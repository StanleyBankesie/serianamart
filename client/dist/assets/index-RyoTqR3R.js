var xE=Object.defineProperty;var gE=(t,s,r)=>s in t?xE(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Jg=(t,s,r)=>gE(t,typeof s!="symbol"?s+"":s,r);function vE(t,s){for(var r=0;r<s.length;r++){const a=s[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var nee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function PS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Zg={exports:{}},Am={},ev={exports:{}},dr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yj;function bE(){if(Yj)return dr;Yj=1;var t=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),m=Symbol.iterator;function h(K){return K===null||typeof K!="object"?null:(K=m&&K[m]||K["@@iterator"],typeof K=="function"?K:null)}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,g={};function b(K,_,F){this.props=K,this.context=_,this.refs=g,this.updater=F||f}b.prototype.isReactComponent={},b.prototype.setState=function(K,_){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,_,"setState")},b.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function y(){}y.prototype=b.prototype;function N(K,_,F){this.props=K,this.context=_,this.refs=g,this.updater=F||f}var j=N.prototype=new y;j.constructor=N,x(j,b.prototype),j.isPureReactComponent=!0;var S=Array.isArray,k=Object.prototype.hasOwnProperty,P={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function B(K,_,F){var E,L={},U=null,J=null;if(_!=null)for(E in _.ref!==void 0&&(J=_.ref),_.key!==void 0&&(U=""+_.key),_)k.call(_,E)&&!I.hasOwnProperty(E)&&(L[E]=_[E]);var ae=arguments.length-2;if(ae===1)L.children=F;else if(1<ae){for(var Z=Array(ae),oe=0;oe<ae;oe++)Z[oe]=arguments[oe+2];L.children=Z}if(K&&K.defaultProps)for(E in ae=K.defaultProps,ae)L[E]===void 0&&(L[E]=ae[E]);return{$$typeof:t,type:K,key:U,ref:J,props:L,_owner:P.current}}function q(K,_){return{$$typeof:t,type:K.type,key:_,ref:K.ref,props:K.props,_owner:K._owner}}function Q(K){return typeof K=="object"&&K!==null&&K.$$typeof===t}function O(K){var _={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(F){return _[F]})}var T=/\/+/g;function V(K,_){return typeof K=="object"&&K!==null&&K.key!=null?O(""+K.key):_.toString(36)}function D(K,_,F,E,L){var U=typeof K;(U==="undefined"||U==="boolean")&&(K=null);var J=!1;if(K===null)J=!0;else switch(U){case"string":case"number":J=!0;break;case"object":switch(K.$$typeof){case t:case s:J=!0}}if(J)return J=K,L=L(J),K=E===""?"."+V(J,0):E,S(L)?(F="",K!=null&&(F=K.replace(T,"$&/")+"/"),D(L,_,F,"",function(oe){return oe})):L!=null&&(Q(L)&&(L=q(L,F+(!L.key||J&&J.key===L.key?"":(""+L.key).replace(T,"$&/")+"/")+K)),_.push(L)),1;if(J=0,E=E===""?".":E+":",S(K))for(var ae=0;ae<K.length;ae++){U=K[ae];var Z=E+V(U,ae);J+=D(U,_,F,Z,L)}else if(Z=h(K),typeof Z=="function")for(K=Z.call(K),ae=0;!(U=K.next()).done;)U=U.value,Z=E+V(U,ae++),J+=D(U,_,F,Z,L);else if(U==="object")throw _=String(K),Error("Objects are not valid as a React child (found: "+(_==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":_)+"). If you meant to render a collection of children, use an array instead.");return J}function Y(K,_,F){if(K==null)return K;var E=[],L=0;return D(K,E,"","",function(U){return _.call(F,U,L++)}),E}function M(K){if(K._status===-1){var _=K._result;_=_(),_.then(function(F){(K._status===0||K._status===-1)&&(K._status=1,K._result=F)},function(F){(K._status===0||K._status===-1)&&(K._status=2,K._result=F)}),K._status===-1&&(K._status=0,K._result=_)}if(K._status===1)return K._result.default;throw K._result}var X={current:null},R={transition:null},H={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:R,ReactCurrentOwner:P};function W(){throw Error("act(...) is not supported in production builds of React.")}return dr.Children={map:Y,forEach:function(K,_,F){Y(K,function(){_.apply(this,arguments)},F)},count:function(K){var _=0;return Y(K,function(){_++}),_},toArray:function(K){return Y(K,function(_){return _})||[]},only:function(K){if(!Q(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},dr.Component=b,dr.Fragment=r,dr.Profiler=n,dr.PureComponent=N,dr.StrictMode=a,dr.Suspense=u,dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,dr.act=W,dr.cloneElement=function(K,_,F){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var E=x({},K.props),L=K.key,U=K.ref,J=K._owner;if(_!=null){if(_.ref!==void 0&&(U=_.ref,J=P.current),_.key!==void 0&&(L=""+_.key),K.type&&K.type.defaultProps)var ae=K.type.defaultProps;for(Z in _)k.call(_,Z)&&!I.hasOwnProperty(Z)&&(E[Z]=_[Z]===void 0&&ae!==void 0?ae[Z]:_[Z])}var Z=arguments.length-2;if(Z===1)E.children=F;else if(1<Z){ae=Array(Z);for(var oe=0;oe<Z;oe++)ae[oe]=arguments[oe+2];E.children=ae}return{$$typeof:t,type:K.type,key:L,ref:U,props:E,_owner:J}},dr.createContext=function(K){return K={$$typeof:l,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:i,_context:K},K.Consumer=K},dr.createElement=B,dr.createFactory=function(K){var _=B.bind(null,K);return _.type=K,_},dr.createRef=function(){return{current:null}},dr.forwardRef=function(K){return{$$typeof:o,render:K}},dr.isValidElement=Q,dr.lazy=function(K){return{$$typeof:c,_payload:{_status:-1,_result:K},_init:M}},dr.memo=function(K,_){return{$$typeof:d,type:K,compare:_===void 0?null:_}},dr.startTransition=function(K){var _=R.transition;R.transition={};try{K()}finally{R.transition=_}},dr.unstable_act=W,dr.useCallback=function(K,_){return X.current.useCallback(K,_)},dr.useContext=function(K){return X.current.useContext(K)},dr.useDebugValue=function(){},dr.useDeferredValue=function(K){return X.current.useDeferredValue(K)},dr.useEffect=function(K,_){return X.current.useEffect(K,_)},dr.useId=function(){return X.current.useId()},dr.useImperativeHandle=function(K,_,F){return X.current.useImperativeHandle(K,_,F)},dr.useInsertionEffect=function(K,_){return X.current.useInsertionEffect(K,_)},dr.useLayoutEffect=function(K,_){return X.current.useLayoutEffect(K,_)},dr.useMemo=function(K,_){return X.current.useMemo(K,_)},dr.useReducer=function(K,_,F){return X.current.useReducer(K,_,F)},dr.useRef=function(K){return X.current.useRef(K)},dr.useState=function(K){return X.current.useState(K)},dr.useSyncExternalStore=function(K,_,F){return X.current.useSyncExternalStore(K,_,F)},dr.useTransition=function(){return X.current.useTransition()},dr.version="18.3.1",dr}var Xj;function y0(){return Xj||(Xj=1,ev.exports=bE()),ev.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jj;function yE(){if(Jj)return Am;Jj=1;var t=y0(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(o,u,d){var c,m={},h=null,f=null;d!==void 0&&(h=""+d),u.key!==void 0&&(h=""+u.key),u.ref!==void 0&&(f=u.ref);for(c in u)a.call(u,c)&&!i.hasOwnProperty(c)&&(m[c]=u[c]);if(o&&o.defaultProps)for(c in u=o.defaultProps,u)m[c]===void 0&&(m[c]=u[c]);return{$$typeof:s,type:o,key:h,ref:f,props:m,_owner:n.current}}return Am.Fragment=r,Am.jsx=l,Am.jsxs=l,Am}var Zj;function jE(){return Zj||(Zj=1,Zg.exports=yE()),Zg.exports}var e=jE(),v=y0();const Os=PS(v),NE=vE({__proto__:null,default:Os},[v]);var _p={},tv={exports:{}},Xi={},sv={exports:{}},rv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eN;function wE(){return eN||(eN=1,(function(t){function s(R,H){var W=R.length;R.push(H);e:for(;0<W;){var K=W-1>>>1,_=R[K];if(0<n(_,H))R[K]=H,R[W]=_,W=K;else break e}}function r(R){return R.length===0?null:R[0]}function a(R){if(R.length===0)return null;var H=R[0],W=R.pop();if(W!==H){R[0]=W;e:for(var K=0,_=R.length,F=_>>>1;K<F;){var E=2*(K+1)-1,L=R[E],U=E+1,J=R[U];if(0>n(L,W))U<_&&0>n(J,L)?(R[K]=J,R[U]=W,K=U):(R[K]=L,R[E]=W,K=E);else if(U<_&&0>n(J,W))R[K]=J,R[U]=W,K=U;else break e}}return H}function n(R,H){var W=R.sortIndex-H.sortIndex;return W!==0?W:R.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var u=[],d=[],c=1,m=null,h=3,f=!1,x=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function j(R){for(var H=r(d);H!==null;){if(H.callback===null)a(d);else if(H.startTime<=R)a(d),H.sortIndex=H.expirationTime,s(u,H);else break;H=r(d)}}function S(R){if(g=!1,j(R),!x)if(r(u)!==null)x=!0,M(k);else{var H=r(d);H!==null&&X(S,H.startTime-R)}}function k(R,H){x=!1,g&&(g=!1,y(B),B=-1),f=!0;var W=h;try{for(j(H),m=r(u);m!==null&&(!(m.expirationTime>H)||R&&!O());){var K=m.callback;if(typeof K=="function"){m.callback=null,h=m.priorityLevel;var _=K(m.expirationTime<=H);H=t.unstable_now(),typeof _=="function"?m.callback=_:m===r(u)&&a(u),j(H)}else a(u);m=r(u)}if(m!==null)var F=!0;else{var E=r(d);E!==null&&X(S,E.startTime-H),F=!1}return F}finally{m=null,h=W,f=!1}}var P=!1,I=null,B=-1,q=5,Q=-1;function O(){return!(t.unstable_now()-Q<q)}function T(){if(I!==null){var R=t.unstable_now();Q=R;var H=!0;try{H=I(!0,R)}finally{H?V():(P=!1,I=null)}}else P=!1}var V;if(typeof N=="function")V=function(){N(T)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,Y=D.port2;D.port1.onmessage=T,V=function(){Y.postMessage(null)}}else V=function(){b(T,0)};function M(R){I=R,P||(P=!0,V())}function X(R,H){B=b(function(){R(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(R){R.callback=null},t.unstable_continueExecution=function(){x||f||(x=!0,M(k))},t.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<R?Math.floor(1e3/R):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(R){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var W=h;h=H;try{return R()}finally{h=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(R,H){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var W=h;h=R;try{return H()}finally{h=W}},t.unstable_scheduleCallback=function(R,H,W){var K=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?K+W:K):W=K,R){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=W+_,R={id:c++,callback:H,priorityLevel:R,startTime:W,expirationTime:_,sortIndex:-1},W>K?(R.sortIndex=W,s(d,R),r(u)===null&&R===r(d)&&(g?(y(B),B=-1):g=!0,X(S,W-K))):(R.sortIndex=_,s(u,R),x||f||(x=!0,M(k))),R},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(R){var H=h;return function(){var W=h;h=H;try{return R.apply(this,arguments)}finally{h=W}}}})(rv)),rv}var tN;function _E(){return tN||(tN=1,sv.exports=wE()),sv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sN;function SE(){if(sN)return Xi;sN=1;var t=y0(),s=_E();function r(A){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+A,w=1;w<arguments.length;w++)p+="&args[]="+encodeURIComponent(arguments[w]);return"Minified React error #"+A+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,n={};function i(A,p){l(A,p),l(A+"Capture",p)}function l(A,p){for(n[A]=p,A=0;A<p.length;A++)a.add(p[A])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},m={};function h(A){return u.call(m,A)?!0:u.call(c,A)?!1:d.test(A)?m[A]=!0:(c[A]=!0,!1)}function f(A,p,w,G){if(w!==null&&w.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return G?!1:w!==null?!w.acceptsBooleans:(A=A.toLowerCase().slice(0,5),A!=="data-"&&A!=="aria-");default:return!1}}function x(A,p,w,G){if(p===null||typeof p>"u"||f(A,p,w,G))return!0;if(G)return!1;if(w!==null)switch(w.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function g(A,p,w,G,ne,de,Be){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=G,this.attributeNamespace=ne,this.mustUseProperty=w,this.propertyName=A,this.type=p,this.sanitizeURL=de,this.removeEmptyString=Be}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(A){b[A]=new g(A,0,!1,A,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(A){var p=A[0];b[p]=new g(p,1,!1,A[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(A){b[A]=new g(A,2,!1,A.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(A){b[A]=new g(A,2,!1,A,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(A){b[A]=new g(A,3,!1,A.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(A){b[A]=new g(A,3,!0,A,null,!1,!1)}),["capture","download"].forEach(function(A){b[A]=new g(A,4,!1,A,null,!1,!1)}),["cols","rows","size","span"].forEach(function(A){b[A]=new g(A,6,!1,A,null,!1,!1)}),["rowSpan","start"].forEach(function(A){b[A]=new g(A,5,!1,A.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function N(A){return A[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(A){var p=A.replace(y,N);b[p]=new g(p,1,!1,A,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(A){var p=A.replace(y,N);b[p]=new g(p,1,!1,A,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(A){var p=A.replace(y,N);b[p]=new g(p,1,!1,A,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(A){b[A]=new g(A,1,!1,A.toLowerCase(),null,!1,!1)}),b.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(A){b[A]=new g(A,1,!1,A.toLowerCase(),null,!0,!0)});function j(A,p,w,G){var ne=b.hasOwnProperty(p)?b[p]:null;(ne!==null?ne.type!==0:G||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(x(p,w,ne,G)&&(w=null),G||ne===null?h(p)&&(w===null?A.removeAttribute(p):A.setAttribute(p,""+w)):ne.mustUseProperty?A[ne.propertyName]=w===null?ne.type===3?!1:"":w:(p=ne.attributeName,G=ne.attributeNamespace,w===null?A.removeAttribute(p):(ne=ne.type,w=ne===3||ne===4&&w===!0?"":""+w,G?A.setAttributeNS(G,p,w):A.setAttribute(p,w))))}var S=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),P=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),q=Symbol.for("react.profiler"),Q=Symbol.for("react.provider"),O=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),R=Symbol.iterator;function H(A){return A===null||typeof A!="object"?null:(A=R&&A[R]||A["@@iterator"],typeof A=="function"?A:null)}var W=Object.assign,K;function _(A){if(K===void 0)try{throw Error()}catch(w){var p=w.stack.trim().match(/\n( *(at )?)/);K=p&&p[1]||""}return`
`+K+A}var F=!1;function E(A,p){if(!A||F)return"";F=!0;var w=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Vt){var G=Vt}Reflect.construct(A,[],p)}else{try{p.call()}catch(Vt){G=Vt}A.call(p.prototype)}else{try{throw Error()}catch(Vt){G=Vt}A()}}catch(Vt){if(Vt&&G&&typeof Vt.stack=="string"){for(var ne=Vt.stack.split(`
`),de=G.stack.split(`
`),Be=ne.length-1,At=de.length-1;1<=Be&&0<=At&&ne[Be]!==de[At];)At--;for(;1<=Be&&0<=At;Be--,At--)if(ne[Be]!==de[At]){if(Be!==1||At!==1)do if(Be--,At--,0>At||ne[Be]!==de[At]){var bt=`
`+ne[Be].replace(" at new "," at ");return A.displayName&&bt.includes("<anonymous>")&&(bt=bt.replace("<anonymous>",A.displayName)),bt}while(1<=Be&&0<=At);break}}}finally{F=!1,Error.prepareStackTrace=w}return(A=A?A.displayName||A.name:"")?_(A):""}function L(A){switch(A.tag){case 5:return _(A.type);case 16:return _("Lazy");case 13:return _("Suspense");case 19:return _("SuspenseList");case 0:case 2:case 15:return A=E(A.type,!1),A;case 11:return A=E(A.type.render,!1),A;case 1:return A=E(A.type,!0),A;default:return""}}function U(A){if(A==null)return null;if(typeof A=="function")return A.displayName||A.name||null;if(typeof A=="string")return A;switch(A){case I:return"Fragment";case P:return"Portal";case q:return"Profiler";case B:return"StrictMode";case V:return"Suspense";case D:return"SuspenseList"}if(typeof A=="object")switch(A.$$typeof){case O:return(A.displayName||"Context")+".Consumer";case Q:return(A._context.displayName||"Context")+".Provider";case T:var p=A.render;return A=A.displayName,A||(A=p.displayName||p.name||"",A=A!==""?"ForwardRef("+A+")":"ForwardRef"),A;case Y:return p=A.displayName||null,p!==null?p:U(A.type)||"Memo";case M:p=A._payload,A=A._init;try{return U(A(p))}catch{}}return null}function J(A){var p=A.type;switch(A.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return A=p.render,A=A.displayName||A.name||"",p.displayName||(A!==""?"ForwardRef("+A+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(p);case 8:return p===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function ae(A){switch(typeof A){case"boolean":case"number":case"string":case"undefined":return A;case"object":return A;default:return""}}function Z(A){var p=A.type;return(A=A.nodeName)&&A.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function oe(A){var p=Z(A)?"checked":"value",w=Object.getOwnPropertyDescriptor(A.constructor.prototype,p),G=""+A[p];if(!A.hasOwnProperty(p)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var ne=w.get,de=w.set;return Object.defineProperty(A,p,{configurable:!0,get:function(){return ne.call(this)},set:function(Be){G=""+Be,de.call(this,Be)}}),Object.defineProperty(A,p,{enumerable:w.enumerable}),{getValue:function(){return G},setValue:function(Be){G=""+Be},stopTracking:function(){A._valueTracker=null,delete A[p]}}}}function ee(A){A._valueTracker||(A._valueTracker=oe(A))}function se(A){if(!A)return!1;var p=A._valueTracker;if(!p)return!0;var w=p.getValue(),G="";return A&&(G=Z(A)?A.checked?"true":"false":A.value),A=G,A!==w?(p.setValue(A),!0):!1}function Ae(A){if(A=A||(typeof document<"u"?document:void 0),typeof A>"u")return null;try{return A.activeElement||A.body}catch{return A.body}}function we(A,p){var w=p.checked;return W({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:w??A._wrapperState.initialChecked})}function ce(A,p){var w=p.defaultValue==null?"":p.defaultValue,G=p.checked!=null?p.checked:p.defaultChecked;w=ae(p.value!=null?p.value:w),A._wrapperState={initialChecked:G,initialValue:w,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function le(A,p){p=p.checked,p!=null&&j(A,"checked",p,!1)}function _e(A,p){le(A,p);var w=ae(p.value),G=p.type;if(w!=null)G==="number"?(w===0&&A.value===""||A.value!=w)&&(A.value=""+w):A.value!==""+w&&(A.value=""+w);else if(G==="submit"||G==="reset"){A.removeAttribute("value");return}p.hasOwnProperty("value")?Ie(A,p.type,w):p.hasOwnProperty("defaultValue")&&Ie(A,p.type,ae(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(A.defaultChecked=!!p.defaultChecked)}function Qe(A,p,w){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var G=p.type;if(!(G!=="submit"&&G!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+A._wrapperState.initialValue,w||p===A.value||(A.value=p),A.defaultValue=p}w=A.name,w!==""&&(A.name=""),A.defaultChecked=!!A._wrapperState.initialChecked,w!==""&&(A.name=w)}function Ie(A,p,w){(p!=="number"||Ae(A.ownerDocument)!==A)&&(w==null?A.defaultValue=""+A._wrapperState.initialValue:A.defaultValue!==""+w&&(A.defaultValue=""+w))}var ke=Array.isArray;function pe(A,p,w,G){if(A=A.options,p){p={};for(var ne=0;ne<w.length;ne++)p["$"+w[ne]]=!0;for(w=0;w<A.length;w++)ne=p.hasOwnProperty("$"+A[w].value),A[w].selected!==ne&&(A[w].selected=ne),ne&&G&&(A[w].defaultSelected=!0)}else{for(w=""+ae(w),p=null,ne=0;ne<A.length;ne++){if(A[ne].value===w){A[ne].selected=!0,G&&(A[ne].defaultSelected=!0);return}p!==null||A[ne].disabled||(p=A[ne])}p!==null&&(p.selected=!0)}}function he(A,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return W({},p,{value:void 0,defaultValue:void 0,children:""+A._wrapperState.initialValue})}function je(A,p){var w=p.value;if(w==null){if(w=p.children,p=p.defaultValue,w!=null){if(p!=null)throw Error(r(92));if(ke(w)){if(1<w.length)throw Error(r(93));w=w[0]}p=w}p==null&&(p=""),w=p}A._wrapperState={initialValue:ae(w)}}function me(A,p){var w=ae(p.value),G=ae(p.defaultValue);w!=null&&(w=""+w,w!==A.value&&(A.value=w),p.defaultValue==null&&A.defaultValue!==w&&(A.defaultValue=w)),G!=null&&(A.defaultValue=""+G)}function xe(A){var p=A.textContent;p===A._wrapperState.initialValue&&p!==""&&p!==null&&(A.value=p)}function Ue(A){switch(A){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ct(A,p){return A==null||A==="http://www.w3.org/1999/xhtml"?Ue(p):A==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":A}var dt,We=(function(A){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,w,G,ne){MSApp.execUnsafeLocalFunction(function(){return A(p,w,G,ne)})}:A})(function(A,p){if(A.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in A)A.innerHTML=p;else{for(dt=dt||document.createElement("div"),dt.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=dt.firstChild;A.firstChild;)A.removeChild(A.firstChild);for(;p.firstChild;)A.appendChild(p.firstChild)}});function He(A,p){if(p){var w=A.firstChild;if(w&&w===A.lastChild&&w.nodeType===3){w.nodeValue=p;return}}A.textContent=p}var ze={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pe=["Webkit","ms","Moz","O"];Object.keys(ze).forEach(function(A){Pe.forEach(function(p){p=p+A.charAt(0).toUpperCase()+A.substring(1),ze[p]=ze[A]})});function Te(A,p,w){return p==null||typeof p=="boolean"||p===""?"":w||typeof p!="number"||p===0||ze.hasOwnProperty(A)&&ze[A]?(""+p).trim():p+"px"}function Ke(A,p){A=A.style;for(var w in p)if(p.hasOwnProperty(w)){var G=w.indexOf("--")===0,ne=Te(w,p[w],G);w==="float"&&(w="cssFloat"),G?A.setProperty(w,ne):A[w]=ne}}var $e=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ve(A,p){if(p){if($e[A]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,A));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!="object")throw Error(r(62))}}function Ze(A,p){if(A.indexOf("-")===-1)return typeof p.is=="string";switch(A){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Re=null;function it(A){return A=A.target||A.srcElement||window,A.correspondingUseElement&&(A=A.correspondingUseElement),A.nodeType===3?A.parentNode:A}var lt=null,Ne=null,Xe=null;function Ge(A){if(A=kd(A)){if(typeof lt!="function")throw Error(r(280));var p=A.stateNode;p&&(p=Pu(p),lt(A.stateNode,A.type,p))}}function at(A){Ne?Xe?Xe.push(A):Xe=[A]:Ne=A}function xt(){if(Ne){var A=Ne,p=Xe;if(Xe=Ne=null,Ge(A),p)for(A=0;A<p.length;A++)Ge(p[A])}}function wt(A,p){return A(p)}function pt(){}var ge=!1;function rt(A,p,w){if(ge)return A(p,w);ge=!0;try{return wt(A,p,w)}finally{ge=!1,(Ne!==null||Xe!==null)&&(pt(),xt())}}function ht(A,p){var w=A.stateNode;if(w===null)return null;var G=Pu(w);if(G===null)return null;w=G[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(G=!G.disabled)||(A=A.type,G=!(A==="button"||A==="input"||A==="select"||A==="textarea")),A=!G;break e;default:A=!1}if(A)return null;if(w&&typeof w!="function")throw Error(r(231,p,typeof w));return w}var ft=!1;if(o)try{var St={};Object.defineProperty(St,"passive",{get:function(){ft=!0}}),window.addEventListener("test",St,St),window.removeEventListener("test",St,St)}catch{ft=!1}function Je(A,p,w,G,ne,de,Be,At,bt){var Vt=Array.prototype.slice.call(arguments,3);try{p.apply(w,Vt)}catch(ds){this.onError(ds)}}var ts=!1,Kt=null,fe=!1,Oe=null,Se={onError:function(A){ts=!0,Kt=A}};function Le(A,p,w,G,ne,de,Be,At,bt){ts=!1,Kt=null,Je.apply(Se,arguments)}function Ye(A,p,w,G,ne,de,Be,At,bt){if(Le.apply(this,arguments),ts){if(ts){var Vt=Kt;ts=!1,Kt=null}else throw Error(r(198));fe||(fe=!0,Oe=Vt)}}function st(A){var p=A,w=A;if(A.alternate)for(;p.return;)p=p.return;else{A=p;do p=A,(p.flags&4098)!==0&&(w=p.return),A=p.return;while(A)}return p.tag===3?w:null}function It(A){if(A.tag===13){var p=A.memoizedState;if(p===null&&(A=A.alternate,A!==null&&(p=A.memoizedState)),p!==null)return p.dehydrated}return null}function Ft(A){if(st(A)!==A)throw Error(r(188))}function Bt(A){var p=A.alternate;if(!p){if(p=st(A),p===null)throw Error(r(188));return p!==A?null:A}for(var w=A,G=p;;){var ne=w.return;if(ne===null)break;var de=ne.alternate;if(de===null){if(G=ne.return,G!==null){w=G;continue}break}if(ne.child===de.child){for(de=ne.child;de;){if(de===w)return Ft(ne),A;if(de===G)return Ft(ne),p;de=de.sibling}throw Error(r(188))}if(w.return!==G.return)w=ne,G=de;else{for(var Be=!1,At=ne.child;At;){if(At===w){Be=!0,w=ne,G=de;break}if(At===G){Be=!0,G=ne,w=de;break}At=At.sibling}if(!Be){for(At=de.child;At;){if(At===w){Be=!0,w=de,G=ne;break}if(At===G){Be=!0,G=de,w=ne;break}At=At.sibling}if(!Be)throw Error(r(189))}}if(w.alternate!==G)throw Error(r(190))}if(w.tag!==3)throw Error(r(188));return w.stateNode.current===w?A:p}function Tt(A){return A=Bt(A),A!==null?Me(A):null}function Me(A){if(A.tag===5||A.tag===6)return A;for(A=A.child;A!==null;){var p=Me(A);if(p!==null)return p;A=A.sibling}return null}var Nt=s.unstable_scheduleCallback,Et=s.unstable_cancelCallback,$t=s.unstable_shouldYield,Ht=s.unstable_requestPaint,Ot=s.unstable_now,ls=s.unstable_getCurrentPriorityLevel,Ls=s.unstable_ImmediatePriority,Is=s.unstable_UserBlockingPriority,Hs=s.unstable_NormalPriority,Ir=s.unstable_LowPriority,ya=s.unstable_IdlePriority,yr=null,cr=null;function ka(A){if(cr&&typeof cr.onCommitFiberRoot=="function")try{cr.onCommitFiberRoot(yr,A,void 0,(A.current.flags&128)===128)}catch{}}var Ks=Math.clz32?Math.clz32:zr,jr=Math.log,nl=Math.LN2;function zr(A){return A>>>=0,A===0?32:31-(jr(A)/nl|0)|0}var sa=64,on=4194304;function yi(A){switch(A&-A){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return A&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return A&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return A}}function en(A,p){var w=A.pendingLanes;if(w===0)return 0;var G=0,ne=A.suspendedLanes,de=A.pingedLanes,Be=w&268435455;if(Be!==0){var At=Be&~ne;At!==0?G=yi(At):(de&=Be,de!==0&&(G=yi(de)))}else Be=w&~ne,Be!==0?G=yi(Be):de!==0&&(G=yi(de));if(G===0)return 0;if(p!==0&&p!==G&&(p&ne)===0&&(ne=G&-G,de=p&-p,ne>=de||ne===16&&(de&4194240)!==0))return p;if((G&4)!==0&&(G|=w&16),p=A.entangledLanes,p!==0)for(A=A.entanglements,p&=G;0<p;)w=31-Ks(p),ne=1<<w,G|=A[w],p&=~ne;return G}function Oi(A,p){switch(A){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qr(A,p){for(var w=A.suspendedLanes,G=A.pingedLanes,ne=A.expirationTimes,de=A.pendingLanes;0<de;){var Be=31-Ks(de),At=1<<Be,bt=ne[Be];bt===-1?((At&w)===0||(At&G)!==0)&&(ne[Be]=Oi(At,p)):bt<=p&&(A.expiredLanes|=At),de&=~At}}function Fn(A){return A=A.pendingLanes&-1073741825,A!==0?A:A&1073741824?1073741824:0}function ji(){var A=sa;return sa<<=1,(sa&4194240)===0&&(sa=64),A}function Gn(A){for(var p=[],w=0;31>w;w++)p.push(A);return p}function Kn(A,p,w){A.pendingLanes|=p,p!==536870912&&(A.suspendedLanes=0,A.pingedLanes=0),A=A.eventTimes,p=31-Ks(p),A[p]=w}function od(A,p){var w=A.pendingLanes&~p;A.pendingLanes=p,A.suspendedLanes=0,A.pingedLanes=0,A.expiredLanes&=p,A.mutableReadLanes&=p,A.entangledLanes&=p,p=A.entanglements;var G=A.eventTimes;for(A=A.expirationTimes;0<w;){var ne=31-Ks(w),de=1<<ne;p[ne]=0,G[ne]=-1,A[ne]=-1,w&=~de}}function il(A,p){var w=A.entangledLanes|=p;for(A=A.entanglements;w;){var G=31-Ks(w),ne=1<<G;ne&p|A[G]&p&&(A[G]|=p),w&=~ne}}var xr=0;function Nr(A){return A&=-A,1<A?4<A?(A&268435455)!==0?16:536870912:4:1}var cd,fc,dd,ma,Qi,ll=!1,cn=[],Mr=null,Ni=null,zn=null,Ms=new Map,be=new Map,nt=[],ut="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _t(A,p){switch(A){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":Ni=null;break;case"mouseover":case"mouseout":zn=null;break;case"pointerover":case"pointerout":Ms.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":be.delete(p.pointerId)}}function Qt(A,p,w,G,ne,de){return A===null||A.nativeEvent!==de?(A={blockedOn:p,domEventName:w,eventSystemFlags:G,nativeEvent:de,targetContainers:[ne]},p!==null&&(p=kd(p),p!==null&&fc(p)),A):(A.eventSystemFlags|=G,p=A.targetContainers,ne!==null&&p.indexOf(ne)===-1&&p.push(ne),A)}function qt(A,p,w,G,ne){switch(p){case"focusin":return Mr=Qt(Mr,A,p,w,G,ne),!0;case"dragenter":return Ni=Qt(Ni,A,p,w,G,ne),!0;case"mouseover":return zn=Qt(zn,A,p,w,G,ne),!0;case"pointerover":var de=ne.pointerId;return Ms.set(de,Qt(Ms.get(de)||null,A,p,w,G,ne)),!0;case"gotpointercapture":return de=ne.pointerId,be.set(de,Qt(be.get(de)||null,A,p,w,G,ne)),!0}return!1}function Ut(A){var p=Go(A.target);if(p!==null){var w=st(p);if(w!==null){if(p=w.tag,p===13){if(p=It(w),p!==null){A.blockedOn=p,Qi(A.priority,function(){dd(w)});return}}else if(p===3&&w.stateNode.current.memoizedState.isDehydrated){A.blockedOn=w.tag===3?w.stateNode.containerInfo:null;return}}}A.blockedOn=null}function Zt(A){if(A.blockedOn!==null)return!1;for(var p=A.targetContainers;0<p.length;){var w=hr(A.domEventName,A.eventSystemFlags,p[0],A.nativeEvent);if(w===null){w=A.nativeEvent;var G=new w.constructor(w.type,w);Re=G,w.target.dispatchEvent(G),Re=null}else return p=kd(w),p!==null&&fc(p),A.blockedOn=w,!1;p.shift()}return!0}function ss(A,p,w){Zt(A)&&w.delete(p)}function fs(){ll=!1,Mr!==null&&Zt(Mr)&&(Mr=null),Ni!==null&&Zt(Ni)&&(Ni=null),zn!==null&&Zt(zn)&&(zn=null),Ms.forEach(ss),be.forEach(ss)}function js(A,p){A.blockedOn===p&&(A.blockedOn=null,ll||(ll=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,fs)))}function ns(A){function p(ne){return js(ne,A)}if(0<cn.length){js(cn[0],A);for(var w=1;w<cn.length;w++){var G=cn[w];G.blockedOn===A&&(G.blockedOn=null)}}for(Mr!==null&&js(Mr,A),Ni!==null&&js(Ni,A),zn!==null&&js(zn,A),Ms.forEach(p),be.forEach(p),w=0;w<nt.length;w++)G=nt[w],G.blockedOn===A&&(G.blockedOn=null);for(;0<nt.length&&(w=nt[0],w.blockedOn===null);)Ut(w),w.blockedOn===null&&nt.shift()}var rs=S.ReactCurrentBatchConfig,bs=!0;function ms(A,p,w,G){var ne=xr,de=rs.transition;rs.transition=null;try{xr=1,dn(A,p,w,G)}finally{xr=ne,rs.transition=de}}function gr(A,p,w,G){var ne=xr,de=rs.transition;rs.transition=null;try{xr=4,dn(A,p,w,G)}finally{xr=ne,rs.transition=de}}function dn(A,p,w,G){if(bs){var ne=hr(A,p,w,G);if(ne===null)Iu(A,p,G,na,w),_t(A,G);else if(qt(ne,A,p,w,G))G.stopPropagation();else if(_t(A,G),p&4&&-1<ut.indexOf(A)){for(;ne!==null;){var de=kd(ne);if(de!==null&&cd(de),de=hr(A,p,w,G),de===null&&Iu(A,p,G,na,w),de===ne)break;ne=de}ne!==null&&G.stopPropagation()}else Iu(A,p,G,null,w)}}var na=null;function hr(A,p,w,G){if(na=null,A=it(G),A=Go(A),A!==null)if(p=st(A),p===null)A=null;else if(w=p.tag,w===13){if(A=It(p),A!==null)return A;A=null}else if(w===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;A=null}else p!==A&&(A=null);return na=A,null}function fa(A){switch(A){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ls()){case Ls:return 1;case Is:return 4;case Hs:case Ir:return 16;case ya:return 536870912;default:return 16}default:return 16}}var er=null,Jr=null,Ea=null;function Sl(){if(Ea)return Ea;var A,p=Jr,w=p.length,G,ne="value"in er?er.value:er.textContent,de=ne.length;for(A=0;A<w&&p[A]===ne[A];A++);var Be=w-A;for(G=1;G<=Be&&p[w-G]===ne[de-G];G++);return Ea=ne.slice(A,1<G?1-G:void 0)}function $s(A){var p=A.keyCode;return"charCode"in A?(A=A.charCode,A===0&&p===13&&(A=13)):A=p,A===10&&(A=13),32<=A||A===13?A:0}function mr(){return!0}function ol(){return!1}function ja(A){function p(w,G,ne,de,Be){this._reactName=w,this._targetInst=ne,this.type=G,this.nativeEvent=de,this.target=Be,this.currentTarget=null;for(var At in A)A.hasOwnProperty(At)&&(w=A[At],this[At]=w?w(de):de[At]);return this.isDefaultPrevented=(de.defaultPrevented!=null?de.defaultPrevented:de.returnValue===!1)?mr:ol,this.isPropagationStopped=ol,this}return W(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var w=this.nativeEvent;w&&(w.preventDefault?w.preventDefault():typeof w.returnValue!="unknown"&&(w.returnValue=!1),this.isDefaultPrevented=mr)},stopPropagation:function(){var w=this.nativeEvent;w&&(w.stopPropagation?w.stopPropagation():typeof w.cancelBubble!="unknown"&&(w.cancelBubble=!0),this.isPropagationStopped=mr)},persist:function(){},isPersistent:mr}),p}var Ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(A){return A.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oo=ja(Ro),pc=W({},Ro,{view:0,detail:0}),Nu=ja(pc),xc,ud,Cl,Qo=W({},pc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ws,button:0,buttons:0,relatedTarget:function(A){return A.relatedTarget===void 0?A.fromElement===A.srcElement?A.toElement:A.fromElement:A.relatedTarget},movementX:function(A){return"movementX"in A?A.movementX:(A!==Cl&&(Cl&&A.type==="mousemove"?(xc=A.screenX-Cl.screenX,ud=A.screenY-Cl.screenY):ud=xc=0,Cl=A),xc)},movementY:function(A){return"movementY"in A?A.movementY:ud}}),Ad=ja(Qo),EA=W({},Qo,{dataTransfer:0}),Kh=ja(EA),hd=W({},pc,{relatedTarget:0}),Zl=ja(hd),wu=W({},Ro,{animationName:0,elapsedTime:0,pseudoElement:0}),Mo=ja(wu),_u=W({},Ro,{clipboardData:function(A){return"clipboardData"in A?A.clipboardData:window.clipboardData}}),re=ja(_u),ye=W({},Ro,{data:0}),ot=ja(ye),gt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function os(A){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(A):(A=zt[A])?!!p[A]:!1}function ws(){return os}var Us=W({},pc,{key:function(A){if(A.key){var p=gt[A.key]||A.key;if(p!=="Unidentified")return p}return A.type==="keypress"?(A=$s(A),A===13?"Enter":String.fromCharCode(A)):A.type==="keydown"||A.type==="keyup"?Lt[A.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ws,charCode:function(A){return A.type==="keypress"?$s(A):0},keyCode:function(A){return A.type==="keydown"||A.type==="keyup"?A.keyCode:0},which:function(A){return A.type==="keypress"?$s(A):A.type==="keydown"||A.type==="keyup"?A.keyCode:0}}),sr=ja(Us),tr=W({},Qo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ar=ja(tr),ia=W({},pc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ws}),pa=ja(ia),Fa=W({},Ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),gn=ja(Fa),tn=W({},Qo,{deltaX:function(A){return"deltaX"in A?A.deltaX:"wheelDeltaX"in A?-A.wheelDeltaX:0},deltaY:function(A){return"deltaY"in A?A.deltaY:"wheelDeltaY"in A?-A.wheelDeltaY:"wheelDelta"in A?-A.wheelDelta:0},deltaZ:0,deltaMode:0}),cl=ja(tn),wi=[9,13,27,32],Mi=o&&"CompositionEvent"in window,Ho=null;o&&"documentMode"in document&&(Ho=document.documentMode);var Su=o&&"TextEvent"in window&&!Ho,md=o&&(!Mi||Ho&&8<Ho&&11>=Ho),gc=" ",fd=!1;function pd(A,p){switch(A){case"keyup":return wi.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vc(A){return A=A.detail,typeof A=="object"&&"data"in A?A.data:null}var xa=!1;function xd(A,p){switch(A){case"compositionend":return vc(p);case"keypress":return p.which!==32?null:(fd=!0,gc);case"textInput":return A=p.data,A===gc&&fd?null:A;default:return null}}function gd(A,p){if(xa)return A==="compositionend"||!Mi&&pd(A,p)?(A=Sl(),Ea=Jr=er=null,xa=!1,A):null;switch(A){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return md&&p.locale!=="ko"?null:p.data;default:return null}}var vd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bd(A){var p=A&&A.nodeName&&A.nodeName.toLowerCase();return p==="input"?!!vd[A.type]:p==="textarea"}function Tn(A,p,w,G){at(G),p=LA(p,"onChange"),0<p.length&&(w=new Oo("onChange","change",null,w,G),A.push({event:w,listeners:p}))}var bc=null,eo=null;function FA(A){Fu(A,0)}function In(A){var p=kc(A);if(se(p))return A}function yd(A,p){if(A==="change")return p}var Cu=!1;if(o){var jd;if(o){var Bl="oninput"in document;if(!Bl){var qo=document.createElement("div");qo.setAttribute("oninput","return;"),Bl=typeof qo.oninput=="function"}jd=Bl}else jd=!1;Cu=jd&&(!document.documentMode||9<document.documentMode)}function Ln(){bc&&(bc.detachEvent("onpropertychange",vn),eo=bc=null)}function vn(A){if(A.propertyName==="value"&&In(eo)){var p=[];Tn(p,eo,A,it(A)),rt(FA,p)}}function Vo(A,p,w){A==="focusin"?(Ln(),bc=p,eo=w,bc.attachEvent("onpropertychange",vn)):A==="focusout"&&Ln()}function to(A){if(A==="selectionchange"||A==="keyup"||A==="keydown")return In(eo)}function so(A,p){if(A==="click")return In(p)}function Nd(A,p){if(A==="input"||A==="change")return In(p)}function ro(A,p){return A===p&&(A!==0||1/A===1/p)||A!==A&&p!==p}var wr=typeof Object.is=="function"?Object.is:ro;function ao(A,p){if(wr(A,p))return!0;if(typeof A!="object"||A===null||typeof p!="object"||p===null)return!1;var w=Object.keys(A),G=Object.keys(p);if(w.length!==G.length)return!1;for(G=0;G<w.length;G++){var ne=w[G];if(!u.call(p,ne)||!wr(A[ne],p[ne]))return!1}return!0}function bn(A){for(;A&&A.firstChild;)A=A.firstChild;return A}function _i(A,p){var w=bn(A);A=0;for(var G;w;){if(w.nodeType===3){if(G=A+w.textContent.length,A<=p&&G>=p)return{node:w,offset:p-A};A=G}e:{for(;w;){if(w.nextSibling){w=w.nextSibling;break e}w=w.parentNode}w=void 0}w=bn(w)}}function yc(A,p){return A&&p?A===p?!0:A&&A.nodeType===3?!1:p&&p.nodeType===3?yc(A,p.parentNode):"contains"in A?A.contains(p):A.compareDocumentPosition?!!(A.compareDocumentPosition(p)&16):!1:!1}function Bu(){for(var A=window,p=Ae();p instanceof A.HTMLIFrameElement;){try{var w=typeof p.contentWindow.location.href=="string"}catch{w=!1}if(w)A=p.contentWindow;else break;p=Ae(A.document)}return p}function jc(A){var p=A&&A.nodeName&&A.nodeName.toLowerCase();return p&&(p==="input"&&(A.type==="text"||A.type==="search"||A.type==="tel"||A.type==="url"||A.type==="password")||p==="textarea"||A.contentEditable==="true")}function Nc(A){var p=Bu(),w=A.focusedElem,G=A.selectionRange;if(p!==w&&w&&w.ownerDocument&&yc(w.ownerDocument.documentElement,w)){if(G!==null&&jc(w)){if(p=G.start,A=G.end,A===void 0&&(A=p),"selectionStart"in w)w.selectionStart=p,w.selectionEnd=Math.min(A,w.value.length);else if(A=(p=w.ownerDocument||document)&&p.defaultView||window,A.getSelection){A=A.getSelection();var ne=w.textContent.length,de=Math.min(G.start,ne);G=G.end===void 0?de:Math.min(G.end,ne),!A.extend&&de>G&&(ne=G,G=de,de=ne),ne=_i(w,de);var Be=_i(w,G);ne&&Be&&(A.rangeCount!==1||A.anchorNode!==ne.node||A.anchorOffset!==ne.offset||A.focusNode!==Be.node||A.focusOffset!==Be.offset)&&(p=p.createRange(),p.setStart(ne.node,ne.offset),A.removeAllRanges(),de>G?(A.addRange(p),A.extend(Be.node,Be.offset)):(p.setEnd(Be.node,Be.offset),A.addRange(p)))}}for(p=[],A=w;A=A.parentNode;)A.nodeType===1&&p.push({element:A,left:A.scrollLeft,top:A.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<p.length;w++)A=p[w],A.element.scrollLeft=A.left,A.element.scrollTop=A.top}}var wc=o&&"documentMode"in document&&11>=document.documentMode,Si=null,no=null,kl=null,io=!1;function lo(A,p,w){var G=w.window===w?w.document:w.nodeType===9?w:w.ownerDocument;io||Si==null||Si!==Ae(G)||(G=Si,"selectionStart"in G&&jc(G)?G={start:G.selectionStart,end:G.selectionEnd}:(G=(G.ownerDocument&&G.ownerDocument.defaultView||window).getSelection(),G={anchorNode:G.anchorNode,anchorOffset:G.anchorOffset,focusNode:G.focusNode,focusOffset:G.focusOffset}),kl&&ao(kl,G)||(kl=G,G=LA(no,"onSelect"),0<G.length&&(p=new Oo("onSelect","select",null,p,w),A.push({event:p,listeners:G}),p.target=Si)))}function $o(A,p){var w={};return w[A.toLowerCase()]=p.toLowerCase(),w["Webkit"+A]="webkit"+p,w["Moz"+A]="moz"+p,w}var un={animationend:$o("Animation","AnimationEnd"),animationiteration:$o("Animation","AnimationIteration"),animationstart:$o("Animation","AnimationStart"),transitionend:$o("Transition","TransitionEnd")},Yn={},Hr={};o&&(Hr=document.createElement("div").style,"AnimationEvent"in window||(delete un.animationend.animation,delete un.animationiteration.animation,delete un.animationstart.animation),"TransitionEvent"in window||delete un.transitionend.transition);function Lr(A){if(Yn[A])return Yn[A];if(!un[A])return A;var p=un[A],w;for(w in p)if(p.hasOwnProperty(w)&&w in Hr)return Yn[A]=p[w];return A}var ga=Lr("animationend"),Ta=Lr("animationiteration"),El=Lr("animationstart"),wd=Lr("transitionend"),_c=new Map,ku="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fl(A,p){_c.set(A,p),i(p,[A])}for(var _d=0;_d<ku.length;_d++){var Dn=ku[_d],Hi=Dn.toLowerCase(),TA=Dn[0].toUpperCase()+Dn.slice(1);Fl(Hi,"on"+TA)}Fl(ga,"onAnimationEnd"),Fl(Ta,"onAnimationIteration"),Fl(El,"onAnimationStart"),Fl("dblclick","onDoubleClick"),Fl("focusin","onFocus"),Fl("focusout","onBlur"),Fl(wd,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$f=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wo));function Eu(A,p,w){var G=A.type||"unknown-event";A.currentTarget=w,Ye(G,p,void 0,A),A.currentTarget=null}function Fu(A,p){p=(p&4)!==0;for(var w=0;w<A.length;w++){var G=A[w],ne=G.event;G=G.listeners;e:{var de=void 0;if(p)for(var Be=G.length-1;0<=Be;Be--){var At=G[Be],bt=At.instance,Vt=At.currentTarget;if(At=At.listener,bt!==de&&ne.isPropagationStopped())break e;Eu(ne,At,Vt),de=bt}else for(Be=0;Be<G.length;Be++){if(At=G[Be],bt=At.instance,Vt=At.currentTarget,At=At.listener,bt!==de&&ne.isPropagationStopped())break e;Eu(ne,At,Vt),de=bt}}}if(fe)throw A=Oe,fe=!1,Oe=null,A}function qr(A,p){var w=p[Jn];w===void 0&&(w=p[Jn]=new Set);var G=A+"__bubble";w.has(G)||(Tu(p,A,2,!1),w.add(G))}function IA(A,p,w){var G=0;p&&(G|=4),Tu(w,A,G,p)}var Sd="_reactListening"+Math.random().toString(36).slice(2);function Sc(A){if(!A[Sd]){A[Sd]=!0,a.forEach(function(w){w!=="selectionchange"&&($f.has(w)||IA(w,!1,A),IA(w,!0,A))});var p=A.nodeType===9?A:A.ownerDocument;p===null||p[Sd]||(p[Sd]=!0,IA("selectionchange",!1,p))}}function Tu(A,p,w,G){switch(fa(p)){case 1:var ne=ms;break;case 4:ne=gr;break;default:ne=dn}w=ne.bind(null,p,w,A),ne=void 0,!ft||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(ne=!0),G?ne!==void 0?A.addEventListener(p,w,{capture:!0,passive:ne}):A.addEventListener(p,w,!0):ne!==void 0?A.addEventListener(p,w,{passive:ne}):A.addEventListener(p,w,!1)}function Iu(A,p,w,G,ne){var de=G;if((p&1)===0&&(p&2)===0&&G!==null)e:for(;;){if(G===null)return;var Be=G.tag;if(Be===3||Be===4){var At=G.stateNode.containerInfo;if(At===ne||At.nodeType===8&&At.parentNode===ne)break;if(Be===4)for(Be=G.return;Be!==null;){var bt=Be.tag;if((bt===3||bt===4)&&(bt=Be.stateNode.containerInfo,bt===ne||bt.nodeType===8&&bt.parentNode===ne))return;Be=Be.return}for(;At!==null;){if(Be=Go(At),Be===null)return;if(bt=Be.tag,bt===5||bt===6){G=de=Be;continue e}At=At.parentNode}}G=G.return}rt(function(){var Vt=de,ds=it(w),hs=[];e:{var cs=_c.get(A);if(cs!==void 0){var Cs=Oo,Es=A;switch(A){case"keypress":if($s(w)===0)break e;case"keydown":case"keyup":Cs=sr;break;case"focusin":Es="focus",Cs=Zl;break;case"focusout":Es="blur",Cs=Zl;break;case"beforeblur":case"afterblur":Cs=Zl;break;case"click":if(w.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Cs=Ad;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Cs=Kh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Cs=pa;break;case ga:case Ta:case El:Cs=Mo;break;case wd:Cs=gn;break;case"scroll":Cs=Nu;break;case"wheel":Cs=cl;break;case"copy":case"cut":case"paste":Cs=re;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Cs=Ar}var Ts=(p&4)!==0,Va=!Ts&&A==="scroll",Rt=Ts?cs!==null?cs+"Capture":null:cs;Ts=[];for(var Ct=Vt,Mt;Ct!==null;){Mt=Ct;var ps=Mt.stateNode;if(Mt.tag===5&&ps!==null&&(Mt=ps,Rt!==null&&(ps=ht(Ct,Rt),ps!=null&&Ts.push(Lu(Ct,ps,Mt)))),Va)break;Ct=Ct.return}0<Ts.length&&(cs=new Cs(cs,Es,null,w,ds),hs.push({event:cs,listeners:Ts}))}}if((p&7)===0){e:{if(cs=A==="mouseover"||A==="pointerover",Cs=A==="mouseout"||A==="pointerout",cs&&w!==Re&&(Es=w.relatedTarget||w.fromElement)&&(Go(Es)||Es[yn]))break e;if((Cs||cs)&&(cs=ds.window===ds?ds:(cs=ds.ownerDocument)?cs.defaultView||cs.parentWindow:window,Cs?(Es=w.relatedTarget||w.toElement,Cs=Vt,Es=Es?Go(Es):null,Es!==null&&(Va=st(Es),Es!==Va||Es.tag!==5&&Es.tag!==6)&&(Es=null)):(Cs=null,Es=Vt),Cs!==Es)){if(Ts=Ad,ps="onMouseLeave",Rt="onMouseEnter",Ct="mouse",(A==="pointerout"||A==="pointerover")&&(Ts=Ar,ps="onPointerLeave",Rt="onPointerEnter",Ct="pointer"),Va=Cs==null?cs:kc(Cs),Mt=Es==null?cs:kc(Es),cs=new Ts(ps,Ct+"leave",Cs,w,ds),cs.target=Va,cs.relatedTarget=Mt,ps=null,Go(ds)===Vt&&(Ts=new Ts(Rt,Ct+"enter",Es,w,ds),Ts.target=Mt,Ts.relatedTarget=Va,ps=Ts),Va=ps,Cs&&Es)t:{for(Ts=Cs,Rt=Es,Ct=0,Mt=Ts;Mt;Mt=Cc(Mt))Ct++;for(Mt=0,ps=Rt;ps;ps=Cc(ps))Mt++;for(;0<Ct-Mt;)Ts=Cc(Ts),Ct--;for(;0<Mt-Ct;)Rt=Cc(Rt),Mt--;for(;Ct--;){if(Ts===Rt||Rt!==null&&Ts===Rt.alternate)break t;Ts=Cc(Ts),Rt=Cc(Rt)}Ts=null}else Ts=null;Cs!==null&&Wf(hs,cs,Cs,Ts,!1),Es!==null&&Va!==null&&Wf(hs,Va,Es,Ts,!0)}}e:{if(cs=Vt?kc(Vt):window,Cs=cs.nodeName&&cs.nodeName.toLowerCase(),Cs==="select"||Cs==="input"&&cs.type==="file")var Ds=yd;else if(bd(cs))if(Cu)Ds=Nd;else{Ds=to;var qs=Vo}else(Cs=cs.nodeName)&&Cs.toLowerCase()==="input"&&(cs.type==="checkbox"||cs.type==="radio")&&(Ds=so);if(Ds&&(Ds=Ds(A,Vt))){Tn(hs,Ds,w,ds);break e}qs&&qs(A,cs,Vt),A==="focusout"&&(qs=cs._wrapperState)&&qs.controlled&&cs.type==="number"&&Ie(cs,"number",cs.value)}switch(qs=Vt?kc(Vt):window,A){case"focusin":(bd(qs)||qs.contentEditable==="true")&&(Si=qs,no=Vt,kl=null);break;case"focusout":kl=no=Si=null;break;case"mousedown":io=!0;break;case"contextmenu":case"mouseup":case"dragend":io=!1,lo(hs,w,ds);break;case"selectionchange":if(wc)break;case"keydown":case"keyup":lo(hs,w,ds)}var Vs;if(Mi)e:{switch(A){case"compositionstart":var Zs="onCompositionStart";break e;case"compositionend":Zs="onCompositionEnd";break e;case"compositionupdate":Zs="onCompositionUpdate";break e}Zs=void 0}else xa?pd(A,w)&&(Zs="onCompositionEnd"):A==="keydown"&&w.keyCode===229&&(Zs="onCompositionStart");Zs&&(md&&w.locale!=="ko"&&(xa||Zs!=="onCompositionStart"?Zs==="onCompositionEnd"&&xa&&(Vs=Sl()):(er=ds,Jr="value"in er?er.value:er.textContent,xa=!0)),qs=LA(Vt,Zs),0<qs.length&&(Zs=new ot(Zs,A,null,w,ds),hs.push({event:Zs,listeners:qs}),Vs?Zs.data=Vs:(Vs=vc(w),Vs!==null&&(Zs.data=Vs)))),(Vs=Su?xd(A,w):gd(A,w))&&(Vt=LA(Vt,"onBeforeInput"),0<Vt.length&&(ds=new ot("onBeforeInput","beforeinput",null,w,ds),hs.push({event:ds,listeners:Vt}),ds.data=Vs))}Fu(hs,p)})}function Lu(A,p,w){return{instance:A,listener:p,currentTarget:w}}function LA(A,p){for(var w=p+"Capture",G=[];A!==null;){var ne=A,de=ne.stateNode;ne.tag===5&&de!==null&&(ne=de,de=ht(A,w),de!=null&&G.unshift(Lu(A,de,ne)),de=ht(A,p),de!=null&&G.push(Lu(A,de,ne))),A=A.return}return G}function Cc(A){if(A===null)return null;do A=A.return;while(A&&A.tag!==5);return A||null}function Wf(A,p,w,G,ne){for(var de=p._reactName,Be=[];w!==null&&w!==G;){var At=w,bt=At.alternate,Vt=At.stateNode;if(bt!==null&&bt===G)break;At.tag===5&&Vt!==null&&(At=Vt,ne?(bt=ht(w,de),bt!=null&&Be.unshift(Lu(w,bt,At))):ne||(bt=ht(w,de),bt!=null&&Be.push(Lu(w,bt,At)))),w=w.return}Be.length!==0&&A.push({event:p,listeners:Be})}var Ag=/\r\n?/g,hg=/\u0000|\uFFFD/g;function Gf(A){return(typeof A=="string"?A:""+A).replace(Ag,`
`).replace(hg,"")}function DA(A,p,w){if(p=Gf(p),Gf(A)!==p&&w)throw Error(r(425))}function Cd(){}var Du=null,Bc=null;function zh(A,p){return A==="textarea"||A==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Yh=typeof setTimeout=="function"?setTimeout:void 0,Kf=typeof clearTimeout=="function"?clearTimeout:void 0,zf=typeof Promise=="function"?Promise:void 0,mg=typeof queueMicrotask=="function"?queueMicrotask:typeof zf<"u"?function(A){return zf.resolve(null).then(A).catch(fg)}:Yh;function fg(A){setTimeout(function(){throw A})}function Xh(A,p){var w=p,G=0;do{var ne=w.nextSibling;if(A.removeChild(w),ne&&ne.nodeType===8)if(w=ne.data,w==="/$"){if(G===0){A.removeChild(ne),ns(p);return}G--}else w!=="$"&&w!=="$?"&&w!=="$!"||G++;w=ne}while(w);ns(p)}function Pn(A){for(;A!=null;A=A.nextSibling){var p=A.nodeType;if(p===1||p===3)break;if(p===8){if(p=A.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return A}function qi(A){A=A.previousSibling;for(var p=0;A;){if(A.nodeType===8){var w=A.data;if(w==="$"||w==="$!"||w==="$?"){if(p===0)return A;p--}else w==="/$"&&p++}A=A.previousSibling}return null}var Xn=Math.random().toString(36).slice(2),Tl="__reactFiber$"+Xn,Bd="__reactProps$"+Xn,yn="__reactContainer$"+Xn,Jn="__reactEvents$"+Xn,pg="__reactListeners$"+Xn,xg="__reactHandles$"+Xn;function Go(A){var p=A[Tl];if(p)return p;for(var w=A.parentNode;w;){if(p=w[yn]||w[Tl]){if(w=p.alternate,p.child!==null||w!==null&&w.child!==null)for(A=qi(A);A!==null;){if(w=A[Tl])return w;A=qi(A)}return p}A=w,w=A.parentNode}return null}function kd(A){return A=A[Tl]||A[yn],!A||A.tag!==5&&A.tag!==6&&A.tag!==13&&A.tag!==3?null:A}function kc(A){if(A.tag===5||A.tag===6)return A.stateNode;throw Error(r(33))}function Pu(A){return A[Bd]||null}var Jh=[],oo=-1;function dl(A){return{current:A}}function Dr(A){0>oo||(A.current=Jh[oo],Jh[oo]=null,oo--)}function Ur(A,p){oo++,Jh[oo]=A.current,A.current=p}var Ko={},An=dl(Ko),Zn=dl(!1),Ec=Ko;function Ed(A,p){var w=A.type.contextTypes;if(!w)return Ko;var G=A.stateNode;if(G&&G.__reactInternalMemoizedUnmaskedChildContext===p)return G.__reactInternalMemoizedMaskedChildContext;var ne={},de;for(de in w)ne[de]=p[de];return G&&(A=A.stateNode,A.__reactInternalMemoizedUnmaskedChildContext=p,A.__reactInternalMemoizedMaskedChildContext=ne),ne}function ei(A){return A=A.childContextTypes,A!=null}function PA(){Dr(Zn),Dr(An)}function Yf(A,p,w){if(An.current!==Ko)throw Error(r(168));Ur(An,p),Ur(Zn,w)}function Zh(A,p,w){var G=A.stateNode;if(p=p.childContextTypes,typeof G.getChildContext!="function")return w;G=G.getChildContext();for(var ne in G)if(!(ne in p))throw Error(r(108,J(A)||"Unknown",ne));return W({},w,G)}function Fc(A){return A=(A=A.stateNode)&&A.__reactInternalMemoizedMergedChildContext||Ko,Ec=An.current,Ur(An,A),Ur(Zn,Zn.current),!0}function Xf(A,p,w){var G=A.stateNode;if(!G)throw Error(r(169));w?(A=Zh(A,p,Ec),G.__reactInternalMemoizedMergedChildContext=A,Dr(Zn),Dr(An),Ur(An,A)):Dr(Zn),Ur(Zn,w)}var co=null,Uu=!1,C=!1;function z(A){co===null?co=[A]:co.push(A)}function ie(A){Uu=!0,z(A)}function ue(){if(!C&&co!==null){C=!0;var A=0,p=xr;try{var w=co;for(xr=1;A<w.length;A++){var G=w[A];do G=G(!0);while(G!==null)}co=null,Uu=!1}catch(ne){throw co!==null&&(co=co.slice(A+1)),Nt(Ls,ue),ne}finally{xr=p,C=!1}}return null}var ve=[],Ce=0,Fe=null,De=0,qe=[],et=0,vt=null,Dt=1,Pt="";function kt(A,p){ve[Ce++]=De,ve[Ce++]=Fe,Fe=A,De=p}function as(A,p,w){qe[et++]=Dt,qe[et++]=Pt,qe[et++]=vt,vt=A;var G=Dt;A=Pt;var ne=32-Ks(G)-1;G&=~(1<<ne),w+=1;var de=32-Ks(p)+ne;if(30<de){var Be=ne-ne%5;de=(G&(1<<Be)-1).toString(32),G>>=Be,ne-=Be,Dt=1<<32-Ks(p)+ne|w<<ne|G,Pt=de+A}else Dt=1<<de|w<<ne|G,Pt=A}function Gt(A){A.return!==null&&(kt(A,1),as(A,1,0))}function yt(A){for(;A===Fe;)Fe=ve[--Ce],ve[Ce]=null,De=ve[--Ce],ve[Ce]=null;for(;A===vt;)vt=qe[--et],qe[et]=null,Pt=qe[--et],qe[et]=null,Dt=qe[--et],qe[et]=null}var jt=null,Xt=null,Yt=!1,es=null;function _s(A,p){var w=Rl(5,null,null,0);w.elementType="DELETED",w.stateNode=p,w.return=A,p=A.deletions,p===null?(A.deletions=[w],A.flags|=16):p.push(w)}function vs(A,p){switch(A.tag){case 5:var w=A.type;return p=p.nodeType!==1||w.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(A.stateNode=p,jt=A,Xt=Pn(p.firstChild),!0):!1;case 6:return p=A.pendingProps===""||p.nodeType!==3?null:p,p!==null?(A.stateNode=p,jt=A,Xt=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(w=vt!==null?{id:Dt,overflow:Pt}:null,A.memoizedState={dehydrated:p,treeContext:w,retryLane:1073741824},w=Rl(18,null,null,0),w.stateNode=p,w.return=A,A.child=w,jt=A,Xt=null,!0):!1;default:return!1}}function Rs(A){return(A.mode&1)!==0&&(A.flags&128)===0}function ys(A){if(Yt){var p=Xt;if(p){var w=p;if(!vs(A,p)){if(Rs(A))throw Error(r(418));p=Pn(w.nextSibling);var G=jt;p&&vs(A,p)?_s(G,w):(A.flags=A.flags&-4097|2,Yt=!1,jt=A)}}else{if(Rs(A))throw Error(r(418));A.flags=A.flags&-4097|2,Yt=!1,jt=A}}}function vr(A){for(A=A.return;A!==null&&A.tag!==5&&A.tag!==3&&A.tag!==13;)A=A.return;jt=A}function br(A){if(A!==jt)return!1;if(!Yt)return vr(A),Yt=!0,!1;var p;if((p=A.tag!==3)&&!(p=A.tag!==5)&&(p=A.type,p=p!=="head"&&p!=="body"&&!zh(A.type,A.memoizedProps)),p&&(p=Xt)){if(Rs(A))throw fr(),Error(r(418));for(;p;)_s(A,p),p=Pn(p.nextSibling)}if(vr(A),A.tag===13){if(A=A.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(r(317));e:{for(A=A.nextSibling,p=0;A;){if(A.nodeType===8){var w=A.data;if(w==="/$"){if(p===0){Xt=Pn(A.nextSibling);break e}p--}else w!=="$"&&w!=="$!"&&w!=="$?"||p++}A=A.nextSibling}Xt=null}}else Xt=jt?Pn(A.stateNode.nextSibling):null;return!0}function fr(){for(var A=Xt;A;)A=Pn(A.nextSibling)}function ar(){Xt=jt=null,Yt=!1}function Pr(A){es===null?es=[A]:es.push(A)}var Rr=S.ReactCurrentBatchConfig;function Xs(A,p,w){if(A=w.ref,A!==null&&typeof A!="function"&&typeof A!="object"){if(w._owner){if(w=w._owner,w){if(w.tag!==1)throw Error(r(309));var G=w.stateNode}if(!G)throw Error(r(147,A));var ne=G,de=""+A;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===de?p.ref:(p=function(Be){var At=ne.refs;Be===null?delete At[de]:At[de]=Be},p._stringRef=de,p)}if(typeof A!="string")throw Error(r(284));if(!w._owner)throw Error(r(290,A))}return A}function la(A,p){throw A=Object.prototype.toString.call(p),Error(r(31,A==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":A))}function Un(A){var p=A._init;return p(A._payload)}function Na(A){function p(Rt,Ct){if(A){var Mt=Rt.deletions;Mt===null?(Rt.deletions=[Ct],Rt.flags|=16):Mt.push(Ct)}}function w(Rt,Ct){if(!A)return null;for(;Ct!==null;)p(Rt,Ct),Ct=Ct.sibling;return null}function G(Rt,Ct){for(Rt=new Map;Ct!==null;)Ct.key!==null?Rt.set(Ct.key,Ct):Rt.set(Ct.index,Ct),Ct=Ct.sibling;return Rt}function ne(Rt,Ct){return Rt=Hd(Rt,Ct),Rt.index=0,Rt.sibling=null,Rt}function de(Rt,Ct,Mt){return Rt.index=Mt,A?(Mt=Rt.alternate,Mt!==null?(Mt=Mt.index,Mt<Ct?(Rt.flags|=2,Ct):Mt):(Rt.flags|=2,Ct)):(Rt.flags|=1048576,Ct)}function Be(Rt){return A&&Rt.alternate===null&&(Rt.flags|=2),Rt}function At(Rt,Ct,Mt,ps){return Ct===null||Ct.tag!==6?(Ct=Wg(Mt,Rt.mode,ps),Ct.return=Rt,Ct):(Ct=ne(Ct,Mt),Ct.return=Rt,Ct)}function bt(Rt,Ct,Mt,ps){var Ds=Mt.type;return Ds===I?ds(Rt,Ct,Mt.props.children,ps,Mt.key):Ct!==null&&(Ct.elementType===Ds||typeof Ds=="object"&&Ds!==null&&Ds.$$typeof===M&&Un(Ds)===Ct.type)?(ps=ne(Ct,Mt.props),ps.ref=Xs(Rt,Ct,Mt),ps.return=Rt,ps):(ps=xp(Mt.type,Mt.key,Mt.props,null,Rt.mode,ps),ps.ref=Xs(Rt,Ct,Mt),ps.return=Rt,ps)}function Vt(Rt,Ct,Mt,ps){return Ct===null||Ct.tag!==4||Ct.stateNode.containerInfo!==Mt.containerInfo||Ct.stateNode.implementation!==Mt.implementation?(Ct=Gg(Mt,Rt.mode,ps),Ct.return=Rt,Ct):(Ct=ne(Ct,Mt.children||[]),Ct.return=Rt,Ct)}function ds(Rt,Ct,Mt,ps,Ds){return Ct===null||Ct.tag!==7?(Ct=$u(Mt,Rt.mode,ps,Ds),Ct.return=Rt,Ct):(Ct=ne(Ct,Mt),Ct.return=Rt,Ct)}function hs(Rt,Ct,Mt){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return Ct=Wg(""+Ct,Rt.mode,Mt),Ct.return=Rt,Ct;if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case k:return Mt=xp(Ct.type,Ct.key,Ct.props,null,Rt.mode,Mt),Mt.ref=Xs(Rt,null,Ct),Mt.return=Rt,Mt;case P:return Ct=Gg(Ct,Rt.mode,Mt),Ct.return=Rt,Ct;case M:var ps=Ct._init;return hs(Rt,ps(Ct._payload),Mt)}if(ke(Ct)||H(Ct))return Ct=$u(Ct,Rt.mode,Mt,null),Ct.return=Rt,Ct;la(Rt,Ct)}return null}function cs(Rt,Ct,Mt,ps){var Ds=Ct!==null?Ct.key:null;if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number")return Ds!==null?null:At(Rt,Ct,""+Mt,ps);if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case k:return Mt.key===Ds?bt(Rt,Ct,Mt,ps):null;case P:return Mt.key===Ds?Vt(Rt,Ct,Mt,ps):null;case M:return Ds=Mt._init,cs(Rt,Ct,Ds(Mt._payload),ps)}if(ke(Mt)||H(Mt))return Ds!==null?null:ds(Rt,Ct,Mt,ps,null);la(Rt,Mt)}return null}function Cs(Rt,Ct,Mt,ps,Ds){if(typeof ps=="string"&&ps!==""||typeof ps=="number")return Rt=Rt.get(Mt)||null,At(Ct,Rt,""+ps,Ds);if(typeof ps=="object"&&ps!==null){switch(ps.$$typeof){case k:return Rt=Rt.get(ps.key===null?Mt:ps.key)||null,bt(Ct,Rt,ps,Ds);case P:return Rt=Rt.get(ps.key===null?Mt:ps.key)||null,Vt(Ct,Rt,ps,Ds);case M:var qs=ps._init;return Cs(Rt,Ct,Mt,qs(ps._payload),Ds)}if(ke(ps)||H(ps))return Rt=Rt.get(Mt)||null,ds(Ct,Rt,ps,Ds,null);la(Ct,ps)}return null}function Es(Rt,Ct,Mt,ps){for(var Ds=null,qs=null,Vs=Ct,Zs=Ct=0,_n=null;Vs!==null&&Zs<Mt.length;Zs++){Vs.index>Zs?(_n=Vs,Vs=null):_n=Vs.sibling;var Fr=cs(Rt,Vs,Mt[Zs],ps);if(Fr===null){Vs===null&&(Vs=_n);break}A&&Vs&&Fr.alternate===null&&p(Rt,Vs),Ct=de(Fr,Ct,Zs),qs===null?Ds=Fr:qs.sibling=Fr,qs=Fr,Vs=_n}if(Zs===Mt.length)return w(Rt,Vs),Yt&&kt(Rt,Zs),Ds;if(Vs===null){for(;Zs<Mt.length;Zs++)Vs=hs(Rt,Mt[Zs],ps),Vs!==null&&(Ct=de(Vs,Ct,Zs),qs===null?Ds=Vs:qs.sibling=Vs,qs=Vs);return Yt&&kt(Rt,Zs),Ds}for(Vs=G(Rt,Vs);Zs<Mt.length;Zs++)_n=Cs(Vs,Rt,Zs,Mt[Zs],ps),_n!==null&&(A&&_n.alternate!==null&&Vs.delete(_n.key===null?Zs:_n.key),Ct=de(_n,Ct,Zs),qs===null?Ds=_n:qs.sibling=_n,qs=_n);return A&&Vs.forEach(function(qd){return p(Rt,qd)}),Yt&&kt(Rt,Zs),Ds}function Ts(Rt,Ct,Mt,ps){var Ds=H(Mt);if(typeof Ds!="function")throw Error(r(150));if(Mt=Ds.call(Mt),Mt==null)throw Error(r(151));for(var qs=Ds=null,Vs=Ct,Zs=Ct=0,_n=null,Fr=Mt.next();Vs!==null&&!Fr.done;Zs++,Fr=Mt.next()){Vs.index>Zs?(_n=Vs,Vs=null):_n=Vs.sibling;var qd=cs(Rt,Vs,Fr.value,ps);if(qd===null){Vs===null&&(Vs=_n);break}A&&Vs&&qd.alternate===null&&p(Rt,Vs),Ct=de(qd,Ct,Zs),qs===null?Ds=qd:qs.sibling=qd,qs=qd,Vs=_n}if(Fr.done)return w(Rt,Vs),Yt&&kt(Rt,Zs),Ds;if(Vs===null){for(;!Fr.done;Zs++,Fr=Mt.next())Fr=hs(Rt,Fr.value,ps),Fr!==null&&(Ct=de(Fr,Ct,Zs),qs===null?Ds=Fr:qs.sibling=Fr,qs=Fr);return Yt&&kt(Rt,Zs),Ds}for(Vs=G(Rt,Vs);!Fr.done;Zs++,Fr=Mt.next())Fr=Cs(Vs,Rt,Zs,Fr.value,ps),Fr!==null&&(A&&Fr.alternate!==null&&Vs.delete(Fr.key===null?Zs:Fr.key),Ct=de(Fr,Ct,Zs),qs===null?Ds=Fr:qs.sibling=Fr,qs=Fr);return A&&Vs.forEach(function(pE){return p(Rt,pE)}),Yt&&kt(Rt,Zs),Ds}function Va(Rt,Ct,Mt,ps){if(typeof Mt=="object"&&Mt!==null&&Mt.type===I&&Mt.key===null&&(Mt=Mt.props.children),typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case k:e:{for(var Ds=Mt.key,qs=Ct;qs!==null;){if(qs.key===Ds){if(Ds=Mt.type,Ds===I){if(qs.tag===7){w(Rt,qs.sibling),Ct=ne(qs,Mt.props.children),Ct.return=Rt,Rt=Ct;break e}}else if(qs.elementType===Ds||typeof Ds=="object"&&Ds!==null&&Ds.$$typeof===M&&Un(Ds)===qs.type){w(Rt,qs.sibling),Ct=ne(qs,Mt.props),Ct.ref=Xs(Rt,qs,Mt),Ct.return=Rt,Rt=Ct;break e}w(Rt,qs);break}else p(Rt,qs);qs=qs.sibling}Mt.type===I?(Ct=$u(Mt.props.children,Rt.mode,ps,Mt.key),Ct.return=Rt,Rt=Ct):(ps=xp(Mt.type,Mt.key,Mt.props,null,Rt.mode,ps),ps.ref=Xs(Rt,Ct,Mt),ps.return=Rt,Rt=ps)}return Be(Rt);case P:e:{for(qs=Mt.key;Ct!==null;){if(Ct.key===qs)if(Ct.tag===4&&Ct.stateNode.containerInfo===Mt.containerInfo&&Ct.stateNode.implementation===Mt.implementation){w(Rt,Ct.sibling),Ct=ne(Ct,Mt.children||[]),Ct.return=Rt,Rt=Ct;break e}else{w(Rt,Ct);break}else p(Rt,Ct);Ct=Ct.sibling}Ct=Gg(Mt,Rt.mode,ps),Ct.return=Rt,Rt=Ct}return Be(Rt);case M:return qs=Mt._init,Va(Rt,Ct,qs(Mt._payload),ps)}if(ke(Mt))return Es(Rt,Ct,Mt,ps);if(H(Mt))return Ts(Rt,Ct,Mt,ps);la(Rt,Mt)}return typeof Mt=="string"&&Mt!==""||typeof Mt=="number"?(Mt=""+Mt,Ct!==null&&Ct.tag===6?(w(Rt,Ct.sibling),Ct=ne(Ct,Mt),Ct.return=Rt,Rt=Ct):(w(Rt,Ct),Ct=Wg(Mt,Rt.mode,ps),Ct.return=Rt,Rt=Ct),Be(Rt)):w(Rt,Ct)}return Va}var Ma=Na(!0),kr=Na(!1),jn=dl(null),Nn=null,oa=null,Ha=null;function hn(){Ha=oa=Nn=null}function ti(A){var p=jn.current;Dr(jn),A._currentValue=p}function Vi(A,p,w){for(;A!==null;){var G=A.alternate;if((A.childLanes&p)!==p?(A.childLanes|=p,G!==null&&(G.childLanes|=p)):G!==null&&(G.childLanes&p)!==p&&(G.childLanes|=p),A===w)break;A=A.return}}function ca(A,p){Nn=A,Ha=oa=null,A=A.dependencies,A!==null&&A.firstContext!==null&&((A.lanes&p)!==0&&(Ki=!0),A.firstContext=null)}function Ia(A){var p=A._currentValue;if(Ha!==A)if(A={context:A,memoizedValue:p,next:null},oa===null){if(Nn===null)throw Error(r(308));oa=A,Nn.dependencies={lanes:0,firstContext:A}}else oa=oa.next=A;return p}var Ci=null;function zo(A){Ci===null?Ci=[A]:Ci.push(A)}function uo(A,p,w,G){var ne=p.interleaved;return ne===null?(w.next=w,zo(p)):(w.next=ne.next,ne.next=w),p.interleaved=w,Er(A,G)}function Er(A,p){A.lanes|=p;var w=A.alternate;for(w!==null&&(w.lanes|=p),w=A,A=A.return;A!==null;)A.childLanes|=p,w=A.alternate,w!==null&&(w.childLanes|=p),w=A,A=A.return;return w.tag===3?w.stateNode:null}var Il=!1;function UA(A){A.updateQueue={baseState:A.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function em(A,p){A=A.updateQueue,p.updateQueue===A&&(p.updateQueue={baseState:A.baseState,firstBaseUpdate:A.firstBaseUpdate,lastBaseUpdate:A.lastBaseUpdate,shared:A.shared,effects:A.effects})}function $i(A,p){return{eventTime:A,lane:p,tag:0,payload:null,callback:null,next:null}}function Wi(A,p,w){var G=A.updateQueue;if(G===null)return null;if(G=G.shared,(_r&2)!==0){var ne=G.pending;return ne===null?p.next=p:(p.next=ne.next,ne.next=p),G.pending=p,Er(A,w)}return ne=G.interleaved,ne===null?(p.next=p,zo(G)):(p.next=ne.next,ne.next=p),G.interleaved=p,Er(A,w)}function Tc(A,p,w){if(p=p.updateQueue,p!==null&&(p=p.shared,(w&4194240)!==0)){var G=p.lanes;G&=A.pendingLanes,w|=G,p.lanes=w,il(A,w)}}function Gi(A,p){var w=A.updateQueue,G=A.alternate;if(G!==null&&(G=G.updateQueue,w===G)){var ne=null,de=null;if(w=w.firstBaseUpdate,w!==null){do{var Be={eventTime:w.eventTime,lane:w.lane,tag:w.tag,payload:w.payload,callback:w.callback,next:null};de===null?ne=de=Be:de=de.next=Be,w=w.next}while(w!==null);de===null?ne=de=p:de=de.next=p}else ne=de=p;w={baseState:G.baseState,firstBaseUpdate:ne,lastBaseUpdate:de,shared:G.shared,effects:G.effects},A.updateQueue=w;return}A=w.lastBaseUpdate,A===null?w.firstBaseUpdate=p:A.next=p,w.lastBaseUpdate=p}function Ao(A,p,w,G){var ne=A.updateQueue;Il=!1;var de=ne.firstBaseUpdate,Be=ne.lastBaseUpdate,At=ne.shared.pending;if(At!==null){ne.shared.pending=null;var bt=At,Vt=bt.next;bt.next=null,Be===null?de=Vt:Be.next=Vt,Be=bt;var ds=A.alternate;ds!==null&&(ds=ds.updateQueue,At=ds.lastBaseUpdate,At!==Be&&(At===null?ds.firstBaseUpdate=Vt:At.next=Vt,ds.lastBaseUpdate=bt))}if(de!==null){var hs=ne.baseState;Be=0,ds=Vt=bt=null,At=de;do{var cs=At.lane,Cs=At.eventTime;if((G&cs)===cs){ds!==null&&(ds=ds.next={eventTime:Cs,lane:0,tag:At.tag,payload:At.payload,callback:At.callback,next:null});e:{var Es=A,Ts=At;switch(cs=p,Cs=w,Ts.tag){case 1:if(Es=Ts.payload,typeof Es=="function"){hs=Es.call(Cs,hs,cs);break e}hs=Es;break e;case 3:Es.flags=Es.flags&-65537|128;case 0:if(Es=Ts.payload,cs=typeof Es=="function"?Es.call(Cs,hs,cs):Es,cs==null)break e;hs=W({},hs,cs);break e;case 2:Il=!0}}At.callback!==null&&At.lane!==0&&(A.flags|=64,cs=ne.effects,cs===null?ne.effects=[At]:cs.push(At))}else Cs={eventTime:Cs,lane:cs,tag:At.tag,payload:At.payload,callback:At.callback,next:null},ds===null?(Vt=ds=Cs,bt=hs):ds=ds.next=Cs,Be|=cs;if(At=At.next,At===null){if(At=ne.shared.pending,At===null)break;cs=At,At=cs.next,cs.next=null,ne.lastBaseUpdate=cs,ne.shared.pending=null}}while(!0);if(ds===null&&(bt=hs),ne.baseState=bt,ne.firstBaseUpdate=Vt,ne.lastBaseUpdate=ds,p=ne.shared.interleaved,p!==null){ne=p;do Be|=ne.lane,ne=ne.next;while(ne!==p)}else de===null&&(ne.shared.lanes=0);Mu|=Be,A.lanes=Be,A.memoizedState=hs}}function Ic(A,p,w){if(A=p.effects,p.effects=null,A!==null)for(p=0;p<A.length;p++){var G=A[p],ne=G.callback;if(ne!==null){if(G.callback=null,G=w,typeof ne!="function")throw Error(r(191,ne));ne.call(G)}}}var Fd={},Bi=dl(Fd),Td=dl(Fd),Yo=dl(Fd);function ho(A){if(A===Fd)throw Error(r(174));return A}function Id(A,p){switch(Ur(Yo,p),Ur(Td,A),Ur(Bi,Fd),A=p.nodeType,A){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:ct(null,"");break;default:A=A===8?p.parentNode:p,p=A.namespaceURI||null,A=A.tagName,p=ct(p,A)}Dr(Bi),Ur(Bi,p)}function Ll(){Dr(Bi),Dr(Td),Dr(Yo)}function Jf(A){ho(Yo.current);var p=ho(Bi.current),w=ct(p,A.type);p!==w&&(Ur(Td,A),Ur(Bi,w))}function tm(A){Td.current===A&&(Dr(Bi),Dr(Td))}var Zr=dl(0);function ul(A){for(var p=A;p!==null;){if(p.tag===13){var w=p.memoizedState;if(w!==null&&(w=w.dehydrated,w===null||w.data==="$?"||w.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===A)break;for(;p.sibling===null;){if(p.return===null||p.return===A)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var sm=[];function rm(){for(var A=0;A<sm.length;A++)sm[A]._workInProgressVersionPrimary=null;sm.length=0}var RA=S.ReactCurrentDispatcher,OA=S.ReactCurrentBatchConfig,Dl=0,ra=null,La=null,wa=null,Ld=!1,mo=!1,Dd=0,gg=0;function qa(){throw Error(r(321))}function QA(A,p){if(p===null)return!1;for(var w=0;w<p.length&&w<A.length;w++)if(!wr(A[w],p[w]))return!1;return!0}function Ru(A,p,w,G,ne,de){if(Dl=de,ra=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,RA.current=A===null||A.memoizedState===null?Hk:qk,A=w(G,ne),mo){de=0;do{if(mo=!1,Dd=0,25<=de)throw Error(r(301));de+=1,wa=La=null,p.updateQueue=null,RA.current=Vk,A=w(G,ne)}while(mo)}if(RA.current=rp,p=La!==null&&La.next!==null,Dl=0,wa=La=ra=null,Ld=!1,p)throw Error(r(300));return A}function Pl(){var A=Dd!==0;return Dd=0,A}function Al(){var A={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wa===null?ra.memoizedState=wa=A:wa=wa.next=A,wa}function ki(){if(La===null){var A=ra.alternate;A=A!==null?A.memoizedState:null}else A=La.next;var p=wa===null?ra.memoizedState:wa.next;if(p!==null)wa=p,La=A;else{if(A===null)throw Error(r(310));La=A,A={memoizedState:La.memoizedState,baseState:La.baseState,baseQueue:La.baseQueue,queue:La.queue,next:null},wa===null?ra.memoizedState=wa=A:wa=wa.next=A}return wa}function Ou(A,p){return typeof p=="function"?p(A):p}function MA(A){var p=ki(),w=p.queue;if(w===null)throw Error(r(311));w.lastRenderedReducer=A;var G=La,ne=G.baseQueue,de=w.pending;if(de!==null){if(ne!==null){var Be=ne.next;ne.next=de.next,de.next=Be}G.baseQueue=ne=de,w.pending=null}if(ne!==null){de=ne.next,G=G.baseState;var At=Be=null,bt=null,Vt=de;do{var ds=Vt.lane;if((Dl&ds)===ds)bt!==null&&(bt=bt.next={lane:0,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null}),G=Vt.hasEagerState?Vt.eagerState:A(G,Vt.action);else{var hs={lane:ds,action:Vt.action,hasEagerState:Vt.hasEagerState,eagerState:Vt.eagerState,next:null};bt===null?(At=bt=hs,Be=G):bt=bt.next=hs,ra.lanes|=ds,Mu|=ds}Vt=Vt.next}while(Vt!==null&&Vt!==de);bt===null?Be=G:bt.next=At,wr(G,p.memoizedState)||(Ki=!0),p.memoizedState=G,p.baseState=Be,p.baseQueue=bt,w.lastRenderedState=G}if(A=w.interleaved,A!==null){ne=A;do de=ne.lane,ra.lanes|=de,Mu|=de,ne=ne.next;while(ne!==A)}else ne===null&&(w.lanes=0);return[p.memoizedState,w.dispatch]}function Xo(A){var p=ki(),w=p.queue;if(w===null)throw Error(r(311));w.lastRenderedReducer=A;var G=w.dispatch,ne=w.pending,de=p.memoizedState;if(ne!==null){w.pending=null;var Be=ne=ne.next;do de=A(de,Be.action),Be=Be.next;while(Be!==ne);wr(de,p.memoizedState)||(Ki=!0),p.memoizedState=de,p.baseQueue===null&&(p.baseState=de),w.lastRenderedState=de}return[de,G]}function Zf(){}function am(A,p){var w=ra,G=ki(),ne=p(),de=!wr(G.memoizedState,ne);if(de&&(G.memoizedState=ne,Ki=!0),G=G.queue,VA(tp.bind(null,w,G,A),[A]),G.getSnapshot!==p||de||wa!==null&&wa.memoizedState.tag&1){if(w.flags|=2048,Ei(9,nm.bind(null,w,G,ne,p),void 0,null),wn===null)throw Error(r(349));(Dl&30)!==0||ep(w,p,ne)}return ne}function ep(A,p,w){A.flags|=16384,A={getSnapshot:p,value:w},p=ra.updateQueue,p===null?(p={lastEffect:null,stores:null},ra.updateQueue=p,p.stores=[A]):(w=p.stores,w===null?p.stores=[A]:w.push(A))}function nm(A,p,w,G){p.value=w,p.getSnapshot=G,Pd(p)&&HA(A)}function tp(A,p,w){return w(function(){Pd(p)&&HA(A)})}function Pd(A){var p=A.getSnapshot;A=A.value;try{var w=p();return!wr(A,w)}catch{return!0}}function HA(A){var p=Er(A,1);p!==null&&vo(p,A,1,-1)}function Qu(A){var p=Al();return typeof A=="function"&&(A=A()),p.memoizedState=p.baseState=A,A={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ou,lastRenderedState:A},p.queue=A,A=A.dispatch=Mk.bind(null,ra,A),[p.memoizedState,A]}function Ei(A,p,w,G){return A={tag:A,create:p,destroy:w,deps:G,next:null},p=ra.updateQueue,p===null?(p={lastEffect:null,stores:null},ra.updateQueue=p,p.lastEffect=A.next=A):(w=p.lastEffect,w===null?p.lastEffect=A.next=A:(G=w.next,w.next=A,A.next=G,p.lastEffect=A)),A}function fo(){return ki().memoizedState}function hl(A,p,w,G){var ne=Al();ra.flags|=A,ne.memoizedState=Ei(1|p,w,void 0,G===void 0?null:G)}function Lc(A,p,w,G){var ne=ki();G=G===void 0?null:G;var de=void 0;if(La!==null){var Be=La.memoizedState;if(de=Be.destroy,G!==null&&QA(G,Be.deps)){ne.memoizedState=Ei(p,w,de,G);return}}ra.flags|=A,ne.memoizedState=Ei(1|p,w,de,G)}function qA(A,p){return hl(8390656,8,A,p)}function VA(A,p){return Lc(2048,8,A,p)}function sp(A,p){return Lc(4,2,A,p)}function $A(A,p){return Lc(4,4,A,p)}function WA(A,p){if(typeof p=="function")return A=A(),p(A),function(){p(null)};if(p!=null)return A=A(),p.current=A,function(){p.current=null}}function K1(A,p,w){return w=w!=null?w.concat([A]):null,Lc(4,4,WA.bind(null,p,A),w)}function vg(){}function z1(A,p){var w=ki();p=p===void 0?null:p;var G=w.memoizedState;return G!==null&&p!==null&&QA(p,G[1])?G[0]:(w.memoizedState=[A,p],A)}function Y1(A,p){var w=ki();p=p===void 0?null:p;var G=w.memoizedState;return G!==null&&p!==null&&QA(p,G[1])?G[0]:(A=A(),w.memoizedState=[A,p],A)}function X1(A,p,w){return(Dl&21)===0?(A.baseState&&(A.baseState=!1,Ki=!0),A.memoizedState=w):(wr(w,p)||(w=ji(),ra.lanes|=w,Mu|=w,A.baseState=!0),p)}function Ok(A,p){var w=xr;xr=w!==0&&4>w?w:4,A(!0);var G=OA.transition;OA.transition={};try{A(!1),p()}finally{xr=w,OA.transition=G}}function J1(){return ki().memoizedState}function Qk(A,p,w){var G=Qd(A);if(w={lane:G,action:w,hasEagerState:!1,eagerState:null,next:null},Z1(A))ej(p,w);else if(w=uo(A,p,w,G),w!==null){var ne=Ti();vo(w,A,G,ne),tj(w,p,G)}}function Mk(A,p,w){var G=Qd(A),ne={lane:G,action:w,hasEagerState:!1,eagerState:null,next:null};if(Z1(A))ej(p,ne);else{var de=A.alternate;if(A.lanes===0&&(de===null||de.lanes===0)&&(de=p.lastRenderedReducer,de!==null))try{var Be=p.lastRenderedState,At=de(Be,w);if(ne.hasEagerState=!0,ne.eagerState=At,wr(At,Be)){var bt=p.interleaved;bt===null?(ne.next=ne,zo(p)):(ne.next=bt.next,bt.next=ne),p.interleaved=ne;return}}catch{}finally{}w=uo(A,p,ne,G),w!==null&&(ne=Ti(),vo(w,A,G,ne),tj(w,p,G))}}function Z1(A){var p=A.alternate;return A===ra||p!==null&&p===ra}function ej(A,p){mo=Ld=!0;var w=A.pending;w===null?p.next=p:(p.next=w.next,w.next=p),A.pending=p}function tj(A,p,w){if((w&4194240)!==0){var G=p.lanes;G&=A.pendingLanes,w|=G,p.lanes=w,il(A,w)}}var rp={readContext:Ia,useCallback:qa,useContext:qa,useEffect:qa,useImperativeHandle:qa,useInsertionEffect:qa,useLayoutEffect:qa,useMemo:qa,useReducer:qa,useRef:qa,useState:qa,useDebugValue:qa,useDeferredValue:qa,useTransition:qa,useMutableSource:qa,useSyncExternalStore:qa,useId:qa,unstable_isNewReconciler:!1},Hk={readContext:Ia,useCallback:function(A,p){return Al().memoizedState=[A,p===void 0?null:p],A},useContext:Ia,useEffect:qA,useImperativeHandle:function(A,p,w){return w=w!=null?w.concat([A]):null,hl(4194308,4,WA.bind(null,p,A),w)},useLayoutEffect:function(A,p){return hl(4194308,4,A,p)},useInsertionEffect:function(A,p){return hl(4,2,A,p)},useMemo:function(A,p){var w=Al();return p=p===void 0?null:p,A=A(),w.memoizedState=[A,p],A},useReducer:function(A,p,w){var G=Al();return p=w!==void 0?w(p):p,G.memoizedState=G.baseState=p,A={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:A,lastRenderedState:p},G.queue=A,A=A.dispatch=Qk.bind(null,ra,A),[G.memoizedState,A]},useRef:function(A){var p=Al();return A={current:A},p.memoizedState=A},useState:Qu,useDebugValue:vg,useDeferredValue:function(A){return Al().memoizedState=A},useTransition:function(){var A=Qu(!1),p=A[0];return A=Ok.bind(null,A[1]),Al().memoizedState=A,[p,A]},useMutableSource:function(){},useSyncExternalStore:function(A,p,w){var G=ra,ne=Al();if(Yt){if(w===void 0)throw Error(r(407));w=w()}else{if(w=p(),wn===null)throw Error(r(349));(Dl&30)!==0||ep(G,p,w)}ne.memoizedState=w;var de={value:w,getSnapshot:p};return ne.queue=de,qA(tp.bind(null,G,de,A),[A]),G.flags|=2048,Ei(9,nm.bind(null,G,de,w,p),void 0,null),w},useId:function(){var A=Al(),p=wn.identifierPrefix;if(Yt){var w=Pt,G=Dt;w=(G&~(1<<32-Ks(G)-1)).toString(32)+w,p=":"+p+"R"+w,w=Dd++,0<w&&(p+="H"+w.toString(32)),p+=":"}else w=gg++,p=":"+p+"r"+w.toString(32)+":";return A.memoizedState=p},unstable_isNewReconciler:!1},qk={readContext:Ia,useCallback:z1,useContext:Ia,useEffect:VA,useImperativeHandle:K1,useInsertionEffect:sp,useLayoutEffect:$A,useMemo:Y1,useReducer:MA,useRef:fo,useState:function(){return MA(Ou)},useDebugValue:vg,useDeferredValue:function(A){var p=ki();return X1(p,La.memoizedState,A)},useTransition:function(){var A=MA(Ou)[0],p=ki().memoizedState;return[A,p]},useMutableSource:Zf,useSyncExternalStore:am,useId:J1,unstable_isNewReconciler:!1},Vk={readContext:Ia,useCallback:z1,useContext:Ia,useEffect:VA,useImperativeHandle:K1,useInsertionEffect:sp,useLayoutEffect:$A,useMemo:Y1,useReducer:Xo,useRef:fo,useState:function(){return Xo(Ou)},useDebugValue:vg,useDeferredValue:function(A){var p=ki();return La===null?p.memoizedState=A:X1(p,La.memoizedState,A)},useTransition:function(){var A=Xo(Ou)[0],p=ki().memoizedState;return[A,p]},useMutableSource:Zf,useSyncExternalStore:am,useId:J1,unstable_isNewReconciler:!1};function po(A,p){if(A&&A.defaultProps){p=W({},p),A=A.defaultProps;for(var w in A)p[w]===void 0&&(p[w]=A[w]);return p}return p}function bg(A,p,w,G){p=A.memoizedState,w=w(G,p),w=w==null?p:W({},p,w),A.memoizedState=w,A.lanes===0&&(A.updateQueue.baseState=w)}var ap={isMounted:function(A){return(A=A._reactInternals)?st(A)===A:!1},enqueueSetState:function(A,p,w){A=A._reactInternals;var G=Ti(),ne=Qd(A),de=$i(G,ne);de.payload=p,w!=null&&(de.callback=w),p=Wi(A,de,ne),p!==null&&(vo(p,A,ne,G),Tc(p,A,ne))},enqueueReplaceState:function(A,p,w){A=A._reactInternals;var G=Ti(),ne=Qd(A),de=$i(G,ne);de.tag=1,de.payload=p,w!=null&&(de.callback=w),p=Wi(A,de,ne),p!==null&&(vo(p,A,ne,G),Tc(p,A,ne))},enqueueForceUpdate:function(A,p){A=A._reactInternals;var w=Ti(),G=Qd(A),ne=$i(w,G);ne.tag=2,p!=null&&(ne.callback=p),p=Wi(A,ne,G),p!==null&&(vo(p,A,G,w),Tc(p,A,G))}};function sj(A,p,w,G,ne,de,Be){return A=A.stateNode,typeof A.shouldComponentUpdate=="function"?A.shouldComponentUpdate(G,de,Be):p.prototype&&p.prototype.isPureReactComponent?!ao(w,G)||!ao(ne,de):!0}function rj(A,p,w){var G=!1,ne=Ko,de=p.contextType;return typeof de=="object"&&de!==null?de=Ia(de):(ne=ei(p)?Ec:An.current,G=p.contextTypes,de=(G=G!=null)?Ed(A,ne):Ko),p=new p(w,de),A.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=ap,A.stateNode=p,p._reactInternals=A,G&&(A=A.stateNode,A.__reactInternalMemoizedUnmaskedChildContext=ne,A.__reactInternalMemoizedMaskedChildContext=de),p}function aj(A,p,w,G){A=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(w,G),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(w,G),p.state!==A&&ap.enqueueReplaceState(p,p.state,null)}function yg(A,p,w,G){var ne=A.stateNode;ne.props=w,ne.state=A.memoizedState,ne.refs={},UA(A);var de=p.contextType;typeof de=="object"&&de!==null?ne.context=Ia(de):(de=ei(p)?Ec:An.current,ne.context=Ed(A,de)),ne.state=A.memoizedState,de=p.getDerivedStateFromProps,typeof de=="function"&&(bg(A,p,de,w),ne.state=A.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof ne.getSnapshotBeforeUpdate=="function"||typeof ne.UNSAFE_componentWillMount!="function"&&typeof ne.componentWillMount!="function"||(p=ne.state,typeof ne.componentWillMount=="function"&&ne.componentWillMount(),typeof ne.UNSAFE_componentWillMount=="function"&&ne.UNSAFE_componentWillMount(),p!==ne.state&&ap.enqueueReplaceState(ne,ne.state,null),Ao(A,w,ne,G),ne.state=A.memoizedState),typeof ne.componentDidMount=="function"&&(A.flags|=4194308)}function GA(A,p){try{var w="",G=p;do w+=L(G),G=G.return;while(G);var ne=w}catch(de){ne=`
Error generating stack: `+de.message+`
`+de.stack}return{value:A,source:p,stack:ne,digest:null}}function jg(A,p,w){return{value:A,source:null,stack:w??null,digest:p??null}}function Ng(A,p){try{console.error(p.value)}catch(w){setTimeout(function(){throw w})}}var $k=typeof WeakMap=="function"?WeakMap:Map;function nj(A,p,w){w=$i(-1,w),w.tag=3,w.payload={element:null};var G=p.value;return w.callback=function(){up||(up=!0,Rg=G),Ng(A,p)},w}function ij(A,p,w){w=$i(-1,w),w.tag=3;var G=A.type.getDerivedStateFromError;if(typeof G=="function"){var ne=p.value;w.payload=function(){return G(ne)},w.callback=function(){Ng(A,p)}}var de=A.stateNode;return de!==null&&typeof de.componentDidCatch=="function"&&(w.callback=function(){Ng(A,p),typeof G!="function"&&(Rd===null?Rd=new Set([this]):Rd.add(this));var Be=p.stack;this.componentDidCatch(p.value,{componentStack:Be!==null?Be:""})}),w}function lj(A,p,w){var G=A.pingCache;if(G===null){G=A.pingCache=new $k;var ne=new Set;G.set(p,ne)}else ne=G.get(p),ne===void 0&&(ne=new Set,G.set(p,ne));ne.has(w)||(ne.add(w),A=nE.bind(null,A,p,w),p.then(A,A))}function oj(A){do{var p;if((p=A.tag===13)&&(p=A.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return A;A=A.return}while(A!==null);return null}function cj(A,p,w,G,ne){return(A.mode&1)===0?(A===p?A.flags|=65536:(A.flags|=128,w.flags|=131072,w.flags&=-52805,w.tag===1&&(w.alternate===null?w.tag=17:(p=$i(-1,1),p.tag=2,Wi(w,p,1))),w.lanes|=1),A):(A.flags|=65536,A.lanes=ne,A)}var Wk=S.ReactCurrentOwner,Ki=!1;function Fi(A,p,w,G){p.child=A===null?kr(p,null,w,G):Ma(p,A.child,w,G)}function dj(A,p,w,G,ne){w=w.render;var de=p.ref;return ca(p,ne),G=Ru(A,p,w,G,de,ne),w=Pl(),A!==null&&!Ki?(p.updateQueue=A.updateQueue,p.flags&=-2053,A.lanes&=~ne,Dc(A,p,ne)):(Yt&&w&&Gt(p),p.flags|=1,Fi(A,p,G,ne),p.child)}function uj(A,p,w,G,ne){if(A===null){var de=w.type;return typeof de=="function"&&!$g(de)&&de.defaultProps===void 0&&w.compare===null&&w.defaultProps===void 0?(p.tag=15,p.type=de,Aj(A,p,de,G,ne)):(A=xp(w.type,null,G,p,p.mode,ne),A.ref=p.ref,A.return=p,p.child=A)}if(de=A.child,(A.lanes&ne)===0){var Be=de.memoizedProps;if(w=w.compare,w=w!==null?w:ao,w(Be,G)&&A.ref===p.ref)return Dc(A,p,ne)}return p.flags|=1,A=Hd(de,G),A.ref=p.ref,A.return=p,p.child=A}function Aj(A,p,w,G,ne){if(A!==null){var de=A.memoizedProps;if(ao(de,G)&&A.ref===p.ref)if(Ki=!1,p.pendingProps=G=de,(A.lanes&ne)!==0)(A.flags&131072)!==0&&(Ki=!0);else return p.lanes=A.lanes,Dc(A,p,ne)}return wg(A,p,w,G,ne)}function hj(A,p,w){var G=p.pendingProps,ne=G.children,de=A!==null?A.memoizedState:null;if(G.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ur(zA,ml),ml|=w;else{if((w&1073741824)===0)return A=de!==null?de.baseLanes|w:w,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:A,cachePool:null,transitions:null},p.updateQueue=null,Ur(zA,ml),ml|=A,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},G=de!==null?de.baseLanes:w,Ur(zA,ml),ml|=G}else de!==null?(G=de.baseLanes|w,p.memoizedState=null):G=w,Ur(zA,ml),ml|=G;return Fi(A,p,ne,w),p.child}function mj(A,p){var w=p.ref;(A===null&&w!==null||A!==null&&A.ref!==w)&&(p.flags|=512,p.flags|=2097152)}function wg(A,p,w,G,ne){var de=ei(w)?Ec:An.current;return de=Ed(p,de),ca(p,ne),w=Ru(A,p,w,G,de,ne),G=Pl(),A!==null&&!Ki?(p.updateQueue=A.updateQueue,p.flags&=-2053,A.lanes&=~ne,Dc(A,p,ne)):(Yt&&G&&Gt(p),p.flags|=1,Fi(A,p,w,ne),p.child)}function fj(A,p,w,G,ne){if(ei(w)){var de=!0;Fc(p)}else de=!1;if(ca(p,ne),p.stateNode===null)ip(A,p),rj(p,w,G),yg(p,w,G,ne),G=!0;else if(A===null){var Be=p.stateNode,At=p.memoizedProps;Be.props=At;var bt=Be.context,Vt=w.contextType;typeof Vt=="object"&&Vt!==null?Vt=Ia(Vt):(Vt=ei(w)?Ec:An.current,Vt=Ed(p,Vt));var ds=w.getDerivedStateFromProps,hs=typeof ds=="function"||typeof Be.getSnapshotBeforeUpdate=="function";hs||typeof Be.UNSAFE_componentWillReceiveProps!="function"&&typeof Be.componentWillReceiveProps!="function"||(At!==G||bt!==Vt)&&aj(p,Be,G,Vt),Il=!1;var cs=p.memoizedState;Be.state=cs,Ao(p,G,Be,ne),bt=p.memoizedState,At!==G||cs!==bt||Zn.current||Il?(typeof ds=="function"&&(bg(p,w,ds,G),bt=p.memoizedState),(At=Il||sj(p,w,At,G,cs,bt,Vt))?(hs||typeof Be.UNSAFE_componentWillMount!="function"&&typeof Be.componentWillMount!="function"||(typeof Be.componentWillMount=="function"&&Be.componentWillMount(),typeof Be.UNSAFE_componentWillMount=="function"&&Be.UNSAFE_componentWillMount()),typeof Be.componentDidMount=="function"&&(p.flags|=4194308)):(typeof Be.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=G,p.memoizedState=bt),Be.props=G,Be.state=bt,Be.context=Vt,G=At):(typeof Be.componentDidMount=="function"&&(p.flags|=4194308),G=!1)}else{Be=p.stateNode,em(A,p),At=p.memoizedProps,Vt=p.type===p.elementType?At:po(p.type,At),Be.props=Vt,hs=p.pendingProps,cs=Be.context,bt=w.contextType,typeof bt=="object"&&bt!==null?bt=Ia(bt):(bt=ei(w)?Ec:An.current,bt=Ed(p,bt));var Cs=w.getDerivedStateFromProps;(ds=typeof Cs=="function"||typeof Be.getSnapshotBeforeUpdate=="function")||typeof Be.UNSAFE_componentWillReceiveProps!="function"&&typeof Be.componentWillReceiveProps!="function"||(At!==hs||cs!==bt)&&aj(p,Be,G,bt),Il=!1,cs=p.memoizedState,Be.state=cs,Ao(p,G,Be,ne);var Es=p.memoizedState;At!==hs||cs!==Es||Zn.current||Il?(typeof Cs=="function"&&(bg(p,w,Cs,G),Es=p.memoizedState),(Vt=Il||sj(p,w,Vt,G,cs,Es,bt)||!1)?(ds||typeof Be.UNSAFE_componentWillUpdate!="function"&&typeof Be.componentWillUpdate!="function"||(typeof Be.componentWillUpdate=="function"&&Be.componentWillUpdate(G,Es,bt),typeof Be.UNSAFE_componentWillUpdate=="function"&&Be.UNSAFE_componentWillUpdate(G,Es,bt)),typeof Be.componentDidUpdate=="function"&&(p.flags|=4),typeof Be.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof Be.componentDidUpdate!="function"||At===A.memoizedProps&&cs===A.memoizedState||(p.flags|=4),typeof Be.getSnapshotBeforeUpdate!="function"||At===A.memoizedProps&&cs===A.memoizedState||(p.flags|=1024),p.memoizedProps=G,p.memoizedState=Es),Be.props=G,Be.state=Es,Be.context=bt,G=Vt):(typeof Be.componentDidUpdate!="function"||At===A.memoizedProps&&cs===A.memoizedState||(p.flags|=4),typeof Be.getSnapshotBeforeUpdate!="function"||At===A.memoizedProps&&cs===A.memoizedState||(p.flags|=1024),G=!1)}return _g(A,p,w,G,de,ne)}function _g(A,p,w,G,ne,de){mj(A,p);var Be=(p.flags&128)!==0;if(!G&&!Be)return ne&&Xf(p,w,!1),Dc(A,p,de);G=p.stateNode,Wk.current=p;var At=Be&&typeof w.getDerivedStateFromError!="function"?null:G.render();return p.flags|=1,A!==null&&Be?(p.child=Ma(p,A.child,null,de),p.child=Ma(p,null,At,de)):Fi(A,p,At,de),p.memoizedState=G.state,ne&&Xf(p,w,!0),p.child}function pj(A){var p=A.stateNode;p.pendingContext?Yf(A,p.pendingContext,p.pendingContext!==p.context):p.context&&Yf(A,p.context,!1),Id(A,p.containerInfo)}function xj(A,p,w,G,ne){return ar(),Pr(ne),p.flags|=256,Fi(A,p,w,G),p.child}var Sg={dehydrated:null,treeContext:null,retryLane:0};function Cg(A){return{baseLanes:A,cachePool:null,transitions:null}}function gj(A,p,w){var G=p.pendingProps,ne=Zr.current,de=!1,Be=(p.flags&128)!==0,At;if((At=Be)||(At=A!==null&&A.memoizedState===null?!1:(ne&2)!==0),At?(de=!0,p.flags&=-129):(A===null||A.memoizedState!==null)&&(ne|=1),Ur(Zr,ne&1),A===null)return ys(p),A=p.memoizedState,A!==null&&(A=A.dehydrated,A!==null)?((p.mode&1)===0?p.lanes=1:A.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(Be=G.children,A=G.fallback,de?(G=p.mode,de=p.child,Be={mode:"hidden",children:Be},(G&1)===0&&de!==null?(de.childLanes=0,de.pendingProps=Be):de=gp(Be,G,0,null),A=$u(A,G,w,null),de.return=p,A.return=p,de.sibling=A,p.child=de,p.child.memoizedState=Cg(w),p.memoizedState=Sg,A):Bg(p,Be));if(ne=A.memoizedState,ne!==null&&(At=ne.dehydrated,At!==null))return Gk(A,p,Be,G,At,ne,w);if(de){de=G.fallback,Be=p.mode,ne=A.child,At=ne.sibling;var bt={mode:"hidden",children:G.children};return(Be&1)===0&&p.child!==ne?(G=p.child,G.childLanes=0,G.pendingProps=bt,p.deletions=null):(G=Hd(ne,bt),G.subtreeFlags=ne.subtreeFlags&14680064),At!==null?de=Hd(At,de):(de=$u(de,Be,w,null),de.flags|=2),de.return=p,G.return=p,G.sibling=de,p.child=G,G=de,de=p.child,Be=A.child.memoizedState,Be=Be===null?Cg(w):{baseLanes:Be.baseLanes|w,cachePool:null,transitions:Be.transitions},de.memoizedState=Be,de.childLanes=A.childLanes&~w,p.memoizedState=Sg,G}return de=A.child,A=de.sibling,G=Hd(de,{mode:"visible",children:G.children}),(p.mode&1)===0&&(G.lanes=w),G.return=p,G.sibling=null,A!==null&&(w=p.deletions,w===null?(p.deletions=[A],p.flags|=16):w.push(A)),p.child=G,p.memoizedState=null,G}function Bg(A,p){return p=gp({mode:"visible",children:p},A.mode,0,null),p.return=A,A.child=p}function np(A,p,w,G){return G!==null&&Pr(G),Ma(p,A.child,null,w),A=Bg(p,p.pendingProps.children),A.flags|=2,p.memoizedState=null,A}function Gk(A,p,w,G,ne,de,Be){if(w)return p.flags&256?(p.flags&=-257,G=jg(Error(r(422))),np(A,p,Be,G)):p.memoizedState!==null?(p.child=A.child,p.flags|=128,null):(de=G.fallback,ne=p.mode,G=gp({mode:"visible",children:G.children},ne,0,null),de=$u(de,ne,Be,null),de.flags|=2,G.return=p,de.return=p,G.sibling=de,p.child=G,(p.mode&1)!==0&&Ma(p,A.child,null,Be),p.child.memoizedState=Cg(Be),p.memoizedState=Sg,de);if((p.mode&1)===0)return np(A,p,Be,null);if(ne.data==="$!"){if(G=ne.nextSibling&&ne.nextSibling.dataset,G)var At=G.dgst;return G=At,de=Error(r(419)),G=jg(de,G,void 0),np(A,p,Be,G)}if(At=(Be&A.childLanes)!==0,Ki||At){if(G=wn,G!==null){switch(Be&-Be){case 4:ne=2;break;case 16:ne=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ne=32;break;case 536870912:ne=268435456;break;default:ne=0}ne=(ne&(G.suspendedLanes|Be))!==0?0:ne,ne!==0&&ne!==de.retryLane&&(de.retryLane=ne,Er(A,ne),vo(G,A,ne,-1))}return Vg(),G=jg(Error(r(421))),np(A,p,Be,G)}return ne.data==="$?"?(p.flags|=128,p.child=A.child,p=iE.bind(null,A),ne._reactRetry=p,null):(A=de.treeContext,Xt=Pn(ne.nextSibling),jt=p,Yt=!0,es=null,A!==null&&(qe[et++]=Dt,qe[et++]=Pt,qe[et++]=vt,Dt=A.id,Pt=A.overflow,vt=p),p=Bg(p,G.children),p.flags|=4096,p)}function vj(A,p,w){A.lanes|=p;var G=A.alternate;G!==null&&(G.lanes|=p),Vi(A.return,p,w)}function kg(A,p,w,G,ne){var de=A.memoizedState;de===null?A.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:G,tail:w,tailMode:ne}:(de.isBackwards=p,de.rendering=null,de.renderingStartTime=0,de.last=G,de.tail=w,de.tailMode=ne)}function bj(A,p,w){var G=p.pendingProps,ne=G.revealOrder,de=G.tail;if(Fi(A,p,G.children,w),G=Zr.current,(G&2)!==0)G=G&1|2,p.flags|=128;else{if(A!==null&&(A.flags&128)!==0)e:for(A=p.child;A!==null;){if(A.tag===13)A.memoizedState!==null&&vj(A,w,p);else if(A.tag===19)vj(A,w,p);else if(A.child!==null){A.child.return=A,A=A.child;continue}if(A===p)break e;for(;A.sibling===null;){if(A.return===null||A.return===p)break e;A=A.return}A.sibling.return=A.return,A=A.sibling}G&=1}if(Ur(Zr,G),(p.mode&1)===0)p.memoizedState=null;else switch(ne){case"forwards":for(w=p.child,ne=null;w!==null;)A=w.alternate,A!==null&&ul(A)===null&&(ne=w),w=w.sibling;w=ne,w===null?(ne=p.child,p.child=null):(ne=w.sibling,w.sibling=null),kg(p,!1,ne,w,de);break;case"backwards":for(w=null,ne=p.child,p.child=null;ne!==null;){if(A=ne.alternate,A!==null&&ul(A)===null){p.child=ne;break}A=ne.sibling,ne.sibling=w,w=ne,ne=A}kg(p,!0,w,null,de);break;case"together":kg(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function ip(A,p){(p.mode&1)===0&&A!==null&&(A.alternate=null,p.alternate=null,p.flags|=2)}function Dc(A,p,w){if(A!==null&&(p.dependencies=A.dependencies),Mu|=p.lanes,(w&p.childLanes)===0)return null;if(A!==null&&p.child!==A.child)throw Error(r(153));if(p.child!==null){for(A=p.child,w=Hd(A,A.pendingProps),p.child=w,w.return=p;A.sibling!==null;)A=A.sibling,w=w.sibling=Hd(A,A.pendingProps),w.return=p;w.sibling=null}return p.child}function Kk(A,p,w){switch(p.tag){case 3:pj(p),ar();break;case 5:Jf(p);break;case 1:ei(p.type)&&Fc(p);break;case 4:Id(p,p.stateNode.containerInfo);break;case 10:var G=p.type._context,ne=p.memoizedProps.value;Ur(jn,G._currentValue),G._currentValue=ne;break;case 13:if(G=p.memoizedState,G!==null)return G.dehydrated!==null?(Ur(Zr,Zr.current&1),p.flags|=128,null):(w&p.child.childLanes)!==0?gj(A,p,w):(Ur(Zr,Zr.current&1),A=Dc(A,p,w),A!==null?A.sibling:null);Ur(Zr,Zr.current&1);break;case 19:if(G=(w&p.childLanes)!==0,(A.flags&128)!==0){if(G)return bj(A,p,w);p.flags|=128}if(ne=p.memoizedState,ne!==null&&(ne.rendering=null,ne.tail=null,ne.lastEffect=null),Ur(Zr,Zr.current),G)break;return null;case 22:case 23:return p.lanes=0,hj(A,p,w)}return Dc(A,p,w)}var yj,Eg,jj,Nj;yj=function(A,p){for(var w=p.child;w!==null;){if(w.tag===5||w.tag===6)A.appendChild(w.stateNode);else if(w.tag!==4&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===p)break;for(;w.sibling===null;){if(w.return===null||w.return===p)return;w=w.return}w.sibling.return=w.return,w=w.sibling}},Eg=function(){},jj=function(A,p,w,G){var ne=A.memoizedProps;if(ne!==G){A=p.stateNode,ho(Bi.current);var de=null;switch(w){case"input":ne=we(A,ne),G=we(A,G),de=[];break;case"select":ne=W({},ne,{value:void 0}),G=W({},G,{value:void 0}),de=[];break;case"textarea":ne=he(A,ne),G=he(A,G),de=[];break;default:typeof ne.onClick!="function"&&typeof G.onClick=="function"&&(A.onclick=Cd)}Ve(w,G);var Be;w=null;for(Vt in ne)if(!G.hasOwnProperty(Vt)&&ne.hasOwnProperty(Vt)&&ne[Vt]!=null)if(Vt==="style"){var At=ne[Vt];for(Be in At)At.hasOwnProperty(Be)&&(w||(w={}),w[Be]="")}else Vt!=="dangerouslySetInnerHTML"&&Vt!=="children"&&Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&Vt!=="autoFocus"&&(n.hasOwnProperty(Vt)?de||(de=[]):(de=de||[]).push(Vt,null));for(Vt in G){var bt=G[Vt];if(At=ne!=null?ne[Vt]:void 0,G.hasOwnProperty(Vt)&&bt!==At&&(bt!=null||At!=null))if(Vt==="style")if(At){for(Be in At)!At.hasOwnProperty(Be)||bt&&bt.hasOwnProperty(Be)||(w||(w={}),w[Be]="");for(Be in bt)bt.hasOwnProperty(Be)&&At[Be]!==bt[Be]&&(w||(w={}),w[Be]=bt[Be])}else w||(de||(de=[]),de.push(Vt,w)),w=bt;else Vt==="dangerouslySetInnerHTML"?(bt=bt?bt.__html:void 0,At=At?At.__html:void 0,bt!=null&&At!==bt&&(de=de||[]).push(Vt,bt)):Vt==="children"?typeof bt!="string"&&typeof bt!="number"||(de=de||[]).push(Vt,""+bt):Vt!=="suppressContentEditableWarning"&&Vt!=="suppressHydrationWarning"&&(n.hasOwnProperty(Vt)?(bt!=null&&Vt==="onScroll"&&qr("scroll",A),de||At===bt||(de=[])):(de=de||[]).push(Vt,bt))}w&&(de=de||[]).push("style",w);var Vt=de;(p.updateQueue=Vt)&&(p.flags|=4)}},Nj=function(A,p,w,G){w!==G&&(p.flags|=4)};function im(A,p){if(!Yt)switch(A.tailMode){case"hidden":p=A.tail;for(var w=null;p!==null;)p.alternate!==null&&(w=p),p=p.sibling;w===null?A.tail=null:w.sibling=null;break;case"collapsed":w=A.tail;for(var G=null;w!==null;)w.alternate!==null&&(G=w),w=w.sibling;G===null?p||A.tail===null?A.tail=null:A.tail.sibling=null:G.sibling=null}}function si(A){var p=A.alternate!==null&&A.alternate.child===A.child,w=0,G=0;if(p)for(var ne=A.child;ne!==null;)w|=ne.lanes|ne.childLanes,G|=ne.subtreeFlags&14680064,G|=ne.flags&14680064,ne.return=A,ne=ne.sibling;else for(ne=A.child;ne!==null;)w|=ne.lanes|ne.childLanes,G|=ne.subtreeFlags,G|=ne.flags,ne.return=A,ne=ne.sibling;return A.subtreeFlags|=G,A.childLanes=w,p}function zk(A,p,w){var G=p.pendingProps;switch(yt(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return si(p),null;case 1:return ei(p.type)&&PA(),si(p),null;case 3:return G=p.stateNode,Ll(),Dr(Zn),Dr(An),rm(),G.pendingContext&&(G.context=G.pendingContext,G.pendingContext=null),(A===null||A.child===null)&&(br(p)?p.flags|=4:A===null||A.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,es!==null&&(Mg(es),es=null))),Eg(A,p),si(p),null;case 5:tm(p);var ne=ho(Yo.current);if(w=p.type,A!==null&&p.stateNode!=null)jj(A,p,w,G,ne),A.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!G){if(p.stateNode===null)throw Error(r(166));return si(p),null}if(A=ho(Bi.current),br(p)){G=p.stateNode,w=p.type;var de=p.memoizedProps;switch(G[Tl]=p,G[Bd]=de,A=(p.mode&1)!==0,w){case"dialog":qr("cancel",G),qr("close",G);break;case"iframe":case"object":case"embed":qr("load",G);break;case"video":case"audio":for(ne=0;ne<Wo.length;ne++)qr(Wo[ne],G);break;case"source":qr("error",G);break;case"img":case"image":case"link":qr("error",G),qr("load",G);break;case"details":qr("toggle",G);break;case"input":ce(G,de),qr("invalid",G);break;case"select":G._wrapperState={wasMultiple:!!de.multiple},qr("invalid",G);break;case"textarea":je(G,de),qr("invalid",G)}Ve(w,de),ne=null;for(var Be in de)if(de.hasOwnProperty(Be)){var At=de[Be];Be==="children"?typeof At=="string"?G.textContent!==At&&(de.suppressHydrationWarning!==!0&&DA(G.textContent,At,A),ne=["children",At]):typeof At=="number"&&G.textContent!==""+At&&(de.suppressHydrationWarning!==!0&&DA(G.textContent,At,A),ne=["children",""+At]):n.hasOwnProperty(Be)&&At!=null&&Be==="onScroll"&&qr("scroll",G)}switch(w){case"input":ee(G),Qe(G,de,!0);break;case"textarea":ee(G),xe(G);break;case"select":case"option":break;default:typeof de.onClick=="function"&&(G.onclick=Cd)}G=ne,p.updateQueue=G,G!==null&&(p.flags|=4)}else{Be=ne.nodeType===9?ne:ne.ownerDocument,A==="http://www.w3.org/1999/xhtml"&&(A=Ue(w)),A==="http://www.w3.org/1999/xhtml"?w==="script"?(A=Be.createElement("div"),A.innerHTML="<script><\/script>",A=A.removeChild(A.firstChild)):typeof G.is=="string"?A=Be.createElement(w,{is:G.is}):(A=Be.createElement(w),w==="select"&&(Be=A,G.multiple?Be.multiple=!0:G.size&&(Be.size=G.size))):A=Be.createElementNS(A,w),A[Tl]=p,A[Bd]=G,yj(A,p,!1,!1),p.stateNode=A;e:{switch(Be=Ze(w,G),w){case"dialog":qr("cancel",A),qr("close",A),ne=G;break;case"iframe":case"object":case"embed":qr("load",A),ne=G;break;case"video":case"audio":for(ne=0;ne<Wo.length;ne++)qr(Wo[ne],A);ne=G;break;case"source":qr("error",A),ne=G;break;case"img":case"image":case"link":qr("error",A),qr("load",A),ne=G;break;case"details":qr("toggle",A),ne=G;break;case"input":ce(A,G),ne=we(A,G),qr("invalid",A);break;case"option":ne=G;break;case"select":A._wrapperState={wasMultiple:!!G.multiple},ne=W({},G,{value:void 0}),qr("invalid",A);break;case"textarea":je(A,G),ne=he(A,G),qr("invalid",A);break;default:ne=G}Ve(w,ne),At=ne;for(de in At)if(At.hasOwnProperty(de)){var bt=At[de];de==="style"?Ke(A,bt):de==="dangerouslySetInnerHTML"?(bt=bt?bt.__html:void 0,bt!=null&&We(A,bt)):de==="children"?typeof bt=="string"?(w!=="textarea"||bt!=="")&&He(A,bt):typeof bt=="number"&&He(A,""+bt):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(n.hasOwnProperty(de)?bt!=null&&de==="onScroll"&&qr("scroll",A):bt!=null&&j(A,de,bt,Be))}switch(w){case"input":ee(A),Qe(A,G,!1);break;case"textarea":ee(A),xe(A);break;case"option":G.value!=null&&A.setAttribute("value",""+ae(G.value));break;case"select":A.multiple=!!G.multiple,de=G.value,de!=null?pe(A,!!G.multiple,de,!1):G.defaultValue!=null&&pe(A,!!G.multiple,G.defaultValue,!0);break;default:typeof ne.onClick=="function"&&(A.onclick=Cd)}switch(w){case"button":case"input":case"select":case"textarea":G=!!G.autoFocus;break e;case"img":G=!0;break e;default:G=!1}}G&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return si(p),null;case 6:if(A&&p.stateNode!=null)Nj(A,p,A.memoizedProps,G);else{if(typeof G!="string"&&p.stateNode===null)throw Error(r(166));if(w=ho(Yo.current),ho(Bi.current),br(p)){if(G=p.stateNode,w=p.memoizedProps,G[Tl]=p,(de=G.nodeValue!==w)&&(A=jt,A!==null))switch(A.tag){case 3:DA(G.nodeValue,w,(A.mode&1)!==0);break;case 5:A.memoizedProps.suppressHydrationWarning!==!0&&DA(G.nodeValue,w,(A.mode&1)!==0)}de&&(p.flags|=4)}else G=(w.nodeType===9?w:w.ownerDocument).createTextNode(G),G[Tl]=p,p.stateNode=G}return si(p),null;case 13:if(Dr(Zr),G=p.memoizedState,A===null||A.memoizedState!==null&&A.memoizedState.dehydrated!==null){if(Yt&&Xt!==null&&(p.mode&1)!==0&&(p.flags&128)===0)fr(),ar(),p.flags|=98560,de=!1;else if(de=br(p),G!==null&&G.dehydrated!==null){if(A===null){if(!de)throw Error(r(318));if(de=p.memoizedState,de=de!==null?de.dehydrated:null,!de)throw Error(r(317));de[Tl]=p}else ar(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;si(p),de=!1}else es!==null&&(Mg(es),es=null),de=!0;if(!de)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=w,p):(G=G!==null,G!==(A!==null&&A.memoizedState!==null)&&G&&(p.child.flags|=8192,(p.mode&1)!==0&&(A===null||(Zr.current&1)!==0?mn===0&&(mn=3):Vg())),p.updateQueue!==null&&(p.flags|=4),si(p),null);case 4:return Ll(),Eg(A,p),A===null&&Sc(p.stateNode.containerInfo),si(p),null;case 10:return ti(p.type._context),si(p),null;case 17:return ei(p.type)&&PA(),si(p),null;case 19:if(Dr(Zr),de=p.memoizedState,de===null)return si(p),null;if(G=(p.flags&128)!==0,Be=de.rendering,Be===null)if(G)im(de,!1);else{if(mn!==0||A!==null&&(A.flags&128)!==0)for(A=p.child;A!==null;){if(Be=ul(A),Be!==null){for(p.flags|=128,im(de,!1),G=Be.updateQueue,G!==null&&(p.updateQueue=G,p.flags|=4),p.subtreeFlags=0,G=w,w=p.child;w!==null;)de=w,A=G,de.flags&=14680066,Be=de.alternate,Be===null?(de.childLanes=0,de.lanes=A,de.child=null,de.subtreeFlags=0,de.memoizedProps=null,de.memoizedState=null,de.updateQueue=null,de.dependencies=null,de.stateNode=null):(de.childLanes=Be.childLanes,de.lanes=Be.lanes,de.child=Be.child,de.subtreeFlags=0,de.deletions=null,de.memoizedProps=Be.memoizedProps,de.memoizedState=Be.memoizedState,de.updateQueue=Be.updateQueue,de.type=Be.type,A=Be.dependencies,de.dependencies=A===null?null:{lanes:A.lanes,firstContext:A.firstContext}),w=w.sibling;return Ur(Zr,Zr.current&1|2),p.child}A=A.sibling}de.tail!==null&&Ot()>YA&&(p.flags|=128,G=!0,im(de,!1),p.lanes=4194304)}else{if(!G)if(A=ul(Be),A!==null){if(p.flags|=128,G=!0,w=A.updateQueue,w!==null&&(p.updateQueue=w,p.flags|=4),im(de,!0),de.tail===null&&de.tailMode==="hidden"&&!Be.alternate&&!Yt)return si(p),null}else 2*Ot()-de.renderingStartTime>YA&&w!==1073741824&&(p.flags|=128,G=!0,im(de,!1),p.lanes=4194304);de.isBackwards?(Be.sibling=p.child,p.child=Be):(w=de.last,w!==null?w.sibling=Be:p.child=Be,de.last=Be)}return de.tail!==null?(p=de.tail,de.rendering=p,de.tail=p.sibling,de.renderingStartTime=Ot(),p.sibling=null,w=Zr.current,Ur(Zr,G?w&1|2:w&1),p):(si(p),null);case 22:case 23:return qg(),G=p.memoizedState!==null,A!==null&&A.memoizedState!==null!==G&&(p.flags|=8192),G&&(p.mode&1)!==0?(ml&1073741824)!==0&&(si(p),p.subtreeFlags&6&&(p.flags|=8192)):si(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function Yk(A,p){switch(yt(p),p.tag){case 1:return ei(p.type)&&PA(),A=p.flags,A&65536?(p.flags=A&-65537|128,p):null;case 3:return Ll(),Dr(Zn),Dr(An),rm(),A=p.flags,(A&65536)!==0&&(A&128)===0?(p.flags=A&-65537|128,p):null;case 5:return tm(p),null;case 13:if(Dr(Zr),A=p.memoizedState,A!==null&&A.dehydrated!==null){if(p.alternate===null)throw Error(r(340));ar()}return A=p.flags,A&65536?(p.flags=A&-65537|128,p):null;case 19:return Dr(Zr),null;case 4:return Ll(),null;case 10:return ti(p.type._context),null;case 22:case 23:return qg(),null;case 24:return null;default:return null}}var lp=!1,ri=!1,Xk=typeof WeakSet=="function"?WeakSet:Set,ks=null;function KA(A,p){var w=A.ref;if(w!==null)if(typeof w=="function")try{w(null)}catch(G){Da(A,p,G)}else w.current=null}function Fg(A,p,w){try{w()}catch(G){Da(A,p,G)}}var wj=!1;function Jk(A,p){if(Du=bs,A=Bu(),jc(A)){if("selectionStart"in A)var w={start:A.selectionStart,end:A.selectionEnd};else e:{w=(w=A.ownerDocument)&&w.defaultView||window;var G=w.getSelection&&w.getSelection();if(G&&G.rangeCount!==0){w=G.anchorNode;var ne=G.anchorOffset,de=G.focusNode;G=G.focusOffset;try{w.nodeType,de.nodeType}catch{w=null;break e}var Be=0,At=-1,bt=-1,Vt=0,ds=0,hs=A,cs=null;t:for(;;){for(var Cs;hs!==w||ne!==0&&hs.nodeType!==3||(At=Be+ne),hs!==de||G!==0&&hs.nodeType!==3||(bt=Be+G),hs.nodeType===3&&(Be+=hs.nodeValue.length),(Cs=hs.firstChild)!==null;)cs=hs,hs=Cs;for(;;){if(hs===A)break t;if(cs===w&&++Vt===ne&&(At=Be),cs===de&&++ds===G&&(bt=Be),(Cs=hs.nextSibling)!==null)break;hs=cs,cs=hs.parentNode}hs=Cs}w=At===-1||bt===-1?null:{start:At,end:bt}}else w=null}w=w||{start:0,end:0}}else w=null;for(Bc={focusedElem:A,selectionRange:w},bs=!1,ks=p;ks!==null;)if(p=ks,A=p.child,(p.subtreeFlags&1028)!==0&&A!==null)A.return=p,ks=A;else for(;ks!==null;){p=ks;try{var Es=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Es!==null){var Ts=Es.memoizedProps,Va=Es.memoizedState,Rt=p.stateNode,Ct=Rt.getSnapshotBeforeUpdate(p.elementType===p.type?Ts:po(p.type,Ts),Va);Rt.__reactInternalSnapshotBeforeUpdate=Ct}break;case 3:var Mt=p.stateNode.containerInfo;Mt.nodeType===1?Mt.textContent="":Mt.nodeType===9&&Mt.documentElement&&Mt.removeChild(Mt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ps){Da(p,p.return,ps)}if(A=p.sibling,A!==null){A.return=p.return,ks=A;break}ks=p.return}return Es=wj,wj=!1,Es}function lm(A,p,w){var G=p.updateQueue;if(G=G!==null?G.lastEffect:null,G!==null){var ne=G=G.next;do{if((ne.tag&A)===A){var de=ne.destroy;ne.destroy=void 0,de!==void 0&&Fg(p,w,de)}ne=ne.next}while(ne!==G)}}function op(A,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var w=p=p.next;do{if((w.tag&A)===A){var G=w.create;w.destroy=G()}w=w.next}while(w!==p)}}function Tg(A){var p=A.ref;if(p!==null){var w=A.stateNode;switch(A.tag){case 5:A=w;break;default:A=w}typeof p=="function"?p(A):p.current=A}}function _j(A){var p=A.alternate;p!==null&&(A.alternate=null,_j(p)),A.child=null,A.deletions=null,A.sibling=null,A.tag===5&&(p=A.stateNode,p!==null&&(delete p[Tl],delete p[Bd],delete p[Jn],delete p[pg],delete p[xg])),A.stateNode=null,A.return=null,A.dependencies=null,A.memoizedProps=null,A.memoizedState=null,A.pendingProps=null,A.stateNode=null,A.updateQueue=null}function Sj(A){return A.tag===5||A.tag===3||A.tag===4}function Cj(A){e:for(;;){for(;A.sibling===null;){if(A.return===null||Sj(A.return))return null;A=A.return}for(A.sibling.return=A.return,A=A.sibling;A.tag!==5&&A.tag!==6&&A.tag!==18;){if(A.flags&2||A.child===null||A.tag===4)continue e;A.child.return=A,A=A.child}if(!(A.flags&2))return A.stateNode}}function Ig(A,p,w){var G=A.tag;if(G===5||G===6)A=A.stateNode,p?w.nodeType===8?w.parentNode.insertBefore(A,p):w.insertBefore(A,p):(w.nodeType===8?(p=w.parentNode,p.insertBefore(A,w)):(p=w,p.appendChild(A)),w=w._reactRootContainer,w!=null||p.onclick!==null||(p.onclick=Cd));else if(G!==4&&(A=A.child,A!==null))for(Ig(A,p,w),A=A.sibling;A!==null;)Ig(A,p,w),A=A.sibling}function Lg(A,p,w){var G=A.tag;if(G===5||G===6)A=A.stateNode,p?w.insertBefore(A,p):w.appendChild(A);else if(G!==4&&(A=A.child,A!==null))for(Lg(A,p,w),A=A.sibling;A!==null;)Lg(A,p,w),A=A.sibling}var Rn=null,xo=!1;function Ud(A,p,w){for(w=w.child;w!==null;)Bj(A,p,w),w=w.sibling}function Bj(A,p,w){if(cr&&typeof cr.onCommitFiberUnmount=="function")try{cr.onCommitFiberUnmount(yr,w)}catch{}switch(w.tag){case 5:ri||KA(w,p);case 6:var G=Rn,ne=xo;Rn=null,Ud(A,p,w),Rn=G,xo=ne,Rn!==null&&(xo?(A=Rn,w=w.stateNode,A.nodeType===8?A.parentNode.removeChild(w):A.removeChild(w)):Rn.removeChild(w.stateNode));break;case 18:Rn!==null&&(xo?(A=Rn,w=w.stateNode,A.nodeType===8?Xh(A.parentNode,w):A.nodeType===1&&Xh(A,w),ns(A)):Xh(Rn,w.stateNode));break;case 4:G=Rn,ne=xo,Rn=w.stateNode.containerInfo,xo=!0,Ud(A,p,w),Rn=G,xo=ne;break;case 0:case 11:case 14:case 15:if(!ri&&(G=w.updateQueue,G!==null&&(G=G.lastEffect,G!==null))){ne=G=G.next;do{var de=ne,Be=de.destroy;de=de.tag,Be!==void 0&&((de&2)!==0||(de&4)!==0)&&Fg(w,p,Be),ne=ne.next}while(ne!==G)}Ud(A,p,w);break;case 1:if(!ri&&(KA(w,p),G=w.stateNode,typeof G.componentWillUnmount=="function"))try{G.props=w.memoizedProps,G.state=w.memoizedState,G.componentWillUnmount()}catch(At){Da(w,p,At)}Ud(A,p,w);break;case 21:Ud(A,p,w);break;case 22:w.mode&1?(ri=(G=ri)||w.memoizedState!==null,Ud(A,p,w),ri=G):Ud(A,p,w);break;default:Ud(A,p,w)}}function kj(A){var p=A.updateQueue;if(p!==null){A.updateQueue=null;var w=A.stateNode;w===null&&(w=A.stateNode=new Xk),p.forEach(function(G){var ne=lE.bind(null,A,G);w.has(G)||(w.add(G),G.then(ne,ne))})}}function go(A,p){var w=p.deletions;if(w!==null)for(var G=0;G<w.length;G++){var ne=w[G];try{var de=A,Be=p,At=Be;e:for(;At!==null;){switch(At.tag){case 5:Rn=At.stateNode,xo=!1;break e;case 3:Rn=At.stateNode.containerInfo,xo=!0;break e;case 4:Rn=At.stateNode.containerInfo,xo=!0;break e}At=At.return}if(Rn===null)throw Error(r(160));Bj(de,Be,ne),Rn=null,xo=!1;var bt=ne.alternate;bt!==null&&(bt.return=null),ne.return=null}catch(Vt){Da(ne,p,Vt)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)Ej(p,A),p=p.sibling}function Ej(A,p){var w=A.alternate,G=A.flags;switch(A.tag){case 0:case 11:case 14:case 15:if(go(p,A),Jo(A),G&4){try{lm(3,A,A.return),op(3,A)}catch(Ts){Da(A,A.return,Ts)}try{lm(5,A,A.return)}catch(Ts){Da(A,A.return,Ts)}}break;case 1:go(p,A),Jo(A),G&512&&w!==null&&KA(w,w.return);break;case 5:if(go(p,A),Jo(A),G&512&&w!==null&&KA(w,w.return),A.flags&32){var ne=A.stateNode;try{He(ne,"")}catch(Ts){Da(A,A.return,Ts)}}if(G&4&&(ne=A.stateNode,ne!=null)){var de=A.memoizedProps,Be=w!==null?w.memoizedProps:de,At=A.type,bt=A.updateQueue;if(A.updateQueue=null,bt!==null)try{At==="input"&&de.type==="radio"&&de.name!=null&&le(ne,de),Ze(At,Be);var Vt=Ze(At,de);for(Be=0;Be<bt.length;Be+=2){var ds=bt[Be],hs=bt[Be+1];ds==="style"?Ke(ne,hs):ds==="dangerouslySetInnerHTML"?We(ne,hs):ds==="children"?He(ne,hs):j(ne,ds,hs,Vt)}switch(At){case"input":_e(ne,de);break;case"textarea":me(ne,de);break;case"select":var cs=ne._wrapperState.wasMultiple;ne._wrapperState.wasMultiple=!!de.multiple;var Cs=de.value;Cs!=null?pe(ne,!!de.multiple,Cs,!1):cs!==!!de.multiple&&(de.defaultValue!=null?pe(ne,!!de.multiple,de.defaultValue,!0):pe(ne,!!de.multiple,de.multiple?[]:"",!1))}ne[Bd]=de}catch(Ts){Da(A,A.return,Ts)}}break;case 6:if(go(p,A),Jo(A),G&4){if(A.stateNode===null)throw Error(r(162));ne=A.stateNode,de=A.memoizedProps;try{ne.nodeValue=de}catch(Ts){Da(A,A.return,Ts)}}break;case 3:if(go(p,A),Jo(A),G&4&&w!==null&&w.memoizedState.isDehydrated)try{ns(p.containerInfo)}catch(Ts){Da(A,A.return,Ts)}break;case 4:go(p,A),Jo(A);break;case 13:go(p,A),Jo(A),ne=A.child,ne.flags&8192&&(de=ne.memoizedState!==null,ne.stateNode.isHidden=de,!de||ne.alternate!==null&&ne.alternate.memoizedState!==null||(Ug=Ot())),G&4&&kj(A);break;case 22:if(ds=w!==null&&w.memoizedState!==null,A.mode&1?(ri=(Vt=ri)||ds,go(p,A),ri=Vt):go(p,A),Jo(A),G&8192){if(Vt=A.memoizedState!==null,(A.stateNode.isHidden=Vt)&&!ds&&(A.mode&1)!==0)for(ks=A,ds=A.child;ds!==null;){for(hs=ks=ds;ks!==null;){switch(cs=ks,Cs=cs.child,cs.tag){case 0:case 11:case 14:case 15:lm(4,cs,cs.return);break;case 1:KA(cs,cs.return);var Es=cs.stateNode;if(typeof Es.componentWillUnmount=="function"){G=cs,w=cs.return;try{p=G,Es.props=p.memoizedProps,Es.state=p.memoizedState,Es.componentWillUnmount()}catch(Ts){Da(G,w,Ts)}}break;case 5:KA(cs,cs.return);break;case 22:if(cs.memoizedState!==null){Ij(hs);continue}}Cs!==null?(Cs.return=cs,ks=Cs):Ij(hs)}ds=ds.sibling}e:for(ds=null,hs=A;;){if(hs.tag===5){if(ds===null){ds=hs;try{ne=hs.stateNode,Vt?(de=ne.style,typeof de.setProperty=="function"?de.setProperty("display","none","important"):de.display="none"):(At=hs.stateNode,bt=hs.memoizedProps.style,Be=bt!=null&&bt.hasOwnProperty("display")?bt.display:null,At.style.display=Te("display",Be))}catch(Ts){Da(A,A.return,Ts)}}}else if(hs.tag===6){if(ds===null)try{hs.stateNode.nodeValue=Vt?"":hs.memoizedProps}catch(Ts){Da(A,A.return,Ts)}}else if((hs.tag!==22&&hs.tag!==23||hs.memoizedState===null||hs===A)&&hs.child!==null){hs.child.return=hs,hs=hs.child;continue}if(hs===A)break e;for(;hs.sibling===null;){if(hs.return===null||hs.return===A)break e;ds===hs&&(ds=null),hs=hs.return}ds===hs&&(ds=null),hs.sibling.return=hs.return,hs=hs.sibling}}break;case 19:go(p,A),Jo(A),G&4&&kj(A);break;case 21:break;default:go(p,A),Jo(A)}}function Jo(A){var p=A.flags;if(p&2){try{e:{for(var w=A.return;w!==null;){if(Sj(w)){var G=w;break e}w=w.return}throw Error(r(160))}switch(G.tag){case 5:var ne=G.stateNode;G.flags&32&&(He(ne,""),G.flags&=-33);var de=Cj(A);Lg(A,de,ne);break;case 3:case 4:var Be=G.stateNode.containerInfo,At=Cj(A);Ig(A,At,Be);break;default:throw Error(r(161))}}catch(bt){Da(A,A.return,bt)}A.flags&=-3}p&4096&&(A.flags&=-4097)}function Zk(A,p,w){ks=A,Fj(A)}function Fj(A,p,w){for(var G=(A.mode&1)!==0;ks!==null;){var ne=ks,de=ne.child;if(ne.tag===22&&G){var Be=ne.memoizedState!==null||lp;if(!Be){var At=ne.alternate,bt=At!==null&&At.memoizedState!==null||ri;At=lp;var Vt=ri;if(lp=Be,(ri=bt)&&!Vt)for(ks=ne;ks!==null;)Be=ks,bt=Be.child,Be.tag===22&&Be.memoizedState!==null?Lj(ne):bt!==null?(bt.return=Be,ks=bt):Lj(ne);for(;de!==null;)ks=de,Fj(de),de=de.sibling;ks=ne,lp=At,ri=Vt}Tj(A)}else(ne.subtreeFlags&8772)!==0&&de!==null?(de.return=ne,ks=de):Tj(A)}}function Tj(A){for(;ks!==null;){var p=ks;if((p.flags&8772)!==0){var w=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:ri||op(5,p);break;case 1:var G=p.stateNode;if(p.flags&4&&!ri)if(w===null)G.componentDidMount();else{var ne=p.elementType===p.type?w.memoizedProps:po(p.type,w.memoizedProps);G.componentDidUpdate(ne,w.memoizedState,G.__reactInternalSnapshotBeforeUpdate)}var de=p.updateQueue;de!==null&&Ic(p,de,G);break;case 3:var Be=p.updateQueue;if(Be!==null){if(w=null,p.child!==null)switch(p.child.tag){case 5:w=p.child.stateNode;break;case 1:w=p.child.stateNode}Ic(p,Be,w)}break;case 5:var At=p.stateNode;if(w===null&&p.flags&4){w=At;var bt=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":bt.autoFocus&&w.focus();break;case"img":bt.src&&(w.src=bt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Vt=p.alternate;if(Vt!==null){var ds=Vt.memoizedState;if(ds!==null){var hs=ds.dehydrated;hs!==null&&ns(hs)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}ri||p.flags&512&&Tg(p)}catch(cs){Da(p,p.return,cs)}}if(p===A){ks=null;break}if(w=p.sibling,w!==null){w.return=p.return,ks=w;break}ks=p.return}}function Ij(A){for(;ks!==null;){var p=ks;if(p===A){ks=null;break}var w=p.sibling;if(w!==null){w.return=p.return,ks=w;break}ks=p.return}}function Lj(A){for(;ks!==null;){var p=ks;try{switch(p.tag){case 0:case 11:case 15:var w=p.return;try{op(4,p)}catch(bt){Da(p,w,bt)}break;case 1:var G=p.stateNode;if(typeof G.componentDidMount=="function"){var ne=p.return;try{G.componentDidMount()}catch(bt){Da(p,ne,bt)}}var de=p.return;try{Tg(p)}catch(bt){Da(p,de,bt)}break;case 5:var Be=p.return;try{Tg(p)}catch(bt){Da(p,Be,bt)}}}catch(bt){Da(p,p.return,bt)}if(p===A){ks=null;break}var At=p.sibling;if(At!==null){At.return=p.return,ks=At;break}ks=p.return}}var eE=Math.ceil,cp=S.ReactCurrentDispatcher,Dg=S.ReactCurrentOwner,Ul=S.ReactCurrentBatchConfig,_r=0,wn=null,sn=null,On=0,ml=0,zA=dl(0),mn=0,om=null,Mu=0,dp=0,Pg=0,cm=null,zi=null,Ug=0,YA=1/0,Pc=null,up=!1,Rg=null,Rd=null,Ap=!1,Od=null,hp=0,dm=0,Og=null,mp=-1,fp=0;function Ti(){return(_r&6)!==0?Ot():mp!==-1?mp:mp=Ot()}function Qd(A){return(A.mode&1)===0?1:(_r&2)!==0&&On!==0?On&-On:Rr.transition!==null?(fp===0&&(fp=ji()),fp):(A=xr,A!==0||(A=window.event,A=A===void 0?16:fa(A.type)),A)}function vo(A,p,w,G){if(50<dm)throw dm=0,Og=null,Error(r(185));Kn(A,w,G),((_r&2)===0||A!==wn)&&(A===wn&&((_r&2)===0&&(dp|=w),mn===4&&Md(A,On)),Yi(A,G),w===1&&_r===0&&(p.mode&1)===0&&(YA=Ot()+500,Uu&&ue()))}function Yi(A,p){var w=A.callbackNode;Qr(A,p);var G=en(A,A===wn?On:0);if(G===0)w!==null&&Et(w),A.callbackNode=null,A.callbackPriority=0;else if(p=G&-G,A.callbackPriority!==p){if(w!=null&&Et(w),p===1)A.tag===0?ie(Pj.bind(null,A)):z(Pj.bind(null,A)),mg(function(){(_r&6)===0&&ue()}),w=null;else{switch(Nr(G)){case 1:w=Ls;break;case 4:w=Is;break;case 16:w=Hs;break;case 536870912:w=ya;break;default:w=Hs}w=Vj(w,Dj.bind(null,A))}A.callbackPriority=p,A.callbackNode=w}}function Dj(A,p){if(mp=-1,fp=0,(_r&6)!==0)throw Error(r(327));var w=A.callbackNode;if(XA()&&A.callbackNode!==w)return null;var G=en(A,A===wn?On:0);if(G===0)return null;if((G&30)!==0||(G&A.expiredLanes)!==0||p)p=pp(A,G);else{p=G;var ne=_r;_r|=2;var de=Rj();(wn!==A||On!==p)&&(Pc=null,YA=Ot()+500,qu(A,p));do try{rE();break}catch(At){Uj(A,At)}while(!0);hn(),cp.current=de,_r=ne,sn!==null?p=0:(wn=null,On=0,p=mn)}if(p!==0){if(p===2&&(ne=Fn(A),ne!==0&&(G=ne,p=Qg(A,ne))),p===1)throw w=om,qu(A,0),Md(A,G),Yi(A,Ot()),w;if(p===6)Md(A,G);else{if(ne=A.current.alternate,(G&30)===0&&!tE(ne)&&(p=pp(A,G),p===2&&(de=Fn(A),de!==0&&(G=de,p=Qg(A,de))),p===1))throw w=om,qu(A,0),Md(A,G),Yi(A,Ot()),w;switch(A.finishedWork=ne,A.finishedLanes=G,p){case 0:case 1:throw Error(r(345));case 2:Vu(A,zi,Pc);break;case 3:if(Md(A,G),(G&130023424)===G&&(p=Ug+500-Ot(),10<p)){if(en(A,0)!==0)break;if(ne=A.suspendedLanes,(ne&G)!==G){Ti(),A.pingedLanes|=A.suspendedLanes&ne;break}A.timeoutHandle=Yh(Vu.bind(null,A,zi,Pc),p);break}Vu(A,zi,Pc);break;case 4:if(Md(A,G),(G&4194240)===G)break;for(p=A.eventTimes,ne=-1;0<G;){var Be=31-Ks(G);de=1<<Be,Be=p[Be],Be>ne&&(ne=Be),G&=~de}if(G=ne,G=Ot()-G,G=(120>G?120:480>G?480:1080>G?1080:1920>G?1920:3e3>G?3e3:4320>G?4320:1960*eE(G/1960))-G,10<G){A.timeoutHandle=Yh(Vu.bind(null,A,zi,Pc),G);break}Vu(A,zi,Pc);break;case 5:Vu(A,zi,Pc);break;default:throw Error(r(329))}}}return Yi(A,Ot()),A.callbackNode===w?Dj.bind(null,A):null}function Qg(A,p){var w=cm;return A.current.memoizedState.isDehydrated&&(qu(A,p).flags|=256),A=pp(A,p),A!==2&&(p=zi,zi=w,p!==null&&Mg(p)),A}function Mg(A){zi===null?zi=A:zi.push.apply(zi,A)}function tE(A){for(var p=A;;){if(p.flags&16384){var w=p.updateQueue;if(w!==null&&(w=w.stores,w!==null))for(var G=0;G<w.length;G++){var ne=w[G],de=ne.getSnapshot;ne=ne.value;try{if(!wr(de(),ne))return!1}catch{return!1}}}if(w=p.child,p.subtreeFlags&16384&&w!==null)w.return=p,p=w;else{if(p===A)break;for(;p.sibling===null;){if(p.return===null||p.return===A)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Md(A,p){for(p&=~Pg,p&=~dp,A.suspendedLanes|=p,A.pingedLanes&=~p,A=A.expirationTimes;0<p;){var w=31-Ks(p),G=1<<w;A[w]=-1,p&=~G}}function Pj(A){if((_r&6)!==0)throw Error(r(327));XA();var p=en(A,0);if((p&1)===0)return Yi(A,Ot()),null;var w=pp(A,p);if(A.tag!==0&&w===2){var G=Fn(A);G!==0&&(p=G,w=Qg(A,G))}if(w===1)throw w=om,qu(A,0),Md(A,p),Yi(A,Ot()),w;if(w===6)throw Error(r(345));return A.finishedWork=A.current.alternate,A.finishedLanes=p,Vu(A,zi,Pc),Yi(A,Ot()),null}function Hg(A,p){var w=_r;_r|=1;try{return A(p)}finally{_r=w,_r===0&&(YA=Ot()+500,Uu&&ue())}}function Hu(A){Od!==null&&Od.tag===0&&(_r&6)===0&&XA();var p=_r;_r|=1;var w=Ul.transition,G=xr;try{if(Ul.transition=null,xr=1,A)return A()}finally{xr=G,Ul.transition=w,_r=p,(_r&6)===0&&ue()}}function qg(){ml=zA.current,Dr(zA)}function qu(A,p){A.finishedWork=null,A.finishedLanes=0;var w=A.timeoutHandle;if(w!==-1&&(A.timeoutHandle=-1,Kf(w)),sn!==null)for(w=sn.return;w!==null;){var G=w;switch(yt(G),G.tag){case 1:G=G.type.childContextTypes,G!=null&&PA();break;case 3:Ll(),Dr(Zn),Dr(An),rm();break;case 5:tm(G);break;case 4:Ll();break;case 13:Dr(Zr);break;case 19:Dr(Zr);break;case 10:ti(G.type._context);break;case 22:case 23:qg()}w=w.return}if(wn=A,sn=A=Hd(A.current,null),On=ml=p,mn=0,om=null,Pg=dp=Mu=0,zi=cm=null,Ci!==null){for(p=0;p<Ci.length;p++)if(w=Ci[p],G=w.interleaved,G!==null){w.interleaved=null;var ne=G.next,de=w.pending;if(de!==null){var Be=de.next;de.next=ne,G.next=Be}w.pending=G}Ci=null}return A}function Uj(A,p){do{var w=sn;try{if(hn(),RA.current=rp,Ld){for(var G=ra.memoizedState;G!==null;){var ne=G.queue;ne!==null&&(ne.pending=null),G=G.next}Ld=!1}if(Dl=0,wa=La=ra=null,mo=!1,Dd=0,Dg.current=null,w===null||w.return===null){mn=1,om=p,sn=null;break}e:{var de=A,Be=w.return,At=w,bt=p;if(p=On,At.flags|=32768,bt!==null&&typeof bt=="object"&&typeof bt.then=="function"){var Vt=bt,ds=At,hs=ds.tag;if((ds.mode&1)===0&&(hs===0||hs===11||hs===15)){var cs=ds.alternate;cs?(ds.updateQueue=cs.updateQueue,ds.memoizedState=cs.memoizedState,ds.lanes=cs.lanes):(ds.updateQueue=null,ds.memoizedState=null)}var Cs=oj(Be);if(Cs!==null){Cs.flags&=-257,cj(Cs,Be,At,de,p),Cs.mode&1&&lj(de,Vt,p),p=Cs,bt=Vt;var Es=p.updateQueue;if(Es===null){var Ts=new Set;Ts.add(bt),p.updateQueue=Ts}else Es.add(bt);break e}else{if((p&1)===0){lj(de,Vt,p),Vg();break e}bt=Error(r(426))}}else if(Yt&&At.mode&1){var Va=oj(Be);if(Va!==null){(Va.flags&65536)===0&&(Va.flags|=256),cj(Va,Be,At,de,p),Pr(GA(bt,At));break e}}de=bt=GA(bt,At),mn!==4&&(mn=2),cm===null?cm=[de]:cm.push(de),de=Be;do{switch(de.tag){case 3:de.flags|=65536,p&=-p,de.lanes|=p;var Rt=nj(de,bt,p);Gi(de,Rt);break e;case 1:At=bt;var Ct=de.type,Mt=de.stateNode;if((de.flags&128)===0&&(typeof Ct.getDerivedStateFromError=="function"||Mt!==null&&typeof Mt.componentDidCatch=="function"&&(Rd===null||!Rd.has(Mt)))){de.flags|=65536,p&=-p,de.lanes|=p;var ps=ij(de,At,p);Gi(de,ps);break e}}de=de.return}while(de!==null)}Qj(w)}catch(Ds){p=Ds,sn===w&&w!==null&&(sn=w=w.return);continue}break}while(!0)}function Rj(){var A=cp.current;return cp.current=rp,A===null?rp:A}function Vg(){(mn===0||mn===3||mn===2)&&(mn=4),wn===null||(Mu&268435455)===0&&(dp&268435455)===0||Md(wn,On)}function pp(A,p){var w=_r;_r|=2;var G=Rj();(wn!==A||On!==p)&&(Pc=null,qu(A,p));do try{sE();break}catch(ne){Uj(A,ne)}while(!0);if(hn(),_r=w,cp.current=G,sn!==null)throw Error(r(261));return wn=null,On=0,mn}function sE(){for(;sn!==null;)Oj(sn)}function rE(){for(;sn!==null&&!$t();)Oj(sn)}function Oj(A){var p=qj(A.alternate,A,ml);A.memoizedProps=A.pendingProps,p===null?Qj(A):sn=p,Dg.current=null}function Qj(A){var p=A;do{var w=p.alternate;if(A=p.return,(p.flags&32768)===0){if(w=zk(w,p,ml),w!==null){sn=w;return}}else{if(w=Yk(w,p),w!==null){w.flags&=32767,sn=w;return}if(A!==null)A.flags|=32768,A.subtreeFlags=0,A.deletions=null;else{mn=6,sn=null;return}}if(p=p.sibling,p!==null){sn=p;return}sn=p=A}while(p!==null);mn===0&&(mn=5)}function Vu(A,p,w){var G=xr,ne=Ul.transition;try{Ul.transition=null,xr=1,aE(A,p,w,G)}finally{Ul.transition=ne,xr=G}return null}function aE(A,p,w,G){do XA();while(Od!==null);if((_r&6)!==0)throw Error(r(327));w=A.finishedWork;var ne=A.finishedLanes;if(w===null)return null;if(A.finishedWork=null,A.finishedLanes=0,w===A.current)throw Error(r(177));A.callbackNode=null,A.callbackPriority=0;var de=w.lanes|w.childLanes;if(od(A,de),A===wn&&(sn=wn=null,On=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||Ap||(Ap=!0,Vj(Hs,function(){return XA(),null})),de=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||de){de=Ul.transition,Ul.transition=null;var Be=xr;xr=1;var At=_r;_r|=4,Dg.current=null,Jk(A,w),Ej(w,A),Nc(Bc),bs=!!Du,Bc=Du=null,A.current=w,Zk(w),Ht(),_r=At,xr=Be,Ul.transition=de}else A.current=w;if(Ap&&(Ap=!1,Od=A,hp=ne),de=A.pendingLanes,de===0&&(Rd=null),ka(w.stateNode),Yi(A,Ot()),p!==null)for(G=A.onRecoverableError,w=0;w<p.length;w++)ne=p[w],G(ne.value,{componentStack:ne.stack,digest:ne.digest});if(up)throw up=!1,A=Rg,Rg=null,A;return(hp&1)!==0&&A.tag!==0&&XA(),de=A.pendingLanes,(de&1)!==0?A===Og?dm++:(dm=0,Og=A):dm=0,ue(),null}function XA(){if(Od!==null){var A=Nr(hp),p=Ul.transition,w=xr;try{if(Ul.transition=null,xr=16>A?16:A,Od===null)var G=!1;else{if(A=Od,Od=null,hp=0,(_r&6)!==0)throw Error(r(331));var ne=_r;for(_r|=4,ks=A.current;ks!==null;){var de=ks,Be=de.child;if((ks.flags&16)!==0){var At=de.deletions;if(At!==null){for(var bt=0;bt<At.length;bt++){var Vt=At[bt];for(ks=Vt;ks!==null;){var ds=ks;switch(ds.tag){case 0:case 11:case 15:lm(8,ds,de)}var hs=ds.child;if(hs!==null)hs.return=ds,ks=hs;else for(;ks!==null;){ds=ks;var cs=ds.sibling,Cs=ds.return;if(_j(ds),ds===Vt){ks=null;break}if(cs!==null){cs.return=Cs,ks=cs;break}ks=Cs}}}var Es=de.alternate;if(Es!==null){var Ts=Es.child;if(Ts!==null){Es.child=null;do{var Va=Ts.sibling;Ts.sibling=null,Ts=Va}while(Ts!==null)}}ks=de}}if((de.subtreeFlags&2064)!==0&&Be!==null)Be.return=de,ks=Be;else e:for(;ks!==null;){if(de=ks,(de.flags&2048)!==0)switch(de.tag){case 0:case 11:case 15:lm(9,de,de.return)}var Rt=de.sibling;if(Rt!==null){Rt.return=de.return,ks=Rt;break e}ks=de.return}}var Ct=A.current;for(ks=Ct;ks!==null;){Be=ks;var Mt=Be.child;if((Be.subtreeFlags&2064)!==0&&Mt!==null)Mt.return=Be,ks=Mt;else e:for(Be=Ct;ks!==null;){if(At=ks,(At.flags&2048)!==0)try{switch(At.tag){case 0:case 11:case 15:op(9,At)}}catch(Ds){Da(At,At.return,Ds)}if(At===Be){ks=null;break e}var ps=At.sibling;if(ps!==null){ps.return=At.return,ks=ps;break e}ks=At.return}}if(_r=ne,ue(),cr&&typeof cr.onPostCommitFiberRoot=="function")try{cr.onPostCommitFiberRoot(yr,A)}catch{}G=!0}return G}finally{xr=w,Ul.transition=p}}return!1}function Mj(A,p,w){p=GA(w,p),p=nj(A,p,1),A=Wi(A,p,1),p=Ti(),A!==null&&(Kn(A,1,p),Yi(A,p))}function Da(A,p,w){if(A.tag===3)Mj(A,A,w);else for(;p!==null;){if(p.tag===3){Mj(p,A,w);break}else if(p.tag===1){var G=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof G.componentDidCatch=="function"&&(Rd===null||!Rd.has(G))){A=GA(w,A),A=ij(p,A,1),p=Wi(p,A,1),A=Ti(),p!==null&&(Kn(p,1,A),Yi(p,A));break}}p=p.return}}function nE(A,p,w){var G=A.pingCache;G!==null&&G.delete(p),p=Ti(),A.pingedLanes|=A.suspendedLanes&w,wn===A&&(On&w)===w&&(mn===4||mn===3&&(On&130023424)===On&&500>Ot()-Ug?qu(A,0):Pg|=w),Yi(A,p)}function Hj(A,p){p===0&&((A.mode&1)===0?p=1:(p=on,on<<=1,(on&130023424)===0&&(on=4194304)));var w=Ti();A=Er(A,p),A!==null&&(Kn(A,p,w),Yi(A,w))}function iE(A){var p=A.memoizedState,w=0;p!==null&&(w=p.retryLane),Hj(A,w)}function lE(A,p){var w=0;switch(A.tag){case 13:var G=A.stateNode,ne=A.memoizedState;ne!==null&&(w=ne.retryLane);break;case 19:G=A.stateNode;break;default:throw Error(r(314))}G!==null&&G.delete(p),Hj(A,w)}var qj;qj=function(A,p,w){if(A!==null)if(A.memoizedProps!==p.pendingProps||Zn.current)Ki=!0;else{if((A.lanes&w)===0&&(p.flags&128)===0)return Ki=!1,Kk(A,p,w);Ki=(A.flags&131072)!==0}else Ki=!1,Yt&&(p.flags&1048576)!==0&&as(p,De,p.index);switch(p.lanes=0,p.tag){case 2:var G=p.type;ip(A,p),A=p.pendingProps;var ne=Ed(p,An.current);ca(p,w),ne=Ru(null,p,G,A,ne,w);var de=Pl();return p.flags|=1,typeof ne=="object"&&ne!==null&&typeof ne.render=="function"&&ne.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,ei(G)?(de=!0,Fc(p)):de=!1,p.memoizedState=ne.state!==null&&ne.state!==void 0?ne.state:null,UA(p),ne.updater=ap,p.stateNode=ne,ne._reactInternals=p,yg(p,G,A,w),p=_g(null,p,G,!0,de,w)):(p.tag=0,Yt&&de&&Gt(p),Fi(null,p,ne,w),p=p.child),p;case 16:G=p.elementType;e:{switch(ip(A,p),A=p.pendingProps,ne=G._init,G=ne(G._payload),p.type=G,ne=p.tag=cE(G),A=po(G,A),ne){case 0:p=wg(null,p,G,A,w);break e;case 1:p=fj(null,p,G,A,w);break e;case 11:p=dj(null,p,G,A,w);break e;case 14:p=uj(null,p,G,po(G.type,A),w);break e}throw Error(r(306,G,""))}return p;case 0:return G=p.type,ne=p.pendingProps,ne=p.elementType===G?ne:po(G,ne),wg(A,p,G,ne,w);case 1:return G=p.type,ne=p.pendingProps,ne=p.elementType===G?ne:po(G,ne),fj(A,p,G,ne,w);case 3:e:{if(pj(p),A===null)throw Error(r(387));G=p.pendingProps,de=p.memoizedState,ne=de.element,em(A,p),Ao(p,G,null,w);var Be=p.memoizedState;if(G=Be.element,de.isDehydrated)if(de={element:G,isDehydrated:!1,cache:Be.cache,pendingSuspenseBoundaries:Be.pendingSuspenseBoundaries,transitions:Be.transitions},p.updateQueue.baseState=de,p.memoizedState=de,p.flags&256){ne=GA(Error(r(423)),p),p=xj(A,p,G,w,ne);break e}else if(G!==ne){ne=GA(Error(r(424)),p),p=xj(A,p,G,w,ne);break e}else for(Xt=Pn(p.stateNode.containerInfo.firstChild),jt=p,Yt=!0,es=null,w=kr(p,null,G,w),p.child=w;w;)w.flags=w.flags&-3|4096,w=w.sibling;else{if(ar(),G===ne){p=Dc(A,p,w);break e}Fi(A,p,G,w)}p=p.child}return p;case 5:return Jf(p),A===null&&ys(p),G=p.type,ne=p.pendingProps,de=A!==null?A.memoizedProps:null,Be=ne.children,zh(G,ne)?Be=null:de!==null&&zh(G,de)&&(p.flags|=32),mj(A,p),Fi(A,p,Be,w),p.child;case 6:return A===null&&ys(p),null;case 13:return gj(A,p,w);case 4:return Id(p,p.stateNode.containerInfo),G=p.pendingProps,A===null?p.child=Ma(p,null,G,w):Fi(A,p,G,w),p.child;case 11:return G=p.type,ne=p.pendingProps,ne=p.elementType===G?ne:po(G,ne),dj(A,p,G,ne,w);case 7:return Fi(A,p,p.pendingProps,w),p.child;case 8:return Fi(A,p,p.pendingProps.children,w),p.child;case 12:return Fi(A,p,p.pendingProps.children,w),p.child;case 10:e:{if(G=p.type._context,ne=p.pendingProps,de=p.memoizedProps,Be=ne.value,Ur(jn,G._currentValue),G._currentValue=Be,de!==null)if(wr(de.value,Be)){if(de.children===ne.children&&!Zn.current){p=Dc(A,p,w);break e}}else for(de=p.child,de!==null&&(de.return=p);de!==null;){var At=de.dependencies;if(At!==null){Be=de.child;for(var bt=At.firstContext;bt!==null;){if(bt.context===G){if(de.tag===1){bt=$i(-1,w&-w),bt.tag=2;var Vt=de.updateQueue;if(Vt!==null){Vt=Vt.shared;var ds=Vt.pending;ds===null?bt.next=bt:(bt.next=ds.next,ds.next=bt),Vt.pending=bt}}de.lanes|=w,bt=de.alternate,bt!==null&&(bt.lanes|=w),Vi(de.return,w,p),At.lanes|=w;break}bt=bt.next}}else if(de.tag===10)Be=de.type===p.type?null:de.child;else if(de.tag===18){if(Be=de.return,Be===null)throw Error(r(341));Be.lanes|=w,At=Be.alternate,At!==null&&(At.lanes|=w),Vi(Be,w,p),Be=de.sibling}else Be=de.child;if(Be!==null)Be.return=de;else for(Be=de;Be!==null;){if(Be===p){Be=null;break}if(de=Be.sibling,de!==null){de.return=Be.return,Be=de;break}Be=Be.return}de=Be}Fi(A,p,ne.children,w),p=p.child}return p;case 9:return ne=p.type,G=p.pendingProps.children,ca(p,w),ne=Ia(ne),G=G(ne),p.flags|=1,Fi(A,p,G,w),p.child;case 14:return G=p.type,ne=po(G,p.pendingProps),ne=po(G.type,ne),uj(A,p,G,ne,w);case 15:return Aj(A,p,p.type,p.pendingProps,w);case 17:return G=p.type,ne=p.pendingProps,ne=p.elementType===G?ne:po(G,ne),ip(A,p),p.tag=1,ei(G)?(A=!0,Fc(p)):A=!1,ca(p,w),rj(p,G,ne),yg(p,G,ne,w),_g(null,p,G,!0,A,w);case 19:return bj(A,p,w);case 22:return hj(A,p,w)}throw Error(r(156,p.tag))};function Vj(A,p){return Nt(A,p)}function oE(A,p,w,G){this.tag=A,this.key=w,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=G,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rl(A,p,w,G){return new oE(A,p,w,G)}function $g(A){return A=A.prototype,!(!A||!A.isReactComponent)}function cE(A){if(typeof A=="function")return $g(A)?1:0;if(A!=null){if(A=A.$$typeof,A===T)return 11;if(A===Y)return 14}return 2}function Hd(A,p){var w=A.alternate;return w===null?(w=Rl(A.tag,p,A.key,A.mode),w.elementType=A.elementType,w.type=A.type,w.stateNode=A.stateNode,w.alternate=A,A.alternate=w):(w.pendingProps=p,w.type=A.type,w.flags=0,w.subtreeFlags=0,w.deletions=null),w.flags=A.flags&14680064,w.childLanes=A.childLanes,w.lanes=A.lanes,w.child=A.child,w.memoizedProps=A.memoizedProps,w.memoizedState=A.memoizedState,w.updateQueue=A.updateQueue,p=A.dependencies,w.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},w.sibling=A.sibling,w.index=A.index,w.ref=A.ref,w}function xp(A,p,w,G,ne,de){var Be=2;if(G=A,typeof A=="function")$g(A)&&(Be=1);else if(typeof A=="string")Be=5;else e:switch(A){case I:return $u(w.children,ne,de,p);case B:Be=8,ne|=8;break;case q:return A=Rl(12,w,p,ne|2),A.elementType=q,A.lanes=de,A;case V:return A=Rl(13,w,p,ne),A.elementType=V,A.lanes=de,A;case D:return A=Rl(19,w,p,ne),A.elementType=D,A.lanes=de,A;case X:return gp(w,ne,de,p);default:if(typeof A=="object"&&A!==null)switch(A.$$typeof){case Q:Be=10;break e;case O:Be=9;break e;case T:Be=11;break e;case Y:Be=14;break e;case M:Be=16,G=null;break e}throw Error(r(130,A==null?A:typeof A,""))}return p=Rl(Be,w,p,ne),p.elementType=A,p.type=G,p.lanes=de,p}function $u(A,p,w,G){return A=Rl(7,A,G,p),A.lanes=w,A}function gp(A,p,w,G){return A=Rl(22,A,G,p),A.elementType=X,A.lanes=w,A.stateNode={isHidden:!1},A}function Wg(A,p,w){return A=Rl(6,A,null,p),A.lanes=w,A}function Gg(A,p,w){return p=Rl(4,A.children!==null?A.children:[],A.key,p),p.lanes=w,p.stateNode={containerInfo:A.containerInfo,pendingChildren:null,implementation:A.implementation},p}function dE(A,p,w,G,ne){this.tag=p,this.containerInfo=A,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gn(0),this.expirationTimes=Gn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gn(0),this.identifierPrefix=G,this.onRecoverableError=ne,this.mutableSourceEagerHydrationData=null}function Kg(A,p,w,G,ne,de,Be,At,bt){return A=new dE(A,p,w,At,bt),p===1?(p=1,de===!0&&(p|=8)):p=0,de=Rl(3,null,null,p),A.current=de,de.stateNode=A,de.memoizedState={element:G,isDehydrated:w,cache:null,transitions:null,pendingSuspenseBoundaries:null},UA(de),A}function uE(A,p,w){var G=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:G==null?null:""+G,children:A,containerInfo:p,implementation:w}}function $j(A){if(!A)return Ko;A=A._reactInternals;e:{if(st(A)!==A||A.tag!==1)throw Error(r(170));var p=A;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(ei(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(A.tag===1){var w=A.type;if(ei(w))return Zh(A,w,p)}return p}function Wj(A,p,w,G,ne,de,Be,At,bt){return A=Kg(w,G,!0,A,ne,de,Be,At,bt),A.context=$j(null),w=A.current,G=Ti(),ne=Qd(w),de=$i(G,ne),de.callback=p??null,Wi(w,de,ne),A.current.lanes=ne,Kn(A,ne,G),Yi(A,G),A}function vp(A,p,w,G){var ne=p.current,de=Ti(),Be=Qd(ne);return w=$j(w),p.context===null?p.context=w:p.pendingContext=w,p=$i(de,Be),p.payload={element:A},G=G===void 0?null:G,G!==null&&(p.callback=G),A=Wi(ne,p,Be),A!==null&&(vo(A,ne,Be,de),Tc(A,ne,Be)),Be}function bp(A){if(A=A.current,!A.child)return null;switch(A.child.tag){case 5:return A.child.stateNode;default:return A.child.stateNode}}function Gj(A,p){if(A=A.memoizedState,A!==null&&A.dehydrated!==null){var w=A.retryLane;A.retryLane=w!==0&&w<p?w:p}}function zg(A,p){Gj(A,p),(A=A.alternate)&&Gj(A,p)}function AE(){return null}var Kj=typeof reportError=="function"?reportError:function(A){console.error(A)};function Yg(A){this._internalRoot=A}yp.prototype.render=Yg.prototype.render=function(A){var p=this._internalRoot;if(p===null)throw Error(r(409));vp(A,p,null,null)},yp.prototype.unmount=Yg.prototype.unmount=function(){var A=this._internalRoot;if(A!==null){this._internalRoot=null;var p=A.containerInfo;Hu(function(){vp(null,A,null,null)}),p[yn]=null}};function yp(A){this._internalRoot=A}yp.prototype.unstable_scheduleHydration=function(A){if(A){var p=ma();A={blockedOn:null,target:A,priority:p};for(var w=0;w<nt.length&&p!==0&&p<nt[w].priority;w++);nt.splice(w,0,A),w===0&&Ut(A)}};function Xg(A){return!(!A||A.nodeType!==1&&A.nodeType!==9&&A.nodeType!==11)}function jp(A){return!(!A||A.nodeType!==1&&A.nodeType!==9&&A.nodeType!==11&&(A.nodeType!==8||A.nodeValue!==" react-mount-point-unstable "))}function zj(){}function hE(A,p,w,G,ne){if(ne){if(typeof G=="function"){var de=G;G=function(){var Vt=bp(Be);de.call(Vt)}}var Be=Wj(p,G,A,0,null,!1,!1,"",zj);return A._reactRootContainer=Be,A[yn]=Be.current,Sc(A.nodeType===8?A.parentNode:A),Hu(),Be}for(;ne=A.lastChild;)A.removeChild(ne);if(typeof G=="function"){var At=G;G=function(){var Vt=bp(bt);At.call(Vt)}}var bt=Kg(A,0,!1,null,null,!1,!1,"",zj);return A._reactRootContainer=bt,A[yn]=bt.current,Sc(A.nodeType===8?A.parentNode:A),Hu(function(){vp(p,bt,w,G)}),bt}function Np(A,p,w,G,ne){var de=w._reactRootContainer;if(de){var Be=de;if(typeof ne=="function"){var At=ne;ne=function(){var bt=bp(Be);At.call(bt)}}vp(p,Be,A,ne)}else Be=hE(w,p,A,ne,G);return bp(Be)}cd=function(A){switch(A.tag){case 3:var p=A.stateNode;if(p.current.memoizedState.isDehydrated){var w=yi(p.pendingLanes);w!==0&&(il(p,w|1),Yi(p,Ot()),(_r&6)===0&&(YA=Ot()+500,ue()))}break;case 13:Hu(function(){var G=Er(A,1);if(G!==null){var ne=Ti();vo(G,A,1,ne)}}),zg(A,1)}},fc=function(A){if(A.tag===13){var p=Er(A,134217728);if(p!==null){var w=Ti();vo(p,A,134217728,w)}zg(A,134217728)}},dd=function(A){if(A.tag===13){var p=Qd(A),w=Er(A,p);if(w!==null){var G=Ti();vo(w,A,p,G)}zg(A,p)}},ma=function(){return xr},Qi=function(A,p){var w=xr;try{return xr=A,p()}finally{xr=w}},lt=function(A,p,w){switch(p){case"input":if(_e(A,w),p=w.name,w.type==="radio"&&p!=null){for(w=A;w.parentNode;)w=w.parentNode;for(w=w.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<w.length;p++){var G=w[p];if(G!==A&&G.form===A.form){var ne=Pu(G);if(!ne)throw Error(r(90));se(G),_e(G,ne)}}}break;case"textarea":me(A,w);break;case"select":p=w.value,p!=null&&pe(A,!!w.multiple,p,!1)}},wt=Hg,pt=Hu;var mE={usingClientEntryPoint:!1,Events:[kd,kc,Pu,at,xt,Hg]},um={findFiberByHostInstance:Go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fE={bundleType:um.bundleType,version:um.version,rendererPackageName:um.rendererPackageName,rendererConfig:um.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(A){return A=Tt(A),A===null?null:A.stateNode},findFiberByHostInstance:um.findFiberByHostInstance||AE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wp.isDisabled&&wp.supportsFiber)try{yr=wp.inject(fE),cr=wp}catch{}}return Xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mE,Xi.createPortal=function(A,p){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xg(p))throw Error(r(200));return uE(A,p,null,w)},Xi.createRoot=function(A,p){if(!Xg(A))throw Error(r(299));var w=!1,G="",ne=Kj;return p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(G=p.identifierPrefix),p.onRecoverableError!==void 0&&(ne=p.onRecoverableError)),p=Kg(A,1,!1,null,null,w,!1,G,ne),A[yn]=p.current,Sc(A.nodeType===8?A.parentNode:A),new Yg(p)},Xi.findDOMNode=function(A){if(A==null)return null;if(A.nodeType===1)return A;var p=A._reactInternals;if(p===void 0)throw typeof A.render=="function"?Error(r(188)):(A=Object.keys(A).join(","),Error(r(268,A)));return A=Tt(p),A=A===null?null:A.stateNode,A},Xi.flushSync=function(A){return Hu(A)},Xi.hydrate=function(A,p,w){if(!jp(p))throw Error(r(200));return Np(null,A,p,!0,w)},Xi.hydrateRoot=function(A,p,w){if(!Xg(A))throw Error(r(405));var G=w!=null&&w.hydratedSources||null,ne=!1,de="",Be=Kj;if(w!=null&&(w.unstable_strictMode===!0&&(ne=!0),w.identifierPrefix!==void 0&&(de=w.identifierPrefix),w.onRecoverableError!==void 0&&(Be=w.onRecoverableError)),p=Wj(p,null,A,1,w??null,ne,!1,de,Be),A[yn]=p.current,Sc(A),G)for(A=0;A<G.length;A++)w=G[A],ne=w._getVersion,ne=ne(w._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[w,ne]:p.mutableSourceEagerHydrationData.push(w,ne);return new yp(p)},Xi.render=function(A,p,w){if(!jp(p))throw Error(r(200));return Np(null,A,p,!1,w)},Xi.unmountComponentAtNode=function(A){if(!jp(A))throw Error(r(40));return A._reactRootContainer?(Hu(function(){Np(null,null,A,!1,function(){A._reactRootContainer=null,A[yn]=null})}),!0):!1},Xi.unstable_batchedUpdates=Hg,Xi.unstable_renderSubtreeIntoContainer=function(A,p,w,G){if(!jp(w))throw Error(r(200));if(A==null||A._reactInternals===void 0)throw Error(r(38));return Np(A,p,w,!1,G)},Xi.version="18.3.1-next-f1338f8080-20240426",Xi}var rN;function US(){if(rN)return tv.exports;rN=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),tv.exports=SE(),tv.exports}var aN;function CE(){if(aN)return _p;aN=1;var t=US();return _p.createRoot=t.createRoot,_p.hydrateRoot=t.hydrateRoot,_p}var BE=CE();const kE=PS(BE);US();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tf(){return tf=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},tf.apply(this,arguments)}var Jd;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Jd||(Jd={}));const nN="popstate";function EE(t){t===void 0&&(t={});function s(a,n){let{pathname:i,search:l,hash:o}=a.location;return gb("",{pathname:i,search:l,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:Dx(n)}return TE(s,r,null,t)}function Ca(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Ty(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function FE(){return Math.random().toString(36).substr(2,8)}function iN(t,s){return{usr:t.state,key:t.key,idx:s}}function gb(t,s,r,a){return r===void 0&&(r=null),tf({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?Uh(s):s,{state:r,key:s&&s.key||a||FE()})}function Dx(t){let{pathname:s="/",search:r="",hash:a=""}=t;return r&&r!=="?"&&(s+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(s+=a.charAt(0)==="#"?a:"#"+a),s}function Uh(t){let s={};if(t){let r=t.indexOf("#");r>=0&&(s.hash=t.substr(r),t=t.substr(0,r));let a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}function TE(t,s,r,a){a===void 0&&(a={});let{window:n=document.defaultView,v5Compat:i=!1}=a,l=n.history,o=Jd.Pop,u=null,d=c();d==null&&(d=0,l.replaceState(tf({},l.state,{idx:d}),""));function c(){return(l.state||{idx:null}).idx}function m(){o=Jd.Pop;let b=c(),y=b==null?null:b-d;d=b,u&&u({action:o,location:g.location,delta:y})}function h(b,y){o=Jd.Push;let N=gb(g.location,b,y);d=c()+1;let j=iN(N,d),S=g.createHref(N);try{l.pushState(j,"",S)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;n.location.assign(S)}i&&u&&u({action:o,location:g.location,delta:1})}function f(b,y){o=Jd.Replace;let N=gb(g.location,b,y);d=c();let j=iN(N,d),S=g.createHref(N);l.replaceState(j,"",S),i&&u&&u({action:o,location:g.location,delta:0})}function x(b){let y=n.location.origin!=="null"?n.location.origin:n.location.href,N=typeof b=="string"?b:Dx(b);return N=N.replace(/ $/,"%20"),Ca(y,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,y)}let g={get action(){return o},get location(){return t(n,l)},listen(b){if(u)throw new Error("A history only accepts one active listener");return n.addEventListener(nN,m),u=b,()=>{n.removeEventListener(nN,m),u=null}},createHref(b){return s(n,b)},createURL:x,encodeLocation(b){let y=x(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:f,go(b){return l.go(b)}};return g}var lN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(lN||(lN={}));function IE(t,s,r){return r===void 0&&(r="/"),LE(t,s,r)}function LE(t,s,r,a){let n=typeof s=="string"?Uh(s):s,i=kh(n.pathname||"/",r);if(i==null)return null;let l=RS(t);DE(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let d=WE(i);o=VE(l[u],d)}return o}function RS(t,s,r,a){s===void 0&&(s=[]),r===void 0&&(r=[]),a===void 0&&(a="");let n=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(Ca(u.relativePath.startsWith(a),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(a.length));let d=iu([a,u.relativePath]),c=r.concat(u);i.children&&i.children.length>0&&(Ca(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),RS(i.children,s,c,d)),!(i.path==null&&!i.index)&&s.push({path:d,score:HE(d,i.index),routesMeta:c})};return t.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))n(i,l);else for(let u of OS(i.path))n(i,l,u)}),s}function OS(t){let s=t.split("/");if(s.length===0)return[];let[r,...a]=s,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(a.length===0)return n?[i,""]:[i];let l=OS(a.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),n&&o.push(...l),o.map(u=>t.startsWith("/")&&u===""?"/":u)}function DE(t){t.sort((s,r)=>s.score!==r.score?r.score-s.score:qE(s.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}const PE=/^:[\w-]+$/,UE=3,RE=2,OE=1,QE=10,ME=-2,oN=t=>t==="*";function HE(t,s){let r=t.split("/"),a=r.length;return r.some(oN)&&(a+=ME),s&&(a+=RE),r.filter(n=>!oN(n)).reduce((n,i)=>n+(PE.test(i)?UE:i===""?OE:QE),a)}function qE(t,s){return t.length===s.length&&t.slice(0,-1).every((a,n)=>a===s[n])?t[t.length-1]-s[s.length-1]:0}function VE(t,s,r){let{routesMeta:a}=t,n={},i="/",l=[];for(let o=0;o<a.length;++o){let u=a[o],d=o===a.length-1,c=i==="/"?s:s.slice(i.length)||"/",m=vb({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},c),h=u.route;if(!m)return null;Object.assign(n,m.params),l.push({params:n,pathname:iu([i,m.pathname]),pathnameBase:XE(iu([i,m.pathnameBase])),route:h}),m.pathnameBase!=="/"&&(i=iu([i,m.pathnameBase]))}return l}function vb(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,a]=$E(t.path,t.caseSensitive,t.end),n=s.match(r);if(!n)return null;let i=n[0],l=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:a.reduce((d,c,m)=>{let{paramName:h,isOptional:f}=c;if(h==="*"){let g=o[m]||"";l=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const x=o[m];return f&&!x?d[h]=void 0:d[h]=(x||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:t}}function $E(t,s,r){s===void 0&&(s=!1),r===void 0&&(r=!0),Ty(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let a=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(a.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(a.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,s?void 0:"i"),a]}function WE(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Ty(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function kh(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,a=t.charAt(r);return a&&a!=="/"?null:t.slice(r)||"/"}const GE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,KE=t=>GE.test(t);function zE(t,s){s===void 0&&(s="/");let{pathname:r,search:a="",hash:n=""}=typeof t=="string"?Uh(t):t,i;if(r)if(KE(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Ty(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=cN(r.substring(1),"/"):i=cN(r,s)}else i=s;return{pathname:i,search:JE(a),hash:ZE(n)}}function cN(t,s){let r=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function av(t,s,r,a){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function YE(t){return t.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function Iy(t,s){let r=YE(t);return s?r.map((a,n)=>n===r.length-1?a.pathname:a.pathnameBase):r.map(a=>a.pathnameBase)}function Ly(t,s,r,a){a===void 0&&(a=!1);let n;typeof t=="string"?n=Uh(t):(n=tf({},t),Ca(!n.pathname||!n.pathname.includes("?"),av("?","pathname","search",n)),Ca(!n.pathname||!n.pathname.includes("#"),av("#","pathname","hash",n)),Ca(!n.search||!n.search.includes("#"),av("#","search","hash",n)));let i=t===""||n.pathname==="",l=i?"/":n.pathname,o;if(l==null)o=r;else{let m=s.length-1;if(!a&&l.startsWith("..")){let h=l.split("/");for(;h[0]==="..";)h.shift(),m-=1;n.pathname=h.join("/")}o=m>=0?s[m]:"/"}let u=zE(n,o),d=l&&l!=="/"&&l.endsWith("/"),c=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||c)&&(u.pathname+="/"),u}const iu=t=>t.join("/").replace(/\/\/+/g,"/"),XE=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),JE=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ZE=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function eF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QS=["post","put","patch","delete"];new Set(QS);const tF=["get",...QS];new Set(tF);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sf(){return sf=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},sf.apply(this,arguments)}const j0=v.createContext(null),MS=v.createContext(null),rd=v.createContext(null),N0=v.createContext(null),ad=v.createContext({outlet:null,matches:[],isDataRoute:!1}),HS=v.createContext(null);function sF(t,s){let{relative:r}=s===void 0?{}:s;Rh()||Ca(!1);let{basename:a,navigator:n}=v.useContext(rd),{hash:i,pathname:l,search:o}=w0(t,{relative:r}),u=l;return a!=="/"&&(u=l==="/"?a:iu([a,l])),n.createHref({pathname:u,search:o,hash:i})}function Rh(){return v.useContext(N0)!=null}function Ba(){return Rh()||Ca(!1),v.useContext(N0).location}function qS(t){v.useContext(rd).static||v.useLayoutEffect(t)}function Ns(){let{isDataRoute:t}=v.useContext(ad);return t?fF():rF()}function rF(){Rh()||Ca(!1);let t=v.useContext(j0),{basename:s,future:r,navigator:a}=v.useContext(rd),{matches:n}=v.useContext(ad),{pathname:i}=Ba(),l=JSON.stringify(Iy(n,r.v7_relativeSplatPath)),o=v.useRef(!1);return qS(()=>{o.current=!0}),v.useCallback(function(d,c){if(c===void 0&&(c={}),!o.current)return;if(typeof d=="number"){a.go(d);return}let m=Ly(d,JSON.parse(l),i,c.relative==="path");t==null&&s!=="/"&&(m.pathname=m.pathname==="/"?s:iu([s,m.pathname])),(c.replace?a.replace:a.push)(m,c.state,c)},[s,a,l,i,t])}function Ps(){let{matches:t}=v.useContext(ad),s=t[t.length-1];return s?s.params:{}}function w0(t,s){let{relative:r}=s===void 0?{}:s,{future:a}=v.useContext(rd),{matches:n}=v.useContext(ad),{pathname:i}=Ba(),l=JSON.stringify(Iy(n,a.v7_relativeSplatPath));return v.useMemo(()=>Ly(t,JSON.parse(l),i,r==="path"),[t,l,i,r])}function aF(t,s){return nF(t,s)}function nF(t,s,r,a){Rh()||Ca(!1);let{navigator:n}=v.useContext(rd),{matches:i}=v.useContext(ad),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let d=Ba(),c;if(s){var m;let b=typeof s=="string"?Uh(s):s;u==="/"||(m=b.pathname)!=null&&m.startsWith(u)||Ca(!1),c=b}else c=d;let h=c.pathname||"/",f=h;if(u!=="/"){let b=u.replace(/^\//,"").split("/");f="/"+h.replace(/^\//,"").split("/").slice(b.length).join("/")}let x=IE(t,{pathname:f}),g=dF(x&&x.map(b=>Object.assign({},b,{params:Object.assign({},o,b.params),pathname:iu([u,n.encodeLocation?n.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:iu([u,n.encodeLocation?n.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),i,r,a);return s&&g?v.createElement(N0.Provider,{value:{location:sf({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Jd.Pop}},g):g}function iF(){let t=mF(),s=eF(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},s),r?v.createElement("pre",{style:n},r):null,null)}const lF=v.createElement(iF,null);class oF extends v.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,r){return r.location!==s.location||r.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:r.error,location:r.location,revalidation:s.revalidation||r.revalidation}}componentDidCatch(s,r){console.error("React Router caught the following error during render",s,r)}render(){return this.state.error!==void 0?v.createElement(ad.Provider,{value:this.props.routeContext},v.createElement(HS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cF(t){let{routeContext:s,match:r,children:a}=t,n=v.useContext(j0);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),v.createElement(ad.Provider,{value:s},a)}function dF(t,s,r,a){var n;if(s===void 0&&(s=[]),r===void 0&&(r=null),a===void 0&&(a=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=a)!=null&&i.v7_partialHydration&&s.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,o=(n=r)==null?void 0:n.errors;if(o!=null){let c=l.findIndex(m=>m.route.id&&(o==null?void 0:o[m.route.id])!==void 0);c>=0||Ca(!1),l=l.slice(0,Math.min(l.length,c+1))}let u=!1,d=-1;if(r&&a&&a.v7_partialHydration)for(let c=0;c<l.length;c++){let m=l[c];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=c),m.route.id){let{loaderData:h,errors:f}=r,x=m.route.loader&&h[m.route.id]===void 0&&(!f||f[m.route.id]===void 0);if(m.route.lazy||x){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((c,m,h)=>{let f,x=!1,g=null,b=null;r&&(f=o&&m.route.id?o[m.route.id]:void 0,g=m.route.errorElement||lF,u&&(d<0&&h===0?(pF("route-fallback"),x=!0,b=null):d===h&&(x=!0,b=m.route.hydrateFallbackElement||null)));let y=s.concat(l.slice(0,h+1)),N=()=>{let j;return f?j=g:x?j=b:m.route.Component?j=v.createElement(m.route.Component,null):m.route.element?j=m.route.element:j=c,v.createElement(cF,{match:m,routeContext:{outlet:c,matches:y,isDataRoute:r!=null},children:j})};return r&&(m.route.ErrorBoundary||m.route.errorElement||h===0)?v.createElement(oF,{location:r.location,revalidation:r.revalidation,component:g,error:f,children:N(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):N()},null)}var VS=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(VS||{}),$S=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})($S||{});function uF(t){let s=v.useContext(j0);return s||Ca(!1),s}function AF(t){let s=v.useContext(MS);return s||Ca(!1),s}function hF(t){let s=v.useContext(ad);return s||Ca(!1),s}function WS(t){let s=hF(),r=s.matches[s.matches.length-1];return r.route.id||Ca(!1),r.route.id}function mF(){var t;let s=v.useContext(HS),r=AF(),a=WS();return s!==void 0?s:(t=r.errors)==null?void 0:t[a]}function fF(){let{router:t}=uF(VS.UseNavigateStable),s=WS($S.UseNavigateStable),r=v.useRef(!1);return qS(()=>{r.current=!0}),v.useCallback(function(n,i){i===void 0&&(i={}),r.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,sf({fromRouteId:s},i)))},[t,s])}const dN={};function pF(t,s,r){dN[t]||(dN[t]=!0)}function xF(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Wc(t){let{to:s,replace:r,state:a,relative:n}=t;Rh()||Ca(!1);let{future:i,static:l}=v.useContext(rd),{matches:o}=v.useContext(ad),{pathname:u}=Ba(),d=Ns(),c=Ly(s,Iy(o,i.v7_relativeSplatPath),u,n==="path"),m=JSON.stringify(c);return v.useEffect(()=>d(JSON.parse(m),{replace:r,state:a,relative:n}),[d,m,n,r,a]),null}function tt(t){Ca(!1)}function gF(t){let{basename:s="/",children:r=null,location:a,navigationType:n=Jd.Pop,navigator:i,static:l=!1,future:o}=t;Rh()&&Ca(!1);let u=s.replace(/^\/*/,"/"),d=v.useMemo(()=>({basename:u,navigator:i,static:l,future:sf({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof a=="string"&&(a=Uh(a));let{pathname:c="/",search:m="",hash:h="",state:f=null,key:x="default"}=a,g=v.useMemo(()=>{let b=kh(c,u);return b==null?null:{location:{pathname:b,search:m,hash:h,state:f,key:x},navigationType:n}},[u,c,m,h,f,x,n]);return g==null?null:v.createElement(rd.Provider,{value:d},v.createElement(N0.Provider,{children:r,value:g}))}function _l(t){let{children:s,location:r}=t;return aF(bb(s),r)}new Promise(()=>{});function bb(t,s){s===void 0&&(s=[]);let r=[];return v.Children.forEach(t,(a,n)=>{if(!v.isValidElement(a))return;let i=[...s,n];if(a.type===v.Fragment){r.push.apply(r,bb(a.props.children,i));return}a.type!==tt&&Ca(!1),!a.props.index||!a.props.children||Ca(!1);let l={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(l.children=bb(a.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Px(){return Px=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Px.apply(this,arguments)}function GS(t,s){if(t==null)return{};var r={},a=Object.keys(t),n,i;for(i=0;i<a.length;i++)n=a[i],!(s.indexOf(n)>=0)&&(r[n]=t[n]);return r}function vF(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function bF(t,s){return t.button===0&&(!s||s==="_self")&&!vF(t)}function yb(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((s,r)=>{let a=t[r];return s.concat(Array.isArray(a)?a.map(n=>[r,n]):[[r,a]])},[]))}function yF(t,s){let r=yb(t);return s&&s.forEach((a,n)=>{r.has(n)||s.getAll(n).forEach(i=>{r.append(n,i)})}),r}const jF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],NF=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],wF="6";try{window.__reactRouterVersion=wF}catch{}const _F=v.createContext({isTransitioning:!1}),SF="startTransition",uN=NE[SF];function CF(t){let{basename:s,children:r,future:a,window:n}=t,i=v.useRef();i.current==null&&(i.current=EE({window:n,v5Compat:!0}));let l=i.current,[o,u]=v.useState({action:l.action,location:l.location}),{v7_startTransition:d}=a||{},c=v.useCallback(m=>{d&&uN?uN(()=>u(m)):u(m)},[u,d]);return v.useLayoutEffect(()=>l.listen(c),[l,c]),v.useEffect(()=>xF(a),[a]),v.createElement(gF,{basename:s,children:r,location:o.location,navigationType:o.action,navigator:l,future:a})}const BF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ee=v.forwardRef(function(s,r){let{onClick:a,relative:n,reloadDocument:i,replace:l,state:o,target:u,to:d,preventScrollReset:c,viewTransition:m}=s,h=GS(s,jF),{basename:f}=v.useContext(rd),x,g=!1;if(typeof d=="string"&&kF.test(d)&&(x=d,BF))try{let j=new URL(window.location.href),S=d.startsWith("//")?new URL(j.protocol+d):new URL(d),k=kh(S.pathname,f);S.origin===j.origin&&k!=null?d=k+S.search+S.hash:g=!0}catch{}let b=sF(d,{relative:n}),y=FF(d,{replace:l,state:o,target:u,preventScrollReset:c,relative:n,viewTransition:m});function N(j){a&&a(j),j.defaultPrevented||y(j)}return v.createElement("a",Px({},h,{href:x||b,onClick:g||i?a:N,ref:r,target:u}))}),AN=v.forwardRef(function(s,r){let{"aria-current":a="page",caseSensitive:n=!1,className:i="",end:l=!1,style:o,to:u,viewTransition:d,children:c}=s,m=GS(s,NF),h=w0(u,{relative:m.relative}),f=Ba(),x=v.useContext(MS),{navigator:g,basename:b}=v.useContext(rd),y=x!=null&&TF(h)&&d===!0,N=g.encodeLocation?g.encodeLocation(h).pathname:h.pathname,j=f.pathname,S=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(j=j.toLowerCase(),S=S?S.toLowerCase():null,N=N.toLowerCase()),S&&b&&(S=kh(S,b)||S);const k=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let P=j===N||!l&&j.startsWith(N)&&j.charAt(k)==="/",I=S!=null&&(S===N||!l&&S.startsWith(N)&&S.charAt(N.length)==="/"),B={isActive:P,isPending:I,isTransitioning:y},q=P?a:void 0,Q;typeof i=="function"?Q=i(B):Q=[i,P?"active":null,I?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let O=typeof o=="function"?o(B):o;return v.createElement(Ee,Px({},m,{"aria-current":q,className:Q,ref:r,style:O,to:u,viewTransition:d}),typeof c=="function"?c(B):c)});var jb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(jb||(jb={}));var hN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(hN||(hN={}));function EF(t){let s=v.useContext(j0);return s||Ca(!1),s}function FF(t,s){let{target:r,replace:a,state:n,preventScrollReset:i,relative:l,viewTransition:o}=s===void 0?{}:s,u=Ns(),d=Ba(),c=w0(t,{relative:l});return v.useCallback(m=>{if(bF(m,r)){m.preventDefault();let h=a!==void 0?a:Dx(d)===Dx(c);u(t,{replace:h,state:n,preventScrollReset:i,relative:l,viewTransition:o})}},[d,u,c,a,n,r,t,i,l,o])}function _0(t){let s=v.useRef(yb(t)),r=v.useRef(!1),a=Ba(),n=v.useMemo(()=>yF(a.search,r.current?null:s.current),[a.search]),i=Ns(),l=v.useCallback((o,u)=>{const d=yb(typeof o=="function"?o(n):o);r.current=!0,i("?"+d,u)},[i,n]);return[n,l]}function TF(t,s){s===void 0&&(s={});let r=v.useContext(_F);r==null&&Ca(!1);let{basename:a}=EF(jb.useViewTransitionState),n=w0(t,{relative:s.relative});if(!r.isTransitioning)return!1;let i=kh(r.currentLocation.pathname,a)||r.currentLocation.pathname,l=kh(r.nextLocation.pathname,a)||r.nextLocation.pathname;return vb(n.pathname,l)!=null||vb(n.pathname,i)!=null}function KS(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(r=KS(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Zd(){for(var t,s,r=0,a="",n=arguments.length;r<n;r++)(t=arguments[r])&&(s=KS(t))&&(a&&(a+=" "),a+=s);return a}const rf=t=>typeof t=="number"&&!isNaN(t),iA=t=>typeof t=="string",bl=t=>typeof t=="function",bx=t=>iA(t)||bl(t)?t:null,Nb=t=>v.isValidElement(t)||iA(t)||bl(t)||rf(t);function IF(t,s,r){r===void 0&&(r=300);const{scrollHeight:a,style:n}=t;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(s,r)})})}function S0(t){let{enter:s,exit:r,appendPosition:a=!1,collapse:n=!0,collapseDuration:i=300}=t;return function(l){let{children:o,position:u,preventExitTransition:d,done:c,nodeRef:m,isIn:h,playToast:f}=l;const x=a?`${s}--${u}`:s,g=a?`${r}--${u}`:r,b=v.useRef(0);return v.useLayoutEffect(()=>{const y=m.current,N=x.split(" "),j=S=>{S.target===m.current&&(f(),y.removeEventListener("animationend",j),y.removeEventListener("animationcancel",j),b.current===0&&S.type!=="animationcancel"&&y.classList.remove(...N))};y.classList.add(...N),y.addEventListener("animationend",j),y.addEventListener("animationcancel",j)},[]),v.useEffect(()=>{const y=m.current,N=()=>{y.removeEventListener("animationend",N),n?IF(y,c,i):c()};h||(d?N():(b.current=1,y.className+=` ${g}`,y.addEventListener("animationend",N)))},[h]),Os.createElement(Os.Fragment,null,o)}}function mN(t,s){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:s}:{}}const Pi=new Map;let af=[];const wb=new Set,LF=t=>wb.forEach(s=>s(t)),zS=()=>Pi.size>0;function YS(t,s){var r;if(s)return!((r=Pi.get(s))==null||!r.isToastActive(t));let a=!1;return Pi.forEach(n=>{n.isToastActive(t)&&(a=!0)}),a}function XS(t,s){Nb(t)&&(zS()||af.push({content:t,options:s}),Pi.forEach(r=>{r.buildToast(t,s)}))}function fN(t,s){Pi.forEach(r=>{s!=null&&s!=null&&s.containerId?(s==null?void 0:s.containerId)===r.id&&r.toggle(t,s==null?void 0:s.id):r.toggle(t,s==null?void 0:s.id)})}function DF(t){const{subscribe:s,getSnapshot:r,setProps:a}=v.useRef((function(i){const l=i.containerId||1;return{subscribe(o){const u=(function(c,m,h){let f=1,x=0,g=[],b=[],y=[],N=m;const j=new Map,S=new Set,k=()=>{y=Array.from(j.values()),S.forEach(B=>B())},P=B=>{b=B==null?[]:b.filter(q=>q!==B),k()},I=B=>{const{toastId:q,onOpen:Q,updateId:O,children:T}=B.props,V=O==null;B.staleId&&j.delete(B.staleId),j.set(q,B),b=[...b,B.props.toastId].filter(D=>D!==B.staleId),k(),h(mN(B,V?"added":"updated")),V&&bl(Q)&&Q(v.isValidElement(T)&&T.props)};return{id:c,props:N,observe:B=>(S.add(B),()=>S.delete(B)),toggle:(B,q)=>{j.forEach(Q=>{q!=null&&q!==Q.props.toastId||bl(Q.toggle)&&Q.toggle(B)})},removeToast:P,toasts:j,clearQueue:()=>{x-=g.length,g=[]},buildToast:(B,q)=>{if((_=>{let{containerId:F,toastId:E,updateId:L}=_;const U=F?F!==c:c!==1,J=j.has(E)&&L==null;return U||J})(q))return;const{toastId:Q,updateId:O,data:T,staleId:V,delay:D}=q,Y=()=>{P(Q)},M=O==null;M&&x++;const X={...N,style:N.toastStyle,key:f++,...Object.fromEntries(Object.entries(q).filter(_=>{let[F,E]=_;return E!=null})),toastId:Q,updateId:O,data:T,closeToast:Y,isIn:!1,className:bx(q.className||N.toastClassName),bodyClassName:bx(q.bodyClassName||N.bodyClassName),progressClassName:bx(q.progressClassName||N.progressClassName),autoClose:!q.isLoading&&(R=q.autoClose,H=N.autoClose,R===!1||rf(R)&&R>0?R:H),deleteToast(){const _=j.get(Q),{onClose:F,children:E}=_.props;bl(F)&&F(v.isValidElement(E)&&E.props),h(mN(_,"removed")),j.delete(Q),x--,x<0&&(x=0),g.length>0?I(g.shift()):k()}};var R,H;X.closeButton=N.closeButton,q.closeButton===!1||Nb(q.closeButton)?X.closeButton=q.closeButton:q.closeButton===!0&&(X.closeButton=!Nb(N.closeButton)||N.closeButton);let W=B;v.isValidElement(B)&&!iA(B.type)?W=v.cloneElement(B,{closeToast:Y,toastProps:X,data:T}):bl(B)&&(W=B({closeToast:Y,toastProps:X,data:T}));const K={content:W,props:X,staleId:V};N.limit&&N.limit>0&&x>N.limit&&M?g.push(K):rf(D)?setTimeout(()=>{I(K)},D):I(K)},setProps(B){N=B},setToggle:(B,q)=>{j.get(B).toggle=q},isToastActive:B=>b.some(q=>q===B),getSnapshot:()=>y}})(l,i,LF);Pi.set(l,u);const d=u.observe(o);return af.forEach(c=>XS(c.content,c.options)),af=[],()=>{d(),Pi.delete(l)}},setProps(o){var u;(u=Pi.get(l))==null||u.setProps(o)},getSnapshot(){var o;return(o=Pi.get(l))==null?void 0:o.getSnapshot()}}})(t)).current;a(t);const n=v.useSyncExternalStore(s,r,r);return{getToastToRender:function(i){if(!n)return[];const l=new Map;return t.newestOnTop&&n.reverse(),n.forEach(o=>{const{position:u}=o.props;l.has(u)||l.set(u,[]),l.get(u).push(o)}),Array.from(l,o=>i(o[0],o[1]))},isToastActive:YS,count:n==null?void 0:n.length}}function PF(t){const[s,r]=v.useState(!1),[a,n]=v.useState(!1),i=v.useRef(null),l=v.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:u,closeToast:d,onClick:c,closeOnClick:m}=t;var h,f;function x(){r(!0)}function g(){r(!1)}function b(j){const S=i.current;l.canDrag&&S&&(l.didMove=!0,s&&g(),l.delta=t.draggableDirection==="x"?j.clientX-l.start:j.clientY-l.start,l.start!==j.clientX&&(l.canCloseOnClick=!1),S.style.transform=`translate3d(${t.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`},0)`,S.style.opacity=""+(1-Math.abs(l.delta/l.removalDistance)))}function y(){document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",y);const j=i.current;if(l.canDrag&&l.didMove&&j){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance)return n(!0),t.closeToast(),void t.collapseAll();j.style.transition="transform 0.2s, opacity 0.2s",j.style.removeProperty("transform"),j.style.removeProperty("opacity")}}(f=Pi.get((h={id:t.toastId,containerId:t.containerId,fn:r}).containerId||1))==null||f.setToggle(h.id,h.fn),v.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||g(),window.addEventListener("focus",x),window.addEventListener("blur",g),()=>{window.removeEventListener("focus",x),window.removeEventListener("blur",g)}},[t.pauseOnFocusLoss]);const N={onPointerDown:function(j){if(t.draggable===!0||t.draggable===j.pointerType){l.didMove=!1,document.addEventListener("pointermove",b),document.addEventListener("pointerup",y);const S=i.current;l.canCloseOnClick=!0,l.canDrag=!0,S.style.transition="none",t.draggableDirection==="x"?(l.start=j.clientX,l.removalDistance=S.offsetWidth*(t.draggablePercent/100)):(l.start=j.clientY,l.removalDistance=S.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(j){const{top:S,bottom:k,left:P,right:I}=i.current.getBoundingClientRect();j.nativeEvent.type!=="touchend"&&t.pauseOnHover&&j.clientX>=P&&j.clientX<=I&&j.clientY>=S&&j.clientY<=k?g():x()}};return o&&u&&(N.onMouseEnter=g,t.stacked||(N.onMouseLeave=x)),m&&(N.onClick=j=>{c&&c(j),l.canCloseOnClick&&d()}),{playToast:x,pauseToast:g,isRunning:s,preventExitTransition:a,toastRef:i,eventHandlers:N}}function UF(t){let{delay:s,isRunning:r,closeToast:a,type:n="default",hide:i,className:l,style:o,controlledProgress:u,progress:d,rtl:c,isIn:m,theme:h}=t;const f=i||u&&d===0,x={...o,animationDuration:`${s}ms`,animationPlayState:r?"running":"paused"};u&&(x.transform=`scaleX(${d})`);const g=Zd("Toastify__progress-bar",u?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":c}),b=bl(l)?l({rtl:c,type:n,defaultClassName:g}):Zd(g,l),y={[u&&d>=1?"onTransitionEnd":"onAnimationEnd"]:u&&d<1?null:()=>{m&&a()}};return Os.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},Os.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${n}`}),Os.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:b,style:x,...y}))}let RF=1;const JS=()=>""+RF++;function OF(t){return t&&(iA(t.toastId)||rf(t.toastId))?t.toastId:JS()}function Um(t,s){return XS(t,s),s.toastId}function Ux(t,s){return{...s,type:s&&s.type||t,toastId:OF(s)}}function Sp(t){return(s,r)=>Um(s,Ux(t,r))}function mt(t,s){return Um(t,Ux("default",s))}mt.loading=(t,s)=>Um(t,Ux("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...s})),mt.promise=function(t,s,r){let a,{pending:n,error:i,success:l}=s;n&&(a=iA(n)?mt.loading(n,r):mt.loading(n.render,{...r,...n}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(c,m,h)=>{if(m==null)return void mt.dismiss(a);const f={type:c,...o,...r,data:h},x=iA(m)?{render:m}:m;return a?mt.update(a,{...f,...x}):mt(x.render,{...f,...x}),h},d=bl(t)?t():t;return d.then(c=>u("success",l,c)).catch(c=>u("error",i,c)),d},mt.success=Sp("success"),mt.info=Sp("info"),mt.error=Sp("error"),mt.warning=Sp("warning"),mt.warn=mt.warning,mt.dark=(t,s)=>Um(t,Ux("default",{theme:"dark",...s})),mt.dismiss=function(t){(function(s){var r;if(zS()){if(s==null||iA(r=s)||rf(r))Pi.forEach(a=>{a.removeToast(s)});else if(s&&("containerId"in s||"id"in s)){const a=Pi.get(s.containerId);a?a.removeToast(s.id):Pi.forEach(n=>{n.removeToast(s.id)})}}else af=af.filter(a=>s!=null&&a.options.toastId!==s)})(t)},mt.clearWaitingQueue=function(t){t===void 0&&(t={}),Pi.forEach(s=>{!s.props.limit||t.containerId&&s.id!==t.containerId||s.clearQueue()})},mt.isActive=YS,mt.update=function(t,s){s===void 0&&(s={});const r=((a,n)=>{var i;let{containerId:l}=n;return(i=Pi.get(l||1))==null?void 0:i.toasts.get(a)})(t,s);if(r){const{props:a,content:n}=r,i={delay:100,...a,...s,toastId:s.toastId||t,updateId:JS()};i.toastId!==t&&(i.staleId=t);const l=i.render||n;delete i.render,Um(l,i)}},mt.done=t=>{mt.update(t,{progress:1})},mt.onChange=function(t){return wb.add(t),()=>{wb.delete(t)}},mt.play=t=>fN(!0,t),mt.pause=t=>fN(!1,t);const QF=typeof window<"u"?v.useLayoutEffect:v.useEffect,Cp=t=>{let{theme:s,type:r,isLoading:a,...n}=t;return Os.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:s==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...n})},nv={info:function(t){return Os.createElement(Cp,{...t},Os.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return Os.createElement(Cp,{...t},Os.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return Os.createElement(Cp,{...t},Os.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return Os.createElement(Cp,{...t},Os.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Os.createElement("div",{className:"Toastify__spinner"})}},MF=t=>{const{isRunning:s,preventExitTransition:r,toastRef:a,eventHandlers:n,playToast:i}=PF(t),{closeButton:l,children:o,autoClose:u,onClick:d,type:c,hideProgressBar:m,closeToast:h,transition:f,position:x,className:g,style:b,bodyClassName:y,bodyStyle:N,progressClassName:j,progressStyle:S,updateId:k,role:P,progress:I,rtl:B,toastId:q,deleteToast:Q,isIn:O,isLoading:T,closeOnClick:V,theme:D}=t,Y=Zd("Toastify__toast",`Toastify__toast-theme--${D}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":B},{"Toastify__toast--close-on-click":V}),M=bl(g)?g({rtl:B,position:x,type:c,defaultClassName:Y}):Zd(Y,g),X=(function(K){let{theme:_,type:F,isLoading:E,icon:L}=K,U=null;const J={theme:_,type:F};return L===!1||(bl(L)?U=L({...J,isLoading:E}):v.isValidElement(L)?U=v.cloneElement(L,J):E?U=nv.spinner():(ae=>ae in nv)(F)&&(U=nv[F](J))),U})(t),R=!!I||!u,H={closeToast:h,type:c,theme:D};let W=null;return l===!1||(W=bl(l)?l(H):v.isValidElement(l)?v.cloneElement(l,H):(function(K){let{closeToast:_,theme:F,ariaLabel:E="close"}=K;return Os.createElement("button",{className:`Toastify__close-button Toastify__close-button--${F}`,type:"button",onClick:L=>{L.stopPropagation(),_(L)},"aria-label":E},Os.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Os.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))})(H)),Os.createElement(f,{isIn:O,done:Q,position:x,preventExitTransition:r,nodeRef:a,playToast:i},Os.createElement("div",{id:q,onClick:d,"data-in":O,className:M,...n,style:b,ref:a},Os.createElement("div",{...O&&{role:P},className:bl(y)?y({type:c}):Zd("Toastify__toast-body",y),style:N},X!=null&&Os.createElement("div",{className:Zd("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!T})},X),Os.createElement("div",null,o)),W,Os.createElement(UF,{...k&&!R?{key:`pb-${k}`}:{},rtl:B,theme:D,delay:u,isRunning:s,isIn:O,closeToast:h,hide:m,type:c,style:S,className:j,controlledProgress:R,progress:I||0})))},C0=function(t,s){return s===void 0&&(s=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:s}},HF=S0(C0("bounce",!0));S0(C0("slide",!0));S0(C0("zoom"));S0(C0("flip"));const qF={position:"top-right",transition:HF,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function VF(t){let s={...qF,...t};const r=t.stacked,[a,n]=v.useState(!0),i=v.useRef(null),{getToastToRender:l,isToastActive:o,count:u}=DF(s),{className:d,style:c,rtl:m,containerId:h}=s;function f(g){const b=Zd("Toastify__toast-container",`Toastify__toast-container--${g}`,{"Toastify__toast-container--rtl":m});return bl(d)?d({position:g,rtl:m,defaultClassName:b}):Zd(b,bx(d))}function x(){r&&(n(!0),mt.play())}return QF(()=>{if(r){var g;const b=i.current.querySelectorAll('[data-in="true"]'),y=12,N=(g=s.position)==null?void 0:g.includes("top");let j=0,S=0;Array.from(b).reverse().forEach((k,P)=>{const I=k;I.classList.add("Toastify__toast--stacked"),P>0&&(I.dataset.collapsed=`${a}`),I.dataset.pos||(I.dataset.pos=N?"top":"bot");const B=j*(a?.2:1)+(a?0:y*P);I.style.setProperty("--y",`${N?B:-1*B}px`),I.style.setProperty("--g",`${y}`),I.style.setProperty("--s",""+(1-(a?S:0))),j+=I.offsetHeight,S+=.025})}},[a,u,r]),Os.createElement("div",{ref:i,className:"Toastify",id:h,onMouseEnter:()=>{r&&(n(!1),mt.pause())},onMouseLeave:x},l((g,b)=>{const y=b.length?{...c}:{...c,pointerEvents:"none"};return Os.createElement("div",{className:f(g),style:y,key:`container-${g}`},b.map(N=>{let{content:j,props:S}=N;return Os.createElement(MF,{...S,stacked:r,collapseAll:x,isIn:o(S.toastId,S.containerId),style:S.style,key:`toast-${S.key}`},j)}))}))}function ZS(t,s){return function(){return t.apply(s,arguments)}}const{toString:$F}=Object.prototype,{getPrototypeOf:Dy}=Object,{iterator:B0,toStringTag:eC}=Symbol,k0=(t=>s=>{const r=$F.call(s);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Fo=t=>(t=t.toLowerCase(),s=>k0(s)===t),E0=t=>s=>typeof s===t,{isArray:Oh}=Array,Eh=E0("undefined");function Bf(t){return t!==null&&!Eh(t)&&t.constructor!==null&&!Eh(t.constructor)&&el(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const tC=Fo("ArrayBuffer");function WF(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&tC(t.buffer),s}const GF=E0("string"),el=E0("function"),sC=E0("number"),kf=t=>t!==null&&typeof t=="object",KF=t=>t===!0||t===!1,yx=t=>{if(k0(t)!=="object")return!1;const s=Dy(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(eC in t)&&!(B0 in t)},zF=t=>{if(!kf(t)||Bf(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},YF=Fo("Date"),XF=Fo("File"),JF=Fo("Blob"),ZF=Fo("FileList"),e3=t=>kf(t)&&el(t.pipe),t3=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||el(t.append)&&((s=k0(t))==="formdata"||s==="object"&&el(t.toString)&&t.toString()==="[object FormData]"))},s3=Fo("URLSearchParams"),[r3,a3,n3,i3]=["ReadableStream","Request","Response","Headers"].map(Fo),l3=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ef(t,s,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let a,n;if(typeof t!="object"&&(t=[t]),Oh(t))for(a=0,n=t.length;a<n;a++)s.call(null,t[a],a,t);else{if(Bf(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),l=i.length;let o;for(a=0;a<l;a++)o=i[a],s.call(null,t[o],o,t)}}function rC(t,s){if(Bf(t))return null;s=s.toLowerCase();const r=Object.keys(t);let a=r.length,n;for(;a-- >0;)if(n=r[a],s===n.toLowerCase())return n;return null}const eA=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,aC=t=>!Eh(t)&&t!==eA;function _b(){const{caseless:t,skipUndefined:s}=aC(this)&&this||{},r={},a=(n,i)=>{const l=t&&rC(r,i)||i;yx(r[l])&&yx(n)?r[l]=_b(r[l],n):yx(n)?r[l]=_b({},n):Oh(n)?r[l]=n.slice():(!s||!Eh(n))&&(r[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&Ef(arguments[n],a);return r}const o3=(t,s,r,{allOwnKeys:a}={})=>(Ef(s,(n,i)=>{r&&el(n)?t[i]=ZS(n,r):t[i]=n},{allOwnKeys:a}),t),c3=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),d3=(t,s,r,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),r&&Object.assign(t.prototype,r)},u3=(t,s,r,a)=>{let n,i,l;const o={};if(s=s||{},t==null)return s;do{for(n=Object.getOwnPropertyNames(t),i=n.length;i-- >0;)l=n[i],(!a||a(l,t,s))&&!o[l]&&(s[l]=t[l],o[l]=!0);t=r!==!1&&Dy(t)}while(t&&(!r||r(t,s))&&t!==Object.prototype);return s},A3=(t,s,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=s.length;const a=t.indexOf(s,r);return a!==-1&&a===r},h3=t=>{if(!t)return null;if(Oh(t))return t;let s=t.length;if(!sC(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=t[s];return r},m3=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Dy(Uint8Array)),f3=(t,s)=>{const a=(t&&t[B0]).call(t);let n;for(;(n=a.next())&&!n.done;){const i=n.value;s.call(t,i[0],i[1])}},p3=(t,s)=>{let r;const a=[];for(;(r=t.exec(s))!==null;)a.push(r);return a},x3=Fo("HTMLFormElement"),g3=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),pN=(({hasOwnProperty:t})=>(s,r)=>t.call(s,r))(Object.prototype),v3=Fo("RegExp"),nC=(t,s)=>{const r=Object.getOwnPropertyDescriptors(t),a={};Ef(r,(n,i)=>{let l;(l=s(n,i,t))!==!1&&(a[i]=l||n)}),Object.defineProperties(t,a)},b3=t=>{nC(t,(s,r)=>{if(el(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=t[r];if(el(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},y3=(t,s)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return Oh(t)?a(t):a(String(t).split(s)),r},j3=()=>{},N3=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function w3(t){return!!(t&&el(t.append)&&t[eC]==="FormData"&&t[B0])}const _3=t=>{const s=new Array(10),r=(a,n)=>{if(kf(a)){if(s.indexOf(a)>=0)return;if(Bf(a))return a;if(!("toJSON"in a)){s[n]=a;const i=Oh(a)?[]:{};return Ef(a,(l,o)=>{const u=r(l,n+1);!Eh(u)&&(i[o]=u)}),s[n]=void 0,i}}return a};return r(t,0)},S3=Fo("AsyncFunction"),C3=t=>t&&(kf(t)||el(t))&&el(t.then)&&el(t.catch),iC=((t,s)=>t?setImmediate:s?((r,a)=>(eA.addEventListener("message",({source:n,data:i})=>{n===eA&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),eA.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",el(eA.postMessage)),B3=typeof queueMicrotask<"u"?queueMicrotask.bind(eA):typeof process<"u"&&process.nextTick||iC,k3=t=>t!=null&&el(t[B0]),Wt={isArray:Oh,isArrayBuffer:tC,isBuffer:Bf,isFormData:t3,isArrayBufferView:WF,isString:GF,isNumber:sC,isBoolean:KF,isObject:kf,isPlainObject:yx,isEmptyObject:zF,isReadableStream:r3,isRequest:a3,isResponse:n3,isHeaders:i3,isUndefined:Eh,isDate:YF,isFile:XF,isBlob:JF,isRegExp:v3,isFunction:el,isStream:e3,isURLSearchParams:s3,isTypedArray:m3,isFileList:ZF,forEach:Ef,merge:_b,extend:o3,trim:l3,stripBOM:c3,inherits:d3,toFlatObject:u3,kindOf:k0,kindOfTest:Fo,endsWith:A3,toArray:h3,forEachEntry:f3,matchAll:p3,isHTMLForm:x3,hasOwnProperty:pN,hasOwnProp:pN,reduceDescriptors:nC,freezeMethods:b3,toObjectSet:y3,toCamelCase:g3,noop:j3,toFiniteNumber:N3,findKey:rC,global:eA,isContextDefined:aC,isSpecCompliantForm:w3,toJSONObject:_3,isAsyncFn:S3,isThenable:C3,setImmediate:iC,asap:B3,isIterable:k3};function nr(t,s,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}Wt.inherits(nr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Wt.toJSONObject(this.config),code:this.code,status:this.status}}});const lC=nr.prototype,oC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{oC[t]={value:t}});Object.defineProperties(nr,oC);Object.defineProperty(lC,"isAxiosError",{value:!0});nr.from=(t,s,r,a,n,i)=>{const l=Object.create(lC);Wt.toFlatObject(t,l,function(c){return c!==Error.prototype},d=>d!=="isAxiosError");const o=t&&t.message?t.message:"Error",u=s==null&&t?t.code:s;return nr.call(l,o,u,r,a,n),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",i&&Object.assign(l,i),l};const E3=null;function Sb(t){return Wt.isPlainObject(t)||Wt.isArray(t)}function cC(t){return Wt.endsWith(t,"[]")?t.slice(0,-2):t}function xN(t,s,r){return t?t.concat(s).map(function(n,i){return n=cC(n),!r&&i?"["+n+"]":n}).join(r?".":""):s}function F3(t){return Wt.isArray(t)&&!t.some(Sb)}const T3=Wt.toFlatObject(Wt,{},null,function(s){return/^is[A-Z]/.test(s)});function F0(t,s,r){if(!Wt.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,r=Wt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,b){return!Wt.isUndefined(b[g])});const a=r.metaTokens,n=r.visitor||c,i=r.dots,l=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&Wt.isSpecCompliantForm(s);if(!Wt.isFunction(n))throw new TypeError("visitor must be a function");function d(x){if(x===null)return"";if(Wt.isDate(x))return x.toISOString();if(Wt.isBoolean(x))return x.toString();if(!u&&Wt.isBlob(x))throw new nr("Blob is not supported. Use a Buffer instead.");return Wt.isArrayBuffer(x)||Wt.isTypedArray(x)?u&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function c(x,g,b){let y=x;if(x&&!b&&typeof x=="object"){if(Wt.endsWith(g,"{}"))g=a?g:g.slice(0,-2),x=JSON.stringify(x);else if(Wt.isArray(x)&&F3(x)||(Wt.isFileList(x)||Wt.endsWith(g,"[]"))&&(y=Wt.toArray(x)))return g=cC(g),y.forEach(function(j,S){!(Wt.isUndefined(j)||j===null)&&s.append(l===!0?xN([g],S,i):l===null?g:g+"[]",d(j))}),!1}return Sb(x)?!0:(s.append(xN(b,g,i),d(x)),!1)}const m=[],h=Object.assign(T3,{defaultVisitor:c,convertValue:d,isVisitable:Sb});function f(x,g){if(!Wt.isUndefined(x)){if(m.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));m.push(x),Wt.forEach(x,function(y,N){(!(Wt.isUndefined(y)||y===null)&&n.call(s,y,Wt.isString(N)?N.trim():N,g,h))===!0&&f(y,g?g.concat(N):[N])}),m.pop()}}if(!Wt.isObject(t))throw new TypeError("data must be an object");return f(t),s}function gN(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function Py(t,s){this._pairs=[],t&&F0(t,this,s)}const dC=Py.prototype;dC.append=function(s,r){this._pairs.push([s,r])};dC.toString=function(s){const r=s?function(a){return s.call(this,a,gN)}:gN;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function I3(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function uC(t,s,r){if(!s)return t;const a=r&&r.encode||I3;Wt.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(s,r):i=Wt.isURLSearchParams(s)?s.toString():new Py(s,r).toString(a),i){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class vN{constructor(){this.handlers=[]}use(s,r,a){return this.handlers.push({fulfilled:s,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){Wt.forEach(this.handlers,function(a){a!==null&&s(a)})}}const AC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},L3=typeof URLSearchParams<"u"?URLSearchParams:Py,D3=typeof FormData<"u"?FormData:null,P3=typeof Blob<"u"?Blob:null,U3={isBrowser:!0,classes:{URLSearchParams:L3,FormData:D3,Blob:P3},protocols:["http","https","file","blob","url","data"]},Uy=typeof window<"u"&&typeof document<"u",Cb=typeof navigator=="object"&&navigator||void 0,R3=Uy&&(!Cb||["ReactNative","NativeScript","NS"].indexOf(Cb.product)<0),O3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Q3=Uy&&window.location.href||"http://localhost",M3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Uy,hasStandardBrowserEnv:R3,hasStandardBrowserWebWorkerEnv:O3,navigator:Cb,origin:Q3},Symbol.toStringTag,{value:"Module"})),fi={...M3,...U3};function H3(t,s){return F0(t,new fi.classes.URLSearchParams,{visitor:function(r,a,n,i){return fi.isNode&&Wt.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...s})}function q3(t){return Wt.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function V3(t){const s={},r=Object.keys(t);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],s[i]=t[i];return s}function hC(t){function s(r,a,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),u=i>=r.length;return l=!l&&Wt.isArray(n)?n.length:l,u?(Wt.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!Wt.isObject(n[l]))&&(n[l]=[]),s(r,a,n[l],i)&&Wt.isArray(n[l])&&(n[l]=V3(n[l])),!o)}if(Wt.isFormData(t)&&Wt.isFunction(t.entries)){const r={};return Wt.forEachEntry(t,(a,n)=>{s(q3(a),n,r,0)}),r}return null}function $3(t,s,r){if(Wt.isString(t))try{return(s||JSON.parse)(t),Wt.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(t)}const Ff={transitional:AC,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=Wt.isObject(s);if(i&&Wt.isHTMLForm(s)&&(s=new FormData(s)),Wt.isFormData(s))return n?JSON.stringify(hC(s)):s;if(Wt.isArrayBuffer(s)||Wt.isBuffer(s)||Wt.isStream(s)||Wt.isFile(s)||Wt.isBlob(s)||Wt.isReadableStream(s))return s;if(Wt.isArrayBufferView(s))return s.buffer;if(Wt.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return H3(s,this.formSerializer).toString();if((o=Wt.isFileList(s))||a.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return F0(o?{"files[]":s}:s,u&&new u,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),$3(s)):s}],transformResponse:[function(s){const r=this.transitional||Ff.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(Wt.isResponse(s)||Wt.isReadableStream(s))return s;if(s&&Wt.isString(s)&&(a&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(s,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?nr.from(o,nr.ERR_BAD_RESPONSE,this,null,this.response):o}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:fi.classes.FormData,Blob:fi.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Wt.forEach(["delete","get","head","post","put","patch"],t=>{Ff.headers[t]={}});const W3=Wt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),G3=t=>{const s={};let r,a,n;return t&&t.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!r||s[r]&&W3[r])&&(r==="set-cookie"?s[r]?s[r].push(a):s[r]=[a]:s[r]=s[r]?s[r]+", "+a:a)}),s},bN=Symbol("internals");function hm(t){return t&&String(t).trim().toLowerCase()}function jx(t){return t===!1||t==null?t:Wt.isArray(t)?t.map(jx):String(t)}function K3(t){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(t);)s[a[1]]=a[2];return s}const z3=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function iv(t,s,r,a,n){if(Wt.isFunction(a))return a.call(this,s,r);if(n&&(s=r),!!Wt.isString(s)){if(Wt.isString(a))return s.indexOf(a)!==-1;if(Wt.isRegExp(a))return a.test(s)}}function Y3(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,a)=>r.toUpperCase()+a)}function X3(t,s){const r=Wt.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+r,{value:function(n,i,l){return this[a].call(this,s,n,i,l)},configurable:!0})})}let tl=class{constructor(s){s&&this.set(s)}set(s,r,a){const n=this;function i(o,u,d){const c=hm(u);if(!c)throw new Error("header name must be a non-empty string");const m=Wt.findKey(n,c);(!m||n[m]===void 0||d===!0||d===void 0&&n[m]!==!1)&&(n[m||u]=jx(o))}const l=(o,u)=>Wt.forEach(o,(d,c)=>i(d,c,u));if(Wt.isPlainObject(s)||s instanceof this.constructor)l(s,r);else if(Wt.isString(s)&&(s=s.trim())&&!z3(s))l(G3(s),r);else if(Wt.isObject(s)&&Wt.isIterable(s)){let o={},u,d;for(const c of s){if(!Wt.isArray(c))throw TypeError("Object iterator must return a key-value pair");o[d=c[0]]=(u=o[d])?Wt.isArray(u)?[...u,c[1]]:[u,c[1]]:c[1]}l(o,r)}else s!=null&&i(r,s,a);return this}get(s,r){if(s=hm(s),s){const a=Wt.findKey(this,s);if(a){const n=this[a];if(!r)return n;if(r===!0)return K3(n);if(Wt.isFunction(r))return r.call(this,n,a);if(Wt.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=hm(s),s){const a=Wt.findKey(this,s);return!!(a&&this[a]!==void 0&&(!r||iv(this,this[a],a,r)))}return!1}delete(s,r){const a=this;let n=!1;function i(l){if(l=hm(l),l){const o=Wt.findKey(a,l);o&&(!r||iv(a,a[o],o,r))&&(delete a[o],n=!0)}}return Wt.isArray(s)?s.forEach(i):i(s),n}clear(s){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!s||iv(this,this[i],i,s,!0))&&(delete this[i],n=!0)}return n}normalize(s){const r=this,a={};return Wt.forEach(this,(n,i)=>{const l=Wt.findKey(a,i);if(l){r[l]=jx(n),delete r[i];return}const o=s?Y3(i):String(i).trim();o!==i&&delete r[i],r[o]=jx(n),a[o]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return Wt.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=s&&Wt.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const a=new this(s);return r.forEach(n=>a.set(n)),a}static accessor(s){const a=(this[bN]=this[bN]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=hm(l);a[o]||(X3(n,l),a[o]=!0)}return Wt.isArray(s)?s.forEach(i):i(s),this}};tl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Wt.reduceDescriptors(tl.prototype,({value:t},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[r]=a}}});Wt.freezeMethods(tl);function lv(t,s){const r=this||Ff,a=s||r,n=tl.from(a.headers);let i=a.data;return Wt.forEach(t,function(o){i=o.call(r,i,n.normalize(),s?s.status:void 0)}),n.normalize(),i}function mC(t){return!!(t&&t.__CANCEL__)}function Qh(t,s,r){nr.call(this,t??"canceled",nr.ERR_CANCELED,s,r),this.name="CanceledError"}Wt.inherits(Qh,nr,{__CANCEL__:!0});function fC(t,s,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?t(r):s(new nr("Request failed with status code "+r.status,[nr.ERR_BAD_REQUEST,nr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function J3(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function Z3(t,s){t=t||10;const r=new Array(t),a=new Array(t);let n=0,i=0,l;return s=s!==void 0?s:1e3,function(u){const d=Date.now(),c=a[i];l||(l=d),r[n]=u,a[n]=d;let m=i,h=0;for(;m!==n;)h+=r[m++],m=m%t;if(n=(n+1)%t,n===i&&(i=(i+1)%t),d-l<s)return;const f=c&&d-c;return f?Math.round(h*1e3/f):void 0}}function eT(t,s){let r=0,a=1e3/s,n,i;const l=(d,c=Date.now())=>{r=c,n=null,i&&(clearTimeout(i),i=null),t(...d)};return[(...d)=>{const c=Date.now(),m=c-r;m>=a?l(d,c):(n=d,i||(i=setTimeout(()=>{i=null,l(n)},a-m)))},()=>n&&l(n)]}const Rx=(t,s,r=3)=>{let a=0;const n=Z3(50,250);return eT(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,u=l-a,d=n(u),c=l<=o;a=l;const m={loaded:l,total:o,progress:o?l/o:void 0,bytes:u,rate:d||void 0,estimated:d&&o&&c?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[s?"download":"upload"]:!0};t(m)},r)},yN=(t,s)=>{const r=t!=null;return[a=>s[0]({lengthComputable:r,total:t,loaded:a}),s[1]]},jN=t=>(...s)=>Wt.asap(()=>t(...s)),tT=fi.hasStandardBrowserEnv?((t,s)=>r=>(r=new URL(r,fi.origin),t.protocol===r.protocol&&t.host===r.host&&(s||t.port===r.port)))(new URL(fi.origin),fi.navigator&&/(msie|trident)/i.test(fi.navigator.userAgent)):()=>!0,sT=fi.hasStandardBrowserEnv?{write(t,s,r,a,n,i,l){if(typeof document>"u")return;const o=[`${t}=${encodeURIComponent(s)}`];Wt.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Wt.isString(a)&&o.push(`path=${a}`),Wt.isString(n)&&o.push(`domain=${n}`),i===!0&&o.push("secure"),Wt.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function rT(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function aT(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function pC(t,s,r){let a=!rT(s);return t&&(a||r==!1)?aT(t,s):s}const NN=t=>t instanceof tl?{...t}:t;function fA(t,s){s=s||{};const r={};function a(d,c,m,h){return Wt.isPlainObject(d)&&Wt.isPlainObject(c)?Wt.merge.call({caseless:h},d,c):Wt.isPlainObject(c)?Wt.merge({},c):Wt.isArray(c)?c.slice():c}function n(d,c,m,h){if(Wt.isUndefined(c)){if(!Wt.isUndefined(d))return a(void 0,d,m,h)}else return a(d,c,m,h)}function i(d,c){if(!Wt.isUndefined(c))return a(void 0,c)}function l(d,c){if(Wt.isUndefined(c)){if(!Wt.isUndefined(d))return a(void 0,d)}else return a(void 0,c)}function o(d,c,m){if(m in s)return a(d,c);if(m in t)return a(void 0,d)}const u={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,c,m)=>n(NN(d),NN(c),m,!0)};return Wt.forEach(Object.keys({...t,...s}),function(c){const m=u[c]||n,h=m(t[c],s[c],c);Wt.isUndefined(h)&&m!==o||(r[c]=h)}),r}const xC=t=>{const s=fA({},t);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=s;if(s.headers=l=tl.from(l),s.url=uC(pC(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Wt.isFormData(r)){if(fi.hasStandardBrowserEnv||fi.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(Wt.isFunction(r.getHeaders)){const u=r.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([c,m])=>{d.includes(c.toLowerCase())&&l.set(c,m)})}}if(fi.hasStandardBrowserEnv&&(a&&Wt.isFunction(a)&&(a=a(s)),a||a!==!1&&tT(s.url))){const u=n&&i&&sT.read(i);u&&l.set(n,u)}return s},nT=typeof XMLHttpRequest<"u",iT=nT&&function(t){return new Promise(function(r,a){const n=xC(t);let i=n.data;const l=tl.from(n.headers).normalize();let{responseType:o,onUploadProgress:u,onDownloadProgress:d}=n,c,m,h,f,x;function g(){f&&f(),x&&x(),n.cancelToken&&n.cancelToken.unsubscribe(c),n.signal&&n.signal.removeEventListener("abort",c)}let b=new XMLHttpRequest;b.open(n.method.toUpperCase(),n.url,!0),b.timeout=n.timeout;function y(){if(!b)return;const j=tl.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),k={data:!o||o==="text"||o==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:j,config:t,request:b};fC(function(I){r(I),g()},function(I){a(I),g()},k),b=null}"onloadend"in b?b.onloadend=y:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(y)},b.onabort=function(){b&&(a(new nr("Request aborted",nr.ECONNABORTED,t,b)),b=null)},b.onerror=function(S){const k=S&&S.message?S.message:"Network Error",P=new nr(k,nr.ERR_NETWORK,t,b);P.event=S||null,a(P),b=null},b.ontimeout=function(){let S=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const k=n.transitional||AC;n.timeoutErrorMessage&&(S=n.timeoutErrorMessage),a(new nr(S,k.clarifyTimeoutError?nr.ETIMEDOUT:nr.ECONNABORTED,t,b)),b=null},i===void 0&&l.setContentType(null),"setRequestHeader"in b&&Wt.forEach(l.toJSON(),function(S,k){b.setRequestHeader(k,S)}),Wt.isUndefined(n.withCredentials)||(b.withCredentials=!!n.withCredentials),o&&o!=="json"&&(b.responseType=n.responseType),d&&([h,x]=Rx(d,!0),b.addEventListener("progress",h)),u&&b.upload&&([m,f]=Rx(u),b.upload.addEventListener("progress",m),b.upload.addEventListener("loadend",f)),(n.cancelToken||n.signal)&&(c=j=>{b&&(a(!j||j.type?new Qh(null,t,b):j),b.abort(),b=null)},n.cancelToken&&n.cancelToken.subscribe(c),n.signal&&(n.signal.aborted?c():n.signal.addEventListener("abort",c)));const N=J3(n.url);if(N&&fi.protocols.indexOf(N)===-1){a(new nr("Unsupported protocol "+N+":",nr.ERR_BAD_REQUEST,t));return}b.send(i||null)})},lT=(t,s)=>{const{length:r}=t=t?t.filter(Boolean):[];if(s||r){let a=new AbortController,n;const i=function(d){if(!n){n=!0,o();const c=d instanceof Error?d:this.reason;a.abort(c instanceof nr?c:new Qh(c instanceof Error?c.message:c))}};let l=s&&setTimeout(()=>{l=null,i(new nr(`timeout ${s} of ms exceeded`,nr.ETIMEDOUT))},s);const o=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),t=null)};t.forEach(d=>d.addEventListener("abort",i));const{signal:u}=a;return u.unsubscribe=()=>Wt.asap(o),u}},oT=function*(t,s){let r=t.byteLength;if(r<s){yield t;return}let a=0,n;for(;a<r;)n=a+s,yield t.slice(a,n),a=n},cT=async function*(t,s){for await(const r of dT(t))yield*oT(r,s)},dT=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:r,value:a}=await s.read();if(r)break;yield a}}finally{await s.cancel()}},wN=(t,s,r,a)=>{const n=cT(t,s);let i=0,l,o=u=>{l||(l=!0,a&&a(u))};return new ReadableStream({async pull(u){try{const{done:d,value:c}=await n.next();if(d){o(),u.close();return}let m=c.byteLength;if(r){let h=i+=m;r(h)}u.enqueue(new Uint8Array(c))}catch(d){throw o(d),d}},cancel(u){return o(u),n.return()}},{highWaterMark:2})},_N=64*1024,{isFunction:Bp}=Wt,uT=(({Request:t,Response:s})=>({Request:t,Response:s}))(Wt.global),{ReadableStream:SN,TextEncoder:CN}=Wt.global,BN=(t,...s)=>{try{return!!t(...s)}catch{return!1}},AT=t=>{t=Wt.merge.call({skipUndefined:!0},uT,t);const{fetch:s,Request:r,Response:a}=t,n=s?Bp(s):typeof fetch=="function",i=Bp(r),l=Bp(a);if(!n)return!1;const o=n&&Bp(SN),u=n&&(typeof CN=="function"?(x=>g=>x.encode(g))(new CN):async x=>new Uint8Array(await new r(x).arrayBuffer())),d=i&&o&&BN(()=>{let x=!1;const g=new r(fi.origin,{body:new SN,method:"POST",get duplex(){return x=!0,"half"}}).headers.has("Content-Type");return x&&!g}),c=l&&o&&BN(()=>Wt.isReadableStream(new a("").body)),m={stream:c&&(x=>x.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(x=>{!m[x]&&(m[x]=(g,b)=>{let y=g&&g[x];if(y)return y.call(g);throw new nr(`Response type '${x}' is not supported`,nr.ERR_NOT_SUPPORT,b)})});const h=async x=>{if(x==null)return 0;if(Wt.isBlob(x))return x.size;if(Wt.isSpecCompliantForm(x))return(await new r(fi.origin,{method:"POST",body:x}).arrayBuffer()).byteLength;if(Wt.isArrayBufferView(x)||Wt.isArrayBuffer(x))return x.byteLength;if(Wt.isURLSearchParams(x)&&(x=x+""),Wt.isString(x))return(await u(x)).byteLength},f=async(x,g)=>{const b=Wt.toFiniteNumber(x.getContentLength());return b??h(g)};return async x=>{let{url:g,method:b,data:y,signal:N,cancelToken:j,timeout:S,onDownloadProgress:k,onUploadProgress:P,responseType:I,headers:B,withCredentials:q="same-origin",fetchOptions:Q}=xC(x),O=s||fetch;I=I?(I+"").toLowerCase():"text";let T=lT([N,j&&j.toAbortSignal()],S),V=null;const D=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let Y;try{if(P&&d&&b!=="get"&&b!=="head"&&(Y=await f(B,y))!==0){let K=new r(g,{method:"POST",body:y,duplex:"half"}),_;if(Wt.isFormData(y)&&(_=K.headers.get("content-type"))&&B.setContentType(_),K.body){const[F,E]=yN(Y,Rx(jN(P)));y=wN(K.body,_N,F,E)}}Wt.isString(q)||(q=q?"include":"omit");const M=i&&"credentials"in r.prototype,X={...Q,signal:T,method:b.toUpperCase(),headers:B.normalize().toJSON(),body:y,duplex:"half",credentials:M?q:void 0};V=i&&new r(g,X);let R=await(i?O(V,Q):O(g,X));const H=c&&(I==="stream"||I==="response");if(c&&(k||H&&D)){const K={};["status","statusText","headers"].forEach(L=>{K[L]=R[L]});const _=Wt.toFiniteNumber(R.headers.get("content-length")),[F,E]=k&&yN(_,Rx(jN(k),!0))||[];R=new a(wN(R.body,_N,F,()=>{E&&E(),D&&D()}),K)}I=I||"text";let W=await m[Wt.findKey(m,I)||"text"](R,x);return!H&&D&&D(),await new Promise((K,_)=>{fC(K,_,{data:W,headers:tl.from(R.headers),status:R.status,statusText:R.statusText,config:x,request:V})})}catch(M){throw D&&D(),M&&M.name==="TypeError"&&/Load failed|fetch/i.test(M.message)?Object.assign(new nr("Network Error",nr.ERR_NETWORK,x,V),{cause:M.cause||M}):nr.from(M,M&&M.code,x,V)}}},hT=new Map,gC=t=>{let s=t&&t.env||{};const{fetch:r,Request:a,Response:n}=s,i=[a,n,r];let l=i.length,o=l,u,d,c=hT;for(;o--;)u=i[o],d=c.get(u),d===void 0&&c.set(u,d=o?new Map:AT(s)),c=d;return d};gC();const Ry={http:E3,xhr:iT,fetch:{get:gC}};Wt.forEach(Ry,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const kN=t=>`- ${t}`,mT=t=>Wt.isFunction(t)||t===null||t===!1;function fT(t,s){t=Wt.isArray(t)?t:[t];const{length:r}=t;let a,n;const i={};for(let l=0;l<r;l++){a=t[l];let o;if(n=a,!mT(a)&&(n=Ry[(o=String(a)).toLowerCase()],n===void 0))throw new nr(`Unknown adapter '${o}'`);if(n&&(Wt.isFunction(n)||(n=n.get(s))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(kN).join(`
`):" "+kN(l[0]):"as no adapter specified";throw new nr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n}const vC={getAdapter:fT,adapters:Ry};function ov(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Qh(null,t)}function EN(t){return ov(t),t.headers=tl.from(t.headers),t.data=lv.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),vC.getAdapter(t.adapter||Ff.adapter,t)(t).then(function(a){return ov(t),a.data=lv.call(t,t.transformResponse,a),a.headers=tl.from(a.headers),a},function(a){return mC(a)||(ov(t),a&&a.response&&(a.response.data=lv.call(t,t.transformResponse,a.response),a.response.headers=tl.from(a.response.headers))),Promise.reject(a)})}const bC="1.13.2",T0={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{T0[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const FN={};T0.transitional=function(s,r,a){function n(i,l){return"[Axios v"+bC+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(s===!1)throw new nr(n(l," has been removed"+(r?" in "+r:"")),nr.ERR_DEPRECATED);return r&&!FN[l]&&(FN[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(i,l,o):!0}};T0.spelling=function(s){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function pT(t,s,r){if(typeof t!="object")throw new nr("options must be an object",nr.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let n=a.length;for(;n-- >0;){const i=a[n],l=s[i];if(l){const o=t[i],u=o===void 0||l(o,i,t);if(u!==!0)throw new nr("option "+i+" must be "+u,nr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new nr("Unknown option "+i,nr.ERR_BAD_OPTION)}}const Nx={assertOptions:pT,validators:T0},Zo=Nx.validators;let lA=class{constructor(s){this.defaults=s||{},this.interceptors={request:new vN,response:new vN}}async request(s,r){try{return await this._request(s,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=fA(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&Nx.assertOptions(a,{silentJSONParsing:Zo.transitional(Zo.boolean),forcedJSONParsing:Zo.transitional(Zo.boolean),clarifyTimeoutError:Zo.transitional(Zo.boolean)},!1),n!=null&&(Wt.isFunction(n)?r.paramsSerializer={serialize:n}:Nx.assertOptions(n,{encode:Zo.function,serialize:Zo.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Nx.assertOptions(r,{baseUrl:Zo.spelling("baseURL"),withXsrfToken:Zo.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&Wt.merge(i.common,i[r.method]);i&&Wt.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),r.headers=tl.concat(l,i);const o=[];let u=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(u=u&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let c,m=0,h;if(!u){const x=[EN.bind(this),void 0];for(x.unshift(...o),x.push(...d),h=x.length,c=Promise.resolve(r);m<h;)c=c.then(x[m++],x[m++]);return c}h=o.length;let f=r;for(;m<h;){const x=o[m++],g=o[m++];try{f=x(f)}catch(b){g.call(this,b);break}}try{c=EN.call(this,f)}catch(x){return Promise.reject(x)}for(m=0,h=d.length;m<h;)c=c.then(d[m++],d[m++]);return c}getUri(s){s=fA(this.defaults,s);const r=pC(s.baseURL,s.url,s.allowAbsoluteUrls);return uC(r,s.params,s.paramsSerializer)}};Wt.forEach(["delete","get","head","options"],function(s){lA.prototype[s]=function(r,a){return this.request(fA(a||{},{method:s,url:r,data:(a||{}).data}))}});Wt.forEach(["post","put","patch"],function(s){function r(a){return function(i,l,o){return this.request(fA(o||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}lA.prototype[s]=r(),lA.prototype[s+"Form"]=r(!0)});let xT=class yC{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},s(function(i,l,o){a.reason||(a.reason=new Qh(i,l,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=a=>{s.abort(a)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new yC(function(n){s=n}),cancel:s}}};function gT(t){return function(r){return t.apply(null,r)}}function vT(t){return Wt.isObject(t)&&t.isAxiosError===!0}const Bb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Bb).forEach(([t,s])=>{Bb[s]=t});function jC(t){const s=new lA(t),r=ZS(lA.prototype.request,s);return Wt.extend(r,lA.prototype,s,{allOwnKeys:!0}),Wt.extend(r,s,null,{allOwnKeys:!0}),r.create=function(n){return jC(fA(t,n))},r}const Ja=jC(Ff);Ja.Axios=lA;Ja.CanceledError=Qh;Ja.CancelToken=xT;Ja.isCancel=mC;Ja.VERSION=bC;Ja.toFormData=F0;Ja.AxiosError=nr;Ja.Cancel=Ja.CanceledError;Ja.all=function(s){return Promise.all(s)};Ja.spread=gT;Ja.isAxiosError=vT;Ja.mergeConfig=fA;Ja.AxiosHeaders=tl;Ja.formToJSON=t=>hC(Wt.isHTMLForm(t)?new FormData(t):t);Ja.getAdapter=vC.getAdapter;Ja.HttpStatusCode=Bb;Ja.default=Ja;const{Axios:oee,AxiosError:cee,CanceledError:dee,isCancel:uee,CancelToken:Aee,VERSION:hee,all:mee,Cancel:fee,isAxiosError:pee,spread:xee,toFormData:gee,AxiosHeaders:vee,HttpStatusCode:bee,formToJSON:yee,getAdapter:jee,mergeConfig:Nee}=Ja;function bT(){const t=self.crypto||window.crypto;if(t!=null&&t.randomUUID)return t.randomUUID();const s=new Uint8Array(16);((t==null?void 0:t.getRandomValues)||(n=>n))(s),s[6]=s[6]&15|64,s[8]=s[8]&63|128;const a=Array.from(s,n=>n.toString(16).padStart(2,"0")).join("");return`${a.slice(0,8)}-${a.slice(8,12)}-${a.slice(12,16)}-${a.slice(16,20)}-${a.slice(20)}`}const yT="omnisuite_offline",jT=1,cc="queue";function I0(){return new Promise((t,s)=>{const r=indexedDB.open(yT,jT);r.onupgradeneeded=a=>{const n=r.result;if(!n.objectStoreNames.contains(cc)){const i=n.createObjectStore(cc,{keyPath:"id"});i.createIndex("status","status",{unique:!1}),i.createIndex("createdAt","createdAt",{unique:!1})}},r.onsuccess=()=>t(r.result),r.onerror=()=>s(r.error)})}async function NC(t){const s=await I0();return new Promise((r,a)=>{const n=s.transaction(cc,"readwrite");n.objectStore(cc).put(t),n.oncomplete=()=>r(t),n.onerror=()=>a(n.error)})}async function NT(){const t=await I0();return new Promise((s,r)=>{const l=t.transaction(cc,"readonly").objectStore(cc).index("status").getAll("pending");l.onsuccess=()=>s(l.result||[]),l.onerror=()=>r(l.error)})}async function TN(t,s,r){const a=await I0();return new Promise((n,i)=>{const l=a.transaction(cc,"readwrite"),o=l.objectStore(cc),u=o.get(t);u.onsuccess=()=>{const d=u.result;if(!d)return n(null);d.status=s,d.response=r||null,o.put(d)},l.oncomplete=()=>n(!0),l.onerror=()=>i(l.error)})}async function Oy(){const t=await I0();return new Promise((s,r)=>{const i=t.transaction(cc,"readonly").objectStore(cc).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>r(i.error)})}const wT=5;let wx=[],Nl={pending:0,failed:0,completed:0,items:[]},cv=!1,IN=null;function Tf(t,s){Nl=(s==null?void 0:s.snapshot)||Nl;for(const r of wx)try{r({event:t,payload:s,snapshot:Nl})}catch{}}async function Fh(){const t=await Oy(),s=t.filter(n=>n.status==="pending").length,r=t.filter(n=>n.status==="failed").length,a=t.filter(n=>n.status==="completed").length;Nl={pending:s,failed:r,completed:a,items:t},Tf("update",{snapshot:Nl})}function _T(t){return wx.push(t),t({event:"init",payload:{},snapshot:Nl}),()=>{wx=wx.filter(s=>s!==t)}}function wC(){return Nl}async function ST({method:t,url:s,data:r,headers:a}){const n=bT(),i={id:n,method:t,url:s,data:r,headers:{...a||{},"x-idempotency-key":n,"x-transaction-id":n},status:"pending",retries:0,createdAt:Date.now()};return await NC(i),await Fh(),Tf("queued",{id:n,item:i,snapshot:Nl}),navigator.onLine&&_m(),{id:n,queued:!0,offline:!navigator.onLine}}async function Qy(t){try{const s=await te.request({method:t.method,url:t.url,data:t.data,headers:t.headers});return await TN(t.id,"completed",(s==null?void 0:s.data)||null),await Fh(),!0}catch{if(t.retries+=1,t.retries>=wT)return await TN(t.id,"failed",null),await Fh(),!1;const s=Math.min(3e4,1e3*2**t.retries);return await new Promise(r=>setTimeout(r,s)),Qy(t)}}async function _m(){if(cv)return;cv=!0;const t=await NT();for(const s of t)await Qy(s);await Fh(),Tf("synced",{snapshot:Nl}),cv=!1}function CT(){window.addEventListener("online",()=>{kT(),_m()}),navigator.onLine&&_m(),IN||(IN=setInterval(()=>{navigator.onLine&&_m()},3e4)),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&navigator.onLine&&_m()})}async function BT(t){const r=(Nl.items||await Oy()).find(a=>a.id===t);return r?(r.retries=0,r.status="pending",await NC(r),await Fh(),Tf("retry",{id:t,snapshot:Nl}),Qy(r)):!1}async function kT(){const s=(Nl.items||await Oy()).filter(r=>r.status==="failed");for(const r of s)await BT(r.id);await Fh(),Tf("retryAll",{snapshot:Nl})}const ET={},te=Ja.create({headers:{"Content-Type":"application/json"},transformRequest:[(t,s)=>t&&typeof t=="object"&&!(t instanceof FormData)?JSON.stringify(t):t]}),LN=typeof window<"u"&&window.location?window.location.origin:"",FT=typeof window<"u"&&(window.__OMNI_API_BASE__||localStorage.getItem("omni.apiBase"))||"",TT=typeof import.meta<"u"&&ET?"https://serianaserver.omnisuite-erp.com/":"";te.defaults.baseURL=FT||TT||(LN?LN+"/api":"/api");CT();te.interceptors.request.use(async t=>{const s=String(t.method||"get").toLowerCase();if(["post","put","patch","delete"].includes(s)&&!navigator.onLine){const r=await ST({method:s,url:t.url,data:t.data,headers:t.headers});return Promise.reject({isOfflineQueued:!0,queued:r,config:t,snapshot:wC()})}return t},t=>Promise.reject(t));te.interceptors.response.use(t=>t&&typeof t=="object"?t:{data:t,status:200,statusText:"OK",headers:{},config:(t==null?void 0:t.config)||{}},t=>{var s,r,a,n;return t&&t.isOfflineQueued?Promise.resolve({data:{queued:!0,offline:!0,id:(s=t.queued)==null?void 0:s.id,snapshot:t.snapshot},status:202,statusText:"Accepted (queued)",headers:{},config:t.config}):(((r=t.response)==null?void 0:r.status)===401&&((n=(a=t.config)==null?void 0:a.headers)!=null&&n.Authorization)&&(localStorage.clear(),window.location.href="/login"),Promise.reject({message:t.message,response:t.response,config:t.config,isAxiosError:!0}))});function DN(t){t?te.defaults.headers.common.Authorization=`Bearer ${t}`:delete te.defaults.headers.common.Authorization}function IT({companyId:t,branchId:s}){t&&(te.defaults.headers.common["x-company-id"]=String(t)),s&&(te.defaults.headers.common["x-branch-id"]=String(s))}function LT(t){const s=t&&typeof t.id<"u"?Number(t.id):t&&typeof t.sub<"u"?Number(t.sub):null;s&&Number.isFinite(s)?te.defaults.headers.common["x-user-id"]=String(s):delete te.defaults.headers.common["x-user-id"]}const _C=v.createContext(null),dv="omnisuite.auth";function DT({children:t}){const[s,r]=v.useState(null),[a,n]=v.useState({sub:0,id:0,username:"dev",email:"dev@local",permissions:["*"],companyIds:[1],branchIds:[1]}),[i,l]=v.useState({companyId:1,branchId:1}),[o,u]=v.useState(!1),[d,c]=v.useState({patterns:[],modules:[]});v.useEffect(()=>{const j=localStorage.getItem(dv);if(j)try{const S=JSON.parse(j);S!=null&&S.token&&(r(S.token),n(S.user||null),l(S.scope||{companyId:1,branchId:1}))}catch{}u(!0)},[]),v.useLayoutEffect(()=>{DN(s)},[s]),v.useLayoutEffect(()=>{IT(i)},[i]),v.useLayoutEffect(()=>{LT(a||null)},[a]),v.useEffect(()=>{localStorage.setItem(dv,JSON.stringify({token:s,user:a,scope:i}))},[s,a,i]);async function m({username:j,password:S}){const k=await te.post("/login",{username:j,password:S});return r(k.data.token),n(k.data.user),await g(k.data.user),k.data}v.useEffect(()=>{s&&a&&g(a)},[s,a]);function h(){r(null),n(null),l({companyId:1,branchId:1}),DN(null);try{localStorage.removeItem(dv)}catch{}c({patterns:[],modules:[]})}function f(j){const S="^"+String(j||"").replace(/:[^/]+/g,"[^/]+")+"$";return new RegExp(S)}function x(j=[],S=[]){const k={};for(const Q of j)k[Q.id]=Q;const P={};for(const Q of j)Q!=null&&Q.path&&(P[Q.path]={path:Q.path,module:Q.module||"",can_view:1,can_create:0,can_edit:0,can_delete:0});for(const Q of S){const O=k[Q.page_id];!O||!O.path||(P[O.path]={path:O.path,module:O.module||"",can_view:Number(Q.can_view)?1:0,can_create:Number(Q.can_create)?1:0,can_edit:Number(Q.can_edit)?1:0,can_delete:Number(Q.can_delete)?1:0})}const I=Object.values(P).map(Q=>({pattern:Q.path,module:Q.module,can_view:Q.can_view,can_create:Q.can_create,can_edit:Q.can_edit,can_delete:Q.can_delete,regex:f(Q.path)})),B=[],q=new Set;for(const Q of I)Q.can_view&&Q.module&&!q.has(Q.module)&&(q.add(Q.module),B.push(Q.module));c({patterns:I,modules:B})}async function g(j){var k,P;const S=Number(j==null?void 0:j.sub)||Number(j==null?void 0:j.id)||Number(a==null?void 0:a.sub)||Number(a==null?void 0:a.id);if(!Number.isFinite(S)||S<=0){c({patterns:[],modules:[]});return}try{const I=await te.get(`/admin/users/${S}/permissions-context`),B=Array.isArray((k=I.data)==null?void 0:k.pages)?I.data.pages:[],q=Array.isArray((P=I.data)==null?void 0:P.permissions)?I.data.permissions:[];x(B,q)}catch{c({patterns:[],modules:[]})}}function b(j,S="view"){if(!Array.isArray(d.patterns)||d.patterns.length===0)return!0;const k=String(j||""),P=/\/edit$/.test(k),I=/(\/new|\/create)$/.test(k);let B=d.patterns.find(q=>q.pattern===k)||d.patterns.find(q=>q.regex.test(k));if(P){const q=k.replace(/\/edit$/,""),Q=d.patterns.find(O=>O.pattern===q)||d.patterns.find(O=>O.regex.test(q));return Q?!!(Q.can_view||Q.can_edit):B?!!(B.can_edit||B.can_view):!0}if(I){const q=k.replace(/\/(new|create)$/,""),Q=d.patterns.find(O=>O.pattern===q)||d.patterns.find(O=>O.regex.test(q));return Q?!!(Q.can_create||Q.can_view):B?!!(B.can_create||B.can_view):!0}return B?S==="create"?!!B.can_create:S==="edit"?!!B.can_edit:S==="delete"?!!B.can_delete:!!B.can_view:!0}function y(j){return!Array.isArray(d.modules)||d.modules.length===0?!0:d.modules.includes(String(j||""))}const N=v.useMemo(()=>({token:s,user:a,scope:i,initialized:o,setScope:l,login:m,logout:h,hasAccess:b,hasModuleAccess:y}),[s,a,i,o,d]);return e.jsx(_C.Provider,{value:N,children:t})}function Qa(){const t=v.useContext(_C);return t||{token:null,user:null,scope:{companyId:1,branchId:1},initialized:!0,setScope:()=>{},login:async()=>({}),logout:()=>{},hasAccess:()=>!0,hasModuleAccess:()=>!0}}const SC=v.createContext(null),PN="omnisuite.theme";function PT({children:t}){const[s,r]=v.useState("light");v.useEffect(()=>{const i=localStorage.getItem(PN);if(i==="light"||i==="dark"){r(i);return}const l=typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches;r(l?"light":"dark")},[]),v.useEffect(()=>{s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem(PN,s)},[s]);function a(){r(i=>i==="dark"?"light":"dark")}const n=v.useMemo(()=>({theme:s,setTheme:r,toggleTheme:a}),[s]);return e.jsx(SC.Provider,{value:n,children:t})}function CC(){const t=v.useContext(SC);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t}function UN({children:t}){const{token:s,initialized:r,user:a,scope:n,setScope:i,hasAccess:l}=Qa(),o=Ba();if(!r)return null;if(!s)return e.jsx(Wc,{to:"/login",replace:!0});const u=Array.isArray(a==null?void 0:a.branchIds)?a.branchIds.map(Number).filter(x=>Number.isFinite(x)):[],d=Number(n==null?void 0:n.branchId);if(u.length<=1){const x=u[0];if(Number.isFinite(x)&&d!==x){const g=Array.isArray(a==null?void 0:a.companyIds)?a.companyIds.map(Number).filter(y=>Number.isFinite(y)):[],b=g.length===1?g[0]:(n==null?void 0:n.companyId)||1;i(y=>({...y,companyId:b,branchId:x}))}if(o.pathname==="/select-branch")return e.jsx(Wc,{to:"/",replace:!0})}else{if(o.pathname==="/select-branch")return t;if(!u.includes(d))return e.jsx(Wc,{to:"/select-branch",replace:!0})}const c=o.pathname;if(c==="/"||c==="/dashboard")return t;const m=/(\/new|\/create)$/.test(c),h=/\/edit$/.test(c);return l(c,m?"create":h?"edit":"view")?t:e.jsx(Wc,{to:"/",replace:!0})}const My="/assets/OMNISUITE_LOGO_CLEAR-E0tTLZi8.png",Hy="/assets/BACKGROUND-DBCOBMBw.jpg";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),RT=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,r,a)=>a?a.toUpperCase():r.toLowerCase()),RN=t=>{const s=RT(t);return s.charAt(0).toUpperCase()+s.slice(1)},BC=(...t)=>t.filter((s,r,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===r).join(" ").trim(),OT=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var QT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MT=v.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:l,...o},u)=>v.createElement("svg",{ref:u,...QT,width:s,height:s,stroke:t,strokeWidth:a?Number(r)*24/Number(s):r,className:BC("lucide",n),...!i&&!OT(o)&&{"aria-hidden":"true"},...o},[...l.map(([d,c])=>v.createElement(d,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=(t,s)=>{const r=v.forwardRef(({className:a,...n},i)=>v.createElement(MT,{ref:i,iconNode:s,className:BC(`lucide-${UT(RN(t))}`,`lucide-${t}`,a),...n}));return r.displayName=RN(t),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],qT=ba("arrow-down",HT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],If=ba("arrow-left",VT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],WT=ba("check",$T);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],KT=ba("circle-alert",GT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],YT=ba("circle-check-big",zT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],gu=ba("download",XT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],qy=ba("eye-off",JT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],L0=ba("eye",ZT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],kC=ba("file-text",eI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],ON=ba("folder-tree",tI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],rI=ba("funnel",sI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],tA=ba("package",aI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],vu=ba("plus",nI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Mh=ba("printer",iI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],oI=ba("rotate-ccw",lI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],QN=ba("ruler",cI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Hh=ba("save",dI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],D0=ba("search",uI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],sA=ba("square-pen",AI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Gl=ba("trash-2",hI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],fI=ba("trash",mI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],xI=ba("triangle-alert",pI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]],vI=ba("warehouse",gI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],EC=ba("x",bI);function yI(){const t=Ns(),{login:s,setScope:r}=Qa(),[a,n]=v.useState(""),[i,l]=v.useState(""),[o,u]=v.useState(null),[d,c]=v.useState(!1),[m,h]=v.useState(!1);async function f(x){var g,b,y,N,j;x.preventDefault(),u(null),c(!0);try{const S=await s({username:a,password:i}),k=Array.isArray((g=S==null?void 0:S.user)==null?void 0:g.branchIds)?S.user.branchIds.map(Number).filter(I=>Number.isFinite(I)):[],P=Array.isArray((b=S==null?void 0:S.user)==null?void 0:b.companyIds)?S.user.companyIds.map(Number).filter(I=>Number.isFinite(I)):[];if(k.length===1){const I=k[0];let B=P.length===1?P[0]:null;if(!B)try{const q=await te.get("/admin/branches"),O=(Array.isArray((y=q.data)==null?void 0:y.items)?q.data.items:[]).find(T=>Number(T.id)===Number(I));O&&(B=Number(O.company_id))}catch{B=P[0]||1}r(q=>({...q,companyId:B||q.companyId||1,branchId:I})),t("/",{replace:!0})}else t("/select-branch",{replace:!0})}catch(S){const k=((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||(S==null?void 0:S.message)||"Login failed";u(k),mt.error(k)}finally{c(!1)}}return e.jsx("div",{className:"min-h-screen grid place-items-center bg-gradient-to-br from-brand-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",style:{backgroundImage:`url(${Hy})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-[400px]",children:e.jsxs("div",{className:"card shadow-erp-lg p-8",style:{backgroundColor:"rgba(255,255,255,0.7)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-8 ml-7",children:e.jsxs("div",{children:[e.jsx("div",{className:"items-center ml-9 mt-3 mb-4",children:e.jsx("img",{src:My,alt:"OmniSuite",className:"h-14 w-auto"})}),e.jsx("div",{className:"items-center text-xl font-bold text-slate-600 dark:text-slate-400 mb-0 mt-4",children:"Enterprise Resource Planning"})]})}),o?e.jsx("div",{className:"mb-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:o}):null,e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",value:a,onChange:x=>n(x.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",className:"input pr-10",value:i,onChange:x=>l(x.target.value),required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center text-slate-500",onClick:()=>h(x=>!x),"aria-label":m?"Hide password":"Show password",children:m?e.jsx(qy,{size:18}):e.jsx(L0,{size:18})})]})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full mt-6",disabled:d,children:d?"Signing in":"Sign in"}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(Ee,{to:"/forgot-password",className:"text-sm text-brand-700 hover:underline",children:"Forgot password?"})})]})]})})})}function jI(){const t=Ns(),[s,r]=v.useState(""),[a,n]=v.useState(""),[i,l]=v.useState(!1),[o,u]=v.useState(null);async function d(c){var m,h;c.preventDefault(),u(null),l(!0);try{await te.post("/auth/forgot-password/request-otp",{username:s,email:a}),mt.success("OTP sent to your registered email"),t("/reset-password",{replace:!0})}catch(f){const x=((h=(m=f==null?void 0:f.response)==null?void 0:m.data)==null?void 0:h.message)||(f==null?void 0:f.message)||"Failed to request OTP";u(x),mt.error(x)}finally{l(!1)}}return e.jsx("div",{className:"min-h-screen grid place-items-center bg-gradient-to-br from-brand-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",style:{backgroundImage:`url(${Hy})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-[420px]",children:e.jsxs("div",{className:"card shadow-erp-lg p-8",style:{backgroundColor:"rgba(255,255,255,0.7)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-6 ml-7",children:e.jsxs("div",{children:[e.jsx("div",{className:"items-center ml-9 mt-3 mb-3",children:e.jsx("img",{src:My,alt:"OmniSuite",className:"h-14 w-auto"})}),e.jsx("div",{className:"items-center text-xl font-bold text-slate-600 dark:text-slate-400 mb-0 mt-2",children:"Password Reset"})]})}),o?e.jsx("div",{className:"mb-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:o}):null,e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",value:s,onChange:c=>r(c.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",className:"input",value:a,onChange:c=>n(c.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full mt-4",disabled:i,children:i?"Sending OTP":"Send OTP"}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(Ee,{to:"/login",className:"text-sm text-brand-700 hover:underline",children:"Back to login"})})]})]})})})}function NI(){const t=Ns(),[s,r]=v.useState(""),[a,n]=v.useState(""),[i,l]=v.useState(""),[o,u]=v.useState(!1),[d,c]=v.useState(null),[m,h]=v.useState(!1);async function f(x){var g,b;x.preventDefault(),c(null),u(!0);try{await te.post("/auth/forgot-password/reset",{username:s,otp:a,new_password:i}),mt.success("Password reset successfully"),t("/login",{replace:!0})}catch(y){const N=((b=(g=y==null?void 0:y.response)==null?void 0:g.data)==null?void 0:b.message)||(y==null?void 0:y.message)||"Failed to reset password";c(N),mt.error(N)}finally{u(!1)}}return e.jsx("div",{className:"min-h-screen grid place-items-center bg-gradient-to-br from-brand-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",style:{backgroundImage:`url(${Hy})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-[420px]",children:e.jsxs("div",{className:"card shadow-erp-lg p-8",style:{backgroundColor:"rgba(255,255,255,0.7)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-6 ml-7",children:e.jsxs("div",{children:[e.jsx("div",{className:"items-center ml-9 mt-3 mb-3",children:e.jsx("img",{src:My,alt:"OmniSuite",className:"h-14 w-auto"})}),e.jsx("div",{className:"items-center text-xl font-bold text-slate-600 dark:text-slate-400 mb-0 mt-2",children:"Enter OTP and New Password"})]})}),d?e.jsx("div",{className:"mb-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:d}):null,e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",value:s,onChange:x=>r(x.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"OTP Code"}),e.jsx("input",{type:"text",className:"input",value:a,onChange:x=>n(x.target.value),inputMode:"numeric",pattern:"\\\\d{6}",placeholder:"6-digit code",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",className:"input pr-10",value:i,onChange:x=>l(x.target.value),required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center text-slate-500",onClick:()=>h(x=>!x),"aria-label":m?"Hide password":"Show password",children:m?e.jsx(qy,{size:18}):e.jsx(L0,{size:18})})]})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full mt-4",disabled:o,children:o?"Resetting":"Reset Password"}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(Ee,{to:"/login",className:"text-sm text-brand-700 hover:underline",children:"Back to login"})})]})]})})})}var uv={exports:{}},Av={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MN;function wI(){if(MN)return Av;MN=1;var t=y0();function s(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var r=typeof Object.is=="function"?Object.is:s,a=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,l=t.useMemo,o=t.useDebugValue;return Av.useSyncExternalStoreWithSelector=function(u,d,c,m,h){var f=n(null);if(f.current===null){var x={hasValue:!1,value:null};f.current=x}else x=f.current;f=l(function(){function b(k){if(!y){if(y=!0,N=k,k=m(k),h!==void 0&&x.hasValue){var P=x.value;if(h(P,k))return j=P}return j=k}if(P=j,r(N,k))return P;var I=m(k);return h!==void 0&&h(P,I)?(N=k,P):(N=k,j=I)}var y=!1,N,j,S=c===void 0?null:c;return[function(){return b(d())},S===null?void 0:function(){return b(S())}]},[d,c,m,h]);var g=a(u,f[0],f[1]);return i(function(){x.hasValue=!0,x.value=g},[g]),o(g),g},Av}var HN;function _I(){return HN||(HN=1,uv.exports=wI()),uv.exports}var SI=_I();function CI(t){t()}function BI(){let t=null,s=null;return{clear(){t=null,s=null},notify(){CI(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=t;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const n=s={callback:r,next:null,prev:s};return n.prev?n.prev.next=n:t=n,function(){!a||t===null||(a=!1,n.next?n.next.prev=n.prev:s=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var qN={notify(){},get:()=>[]};function kI(t,s){let r,a=qN,n=0,i=!1;function l(g){c();const b=a.subscribe(g);let y=!1;return()=>{y||(y=!0,b(),m())}}function o(){a.notify()}function u(){x.onStateChange&&x.onStateChange()}function d(){return i}function c(){n++,r||(r=t.subscribe(u),a=BI())}function m(){n--,r&&n===0&&(r(),r=void 0,a.clear(),a=qN)}function h(){i||(i=!0,c())}function f(){i&&(i=!1,m())}const x={addNestedSub:l,notifyNestedSubs:o,handleChangeWrapper:u,isSubscribed:d,trySubscribe:h,tryUnsubscribe:f,getListeners:()=>a};return x}var EI=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FI=EI(),TI=()=>typeof navigator<"u"&&navigator.product==="ReactNative",II=TI(),LI=()=>FI||II?v.useLayoutEffect:v.useEffect,DI=LI(),hv=Symbol.for("react-redux-context"),mv=typeof globalThis<"u"?globalThis:{};function PI(){if(!v.createContext)return{};const t=mv[hv]??(mv[hv]=new Map);let s=t.get(v.createContext);return s||(s=v.createContext(null),t.set(v.createContext,s)),s}var cu=PI();function UI(t){const{children:s,context:r,serverState:a,store:n}=t,i=v.useMemo(()=>{const u=kI(n);return{store:n,subscription:u,getServerState:a?()=>a:void 0}},[n,a]),l=v.useMemo(()=>n.getState(),[n]);DI(()=>{const{subscription:u}=i;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),l!==n.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[i,l]);const o=r||cu;return v.createElement(o.Provider,{value:i},s)}var RI=UI;function Vy(t=cu){return function(){return v.useContext(t)}}var FC=Vy();function TC(t=cu){const s=t===cu?FC:Vy(t),r=()=>{const{store:a}=s();return a};return Object.assign(r,{withTypes:()=>r}),r}var OI=TC();function QI(t=cu){const s=t===cu?OI:TC(t),r=()=>s().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var $y=QI(),MI=(t,s)=>t===s;function HI(t=cu){const s=t===cu?FC:Vy(t),r=(a,n={})=>{const{equalityFn:i=MI}=typeof n=="function"?{equalityFn:n}:n,l=s(),{store:o,subscription:u,getServerState:d}=l;v.useRef(!0);const c=v.useCallback({[a.name](h){return a(h)}}[a.name],[a]),m=SI.useSyncExternalStoreWithSelector(u.addNestedSub,o.getState,d||o.getState,c,i);return v.useDebugValue(m),m};return Object.assign(r,{withTypes:()=>r}),r}var Kc=HI();function Mn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var qI=typeof Symbol=="function"&&Symbol.observable||"@@observable",VN=qI,fv=()=>Math.random().toString(36).substring(7).split("").join("."),VI={INIT:`@@redux/INIT${fv()}`,REPLACE:`@@redux/REPLACE${fv()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${fv()}`},Ox=VI;function Wy(t){if(typeof t!="object"||t===null)return!1;let s=t;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(t)===s||Object.getPrototypeOf(t)===null}function IC(t,s,r){if(typeof t!="function")throw new Error(Mn(2));if(typeof s=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Mn(0));if(typeof s=="function"&&typeof r>"u"&&(r=s,s=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Mn(1));return r(IC)(t,s)}let a=t,n=s,i=new Map,l=i,o=0,u=!1;function d(){l===i&&(l=new Map,i.forEach((b,y)=>{l.set(y,b)}))}function c(){if(u)throw new Error(Mn(3));return n}function m(b){if(typeof b!="function")throw new Error(Mn(4));if(u)throw new Error(Mn(5));let y=!0;d();const N=o++;return l.set(N,b),function(){if(y){if(u)throw new Error(Mn(6));y=!1,d(),l.delete(N),i=null}}}function h(b){if(!Wy(b))throw new Error(Mn(7));if(typeof b.type>"u")throw new Error(Mn(8));if(typeof b.type!="string")throw new Error(Mn(17));if(u)throw new Error(Mn(9));try{u=!0,n=a(n,b)}finally{u=!1}return(i=l).forEach(N=>{N()}),b}function f(b){if(typeof b!="function")throw new Error(Mn(10));a=b,h({type:Ox.REPLACE})}function x(){const b=m;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Mn(11));function N(){const S=y;S.next&&S.next(c())}return N(),{unsubscribe:b(N)}},[VN](){return this}}}return h({type:Ox.INIT}),{dispatch:h,subscribe:m,getState:c,replaceReducer:f,[VN]:x}}function $I(t){Object.keys(t).forEach(s=>{const r=t[s];if(typeof r(void 0,{type:Ox.INIT})>"u")throw new Error(Mn(12));if(typeof r(void 0,{type:Ox.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Mn(13))})}function WI(t){const s=Object.keys(t),r={};for(let i=0;i<s.length;i++){const l=s[i];typeof t[l]=="function"&&(r[l]=t[l])}const a=Object.keys(r);let n;try{$I(r)}catch(i){n=i}return function(l={},o){if(n)throw n;let u=!1;const d={};for(let c=0;c<a.length;c++){const m=a[c],h=r[m],f=l[m],x=h(f,o);if(typeof x>"u")throw o&&o.type,new Error(Mn(14));d[m]=x,u=u||x!==f}return u=u||a.length!==Object.keys(l).length,u?d:l}}function Qx(...t){return t.length===0?s=>s:t.length===1?t[0]:t.reduce((s,r)=>(...a)=>s(r(...a)))}function GI(...t){return s=>(r,a)=>{const n=s(r,a);let i=()=>{throw new Error(Mn(15))};const l={getState:n.getState,dispatch:(u,...d)=>i(u,...d)},o=t.map(u=>u(l));return i=Qx(...o)(n.dispatch),{...n,dispatch:i}}}function KI(t){return Wy(t)&&"type"in t&&typeof t.type=="string"}var LC=Symbol.for("immer-nothing"),$N=Symbol.for("immer-draftable"),Ri=Symbol.for("immer-state");function _o(t,...s){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var yl=Object,Th=yl.getPrototypeOf,Mx="constructor",P0="prototype",kb="configurable",Hx="enumerable",_x="writable",nf="value",ed=t=>!!t&&!!t[Ri];function Eo(t){var s;return t?DC(t)||R0(t)||!!t[$N]||!!((s=t[Mx])!=null&&s[$N])||O0(t)||Q0(t):!1}var zI=yl[P0][Mx].toString(),WN=new WeakMap;function DC(t){if(!t||!Gy(t))return!1;const s=Th(t);if(s===null||s===yl[P0])return!0;const r=yl.hasOwnProperty.call(s,Mx)&&s[Mx];if(r===Object)return!0;if(!dh(r))return!1;let a=WN.get(r);return a===void 0&&(a=Function.toString.call(r),WN.set(r,a)),a===zI}function U0(t,s,r=!0){Lf(t)===0?(r?Reflect.ownKeys(t):yl.keys(t)).forEach(n=>{s(n,t[n],t)}):t.forEach((a,n)=>s(n,a,t))}function Lf(t){const s=t[Ri];return s?s.type_:R0(t)?1:O0(t)?2:Q0(t)?3:0}var GN=(t,s,r=Lf(t))=>r===2?t.has(s):yl[P0].hasOwnProperty.call(t,s),Eb=(t,s,r=Lf(t))=>r===2?t.get(s):t[s],qx=(t,s,r,a=Lf(t))=>{a===2?t.set(s,r):a===3?t.add(r):t[s]=r};function YI(t,s){return t===s?t!==0||1/t===1/s:t!==t&&s!==s}var R0=Array.isArray,O0=t=>t instanceof Map,Q0=t=>t instanceof Set,Gy=t=>typeof t=="object",dh=t=>typeof t=="function",pv=t=>typeof t=="boolean";function XI(t){const s=+t;return Number.isInteger(s)&&String(s)===t}var $c=t=>t.copy_||t.base_,Ky=t=>t.modified_?t.copy_:t.base_;function Fb(t,s){if(O0(t))return new Map(t);if(Q0(t))return new Set(t);if(R0(t))return Array[P0].slice.call(t);const r=DC(t);if(s===!0||s==="class_only"&&!r){const a=yl.getOwnPropertyDescriptors(t);delete a[Ri];let n=Reflect.ownKeys(a);for(let i=0;i<n.length;i++){const l=n[i],o=a[l];o[_x]===!1&&(o[_x]=!0,o[kb]=!0),(o.get||o.set)&&(a[l]={[kb]:!0,[_x]:!0,[Hx]:o[Hx],[nf]:t[l]})}return yl.create(Th(t),a)}else{const a=Th(t);if(a!==null&&r)return{...t};const n=yl.create(a);return yl.assign(n,t)}}function zy(t,s=!1){return M0(t)||ed(t)||!Eo(t)||(Lf(t)>1&&yl.defineProperties(t,{set:kp,add:kp,clear:kp,delete:kp}),yl.freeze(t),s&&U0(t,(r,a)=>{zy(a,!0)},!1)),t}function JI(){_o(2)}var kp={[nf]:JI};function M0(t){return t===null||!Gy(t)?!0:yl.isFrozen(t)}var Vx="MapSet",Tb="Patches",KN="ArrayMethods",PC={};function pA(t){const s=PC[t];return s||_o(0,t),s}var zN=t=>!!PC[t],lf,UC=()=>lf,ZI=(t,s)=>({drafts_:[],parent_:t,immer_:s,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:zN(Vx)?pA(Vx):void 0,arrayMethodsPlugin_:zN(KN)?pA(KN):void 0});function YN(t,s){s&&(t.patchPlugin_=pA(Tb),t.patches_=[],t.inversePatches_=[],t.patchListener_=s)}function Ib(t){Lb(t),t.drafts_.forEach(e6),t.drafts_=null}function Lb(t){t===lf&&(lf=t.parent_)}var XN=t=>lf=ZI(lf,t);function e6(t){const s=t[Ri];s.type_===0||s.type_===1?s.revoke_():s.revoked_=!0}function JN(t,s){s.unfinalizedDrafts_=s.drafts_.length;const r=s.drafts_[0];if(t!==void 0&&t!==r){r[Ri].modified_&&(Ib(s),_o(4)),Eo(t)&&(t=ZN(s,t));const{patchPlugin_:n}=s;n&&n.generateReplacementPatches_(r[Ri].base_,t,s)}else t=ZN(s,r);return t6(s,t,!0),Ib(s),s.patches_&&s.patchListener_(s.patches_,s.inversePatches_),t!==LC?t:void 0}function ZN(t,s){if(M0(s))return s;const r=s[Ri];if(!r)return $x(s,t.handledSet_,t);if(!H0(r,t))return s;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:a}=r;if(a)for(;a.length>0;)a.pop()(t);QC(r,t)}return r.copy_}function t6(t,s,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&zy(s,r)}function RC(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var H0=(t,s)=>t.scope_===s,s6=[];function OC(t,s,r,a){const n=$c(t),i=t.type_;if(a!==void 0&&Eb(n,a,i)===s){qx(n,a,r,i);return}if(!t.draftLocations_){const o=t.draftLocations_=new Map;U0(n,(u,d)=>{if(ed(d)){const c=o.get(d)||[];c.push(u),o.set(d,c)}})}const l=t.draftLocations_.get(s)??s6;for(const o of l)qx(n,o,r,i)}function r6(t,s,r){t.callbacks_.push(function(n){var o;const i=s;if(!i||!H0(i,n))return;(o=n.mapSetPlugin_)==null||o.fixSetContents(i);const l=Ky(i);OC(t,i.draft_??i,l,r),QC(i,n)})}function QC(t,s){var a;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((a=t.assigned_)==null?void 0:a.size)??0)>0)){const{patchPlugin_:n}=s;if(n){const i=n.getPath(t);i&&n.generatePatches_(t,i,s)}RC(t)}}function a6(t,s,r){const{scope_:a}=t;if(ed(r)){const n=r[Ri];H0(n,a)&&n.callbacks_.push(function(){Sx(t);const l=Ky(n);OC(t,r,l,s)})}else Eo(r)&&t.callbacks_.push(function(){const i=$c(t);t.type_===3?i.has(r)&&$x(r,a.handledSet_,a):Eb(i,s,t.type_)===r&&a.drafts_.length>1&&(t.assigned_.get(s)??!1)===!0&&t.copy_&&$x(Eb(t.copy_,s,t.type_),a.handledSet_,a)})}function $x(t,s,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||ed(t)||s.has(t)||!Eo(t)||M0(t)||(s.add(t),U0(t,(a,n)=>{if(ed(n)){const i=n[Ri];if(H0(i,r)){const l=Ky(i);qx(t,a,l,t.type_),RC(i)}}else Eo(n)&&$x(n,s,r)})),t}function n6(t,s){const r=R0(t),a={type_:r?1:0,scope_:s?s.scope_:UC(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:s,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let n=a,i=Wx;r&&(n=[a],i=of);const{revoke:l,proxy:o}=Proxy.revocable(n,i);return a.draft_=o,a.revoke_=l,[o,a]}var Wx={get(t,s){if(s===Ri)return t;let r=t.scope_.arrayMethodsPlugin_;const a=t.type_===1&&typeof s=="string";if(a&&r!=null&&r.isArrayOperationMethod(s))return r.createMethodInterceptor(t,s);const n=$c(t);if(!GN(n,s,t.type_))return i6(t,n,s);const i=n[s];if(t.finalized_||!Eo(i)||a&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&XI(s))return i;if(i===xv(t.base_,s)){Sx(t);const l=t.type_===1?+s:s,o=Pb(t.scope_,i,t,l);return t.copy_[l]=o}return i},has(t,s){return s in $c(t)},ownKeys(t){return Reflect.ownKeys($c(t))},set(t,s,r){const a=MC($c(t),s);if(a!=null&&a.set)return a.set.call(t.draft_,r),!0;if(!t.modified_){const n=xv($c(t),s),i=n==null?void 0:n[Ri];if(i&&i.base_===r)return t.copy_[s]=r,t.assigned_.set(s,!1),!0;if(YI(r,n)&&(r!==void 0||GN(t.base_,s,t.type_)))return!0;Sx(t),Db(t)}return t.copy_[s]===r&&(r!==void 0||s in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[s])||(t.copy_[s]=r,t.assigned_.set(s,!0),a6(t,s,r)),!0},deleteProperty(t,s){return Sx(t),xv(t.base_,s)!==void 0||s in t.base_?(t.assigned_.set(s,!1),Db(t)):t.assigned_.delete(s),t.copy_&&delete t.copy_[s],!0},getOwnPropertyDescriptor(t,s){const r=$c(t),a=Reflect.getOwnPropertyDescriptor(r,s);return a&&{[_x]:!0,[kb]:t.type_!==1||s!=="length",[Hx]:a[Hx],[nf]:r[s]}},defineProperty(){_o(11)},getPrototypeOf(t){return Th(t.base_)},setPrototypeOf(){_o(12)}},of={};for(let t in Wx){let s=Wx[t];of[t]=function(){const r=arguments;return r[0]=r[0][0],s.apply(this,r)}}of.deleteProperty=function(t,s){return of.set.call(this,t,s,void 0)};of.set=function(t,s,r){return Wx.set.call(this,t[0],s,r,t[0])};function xv(t,s){const r=t[Ri];return(r?$c(r):t)[s]}function i6(t,s,r){var n;const a=MC(s,r);return a?nf in a?a[nf]:(n=a.get)==null?void 0:n.call(t.draft_):void 0}function MC(t,s){if(!(s in t))return;let r=Th(t);for(;r;){const a=Object.getOwnPropertyDescriptor(r,s);if(a)return a;r=Th(r)}}function Db(t){t.modified_||(t.modified_=!0,t.parent_&&Db(t.parent_))}function Sx(t){t.copy_||(t.assigned_=new Map,t.copy_=Fb(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var l6=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(s,r,a)=>{if(dh(s)&&!dh(r)){const i=r;r=s;const l=this;return function(u=i,...d){return l.produce(u,c=>r.call(this,c,...d))}}dh(r)||_o(6),a!==void 0&&!dh(a)&&_o(7);let n;if(Eo(s)){const i=XN(this),l=Pb(i,s,void 0);let o=!0;try{n=r(l),o=!1}finally{o?Ib(i):Lb(i)}return YN(i,a),JN(n,i)}else if(!s||!Gy(s)){if(n=r(s),n===void 0&&(n=s),n===LC&&(n=void 0),this.autoFreeze_&&zy(n,!0),a){const i=[],l=[];pA(Tb).generateReplacementPatches_(s,n,{patches_:i,inversePatches_:l}),a(i,l)}return n}else _o(1,s)},this.produceWithPatches=(s,r)=>{if(dh(s))return(l,...o)=>this.produceWithPatches(l,u=>s(u,...o));let a,n;return[this.produce(s,r,(l,o)=>{a=l,n=o}),a,n]},pv(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),pv(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),pv(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Eo(t)||_o(8),ed(t)&&(t=o6(t));const s=XN(this),r=Pb(s,t,void 0);return r[Ri].isManual_=!0,Lb(s),r}finishDraft(t,s){const r=t&&t[Ri];(!r||!r.isManual_)&&_o(9);const{scope_:a}=r;return YN(a,s),JN(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,s){let r;for(r=s.length-1;r>=0;r--){const n=s[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(s=s.slice(r+1));const a=pA(Tb).applyPatches_;return ed(t)?a(t,s):this.produce(t,n=>a(n,s))}};function Pb(t,s,r,a){const[n,i]=O0(s)?pA(Vx).proxyMap_(s,r):Q0(s)?pA(Vx).proxySet_(s,r):n6(s,r);return((r==null?void 0:r.scope_)??UC()).drafts_.push(n),i.callbacks_=(r==null?void 0:r.callbacks_)??[],i.key_=a,r&&a!==void 0?r6(r,i,a):i.callbacks_.push(function(u){var c;(c=u.mapSetPlugin_)==null||c.fixSetContents(i);const{patchPlugin_:d}=u;i.modified_&&d&&d.generatePatches_(i,[],u)}),n}function o6(t){return ed(t)||_o(10,t),HC(t)}function HC(t){if(!Eo(t)||M0(t))return t;const s=t[Ri];let r,a=!0;if(s){if(!s.modified_)return s.base_;s.finalized_=!0,r=Fb(t,s.scope_.immer_.useStrictShallowCopy_),a=s.scope_.immer_.shouldUseStrictIteration()}else r=Fb(t,!0);return U0(r,(n,i)=>{qx(r,n,HC(i))},a),s&&(s.finalized_=!1),r}var c6=new l6,qC=c6.produce;function VC(t){return({dispatch:r,getState:a})=>n=>i=>typeof i=="function"?i(r,a,t):n(i)}var d6=VC(),u6=VC,A6=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Qx:Qx.apply(null,arguments)},h6=t=>t&&typeof t.match=="function";function Rm(t,s){function r(...a){if(s){let n=s(...a);if(!n)throw new Error(zc(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:a[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=a=>KI(a)&&a.type===t,r}var $C=class Sm extends Array{constructor(...s){super(...s),Object.setPrototypeOf(this,Sm.prototype)}static get[Symbol.species](){return Sm}concat(...s){return super.concat.apply(this,s)}prepend(...s){return s.length===1&&Array.isArray(s[0])?new Sm(...s[0].concat(this)):new Sm(...s.concat(this))}};function ew(t){return Eo(t)?qC(t,()=>{}):t}function Ep(t,s,r){return t.has(s)?t.get(s):t.set(s,r(s)).get(s)}function m6(t){return typeof t=="boolean"}var f6=()=>function(s){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=s??{};let l=new $C;return r&&(m6(r)?l.push(d6):l.push(u6(r.extraArgument))),l},p6="RTK_autoBatch",tw=t=>s=>{setTimeout(s,t)},x6=(t={type:"raf"})=>s=>(...r)=>{const a=s(...r);let n=!0,i=!1,l=!1;const o=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:tw(10):t.type==="callback"?t.queueNotification:tw(t.timeout),d=()=>{l=!1,i&&(i=!1,o.forEach(c=>c()))};return Object.assign({},a,{subscribe(c){const m=()=>n&&c(),h=a.subscribe(m);return o.add(c),()=>{h(),o.delete(c)}},dispatch(c){var m;try{return n=!((m=c==null?void 0:c.meta)!=null&&m[p6]),i=!n,i&&(l||(l=!0,u(d))),a.dispatch(c)}finally{n=!0}}})},g6=t=>function(r){const{autoBatch:a=!0}=r??{};let n=new $C(t);return a&&n.push(x6(typeof a=="object"?a:void 0)),n};function v6(t){const s=f6(),{reducer:r=void 0,middleware:a,devTools:n=!0,preloadedState:i=void 0,enhancers:l=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(Wy(r))o=WI(r);else throw new Error(zc(1));let u;typeof a=="function"?u=a(s):u=s();let d=Qx;n&&(d=A6({trace:!1,...typeof n=="object"&&n}));const c=GI(...u),m=g6(c);let h=typeof l=="function"?l(m):m();const f=d(...h);return IC(o,i,f)}function WC(t){const s={},r=[];let a;const n={addCase(i,l){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(zc(28));if(o in s)throw new Error(zc(29));return s[o]=l,n},addAsyncThunk(i,l){return l.pending&&(s[i.pending.type]=l.pending),l.rejected&&(s[i.rejected.type]=l.rejected),l.fulfilled&&(s[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),n},addMatcher(i,l){return r.push({matcher:i,reducer:l}),n},addDefaultCase(i){return a=i,n}};return t(n),[s,r,a]}function b6(t){return typeof t=="function"}function y6(t,s){let[r,a,n]=WC(s),i;if(b6(t))i=()=>ew(t());else{const o=ew(t);i=()=>o}function l(o=i(),u){let d=[r[u.type],...a.filter(({matcher:c})=>c(u)).map(({reducer:c})=>c)];return d.filter(c=>!!c).length===0&&(d=[n]),d.reduce((c,m)=>{if(m)if(ed(c)){const f=m(c,u);return f===void 0?c:f}else{if(Eo(c))return qC(c,h=>m(h,u));{const h=m(c,u);if(h===void 0){if(c===null)return c;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return c},o)}return l.getInitialState=i,l}var j6=(t,s)=>h6(t)?t.match(s):t(s);function N6(...t){return s=>t.some(r=>j6(r,s))}var w6="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",_6=(t=21)=>{let s="",r=t;for(;r--;)s+=w6[Math.random()*64|0];return s},S6=["name","message","stack","code"],gv=class{constructor(t,s){Jg(this,"_type");this.payload=t,this.meta=s}},sw=class{constructor(t,s){Jg(this,"_type");this.payload=t,this.meta=s}},C6=t=>{if(typeof t=="object"&&t!==null){const s={};for(const r of S6)typeof t[r]=="string"&&(s[r]=t[r]);return s}return{message:String(t)}},rw="External signal was aborted",Yy=(()=>{function t(s,r,a){const n=Rm(s+"/fulfilled",(u,d,c,m)=>({payload:u,meta:{...m||{},arg:c,requestId:d,requestStatus:"fulfilled"}})),i=Rm(s+"/pending",(u,d,c)=>({payload:void 0,meta:{...c||{},arg:d,requestId:u,requestStatus:"pending"}})),l=Rm(s+"/rejected",(u,d,c,m,h)=>({payload:m,error:(a&&a.serializeError||C6)(u||"Rejected"),meta:{...h||{},arg:c,requestId:d,rejectedWithValue:!!m,requestStatus:"rejected",aborted:(u==null?void 0:u.name)==="AbortError",condition:(u==null?void 0:u.name)==="ConditionError"}}));function o(u,{signal:d}={}){return(c,m,h)=>{const f=a!=null&&a.idGenerator?a.idGenerator(u):_6(),x=new AbortController;let g,b;function y(j){b=j,x.abort()}d&&(d.aborted?y(rw):d.addEventListener("abort",()=>y(rw),{once:!0}));const N=(async function(){var k,P;let j;try{let I=(k=a==null?void 0:a.condition)==null?void 0:k.call(a,u,{getState:m,extra:h});if(k6(I)&&(I=await I),I===!1||x.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const B=new Promise((q,Q)=>{g=()=>{Q({name:"AbortError",message:b||"Aborted"})},x.signal.addEventListener("abort",g,{once:!0})});c(i(f,u,(P=a==null?void 0:a.getPendingMeta)==null?void 0:P.call(a,{requestId:f,arg:u},{getState:m,extra:h}))),j=await Promise.race([B,Promise.resolve(r(u,{dispatch:c,getState:m,extra:h,requestId:f,signal:x.signal,abort:y,rejectWithValue:(q,Q)=>new gv(q,Q),fulfillWithValue:(q,Q)=>new sw(q,Q)})).then(q=>{if(q instanceof gv)throw q;return q instanceof sw?n(q.payload,f,u,q.meta):n(q,f,u)})])}catch(I){j=I instanceof gv?l(null,f,u,I.payload,I.meta):l(I,f,u)}finally{g&&x.signal.removeEventListener("abort",g)}return a&&!a.dispatchConditionRejection&&l.match(j)&&j.meta.condition||c(j),j})();return Object.assign(N,{abort:y,requestId:f,arg:u,unwrap(){return N.then(B6)}})}}return Object.assign(o,{pending:i,rejected:l,fulfilled:n,settled:N6(l,n),typePrefix:s})}return t.withTypes=()=>t,t})();function B6(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function k6(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var E6=Symbol.for("rtk-slice-createasyncthunk");function F6(t,s){return`${t}/${s}`}function T6({creators:t}={}){var r;const s=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[E6];return function(n){const{name:i,reducerPath:l=i}=n;if(!i)throw new Error(zc(11));const o=(typeof n.reducers=="function"?n.reducers(D6()):n.reducers)||{},u=Object.keys(o),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(S,k){const P=typeof S=="string"?S:S.type;if(!P)throw new Error(zc(12));if(P in d.sliceCaseReducersByType)throw new Error(zc(13));return d.sliceCaseReducersByType[P]=k,c},addMatcher(S,k){return d.sliceMatchers.push({matcher:S,reducer:k}),c},exposeAction(S,k){return d.actionCreators[S]=k,c},exposeCaseReducer(S,k){return d.sliceCaseReducersByName[S]=k,c}};u.forEach(S=>{const k=o[S],P={reducerName:S,type:F6(i,S),createNotation:typeof n.reducers=="function"};U6(k)?O6(P,k,c,s):P6(P,k,c)});function m(){const[S={},k=[],P=void 0]=typeof n.extraReducers=="function"?WC(n.extraReducers):[n.extraReducers],I={...S,...d.sliceCaseReducersByType};return y6(n.initialState,B=>{for(let q in I)B.addCase(q,I[q]);for(let q of d.sliceMatchers)B.addMatcher(q.matcher,q.reducer);for(let q of k)B.addMatcher(q.matcher,q.reducer);P&&B.addDefaultCase(P)})}const h=S=>S,f=new Map,x=new WeakMap;let g;function b(S,k){return g||(g=m()),g(S,k)}function y(){return g||(g=m()),g.getInitialState()}function N(S,k=!1){function P(B){let q=B[S];return typeof q>"u"&&k&&(q=Ep(x,P,y)),q}function I(B=h){const q=Ep(f,k,()=>new WeakMap);return Ep(q,B,()=>{const Q={};for(const[O,T]of Object.entries(n.selectors??{}))Q[O]=I6(T,B,()=>Ep(x,B,y),k);return Q})}return{reducerPath:S,getSelectors:I,get selectors(){return I(P)},selectSlice:P}}const j={name:i,reducer:b,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:y,...N(l),injectInto(S,{reducerPath:k,...P}={}){const I=k??l;return S.inject({reducerPath:I,reducer:b},P),{...j,...N(I,!0)}}};return j}}function I6(t,s,r,a){function n(i,...l){let o=s(i);return typeof o>"u"&&a&&(o=r()),t(o,...l)}return n.unwrapped=t,n}var L6=T6();function D6(){function t(s,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:s,...r}}return t.withTypes=()=>t,{reducer(s){return Object.assign({[s.name](...r){return s(...r)}}[s.name],{_reducerDefinitionType:"reducer"})},preparedReducer(s,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:s,reducer:r}},asyncThunk:t}}function P6({type:t,reducerName:s,createNotation:r},a,n){let i,l;if("reducer"in a){if(r&&!R6(a))throw new Error(zc(17));i=a.reducer,l=a.prepare}else i=a;n.addCase(t,i).exposeCaseReducer(s,i).exposeAction(s,l?Rm(t,l):Rm(t))}function U6(t){return t._reducerDefinitionType==="asyncThunk"}function R6(t){return t._reducerDefinitionType==="reducerWithPrepare"}function O6({type:t,reducerName:s},r,a,n){if(!n)throw new Error(zc(18));const{payloadCreator:i,fulfilled:l,pending:o,rejected:u,settled:d,options:c}=r,m=n(t,i,c);a.exposeAction(s,m),l&&a.addCase(m.fulfilled,l),o&&a.addCase(m.pending,o),u&&a.addCase(m.rejected,u),d&&a.addMatcher(m.settled,d),a.exposeCaseReducer(s,{fulfilled:l||Fp,pending:o||Fp,rejected:u||Fp,settled:d||Fp})}function Fp(){}function zc(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Om=Yy("inventoryRef/fetchUoms",async()=>{var s;const t=await te.get("/inventory/uoms");return Array.isArray((s=t.data)==null?void 0:s.items)?t.data.items:[]}),Qm=Yy("inventoryRef/fetchCategories",async()=>{var s;const t=await te.get("/inventory/item-categories");return Array.isArray((s=t.data)==null?void 0:s.items)?t.data.items:[]}),rA=Yy("inventoryRef/fetchItemTypes",async()=>{var s;const t=await te.get("/inventory/item-types");return Array.isArray((s=t.data)==null?void 0:s.items)?t.data.items:[]}),Q6={uoms:[],categories:[],itemTypes:[],status:{uoms:"idle",categories:"idle",itemTypes:"idle"},error:{uoms:null,categories:null,itemTypes:null},lastFetched:{uoms:null,categories:null,itemTypes:null}},M6=L6({name:"inventoryRef",initialState:Q6,reducers:{},extraReducers:t=>{t.addCase(Om.pending,s=>{s.status.uoms="loading",s.error.uoms=null}).addCase(Om.fulfilled,(s,r)=>{s.status.uoms="succeeded",s.uoms=r.payload,s.lastFetched.uoms=Date.now()}).addCase(Om.rejected,(s,r)=>{var a;s.status.uoms="failed",s.error.uoms=((a=r.error)==null?void 0:a.message)||"Failed to load UOMs"}).addCase(Qm.pending,s=>{s.status.categories="loading",s.error.categories=null}).addCase(Qm.fulfilled,(s,r)=>{s.status.categories="succeeded",s.categories=r.payload,s.lastFetched.categories=Date.now()}).addCase(Qm.rejected,(s,r)=>{var a;s.status.categories="failed",s.error.categories=((a=r.error)==null?void 0:a.message)||"Failed to load categories"}).addCase(rA.pending,s=>{s.status.itemTypes="loading",s.error.itemTypes=null}).addCase(rA.fulfilled,(s,r)=>{s.status.itemTypes="succeeded",s.itemTypes=r.payload,s.lastFetched.itemTypes=Date.now()}).addCase(rA.rejected,(s,r)=>{var a;s.status.itemTypes="failed",s.error.itemTypes=((a=r.error)==null?void 0:a.message)||"Failed to load item types"})}}),H6=M6.reducer,q6=v6({reducer:{inventoryRef:H6}});function V6(){const t=Ns(),{user:s,scope:r,setScope:a}=Qa(),[n,i]=v.useState([]),[l,o]=v.useState(""),[u,d]=v.useState(!1),[c,m]=v.useState(""),h=v.useMemo(()=>Array.isArray(s==null?void 0:s.branchIds)?s.branchIds.map(Number):[],[s==null?void 0:s.branchIds]);v.useEffect(()=>{let x=!0;async function g(){var b,y,N;d(!0),m("");try{const j=await te.get("/admin/branches"),k=(Array.isArray((b=j.data)==null?void 0:b.items)?j.data.items:[]).filter(P=>h.includes(Number(P.id)));if(x&&(i(k),k.length===1)){const P=k[0];a(I=>({...I,companyId:Number(P.company_id),branchId:Number(P.id)})),t("/",{replace:!0});return}}catch(j){m(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Error loading branches")}finally{x&&d(!1)}}return g(),()=>{x=!1}},[]);async function f(){const x=Number(l);if(!x)return;const g=n.find(b=>Number(b.id)===x);g&&(a(b=>({...b,companyId:Number(g.company_id),branchId:Number(g.id),branchConfirmedId:n.length===1?Number(g.id):b==null?void 0:b.branchConfirmedId})),t("/",{replace:!0}))}return n.length===1?null:e.jsx("div",{className:"min-h-screen grid place-items-center bg-slate-50 dark:bg-slate-900 p-6",children:e.jsxs("div",{className:"w-full max-w-md card p-6 shadow-erp-lg",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 text-center",children:"Select Working Branch"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center mt-1",children:"Choose one of your assigned branches to continue."}),c?e.jsx("div",{className:"mt-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:c}):null,e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"label",children:"Branch"}),e.jsxs("select",{className:"input w-full",value:l,onChange:x=>o(x.target.value),disabled:u||n.length===0,children:[e.jsx("option",{value:"",children:"Select a branch"}),n.map(x=>e.jsxs("option",{value:x.id,children:[x.name," (",x.company_name,")"]},x.id))]})]}),e.jsx("button",{className:"btn-primary w-full mt-6",onClick:f,disabled:u||!l,children:u?"Loading":"Continue"})]})})}function $6(){const{theme:t,toggleTheme:s}=CC(),r=t==="dark";return e.jsx("button",{type:"button",className:"relative inline-flex h-6 w-11 items-center rounded-full border transition-colors focus:outline-none focus:ring-2 focus:ring-brand/40 focus:ring-offset-2 focus:ring-offset-transparent "+(r?"bg-brand/25 border-white/10 dark:border-white/10":"bg-slate-200 border-slate-300"),role:"switch","aria-checked":r,"aria-label":"Toggle dark mode",onClick:s,children:e.jsx("span",{className:"inline-block h-5 w-5 transform rounded-full shadow transition-transform "+(r?"translate-x-5 bg-brand":"translate-x-1 bg-white")})})}function W6(){const{user:t}=Qa();return e.jsxs("div",{className:"hidden rounded-2xl border border-slate-200/70 dark:border-white/10 bg-white/70 dark:bg-slate-900/40 backdrop-blur-xl shadow-sm p-5",children:[e.jsx("div",{className:"font-extrabold text-lg mb-1",children:"Dashboard"}),e.jsxs("div",{className:"text-slate-500 dark:text-slate-400 mb-3",children:["Welcome, ",t==null?void 0:t.email,". This is the ERP starter shell."]}),e.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm leading-relaxed",children:"Start by enabling permissions in MySQL and then calling module endpoints from the UI."})]})}function G6(){const{user:t,token:s}=Qa(),r=Ns(),[a,n]=v.useState([]),[i,l]=v.useState([]),[o,u]=v.useState(null),[d,c]=v.useState(!1),[m,h]=v.useState(null),[f,x]=v.useState(null),[g,b]=v.useState(""),[y,N]=v.useState(!1),[j,S]=v.useState(!1),[k,P]=v.useState(null);v.useEffect(()=>{let _=!1;return te.get("/workflows/approvals/pending").then(F=>{var E;_||n(Array.isArray((E=F.data)==null?void 0:E.items)?F.data.items:[])}).catch(()=>{_||n([])}),te.get("/workflows/notifications").then(F=>{var E;_||l(Array.isArray((E=F.data)==null?void 0:E.items)?F.data.items:[])}).catch(()=>{_||l([])}),te.get("/pos/analytics/overview").then(F=>{_||u(F.data||null)}).catch(()=>{_||u(null)}),()=>{_=!0}},[s]);const I=_=>String(_||"").trim().toUpperCase().replace(/\s+/g,"_"),B=_=>{const F=I(_);if(F==="MATERIAL_REQUISITION")return"Material Requisition";if(F==="RETURN_TO_STORES")return"Return to Stores";if(F.startsWith("PURCHASE_ORDER:")){const E=F.split(":")[1];return E==="LOCAL"?"Purchase Order - Local":E==="IMPORT"?"Purchase Order - Import":"Purchase Order"}return F==="GOODS_RECEIPT"||F==="GRN"||F==="GOODS_RECEIPT_NOTE"?"GRN":F==="GOODS_RECEIPT:LOCAL"||F==="GRN:LOCAL"||F==="GOODS_RECEIPT_NOTE:LOCAL"?"GRN Local":F==="GOODS_RECEIPT:IMPORT"||F==="GRN:IMPORT"||F==="GOODS_RECEIPT_NOTE:IMPORT"?"GRN Import":String(_||"Document")},q=_=>{const F=I(_.document_type);if(F==="PURCHASE_ORDER"){const E=I(_.po_type);return E?`${F}:${E}`:F}if(F==="GOODS_RECEIPT"||F==="GRN"||F==="GOODS_RECEIPT_NOTE"){const E=String(_.doc_ref||""),L=E.startsWith("GL-")?"LOCAL":E.startsWith("GI-")?"IMPORT":"";return L?`${F}:${L}`:F}return F},Q=v.useMemo(()=>{const _=new Map;for(const F of a){const E=String(F.workflow_instance_id||`${I(F.document_type)}-${F.document_id}`);_.has(E)||_.set(E,F)}return Array.from(_.values())},[a]),O=v.useMemo(()=>{const _={};for(const F of Q){const E=q(F);_[E]||(_[E]=[]),_[E].push(F)}return _},[Q]),T=v.useMemo(()=>{const _=Object.keys(O),F=["MATERIAL_REQUISITION","RETURN_TO_STORES","STOCK_ADJUSTMENT"],E=F.filter(U=>_.includes(U)),L=_.filter(U=>!F.includes(U)).sort();return[...E,...L]},[O]),V=_=>{const F=B(q(_)),E=_.doc_ref?String(_.doc_ref):`#${_.document_id}`;return`${F} ${E}`},D=async _=>{var F;c(!0),h(_),N(!0),x(null),b("");try{const L=((F=(await te.get(`/workflows/approvals/instance/${_}`)).data)==null?void 0:F.item)||null;if(x(L),L&&!L.is_last_step&&Array.isArray(L.next_step_approvers)){const U=L.next_step_approvers[0];P(U?U.id:null)}else P(null)}catch{x(null)}finally{N(!1)}},Y=_=>{const E=String(_||"").match(/approvals\/(\d+)/);return E?Number(E[1]):null},M=async _=>{try{await te.put(`/workflows/notifications/${_}/read`),l(F=>F.map(E=>E.id===_?{...E,is_read:1}:E))}catch{}},X=()=>{c(!1),h(null),x(null),b(""),N(!1),S(!1),P(null)},R=async _=>{var F,E;if(m){if(!g&&(_==="REJECT"||_==="RETURN")){alert("Please provide a comment for rejection/return");return}if(_==="APPROVE"&&f&&!f.is_last_step&&!k){alert("Please select the next approver");return}S(!0);try{await te.post(`/workflows/${m}/action`,{action:_,comments:g,target_user_id:f&&!f.is_last_step?k:null}),n(L=>L.filter(U=>U.workflow_instance_id!==m)),X()}catch(L){alert(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Action failed")}finally{S(!1)}}};function H(_){return`${Number(_||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}const W=[{label:"Today Sales",value:H((o==null?void 0:o.todaySales)||0),path:"/sales",color:"from-ticker-green to-ticker-green"},{label:"Total Customers",value:String((o==null?void 0:o.totalCustomers)??0),path:"/sales/customers",color:"from-ticker-blue to-ticker-blue"},{label:"Average Order",value:H((o==null?void 0:o.averageOrder)||0),path:"/sales/reports",color:"from-ticker-purple to-ticker-purple"},{label:"Monthly Revenue",value:H((o==null?void 0:o.monthlyRevenue)||0),path:"/finance/reports",color:"from-ticker-orange to-ticker-orange"}],K=[{label:"New Sale",icon:"",path:"/pos/sales/new",color:"text-green-600 bg-green-50"},{label:"Inventory",icon:"",path:"/inventory",color:"text-blue-600 bg-blue-50"},{label:"Customers",icon:"",path:"/sales/customers",color:"text-purple-600 bg-purple-50"},{label:"Reports",icon:"",path:"/reports",color:"text-orange-600 bg-orange-50"},{label:"Settings",icon:"",path:"/administration/settings",color:"text-slate-600 bg-slate-50"},{label:"Help",icon:"",path:"/help",color:"text-red-600 bg-red-50"}];return e.jsxs("div",{className:"min-h-screen bg-slate-50/50 p-6 md:p-8 font-sans text-slate-900",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 fullbleed-sm",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-r from-brand-900 to-brand-800 p-8 shadow-erp text-white",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Welcome back, ",(t==null?void 0:t.name)||(t==null?void 0:t.username)||"User","! "]}),e.jsx("p",{className:"mt-2 text-brand-100 text-lg max-w-2xl",children:"Here's an overview of your business performance and pending tasks today."})]}),e.jsx("div",{className:"absolute right-0 top-0 h-full w-1/3 bg-white/5 skew-x-12 transform translate-x-20"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:W.map((_,F)=>e.jsxs("div",{onClick:()=>r(_.path),className:`relative overflow-hidden rounded-xl p-6 shadow-erp-sm hover:shadow-erp-md transition-all duration-200 cursor-pointer group bg-gradient-to-r ${_.color} text-white`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white/80 uppercase tracking-wider",children:_.label}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-white",children:_.value})]}),e.jsx("div",{className:"p-3 rounded-lg bg-white/20 text-white",children:e.jsx("span",{className:"text-2xl",children:_.icon})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 p-4 opacity-10 group-hover:scale-110 transition-transform duration-300",children:e.jsx("span",{className:"text-6xl text-white/20",children:_.icon})})]},F))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1 space-y-6",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100 h-full",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-amber-500",children:""})," Quick Actions"]}),e.jsx("div",{className:"space-y-3",children:K.map((_,F)=>e.jsxs("button",{onClick:()=>r(_.path),className:"w-full flex items-center gap-4 p-3 rounded-lg hover:bg-slate-50 transition-colors border border-transparent hover:border-slate-200 text-left group",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xl ${_.color}`,children:_.icon}),e.jsx("span",{className:"font-medium text-slate-700 group-hover:text-brand-700",children:_.label})]},F))})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-500",children:""})," Pending Approvals"]}),e.jsxs("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs font-bold rounded-full",children:[Q.length," Pending"]})]}),Q.length>0?e.jsx("div",{className:"space-y-4",children:T.map(_=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700",children:B(_)}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-700 text-xs font-bold rounded-full",children:O[_].length})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:O[_].map(F=>e.jsxs("div",{className:"py-3 flex items-center justify-between hover:bg-slate-50 rounded-lg px-2 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600",children:F.initiator?F.initiator.charAt(0):"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:V(F)}),e.jsxs("p",{className:"text-xs text-slate-500",children:[F.submitted_at?new Date(F.submitted_at).toLocaleString():"Just now"," "," ",F.workflow_name||"Approval Required"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>D(F.workflow_instance_id),className:"px-3 py-1 text-xs font-medium text-green-700 bg-green-50 hover:bg-green-100 rounded-md transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>r(`/administration/workflows/approvals/${F.workflow_instance_id}`),className:"px-3 py-1 text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-md transition-colors",children:"View"})]})]},F.workflow_instance_id))})]},_))}):e.jsx("div",{className:"text-center py-8 text-slate-500 text-sm bg-slate-50/50 rounded-lg border border-dashed border-slate-200",children:"No pending approvals found. You're all caught up! "})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-brand-500",children:""})," Notifications"]}),i.length>0?e.jsx("div",{className:"space-y-3",children:i.slice(0,5).map((_,F)=>e.jsxs("div",{className:"flex gap-3 items-start p-2 hover:bg-slate-50 rounded-lg transition-colors",children:[e.jsx("div",{className:"mt-1 w-2 h-2 rounded-full bg-brand-500 shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-800 leading-snug",children:_.message}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:_.date||"Just now"})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[Y(_.link)?e.jsx("button",{onClick:()=>D(Y(_.link)),className:"px-3 py-1 text-xs font-medium text-brand-700 bg-brand-50 hover:bg-brand-100 rounded-md transition-colors",children:"Pending Approval"}):null,e.jsx("button",{onClick:()=>M(_.id),className:"px-3 py-1 text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-md transition-colors",children:"Mark Read"})]})]},F))}):e.jsx("div",{className:"text-center py-6 text-slate-500 text-sm",children:"No new notifications."})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-500",children:""})," System Status"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-600",children:"Server Uptime"}),e.jsx("span",{className:"text-green-600 font-medium",children:"99.9%"})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"99.9%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-600",children:"Database Load"}),e.jsx("span",{className:"text-brand-600 font-medium",children:"34%"})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2",children:e.jsx("div",{className:"bg-brand-500 h-2 rounded-full",style:{width:"34%"}})})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider font-bold mb-2",children:"Recent Login"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Windows PC  Chrome"}),e.jsx("span",{className:"text-slate-400 ml-auto",children:"10:42 AM"})]})]})]})]})]})]})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Approval"}),e.jsx("button",{onClick:X,className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsx("div",{className:"p-4 space-y-3",children:y?e.jsx("div",{className:"text-sm",children:"Loading..."}):f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document:"," ",e.jsxs("span",{className:"font-semibold",children:[f.document_type," #",f.document_id]})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Current Step:"," ",e.jsx("span",{className:"font-semibold",children:f.step_name})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Amount:"," ",e.jsx("span",{className:"font-semibold",children:f.amount!=null?Number(f.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Comments"}),e.jsx("textarea",{className:"input w-full h-24",placeholder:"Enter comments...",value:g,onChange:_=>b(_.target.value)})]}),!f.is_last_step&&Array.isArray(f.next_step_approvers)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Forward To"}),e.jsxs("select",{className:"input w-full",value:k||"",onChange:_=>P(Number(_.target.value)),children:[e.jsx("option",{value:"",children:"Select user"}),f.next_step_approvers.map(_=>e.jsx("option",{value:_.id,children:_.username},_.id))]})]})]}):e.jsx("div",{className:"text-sm text-red-600",children:"Failed to load approval"})}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:X,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700 disabled:opacity-50",onClick:()=>R("APPROVE"),disabled:j,children:f&&f.is_last_step?"Final Approve":"Forward"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 disabled:opacity-50",onClick:()=>R("RETURN"),disabled:j,children:"Return"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",onClick:()=>R("REJECT"),disabled:j,children:"Reject"})]})]})})]})}const To=({title:t,description:s,stats:r=[],quickActions:a=[],sections:n=[]})=>{const i=Ns(),{hasAccess:l}=Qa(),o=(c,m)=>{c&&i(c)},u=["from-green-500 to-green-600","from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-orange-500 to-orange-600","from-pink-500 to-pink-600","from-teal-500 to-teal-600","from-red-500 to-red-600","from-amber-500 to-amber-600"],d=Os.useMemo(()=>{const c=[...u];for(let h=c.length-1;h>0;h--){const f=Math.floor(Math.random()*(h+1));[c[h],c[f]]=[c[f],c[h]]}const m=[];for(let h=0;h<r.length;h++)m.push(c[h%c.length]);return m},[r.length]);return e.jsxs("div",{className:"p-6 space-y-8 animate-fade-in fullbleed-sm",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-brand-900 dark:text-white tracking-tight mb-2",children:t}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg max-w-3xl",children:s})]}),r.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold text-brand-800 dark:text-brand-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:""})," Business Overview"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:r.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).map((c,m)=>e.jsxs("div",{className:`p-6 rounded-xl shadow-erp-sm hover:shadow-erp-md transition-all duration-200 cursor-pointer group bg-gradient-to-r ${c.color||d[m]} text-white`,onClick:()=>o(c.path),children:[e.jsx("div",{className:"flex justify-end mb-2",children:c.change&&e.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded-full bg-white/20 text-white",children:c.change})}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:c.value}),e.jsx("div",{className:"text-sm text-white/80 font-medium",children:c.label})]},m))})]}),a.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).length>0&&e.jsxs("div",{className:"mb-10",children:[e.jsxs("h2",{className:"text-xl font-semibold text-brand-800 dark:text-brand-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:""})," Quick Actions"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:a.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).map((c,m)=>e.jsxs("button",{className:"flex flex-col items-center justify-center p-4 bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-md hover:bg-brand-50 dark:hover:bg-slate-700 transition-all duration-200 group text-center h-full border border-slate-100 dark:border-slate-700",onClick:()=>o(c.path),children:[e.jsx("span",{className:"text-2xl mb-2 group-hover:-translate-y-1 transition-transform duration-200 block",children:c.icon}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 group-hover:text-brand-700 dark:group-hover:text-brand-300",children:c.label})]},m))})]}),e.jsx("div",{className:"space-y-10",children:n.map((c,m)=>{const h=c.title||c.category,f=c.items||c.features||[];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5 border-b border-slate-200 dark:border-slate-700 pb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:h}),c.badge&&e.jsx("span",{className:"bg-brand-100 text-brand-700 dark:bg-brand-900/40 dark:text-brand-300 text-xs font-bold px-2.5 py-0.5 rounded-full uppercase tracking-wider",children:c.badge})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:f.filter(x=>!(x!=null&&x.hidden)&&(!(x!=null&&x.path)||l(x.path,"view"))).map((x,g)=>{const b=x.title||x.name;return e.jsx("div",{className:"bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm hover:shadow-md hover:border-brand-300 dark:hover:border-brand-700 border border-transparent transition-all duration-200 cursor-pointer group relative overflow-hidden",onClick:()=>o(x.path),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-50 dark:bg-slate-700 flex items-center justify-center text-xl group-hover:bg-brand-100 dark:group-hover:bg-slate-600 transition-colors",children:x.icon||""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-800 dark:text-slate-100 group-hover:text-brand-700 dark:group-hover:text-brand-400 transition-colors mb-1",children:b}),x.description&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 line-clamp-2",children:x.description})]})]})},g)})})]},m)})})]})};function K6(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(""),[l,o]=v.useState("");v.useEffect(()=>{u()},[]);const u=async()=>{var c,m,h,f;try{a(!0),i("");const x=await te.get("/admin/roles"),g=Array.isArray((m=(c=x.data)==null?void 0:c.data)==null?void 0:m.items)?x.data.data.items:[];s(g)}catch(x){i(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.message)||"Error fetching roles"),console.error("Error fetching roles:",x)}finally{a(!1)}},d=t.filter(c=>String(c.name||"").toLowerCase().includes(l.toLowerCase())||String(c.code||"").toLowerCase().includes(l.toLowerCase()));return r?e.jsx("div",{className:"text-center py-8",children:"Loading roles..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Role Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure roles and assign permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/administration/roles/new",className:"btn-success",children:"+ New Role"})]})]}),n&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:n})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search roles...",className:"input max-w-md",value:l,onChange:c=>o(c.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Role Code"}),e.jsx("th",{children:"Role Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded text-sm",children:c.code})}),e.jsx("td",{className:"font-medium text-slate-900 dark:text-slate-100",children:c.name}),e.jsx("td",{children:c.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-slate-600 dark:text-slate-400",children:new Date(c.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("div",{className:"flex gap-2",children:e.jsx(Ee,{to:`/administration/roles/${c.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 text-sm font-medium",children:"Edit"})})})]},c.id))})]})}),d.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No roles found matching your search."})})]})})]})}function aw(){const{id:t}=Ps(),s=Ns(),r=!!t,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({code:"",name:"",isActive:!0}),[d,c]=v.useState([]),[m,h]=v.useState(new Set),[f,x]=v.useState({}),[g,b]=v.useState("");v.useEffect(()=>{const B=setInterval(()=>{y()},2e4);return()=>clearInterval(B)},[]),v.useEffect(()=>{y(),r&&N()},[t]);async function y(){var B,q;try{const O=((q=(B=(await te.get("/admin/pages")).data)==null?void 0:B.data)==null?void 0:q.items)||[];c(O);const T={},V=Y=>String(Y||"").split("-").map(M=>M[0]?M[0].toUpperCase()+M.slice(1):"").join(" "),D=Y=>Y==="new"||Y==="create"?"create":Y&&Y.startsWith(":")?"edit":"view";for(const Y of O){const M=Y.module||"General",R=String(Y.path||"").split("/").filter(Boolean);let H=R.slice(),W="view";if(R.length>0){const E=R[R.length-1],L=D(E);W=L,L!=="view"&&(H=R.slice(0,R.length-1))}const K=/\bDelete\b/i.test(String(Y.name||""))?"delete":null;K&&(W=K);let _="";H.length>=2?_=V(H[H.length-1]):_=String(Y.name||"").replace(/\s*(List|Form|Edit|Delete)\s*$/i,"")||V(R[1]||"");const F=H.join("/");T[M]||(T[M]={}),T[M][F]||(T[M][F]={label:_,actions:{}}),T[M][F].actions[W]=Y}x(T)}catch(Q){console.error("Error fetching pages:",Q)}}async function N(){var B,q,Q,O;try{n(!0),l("");const T=await te.get(`/admin/roles/${t}`);if((q=(B=T.data)==null?void 0:B.data)!=null&&q.item){const V=T.data.data.item;u({code:V.code,name:V.name,isActive:!!V.is_active}),Array.isArray(V.pages)&&h(new Set(V.pages.map(Number)))}}catch(T){l(((O=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:O.message)||"Error fetching role")}finally{n(!1)}}const j=B=>{h(q=>{const Q=new Set(q);return Q.has(B)?Q.delete(B):Q.add(B),Q})},S=async B=>{var q,Q;B.preventDefault(),n(!0),l("");try{let O=o.code;(!O||!r)&&(O=o.name.toUpperCase().trim().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,""));const T={code:O,name:o.name,is_active:o.isActive,pages:Array.from(m)};r?await te.put(`/admin/roles/${t}`,T):await te.post("/admin/roles",T),s("/administration/roles")}catch(O){l(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Error saving role")}finally{n(!1)}},k=(B,q)=>{h(Q=>{const O=new Set(Q);return q?O.add(B.id):O.delete(B.id),O})},P=(B,q)=>{const Q=[];for(const[,O]of B)for(const[,T]of Object.entries(O.actions))Q.push(T);h(O=>{const T=new Set(O);for(const V of Q)q?T.add(V.id):T.delete(V.id);return T})},I=(B,q,Q)=>{const O=[];for(const[,T]of B){const V=T.actions[q];V&&O.push(V)}h(T=>{const V=new Set(T);for(const D of O)Q?V.add(D.id):V.delete(D.id);return V})};return e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration/roles",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Roles"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Role":"New Role"}),e.jsx("p",{className:"text-sm mt-1",children:"Define role details and select accessible pages"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Ee,{to:"/administration/roles",className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a,children:a?"Saving...":"Save Role"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Role Information"})}),e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role Name *"}),e.jsx("input",{type:"text",className:"input",value:o.name,onChange:B=>u({...o,name:B.target.value}),placeholder:"e.g., Sales Manager",required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-8",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:o.isActive,onChange:B=>u({...o,isActive:B.target.checked})}),e.jsx("span",{className:"text-sm font-medium",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-100 dark:text-slate-100",children:"Page Access"}),e.jsx("p",{className:"text-sm mt-1",children:"Select which pages users with this role can access"}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{type:"button",className:"btn btn-secondary mr-3",onClick:y,disabled:a,children:"Refresh Pages"})})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"space-y-8",children:Object.entries(f).map(([B,q])=>{const Q=Object.entries(q),O=Q.every(([,T])=>Object.values(T.actions).every(V=>m.has(V.id)));return e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100 flex justify-between items-center",children:[e.jsx("span",{children:B}),e.jsxs("div",{className:"flex items-center gap-4 text-sm font-normal",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:O,onChange:T=>P(Q,T.target.checked)}),"Select All"]}),(()=>{const T=Q.map(([,D])=>D.actions.view).filter(Boolean),V=T.length>0&&T.every(D=>m.has(D.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:T.length===0,checked:V,onChange:D=>I(Q,"view",D.target.checked)}),"View"]})})(),(()=>{const T=Q.map(([,D])=>D.actions.create).filter(Boolean),V=T.length>0&&T.every(D=>m.has(D.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:T.length===0,checked:V,onChange:D=>I(Q,"create",D.target.checked)}),"Add"]})})(),(()=>{const T=Q.map(([,D])=>D.actions.edit).filter(Boolean),V=T.length>0&&T.every(D=>m.has(D.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:T.length===0,checked:V,onChange:D=>I(Q,"edit",D.target.checked)}),"Edit"]})})(),(()=>{const T=Q.map(([,D])=>D.actions.delete).filter(Boolean),V=T.length>0&&T.every(D=>m.has(D.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:T.length===0,checked:V,onChange:D=>I(Q,"delete",D.target.checked)}),"Delete"]})})()]})]}),e.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Q.map(([T,V])=>{const D=V.actions.view,Y=V.actions.create,M=V.actions.edit,X=V.actions.delete;return e.jsxs("div",{className:"flex flex-col gap-2 p-3 rounded-lg border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:V.label}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[D&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:m.has(D.id),onChange:R=>k(D,R.target.checked)}),"View"]}),Y&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:m.has(Y.id),onChange:R=>k(Y,R.target.checked)}),"Create"]}),M&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:m.has(M.id),onChange:R=>k(M,R.target.checked)}),"Edit"]}),X&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:m.has(X.id),onChange:R=>k(X,R.target.checked)}),"Delete"]})]})]},T)})})]},B)})})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-100 dark:text-slate-100",children:"All Pages (Individual)"}),e.jsx("p",{className:"text-sm mt-1",children:"New pages appear automatically"})]}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{className:"input",placeholder:"Search by module, name, or path",value:g,onChange:B=>b(B.target.value)})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm text-slate-600",children:[Array.isArray(d)?d.length:0," pages"]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Module"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Page"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Path"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Select"})]})}),e.jsx("tbody",{className:"bg-white",children:d.filter(B=>{const q=String(g||"").trim().toLowerCase();return q?String(B.module||"").toLowerCase().includes(q)||String(B.name||"").toLowerCase().includes(q)||String(B.path||"").toLowerCase().includes(q):!0}).sort((B,q)=>{const Q=String(B.module||""),O=String(q.module||"");return Q===O?String(B.name||"").localeCompare(String(q.name||"")):Q.localeCompare(O)}).map(B=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:B.module||"-"}),e.jsx("td",{className:"p-2",children:B.name||"-"}),e.jsx("td",{className:"p-2",children:B.path||"-"}),e.jsx("td",{className:"p-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:m.has(B.id),onChange:q=>j(B.id,q.target.checked)}),e.jsx("span",{className:"text-xs",children:"Allow"})]})})]},B.id))})]})})]})]})]})})}function z6(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState("all"),[c,m]=v.useState("all"),h={total:t.length,active:t.filter(g=>g.is_active).length,inactive:t.filter(g=>!g.is_active).length};v.useEffect(()=>{f()},[]);const f=async()=>{var g,b,y,N;try{a(!0),i("");const j=await te.get("/admin/users"),S=Array.isArray((b=(g=j.data)==null?void 0:g.data)==null?void 0:b.items)?j.data.data.items:[];s(S)}catch(j){i(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Error fetching users"),console.error("Error fetching users:",j)}finally{a(!1)}},x=t.filter(g=>{const b=String(g.full_name||"").toLowerCase().includes(l.toLowerCase())||String(g.username||"").toLowerCase().includes(l.toLowerCase())||String(g.email||"").toLowerCase().includes(l.toLowerCase()),y=u==="all"||u==="active"&&g.is_active||u==="inactive"&&!g.is_active,N=c==="all"||g.user_type&&g.user_type.toLowerCase()===c.toLowerCase();return b&&y&&N});return e.jsxs("div",{className:"user-container",children:[e.jsxs("div",{className:"user-header",children:[e.jsx("h1",{children:" User Management System"}),e.jsxs("div",{className:"user-header-actions",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/administration/users/new",className:"btn btn-primary",style:{textDecoration:"none",color:"white",padding:"10px 20px",borderRadius:"6px",background:"#28a745"},children:" Create New User"}),e.jsx("button",{className:"btn btn-secondary",onClick:f,style:{padding:"10px 20px",border:"none",borderRadius:"6px",cursor:"pointer",background:"#6c757d",color:"white"},children:" Refresh"})]})]}),e.jsx("div",{className:"user-search-section",children:e.jsxs("div",{className:"user-search-box",children:[e.jsxs("div",{className:"user-form-group",children:[e.jsx("label",{children:"Search by Name/Email"}),e.jsx("input",{type:"text",className:"user-form-control",placeholder:"Enter name or email...",value:l,onChange:g=>o(g.target.value)})]}),e.jsxs("div",{className:"user-form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"user-form-control",value:u,onChange:g=>d(g.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"user-table-container",children:[e.jsxs("div",{className:"user-stats",children:[e.jsxs("div",{className:"user-stat-card",children:[e.jsx("h3",{children:"Total Users"}),e.jsx("div",{className:"stat-value",children:h.total})]}),e.jsxs("div",{className:"user-stat-card",children:[e.jsx("h3",{children:"Active Users"}),e.jsx("div",{className:"stat-value",children:h.active})]}),e.jsxs("div",{className:"user-stat-card",children:[e.jsx("h3",{children:"Inactive Users"}),e.jsx("div",{className:"stat-value",children:h.inactive})]})]}),r?e.jsx("div",{className:"text-center py-8",children:"Loading users..."}):n?e.jsx("div",{className:"text-center py-8 text-red-500",children:n}):e.jsxs("table",{className:"user-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Branch"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-4",children:"No users found"})}):x.map(g=>{const b=(g.full_name||g.username||"?").substring(0,2).toUpperCase();return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-avatar",children:g.profile_picture_url?e.jsx("img",{src:g.profile_picture_url,alt:g.username,style:{width:"100%",height:"100%",objectFit:"cover"}}):b}),e.jsx("div",{className:"user-details",children:e.jsx("span",{className:"user-name",children:g.full_name||"N/A"})})]})}),e.jsx("td",{children:g.username}),e.jsx("td",{children:g.email}),e.jsx("td",{children:g.user_type||"Internal"}),e.jsx("td",{children:g.company_name||"N/A"}),e.jsx("td",{children:g.branch_name||"N/A"}),e.jsx("td",{children:g.is_active?e.jsx("span",{className:"user-status-badge user-status-active",children:"Active"}):e.jsx("span",{className:"user-status-badge user-status-inactive",children:"Inactive"})}),e.jsx("td",{children:g.created_at?new Date(g.created_at).toLocaleDateString():"N/A"}),e.jsx("td",{children:e.jsx("div",{className:"user-action-buttons",children:e.jsx(Ee,{to:`/administration/users/${g.id}`,className:"btn",style:{background:"#007bff",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",textDecoration:"none"},children:" Edit"})})})]},g.id)})})]})]})]})}function nw(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState({companyId:"",branchIds:[],username:"",email:"",fullName:"",password:"",isActive:!0,profilePictureUrl:"",isEmployee:!1,userType:"Internal",validFrom:"",validTo:"",roleId:""}),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState([]),[y,N]=v.useState(!1);v.useEffect(()=>{j(),r&&S()},[s]);async function j(){var O,T,V;try{const[D,Y,M]=await Promise.all([te.get("/admin/companies"),te.get("/admin/branches"),te.get("/admin/roles").catch(()=>({data:{items:[]}}))]);h(D.data&&D.data.data&&D.data.data.items||((O=D.data)==null?void 0:O.items)||[]),x(Y.data&&Y.data.data&&Y.data.data.items||((T=Y.data)==null?void 0:T.items)||[]),b(M.data&&M.data.data&&M.data.data.items||((V=M.data)==null?void 0:V.items)||[])}catch(D){console.error("Error fetching dependencies:",D)}}async function S(){var O,T,V,D,Y,M;try{n(!0),u("");const X=await te.get(`/admin/users/${s}`);if((T=(O=X.data)==null?void 0:O.data)!=null&&T.item){const R=X.data.data.item;c({companyId:R.company_id||"",branchIds:R.branch_id?[String(R.branch_id)]:[],username:R.username||"",email:R.email||"",fullName:R.full_name||"",isActive:!!R.is_active,password:"",profilePictureUrl:R.profile_picture_url||"",isEmployee:!!R.is_employee,userType:R.user_type||"Internal",validFrom:R.valid_from?R.valid_from.split("T")[0]:"",validTo:R.valid_to?R.valid_to.split("T")[0]:"",roleId:R.role_id||""});try{const H=await te.get(`/admin/users/${s}/branches`),W=Array.isArray((D=(V=H.data)==null?void 0:V.data)==null?void 0:D.items)?H.data.data.items:[];c(K=>({...K,branchIds:W.map(_=>String(_.id))}))}catch{}}}catch(X){u(((M=(Y=X==null?void 0:X.response)==null?void 0:Y.data)==null?void 0:M.message)||"Error fetching user")}finally{n(!1)}}function k(O,T){c(V=>({...V,[O]:T}))}async function P(O){const T=O.target.files[0];if(!T)return;const V=new FormData;V.append("file",T);try{l(!0);const D=await te.post("/upload",V,{headers:{"Content-Type":"multipart/form-data"}});k("profilePictureUrl",D.data.url)}catch(D){console.error("Upload failed",D),u("Failed to upload profile picture")}finally{l(!1)}}function I(O){if(!O)return!0;const T=8,V=/[A-Z]/.test(O),D=/[0-9]/.test(O),Y=/[!@#$%^&*(),.?":{}|<>]/.test(O);return O.length<T?"Password must be at least 8 characters long.":V?D?Y?!0:"Password must contain at least one special character.":"Password must contain at least one number.":"Password must contain at least one uppercase letter."}async function B(O){var T,V,D;if(O.preventDefault(),n(!0),u(""),!r||d.password){const Y=I(d.password);if(Y!==!0){u(Y),n(!1);return}}try{const Y={company_id:d.companyId,branch_id:(T=d.branchIds)!=null&&T[0]?Number(d.branchIds[0]):void 0,branch_ids:d.branchIds.map(M=>Number(M)),username:d.username,email:d.email,full_name:d.fullName,is_active:d.isActive,profile_picture_url:d.profilePictureUrl,is_employee:d.isEmployee,user_type:d.userType,valid_from:d.validFrom||null,valid_to:d.validTo||null,role_id:d.roleId||null};if(!Y.branch_id){u("Select at least one branch"),n(!1);return}d.password&&(Y.password_hash=d.password),r?await te.put(`/admin/users/${s}`,Y):await te.post("/admin/users",Y),t("/administration/users")}catch(Y){u(((D=(V=Y==null?void 0:Y.response)==null?void 0:V.data)==null?void 0:D.message)||"Error saving user")}finally{n(!1)}}const q=d.companyId?f.filter(O=>String(O.company_id)===String(d.companyId)):[],Q=d.companyId?g.filter(O=>String(O.company_id)===String(d.companyId)):[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration/users",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Users"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit User":"New User"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage system users"})]}),e.jsx("form",{onSubmit:B,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[o&&e.jsx("div",{className:"alert alert-error mb-4",children:o}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company *"}),e.jsxs("select",{className:"input",value:d.companyId,onChange:O=>{k("companyId",O.target.value),k("branchIds",[]),k("roleId","")},required:!0,children:[e.jsx("option",{value:"",children:"-- Select Company --"}),m.map(O=>e.jsxs("option",{value:O.id,children:[O.name," (",O.code,")"]},O.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branches *"}),e.jsxs("div",{className:"space-y-2 border rounded-md p-2 max-h-48 overflow-auto",children:[q.map(O=>{const T=d.branchIds.includes(String(O.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-brand rounded focus:ring-brand",checked:T,onChange:V=>{const D=V.target.checked;c(Y=>{const M=new Set(Y.branchIds);return D?M.add(String(O.id)):M.delete(String(O.id)),{...Y,branchIds:Array.from(M)}})},disabled:!d.companyId}),e.jsxs("span",{className:"text-sm",children:[O.name," (",O.code,")"]})]},O.id)}),q.length===0?e.jsx("div",{className:"text-xs text-slate-500",children:"Select a company to see branches"}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username *"}),e.jsx("input",{className:"input",value:d.username,onChange:O=>k("username",O.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email *"}),e.jsx("input",{className:"input",type:"email",value:d.email,onChange:O=>k("email",O.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Name *"}),e.jsx("input",{className:"input",value:d.fullName,onChange:O=>k("fullName",O.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{className:"input",value:d.roleId,onChange:O=>k("roleId",O.target.value),disabled:!d.companyId,children:[e.jsx("option",{value:"",children:"-- Select Role --"}),Q.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center gap-4",children:[d.profilePictureUrl&&e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border border-slate-200",children:e.jsx("img",{src:d.profilePictureUrl,alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",className:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-50 file:text-brand-700 hover:file:bg-brand-100 text-sm text-slate-500",onChange:P,accept:"image/*",disabled:i}),i&&e.jsx("span",{className:"text-xs text-brand ml-2",children:"Uploading..."})]})]}),e.jsx("input",{type:"hidden",value:d.profilePictureUrl})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"User Type"}),e.jsxs("select",{className:"input",value:d.userType,onChange:O=>k("userType",O.target.value),children:[e.jsx("option",{value:"Internal",children:"Internal"}),e.jsx("option",{value:"External",children:"External"}),e.jsx("option",{value:"Vendor",children:"Vendor"}),e.jsx("option",{value:"Customer",children:"Customer"}),e.jsx("option",{value:"Contractor",children:"Contractor"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.isEmployee,onChange:O=>k("isEmployee",O.target.checked),className:"w-4 h-4 text-brand rounded focus:ring-brand"}),e.jsx("span",{className:"text-sm font-medium",children:"Is Employee"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.isActive,onChange:O=>k("isActive",O.target.checked),className:"w-4 h-4 text-brand rounded focus:ring-brand"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Status"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Valid From"}),e.jsx("input",{type:"date",className:"input",value:d.validFrom,onChange:O=>k("validFrom",O.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Valid To"}),e.jsx("input",{type:"date",className:"input",value:d.validTo,onChange:O=>k("validTo",O.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 border-t pt-4 mt-2",children:[e.jsx("label",{className:"label",children:r?"New Password (leave blank to keep current)":"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"input pr-10",type:y?"text":"password",value:d.password,onChange:O=>k("password",O.target.value),required:!r,placeholder:r?"Enter new password...":"Enter password..."}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center text-slate-500",onClick:()=>N(O=>!O),"aria-label":y?"Hide password":"Show password",children:y?e.jsx(qy,{size:18}):e.jsx(L0,{size:18})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Must be at least 8 characters, include 1 uppercase, 1 number, and 1 special character."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(Ee,{to:"/administration/users",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update User":"Create User"})]})]})})})]})}const Y6=()=>{const[t,s]=v.useState([]),[r,a]=v.useState(!0),n=Ns();v.useEffect(()=>{i()},[]);const i=async()=>{try{const o=await te.get("/workflows");s(o.data.items||[])}catch(o){console.error("Failed to fetch workflows",o)}finally{a(!1)}},l=async o=>{if(window.confirm("Are you sure you want to delete this workflow?"))try{await te.delete(`/workflows/${o}`),i()}catch(u){console.error("Failed to delete workflow",u)}};return r?e.jsx("div",{className:"p-8 text-center",children:"Loading workflows..."}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Workflow Definitions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsxs("button",{onClick:()=>n("/administration/workflows/new"),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition",children:[e.jsx(vu,{size:20}),"Create Workflow"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doc Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"No workflows defined yet."})}):t.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.workflow_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.workflow_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.module_key}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.document_type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${o.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.is_active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>n(`/administration/workflows/${o.id}`),className:"text-blue-600 hover:text-blue-900 mr-4",children:e.jsx(sA,{size:18})}),e.jsx("button",{onClick:()=>l(o.id),className:"text-red-600 hover:text-red-900",children:e.jsx(Gl,{size:18})})]})]},o.id))})]})})]})};function X6(t){return String(t||"").split("-").map(s=>s[0]?s[0].toUpperCase()+s.slice(1):"").join(" ")}function iw(t,s){return`${t}_${s}`.toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,"")}function Tp(t){return String(t||"").toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,"")}const lw=()=>{const{id:t}=Ps(),s=Ns(),r=!!t,[a,n]=v.useState(!1),[i,l]=v.useState([]),[o,u]=v.useState([]),[d,c]=v.useState(""),[m,h]=v.useState({workflow_code:"",workflow_name:"",module_key:"",document_type:"",document_route:"",is_active:!0,steps:[]});v.useEffect(()=>{b();const I=setInterval(b,2e4);return r&&y(),()=>clearInterval(I)},[t]);const[f,x]=v.useState({}),g=async(I,B)=>{var Q;const q=String(B||"").trim();if(q.length<2){x(O=>({...O,[I]:[]}));return}try{const O=await te.get("/admin/users",{params:{q,active:1}}),T=Array.isArray((Q=O.data)==null?void 0:Q.items)?O.data.items:[];x(V=>({...V,[I]:T}))}catch{x(T=>({...T,[I]:[]}))}},b=async()=>{var I;try{const q=((I=(await te.get("/admin/pages")).data)==null?void 0:I.items)||[],Q={},O=V=>V==="new"||V==="create"?"create":V&&V.startsWith(":")?"edit":"view";for(const V of q){const D=V.module||"General",Y=String(V.path||""),M=Y.split("/").filter(Boolean);if(!M.length||/administration/i.test(D)||/business intelligence/i.test(D)||/reports/i.test(Y)||/dashboard/i.test(Y)||/permissions/i.test(Y))continue;let X=M.slice(),R="view";if(M.length>0){const K=M[M.length-1],_=O(K);R=_,_!=="view"&&(X=M.slice(0,M.length-1))}const H=X.join("/"),W=String(V.name||"").replace(/\s*(List|Form|Edit|Delete)\s*$/i,"")||X6(X[X.length-1]||M[1]||"");Q[D]||(Q[D]={}),Q[D][H]||(Q[D][H]={module:D,label:W,actions:{view:null,create:null,edit:null}}),(R==="create"||R==="edit"||R==="view")&&(Q[D][H].actions[R]=V)}const T=[];for(const[V,D]of Object.entries(Q))for(const[Y,M]of Object.entries(D))(M.actions.create||M.actions.edit)&&T.push({module:V,label:M.label,value:`${V}|${M.label}`,code:iw(V,M.label),route:`/${Y}`});T.sort((V,D)=>V.module===D.module?V.label.localeCompare(D.label):V.module.localeCompare(D.module)),u(T)}catch(B){console.error("Failed to fetch transaction document types",B),u([])}};v.useEffect(()=>{if(!m.module_key||!m.document_type||o.length===0)return;const I=o.find(B=>Tp(B.module)===Tp(m.module_key)&&B.label===m.document_type)||o.find(B=>B.code===iw(Tp(m.module_key),m.document_type));c(I?I.code:"")},[o,m.module_key,m.document_type]);const y=async()=>{n(!0);try{const B=(await te.get(`/workflows/${t}`)).data.item,q=Array.isArray(B.steps)?B.steps.map(Q=>({...Q,approver_user_ids:Array.isArray(Q.approvers)&&Q.approvers.length?Q.approvers.map(O=>O.id):Q.approver_user_id?[Q.approver_user_id]:[]})):[];h({...B,is_active:!!B.is_active,steps:q})}catch(I){console.error("Failed to fetch workflow",I),alert("Error loading workflow")}finally{n(!1)}},N=I=>{const{name:B,value:q,type:Q,checked:O}=I.target;h(T=>({...T,[B]:Q==="checkbox"?O:q}))},j=(I,B,q)=>{const Q=[...m.steps];Q[I]={...Q[I],[B]:q},h(O=>({...O,steps:Q}))},S=()=>{h(I=>({...I,steps:[...I.steps,{step_order:I.steps.length+1,step_name:"",approver_user_ids:[],approval_limit:null,is_mandatory:!0}]}))},k=I=>{const q=m.steps.filter((Q,O)=>O!==I).map((Q,O)=>({...Q,step_order:O+1}));h(Q=>({...Q,steps:q}))},P=async I=>{var B,q;I.preventDefault(),n(!0);try{for(const O of m.steps)if(!(Array.isArray(O.approver_user_ids)?O.approver_user_ids:O.approver_user_id?[O.approver_user_id]:[]).length){alert(`Please select an approver for step ${O.step_order}`),n(!1);return}const Q={...m,steps:m.steps.map(O=>{const T=Array.isArray(O.approver_user_ids)?O.approver_user_ids:O.approver_user_id?[O.approver_user_id]:[];return{...O,approver_user_ids:T.map(V=>Number(V)),approval_limit:O.approval_limit?parseFloat(O.approval_limit):null}})};if(!r){const O=String(Q.workflow_code||"");/^WF-[0-9]{6}$/.test(O)||delete Q.workflow_code}r?await te.put(`/workflows/${t}`,Q):await te.post("/workflows",Q),s("/administration/workflows")}catch(Q){console.error("Failed to save workflow",Q),alert(((q=(B=Q.response)==null?void 0:B.data)==null?void 0:q.message)||"Error saving workflow")}finally{n(!1)}};return a&&r&&!m.workflow_code?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s("/administration/workflows"),className:"text-gray-500 hover:text-gray-700",children:e.jsx(If,{size:24})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:r?"Edit Workflow":"Create Workflow"})]}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Workflow Name"}),e.jsx("input",{type:"text",name:"workflow_name",required:!0,value:m.workflow_name,onChange:N,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Workflow Code"}),e.jsx("input",{type:"text",name:"workflow_code",required:!0,value:m.workflow_code,readOnly:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 bg-gray-100 text-gray-500 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Module Key"}),e.jsxs("select",{name:"module_key",required:!0,value:m.module_key,onChange:N,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[e.jsx("option",{value:"",children:"Select Module"}),o.length===0?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"PURCHASE",children:"Purchase"}),e.jsx("option",{value:"SALES",children:"Sales"}),e.jsx("option",{value:"HR",children:"HR"}),e.jsx("option",{value:"FINANCE",children:"Finance"}),e.jsx("option",{value:"INVENTORY",children:"Inventory"})]}):Array.from(new Set(o.map(I=>I.module))).map(I=>e.jsx("option",{value:String(I).toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,""),children:I},I))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Document Type"}),e.jsxs("select",{name:"document_type",required:!0,value:d,onChange:I=>{const B=I.target.value;c(B);const q=o.find(Q=>Q.code===B)||(()=>{const Q=String(B).split("|");return Q.length===2?{module:Q[0],label:Q[1],route:`/${Q[0].toLowerCase()}/${Q[1].toLowerCase().replace(/[^a-z0-9]+/g,"-")}`}:null})();q&&h(Q=>({...Q,module_key:Tp(q.module),document_type:q.label||"",document_route:q.route||""}))},className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[e.jsx("option",{value:"",children:"Select Document Type"}),o.length===0?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"SALES|Sales Order",children:"Sales Order"}),e.jsx("option",{value:"PURCHASE|Purchase Order",children:"Purchase Order"}),e.jsx("option",{value:"SALES|Invoice",children:"Invoice"}),e.jsx("option",{value:"INVENTORY|Work Order",children:"Work Order"})]}):o.map(I=>e.jsx("option",{value:I.code,children:I.label},I.code))]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{type:"button",onClick:b,className:"btn btn-sm btn-secondary",children:"Refresh Types"})})]}),e.jsxs("div",{className:"flex items-center mt-6",children:[e.jsx("input",{type:"checkbox",name:"is_active",checked:m.is_active,onChange:N,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Is Active"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Approval Steps"}),e.jsxs("button",{type:"button",onClick:S,className:"flex items-center gap-1 text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200",children:[e.jsx(vu,{size:16})," Add Step"]})]}),e.jsxs("div",{className:"space-y-4",children:[m.steps.map((I,B)=>e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-end p-4 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"w-full md:w-16",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Order"}),e.jsx("div",{className:"mt-1 font-semibold text-center",children:I.step_order})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Step Name"}),e.jsx("input",{type:"text",value:I.step_name,onChange:q=>j(B,"step_name",q.target.value),placeholder:"e.g. Manager Approval",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm"})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Approvers (Users)"}),e.jsx("input",{type:"text",placeholder:"Type to search users (min 2 chars)",onChange:q=>g(B,q.target.value||""),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm"}),e.jsx("select",{className:"hidden"}),e.jsx("div",{className:"mt-1 grid grid-cols-1 md:grid-cols-2 gap-2",children:(f[B]||[]).map(q=>{const Q=Number(q.id),O=Array.isArray(I.approver_user_ids)?I.approver_user_ids.map(T=>Number(T)).includes(Q):!1;return e.jsxs("label",{className:"flex items-center gap-2 border rounded p-2 text-sm cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",value:Q,checked:O,onChange:T=>{const V=Number(T.target.value),D=Array.isArray(I.approver_user_ids)?I.approver_user_ids.map(M=>Number(M)):[],Y=T.target.checked?Array.from(new Set([...D,V])):D.filter(M=>M!==V);j(B,"approver_user_ids",Y)}}),e.jsx("span",{children:q.username||q.full_name||q.email||`User #${Q}`})]},Q)})}),Array.isArray(I.approver_user_ids)&&I.approver_user_ids.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:I.approver_user_ids.map(q=>{const Q=Number(q),O=(f[B]||[]).find(V=>Number(V.id)===Q)||(Array.isArray(I.approvers)?I.approvers.find(V=>Number(V.id)===Q):null),T=O&&(O.username||O.full_name||O.email)||`User #${Q}`;return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-50 text-blue-700 text-xs",children:T},`sel-${Q}`)})})]}),e.jsxs("div",{className:"w-full md:w-32",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Limit ($)"}),e.jsx("input",{type:"number",value:I.approval_limit||"",onChange:q=>j(B,"approval_limit",q.target.value),placeholder:"No Limit",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm"})]}),e.jsx("button",{type:"button",onClick:()=>k(B),className:"text-red-500 hover:text-red-700 p-2",children:e.jsx(Gl,{size:18})})]},B)),m.steps.length===0&&e.jsx("p",{className:"text-gray-500 text-sm italic text-center py-4",children:'No steps defined. Click "Add Step" to begin.'})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>s("/administration/workflows"),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Hh,{size:18}),a?"Saving...":"Save Workflow"]})]})]})]})};function J6(){const[t,s]=v.useState([]),[r,a]=v.useState(!0);return v.useEffect(()=>{te.get("/workflows/approvals/pending").then(n=>s(n.data.items)).catch(n=>console.error(n)).finally(()=>a(!1))},[]),r?e.jsx("div",{className:"p-6",children:"Loading approvals..."}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"My Pending Approvals"}),e.jsx(Ee,{to:"/",className:"btn btn-secondary",children:"Return to Home"})]}),t.length===0?e.jsx("div",{className:"text-slate-500",children:"No pending approvals found."}):e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 font-medium border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Document"}),e.jsx("th",{className:"p-4",children:"Type"}),e.jsx("th",{className:"p-4",children:"Amount"}),e.jsx("th",{className:"p-4",children:"Step"}),e.jsx("th",{className:"p-4",children:"Submitted By"}),e.jsx("th",{className:"p-4",children:"Date"}),e.jsx("th",{className:"p-4",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:t.map(n=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsxs("td",{className:"p-4 font-medium text-slate-900 dark:text-slate-100",children:[String(n.document_type||"").replace(/_/g," ").toLowerCase().replace(/\b\w/g,i=>i.toUpperCase())," #",n.document_id]}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:n.document_type}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:n.amount!=null?Number(n.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"badge bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:n.step_name})}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:n.initiator||"Unknown"}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:new Date(n.submitted_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsx(Ee,{to:`/administration/workflows/approvals/${n.workflow_instance_id}`,className:"btn btn-sm btn-primary",children:"Review"})})]},n.workflow_instance_id))})]})})]})}function Z6(){const{instanceId:t}=Ps(),s=Ns(),[r,a]=v.useState(null),[n,i]=v.useState(!0),[l,o]=v.useState(""),[u,d]=v.useState(!1),[c,m]=v.useState(null),[h,f]=v.useState([]),[x,g]=v.useState(!1),[b,y]=v.useState(null);v.useEffect(()=>{te.get(`/workflows/approvals/instance/${t}`).then(j=>a(j.data.item)).catch(j=>{console.error(j),mt.error("Failed to load workflow details")}).finally(()=>i(!1))},[t]),v.useEffect(()=>{if(!r)return;if(!r.is_last_step&&Array.isArray(r.next_step_approvers)){const S=r.next_step_approvers[0];y(S?S.id:null)}else y(null);const j=String(r.document_type||"").toUpperCase();j==="MATERIAL_REQUISITION"?(g(!0),te.get(`/inventory/material-requisitions/${r.document_id}`).then(S=>{var k,P;m(((k=S.data)==null?void 0:k.item)||null),f(Array.isArray((P=S.data)==null?void 0:P.details)?S.data.details:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):j==="STOCK_ADJUSTMENT"?(g(!0),te.get(`/inventory/stock-adjustments/${r.document_id}`).then(S=>{var k,P;m(((k=S.data)==null?void 0:k.item)||null),f(Array.isArray((P=S.data)==null?void 0:P.details)?S.data.details:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):j==="PURCHASE_ORDER"||j==="PURCHASE ORDER"?(g(!0),te.get(`/purchase/orders/${r.document_id}`).then(S=>{var k,P,I;m(((k=S.data)==null?void 0:k.item)||null),f(Array.isArray((I=(P=S.data)==null?void 0:P.item)==null?void 0:I.details)?S.data.item.details:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):j==="GOODS_RECEIPT"||j==="GRN"||j==="GOODS RECEIPT NOTE"?(g(!0),te.get(`/inventory/grn/${r.document_id}`).then(S=>{var k,P,I;m(((k=S.data)==null?void 0:k.item)||null),f(Array.isArray((I=(P=S.data)==null?void 0:P.item)==null?void 0:I.details)?S.data.item.details:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):j==="PAYMENT_VOUCHER"||j==="PAYMENT VOUCHER"||j==="PV"?(g(!0),te.get(`/finance/vouchers/${r.document_id}`).then(S=>{var k,P;m(((k=S.data)==null?void 0:k.voucher)||null),f(Array.isArray((P=S.data)==null?void 0:P.lines)?S.data.lines:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):j==="RECEIPT_VOUCHER"||j==="RECEIPT VOUCHER"||j==="RV"?(g(!0),te.get(`/finance/vouchers/${r.document_id}`).then(S=>{var k,P;m(((k=S.data)==null?void 0:k.voucher)||null),f(Array.isArray((P=S.data)==null?void 0:P.lines)?S.data.lines:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):j==="SALES_ORDER"||j==="SALES ORDER"?(g(!0),te.get(`/sales/orders/${r.document_id}`).then(S=>{var k,P;m(((k=S.data)==null?void 0:k.item)||null),f(Array.isArray((P=S.data)==null?void 0:P.details)?S.data.details:[])}).catch(()=>{m(null),f([])}).finally(()=>g(!1))):(m(null),f([]),g(!1))},[r]);const N=async j=>{var S,k;if(!l&&(j==="REJECT"||j==="RETURN")){mt.warning("Please provide a comment for rejection/return");return}if(j==="APPROVE"&&!r.is_last_step&&!b){mt.warning("Please select the next approver");return}d(!0);try{await te.post(`/workflows/${t}/action`,{action:j,comments:l,target_user_id:r.is_last_step?null:b}),mt.success(`Document ${j.toLowerCase()}ed successfully`),s("/administration/workflows/approvals")}catch(P){console.error(P),mt.error(((k=(S=P.response)==null?void 0:S.data)==null?void 0:k.message)||"Action failed")}finally{d(!1)}};return n?e.jsx("div",{className:"p-6",children:"Loading details..."}):r?e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:["Review:"," ",String(r.document_type||"").replace(/_/g," ").toLowerCase().replace(/\b\w/g,j=>j.toUpperCase())," ","#",r.document_id]}),e.jsx("button",{onClick:()=>s(-1),className:"btn btn-outline",children:"Back"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:"Document Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Document Type"}),e.jsx("div",{className:"font-medium",children:r.document_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"ID"}),e.jsxs("div",{className:"font-medium",children:["#",r.document_id]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Amount"}),e.jsx("div",{className:"font-medium",children:r.amount!=null?Number(r.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Submitted At"}),e.jsx("div",{className:"font-medium",children:new Date(r.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Current Status"}),e.jsx("span",{className:`badge ${r.status==="PENDING"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:r.status})]})]}),String(r.document_type||"").toUpperCase()==="MATERIAL_REQUISITION"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requisition No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.requisition_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requisition Date"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.requisition_date)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.warehouse_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Department"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.department_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requested By"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.requested_by)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty Requested"}),e.jsx("th",{children:"UOM"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:j.item_code||j.item_id}),e.jsx("td",{children:j.item_name||"-"}),e.jsx("td",{children:Number(j.qty_requested||0)}),e.jsx("td",{children:j.uom||"-"})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]}),(c==null?void 0:c.remarks)&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 rounded text-sm",children:[e.jsx("div",{className:"text-slate-500",children:"Remarks"}),e.jsx("div",{className:"text-slate-700 dark:text-slate-300",children:c.remarks})]})]}):String(r.document_type||"").toUpperCase()==="STOCK_ADJUSTMENT"||String(r.document_type||"").toUpperCase()==="STOCK ADJUSTMENT"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Adjustment No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.adjustment_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.adjustment_date?new Date(c.adjustment_date).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.adjustment_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),(c==null?void 0:c.warehouse_name)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-medium",children:c.warehouse_name})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Adjusted Stock"}),e.jsx("th",{children:"Difference"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:j.item_code||j.item_id}),e.jsx("td",{children:j.item_name||"-"}),e.jsx("td",{children:Number(j.current_stock||0)}),e.jsx("td",{children:Number(j.adjusted_stock||0)}),e.jsxs("td",{className:Number(j.qty)<0?"text-red-500":"text-green-500",children:[Number(j.qty)>0?"+":"",Number(j.qty)]})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]}),(c==null?void 0:c.reason)&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 rounded text-sm",children:[e.jsx("div",{className:"text-slate-500",children:"Reason"}),e.jsx("div",{className:"text-slate-700 dark:text-slate-300",children:c.reason})]})]}):String(r.document_type||"").toUpperCase()==="PURCHASE_ORDER"||String(r.document_type||"").toUpperCase()==="PURCHASE ORDER"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"PO No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.po_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"PO Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.po_date?new Date(c.po_date).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Order Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.po_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.supplier_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_amount)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Line Total"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:j.item_code||j.item_id}),e.jsx("td",{children:j.item_name||"-"}),e.jsx("td",{children:Number(j.qty||0)}),e.jsx("td",{children:Number(j.unit_price||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(j.line_total||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]})]}):String(r.document_type||"").toUpperCase()==="GOODS_RECEIPT"||String(r.document_type||"").toUpperCase()==="GRN"||String(r.document_type||"").toUpperCase()==="GOODS RECEIPT NOTE"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"GRN No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.grn_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"GRN Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.grn_date?String(c.grn_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.supplier_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.warehouse_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Invoice No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.invoice_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Invoice Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.invoice_date?String(c.invoice_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Invoice Amount"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.invoice_amount)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty Received"}),e.jsx("th",{children:"Qty Accepted"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Line Amount"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:j.item_code||j.item_id}),e.jsx("td",{children:j.item_name||"-"}),e.jsx("td",{children:Number(j.qty_received||0)}),e.jsx("td",{children:Number(j.qty_accepted||0)}),e.jsx("td",{children:j.uom||"-"}),e.jsx("td",{children:Number(j.unit_price||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(j.line_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]})]}):String(r.document_type||"").toUpperCase()==="PAYMENT_VOUCHER"||String(r.document_type||"").toUpperCase()==="PAYMENT VOUCHER"||String(r.document_type||"").toUpperCase()==="PV"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.voucher_date?String(c.voucher_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_type_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Debit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_debit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Credit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_credit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Lines (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsxs("td",{children:[j.account_code," - ",j.account_name]}),e.jsx("td",{children:j.description||"-"}),e.jsx("td",{className:"text-right",children:Number(j.debit||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{className:"text-right",children:Number(j.credit||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No lines found"})]})]}):String(r.document_type||"").toUpperCase()==="RECEIPT_VOUCHER"||String(r.document_type||"").toUpperCase()==="RECEIPT VOUCHER"||String(r.document_type||"").toUpperCase()==="RV"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.voucher_date?String(c.voucher_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_type_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Debit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_debit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Credit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_credit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Lines (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsxs("td",{children:[j.account_code," - ",j.account_name]}),e.jsx("td",{children:j.description||"-"}),e.jsx("td",{className:"text-right",children:Number(j.debit||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{className:"text-right",children:Number(j.credit||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No lines found"})]})]}):String(r.document_type||"").toUpperCase()==="SALES_ORDER"||String(r.document_type||"").toUpperCase()==="SALES ORDER"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Order No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.order_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Order Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.order_date?new Date(c.order_date).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Customer ID"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.customer_id)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Price Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.price_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Payment Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.payment_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_amount)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",h.length,")"]}),x?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item ID"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Tax Amount"}),e.jsx("th",{children:"Line Total"})]})}),e.jsx("tbody",{children:h.map(j=>e.jsxs("tr",{children:[e.jsx("td",{children:j.item_id}),e.jsx("td",{children:Number(j.quantity||0)}),e.jsx("td",{children:Number(j.unit_price||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(j.tax_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(j.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},j.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]}),(c==null?void 0:c.remarks)&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 rounded text-sm",children:[e.jsx("div",{className:"text-slate-500",children:"Remarks"}),e.jsx("div",{className:"text-slate-700 dark:text-slate-300",children:c.remarks})]})]}):e.jsxs("div",{className:"mt-6 p-4 bg-slate-50 dark:bg-slate-900/50 rounded border border-slate-100 dark:border-slate-800 text-center text-slate-500",children:[e.jsx("p",{children:"Document Preview Not Available"}),e.jsx("p",{className:"text-xs mt-1",children:`(${r.document_type} preview not implemented)`})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:"Approval History"}),e.jsx("div",{className:"space-y-4",children:r.logs&&r.logs.length>0?r.logs.map((j,S)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"mt-1 w-2 h-2 rounded-full bg-slate-300 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:[j.actor_name||"Unknown"," ",e.jsx("span",{className:"text-slate-500",children:"performed"})," ",j.action]}),e.jsx("div",{className:"text-xs text-slate-500",children:new Date(j.created_at).toLocaleString()}),j.comments&&e.jsxs("div",{className:"mt-1 text-sm bg-slate-50 dark:bg-slate-900/50 p-2 rounded text-slate-600 dark:text-slate-400",children:['"',j.comments,'"']})]})]},S)):e.jsx("div",{className:"text-slate-500 italic",children:"No history yet."})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 p-6 sticky top-24",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Actions"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Current Step"}),e.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded border border-blue-100 dark:border-blue-800",children:r.step_name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Comments"}),e.jsx("textarea",{className:"input w-full h-24",placeholder:"Enter comments...",value:l,onChange:j=>o(j.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[!r.is_last_step&&Array.isArray(r.next_step_approvers)&&e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Forward To"}),e.jsxs("select",{className:"input w-full",value:b||"",onChange:j=>y(Number(j.target.value)),children:[e.jsx("option",{value:"",children:"Select user"}),r.next_step_approvers.map(j=>e.jsx("option",{value:j.id,children:j.username},j.id))]})]}),e.jsx("button",{onClick:()=>N("APPROVE"),disabled:u||r.is_last_step&&r.approval_limit!==null&&r.amount>r.approval_limit,className:"btn btn-primary w-full justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:r.is_last_step?"Final Approve":"Forward to Next Stage"}),r.is_last_step&&r.approval_limit!==null&&r.amount>r.approval_limit&&e.jsxs("p",{className:"text-red-500 text-xs text-center",children:["Amount exceeds your approval limit of"," ",Number(r.approval_limit||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("button",{onClick:()=>N("RETURN"),disabled:u,className:"btn btn-warning w-full justify-center",children:"Return for Revision"}),e.jsx("button",{onClick:()=>N("REJECT"),disabled:u,className:"btn btn-danger w-full justify-center",children:"Reject"}),(function(){const j=String(r.document_type||"").toUpperCase();return(j==="PV"||j==="PAYMENT_VOUCHER"||j==="PAYMENT VOUCHER"||j==="RV"||j==="RECEIPT_VOUCHER"||j==="RECEIPT VOUCHER")&&(c==null?void 0:c.status)==="APPROVED"})()&&e.jsx("button",{onClick:async()=>{var S,k,P,I;const j=window.prompt("Reason for reversal (optional):")||"";try{await te.post(`/finance/vouchers/${r.document_id}/reverse`,{reason:j}),mt.success("Voucher reversed");const B=await te.get(`/finance/vouchers/${r.document_id}`);m(((S=B.data)==null?void 0:S.voucher)||null),f(Array.isArray((k=B.data)==null?void 0:k.lines)?B.data.lines:[])}catch(B){mt.error(((I=(P=B==null?void 0:B.response)==null?void 0:P.data)==null?void 0:I.message)||"Failed to reverse voucher")}},disabled:u,className:"btn btn-outline w-full justify-center",children:"Reverse Voucher"})]})]})})]})]}):e.jsx("div",{className:"p-6",children:"Workflow not found"})}function eL(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState("");v.useEffect(()=>{l()},[]);async function l(){var o,u,d;try{a(!0);const c=await te.get("/admin/exceptional-permissions");s(Array.isArray((o=c.data)==null?void 0:o.items)?c.data.items:[]),i("")}catch(c){i(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load exceptional permissions")}finally{a(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Exceptional Permissions"}),e.jsx("p",{className:"text-sm mt-1",children:"Grant temporary allow/deny permissions to specific users"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/administration/users",className:"btn btn-secondary",children:"Return to Users"}),e.jsx(Ee,{to:"/administration/exceptional-permissions/new",className:"btn-success",children:"+ New Exceptional Permission"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[n&&e.jsx("div",{className:"alert alert-error mb-3",children:e.jsx("span",{children:n})}),r?e.jsx("div",{className:"text-center py-4",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Permission"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Effect"}),e.jsx("th",{children:"Validity"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Approver"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center py-4 text-slate-500",children:"No exceptional permissions found."})}):t.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.username||"Unknown User"}),e.jsx("td",{children:o.permission_code}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-neutral",children:o.exception_type||"TEMPORARY"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${o.effect==="ALLOW"?"badge-success":"badge-error"}`,children:o.effect})}),e.jsxs("td",{className:"text-xs",children:[e.jsxs("div",{children:["From:"," ",o.effective_from?new Date(o.effective_from).toLocaleDateString():"N/A"]}),e.jsxs("div",{children:["To:"," ",o.effective_to?new Date(o.effective_to).toLocaleDateString():"N/A"]})]}),e.jsx("td",{className:"max-w-xs truncate",title:o.reason,children:o.reason}),e.jsx("td",{className:"text-sm",children:o.approver_name||"System"}),e.jsx("td",{children:o.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Ee,{to:`/administration/exceptional-permissions/${o.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},o.id))})]})})]})})]})}function ow(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState([]);v.useEffect(()=>{d()},[]);async function d(){var b;try{const y=await te.get("/admin/users"),N=y.data&&y.data.data&&y.data.data.items||((b=y.data)==null?void 0:b.items)||[];u(N)}catch(y){console.error("Failed to fetch users",y)}}const[c,m]=v.useState({username:"",permissionCode:"",effect:"ALLOW",reason:"",is_active:!0,effective_from:"",effective_to:"",exception_type:"TEMPORARY"}),h=["Clearing Bill Cancellation","Direct Purchase Cancellation","Discount in Sales Invoice","Discount in Sales Order","Discount in Sales Quotation","GRN Cancellation","Price Editable in Sales Invoice","Price Editable in Sales Order","Price Editable in Sales Quotation","Import Bill cancellation","Leave Requet Approval -Stage","Local Bill cancellation","POS DELIVERY CANCEL","POS DISCOUNT","Sales Invoice cancellation"];v.useEffect(()=>{r&&f()},[s]);async function f(){var b,y,N;try{n(!0),l("");const j=await te.get(`/admin/exceptional-permissions/${s}`);if((b=j.data)!=null&&b.item){const S=j.data.item;S.effective_from&&(S.effective_from=S.effective_from.split("T")[0]),S.effective_to&&(S.effective_to=S.effective_to.split("T")[0]),!S.username&&S.user_name&&(S.username=S.user_name),!S.permissionCode&&S.permission_code&&(S.permissionCode=S.permission_code),m(S)}}catch(j){l(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Error fetching permission")}finally{n(!1)}}function x(b,y){m(N=>({...N,[b]:y}))}async function g(b){var y,N;b.preventDefault(),n(!0),l("");try{r?await te.put(`/admin/exceptional-permissions/${s}`,c):await te.post("/admin/exceptional-permissions",c),t("/administration/users")}catch(j){l(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Error saving permission")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration/exceptional-permissions",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Exceptional Permissions"}),e.jsx(Ee,{to:"/administration/users",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block ml-4",children:" Back to Users"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Exceptional Permission":"New Exceptional Permission"}),e.jsx("p",{className:"text-sm mt-1",children:"Temporary user-specific overrides"})]}),e.jsx("form",{onSubmit:g,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username *"}),e.jsxs("select",{className:"input",value:c.username,onChange:b=>x("username",b.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select User --"}),o.map(b=>e.jsx("option",{value:b.username,children:b.username},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Permission *"}),e.jsxs("select",{className:"input",value:c.permissionCode,onChange:b=>x("permissionCode",b.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Permission --"}),h.map(b=>e.jsx("option",{value:b,children:b},b))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effect"}),e.jsxs("select",{className:"input",value:c.effect,onChange:b=>x("effect",b.target.value),children:[e.jsx("option",{value:"ALLOW",children:"Allow"}),e.jsx("option",{value:"DENY",children:"Deny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exception Type"}),e.jsxs("select",{className:"input",value:c.exception_type,onChange:b=>x("exception_type",b.target.value),children:[e.jsx("option",{value:"TEMPORARY",children:"Temporary"}),e.jsx("option",{value:"PERMANENT",children:"Permanent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective From"}),e.jsx("input",{type:"date",className:"input",value:c.effective_from,onChange:b=>x("effective_from",b.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective To"}),e.jsx("input",{type:"date",className:"input",value:c.effective_to,onChange:b=>x("effective_to",b.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Reason"}),e.jsx("input",{className:"input",value:c.reason,onChange:b=>x("reason",b.target.value),placeholder:"Reason for this exception"})]}),e.jsxs("div",{className:"flex items-center mt-8",children:[e.jsx("input",{type:"checkbox",id:"is_active",className:"w-5 h-5 text-brand rounded focus:ring-brand-500 border-gray-300",checked:c.is_active,onChange:b=>x("is_active",b.target.checked)}),e.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-slate-900 dark:text-white",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/administration/exceptional-permissions",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update":"Create"})]})]})})})]})}function tL(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(null);v.useEffect(()=>{l()},[]);const l=async()=>{try{a(!0);const o=await te.get("/admin/companies");s(o.data.items||[])}catch(o){i(o.message||"Failed to fetch companies")}finally{a(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Company Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage companies"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/administration/companies/new",className:"btn-success",children:"+ New Company"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:r?e.jsx("div",{className:"text-center py-4",children:"Loading..."}):n?e.jsx("div",{className:"text-red-500 py-4",children:n}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colspan:"4",className:"text-center py-4 text-gray-500",children:"No companies found"})}):t.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.code}),e.jsx("td",{children:o.name}),e.jsx("td",{children:o.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Ee,{to:`/administration/companies/${o.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},o.id))})]})})})})]})}function cw(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({code:"",name:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",telephone:"",email:"",website:"",tax_id:"",registration_no:"",fiscal_year_start_month:1,timezone:"",currency_id:""}),[d,c]=v.useState([]),[m,h]=v.useState(null),[f,x]=v.useState(""),[g,b]=v.useState(!1),[y,N]=v.useState("");v.useEffect(()=>{S(),r&&j()},[s]),v.useEffect(()=>()=>{f&&URL.revokeObjectURL(f)},[f]);async function j(){var q,Q,O;try{n(!0),l("");const T=await te.get(`/admin/companies/${s}`);if((q=T.data)!=null&&q.item){const V=T.data.item;u({code:V.code||"",name:V.name||"",isActive:V.is_active===1||V.is_active===!0,address:V.address||"",city:V.city||"",state:V.state||"",postal_code:V.postal_code||"",country:V.country||"",telephone:V.telephone||"",email:V.email||"",website:V.website||"",tax_id:V.tax_id||"",registration_no:V.registration_no||"",fiscal_year_start_month:V.fiscal_year_start_month||1,timezone:V.timezone||"",currency_id:V.currency_id||""});try{const D=await te.get(`/admin/companies/${s}/logo`,{responseType:"blob"}),Y=URL.createObjectURL(D.data);x(Y)}catch{}}}catch(T){l(((O=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:O.message)||"Error fetching company")}finally{n(!1)}}async function S(){var q;try{const Q=await te.get("/finance/currencies"),O=Array.isArray((q=Q.data)==null?void 0:q.items)?Q.data.items:[];c(O)}catch{}}function k(q){var T;const Q=(T=q.target.files)==null?void 0:T[0];if(N(""),!Q)return;if(!String(Q.type).startsWith("image/")){N("Only image files are allowed");return}if(Q.size>2*1024*1024){N("Image size must be less than 2MB");return}h(Q);const O=URL.createObjectURL(Q);x(O)}async function P(){var q,Q;if(!r){N("Save company first before uploading logo");return}if(!m){N("Choose an image file to upload");return}b(!0),N("");try{const O=new FormData;O.append("logo",m),await te.post(`/admin/companies/${s}/logo`,O,{headers:{"Content-Type":"multipart/form-data"}})}catch(O){N(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to upload logo")}finally{b(!1)}}function I(q,Q){u(O=>({...O,[q]:Q}))}async function B(q){var Q,O,T;q.preventDefault(),n(!0),l("");try{const V={name:o.name,code:o.code,is_active:o.isActive?1:0,address:o.address||void 0,city:o.city||void 0,state:o.state||void 0,postal_code:o.postal_code||void 0,country:o.country||void 0,telephone:o.telephone||void 0,email:o.email||void 0,website:o.website||void 0,tax_id:o.tax_id||void 0,registration_no:o.registration_no||void 0,fiscal_year_start_month:o.fiscal_year_start_month!==void 0&&o.fiscal_year_start_month!==null?Number(o.fiscal_year_start_month):void 0,timezone:o.timezone||void 0,currency_id:o.currency_id!==""&&o.currency_id!==null?Number(o.currency_id):void 0};if(r)await te.put(`/admin/companies/${s}`,V);else{const Y=(Q=(await te.post("/admin/companies",V)).data)==null?void 0:Q.id;Y&&await te.put(`/admin/companies/${Y}`,V)}t("/administration/companies")}catch(V){l(((T=(O=V==null?void 0:V.response)==null?void 0:O.data)==null?void 0:T.message)||"Error saving company")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration/companies",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Companies"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Company":"New Company"}),e.jsx("p",{className:"text-sm mt-1",children:"Company profile"})]}),e.jsx("form",{onSubmit:B,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:o.code,onChange:q=>I("code",q.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:o.name,onChange:q=>I("name",q.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.isActive?"1":"0",onChange:q=>I("isActive",q.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("input",{className:"input",value:o.address,onChange:q=>I("address",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:o.city,onChange:q=>I("city",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:o.state,onChange:q=>I("state",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Postal Code"}),e.jsx("input",{className:"input",value:o.postal_code,onChange:q=>I("postal_code",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input",value:o.country,onChange:q=>I("country",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Telephone"}),e.jsx("input",{className:"input",value:o.telephone,onChange:q=>I("telephone",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:o.email,onChange:q=>I("email",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Website"}),e.jsx("input",{className:"input",value:o.website,onChange:q=>I("website",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax ID"}),e.jsx("input",{className:"input",value:o.tax_id,onChange:q=>I("tax_id",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Registration No."}),e.jsx("input",{className:"input",value:o.registration_no,onChange:q=>I("registration_no",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year Start Month"}),e.jsx("input",{className:"input",type:"number",min:"1",max:"12",value:o.fiscal_year_start_month,onChange:q=>I("fiscal_year_start_month",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Timezone"}),e.jsx("input",{className:"input",value:o.timezone,onChange:q=>I("timezone",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:o.currency_id,onChange:q=>I("currency_id",q.target.value),children:[e.jsx("option",{value:"",children:"Select Currency"}),d.map(q=>e.jsx("option",{value:q.id,children:(q.code||q.currency_code)+" - "+(q.name||q.currency_name)},q.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Company Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 border border-gray-200 rounded-lg flex items-center justify-center bg-white dark:bg-slate-800",children:f?e.jsx("img",{src:f,alt:"Logo Preview",className:"w-full h-full object-contain"}):e.jsx("span",{className:"text-sm text-slate-500",children:"No logo"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"input"}),e.jsx("div",{className:"mt-2",children:m&&e.jsx("button",{type:"button",onClick:P,className:"btn-success",disabled:g,children:g?"Uploading...":"Upload Logo"})}),y&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:y})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/administration/companies",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update":"Create"})]})]})})})]})}function sL({branches:t,companies:s,onUpdate:r}){const[a,n]=v.useState([]),[i,l]=v.useState(!0),[o,u]=v.useState(""),[d,c]=v.useState(!1),[m,h]=v.useState(null),[f,x]=v.useState({companyId:"",branchIds:[]}),[g,b]=v.useState(!1);v.useEffect(()=>{y()},[]);const y=async()=>{try{l(!0);const P=await te.get("/admin/users");n(P.data.items||[])}catch(P){console.error("Failed to fetch users",P)}finally{l(!1)}},N=async P=>{var B;h(P);const I={companyId:P.company_id||"",branchIds:P.branch_id?[String(P.branch_id)]:[]};try{const q=await te.get(`/admin/users/${P.id}/branches`),Q=Array.isArray((B=q.data)==null?void 0:B.items)?q.data.items.map(O=>String(O.id)):[];x({...I,branchIds:Q})}catch{x(I)}c(!0)},j=async P=>{if(P.preventDefault(),!!m){b(!0);try{await te.put(`/admin/users/${m.id}/branches`,{company_id:f.companyId,branch_ids:f.branchIds.map(I=>Number(I))}),await y(),r&&r(),c(!1),h(null)}catch(I){alert("Failed to update user branch: "+I.message)}finally{b(!1)}}},S=f.companyId?t.filter(P=>String(P.company_id)===String(f.companyId)):[],k=a.filter(P=>{const I=o.toLowerCase();return P.username.toLowerCase().includes(I)||P.email.toLowerCase().includes(I)||P.full_name&&P.full_name.toLowerCase().includes(I)});return e.jsxs("div",{children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",className:"search-input",placeholder:" Search users...",value:o,onChange:P=>u(P.target.value)}),e.jsx("button",{className:"btn btn-secondary",onClick:y,children:" Refresh Users"})]}),e.jsx("div",{className:"table-container",children:i?e.jsx("div",{className:"p-8 text-center",children:"Loading users..."}):e.jsxs("table",{className:"branch-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Current Company"}),e.jsx("th",{children:"Current Branch"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-4",children:"No users found"})}):k.map(P=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:P.username}),e.jsx("div",{className:"text-sm text-gray-500",children:P.email})]}),e.jsx("td",{children:P.company_name||"Unassigned"}),e.jsx("td",{children:P.branch_name||"Unassigned"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>N(P),children:"Assign Branch"})})]},P.id))})]})}),d&&e.jsx("div",{className:"branch-modal-overlay",children:e.jsxs("div",{className:"branch-modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"branch-modal-header",children:[e.jsxs("h2",{children:["Assign Branch to ",m==null?void 0:m.username]}),e.jsx("button",{className:"branch-close-btn",onClick:()=>c(!1),children:""})]}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"branch-modal-body",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Company"}),e.jsxs("select",{className:"search-input w-full",value:f.companyId,onChange:P=>x({...f,companyId:P.target.value,branchId:""}),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Company --"}),s.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Branches"}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-auto border rounded-md p-2",children:[S.map(P=>{const I=f.branchIds.includes(String(P.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:I,onChange:B=>{const q=B.target.checked;x(Q=>{const O=new Set(Q.branchIds);return q?O.add(String(P.id)):O.delete(String(P.id)),{...Q,branchIds:Array.from(O)}})},disabled:!f.companyId}),e.jsx("span",{className:"text-sm",children:P.name})]},P.id)}),f.companyId?null:e.jsx("div",{className:"text-xs text-gray-500",children:"Select a company to view branches"})]})]})]}),e.jsxs("div",{className:"branch-modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-success",disabled:g,children:g?"Saving...":"Save Assignment"})]})]})]})})]})}function rL(){const[t,s]=v.useState("branches"),[r,a]=v.useState([]),[n,i]=v.useState([]),[l,o]=v.useState(!0),[u,d]=v.useState(null),[c,m]=v.useState(!1),[h,f]=v.useState(null),[x,g]=v.useState(!1),[b,y]=v.useState(""),[N,j]=v.useState({companyId:"",name:"",code:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",location:"",telephone:"",email:"",remarks:""}),S={totalBranches:r.length,activeBranches:r.filter(Q=>Q.is_active).length,assignments:0};v.useEffect(()=>{k()},[]);const k=async()=>{try{o(!0);const[Q,O]=await Promise.all([te.get("/admin/branches"),te.get("/admin/companies")]);a(Q.data.items||[]),i(O.data.items||[])}catch(Q){d(Q.message||"Failed to fetch data")}finally{o(!1)}},P=async()=>{try{const Q=await te.get("/admin/branches");a(Q.data.items||[])}catch(Q){console.error("Failed to refresh branches",Q)}},I=(Q=null)=>{f(Q),j(Q?{companyId:Q.company_id,name:Q.name,code:Q.code,isActive:Q.is_active,address:Q.address||"",city:Q.city||"",state:Q.state||"",postal_code:Q.postal_code||"",country:Q.country||"",location:Q.location||"",telephone:Q.telephone||"",email:Q.email||"",remarks:Q.remarks||""}:{companyId:"",name:"",code:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",location:"",telephone:"",email:"",remarks:""}),y(""),m(!0)},B=()=>{m(!1),f(null),y("")},q=async Q=>{var O,T;Q.preventDefault(),g(!0),y("");try{h?await te.put(`/admin/branches/${h.id}`,{company_id:N.companyId,name:N.name,code:N.code,is_active:N.isActive,address:N.address||null,city:N.city||null,state:N.state||null,postal_code:N.postal_code||null,country:N.country||null,location:N.location||null,telephone:N.telephone||null,email:N.email||null,remarks:N.remarks||null}):await te.post("/admin/branches",{company_id:N.companyId,name:N.name,code:N.code,is_active:N.isActive,address:N.address||null,city:N.city||null,state:N.state||null,postal_code:N.postal_code||null,country:N.country||null,location:N.location||null,telephone:N.telephone||null,email:N.email||null,remarks:N.remarks||null}),await P(),B()}catch(V){y(((T=(O=V==null?void 0:V.response)==null?void 0:O.data)==null?void 0:T.message)||V.message||"Failed to save branch")}finally{g(!1)}};return e.jsxs("div",{className:"branch-setup-container",children:[e.jsxs("div",{className:"branch-header",children:[e.jsx("div",{children:e.jsx("h1",{children:" Branch Management System"})}),e.jsxs("div",{className:"header-actions",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:" Refresh"})]})]}),e.jsxs("div",{className:"branch-content",children:[e.jsxs("div",{className:"branch-stats",children:[e.jsxs("div",{className:"branch-stat-card",children:[e.jsx("h3",{children:"Total Branches"}),e.jsx("div",{className:"value",children:S.totalBranches})]}),e.jsxs("div",{className:"branch-stat-card",children:[e.jsx("h3",{children:"Active Branches"}),e.jsx("div",{className:"value",children:S.activeBranches})]}),e.jsxs("div",{className:"branch-stat-card",children:[e.jsx("h3",{children:"Assignments"}),e.jsx("div",{className:"value",children:S.assignments})]})]}),e.jsxs("div",{className:"branch-tabs",children:[e.jsx("button",{className:`branch-tab ${t==="users"?"active":""}`,onClick:()=>s("users"),children:" User Branch Assignment"}),e.jsx("button",{className:`branch-tab ${t==="branches"?"active":""}`,onClick:()=>s("branches"),children:" Branch Management"}),e.jsx("button",{className:`branch-tab ${t==="history"?"active":""}`,onClick:()=>s("history"),children:" Assignment History"})]}),e.jsxs("div",{className:`tab-content ${t==="branches"?"active":""}`,children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",className:"search-input",placeholder:" Search branches..."}),e.jsx("button",{className:"btn btn-success",onClick:()=>I(null),children:" Add New Branch"})]}),e.jsx("div",{className:"table-container",children:l?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):u?e.jsx("div",{className:"p-8 text-center text-red-500",children:u}):e.jsxs("table",{className:"branch-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-4 text-gray-500",children:"No branches found"})}):r.map(Q=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:Q.code}),e.jsx("td",{children:Q.name}),e.jsx("td",{children:Q.company_name||"N/A"}),e.jsx("td",{children:Q.is_active?e.jsx("span",{className:"branch-badge branch-badge-success",children:"Active"}):e.jsx("span",{className:"branch-badge branch-badge-danger",children:"Inactive"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>I(Q),children:"Edit"})})]},Q.id))})]})})]}),e.jsx("div",{className:`tab-content ${t==="users"?"active":""}`,children:e.jsx(sL,{branches:r,companies:n,onUpdate:k})}),e.jsx("div",{className:`tab-content ${t==="history"?"active":""}`,children:e.jsx("div",{className:"p-8 text-center text-gray-500",children:e.jsx("p",{children:"History log coming soon."})})})]}),c&&e.jsx("div",{className:"branch-modal-overlay",children:e.jsxs("div",{className:"branch-modal",children:[e.jsxs("div",{className:"branch-modal-header",children:[e.jsx("h2",{children:h?"Edit Branch":"New Branch"}),e.jsx("button",{className:"branch-close-btn",onClick:B,children:""})]}),e.jsxs("form",{onSubmit:q,children:[e.jsxs("div",{className:"branch-modal-body",children:[b&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:b}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Company *"}),e.jsxs("select",{className:"search-input w-full",value:N.companyId,onChange:Q=>j({...N,companyId:Q.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Company --"}),n.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.name," (",Q.code,")"]},Q.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Code *"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.code,onChange:Q=>j({...N,code:Q.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Name *"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.name,onChange:Q=>j({...N,name:Q.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Status"}),e.jsxs("select",{className:"search-input w-full",value:N.isActive?"1":"0",onChange:Q=>j({...N,isActive:Q.target.value==="1"}),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Address"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.address,onChange:Q=>j({...N,address:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Location"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.location,onChange:Q=>j({...N,location:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"City"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.city,onChange:Q=>j({...N,city:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"State"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.state,onChange:Q=>j({...N,state:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Postal Code"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.postal_code,onChange:Q=>j({...N,postal_code:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Country"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.country,onChange:Q=>j({...N,country:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Telephone"}),e.jsx("input",{type:"text",className:"search-input w-full",value:N.telephone,onChange:Q=>j({...N,telephone:Q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{type:"email",className:"search-input w-full",value:N.email,onChange:Q=>j({...N,email:Q.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Remarks"}),e.jsx("textarea",{className:"search-input w-full",rows:"3",value:N.remarks,onChange:Q=>j({...N,remarks:Q.target.value})})]})]})]}),e.jsxs("div",{className:"branch-modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:B,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-success",disabled:x,children:x?"Saving...":"Save Branch"})]})]})]})})]})}function dw(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({company_id:1,code:"",name:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",location:"",telephone:"",email:"",remarks:""});v.useEffect(()=>{r&&d()},[s]);async function d(){var h,f,x;try{n(!0),l("");const g=await te.get(`/admin/branches/${s}`);if((h=g.data)!=null&&h.item){const b=g.data.item;u({company_id:b.company_id,code:b.code,name:b.name,isActive:b.is_active,address:b.address||"",city:b.city||"",state:b.state||"",postal_code:b.postal_code||"",country:b.country||"",location:b.location||"",telephone:b.telephone||"",email:b.email||"",remarks:b.remarks||""})}}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error fetching branch")}finally{n(!1)}}function c(h,f){u(x=>({...x,[h]:f}))}async function m(h){var f,x;h.preventDefault(),n(!0),l("");try{const g={company_id:o.company_id,name:o.name,code:o.code,is_active:o.isActive,address:o.address||null,city:o.city||null,state:o.state||null,postal_code:o.postal_code||null,country:o.country||null,location:o.location||null,telephone:o.telephone||null,email:o.email||null,remarks:o.remarks||null};r?await te.put(`/admin/branches/${s}`,g):await te.post("/admin/branches",g),t("/administration/branches")}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error saving branch")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6 [&::-webkit-scrollbar]:hidden",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration/branches",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Branches"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Branch":"New Branch"}),e.jsx("p",{className:"text-sm mt-1",children:"Branch profile"})]}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company ID"}),e.jsx("input",{className:"input",type:"number",value:o.company_id,onChange:h=>c("company_id",parseInt(h.target.value)||1),disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:o.code,onChange:h=>c("code",h.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:o.name,onChange:h=>c("name",h.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.isActive?"1":"0",onChange:h=>c("isActive",h.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("input",{className:"input",value:o.address,onChange:h=>c("address",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("input",{className:"input",value:o.location,onChange:h=>c("location",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:o.city,onChange:h=>c("city",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:o.state,onChange:h=>c("state",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Postal Code"}),e.jsx("input",{className:"input",value:o.postal_code,onChange:h=>c("postal_code",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input",value:o.country,onChange:h=>c("country",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Telephone"}),e.jsx("input",{className:"input",value:o.telephone,onChange:h=>c("telephone",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:o.email,onChange:h=>c("email",h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:o.remarks,onChange:h=>c("remarks",h.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/administration/branches",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update":"Create"})]})]})})})]})}function aL(){const t=[{title:"User Login Activity",description:"Recent logins per user (placeholder)"},{title:"Permission Changes",description:"Audit report of permission updates (placeholder)"},{title:"Workflow Queue",description:"Documents pending approvals (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Administration"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Administration Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"System monitoring and audit reporting"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function nL(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/admin/reports/system-log-book",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"System Log Book"}),e.jsx("p",{className:"text-sm mt-1",children:"Application events and user activity across modules"})]}),e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Module"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Message"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.event_time?new Date(d.event_time).toLocaleString():"-"}),e.jsx("td",{children:d.user_name||"-"}),e.jsx("td",{children:d.module_name||"-"}),e.jsx("td",{children:d.action||"-"}),e.jsx("td",{className:"font-medium",children:d.ref_no||"-"}),e.jsx("td",{children:d.message||"-"})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function iL(){const t=Ns(),[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,u]=v.useState("");v.useEffect(()=>{d()},[]);async function d(){var m,h,f;try{n(!0),l("");const x=await te.get("/admin/user-assignments"),g=x.data&&x.data.data&&x.data.data.items||((m=x.data)==null?void 0:m.items)||[];r(g)}catch(x){l(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load assignments")}finally{n(!1)}}const c=s.filter(m=>{const h=o.trim().toLowerCase();return h?String(m.username||"").toLowerCase().includes(h)||String(m.email||"").toLowerCase().includes(h)||String(m.role_name||"").toLowerCase().includes(h):!0});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"User Permissions"}),e.jsx("p",{className:"text-sm mt-1",children:"Review users with customized page-level permissions and manage assignments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>t("/administration/user-permissions"),children:"Assign Rights"})]})]}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("input",{type:"text",placeholder:"Search by user, email, role...",className:"input max-w-md",value:o,onChange:m=>u(m.target.value)}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"btn btn-outline",onClick:d,children:"Refresh"})})]}),a?e.jsx("div",{className:"py-12 text-center",children:e.jsx("div",{className:"loading loading-spinner loading-lg"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Customized Pages"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[c.map(m=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:m.username}),e.jsx("td",{children:m.email}),e.jsx("td",{children:m.role_name?e.jsx("span",{className:"badge",children:m.role_name}):e.jsx("span",{className:"text-xs text-slate-500",children:"None"})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:Number(m.custom_count||0)})}),e.jsx("td",{children:e.jsx("button",{onClick:()=>t("/administration/user-permissions",{state:{selectedUser:m.id}}),className:"btn btn-sm btn-ghost text-brand hover:bg-brand/10",children:"Edit Permissions"})})]},m.id)),c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-10",children:e.jsx("div",{className:"text-slate-500",children:"No permission assignments found."})})})]})]})})]})})]})}function lL(){var I;const t=Ba(),[s,r]=v.useState([]),[a,n]=v.useState(((I=t.state)==null?void 0:I.selectedUser)||""),[i,l]=v.useState(null),[o,u]=v.useState([]),[d,c]=v.useState({}),[m,h]=v.useState(!1),[f,x]=v.useState(!1),[g,b]=v.useState({type:"",text:""});v.useEffect(()=>{y()},[]),v.useEffect(()=>{a?N(a):(l(null),u([]),c({}))},[a]);async function y(){var B;try{const q=await te.get("/admin/users"),Q=q.data&&q.data.data&&q.data.data.items||((B=q.data)==null?void 0:B.items)||[];r(Q)}catch(q){console.error(q);try{await te.post("/admin/error-logs",{module:"Administration",action:"FetchUsersForPermissions",error_code:(q==null?void 0:q.code)||null,message:(q==null?void 0:q.message)||"Failed to load users",details:{path:"/admin/users"}})}catch{}}}async function N(B){var q,Q,O;h(!0),l(null),u([]),c({}),b({type:"",text:""});try{const T=await te.get(`/admin/users/${B}/permissions-context`),V=T.data&&T.data.data&&T.data.data.role||((q=T.data)==null?void 0:q.role),D=T.data&&T.data.data&&T.data.data.pages||((Q=T.data)==null?void 0:Q.pages)||[];l(V||null),u(D);const Y={};(T.data&&T.data.data&&T.data.data.permissions||((O=T.data)==null?void 0:O.permissions)||[]).forEach(X=>{Y[X.page_id]={canView:!!X.can_view,canCreate:!!X.can_create,canEdit:!!X.can_edit,canDelete:!!X.can_delete}}),c(Y)}catch(T){console.error(T),b({type:"error",text:"Error loading permissions context"});try{await te.post("/admin/error-logs",{module:"Administration",action:"FetchUserPermissionsContext",error_code:(T==null?void 0:T.code)||null,message:(T==null?void 0:T.message)||"Failed to load permissions context",details:{userId:B}})}catch{}}finally{h(!1)}}const j=(B,q)=>{c(Q=>{const O=Q[B]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1};return{...Q,[B]:{...O,[q]:!O[q]}}})},S=async()=>{if(a){x(!0),b({type:"",text:""});try{const B=Object.entries(d).map(([q,Q])=>({page_id:Number(q),can_view:Q.canView,can_create:Q.canCreate,can_edit:Q.canEdit,can_delete:Q.canDelete}));await te.post(`/admin/users/${a}/permissions`,{permissions:B}),b({type:"success",text:"Permissions saved successfully!"})}catch(B){console.error(B),b({type:"error",text:"Error saving permissions."});try{await te.post("/admin/error-logs",{module:"Administration",action:"SaveUserPermissions",error_code:(B==null?void 0:B.code)||null,message:(B==null?void 0:B.message)||"Failed to save permissions",details:{userId:a,payloadSize:payload.length}})}catch{}}finally{x(!1)}}},k=o.reduce((B,q)=>(B[q.module]||(B[q.module]=[]),B[q.module].push(q),B),{}),P=(B,q)=>{c(Q=>({...Q,[B]:{canView:q,canCreate:q,canEdit:q,canDelete:q}}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/administration/permissions",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Permissions"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"User Permission Assignment"}),e.jsx("p",{className:"text-sm mt-1",children:"Select a user to configure their specific access rights based on their assigned role."})]}),a&&o.length>0&&e.jsx("button",{onClick:S,disabled:f,className:"btn btn-primary",children:f?"Saving...":"Save Changes"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Select User"}),e.jsxs("select",{className:"input",value:a,onChange:B=>n(B.target.value),children:[e.jsx("option",{value:"",children:"-- Select User --"}),s.map(B=>e.jsxs("option",{value:B.id,children:[B.username," (",B.email,")"]},B.id))]})]}),a&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assigned Role"}),e.jsx("div",{className:"p-2 border rounded bg-slate-50 dark:bg-slate-800",children:i?e.jsx("span",{className:"font-semibold text-brand",children:i.name}):e.jsx("span",{className:"text-slate-400 italic",children:"No Role Assigned"})}),i&&e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Role defines which pages are visible. Configure CRUD rights below."})]})]})})}),g.text&&e.jsx("div",{className:`alert ${g.type==="success"?"alert-success":"alert-error"}`,children:g.text}),m&&e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"loading loading-spinner loading-lg"})}),!m&&a&&o.length===0&&e.jsx("div",{className:"card bg-base-200",children:e.jsx("div",{className:"card-body text-center text-slate-500",children:i?"This role has no pages assigned.":"Assign a role to this user first to configure permissions."})}),!m&&a&&o.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Permissions"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"space-y-8",children:Object.entries(k).map(([B,q])=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100",children:B}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 dark:bg-slate-800/50 text-left",children:[e.jsx("th",{className:"p-3 w-1/3",children:"Page"}),e.jsx("th",{className:"p-3 text-center w-24",children:"View"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Create"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Edit"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Delete"}),e.jsx("th",{className:"p-3 text-center w-24",children:"All"})]})}),e.jsx("tbody",{children:q.map(Q=>{const O=d[Q.id]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1},T=O.canView&&O.canCreate&&O.canEdit&&O.canDelete;return e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium",children:Q.name}),e.jsx("div",{className:"text-xs text-slate-500",children:Q.code})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:O.canView,onChange:()=>j(Q.id,"canView")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:O.canCreate,onChange:()=>j(Q.id,"canCreate")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:O.canEdit,onChange:()=>j(Q.id,"canEdit")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:O.canDelete,onChange:()=>j(Q.id,"canDelete")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:T,onChange:V=>P(Q.id,V.target.checked)})})]},Q.id)})})]})})]},B))})}),e.jsx("div",{className:"card-footer bg-slate-50 dark:bg-slate-800 p-4 rounded-b-lg flex justify-end",children:e.jsx("button",{onClick:S,disabled:f,className:"btn btn-primary",children:f?"Saving...":"Save Changes"})})]})]})}const oL="modulepreload",cL=function(t){return"/"+t},uw={},Gx=function(s,r,a){let n=Promise.resolve();if(r&&r.length>0){let l=function(d){return Promise.all(d.map(c=>Promise.resolve(c).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=l(r.map(d=>{if(d=cL(d),d in uw)return;uw[d]=!0;const c=d.endsWith(".css"),m=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":oL,c||(h.as="script"),h.crossOrigin="",h.href=d,u&&h.setAttribute("nonce",u),document.head.appendChild(h),c)return new Promise((f,x)=>{h.addEventListener("load",f),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return n.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return s().catch(i)})};function Gr(t){"@babel/helpers - typeof";return Gr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Gr(t)}var pi=Uint8Array,jl=Uint16Array,Xy=Int32Array,q0=new pi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),V0=new pi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ub=new pi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),GC=function(t,s){for(var r=new jl(31),a=0;a<31;++a)r[a]=s+=1<<t[a-1];for(var n=new Xy(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)n[i]=i-r[a]<<5|a;return{b:r,r:n}},KC=GC(q0,2),zC=KC.b,Rb=KC.r;zC[28]=258,Rb[258]=28;var YC=GC(V0,0),dL=YC.b,Aw=YC.r,Ob=new jl(32768);for(var ua=0;ua<32768;++ua){var Vd=(ua&43690)>>1|(ua&21845)<<1;Vd=(Vd&52428)>>2|(Vd&13107)<<2,Vd=(Vd&61680)>>4|(Vd&3855)<<4,Ob[ua]=((Vd&65280)>>8|(Vd&255)<<8)>>1}var oc=(function(t,s,r){for(var a=t.length,n=0,i=new jl(s);n<a;++n)t[n]&&++i[t[n]-1];var l=new jl(s);for(n=1;n<s;++n)l[n]=l[n-1]+i[n-1]<<1;var o;if(r){o=new jl(1<<s);var u=15-s;for(n=0;n<a;++n)if(t[n])for(var d=n<<4|t[n],c=s-t[n],m=l[t[n]-1]++<<c,h=m|(1<<c)-1;m<=h;++m)o[Ob[m]>>u]=d}else for(o=new jl(a),n=0;n<a;++n)t[n]&&(o[n]=Ob[l[t[n]-1]++]>>15-t[n]);return o}),du=new pi(288);for(var ua=0;ua<144;++ua)du[ua]=8;for(var ua=144;ua<256;++ua)du[ua]=9;for(var ua=256;ua<280;++ua)du[ua]=7;for(var ua=280;ua<288;++ua)du[ua]=8;var cf=new pi(32);for(var ua=0;ua<32;++ua)cf[ua]=5;var uL=oc(du,9,0),AL=oc(du,9,1),hL=oc(cf,5,0),mL=oc(cf,5,1),vv=function(t){for(var s=t[0],r=1;r<t.length;++r)t[r]>s&&(s=t[r]);return s},bo=function(t,s,r){var a=s/8|0;return(t[a]|t[a+1]<<8)>>(s&7)&r},bv=function(t,s){var r=s/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(s&7)},Jy=function(t){return(t+7)/8|0},XC=function(t,s,r){return(r==null||r>t.length)&&(r=t.length),new pi(t.subarray(s,r))},fL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wo=function(t,s,r){var a=new Error(s||fL[t]);if(a.code=t,Error.captureStackTrace&&Error.captureStackTrace(a,wo),!r)throw a;return a},pL=function(t,s,r,a){var n=t.length,i=0;if(!n||s.f&&!s.l)return r||new pi(0);var l=!r,o=l||s.i!=2,u=s.i;l&&(r=new pi(n*3));var d=function(ee){var se=r.length;if(ee>se){var Ae=new pi(Math.max(se*2,ee));Ae.set(r),r=Ae}},c=s.f||0,m=s.p||0,h=s.b||0,f=s.l,x=s.d,g=s.m,b=s.n,y=n*8;do{if(!f){c=bo(t,m,1);var N=bo(t,m+1,3);if(m+=3,N)if(N==1)f=AL,x=mL,g=9,b=5;else if(N==2){var P=bo(t,m,31)+257,I=bo(t,m+10,15)+4,B=P+bo(t,m+5,31)+1;m+=14;for(var q=new pi(B),Q=new pi(19),O=0;O<I;++O)Q[Ub[O]]=bo(t,m+O*3,7);m+=I*3;for(var T=vv(Q),V=(1<<T)-1,D=oc(Q,T,1),O=0;O<B;){var Y=D[bo(t,m,V)];m+=Y&15;var j=Y>>4;if(j<16)q[O++]=j;else{var M=0,X=0;for(j==16?(X=3+bo(t,m,3),m+=2,M=q[O-1]):j==17?(X=3+bo(t,m,7),m+=3):j==18&&(X=11+bo(t,m,127),m+=7);X--;)q[O++]=M}}var R=q.subarray(0,P),H=q.subarray(P);g=vv(R),b=vv(H),f=oc(R,g,1),x=oc(H,b,1)}else wo(1);else{var j=Jy(m)+4,S=t[j-4]|t[j-3]<<8,k=j+S;if(k>n){u&&wo(0);break}o&&d(h+S),r.set(t.subarray(j,k),h),s.b=h+=S,s.p=m=k*8,s.f=c;continue}if(m>y){u&&wo(0);break}}o&&d(h+131072);for(var W=(1<<g)-1,K=(1<<b)-1,_=m;;_=m){var M=f[bv(t,m)&W],F=M>>4;if(m+=M&15,m>y){u&&wo(0);break}if(M||wo(2),F<256)r[h++]=F;else if(F==256){_=m,f=null;break}else{var E=F-254;if(F>264){var O=F-257,L=q0[O];E=bo(t,m,(1<<L)-1)+zC[O],m+=L}var U=x[bv(t,m)&K],J=U>>4;U||wo(3),m+=U&15;var H=dL[J];if(J>3){var L=V0[J];H+=bv(t,m)&(1<<L)-1,m+=L}if(m>y){u&&wo(0);break}o&&d(h+131072);var ae=h+E;if(h<H){var Z=i-H,oe=Math.min(H,ae);for(Z+h<0&&wo(3);h<oe;++h)r[h]=a[Z+h]}for(;h<ae;++h)r[h]=r[h-H]}}s.l=f,s.p=_,s.b=h,s.f=c,f&&(c=1,s.m=g,s.d=x,s.n=b)}while(!c);return h!=r.length&&l?XC(r,0,h):r.subarray(0,h)},Uc=function(t,s,r){r<<=s&7;var a=s/8|0;t[a]|=r,t[a+1]|=r>>8},mm=function(t,s,r){r<<=s&7;var a=s/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},yv=function(t,s){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,i=r.slice();if(!n)return{t:ZC,l:0};if(n==1){var l=new pi(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(k,P){return k.f-P.f}),r.push({s:-1,f:25001});var o=r[0],u=r[1],d=0,c=1,m=2;for(r[0]={s:-1,f:o.f+u.f,l:o,r:u};c!=n-1;)o=r[r[d].f<r[m].f?d++:m++],u=r[d!=c&&r[d].f<r[m].f?d++:m++],r[c++]={s:-1,f:o.f+u.f,l:o,r:u};for(var h=i[0].s,a=1;a<n;++a)i[a].s>h&&(h=i[a].s);var f=new jl(h+1),x=Qb(r[c-1],f,0);if(x>s){var a=0,g=0,b=x-s,y=1<<b;for(i.sort(function(P,I){return f[I.s]-f[P.s]||P.f-I.f});a<n;++a){var N=i[a].s;if(f[N]>s)g+=y-(1<<x-f[N]),f[N]=s;else break}for(g>>=b;g>0;){var j=i[a].s;f[j]<s?g-=1<<s-f[j]++-1:++a}for(;a>=0&&g;--a){var S=i[a].s;f[S]==s&&(--f[S],++g)}x=s}return{t:new pi(f),l:x}},Qb=function(t,s,r){return t.s==-1?Math.max(Qb(t.l,s,r+1),Qb(t.r,s,r+1)):s[t.s]=r},hw=function(t){for(var s=t.length;s&&!t[--s];);for(var r=new jl(++s),a=0,n=t[0],i=1,l=function(u){r[a++]=u},o=1;o<=s;++o)if(t[o]==n&&o!=s)++i;else{if(!n&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(n),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(n);i=1,n=t[o]}return{c:r.subarray(0,a),n:s}},fm=function(t,s){for(var r=0,a=0;a<s.length;++a)r+=t[a]*s[a];return r},JC=function(t,s,r){var a=r.length,n=Jy(s+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var i=0;i<a;++i)t[n+i+4]=r[i];return(n+4+a)*8},mw=function(t,s,r,a,n,i,l,o,u,d,c){Uc(s,c++,r),++n[256];for(var m=yv(n,15),h=m.t,f=m.l,x=yv(i,15),g=x.t,b=x.l,y=hw(h),N=y.c,j=y.n,S=hw(g),k=S.c,P=S.n,I=new jl(19),B=0;B<N.length;++B)++I[N[B]&31];for(var B=0;B<k.length;++B)++I[k[B]&31];for(var q=yv(I,7),Q=q.t,O=q.l,T=19;T>4&&!Q[Ub[T-1]];--T);var V=d+5<<3,D=fm(n,du)+fm(i,cf)+l,Y=fm(n,h)+fm(i,g)+l+14+3*T+fm(I,Q)+2*I[16]+3*I[17]+7*I[18];if(u>=0&&V<=D&&V<=Y)return JC(s,c,t.subarray(u,u+d));var M,X,R,H;if(Uc(s,c,1+(Y<D)),c+=2,Y<D){M=oc(h,f,0),X=h,R=oc(g,b,0),H=g;var W=oc(Q,O,0);Uc(s,c,j-257),Uc(s,c+5,P-1),Uc(s,c+10,T-4),c+=14;for(var B=0;B<T;++B)Uc(s,c+3*B,Q[Ub[B]]);c+=3*T;for(var K=[N,k],_=0;_<2;++_)for(var F=K[_],B=0;B<F.length;++B){var E=F[B]&31;Uc(s,c,W[E]),c+=Q[E],E>15&&(Uc(s,c,F[B]>>5&127),c+=F[B]>>12)}}else M=uL,X=du,R=hL,H=cf;for(var B=0;B<o;++B){var L=a[B];if(L>255){var E=L>>18&31;mm(s,c,M[E+257]),c+=X[E+257],E>7&&(Uc(s,c,L>>23&31),c+=q0[E]);var U=L&31;mm(s,c,R[U]),c+=H[U],U>3&&(mm(s,c,L>>5&8191),c+=V0[U])}else mm(s,c,M[L]),c+=X[L]}return mm(s,c,M[256]),c+X[256]},xL=new Xy([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ZC=new pi(0),gL=function(t,s,r,a,n,i){var l=i.z||t.length,o=new pi(a+l+5*(1+Math.ceil(l/7e3))+n),u=o.subarray(a,o.length-n),d=i.l,c=(i.r||0)&7;if(s){c&&(u[0]=i.r>>3);for(var m=xL[s-1],h=m>>13,f=m&8191,x=(1<<r)-1,g=i.p||new jl(32768),b=i.h||new jl(x+1),y=Math.ceil(r/3),N=2*y,j=function(we){return(t[we]^t[we+1]<<y^t[we+2]<<N)&x},S=new Xy(25e3),k=new jl(288),P=new jl(32),I=0,B=0,q=i.i||0,Q=0,O=i.w||0,T=0;q+2<l;++q){var V=j(q),D=q&32767,Y=b[V];if(g[D]=Y,b[V]=D,O<=q){var M=l-q;if((I>7e3||Q>24576)&&(M>423||!d)){c=mw(t,u,0,S,k,P,B,Q,T,q-T,c),Q=I=B=0,T=q;for(var X=0;X<286;++X)k[X]=0;for(var X=0;X<30;++X)P[X]=0}var R=2,H=0,W=f,K=D-Y&32767;if(M>2&&V==j(q-K))for(var _=Math.min(h,M)-1,F=Math.min(32767,q),E=Math.min(258,M);K<=F&&--W&&D!=Y;){if(t[q+R]==t[q+R-K]){for(var L=0;L<E&&t[q+L]==t[q+L-K];++L);if(L>R){if(R=L,H=K,L>_)break;for(var U=Math.min(K,L-2),J=0,X=0;X<U;++X){var ae=q-K+X&32767,Z=g[ae],oe=ae-Z&32767;oe>J&&(J=oe,Y=ae)}}}D=Y,Y=g[D],K+=D-Y&32767}if(H){S[Q++]=268435456|Rb[R]<<18|Aw[H];var ee=Rb[R]&31,se=Aw[H]&31;B+=q0[ee]+V0[se],++k[257+ee],++P[se],O=q+R,++I}else S[Q++]=t[q],++k[t[q]]}}for(q=Math.max(q,O);q<l;++q)S[Q++]=t[q],++k[t[q]];c=mw(t,u,d,S,k,P,B,Q,T,q-T,c),d||(i.r=c&7|u[c/8|0]<<3,c-=7,i.h=b,i.p=g,i.i=q,i.w=O)}else{for(var q=i.w||0;q<l+d;q+=65535){var Ae=q+65535;Ae>=l&&(u[c/8|0]=d,Ae=l),c=JC(u,c+1,t.subarray(q,Ae))}i.i=l}return XC(o,0,a+Jy(c)+n)},e5=function(){var t=1,s=0;return{p:function(r){for(var a=t,n=s,i=r.length|0,l=0;l!=i;){for(var o=Math.min(l+2655,i);l<o;++l)n+=a+=r[l];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,s=n},d:function(){return t%=65521,s%=65521,(t&255)<<24|(t&65280)<<8|(s&255)<<8|s>>8}}},vL=function(t,s,r,a,n){if(!n&&(n={l:1},s.dictionary)){var i=s.dictionary.subarray(-32768),l=new pi(i.length+t.length);l.set(i),l.set(t,i.length),t=l,n.w=i.length}return gL(t,s.level==null?6:s.level,s.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+s.mem,r,a,n)},t5=function(t,s,r){for(;r;++s)t[s]=r,r>>>=8},bL=function(t,s){var r=s.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(s.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,s.dictionary){var n=e5();n.p(s.dictionary),t5(t,2,n.d())}},yL=function(t,s){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&wo(6,"invalid zlib data"),(t[1]>>5&1)==1&&wo(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Mb(t,s){s||(s={});var r=e5();r.p(t);var a=vL(t,s,s.dictionary?6:2,4);return bL(a,s),t5(a,a.length-4,r.d()),a}function jL(t,s){return pL(t.subarray(yL(t),-4),{i:2},s,s)}var NL=typeof TextDecoder<"u"&&new TextDecoder,wL=0;try{NL.decode(ZC,{stream:!0}),wL=1}catch{}var zs=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function jv(){zs.console&&typeof zs.console.log=="function"&&zs.console.log.apply(zs.console,arguments)}var ta={log:jv,warn:function(t){zs.console&&(typeof zs.console.warn=="function"?zs.console.warn.apply(zs.console,arguments):jv.call(null,arguments))},error:function(t){zs.console&&(typeof zs.console.error=="function"?zs.console.error.apply(zs.console,arguments):jv(t))}};function Nv(t,s,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){zu(a.response,s,r)},a.onerror=function(){ta.error("could not download file")},a.send()}function fw(t){var s=new XMLHttpRequest;s.open("HEAD",t,!1);try{s.send()}catch{}return s.status>=200&&s.status<=299}function Ip(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(s)}}var Mm,Hb,zu=zs.saveAs||((typeof window>"u"?"undefined":Gr(window))!=="object"||window!==zs?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,s,r){var a=zs.URL||zs.webkitURL,n=document.createElement("a");s=s||t.name||"download",n.download=s,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?fw(n.href)?Nv(t,s,r):Ip(n,n.target="_blank"):Ip(n)):(n.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(n.href)}),4e4),setTimeout((function(){Ip(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,s,r){if(s=s||t.name||"download",typeof t=="string")if(fw(t))Nv(t,s,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){Ip(a)}))}else navigator.msSaveOrOpenBlob((function(n,i){return i===void 0?i={autoBom:!1}:Gr(i)!=="object"&&(ta.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),s)}:function(t,s,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return Nv(t,s,r);var n=t.type==="application/octet-stream",i=/constructor/i.test(zs.HTMLElement)||zs.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&i)&&(typeof FileReader>"u"?"undefined":Gr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var c=o.result;c=l?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=c:location=c,a=null},o.readAsDataURL(t)}else{var u=zs.URL||zs.webkitURL,d=u.createObjectURL(t);a?a.location=d:location.href=d,a=null,setTimeout((function(){u.revokeObjectURL(d)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function s5(t){var s;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,i=r[a].process,l=n.exec(t);l&&(s=i(l),this.r=s[0],this.g=s[1],this.b=s[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),d=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),d.length==1&&(d="0"+d),"#"+o+u+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function wv(t,s){var r=t[0],a=t[1],n=t[2],i=t[3];r=ai(r,a,n,i,s[0],7,-680876936),i=ai(i,r,a,n,s[1],12,-389564586),n=ai(n,i,r,a,s[2],17,606105819),a=ai(a,n,i,r,s[3],22,-1044525330),r=ai(r,a,n,i,s[4],7,-176418897),i=ai(i,r,a,n,s[5],12,1200080426),n=ai(n,i,r,a,s[6],17,-1473231341),a=ai(a,n,i,r,s[7],22,-45705983),r=ai(r,a,n,i,s[8],7,1770035416),i=ai(i,r,a,n,s[9],12,-1958414417),n=ai(n,i,r,a,s[10],17,-42063),a=ai(a,n,i,r,s[11],22,-1990404162),r=ai(r,a,n,i,s[12],7,1804603682),i=ai(i,r,a,n,s[13],12,-40341101),n=ai(n,i,r,a,s[14],17,-1502002290),r=ni(r,a=ai(a,n,i,r,s[15],22,1236535329),n,i,s[1],5,-165796510),i=ni(i,r,a,n,s[6],9,-1069501632),n=ni(n,i,r,a,s[11],14,643717713),a=ni(a,n,i,r,s[0],20,-373897302),r=ni(r,a,n,i,s[5],5,-701558691),i=ni(i,r,a,n,s[10],9,38016083),n=ni(n,i,r,a,s[15],14,-660478335),a=ni(a,n,i,r,s[4],20,-405537848),r=ni(r,a,n,i,s[9],5,568446438),i=ni(i,r,a,n,s[14],9,-1019803690),n=ni(n,i,r,a,s[3],14,-187363961),a=ni(a,n,i,r,s[8],20,1163531501),r=ni(r,a,n,i,s[13],5,-1444681467),i=ni(i,r,a,n,s[2],9,-51403784),n=ni(n,i,r,a,s[7],14,1735328473),r=ii(r,a=ni(a,n,i,r,s[12],20,-1926607734),n,i,s[5],4,-378558),i=ii(i,r,a,n,s[8],11,-2022574463),n=ii(n,i,r,a,s[11],16,1839030562),a=ii(a,n,i,r,s[14],23,-35309556),r=ii(r,a,n,i,s[1],4,-1530992060),i=ii(i,r,a,n,s[4],11,1272893353),n=ii(n,i,r,a,s[7],16,-155497632),a=ii(a,n,i,r,s[10],23,-1094730640),r=ii(r,a,n,i,s[13],4,681279174),i=ii(i,r,a,n,s[0],11,-358537222),n=ii(n,i,r,a,s[3],16,-722521979),a=ii(a,n,i,r,s[6],23,76029189),r=ii(r,a,n,i,s[9],4,-640364487),i=ii(i,r,a,n,s[12],11,-421815835),n=ii(n,i,r,a,s[15],16,530742520),r=li(r,a=ii(a,n,i,r,s[2],23,-995338651),n,i,s[0],6,-198630844),i=li(i,r,a,n,s[7],10,1126891415),n=li(n,i,r,a,s[14],15,-1416354905),a=li(a,n,i,r,s[5],21,-57434055),r=li(r,a,n,i,s[12],6,1700485571),i=li(i,r,a,n,s[3],10,-1894986606),n=li(n,i,r,a,s[10],15,-1051523),a=li(a,n,i,r,s[1],21,-2054922799),r=li(r,a,n,i,s[8],6,1873313359),i=li(i,r,a,n,s[15],10,-30611744),n=li(n,i,r,a,s[6],15,-1560198380),a=li(a,n,i,r,s[13],21,1309151649),r=li(r,a,n,i,s[4],6,-145523070),i=li(i,r,a,n,s[11],10,-1120210379),n=li(n,i,r,a,s[2],15,718787259),a=li(a,n,i,r,s[9],21,-343485551),t[0]=eu(r,t[0]),t[1]=eu(a,t[1]),t[2]=eu(n,t[2]),t[3]=eu(i,t[3])}function $0(t,s,r,a,n,i){return s=eu(eu(s,t),eu(a,i)),eu(s<<n|s>>>32-n,r)}function ai(t,s,r,a,n,i,l){return $0(s&r|~s&a,t,s,n,i,l)}function ni(t,s,r,a,n,i,l){return $0(s&a|r&~a,t,s,n,i,l)}function ii(t,s,r,a,n,i,l){return $0(s^r^a,t,s,n,i,l)}function li(t,s,r,a,n,i,l){return $0(r^(s|~a),t,s,n,i,l)}function r5(t){var s,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(s=64;s<=t.length;s+=64)wv(a,_L(t.substring(s-64,s)));t=t.substring(s-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<t.length;s++)n[s>>2]|=t.charCodeAt(s)<<(s%4<<3);if(n[s>>2]|=128<<(s%4<<3),s>55)for(wv(a,n),s=0;s<16;s++)n[s]=0;return n[14]=8*r,wv(a,n),a}function _L(t){var s,r=[];for(s=0;s<64;s+=4)r[s>>2]=t.charCodeAt(s)+(t.charCodeAt(s+1)<<8)+(t.charCodeAt(s+2)<<16)+(t.charCodeAt(s+3)<<24);return r}Mm=zs.atob.bind(zs),Hb=zs.btoa.bind(zs);var pw="0123456789abcdef".split("");function SL(t){for(var s="",r=0;r<4;r++)s+=pw[t>>8*r+4&15]+pw[t>>8*r&15];return s}function CL(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function qb(t){return r5(t).map(CL).join("")}var BL=(function(t){for(var s=0;s<t.length;s++)t[s]=SL(t[s]);return t.join("")})(r5("hello"))!="5d41402abc4b2a76b9719d911017c592";function eu(t,s){if(BL){var r=(65535&t)+(65535&s);return(t>>16)+(s>>16)+(r>>16)<<16|65535&r}return t+s&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Vb(t,s){var r,a,n,i;if(t!==r){for(var l=(n=t,i=1+(256/t.length>>0),new Array(i+1).join(n)),o=[],u=0;u<256;u++)o[u]=u;var d=0;for(u=0;u<256;u++){var c=o[u];d=(d+c+l.charCodeAt(u))%256,o[u]=o[d],o[d]=c}r=t,a=o}else o=a;var m=s.length,h=0,f=0,x="";for(u=0;u<m;u++)f=(f+(c=o[h=(h+1)%256]))%256,o[h]=o[f],o[f]=c,l=o[(o[h]+o[f])%256],x+=String.fromCharCode(s.charCodeAt(u)^l);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var xw={print:4,modify:8,copy:16,"annot-forms":32};function uh(t,s,r,a){this.v=1,this.r=2;var n=192;t.forEach((function(o){if(xw.perm!==void 0)throw new Error("Invalid permission: "+o);n+=xw[o]})),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(s+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,l),this.P=-(1+(255^n)),this.encryptionKey=qb(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Vb(this.encryptionKey,this.padding)}function Ah(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var s="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?s+="#"+("0"+n.toString(16)).slice(-2):s+=t[a]}return s}function gw(t){if(Gr(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var s={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");s.hasOwnProperty(r)||(s[r]={});var i=Math.random().toString(35);return s[r][i]=[a,!!n],i},this.unsubscribe=function(r){for(var a in s)if(s[a][r])return delete s[a][r],Object.keys(s[a]).length===0&&delete s[a],!0;return!1},this.publish=function(r){if(s.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var i in s[r]){var l=s[r][i];try{l[0].apply(t,a)}catch(o){zs.console&&ta.error("jsPDF PubSub Error",o.message,o)}l[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return s}}function Kx(t){if(!(this instanceof Kx))return new Kx(t);var s="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&s.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function a5(t,s){this.gState=t,this.matrix=s,this.id="",this.objectNumber=-1}function Xu(t,s,r,a,n){if(!(this instanceof Xu))return new Xu(t,s,r,a,n);this.type=t==="axial"?2:3,this.coords=s,this.colors=r,a5.call(this,a,n)}function ph(t,s,r,a,n){if(!(this instanceof ph))return new ph(t,s,r,a,n);this.boundingBox=t,this.xStep=s,this.yStep=r,this.stream="",this.cloneIndex=0,a5.call(this,a,n)}function As(t){var s,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],i=arguments[3],l=[],o=1,u=16,d="S",c=null;Gr(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,i=t.compress||t.compressPdf||i,(c=t.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(s=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),d=t.defaultPathOperation||"S"),l=t.filters||(i===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var m=t.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=gw;var x="1.3",g=f.__private__.getPdfVersion=function(){return x};f.__private__.setPdfVersion=function(re){x=re};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return b};var y=f.__private__.getPageFormat=function(re){return b[re]};n=n||"a4";var N={COMPAT:"compat",ADVANCED:"advanced"},j=N.COMPAT;function S(){this.saveGraphicsState(),le(new ht(ze,0,0,-ze,0,Mo()*ze).toString()+" cm"),this.setFontSize(this.getFontSize()/ze),d="n",j=N.ADVANCED}function k(){this.restoreGraphicsState(),d="S",j=N.COMPAT}var P=f.__private__.combineFontStyleAndFontWeight=function(re,ye){if(re=="bold"&&ye=="normal"||re=="bold"&&ye==400||re=="normal"&&ye=="italic"||re=="bold"&&ye=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ye&&(re=ye==400||ye==="normal"?re==="italic"?"italic":"normal":ye!=700&&ye!=="bold"||re!=="normal"?(ye==700?"bold":ye)+""+re:"bold"),re};f.advancedAPI=function(re){var ye=j===N.COMPAT;return ye&&S.call(this),typeof re!="function"||(re(this),ye&&k.call(this)),this},f.compatAPI=function(re){var ye=j===N.ADVANCED;return ye&&k.call(this),typeof re!="function"||(re(this),ye&&S.call(this)),this},f.isAdvancedAPI=function(){return j===N.ADVANCED};var I,B=function(re){if(j!==N.ADVANCED)throw new Error(re+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},q=f.roundToPrecision=f.__private__.roundToPrecision=function(re,ye){var ot=s||ye;if(isNaN(re)||isNaN(ot))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return re.toFixed(ot).replace(/0+$/,"")};I=f.hpf=f.__private__.hpf=typeof u=="number"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return q(re,u)}:u==="smart"?function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return q(re,re>-1&&re<1?16:5)}:function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.hpf");return q(re,16)};var Q=f.f2=f.__private__.f2=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f2");return q(re,2)},O=f.__private__.f3=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.f3");return q(re,3)},T=f.scale=f.__private__.scale=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.scale");return j===N.COMPAT?re*ze:j===N.ADVANCED?re:void 0},V=function(re){return j===N.COMPAT?Mo()-re:j===N.ADVANCED?re:void 0},D=function(re){return T(V(re))};f.__private__.setPrecision=f.setPrecision=function(re){typeof parseInt(re,10)=="number"&&(s=parseInt(re,10))};var Y,M="00000000000000000000000000000000",X=f.__private__.getFileId=function(){return M},R=f.__private__.setFileId=function(re){return M=re!==void 0&&/^[a-fA-F0-9]{32}$/.test(re)?re.toUpperCase():M.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),c!==null&&(Mr=new uh(c.userPermissions,c.userPassword,c.ownerPassword,M)),M};f.setFileId=function(re){return R(re),this},f.getFileId=function(){return X()};var H=f.__private__.convertDateToPDFDate=function(re){var ye=re.getTimezoneOffset(),ot=ye<0?"+":"-",gt=Math.floor(Math.abs(ye/60)),Lt=Math.abs(ye%60),zt=[ot,E(gt),"'",E(Lt),"'"].join("");return["D:",re.getFullYear(),E(re.getMonth()+1),E(re.getDate()),E(re.getHours()),E(re.getMinutes()),E(re.getSeconds()),zt].join("")},W=f.__private__.convertPDFDateToDate=function(re){var ye=parseInt(re.substr(2,4),10),ot=parseInt(re.substr(6,2),10)-1,gt=parseInt(re.substr(8,2),10),Lt=parseInt(re.substr(10,2),10),zt=parseInt(re.substr(12,2),10),os=parseInt(re.substr(14,2),10);return new Date(ye,ot,gt,Lt,zt,os,0)},K=f.__private__.setCreationDate=function(re){var ye;if(re===void 0&&(re=new Date),re instanceof Date)ye=H(re);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(re))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ye=re}return Y=ye},_=f.__private__.getCreationDate=function(re){var ye=Y;return re==="jsDate"&&(ye=W(Y)),ye};f.setCreationDate=function(re){return K(re),this},f.getCreationDate=function(re){return _(re)};var F,E=f.__private__.padd2=function(re){return("0"+parseInt(re)).slice(-2)},L=f.__private__.padd2Hex=function(re){return("00"+(re=re.toString())).substr(re.length)},U=0,J=[],ae=[],Z=0,oe=[],ee=[],se=!1,Ae=ae,we=function(){U=0,Z=0,ae=[],J=[],oe=[],Se=Kt(),Le=Kt()};f.__private__.setCustomOutputDestination=function(re){se=!0,Ae=re};var ce=function(re){se||(Ae=re)};f.__private__.resetCustomOutputDestination=function(){se=!1,Ae=ae};var le=f.__private__.out=function(re){return re=re.toString(),Z+=re.length+1,Ae.push(re),Ae},_e=f.__private__.write=function(re){return le(arguments.length===1?re.toString():Array.prototype.join.call(arguments," "))},Qe=f.__private__.getArrayBuffer=function(re){for(var ye=re.length,ot=new ArrayBuffer(ye),gt=new Uint8Array(ot);ye--;)gt[ye]=re.charCodeAt(ye);return ot},Ie=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Ie};var ke=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(re){return ke=j===N.ADVANCED?re/ze:re,this};var pe,he=f.__private__.getFontSize=f.getFontSize=function(){return j===N.COMPAT?ke:ke*ze},je=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(re){return je=re,this},f.__private__.getR2L=f.getR2L=function(){return je};var me,xe=f.__private__.setZoomMode=function(re){var ye=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(re))pe=re;else if(isNaN(re)){if(ye.indexOf(re)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+re+'" is not recognized.');pe=re}else pe=parseInt(re,10)};f.__private__.getZoomMode=function(){return pe};var Ue,ct=f.__private__.setPageMode=function(re){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(re)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+re+'" is not recognized.');me=re};f.__private__.getPageMode=function(){return me};var dt=f.__private__.setLayoutMode=function(re){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(re)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+re+'" is not recognized.');Ue=re};f.__private__.getLayoutMode=function(){return Ue},f.__private__.setDisplayMode=f.setDisplayMode=function(re,ye,ot){return xe(re),dt(ye),ct(ot),this};var We={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(re){if(Object.keys(We).indexOf(re)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return We[re]},f.__private__.getDocumentProperties=function(){return We},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(re){for(var ye in We)We.hasOwnProperty(ye)&&re[ye]&&(We[ye]=re[ye]);return this},f.__private__.setDocumentProperty=function(re,ye){if(Object.keys(We).indexOf(re)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return We[re]=ye};var He,ze,Pe,Te,Ke,$e={},Ve={},Ze=[],Re={},it={},lt={},Ne={},Xe=null,Ge=0,at=[],xt=new gw(f),wt=t.hotfixes||[],pt={},ge={},rt=[],ht=function re(ye,ot,gt,Lt,zt,os){if(!(this instanceof re))return new re(ye,ot,gt,Lt,zt,os);isNaN(ye)&&(ye=1),isNaN(ot)&&(ot=0),isNaN(gt)&&(gt=0),isNaN(Lt)&&(Lt=1),isNaN(zt)&&(zt=0),isNaN(os)&&(os=0),this._matrix=[ye,ot,gt,Lt,zt,os]};Object.defineProperty(ht.prototype,"sx",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(ht.prototype,"shy",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(ht.prototype,"shx",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(ht.prototype,"sy",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(ht.prototype,"tx",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(ht.prototype,"ty",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(ht.prototype,"a",{get:function(){return this._matrix[0]},set:function(re){this._matrix[0]=re}}),Object.defineProperty(ht.prototype,"b",{get:function(){return this._matrix[1]},set:function(re){this._matrix[1]=re}}),Object.defineProperty(ht.prototype,"c",{get:function(){return this._matrix[2]},set:function(re){this._matrix[2]=re}}),Object.defineProperty(ht.prototype,"d",{get:function(){return this._matrix[3]},set:function(re){this._matrix[3]=re}}),Object.defineProperty(ht.prototype,"e",{get:function(){return this._matrix[4]},set:function(re){this._matrix[4]=re}}),Object.defineProperty(ht.prototype,"f",{get:function(){return this._matrix[5]},set:function(re){this._matrix[5]=re}}),Object.defineProperty(ht.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ht.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ht.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ht.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ht.prototype.join=function(re){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(re)},ht.prototype.multiply=function(re){var ye=re.sx*this.sx+re.shy*this.shx,ot=re.sx*this.shy+re.shy*this.sy,gt=re.shx*this.sx+re.sy*this.shx,Lt=re.shx*this.shy+re.sy*this.sy,zt=re.tx*this.sx+re.ty*this.shx+this.tx,os=re.tx*this.shy+re.ty*this.sy+this.ty;return new ht(ye,ot,gt,Lt,zt,os)},ht.prototype.decompose=function(){var re=this.sx,ye=this.shy,ot=this.shx,gt=this.sy,Lt=this.tx,zt=this.ty,os=Math.sqrt(re*re+ye*ye),ws=(re/=os)*ot+(ye/=os)*gt;ot-=re*ws,gt-=ye*ws;var Us=Math.sqrt(ot*ot+gt*gt);return ws/=Us,re*(gt/=Us)<ye*(ot/=Us)&&(re=-re,ye=-ye,ws=-ws,os=-os),{scale:new ht(os,0,0,Us,0,0),translate:new ht(1,0,0,1,Lt,zt),rotate:new ht(re,ye,-ye,re,0,0),skew:new ht(1,0,ws,1,0,0)}},ht.prototype.toString=function(re){return this.join(" ")},ht.prototype.inversed=function(){var re=this.sx,ye=this.shy,ot=this.shx,gt=this.sy,Lt=this.tx,zt=this.ty,os=1/(re*gt-ye*ot),ws=gt*os,Us=-ye*os,sr=-ot*os,tr=re*os;return new ht(ws,Us,sr,tr,-ws*Lt-sr*zt,-Us*Lt-tr*zt)},ht.prototype.applyToPoint=function(re){var ye=re.x*this.sx+re.y*this.shx+this.tx,ot=re.x*this.shy+re.y*this.sy+this.ty;return new Cl(ye,ot)},ht.prototype.applyToRectangle=function(re){var ye=this.applyToPoint(re),ot=this.applyToPoint(new Cl(re.x+re.w,re.y+re.h));return new Qo(ye.x,ye.y,ot.x-ye.x,ot.y-ye.y)},ht.prototype.clone=function(){var re=this.sx,ye=this.shy,ot=this.shx,gt=this.sy,Lt=this.tx,zt=this.ty;return new ht(re,ye,ot,gt,Lt,zt)},f.Matrix=ht;var ft=f.matrixMult=function(re,ye){return ye.multiply(re)},St=new ht(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=St;var Je=function(re,ye){if(!it[re]){var ot=(ye instanceof Xu?"Sh":"P")+(Object.keys(Re).length+1).toString(10);ye.id=ot,it[re]=ot,Re[ot]=ye,xt.publish("addPattern",ye)}};f.ShadingPattern=Xu,f.TilingPattern=ph,f.addShadingPattern=function(re,ye){return B("addShadingPattern()"),Je(re,ye),this},f.beginTilingPattern=function(re){B("beginTilingPattern()"),EA(re.boundingBox[0],re.boundingBox[1],re.boundingBox[2]-re.boundingBox[0],re.boundingBox[3]-re.boundingBox[1],re.matrix)},f.endTilingPattern=function(re,ye){B("endTilingPattern()"),ye.stream=ee[F].join(`
`),Je(re,ye),xt.publish("endTilingPattern",ye),rt.pop().restore()};var ts=f.__private__.newObject=function(){var re=Kt();return fe(re,!0),re},Kt=f.__private__.newObjectDeferred=function(){return U++,J[U]=function(){return Z},U},fe=function(re,ye){return ye=typeof ye=="boolean"&&ye,J[re]=Z,ye&&le(re+" 0 obj"),re},Oe=f.__private__.newAdditionalObject=function(){var re={objId:Kt(),content:""};return oe.push(re),re},Se=Kt(),Le=Kt(),Ye=f.__private__.decodeColorString=function(re){var ye=re.split(" ");if(ye.length!==2||ye[1]!=="g"&&ye[1]!=="G")ye.length===5&&(ye[4]==="k"||ye[4]==="K")&&(ye=[(1-ye[0])*(1-ye[3]),(1-ye[1])*(1-ye[3]),(1-ye[2])*(1-ye[3]),"r"]);else{var ot=parseFloat(ye[0]);ye=[ot,ot,ot,"r"]}for(var gt="#",Lt=0;Lt<3;Lt++)gt+=("0"+Math.floor(255*parseFloat(ye[Lt])).toString(16)).slice(-2);return gt},st=f.__private__.encodeColorString=function(re){var ye;typeof re=="string"&&(re={ch1:re});var ot=re.ch1,gt=re.ch2,Lt=re.ch3,zt=re.ch4,os=re.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ot=="string"&&ot.charAt(0)!=="#"){var ws=new s5(ot);if(ws.ok)ot=ws.toHex();else if(!/^\d*\.?\d*$/.test(ot))throw new Error('Invalid color "'+ot+'" passed to jsPDF.encodeColorString.')}if(typeof ot=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ot)&&(ot="#"+ot[1]+ot[1]+ot[2]+ot[2]+ot[3]+ot[3]),typeof ot=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ot)){var Us=parseInt(ot.substr(1),16);ot=Us>>16&255,gt=Us>>8&255,Lt=255&Us}if(gt===void 0||zt===void 0&&ot===gt&&gt===Lt)if(typeof ot=="string")ye=ot+" "+os[0];else switch(re.precision){case 2:ye=Q(ot/255)+" "+os[0];break;case 3:default:ye=O(ot/255)+" "+os[0]}else if(zt===void 0||Gr(zt)==="object"){if(zt&&!isNaN(zt.a)&&zt.a===0)return ye=["1.","1.","1.",os[1]].join(" ");if(typeof ot=="string")ye=[ot,gt,Lt,os[1]].join(" ");else switch(re.precision){case 2:ye=[Q(ot/255),Q(gt/255),Q(Lt/255),os[1]].join(" ");break;default:case 3:ye=[O(ot/255),O(gt/255),O(Lt/255),os[1]].join(" ")}}else if(typeof ot=="string")ye=[ot,gt,Lt,zt,os[2]].join(" ");else switch(re.precision){case 2:ye=[Q(ot),Q(gt),Q(Lt),Q(zt),os[2]].join(" ");break;case 3:default:ye=[O(ot),O(gt),O(Lt),O(zt),os[2]].join(" ")}return ye},It=f.__private__.getFilters=function(){return l},Ft=f.__private__.putStream=function(re){var ye=(re=re||{}).data||"",ot=re.filters||It(),gt=re.alreadyAppliedFilters||[],Lt=re.addLength1||!1,zt=ye.length,os=re.objectId,ws=function(gn){return gn};if(c!==null&&os===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(ws=Mr.encryptor(os,0));var Us={};ot===!0&&(ot=["FlateEncode"]);var sr=re.additionalKeyValues||[],tr=(Us=As.API.processDataByFilters!==void 0?As.API.processDataByFilters(ye,ot):{data:ye,reverseChain:[]}).reverseChain+(Array.isArray(gt)?gt.join(" "):gt.toString());if(Us.data.length!==0&&(sr.push({key:"Length",value:Us.data.length}),Lt===!0&&sr.push({key:"Length1",value:zt})),tr.length!=0)if(tr.split("/").length-1==1)sr.push({key:"Filter",value:tr});else{sr.push({key:"Filter",value:"["+tr+"]"});for(var Ar=0;Ar<sr.length;Ar+=1)if(sr[Ar].key==="DecodeParms"){for(var ia=[],pa=0;pa<Us.reverseChain.split("/").length-1;pa+=1)ia.push("null");ia.push(sr[Ar].value),sr[Ar].value="["+ia.join(" ")+"]"}}le("<<");for(var Fa=0;Fa<sr.length;Fa++)le("/"+sr[Fa].key+" "+sr[Fa].value);le(">>"),Us.data.length!==0&&(le("stream"),le(ws(Us.data)),le("endstream"))},Bt=f.__private__.putPage=function(re){var ye=re.number,ot=re.data,gt=re.objId,Lt=re.contentsObjId;fe(gt,!0),le("<</Type /Page"),le("/Parent "+re.rootDictionaryObjId+" 0 R"),le("/Resources "+re.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(I(re.mediaBox.bottomLeftX))+" "+parseFloat(I(re.mediaBox.bottomLeftY))+" "+I(re.mediaBox.topRightX)+" "+I(re.mediaBox.topRightY)+"]"),re.cropBox!==null&&le("/CropBox ["+I(re.cropBox.bottomLeftX)+" "+I(re.cropBox.bottomLeftY)+" "+I(re.cropBox.topRightX)+" "+I(re.cropBox.topRightY)+"]"),re.bleedBox!==null&&le("/BleedBox ["+I(re.bleedBox.bottomLeftX)+" "+I(re.bleedBox.bottomLeftY)+" "+I(re.bleedBox.topRightX)+" "+I(re.bleedBox.topRightY)+"]"),re.trimBox!==null&&le("/TrimBox ["+I(re.trimBox.bottomLeftX)+" "+I(re.trimBox.bottomLeftY)+" "+I(re.trimBox.topRightX)+" "+I(re.trimBox.topRightY)+"]"),re.artBox!==null&&le("/ArtBox ["+I(re.artBox.bottomLeftX)+" "+I(re.artBox.bottomLeftY)+" "+I(re.artBox.topRightX)+" "+I(re.artBox.topRightY)+"]"),typeof re.userUnit=="number"&&re.userUnit!==1&&le("/UserUnit "+re.userUnit),xt.publish("putPage",{objId:gt,pageContext:at[ye],pageNumber:ye,page:ot}),le("/Contents "+Lt+" 0 R"),le(">>"),le("endobj");var zt=ot.join(`
`);return j===N.ADVANCED&&(zt+=`
Q`),fe(Lt,!0),Ft({data:zt,filters:It(),objectId:Lt}),le("endobj"),gt},Tt=f.__private__.putPages=function(){var re,ye,ot=[];for(re=1;re<=Ge;re++)at[re].objId=Kt(),at[re].contentsObjId=Kt();for(re=1;re<=Ge;re++)ot.push(Bt({number:re,data:ee[re],objId:at[re].objId,contentsObjId:at[re].contentsObjId,mediaBox:at[re].mediaBox,cropBox:at[re].cropBox,bleedBox:at[re].bleedBox,trimBox:at[re].trimBox,artBox:at[re].artBox,userUnit:at[re].userUnit,rootDictionaryObjId:Se,resourceDictionaryObjId:Le}));fe(Se,!0),le("<</Type /Pages");var gt="/Kids [";for(ye=0;ye<Ge;ye++)gt+=ot[ye]+" 0 R ";le(gt+"]"),le("/Count "+Ge),le(">>"),le("endobj"),xt.publish("postPutPages")},Me=function(re){xt.publish("putFont",{font:re,out:le,newObject:ts,putStream:Ft}),re.isAlreadyPutted!==!0&&(re.objectNumber=ts(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Ah(re.postScriptName)),le("/Subtype /Type1"),typeof re.encoding=="string"&&le("/Encoding /"+re.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},Nt=function(){for(var re in $e)$e.hasOwnProperty(re)&&(m===!1||m===!0&&h.hasOwnProperty(re))&&Me($e[re])},Et=function(re){re.objectNumber=ts();var ye=[];ye.push({key:"Type",value:"/XObject"}),ye.push({key:"Subtype",value:"/Form"}),ye.push({key:"BBox",value:"["+[I(re.x),I(re.y),I(re.x+re.width),I(re.y+re.height)].join(" ")+"]"}),ye.push({key:"Matrix",value:"["+re.matrix.toString()+"]"});var ot=re.pages[1].join(`
`);Ft({data:ot,additionalKeyValues:ye,objectId:re.objectNumber}),le("endobj")},$t=function(){for(var re in pt)pt.hasOwnProperty(re)&&Et(pt[re])},Ht=function(re,ye){var ot,gt=[],Lt=1/(ye-1);for(ot=0;ot<1;ot+=Lt)gt.push(ot);if(gt.push(1),re[0].offset!=0){var zt={offset:0,color:re[0].color};re.unshift(zt)}if(re[re.length-1].offset!=1){var os={offset:1,color:re[re.length-1].color};re.push(os)}for(var ws="",Us=0,sr=0;sr<gt.length;sr++){for(ot=gt[sr];ot>re[Us+1].offset;)Us++;var tr=re[Us].offset,Ar=(ot-tr)/(re[Us+1].offset-tr),ia=re[Us].color,pa=re[Us+1].color;ws+=L(Math.round((1-Ar)*ia[0]+Ar*pa[0]).toString(16))+L(Math.round((1-Ar)*ia[1]+Ar*pa[1]).toString(16))+L(Math.round((1-Ar)*ia[2]+Ar*pa[2]).toString(16))}return ws.trim()},Ot=function(re,ye){ye||(ye=21);var ot=ts(),gt=Ht(re.colors,ye),Lt=[];Lt.push({key:"FunctionType",value:"0"}),Lt.push({key:"Domain",value:"[0.0 1.0]"}),Lt.push({key:"Size",value:"["+ye+"]"}),Lt.push({key:"BitsPerSample",value:"8"}),Lt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Lt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ft({data:gt,additionalKeyValues:Lt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ot}),le("endobj"),re.objectNumber=ts(),le("<< /ShadingType "+re.type),le("/ColorSpace /DeviceRGB");var zt="/Coords ["+I(parseFloat(re.coords[0]))+" "+I(parseFloat(re.coords[1]))+" ";re.type===2?zt+=I(parseFloat(re.coords[2]))+" "+I(parseFloat(re.coords[3])):zt+=I(parseFloat(re.coords[2]))+" "+I(parseFloat(re.coords[3]))+" "+I(parseFloat(re.coords[4]))+" "+I(parseFloat(re.coords[5])),le(zt+="]"),re.matrix&&le("/Matrix ["+re.matrix.toString()+"]"),le("/Function "+ot+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},ls=function(re,ye){var ot=Kt(),gt=ts();ye.push({resourcesOid:ot,objectOid:gt}),re.objectNumber=gt;var Lt=[];Lt.push({key:"Type",value:"/Pattern"}),Lt.push({key:"PatternType",value:"1"}),Lt.push({key:"PaintType",value:"1"}),Lt.push({key:"TilingType",value:"1"}),Lt.push({key:"BBox",value:"["+re.boundingBox.map(I).join(" ")+"]"}),Lt.push({key:"XStep",value:I(re.xStep)}),Lt.push({key:"YStep",value:I(re.yStep)}),Lt.push({key:"Resources",value:ot+" 0 R"}),re.matrix&&Lt.push({key:"Matrix",value:"["+re.matrix.toString()+"]"}),Ft({data:re.stream,additionalKeyValues:Lt,objectId:re.objectNumber}),le("endobj")},Ls=function(re){var ye;for(ye in Re)Re.hasOwnProperty(ye)&&(Re[ye]instanceof Xu?Ot(Re[ye]):Re[ye]instanceof ph&&ls(Re[ye],re))},Is=function(re){for(var ye in re.objectNumber=ts(),le("<<"),re)switch(ye){case"opacity":le("/ca "+Q(re[ye]));break;case"stroke-opacity":le("/CA "+Q(re[ye]))}le(">>"),le("endobj")},Hs=function(){var re;for(re in lt)lt.hasOwnProperty(re)&&Is(lt[re])},Ir=function(){for(var re in le("/XObject <<"),pt)pt.hasOwnProperty(re)&&pt[re].objectNumber>=0&&le("/"+re+" "+pt[re].objectNumber+" 0 R");xt.publish("putXobjectDict"),le(">>")},ya=function(){Mr.oid=ts(),le("<<"),le("/Filter /Standard"),le("/V "+Mr.v),le("/R "+Mr.r),le("/U <"+Mr.toHexString(Mr.U)+">"),le("/O <"+Mr.toHexString(Mr.O)+">"),le("/P "+Mr.P),le(">>"),le("endobj")},yr=function(){for(var re in le("/Font <<"),$e)$e.hasOwnProperty(re)&&(m===!1||m===!0&&h.hasOwnProperty(re))&&le("/"+re+" "+$e[re].objectNumber+" 0 R");le(">>")},cr=function(){if(Object.keys(Re).length>0){for(var re in le("/Shading <<"),Re)Re.hasOwnProperty(re)&&Re[re]instanceof Xu&&Re[re].objectNumber>=0&&le("/"+re+" "+Re[re].objectNumber+" 0 R");xt.publish("putShadingPatternDict"),le(">>")}},ka=function(re){if(Object.keys(Re).length>0){for(var ye in le("/Pattern <<"),Re)Re.hasOwnProperty(ye)&&Re[ye]instanceof f.TilingPattern&&Re[ye].objectNumber>=0&&Re[ye].objectNumber<re&&le("/"+ye+" "+Re[ye].objectNumber+" 0 R");xt.publish("putTilingPatternDict"),le(">>")}},Ks=function(){if(Object.keys(lt).length>0){var re;for(re in le("/ExtGState <<"),lt)lt.hasOwnProperty(re)&&lt[re].objectNumber>=0&&le("/"+re+" "+lt[re].objectNumber+" 0 R");xt.publish("putGStateDict"),le(">>")}},jr=function(re){fe(re.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),yr(),cr(),ka(re.objectOid),Ks(),Ir(),le(">>"),le("endobj")},nl=function(){var re=[];Nt(),Hs(),$t(),Ls(re),xt.publish("putResources"),re.forEach(jr),jr({resourcesOid:Le,objectOid:Number.MAX_SAFE_INTEGER}),xt.publish("postPutResources")},zr=function(){xt.publish("putAdditionalObjects");for(var re=0;re<oe.length;re++){var ye=oe[re];fe(ye.objId,!0),le(ye.content),le("endobj")}xt.publish("postPutAdditionalObjects")},sa=function(re){Ve[re.fontName]=Ve[re.fontName]||{},Ve[re.fontName][re.fontStyle]=re.id},on=function(re,ye,ot,gt,Lt){var zt={id:"F"+(Object.keys($e).length+1).toString(10),postScriptName:re,fontName:ye,fontStyle:ot,encoding:gt,isStandardFont:Lt||!1,metadata:{}};return xt.publish("addFont",{font:zt,instance:this}),$e[zt.id]=zt,sa(zt),zt.id},yi=function(re){for(var ye=0,ot=Ie.length;ye<ot;ye++){var gt=on.call(this,re[ye][0],re[ye][1],re[ye][2],Ie[ye][3],!0);m===!1&&(h[gt]=!0);var Lt=re[ye][0].split("-");sa({id:gt,fontName:Lt[0],fontStyle:Lt[1]||""})}xt.publish("addFonts",{fonts:$e,dictionary:Ve})},en=function(re){return re.foo=function(){try{return re.apply(this,arguments)}catch(gt){var ye=gt.stack||"";~ye.indexOf(" at ")&&(ye=ye.split(" at ")[1]);var ot="Error in function "+ye.split(`
`)[0].split("<")[0]+": "+gt.message;if(!zs.console)throw new Error(ot);zs.console.error(ot,gt),zs.alert&&alert(ot)}},re.foo.bar=re,re.foo},Oi=function(re,ye){var ot,gt,Lt,zt,os,ws,Us,sr,tr;if(Lt=(ye=ye||{}).sourceEncoding||"Unicode",os=ye.outputEncoding,(ye.autoencode||os)&&$e[He].metadata&&$e[He].metadata[Lt]&&$e[He].metadata[Lt].encoding&&(zt=$e[He].metadata[Lt].encoding,!os&&$e[He].encoding&&(os=$e[He].encoding),!os&&zt.codePages&&(os=zt.codePages[0]),typeof os=="string"&&(os=zt[os]),os)){for(Us=!1,ws=[],ot=0,gt=re.length;ot<gt;ot++)(sr=os[re.charCodeAt(ot)])?ws.push(String.fromCharCode(sr)):ws.push(re[ot]),ws[ot].charCodeAt(0)>>8&&(Us=!0);re=ws.join("")}for(ot=re.length;Us===void 0&&ot!==0;)re.charCodeAt(ot-1)>>8&&(Us=!0),ot--;if(!Us)return re;for(ws=ye.noBOM?[]:[254,255],ot=0,gt=re.length;ot<gt;ot++){if((tr=(sr=re.charCodeAt(ot))>>8)>>8)throw new Error("Character at position "+ot+" of string '"+re+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");ws.push(tr),ws.push(sr-(tr<<8))}return String.fromCharCode.apply(void 0,ws)},Qr=f.__private__.pdfEscape=f.pdfEscape=function(re,ye){return Oi(re,ye).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Fn=f.__private__.beginPage=function(re){ee[++Ge]=[],at[Ge]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(re[0]),topRightY:Number(re[1])}},Kn(Ge),ce(ee[F])},ji=function(re,ye){var ot,gt,Lt;switch(r=ye||r,typeof re=="string"&&(ot=y(re.toLowerCase()),Array.isArray(ot)&&(gt=ot[0],Lt=ot[1])),Array.isArray(re)&&(gt=re[0]*ze,Lt=re[1]*ze),isNaN(gt)&&(gt=n[0],Lt=n[1]),(gt>14400||Lt>14400)&&(ta.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),gt=Math.min(14400,gt),Lt=Math.min(14400,Lt)),n=[gt,Lt],r.substr(0,1)){case"l":Lt>gt&&(n=[Lt,gt]);break;case"p":gt>Lt&&(n=[Lt,gt])}Fn(n),na(gr),le(mr),Nu!==0&&le(Nu+" J"),xc!==0&&le(xc+" j"),xt.publish("addPage",{pageNumber:Ge})},Gn=function(re){re>0&&re<=Ge&&(ee.splice(re,1),at.splice(re,1),Ge--,F>Ge&&(F=Ge),this.setPage(F))},Kn=function(re){re>0&&re<=Ge&&(F=re)},od=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return ee.length-1},il=function(re,ye,ot){var gt,Lt=void 0;return ot=ot||{},re=re!==void 0?re:$e[He].fontName,ye=ye!==void 0?ye:$e[He].fontStyle,gt=re.toLowerCase(),Ve[gt]!==void 0&&Ve[gt][ye]!==void 0?Lt=Ve[gt][ye]:Ve[re]!==void 0&&Ve[re][ye]!==void 0?Lt=Ve[re][ye]:ot.disableWarning===!1&&ta.warn("Unable to look up font label for font '"+re+"', '"+ye+"'. Refer to getFontList() for available fonts."),Lt||ot.noFallback||(Lt=Ve.times[ye])==null&&(Lt=Ve.times.normal),Lt},xr=f.__private__.putInfo=function(){var re=ts(),ye=function(gt){return gt};for(var ot in c!==null&&(ye=Mr.encryptor(re,0)),le("<<"),le("/Producer ("+Qr(ye("jsPDF "+As.version))+")"),We)We.hasOwnProperty(ot)&&We[ot]&&le("/"+ot.substr(0,1).toUpperCase()+ot.substr(1)+" ("+Qr(ye(We[ot]))+")");le("/CreationDate ("+Qr(ye(Y))+")"),le(">>"),le("endobj")},Nr=f.__private__.putCatalog=function(re){var ye=(re=re||{}).rootDictionaryObjId||Se;switch(ts(),le("<<"),le("/Type /Catalog"),le("/Pages "+ye+" 0 R"),pe||(pe="fullwidth"),pe){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ot=""+pe;ot.substr(ot.length-1)==="%"&&(pe=parseInt(pe)/100),typeof pe=="number"&&le("/OpenAction [3 0 R /XYZ null null "+Q(pe)+"]")}switch(Ue||(Ue="continuous"),Ue){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}me&&le("/PageMode /"+me),xt.publish("putCatalog"),le(">>"),le("endobj")},cd=f.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(U+1)),le("/Root "+U+" 0 R"),le("/Info "+(U-1)+" 0 R"),c!==null&&le("/Encrypt "+Mr.oid+" 0 R"),le("/ID [ <"+M+"> <"+M+"> ]"),le(">>")},fc=f.__private__.putHeader=function(){le("%PDF-"+x),le("%")},dd=f.__private__.putXRef=function(){var re="0000000000";le("xref"),le("0 "+(U+1)),le("0000000000 65535 f ");for(var ye=1;ye<=U;ye++)typeof J[ye]=="function"?le((re+J[ye]()).slice(-10)+" 00000 n "):J[ye]!==void 0?le((re+J[ye]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},ma=f.__private__.buildDocument=function(){we(),ce(ae),xt.publish("buildDocument"),fc(),Tt(),zr(),nl(),c!==null&&ya(),xr(),Nr();var re=Z;return dd(),cd(),le("startxref"),le(""+re),le("%%EOF"),ce(ee[F]),ae.join(`
`)},Qi=f.__private__.getBlob=function(re){return new Blob([Qe(re)],{type:"application/pdf"})},ll=f.output=f.__private__.output=en((function(re,ye){switch(typeof(ye=ye||{})=="string"?ye={filename:ye}:ye.filename=ye.filename||"generated.pdf",re){case void 0:return ma();case"save":f.save(ye.filename);break;case"arraybuffer":return Qe(ma());case"blob":return Qi(ma());case"bloburi":case"bloburl":if(zs.URL!==void 0&&typeof zs.URL.createObjectURL=="function")return zs.URL&&zs.URL.createObjectURL(Qi(ma()))||void 0;ta.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ot="",gt=ma();try{ot=Hb(gt)}catch{ot=Hb(unescape(encodeURIComponent(gt)))}return"data:application/pdf;filename="+ye.filename+";base64,"+ot;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zs)==="[object Window]"){var Lt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",zt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ye.pdfObjectUrl&&(Lt=ye.pdfObjectUrl,zt="");var os='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Lt+'"'+zt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ye)+");<\/script></body></html>",ws=zs.open();return ws!==null&&ws.document.write(os),ws}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zs)==="[object Window]"){var Us='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ye.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ye.filename+'" width="500px" height="400px" /></body></html>',sr=zs.open();if(sr!==null){sr.document.write(Us);var tr=this;sr.document.documentElement.querySelector("#pdfViewer").onload=function(){sr.document.title=ye.filename,sr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(tr.output("bloburl"))}}return sr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zs)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ar='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ye)+'"></iframe></body></html>',ia=zs.open();if(ia!==null&&(ia.document.write(Ar),ia.document.title=ye.filename),ia||typeof safari>"u")return ia;break;case"datauri":case"dataurl":return zs.document.location.href=this.output("datauristring",ye);default:return null}})),cn=function(re){return Array.isArray(wt)===!0&&wt.indexOf(re)>-1};switch(a){case"pt":ze=1;break;case"mm":ze=72/25.4;break;case"cm":ze=72/2.54;break;case"in":ze=72;break;case"px":ze=cn("px_scaling")==1?.75:96/72;break;case"pc":case"em":ze=12;break;case"ex":ze=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ze=a}var Mr=null;K(),R();var Ni=function(re){return c!==null?Mr.encryptor(re,0):function(ye){return ye}},zn=f.__private__.getPageInfo=f.getPageInfo=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:at[re].objId,pageNumber:re,pageContext:at[re]}},Ms=f.__private__.getPageInfoByObjId=function(re){if(isNaN(re)||re%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ye in at)if(at[ye].objId===re)break;return zn(ye)},be=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:at[F].objId,pageNumber:F,pageContext:at[F]}};f.addPage=function(){return ji.apply(this,arguments),this},f.setPage=function(){return Kn.apply(this,arguments),ce.call(this,ee[F]),this},f.insertPage=function(re){return this.addPage(),this.movePage(F,re),this},f.movePage=function(re,ye){var ot,gt;if(re>ye){ot=ee[re],gt=at[re];for(var Lt=re;Lt>ye;Lt--)ee[Lt]=ee[Lt-1],at[Lt]=at[Lt-1];ee[ye]=ot,at[ye]=gt,this.setPage(ye)}else if(re<ye){ot=ee[re],gt=at[re];for(var zt=re;zt<ye;zt++)ee[zt]=ee[zt+1],at[zt]=at[zt+1];ee[ye]=ot,at[ye]=gt,this.setPage(ye)}return this},f.deletePage=function(){return Gn.apply(this,arguments),this},f.__private__.text=f.text=function(re,ye,ot,gt,Lt){var zt,os,ws,Us,sr,tr,Ar,ia,pa,Fa=(gt=gt||{}).scope||this;if(typeof re=="number"&&typeof ye=="number"&&(typeof ot=="string"||Array.isArray(ot))){var gn=ot;ot=ye,ye=re,re=gn}if(arguments[3]instanceof ht?(B("The transform parameter of text() with a Matrix value"),pa=Lt):(ws=arguments[4],Us=arguments[5],Gr(Ar=arguments[3])==="object"&&Ar!==null||(typeof ws=="string"&&(Us=ws,ws=null),typeof Ar=="string"&&(Us=Ar,Ar=null),typeof Ar=="number"&&(ws=Ar,Ar=null),gt={flags:Ar,angle:ws,align:Us})),isNaN(ye)||isNaN(ot)||re==null)throw new Error("Invalid arguments passed to jsPDF.text");if(re.length===0)return Fa;var tn="",cl=!1,wi=typeof gt.lineHeightFactor=="number"?gt.lineHeightFactor:ms,Mi=Fa.internal.scaleFactor;function Ho(Hr){return Hr=Hr.split("	").join(Array(gt.TabLen||9).join(" ")),Qr(Hr,Ar)}function Su(Hr){for(var Lr,ga=Hr.concat(),Ta=[],El=ga.length;El--;)typeof(Lr=ga.shift())=="string"?Ta.push(Lr):Array.isArray(Hr)&&(Lr.length===1||Lr[1]===void 0&&Lr[2]===void 0)?Ta.push(Lr[0]):Ta.push([Lr[0],Lr[1],Lr[2]]);return Ta}function md(Hr,Lr){var ga;if(typeof Hr=="string")ga=Lr(Hr)[0];else if(Array.isArray(Hr)){for(var Ta,El,wd=Hr.concat(),_c=[],ku=wd.length;ku--;)typeof(Ta=wd.shift())=="string"?_c.push(Lr(Ta)[0]):Array.isArray(Ta)&&typeof Ta[0]=="string"&&(El=Lr(Ta[0],Ta[1],Ta[2]),_c.push([El[0],El[1],El[2]]));ga=_c}return ga}var gc=!1,fd=!0;if(typeof re=="string")gc=!0;else if(Array.isArray(re)){var pd=re.concat();os=[];for(var vc,xa=pd.length;xa--;)(typeof(vc=pd.shift())!="string"||Array.isArray(vc)&&typeof vc[0]!="string")&&(fd=!1);gc=fd}if(gc===!1)throw new Error('Type of text must be string or Array. "'+re+'" is not recognized.');typeof re=="string"&&(re=re.match(/[\r?\n]/)?re.split(/\r\n|\r|\n/g):[re]);var xd=ke/Fa.internal.scaleFactor,gd=xd*(wi-1);switch(gt.baseline){case"bottom":ot-=gd;break;case"top":ot+=xd-gd;break;case"hanging":ot+=xd-2*gd;break;case"middle":ot+=xd/2-gd}if((tr=gt.maxWidth||0)>0&&(typeof re=="string"?re=Fa.splitTextToSize(re,tr):Object.prototype.toString.call(re)==="[object Array]"&&(re=re.reduce((function(Hr,Lr){return Hr.concat(Fa.splitTextToSize(Lr,tr))}),[]))),zt={text:re,x:ye,y:ot,options:gt,mutex:{pdfEscape:Qr,activeFontKey:He,fonts:$e,activeFontSize:ke}},xt.publish("preProcessText",zt),re=zt.text,ws=(gt=zt.options).angle,!(pa instanceof ht)&&ws&&typeof ws=="number"){ws*=Math.PI/180,gt.rotationDirection===0&&(ws=-ws),j===N.ADVANCED&&(ws=-ws);var vd=Math.cos(ws),bd=Math.sin(ws);pa=new ht(vd,bd,-bd,vd,0,0)}else ws&&ws instanceof ht&&(pa=ws);j!==N.ADVANCED||pa||(pa=St),(sr=gt.charSpace||Oo)!==void 0&&(tn+=I(T(sr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ia=gt.horizontalScale)!==void 0&&(tn+=I(100*ia)+` Tz
`),gt.lang;var Tn=-1,bc=gt.renderingMode!==void 0?gt.renderingMode:gt.stroke,eo=Fa.internal.getCurrentPageInfo().pageContext;switch(bc){case 0:case!1:case"fill":Tn=0;break;case 1:case!0:case"stroke":Tn=1;break;case 2:case"fillThenStroke":Tn=2;break;case 3:case"invisible":Tn=3;break;case 4:case"fillAndAddForClipping":Tn=4;break;case 5:case"strokeAndAddPathForClipping":Tn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Tn=6;break;case 7:case"addToPathForClipping":Tn=7}var FA=eo.usedRenderingMode!==void 0?eo.usedRenderingMode:-1;Tn!==-1?tn+=Tn+` Tr
`:FA!==-1&&(tn+=`0 Tr
`),Tn!==-1&&(eo.usedRenderingMode=Tn),Us=gt.align||"left";var In,yd=ke*wi,Cu=Fa.internal.pageSize.getWidth(),jd=$e[He];sr=gt.charSpace||Oo,tr=gt.maxWidth||0,Ar=Object.assign({autoencode:!0,noBOM:!0},gt.flags);var Bl=[],qo=function(Hr){return Fa.getStringUnitWidth(Hr,{font:jd,charSpace:sr,fontSize:ke,doKerning:!1})*ke/Mi};if(Object.prototype.toString.call(re)==="[object Array]"){var Ln;os=Su(re),Us!=="left"&&(In=os.map(qo));var vn,Vo=0;if(Us==="right"){ye-=In[0],re=[],xa=os.length;for(var to=0;to<xa;to++)to===0?(vn=Jr(ye),Ln=Ea(ot)):(vn=T(Vo-In[to]),Ln=-yd),re.push([os[to],vn,Ln]),Vo=In[to]}else if(Us==="center"){ye-=In[0]/2,re=[],xa=os.length;for(var so=0;so<xa;so++)so===0?(vn=Jr(ye),Ln=Ea(ot)):(vn=T((Vo-In[so])/2),Ln=-yd),re.push([os[so],vn,Ln]),Vo=In[so]}else if(Us==="left"){re=[],xa=os.length;for(var Nd=0;Nd<xa;Nd++)re.push(os[Nd])}else if(Us==="justify"&&jd.encoding==="Identity-H"){re=[],xa=os.length,tr=tr!==0?tr:Cu;for(var ro=0,wr=0;wr<xa;wr++)if(Ln=wr===0?Ea(ot):-yd,vn=wr===0?Jr(ye):ro,wr<xa-1){var ao=T((tr-In[wr])/(os[wr].split(" ").length-1)),bn=os[wr].split(" ");re.push([bn[0]+" ",vn,Ln]),ro=0;for(var _i=1;_i<bn.length;_i++){var yc=(qo(bn[_i-1]+" "+bn[_i])-qo(bn[_i]))*Mi+ao;_i==bn.length-1?re.push([bn[_i],yc,0]):re.push([bn[_i]+" ",yc,0]),ro-=yc}}else re.push([os[wr],vn,Ln]);re.push(["",ro,0])}else{if(Us!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(re=[],xa=os.length,tr=tr!==0?tr:Cu,wr=0;wr<xa;wr++)Ln=wr===0?Ea(ot):-yd,vn=wr===0?Jr(ye):0,wr<xa-1?Bl.push(I(T((tr-In[wr])/(os[wr].split(" ").length-1)))):Bl.push(0),re.push([os[wr],vn,Ln])}}var Bu=typeof gt.R2L=="boolean"?gt.R2L:je;Bu===!0&&(re=md(re,(function(Hr,Lr,ga){return[Hr.split("").reverse().join(""),Lr,ga]}))),zt={text:re,x:ye,y:ot,options:gt,mutex:{pdfEscape:Qr,activeFontKey:He,fonts:$e,activeFontSize:ke}},xt.publish("postProcessText",zt),re=zt.text,cl=zt.mutex.isHex||!1;var jc=$e[He].encoding;jc!=="WinAnsiEncoding"&&jc!=="StandardEncoding"||(re=md(re,(function(Hr,Lr,ga){return[Ho(Hr),Lr,ga]}))),os=Su(re),re=[];for(var Nc,wc,Si,no=0,kl=1,io=Array.isArray(os[0])?kl:no,lo="",$o=function(Hr,Lr,ga){var Ta="";return ga instanceof ht?(ga=typeof gt.angle=="number"?ft(ga,new ht(1,0,0,1,Hr,Lr)):ft(new ht(1,0,0,1,Hr,Lr),ga),j===N.ADVANCED&&(ga=ft(new ht(1,0,0,-1,0,0),ga)),Ta=ga.join(" ")+` Tm
`):Ta=I(Hr)+" "+I(Lr)+` Td
`,Ta},un=0;un<os.length;un++){switch(lo="",io){case kl:Si=(cl?"<":"(")+os[un][0]+(cl?">":")"),Nc=parseFloat(os[un][1]),wc=parseFloat(os[un][2]);break;case no:Si=(cl?"<":"(")+os[un]+(cl?">":")"),Nc=Jr(ye),wc=Ea(ot)}Bl!==void 0&&Bl[un]!==void 0&&(lo=Bl[un]+` Tw
`),un===0?re.push(lo+$o(Nc,wc,pa)+Si):io===no?re.push(lo+Si):io===kl&&re.push(lo+$o(Nc,wc,pa)+Si)}re=io===no?re.join(` Tj
T* `):re.join(` Tj
`),re+=` Tj
`;var Yn=`BT
/`;return Yn+=He+" "+ke+` Tf
`,Yn+=I(ke*wi)+` TL
`,Yn+=ja+`
`,Yn+=tn,Yn+=re,le(Yn+="ET"),h[He]=!0,Fa};var nt=f.__private__.clip=f.clip=function(re){return le(re==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return nt("evenodd")},f.__private__.discardPath=f.discardPath=function(){return le("n"),this};var ut=f.__private__.isValidStyle=function(re){var ye=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(re)!==-1&&(ye=!0),ye};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(re){return ut(re)&&(d=re),this};var _t=f.__private__.getStyle=f.getStyle=function(re){var ye=d;switch(re){case"D":case"S":ye="S";break;case"F":ye="f";break;case"FD":case"DF":ye="B";break;case"f":case"f*":case"B":case"B*":ye=re}return ye},Qt=f.close=function(){return le("h"),this};f.stroke=function(){return le("S"),this},f.fill=function(re){return qt("f",re),this},f.fillEvenOdd=function(re){return qt("f*",re),this},f.fillStroke=function(re){return qt("B",re),this},f.fillStrokeEvenOdd=function(re){return qt("B*",re),this};var qt=function(re,ye){Gr(ye)==="object"?ss(ye,re):le(re)},Ut=function(re){re===null||j===N.ADVANCED&&re===void 0||(re=_t(re),le(re))};function Zt(re,ye,ot,gt,Lt){var zt=new ph(ye||this.boundingBox,ot||this.xStep,gt||this.yStep,this.gState,Lt||this.matrix);zt.stream=this.stream;var os=re+"$$"+this.cloneIndex+++"$$";return Je(os,zt),zt}var ss=function(re,ye){var ot=it[re.key],gt=Re[ot];if(gt instanceof Xu)le("q"),le(fs(ye)),gt.gState&&f.setGState(gt.gState),le(re.matrix.toString()+" cm"),le("/"+ot+" sh"),le("Q");else if(gt instanceof ph){var Lt=new ht(1,0,0,-1,0,Mo());re.matrix&&(Lt=Lt.multiply(re.matrix||St),ot=Zt.call(gt,re.key,re.boundingBox,re.xStep,re.yStep,Lt).id),le("q"),le("/Pattern cs"),le("/"+ot+" scn"),gt.gState&&f.setGState(gt.gState),le(ye),le("Q")}},fs=function(re){switch(re){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},js=f.moveTo=function(re,ye){return le(I(T(re))+" "+I(D(ye))+" m"),this},ns=f.lineTo=function(re,ye){return le(I(T(re))+" "+I(D(ye))+" l"),this},rs=f.curveTo=function(re,ye,ot,gt,Lt,zt){return le([I(T(re)),I(D(ye)),I(T(ot)),I(D(gt)),I(T(Lt)),I(D(zt)),"c"].join(" ")),this};f.__private__.line=f.line=function(re,ye,ot,gt,Lt){if(isNaN(re)||isNaN(ye)||isNaN(ot)||isNaN(gt)||!ut(Lt))throw new Error("Invalid arguments passed to jsPDF.line");return j===N.COMPAT?this.lines([[ot-re,gt-ye]],re,ye,[1,1],Lt||"S"):this.lines([[ot-re,gt-ye]],re,ye,[1,1]).stroke()},f.__private__.lines=f.lines=function(re,ye,ot,gt,Lt,zt){var os,ws,Us,sr,tr,Ar,ia,pa,Fa,gn,tn,cl;if(typeof re=="number"&&(cl=ot,ot=ye,ye=re,re=cl),gt=gt||[1,1],zt=zt||!1,isNaN(ye)||isNaN(ot)||!Array.isArray(re)||!Array.isArray(gt)||!ut(Lt)||typeof zt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(js(ye,ot),os=gt[0],ws=gt[1],sr=re.length,gn=ye,tn=ot,Us=0;Us<sr;Us++)(tr=re[Us]).length===2?(gn=tr[0]*os+gn,tn=tr[1]*ws+tn,ns(gn,tn)):(Ar=tr[0]*os+gn,ia=tr[1]*ws+tn,pa=tr[2]*os+gn,Fa=tr[3]*ws+tn,gn=tr[4]*os+gn,tn=tr[5]*ws+tn,rs(Ar,ia,pa,Fa,gn,tn));return zt&&Qt(),Ut(Lt),this},f.path=function(re){for(var ye=0;ye<re.length;ye++){var ot=re[ye],gt=ot.c;switch(ot.op){case"m":js(gt[0],gt[1]);break;case"l":ns(gt[0],gt[1]);break;case"c":rs.apply(this,gt);break;case"h":Qt()}}return this},f.__private__.rect=f.rect=function(re,ye,ot,gt,Lt){if(isNaN(re)||isNaN(ye)||isNaN(ot)||isNaN(gt)||!ut(Lt))throw new Error("Invalid arguments passed to jsPDF.rect");return j===N.COMPAT&&(gt=-gt),le([I(T(re)),I(D(ye)),I(T(ot)),I(T(gt)),"re"].join(" ")),Ut(Lt),this},f.__private__.triangle=f.triangle=function(re,ye,ot,gt,Lt,zt,os){if(isNaN(re)||isNaN(ye)||isNaN(ot)||isNaN(gt)||isNaN(Lt)||isNaN(zt)||!ut(os))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ot-re,gt-ye],[Lt-ot,zt-gt],[re-Lt,ye-zt]],re,ye,[1,1],os,!0),this},f.__private__.roundedRect=f.roundedRect=function(re,ye,ot,gt,Lt,zt,os){if(isNaN(re)||isNaN(ye)||isNaN(ot)||isNaN(gt)||isNaN(Lt)||isNaN(zt)||!ut(os))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ws=4/3*(Math.SQRT2-1);return Lt=Math.min(Lt,.5*ot),zt=Math.min(zt,.5*gt),this.lines([[ot-2*Lt,0],[Lt*ws,0,Lt,zt-zt*ws,Lt,zt],[0,gt-2*zt],[0,zt*ws,-Lt*ws,zt,-Lt,zt],[2*Lt-ot,0],[-Lt*ws,0,-Lt,-zt*ws,-Lt,-zt],[0,2*zt-gt],[0,-zt*ws,Lt*ws,-zt,Lt,-zt]],re+Lt,ye,[1,1],os,!0),this},f.__private__.ellipse=f.ellipse=function(re,ye,ot,gt,Lt){if(isNaN(re)||isNaN(ye)||isNaN(ot)||isNaN(gt)||!ut(Lt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var zt=4/3*(Math.SQRT2-1)*ot,os=4/3*(Math.SQRT2-1)*gt;return js(re+ot,ye),rs(re+ot,ye-os,re+zt,ye-gt,re,ye-gt),rs(re-zt,ye-gt,re-ot,ye-os,re-ot,ye),rs(re-ot,ye+os,re-zt,ye+gt,re,ye+gt),rs(re+zt,ye+gt,re+ot,ye+os,re+ot,ye),Ut(Lt),this},f.__private__.circle=f.circle=function(re,ye,ot,gt){if(isNaN(re)||isNaN(ye)||isNaN(ot)||!ut(gt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(re,ye,ot,ot,gt)},f.setFont=function(re,ye,ot){return ot&&(ye=P(ye,ot)),He=il(re,ye,{disableWarning:!1}),this};var bs=f.__private__.getFont=f.getFont=function(){return $e[il.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var re,ye,ot={};for(re in Ve)if(Ve.hasOwnProperty(re))for(ye in ot[re]=[],Ve[re])Ve[re].hasOwnProperty(ye)&&ot[re].push(ye);return ot},f.addFont=function(re,ye,ot,gt,Lt){var zt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&zt.indexOf(arguments[3])!==-1?Lt=arguments[3]:arguments[3]&&zt.indexOf(arguments[3])==-1&&(ot=P(ot,gt)),Lt=Lt||"Identity-H",on.call(this,re,ye,ot,Lt)};var ms,gr=t.lineWidth||.200025,dn=f.__private__.getLineWidth=f.getLineWidth=function(){return gr},na=f.__private__.setLineWidth=f.setLineWidth=function(re){return gr=re,le(I(T(re))+" w"),this};f.__private__.setLineDash=As.API.setLineDash=As.API.setLineDashPattern=function(re,ye){if(re=re||[],ye=ye||0,isNaN(ye)||!Array.isArray(re))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return re=re.map((function(ot){return I(T(ot))})).join(" "),ye=I(T(ye)),le("["+re+"] "+ye+" d"),this};var hr=f.__private__.getLineHeight=f.getLineHeight=function(){return ke*ms};f.__private__.getLineHeight=f.getLineHeight=function(){return ke*ms};var fa=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(re){return typeof(re=re||1.15)=="number"&&(ms=re),this},er=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return ms};fa(t.lineHeight);var Jr=f.__private__.getHorizontalCoordinate=function(re){return T(re)},Ea=f.__private__.getVerticalCoordinate=function(re){return j===N.ADVANCED?re:at[F].mediaBox.topRightY-at[F].mediaBox.bottomLeftY-T(re)},Sl=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(re){return I(Jr(re))},$s=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(re){return I(Ea(re))},mr=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Ye(mr)},f.__private__.setStrokeColor=f.setDrawColor=function(re,ye,ot,gt){return mr=st({ch1:re,ch2:ye,ch3:ot,ch4:gt,pdfColorType:"draw",precision:2}),le(mr),this};var ol=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Ye(ol)},f.__private__.setFillColor=f.setFillColor=function(re,ye,ot,gt){return ol=st({ch1:re,ch2:ye,ch3:ot,ch4:gt,pdfColorType:"fill",precision:2}),le(ol),this};var ja=t.textColor||"0 g",Ro=f.__private__.getTextColor=f.getTextColor=function(){return Ye(ja)};f.__private__.setTextColor=f.setTextColor=function(re,ye,ot,gt){return ja=st({ch1:re,ch2:ye,ch3:ot,ch4:gt,pdfColorType:"text",precision:3}),this};var Oo=t.charSpace,pc=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Oo||0)};f.__private__.setCharSpace=f.setCharSpace=function(re){if(isNaN(re))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Oo=re,this};var Nu=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(re){var ye=f.CapJoinStyles[re];if(ye===void 0)throw new Error("Line cap style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nu=ye,le(ye+" J"),this};var xc=0;f.__private__.setLineJoin=f.setLineJoin=function(re){var ye=f.CapJoinStyles[re];if(ye===void 0)throw new Error("Line join style of '"+re+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xc=ye,le(ye+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(re){if(re=re||0,isNaN(re))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(I(T(re))+" M"),this},f.GState=Kx,f.setGState=function(re){(re=typeof re=="string"?lt[Ne[re]]:ud(null,re)).equals(Xe)||(le("/"+re.id+" gs"),Xe=re)};var ud=function(re,ye){if(!re||!Ne[re]){var ot=!1;for(var gt in lt)if(lt.hasOwnProperty(gt)&&lt[gt].equals(ye)){ot=!0;break}if(ot)ye=lt[gt];else{var Lt="GS"+(Object.keys(lt).length+1).toString(10);lt[Lt]=ye,ye.id=Lt}return re&&(Ne[re]=ye.id),xt.publish("addGState",ye),ye}};f.addGState=function(re,ye){return ud(re,ye),this},f.saveGraphicsState=function(){return le("q"),Ze.push({key:He,size:ke,color:ja}),this},f.restoreGraphicsState=function(){le("Q");var re=Ze.pop();return He=re.key,ke=re.size,ja=re.color,Xe=null,this},f.setCurrentTransformationMatrix=function(re){return le(re.toString()+" cm"),this},f.comment=function(re){return le("#"+re),this};var Cl=function(re,ye){var ot=re||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ot},set:function(zt){isNaN(zt)||(ot=parseFloat(zt))}});var gt=ye||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return gt},set:function(zt){isNaN(zt)||(gt=parseFloat(zt))}});var Lt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Lt},set:function(zt){Lt=zt.toString()}}),this},Qo=function(re,ye,ot,gt){Cl.call(this,re,ye),this.type="rect";var Lt=ot||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Lt},set:function(os){isNaN(os)||(Lt=parseFloat(os))}});var zt=gt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return zt},set:function(os){isNaN(os)||(zt=parseFloat(os))}}),this},Ad=function(){this.page=Ge,this.currentPage=F,this.pages=ee.slice(0),this.pagesContext=at.slice(0),this.x=Pe,this.y=Te,this.matrix=Ke,this.width=Zl(F),this.height=Mo(F),this.outputDestination=Ae,this.id="",this.objectNumber=-1};Ad.prototype.restore=function(){Ge=this.page,F=this.currentPage,at=this.pagesContext,ee=this.pages,Pe=this.x,Te=this.y,Ke=this.matrix,wu(F,this.width),_u(F,this.height),Ae=this.outputDestination};var EA=function(re,ye,ot,gt,Lt){rt.push(new Ad),Ge=F=0,ee=[],Pe=re,Te=ye,Ke=Lt,Fn([ot,gt])},Kh=function(re){if(ge[re])rt.pop().restore();else{var ye=new Ad,ot="Xo"+(Object.keys(pt).length+1).toString(10);ye.id=ot,ge[re]=ot,pt[ot]=ye,xt.publish("addFormObject",ye),rt.pop().restore()}};for(var hd in f.beginFormObject=function(re,ye,ot,gt,Lt){return EA(re,ye,ot,gt,Lt),this},f.endFormObject=function(re){return Kh(re),this},f.doFormObject=function(re,ye){var ot=pt[ge[re]];return le("q"),le(ye.toString()+" cm"),le("/"+ot.id+" Do"),le("Q"),this},f.getFormObject=function(re){var ye=pt[ge[re]];return{x:ye.x,y:ye.y,width:ye.width,height:ye.height,matrix:ye.matrix}},f.save=function(re,ye){return re=re||"generated.pdf",(ye=ye||{}).returnPromise=ye.returnPromise||!1,ye.returnPromise===!1?(zu(Qi(ma()),re),typeof zu.unload=="function"&&zs.setTimeout&&setTimeout(zu.unload,911),this):new Promise((function(ot,gt){try{var Lt=zu(Qi(ma()),re);typeof zu.unload=="function"&&zs.setTimeout&&setTimeout(zu.unload,911),ot(Lt)}catch(zt){gt(zt.message)}}))},As.API)As.API.hasOwnProperty(hd)&&(hd==="events"&&As.API.events.length?(function(re,ye){var ot,gt,Lt;for(Lt=ye.length-1;Lt!==-1;Lt--)ot=ye[Lt][0],gt=ye[Lt][1],re.subscribe.apply(re,[ot].concat(typeof gt=="function"?[gt]:gt))})(xt,As.API.events):f[hd]=As.API[hd]);var Zl=f.getPageWidth=function(re){return(at[re=re||F].mediaBox.topRightX-at[re].mediaBox.bottomLeftX)/ze},wu=f.setPageWidth=function(re,ye){at[re].mediaBox.topRightX=ye*ze+at[re].mediaBox.bottomLeftX},Mo=f.getPageHeight=function(re){return(at[re=re||F].mediaBox.topRightY-at[re].mediaBox.bottomLeftY)/ze},_u=f.setPageHeight=function(re,ye){at[re].mediaBox.topRightY=ye*ze+at[re].mediaBox.bottomLeftY};return f.internal={pdfEscape:Qr,getStyle:_t,getFont:bs,getFontSize:he,getCharSpace:pc,getTextColor:Ro,getLineHeight:hr,getLineHeightFactor:er,getLineWidth:dn,write:_e,getHorizontalCoordinate:Jr,getVerticalCoordinate:Ea,getCoordinateString:Sl,getVerticalCoordinateString:$s,collections:{},newObject:ts,newAdditionalObject:Oe,newObjectDeferred:Kt,newObjectDeferredBegin:fe,getFilters:It,putStream:Ft,events:xt,scaleFactor:ze,pageSize:{getWidth:function(){return Zl(F)},setWidth:function(re){wu(F,re)},getHeight:function(){return Mo(F)},setHeight:function(re){_u(F,re)}},encryptionOptions:c,encryption:Mr,getEncryptor:Ni,output:ll,getNumberOfPages:od,pages:ee,out:le,f2:Q,f3:O,getPageInfo:zn,getPageInfoByObjId:Ms,getCurrentPageInfo:be,getPDFVersion:g,Point:Cl,Rectangle:Qo,Matrix:ht,hasHotfix:cn},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return Zl(F)},set:function(re){wu(F,re)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Mo(F)},set:function(re){_u(F,re)},enumerable:!0,configurable:!0}),yi.call(f,Ie),He="F1",ji(n,r),xt.publish("initialized"),f}uh.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},uh.prototype.toHexString=function(t){return t.split("").map((function(s){return("0"+(255&s.charCodeAt(0)).toString(16)).slice(-2)})).join("")},uh.prototype.hexToBytes=function(t){for(var s=[],r=0;r<t.length;r+=2)s.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return s.join("")},uh.prototype.processOwnerPassword=function(t,s){return Vb(qb(s).substr(0,5),t)},uh.prototype.encryptor=function(t,s){var r=qb(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&s,s>>8&255)).substr(0,10);return function(a){return Vb(r,a)}},Kx.prototype.equals=function(t){var s,r="id,objectNumber,equals";if(!t||Gr(t)!==Gr(this))return!1;var a=0;for(s in this)if(!(r.indexOf(s)>=0)){if(this.hasOwnProperty(s)&&!t.hasOwnProperty(s)||this[s]!==t[s])return!1;a++}for(s in t)t.hasOwnProperty(s)&&r.indexOf(s)<0&&a--;return a===0},As.API={events:[]},As.version="2.5.2";var Pa=As.API,Zy=1,NA=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},JA=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},rr=function(t){return t.toFixed(2)},$d=function(t){return t.toFixed(5)};Pa.__acroform__={};var al=function(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t},vw=function(t){return t*Zy},sc=function(t){var s=new i5,r=Fs.internal.getHeight(t)||0,a=Fs.internal.getWidth(t)||0;return s.BBox=[0,0,Number(rr(a)),Number(rr(r))],s},kL=Pa.__acroform__.setBit=function(t,s){if(t=t||0,s=s||0,isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<s},EL=Pa.__acroform__.clearBit=function(t,s){if(t=t||0,s=s||0,isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<s)},FL=Pa.__acroform__.getBit=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<s)==0?0:1},Ka=Pa.__acroform__.getBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return FL(t,s-1)},za=Pa.__acroform__.setBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return kL(t,s-1)},Ya=Pa.__acroform__.clearBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return EL(t,s-1)},TL=Pa.__acroform__.calculateCoordinates=function(t,s){var r=s.internal.getHorizontalCoordinate,a=s.internal.getVerticalCoordinate,n=t[0],i=t[1],l=t[2],o=t[3],u={};return u.lowerLeft_X=r(n)||0,u.lowerLeft_Y=a(i+o)||0,u.upperRight_X=r(n+l)||0,u.upperRight_Y=a(i)||0,[Number(rr(u.lowerLeft_X)),Number(rr(u.lowerLeft_Y)),Number(rr(u.upperRight_X)),Number(rr(u.upperRight_Y))]},IL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var s=[],r=t._V||t.DV,a=$b(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;s.push("/Tx BMC"),s.push("q"),s.push("BT"),s.push(t.scope.__private__.encodeColorString(t.color)),s.push("/"+n+" "+rr(a.fontSize)+" Tf"),s.push("1 0 0 1 0 0 Tm"),s.push(a.text),s.push("ET"),s.push("Q"),s.push("EMC");var i=sc(t);return i.scope=t.scope,i.stream=s.join(`
`),i}},$b=function(t,s){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(s=(s=s.substr(0,1)=="("?s.substr(1):s).substr(s.length-1)==")"?s.substr(0,s.length-1):s).split(" ");n=t.multiline?n.map((function(O){return O.split(`
`)})):n.map((function(O){return[O]}));var i=r,l=Fs.internal.getHeight(t)||0;l=l<0?-l:l;var o=Fs.internal.getWidth(t)||0;o=o<0?-o:o;var u=function(O,T,V){if(O+1<n.length){var D=T+" "+n[O+1][0];return Lp(D,t,V).width<=o-4}return!1};i++;e:for(;i>0;){s="",i--;var d,c,m=Lp("3",t,i).height,h=t.multiline?l-i:(l-m)/2,f=h+=2,x=0,g=0,b=0;if(i<=0){s=`(...) Tj
`,s+="% Width of Text: "+Lp(s,t,i=12).width+", FieldWidth:"+o+`
`;break}for(var y="",N=0,j=0;j<n.length;j++)if(n.hasOwnProperty(j)){var S=!1;if(n[j].length!==1&&b!==n[j].length-1){if((m+2)*(N+2)+2>l)continue e;y+=n[j][b],S=!0,g=j,j--}else{y=(y+=n[j][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var k=parseInt(j),P=u(k,y,i),I=j>=n.length-1;if(P&&!I){y+=" ",b=0;continue}if(P||I){if(I)g=k;else if(t.multiline&&(m+2)*(N+2)+2>l)continue e}else{if(!t.multiline||(m+2)*(N+2)+2>l)continue e;g=k}}for(var B="",q=x;q<=g;q++){var Q=n[q];if(t.multiline){if(q===g){B+=Q[b]+" ",b=(b+1)%Q.length;continue}if(q===x){B+=Q[Q.length-1]+" ";continue}}B+=Q[0]+" "}switch(B=B.substr(B.length-1)==" "?B.substr(0,B.length-1):B,c=Lp(B,t,i).width,t.textAlign){case"right":d=o-c-2;break;case"center":d=(o-c)/2;break;case"left":default:d=2}s+=rr(d)+" "+rr(f)+` Td
`,s+="("+NA(B)+`) Tj
`,s+=-rr(d)+` 0 Td
`,f=-(i+2),c=0,x=S?g:g+1,N++,y=""}break}return a.text=s,a.fontSize=i,a},Lp=function(t,s,r){var a=s.scope.internal.getFont(s.fontName,s.fontStyle),n=s.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:s.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},LL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},DL=function(t,s){var r={type:"reference",object:t};s.internal.getPageInfo(t.page).pageContext.annotations.find((function(a){return a.type===r.type&&a.object===r.object}))===void 0&&s.internal.getPageInfo(t.page).pageContext.annotations.push(r)},PL=function(t,s){for(var r in t)if(t.hasOwnProperty(r)){var a=r,n=t[r];s.internal.newObjectDeferredBegin(n.objId,!0),Gr(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete t[a]}},UL=function(t,s){if(s.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Io.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(LL)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Zy=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new l5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",(function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)})),t.internal.events.subscribe("buildDocument",(function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var i=a[n];i.objId=void 0,i.hasAnnotation&&DL(i,r)}})(t)})),t.internal.events.subscribe("putCatalog",(function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)})),t.internal.events.subscribe("postPutPages",(function(r){(function(a,n){var i=!a;for(var l in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var o=a[l],u=[],d=o.Rect;if(o.Rect&&(o.Rect=TL(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Fs.createDefaultAppearanceStream(o),Gr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=d,o.hasAppearanceStream&&!o.appearanceStreamContent){var c=IL(o);u.push({key:"AP",value:"<</N "+c+">>"}),n.internal.acroformPlugin.xForms.push(c)}if(o.appearanceStreamContent){var m="";for(var h in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(h)){var f=o.appearanceStreamContent[h];if(m+="/"+h+" ",m+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var l in f)if(f.hasOwnProperty(l)){var x=f[l];typeof x=="function"&&(x=x.call(n,o)),m+="/"+l+" "+x+" ",n.internal.acroformPlugin.xForms.indexOf(x)>=0||n.internal.acroformPlugin.xForms.push(x)}}else typeof(x=f)=="function"&&(x=x.call(n,o)),m+="/"+l+" "+x,n.internal.acroformPlugin.xForms.indexOf(x)>=0||n.internal.acroformPlugin.xForms.push(x);m+=">>"}u.push({key:"AP",value:`<<
`+m+">>"})}n.internal.putStream({additionalKeyValues:u,objectId:o.objId}),n.internal.out("endobj")}i&&PL(n.internal.acroformPlugin.xForms,n)})(r,t)})),t.internal.acroformPlugin.isInitialized=!0}},n5=Pa.__acroform__.arrayToPdfArray=function(t,s,r){var a=function(l){return l};if(Array.isArray(t)){for(var n="[",i=0;i<t.length;i++)switch(i!==0&&(n+=" "),Gr(t[i])){case"boolean":case"number":case"object":n+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(s!==void 0&&r&&(a=r.internal.getEncryptor(s)),n+="("+NA(a(t[i].toString()))+")"):n+=t[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},_v=function(t,s,r){var a=function(n){return n};return s!==void 0&&r&&(a=r.internal.getEncryptor(s)),(t=t||"").toString(),t="("+NA(a(t))+")"},ic=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ic.prototype.toString=function(){return this.objId+" 0 R"},ic.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},ic.prototype.getKeyValueListForStream=function(){var t=[],s=Object.getOwnPropertyNames(this).filter((function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"}));for(var r in s)if(Object.getOwnPropertyDescriptor(this,s[r]).configurable===!1){var a=s[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:n5(n,this.objId,this.scope)}):n instanceof ic?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var i5=function(){ic.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,s=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};al(i5,ic);var l5=function(){ic.call(this);var t,s=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return s.length>0?s:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return s}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+NA(r(t))+")"}},set:function(r){t=r}})};al(l5,ic);var Io=function t(){ic.call(this);var s=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return s},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');s=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ka(s,3)},set:function(y){y?this.F=za(s,3):this.F=Ya(s,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(y){a=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(y){a[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(y){a[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(y){a[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(y){a[3]=y}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof zx)return;i="FieldObject"+t.FieldNum++}var y=function(N){return N};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+NA(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/Zy:d},set:function(y){d=y}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var m="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!m||this instanceof zx||this instanceof oA))return _v(m,this.objId,this.scope)},set:function(y){y=y.toString(),m=y}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Bn?h:_v(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof Bn?y:y.substr(0,1)==="("?JA(y.substr(1,y.length-2)):JA(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Bn?JA(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof Bn?"/"+y:y}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Bn?f:_v(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=this instanceof Bn?y:y.substr(0,1)==="("?JA(y.substr(1,y.length-2)):JA(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Bn?JA(f.substr(1,f.length-1)):f},set:function(y){y=y.toString(),f=this instanceof Bn?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(y){y=!!y,g=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(y){x=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,1)},set:function(y){y?this.Ff=za(this.Ff,1):this.Ff=Ya(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,2)},set:function(y){y?this.Ff=za(this.Ff,2):this.Ff=Ya(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,3)},set:function(y){y?this.Ff=za(this.Ff,3):this.Ff=Ya(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};al(Io,ic);var bh=function(){Io.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var s=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return n5(s,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(i,l,o){o||(o=1);for(var u,d=[];u=l.exec(i);)d.push(u[o]);return d})(a,/\((.*?)\)/g)),s=n}}),this.getOptions=function(){return s},this.setOptions=function(r){s=r,this.sort&&s.sort()},this.addOption=function(r){r=(r=r||"").toString(),s.push(r),this.sort&&s.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();s.indexOf(r)!==-1&&(s.splice(s.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,18)},set:function(r){r?this.Ff=za(this.Ff,18):this.Ff=Ya(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=za(this.Ff,19):this.Ff=Ya(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,20)},set:function(r){r?(this.Ff=za(this.Ff,20),s.sort()):this.Ff=Ya(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,22)},set:function(r){r?this.Ff=za(this.Ff,22):this.Ff=Ya(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,23)},set:function(r){r?this.Ff=za(this.Ff,23):this.Ff=Ya(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,27)},set:function(r){r?this.Ff=za(this.Ff,27):this.Ff=Ya(this.Ff,27)}}),this.hasAppearanceStream=!1};al(bh,Io);var yh=function(){bh.call(this),this.fontName="helvetica",this.combo=!1};al(yh,bh);var jh=function(){yh.call(this),this.combo=!0};al(jh,yh);var Cx=function(){jh.call(this),this.edit=!0};al(Cx,jh);var Bn=function(){Io.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,15)},set:function(r){r?this.Ff=za(this.Ff,15):this.Ff=Ya(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,16)},set:function(r){r?this.Ff=za(this.Ff,16):this.Ff=Ya(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,17)},set:function(r){r?this.Ff=za(this.Ff,17):this.Ff=Ya(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,26)},set:function(r){r?this.Ff=za(this.Ff,26):this.Ff=Ya(this.Ff,26)}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(s).length!==0){var a,n=[];for(a in n.push("<<"),s)n.push("/"+a+" ("+NA(r(s[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){Gr(r)==="object"&&(s=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(r){typeof r=="string"&&(s.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};al(Bn,Io);var Bx=function(){Bn.call(this),this.pushButton=!0};al(Bx,Bn);var Nh=function(){Bn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(s){t=s!==void 0?s:[]}})};al(Nh,Bn);var zx=function(){var t,s;Io.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return s},set:function(n){s=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,l=[];for(i in l.push("<<"),a)l.push("/"+i+" ("+NA(n(a[i]))+")");return l.push(">>"),l.join(`
`)},set:function(n){Gr(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Fs.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};al(zx,Io),Nh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var s in this.Kids)if(this.Kids.hasOwnProperty(s)){var r=this.Kids[s];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},Nh.prototype.createOption=function(t){var s=new zx;return s.Parent=this,s.optionName=t,this.Kids.push(s),RL.call(this.scope,s),s};var kx=function(){Bn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Fs.CheckBox.createAppearanceStream()};al(kx,Bn);var oA=function(){Io.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,13)},set:function(s){s?this.Ff=za(this.Ff,13):this.Ff=Ya(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,21)},set:function(s){s?this.Ff=za(this.Ff,21):this.Ff=Ya(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,23)},set:function(s){s?this.Ff=za(this.Ff,23):this.Ff=Ya(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,24)},set:function(s){s?this.Ff=za(this.Ff,24):this.Ff=Ya(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,25)},set:function(s){s?this.Ff=za(this.Ff,25):this.Ff=Ya(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,26)},set:function(s){s?this.Ff=za(this.Ff,26):this.Ff=Ya(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(s){Number.isInteger(s)&&(t=s)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};al(oA,Io);var Ex=function(){oA.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ka(this.Ff,14)},set:function(t){t?this.Ff=za(this.Ff,14):this.Ff=Ya(this.Ff,14)}}),this.password=!0};al(Ex,oA);var Fs={CheckBox:{createAppearanceStream:function(){return{N:{On:Fs.CheckBox.YesNormal},D:{On:Fs.CheckBox.YesPushDown,Off:Fs.CheckBox.OffPushDown}}},YesPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=$b(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+rr(Fs.internal.getWidth(t))+" "+rr(Fs.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+rr(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),s.stream=r.join(`
`),s},YesNormal:function(t){var s=sc(t);s.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],i=Fs.internal.getHeight(t),l=Fs.internal.getWidth(t),o=$b(t,t.caption);return n.push("1 g"),n.push("0 0 "+rr(l)+" "+rr(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+rr(l-1)+" "+rr(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+rr(o.fontSize)+" Tf "+a),n.push(o.text),n.push("ET"),n.push("Q"),s.stream=n.join(`
`),s},OffPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+rr(Fs.internal.getWidth(t))+" "+rr(Fs.internal.getHeight(t))+" re"),r.push("f"),s.stream=r.join(`
`),s}},RadioButton:{Circle:{createAppearanceStream:function(t){var s={D:{Off:Fs.RadioButton.Circle.OffPushDown},N:{}};return s.N[t]=Fs.RadioButton.Circle.YesNormal,s.D[t]=Fs.RadioButton.Circle.YesPushDown,s},getCA:function(){return"l"},YesNormal:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Fs.internal.getWidth(t)<=Fs.internal.getHeight(t)?Fs.internal.getWidth(t)/4:Fs.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Fs.internal.Bezier_C,i=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+$d(Fs.internal.getWidth(t)/2)+" "+$d(Fs.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),s.stream=r.join(`
`),s},YesPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Fs.internal.getWidth(t)<=Fs.internal.getHeight(t)?Fs.internal.getWidth(t)/4:Fs.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*Fs.internal.Bezier_C).toFixed(5)),l=Number((a*Fs.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+$d(Fs.internal.getWidth(t)/2)+" "+$d(Fs.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+$d(Fs.internal.getWidth(t)/2)+" "+$d(Fs.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),s.stream=r.join(`
`),s},OffPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Fs.internal.getWidth(t)<=Fs.internal.getHeight(t)?Fs.internal.getWidth(t)/4:Fs.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*Fs.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+$d(Fs.internal.getWidth(t)/2)+" "+$d(Fs.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),s.stream=r.join(`
`),s}},Cross:{createAppearanceStream:function(t){var s={D:{Off:Fs.RadioButton.Cross.OffPushDown},N:{}};return s.N[t]=Fs.RadioButton.Cross.YesNormal,s.D[t]=Fs.RadioButton.Cross.YesPushDown,s},getCA:function(){return"8"},YesNormal:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Fs.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+rr(Fs.internal.getWidth(t)-2)+" "+rr(Fs.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(rr(a.x1.x)+" "+rr(a.x1.y)+" m"),r.push(rr(a.x2.x)+" "+rr(a.x2.y)+" l"),r.push(rr(a.x4.x)+" "+rr(a.x4.y)+" m"),r.push(rr(a.x3.x)+" "+rr(a.x3.y)+" l"),r.push("s"),r.push("Q"),s.stream=r.join(`
`),s},YesPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=Fs.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+rr(Fs.internal.getWidth(t))+" "+rr(Fs.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+rr(Fs.internal.getWidth(t)-2)+" "+rr(Fs.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(rr(r.x1.x)+" "+rr(r.x1.y)+" m"),a.push(rr(r.x2.x)+" "+rr(r.x2.y)+" l"),a.push(rr(r.x4.x)+" "+rr(r.x4.y)+" m"),a.push(rr(r.x3.x)+" "+rr(r.x3.y)+" l"),a.push("s"),a.push("Q"),s.stream=a.join(`
`),s},OffPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+rr(Fs.internal.getWidth(t))+" "+rr(Fs.internal.getHeight(t))+" re"),r.push("f"),s.stream=r.join(`
`),s}}},createDefaultAppearanceStream:function(t){var s=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+s+" "+t.fontSize+" Tf "+r}};Fs.internal={Bezier_C:.551915024494,calculateCross:function(t){var s=Fs.internal.getWidth(t),r=Fs.internal.getHeight(t),a=Math.min(s,r);return{x1:{x:(s-a)/2,y:(r-a)/2+a},x2:{x:(s-a)/2+a,y:(r-a)/2},x3:{x:(s-a)/2,y:(r-a)/2},x4:{x:(s-a)/2+a,y:(r-a)/2+a}}}},Fs.internal.getWidth=function(t){var s=0;return Gr(t)==="object"&&(s=vw(t.Rect[2])),s},Fs.internal.getHeight=function(t){var s=0;return Gr(t)==="object"&&(s=vw(t.Rect[3])),s};var RL=Pa.addField=function(t){if(UL(this,t),!(t instanceof Io))throw new Error("Invalid argument passed to jsPDF.addField.");var s;return(s=t).scope.internal.acroformPlugin.printedOut&&(s.scope.internal.acroformPlugin.printedOut=!1,s.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),s.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(s),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Pa.AcroFormChoiceField=bh,Pa.AcroFormListBox=yh,Pa.AcroFormComboBox=jh,Pa.AcroFormEditBox=Cx,Pa.AcroFormButton=Bn,Pa.AcroFormPushButton=Bx,Pa.AcroFormRadioButton=Nh,Pa.AcroFormCheckBox=kx,Pa.AcroFormTextField=oA,Pa.AcroFormPasswordField=Ex,Pa.AcroFormAppearance=Fs,Pa.AcroForm={ChoiceField:bh,ListBox:yh,ComboBox:jh,EditBox:Cx,Button:Bn,PushButton:Bx,RadioButton:Nh,CheckBox:kx,TextField:oA,PasswordField:Ex,Appearance:Fs},As.AcroForm={ChoiceField:bh,ListBox:yh,ComboBox:jh,EditBox:Cx,Button:Bn,PushButton:Bx,RadioButton:Nh,CheckBox:kx,TextField:oA,PasswordField:Ex,Appearance:Fs};As.AcroForm;function o5(t){return t.reduce((function(s,r,a){return s[r]=a,s}),{})}(function(t){t.__addimage__={};var s="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(O,T){var V,D,Y,M,X,R=s;if((T=T||s)==="RGBA"||O.data!==void 0&&O.data instanceof Uint8ClampedArray&&"height"in O&&"width"in O)return"RGBA";if(P(O))for(X in r)for(Y=r[X],V=0;V<Y.length;V+=1){for(M=!0,D=0;D<Y[V].length;D+=1)if(Y[V][D]!==void 0&&Y[V][D]!==O[D]){M=!1;break}if(M===!0){R=X;break}}else for(X in r)for(Y=r[X],V=0;V<Y.length;V+=1){for(M=!0,D=0;D<Y[V].length;D+=1)if(Y[V][D]!==void 0&&Y[V][D]!==O.charCodeAt(D)){M=!1;break}if(M===!0){R=X;break}}return R===s&&T!==s&&(R=T),R},n=function O(T){for(var V=this.internal.write,D=this.internal.putStream,Y=(0,this.internal.getFilters)();Y.indexOf("FlateEncode")!==-1;)Y.splice(Y.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var M=[];if(M.push({key:"Type",value:"/XObject"}),M.push({key:"Subtype",value:"/Image"}),M.push({key:"Width",value:T.width}),M.push({key:"Height",value:T.height}),T.colorSpace===b.INDEXED?M.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(M.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===b.DEVICE_CMYK&&M.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),M.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&M.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var X="",R=0,H=T.transparency.length;R<H;R++)X+=T.transparency[R]+" "+T.transparency[R]+" ";M.push({key:"Mask",value:"["+X+"]"})}T.sMask!==void 0&&M.push({key:"SMask",value:T.objectId+1+" 0 R"});var W=T.filter!==void 0?["/"+T.filter]:void 0;if(D({data:T.data,additionalKeyValues:M,alreadyAppliedFilters:W,objectId:T.objectId}),V("endobj"),"sMask"in T&&T.sMask!==void 0){var K="/Predictor "+T.predictor+" /Colors 1 /BitsPerComponent "+T.bitsPerComponent+" /Columns "+T.width,_={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:K,data:T.sMask};"filter"in T&&(_.filter=T.filter),O.call(this,_)}if(T.colorSpace===b.INDEXED){var F=this.internal.newObject();D({data:B(new Uint8Array(T.palette)),objectId:F}),V("endobj")}},i=function(){var O=this.internal.collections.addImage_images;for(var T in O)n.call(this,O[T])},l=function(){var O,T=this.internal.collections.addImage_images,V=this.internal.write;for(var D in T)V("/I"+(O=T[D]).index,O.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var O=this.internal.collections.addImage_images;return o.call(this),O},d=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(O){return typeof t["process"+O.toUpperCase()]=="function"},m=function(O){return Gr(O)==="object"&&O.nodeType===1},h=function(O,T){if(O.nodeName==="IMG"&&O.hasAttribute("src")){var V=""+O.getAttribute("src");if(V.indexOf("data:image/")===0)return Mm(unescape(V).split("base64,").pop());var D=t.loadFile(V,!0);if(D!==void 0)return D}if(O.nodeName==="CANVAS"){if(O.width===0||O.height===0)throw new Error("Given canvas must have data. Canvas width: "+O.width+", height: "+O.height);var Y;switch(T){case"PNG":Y="image/png";break;case"WEBP":Y="image/webp";break;case"JPEG":case"JPG":default:Y="image/jpeg"}return Mm(O.toDataURL(Y,1).split("base64,").pop())}},f=function(O){var T=this.internal.collections.addImage_images;if(T){for(var V in T)if(O===T[V].alias)return T[V]}},x=function(O,T,V){return O||T||(O=-96,T=-96),O<0&&(O=-1*V.width*72/O/this.internal.scaleFactor),T<0&&(T=-1*V.height*72/T/this.internal.scaleFactor),O===0&&(O=T*V.width/V.height),T===0&&(T=O*V.height/V.width),[O,T]},g=function(O,T,V,D,Y,M){var X=x.call(this,V,D,Y),R=this.internal.getCoordinateString,H=this.internal.getVerticalCoordinateString,W=u.call(this);if(V=X[0],D=X[1],W[Y.index]=Y,M){M*=Math.PI/180;var K=Math.cos(M),_=Math.sin(M),F=function(L){return L.toFixed(4)},E=[F(K),F(_),F(-1*_),F(K),0,0,"cm"]}this.internal.write("q"),M?(this.internal.write([1,"0","0",1,R(O),H(T+D),"cm"].join(" ")),this.internal.write(E.join(" ")),this.internal.write([R(V),"0","0",R(D),"0","0","cm"].join(" "))):this.internal.write([R(V),"0","0",R(D),R(O),H(T+D),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Y.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},N=t.__addimage__.sHashCode=function(O){var T,V,D=0;if(typeof O=="string")for(V=O.length,T=0;T<V;T++)D=(D<<5)-D+O.charCodeAt(T),D|=0;else if(P(O))for(V=O.byteLength/2,T=0;T<V;T++)D=(D<<5)-D+O[T],D|=0;return D},j=t.__addimage__.validateStringAsBase64=function(O){(O=O||"").toString().trim();var T=!0;return O.length===0&&(T=!1),O.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(O.substr(0,O.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(O.substr(-2))===!1&&(T=!1),T},S=t.__addimage__.extractImageFromDataUrl=function(O){var T=(O=O||"").split("base64,"),V=null;if(T.length===2){var D=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(T[0]);Array.isArray(D)&&(V={mimeType:D[1],charset:D[2],data:T[1]})}return V},k=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(O){return k()&&O instanceof ArrayBuffer};var P=t.__addimage__.isArrayBufferView=function(O){return k()&&typeof Uint32Array<"u"&&(O instanceof Int8Array||O instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&O instanceof Uint8ClampedArray||O instanceof Int16Array||O instanceof Uint16Array||O instanceof Int32Array||O instanceof Uint32Array||O instanceof Float32Array||O instanceof Float64Array)},I=t.__addimage__.binaryStringToUint8Array=function(O){for(var T=O.length,V=new Uint8Array(T),D=0;D<T;D++)V[D]=O.charCodeAt(D);return V},B=t.__addimage__.arrayBufferToBinaryString=function(O){for(var T="",V=P(O)?O:new Uint8Array(O),D=0;D<V.length;D+=8192)T+=String.fromCharCode.apply(null,V.subarray(D,D+8192));return T};t.addImage=function(){var O,T,V,D,Y,M,X,R,H;if(typeof arguments[1]=="number"?(T=s,V=arguments[1],D=arguments[2],Y=arguments[3],M=arguments[4],X=arguments[5],R=arguments[6],H=arguments[7]):(T=arguments[1],V=arguments[2],D=arguments[3],Y=arguments[4],M=arguments[5],X=arguments[6],R=arguments[7],H=arguments[8]),Gr(O=arguments[0])==="object"&&!m(O)&&"imageData"in O){var W=O;O=W.imageData,T=W.format||T||s,V=W.x||V||0,D=W.y||D||0,Y=W.w||W.width||Y,M=W.h||W.height||M,X=W.alias||X,R=W.compression||R,H=W.rotation||W.angle||H}var K=this.internal.getFilters();if(R===void 0&&K.indexOf("FlateEncode")!==-1&&(R="SLOW"),isNaN(V)||isNaN(D))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var _=q.call(this,O,T,X,R);return g.call(this,V,D,Y,M,_,H),this};var q=function(O,T,V,D){var Y,M,X;if(typeof O=="string"&&a(O)===s){O=unescape(O);var R=Q(O,!1);(R!==""||(R=t.loadFile(O,!0))!==void 0)&&(O=R)}if(m(O)&&(O=h(O,T)),T=a(O,T),!c(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((X=V)==null||X.length===0)&&(V=(function(H){return typeof H=="string"||P(H)?N(H):P(H.data)?N(H.data):null})(O)),(Y=f.call(this,V))||(k()&&(O instanceof Uint8Array||T==="RGBA"||(M=O,O=I(O))),Y=this["process"+T.toUpperCase()](O,d.call(this),V,(function(H){return H&&typeof H=="string"&&(H=H.toUpperCase()),H in t.image_compression?H:y.NONE})(D),M)),!Y)throw new Error("An unknown error occurred whilst processing the image.");return Y},Q=t.__addimage__.convertBase64ToBinaryString=function(O,T){var V;T=typeof T!="boolean"||T;var D,Y="";if(typeof O=="string"){D=(V=S(O))!==null?V.data:O;try{Y=Mm(D)}catch(M){if(T)throw j(D)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+M.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Y};t.getImageProperties=function(O){var T,V,D="";if(m(O)&&(O=h(O)),typeof O=="string"&&a(O)===s&&((D=Q(O,!1))===""&&(D=t.loadFile(O)||""),O=D),V=a(O),!c(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(!k()||O instanceof Uint8Array||(O=I(O)),!(T=this["process"+V.toUpperCase()](O)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=V,T}})(As.API),(function(t){var s=function(r){if(r!==void 0&&r!="")return!0};As.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,i,l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,c=!1,m=0;m<d.length&&!c;m++)switch((a=d[m]).type){case"link":(s(a.options.url)||s(a.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){a=d[h];var f=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(g.objId),N=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+l(a.bounds.x)+" "+o(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y)+"] ")+"/Contents ("+f(y(a.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+f(y(N))+") >>",g.content=i;var j=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+l(a.bounds.x+30)+" "+o(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+o(a.bounds.y)+"] ")+" /Parent "+j,a.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(g.objId,"0 R",b.objId,"0 R");break;case"freetext":n="/Rect ["+l(a.bounds.x)+" "+o(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y+a.bounds.h)+"] ";var S=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(x(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var k=this.annotations._nameMap[a.options.name];a.options.pageNumber=k.page,a.options.top=k.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(x(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var P=o(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+P+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,i,l){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(r),y:d(a),w:u(r+n),h:d(a+i)},options:l,type:"link"})},t.textWithLink=function(r,a,n,i){var l,o,u=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var c=this.splitTextToSize(r,o).length;l=Math.ceil(d*c)}else o=u,l=d;return this.text(r,a,n,i),n+=.2*d,i.align==="center"&&(a-=u/2),i.align==="right"&&(a-=u),this.link(a,n-d,o,l,i),u},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(As.API),(function(t){var s={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(g){return s[g.charCodeAt(0)]!==void 0},l=t.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=t.__arabicParser__.isArabicEndLetter=function(g){return l(g)&&i(g)&&s[g.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(g){return l(g)&&n.indexOf(g.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return l(g)&&i(g)&&s[g.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(g){return l(g)&&i(g)&&s[g.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(g){return l(g)&&i(g)&&s[g.charCodeAt(0)].length>=3};var c=t.__arabicParser__.arabicLetterHasMedialForm=function(g){return l(g)&&i(g)&&s[g.charCodeAt(0)].length==4},m=t.__arabicParser__.resolveLigatures=function(g){var b=0,y=r,N="",j=0;for(b=0;b<g.length;b+=1)y[g.charCodeAt(b)]!==void 0?(j++,typeof(y=y[g.charCodeAt(b)])=="number"&&(N+=String.fromCharCode(y),y=r,j=0),b===g.length-1&&(y=r,N+=g.charAt(b-(j-1)),b-=j-1,j=0)):(y=r,N+=g.charAt(b-j),b-=j,j=0);return N};t.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&a[g.charCodeAt(0)]!==void 0};var h=t.__arabicParser__.getCorrectForm=function(g,b,y){return l(g)?i(g)===!1?-1:!d(g)||!l(b)&&!l(y)||!l(y)&&o(b)||o(g)&&!l(b)||o(g)&&u(b)||o(g)&&o(b)?0:c(g)&&l(b)&&!o(b)&&l(y)&&d(y)?3:o(g)||!l(y)?1:2:-1},f=function(g){var b=0,y=0,N=0,j="",S="",k="",P=(g=g||"").split("\\s+"),I=[];for(b=0;b<P.length;b+=1){for(I.push(""),y=0;y<P[b].length;y+=1)j=P[b][y],S=P[b][y-1],k=P[b][y+1],l(j)?(N=h(j,S,k),I[b]+=N!==-1?String.fromCharCode(s[j.charCodeAt(0)][N]):j):I[b]+=j;I[b]=m(I[b])}return I.join(" ")},x=t.__arabicParser__.processArabic=t.processArabic=function(){var g,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var N=0;for(y=[],N=0;N<b.length;N+=1)Array.isArray(b[N])?y.push([f(b[N][0]),b[N][1],b[N][2]]):y.push([f(b[N])]);g=y}else g=f(b);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};t.events.push(["preProcessText",x])})(As.API),As.API.autoPrint=function(t){var s;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){s=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+s+" 0 R")}))}return this},(function(t){var s=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(o){l=o}}),Object.defineProperty(this,"parentNode",{})};s.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},s.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new s,this.canvas.pdf=this}])})(As.API),(function(t){var s={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},s),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var m=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(g){x=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,d){a.call(this);var c=(d=d||{}).fontSize||this.getFontSize(),m=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,f=0,x=0,g=0,b=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var y=d.maxWidth;y>0?typeof u=="string"?u=this.splitTextToSize(u,y):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce((function(j,S){return j.concat(b.splitTextToSize(S,y))}),[])):u=Array.isArray(u)?u:[u];for(var N=0;N<u.length;N++)f<(g=this.getStringUnitWidth(u[N],{font:m})*c)&&(f=g);return f!==0&&(x=u.length),{w:f/=h,h:Math.max((x*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/h,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||s;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=t.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var d=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,m=this.internal.__cell__.margins||s,h=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===u.lineNumber?(u.x=(d.x||0)+(d.width||0),u.y=d.y||0):d.y+d.height+u.height+m.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=m.top,f&&h&&(this.printHeaderRow(u.lineNumber,!0),u.y+=h[0].height)):u.y=d.y+d.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-c,u.y+c,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+c,{align:"center",baseline:"top",maxWidth:u.width-c-c}):this.text(u.text,u.x+c,u.y+c,{align:"left",baseline:"top",maxWidth:u.width-c-c})),this.internal.__cell__.lastCell=u,this};t.table=function(u,d,c,m,h){if(a.call(this),!c)throw new Error("No data for PDF table.");var f,x,g,b,y=[],N=[],j=[],S={},k={},P=[],I=[],B=(h=h||{}).autoSize||!1,q=h.printHeaders!==!1,Q=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,O=h.margins||Object.assign({width:this.getPageWidth()},s),T=typeof h.padding=="number"?h.padding:3,V=h.headerBackgroundColor||"#c8c8c8",D=h.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=q,this.internal.__cell__.margins=O,this.internal.__cell__.table_font_size=Q,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=D,this.setFontSize(Q),m==null)N=y=Object.keys(c[0]),j=y.map((function(){return"left"}));else if(Array.isArray(m)&&Gr(m[0])==="object")for(y=m.map((function(W){return W.name})),N=m.map((function(W){return W.prompt||W.name||""})),j=m.map((function(W){return W.align||"left"})),f=0;f<m.length;f+=1)k[m[f].name]=m[f].width*(19.049976/25.4);else Array.isArray(m)&&typeof m[0]=="string"&&(N=y=m,j=y.map((function(){return"left"})));if(B||Array.isArray(m)&&typeof m[0]=="string")for(f=0;f<y.length;f+=1){for(S[b=y[f]]=c.map((function(W){return W[b]})),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(N[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=S[b],this.setFont(void 0,"normal"),g=0;g<x.length;g+=1)P.push(this.getTextDimensions(x[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);k[b]=Math.max.apply(null,P)+T+T,P=[]}if(q){var Y={};for(f=0;f<y.length;f+=1)Y[y[f]]={},Y[y[f]].text=N[f],Y[y[f]].align=j[f];var M=o.call(this,Y,k);I=y.map((function(W){return new i(u,d,k[W],M,Y[W].text,void 0,Y[W].align)})),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var X=m.reduce((function(W,K){return W[K.name]=K.align,W}),{});for(f=0;f<c.length;f+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:f,data:c[f]},this);var R=o.call(this,c[f],k);for(g=0;g<y.length;g+=1){var H=c[f][y[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:f,col:g,data:H},this),l.call(this,new i(u,d,k[y[g]],R,H,f+2,X[y[g]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=d,this};var o=function(u,d){var c=this.internal.__cell__.padding,m=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(u).map((function(f){var x=u[f];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,d[f]-c-c)}),this).map((function(f){return this.getLineHeightFactor()*f.length*m/h+c+c}),this).reduce((function(f,x){return Math.max(f,x)}),0)};t.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,d){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var m=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(m[0],m[1],m[2],m[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){c=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(c.y=this.internal.__cell__.margins.top||0,h.push(c)),c.lineNumber=u;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,c),this.setTextColor(x)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}})(As.API);var c5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},d5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Wb=o5(d5),u5=[100,200,300,400,500,600,700,800,900],OL=o5(u5);function Gb(t){var s=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(i){return c5[i=i||"normal"]?i:"normal"})(t.style),a=(function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}})(t.weight),n=(function(i){return typeof Wb[i=i||"normal"]=="number"?i:"normal"})(t.stretch);return{family:s,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:s,style:[n,r,a].join(" ")}}}function bw(t,s,r,a){var n;for(n=r;n>=0&&n<s.length;n+=a)if(t[s[n]])return t[s[n]];for(n=r;n>=0&&n<s.length;n-=a)if(t[s[n]])return t[s[n]]}var QL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},yw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function jw(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function ML(t,s,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},QL,r.genericFontFamilies||{}),i=null,l=null,o=0;o<s.length;++o)if(n[(i=Gb(s[o])).family]&&(i.family=n[i.family]),t.hasOwnProperty(i.family)){l=t[i.family];break}if(!(l=l||t[a]))throw new Error("Could not find a font-family for the rule '"+jw(i)+"' and default family '"+a+"'.");if(l=(function(u,d){if(d[u])return d[u];var c=Wb[u],m=c<=Wb.normal?-1:1,h=bw(d,d5,c,m);if(!h)throw new Error("Could not find a matching font-stretch value for "+u);return h})(i.stretch,l),l=(function(u,d){if(d[u])return d[u];for(var c=c5[u],m=0;m<c.length;++m)if(d[c[m]])return d[c[m]];throw new Error("Could not find a matching font-style for "+u)})(i.style,l),!(l=(function(u,d){if(d[u])return d[u];if(u===400&&d[500])return d[500];if(u===500&&d[400])return d[400];var c=OL[u],m=bw(d,u5,c,u<400?-1:1);if(!m)throw new Error("Could not find a matching font-weight for value "+u);return m})(i.weight,l)))throw new Error("Failed to resolve a font for the rule '"+jw(i)+"'.");return l}function Nw(t){return t.trimLeft()}function HL(t,s){for(var r=0;r<t.length;){if(t.charAt(r)===s)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function qL(t){var s=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return s===null?null:[s[0],t.substring(s[0].length)]}var Dp,ww,_w,Sv=["times"];(function(t){var s,r,a,n,i,l,o,u,d,c=function(_){return _=_||{},this.isStrokeTransparent=_.isStrokeTransparent||!1,this.strokeOpacity=_.strokeOpacity||1,this.strokeStyle=_.strokeStyle||"#000000",this.fillStyle=_.fillStyle||"#000000",this.isFillTransparent=_.isFillTransparent||!1,this.fillOpacity=_.fillOpacity||1,this.font=_.font||"10px sans-serif",this.textBaseline=_.textBaseline||"alphabetic",this.textAlign=_.textAlign||"left",this.lineWidth=_.lineWidth||1,this.lineJoin=_.lineJoin||"miter",this.lineCap=_.lineCap||"butt",this.path=_.path||[],this.transform=_.transform!==void 0?_.transform.clone():new u,this.globalCompositeOperation=_.globalCompositeOperation||"normal",this.globalAlpha=_.globalAlpha||1,this.clip_path=_.clip_path||[],this.currentPoint=_.currentPoint||new l,this.miterLimit=_.miterLimit||10,this.lastPoint=_.lastPoint||new l,this.lineDashOffset=_.lineDashOffset||0,this.lineDash=_.lineDash||[],this.margin=_.margin||[0,0,0,0],this.prevPageLastElemOffset=_.prevPageLastElemOffset||0,this.ignoreClearRect=typeof _.ignoreClearRect!="boolean"||_.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new m(this),s=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,l=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,d=new c}]);var m=function(_){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var F=_;Object.defineProperty(this,"pdf",{get:function(){return F}});var E=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return E},set:function(ce){E=!!ce}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(ce){L=!!ce}});var U=0;Object.defineProperty(this,"posX",{get:function(){return U},set:function(ce){isNaN(ce)||(U=ce)}});var J=0;Object.defineProperty(this,"posY",{get:function(){return J},set:function(ce){isNaN(ce)||(J=ce)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(ce){var le;typeof ce=="number"?le=[ce,ce,ce,ce]:((le=new Array(4))[0]=ce[0],le[1]=ce.length>=2?ce[1]:le[0],le[2]=ce.length>=3?ce[2]:le[0],le[3]=ce.length>=4?ce[3]:le[1]),d.margin=le}});var ae=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ae},set:function(ce){ae=ce}});var Z=0;Object.defineProperty(this,"lastBreak",{get:function(){return Z},set:function(ce){Z=ce}});var oe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return oe},set:function(ce){oe=ce}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(ce){ce instanceof c&&(d=ce)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(ce){d.path=ce}});var ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return ee},set:function(ce){ee=ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ce){var le;le=h(ce),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ce){var le=h(ce);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ce){["butt","round","square"].indexOf(ce)!==-1&&(this.ctx.lineCap=ce,this.pdf.setLineCap(ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ce){isNaN(ce)||(this.ctx.lineWidth=ce,this.pdf.setLineWidth(ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ce){["bevel","round","miter"].indexOf(ce)!==-1&&(this.ctx.lineJoin=ce,this.pdf.setLineJoin(ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ce){isNaN(ce)||(this.ctx.miterLimit=ce,this.pdf.setMiterLimit(ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ce){this.ctx.textBaseline=ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ce){["right","end","center","left","start"].indexOf(ce)!==-1&&(this.ctx.textAlign=ce)}});var se=null;function Ae(ce,le){if(se===null){var _e=(function(Qe){var Ie=[];return Object.keys(Qe).forEach((function(ke){Qe[ke].forEach((function(pe){var he=null;switch(pe){case"bold":he={family:ke,weight:"bold"};break;case"italic":he={family:ke,style:"italic"};break;case"bolditalic":he={family:ke,weight:"bold",style:"italic"};break;case"":case"normal":he={family:ke}}he!==null&&(he.ref={name:ke,style:pe},Ie.push(he))}))})),Ie})(ce.getFontList());se=(function(Qe){for(var Ie={},ke=0;ke<Qe.length;++ke){var pe=Gb(Qe[ke]),he=pe.family,je=pe.stretch,me=pe.style,xe=pe.weight;Ie[he]=Ie[he]||{},Ie[he][je]=Ie[he][je]||{},Ie[he][je][me]=Ie[he][je][me]||{},Ie[he][je][me][xe]=pe}return Ie})(_e.concat(le))}return se}var we=null;Object.defineProperty(this,"fontFaces",{get:function(){return we},set:function(ce){se=null,we=ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ce){var le;if(this.ctx.font=ce,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ce))!==null){var _e=le[1],Qe=(le[2],le[3]),Ie=le[4],ke=(le[5],le[6]),pe=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ie)[2];Ie=Math.floor(pe==="px"?parseFloat(Ie)*this.pdf.internal.scaleFactor:pe==="em"?parseFloat(Ie)*this.pdf.getFontSize():parseFloat(Ie)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ie);var he=(function(We){var He,ze,Pe=[],Te=We.trim();if(Te==="")return Sv;if(Te in yw)return[yw[Te]];for(;Te!=="";){switch(ze=null,He=(Te=Nw(Te)).charAt(0)){case'"':case"'":ze=HL(Te.substring(1),He);break;default:ze=qL(Te)}if(ze===null||(Pe.push(ze[0]),(Te=Nw(ze[1]))!==""&&Te.charAt(0)!==","))return Sv;Te=Te.replace(/^,/,"")}return Pe})(ke);if(this.fontFaces){var je=ML(Ae(this.pdf,this.fontFaces),he.map((function(We){return{family:We,stretch:"normal",weight:Qe,style:_e}})));this.pdf.setFont(je.ref.name,je.ref.style)}else{var me="";(Qe==="bold"||parseInt(Qe,10)>=700||_e==="bold")&&(me="bold"),_e==="italic"&&(me+="italic"),me.length===0&&(me="normal");for(var xe="",Ue={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},ct=0;ct<he.length;ct++){if(this.pdf.internal.getFont(he[ct],me,{noFallback:!0,disableWarning:!0})!==void 0){xe=he[ct];break}if(me==="bolditalic"&&this.pdf.internal.getFont(he[ct],"bold",{noFallback:!0,disableWarning:!0})!==void 0)xe=he[ct],me="bold";else if(this.pdf.internal.getFont(he[ct],"normal",{noFallback:!0,disableWarning:!0})!==void 0){xe=he[ct],me="normal";break}}if(xe===""){for(var dt=0;dt<he.length;dt++)if(Ue[he[dt]]){xe=Ue[he[dt]];break}}xe=xe===""?"Times":xe,this.pdf.setFont(xe,me)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ce){this.ctx.globalCompositeOperation=ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ce){this.ctx.globalAlpha=ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ce){this.ctx.lineDashOffset=ce,K.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ce){this.ctx.lineDash=ce,K.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ce){this.ctx.ignoreClearRect=!!ce}})};m.prototype.setLineDash=function(_){this.lineDash=_},m.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},m.prototype.fill=function(){S.call(this,"fill",!1)},m.prototype.stroke=function(){S.call(this,"stroke",!1)},m.prototype.beginPath=function(){this.path=[{type:"begin"}]},m.prototype.moveTo=function(_,F){if(isNaN(_)||isNaN(F))throw ta.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var E=this.ctx.transform.applyToPoint(new l(_,F));this.path.push({type:"mt",x:E.x,y:E.y}),this.ctx.lastPoint=new l(_,F)},m.prototype.closePath=function(){var _=new l(0,0),F=0;for(F=this.path.length-1;F!==-1;F--)if(this.path[F].type==="begin"&&Gr(this.path[F+1])==="object"&&typeof this.path[F+1].x=="number"){_=new l(this.path[F+1].x,this.path[F+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(_.x,_.y)},m.prototype.lineTo=function(_,F){if(isNaN(_)||isNaN(F))throw ta.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var E=this.ctx.transform.applyToPoint(new l(_,F));this.path.push({type:"lt",x:E.x,y:E.y}),this.ctx.lastPoint=new l(E.x,E.y)},m.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},m.prototype.quadraticCurveTo=function(_,F,E,L){if(isNaN(E)||isNaN(L)||isNaN(_)||isNaN(F))throw ta.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var U=this.ctx.transform.applyToPoint(new l(E,L)),J=this.ctx.transform.applyToPoint(new l(_,F));this.path.push({type:"qct",x1:J.x,y1:J.y,x:U.x,y:U.y}),this.ctx.lastPoint=new l(U.x,U.y)},m.prototype.bezierCurveTo=function(_,F,E,L,U,J){if(isNaN(U)||isNaN(J)||isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L))throw ta.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ae=this.ctx.transform.applyToPoint(new l(U,J)),Z=this.ctx.transform.applyToPoint(new l(_,F)),oe=this.ctx.transform.applyToPoint(new l(E,L));this.path.push({type:"bct",x1:Z.x,y1:Z.y,x2:oe.x,y2:oe.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new l(ae.x,ae.y)},m.prototype.arc=function(_,F,E,L,U,J){if(isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L)||isNaN(U))throw ta.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(J=!!J,!this.ctx.transform.isIdentity){var ae=this.ctx.transform.applyToPoint(new l(_,F));_=ae.x,F=ae.y;var Z=this.ctx.transform.applyToPoint(new l(0,E)),oe=this.ctx.transform.applyToPoint(new l(0,0));E=Math.sqrt(Math.pow(Z.x-oe.x,2)+Math.pow(Z.y-oe.y,2))}Math.abs(U-L)>=2*Math.PI&&(L=0,U=2*Math.PI),this.path.push({type:"arc",x:_,y:F,radius:E,startAngle:L,endAngle:U,counterclockwise:J})},m.prototype.arcTo=function(_,F,E,L,U){throw new Error("arcTo not implemented.")},m.prototype.rect=function(_,F,E,L){if(isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L))throw ta.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(_,F),this.lineTo(_+E,F),this.lineTo(_+E,F+L),this.lineTo(_,F+L),this.lineTo(_,F),this.lineTo(_+E,F),this.lineTo(_,F)},m.prototype.fillRect=function(_,F,E,L){if(isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L))throw ta.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var U={};this.lineCap!=="butt"&&(U.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(U.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(_,F,E,L),this.fill(),U.hasOwnProperty("lineCap")&&(this.lineCap=U.lineCap),U.hasOwnProperty("lineJoin")&&(this.lineJoin=U.lineJoin)}},m.prototype.strokeRect=function(_,F,E,L){if(isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L))throw ta.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(_,F,E,L),this.stroke())},m.prototype.clearRect=function(_,F,E,L){if(isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L))throw ta.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(_,F,E,L))},m.prototype.save=function(_){_=typeof _!="boolean"||_;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,E=0;E<this.pdf.internal.getNumberOfPages();E++)this.pdf.setPage(E+1),this.pdf.internal.out("q");if(this.pdf.setPage(F),_){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},m.prototype.restore=function(_){_=typeof _!="boolean"||_;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,E=0;E<this.pdf.internal.getNumberOfPages();E++)this.pdf.setPage(E+1),this.pdf.internal.out("Q");this.pdf.setPage(F),_&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},m.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(_){var F,E,L,U;if(_.isCanvasGradient===!0&&(_=_.getColor()),!_)return{r:0,g:0,b:0,a:0,style:_};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(_))F=0,E=0,L=0,U=0;else{var J=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(_);if(J!==null)F=parseInt(J[1]),E=parseInt(J[2]),L=parseInt(J[3]),U=1;else if((J=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(_))!==null)F=parseInt(J[1]),E=parseInt(J[2]),L=parseInt(J[3]),U=parseFloat(J[4]);else{if(U=1,typeof _=="string"&&_.charAt(0)!=="#"){var ae=new s5(_);_=ae.ok?ae.toHex():"#000000"}_.length===4?(F=_.substring(1,2),F+=F,E=_.substring(2,3),E+=E,L=_.substring(3,4),L+=L):(F=_.substring(1,3),E=_.substring(3,5),L=_.substring(5,7)),F=parseInt(F,16),E=parseInt(E,16),L=parseInt(L,16)}}return{r:F,g:E,b:L,a:U,style:_}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};m.prototype.fillText=function(_,F,E,L){if(isNaN(F)||isNaN(E)||typeof _!="string")throw ta.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!f.call(this)){var U=R(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;T.call(this,{text:_,x:F,y:E,scale:J,angle:U,align:this.textAlign,maxWidth:L})}},m.prototype.strokeText=function(_,F,E,L){if(isNaN(F)||isNaN(E)||typeof _!="string")throw ta.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){L=isNaN(L)?void 0:L;var U=R(this.ctx.transform.rotation),J=this.ctx.transform.scaleX;T.call(this,{text:_,x:F,y:E,scale:J,renderingMode:"stroke",angle:U,align:this.textAlign,maxWidth:L})}},m.prototype.measureText=function(_){if(typeof _!="string")throw ta.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var F=this.pdf,E=this.pdf.internal.scaleFactor,L=F.internal.getFontSize(),U=F.getStringUnitWidth(_)*L/F.internal.scaleFactor,J=function(ae){var Z=(ae=ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Z}}),this};return new J({width:U*=Math.round(96*E/72*1e4)/1e4})},m.prototype.scale=function(_,F){if(isNaN(_)||isNaN(F))throw ta.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var E=new u(_,0,0,F,0,0);this.ctx.transform=this.ctx.transform.multiply(E)},m.prototype.rotate=function(_){if(isNaN(_))throw ta.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var F=new u(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),0,0);this.ctx.transform=this.ctx.transform.multiply(F)},m.prototype.translate=function(_,F){if(isNaN(_)||isNaN(F))throw ta.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var E=new u(1,0,0,1,_,F);this.ctx.transform=this.ctx.transform.multiply(E)},m.prototype.transform=function(_,F,E,L,U,J){if(isNaN(_)||isNaN(F)||isNaN(E)||isNaN(L)||isNaN(U)||isNaN(J))throw ta.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ae=new u(_,F,E,L,U,J);this.ctx.transform=this.ctx.transform.multiply(ae)},m.prototype.setTransform=function(_,F,E,L,U,J){_=isNaN(_)?1:_,F=isNaN(F)?0:F,E=isNaN(E)?0:E,L=isNaN(L)?1:L,U=isNaN(U)?0:U,J=isNaN(J)?0:J,this.ctx.transform=new u(_,F,E,L,U,J)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};m.prototype.drawImage=function(_,F,E,L,U,J,ae,Z,oe){var ee=this.pdf.getImageProperties(_),se=1,Ae=1,we=1,ce=1;L!==void 0&&Z!==void 0&&(we=Z/L,ce=oe/U,se=ee.width/L*Z/L,Ae=ee.height/U*oe/U),J===void 0&&(J=F,ae=E,F=0,E=0),L!==void 0&&Z===void 0&&(Z=L,oe=U),L===void 0&&Z===void 0&&(Z=ee.width,oe=ee.height);for(var le,_e=this.ctx.transform.decompose(),Qe=R(_e.rotate.shx),Ie=new u,ke=(Ie=(Ie=(Ie=Ie.multiply(_e.translate)).multiply(_e.skew)).multiply(_e.scale)).applyToRectangle(new o(J-F*we,ae-E*ce,L*se,U*Ae)),pe=b.call(this,ke),he=[],je=0;je<pe.length;je+=1)he.indexOf(pe[je])===-1&&he.push(pe[je]);if(j(he),this.autoPaging)for(var me=he[0],xe=he[he.length-1],Ue=me;Ue<xe+1;Ue++){this.pdf.setPage(Ue);var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],dt=Ue===1?this.posY+this.margin[0]:this.margin[0],We=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],He=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=Ue===1?0:We+(Ue-2)*He;if(this.ctx.clip_path.length!==0){var Pe=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(le,this.posX+this.margin[3],-ze+dt+this.ctx.prevPageLastElemOffset),k.call(this,"fill",!0),this.path=Pe}var Te=JSON.parse(JSON.stringify(ke));Te=N([Te],this.posX+this.margin[3],-ze+dt+this.ctx.prevPageLastElemOffset)[0];var Ke=(Ue>me||Ue<xe)&&g.call(this);Ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,He,null).clip().discardPath()),this.pdf.addImage(_,"JPEG",Te.x,Te.y,Te.w,Te.h,null,null,Qe),Ke&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(_,"JPEG",ke.x,ke.y,ke.w,ke.h,null,null,Qe)};var b=function(_,F,E){var L=[];F=F||this.pdf.internal.pageSize.width,E=E||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var U=this.posY+this.ctx.prevPageLastElemOffset;switch(_.type){default:case"mt":case"lt":L.push(Math.floor((_.y+U)/E)+1);break;case"arc":L.push(Math.floor((_.y+U-_.radius)/E)+1),L.push(Math.floor((_.y+U+_.radius)/E)+1);break;case"qct":var J=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x,_.y);L.push(Math.floor((J.y+U)/E)+1),L.push(Math.floor((J.y+J.h+U)/E)+1);break;case"bct":var ae=W(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x2,_.y2,_.x,_.y);L.push(Math.floor((ae.y+U)/E)+1),L.push(Math.floor((ae.y+ae.h+U)/E)+1);break;case"rect":L.push(Math.floor((_.y+U)/E)+1),L.push(Math.floor((_.y+_.h+U)/E)+1)}for(var Z=0;Z<L.length;Z+=1)for(;this.pdf.internal.getNumberOfPages()<L[Z];)y.call(this);return L},y=function(){var _=this.fillStyle,F=this.strokeStyle,E=this.font,L=this.lineCap,U=this.lineWidth,J=this.lineJoin;this.pdf.addPage(),this.fillStyle=_,this.strokeStyle=F,this.font=E,this.lineCap=L,this.lineWidth=U,this.lineJoin=J},N=function(_,F,E){for(var L=0;L<_.length;L++)switch(_[L].type){case"bct":_[L].x2+=F,_[L].y2+=E;case"qct":_[L].x1+=F,_[L].y1+=E;case"mt":case"lt":case"arc":default:_[L].x+=F,_[L].y+=E}return _},j=function(_){return _.sort((function(F,E){return F-E}))},S=function(_,F){for(var E,L,U=this.fillStyle,J=this.strokeStyle,ae=this.lineCap,Z=this.lineWidth,oe=Math.abs(Z*this.ctx.transform.scaleX),ee=this.lineJoin,se=JSON.parse(JSON.stringify(this.path)),Ae=JSON.parse(JSON.stringify(this.path)),we=[],ce=0;ce<Ae.length;ce++)if(Ae[ce].x!==void 0)for(var le=b.call(this,Ae[ce]),_e=0;_e<le.length;_e+=1)we.indexOf(le[_e])===-1&&we.push(le[_e]);for(var Qe=0;Qe<we.length;Qe++)for(;this.pdf.internal.getNumberOfPages()<we[Qe];)y.call(this);if(j(we),this.autoPaging)for(var Ie=we[0],ke=we[we.length-1],pe=Ie;pe<ke+1;pe++){this.pdf.setPage(pe),this.fillStyle=U,this.strokeStyle=J,this.lineCap=ae,this.lineWidth=oe,this.lineJoin=ee;var he=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],je=pe===1?this.posY+this.margin[0]:this.margin[0],me=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ue=pe===1?0:me+(pe-2)*xe;if(this.ctx.clip_path.length!==0){var ct=this.path;E=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(E,this.posX+this.margin[3],-Ue+je+this.ctx.prevPageLastElemOffset),k.call(this,_,!0),this.path=ct}if(L=JSON.parse(JSON.stringify(se)),this.path=N(L,this.posX+this.margin[3],-Ue+je+this.ctx.prevPageLastElemOffset),F===!1||pe===0){var dt=(pe>Ie||pe<ke)&&g.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],he,xe,null).clip().discardPath()),k.call(this,_,F),dt&&this.pdf.restoreGraphicsState()}this.lineWidth=Z}else this.lineWidth=oe,k.call(this,_,F),this.lineWidth=Z;this.path=se},k=function(_,F){if((_!=="stroke"||F||!x.call(this))&&(_==="stroke"||F||!f.call(this))){for(var E,L,U=[],J=this.path,ae=0;ae<J.length;ae++){var Z=J[ae];switch(Z.type){case"begin":U.push({begin:!0});break;case"close":U.push({close:!0});break;case"mt":U.push({start:Z,deltas:[],abs:[]});break;case"lt":var oe=U.length;if(J[ae-1]&&!isNaN(J[ae-1].x)&&(E=[Z.x-J[ae-1].x,Z.y-J[ae-1].y],oe>0)){for(;oe>=0;oe--)if(U[oe-1].close!==!0&&U[oe-1].begin!==!0){U[oe-1].deltas.push(E),U[oe-1].abs.push(Z);break}}break;case"bct":E=[Z.x1-J[ae-1].x,Z.y1-J[ae-1].y,Z.x2-J[ae-1].x,Z.y2-J[ae-1].y,Z.x-J[ae-1].x,Z.y-J[ae-1].y],U[U.length-1].deltas.push(E);break;case"qct":var ee=J[ae-1].x+2/3*(Z.x1-J[ae-1].x),se=J[ae-1].y+2/3*(Z.y1-J[ae-1].y),Ae=Z.x+2/3*(Z.x1-Z.x),we=Z.y+2/3*(Z.y1-Z.y),ce=Z.x,le=Z.y;E=[ee-J[ae-1].x,se-J[ae-1].y,Ae-J[ae-1].x,we-J[ae-1].y,ce-J[ae-1].x,le-J[ae-1].y],U[U.length-1].deltas.push(E);break;case"arc":U.push({deltas:[],abs:[],arc:!0}),Array.isArray(U[U.length-1].abs)&&U[U.length-1].abs.push(Z)}}L=F?null:_==="stroke"?"stroke":"fill";for(var _e=!1,Qe=0;Qe<U.length;Qe++)if(U[Qe].arc)for(var Ie=U[Qe].abs,ke=0;ke<Ie.length;ke++){var pe=Ie[ke];pe.type==="arc"?B.call(this,pe.x,pe.y,pe.radius,pe.startAngle,pe.endAngle,pe.counterclockwise,void 0,F,!_e):V.call(this,pe.x,pe.y),_e=!0}else if(U[Qe].close===!0)this.pdf.internal.out("h"),_e=!1;else if(U[Qe].begin!==!0){var he=U[Qe].start.x,je=U[Qe].start.y;D.call(this,U[Qe].deltas,he,je),_e=!0}L&&q.call(this,L),F&&Q.call(this)}},P=function(_){var F=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,E=F*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return _-E;case"top":return _+F-E;case"hanging":return _+F-2*E;case"middle":return _+F/2-E;case"ideographic":return _;case"alphabetic":default:return _}},I=function(_){return _+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};m.prototype.createLinearGradient=function(){var _=function(){};return _.colorStops=[],_.addColorStop=function(F,E){this.colorStops.push([F,E])},_.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},_.isCanvasGradient=!0,_},m.prototype.createPattern=function(){return this.createLinearGradient()},m.prototype.createRadialGradient=function(){return this.createLinearGradient()};var B=function(_,F,E,L,U,J,ae,Z,oe){for(var ee=M.call(this,E,L,U,J),se=0;se<ee.length;se++){var Ae=ee[se];se===0&&(oe?O.call(this,Ae.x1+_,Ae.y1+F):V.call(this,Ae.x1+_,Ae.y1+F)),Y.call(this,_,F,Ae.x2,Ae.y2,Ae.x3,Ae.y3,Ae.x4,Ae.y4)}Z?Q.call(this):q.call(this,ae)},q=function(_){switch(_){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Q=function(){this.pdf.clip(),this.pdf.discardPath()},O=function(_,F){this.pdf.internal.out(r(_)+" "+a(F)+" m")},T=function(_){var F;switch(_.align){case"right":case"end":F="right";break;case"center":F="center";break;case"left":case"start":default:F="left"}var E=this.pdf.getTextDimensions(_.text),L=P.call(this,_.y),U=I.call(this,L)-E.h,J=this.ctx.transform.applyToPoint(new l(_.x,L)),ae=this.ctx.transform.decompose(),Z=new u;Z=(Z=(Z=Z.multiply(ae.translate)).multiply(ae.skew)).multiply(ae.scale);for(var oe,ee,se,Ae=this.ctx.transform.applyToRectangle(new o(_.x,L,E.w,E.h)),we=Z.applyToRectangle(new o(_.x,U,E.w,E.h)),ce=b.call(this,we),le=[],_e=0;_e<ce.length;_e+=1)le.indexOf(ce[_e])===-1&&le.push(ce[_e]);if(j(le),this.autoPaging)for(var Qe=le[0],Ie=le[le.length-1],ke=Qe;ke<Ie+1;ke++){this.pdf.setPage(ke);var pe=ke===1?this.posY+this.margin[0]:this.margin[0],he=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],je=this.pdf.internal.pageSize.height-this.margin[2],me=je-this.margin[0],xe=this.pdf.internal.pageSize.width-this.margin[1],Ue=xe-this.margin[3],ct=ke===1?0:he+(ke-2)*me;if(this.ctx.clip_path.length!==0){var dt=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=N(oe,this.posX+this.margin[3],-1*ct+pe),k.call(this,"fill",!0),this.path=dt}var We=N([JSON.parse(JSON.stringify(we))],this.posX+this.margin[3],-ct+pe+this.ctx.prevPageLastElemOffset)[0];_.scale>=.01&&(ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ee*_.scale),se=this.lineWidth,this.lineWidth=se*_.scale);var He=this.autoPaging!=="text";if(He||We.y+We.h<=je){if(He||We.y>=pe&&We.x<=xe){var ze=He?_.text:this.pdf.splitTextToSize(_.text,_.maxWidth||xe-We.x)[0],Pe=N([JSON.parse(JSON.stringify(Ae))],this.posX+this.margin[3],-ct+pe+this.ctx.prevPageLastElemOffset)[0],Te=He&&(ke>Qe||ke<Ie)&&g.call(this);Te&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ue,me,null).clip().discardPath()),this.pdf.text(ze,Pe.x,Pe.y,{angle:_.angle,align:F,renderingMode:_.renderingMode}),Te&&this.pdf.restoreGraphicsState()}}else We.y<je&&(this.ctx.prevPageLastElemOffset+=je-We.y);_.scale>=.01&&(this.pdf.setFontSize(ee),this.lineWidth=se)}else _.scale>=.01&&(ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ee*_.scale),se=this.lineWidth,this.lineWidth=se*_.scale),this.pdf.text(_.text,J.x+this.posX,J.y+this.posY,{angle:_.angle,align:F,renderingMode:_.renderingMode,maxWidth:_.maxWidth}),_.scale>=.01&&(this.pdf.setFontSize(ee),this.lineWidth=se)},V=function(_,F,E,L){E=E||0,L=L||0,this.pdf.internal.out(r(_+E)+" "+a(F+L)+" l")},D=function(_,F,E){return this.pdf.lines(_,F,E,null,null)},Y=function(_,F,E,L,U,J,ae,Z){this.pdf.internal.out([s(n(E+_)),s(i(L+F)),s(n(U+_)),s(i(J+F)),s(n(ae+_)),s(i(Z+F)),"c"].join(" "))},M=function(_,F,E,L){for(var U=2*Math.PI,J=Math.PI/2;F>E;)F-=U;var ae=Math.abs(E-F);ae<U&&L&&(ae=U-ae);for(var Z=[],oe=L?-1:1,ee=F;ae>1e-5;){var se=ee+oe*Math.min(ae,J);Z.push(X.call(this,_,ee,se)),ae-=Math.abs(se-ee),ee=se}return Z},X=function(_,F,E){var L=(E-F)/2,U=_*Math.cos(L),J=_*Math.sin(L),ae=U,Z=-J,oe=ae*ae+Z*Z,ee=oe+ae*U+Z*J,se=4/3*(Math.sqrt(2*oe*ee)-ee)/(ae*J-Z*U),Ae=ae-se*Z,we=Z+se*ae,ce=Ae,le=-we,_e=L+F,Qe=Math.cos(_e),Ie=Math.sin(_e);return{x1:_*Math.cos(F),y1:_*Math.sin(F),x2:Ae*Qe-we*Ie,y2:Ae*Ie+we*Qe,x3:ce*Qe-le*Ie,y3:ce*Ie+le*Qe,x4:_*Math.cos(E),y4:_*Math.sin(E)}},R=function(_){return 180*_/Math.PI},H=function(_,F,E,L,U,J){var ae=_+.5*(E-_),Z=F+.5*(L-F),oe=U+.5*(E-U),ee=J+.5*(L-J),se=Math.min(_,U,ae,oe),Ae=Math.max(_,U,ae,oe),we=Math.min(F,J,Z,ee),ce=Math.max(F,J,Z,ee);return new o(se,we,Ae-se,ce-we)},W=function(_,F,E,L,U,J,ae,Z){var oe,ee,se,Ae,we,ce,le,_e,Qe,Ie,ke,pe,he,je,me=E-_,xe=L-F,Ue=U-E,ct=J-L,dt=ae-U,We=Z-J;for(ee=0;ee<41;ee++)Qe=(le=(se=_+(oe=ee/40)*me)+oe*((we=E+oe*Ue)-se))+oe*(we+oe*(U+oe*dt-we)-le),Ie=(_e=(Ae=F+oe*xe)+oe*((ce=L+oe*ct)-Ae))+oe*(ce+oe*(J+oe*We-ce)-_e),ee==0?(ke=Qe,pe=Ie,he=Qe,je=Ie):(ke=Math.min(ke,Qe),pe=Math.min(pe,Ie),he=Math.max(he,Qe),je=Math.max(je,Ie));return new o(Math.round(ke),Math.round(pe),Math.round(he-ke),Math.round(je-pe))},K=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var _,F,E=(_=this.ctx.lineDash,F=this.ctx.lineDashOffset,JSON.stringify({lineDash:_,lineDashOffset:F}));this.prevLineDash!==E&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=E)}}})(As.API),(function(t){var s=function(i){var l,o,u,d,c,m,h,f,x,g;for(o=[],u=0,d=(i+=l="\0\0\0\0".slice(i.length%4||4)).length;d>u;u+=4)(c=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(m=(c=((c=((c=((c=(c-(g=c%85))/85)-(x=c%85))/85)-(f=c%85))/85)-(h=c%85))/85)%85,o.push(m+33,h+33,f+33,x+33,g+33)):o.push(122);return(function(b,y){for(var N=y;N>0;N--)b.pop()})(o,l.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var l,o,u,d,c,m=String,h="length",f=255,x="charCodeAt",g="slice",b="replace";for(i[g](-2),i=i[g](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],d=0,c=(i+=l="uuuuu"[g](i[h]%5||5))[h];c>d;d+=5)o=52200625*(i[x](d)-33)+614125*(i[x](d+1)-33)+7225*(i[x](d+2)-33)+85*(i[x](d+3)-33)+(i[x](d+4)-33),u.push(f&o>>24,f&o>>16,f&o>>8,f&o);return(function(y,N){for(var j=N;j>0;j--)y.pop()})(u,l[h]),m.fromCharCode.apply(m,u)},a=function(i){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),l.test(i)===!1)return"";for(var o="",u=0;u<i.length;u+=2)o+=String.fromCharCode("0x"+(i[u]+i[u+1]));return o},n=function(i){for(var l=new Uint8Array(i.length),o=i.length;o--;)l[o]=i.charCodeAt(o);return i=(l=Mb(l)).reduce((function(u,d){return u+String.fromCharCode(d)}),"")};t.processDataByFilters=function(i,l){var o=0,u=i||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),o=0;o<l.length;o+=1)switch(l[o]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=s(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map((function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)})).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=n(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[o]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}})(As.API),(function(t){t.loadFile=function(s,r,a){return(function(n,i,l){i=i!==!1,l=typeof l=="function"?l:function(){};var o=void 0;try{o=(function(u,d,c){var m=new XMLHttpRequest,h=0,f=function(x){var g=x.length,b=[],y=String.fromCharCode;for(h=0;h<g;h+=1)b.push(y(255&x.charCodeAt(h)));return b.join("")};if(m.open("GET",u,!d),m.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(m.onload=function(){m.status===200?c(f(this.responseText)):c(void 0)}),m.send(null),d&&m.status===200)return f(m.responseText)})(n,i,l)}catch{}return o})(s,r,a)},t.loadImageFile=t.loadFile})(As.API),(function(t){function s(){return(zs.html2canvas?Promise.resolve(zs.html2canvas):Gx(()=>Promise.resolve().then(()=>FO),void 0)).catch((function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))})).then((function(l){return l.default?l.default:l}))}function r(){return(zs.DOMPurify?Promise.resolve(zs.DOMPurify):Gx(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch((function(l){return Promise.reject(new Error("Could not load dompurify: "+l))})).then((function(l){return l.default?l.default:l}))}var a=function(l){var o=Gr(l);return o==="undefined"?"undefined":o==="string"||l instanceof String?"string":o==="number"||l instanceof Number?"number":o==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":o==="object"?"object":"unknown"},n=function(l,o){var u=document.createElement(l);for(var d in o.className&&(u.className=o.className),o.innerHTML&&o.dompurify&&(u.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)u.style[d]=o.style[d];return u},i=function l(o){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return d=(d=d.setProgress(1,l,1,[l])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(l,o){return l.__proto__=o||i.prototype,l},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(l,o){return this.then((function(){switch(o=o||(function(u){switch(a(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l)){case"string":return this.then(r).then((function(u){return this.set({src:n("div",{innerHTML:l,dompurify:u})})}));case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}}))},i.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=(function u(d,c){for(var m=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),h=d.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||m.appendChild(u(h,c));return d.nodeType===1&&(d.nodeName==="CANVAS"?(m.width=d.width,m.height=d.height,m.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(m.value=d.value),m.addEventListener("load",(function(){m.scrollTop=d.scrollTop,m.scrollLeft=d.scrollLeft}),!0)),m})(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},i.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(s).then((function(o){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,o(this.prop.container,u)})).then((function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},i.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(s).then((function(o){var u=this.opt.jsPDF,d=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var f=d[h],x=f.src.find((function(g){return g.format==="truetype"}));x&&u.addFont(x.url,f.ref.name,f.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,u.context2d.save(!0),o(this.prop.container,m)})).then((function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l}))},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},i.prototype.output=function(l,o,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,o):this.outputPdf(l,o)},i.prototype.outputPdf=function(l,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(l,o)}))},i.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}}))},i.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},i.prototype.set=function(l){if(a(l)!=="object")return this;var o=Object.keys(l||{}).map((function(u){if(u in i.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}}),this);return this.then((function(){return this.thenList(o)}))},i.prototype.get=function(l,o){return this.then((function(){var u=l in i.template.prop?this.prop[l]:this.opt[l];return o?o(u):u}))},i.prototype.setMargin=function(l){return this.then((function(){switch(a(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l})).then(this.setPageSize)},i.prototype.setPageSize=function(l){function o(u,d){return Math.floor(u*d/72*96)}return this.then((function(){(l=l||As.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:o(l.inner.width,l.k),height:o(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l}))},i.prototype.setProgress=function(l,o,u,d){return l!=null&&(this.progress.val=l),o!=null&&(this.progress.state=o),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(l,o,u,d){return this.setProgress(l?this.progress.val+l:null,o||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},i.prototype.then=function(l,o){var u=this;return this.thenCore(l,o,(function(d,c){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,(function(m){return u.updateProgress(null,d),m})).then(d,c).then((function(m){return u.updateProgress(1),m}))}))},i.prototype.thenCore=function(l,o,u){u=u||Promise.prototype.then,l&&(l=l.bind(this)),o&&(o=o.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),c=u.call(d,l,o);return i.convert(c,this.__proto__)},i.prototype.thenExternal=function(l,o){return Promise.prototype.then.call(this,l,o)},i.prototype.thenList=function(l){var o=this;return l.forEach((function(u){o=o.thenCore(u)})),o},i.prototype.catch=function(l){l&&(l=l.bind(this));var o=Promise.prototype.catch.call(this,l);return i.convert(o,this)},i.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},i.prototype.error=function(l){return this.then((function(){throw new Error(l)}))},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,As.getPageSize=function(l,o,u){if(Gr(l)==="object"){var d=l;l=d.orientation,o=d.unit||o,u=d.format||u}o=o||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var c,m=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+o}var f,x=0,g=0;if(h.hasOwnProperty(m))x=h[m][1]/c,g=h[m][0]/c;else try{x=u[1],g=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",g>x&&(f=g,g=x,x=f);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",x>g&&(f=g,g=x,x=f)}return{width:g,height:x,unit:o,k:c,orientation:l}},t.html=function(l,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Gb):null;var u=new i(o);return o.worker?u:u.from(l).doCallback()}})(As.API),As.API.addJS=function(t){return _w=t,this.internal.events.subscribe("postPutResources",(function(){Dp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Dp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),ww=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+_w+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){Dp!==void 0&&ww!==void 0&&this.internal.out("/Names <</JavaScript "+Dp+" 0 R>>")})),this},(function(t){var s;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var l=n[i],o=a.exec(l);if(o!=null){var u=o[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,c=[];for(i=0;i<d;i++){var m=r.internal.newObject();c.push(m);var h=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<c.length;i++)r.internal.write("(page_"+(i+1)+")"+c[i]+" 0 R");r.internal.write(" ] >>","endobj"),s=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+s+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,i){var l={title:n,options:i,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var l=a.children[i];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var o=this.count=this.count_r({count:0},l);if(o>0&&this.line("/Count "+o),l.options&&l.options.pageNumber){var u=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<a.children.length;d++)this.renderItems(a.children[d])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var i=0;i<n.children.length;i++)a.count++,this.count_r(a,n.children[i]);return a.count}}])})(As.API),(function(t){var s=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,i,l,o){var u,d=this.decode.DCT_DECODE,c=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(u=(function(m){for(var h,f=256*m.charCodeAt(4)+m.charCodeAt(5),x=m.length,g={width:0,height:0,numcomponents:1},b=4;b<x;b+=2){if(b+=f,s.indexOf(m.charCodeAt(b+1))!==-1){h=256*m.charCodeAt(b+5)+m.charCodeAt(b+6),g={width:256*m.charCodeAt(b+7)+m.charCodeAt(b+8),height:h,numcomponents:m.charCodeAt(b+9)};break}f=256*m.charCodeAt(b+2)+m.charCodeAt(b+3)}return g})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}c={data:r,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:d,index:a,alias:n}}return c}})(As.API);var ZA,Pp,Sw,Cw,Bw,VL=(function(){var t,s,r;function a(i){var l,o,u,d,c,m,h,f,x,g,b,y,N,j;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},m=null;;){switch(l=this.readUInt32(),x=(function(){var S,k;for(k=[],S=0;S<4;++S)k.push(String.fromCharCode(this.data[this.pos++]));return k}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":m&&this.animation.frames.push(m),this.pos+=4,m={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),d=this.readUInt16()||100,m.delay=1e3*c/d,m.disposeOp=this.data[this.pos++],m.blendOp=this.data[this.pos++],m.data=[];break;case"IDAT":case"fdAT":for(x==="fdAT"&&(this.pos+=4,l-=4),i=(m!=null?m.data:void 0)||this.imgData,y=0;0<=l?y<l:y>l;0<=l?++y:--y)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((g=u-this.transparency.indexed.length)>0)for(N=0;0<=g?N<g:N>g;0<=g?++N:--N)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":h=(b=this.read(l)).indexOf(0),f=String.fromCharCode.apply(String,b.slice(0,h)),this.text[f]=String.fromCharCode.apply(String,b.slice(h+1));break;case"IEND":return m&&this.animation.frames.push(m),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(j=this.colorType)===4||j===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var l,o;for(o=[],l=0;0<=i?l<i:l>i;0<=i?++l:--l)o.push(this.data[this.pos++]);return o},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var l=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*l),u=0,d=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function c(m,h,f,x){var g,b,y,N,j,S,k,P,I,B,q,Q,O,T,V,D,Y,M,X,R,H,W=Math.ceil((d.width-m)/f),K=Math.ceil((d.height-h)/x),_=d.width==W&&d.height==K;for(T=l*W,Q=_?o:new Uint8Array(T*K),S=i.length,O=0,b=0;O<K&&u<S;){switch(i[u++]){case 0:for(N=Y=0;Y<T;N=Y+=1)Q[b++]=i[u++];break;case 1:for(N=M=0;M<T;N=M+=1)g=i[u++],j=N<l?0:Q[b-l],Q[b++]=(g+j)%256;break;case 2:for(N=X=0;X<T;N=X+=1)g=i[u++],y=(N-N%l)/l,V=O&&Q[(O-1)*T+y*l+N%l],Q[b++]=(V+g)%256;break;case 3:for(N=R=0;R<T;N=R+=1)g=i[u++],y=(N-N%l)/l,j=N<l?0:Q[b-l],V=O&&Q[(O-1)*T+y*l+N%l],Q[b++]=(g+Math.floor((j+V)/2))%256;break;case 4:for(N=H=0;H<T;N=H+=1)g=i[u++],y=(N-N%l)/l,j=N<l?0:Q[b-l],O===0?V=D=0:(V=Q[(O-1)*T+y*l+N%l],D=y&&Q[(O-1)*T+(y-1)*l+N%l]),k=j+V-D,P=Math.abs(k-j),B=Math.abs(k-V),q=Math.abs(k-D),I=P<=B&&P<=q?j:B<=q?V:D,Q[b++]=(g+I)%256;break;default:throw new Error("Invalid filter algorithm: "+i[u-1])}if(!_){var F=((h+O*x)*d.width+m)*l,E=O*T;for(N=0;N<W;N+=1){for(var L=0;L<l;L+=1)o[F++]=Q[E++];F+=(f-1)*l}}O++}}return i=jL(i),d.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),o},a.prototype.decodePalette=function(){var i,l,o,u,d,c,m,h,f;for(o=this.palette,c=this.transparency.indexed||[],d=new Uint8Array((c.length||0)+o.length),u=0,i=0,l=m=0,h=o.length;m<h;l=m+=3)d[u++]=o[l],d[u++]=o[l+1],d[u++]=o[l+2],d[u++]=(f=c[i++])!=null?f:255;return d},a.prototype.copyToImageData=function(i,l){var o,u,d,c,m,h,f,x,g,b,y;if(u=this.colors,g=null,o=this.hasAlphaChannel,this.palette.length&&(g=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),u=4,o=!0),x=(d=i.data||i).length,m=g||l,c=h=0,u===1)for(;c<x;)f=g?4*l[c/4]:h,b=m[f++],d[c++]=b,d[c++]=b,d[c++]=b,d[c++]=o?m[f++]:255,h=f;else for(;c<x;)f=g?4*l[c/4]:h,d[c++]=m[f++],d[c++]=m[f++],d[c++]=m[f++],d[c++]=o?m[f++]:255,h=f},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(zs)==="[object Window]"){try{s=zs.document.createElement("canvas"),r=s.getContext("2d")}catch{return!1}return!0}return!1};return n(),t=function(i){var l;if(n()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(l=new Image).src=s.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var l,o,u,d,c,m,h,f;if(this.animation){for(f=[],o=c=0,m=(h=this.animation.frames).length;c<m;o=++c)l=h[o],u=i.createImageData(l.width,l.height),d=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(u,d),l.imageData=u,f.push(l.image=t(u));return f}},a.prototype.renderFrame=function(i,l){var o,u,d;return o=(u=this.animation.frames)[l],d=u[l-1],l===0&&i.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?i.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&i.putImageData(d.imageData,d.xOffset,d.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},a.prototype.animate=function(i){var l,o,u,d,c,m,h=this;return o=0,m=this.animation,d=m.numFrames,u=m.frames,c=m.numPlays,(l=function(){var f,x;if(f=o++%d,x=u[f],h.renderFrame(i,f),d>1&&o/d<c)return h.animation._timeout=setTimeout(l,x.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var l,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,l=i.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(o=l.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),l.putImageData(o,0,0))},a})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function $L(t){var s=0;if(t[s++]!==71||t[s++]!==73||t[s++]!==70||t[s++]!==56||(t[s++]+1&253)!=56||t[s++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[s++]|t[s++]<<8,a=t[s++]|t[s++]<<8,n=t[s++],i=n>>7,l=1<<(7&n)+1;t[s++],t[s++];var o=null,u=null;i&&(o=s,u=l,s+=3*l);var d=!0,c=[],m=0,h=null,f=0,x=null;for(this.width=r,this.height=a;d&&s<t.length;)switch(t[s++]){case 33:switch(t[s++]){case 255:if(t[s]!==11||t[s+1]==78&&t[s+2]==69&&t[s+3]==84&&t[s+4]==83&&t[s+5]==67&&t[s+6]==65&&t[s+7]==80&&t[s+8]==69&&t[s+9]==50&&t[s+10]==46&&t[s+11]==48&&t[s+12]==3&&t[s+13]==1&&t[s+16]==0)s+=14,x=t[s++]|t[s++]<<8,s++;else for(s+=12;;){if(!((O=t[s++])>=0))throw Error("Invalid block size");if(O===0)break;s+=O}break;case 249:if(t[s++]!==4||t[s+4]!==0)throw new Error("Invalid graphics extension block.");var g=t[s++];m=t[s++]|t[s++]<<8,h=t[s++],(1&g)==0&&(h=null),f=g>>2&7,s++;break;case 254:for(;;){if(!((O=t[s++])>=0))throw Error("Invalid block size");if(O===0)break;s+=O}break;default:throw new Error("Unknown graphic control label: 0x"+t[s-1].toString(16))}break;case 44:var b=t[s++]|t[s++]<<8,y=t[s++]|t[s++]<<8,N=t[s++]|t[s++]<<8,j=t[s++]|t[s++]<<8,S=t[s++],k=S>>6&1,P=1<<(7&S)+1,I=o,B=u,q=!1;S>>7&&(q=!0,I=s,B=P,s+=3*P);var Q=s;for(s++;;){var O;if(!((O=t[s++])>=0))throw Error("Invalid block size");if(O===0)break;s+=O}c.push({x:b,y,width:N,height:j,has_local_palette:q,palette_offset:I,palette_size:B,data_offset:Q,data_length:s-Q,transparent_index:h,interlaced:!!k,delay:m,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[s-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return x},this.frameInfo=function(T){if(T<0||T>=c.length)throw new Error("Frame index out of range.");return c[T]},this.decodeAndBlitFrameBGRA=function(T,V){var D=this.frameInfo(T),Y=D.width*D.height,M=new Uint8Array(Y);kw(t,D.data_offset,M,Y);var X=D.palette_offset,R=D.transparent_index;R===null&&(R=256);var H=D.width,W=r-H,K=H,_=4*(D.y*r+D.x),F=4*((D.y+D.height)*r+D.x),E=_,L=4*W;D.interlaced===!0&&(L+=4*r*7);for(var U=8,J=0,ae=M.length;J<ae;++J){var Z=M[J];if(K===0&&(K=H,(E+=L)>=F&&(L=4*W+4*r*(U-1),E=_+(H+W)*(U<<1),U>>=1)),Z===R)E+=4;else{var oe=t[X+3*Z],ee=t[X+3*Z+1],se=t[X+3*Z+2];V[E++]=se,V[E++]=ee,V[E++]=oe,V[E++]=255}--K}},this.decodeAndBlitFrameRGBA=function(T,V){var D=this.frameInfo(T),Y=D.width*D.height,M=new Uint8Array(Y);kw(t,D.data_offset,M,Y);var X=D.palette_offset,R=D.transparent_index;R===null&&(R=256);var H=D.width,W=r-H,K=H,_=4*(D.y*r+D.x),F=4*((D.y+D.height)*r+D.x),E=_,L=4*W;D.interlaced===!0&&(L+=4*r*7);for(var U=8,J=0,ae=M.length;J<ae;++J){var Z=M[J];if(K===0&&(K=H,(E+=L)>=F&&(L=4*W+4*r*(U-1),E=_+(H+W)*(U<<1),U>>=1)),Z===R)E+=4;else{var oe=t[X+3*Z],ee=t[X+3*Z+1],se=t[X+3*Z+2];V[E++]=oe,V[E++]=ee,V[E++]=se,V[E++]=255}--K}}}function kw(t,s,r,a){for(var n=t[s++],i=1<<n,l=i+1,o=l+1,u=n+1,d=(1<<u)-1,c=0,m=0,h=0,f=t[s++],x=new Int32Array(4096),g=null;;){for(;c<16&&f!==0;)m|=t[s++]<<c,c+=8,f===1?f=t[s++]:--f;if(c<u)break;var b=m&d;if(m>>=u,c-=u,b!==i){if(b===l)break;for(var y=b<o?b:g,N=0,j=y;j>i;)j=x[j]>>8,++N;var S=j;if(h+N+(y!==b?1:0)>a)return void ta.log("Warning, gif stream longer than expected.");r[h++]=S;var k=h+=N;for(y!==b&&(r[h++]=S),j=y;N--;)j=x[j],r[--k]=255&j,j>>=8;g!==null&&o<4096&&(x[o++]=g<<8|S,o>=d+1&&u<12&&(++u,d=d<<1|1)),g=b}else o=l+1,d=(1<<(u=n+1))-1,g=null}return h!==a&&ta.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Cv(t){var s,r,a,n,i,l=Math.floor,o=new Array(64),u=new Array(64),d=new Array(64),c=new Array(64),m=new Array(65535),h=new Array(65535),f=new Array(64),x=new Array(64),g=[],b=0,y=7,N=new Array(64),j=new Array(64),S=new Array(64),k=new Array(256),P=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],B=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],Q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],O=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Y=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function M(_,F){for(var E=0,L=0,U=new Array,J=1;J<=16;J++){for(var ae=1;ae<=_[J];ae++)U[F[L]]=[],U[F[L]][0]=E,U[F[L]][1]=J,L++,E++;E*=2}return U}function X(_){for(var F=_[0],E=_[1]-1;E>=0;)F&1<<E&&(b|=1<<y),E--,--y<0&&(b==255?(R(255),R(0)):R(b),y=7,b=0)}function R(_){g.push(_)}function H(_){R(_>>8&255),R(255&_)}function W(_,F,E,L,U){for(var J,ae=U[0],Z=U[240],oe=(function(Ie,ke){var pe,he,je,me,xe,Ue,ct,dt,We,He,ze=0;for(We=0;We<8;++We){pe=Ie[ze],he=Ie[ze+1],je=Ie[ze+2],me=Ie[ze+3],xe=Ie[ze+4],Ue=Ie[ze+5],ct=Ie[ze+6];var Pe=pe+(dt=Ie[ze+7]),Te=pe-dt,Ke=he+ct,$e=he-ct,Ve=je+Ue,Ze=je-Ue,Re=me+xe,it=me-xe,lt=Pe+Re,Ne=Pe-Re,Xe=Ke+Ve,Ge=Ke-Ve;Ie[ze]=lt+Xe,Ie[ze+4]=lt-Xe;var at=.707106781*(Ge+Ne);Ie[ze+2]=Ne+at,Ie[ze+6]=Ne-at;var xt=.382683433*((lt=it+Ze)-(Ge=$e+Te)),wt=.5411961*lt+xt,pt=1.306562965*Ge+xt,ge=.707106781*(Xe=Ze+$e),rt=Te+ge,ht=Te-ge;Ie[ze+5]=ht+wt,Ie[ze+3]=ht-wt,Ie[ze+1]=rt+pt,Ie[ze+7]=rt-pt,ze+=8}for(ze=0,We=0;We<8;++We){pe=Ie[ze],he=Ie[ze+8],je=Ie[ze+16],me=Ie[ze+24],xe=Ie[ze+32],Ue=Ie[ze+40],ct=Ie[ze+48];var ft=pe+(dt=Ie[ze+56]),St=pe-dt,Je=he+ct,ts=he-ct,Kt=je+Ue,fe=je-Ue,Oe=me+xe,Se=me-xe,Le=ft+Oe,Ye=ft-Oe,st=Je+Kt,It=Je-Kt;Ie[ze]=Le+st,Ie[ze+32]=Le-st;var Ft=.707106781*(It+Ye);Ie[ze+16]=Ye+Ft,Ie[ze+48]=Ye-Ft;var Bt=.382683433*((Le=Se+fe)-(It=ts+St)),Tt=.5411961*Le+Bt,Me=1.306562965*It+Bt,Nt=.707106781*(st=fe+ts),Et=St+Nt,$t=St-Nt;Ie[ze+40]=$t+Tt,Ie[ze+24]=$t-Tt,Ie[ze+8]=Et+Me,Ie[ze+56]=Et-Me,ze++}for(We=0;We<64;++We)He=Ie[We]*ke[We],f[We]=He>0?He+.5|0:He-.5|0;return f})(_,F),ee=0;ee<64;++ee)x[I[ee]]=oe[ee];var se=x[0]-E;E=x[0],se==0?X(L[0]):(X(L[h[J=32767+se]]),X(m[J]));for(var Ae=63;Ae>0&&x[Ae]==0;)Ae--;if(Ae==0)return X(ae),E;for(var we,ce=1;ce<=Ae;){for(var le=ce;x[ce]==0&&ce<=Ae;)++ce;var _e=ce-le;if(_e>=16){we=_e>>4;for(var Qe=1;Qe<=we;++Qe)X(Z);_e&=15}J=32767+x[ce],X(U[(_e<<4)+h[J]]),X(m[J]),ce++}return Ae!=63&&X(ae),E}function K(_){_=Math.min(Math.max(_,1),100),i!=_&&((function(F){for(var E=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var U=l((E[L]*F+50)/100);U=Math.min(Math.max(U,1),255),o[I[L]]=U}for(var J=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ae=0;ae<64;ae++){var Z=l((J[ae]*F+50)/100);Z=Math.min(Math.max(Z,1),255),u[I[ae]]=Z}for(var oe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ee=0,se=0;se<8;se++)for(var Ae=0;Ae<8;Ae++)d[ee]=1/(o[I[ee]]*oe[se]*oe[Ae]*8),c[ee]=1/(u[I[ee]]*oe[se]*oe[Ae]*8),ee++})(_<50?Math.floor(5e3/_):Math.floor(200-2*_)),i=_)}this.encode=function(_,F){F&&K(F),g=new Array,b=0,y=7,H(65496),H(65504),H(16),R(74),R(70),R(73),R(70),R(0),R(1),R(1),R(0),H(1),H(1),R(0),R(0),(function(){H(65499),H(132),R(0);for(var he=0;he<64;he++)R(o[he]);R(1);for(var je=0;je<64;je++)R(u[je])})(),(function(he,je){H(65472),H(17),R(8),H(je),H(he),R(3),R(1),R(17),R(0),R(2),R(17),R(1),R(3),R(17),R(1)})(_.width,_.height),(function(){H(65476),H(418),R(0);for(var he=0;he<16;he++)R(B[he+1]);for(var je=0;je<=11;je++)R(q[je]);R(16);for(var me=0;me<16;me++)R(Q[me+1]);for(var xe=0;xe<=161;xe++)R(O[xe]);R(1);for(var Ue=0;Ue<16;Ue++)R(T[Ue+1]);for(var ct=0;ct<=11;ct++)R(V[ct]);R(17);for(var dt=0;dt<16;dt++)R(D[dt+1]);for(var We=0;We<=161;We++)R(Y[We])})(),H(65498),H(12),R(3),R(1),R(0),R(2),R(17),R(3),R(17),R(0),R(63),R(0);var E=0,L=0,U=0;b=0,y=7,this.encode.displayName="_encode_";for(var J,ae,Z,oe,ee,se,Ae,we,ce,le=_.data,_e=_.width,Qe=_.height,Ie=4*_e,ke=0;ke<Qe;){for(J=0;J<Ie;){for(ee=Ie*ke+J,Ae=-1,we=0,ce=0;ce<64;ce++)se=ee+(we=ce>>3)*Ie+(Ae=4*(7&ce)),ke+we>=Qe&&(se-=Ie*(ke+1+we-Qe)),J+Ae>=Ie&&(se-=J+Ae-Ie+4),ae=le[se++],Z=le[se++],oe=le[se++],N[ce]=(P[ae]+P[Z+256>>0]+P[oe+512>>0]>>16)-128,j[ce]=(P[ae+768>>0]+P[Z+1024>>0]+P[oe+1280>>0]>>16)-128,S[ce]=(P[ae+1280>>0]+P[Z+1536>>0]+P[oe+1792>>0]>>16)-128;E=W(N,d,E,s,a),L=W(j,c,L,r,n),U=W(S,c,U,r,n),J+=32}ke+=8}if(y>=0){var pe=[];pe[1]=y+1,pe[0]=(1<<y+1)-1,X(pe)}return H(65497),new Uint8Array(g)},t=t||50,(function(){for(var _=String.fromCharCode,F=0;F<256;F++)k[F]=_(F)})(),s=M(B,q),r=M(T,V),a=M(Q,O),n=M(D,Y),(function(){for(var _=1,F=2,E=1;E<=15;E++){for(var L=_;L<F;L++)h[32767+L]=E,m[32767+L]=[],m[32767+L][1]=E,m[32767+L][0]=L;for(var U=-(F-1);U<=-_;U++)h[32767+U]=E,m[32767+U]=[],m[32767+U][1]=E,m[32767+U][0]=F-1+U;_<<=1,F<<=1}})(),(function(){for(var _=0;_<256;_++)P[_]=19595*_,P[_+256>>0]=38470*_,P[_+512>>0]=7471*_+32768,P[_+768>>0]=-11059*_,P[_+1024>>0]=-21709*_,P[_+1280>>0]=32768*_+8421375,P[_+1536>>0]=-27439*_,P[_+1792>>0]=-5329*_})(),K(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function yo(t,s){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!s,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ew(t){function s(B){if(!B)throw Error("assert :P")}function r(B,q,Q){for(var O=0;4>O;O++)if(B[q+O]!=Q.charCodeAt(O))return!0;return!1}function a(B,q,Q,O,T){for(var V=0;V<T;V++)B[q+V]=Q[O+V]}function n(B,q,Q,O){for(var T=0;T<O;T++)B[q+T]=Q}function i(B){return new Int32Array(B)}function l(B,q){for(var Q=[],O=0;O<B;O++)Q.push(new q);return Q}function o(B,q){var Q=[];return(function O(T,V,D){for(var Y=D[V],M=0;M<Y&&(T.push(D.length>V+1?[]:new q),!(D.length<V+1));M++)O(T[M],V+1,D)})(Q,0,B),Q}var u=function(){var B=this;function q(C,z){for(var ie=1<<z-1>>>0;C&ie;)ie>>>=1;return ie?(C&ie-1)+ie:C}function Q(C,z,ie,ue,ve){s(!(ue%ie));do C[z+(ue-=ie)]=ve;while(0<ue)}function O(C,z,ie,ue,ve){if(s(2328>=ve),512>=ve)var Ce=i(512);else if((Ce=i(ve))==null)return 0;return(function(Fe,De,qe,et,vt,Dt){var Pt,kt,as=De,Gt=1<<qe,yt=i(16),jt=i(16);for(s(vt!=0),s(et!=null),s(Fe!=null),s(0<qe),kt=0;kt<vt;++kt){if(15<et[kt])return 0;++yt[et[kt]]}if(yt[0]==vt)return 0;for(jt[1]=0,Pt=1;15>Pt;++Pt){if(yt[Pt]>1<<Pt)return 0;jt[Pt+1]=jt[Pt]+yt[Pt]}for(kt=0;kt<vt;++kt)Pt=et[kt],0<et[kt]&&(Dt[jt[Pt]++]=kt);if(jt[15]==1)return(et=new T).g=0,et.value=Dt[0],Q(Fe,as,1,Gt,et),Gt;var Xt,Yt=-1,es=Gt-1,_s=0,vs=1,Rs=1,ys=1<<qe;for(kt=0,Pt=1,vt=2;Pt<=qe;++Pt,vt<<=1){if(vs+=Rs<<=1,0>(Rs-=yt[Pt]))return 0;for(;0<yt[Pt];--yt[Pt])(et=new T).g=Pt,et.value=Dt[kt++],Q(Fe,as+_s,vt,ys,et),_s=q(_s,Pt)}for(Pt=qe+1,vt=2;15>=Pt;++Pt,vt<<=1){if(vs+=Rs<<=1,0>(Rs-=yt[Pt]))return 0;for(;0<yt[Pt];--yt[Pt]){if(et=new T,(_s&es)!=Yt){for(as+=ys,Xt=1<<(Yt=Pt)-qe;15>Yt&&!(0>=(Xt-=yt[Yt]));)++Yt,Xt<<=1;Gt+=ys=1<<(Xt=Yt-qe),Fe[De+(Yt=_s&es)].g=Xt+qe,Fe[De+Yt].value=as-De-Yt}et.g=Pt-qe,et.value=Dt[kt++],Q(Fe,as+(_s>>qe),vt,ys,et),_s=q(_s,Pt)}}return vs!=2*jt[15]-1?0:Gt})(C,z,ie,ue,ve,Ce)}function T(){this.value=this.g=0}function V(){this.value=this.g=0}function D(){this.G=l(5,T),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(xa,V)}function Y(C,z,ie,ue){s(C!=null),s(z!=null),s(2147483648>ue),C.Ca=254,C.I=0,C.b=-8,C.Ka=0,C.oa=z,C.pa=ie,C.Jd=z,C.Yc=ie+ue,C.Zc=4<=ue?ie+ue-4+1:ie,J(C)}function M(C,z){for(var ie=0;0<z--;)ie|=Z(C,128)<<z;return ie}function X(C,z){var ie=M(C,z);return ae(C)?-ie:ie}function R(C,z,ie,ue){var ve,Ce=0;for(s(C!=null),s(z!=null),s(4294967288>ue),C.Sb=ue,C.Ra=0,C.u=0,C.h=0,4<ue&&(ue=4),ve=0;ve<ue;++ve)Ce+=z[ie+ve]<<8*ve;C.Ra=Ce,C.bb=ue,C.oa=z,C.pa=ie}function H(C){for(;8<=C.u&&C.bb<C.Sb;)C.Ra>>>=8,C.Ra+=C.oa[C.pa+C.bb]<<vd-8>>>0,++C.bb,C.u-=8;E(C)&&(C.h=1,C.u=0)}function W(C,z){if(s(0<=z),!C.h&&z<=gd){var ie=F(C)&xd[z];return C.u+=z,H(C),ie}return C.h=1,C.u=0}function K(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function _(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function F(C){return C.Ra>>>(C.u&vd-1)>>>0}function E(C){return s(C.bb<=C.Sb),C.h||C.bb==C.Sb&&C.u>vd}function L(C,z){C.u=z,C.h=E(C)}function U(C){C.u>=bd&&(s(C.u>=bd),H(C))}function J(C){s(C!=null&&C.oa!=null),C.pa<C.Zc?(C.I=(C.oa[C.pa++]|C.I<<8)>>>0,C.b+=8):(s(C!=null&&C.oa!=null),C.pa<C.Yc?(C.b+=8,C.I=C.oa[C.pa++]|C.I<<8):C.Ka?C.b=0:(C.I<<=8,C.b+=8,C.Ka=1))}function ae(C){return M(C,1)}function Z(C,z){var ie=C.Ca;0>C.b&&J(C);var ue=C.b,ve=ie*z>>>8,Ce=(C.I>>>ue>ve)+0;for(Ce?(ie-=ve,C.I-=ve+1<<ue>>>0):ie=ve+1,ue=ie,ve=0;256<=ue;)ve+=8,ue>>=8;return ue=7^ve+Tn[ue],C.b-=ue,C.Ca=(ie<<ue)-1,Ce}function oe(C,z,ie){C[z+0]=ie>>24&255,C[z+1]=ie>>16&255,C[z+2]=ie>>8&255,C[z+3]=ie>>0&255}function ee(C,z){return C[z+0]<<0|C[z+1]<<8}function se(C,z){return ee(C,z)|C[z+2]<<16}function Ae(C,z){return ee(C,z)|ee(C,z+2)<<16}function we(C,z){var ie=1<<z;return s(C!=null),s(0<z),C.X=i(ie),C.X==null?0:(C.Mb=32-z,C.Xa=z,1)}function ce(C,z){s(C!=null),s(z!=null),s(C.Xa==z.Xa),a(z.X,0,C.X,0,1<<z.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function _e(C,z,ie,ue){s(ie!=null),s(ue!=null);var ve=ie[0],Ce=ue[0];return ve==0&&(ve=(C*Ce+z/2)/z),Ce==0&&(Ce=(z*ve+C/2)/C),0>=ve||0>=Ce?0:(ie[0]=ve,ue[0]=Ce,1)}function Qe(C,z){return C+(1<<z)-1>>>z}function Ie(C,z){return((4278255360&C)+(4278255360&z)>>>0&4278255360)+((16711935&C)+(16711935&z)>>>0&16711935)>>>0}function ke(C,z){B[z]=function(ie,ue,ve,Ce,Fe,De,qe){var et;for(et=0;et<Fe;++et){var vt=B[C](De[qe+et-1],ve,Ce+et);De[qe+et]=Ie(ie[ue+et],vt)}}}function pe(){this.ud=this.hd=this.jd=0}function he(C,z){return((4278124286&(C^z))>>>1)+(C&z)>>>0}function je(C){return 0<=C&&256>C?C:0>C?0:255<C?255:void 0}function me(C,z){return je(C+(C-z+.5>>1))}function xe(C,z,ie){return Math.abs(z-ie)-Math.abs(C-ie)}function Ue(C,z,ie,ue,ve,Ce,Fe){for(ue=Ce[Fe-1],ie=0;ie<ve;++ie)Ce[Fe+ie]=ue=Ie(C[z+ie],ue)}function ct(C,z,ie,ue,ve){var Ce;for(Ce=0;Ce<ie;++Ce){var Fe=C[z+Ce],De=Fe>>8&255,qe=16711935&(qe=(qe=16711935&Fe)+((De<<16)+De));ue[ve+Ce]=(4278255360&Fe)+qe>>>0}}function dt(C,z){z.jd=C>>0&255,z.hd=C>>8&255,z.ud=C>>16&255}function We(C,z,ie,ue,ve,Ce){var Fe;for(Fe=0;Fe<ue;++Fe){var De=z[ie+Fe],qe=De>>>8,et=De,vt=255&(vt=(vt=De>>>16)+((C.jd<<24>>24)*(qe<<24>>24)>>>5));et=255&(et=(et=et+((C.hd<<24>>24)*(qe<<24>>24)>>>5))+((C.ud<<24>>24)*(vt<<24>>24)>>>5)),ve[Ce+Fe]=(4278255360&De)+(vt<<16)+et}}function He(C,z,ie,ue,ve){B[z]=function(Ce,Fe,De,qe,et,vt,Dt,Pt,kt){for(qe=Dt;qe<Pt;++qe)for(Dt=0;Dt<kt;++Dt)et[vt++]=ve(De[ue(Ce[Fe++])])},B[C]=function(Ce,Fe,De,qe,et,vt,Dt){var Pt=8>>Ce.b,kt=Ce.Ea,as=Ce.K[0],Gt=Ce.w;if(8>Pt)for(Ce=(1<<Ce.b)-1,Gt=(1<<Pt)-1;Fe<De;++Fe){var yt,jt=0;for(yt=0;yt<kt;++yt)yt&Ce||(jt=ue(qe[et++])),vt[Dt++]=ve(as[jt&Gt]),jt>>=Pt}else B["VP8LMapColor"+ie](qe,et,as,Gt,vt,Dt,Fe,De,kt)}}function ze(C,z,ie,ue,ve){for(ie=z+ie;z<ie;){var Ce=C[z++];ue[ve++]=Ce>>16&255,ue[ve++]=Ce>>8&255,ue[ve++]=Ce>>0&255}}function Pe(C,z,ie,ue,ve){for(ie=z+ie;z<ie;){var Ce=C[z++];ue[ve++]=Ce>>16&255,ue[ve++]=Ce>>8&255,ue[ve++]=Ce>>0&255,ue[ve++]=Ce>>24&255}}function Te(C,z,ie,ue,ve){for(ie=z+ie;z<ie;){var Ce=(Fe=C[z++])>>16&240|Fe>>12&15,Fe=Fe>>0&240|Fe>>28&15;ue[ve++]=Ce,ue[ve++]=Fe}}function Ke(C,z,ie,ue,ve){for(ie=z+ie;z<ie;){var Ce=(Fe=C[z++])>>16&248|Fe>>13&7,Fe=Fe>>5&224|Fe>>3&31;ue[ve++]=Ce,ue[ve++]=Fe}}function $e(C,z,ie,ue,ve){for(ie=z+ie;z<ie;){var Ce=C[z++];ue[ve++]=Ce>>0&255,ue[ve++]=Ce>>8&255,ue[ve++]=Ce>>16&255}}function Ve(C,z,ie,ue,ve,Ce){if(Ce==0)for(ie=z+ie;z<ie;)oe(ue,((Ce=C[z++])[0]>>24|Ce[1]>>8&65280|Ce[2]<<8&16711680|Ce[3]<<24)>>>0),ve+=32;else a(ue,ve,C,z,ie)}function Ze(C,z){B[z][0]=B[C+"0"],B[z][1]=B[C+"1"],B[z][2]=B[C+"2"],B[z][3]=B[C+"3"],B[z][4]=B[C+"4"],B[z][5]=B[C+"5"],B[z][6]=B[C+"6"],B[z][7]=B[C+"7"],B[z][8]=B[C+"8"],B[z][9]=B[C+"9"],B[z][10]=B[C+"10"],B[z][11]=B[C+"11"],B[z][12]=B[C+"12"],B[z][13]=B[C+"13"],B[z][14]=B[C+"0"],B[z][15]=B[C+"0"]}function Re(C){return C==Sd||C==Sc||C==Tu||C==Iu}function it(){this.eb=[],this.size=this.A=this.fb=0}function lt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ne(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new it,this.f.kb=new lt,this.sd=null}function Xe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ge(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function at(C){return alert("todo:WebPSamplerProcessPlane"),C.T}function xt(C,z){var ie=C.T,ue=z.ba.f.RGBA,ve=ue.eb,Ce=ue.fb+C.ka*ue.A,Fe=Jn[z.ba.S],De=C.y,qe=C.O,et=C.f,vt=C.N,Dt=C.ea,Pt=C.W,kt=z.cc,as=z.dc,Gt=z.Mc,yt=z.Nc,jt=C.ka,Xt=C.ka+C.T,Yt=C.U,es=Yt+1>>1;for(jt==0?Fe(De,qe,null,null,et,vt,Dt,Pt,et,vt,Dt,Pt,ve,Ce,null,null,Yt):(Fe(z.ec,z.fc,De,qe,kt,as,Gt,yt,et,vt,Dt,Pt,ve,Ce-ue.A,ve,Ce,Yt),++ie);jt+2<Xt;jt+=2)kt=et,as=vt,Gt=Dt,yt=Pt,vt+=C.Rc,Pt+=C.Rc,Ce+=2*ue.A,Fe(De,(qe+=2*C.fa)-C.fa,De,qe,kt,as,Gt,yt,et,vt,Dt,Pt,ve,Ce-ue.A,ve,Ce,Yt);return qe+=C.fa,C.j+Xt<C.o?(a(z.ec,z.fc,De,qe,Yt),a(z.cc,z.dc,et,vt,es),a(z.Mc,z.Nc,Dt,Pt,es),ie--):1&Xt||Fe(De,qe,null,null,et,vt,Dt,Pt,et,vt,Dt,Pt,ve,Ce+ue.A,null,null,Yt),ie}function wt(C,z,ie){var ue=C.F,ve=[C.J];if(ue!=null){var Ce=C.U,Fe=z.ba.S,De=Fe==Fu||Fe==Tu;z=z.ba.f.RGBA;var qe=[0],et=C.ka;qe[0]=C.T,C.Kb&&(et==0?--qe[0]:(--et,ve[0]-=C.width),C.j+C.ka+C.T==C.o&&(qe[0]=C.o-C.j-et));var vt=z.eb;et=z.fb+et*z.A,C=Lr(ue,ve[0],C.width,Ce,qe,vt,et+(De?0:3),z.A),s(ie==qe),C&&Re(Fe)&&Yn(vt,et,De,Ce,qe,z.A)}return 0}function pt(C){var z=C.ma,ie=z.ba.S,ue=11>ie,ve=ie==Wo||ie==Eu||ie==Fu||ie==qr||ie==12||Re(ie);if(z.memory=null,z.Ib=null,z.Jb=null,z.Nd=null,!fd(z.Oa,C,ve?11:12))return 0;if(ve&&Re(ie)&&os(),C.da)alert("todo:use_scaling");else{if(ue){if(z.Ib=at,C.Kb){if(ie=C.U+1>>1,z.memory=i(C.U+2*ie),z.memory==null)return 0;z.ec=z.memory,z.fc=0,z.cc=z.ec,z.dc=z.fc+C.U,z.Mc=z.cc,z.Nc=z.dc+ie,z.Ib=xt,os()}}else alert("todo:EmitYUV");ve&&(z.Jb=wt,ue&&Lt())}if(ue&&!An){for(C=0;256>C;++C)Zn[C]=89858*(C-128)+dl>>oo,ei[C]=-22014*(C-128)+dl,Ed[C]=-45773*(C-128),Ec[C]=113618*(C-128)+dl>>oo;for(C=Dr;C<Ur;++C)z=76283*(C-16)+dl>>oo,PA[C-Dr]=wi(z,255),Yf[C-Dr]=wi(z+8>>4,15);An=1}return 1}function ge(C){var z=C.ma,ie=C.U,ue=C.T;return s(!(1&C.ka)),0>=ie||0>=ue?0:(ie=z.Ib(C,z),z.Jb!=null&&z.Jb(C,z,ie),z.Dc+=ie,1)}function rt(C){C.ma.memory=null}function ht(C,z,ie,ue){return W(C,8)!=47?0:(z[0]=W(C,14)+1,ie[0]=W(C,14)+1,ue[0]=W(C,1),W(C,3)!=0?0:!C.h)}function ft(C,z){if(4>C)return C+1;var ie=C-2>>1;return(2+(1&C)<<ie)+W(z,ie)+1}function St(C,z){return 120<z?z-120:1<=(ie=((ie=hg[z-1])>>4)*C+(8-(15&ie)))?ie:1;var ie}function Je(C,z,ie){var ue=F(ie),ve=C[z+=255&ue].g-8;return 0<ve&&(L(ie,ie.u+8),ue=F(ie),z+=C[z].value,z+=ue&(1<<ve)-1),L(ie,ie.u+C[z].g),C[z].value}function ts(C,z,ie){return ie.g+=C.g,ie.value+=C.value<<z>>>0,s(8>=ie.g),C.g}function Kt(C,z,ie){var ue=C.xc;return s((z=ue==0?0:C.vc[C.md*(ie>>ue)+(z>>ue)])<C.Wb),C.Ya[z]}function fe(C,z,ie,ue){var ve=C.ab,Ce=C.c*z,Fe=C.C;z=Fe+z;var De=ie,qe=ue;for(ue=C.Ta,ie=C.Ua;0<ve--;){var et=C.gc[ve],vt=Fe,Dt=z,Pt=De,kt=qe,as=(qe=ue,De=ie,et.Ea);switch(s(vt<Dt),s(Dt<=et.nc),et.hc){case 2:FA(Pt,kt,(Dt-vt)*as,qe,De);break;case 0:var Gt=vt,yt=Dt,jt=qe,Xt=De,Yt=(ys=et).Ea;Gt==0&&(bc(Pt,kt,null,null,1,jt,Xt),Ue(Pt,kt+1,0,0,Yt-1,jt,Xt+1),kt+=Yt,Xt+=Yt,++Gt);for(var es=1<<ys.b,_s=es-1,vs=Qe(Yt,ys.b),Rs=ys.K,ys=ys.w+(Gt>>ys.b)*vs;Gt<yt;){var vr=Rs,br=ys,fr=1;for(eo(Pt,kt,jt,Xt-Yt,1,jt,Xt);fr<Yt;){var ar=(fr&~_s)+es;ar>Yt&&(ar=Yt),(0,Bl[vr[br++]>>8&15])(Pt,kt+ +fr,jt,Xt+fr-Yt,ar-fr,jt,Xt+fr),fr=ar}kt+=Yt,Xt+=Yt,++Gt&_s||(ys+=vs)}Dt!=et.nc&&a(qe,De-as,qe,De+(Dt-vt-1)*as,as);break;case 1:for(as=Pt,yt=kt,Yt=(Pt=et.Ea)-(Xt=Pt&~(jt=(kt=1<<et.b)-1)),Gt=Qe(Pt,et.b),es=et.K,et=et.w+(vt>>et.b)*Gt;vt<Dt;){for(_s=es,vs=et,Rs=new pe,ys=yt+Xt,vr=yt+Pt;yt<ys;)dt(_s[vs++],Rs),qo(Rs,as,yt,kt,qe,De),yt+=kt,De+=kt;yt<vr&&(dt(_s[vs++],Rs),qo(Rs,as,yt,Yt,qe,De),yt+=Yt,De+=Yt),++vt&jt||(et+=Gt)}break;case 3:if(Pt==qe&&kt==De&&0<et.b){for(yt=qe,Pt=as=De+(Dt-vt)*as-(Xt=(Dt-vt)*Qe(et.Ea,et.b)),kt=qe,jt=De,Gt=[],Xt=(Yt=Xt)-1;0<=Xt;--Xt)Gt[Xt]=kt[jt+Xt];for(Xt=Yt-1;0<=Xt;--Xt)yt[Pt+Xt]=Gt[Xt];In(et,vt,Dt,qe,as,qe,De)}else In(et,vt,Dt,Pt,kt,qe,De)}De=ue,qe=ie}qe!=ie&&a(ue,ie,De,qe,Ce)}function Oe(C,z){var ie=C.V,ue=C.Ba+C.c*C.C,ve=z-C.C;if(s(z<=C.l.o),s(16>=ve),0<ve){var Ce=C.l,Fe=C.Ta,De=C.Ua,qe=Ce.width;if(fe(C,ve,ie,ue),ve=De=[De],s((ie=C.C)<(ue=z)),s(Ce.v<Ce.va),ue>Ce.o&&(ue=Ce.o),ie<Ce.j){var et=Ce.j-ie;ie=Ce.j,ve[0]+=et*qe}if(ie>=ue?ie=0:(ve[0]+=4*Ce.v,Ce.ka=ie-Ce.j,Ce.U=Ce.va-Ce.v,Ce.T=ue-ie,ie=1),ie){if(De=De[0],11>(ie=C.ca).S){var vt=ie.f.RGBA,Dt=(ue=ie.S,ve=Ce.U,Ce=Ce.T,et=vt.eb,vt.A),Pt=Ce;for(vt=vt.fb+C.Ma*vt.A;0<Pt--;){var kt=Fe,as=De,Gt=ve,yt=et,jt=vt;switch(ue){case TA:Ln(kt,as,Gt,yt,jt);break;case Wo:vn(kt,as,Gt,yt,jt);break;case Sd:vn(kt,as,Gt,yt,jt),Yn(yt,jt,0,Gt,1,0);break;case $f:so(kt,as,Gt,yt,jt);break;case Eu:Ve(kt,as,Gt,yt,jt,1);break;case Sc:Ve(kt,as,Gt,yt,jt,1),Yn(yt,jt,0,Gt,1,0);break;case Fu:Ve(kt,as,Gt,yt,jt,0);break;case Tu:Ve(kt,as,Gt,yt,jt,0),Yn(yt,jt,1,Gt,1,0);break;case qr:Vo(kt,as,Gt,yt,jt);break;case Iu:Vo(kt,as,Gt,yt,jt),Hr(yt,jt,Gt,1,0);break;case IA:to(kt,as,Gt,yt,jt);break;default:s(0)}De+=qe,vt+=Dt}C.Ma+=Ce}else alert("todo:EmitRescaledRowsYUVA");s(C.Ma<=ie.height)}}C.C=z,s(C.C<=C.i)}function Se(C){var z;if(0<C.ua)return 0;for(z=0;z<C.Wb;++z){var ie=C.Ya[z].G,ue=C.Ya[z].H;if(0<ie[1][ue[1]+0].g||0<ie[2][ue[2]+0].g||0<ie[3][ue[3]+0].g)return 0}return 1}function Le(C,z,ie,ue,ve,Ce){if(C.Z!=0){var Fe=C.qd,De=C.rd;for(s(yn[C.Z]!=null);z<ie;++z)yn[C.Z](Fe,De,ue,ve,ue,ve,Ce),Fe=ue,De=ve,ve+=Ce;C.qd=Fe,C.rd=De}}function Ye(C,z){var ie=C.l.ma,ue=ie.Z==0||ie.Z==1?C.l.j:C.C;if(ue=C.C<ue?ue:C.C,s(z<=C.l.o),z>ue){var ve=C.l.width,Ce=ie.ca,Fe=ie.tb+ve*ue,De=C.V,qe=C.Ba+C.c*ue,et=C.gc;s(C.ab==1),s(et[0].hc==3),Cu(et[0],ue,z,De,qe,Ce,Fe),Le(ie,ue,z,Ce,Fe,ve)}C.C=C.Ma=z}function st(C,z,ie,ue,ve,Ce,Fe){var De=C.$/ue,qe=C.$%ue,et=C.m,vt=C.s,Dt=ie+C.$,Pt=Dt;ve=ie+ue*ve;var kt=ie+ue*Ce,as=280+vt.ua,Gt=C.Pb?De:16777216,yt=0<vt.ua?vt.Wa:null,jt=vt.wc,Xt=Dt<kt?Kt(vt,qe,De):null;s(C.C<Ce),s(kt<=ve);var Yt=!1;e:for(;;){for(;Yt||Dt<kt;){var es=0;if(De>=Gt){var _s=Dt-ie;s((Gt=C).Pb),Gt.wd=Gt.m,Gt.xd=_s,0<Gt.s.ua&&ce(Gt.s.Wa,Gt.s.vb),Gt=De+DA}if(qe&jt||(Xt=Kt(vt,qe,De)),s(Xt!=null),Xt.Qb&&(z[Dt]=Xt.qb,Yt=!0),!Yt)if(U(et),Xt.jc){es=et,_s=z;var vs=Dt,Rs=Xt.pd[F(es)&xa-1];s(Xt.jc),256>Rs.g?(L(es,es.u+Rs.g),_s[vs]=Rs.value,es=0):(L(es,es.u+Rs.g-256),s(256<=Rs.value),es=Rs.value),es==0&&(Yt=!0)}else es=Je(Xt.G[0],Xt.H[0],et);if(et.h)break;if(Yt||256>es){if(!Yt)if(Xt.nd)z[Dt]=(Xt.qb|es<<8)>>>0;else{if(U(et),Yt=Je(Xt.G[1],Xt.H[1],et),U(et),_s=Je(Xt.G[2],Xt.H[2],et),vs=Je(Xt.G[3],Xt.H[3],et),et.h)break;z[Dt]=(vs<<24|Yt<<16|es<<8|_s)>>>0}if(Yt=!1,++Dt,++qe>=ue&&(qe=0,++De,Fe!=null&&De<=Ce&&!(De%16)&&Fe(C,De),yt!=null))for(;Pt<Dt;)es=z[Pt++],yt.X[(506832829*es&4294967295)>>>yt.Mb]=es}else if(280>es){if(es=ft(es-256,et),_s=Je(Xt.G[4],Xt.H[4],et),U(et),_s=St(ue,_s=ft(_s,et)),et.h)break;if(Dt-ie<_s||ve-Dt<es)break e;for(vs=0;vs<es;++vs)z[Dt+vs]=z[Dt+vs-_s];for(Dt+=es,qe+=es;qe>=ue;)qe-=ue,++De,Fe!=null&&De<=Ce&&!(De%16)&&Fe(C,De);if(s(Dt<=ve),qe&jt&&(Xt=Kt(vt,qe,De)),yt!=null)for(;Pt<Dt;)es=z[Pt++],yt.X[(506832829*es&4294967295)>>>yt.Mb]=es}else{if(!(es<as))break e;for(Yt=es-280,s(yt!=null);Pt<Dt;)es=z[Pt++],yt.X[(506832829*es&4294967295)>>>yt.Mb]=es;es=Dt,s(!(Yt>>>(_s=yt).Xa)),z[es]=_s.X[Yt],Yt=!0}Yt||s(et.h==E(et))}if(C.Pb&&et.h&&Dt<ve)s(C.m.h),C.a=5,C.m=C.wd,C.$=C.xd,0<C.s.ua&&ce(C.s.vb,C.s.Wa);else{if(et.h)break e;Fe!=null&&Fe(C,De>Ce?Ce:De),C.a=0,C.$=Dt-ie}return 1}return C.a=3,0}function It(C){s(C!=null),C.vc=null,C.yc=null,C.Ya=null;var z=C.Wa;z!=null&&(z.X=null),C.vb=null,s(C!=null)}function Ft(){var C=new Kh;return C==null?null:(C.a=0,C.xb=Bd,Ze("Predictor","VP8LPredictors"),Ze("Predictor","VP8LPredictors_C"),Ze("PredictorAdd","VP8LPredictorsAdd"),Ze("PredictorAdd","VP8LPredictorsAdd_C"),FA=ct,qo=We,Ln=ze,vn=Pe,Vo=Te,to=Ke,so=$e,B.VP8LMapColor32b=yd,B.VP8LMapColor8b=jd,C)}function Bt(C,z,ie,ue,ve){var Ce=1,Fe=[C],De=[z],qe=ue.m,et=ue.s,vt=null,Dt=0;e:for(;;){if(ie)for(;Ce&&W(qe,1);){var Pt=Fe,kt=De,as=ue,Gt=1,yt=as.m,jt=as.gc[as.ab],Xt=W(yt,2);if(as.Oc&1<<Xt)Ce=0;else{switch(as.Oc|=1<<Xt,jt.hc=Xt,jt.Ea=Pt[0],jt.nc=kt[0],jt.K=[null],++as.ab,s(4>=as.ab),Xt){case 0:case 1:jt.b=W(yt,3)+2,Gt=Bt(Qe(jt.Ea,jt.b),Qe(jt.nc,jt.b),0,as,jt.K),jt.K=jt.K[0];break;case 3:var Yt,es=W(yt,8)+1,_s=16<es?0:4<es?1:2<es?2:3;if(Pt[0]=Qe(jt.Ea,_s),jt.b=_s,Yt=Gt=Bt(es,1,0,as,jt.K)){var vs,Rs=es,ys=jt,vr=1<<(8>>ys.b),br=i(vr);if(br==null)Yt=0;else{var fr=ys.K[0],ar=ys.w;for(br[0]=ys.K[0][0],vs=1;vs<1*Rs;++vs)br[vs]=Ie(fr[ar+vs],br[vs-1]);for(;vs<4*vr;++vs)br[vs]=0;ys.K[0]=null,ys.K[0]=br,Yt=1}}Gt=Yt;break;case 2:break;default:s(0)}Ce=Gt}}if(Fe=Fe[0],De=De[0],Ce&&W(qe,1)&&!(Ce=1<=(Dt=W(qe,4))&&11>=Dt)){ue.a=3;break e}var Pr;if(Pr=Ce)t:{var Rr,Xs,la,Un=ue,Na=Fe,Ma=De,kr=Dt,jn=ie,Nn=Un.m,oa=Un.s,Ha=[null],hn=1,ti=0,Vi=Gf[kr];s:for(;;){if(jn&&W(Nn,1)){var ca=W(Nn,3)+2,Ia=Qe(Na,ca),Ci=Qe(Ma,ca),zo=Ia*Ci;if(!Bt(Ia,Ci,0,Un,Ha))break s;for(Ha=Ha[0],oa.xc=ca,Rr=0;Rr<zo;++Rr){var uo=Ha[Rr]>>8&65535;Ha[Rr]=uo,uo>=hn&&(hn=uo+1)}}if(Nn.h)break s;for(Xs=0;5>Xs;++Xs){var Er=Cc[Xs];!Xs&&0<kr&&(Er+=1<<kr),ti<Er&&(ti=Er)}var Il=l(hn*Vi,T),UA=hn,em=l(UA,D);if(em==null)var $i=null;else s(65536>=UA),$i=em;var Wi=i(ti);if($i==null||Wi==null||Il==null){Un.a=1;break s}var Tc=Il;for(Rr=la=0;Rr<hn;++Rr){var Gi=$i[Rr],Ao=Gi.G,Ic=Gi.H,Fd=0,Bi=1,Td=0;for(Xs=0;5>Xs;++Xs){Er=Cc[Xs],Ao[Xs]=Tc,Ic[Xs]=la,!Xs&&0<kr&&(Er+=1<<kr);a:{var Yo,ho=Er,Id=Un,Ll=Wi,Jf=Tc,tm=la,Zr=0,ul=Id.m,sm=W(ul,1);if(n(Ll,0,0,ho),sm){var rm=W(ul,1)+1,RA=W(ul,1),OA=W(ul,RA==0?1:8);Ll[OA]=1,rm==2&&(Ll[OA=W(ul,8)]=1);var Dl=1}else{var ra=i(19),La=W(ul,4)+4;if(19<La){Id.a=3;var wa=0;break a}for(Yo=0;Yo<La;++Yo)ra[Ag[Yo]]=W(ul,3);var Ld=void 0,mo=void 0,Dd=Id,gg=ra,qa=ho,QA=Ll,Ru=0,Pl=Dd.m,Al=8,ki=l(128,T);r:for(;O(ki,0,7,gg,19);){if(W(Pl,1)){var Ou=2+2*W(Pl,3);if((Ld=2+W(Pl,Ou))>qa)break r}else Ld=qa;for(mo=0;mo<qa&&Ld--;){U(Pl);var MA=ki[0+(127&F(Pl))];L(Pl,Pl.u+MA.g);var Xo=MA.value;if(16>Xo)QA[mo++]=Xo,Xo!=0&&(Al=Xo);else{var Zf=Xo==16,am=Xo-16,ep=LA[am],nm=W(Pl,Lu[am])+ep;if(mo+nm>qa)break r;for(var tp=Zf?Al:0;0<nm--;)QA[mo++]=tp}}Ru=1;break r}Ru||(Dd.a=3),Dl=Ru}(Dl=Dl&&!ul.h)&&(Zr=O(Jf,tm,8,Ll,ho)),Dl&&Zr!=0?wa=Zr:(Id.a=3,wa=0)}if(wa==0)break s;if(Bi&&Wf[Xs]==1&&(Bi=Tc[la].g==0),Fd+=Tc[la].g,la+=wa,3>=Xs){var Pd,HA=Wi[0];for(Pd=1;Pd<Er;++Pd)Wi[Pd]>HA&&(HA=Wi[Pd]);Td+=HA}}if(Gi.nd=Bi,Gi.Qb=0,Bi&&(Gi.qb=(Ao[3][Ic[3]+0].value<<24|Ao[1][Ic[1]+0].value<<16|Ao[2][Ic[2]+0].value)>>>0,Fd==0&&256>Ao[0][Ic[0]+0].value&&(Gi.Qb=1,Gi.qb+=Ao[0][Ic[0]+0].value<<8)),Gi.jc=!Gi.Qb&&6>Td,Gi.jc){var Qu,Ei=Gi;for(Qu=0;Qu<xa;++Qu){var fo=Qu,hl=Ei.pd[fo],Lc=Ei.G[0][Ei.H[0]+fo];256<=Lc.value?(hl.g=Lc.g+256,hl.value=Lc.value):(hl.g=0,hl.value=0,fo>>=ts(Lc,8,hl),fo>>=ts(Ei.G[1][Ei.H[1]+fo],16,hl),fo>>=ts(Ei.G[2][Ei.H[2]+fo],0,hl),ts(Ei.G[3][Ei.H[3]+fo],24,hl))}}}oa.vc=Ha,oa.Wb=hn,oa.Ya=$i,oa.yc=Il,Pr=1;break t}Pr=0}if(!(Ce=Pr)){ue.a=3;break e}if(0<Dt){if(et.ua=1<<Dt,!we(et.Wa,Dt)){ue.a=1,Ce=0;break e}}else et.ua=0;var qA=ue,VA=Fe,sp=De,$A=qA.s,WA=$A.xc;if(qA.c=VA,qA.i=sp,$A.md=Qe(VA,WA),$A.wc=WA==0?-1:(1<<WA)-1,ie){ue.xb=Tl;break e}if((vt=i(Fe*De))==null){ue.a=1,Ce=0;break e}Ce=(Ce=st(ue,vt,0,Fe,De,De,null))&&!qe.h;break e}return Ce?(ve!=null?ve[0]=vt:(s(vt==null),s(ie)),ue.$=0,ie||It(et)):It(et),Ce}function Tt(C,z){var ie=C.c*C.i,ue=ie+z+16*z;return s(C.c<=z),C.V=i(ue),C.V==null?(C.Ta=null,C.Ua=0,C.a=1,0):(C.Ta=C.V,C.Ua=C.Ba+ie+z,1)}function Me(C,z){var ie=C.C,ue=z-ie,ve=C.V,Ce=C.Ba+C.c*ie;for(s(z<=C.l.o);0<ue;){var Fe=16<ue?16:ue,De=C.l.ma,qe=C.l.width,et=qe*Fe,vt=De.ca,Dt=De.tb+qe*ie,Pt=C.Ta,kt=C.Ua;fe(C,Fe,ve,Ce),ga(Pt,kt,vt,Dt,et),Le(De,ie,ie+Fe,vt,Dt,qe),ue-=Fe,ve+=Fe*C.c,ie+=Fe}s(ie==z),C.C=C.Ma=z}function Nt(){this.ub=this.yd=this.td=this.Rb=0}function Et(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function $t(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Ht(){this.Yb=(function(){var C=[];return(function z(ie,ue,ve){for(var Ce=ve[ue],Fe=0;Fe<Ce&&(ie.push(ve.length>ue+1?[]:0),!(ve.length<ue+1));Fe++)z(ie[Fe],ue+1,ve)})(C,0,[3,11]),C})()}function Ot(){this.jb=i(3),this.Wc=o([4,8],Ht),this.Xc=o([4,17],Ht)}function ls(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Ls(){this.ld=this.La=this.dd=this.tc=0}function Is(){this.Na=this.la=0}function Hs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ir(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ya(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ls),this.Y=0,this.ya=Array(new Ir),this.aa=0,this.l=new ka}function yr(){this.y=i(16),this.f=i(8),this.ea=i(8)}function cr(){this.cb=this.a=0,this.sc="",this.m=new K,this.Od=new Nt,this.Kc=new Et,this.ed=new ls,this.Qa=new $t,this.Ic=this.$c=this.Aa=0,this.D=new ya,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,K),this.ia=0,this.pb=l(4,Hs),this.Pa=new Ot,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new yr),this.Hd=0,this.rb=Array(new Is),this.sb=0,this.wa=Array(new Ls),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ir),this.L=this.aa=0,this.gd=o([4,2],Ls),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function ka(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ks(){var C=new cr;return C!=null&&(C.a=0,C.sc="OK",C.cb=0,C.Xb=0,Bc||(Bc=sa)),C}function jr(C,z,ie){return C.a==0&&(C.a=z,C.sc=ie,C.cb=0),0}function nl(C,z,ie){return 3<=ie&&C[z+0]==157&&C[z+1]==1&&C[z+2]==42}function zr(C,z){if(C==null)return 0;if(C.a=0,C.sc="OK",z==null)return jr(C,2,"null VP8Io passed to VP8GetHeaders()");var ie=z.data,ue=z.w,ve=z.ha;if(4>ve)return jr(C,7,"Truncated header.");var Ce=ie[ue+0]|ie[ue+1]<<8|ie[ue+2]<<16,Fe=C.Od;if(Fe.Rb=!(1&Ce),Fe.td=Ce>>1&7,Fe.yd=Ce>>4&1,Fe.ub=Ce>>5,3<Fe.td)return jr(C,3,"Incorrect keyframe parameters.");if(!Fe.yd)return jr(C,4,"Frame not displayable.");ue+=3,ve-=3;var De=C.Kc;if(Fe.Rb){if(7>ve)return jr(C,7,"cannot parse picture header");if(!nl(ie,ue,ve))return jr(C,3,"Bad code word");De.c=16383&(ie[ue+4]<<8|ie[ue+3]),De.Td=ie[ue+4]>>6,De.i=16383&(ie[ue+6]<<8|ie[ue+5]),De.Ud=ie[ue+6]>>6,ue+=7,ve-=7,C.za=De.c+15>>4,C.Ub=De.i+15>>4,z.width=De.c,z.height=De.i,z.Da=0,z.j=0,z.v=0,z.va=z.width,z.o=z.height,z.da=0,z.ib=z.width,z.hb=z.height,z.U=z.width,z.T=z.height,n((Ce=C.Pa).jb,0,255,Ce.jb.length),s((Ce=C.Qa)!=null),Ce.Cb=0,Ce.Bb=0,Ce.Fb=1,n(Ce.Zb,0,0,Ce.Zb.length),n(Ce.Lb,0,0,Ce.Lb)}if(Fe.ub>ve)return jr(C,7,"bad partition length");Y(Ce=C.m,ie,ue,Fe.ub),ue+=Fe.ub,ve-=Fe.ub,Fe.Rb&&(De.Ld=ae(Ce),De.Kd=ae(Ce)),De=C.Qa;var qe,et=C.Pa;if(s(Ce!=null),s(De!=null),De.Cb=ae(Ce),De.Cb){if(De.Bb=ae(Ce),ae(Ce)){for(De.Fb=ae(Ce),qe=0;4>qe;++qe)De.Zb[qe]=ae(Ce)?X(Ce,7):0;for(qe=0;4>qe;++qe)De.Lb[qe]=ae(Ce)?X(Ce,6):0}if(De.Bb)for(qe=0;3>qe;++qe)et.jb[qe]=ae(Ce)?M(Ce,8):255}else De.Bb=0;if(Ce.Ka)return jr(C,3,"cannot parse segment header");if((De=C.ed).zd=ae(Ce),De.Tb=M(Ce,6),De.wb=M(Ce,3),De.Pc=ae(Ce),De.Pc&&ae(Ce)){for(et=0;4>et;++et)ae(Ce)&&(De.vd[et]=X(Ce,6));for(et=0;4>et;++et)ae(Ce)&&(De.od[et]=X(Ce,6))}if(C.L=De.Tb==0?0:De.zd?1:2,Ce.Ka)return jr(C,3,"cannot parse filter header");var vt=ve;if(ve=qe=ue,ue=qe+vt,De=vt,C.Xb=(1<<M(C.m,2))-1,vt<3*(et=C.Xb))ie=7;else{for(qe+=3*et,De-=3*et,vt=0;vt<et;++vt){var Dt=ie[ve+0]|ie[ve+1]<<8|ie[ve+2]<<16;Dt>De&&(Dt=De),Y(C.Jc[+vt],ie,qe,Dt),qe+=Dt,De-=Dt,ve+=3}Y(C.Jc[+et],ie,qe,De),ie=qe<ue?0:5}if(ie!=0)return jr(C,ie,"cannot parse partitions");for(ie=M(qe=C.m,7),ve=ae(qe)?X(qe,4):0,ue=ae(qe)?X(qe,4):0,De=ae(qe)?X(qe,4):0,et=ae(qe)?X(qe,4):0,qe=ae(qe)?X(qe,4):0,vt=C.Qa,Dt=0;4>Dt;++Dt){if(vt.Cb){var Pt=vt.Zb[Dt];vt.Fb||(Pt+=ie)}else{if(0<Dt){C.pb[Dt]=C.pb[0];continue}Pt=ie}var kt=C.pb[Dt];kt.Sc[0]=Cd[wi(Pt+ve,127)],kt.Sc[1]=Du[wi(Pt+0,127)],kt.Eb[0]=2*Cd[wi(Pt+ue,127)],kt.Eb[1]=101581*Du[wi(Pt+De,127)]>>16,8>kt.Eb[1]&&(kt.Eb[1]=8),kt.Qc[0]=Cd[wi(Pt+et,117)],kt.Qc[1]=Du[wi(Pt+qe,127)],kt.lc=Pt+qe}if(!Fe.Rb)return jr(C,4,"Not a key frame.");for(ae(Ce),Fe=C.Pa,ie=0;4>ie;++ie){for(ve=0;8>ve;++ve)for(ue=0;3>ue;++ue)for(De=0;11>De;++De)et=Z(Ce,fg[ie][ve][ue][De])?M(Ce,8):zf[ie][ve][ue][De],Fe.Wc[ie][ve].Yb[ue][De]=et;for(ve=0;17>ve;++ve)Fe.Xc[ie][ve]=Fe.Wc[ie][Xh[ve]]}return C.kc=ae(Ce),C.kc&&(C.Bd=M(Ce,8)),C.cb=1}function sa(C,z,ie,ue,ve,Ce,Fe){var De=z[ve].Yb[ie];for(ie=0;16>ve;++ve){if(!Z(C,De[ie+0]))return ve;for(;!Z(C,De[ie+1]);)if(De=z[++ve].Yb[0],ie=0,ve==16)return 16;var qe=z[ve+1].Yb;if(Z(C,De[ie+2])){var et=C,vt=0;if(Z(et,(Pt=De)[(Dt=ie)+3]))if(Z(et,Pt[Dt+6])){for(De=0,Dt=2*(vt=Z(et,Pt[Dt+8]))+(Pt=Z(et,Pt[Dt+9+vt])),vt=0,Pt=zh[Dt];Pt[De];++De)vt+=vt+Z(et,Pt[De]);vt+=3+(8<<Dt)}else Z(et,Pt[Dt+7])?(vt=7+2*Z(et,165),vt+=Z(et,145)):vt=5+Z(et,159);else vt=Z(et,Pt[Dt+4])?3+Z(et,Pt[Dt+5]):2;De=qe[2]}else vt=1,De=qe[1];qe=Fe+Yh[ve],0>(et=C).b&&J(et);var Dt,Pt=et.b,kt=(Dt=et.Ca>>1)-(et.I>>Pt)>>31;--et.b,et.Ca+=kt,et.Ca|=1,et.I-=(Dt+1&kt)<<Pt,Ce[qe]=((vt^kt)-kt)*ue[(0<ve)+0]}return 16}function on(C){var z=C.rb[C.sb-1];z.la=0,z.Na=0,n(C.zc,0,0,C.zc.length),C.ja=0}function yi(C,z){if(C==null)return 0;if(z==null)return jr(C,2,"NULL VP8Io parameter in VP8Decode().");if(!C.cb&&!zr(C,z))return 0;if(s(C.cb),z.ac==null||z.ac(z)){z.ob&&(C.L=0);var ie=Fc[C.L];if(C.L==2?(C.yb=0,C.zb=0):(C.yb=z.v-ie>>4,C.zb=z.j-ie>>4,0>C.yb&&(C.yb=0),0>C.zb&&(C.zb=0)),C.Va=z.o+15+ie>>4,C.Hb=z.va+15+ie>>4,C.Hb>C.za&&(C.Hb=C.za),C.Va>C.Ub&&(C.Va=C.Ub),0<C.L){var ue=C.ed;for(ie=0;4>ie;++ie){var ve;if(C.Qa.Cb){var Ce=C.Qa.Lb[ie];C.Qa.Fb||(Ce+=ue.Tb)}else Ce=ue.Tb;for(ve=0;1>=ve;++ve){var Fe=C.gd[ie][ve],De=Ce;if(ue.Pc&&(De+=ue.vd[0],ve&&(De+=ue.od[0])),0<(De=0>De?0:63<De?63:De)){var qe=De;0<ue.wb&&(qe=4<ue.wb?qe>>2:qe>>1)>9-ue.wb&&(qe=9-ue.wb),1>qe&&(qe=1),Fe.dd=qe,Fe.tc=2*De+qe,Fe.ld=40<=De?2:15<=De?1:0}else Fe.tc=0;Fe.La=ve}}}ie=0}else jr(C,6,"Frame setup failed"),ie=C.a;if(ie=ie==0){if(ie){C.$c=0,0<C.Aa||(C.Ic=co);e:{ie=C.Ic,ue=4*(qe=C.za);var et=32*qe,vt=qe+1,Dt=0<C.L?qe*(0<C.Aa?2:1):0,Pt=(C.Aa==2?2:1)*qe;if((Fe=ue+832+(ve=3*(16*ie+Fc[C.L])/2*et)+(Ce=C.Fa!=null&&0<C.Fa.length?C.Kc.c*C.Kc.i:0))!=Fe)ie=0;else{if(Fe>C.Vb){if(C.Vb=0,C.Ec=i(Fe),C.Fc=0,C.Ec==null){ie=jr(C,1,"no memory during frame initialization.");break e}C.Vb=Fe}Fe=C.Ec,De=C.Fc,C.Ac=Fe,C.Bc=De,De+=ue,C.Gd=l(et,yr),C.Hd=0,C.rb=l(vt+1,Is),C.sb=1,C.wa=Dt?l(Dt,Ls):null,C.Y=0,C.D.Nb=0,C.D.wa=C.wa,C.D.Y=C.Y,0<C.Aa&&(C.D.Y+=qe),s(!0),C.oc=Fe,C.pc=De,De+=832,C.ya=l(Pt,Ir),C.aa=0,C.D.ya=C.ya,C.D.aa=C.aa,C.Aa==2&&(C.D.aa+=qe),C.R=16*qe,C.B=8*qe,qe=(et=Fc[C.L])*C.R,et=et/2*C.B,C.sa=Fe,C.ta=De+qe,C.qa=C.sa,C.ra=C.ta+16*ie*C.R+et,C.Ha=C.qa,C.Ia=C.ra+8*ie*C.B+et,C.$c=0,De+=ve,C.mb=Ce?Fe:null,C.nb=Ce?De:null,s(De+Ce<=C.Fc+C.Vb),on(C),n(C.Ac,C.Bc,0,ue),ie=1}}if(ie){if(z.ka=0,z.y=C.sa,z.O=C.ta,z.f=C.qa,z.N=C.ra,z.ea=C.Ha,z.Vd=C.Ia,z.fa=C.R,z.Rc=C.B,z.F=null,z.J=0,!ku){for(ie=-255;255>=ie;++ie)Ta[255+ie]=0>ie?-ie:ie;for(ie=-1020;1020>=ie;++ie)El[1020+ie]=-128>ie?-128:127<ie?127:ie;for(ie=-112;112>=ie;++ie)wd[112+ie]=-16>ie?-16:15<ie?15:ie;for(ie=-255;510>=ie;++ie)_c[255+ie]=0>ie?0:255<ie?255:ie;ku=1}Nd=xr,ro=Gn,ao=Kn,bn=od,_i=il,wr=ji,yc=ol,Bu=ja,jc=pc,Nc=Nu,wc=Ro,Si=Oo,no=xc,kl=ud,io=er,lo=Jr,$o=Ea,un=Sl,qi[0]=ut,qi[1]=cd,qi[2]=be,qi[3]=nt,qi[4]=_t,qi[5]=qt,qi[6]=Qt,qi[7]=Ut,qi[8]=ss,qi[9]=Zt,Pn[0]=cn,Pn[1]=dd,Pn[2]=ma,Pn[3]=Qi,Pn[4]=Mr,Pn[5]=Ni,Pn[6]=zn,Xn[0]=rs,Xn[1]=fc,Xn[2]=fs,Xn[3]=js,Xn[4]=ms,Xn[5]=bs,Xn[6]=gr,ie=1}else ie=0}ie&&(ie=(function(kt,as){for(kt.M=0;kt.M<kt.Va;++kt.M){var Gt,yt=kt.Jc[kt.M&kt.Xb],jt=kt.m,Xt=kt;for(Gt=0;Gt<Xt.za;++Gt){var Yt=jt,es=Xt,_s=es.Ac,vs=es.Bc+4*Gt,Rs=es.zc,ys=es.ya[es.aa+Gt];if(es.Qa.Bb?ys.$b=Z(Yt,es.Pa.jb[0])?2+Z(Yt,es.Pa.jb[2]):Z(Yt,es.Pa.jb[1]):ys.$b=0,es.kc&&(ys.Ad=Z(Yt,es.Bd)),ys.Za=!Z(Yt,145)+0,ys.Za){var vr=ys.Ob,br=0;for(es=0;4>es;++es){var fr,ar=Rs[0+es];for(fr=0;4>fr;++fr){ar=mg[_s[vs+fr]][ar];for(var Pr=Kf[Z(Yt,ar[0])];0<Pr;)Pr=Kf[2*Pr+Z(Yt,ar[Pr])];ar=-Pr,_s[vs+fr]=ar}a(vr,br,_s,vs,4),br+=4,Rs[0+es]=ar}}else ar=Z(Yt,156)?Z(Yt,128)?1:3:Z(Yt,163)?2:0,ys.Ob[0]=ar,n(_s,vs,ar,4),n(Rs,0,ar,4);ys.Dd=Z(Yt,142)?Z(Yt,114)?Z(Yt,183)?1:3:2:0}if(Xt.m.Ka)return jr(kt,7,"Premature end-of-partition0 encountered.");for(;kt.ja<kt.za;++kt.ja){if(Xt=yt,Yt=(jt=kt).rb[jt.sb-1],_s=jt.rb[jt.sb+jt.ja],Gt=jt.ya[jt.aa+jt.ja],vs=jt.kc?Gt.Ad:0)Yt.la=_s.la=0,Gt.Za||(Yt.Na=_s.Na=0),Gt.Hc=0,Gt.Gc=0,Gt.ia=0;else{var Rr,Xs;if(Yt=_s,_s=Xt,vs=jt.Pa.Xc,Rs=jt.ya[jt.aa+jt.ja],ys=jt.pb[Rs.$b],es=Rs.ad,vr=0,br=jt.rb[jt.sb-1],ar=fr=0,n(es,vr,0,384),Rs.Za)var la=0,Un=vs[3];else{Pr=i(16);var Na=Yt.Na+br.Na;if(Na=Bc(_s,vs[1],Na,ys.Eb,0,Pr,0),Yt.Na=br.Na=(0<Na)+0,1<Na)Nd(Pr,0,es,vr);else{var Ma=Pr[0]+3>>3;for(Pr=0;256>Pr;Pr+=16)es[vr+Pr]=Ma}la=1,Un=vs[0]}var kr=15&Yt.la,jn=15&br.la;for(Pr=0;4>Pr;++Pr){var Nn=1&jn;for(Ma=Xs=0;4>Ma;++Ma)kr=kr>>1|(Nn=(Na=Bc(_s,Un,Na=Nn+(1&kr),ys.Sc,la,es,vr))>la)<<7,Xs=Xs<<2|(3<Na?3:1<Na?2:es[vr+0]!=0),vr+=16;kr>>=4,jn=jn>>1|Nn<<7,fr=(fr<<8|Xs)>>>0}for(Un=kr,la=jn>>4,Rr=0;4>Rr;Rr+=2){for(Xs=0,kr=Yt.la>>4+Rr,jn=br.la>>4+Rr,Pr=0;2>Pr;++Pr){for(Nn=1&jn,Ma=0;2>Ma;++Ma)Na=Nn+(1&kr),kr=kr>>1|(Nn=0<(Na=Bc(_s,vs[2],Na,ys.Qc,0,es,vr)))<<3,Xs=Xs<<2|(3<Na?3:1<Na?2:es[vr+0]!=0),vr+=16;kr>>=2,jn=jn>>1|Nn<<5}ar|=Xs<<4*Rr,Un|=kr<<4<<Rr,la|=(240&jn)<<Rr}Yt.la=Un,br.la=la,Rs.Hc=fr,Rs.Gc=ar,Rs.ia=43690&ar?0:ys.ia,vs=!(fr|ar)}if(0<jt.L&&(jt.wa[jt.Y+jt.ja]=jt.gd[Gt.$b][Gt.Za],jt.wa[jt.Y+jt.ja].La|=!vs),Xt.Ka)return jr(kt,7,"Premature end-of-file encountered.")}if(on(kt),jt=as,Xt=1,Gt=(yt=kt).D,Yt=0<yt.L&&yt.M>=yt.zb&&yt.M<=yt.Va,yt.Aa==0)e:{if(Gt.M=yt.M,Gt.uc=Yt,md(yt,Gt),Xt=1,Gt=(Xs=yt.D).Nb,Yt=(ar=Fc[yt.L])*yt.R,_s=ar/2*yt.B,Pr=16*Gt*yt.R,Ma=8*Gt*yt.B,vs=yt.sa,Rs=yt.ta-Yt+Pr,ys=yt.qa,es=yt.ra-_s+Ma,vr=yt.Ha,br=yt.Ia-_s+Ma,jn=(kr=Xs.M)==0,fr=kr>=yt.Va-1,yt.Aa==2&&md(yt,Xs),Xs.uc)for(Nn=(Na=yt).D.M,s(Na.D.uc),Xs=Na.yb;Xs<Na.Hb;++Xs){la=Xs,Un=Nn;var oa=(Ha=(Er=Na).D).Nb;Rr=Er.R;var Ha=Ha.wa[Ha.Y+la],hn=Er.sa,ti=Er.ta+16*oa*Rr+16*la,Vi=Ha.dd,ca=Ha.tc;if(ca!=0)if(s(3<=ca),Er.L==1)0<la&&lo(hn,ti,Rr,ca+4),Ha.La&&un(hn,ti,Rr,ca),0<Un&&io(hn,ti,Rr,ca+4),Ha.La&&$o(hn,ti,Rr,ca);else{var Ia=Er.B,Ci=Er.qa,zo=Er.ra+8*oa*Ia+8*la,uo=Er.Ha,Er=Er.Ia+8*oa*Ia+8*la;oa=Ha.ld,0<la&&(Bu(hn,ti,Rr,ca+4,Vi,oa),Nc(Ci,zo,uo,Er,Ia,ca+4,Vi,oa)),Ha.La&&(Si(hn,ti,Rr,ca,Vi,oa),kl(Ci,zo,uo,Er,Ia,ca,Vi,oa)),0<Un&&(yc(hn,ti,Rr,ca+4,Vi,oa),jc(Ci,zo,uo,Er,Ia,ca+4,Vi,oa)),Ha.La&&(wc(hn,ti,Rr,ca,Vi,oa),no(Ci,zo,uo,Er,Ia,ca,Vi,oa))}}if(yt.ia&&alert("todo:DitherRow"),jt.put!=null){if(Xs=16*kr,kr=16*(kr+1),jn?(jt.y=yt.sa,jt.O=yt.ta+Pr,jt.f=yt.qa,jt.N=yt.ra+Ma,jt.ea=yt.Ha,jt.W=yt.Ia+Ma):(Xs-=ar,jt.y=vs,jt.O=Rs,jt.f=ys,jt.N=es,jt.ea=vr,jt.W=br),fr||(kr-=ar),kr>jt.o&&(kr=jt.o),jt.F=null,jt.J=null,yt.Fa!=null&&0<yt.Fa.length&&Xs<kr&&(jt.J=_u(yt,jt,Xs,kr-Xs),jt.F=yt.mb,jt.F==null&&jt.F.length==0)){Xt=jr(yt,3,"Could not decode alpha data.");break e}Xs<jt.j&&(ar=jt.j-Xs,Xs=jt.j,s(!(1&ar)),jt.O+=yt.R*ar,jt.N+=yt.B*(ar>>1),jt.W+=yt.B*(ar>>1),jt.F!=null&&(jt.J+=jt.width*ar)),Xs<kr&&(jt.O+=jt.v,jt.N+=jt.v>>1,jt.W+=jt.v>>1,jt.F!=null&&(jt.J+=jt.v),jt.ka=Xs-jt.j,jt.U=jt.va-jt.v,jt.T=kr-Xs,Xt=jt.put(jt))}Gt+1!=yt.Ic||fr||(a(yt.sa,yt.ta-Yt,vs,Rs+16*yt.R,Yt),a(yt.qa,yt.ra-_s,ys,es+8*yt.B,_s),a(yt.Ha,yt.Ia-_s,vr,br+8*yt.B,_s))}if(!Xt)return jr(kt,6,"Output aborted.")}return 1})(C,z)),z.bc!=null&&z.bc(z),ie&=1}return ie?(C.cb=0,ie):0}function en(C,z,ie,ue,ve){ve=C[z+ie+32*ue]+(ve>>3),C[z+ie+32*ue]=-256&ve?0>ve?0:255:ve}function Oi(C,z,ie,ue,ve,Ce){en(C,z,0,ie,ue+ve),en(C,z,1,ie,ue+Ce),en(C,z,2,ie,ue-Ce),en(C,z,3,ie,ue-ve)}function Qr(C){return(20091*C>>16)+C}function Fn(C,z,ie,ue){var ve,Ce=0,Fe=i(16);for(ve=0;4>ve;++ve){var De=C[z+0]+C[z+8],qe=C[z+0]-C[z+8],et=(35468*C[z+4]>>16)-Qr(C[z+12]),vt=Qr(C[z+4])+(35468*C[z+12]>>16);Fe[Ce+0]=De+vt,Fe[Ce+1]=qe+et,Fe[Ce+2]=qe-et,Fe[Ce+3]=De-vt,Ce+=4,z++}for(ve=Ce=0;4>ve;++ve)De=(C=Fe[Ce+0]+4)+Fe[Ce+8],qe=C-Fe[Ce+8],et=(35468*Fe[Ce+4]>>16)-Qr(Fe[Ce+12]),en(ie,ue,0,0,De+(vt=Qr(Fe[Ce+4])+(35468*Fe[Ce+12]>>16))),en(ie,ue,1,0,qe+et),en(ie,ue,2,0,qe-et),en(ie,ue,3,0,De-vt),Ce++,ue+=32}function ji(C,z,ie,ue){var ve=C[z+0]+4,Ce=35468*C[z+4]>>16,Fe=Qr(C[z+4]),De=35468*C[z+1]>>16;Oi(ie,ue,0,ve+Fe,C=Qr(C[z+1]),De),Oi(ie,ue,1,ve+Ce,C,De),Oi(ie,ue,2,ve-Ce,C,De),Oi(ie,ue,3,ve-Fe,C,De)}function Gn(C,z,ie,ue,ve){Fn(C,z,ie,ue),ve&&Fn(C,z+16,ie,ue+4)}function Kn(C,z,ie,ue){ro(C,z+0,ie,ue,1),ro(C,z+32,ie,ue+128,1)}function od(C,z,ie,ue){var ve;for(C=C[z+0]+4,ve=0;4>ve;++ve)for(z=0;4>z;++z)en(ie,ue,z,ve,C)}function il(C,z,ie,ue){C[z+0]&&bn(C,z+0,ie,ue),C[z+16]&&bn(C,z+16,ie,ue+4),C[z+32]&&bn(C,z+32,ie,ue+128),C[z+48]&&bn(C,z+48,ie,ue+128+4)}function xr(C,z,ie,ue){var ve,Ce=i(16);for(ve=0;4>ve;++ve){var Fe=C[z+0+ve]+C[z+12+ve],De=C[z+4+ve]+C[z+8+ve],qe=C[z+4+ve]-C[z+8+ve],et=C[z+0+ve]-C[z+12+ve];Ce[0+ve]=Fe+De,Ce[8+ve]=Fe-De,Ce[4+ve]=et+qe,Ce[12+ve]=et-qe}for(ve=0;4>ve;++ve)Fe=(C=Ce[0+4*ve]+3)+Ce[3+4*ve],De=Ce[1+4*ve]+Ce[2+4*ve],qe=Ce[1+4*ve]-Ce[2+4*ve],et=C-Ce[3+4*ve],ie[ue+0]=Fe+De>>3,ie[ue+16]=et+qe>>3,ie[ue+32]=Fe-De>>3,ie[ue+48]=et-qe>>3,ue+=64}function Nr(C,z,ie){var ue,ve=z-32,Ce=Dn,Fe=255-C[ve-1];for(ue=0;ue<ie;++ue){var De,qe=Ce,et=Fe+C[z-1];for(De=0;De<ie;++De)C[z+De]=qe[et+C[ve+De]];z+=32}}function cd(C,z){Nr(C,z,4)}function fc(C,z){Nr(C,z,8)}function dd(C,z){Nr(C,z,16)}function ma(C,z){var ie;for(ie=0;16>ie;++ie)a(C,z+32*ie,C,z-32,16)}function Qi(C,z){var ie;for(ie=16;0<ie;--ie)n(C,z,C[z-1],16),z+=32}function ll(C,z,ie){var ue;for(ue=0;16>ue;++ue)n(z,ie+32*ue,C,16)}function cn(C,z){var ie,ue=16;for(ie=0;16>ie;++ie)ue+=C[z-1+32*ie]+C[z+ie-32];ll(ue>>5,C,z)}function Mr(C,z){var ie,ue=8;for(ie=0;16>ie;++ie)ue+=C[z-1+32*ie];ll(ue>>4,C,z)}function Ni(C,z){var ie,ue=8;for(ie=0;16>ie;++ie)ue+=C[z+ie-32];ll(ue>>4,C,z)}function zn(C,z){ll(128,C,z)}function Ms(C,z,ie){return C+2*z+ie+2>>2}function be(C,z){var ie,ue=z-32;for(ue=new Uint8Array([Ms(C[ue-1],C[ue+0],C[ue+1]),Ms(C[ue+0],C[ue+1],C[ue+2]),Ms(C[ue+1],C[ue+2],C[ue+3]),Ms(C[ue+2],C[ue+3],C[ue+4])]),ie=0;4>ie;++ie)a(C,z+32*ie,ue,0,ue.length)}function nt(C,z){var ie=C[z-1],ue=C[z-1+32],ve=C[z-1+64],Ce=C[z-1+96];oe(C,z+0,16843009*Ms(C[z-1-32],ie,ue)),oe(C,z+32,16843009*Ms(ie,ue,ve)),oe(C,z+64,16843009*Ms(ue,ve,Ce)),oe(C,z+96,16843009*Ms(ve,Ce,Ce))}function ut(C,z){var ie,ue=4;for(ie=0;4>ie;++ie)ue+=C[z+ie-32]+C[z-1+32*ie];for(ue>>=3,ie=0;4>ie;++ie)n(C,z+32*ie,ue,4)}function _t(C,z){var ie=C[z-1+0],ue=C[z-1+32],ve=C[z-1+64],Ce=C[z-1-32],Fe=C[z+0-32],De=C[z+1-32],qe=C[z+2-32],et=C[z+3-32];C[z+0+96]=Ms(ue,ve,C[z-1+96]),C[z+1+96]=C[z+0+64]=Ms(ie,ue,ve),C[z+2+96]=C[z+1+64]=C[z+0+32]=Ms(Ce,ie,ue),C[z+3+96]=C[z+2+64]=C[z+1+32]=C[z+0+0]=Ms(Fe,Ce,ie),C[z+3+64]=C[z+2+32]=C[z+1+0]=Ms(De,Fe,Ce),C[z+3+32]=C[z+2+0]=Ms(qe,De,Fe),C[z+3+0]=Ms(et,qe,De)}function Qt(C,z){var ie=C[z+1-32],ue=C[z+2-32],ve=C[z+3-32],Ce=C[z+4-32],Fe=C[z+5-32],De=C[z+6-32],qe=C[z+7-32];C[z+0+0]=Ms(C[z+0-32],ie,ue),C[z+1+0]=C[z+0+32]=Ms(ie,ue,ve),C[z+2+0]=C[z+1+32]=C[z+0+64]=Ms(ue,ve,Ce),C[z+3+0]=C[z+2+32]=C[z+1+64]=C[z+0+96]=Ms(ve,Ce,Fe),C[z+3+32]=C[z+2+64]=C[z+1+96]=Ms(Ce,Fe,De),C[z+3+64]=C[z+2+96]=Ms(Fe,De,qe),C[z+3+96]=Ms(De,qe,qe)}function qt(C,z){var ie=C[z-1+0],ue=C[z-1+32],ve=C[z-1+64],Ce=C[z-1-32],Fe=C[z+0-32],De=C[z+1-32],qe=C[z+2-32],et=C[z+3-32];C[z+0+0]=C[z+1+64]=Ce+Fe+1>>1,C[z+1+0]=C[z+2+64]=Fe+De+1>>1,C[z+2+0]=C[z+3+64]=De+qe+1>>1,C[z+3+0]=qe+et+1>>1,C[z+0+96]=Ms(ve,ue,ie),C[z+0+64]=Ms(ue,ie,Ce),C[z+0+32]=C[z+1+96]=Ms(ie,Ce,Fe),C[z+1+32]=C[z+2+96]=Ms(Ce,Fe,De),C[z+2+32]=C[z+3+96]=Ms(Fe,De,qe),C[z+3+32]=Ms(De,qe,et)}function Ut(C,z){var ie=C[z+0-32],ue=C[z+1-32],ve=C[z+2-32],Ce=C[z+3-32],Fe=C[z+4-32],De=C[z+5-32],qe=C[z+6-32],et=C[z+7-32];C[z+0+0]=ie+ue+1>>1,C[z+1+0]=C[z+0+64]=ue+ve+1>>1,C[z+2+0]=C[z+1+64]=ve+Ce+1>>1,C[z+3+0]=C[z+2+64]=Ce+Fe+1>>1,C[z+0+32]=Ms(ie,ue,ve),C[z+1+32]=C[z+0+96]=Ms(ue,ve,Ce),C[z+2+32]=C[z+1+96]=Ms(ve,Ce,Fe),C[z+3+32]=C[z+2+96]=Ms(Ce,Fe,De),C[z+3+64]=Ms(Fe,De,qe),C[z+3+96]=Ms(De,qe,et)}function Zt(C,z){var ie=C[z-1+0],ue=C[z-1+32],ve=C[z-1+64],Ce=C[z-1+96];C[z+0+0]=ie+ue+1>>1,C[z+2+0]=C[z+0+32]=ue+ve+1>>1,C[z+2+32]=C[z+0+64]=ve+Ce+1>>1,C[z+1+0]=Ms(ie,ue,ve),C[z+3+0]=C[z+1+32]=Ms(ue,ve,Ce),C[z+3+32]=C[z+1+64]=Ms(ve,Ce,Ce),C[z+3+64]=C[z+2+64]=C[z+0+96]=C[z+1+96]=C[z+2+96]=C[z+3+96]=Ce}function ss(C,z){var ie=C[z-1+0],ue=C[z-1+32],ve=C[z-1+64],Ce=C[z-1+96],Fe=C[z-1-32],De=C[z+0-32],qe=C[z+1-32],et=C[z+2-32];C[z+0+0]=C[z+2+32]=ie+Fe+1>>1,C[z+0+32]=C[z+2+64]=ue+ie+1>>1,C[z+0+64]=C[z+2+96]=ve+ue+1>>1,C[z+0+96]=Ce+ve+1>>1,C[z+3+0]=Ms(De,qe,et),C[z+2+0]=Ms(Fe,De,qe),C[z+1+0]=C[z+3+32]=Ms(ie,Fe,De),C[z+1+32]=C[z+3+64]=Ms(ue,ie,Fe),C[z+1+64]=C[z+3+96]=Ms(ve,ue,ie),C[z+1+96]=Ms(Ce,ve,ue)}function fs(C,z){var ie;for(ie=0;8>ie;++ie)a(C,z+32*ie,C,z-32,8)}function js(C,z){var ie;for(ie=0;8>ie;++ie)n(C,z,C[z-1],8),z+=32}function ns(C,z,ie){var ue;for(ue=0;8>ue;++ue)n(z,ie+32*ue,C,8)}function rs(C,z){var ie,ue=8;for(ie=0;8>ie;++ie)ue+=C[z+ie-32]+C[z-1+32*ie];ns(ue>>4,C,z)}function bs(C,z){var ie,ue=4;for(ie=0;8>ie;++ie)ue+=C[z+ie-32];ns(ue>>3,C,z)}function ms(C,z){var ie,ue=4;for(ie=0;8>ie;++ie)ue+=C[z-1+32*ie];ns(ue>>3,C,z)}function gr(C,z){ns(128,C,z)}function dn(C,z,ie){var ue=C[z-ie],ve=C[z+0],Ce=3*(ve-ue)+Fl[1020+C[z-2*ie]-C[z+ie]],Fe=_d[112+(Ce+4>>3)];C[z-ie]=Dn[255+ue+_d[112+(Ce+3>>3)]],C[z+0]=Dn[255+ve-Fe]}function na(C,z,ie,ue){var ve=C[z+0],Ce=C[z+ie];return Hi[255+C[z-2*ie]-C[z-ie]]>ue||Hi[255+Ce-ve]>ue}function hr(C,z,ie,ue){return 4*Hi[255+C[z-ie]-C[z+0]]+Hi[255+C[z-2*ie]-C[z+ie]]<=ue}function fa(C,z,ie,ue,ve){var Ce=C[z-3*ie],Fe=C[z-2*ie],De=C[z-ie],qe=C[z+0],et=C[z+ie],vt=C[z+2*ie],Dt=C[z+3*ie];return 4*Hi[255+De-qe]+Hi[255+Fe-et]>ue?0:Hi[255+C[z-4*ie]-Ce]<=ve&&Hi[255+Ce-Fe]<=ve&&Hi[255+Fe-De]<=ve&&Hi[255+Dt-vt]<=ve&&Hi[255+vt-et]<=ve&&Hi[255+et-qe]<=ve}function er(C,z,ie,ue){var ve=2*ue+1;for(ue=0;16>ue;++ue)hr(C,z+ue,ie,ve)&&dn(C,z+ue,ie)}function Jr(C,z,ie,ue){var ve=2*ue+1;for(ue=0;16>ue;++ue)hr(C,z+ue*ie,1,ve)&&dn(C,z+ue*ie,1)}function Ea(C,z,ie,ue){var ve;for(ve=3;0<ve;--ve)er(C,z+=4*ie,ie,ue)}function Sl(C,z,ie,ue){var ve;for(ve=3;0<ve;--ve)Jr(C,z+=4,ie,ue)}function $s(C,z,ie,ue,ve,Ce,Fe,De){for(Ce=2*Ce+1;0<ve--;){if(fa(C,z,ie,Ce,Fe))if(na(C,z,ie,De))dn(C,z,ie);else{var qe=C,et=z,vt=ie,Dt=qe[et-2*vt],Pt=qe[et-vt],kt=qe[et+0],as=qe[et+vt],Gt=qe[et+2*vt],yt=27*(Xt=Fl[1020+3*(kt-Pt)+Fl[1020+Dt-as]])+63>>7,jt=18*Xt+63>>7,Xt=9*Xt+63>>7;qe[et-3*vt]=Dn[255+qe[et-3*vt]+Xt],qe[et-2*vt]=Dn[255+Dt+jt],qe[et-vt]=Dn[255+Pt+yt],qe[et+0]=Dn[255+kt-yt],qe[et+vt]=Dn[255+as-jt],qe[et+2*vt]=Dn[255+Gt-Xt]}z+=ue}}function mr(C,z,ie,ue,ve,Ce,Fe,De){for(Ce=2*Ce+1;0<ve--;){if(fa(C,z,ie,Ce,Fe))if(na(C,z,ie,De))dn(C,z,ie);else{var qe=C,et=z,vt=ie,Dt=qe[et-vt],Pt=qe[et+0],kt=qe[et+vt],as=_d[112+((Gt=3*(Pt-Dt))+4>>3)],Gt=_d[112+(Gt+3>>3)],yt=as+1>>1;qe[et-2*vt]=Dn[255+qe[et-2*vt]+yt],qe[et-vt]=Dn[255+Dt+Gt],qe[et+0]=Dn[255+Pt-as],qe[et+vt]=Dn[255+kt-yt]}z+=ue}}function ol(C,z,ie,ue,ve,Ce){$s(C,z,ie,1,16,ue,ve,Ce)}function ja(C,z,ie,ue,ve,Ce){$s(C,z,1,ie,16,ue,ve,Ce)}function Ro(C,z,ie,ue,ve,Ce){var Fe;for(Fe=3;0<Fe;--Fe)mr(C,z+=4*ie,ie,1,16,ue,ve,Ce)}function Oo(C,z,ie,ue,ve,Ce){var Fe;for(Fe=3;0<Fe;--Fe)mr(C,z+=4,1,ie,16,ue,ve,Ce)}function pc(C,z,ie,ue,ve,Ce,Fe,De){$s(C,z,ve,1,8,Ce,Fe,De),$s(ie,ue,ve,1,8,Ce,Fe,De)}function Nu(C,z,ie,ue,ve,Ce,Fe,De){$s(C,z,1,ve,8,Ce,Fe,De),$s(ie,ue,1,ve,8,Ce,Fe,De)}function xc(C,z,ie,ue,ve,Ce,Fe,De){mr(C,z+4*ve,ve,1,8,Ce,Fe,De),mr(ie,ue+4*ve,ve,1,8,Ce,Fe,De)}function ud(C,z,ie,ue,ve,Ce,Fe,De){mr(C,z+4,1,ve,8,Ce,Fe,De),mr(ie,ue+4,1,ve,8,Ce,Fe,De)}function Cl(){this.ba=new Ne,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ge,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Qo(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ad(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function EA(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new D,this.yc=new T}function Kh(){this.xb=this.a=0,this.l=new ka,this.ca=new Ne,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new _,this.Pb=0,this.wd=new _,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new EA,this.ab=0,this.gc=l(4,Ad),this.Oc=0}function hd(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new ka,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Zl(C,z,ie,ue,ve,Ce,Fe){for(C=C==null?0:C[z+0],z=0;z<Fe;++z)ve[Ce+z]=C+ie[ue+z]&255,C=ve[Ce+z]}function wu(C,z,ie,ue,ve,Ce,Fe){var De;if(C==null)Zl(null,null,ie,ue,ve,Ce,Fe);else for(De=0;De<Fe;++De)ve[Ce+De]=C[z+De]+ie[ue+De]&255}function Mo(C,z,ie,ue,ve,Ce,Fe){if(C==null)Zl(null,null,ie,ue,ve,Ce,Fe);else{var De,qe=C[z+0],et=qe,vt=qe;for(De=0;De<Fe;++De)et=vt+(qe=C[z+De])-et,vt=ie[ue+De]+(-256&et?0>et?0:255:et)&255,et=qe,ve[Ce+De]=vt}}function _u(C,z,ie,ue){var ve=z.width,Ce=z.o;if(s(C!=null&&z!=null),0>ie||0>=ue||ie+ue>Ce)return null;if(!C.Cc){if(C.ga==null){var Fe;if(C.ga=new hd,(Fe=C.ga==null)||(Fe=z.width*z.o,s(C.Gb.length==0),C.Gb=i(Fe),C.Uc=0,C.Gb==null?Fe=0:(C.mb=C.Gb,C.nb=C.Uc,C.rc=null,Fe=1),Fe=!Fe),!Fe){Fe=C.ga;var De=C.Fa,qe=C.P,et=C.qc,vt=C.mb,Dt=C.nb,Pt=qe+1,kt=et-1,as=Fe.l;if(s(De!=null&&vt!=null&&z!=null),yn[0]=null,yn[1]=Zl,yn[2]=wu,yn[3]=Mo,Fe.ca=vt,Fe.tb=Dt,Fe.c=z.width,Fe.i=z.height,s(0<Fe.c&&0<Fe.i),1>=et)z=0;else if(Fe.$a=De[qe+0]>>0&3,Fe.Z=De[qe+0]>>2&3,Fe.Lc=De[qe+0]>>4&3,qe=De[qe+0]>>6&3,0>Fe.$a||1<Fe.$a||4<=Fe.Z||1<Fe.Lc||qe)z=0;else if(as.put=ge,as.ac=pt,as.bc=rt,as.ma=Fe,as.width=z.width,as.height=z.height,as.Da=z.Da,as.v=z.v,as.va=z.va,as.j=z.j,as.o=z.o,Fe.$a)e:{s(Fe.$a==1),z=Ft();t:for(;;){if(z==null){z=0;break e}if(s(Fe!=null),Fe.mc=z,z.c=Fe.c,z.i=Fe.i,z.l=Fe.l,z.l.ma=Fe,z.l.width=Fe.c,z.l.height=Fe.i,z.a=0,R(z.m,De,Pt,kt),!Bt(Fe.c,Fe.i,1,z,null)||(z.ab==1&&z.gc[0].hc==3&&Se(z.s)?(Fe.ic=1,De=z.c*z.i,z.Ta=null,z.Ua=0,z.V=i(De),z.Ba=0,z.V==null?(z.a=1,z=0):z=1):(Fe.ic=0,z=Tt(z,Fe.c)),!z))break t;z=1;break e}Fe.mc=null,z=0}else z=kt>=Fe.c*Fe.i;Fe=!z}if(Fe)return null;C.ga.Lc!=1?C.Ga=0:ue=Ce-ie}s(C.ga!=null),s(ie+ue<=Ce);e:{if(z=(De=C.ga).c,Ce=De.l.o,De.$a==0){if(Pt=C.rc,kt=C.Vc,as=C.Fa,qe=C.P+1+ie*z,et=C.mb,vt=C.nb+ie*z,s(qe<=C.P+C.qc),De.Z!=0)for(s(yn[De.Z]!=null),Fe=0;Fe<ue;++Fe)yn[De.Z](Pt,kt,as,qe,et,vt,z),Pt=et,kt=vt,vt+=z,qe+=z;else for(Fe=0;Fe<ue;++Fe)a(et,vt,as,qe,z),Pt=et,kt=vt,vt+=z,qe+=z;C.rc=Pt,C.Vc=kt}else{if(s(De.mc!=null),z=ie+ue,s((Fe=De.mc)!=null),s(z<=Fe.i),Fe.C>=z)z=1;else if(De.ic||Lt(),De.ic){De=Fe.V,Pt=Fe.Ba,kt=Fe.c;var Gt=Fe.i,yt=(as=1,qe=Fe.$/kt,et=Fe.$%kt,vt=Fe.m,Dt=Fe.s,Fe.$),jt=kt*Gt,Xt=kt*z,Yt=Dt.wc,es=yt<Xt?Kt(Dt,et,qe):null;s(yt<=jt),s(z<=Gt),s(Se(Dt));t:for(;;){for(;!vt.h&&yt<Xt;){if(et&Yt||(es=Kt(Dt,et,qe)),s(es!=null),U(vt),256>(Gt=Je(es.G[0],es.H[0],vt)))De[Pt+yt]=Gt,++yt,++et>=kt&&(et=0,++qe<=z&&!(qe%16)&&Ye(Fe,qe));else{if(!(280>Gt)){as=0;break t}Gt=ft(Gt-256,vt);var _s,vs=Je(es.G[4],es.H[4],vt);if(U(vt),!(yt>=(vs=St(kt,vs=ft(vs,vt)))&&jt-yt>=Gt)){as=0;break t}for(_s=0;_s<Gt;++_s)De[Pt+yt+_s]=De[Pt+yt+_s-vs];for(yt+=Gt,et+=Gt;et>=kt;)et-=kt,++qe<=z&&!(qe%16)&&Ye(Fe,qe);yt<Xt&&et&Yt&&(es=Kt(Dt,et,qe))}s(vt.h==E(vt))}Ye(Fe,qe>z?z:qe);break t}!as||vt.h&&yt<jt?(as=0,Fe.a=vt.h?5:3):Fe.$=yt,z=as}else z=st(Fe,Fe.V,Fe.Ba,Fe.c,Fe.i,z,Me);if(!z){ue=0;break e}}ie+ue>=Ce&&(C.Cc=1),ue=1}if(!ue)return null;if(C.Cc&&((ue=C.ga)!=null&&(ue.mc=null),C.ga=null,0<C.Ga))return alert("todo:WebPDequantizeLevels"),null}return C.nb+ie*ve}function re(C,z,ie,ue,ve,Ce){for(;0<ve--;){var Fe,De=C,qe=z+(ie?1:0),et=C,vt=z+(ie?0:3);for(Fe=0;Fe<ue;++Fe){var Dt=et[vt+4*Fe];Dt!=255&&(Dt*=32897,De[qe+4*Fe+0]=De[qe+4*Fe+0]*Dt>>23,De[qe+4*Fe+1]=De[qe+4*Fe+1]*Dt>>23,De[qe+4*Fe+2]=De[qe+4*Fe+2]*Dt>>23)}z+=Ce}}function ye(C,z,ie,ue,ve){for(;0<ue--;){var Ce;for(Ce=0;Ce<ie;++Ce){var Fe=C[z+2*Ce+0],De=15&(et=C[z+2*Ce+1]),qe=4369*De,et=(240&et|et>>4)*qe>>16;C[z+2*Ce+0]=(240&Fe|Fe>>4)*qe>>16&240|(15&Fe|Fe<<4)*qe>>16>>4&15,C[z+2*Ce+1]=240&et|De}z+=ve}}function ot(C,z,ie,ue,ve,Ce,Fe,De){var qe,et,vt=255;for(et=0;et<ve;++et){for(qe=0;qe<ue;++qe){var Dt=C[z+qe];Ce[Fe+4*qe]=Dt,vt&=Dt}z+=ie,Fe+=De}return vt!=255}function gt(C,z,ie,ue,ve){var Ce;for(Ce=0;Ce<ve;++Ce)ie[ue+Ce]=C[z+Ce]>>8}function Lt(){Yn=re,Hr=ye,Lr=ot,ga=gt}function zt(C,z,ie){B[C]=function(ue,ve,Ce,Fe,De,qe,et,vt,Dt,Pt,kt,as,Gt,yt,jt,Xt,Yt){var es,_s=Yt-1>>1,vs=De[qe+0]|et[vt+0]<<16,Rs=Dt[Pt+0]|kt[as+0]<<16;s(ue!=null);var ys=3*vs+Rs+131074>>2;for(z(ue[ve+0],255&ys,ys>>16,Gt,yt),Ce!=null&&(ys=3*Rs+vs+131074>>2,z(Ce[Fe+0],255&ys,ys>>16,jt,Xt)),es=1;es<=_s;++es){var vr=De[qe+es]|et[vt+es]<<16,br=Dt[Pt+es]|kt[as+es]<<16,fr=vs+vr+Rs+br+524296,ar=fr+2*(vr+Rs)>>3;ys=ar+vs>>1,vs=(fr=fr+2*(vs+br)>>3)+vr>>1,z(ue[ve+2*es-1],255&ys,ys>>16,Gt,yt+(2*es-1)*ie),z(ue[ve+2*es-0],255&vs,vs>>16,Gt,yt+(2*es-0)*ie),Ce!=null&&(ys=fr+Rs>>1,vs=ar+br>>1,z(Ce[Fe+2*es-1],255&ys,ys>>16,jt,Xt+(2*es-1)*ie),z(Ce[Fe+2*es+0],255&vs,vs>>16,jt,Xt+(2*es+0)*ie)),vs=vr,Rs=br}1&Yt||(ys=3*vs+Rs+131074>>2,z(ue[ve+Yt-1],255&ys,ys>>16,Gt,yt+(Yt-1)*ie),Ce!=null&&(ys=3*Rs+vs+131074>>2,z(Ce[Fe+Yt-1],255&ys,ys>>16,jt,Xt+(Yt-1)*ie)))}}function os(){Jn[TA]=pg,Jn[Wo]=Go,Jn[$f]=xg,Jn[Eu]=kd,Jn[Fu]=kc,Jn[qr]=Pu,Jn[IA]=Jh,Jn[Sd]=Go,Jn[Sc]=kd,Jn[Tu]=kc,Jn[Iu]=Pu}function ws(C){return C&-16384?0>C?0:255:C>>Ko}function Us(C,z){return ws((19077*C>>8)+(26149*z>>8)-14234)}function sr(C,z,ie){return ws((19077*C>>8)-(6419*z>>8)-(13320*ie>>8)+8708)}function tr(C,z){return ws((19077*C>>8)+(33050*z>>8)-17685)}function Ar(C,z,ie,ue,ve){ue[ve+0]=Us(C,ie),ue[ve+1]=sr(C,z,ie),ue[ve+2]=tr(C,z)}function ia(C,z,ie,ue,ve){ue[ve+0]=tr(C,z),ue[ve+1]=sr(C,z,ie),ue[ve+2]=Us(C,ie)}function pa(C,z,ie,ue,ve){var Ce=sr(C,z,ie);z=Ce<<3&224|tr(C,z)>>3,ue[ve+0]=248&Us(C,ie)|Ce>>5,ue[ve+1]=z}function Fa(C,z,ie,ue,ve){var Ce=240&tr(C,z)|15;ue[ve+0]=240&Us(C,ie)|sr(C,z,ie)>>4,ue[ve+1]=Ce}function gn(C,z,ie,ue,ve){ue[ve+0]=255,Ar(C,z,ie,ue,ve+1)}function tn(C,z,ie,ue,ve){ia(C,z,ie,ue,ve),ue[ve+3]=255}function cl(C,z,ie,ue,ve){Ar(C,z,ie,ue,ve),ue[ve+3]=255}function wi(C,z){return 0>C?0:C>z?z:C}function Mi(C,z,ie){B[C]=function(ue,ve,Ce,Fe,De,qe,et,vt,Dt){for(var Pt=vt+(-2&Dt)*ie;vt!=Pt;)z(ue[ve+0],Ce[Fe+0],De[qe+0],et,vt),z(ue[ve+1],Ce[Fe+0],De[qe+0],et,vt+ie),ve+=2,++Fe,++qe,vt+=2*ie;1&Dt&&z(ue[ve+0],Ce[Fe+0],De[qe+0],et,vt)}}function Ho(C,z,ie){return ie==0?C==0?z==0?6:5:z==0?4:0:ie}function Su(C,z,ie,ue,ve){switch(C>>>30){case 3:ro(z,ie,ue,ve,0);break;case 2:wr(z,ie,ue,ve);break;case 1:bn(z,ie,ue,ve)}}function md(C,z){var ie,ue,ve=z.M,Ce=z.Nb,Fe=C.oc,De=C.pc+40,qe=C.oc,et=C.pc+584,vt=C.oc,Dt=C.pc+600;for(ie=0;16>ie;++ie)Fe[De+32*ie-1]=129;for(ie=0;8>ie;++ie)qe[et+32*ie-1]=129,vt[Dt+32*ie-1]=129;for(0<ve?Fe[De-1-32]=qe[et-1-32]=vt[Dt-1-32]=129:(n(Fe,De-32-1,127,21),n(qe,et-32-1,127,9),n(vt,Dt-32-1,127,9)),ue=0;ue<C.za;++ue){var Pt=z.ya[z.aa+ue];if(0<ue){for(ie=-1;16>ie;++ie)a(Fe,De+32*ie-4,Fe,De+32*ie+12,4);for(ie=-1;8>ie;++ie)a(qe,et+32*ie-4,qe,et+32*ie+4,4),a(vt,Dt+32*ie-4,vt,Dt+32*ie+4,4)}var kt=C.Gd,as=C.Hd+ue,Gt=Pt.ad,yt=Pt.Hc;if(0<ve&&(a(Fe,De-32,kt[as].y,0,16),a(qe,et-32,kt[as].f,0,8),a(vt,Dt-32,kt[as].ea,0,8)),Pt.Za){var jt=Fe,Xt=De-32+16;for(0<ve&&(ue>=C.za-1?n(jt,Xt,kt[as].y[15],4):a(jt,Xt,kt[as+1].y,0,4)),ie=0;4>ie;ie++)jt[Xt+128+ie]=jt[Xt+256+ie]=jt[Xt+384+ie]=jt[Xt+0+ie];for(ie=0;16>ie;++ie,yt<<=2)jt=Fe,Xt=De+Zh[ie],qi[Pt.Ob[ie]](jt,Xt),Su(yt,Gt,16*+ie,jt,Xt)}else if(jt=Ho(ue,ve,Pt.Ob[0]),Pn[jt](Fe,De),yt!=0)for(ie=0;16>ie;++ie,yt<<=2)Su(yt,Gt,16*+ie,Fe,De+Zh[ie]);for(ie=Pt.Gc,jt=Ho(ue,ve,Pt.Dd),Xn[jt](qe,et),Xn[jt](vt,Dt),yt=Gt,jt=qe,Xt=et,255&(Pt=ie>>0)&&(170&Pt?ao(yt,256,jt,Xt):_i(yt,256,jt,Xt)),Pt=vt,yt=Dt,255&(ie>>=8)&&(170&ie?ao(Gt,320,Pt,yt):_i(Gt,320,Pt,yt)),ve<C.Ub-1&&(a(kt[as].y,0,Fe,De+480,16),a(kt[as].f,0,qe,et+224,8),a(kt[as].ea,0,vt,Dt+224,8)),ie=8*Ce*C.B,kt=C.sa,as=C.ta+16*ue+16*Ce*C.R,Gt=C.qa,Pt=C.ra+8*ue+ie,yt=C.Ha,jt=C.Ia+8*ue+ie,ie=0;16>ie;++ie)a(kt,as+ie*C.R,Fe,De+32*ie,16);for(ie=0;8>ie;++ie)a(Gt,Pt+ie*C.B,qe,et+32*ie,8),a(yt,jt+ie*C.B,vt,Dt+32*ie,8)}}function gc(C,z,ie,ue,ve,Ce,Fe,De,qe){var et=[0],vt=[0],Dt=0,Pt=qe!=null?qe.kd:0,kt=qe??new Qo;if(C==null||12>ie)return 7;kt.data=C,kt.w=z,kt.ha=ie,z=[z],ie=[ie],kt.gb=[kt.gb];e:{var as=z,Gt=ie,yt=kt.gb;if(s(C!=null),s(Gt!=null),s(yt!=null),yt[0]=0,12<=Gt[0]&&!r(C,as[0],"RIFF")){if(r(C,as[0]+8,"WEBP")){yt=3;break e}var jt=Ae(C,as[0]+4);if(12>jt||4294967286<jt){yt=3;break e}if(Pt&&jt>Gt[0]-8){yt=7;break e}yt[0]=jt,as[0]+=12,Gt[0]-=12}yt=0}if(yt!=0)return yt;for(jt=0<kt.gb[0],ie=ie[0];;){e:{var Xt=C;Gt=z,yt=ie;var Yt=et,es=vt,_s=as=[0];if((ys=Dt=[Dt])[0]=0,8>yt[0])yt=7;else{if(!r(Xt,Gt[0],"VP8X")){if(Ae(Xt,Gt[0]+4)!=10){yt=3;break e}if(18>yt[0]){yt=7;break e}var vs=Ae(Xt,Gt[0]+8),Rs=1+se(Xt,Gt[0]+12);if(2147483648<=Rs*(Xt=1+se(Xt,Gt[0]+15))){yt=3;break e}_s!=null&&(_s[0]=vs),Yt!=null&&(Yt[0]=Rs),es!=null&&(es[0]=Xt),Gt[0]+=18,yt[0]-=18,ys[0]=1}yt=0}}if(Dt=Dt[0],as=as[0],yt!=0)return yt;if(Gt=!!(2&as),!jt&&Dt)return 3;if(Ce!=null&&(Ce[0]=!!(16&as)),Fe!=null&&(Fe[0]=Gt),De!=null&&(De[0]=0),Fe=et[0],as=vt[0],Dt&&Gt&&qe==null){yt=0;break}if(4>ie){yt=7;break}if(jt&&Dt||!jt&&!Dt&&!r(C,z[0],"ALPH")){ie=[ie],kt.na=[kt.na],kt.P=[kt.P],kt.Sa=[kt.Sa];e:{vs=C,yt=z,jt=ie;var ys=kt.gb;Yt=kt.na,es=kt.P,_s=kt.Sa,Rs=22,s(vs!=null),s(jt!=null),Xt=yt[0];var vr=jt[0];for(s(Yt!=null),s(_s!=null),Yt[0]=null,es[0]=null,_s[0]=0;;){if(yt[0]=Xt,jt[0]=vr,8>vr){yt=7;break e}var br=Ae(vs,Xt+4);if(4294967286<br){yt=3;break e}var fr=8+br+1&-2;if(Rs+=fr,0<ys&&Rs>ys){yt=3;break e}if(!r(vs,Xt,"VP8 ")||!r(vs,Xt,"VP8L")){yt=0;break e}if(vr[0]<fr){yt=7;break e}r(vs,Xt,"ALPH")||(Yt[0]=vs,es[0]=Xt+8,_s[0]=br),Xt+=fr,vr-=fr}}if(ie=ie[0],kt.na=kt.na[0],kt.P=kt.P[0],kt.Sa=kt.Sa[0],yt!=0)break}ie=[ie],kt.Ja=[kt.Ja],kt.xa=[kt.xa];e:if(ys=C,yt=z,jt=ie,Yt=kt.gb[0],es=kt.Ja,_s=kt.xa,vs=yt[0],Xt=!r(ys,vs,"VP8 "),Rs=!r(ys,vs,"VP8L"),s(ys!=null),s(jt!=null),s(es!=null),s(_s!=null),8>jt[0])yt=7;else{if(Xt||Rs){if(ys=Ae(ys,vs+4),12<=Yt&&ys>Yt-12){yt=3;break e}if(Pt&&ys>jt[0]-8){yt=7;break e}es[0]=ys,yt[0]+=8,jt[0]-=8,_s[0]=Rs}else _s[0]=5<=jt[0]&&ys[vs+0]==47&&!(ys[vs+4]>>5),es[0]=jt[0];yt=0}if(ie=ie[0],kt.Ja=kt.Ja[0],kt.xa=kt.xa[0],z=z[0],yt!=0)break;if(4294967286<kt.Ja)return 3;if(De==null||Gt||(De[0]=kt.xa?2:1),Fe=[Fe],as=[as],kt.xa){if(5>ie){yt=7;break}De=Fe,Pt=as,Gt=Ce,C==null||5>ie?C=0:5<=ie&&C[z+0]==47&&!(C[z+4]>>5)?(jt=[0],ys=[0],Yt=[0],R(es=new _,C,z,ie),ht(es,jt,ys,Yt)?(De!=null&&(De[0]=jt[0]),Pt!=null&&(Pt[0]=ys[0]),Gt!=null&&(Gt[0]=Yt[0]),C=1):C=0):C=0}else{if(10>ie){yt=7;break}De=as,C==null||10>ie||!nl(C,z+3,ie-3)?C=0:(Pt=C[z+0]|C[z+1]<<8|C[z+2]<<16,Gt=16383&(C[z+7]<<8|C[z+6]),C=16383&(C[z+9]<<8|C[z+8]),1&Pt||3<(Pt>>1&7)||!(Pt>>4&1)||Pt>>5>=kt.Ja||!Gt||!C?C=0:(Fe&&(Fe[0]=Gt),De&&(De[0]=C),C=1))}if(!C||(Fe=Fe[0],as=as[0],Dt&&(et[0]!=Fe||vt[0]!=as)))return 3;qe!=null&&(qe[0]=kt,qe.offset=z-qe.w,s(4294967286>z-qe.w),s(qe.offset==qe.ha-ie));break}return yt==0||yt==7&&Dt&&qe==null?(Ce!=null&&(Ce[0]|=kt.na!=null&&0<kt.na.length),ue!=null&&(ue[0]=Fe),ve!=null&&(ve[0]=as),0):yt}function fd(C,z,ie){var ue=z.width,ve=z.height,Ce=0,Fe=0,De=ue,qe=ve;if(z.Da=C!=null&&0<C.Da,z.Da&&(De=C.cd,qe=C.bd,Ce=C.v,Fe=C.j,11>ie||(Ce&=-2,Fe&=-2),0>Ce||0>Fe||0>=De||0>=qe||Ce+De>ue||Fe+qe>ve))return 0;if(z.v=Ce,z.j=Fe,z.va=Ce+De,z.o=Fe+qe,z.U=De,z.T=qe,z.da=C!=null&&0<C.da,z.da){if(!_e(De,qe,ie=[C.ib],Ce=[C.hb]))return 0;z.ib=ie[0],z.hb=Ce[0]}return z.ob=C!=null&&C.ob,z.Kb=C==null||!C.Sd,z.da&&(z.ob=z.ib<3*ue/4&&z.hb<3*ve/4,z.Kb=0),1}function pd(C){if(C==null)return 2;if(11>C.S){var z=C.f.RGBA;z.fb+=(C.height-1)*z.A,z.A=-z.A}else z=C.f.kb,C=C.height,z.O+=(C-1)*z.fa,z.fa=-z.fa,z.N+=(C-1>>1)*z.Ab,z.Ab=-z.Ab,z.W+=(C-1>>1)*z.Db,z.Db=-z.Db,z.F!=null&&(z.J+=(C-1)*z.lb,z.lb=-z.lb);return 0}function vc(C,z,ie,ue){if(ue==null||0>=C||0>=z)return 2;if(ie!=null){if(ie.Da){var ve=ie.cd,Ce=ie.bd,Fe=-2&ie.v,De=-2&ie.j;if(0>Fe||0>De||0>=ve||0>=Ce||Fe+ve>C||De+Ce>z)return 2;C=ve,z=Ce}if(ie.da){if(!_e(C,z,ve=[ie.ib],Ce=[ie.hb]))return 2;C=ve[0],z=Ce[0]}}ue.width=C,ue.height=z;e:{var qe=ue.width,et=ue.height;if(C=ue.S,0>=qe||0>=et||!(C>=TA&&13>C))C=2;else{if(0>=ue.Rd&&ue.sd==null){Fe=Ce=ve=z=0;var vt=(De=qe*Uu[C])*et;if(11>C||(Ce=(et+1)/2*(z=(qe+1)/2),C==12&&(Fe=(ve=qe)*et)),(et=i(vt+2*Ce+Fe))==null){C=1;break e}ue.sd=et,11>C?((qe=ue.f.RGBA).eb=et,qe.fb=0,qe.A=De,qe.size=vt):((qe=ue.f.kb).y=et,qe.O=0,qe.fa=De,qe.Fd=vt,qe.f=et,qe.N=0+vt,qe.Ab=z,qe.Cd=Ce,qe.ea=et,qe.W=0+vt+Ce,qe.Db=z,qe.Ed=Ce,C==12&&(qe.F=et,qe.J=0+vt+2*Ce),qe.Tc=Fe,qe.lb=ve)}if(z=1,ve=ue.S,Ce=ue.width,Fe=ue.height,ve>=TA&&13>ve)if(11>ve)C=ue.f.RGBA,z&=(De=Math.abs(C.A))*(Fe-1)+Ce<=C.size,z&=De>=Ce*Uu[ve],z&=C.eb!=null;else{C=ue.f.kb,De=(Ce+1)/2,vt=(Fe+1)/2,qe=Math.abs(C.fa),et=Math.abs(C.Ab);var Dt=Math.abs(C.Db),Pt=Math.abs(C.lb),kt=Pt*(Fe-1)+Ce;z&=qe*(Fe-1)+Ce<=C.Fd,z&=et*(vt-1)+De<=C.Cd,z=(z&=Dt*(vt-1)+De<=C.Ed)&qe>=Ce&et>=De&Dt>=De,z&=C.y!=null,z&=C.f!=null,z&=C.ea!=null,ve==12&&(z&=Pt>=Ce,z&=kt<=C.Tc,z&=C.F!=null)}else z=0;C=z?0:2}}return C!=0||ie!=null&&ie.fd&&(C=pd(ue)),C}var xa=64,xd=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],gd=24,vd=32,bd=8,Tn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ke("Predictor0","PredictorAdd0"),B.Predictor0=function(){return 4278190080},B.Predictor1=function(C){return C},B.Predictor2=function(C,z,ie){return z[ie+0]},B.Predictor3=function(C,z,ie){return z[ie+1]},B.Predictor4=function(C,z,ie){return z[ie-1]},B.Predictor5=function(C,z,ie){return he(he(C,z[ie+1]),z[ie+0])},B.Predictor6=function(C,z,ie){return he(C,z[ie-1])},B.Predictor7=function(C,z,ie){return he(C,z[ie+0])},B.Predictor8=function(C,z,ie){return he(z[ie-1],z[ie+0])},B.Predictor9=function(C,z,ie){return he(z[ie+0],z[ie+1])},B.Predictor10=function(C,z,ie){return he(he(C,z[ie-1]),he(z[ie+0],z[ie+1]))},B.Predictor11=function(C,z,ie){var ue=z[ie+0];return 0>=xe(ue>>24&255,C>>24&255,(z=z[ie-1])>>24&255)+xe(ue>>16&255,C>>16&255,z>>16&255)+xe(ue>>8&255,C>>8&255,z>>8&255)+xe(255&ue,255&C,255&z)?ue:C},B.Predictor12=function(C,z,ie){var ue=z[ie+0];return(je((C>>24&255)+(ue>>24&255)-((z=z[ie-1])>>24&255))<<24|je((C>>16&255)+(ue>>16&255)-(z>>16&255))<<16|je((C>>8&255)+(ue>>8&255)-(z>>8&255))<<8|je((255&C)+(255&ue)-(255&z)))>>>0},B.Predictor13=function(C,z,ie){var ue=z[ie-1];return(me((C=he(C,z[ie+0]))>>24&255,ue>>24&255)<<24|me(C>>16&255,ue>>16&255)<<16|me(C>>8&255,ue>>8&255)<<8|me(C>>0&255,ue>>0&255))>>>0};var bc=B.PredictorAdd0;B.PredictorAdd1=Ue,ke("Predictor2","PredictorAdd2"),ke("Predictor3","PredictorAdd3"),ke("Predictor4","PredictorAdd4"),ke("Predictor5","PredictorAdd5"),ke("Predictor6","PredictorAdd6"),ke("Predictor7","PredictorAdd7"),ke("Predictor8","PredictorAdd8"),ke("Predictor9","PredictorAdd9"),ke("Predictor10","PredictorAdd10"),ke("Predictor11","PredictorAdd11"),ke("Predictor12","PredictorAdd12"),ke("Predictor13","PredictorAdd13");var eo=B.PredictorAdd2;He("ColorIndexInverseTransform","MapARGB","32b",(function(C){return C>>8&255}),(function(C){return C})),He("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(C){return C}),(function(C){return C>>8&255}));var FA,In=B.ColorIndexInverseTransform,yd=B.MapARGB,Cu=B.VP8LColorIndexInverseTransformAlpha,jd=B.MapAlpha,Bl=B.VP8LPredictorsAdd=[];Bl.length=16,(B.VP8LPredictors=[]).length=16,(B.VP8LPredictorsAdd_C=[]).length=16,(B.VP8LPredictors_C=[]).length=16;var qo,Ln,vn,Vo,to,so,Nd,ro,wr,ao,bn,_i,yc,Bu,jc,Nc,wc,Si,no,kl,io,lo,$o,un,Yn,Hr,Lr,ga,Ta=i(511),El=i(2041),wd=i(225),_c=i(767),ku=0,Fl=El,_d=wd,Dn=_c,Hi=Ta,TA=0,Wo=1,$f=2,Eu=3,Fu=4,qr=5,IA=6,Sd=7,Sc=8,Tu=9,Iu=10,Lu=[2,3,7],LA=[3,3,11],Cc=[280,256,256,256,40],Wf=[0,1,1,1,0],Ag=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],hg=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Gf=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],DA=8,Cd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Du=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Bc=null,zh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Yh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Kf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],zf=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],mg=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],fg=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Xh=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Pn=[],qi=[],Xn=[],Tl=1,Bd=2,yn=[],Jn=[];zt("UpsampleRgbLinePair",Ar,3),zt("UpsampleBgrLinePair",ia,3),zt("UpsampleRgbaLinePair",cl,4),zt("UpsampleBgraLinePair",tn,4),zt("UpsampleArgbLinePair",gn,4),zt("UpsampleRgba4444LinePair",Fa,2),zt("UpsampleRgb565LinePair",pa,2);var pg=B.UpsampleRgbLinePair,xg=B.UpsampleBgrLinePair,Go=B.UpsampleRgbaLinePair,kd=B.UpsampleBgraLinePair,kc=B.UpsampleArgbLinePair,Pu=B.UpsampleRgba4444LinePair,Jh=B.UpsampleRgb565LinePair,oo=16,dl=1<<oo-1,Dr=-227,Ur=482,Ko=6,An=0,Zn=i(256),Ec=i(256),Ed=i(256),ei=i(256),PA=i(Ur-Dr),Yf=i(Ur-Dr);Mi("YuvToRgbRow",Ar,3),Mi("YuvToBgrRow",ia,3),Mi("YuvToRgbaRow",cl,4),Mi("YuvToBgraRow",tn,4),Mi("YuvToArgbRow",gn,4),Mi("YuvToRgba4444Row",Fa,2),Mi("YuvToRgb565Row",pa,2);var Zh=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Fc=[0,2,8],Xf=[8,7,6,4,4,2,2,2,1,1,1,1],co=1;this.WebPDecodeRGBA=function(C,z,ie,ue,ve){var Ce=Wo,Fe=new Cl,De=new Ne;Fe.ba=De,De.S=Ce,De.width=[De.width],De.height=[De.height];var qe=De.width,et=De.height,vt=new Xe;if(vt==null||C==null)var Dt=2;else s(vt!=null),Dt=gc(C,z,ie,vt.width,vt.height,vt.Pd,vt.Qd,vt.format,null);if(Dt!=0?qe=0:(qe!=null&&(qe[0]=vt.width[0]),et!=null&&(et[0]=vt.height[0]),qe=1),qe){De.width=De.width[0],De.height=De.height[0],ue!=null&&(ue[0]=De.width),ve!=null&&(ve[0]=De.height);e:{if(ue=new ka,(ve=new Qo).data=C,ve.w=z,ve.ha=ie,ve.kd=1,z=[0],s(ve!=null),((C=gc(ve.data,ve.w,ve.ha,null,null,null,z,null,ve))==0||C==7)&&z[0]&&(C=4),(z=C)==0){if(s(Fe!=null),ue.data=ve.data,ue.w=ve.w+ve.offset,ue.ha=ve.ha-ve.offset,ue.put=ge,ue.ac=pt,ue.bc=rt,ue.ma=Fe,ve.xa){if((C=Ft())==null){Fe=1;break e}if((function(Pt,kt){var as=[0],Gt=[0],yt=[0];t:for(;;){if(Pt==null)return 0;if(kt==null)return Pt.a=2,0;if(Pt.l=kt,Pt.a=0,R(Pt.m,kt.data,kt.w,kt.ha),!ht(Pt.m,as,Gt,yt)){Pt.a=3;break t}if(Pt.xb=Bd,kt.width=as[0],kt.height=Gt[0],!Bt(as[0],Gt[0],1,Pt,null))break t;return 1}return s(Pt.a!=0),0})(C,ue)){if(ue=(z=vc(ue.width,ue.height,Fe.Oa,Fe.ba))==0){t:{ue=C;s:for(;;){if(ue==null){ue=0;break t}if(s(ue.s.yc!=null),s(ue.s.Ya!=null),s(0<ue.s.Wb),s((ie=ue.l)!=null),s((ve=ie.ma)!=null),ue.xb!=0){if(ue.ca=ve.ba,ue.tb=ve.tb,s(ue.ca!=null),!fd(ve.Oa,ie,Eu)){ue.a=2;break s}if(!Tt(ue,ie.width)||ie.da)break s;if((ie.da||Re(ue.ca.S))&&Lt(),11>ue.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ue.ca.f.kb.F!=null&&Lt()),ue.Pb&&0<ue.s.ua&&ue.s.vb.X==null&&!we(ue.s.vb,ue.s.Wa.Xa)){ue.a=1;break s}ue.xb=0}if(!st(ue,ue.V,ue.Ba,ue.c,ue.i,ie.o,Oe))break s;ve.Dc=ue.Ma,ue=1;break t}s(ue.a!=0),ue=0}ue=!ue}ue&&(z=C.a)}else z=C.a}else{if((C=new Ks)==null){Fe=1;break e}if(C.Fa=ve.na,C.P=ve.P,C.qc=ve.Sa,zr(C,ue)){if((z=vc(ue.width,ue.height,Fe.Oa,Fe.ba))==0){if(C.Aa=0,ie=Fe.Oa,s((ve=C)!=null),ie!=null){if(0<(qe=0>(qe=ie.Md)?0:100<qe?255:255*qe/100)){for(et=vt=0;4>et;++et)12>(Dt=ve.pb[et]).lc&&(Dt.ia=qe*Xf[0>Dt.lc?0:Dt.lc]>>3),vt|=Dt.ia;vt&&(alert("todo:VP8InitRandom"),ve.ia=1)}ve.Ga=ie.Id,100<ve.Ga?ve.Ga=100:0>ve.Ga&&(ve.Ga=0)}yi(C,ue)||(z=C.a)}}else z=C.a}z==0&&Fe.Oa!=null&&Fe.Oa.fd&&(z=pd(Fe.ba))}Fe=z}Ce=Fe!=0?null:11>Ce?De.f.RGBA.eb:De.f.kb.y}else Ce=null;return Ce};var Uu=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(B,q){for(var Q="",O=0;O<4;O++)Q+=String.fromCharCode(B[q++]);return Q}function c(B,q){return(B[q+0]<<0|B[q+1]<<8|B[q+2]<<16)>>>0}function m(B,q){return(B[q+0]<<0|B[q+1]<<8|B[q+2]<<16|B[q+3]<<24)>>>0}new u;var h=[0],f=[0],x=[],g=new u,b=t,y=(function(B,q){var Q={},O=0,T=!1,V=0,D=0;if(Q.frames=[],!(function(F,E,L,U){for(var J=0;J<U;J++)if(F[E+J]!=L.charCodeAt(J))return!0;return!1})(B,q,"RIFF",4)){var Y,M;for(m(B,q+=4),q+=8;q<B.length;){var X=d(B,q),R=m(B,q+=4);q+=4;var H=R+(1&R);switch(X){case"VP8 ":case"VP8L":Q.frames[O]===void 0&&(Q.frames[O]={}),(_=Q.frames[O]).src_off=T?D:q-8,_.src_size=V+R+8,O++,T&&(T=!1,V=0,D=0);break;case"VP8X":(_=Q.header={}).feature_flags=B[q];var W=q+4;_.canvas_width=1+c(B,W),W+=3,_.canvas_height=1+c(B,W),W+=3;break;case"ALPH":T=!0,V=H+8,D=q-8;break;case"ANIM":(_=Q.header).bgcolor=m(B,q),W=q+4,_.loop_count=(Y=B)[(M=W)+0]<<0|Y[M+1]<<8,W+=2;break;case"ANMF":var K,_;(_=Q.frames[O]={}).offset_x=2*c(B,q),q+=3,_.offset_y=2*c(B,q),q+=3,_.width=1+c(B,q),q+=3,_.height=1+c(B,q),q+=3,_.duration=c(B,q),q+=3,K=B[q++],_.dispose=1&K,_.blend=K>>1&1}X!="ANMF"&&(q+=H)}return Q}})(b,0);y.response=b,y.rgbaoutput=!0,y.dataurl=!1;var N=y.header?y.header:null,j=y.frames?y.frames:null;if(N){N.loop_counter=N.loop_count,h=[N.canvas_height],f=[N.canvas_width];for(var S=0;S<j.length&&j[S].blend!=0;S++);}var k=j[0],P=g.WebPDecodeRGBA(b,k.src_off,k.src_size,f,h);k.rgba=P,k.imgwidth=f[0],k.imgheight=h[0];for(var I=0;I<f[0]*h[0]*4;I++)x[I]=P[I];return this.width=f,this.height=h,this.data=x,this}(function(t){var s=function(){return typeof Mb=="function"},r=function(h,f,x,g){var b=4,y=l;switch(g){case t.image_compression.FAST:b=1,y=i;break;case t.image_compression.MEDIUM:b=6,y=o;break;case t.image_compression.SLOW:b=9,y=u}h=a(h,f,x,y);var N=Mb(h,{level:b});return t.__addimage__.arrayBufferToBinaryString(N)},a=function(h,f,x,g){for(var b,y,N,j=h.length/f,S=new Uint8Array(h.length+j),k=c(),P=0;P<j;P+=1){if(N=P*f,b=h.subarray(N,N+f),g)S.set(g(b,x,y),N+P);else{for(var I,B=k.length,q=[];I<B;I+=1)q[I]=k[I](b,x,y);var Q=m(q.concat());S.set(q[Q],N+P)}y=b}return S},n=function(h){var f=Array.apply([],h);return f.unshift(0),f},i=function(h,f){var x,g=[],b=h.length;g[0]=1;for(var y=0;y<b;y+=1)x=h[y-f]||0,g[y+1]=h[y]-x+256&255;return g},l=function(h,f,x){var g,b=[],y=h.length;b[0]=2;for(var N=0;N<y;N+=1)g=x&&x[N]||0,b[N+1]=h[N]-g+256&255;return b},o=function(h,f,x){var g,b,y=[],N=h.length;y[0]=3;for(var j=0;j<N;j+=1)g=h[j-f]||0,b=x&&x[j]||0,y[j+1]=h[j]+256-(g+b>>>1)&255;return y},u=function(h,f,x){var g,b,y,N,j=[],S=h.length;j[0]=4;for(var k=0;k<S;k+=1)g=h[k-f]||0,b=x&&x[k]||0,y=x&&x[k-f]||0,N=d(g,b,y),j[k+1]=h[k]-N+256&255;return j},d=function(h,f,x){if(h===f&&f===x)return h;var g=Math.abs(f-x),b=Math.abs(h-x),y=Math.abs(h+f-x-x);return g<=b&&g<=y?h:b<=y?f:x},c=function(){return[n,i,l,o,u]},m=function(h){var f=h.map((function(x){return x.reduce((function(g,b){return g+Math.abs(b)}),0)}));return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(h,f,x,g){var b,y,N,j,S,k,P,I,B,q,Q,O,T,V,D,Y=this.decode.FLATE_DECODE,M="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(N=new VL(h)).imgData,y=N.bits,b=N.colorSpace,S=N.colors,[4,6].indexOf(N.colorType)!==-1){if(N.bits===8){B=(I=N.pixelBitlength==32?new Uint32Array(N.decodePixels().buffer):N.pixelBitlength==16?new Uint16Array(N.decodePixels().buffer):new Uint8Array(N.decodePixels().buffer)).length,Q=new Uint8Array(B*N.colors),q=new Uint8Array(B);var X,R=N.pixelBitlength-N.bits;for(V=0,D=0;V<B;V++){for(T=I[V],X=0;X<R;)Q[D++]=T>>>X&255,X+=N.bits;q[V]=T>>>X&255}}if(N.bits===16){B=(I=new Uint32Array(N.decodePixels().buffer)).length,Q=new Uint8Array(B*(32/N.pixelBitlength)*N.colors),q=new Uint8Array(B*(32/N.pixelBitlength)),O=N.colors>1,V=0,D=0;for(var H=0;V<B;)T=I[V++],Q[D++]=T>>>0&255,O&&(Q[D++]=T>>>16&255,T=I[V++],Q[D++]=T>>>0&255),q[H++]=T>>>16&255;y=8}g!==t.image_compression.NONE&&s()?(h=r(Q,N.width*N.colors,N.colors,g),P=r(q,N.width,1,g)):(h=Q,P=q,Y=void 0)}if(N.colorType===3&&(b=this.color_spaces.INDEXED,k=N.palette,N.transparency.indexed)){var W=N.transparency.indexed,K=0;for(V=0,B=W.length;V<B;++V)K+=W[V];if((K/=255)===B-1&&W.indexOf(0)!==-1)j=[W.indexOf(0)];else if(K!==B){for(I=N.decodePixels(),q=new Uint8Array(I.length),V=0,B=I.length;V<B;V++)q[V]=W[I[V]];P=r(q,N.width,1)}}var _=(function(F){var E;switch(F){case t.image_compression.FAST:E=11;break;case t.image_compression.MEDIUM:E=13;break;case t.image_compression.SLOW:E=14;break;default:E=12}return E})(g);return Y===this.decode.FLATE_DECODE&&(M="/Predictor "+_+" "),M+="/Colors "+S+" /BitsPerComponent "+y+" /Columns "+N.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(P&&this.__addimage__.isArrayBuffer(P)||this.__addimage__.isArrayBufferView(P))&&(P=this.__addimage__.arrayBufferToBinaryString(P)),{alias:x,data:h,index:f,filter:Y,decodeParameters:M,transparency:j,palette:k,sMask:P,predictor:_,width:N.width,height:N.height,bitsPerComponent:y,colorSpace:b}}}})(As.API),(function(t){t.processGIF89A=function(s,r,a,n){var i=new $L(s),l=i.width,o=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var d={data:u,width:l,height:o},c=new Cv(100).encode(d,100);return t.processJPEG.call(this,c,r,a,n)},t.processGIF87A=t.processGIF89A})(As.API),yo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var s=0;s<t;s++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[s]={red:n,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,s=this.width*this.height*4;this.data=new Uint8Array(s),this[t]()}catch(r){ta.log("bit decode error:"+r)}},yo.prototype.bit1=function(){var t,s=Math.ceil(this.width/8),r=s%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<s;n++)for(var i=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var u=this.palette[i>>7-o&1];this.data[l+4*o]=u.blue,this.data[l+4*o+1]=u.green,this.data[l+4*o+2]=u.red,this.data[l+4*o+3]=255}r!==0&&(this.pos+=4-r)}},yo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),s=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var i=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*n*4,o=i>>4,u=15&i,d=this.palette[o];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*n+1>=this.width)break;d=this.palette[u],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}s!==0&&(this.pos+=4-s)}},yo.prototype.bit8=function(){for(var t=this.width%4,s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(n<this.palette.length){var l=this.palette[n];this.data[i]=l.red,this.data[i+1]=l.green,this.data[i+2]=l.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},yo.prototype.bit15=function(){for(var t=this.width%3,s=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&s)/s*255|0,o=(i>>5&s)/s*255|0,u=(i>>10&s)/s*255|0,d=i>>15?255:0,c=a*this.width*4+4*n;this.data[c]=u,this.data[c+1]=o,this.data[c+2]=l,this.data[c+3]=d}this.pos+=t}},yo.prototype.bit16=function(){for(var t=this.width%3,s=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(l&s)/s*255|0,u=(l>>5&r)/r*255|0,d=(l>>11)/s*255|0,c=n*this.width*4+4*i;this.data[c]=d,this.data[c+1]=u,this.data[c+2]=o,this.data[c+3]=255}this.pos+=t}},yo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=s*this.width*4+4*r;this.data[l]=i,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},yo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=l}},yo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(s,r,a,n){var i=new yo(s,!1),l=i.width,o=i.height,u={data:i.getData(),width:l,height:o},d=new Cv(100).encode(u,100);return t.processJPEG.call(this,d,r,a,n)}})(As.API),Ew.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(s,r,a,n){var i=new Ew(s),l=i.width,o=i.height,u={data:i.getData(),width:l,height:o},d=new Cv(100).encode(u,100);return t.processJPEG.call(this,d,r,a,n)}})(As.API),As.API.processRGBA=function(t,s,r){for(var a=t.data,n=a.length,i=new Uint8Array(n/4*3),l=new Uint8Array(n/4),o=0,u=0,d=0;d<n;d+=4){var c=a[d],m=a[d+1],h=a[d+2],f=a[d+3];i[o++]=c,i[o++]=m,i[o++]=h,l[u++]=f}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:x,index:s,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},As.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},ZA=As.API,Pp=ZA.getCharWidthsArray=function(t,s){var r,a,n=(s=s||{}).font||this.internal.getFont(),i=s.fontSize||this.internal.getFontSize(),l=s.charSpace||this.internal.getCharSpace(),o=s.widths?s.widths:n.metadata.Unicode.widths,u=o.fof?o.fof:1,d=s.kerning?s.kerning:n.metadata.Unicode.kerning,c=d.fof?d.fof:1,m=s.doKerning!==!1,h=0,f=t.length,x=0,g=o[0]||u,b=[];for(r=0;r<f;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?b.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+l*(1e3/i)||0)/1e3):(h=m&&Gr(d[a])==="object"&&!isNaN(parseInt(d[a][x],10))?d[a][x]/c:0,b.push((o[a]||g)/u+h)),x=a;return b},Sw=ZA.getStringUnitWidth=function(t,s){var r=(s=s||{}).fontSize||this.internal.getFontSize(),a=s.font||this.internal.getFont(),n=s.charSpace||this.internal.getCharSpace();return ZA.processArabic&&(t=ZA.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:Pp.apply(this,arguments).reduce((function(i,l){return i+l}),0)},Cw=function(t,s,r,a){for(var n=[],i=0,l=t.length,o=0;i!==l&&o+s[i]<r;)o+=s[i],i++;n.push(t.slice(0,i));var u=i;for(o=0;i!==l;)o+s[i]>a&&(n.push(t.slice(u,i)),o=0,u=i),o+=s[i],i++;return u!==i&&n.push(t.slice(u,i)),n},Bw=function(t,s,r){r||(r={});var a,n,i,l,o,u,d,c=[],m=[c],h=r.textIndent||0,f=0,x=0,g=t.split(" "),b=Pp.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var y=Array(u).join(" "),N=[];g.map((function(S){(S=S.split(/\s*\n/)).length>1?N=N.concat(S.map((function(k,P){return(P&&k.length?`
`:"")+k}))):N.push(S[0])})),g=N,u=Sw.apply(this,[y,r])}for(i=0,l=g.length;i<l;i++){var j=0;if(a=g[i],u&&a[0]==`
`&&(a=a.substr(1),j=1),h+f+(x=(n=Pp.apply(this,[a,r])).reduce((function(S,k){return S+k}),0))>s||j){if(x>s){for(o=Cw.apply(this,[a,n,s-(h+f),s]),c.push(o.shift()),c=[o.pop()];o.length;)m.push([o.shift()]);x=n.slice(a.length-(c[0]?c[0].length:0)).reduce((function(S,k){return S+k}),0)}else c=[a];m.push(c),h=x+u,f=b}else c.push(a),h+=f+x,f=b}return d=u?function(S,k){return(k?y:"")+S.join(" ")}:function(S){return S.join(" ")},m.map(d)},ZA.splitTextToSize=function(t,s,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var m=this.internal.getFont(c.fontName,c.fontStyle);return m.metadata.Unicode?{widths:m.metadata.Unicode.widths||{0:1},kerning:m.metadata.Unicode.kerning||{}}:{font:m.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var l=1*this.internal.scaleFactor*s/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var o,u,d=[];for(o=0,u=a.length;o<u;o++)d=d.concat(Bw.apply(this,[a[o],l,i]));return d},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var s="klmnopqrstuvwxyz",r={},a={},n=0;n<s.length;n++)r[s[n]]="0123456789abcdef"[n],a["0123456789abcdef"[n]]=s[n];var i=function(m){return"0x"+parseInt(m,10).toString(16)},l=t.__fontmetrics__.compress=function(m){var h,f,x,g,b=["{"];for(var y in m){if(h=m[y],isNaN(parseInt(y,10))?f="'"+y+"'":(y=parseInt(y,10),f=(f=i(y).slice(2)).slice(0,-1)+a[f.slice(-1)]),typeof h=="number")h<0?(x=i(h).slice(3),g="-"):(x=i(h).slice(2),g=""),x=g+x.slice(0,-1)+a[x.slice(-1)];else{if(Gr(h)!=="object")throw new Error("Don't know what to do with value type "+Gr(h)+".");x=l(h)}b.push(f+x)}return b.push("}"),b.join("")},o=t.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,f,x,g,b={},y=1,N=b,j=[],S="",k="",P=m.length-1,I=1;I<P;I+=1)(g=m[I])=="'"?h?(x=h.join(""),h=void 0):h=[]:h?h.push(g):g=="{"?(j.push([N,x]),N={},x=void 0):g=="}"?((f=j.pop())[0][f[1]]=N,x=void 0,N=f[0]):g=="-"?y=-1:x===void 0?r.hasOwnProperty(g)?(S+=r[g],x=parseInt(S,16)*y,y=1,S=""):S+=g:r.hasOwnProperty(g)?(k+=r[g],N[x]=parseInt(k,16)*y,y=1,x=void 0,k=""):k+=g;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},c={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(m){var h=m.font,f=c.Unicode[h.postScriptName];f&&(h.metadata.Unicode={},h.metadata.Unicode.widths=f.widths,h.metadata.Unicode.kerning=f.kerning);var x=d.Unicode[h.postScriptName];x&&(h.metadata.Unicode.encoding=x,h.encoding=x.codePages[0])}])})(As.API),(function(t){var s=function(r){for(var a=r.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=r.charCodeAt(i);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(l,o){o=/^\x00\x01\x00\x00/.test(o)?s(o):s(Mm(o)),l.metadata=t.API.TTFFont.open(o),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(n,a)}}])})(As),(function(t){function s(){return(zs.canvg?Promise.resolve(zs.canvg):Gx(()=>import("./index.es-CRn9CIaW.js"),[])).catch((function(r){return Promise.reject(new Error("Could not load canvg: "+r))})).then((function(r){return r.default?r.default:r}))}As.API.addSvgAsImage=function(r,a,n,i,l,o,u,d){if(isNaN(a)||isNaN(n))throw ta.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(l))throw ta.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=i,c.height=l;var m=c.getContext("2d");m.fillStyle="#fff",m.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return s().then((function(x){return x.fromString(m,r,h)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(x){return x.render(h)})).then((function(){f.addImage(c.toDataURL("image/jpeg",1),a,n,i,l,u,d)}))}})(),As.API.putTotalPages=function(t){var s,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(s=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(s=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(s,r);return this},As.API.viewerPreferences=function(t,s){var r;t=t||{},s=s||!1;var a,n,i,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(l),u=[],d=0,c=0,m=0;function h(x,g){var b,y=!1;for(b=0;b<x.length;b+=1)x[b]===g&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||s===!0){var f=o.length;for(m=0;m<f;m+=1)r[o[m]].value=r[o[m]].defaultValue,r[o[m]].explicitSet=!1}if(Gr(t)==="object"){for(n in t)if(i=t[n],h(o,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&h(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(d=0;d<i.length;d+=1)if(a=!0,i[d].length===1&&typeof i[d][0]=="number")u.push(String(i[d]-1));else if(i[d].length>1){for(c=0;c<i[d].length;c+=1)typeof i[d][c]!="number"&&(a=!1);a===!0&&u.push([i[d][0]-1,i[d][1]-1].join(" "))}r[n].value="["+u.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var x,g=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?g.push("/"+x+" /"+r[x].value):g.push("/"+x+" "+r[x].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var s=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+l.length+o.length+n.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+i+l+o+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",s)),this}})(As.API),(function(t){var s=t.API,r=s.pdfEscape16=function(i,l){for(var o,u=l.metadata.Unicode.widths,d=["","0","00","000","0000"],c=[""],m=0,h=i.length;m<h;++m){if(o=l.metadata.characterToGlyph(i.charCodeAt(m)),l.metadata.glyIdsUsed.push(o),l.metadata.toUnicode[o]=i.charCodeAt(m),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(l.metadata.widthOfGlyph(o),10)])),o=="0")return c.join("");o=o.toString(16),c.push(d[4-o.length],o)}return c.join("")},a=function(i){var l,o,u,d,c,m,h;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],m=0,h=(o=Object.keys(i).sort((function(f,x){return f-x}))).length;m<h;m++)l=o[m],u.length>=100&&(c+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[l]!==void 0&&i[l]!==null&&typeof i[l].toString=="function"&&(d=("0000"+i[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),u.push("<"+l+"><"+d+">"));return u.length&&(c+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};s.events.push(["putFont",function(i){(function(l){var o=l.font,u=l.out,d=l.newObject,c=l.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var m=o.metadata.Unicode.widths,h=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",x=0;x<h.length;x++)f+=String.fromCharCode(h[x]);var g=d();c({data:f,addLength1:!0,objectId:g}),u("endobj");var b=d();c({data:a(o.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var y=d();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+Ah(o.fontName)),u("/FontFile2 "+g+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var N=d();u("<<"),u("/Type /Font"),u("/BaseFont /"+Ah(o.fontName)),u("/FontDescriptor "+y+" 0 R"),u("/W "+t.API.PDFObject.convert(m)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=d(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+b+" 0 R"),u("/BaseFont /"+Ah(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+N+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]),s.events.push(["putFont",function(i){(function(l){var o=l.font,u=l.out,d=l.newObject,c=l.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var m=o.metadata.rawData,h="",f=0;f<m.length;f++)h+=String.fromCharCode(m[f]);var x=d();c({data:h,addLength1:!0,objectId:x}),u("endobj");var g=d();c({data:a(o.metadata.toUnicode),addLength1:!0,objectId:g}),u("endobj");var b=d();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+x+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+Ah(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=d();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Ah(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]);var n=function(i){var l,o=i.text||"",u=i.x,d=i.y,c=i.options||{},m=i.mutex||{},h=m.pdfEscape,f=m.activeFontKey,x=m.fonts,g=f,b="",y=0,N="",j=x[g].encoding;if(x[g].encoding!=="Identity-H")return{text:o,x:u,y:d,options:c,mutex:m};for(N=o,g=f,Array.isArray(o)&&(N=o[0]),y=0;y<N.length;y+=1)x[g].metadata.hasOwnProperty("cmap")&&(l=x[g].metadata.cmap.unicode.codeMap[N[y].charCodeAt(0)]),l||N[y].charCodeAt(0)<256&&x[g].metadata.hasOwnProperty("Unicode")?b+=N[y]:b+="";var S="";return parseInt(g.slice(1))<14||j==="WinAnsiEncoding"?S=h(b,g).split("").map((function(k){return k.charCodeAt(0).toString(16)})).join(""):j==="Identity-H"&&(S=r(b,x[g])),m.isHex=!0,{text:S,x:u,y:d,options:c,mutex:m}};s.events.push(["postProcessText",function(i){var l=i.text||"",o=[],u={text:l,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?o.push([n(Object.assign({},u,{text:l[d][0]})).text,l[d][1],l[d][2]]):o.push(n(Object.assign({},u,{text:l[d]})).text);i.text=o}else i.text=n(Object.assign({},u,{text:l})).text}])})(As),(function(t){var s=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return s.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return s.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return s.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(As.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,i,l,o,u,d,c,m=s,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),N=!1,j=0;this.__bidiEngine__={};var S=function(O){var T=O.charCodeAt(),V=T>>8,D=g[V];return D!==void 0?m[256*D+(255&T)]:V===252||V===253?"AL":y.test(V)?"L":V===8?"R":"N"},k=function(O){for(var T,V=0;V<O.length;V++){if((T=S(O.charAt(V)))==="L")return!1;if(T==="R")return!0}return!1},P=function(O,T,V,D){var Y,M,X,R,H=T[D];switch(H){case"L":case"R":N=!1;break;case"N":case"AN":break;case"EN":N&&(H="AN");break;case"AL":N=!0,H="R";break;case"WS":H="N";break;case"CS":D<1||D+1>=T.length||(Y=V[D-1])!=="EN"&&Y!=="AN"||(M=T[D+1])!=="EN"&&M!=="AN"?H="N":N&&(M="AN"),H=M===Y?M:"N";break;case"ES":H=(Y=D>0?V[D-1]:"B")==="EN"&&D+1<T.length&&T[D+1]==="EN"?"EN":"N";break;case"ET":if(D>0&&V[D-1]==="EN"){H="EN";break}if(N){H="N";break}for(X=D+1,R=T.length;X<R&&T[X]==="ET";)X++;H=X<R&&T[X]==="EN"?"EN":"N";break;case"NSM":if(l&&!o){for(R=T.length,X=D+1;X<R&&T[X]==="NSM";)X++;if(X<R){var W=O[D],K=W>=1425&&W<=2303||W===64286;if(Y=T[X],K&&(Y==="R"||Y==="AL")){H="R";break}}}H=D<1||(Y=T[D-1])==="B"?"N":V[D-1];break;case"B":N=!1,n=!0,H=j;break;case"S":i=!0,H="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":N=!1;break;case"BN":H="N"}return H},I=function(O,T,V){var D=O.split("");return V&&B(D,V,{hiLevel:j}),D.reverse(),T&&T.reverse(),D.join("")},B=function(O,T,V){var D,Y,M,X,R,H=-1,W=O.length,K=0,_=[],F=j?f:h,E=[];for(N=!1,n=!1,i=!1,Y=0;Y<W;Y++)E[Y]=S(O[Y]);for(M=0;M<W;M++){if(R=K,_[M]=P(O,E,_,M),D=240&(K=F[R][x[_[M]]]),K&=15,T[M]=X=F[K][5],D>0)if(D===16){for(Y=H;Y<M;Y++)T[Y]=1;H=-1}else H=-1;if(F[K][6])H===-1&&(H=M);else if(H>-1){for(Y=H;Y<M;Y++)T[Y]=X;H=-1}E[M]==="B"&&(T[M]=0),V.hiLevel|=X}i&&(function(L,U,J){for(var ae=0;ae<J;ae++)if(L[ae]==="S"){U[ae]=j;for(var Z=ae-1;Z>=0&&L[Z]==="WS";Z--)U[Z]=j}})(E,T,W)},q=function(O,T,V,D,Y){if(!(Y.hiLevel<O)){if(O===1&&j===1&&!n)return T.reverse(),void(V&&V.reverse());for(var M,X,R,H,W=T.length,K=0;K<W;){if(D[K]>=O){for(R=K+1;R<W&&D[R]>=O;)R++;for(H=K,X=R-1;H<X;H++,X--)M=T[H],T[H]=T[X],T[X]=M,V&&(M=V[H],V[H]=V[X],V[X]=M);K=R}K++}}},Q=function(O,T,V){var D=O.split(""),Y={hiLevel:j};return V||(V=[]),B(D,V,Y),(function(M,X,R){if(R.hiLevel!==0&&c)for(var H,W=0;W<M.length;W++)X[W]===1&&(H=b.indexOf(M[W]))>=0&&(M[W]=b[H+1])})(D,V,Y),q(2,D,T,V,Y),q(1,D,T,V,Y),D.join("")};return this.__bidiEngine__.doBidiReorder=function(O,T,V){if((function(Y,M){if(M)for(var X=0;X<Y.length;X++)M[X]=X;o===void 0&&(o=k(Y)),d===void 0&&(d=k(Y))})(O,T),l||!u||d)if(l&&u&&o^d)j=o?1:0,O=I(O,T,V);else if(!l&&u&&d)j=o?1:0,O=Q(O,T,V),O=I(O,T);else if(!l||o||u||d){if(l&&!u&&o^d)O=I(O,T),o?(j=0,O=Q(O,T,V)):(j=1,O=Q(O,T,V),O=I(O,T));else if(l&&o&&!u&&d)j=1,O=Q(O,T,V),O=I(O,T);else if(!l&&!u&&o^d){var D=c;o?(j=1,O=Q(O,T,V),j=0,c=!1,O=Q(O,T,V),c=D):(j=0,O=Q(O,T,V),O=I(O,T),j=1,c=!1,O=Q(O,T,V),c=D,O=I(O,T))}}else j=0,O=Q(O,T,V);else j=o?1:0,O=Q(O,T,V);return O},this.__bidiEngine__.setOptions=function(O){O&&(l=O.isInputVisual,u=O.isOutputVisual,o=O.isInputRtl,d=O.isOutputRtl,c=O.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var s=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text,i=(a.x,a.y,a.options||{}),l=(a.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(l=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?l.push([r.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):l.push([r.doBidiReorder(n[o])]);a.text=l}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(As),As.API.TTFFont=(function(){function t(s){var r;if(this.rawData=s,r=this.contents=new uu(s),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new iD(this),this.registerTTF()}return t.open=function(s){return new t(s)},t.prototype.parse=function(){return this.directory=new WL(this.contents),this.head=new KL(this),this.name=new ZL(this),this.cmap=new A5(this),this.toUnicode={},this.hhea=new zL(this),this.maxp=new eD(this),this.hmtx=new tD(this),this.post=new XL(this),this.os2=new YL(this),this.loca=new nD(this),this.glyf=new sD(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var s,r,a,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,o,u,d;for(d=[],l=0,o=(u=this.bbox).length;l<o;l++)s=u[l],d.push(Math.round(s*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),(32768&(r=n>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(s){var r;return((r=this.cmap.unicode)!=null?r.codeMap[s]:void 0)||0},t.prototype.widthOfGlyph=function(s){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(s).advance*r},t.prototype.widthOfString=function(s,r,a){var n,i,l,o;for(l=0,i=0,o=(s=""+s).length;0<=o?i<o:i>o;i=0<=o?++i:--i)n=s.charCodeAt(i),l+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return l*(r/1e3)},t.prototype.lineHeight=function(s,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*s},t})();var Lo,uu=(function(){function t(s){this.data=s??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(s){return this.data[this.pos++]=s},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(s){return this.writeByte(s>>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt32=function(){var s;return(s=this.readUInt32())>=2147483648?s-4294967296:s},t.prototype.writeInt32=function(s){return s<0&&(s+=4294967296),this.writeUInt32(s)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(s){return this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt16=function(){var s;return(s=this.readUInt16())>=32768?s-65536:s},t.prototype.writeInt16=function(s){return s<0&&(s+=65536),this.writeUInt16(s)},t.prototype.readString=function(s){var r,a;for(a=[],r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(s){var r,a,n;for(n=[],r=0,a=s.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(s.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(s){return this.writeInt16(s)},t.prototype.readLongLong=function(){var s,r,a,n,i,l,o,u;return s=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),l=this.readByte(),o=this.readByte(),u=this.readByte(),128&s?-1*(72057594037927940*(255^s)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^i)+65536*(255^l)+256*(255^o)+(255^u)+1):72057594037927940*s+281474976710656*r+1099511627776*a+4294967296*n+16777216*i+65536*l+256*o+u},t.prototype.writeLongLong=function(s){var r,a;return r=Math.floor(s/4294967296),a=4294967295&s,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(s){return this.writeInt32(s)},t.prototype.read=function(s){var r,a;for(r=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(s){var r,a,n,i;for(i=[],a=0,n=s.length;a<n;a++)r=s[a],i.push(this.writeByte(r));return i},t})(),WL=(function(){var t;function s(r){var a,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return s.prototype.encode=function(r){var a,n,i,l,o,u,d,c,m,h,f,x,g;for(g in f=Object.keys(r).length,u=Math.log(2),m=16*Math.floor(Math.log(f)/u),l=Math.floor(m/u),c=16*f-m,(n=new uu).writeInt(this.scalarType),n.writeShort(f),n.writeShort(m),n.writeShort(l),n.writeShort(c),i=16*f,d=n.pos+i,o=null,x=[],r)for(h=r[g],n.writeString(g),n.writeInt(t(h)),n.writeInt(d),n.writeInt(h.length),x=x.concat(h),g==="head"&&(o=d),d+=h.length;d%4;)x.push(0),d++;return n.write(x),a=2981146554-t(n.data),n.pos=o+8,n.writeUInt32(a),n.data},t=function(r){var a,n,i,l;for(r=h5.call(r);r.length%4;)r.push(0);for(i=new uu(r),n=0,a=0,l=r.length;a<l;a=a+=4)n+=i.readUInt32();return 4294967295&n},s})(),GL={}.hasOwnProperty,dc=function(t,s){for(var r in s)GL.call(s,r)&&(t[r]=s[r]);function a(){this.constructor=t}return a.prototype=s.prototype,t.prototype=new a,t.__super__=s.prototype,t};Lo=(function(){function t(s){var r;this.file=s,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var KL=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="head",s.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},s.prototype.encode=function(r){var a;return(a=new uu).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},s})(),Fw=(function(){function t(s,r){var a,n,i,l,o,u,d,c,m,h,f,x,g,b,y,N,j;switch(this.platformID=s.readUInt16(),this.encodingID=s.readShort(),this.offset=r+s.readInt(),m=s.pos,s.pos=this.offset,this.format=s.readUInt16(),this.length=s.readUInt16(),this.language=s.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=s.readByte();break;case 4:for(f=s.readUInt16(),h=f/2,s.pos+=6,i=(function(){var S,k;for(k=[],u=S=0;0<=h?S<h:S>h;u=0<=h?++S:--S)k.push(s.readUInt16());return k})(),s.pos+=2,g=(function(){var S,k;for(k=[],u=S=0;0<=h?S<h:S>h;u=0<=h?++S:--S)k.push(s.readUInt16());return k})(),d=(function(){var S,k;for(k=[],u=S=0;0<=h?S<h:S>h;u=0<=h?++S:--S)k.push(s.readUInt16());return k})(),c=(function(){var S,k;for(k=[],u=S=0;0<=h?S<h:S>h;u=0<=h?++S:--S)k.push(s.readUInt16());return k})(),n=(this.length-s.pos+this.offset)/2,o=(function(){var S,k;for(k=[],u=S=0;0<=n?S<n:S>n;u=0<=n?++S:--S)k.push(s.readUInt16());return k})(),u=y=0,j=i.length;y<j;u=++y)for(b=i[u],a=N=x=g[u];x<=b?N<=b:N>=b;a=x<=b?++N:--N)c[u]===0?l=a+d[u]:(l=o[c[u]/2+(a-x)-(h-u)]||0)!==0&&(l+=d[u]),this.codeMap[a]=65535&l}s.pos=m}return t.encode=function(s,r){var a,n,i,l,o,u,d,c,m,h,f,x,g,b,y,N,j,S,k,P,I,B,q,Q,O,T,V,D,Y,M,X,R,H,W,K,_,F,E,L,U,J,ae,Z,oe,ee,se;switch(D=new uu,l=Object.keys(s).sort((function(Ae,we){return Ae-we})),r){case"macroman":for(g=0,b=(function(){var Ae=[];for(x=0;x<256;++x)Ae.push(0);return Ae})(),N={0:0},i={},Y=0,H=l.length;Y<H;Y++)N[Z=s[n=l[Y]]]==null&&(N[Z]=++g),i[n]={old:s[n],new:N[s[n]]},b[n]=N[s[n]];return D.writeUInt16(1),D.writeUInt16(0),D.writeUInt32(12),D.writeUInt16(0),D.writeUInt16(262),D.writeUInt16(0),D.write(b),{charMap:i,subtable:D.data,maxGlyphID:g+1};case"unicode":for(T=[],m=[],j=0,N={},a={},y=d=null,M=0,W=l.length;M<W;M++)N[k=s[n=l[M]]]==null&&(N[k]=++j),a[n]={old:k,new:N[k]},o=N[k]-n,y!=null&&o===d||(y&&m.push(y),T.push(n),d=o),y=n;for(y&&m.push(y),m.push(65535),T.push(65535),Q=2*(q=T.length),B=2*Math.pow(Math.log(q)/Math.LN2,2),h=Math.log(B/2)/Math.LN2,I=2*q-B,u=[],P=[],f=[],x=X=0,K=T.length;X<K;x=++X){if(O=T[x],c=m[x],O===65535){u.push(0),P.push(0);break}if(O-(V=a[O].new)>=32768)for(u.push(0),P.push(2*(f.length+q-x)),n=R=O;O<=c?R<=c:R>=c;n=O<=c?++R:--R)f.push(a[n].new);else u.push(V-O),P.push(0)}for(D.writeUInt16(3),D.writeUInt16(1),D.writeUInt32(12),D.writeUInt16(4),D.writeUInt16(16+8*q+2*f.length),D.writeUInt16(0),D.writeUInt16(Q),D.writeUInt16(B),D.writeUInt16(h),D.writeUInt16(I),J=0,_=m.length;J<_;J++)n=m[J],D.writeUInt16(n);for(D.writeUInt16(0),ae=0,F=T.length;ae<F;ae++)n=T[ae],D.writeUInt16(n);for(oe=0,E=u.length;oe<E;oe++)o=u[oe],D.writeUInt16(o);for(ee=0,L=P.length;ee<L;ee++)S=P[ee],D.writeUInt16(S);for(se=0,U=f.length;se<U;se++)g=f[se],D.writeUInt16(g);return{charMap:a,subtable:D.data,maxGlyphID:j+1}}},t})(),A5=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="cmap",s.prototype.parse=function(r){var a,n,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)a=new Fw(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},s.encode=function(r,a){var n,i;return a==null&&(a="macroman"),n=Fw.encode(r,a),(i=new uu).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},s})(),zL=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="hhea",s.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},s})(),YL=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="OS/2",s.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var a,n;for(n=[],a=0;a<10;++a)n.push(r.readByte());return n})(),this.charRange=(function(){var a,n;for(n=[],a=0;a<4;++a)n.push(r.readInt());return n})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var a,n;for(n=[],a=0;a<2;a=++a)n.push(r.readInt());return n})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},s})(),XL=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="post",s.prototype.parse=function(r){var a,n,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var l;for(n=r.readUInt16(),this.glyphNameIndex=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)a=r.readByte(),i.push(this.names.push(r.readString(a)));return i;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var o,u,d;for(d=[],l=o=0,u=this.file.maxp.numGlyphs;0<=u?o<u:o>u;l=0<=u?++o:--o)d.push(r.readUInt32());return d}).call(this)}},s})(),JL=function(t,s){this.raw=t,this.length=t.length,this.platformID=s.platformID,this.encodingID=s.encodingID,this.languageID=s.languageID},ZL=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="name",s.prototype.parse=function(r){var a,n,i,l,o,u,d,c,m,h,f;for(r.pos=this.offset,r.readShort(),a=r.readShort(),u=r.readShort(),n=[],l=0;0<=a?l<a:l>a;l=0<=a?++l:--l)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+u+r.readShort()});for(d={},l=m=0,h=n.length;m<h;l=++m)i=n[l],r.pos=i.offset,c=r.readString(i.length),o=new JL(c,i),d[f=i.nameID]==null&&(d[f]=[]),d[i.nameID].push(o);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},s})(),eD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="maxp",s.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},s})(),tD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="hmtx",s.prototype.parse=function(r){var a,n,i,l,o,u,d;for(r.pos=this.offset,this.metrics=[],a=0,u=this.file.hhea.numberOfMetrics;0<=u?a<u:a>u;a=0<=u?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,m;for(m=[],a=c=0;0<=i?c<i:c>i;a=0<=i?++c:--c)m.push(r.readInt16());return m})(),this.widths=(function(){var c,m,h,f;for(f=[],c=0,m=(h=this.metrics).length;c<m;c++)l=h[c],f.push(l.advance);return f}).call(this),n=this.widths[this.widths.length-1],d=[],a=o=0;0<=i?o<i:o>i;a=0<=i?++o:--o)d.push(this.widths.push(n));return d},s.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},s})(),h5=[].slice,sD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="glyf",s.prototype.parse=function(){return this.cache={}},s.prototype.glyphFor=function(r){var a,n,i,l,o,u,d,c,m,h;return r in this.cache?this.cache[r]:(l=this.file.loca,a=this.file.contents,n=l.indexOf(r),(i=l.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+n,o=(u=new uu(a.read(i))).readShort(),c=u.readShort(),h=u.readShort(),d=u.readShort(),m=u.readShort(),this.cache[r]=o===-1?new aD(u,c,h,d,m):new rD(u,o,c,h,d,m),this.cache[r]))},s.prototype.encode=function(r,a,n){var i,l,o,u,d;for(o=[],l=[],u=0,d=a.length;u<d;u++)i=r[a[u]],l.push(o.length),i&&(o=o.concat(i.encode(n)));return l.push(o.length),{table:o,offsets:l}},s})(),rD=(function(){function t(s,r,a,n,i,l){this.raw=s,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=i,this.yMax=l,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),aD=(function(){function t(s,r,a,n,i){var l,o;for(this.raw=s,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;o=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&o;)l.pos+=1&o?4:2,128&o?l.pos+=8:64&o?l.pos+=4:8&o&&(l.pos+=2)}return t.prototype.encode=function(){var s,r,a;for(r=new uu(h5.call(this.raw.data)),s=0,a=this.glyphIDs.length;s<a;++s)r.pos=this.glyphOffsets[s];return r.data},t})(),nD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return dc(s,Lo),s.prototype.tag="loca",s.prototype.parse=function(r){var a,n;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,l;for(l=[],n=0,i=this.length;n<i;n+=2)l.push(2*r.readUInt16());return l}).call(this):(function(){var i,l;for(l=[],n=0,i=this.length;n<i;n+=4)l.push(r.readUInt32());return l}).call(this)},s.prototype.indexOf=function(r){return this.offsets[r]},s.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},s.prototype.encode=function(r,a){for(var n=new Uint32Array(this.offsets.length),i=0,l=0,o=0;o<n.length;++o)if(n[o]=i,l<a.length&&a[l]==o){++l,n[o]=i;var u=this.offsets[o],d=this.offsets[o+1]-u;d>0&&(i+=d)}for(var c=new Array(4*n.length),m=0;m<n.length;++m)c[4*m+3]=255&n[m],c[4*m+2]=(65280&n[m])>>8,c[4*m+1]=(16711680&n[m])>>16,c[4*m]=(4278190080&n[m])>>24;return c},s})(),iD=(function(){function t(s){this.font=s,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var s,r,a,n,i;for(r in n=this.font.cmap.tables[0].codeMap,s={},i=this.subset)a=i[r],s[r]=n[a];return s},t.prototype.glyphsFor=function(s){var r,a,n,i,l,o,u;for(n={},l=0,o=s.length;l<o;l++)n[i=s[l]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(a=n[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in u=this.glyphsFor(r))a=u[i],n[i]=a;return n},t.prototype.encode=function(s,r){var a,n,i,l,o,u,d,c,m,h,f,x,g,b,y;for(n in a=A5.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(s),f={0:0},y=a.charMap)f[(u=y[n]).old]=u.new;for(x in h=a.maxGlyphID,l)x in f||(f[x]=h++);return c=(function(N){var j,S;for(j in S={},N)S[N[j]]=j;return S})(f),m=Object.keys(c).sort((function(N,j){return N-j})),g=(function(){var N,j,S;for(S=[],N=0,j=m.length;N<j;N++)o=m[N],S.push(c[o]);return S})(),i=this.font.glyf.encode(l,g,f),d=this.font.loca.encode(i.offsets,g),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},t})();As.API.PDFObject=(function(){var t;function s(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},s.convert=function(r){var a,n,i,l;if(Array.isArray(r))return"["+(function(){var o,u,d;for(d=[],o=0,u=r.length;o<u;o++)a=r[o],d.push(s.convert(a));return d})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)l=r[n],i.push("/"+n+" "+s.convert(l));return i.push(">>"),i.join(`
`)}return""+r},s})();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Kb=function(t,s){return Kb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Kb(t,s)};function Do(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");Kb(t,s);function r(){this.constructor=t}t.prototype=s===null?Object.create(s):(r.prototype=s.prototype,new r)}var zb=function(){return zb=Object.assign||function(s){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},zb.apply(this,arguments)};function Ii(t,s,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(c){try{d(a.next(c))}catch(m){l(m)}}function u(c){try{d(a.throw(c))}catch(m){l(m)}}function d(c){c.done?i(c.value):n(c.value).then(o,u)}d((a=a.apply(t,[])).next())})}function di(t,s){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(d){return function(c){return u([d,c])}}function u(d){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(i=d[0]&2?n.return:d[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,d[1])).done)return i;switch(n=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=s.call(t,r)}catch(c){d=[6,c],n=0}finally{a=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Up(t,s,r){if(arguments.length===2)for(var a=0,n=s.length,i;a<n;a++)(i||!(a in s))&&(i||(i=Array.prototype.slice.call(s,0,a)),i[a]=s[a]);return t.concat(i||s)}var td=(function(){function t(s,r,a,n){this.left=s,this.top=r,this.width=a,this.height=n}return t.prototype.add=function(s,r,a,n){return new t(this.left+s,this.top+r,this.width+a,this.height+n)},t.fromClientRect=function(s,r){return new t(r.left+s.windowBounds.left,r.top+s.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(s,r){var a=Array.from(r).find(function(n){return n.width!==0});return a?new t(a.left+s.windowBounds.left,a.top+s.windowBounds.top,a.width,a.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t})(),W0=function(t,s){return td.fromClientRect(t,s.getBoundingClientRect())},lD=function(t){var s=t.body,r=t.documentElement;if(!s||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(s.scrollWidth,r.scrollWidth),Math.max(s.offsetWidth,r.offsetWidth),Math.max(s.clientWidth,r.clientWidth)),n=Math.max(Math.max(s.scrollHeight,r.scrollHeight),Math.max(s.offsetHeight,r.offsetHeight),Math.max(s.clientHeight,r.clientHeight));return new td(0,0,a,n)},G0=function(t){for(var s=[],r=0,a=t.length;r<a;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var i=t.charCodeAt(r++);(i&64512)===56320?s.push(((n&1023)<<10)+(i&1023)+65536):(s.push(n),r--)}else s.push(n)}return s},Ga=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var a=[],n=-1,i="";++n<r;){var l=t[n];l<=65535?a.push(l):(l-=65536,a.push((l>>10)+55296,l%1024+56320)),(n+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},Tw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",oD=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Rp=0;Rp<Tw.length;Rp++)oD[Tw.charCodeAt(Rp)]=Rp;var Iw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Cm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Op=0;Op<Iw.length;Op++)Cm[Iw.charCodeAt(Op)]=Op;var cD=function(t){var s=t.length*.75,r=t.length,a,n=0,i,l,o,u;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(s):new Array(s),c=Array.isArray(d)?d:new Uint8Array(d);for(a=0;a<r;a+=4)i=Cm[t.charCodeAt(a)],l=Cm[t.charCodeAt(a+1)],o=Cm[t.charCodeAt(a+2)],u=Cm[t.charCodeAt(a+3)],c[n++]=i<<2|l>>4,c[n++]=(l&15)<<4|o>>2,c[n++]=(o&3)<<6|u&63;return d},dD=function(t){for(var s=t.length,r=[],a=0;a<s;a+=2)r.push(t[a+1]<<8|t[a]);return r},uD=function(t){for(var s=t.length,r=[],a=0;a<s;a+=4)r.push(t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a]);return r},cA=5,e1=11,Bv=2,AD=e1-cA,m5=65536>>cA,hD=1<<cA,kv=hD-1,mD=1024>>cA,fD=m5+mD,pD=fD,xD=32,gD=pD+xD,vD=65536>>e1,bD=1<<AD,yD=bD-1,Lw=function(t,s,r){return t.slice?t.slice(s,r):new Uint16Array(Array.prototype.slice.call(t,s,r))},jD=function(t,s,r){return t.slice?t.slice(s,r):new Uint32Array(Array.prototype.slice.call(t,s,r))},ND=function(t,s){var r=cD(t),a=Array.isArray(r)?uD(r):new Uint32Array(r),n=Array.isArray(r)?dD(r):new Uint16Array(r),i=24,l=Lw(n,i/2,a[4]/2),o=a[5]===2?Lw(n,(i+a[4])/2):jD(a,Math.ceil((i+a[4])/4));return new wD(a[0],a[1],a[2],a[3],l,o)},wD=(function(){function t(s,r,a,n,i,l){this.initialValue=s,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=i,this.data=l}return t.prototype.get=function(s){var r;if(s>=0){if(s<55296||s>56319&&s<=65535)return r=this.index[s>>cA],r=(r<<Bv)+(s&kv),this.data[r];if(s<=65535)return r=this.index[m5+(s-55296>>cA)],r=(r<<Bv)+(s&kv),this.data[r];if(s<this.highStart)return r=gD-vD+(s>>e1),r=this.index[r],r+=s>>cA&yD,r=this.index[r],r=(r<<Bv)+(s&kv),this.data[r];if(s<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t})(),Dw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_D=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Qp=0;Qp<Dw.length;Qp++)_D[Dw.charCodeAt(Qp)]=Qp;var SD="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Pw=50,CD=1,f5=2,p5=3,BD=4,kD=5,Uw=7,x5=8,Rw=9,tu=10,Yb=11,Ow=12,Xb=13,ED=14,Bm=15,Jb=16,Mp=17,pm=18,FD=19,Qw=20,Zb=21,xm=22,Ev=23,eh=24,fl=25,km=26,Em=27,th=28,TD=29,Ju=30,ID=31,Hp=32,qp=33,ey=34,ty=35,sy=36,df=37,ry=38,Fx=39,Tx=40,Fv=41,g5=42,LD=43,DD=[9001,65288],v5="!",pr="",Vp="",ay=ND(SD),Rc=[Ju,sy],ny=[CD,f5,p5,kD],b5=[tu,x5],Mw=[Em,km],PD=ny.concat(b5),Hw=[ry,Fx,Tx,ey,ty],UD=[Bm,Xb],RD=function(t,s){s===void 0&&(s="strict");var r=[],a=[],n=[];return t.forEach(function(i,l){var o=ay.get(i);if(o>Pw?(n.push(!0),o-=Pw):n.push(!1),["normal","auto","loose"].indexOf(s)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return a.push(l),r.push(Jb);if(o===BD||o===Yb){if(l===0)return a.push(l),r.push(Ju);var u=r[l-1];return PD.indexOf(u)===-1?(a.push(a[l-1]),r.push(u)):(a.push(l),r.push(Ju))}if(a.push(l),o===ID)return r.push(s==="strict"?Zb:df);if(o===g5||o===TD)return r.push(Ju);if(o===LD)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(df):r.push(Ju);r.push(o)}),[a,r,n]},Tv=function(t,s,r,a){var n=a[r];if(Array.isArray(t)?t.indexOf(n)!==-1:t===n)for(var i=r;i<=a.length;){i++;var l=a[i];if(l===s)return!0;if(l!==tu)break}if(n===tu)for(var i=r;i>0;){i--;var o=a[i];if(Array.isArray(t)?t.indexOf(o)!==-1:t===o)for(var u=r;u<=a.length;){u++;var l=a[u];if(l===s)return!0;if(l!==tu)break}if(o!==tu)break}return!1},qw=function(t,s){for(var r=t;r>=0;){var a=s[r];if(a===tu)r--;else return a}return 0},OD=function(t,s,r,a,n){if(r[a]===0)return pr;var i=a-1;if(Array.isArray(n)&&n[i]===!0)return pr;var l=i-1,o=i+1,u=s[i],d=l>=0?s[l]:0,c=s[o];if(u===f5&&c===p5)return pr;if(ny.indexOf(u)!==-1)return v5;if(ny.indexOf(c)!==-1||b5.indexOf(c)!==-1)return pr;if(qw(i,s)===x5)return Vp;if(ay.get(t[i])===Yb||(u===Hp||u===qp)&&ay.get(t[o])===Yb||u===Uw||c===Uw||u===Rw||[tu,Xb,Bm].indexOf(u)===-1&&c===Rw||[Mp,pm,FD,eh,th].indexOf(c)!==-1||qw(i,s)===xm||Tv(Ev,xm,i,s)||Tv([Mp,pm],Zb,i,s)||Tv(Ow,Ow,i,s))return pr;if(u===tu)return Vp;if(u===Ev||c===Ev)return pr;if(c===Jb||u===Jb)return Vp;if([Xb,Bm,Zb].indexOf(c)!==-1||u===ED||d===sy&&UD.indexOf(u)!==-1||u===th&&c===sy||c===Qw||Rc.indexOf(c)!==-1&&u===fl||Rc.indexOf(u)!==-1&&c===fl||u===Em&&[df,Hp,qp].indexOf(c)!==-1||[df,Hp,qp].indexOf(u)!==-1&&c===km||Rc.indexOf(u)!==-1&&Mw.indexOf(c)!==-1||Mw.indexOf(u)!==-1&&Rc.indexOf(c)!==-1||[Em,km].indexOf(u)!==-1&&(c===fl||[xm,Bm].indexOf(c)!==-1&&s[o+1]===fl)||[xm,Bm].indexOf(u)!==-1&&c===fl||u===fl&&[fl,th,eh].indexOf(c)!==-1)return pr;if([fl,th,eh,Mp,pm].indexOf(c)!==-1)for(var m=i;m>=0;){var h=s[m];if(h===fl)return pr;if([th,eh].indexOf(h)!==-1)m--;else break}if([Em,km].indexOf(c)!==-1)for(var m=[Mp,pm].indexOf(u)!==-1?l:i;m>=0;){var h=s[m];if(h===fl)return pr;if([th,eh].indexOf(h)!==-1)m--;else break}if(ry===u&&[ry,Fx,ey,ty].indexOf(c)!==-1||[Fx,ey].indexOf(u)!==-1&&[Fx,Tx].indexOf(c)!==-1||[Tx,ty].indexOf(u)!==-1&&c===Tx||Hw.indexOf(u)!==-1&&[Qw,km].indexOf(c)!==-1||Hw.indexOf(c)!==-1&&u===Em||Rc.indexOf(u)!==-1&&Rc.indexOf(c)!==-1||u===eh&&Rc.indexOf(c)!==-1||Rc.concat(fl).indexOf(u)!==-1&&c===xm&&DD.indexOf(t[o])===-1||Rc.concat(fl).indexOf(c)!==-1&&u===pm)return pr;if(u===Fv&&c===Fv){for(var f=r[i],x=1;f>0&&(f--,s[f]===Fv);)x++;if(x%2!==0)return pr}return u===Hp&&c===qp?pr:Vp},QD=function(t,s){s||(s={lineBreak:"normal",wordBreak:"normal"});var r=RD(t,s.lineBreak),a=r[0],n=r[1],i=r[2];(s.wordBreak==="break-all"||s.wordBreak==="break-word")&&(n=n.map(function(o){return[fl,Ju,g5].indexOf(o)!==-1?df:o}));var l=s.wordBreak==="keep-all"?i.map(function(o,u){return o&&t[u]>=19968&&t[u]<=40959}):void 0;return[a,n,l]},MD=(function(){function t(s,r,a,n){this.codePoints=s,this.required=r===v5,this.start=a,this.end=n}return t.prototype.slice=function(){return Ga.apply(void 0,this.codePoints.slice(this.start,this.end))},t})(),HD=function(t,s){var r=G0(t),a=QD(r,s),n=a[0],i=a[1],l=a[2],o=r.length,u=0,d=0;return{next:function(){if(d>=o)return{done:!0,value:null};for(var c=pr;d<o&&(c=OD(r,i,n,++d,l))===pr;);if(c!==pr||d===o){var m=new MD(r,c,u,d);return u=d,{value:m,done:!1}}return{done:!0,value:null}}}},qD=1,VD=2,Df=4,Vw=8,Yx=10,$w=47,Hm=92,$D=9,WD=32,$p=34,gm=61,GD=35,KD=36,zD=37,Wp=39,Gp=40,vm=41,YD=95,Zi=45,XD=33,JD=60,ZD=62,eP=64,tP=91,sP=93,rP=61,aP=123,Kp=63,nP=125,Ww=124,iP=126,lP=128,Gw=65533,Iv=42,aA=43,oP=44,cP=58,dP=59,uf=46,uP=0,AP=8,hP=11,mP=14,fP=31,pP=127,ec=-1,y5=48,j5=97,N5=101,xP=102,gP=117,vP=122,w5=65,_5=69,S5=70,bP=85,yP=90,Ai=function(t){return t>=y5&&t<=57},jP=function(t){return t>=55296&&t<=57343},sh=function(t){return Ai(t)||t>=w5&&t<=S5||t>=j5&&t<=xP},NP=function(t){return t>=j5&&t<=vP},wP=function(t){return t>=w5&&t<=yP},_P=function(t){return NP(t)||wP(t)},SP=function(t){return t>=lP},zp=function(t){return t===Yx||t===$D||t===WD},Xx=function(t){return _P(t)||SP(t)||t===YD},Kw=function(t){return Xx(t)||Ai(t)||t===Zi},CP=function(t){return t>=uP&&t<=AP||t===hP||t>=mP&&t<=fP||t===pP},Xd=function(t,s){return t!==Hm?!1:s!==Yx},Yp=function(t,s,r){return t===Zi?Xx(s)||Xd(s,r):Xx(t)?!0:!!(t===Hm&&Xd(t,s))},Lv=function(t,s,r){return t===aA||t===Zi?Ai(s)?!0:s===uf&&Ai(r):Ai(t===uf?s:t)},BP=function(t){var s=0,r=1;(t[s]===aA||t[s]===Zi)&&(t[s]===Zi&&(r=-1),s++);for(var a=[];Ai(t[s]);)a.push(t[s++]);var n=a.length?parseInt(Ga.apply(void 0,a),10):0;t[s]===uf&&s++;for(var i=[];Ai(t[s]);)i.push(t[s++]);var l=i.length,o=l?parseInt(Ga.apply(void 0,i),10):0;(t[s]===_5||t[s]===N5)&&s++;var u=1;(t[s]===aA||t[s]===Zi)&&(t[s]===Zi&&(u=-1),s++);for(var d=[];Ai(t[s]);)d.push(t[s++]);var c=d.length?parseInt(Ga.apply(void 0,d),10):0;return r*(n+o*Math.pow(10,-l))*Math.pow(10,u*c)},kP={type:2},EP={type:3},FP={type:4},TP={type:13},IP={type:8},LP={type:21},DP={type:9},PP={type:10},UP={type:11},RP={type:12},OP={type:14},Xp={type:23},QP={type:1},MP={type:25},HP={type:24},qP={type:26},VP={type:27},$P={type:28},WP={type:29},GP={type:31},iy={type:32},C5=(function(){function t(){this._value=[]}return t.prototype.write=function(s){this._value=this._value.concat(G0(s))},t.prototype.read=function(){for(var s=[],r=this.consumeToken();r!==iy;)s.push(r),r=this.consumeToken();return s},t.prototype.consumeToken=function(){var s=this.consumeCodePoint();switch(s){case $p:return this.consumeStringToken($p);case GD:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),n=this.peekCodePoint(2);if(Kw(r)||Xd(a,n)){var i=Yp(r,a,n)?VD:qD,l=this.consumeName();return{type:5,value:l,flags:i}}break;case KD:if(this.peekCodePoint(0)===gm)return this.consumeCodePoint(),TP;break;case Wp:return this.consumeStringToken(Wp);case Gp:return kP;case vm:return EP;case Iv:if(this.peekCodePoint(0)===gm)return this.consumeCodePoint(),OP;break;case aA:if(Lv(s,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(s),this.consumeNumericToken();break;case oP:return FP;case Zi:var o=s,u=this.peekCodePoint(0),d=this.peekCodePoint(1);if(Lv(o,u,d))return this.reconsumeCodePoint(s),this.consumeNumericToken();if(Yp(o,u,d))return this.reconsumeCodePoint(s),this.consumeIdentLikeToken();if(u===Zi&&d===ZD)return this.consumeCodePoint(),this.consumeCodePoint(),HP;break;case uf:if(Lv(s,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(s),this.consumeNumericToken();break;case $w:if(this.peekCodePoint(0)===Iv)for(this.consumeCodePoint();;){var c=this.consumeCodePoint();if(c===Iv&&(c=this.consumeCodePoint(),c===$w))return this.consumeToken();if(c===ec)return this.consumeToken()}break;case cP:return qP;case dP:return VP;case JD:if(this.peekCodePoint(0)===XD&&this.peekCodePoint(1)===Zi&&this.peekCodePoint(2)===Zi)return this.consumeCodePoint(),this.consumeCodePoint(),MP;break;case eP:var m=this.peekCodePoint(0),h=this.peekCodePoint(1),f=this.peekCodePoint(2);if(Yp(m,h,f)){var l=this.consumeName();return{type:7,value:l}}break;case tP:return $P;case Hm:if(Xd(s,this.peekCodePoint(0)))return this.reconsumeCodePoint(s),this.consumeIdentLikeToken();break;case sP:return WP;case rP:if(this.peekCodePoint(0)===gm)return this.consumeCodePoint(),IP;break;case aP:return UP;case nP:return RP;case gP:case bP:var x=this.peekCodePoint(0),g=this.peekCodePoint(1);return x===aA&&(sh(g)||g===Kp)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(s),this.consumeIdentLikeToken();case Ww:if(this.peekCodePoint(0)===gm)return this.consumeCodePoint(),DP;if(this.peekCodePoint(0)===Ww)return this.consumeCodePoint(),LP;break;case iP:if(this.peekCodePoint(0)===gm)return this.consumeCodePoint(),PP;break;case ec:return iy}return zp(s)?(this.consumeWhiteSpace(),GP):Ai(s)?(this.reconsumeCodePoint(s),this.consumeNumericToken()):Xx(s)?(this.reconsumeCodePoint(s),this.consumeIdentLikeToken()):{type:6,value:Ga(s)}},t.prototype.consumeCodePoint=function(){var s=this._value.shift();return typeof s>"u"?-1:s},t.prototype.reconsumeCodePoint=function(s){this._value.unshift(s)},t.prototype.peekCodePoint=function(s){return s>=this._value.length?-1:this._value[s]},t.prototype.consumeUnicodeRangeToken=function(){for(var s=[],r=this.consumeCodePoint();sh(r)&&s.length<6;)s.push(r),r=this.consumeCodePoint();for(var a=!1;r===Kp&&s.length<6;)s.push(r),r=this.consumeCodePoint(),a=!0;if(a){var n=parseInt(Ga.apply(void 0,s.map(function(u){return u===Kp?y5:u})),16),i=parseInt(Ga.apply(void 0,s.map(function(u){return u===Kp?S5:u})),16);return{type:30,start:n,end:i}}var l=parseInt(Ga.apply(void 0,s),16);if(this.peekCodePoint(0)===Zi&&sh(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var o=[];sh(r)&&o.length<6;)o.push(r),r=this.consumeCodePoint();var i=parseInt(Ga.apply(void 0,o),16);return{type:30,start:l,end:i}}else return{type:30,start:l,end:l}},t.prototype.consumeIdentLikeToken=function(){var s=this.consumeName();return s.toLowerCase()==="url"&&this.peekCodePoint(0)===Gp?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Gp?(this.consumeCodePoint(),{type:19,value:s}):{type:20,value:s}},t.prototype.consumeUrlToken=function(){var s=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ec)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===Wp||r===$p){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ec||this.peekCodePoint(0)===vm)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),Xp)}for(;;){var n=this.consumeCodePoint();if(n===ec||n===vm)return{type:22,value:Ga.apply(void 0,s)};if(zp(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ec||this.peekCodePoint(0)===vm?(this.consumeCodePoint(),{type:22,value:Ga.apply(void 0,s)}):(this.consumeBadUrlRemnants(),Xp);if(n===$p||n===Wp||n===Gp||CP(n))return this.consumeBadUrlRemnants(),Xp;if(n===Hm)if(Xd(n,this.peekCodePoint(0)))s.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Xp;else s.push(n)}},t.prototype.consumeWhiteSpace=function(){for(;zp(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var s=this.consumeCodePoint();if(s===vm||s===ec)return;Xd(s,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(s){for(var r=5e4,a="";s>0;){var n=Math.min(r,s);a+=Ga.apply(void 0,this._value.splice(0,n)),s-=n}return this._value.shift(),a},t.prototype.consumeStringToken=function(s){var r="",a=0;do{var n=this._value[a];if(n===ec||n===void 0||n===s)return r+=this.consumeStringSlice(a),{type:0,value:r};if(n===Yx)return this._value.splice(0,a),QP;if(n===Hm){var i=this._value[a+1];i!==ec&&i!==void 0&&(i===Yx?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):Xd(n,i)&&(r+=this.consumeStringSlice(a),r+=Ga(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},t.prototype.consumeNumber=function(){var s=[],r=Df,a=this.peekCodePoint(0);for((a===aA||a===Zi)&&s.push(this.consumeCodePoint());Ai(this.peekCodePoint(0));)s.push(this.consumeCodePoint());a=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(a===uf&&Ai(n))for(s.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Vw;Ai(this.peekCodePoint(0));)s.push(this.consumeCodePoint());a=this.peekCodePoint(0),n=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((a===_5||a===N5)&&((n===aA||n===Zi)&&Ai(i)||Ai(n)))for(s.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Vw;Ai(this.peekCodePoint(0));)s.push(this.consumeCodePoint());return[BP(s),r]},t.prototype.consumeNumericToken=function(){var s=this.consumeNumber(),r=s[0],a=s[1],n=this.peekCodePoint(0),i=this.peekCodePoint(1),l=this.peekCodePoint(2);if(Yp(n,i,l)){var o=this.consumeName();return{type:15,number:r,flags:a,unit:o}}return n===zD?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},t.prototype.consumeEscapedCodePoint=function(){var s=this.consumeCodePoint();if(sh(s)){for(var r=Ga(s);sh(this.peekCodePoint(0))&&r.length<6;)r+=Ga(this.consumeCodePoint());zp(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||jP(a)||a>1114111?Gw:a}return s===ec?Gw:s},t.prototype.consumeName=function(){for(var s="";;){var r=this.consumeCodePoint();if(Kw(r))s+=Ga(r);else if(Xd(r,this.peekCodePoint(0)))s+=Ga(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),s}},t})(),B5=(function(){function t(s){this._tokens=s}return t.create=function(s){var r=new C5;return r.write(s),new t(r.read())},t.parseValue=function(s){return t.create(s).parseComponentValue()},t.parseValues=function(s){return t.create(s).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var s=this.consumeToken();s.type===31;)s=this.consumeToken();if(s.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(s);var r=this.consumeComponentValue();do s=this.consumeToken();while(s.type===31);if(s.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var s=[];;){var r=this.consumeComponentValue();if(r.type===32)return s;s.push(r),s.push()}},t.prototype.consumeComponentValue=function(){var s=this.consumeToken();switch(s.type){case 11:case 28:case 2:return this.consumeSimpleBlock(s.type);case 19:return this.consumeFunction(s)}return s},t.prototype.consumeSimpleBlock=function(s){for(var r={type:s,values:[]},a=this.consumeToken();;){if(a.type===32||zP(a,s))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},t.prototype.consumeFunction=function(s){for(var r={name:s.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var s=this._tokens.shift();return typeof s>"u"?iy:s},t.prototype.reconsumeToken=function(s){this._tokens.unshift(s)},t})(),Pf=function(t){return t.type===15},qh=function(t){return t.type===17},Yr=function(t){return t.type===20},KP=function(t){return t.type===0},ly=function(t,s){return Yr(t)&&t.value===s},k5=function(t){return t.type!==31},Ih=function(t){return t.type!==31&&t.type!==4},uc=function(t){var s=[],r=[];return t.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");s.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&s.push(r),s},zP=function(t,s){return s===11&&t.type===12||s===28&&t.type===29?!0:s===2&&t.type===3},Au=function(t){return t.type===17||t.type===15},ln=function(t){return t.type===16||Au(t)},E5=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},$n={type:17,number:0,flags:Df},t1={type:16,number:50,flags:Df},su={type:16,number:100,flags:Df},Fm=function(t,s,r){var a=t[0],n=t[1];return[aa(a,s),aa(typeof n<"u"?n:a,r)]},aa=function(t,s){if(t.type===16)return t.number/100*s;if(Pf(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},F5="deg",T5="grad",I5="rad",L5="turn",K0={name:"angle",parse:function(t,s){if(s.type===15)switch(s.unit){case F5:return Math.PI*s.number/180;case T5:return Math.PI/200*s.number;case I5:return s.number;case L5:return Math.PI*2*s.number}throw new Error("Unsupported angle type")}},D5=function(t){return t.type===15&&(t.unit===F5||t.unit===T5||t.unit===I5||t.unit===L5)},P5=function(t){var s=t.filter(Yr).map(function(r){return r.value}).join(" ");switch(s){case"to bottom right":case"to right bottom":case"left top":case"top left":return[$n,$n];case"to top":case"bottom":return Kl(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[$n,su];case"to right":case"left":return Kl(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[su,su];case"to bottom":case"top":return Kl(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[su,$n];case"to left":case"right":return Kl(270)}return 0},Kl=function(t){return Math.PI*t/180},lu={name:"color",parse:function(t,s){if(s.type===18){var r=YP[s.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+s.name+'"');return r(t,s.values)}if(s.type===5){if(s.value.length===3){var a=s.value.substring(0,1),n=s.value.substring(1,2),i=s.value.substring(2,3);return ru(parseInt(a+a,16),parseInt(n+n,16),parseInt(i+i,16),1)}if(s.value.length===4){var a=s.value.substring(0,1),n=s.value.substring(1,2),i=s.value.substring(2,3),l=s.value.substring(3,4);return ru(parseInt(a+a,16),parseInt(n+n,16),parseInt(i+i,16),parseInt(l+l,16)/255)}if(s.value.length===6){var a=s.value.substring(0,2),n=s.value.substring(2,4),i=s.value.substring(4,6);return ru(parseInt(a,16),parseInt(n,16),parseInt(i,16),1)}if(s.value.length===8){var a=s.value.substring(0,2),n=s.value.substring(2,4),i=s.value.substring(4,6),l=s.value.substring(6,8);return ru(parseInt(a,16),parseInt(n,16),parseInt(i,16),parseInt(l,16)/255)}}if(s.type===20){var o=Yc[s.value.toUpperCase()];if(typeof o<"u")return o}return Yc.TRANSPARENT}},ou=function(t){return(255&t)===0},Sn=function(t){var s=255&t,r=255&t>>8,a=255&t>>16,n=255&t>>24;return s<255?"rgba("+n+","+a+","+r+","+s/255+")":"rgb("+n+","+a+","+r+")"},ru=function(t,s,r,a){return(t<<24|s<<16|r<<8|Math.round(a*255)<<0)>>>0},zw=function(t,s){if(t.type===17)return t.number;if(t.type===16){var r=s===3?1:255;return s===3?t.number/100*r:Math.round(t.number/100*r)}return 0},Yw=function(t,s){var r=s.filter(Ih);if(r.length===3){var a=r.map(zw),n=a[0],i=a[1],l=a[2];return ru(n,i,l,1)}if(r.length===4){var o=r.map(zw),n=o[0],i=o[1],l=o[2],u=o[3];return ru(n,i,l,u)}return 0};function Dv(t,s,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(s-t)*r*6+t:r<1/2?s:r<2/3?(s-t)*6*(2/3-r)+t:t}var Xw=function(t,s){var r=s.filter(Ih),a=r[0],n=r[1],i=r[2],l=r[3],o=(a.type===17?Kl(a.number):K0.parse(t,a))/(Math.PI*2),u=ln(n)?n.number/100:0,d=ln(i)?i.number/100:0,c=typeof l<"u"&&ln(l)?aa(l,1):1;if(u===0)return ru(d*255,d*255,d*255,1);var m=d<=.5?d*(u+1):d+u-d*u,h=d*2-m,f=Dv(h,m,o+1/3),x=Dv(h,m,o),g=Dv(h,m,o-1/3);return ru(f*255,x*255,g*255,c)},YP={hsl:Xw,hsla:Xw,rgb:Yw,rgba:Yw},qm=function(t,s){return lu.parse(t,B5.create(s).parseComponentValue())},Yc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},XP={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,s){return s.map(function(r){if(Yr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},JP={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},z0=function(t,s){var r=lu.parse(t,s[0]),a=s[1];return a&&ln(a)?{color:r,stop:a}:{color:r,stop:null}},Jw=function(t,s){var r=t[0],a=t[t.length-1];r.stop===null&&(r.stop=$n),a.stop===null&&(a.stop=su);for(var n=[],i=0,l=0;l<t.length;l++){var o=t[l].stop;if(o!==null){var u=aa(o,s);u>i?n.push(u):n.push(i),i=u}else n.push(null)}for(var d=null,l=0;l<n.length;l++){var c=n[l];if(c===null)d===null&&(d=l);else if(d!==null){for(var m=l-d,h=n[d-1],f=(c-h)/(m+1),x=1;x<=m;x++)n[d+x-1]=f*x;d=null}}return t.map(function(g,b){var y=g.color;return{color:y,stop:Math.max(Math.min(1,n[b]/s),0)}})},ZP=function(t,s,r){var a=s/2,n=r/2,i=aa(t[0],s)-a,l=n-aa(t[1],r);return(Math.atan2(l,i)+Math.PI*2)%(Math.PI*2)},eU=function(t,s,r){var a=typeof t=="number"?t:ZP(t,s,r),n=Math.abs(s*Math.sin(a))+Math.abs(r*Math.cos(a)),i=s/2,l=r/2,o=n/2,u=Math.sin(a-Math.PI/2)*o,d=Math.cos(a-Math.PI/2)*o;return[n,i-d,i+d,l-u,l+u]},No=function(t,s){return Math.sqrt(t*t+s*s)},Zw=function(t,s,r,a,n){var i=[[0,0],[0,s],[t,0],[t,s]];return i.reduce(function(l,o){var u=o[0],d=o[1],c=No(r-u,a-d);return(n?c<l.optimumDistance:c>l.optimumDistance)?{optimumCorner:o,optimumDistance:c}:l},{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},tU=function(t,s,r,a,n){var i=0,l=0;switch(t.size){case 0:t.shape===0?i=l=Math.min(Math.abs(s),Math.abs(s-a),Math.abs(r),Math.abs(r-n)):t.shape===1&&(i=Math.min(Math.abs(s),Math.abs(s-a)),l=Math.min(Math.abs(r),Math.abs(r-n)));break;case 2:if(t.shape===0)i=l=Math.min(No(s,r),No(s,r-n),No(s-a,r),No(s-a,r-n));else if(t.shape===1){var o=Math.min(Math.abs(r),Math.abs(r-n))/Math.min(Math.abs(s),Math.abs(s-a)),u=Zw(a,n,s,r,!0),d=u[0],c=u[1];i=No(d-s,(c-r)/o),l=o*i}break;case 1:t.shape===0?i=l=Math.max(Math.abs(s),Math.abs(s-a),Math.abs(r),Math.abs(r-n)):t.shape===1&&(i=Math.max(Math.abs(s),Math.abs(s-a)),l=Math.max(Math.abs(r),Math.abs(r-n)));break;case 3:if(t.shape===0)i=l=Math.max(No(s,r),No(s,r-n),No(s-a,r),No(s-a,r-n));else if(t.shape===1){var o=Math.max(Math.abs(r),Math.abs(r-n))/Math.max(Math.abs(s),Math.abs(s-a)),m=Zw(a,n,s,r,!1),d=m[0],c=m[1];i=No(d-s,(c-r)/o),l=o*i}break}return Array.isArray(t.size)&&(i=aa(t.size[0],a),l=t.size.length===2?aa(t.size[1],n):i),[i,l]},sU=function(t,s){var r=Kl(180),a=[];return uc(s).forEach(function(n,i){if(i===0){var l=n[0];if(l.type===20&&l.value==="to"){r=P5(n);return}else if(D5(l)){r=K0.parse(t,l);return}}var o=z0(t,n);a.push(o)}),{angle:r,stops:a,type:1}},Jp=function(t,s){var r=Kl(180),a=[];return uc(s).forEach(function(n,i){if(i===0){var l=n[0];if(l.type===20&&["top","left","right","bottom"].indexOf(l.value)!==-1){r=P5(n);return}else if(D5(l)){r=(K0.parse(t,l)+Kl(270))%Kl(360);return}}var o=z0(t,n);a.push(o)}),{angle:r,stops:a,type:1}},rU=function(t,s){var r=Kl(180),a=[],n=1,i=0,l=3,o=[];return uc(s).forEach(function(u,d){var c=u[0];if(d===0){if(Yr(c)&&c.value==="linear"){n=1;return}else if(Yr(c)&&c.value==="radial"){n=2;return}}if(c.type===18){if(c.name==="from"){var m=lu.parse(t,c.values[0]);a.push({stop:$n,color:m})}else if(c.name==="to"){var m=lu.parse(t,c.values[0]);a.push({stop:su,color:m})}else if(c.name==="color-stop"){var h=c.values.filter(Ih);if(h.length===2){var m=lu.parse(t,h[1]),f=h[0];qh(f)&&a.push({stop:{type:16,number:f.number*100,flags:f.flags},color:m})}}}}),n===1?{angle:(r+Kl(180))%Kl(360),stops:a,type:n}:{size:l,shape:i,stops:a,position:o,type:n}},U5="closest-side",R5="farthest-side",O5="closest-corner",Q5="farthest-corner",M5="circle",H5="ellipse",q5="cover",V5="contain",aU=function(t,s){var r=0,a=3,n=[],i=[];return uc(s).forEach(function(l,o){var u=!0;if(o===0){var d=!1;u=l.reduce(function(m,h){if(d)if(Yr(h))switch(h.value){case"center":return i.push(t1),m;case"top":case"left":return i.push($n),m;case"right":case"bottom":return i.push(su),m}else(ln(h)||Au(h))&&i.push(h);else if(Yr(h))switch(h.value){case M5:return r=0,!1;case H5:return r=1,!1;case"at":return d=!0,!1;case U5:return a=0,!1;case q5:case R5:return a=1,!1;case V5:case O5:return a=2,!1;case Q5:return a=3,!1}else if(Au(h)||ln(h))return Array.isArray(a)||(a=[]),a.push(h),!1;return m},u)}if(u){var c=z0(t,l);n.push(c)}}),{size:a,shape:r,stops:n,position:i,type:2}},Zp=function(t,s){var r=0,a=3,n=[],i=[];return uc(s).forEach(function(l,o){var u=!0;if(o===0?u=l.reduce(function(c,m){if(Yr(m))switch(m.value){case"center":return i.push(t1),!1;case"top":case"left":return i.push($n),!1;case"right":case"bottom":return i.push(su),!1}else if(ln(m)||Au(m))return i.push(m),!1;return c},u):o===1&&(u=l.reduce(function(c,m){if(Yr(m))switch(m.value){case M5:return r=0,!1;case H5:return r=1,!1;case V5:case U5:return a=0,!1;case R5:return a=1,!1;case O5:return a=2,!1;case q5:case Q5:return a=3,!1}else if(Au(m)||ln(m))return Array.isArray(a)||(a=[]),a.push(m),!1;return c},u)),u){var d=z0(t,l);n.push(d)}}),{size:a,shape:r,stops:n,position:i,type:2}},nU=function(t){return t.type===1},iU=function(t){return t.type===2},s1={name:"image",parse:function(t,s){if(s.type===22){var r={url:s.value,type:0};return t.cache.addImage(s.value),r}if(s.type===18){var a=$5[s.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+s.name+'"');return a(t,s.values)}throw new Error("Unsupported image type "+s.type)}};function lU(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!$5[t.name])}var $5={"linear-gradient":sU,"-moz-linear-gradient":Jp,"-ms-linear-gradient":Jp,"-o-linear-gradient":Jp,"-webkit-linear-gradient":Jp,"radial-gradient":aU,"-moz-radial-gradient":Zp,"-ms-radial-gradient":Zp,"-o-radial-gradient":Zp,"-webkit-radial-gradient":Zp,"-webkit-gradient":rU},oU={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,s){if(s.length===0)return[];var r=s[0];return r.type===20&&r.value==="none"?[]:s.filter(function(a){return Ih(a)&&lU(a)}).map(function(a){return s1.parse(t,a)})}},cU={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,s){return s.map(function(r){if(Yr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},dU={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,s){return uc(s).map(function(r){return r.filter(ln)}).map(E5)}},uU={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,s){return uc(s).map(function(r){return r.filter(Yr).map(function(a){return a.value}).join(" ")}).map(AU)}},AU=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},wh;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(wh||(wh={}));var hU={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,s){return uc(s).map(function(r){return r.filter(mU)})}},mU=function(t){return Yr(t)||ln(t)},Y0=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},fU=Y0("top"),pU=Y0("right"),xU=Y0("bottom"),gU=Y0("left"),X0=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(s,r){return E5(r.filter(ln))}}},vU=X0("top-left"),bU=X0("top-right"),yU=X0("bottom-right"),jU=X0("bottom-left"),J0=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(s,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},NU=J0("top"),wU=J0("right"),_U=J0("bottom"),SU=J0("left"),Z0=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(s,r){return Pf(r)?r.number:0}}},CU=Z0("top"),BU=Z0("right"),kU=Z0("bottom"),EU=Z0("left"),FU={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},TU={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,s){switch(s){case"rtl":return 1;case"ltr":default:return 0}}},IU={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,s){return s.filter(Yr).reduce(function(r,a){return r|LU(a.value)},0)}},LU=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},DU={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},PU={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,s){return s.type===20&&s.value==="normal"?0:s.type===17||s.type===15?s.number:0}},Jx;(function(t){t.NORMAL="normal",t.STRICT="strict"})(Jx||(Jx={}));var UU={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"strict":return Jx.STRICT;case"normal":default:return Jx.NORMAL}}},RU={name:"line-height",initialValue:"normal",prefix:!1,type:4},e2=function(t,s){return Yr(t)&&t.value==="normal"?1.2*s:t.type===17?s*t.number:ln(t)?aa(t,s):s},OU={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,s){return s.type===20&&s.value==="none"?null:s1.parse(t,s)}},QU={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,s){switch(s){case"inside":return 0;case"outside":default:return 1}}},oy={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},eg=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},MU=eg("top"),HU=eg("right"),qU=eg("bottom"),VU=eg("left"),$U={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,s){return s.filter(Yr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},WU={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"break-word":return"break-word";case"normal":default:return"normal"}}},tg=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},GU=tg("top"),KU=tg("right"),zU=tg("bottom"),YU=tg("left"),XU={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,s){switch(s){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},JU={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,s){switch(s){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},ZU={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.length===1&&ly(s[0],"none")?[]:uc(s).map(function(r){for(var a={color:Yc.TRANSPARENT,offsetX:$n,offsetY:$n,blur:$n},n=0,i=0;i<r.length;i++){var l=r[i];Au(l)?(n===0?a.offsetX=l:n===1?a.offsetY=l:a.blur=l,n++):a.color=lu.parse(t,l)}return a})}},eR={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},tR={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,s){if(s.type===20&&s.value==="none")return null;if(s.type===18){var r=aR[s.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+s.name+'"');return r(s.values)}return null}},sR=function(t){var s=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return s.length===6?s:null},rR=function(t){var s=t.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=s[0],a=s[1];s[2],s[3];var n=s[4],i=s[5];s[6],s[7],s[8],s[9],s[10],s[11];var l=s[12],o=s[13];return s[14],s[15],s.length===16?[r,a,n,i,l,o]:null},aR={matrix:sR,matrix3d:rR},t2={type:16,number:50,flags:Df},nR=[t2,t2],iR={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,s){var r=s.filter(ln);return r.length!==2?nR:[r[0],r[1]]}},lR={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Vm;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Vm||(Vm={}));var oR={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"break-all":return Vm.BREAK_ALL;case"keep-all":return Vm.KEEP_ALL;case"normal":default:return Vm.NORMAL}}},cR={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,s){if(s.type===20)return{auto:!0,order:0};if(qh(s))return{auto:!1,order:s.number};throw new Error("Invalid z-index number parsed")}},W5={name:"time",parse:function(t,s){if(s.type===15)switch(s.unit.toLowerCase()){case"s":return 1e3*s.number;case"ms":return s.number}throw new Error("Unsupported time type")}},dR={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,s){return qh(s)?s.number:1}},uR={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},AR={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,s){return s.filter(Yr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},hR={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,s){var r=[],a=[];return s.forEach(function(n){switch(n.type){case 20:case 0:r.push(n.value);break;case 17:r.push(n.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(n){return n.indexOf(" ")===-1?n:"'"+n+"'"})}},mR={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},fR={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,s){if(qh(s))return s.number;if(Yr(s))switch(s.value){case"bold":return 700;case"normal":default:return 400}return 400}},pR={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.filter(Yr).map(function(r){return r.value})}},xR={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},fn=function(t,s){return(t&s)!==0},gR={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,s){if(s.length===0)return[];var r=s[0];return r.type===20&&r.value==="none"?[]:s}},vR={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return null;var r=s[0];if(r.type===20&&r.value==="none")return null;for(var a=[],n=s.filter(k5),i=0;i<n.length;i++){var l=n[i],o=n[i+1];if(l.type===20){var u=o&&qh(o)?o.number:1;a.push({counter:l.value,increment:u})}}return a}},bR={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return[];for(var r=[],a=s.filter(k5),n=0;n<a.length;n++){var i=a[n],l=a[n+1];if(Yr(i)&&i.value!=="none"){var o=l&&qh(l)?l.number:0;r.push({counter:i.value,reset:o})}}return r}},yR={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,s){return s.filter(Pf).map(function(r){return W5.parse(t,r)})}},jR={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return null;var r=s[0];if(r.type===20&&r.value==="none")return null;var a=[],n=s.filter(KP);if(n.length%2!==0)return null;for(var i=0;i<n.length;i+=2){var l=n[i].value,o=n[i+1].value;a.push({open:l,close:o})}return a}},s2=function(t,s,r){if(!t)return"";var a=t[Math.min(s,t.length-1)];return a?r?a.open:a.close:""},NR={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.length===1&&ly(s[0],"none")?[]:uc(s).map(function(r){for(var a={color:255,offsetX:$n,offsetY:$n,blur:$n,spread:$n,inset:!1},n=0,i=0;i<r.length;i++){var l=r[i];ly(l,"inset")?a.inset=!0:Au(l)?(n===0?a.offsetX=l:n===1?a.offsetY=l:n===2?a.blur=l:a.spread=l,n++):a.color=lu.parse(t,l)}return a})}},wR={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,s){var r=[0,1,2],a=[];return s.filter(Yr).forEach(function(n){switch(n.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(n){a.indexOf(n)===-1&&a.push(n)}),a}},_R={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},SR={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,s){return Pf(s)?s.number:0}},CR=(function(){function t(s,r){var a,n;this.animationDuration=Bs(s,yR,r.animationDuration),this.backgroundClip=Bs(s,XP,r.backgroundClip),this.backgroundColor=Bs(s,JP,r.backgroundColor),this.backgroundImage=Bs(s,oU,r.backgroundImage),this.backgroundOrigin=Bs(s,cU,r.backgroundOrigin),this.backgroundPosition=Bs(s,dU,r.backgroundPosition),this.backgroundRepeat=Bs(s,uU,r.backgroundRepeat),this.backgroundSize=Bs(s,hU,r.backgroundSize),this.borderTopColor=Bs(s,fU,r.borderTopColor),this.borderRightColor=Bs(s,pU,r.borderRightColor),this.borderBottomColor=Bs(s,xU,r.borderBottomColor),this.borderLeftColor=Bs(s,gU,r.borderLeftColor),this.borderTopLeftRadius=Bs(s,vU,r.borderTopLeftRadius),this.borderTopRightRadius=Bs(s,bU,r.borderTopRightRadius),this.borderBottomRightRadius=Bs(s,yU,r.borderBottomRightRadius),this.borderBottomLeftRadius=Bs(s,jU,r.borderBottomLeftRadius),this.borderTopStyle=Bs(s,NU,r.borderTopStyle),this.borderRightStyle=Bs(s,wU,r.borderRightStyle),this.borderBottomStyle=Bs(s,_U,r.borderBottomStyle),this.borderLeftStyle=Bs(s,SU,r.borderLeftStyle),this.borderTopWidth=Bs(s,CU,r.borderTopWidth),this.borderRightWidth=Bs(s,BU,r.borderRightWidth),this.borderBottomWidth=Bs(s,kU,r.borderBottomWidth),this.borderLeftWidth=Bs(s,EU,r.borderLeftWidth),this.boxShadow=Bs(s,NR,r.boxShadow),this.color=Bs(s,FU,r.color),this.direction=Bs(s,TU,r.direction),this.display=Bs(s,IU,r.display),this.float=Bs(s,DU,r.cssFloat),this.fontFamily=Bs(s,hR,r.fontFamily),this.fontSize=Bs(s,mR,r.fontSize),this.fontStyle=Bs(s,xR,r.fontStyle),this.fontVariant=Bs(s,pR,r.fontVariant),this.fontWeight=Bs(s,fR,r.fontWeight),this.letterSpacing=Bs(s,PU,r.letterSpacing),this.lineBreak=Bs(s,UU,r.lineBreak),this.lineHeight=Bs(s,RU,r.lineHeight),this.listStyleImage=Bs(s,OU,r.listStyleImage),this.listStylePosition=Bs(s,QU,r.listStylePosition),this.listStyleType=Bs(s,oy,r.listStyleType),this.marginTop=Bs(s,MU,r.marginTop),this.marginRight=Bs(s,HU,r.marginRight),this.marginBottom=Bs(s,qU,r.marginBottom),this.marginLeft=Bs(s,VU,r.marginLeft),this.opacity=Bs(s,dR,r.opacity);var i=Bs(s,$U,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=Bs(s,WU,r.overflowWrap),this.paddingTop=Bs(s,GU,r.paddingTop),this.paddingRight=Bs(s,KU,r.paddingRight),this.paddingBottom=Bs(s,zU,r.paddingBottom),this.paddingLeft=Bs(s,YU,r.paddingLeft),this.paintOrder=Bs(s,wR,r.paintOrder),this.position=Bs(s,JU,r.position),this.textAlign=Bs(s,XU,r.textAlign),this.textDecorationColor=Bs(s,uR,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=Bs(s,AR,(n=r.textDecorationLine)!==null&&n!==void 0?n:r.textDecoration),this.textShadow=Bs(s,ZU,r.textShadow),this.textTransform=Bs(s,eR,r.textTransform),this.transform=Bs(s,tR,r.transform),this.transformOrigin=Bs(s,iR,r.transformOrigin),this.visibility=Bs(s,lR,r.visibility),this.webkitTextStrokeColor=Bs(s,_R,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Bs(s,SR,r.webkitTextStrokeWidth),this.wordBreak=Bs(s,oR,r.wordBreak),this.zIndex=Bs(s,cR,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return ou(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return fn(this.display,4)||fn(this.display,33554432)||fn(this.display,268435456)||fn(this.display,536870912)||fn(this.display,67108864)||fn(this.display,134217728)},t})(),BR=(function(){function t(s,r){this.content=Bs(s,gR,r.content),this.quotes=Bs(s,jR,r.quotes)}return t})(),r2=(function(){function t(s,r){this.counterIncrement=Bs(s,vR,r.counterIncrement),this.counterReset=Bs(s,bR,r.counterReset)}return t})(),Bs=function(t,s,r){var a=new C5,n=r!==null&&typeof r<"u"?r.toString():s.initialValue;a.write(n);var i=new B5(a.read());switch(s.type){case 2:var l=i.parseComponentValue();return s.parse(t,Yr(l)?l.value:s.initialValue);case 0:return s.parse(t,i.parseComponentValue());case 1:return s.parse(t,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(s.format){case"angle":return K0.parse(t,i.parseComponentValue());case"color":return lu.parse(t,i.parseComponentValue());case"image":return s1.parse(t,i.parseComponentValue());case"length":var o=i.parseComponentValue();return Au(o)?o:$n;case"length-percentage":var u=i.parseComponentValue();return ln(u)?u:$n;case"time":return W5.parse(t,i.parseComponentValue())}break}},kR="data-html2canvas-debug",ER=function(t){var s=t.getAttribute(kR);switch(s){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},cy=function(t,s){var r=ER(t);return r===1||s===r},Ac=(function(){function t(s,r){if(this.context=s,this.textNodes=[],this.elements=[],this.flags=0,cy(r,3))debugger;this.styles=new CR(s,window.getComputedStyle(r,null)),Ay(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=W0(this.context,r),cy(r,4)&&(this.flags|=16)}return t})(),FR="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",a2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Tm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ex=0;ex<a2.length;ex++)Tm[a2.charCodeAt(ex)]=ex;var TR=function(t){var s=t.length*.75,r=t.length,a,n=0,i,l,o,u;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(s):new Array(s),c=Array.isArray(d)?d:new Uint8Array(d);for(a=0;a<r;a+=4)i=Tm[t.charCodeAt(a)],l=Tm[t.charCodeAt(a+1)],o=Tm[t.charCodeAt(a+2)],u=Tm[t.charCodeAt(a+3)],c[n++]=i<<2|l>>4,c[n++]=(l&15)<<4|o>>2,c[n++]=(o&3)<<6|u&63;return d},IR=function(t){for(var s=t.length,r=[],a=0;a<s;a+=2)r.push(t[a+1]<<8|t[a]);return r},LR=function(t){for(var s=t.length,r=[],a=0;a<s;a+=4)r.push(t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a]);return r},dA=5,r1=11,Pv=2,DR=r1-dA,G5=65536>>dA,PR=1<<dA,Uv=PR-1,UR=1024>>dA,RR=G5+UR,OR=RR,QR=32,MR=OR+QR,HR=65536>>r1,qR=1<<DR,VR=qR-1,n2=function(t,s,r){return t.slice?t.slice(s,r):new Uint16Array(Array.prototype.slice.call(t,s,r))},$R=function(t,s,r){return t.slice?t.slice(s,r):new Uint32Array(Array.prototype.slice.call(t,s,r))},WR=function(t,s){var r=TR(t),a=Array.isArray(r)?LR(r):new Uint32Array(r),n=Array.isArray(r)?IR(r):new Uint16Array(r),i=24,l=n2(n,i/2,a[4]/2),o=a[5]===2?n2(n,(i+a[4])/2):$R(a,Math.ceil((i+a[4])/4));return new GR(a[0],a[1],a[2],a[3],l,o)},GR=(function(){function t(s,r,a,n,i,l){this.initialValue=s,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=i,this.data=l}return t.prototype.get=function(s){var r;if(s>=0){if(s<55296||s>56319&&s<=65535)return r=this.index[s>>dA],r=(r<<Pv)+(s&Uv),this.data[r];if(s<=65535)return r=this.index[G5+(s-55296>>dA)],r=(r<<Pv)+(s&Uv),this.data[r];if(s<this.highStart)return r=MR-HR+(s>>r1),r=this.index[r],r+=s>>dA&VR,r=this.index[r],r=(r<<Pv)+(s&Uv),this.data[r];if(s<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t})(),i2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",KR=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var tx=0;tx<i2.length;tx++)KR[i2.charCodeAt(tx)]=tx;var zR=1,Rv=2,Ov=3,l2=4,o2=5,YR=7,c2=8,Qv=9,Mv=10,d2=11,u2=12,A2=13,h2=14,Hv=15,XR=function(t){for(var s=[],r=0,a=t.length;r<a;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var i=t.charCodeAt(r++);(i&64512)===56320?s.push(((n&1023)<<10)+(i&1023)+65536):(s.push(n),r--)}else s.push(n)}return s},JR=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var a=[],n=-1,i="";++n<r;){var l=t[n];l<=65535?a.push(l):(l-=65536,a.push((l>>10)+55296,l%1024+56320)),(n+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},ZR=WR(FR),ql="",qv="",e8=function(t){return ZR.get(t)},t8=function(t,s,r){var a=r-2,n=s[a],i=s[r-1],l=s[r];if(i===Rv&&l===Ov)return ql;if(i===Rv||i===Ov||i===l2||l===Rv||l===Ov||l===l2)return qv;if(i===c2&&[c2,Qv,d2,u2].indexOf(l)!==-1||(i===d2||i===Qv)&&(l===Qv||l===Mv)||(i===u2||i===Mv)&&l===Mv||l===A2||l===o2||l===YR||i===zR)return ql;if(i===A2&&l===h2){for(;n===o2;)n=s[--a];if(n===h2)return ql}if(i===Hv&&l===Hv){for(var o=0;n===Hv;)o++,n=s[--a];if(o%2===0)return ql}return qv},s8=function(t){var s=XR(t),r=s.length,a=0,n=0,i=s.map(e8);return{next:function(){if(a>=r)return{done:!0,value:null};for(var l=ql;a<r&&(l=t8(s,i,++a))===ql;);if(l!==ql||a===r){var o=JR.apply(null,s.slice(n,a));return n=a,{value:o,done:!1}}return{done:!0,value:null}}}},r8=function(t){for(var s=s8(t),r=[],a;!(a=s.next()).done;)a.value&&r.push(a.value.slice());return r},a8=function(t){var s=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var a=t.createElement("boundtest");a.style.height=s+"px",a.style.display="block",t.body.appendChild(a),r.selectNode(a);var n=r.getBoundingClientRect(),i=Math.round(n.height);if(t.body.removeChild(a),i===s)return!0}}return!1},n8=function(t){var s=t.createElement("boundtest");s.style.width="50px",s.style.display="block",s.style.fontSize="12px",s.style.letterSpacing="0px",s.style.wordSpacing="0px",t.body.appendChild(s);var r=t.createRange();s.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=s.firstChild,n=G0(a.data).map(function(u){return Ga(u)}),i=0,l={},o=n.every(function(u,d){r.setStart(a,i),r.setEnd(a,i+u.length);var c=r.getBoundingClientRect();i+=u.length;var m=c.x>l.x||c.y>l.y;return l=c,d===0?!0:m});return t.body.removeChild(s),o},i8=function(){return typeof new Image().crossOrigin<"u"},l8=function(){return typeof new XMLHttpRequest().responseType=="string"},o8=function(t){var s=new Image,r=t.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;s.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(s,0,0),r.toDataURL()}catch{return!1}return!0},m2=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},c8=function(t){var s=t.createElement("canvas"),r=100;s.width=r,s.height=r;var a=s.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var n=new Image,i=s.toDataURL();n.src=i;var l=dy(r,r,0,0,n);return a.fillStyle="red",a.fillRect(0,0,r,r),f2(l).then(function(o){a.drawImage(o,0,0);var u=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var d=t.createElement("div");return d.style.backgroundImage="url("+i+")",d.style.height=r+"px",m2(u)?f2(dy(r,r,0,0,d)):Promise.reject(!1)}).then(function(o){return a.drawImage(o,0,0),m2(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},dy=function(t,s,r,a,n){var i="http://www.w3.org/2000/svg",l=document.createElementNS(i,"svg"),o=document.createElementNS(i,"foreignObject");return l.setAttributeNS(null,"width",t.toString()),l.setAttributeNS(null,"height",s.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",r.toString()),o.setAttributeNS(null,"y",a.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),l.appendChild(o),o.appendChild(n),l},f2=function(t){return new Promise(function(s,r){var a=new Image;a.onload=function(){return s(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Hn={get SUPPORT_RANGE_BOUNDS(){var t=a8(document);return Object.defineProperty(Hn,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Hn.SUPPORT_RANGE_BOUNDS&&n8(document);return Object.defineProperty(Hn,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=o8(document);return Object.defineProperty(Hn,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?c8(document):Promise.resolve(!1);return Object.defineProperty(Hn,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=i8();return Object.defineProperty(Hn,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=l8();return Object.defineProperty(Hn,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Hn,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Hn,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},$m=(function(){function t(s,r){this.text=s,this.bounds=r}return t})(),d8=function(t,s,r,a){var n=h8(s,r),i=[],l=0;return n.forEach(function(o){if(r.textDecorationLine.length||o.trim().length>0)if(Hn.SUPPORT_RANGE_BOUNDS){var u=p2(a,l,o.length).getClientRects();if(u.length>1){var d=a1(o),c=0;d.forEach(function(h){i.push(new $m(h,td.fromDOMRectList(t,p2(a,c+l,h.length).getClientRects()))),c+=h.length})}else i.push(new $m(o,td.fromDOMRectList(t,u)))}else{var m=a.splitText(o.length);i.push(new $m(o,u8(t,a))),a=m}else Hn.SUPPORT_RANGE_BOUNDS||(a=a.splitText(o.length));l+=o.length}),i},u8=function(t,s){var r=s.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(s.cloneNode(!0));var n=s.parentNode;if(n){n.replaceChild(a,s);var i=W0(t,a);return a.firstChild&&n.replaceChild(a.firstChild,a),i}}return td.EMPTY},p2=function(t,s,r){var a=t.ownerDocument;if(!a)throw new Error("Node has no owner document");var n=a.createRange();return n.setStart(t,s),n.setEnd(t,s+r),n},a1=function(t){if(Hn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var s=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(s.segment(t)).map(function(r){return r.segment})}return r8(t)},A8=function(t,s){if(Hn.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(a){return a.segment})}return f8(t,s)},h8=function(t,s){return s.letterSpacing!==0?a1(t):A8(t,s)},m8=[32,160,4961,65792,65793,4153,4241],f8=function(t,s){for(var r=HD(t,{lineBreak:s.lineBreak,wordBreak:s.overflowWrap==="break-word"?"break-word":s.wordBreak}),a=[],n,i=function(){if(n.value){var l=n.value.slice(),o=G0(l),u="";o.forEach(function(d){m8.indexOf(d)===-1?u+=Ga(d):(u.length&&a.push(u),a.push(Ga(d)),u="")}),u.length&&a.push(u)}};!(n=r.next()).done;)i();return a},p8=(function(){function t(s,r,a){this.text=x8(r.data,a.textTransform),this.textBounds=d8(s,this.text,a,r)}return t})(),x8=function(t,s){switch(s){case 1:return t.toLowerCase();case 3:return t.replace(g8,v8);case 2:return t.toUpperCase();default:return t}},g8=/(^|\s|:|-|\(|\))([a-z])/g,v8=function(t,s,r){return t.length>0?s+r.toUpperCase():t},K5=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.src=a.currentSrc||a.src,n.intrinsicWidth=a.naturalWidth,n.intrinsicHeight=a.naturalHeight,n.context.cache.addImage(n.src),n}return s})(Ac),z5=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.canvas=a,n.intrinsicWidth=a.width,n.intrinsicHeight=a.height,n}return s})(Ac),Y5=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this,i=new XMLSerializer,l=W0(r,a);return a.setAttribute("width",l.width+"px"),a.setAttribute("height",l.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(a)),n.intrinsicWidth=a.width.baseVal.value,n.intrinsicHeight=a.height.baseVal.value,n.context.cache.addImage(n.svg),n}return s})(Ac),X5=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.value=a.value,n}return s})(Ac),uy=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.start=a.start,n.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,n}return s})(Ac),b8=[{type:15,flags:0,unit:"px",number:3}],y8=[{type:16,flags:0,number:50}],j8=function(t){return t.width>t.height?new td(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new td(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},N8=function(t){var s=t.type===w8?new Array(t.value.length+1).join(""):t.value;return s.length===0?t.placeholder||"":s},Zx="checkbox",e0="radio",w8="password",x2=707406591,n1=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;switch(n.type=a.type.toLowerCase(),n.checked=a.checked,n.value=N8(a),(n.type===Zx||n.type===e0)&&(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=j8(n.bounds)),n.type){case Zx:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=b8;break;case e0:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=y8;break}return n}return s})(Ac),J5=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this,i=a.options[a.selectedIndex||0];return n.value=i&&i.text||"",n}return s})(Ac),Z5=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.value=a.value,n}return s})(Ac),e4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;n.src=a.src,n.width=parseInt(a.width,10)||0,n.height=parseInt(a.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){n.tree=s4(r,a.contentWindow.document.documentElement);var i=a.contentWindow.document.documentElement?qm(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):Yc.TRANSPARENT,l=a.contentWindow.document.body?qm(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):Yc.TRANSPARENT;n.backgroundColor=ou(i)?ou(l)?n.styles.backgroundColor:l:i}}catch{}return n}return s})(Ac),_8=["OL","UL","MENU"],Ix=function(t,s,r,a){for(var n=s.firstChild,i=void 0;n;n=i)if(i=n.nextSibling,r4(n)&&n.data.trim().length>0)r.textNodes.push(new p8(t,n,r.styles));else if(xh(n))if(l4(n)&&n.assignedNodes)n.assignedNodes().forEach(function(o){return Ix(t,o,r,a)});else{var l=t4(t,n);l.styles.isVisible()&&(S8(n,l,a)?l.flags|=4:C8(l.styles)&&(l.flags|=2),_8.indexOf(n.tagName)!==-1&&(l.flags|=8),r.elements.push(l),n.slot,n.shadowRoot?Ix(t,n.shadowRoot,l,a):!t0(n)&&!a4(n)&&!s0(n)&&Ix(t,n,l,a))}},t4=function(t,s){return hy(s)?new K5(t,s):n4(s)?new z5(t,s):a4(s)?new Y5(t,s):B8(s)?new X5(t,s):k8(s)?new uy(t,s):E8(s)?new n1(t,s):s0(s)?new J5(t,s):t0(s)?new Z5(t,s):i4(s)?new e4(t,s):new Ac(t,s)},s4=function(t,s){var r=t4(t,s);return r.flags|=4,Ix(t,s,r,r),r},S8=function(t,s,r){return s.styles.isPositionedWithZIndex()||s.styles.opacity<1||s.styles.isTransformed()||i1(t)&&r.styles.isTransparent()},C8=function(t){return t.isPositioned()||t.isFloating()},r4=function(t){return t.nodeType===Node.TEXT_NODE},xh=function(t){return t.nodeType===Node.ELEMENT_NODE},Ay=function(t){return xh(t)&&typeof t.style<"u"&&!Lx(t)},Lx=function(t){return typeof t.className=="object"},B8=function(t){return t.tagName==="LI"},k8=function(t){return t.tagName==="OL"},E8=function(t){return t.tagName==="INPUT"},F8=function(t){return t.tagName==="HTML"},a4=function(t){return t.tagName==="svg"},i1=function(t){return t.tagName==="BODY"},n4=function(t){return t.tagName==="CANVAS"},g2=function(t){return t.tagName==="VIDEO"},hy=function(t){return t.tagName==="IMG"},i4=function(t){return t.tagName==="IFRAME"},v2=function(t){return t.tagName==="STYLE"},T8=function(t){return t.tagName==="SCRIPT"},t0=function(t){return t.tagName==="TEXTAREA"},s0=function(t){return t.tagName==="SELECT"},l4=function(t){return t.tagName==="SLOT"},b2=function(t){return t.tagName.indexOf("-")>0},I8=(function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(s){var r=this.counters[s];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(s){var r=this.counters[s];return r||[]},t.prototype.pop=function(s){var r=this;s.forEach(function(a){return r.counters[a].pop()})},t.prototype.parse=function(s){var r=this,a=s.counterIncrement,n=s.counterReset,i=!0;a!==null&&a.forEach(function(o){var u=r.counters[o.counter];u&&o.increment!==0&&(i=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=o.increment)});var l=[];return i&&n.forEach(function(o){var u=r.counters[o.counter];l.push(o.counter),u||(u=r.counters[o.counter]=[]),u.push(o.reset)}),l},t})(),y2={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},j2={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},L8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},D8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},rh=function(t,s,r,a,n,i){return t<s||t>r?Af(t,n,i.length>0):a.integers.reduce(function(l,o,u){for(;t>=o;)t-=o,l+=a.values[u];return l},"")+i},o4=function(t,s,r,a){var n="";do r||t--,n=a(t)+n,t/=s;while(t*s>=s);return n},$a=function(t,s,r,a,n){var i=r-s+1;return(t<0?"-":"")+(o4(Math.abs(t),i,a,function(l){return Ga(Math.floor(l%i)+s)})+n)},Wu=function(t,s,r){r===void 0&&(r=". ");var a=s.length;return o4(Math.abs(t),a,!1,function(n){return s[Math.floor(n%a)]})+r},hh=1,zd=2,Yd=4,Im=8,Oc=function(t,s,r,a,n,i){if(t<-9999||t>9999)return Af(t,4,n.length>0);var l=Math.abs(t),o=n;if(l===0)return s[0]+o;for(var u=0;l>0&&u<=4;u++){var d=l%10;d===0&&fn(i,hh)&&o!==""?o=s[d]+o:d>1||d===1&&u===0||d===1&&u===1&&fn(i,zd)||d===1&&u===1&&fn(i,Yd)&&t>100||d===1&&u>1&&fn(i,Im)?o=s[d]+(u>0?r[u-1]:"")+o:d===1&&u>0&&(o=r[u-1]+o),l=Math.floor(l/10)}return(t<0?a:"")+o},N2="",w2="",_2="",Vv="",Af=function(t,s,r){var a=r?". ":"",n=r?"":"",i=r?", ":"",l=r?" ":"";switch(s){case 0:return""+l;case 1:return""+l;case 2:return""+l;case 5:var o=$a(t,48,57,!0,a);return o.length<4?"0"+o:o;case 4:return Wu(t,"",n);case 6:return rh(t,1,3999,y2,3,a).toLowerCase();case 7:return rh(t,1,3999,y2,3,a);case 8:return $a(t,945,969,!1,a);case 9:return $a(t,97,122,!1,a);case 10:return $a(t,65,90,!1,a);case 11:return $a(t,1632,1641,!0,a);case 12:case 49:return rh(t,1,9999,j2,3,a);case 35:return rh(t,1,9999,j2,3,a).toLowerCase();case 13:return $a(t,2534,2543,!0,a);case 14:case 30:return $a(t,6112,6121,!0,a);case 15:return Wu(t,"",n);case 16:return Wu(t,"",n);case 17:case 48:return Oc(t,"",N2,"",n,zd|Yd|Im);case 47:return Oc(t,"",w2,"",n,hh|zd|Yd|Im);case 42:return Oc(t,"",N2,"",n,zd|Yd|Im);case 41:return Oc(t,"",w2,"",n,hh|zd|Yd|Im);case 26:return Oc(t,"","",_2,n,0);case 25:return Oc(t,"","",_2,n,hh|zd|Yd);case 31:return Oc(t,"","",Vv,i,hh|zd|Yd);case 33:return Oc(t,"","",Vv,i,0);case 32:return Oc(t,"","",Vv,i,hh|zd|Yd);case 18:return $a(t,2406,2415,!0,a);case 20:return rh(t,1,19999,D8,3,a);case 21:return $a(t,2790,2799,!0,a);case 22:return $a(t,2662,2671,!0,a);case 22:return rh(t,1,10999,L8,3,a);case 23:return Wu(t,"");case 24:return Wu(t,"");case 27:return $a(t,3302,3311,!0,a);case 28:return Wu(t,"",n);case 29:return Wu(t,"",n);case 34:return $a(t,3792,3801,!0,a);case 37:return $a(t,6160,6169,!0,a);case 38:return $a(t,4160,4169,!0,a);case 39:return $a(t,2918,2927,!0,a);case 40:return $a(t,1776,1785,!0,a);case 43:return $a(t,3046,3055,!0,a);case 44:return $a(t,3174,3183,!0,a);case 45:return $a(t,3664,3673,!0,a);case 46:return $a(t,3872,3881,!0,a);case 3:default:return $a(t,48,57,!0,a)}},c4="data-html2canvas-ignore",S2=(function(){function t(s,r,a){if(this.context=s,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new I8,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(s,r){var a=this,n=P8(s,r);if(!n.contentWindow)return Promise.reject("Unable to find iframe window");var i=s.defaultView.pageXOffset,l=s.defaultView.pageYOffset,o=n.contentWindow,u=o.document,d=O8(n).then(function(){return Ii(a,void 0,void 0,function(){var c,m;return di(this,function(h){switch(h.label){case 0:return this.scrolledElements.forEach(q8),o&&(o.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==r.top||o.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-r.left,o.scrollY-r.top,0,0))),c=this.options.onclone,m=this.clonedReferenceElement,typeof m>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:h.sent(),h.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,R8(u)]:[3,4];case 3:h.sent(),h.label=4;case 4:return typeof c=="function"?[2,Promise.resolve().then(function(){return c(u,m)}).then(function(){return n})]:[2,n]}})})});return u.open(),u.write(M8(document.doctype)+"<html></html>"),H8(this.referenceElement.ownerDocument,i,l),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),d},t.prototype.createElementClone=function(s){if(cy(s,2))debugger;if(n4(s))return this.createCanvasClone(s);if(g2(s))return this.createVideoClone(s);if(v2(s))return this.createStyleClone(s);var r=s.cloneNode(!1);return hy(r)&&(hy(s)&&s.currentSrc&&s.currentSrc!==s.src&&(r.src=s.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),b2(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(s){var r=document.createElement("html2canvascustomelement");return $v(s.style,r),r},t.prototype.createStyleClone=function(s){try{var r=s.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(i,l){return l&&typeof l.cssText=="string"?i+l.cssText:i},""),n=s.cloneNode(!1);return n.textContent=a,n}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return s.cloneNode(!1)},t.prototype.createCanvasClone=function(s){var r;if(this.options.inlineImages&&s.ownerDocument){var a=s.ownerDocument.createElement("img");try{return a.src=s.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",s)}}var n=s.cloneNode(!1);try{n.width=s.width,n.height=s.height;var i=s.getContext("2d"),l=n.getContext("2d");if(l)if(!this.options.allowTaint&&i)l.putImageData(i.getImageData(0,0,s.width,s.height),0,0);else{var o=(r=s.getContext("webgl2"))!==null&&r!==void 0?r:s.getContext("webgl");if(o){var u=o.getContextAttributes();(u==null?void 0:u.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",s)}l.drawImage(s,0,0)}return n}catch{this.context.logger.info("Unable to clone canvas as it is tainted",s)}return n},t.prototype.createVideoClone=function(s){var r=s.ownerDocument.createElement("canvas");r.width=s.offsetWidth,r.height=s.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(s,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",s)}var n=s.ownerDocument.createElement("canvas");return n.width=s.offsetWidth,n.height=s.offsetHeight,n},t.prototype.appendChildNode=function(s,r,a){(!xh(r)||!T8(r)&&!r.hasAttribute(c4)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!xh(r)||!v2(r))&&s.appendChild(this.cloneNode(r,a))},t.prototype.cloneChildNodes=function(s,r,a){for(var n=this,i=s.shadowRoot?s.shadowRoot.firstChild:s.firstChild;i;i=i.nextSibling)if(xh(i)&&l4(i)&&typeof i.assignedNodes=="function"){var l=i.assignedNodes();l.length&&l.forEach(function(o){return n.appendChildNode(r,o,a)})}else this.appendChildNode(r,i,a)},t.prototype.cloneNode=function(s,r){if(r4(s))return document.createTextNode(s.data);if(!s.ownerDocument)return s.cloneNode(!1);var a=s.ownerDocument.defaultView;if(a&&xh(s)&&(Ay(s)||Lx(s))){var n=this.createElementClone(s);n.style.transitionProperty="none";var i=a.getComputedStyle(s),l=a.getComputedStyle(s,":before"),o=a.getComputedStyle(s,":after");this.referenceElement===s&&Ay(n)&&(this.clonedReferenceElement=n),i1(n)&&W8(n);var u=this.counters.parse(new r2(this.context,i)),d=this.resolvePseudoContent(s,n,l,Wm.BEFORE);b2(s)&&(r=!0),g2(s)||this.cloneChildNodes(s,n,r),d&&n.insertBefore(d,n.firstChild);var c=this.resolvePseudoContent(s,n,o,Wm.AFTER);return c&&n.appendChild(c),this.counters.pop(u),(i&&(this.options.copyStyles||Lx(s))&&!i4(s)||r)&&$v(i,n),(s.scrollTop!==0||s.scrollLeft!==0)&&this.scrolledElements.push([n,s.scrollLeft,s.scrollTop]),(t0(s)||s0(s))&&(t0(n)||s0(n))&&(n.value=s.value),n}return s.cloneNode(!1)},t.prototype.resolvePseudoContent=function(s,r,a,n){var i=this;if(a){var l=a.content,o=r.ownerDocument;if(!(!o||!l||l==="none"||l==="-moz-alt-content"||a.display==="none")){this.counters.parse(new r2(this.context,a));var u=new BR(this.context,a),d=o.createElement("html2canvaspseudoelement");$v(a,d),u.content.forEach(function(m){if(m.type===0)d.appendChild(o.createTextNode(m.value));else if(m.type===22){var h=o.createElement("img");h.src=m.value,h.style.opacity="1",d.appendChild(h)}else if(m.type===18){if(m.name==="attr"){var f=m.values.filter(Yr);f.length&&d.appendChild(o.createTextNode(s.getAttribute(f[0].value)||""))}else if(m.name==="counter"){var x=m.values.filter(Ih),g=x[0],b=x[1];if(g&&Yr(g)){var y=i.counters.getCounterValue(g.value),N=b&&Yr(b)?oy.parse(i.context,b.value):3;d.appendChild(o.createTextNode(Af(y,N,!1)))}}else if(m.name==="counters"){var j=m.values.filter(Ih),g=j[0],S=j[1],b=j[2];if(g&&Yr(g)){var k=i.counters.getCounterValues(g.value),P=b&&Yr(b)?oy.parse(i.context,b.value):3,I=S&&S.type===0?S.value:"",B=k.map(function(O){return Af(O,P,!1)}).join(I);d.appendChild(o.createTextNode(B))}}}else if(m.type===20)switch(m.value){case"open-quote":d.appendChild(o.createTextNode(s2(u.quotes,i.quoteDepth++,!0)));break;case"close-quote":d.appendChild(o.createTextNode(s2(u.quotes,--i.quoteDepth,!1)));break;default:d.appendChild(o.createTextNode(m.value))}}),d.className=my+" "+fy;var c=n===Wm.BEFORE?" "+my:" "+fy;return Lx(r)?r.className.baseValue+=c:r.className+=c,d}}},t.destroy=function(s){return s.parentNode?(s.parentNode.removeChild(s),!0):!1},t})(),Wm;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Wm||(Wm={}));var P8=function(t,s){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=s.width.toString(),r.height=s.height.toString(),r.scrolling="no",r.setAttribute(c4,"true"),t.body.appendChild(r),r},U8=function(t){return new Promise(function(s){if(t.complete){s();return}if(!t.src){s();return}t.onload=s,t.onerror=s})},R8=function(t){return Promise.all([].slice.call(t.images,0).map(U8))},O8=function(t){return new Promise(function(s,r){var a=t.contentWindow;if(!a)return r("No window assigned for iframe");var n=a.document;a.onload=t.onload=function(){a.onload=t.onload=null;var i=setInterval(function(){n.body.childNodes.length>0&&n.readyState==="complete"&&(clearInterval(i),s(t))},50)}})},Q8=["all","d","content"],$v=function(t,s){for(var r=t.length-1;r>=0;r--){var a=t.item(r);Q8.indexOf(a)===-1&&s.style.setProperty(a,t.getPropertyValue(a))}return s},M8=function(t){var s="";return t&&(s+="<!DOCTYPE ",t.name&&(s+=t.name),t.internalSubset&&(s+=t.internalSubset),t.publicId&&(s+='"'+t.publicId+'"'),t.systemId&&(s+='"'+t.systemId+'"'),s+=">"),s},H8=function(t,s,r){t&&t.defaultView&&(s!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(s,r)},q8=function(t){var s=t[0],r=t[1],a=t[2];s.scrollLeft=r,s.scrollTop=a},V8=":before",$8=":after",my="___html2canvas___pseudoelement_before",fy="___html2canvas___pseudoelement_after",C2=`{
    content: "" !important;
    display: none !important;
}`,W8=function(t){G8(t,"."+my+V8+C2+`
         .`+fy+$8+C2)},G8=function(t,s){var r=t.ownerDocument;if(r){var a=r.createElement("style");a.textContent=s,t.appendChild(a)}},d4=(function(){function t(){}return t.getOrigin=function(s){var r=t._link;return r?(r.href=s,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(s){return t.getOrigin(s)===t._origin},t.setContext=function(s){t._link=s.document.createElement("a"),t._origin=t.getOrigin(s.location.href)},t._origin="about:blank",t})(),K8=(function(){function t(s,r){this.context=s,this._options=r,this._cache={}}return t.prototype.addImage=function(s){var r=Promise.resolve();return this.has(s)||(Gv(s)||J8(s))&&(this._cache[s]=this.loadImage(s)).catch(function(){}),r},t.prototype.match=function(s){return this._cache[s]},t.prototype.loadImage=function(s){return Ii(this,void 0,void 0,function(){var r,a,n,i,l=this;return di(this,function(o){switch(o.label){case 0:return r=d4.isSameOrigin(s),a=!Wv(s)&&this._options.useCORS===!0&&Hn.SUPPORT_CORS_IMAGES&&!r,n=!Wv(s)&&!r&&!Gv(s)&&typeof this._options.proxy=="string"&&Hn.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!Wv(s)&&!Gv(s)&&!n&&!a?[2]:(i=s,n?[4,this.proxy(i)]:[3,2]);case 1:i=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+s.substring(0,256)),[4,new Promise(function(u,d){var c=new Image;c.onload=function(){return u(c)},c.onerror=d,(Z8(i)||a)&&(c.crossOrigin="anonymous"),c.src=i,c.complete===!0&&setTimeout(function(){return u(c)},500),l._options.imageTimeout>0&&setTimeout(function(){return d("Timed out ("+l._options.imageTimeout+"ms) loading image")},l._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},t.prototype.has=function(s){return typeof this._cache[s]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(s){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var n=s.substring(0,256);return new Promise(function(i,l){var o=Hn.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(o==="text")i(u.response);else{var m=new FileReader;m.addEventListener("load",function(){return i(m.result)},!1),m.addEventListener("error",function(h){return l(h)},!1),m.readAsDataURL(u.response)}else l("Failed to proxy resource "+n+" with status code "+u.status)},u.onerror=l;var d=a.indexOf("?")>-1?"&":"?";if(u.open("GET",""+a+d+"url="+encodeURIComponent(s)+"&responseType="+o),o!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=o),r._options.imageTimeout){var c=r._options.imageTimeout;u.timeout=c,u.ontimeout=function(){return l("Timed out ("+c+"ms) proxying "+n)}}u.send()})},t})(),z8=/^data:image\/svg\+xml/i,Y8=/^data:image\/.*;base64,/i,X8=/^data:image\/.*/i,J8=function(t){return Hn.SUPPORT_SVG_DRAWING||!eO(t)},Wv=function(t){return X8.test(t)},Z8=function(t){return Y8.test(t)},Gv=function(t){return t.substr(0,4)==="blob"},eO=function(t){return t.substr(-3).toLowerCase()==="svg"||z8.test(t)},Ss=(function(){function t(s,r){this.type=0,this.x=s,this.y=r}return t.prototype.add=function(s,r){return new t(this.x+s,this.y+r)},t})(),ah=function(t,s,r){return new Ss(t.x+(s.x-t.x)*r,t.y+(s.y-t.y)*r)},sx=(function(){function t(s,r,a,n){this.type=1,this.start=s,this.startControl=r,this.endControl=a,this.end=n}return t.prototype.subdivide=function(s,r){var a=ah(this.start,this.startControl,s),n=ah(this.startControl,this.endControl,s),i=ah(this.endControl,this.end,s),l=ah(a,n,s),o=ah(n,i,s),u=ah(l,o,s);return r?new t(this.start,a,l,u):new t(u,o,i,this.end)},t.prototype.add=function(s,r){return new t(this.start.add(s,r),this.startControl.add(s,r),this.endControl.add(s,r),this.end.add(s,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t})(),Wl=function(t){return t.type===1},tO=(function(){function t(s){var r=s.styles,a=s.bounds,n=Fm(r.borderTopLeftRadius,a.width,a.height),i=n[0],l=n[1],o=Fm(r.borderTopRightRadius,a.width,a.height),u=o[0],d=o[1],c=Fm(r.borderBottomRightRadius,a.width,a.height),m=c[0],h=c[1],f=Fm(r.borderBottomLeftRadius,a.width,a.height),x=f[0],g=f[1],b=[];b.push((i+u)/a.width),b.push((x+m)/a.width),b.push((l+g)/a.height),b.push((d+h)/a.height);var y=Math.max.apply(Math,b);y>1&&(i/=y,l/=y,u/=y,d/=y,m/=y,h/=y,x/=y,g/=y);var N=a.width-u,j=a.height-h,S=a.width-m,k=a.height-g,P=r.borderTopWidth,I=r.borderRightWidth,B=r.borderBottomWidth,q=r.borderLeftWidth,Q=aa(r.paddingTop,s.bounds.width),O=aa(r.paddingRight,s.bounds.width),T=aa(r.paddingBottom,s.bounds.width),V=aa(r.paddingLeft,s.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||l>0?va(a.left+q/3,a.top+P/3,i-q/3,l-P/3,Or.TOP_LEFT):new Ss(a.left+q/3,a.top+P/3),this.topRightBorderDoubleOuterBox=i>0||l>0?va(a.left+N,a.top+P/3,u-I/3,d-P/3,Or.TOP_RIGHT):new Ss(a.left+a.width-I/3,a.top+P/3),this.bottomRightBorderDoubleOuterBox=m>0||h>0?va(a.left+S,a.top+j,m-I/3,h-B/3,Or.BOTTOM_RIGHT):new Ss(a.left+a.width-I/3,a.top+a.height-B/3),this.bottomLeftBorderDoubleOuterBox=x>0||g>0?va(a.left+q/3,a.top+k,x-q/3,g-B/3,Or.BOTTOM_LEFT):new Ss(a.left+q/3,a.top+a.height-B/3),this.topLeftBorderDoubleInnerBox=i>0||l>0?va(a.left+q*2/3,a.top+P*2/3,i-q*2/3,l-P*2/3,Or.TOP_LEFT):new Ss(a.left+q*2/3,a.top+P*2/3),this.topRightBorderDoubleInnerBox=i>0||l>0?va(a.left+N,a.top+P*2/3,u-I*2/3,d-P*2/3,Or.TOP_RIGHT):new Ss(a.left+a.width-I*2/3,a.top+P*2/3),this.bottomRightBorderDoubleInnerBox=m>0||h>0?va(a.left+S,a.top+j,m-I*2/3,h-B*2/3,Or.BOTTOM_RIGHT):new Ss(a.left+a.width-I*2/3,a.top+a.height-B*2/3),this.bottomLeftBorderDoubleInnerBox=x>0||g>0?va(a.left+q*2/3,a.top+k,x-q*2/3,g-B*2/3,Or.BOTTOM_LEFT):new Ss(a.left+q*2/3,a.top+a.height-B*2/3),this.topLeftBorderStroke=i>0||l>0?va(a.left+q/2,a.top+P/2,i-q/2,l-P/2,Or.TOP_LEFT):new Ss(a.left+q/2,a.top+P/2),this.topRightBorderStroke=i>0||l>0?va(a.left+N,a.top+P/2,u-I/2,d-P/2,Or.TOP_RIGHT):new Ss(a.left+a.width-I/2,a.top+P/2),this.bottomRightBorderStroke=m>0||h>0?va(a.left+S,a.top+j,m-I/2,h-B/2,Or.BOTTOM_RIGHT):new Ss(a.left+a.width-I/2,a.top+a.height-B/2),this.bottomLeftBorderStroke=x>0||g>0?va(a.left+q/2,a.top+k,x-q/2,g-B/2,Or.BOTTOM_LEFT):new Ss(a.left+q/2,a.top+a.height-B/2),this.topLeftBorderBox=i>0||l>0?va(a.left,a.top,i,l,Or.TOP_LEFT):new Ss(a.left,a.top),this.topRightBorderBox=u>0||d>0?va(a.left+N,a.top,u,d,Or.TOP_RIGHT):new Ss(a.left+a.width,a.top),this.bottomRightBorderBox=m>0||h>0?va(a.left+S,a.top+j,m,h,Or.BOTTOM_RIGHT):new Ss(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=x>0||g>0?va(a.left,a.top+k,x,g,Or.BOTTOM_LEFT):new Ss(a.left,a.top+a.height),this.topLeftPaddingBox=i>0||l>0?va(a.left+q,a.top+P,Math.max(0,i-q),Math.max(0,l-P),Or.TOP_LEFT):new Ss(a.left+q,a.top+P),this.topRightPaddingBox=u>0||d>0?va(a.left+Math.min(N,a.width-I),a.top+P,N>a.width+I?0:Math.max(0,u-I),Math.max(0,d-P),Or.TOP_RIGHT):new Ss(a.left+a.width-I,a.top+P),this.bottomRightPaddingBox=m>0||h>0?va(a.left+Math.min(S,a.width-q),a.top+Math.min(j,a.height-B),Math.max(0,m-I),Math.max(0,h-B),Or.BOTTOM_RIGHT):new Ss(a.left+a.width-I,a.top+a.height-B),this.bottomLeftPaddingBox=x>0||g>0?va(a.left+q,a.top+Math.min(k,a.height-B),Math.max(0,x-q),Math.max(0,g-B),Or.BOTTOM_LEFT):new Ss(a.left+q,a.top+a.height-B),this.topLeftContentBox=i>0||l>0?va(a.left+q+V,a.top+P+Q,Math.max(0,i-(q+V)),Math.max(0,l-(P+Q)),Or.TOP_LEFT):new Ss(a.left+q+V,a.top+P+Q),this.topRightContentBox=u>0||d>0?va(a.left+Math.min(N,a.width+q+V),a.top+P+Q,N>a.width+q+V?0:u-q+V,d-(P+Q),Or.TOP_RIGHT):new Ss(a.left+a.width-(I+O),a.top+P+Q),this.bottomRightContentBox=m>0||h>0?va(a.left+Math.min(S,a.width-(q+V)),a.top+Math.min(j,a.height+P+Q),Math.max(0,m-(I+O)),h-(B+T),Or.BOTTOM_RIGHT):new Ss(a.left+a.width-(I+O),a.top+a.height-(B+T)),this.bottomLeftContentBox=x>0||g>0?va(a.left+q+V,a.top+k,Math.max(0,x-(q+V)),g-(B+T),Or.BOTTOM_LEFT):new Ss(a.left+q+V,a.top+a.height-(B+T))}return t})(),Or;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Or||(Or={}));var va=function(t,s,r,a,n){var i=4*((Math.sqrt(2)-1)/3),l=r*i,o=a*i,u=t+r,d=s+a;switch(n){case Or.TOP_LEFT:return new sx(new Ss(t,d),new Ss(t,d-o),new Ss(u-l,s),new Ss(u,s));case Or.TOP_RIGHT:return new sx(new Ss(t,s),new Ss(t+l,s),new Ss(u,d-o),new Ss(u,d));case Or.BOTTOM_RIGHT:return new sx(new Ss(u,s),new Ss(u,s+o),new Ss(t+l,d),new Ss(t,d));case Or.BOTTOM_LEFT:default:return new sx(new Ss(u,d),new Ss(u-l,d),new Ss(t,s+o),new Ss(t,s))}},r0=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},sO=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},a0=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},rO=(function(){function t(s,r,a){this.offsetX=s,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return t})(),rx=(function(){function t(s,r){this.path=s,this.target=r,this.type=1}return t})(),aO=(function(){function t(s){this.opacity=s,this.type=2,this.target=6}return t})(),nO=function(t){return t.type===0},u4=function(t){return t.type===1},iO=function(t){return t.type===2},B2=function(t,s){return t.length===s.length?t.some(function(r,a){return r===s[a]}):!1},lO=function(t,s,r,a,n){return t.map(function(i,l){switch(l){case 0:return i.add(s,r);case 1:return i.add(s+a,r);case 2:return i.add(s+a,r+n);case 3:return i.add(s,r+n)}return i})},A4=(function(){function t(s){this.element=s,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t})(),h4=(function(){function t(s,r){if(this.container=s,this.parent=r,this.effects=[],this.curves=new tO(this.container),this.container.styles.opacity<1&&this.effects.push(new aO(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new rO(a,n,i))}if(this.container.styles.overflowX!==0){var l=r0(this.curves),o=a0(this.curves);B2(l,o)?this.effects.push(new rx(l,6)):(this.effects.push(new rx(l,2)),this.effects.push(new rx(o,4)))}}return t.prototype.getEffects=function(s){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,n=this.effects.slice(0);a;){var i=a.effects.filter(function(u){return!u4(u)});if(r||a.container.styles.position!==0||!a.parent){if(n.unshift.apply(n,i),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var l=r0(a.curves),o=a0(a.curves);B2(l,o)||n.unshift(new rx(o,6))}}else n.unshift.apply(n,i);a=a.parent}return n.filter(function(u){return fn(u.target,s)})},t})(),py=function(t,s,r,a){t.container.elements.forEach(function(n){var i=fn(n.flags,4),l=fn(n.flags,2),o=new h4(n,t);fn(n.styles.display,2048)&&a.push(o);var u=fn(n.flags,8)?[]:a;if(i||l){var d=i||n.styles.isPositioned()?r:s,c=new A4(o);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var m=n.styles.zIndex.order;if(m<0){var h=0;d.negativeZIndex.some(function(x,g){return m>x.element.container.styles.zIndex.order?(h=g,!1):h>0}),d.negativeZIndex.splice(h,0,c)}else if(m>0){var f=0;d.positiveZIndex.some(function(x,g){return m>=x.element.container.styles.zIndex.order?(f=g+1,!1):f>0}),d.positiveZIndex.splice(f,0,c)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else n.styles.isFloating()?d.nonPositionedFloats.push(c):d.nonPositionedInlineLevel.push(c);py(o,c,i?c:r,u)}else n.styles.isInlineLevel()?s.inlineLevel.push(o):s.nonInlineLevel.push(o),py(o,s,r,u);fn(n.flags,8)&&m4(n,u)})},m4=function(t,s){for(var r=t instanceof uy?t.start:1,a=t instanceof uy?t.reversed:!1,n=0;n<s.length;n++){var i=s[n];i.container instanceof X5&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=Af(r,i.container.styles.listStyleType,!0),r+=a?-1:1}},oO=function(t){var s=new h4(t,null),r=new A4(s),a=[];return py(s,r,r,a),m4(s.container,a),r},k2=function(t,s){switch(s){case 0:return zl(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return zl(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return zl(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return zl(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},cO=function(t,s){switch(s){case 0:return zl(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return zl(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return zl(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return zl(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},dO=function(t,s){switch(s){case 0:return zl(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return zl(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return zl(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return zl(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},uO=function(t,s){switch(s){case 0:return ax(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return ax(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return ax(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return ax(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},ax=function(t,s){var r=[];return Wl(t)?r.push(t.subdivide(.5,!1)):r.push(t),Wl(s)?r.push(s.subdivide(.5,!0)):r.push(s),r},zl=function(t,s,r,a){var n=[];return Wl(t)?n.push(t.subdivide(.5,!1)):n.push(t),Wl(r)?n.push(r.subdivide(.5,!0)):n.push(r),Wl(a)?n.push(a.subdivide(.5,!0).reverse()):n.push(a),Wl(s)?n.push(s.subdivide(.5,!1).reverse()):n.push(s),n},f4=function(t){var s=t.bounds,r=t.styles;return s.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},n0=function(t){var s=t.styles,r=t.bounds,a=aa(s.paddingLeft,r.width),n=aa(s.paddingRight,r.width),i=aa(s.paddingTop,r.width),l=aa(s.paddingBottom,r.width);return r.add(a+s.borderLeftWidth,i+s.borderTopWidth,-(s.borderRightWidth+s.borderLeftWidth+a+n),-(s.borderTopWidth+s.borderBottomWidth+i+l))},AO=function(t,s){return t===0?s.bounds:t===2?n0(s):f4(s)},hO=function(t,s){return t===0?s.bounds:t===2?n0(s):f4(s)},Kv=function(t,s,r){var a=AO(mh(t.styles.backgroundOrigin,s),t),n=hO(mh(t.styles.backgroundClip,s),t),i=mO(mh(t.styles.backgroundSize,s),r,a),l=i[0],o=i[1],u=Fm(mh(t.styles.backgroundPosition,s),a.width-l,a.height-o),d=fO(mh(t.styles.backgroundRepeat,s),u,i,a,n),c=Math.round(a.left+u[0]),m=Math.round(a.top+u[1]);return[d,c,m,l,o]},nh=function(t){return Yr(t)&&t.value===wh.AUTO},nx=function(t){return typeof t=="number"},mO=function(t,s,r){var a=s[0],n=s[1],i=s[2],l=t[0],o=t[1];if(!l)return[0,0];if(ln(l)&&o&&ln(o))return[aa(l,r.width),aa(o,r.height)];var u=nx(i);if(Yr(l)&&(l.value===wh.CONTAIN||l.value===wh.COVER)){if(nx(i)){var d=r.width/r.height;return d<i!=(l.value===wh.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var c=nx(a),m=nx(n),h=c||m;if(nh(l)&&(!o||nh(o))){if(c&&m)return[a,n];if(!u&&!h)return[r.width,r.height];if(h&&u){var f=c?a:n*i,x=m?n:a/i;return[f,x]}var g=c?a:r.width,b=m?n:r.height;return[g,b]}if(u){var y=0,N=0;return ln(l)?y=aa(l,r.width):ln(o)&&(N=aa(o,r.height)),nh(l)?y=N*i:(!o||nh(o))&&(N=y/i),[y,N]}var j=null,S=null;if(ln(l)?j=aa(l,r.width):o&&ln(o)&&(S=aa(o,r.height)),j!==null&&(!o||nh(o))&&(S=c&&m?j/a*n:r.height),S!==null&&nh(l)&&(j=c&&m?S/n*a:r.width),j!==null&&S!==null)return[j,S];throw new Error("Unable to calculate background-size for element")},mh=function(t,s){var r=t[s];return typeof r>"u"?t[0]:r},fO=function(t,s,r,a,n){var i=s[0],l=s[1],o=r[0],u=r[1];switch(t){case 2:return[new Ss(Math.round(a.left),Math.round(a.top+l)),new Ss(Math.round(a.left+a.width),Math.round(a.top+l)),new Ss(Math.round(a.left+a.width),Math.round(u+a.top+l)),new Ss(Math.round(a.left),Math.round(u+a.top+l))];case 3:return[new Ss(Math.round(a.left+i),Math.round(a.top)),new Ss(Math.round(a.left+i+o),Math.round(a.top)),new Ss(Math.round(a.left+i+o),Math.round(a.height+a.top)),new Ss(Math.round(a.left+i),Math.round(a.height+a.top))];case 1:return[new Ss(Math.round(a.left+i),Math.round(a.top+l)),new Ss(Math.round(a.left+i+o),Math.round(a.top+l)),new Ss(Math.round(a.left+i+o),Math.round(a.top+l+u)),new Ss(Math.round(a.left+i),Math.round(a.top+l+u))];default:return[new Ss(Math.round(n.left),Math.round(n.top)),new Ss(Math.round(n.left+n.width),Math.round(n.top)),new Ss(Math.round(n.left+n.width),Math.round(n.height+n.top)),new Ss(Math.round(n.left),Math.round(n.height+n.top))]}},pO="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",E2="Hidden Text",xO=(function(){function t(s){this._data={},this._document=s}return t.prototype.parseMetrics=function(s,r){var a=this._document.createElement("div"),n=this._document.createElement("img"),i=this._document.createElement("span"),l=this._document.body;a.style.visibility="hidden",a.style.fontFamily=s,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",l.appendChild(a),n.src=pO,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",i.style.fontFamily=s,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(E2)),a.appendChild(i),a.appendChild(n);var o=n.offsetTop-i.offsetTop+2;a.removeChild(i),a.appendChild(this._document.createTextNode(E2)),a.style.lineHeight="normal",n.style.verticalAlign="super";var u=n.offsetTop-a.offsetTop+2;return l.removeChild(a),{baseline:o,middle:u}},t.prototype.getMetrics=function(s,r){var a=s+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(s,r)),this._data[a]},t})(),p4=(function(){function t(s,r){this.context=s,this.options=r}return t})(),gO=1e4,vO=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n._activeEffects=[],n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),a.canvas||(n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px"),n.fontMetrics=new xO(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),n}return s.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(n){return a.applyEffect(n)})},s.prototype.applyEffect=function(r){this.ctx.save(),iO(r)&&(this.ctx.globalAlpha=r.opacity),nO(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),u4(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},s.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},s.prototype.renderStack=function(r){return Ii(this,void 0,void 0,function(){var a;return di(this,function(n){switch(n.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},s.prototype.renderNode=function(r){return Ii(this,void 0,void 0,function(){return di(this,function(a){switch(a.label){case 0:if(fn(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},s.prototype.renderTextWithLetterSpacing=function(r,a,n){var i=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+n);else{var l=a1(r.text);l.reduce(function(o,u){return i.ctx.fillText(u,o,r.bounds.top+n),o+i.ctx.measureText(u).width},r.bounds.left)}},s.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(l){return l==="normal"||l==="small-caps"}).join(""),n=wO(r.fontFamily).join(", "),i=Pf(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,i,n].join(" "),n,i]},s.prototype.renderTextNode=function(r,a){return Ii(this,void 0,void 0,function(){var n,i,l,o,u,d,c,m,h=this;return di(this,function(f){return n=this.createFontStyle(a),i=n[0],l=n[1],o=n[2],this.ctx.font=i,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(l,o),d=u.baseline,c=u.middle,m=a.paintOrder,r.textBounds.forEach(function(x){m.forEach(function(g){switch(g){case 0:h.ctx.fillStyle=Sn(a.color),h.renderTextWithLetterSpacing(x,a.letterSpacing,d);var b=a.textShadow;b.length&&x.text.trim().length&&(b.slice(0).reverse().forEach(function(y){h.ctx.shadowColor=Sn(y.color),h.ctx.shadowOffsetX=y.offsetX.number*h.options.scale,h.ctx.shadowOffsetY=y.offsetY.number*h.options.scale,h.ctx.shadowBlur=y.blur.number,h.renderTextWithLetterSpacing(x,a.letterSpacing,d)}),h.ctx.shadowColor="",h.ctx.shadowOffsetX=0,h.ctx.shadowOffsetY=0,h.ctx.shadowBlur=0),a.textDecorationLine.length&&(h.ctx.fillStyle=Sn(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(y){switch(y){case 1:h.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top+d),x.bounds.width,1);break;case 2:h.ctx.fillRect(x.bounds.left,Math.round(x.bounds.top),x.bounds.width,1);break;case 3:h.ctx.fillRect(x.bounds.left,Math.ceil(x.bounds.top+c),x.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&x.text.trim().length&&(h.ctx.strokeStyle=Sn(a.webkitTextStrokeColor),h.ctx.lineWidth=a.webkitTextStrokeWidth,h.ctx.lineJoin=window.chrome?"miter":"round",h.ctx.strokeText(x.text,x.bounds.left,x.bounds.top+d)),h.ctx.strokeStyle="",h.ctx.lineWidth=0,h.ctx.lineJoin="miter";break}})}),[2]})})},s.prototype.renderReplacedElement=function(r,a,n){if(n&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=n0(r),l=a0(a);this.path(l),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},s.prototype.renderNodeContent=function(r){return Ii(this,void 0,void 0,function(){var a,n,i,l,o,u,N,N,d,c,m,h,S,f,x,k,g,b,y,N,j,S,k;return di(this,function(P){switch(P.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,n=r.curves,i=a.styles,l=0,o=a.textNodes,P.label=1;case 1:return l<o.length?(u=o[l],[4,this.renderTextNode(u,i)]):[3,4];case 2:P.sent(),P.label=3;case 3:return l++,[3,1];case 4:if(!(a instanceof K5))return[3,8];P.label=5;case 5:return P.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return N=P.sent(),this.renderReplacedElement(a,n,N),[3,8];case 7:return P.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof z5&&this.renderReplacedElement(a,n,a.canvas),!(a instanceof Y5))return[3,12];P.label=9;case 9:return P.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return N=P.sent(),this.renderReplacedElement(a,n,N),[3,12];case 11:return P.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof e4&&a.tree?(d=new s(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,d.render(a.tree)]):[3,14];case 13:c=P.sent(),a.width&&a.height&&this.ctx.drawImage(c,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),P.label=14;case 14:if(a instanceof n1&&(m=Math.min(a.bounds.width,a.bounds.height),a.type===Zx?a.checked&&(this.ctx.save(),this.path([new Ss(a.bounds.left+m*.39363,a.bounds.top+m*.79),new Ss(a.bounds.left+m*.16,a.bounds.top+m*.5549),new Ss(a.bounds.left+m*.27347,a.bounds.top+m*.44071),new Ss(a.bounds.left+m*.39694,a.bounds.top+m*.5649),new Ss(a.bounds.left+m*.72983,a.bounds.top+m*.23),new Ss(a.bounds.left+m*.84,a.bounds.top+m*.34085),new Ss(a.bounds.left+m*.39363,a.bounds.top+m*.79)]),this.ctx.fillStyle=Sn(x2),this.ctx.fill(),this.ctx.restore()):a.type===e0&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+m/2,a.bounds.top+m/2,m/4,0,Math.PI*2,!0),this.ctx.fillStyle=Sn(x2),this.ctx.fill(),this.ctx.restore())),bO(a)&&a.value.length){switch(h=this.createFontStyle(i),S=h[0],f=h[1],x=this.fontMetrics.getMetrics(S,f).baseline,this.ctx.font=S,this.ctx.fillStyle=Sn(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=jO(a.styles.textAlign),k=n0(a),g=0,a.styles.textAlign){case 1:g+=k.width/2;break;case 2:g+=k.width;break}b=k.add(g,0,0,-k.height/2+1),this.ctx.save(),this.path([new Ss(k.left,k.top),new Ss(k.left+k.width,k.top),new Ss(k.left+k.width,k.top+k.height),new Ss(k.left,k.top+k.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new $m(a.value,b),i.letterSpacing,x),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!fn(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(y=a.styles.listStyleImage,y.type!==0)return[3,18];N=void 0,j=y.url,P.label=15;case 15:return P.trys.push([15,17,,18]),[4,this.context.cache.match(j)];case 16:return N=P.sent(),this.ctx.drawImage(N,a.bounds.left-(N.width+10),a.bounds.top),[3,18];case 17:return P.sent(),this.context.logger.error("Error loading list-style-image "+j),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(S=this.createFontStyle(i)[0],this.ctx.font=S,this.ctx.fillStyle=Sn(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",k=new td(a.bounds.left,a.bounds.top+aa(a.styles.paddingTop,a.bounds.width),a.bounds.width,e2(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new $m(r.listValue,k),i.letterSpacing,e2(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),P.label=20;case 20:return[2]}})})},s.prototype.renderStackContent=function(r){return Ii(this,void 0,void 0,function(){var a,n,y,i,l,y,o,u,y,d,c,y,m,h,y,f,x,y,g,b,y;return di(this,function(N){switch(N.label){case 0:if(fn(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:N.sent(),a=0,n=r.negativeZIndex,N.label=2;case 2:return a<n.length?(y=n[a],[4,this.renderStack(y)]):[3,5];case 3:N.sent(),N.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:N.sent(),i=0,l=r.nonInlineLevel,N.label=7;case 7:return i<l.length?(y=l[i],[4,this.renderNode(y)]):[3,10];case 8:N.sent(),N.label=9;case 9:return i++,[3,7];case 10:o=0,u=r.nonPositionedFloats,N.label=11;case 11:return o<u.length?(y=u[o],[4,this.renderStack(y)]):[3,14];case 12:N.sent(),N.label=13;case 13:return o++,[3,11];case 14:d=0,c=r.nonPositionedInlineLevel,N.label=15;case 15:return d<c.length?(y=c[d],[4,this.renderStack(y)]):[3,18];case 16:N.sent(),N.label=17;case 17:return d++,[3,15];case 18:m=0,h=r.inlineLevel,N.label=19;case 19:return m<h.length?(y=h[m],[4,this.renderNode(y)]):[3,22];case 20:N.sent(),N.label=21;case 21:return m++,[3,19];case 22:f=0,x=r.zeroOrAutoZIndexOrTransformedOrOpacity,N.label=23;case 23:return f<x.length?(y=x[f],[4,this.renderStack(y)]):[3,26];case 24:N.sent(),N.label=25;case 25:return f++,[3,23];case 26:g=0,b=r.positiveZIndex,N.label=27;case 27:return g<b.length?(y=b[g],[4,this.renderStack(y)]):[3,30];case 28:N.sent(),N.label=29;case 29:return g++,[3,27];case 30:return[2]}})})},s.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},s.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},s.prototype.formatPath=function(r){var a=this;r.forEach(function(n,i){var l=Wl(n)?n.start:n;i===0?a.ctx.moveTo(l.x,l.y):a.ctx.lineTo(l.x,l.y),Wl(n)&&a.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},s.prototype.renderRepeat=function(r,a,n,i){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(n,i),this.ctx.fill(),this.ctx.translate(-n,-i)},s.prototype.resizeImage=function(r,a,n){var i;if(r.width===a&&r.height===n)return r;var l=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,o=l.createElement("canvas");o.width=Math.max(1,a),o.height=Math.max(1,n);var u=o.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,a,n),o},s.prototype.renderBackgroundImage=function(r){return Ii(this,void 0,void 0,function(){var a,n,i,l,o,u;return di(this,function(d){switch(d.label){case 0:a=r.styles.backgroundImage.length-1,n=function(c){var m,h,f,Q,M,X,V,D,B,x,Q,M,X,V,D,g,b,y,N,j,S,k,P,I,B,q,Q,O,T,V,D,Y,M,X,R,H,W,K,_,F,E,L;return di(this,function(U){switch(U.label){case 0:if(c.type!==0)return[3,5];m=void 0,h=c.url,U.label=1;case 1:return U.trys.push([1,3,,4]),[4,i.context.cache.match(h)];case 2:return m=U.sent(),[3,4];case 3:return U.sent(),i.context.logger.error("Error loading background-image "+h),[3,4];case 4:return m&&(f=Kv(r,a,[m.width,m.height,m.width/m.height]),Q=f[0],M=f[1],X=f[2],V=f[3],D=f[4],B=i.ctx.createPattern(i.resizeImage(m,V,D),"repeat"),i.renderRepeat(Q,B,M,X)),[3,6];case 5:nU(c)?(x=Kv(r,a,[null,null,null]),Q=x[0],M=x[1],X=x[2],V=x[3],D=x[4],g=eU(c.angle,V,D),b=g[0],y=g[1],N=g[2],j=g[3],S=g[4],k=document.createElement("canvas"),k.width=V,k.height=D,P=k.getContext("2d"),I=P.createLinearGradient(y,j,N,S),Jw(c.stops,b).forEach(function(J){return I.addColorStop(J.stop,Sn(J.color))}),P.fillStyle=I,P.fillRect(0,0,V,D),V>0&&D>0&&(B=i.ctx.createPattern(k,"repeat"),i.renderRepeat(Q,B,M,X))):iU(c)&&(q=Kv(r,a,[null,null,null]),Q=q[0],O=q[1],T=q[2],V=q[3],D=q[4],Y=c.position.length===0?[t1]:c.position,M=aa(Y[0],V),X=aa(Y[Y.length-1],D),R=tU(c,M,X,V,D),H=R[0],W=R[1],H>0&&W>0&&(K=i.ctx.createRadialGradient(O+M,T+X,0,O+M,T+X,H),Jw(c.stops,H*2).forEach(function(J){return K.addColorStop(J.stop,Sn(J.color))}),i.path(Q),i.ctx.fillStyle=K,H!==W?(_=r.bounds.left+.5*r.bounds.width,F=r.bounds.top+.5*r.bounds.height,E=W/H,L=1/E,i.ctx.save(),i.ctx.translate(_,F),i.ctx.transform(1,0,0,E,0,0),i.ctx.translate(-_,-F),i.ctx.fillRect(O,L*(T-F)+F,V,D*L),i.ctx.restore()):i.ctx.fill())),U.label=6;case 6:return a--,[2]}})},i=this,l=0,o=r.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return l<o.length?(u=o[l],[5,n(u)]):[3,4];case 2:d.sent(),d.label=3;case 3:return l++,[3,1];case 4:return[2]}})})},s.prototype.renderSolidBorder=function(r,a,n){return Ii(this,void 0,void 0,function(){return di(this,function(i){return this.path(k2(n,a)),this.ctx.fillStyle=Sn(r),this.ctx.fill(),[2]})})},s.prototype.renderDoubleBorder=function(r,a,n,i){return Ii(this,void 0,void 0,function(){var l,o;return di(this,function(u){switch(u.label){case 0:return a<3?[4,this.renderSolidBorder(r,n,i)]:[3,2];case 1:return u.sent(),[2];case 2:return l=cO(i,n),this.path(l),this.ctx.fillStyle=Sn(r),this.ctx.fill(),o=dO(i,n),this.path(o),this.ctx.fill(),[2]}})})},s.prototype.renderNodeBackgroundAndBorders=function(r){return Ii(this,void 0,void 0,function(){var a,n,i,l,o,u,d,c,m=this;return di(this,function(h){switch(h.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,n=!ou(a.backgroundColor)||a.backgroundImage.length,i=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],l=yO(mh(a.backgroundClip,0),r.curves),n||a.boxShadow.length?(this.ctx.save(),this.path(l),this.ctx.clip(),ou(a.backgroundColor)||(this.ctx.fillStyle=Sn(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(f){m.ctx.save();var x=r0(r.curves),g=f.inset?0:gO,b=lO(x,-g+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(m.path(x),m.ctx.clip(),m.mask(b)):(m.mask(x),m.ctx.clip(),m.path(b)),m.ctx.shadowOffsetX=f.offsetX.number+g,m.ctx.shadowOffsetY=f.offsetY.number,m.ctx.shadowColor=Sn(f.color),m.ctx.shadowBlur=f.blur.number,m.ctx.fillStyle=f.inset?Sn(f.color):"rgba(0,0,0,1)",m.ctx.fill(),m.ctx.restore()}),h.label=2;case 2:o=0,u=0,d=i,h.label=3;case 3:return u<d.length?(c=d[u],c.style!==0&&!ou(c.color)&&c.width>0?c.style!==2?[3,5]:[4,this.renderDashedDottedBorder(c.color,c.width,o,r.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return c.style!==3?[3,7]:[4,this.renderDashedDottedBorder(c.color,c.width,o,r.curves,3)];case 6:return h.sent(),[3,11];case 7:return c.style!==4?[3,9]:[4,this.renderDoubleBorder(c.color,c.width,o,r.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(c.color,o,r.curves)];case 10:h.sent(),h.label=11;case 11:o++,h.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},s.prototype.renderDashedDottedBorder=function(r,a,n,i,l){return Ii(this,void 0,void 0,function(){var o,u,d,c,m,h,f,x,g,b,y,N,j,S,k,P,k,P;return di(this,function(I){return this.ctx.save(),o=uO(i,n),u=k2(i,n),l===2&&(this.path(u),this.ctx.clip()),Wl(u[0])?(d=u[0].start.x,c=u[0].start.y):(d=u[0].x,c=u[0].y),Wl(u[1])?(m=u[1].end.x,h=u[1].end.y):(m=u[1].x,h=u[1].y),n===0||n===2?f=Math.abs(d-m):f=Math.abs(c-h),this.ctx.beginPath(),l===3?this.formatPath(o):this.formatPath(u.slice(0,2)),x=a<3?a*3:a*2,g=a<3?a*2:a,l===3&&(x=a,g=a),b=!0,f<=x*2?b=!1:f<=x*2+g?(y=f/(2*x+g),x*=y,g*=y):(N=Math.floor((f+g)/(x+g)),j=(f-N*x)/(N-1),S=(f-(N+1)*x)/N,g=S<=0||Math.abs(g-j)<Math.abs(g-S)?j:S),b&&(l===3?this.ctx.setLineDash([0,x+g]):this.ctx.setLineDash([x,g])),l===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=Sn(r),this.ctx.stroke(),this.ctx.setLineDash([]),l===2&&(Wl(u[0])&&(k=u[3],P=u[0],this.ctx.beginPath(),this.formatPath([new Ss(k.end.x,k.end.y),new Ss(P.start.x,P.start.y)]),this.ctx.stroke()),Wl(u[1])&&(k=u[1],P=u[2],this.ctx.beginPath(),this.formatPath([new Ss(k.end.x,k.end.y),new Ss(P.start.x,P.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},s.prototype.render=function(r){return Ii(this,void 0,void 0,function(){var a;return di(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=Sn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=oO(r),[4,this.renderStack(a)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})},s})(p4),bO=function(t){return t instanceof Z5||t instanceof J5?!0:t instanceof n1&&t.type!==e0&&t.type!==Zx},yO=function(t,s){switch(t){case 0:return r0(s);case 2:return sO(s);case 1:default:return a0(s)}},jO=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},NO=["-apple-system","system-ui"],wO=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(s){return NO.indexOf(s)===-1}):t},_O=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=a,n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),n}return s.prototype.render=function(r){return Ii(this,void 0,void 0,function(){var a,n;return di(this,function(i){switch(i.label){case 0:return a=dy(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,SO(a)];case 1:return n=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=Sn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},s})(p4),SO=function(t){return new Promise(function(s,r){var a=new Image;a.onload=function(){s(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},CO=(function(){function t(s){var r=s.id,a=s.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return t.prototype.debug=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Up([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Up([this.id,this.getTime()+"ms"],s))},t.prototype.warn=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Up([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.prototype.error=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Up([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.instances={},t})(),BO=(function(){function t(s,r){var a;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new CO({id:this.instanceName,enabled:s.logging}),this.cache=(a=s.cache)!==null&&a!==void 0?a:new K8(this,s)}return t.instanceCount=1,t})(),Wn=function(t,s){return s===void 0&&(s={}),kO(t,s)};typeof window<"u"&&d4.setContext(window);var kO=function(t,s){return Ii(void 0,void 0,void 0,function(){var r,a,n,i,l,o,u,d,c,m,h,f,x,g,b,y,N,j,S,k,I,P,I,B,q,Q,O,T,V,D,Y,M,X,R,H,W,K,_,F,E;return di(this,function(L){switch(L.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return n={allowTaint:(B=s.allowTaint)!==null&&B!==void 0?B:!1,imageTimeout:(q=s.imageTimeout)!==null&&q!==void 0?q:15e3,proxy:s.proxy,useCORS:(Q=s.useCORS)!==null&&Q!==void 0?Q:!1},i=zb({logging:(O=s.logging)!==null&&O!==void 0?O:!0,cache:s.cache},n),l={windowWidth:(T=s.windowWidth)!==null&&T!==void 0?T:a.innerWidth,windowHeight:(V=s.windowHeight)!==null&&V!==void 0?V:a.innerHeight,scrollX:(D=s.scrollX)!==null&&D!==void 0?D:a.pageXOffset,scrollY:(Y=s.scrollY)!==null&&Y!==void 0?Y:a.pageYOffset},o=new td(l.scrollX,l.scrollY,l.windowWidth,l.windowHeight),u=new BO(i,o),d=(M=s.foreignObjectRendering)!==null&&M!==void 0?M:!1,c={allowTaint:(X=s.allowTaint)!==null&&X!==void 0?X:!1,onclone:s.onclone,ignoreElements:s.ignoreElements,inlineImages:d,copyStyles:d},u.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),m=new S2(u,t,c),h=m.clonedReferenceElement,h?[4,m.toIFrame(r,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=L.sent(),x=i1(h)||F8(h)?lD(h.ownerDocument):W0(u,h),g=x.width,b=x.height,y=x.left,N=x.top,j=EO(u,h,s.backgroundColor),S={canvas:s.canvas,backgroundColor:j,scale:(H=(R=s.scale)!==null&&R!==void 0?R:a.devicePixelRatio)!==null&&H!==void 0?H:1,x:((W=s.x)!==null&&W!==void 0?W:0)+y,y:((K=s.y)!==null&&K!==void 0?K:0)+N,width:(_=s.width)!==null&&_!==void 0?_:Math.ceil(g),height:(F=s.height)!==null&&F!==void 0?F:Math.ceil(b)},d?(u.logger.debug("Document cloned, using foreign object rendering"),I=new _O(u,S),[4,I.render(h)]):[3,3];case 2:return k=L.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+y+","+N+" with size "+g+"x"+b+" using computed rendering"),u.logger.debug("Starting DOM parsing"),P=s4(u,h),j===P.styles.backgroundColor&&(P.styles.backgroundColor=Yc.TRANSPARENT),u.logger.debug("Starting renderer for element at "+S.x+","+S.y+" with size "+S.width+"x"+S.height),I=new vO(u,S),[4,I.render(P)];case 4:k=L.sent(),L.label=5;case 5:return(!((E=s.removeContainer)!==null&&E!==void 0)||E)&&(S2.destroy(f)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,k]}})})},EO=function(t,s,r){var a=s.ownerDocument,n=a.documentElement?qm(t,getComputedStyle(a.documentElement).backgroundColor):Yc.TRANSPARENT,i=a.body?qm(t,getComputedStyle(a.body).backgroundColor):Yc.TRANSPARENT,l=typeof r=="string"?qm(t,r):r===null?Yc.TRANSPARENT:4294967295;return s===a.documentElement?ou(n)?ou(i)?l:i:n:l};const FO=Object.freeze(Object.defineProperty({__proto__:null,default:Wn},Symbol.toStringTag,{value:"Module"}));function x4(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Qc(t,s){const r=String(s||"").trim().replace(/^\./,"");if(!r)return;const a=r.split(".").filter(Boolean);let n=t;for(const i of a){if(n==null)return;n=n[i]}return n}function g4(t,s,r=s){let a=String(t??"");return a=a.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(n,i,l)=>{const o=String(i||"").trim(),u=o.startsWith("@root.")?Qc(r,o.slice(6)):Qc(s,o)??Qc(r,o);return(Array.isArray(u)?u:[]).map(c=>g4(l,c??{},r)).join("")}),a=a.replace(/{{{\s*([^}]+?)\s*}}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Qc(r,l.slice(6)):o=Qc(s,l)??Qc(r,l),String(o??"")}),a=a.replace(/{{\s*([^}]+?)\s*}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Qc(r,l.slice(6)):o=Qc(s,l)??Qc(r,l),x4(o)}),a}function TO(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Document Template Preview</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}const IO=[{value:"RECEIPT",label:"Receipt"},{value:"RECEIPT_VOUCHER",label:"Receipt Voucher"},{value:"PAYMENT_VOUCHER",label:"Payment Voucher"},{value:"INVOICE",label:"Invoice"},{value:"PAYSLIP",label:"Payslip"},{value:"DELIVERY_NOTE",label:"Delivery Note"},{value:"SALES_ORDER",label:"Sales Order"}];function LO(){const[t,s]=v.useState("RECEIPT"),[r,a]=v.useState(!1),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState({name:"",address:"",city:"",state:"",postalCode:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[h,f]=v.useState(null),[x,g]=v.useState(["companyHeader","documentHeader","customerBlock","itemsTable","totalsBlock","footer"]);v.useEffect(()=>{let q=!0;async function Q(){var O,T,V;try{const Y=(T=(O=(await te.get("/admin/me")).data)==null?void 0:O.scope)==null?void 0:T.companyId;if(!Y)return;const X=((V=(await te.get(`/admin/companies/${Y}`)).data)==null?void 0:V.item)||{},R=X.has_logo===1||X.has_logo===!0?`/api/admin/companies/${Y}/logo`:"";if(!q)return;m({name:X.name||"",address:X.address||"",city:X.city||"",state:X.state||"",postalCode:X.postal_code||"",country:X.country||"",phone:X.telephone||"",email:X.email||"",website:X.website||"",taxId:X.tax_id||"",registrationNo:X.registration_no||"",logoUrl:R})}catch{}}return Q(),()=>{q=!1}},[]),v.useEffect(()=>{let q=!0;async function Q(){var O;try{const V=((O=(await te.get("/pos/receipt-settings")).data)==null?void 0:O.item)||null;if(!q)return;if(!V){f({});return}f({showLogo:V.show_logo===1||V.show_logo===!0||String(V.show_logo).toLowerCase()==="true",headerText:V.header_text||"",footerText:V.footer_text||"",contactNumber:V.contact_number||"",addressLine1:V.address_line1||"",addressLine2:V.address_line2||"",logoUrl:V.logo_url||""})}catch{if(!q)return;f({})}}return Q(),()=>{q=!1}},[]),v.useEffect(()=>{g(["companyHeader","documentHeader","customerBlock","itemsTable","totalsBlock","footer"])},[t]);const b=v.useMemo(()=>t==="RECEIPT_VOUCHER"?{companyHeader:`<div style="text-align:center;">
  <div>{{{company.logoHtml}}}</div>
  <div style="font-weight:700;font-size:18px;">{{company.name}}</div>
  <div style="font-size:12px;color:#475569;">{{company.addressLine1}}</div>
  <div style="font-size:12px;color:#475569;">{{company.addressLine2}}</div>
  <div style="font-size:12px;color:#475569;">Mobile: {{company.phone}}</div>
  <div style="font-size:12px;color:#475569;">{{company.website}}</div>
  <div style="font-size:12px;color:#475569;">TIN: {{company.taxId}} &nbsp; Reg: {{company.registrationNo}}</div>
</div>`,documentHeader:`<div style="text-align:center;margin-top:6px;font-size:14px;font-weight:800;">RECEIPT VOUCHER</div>
<div style="text-align:center;margin-top:6px;font-size:12px;color:#475569;">{{receipt.headerText}}</div>`,customerBlock:"",itemsTable:`<table style="font-size:12px;margin-top:10px;">
  <thead>
    <tr><th>Description</th><th style="text-align:right;">Amount</th></tr>
  </thead>
  <tbody>
    {{#each items}}
      <tr>
        <td>{{name}}</td>
        <td style="text-align:right;">{{lineTotal}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>`,totalsBlock:`<div style="margin-top:10px;border-top:1px solid #0f172a;padding-top:6px;">
  <div style="display:flex;justify-content:space-between;font-size:13px;"><span>Subtotal</span><span>{{totals.subtotal}}</span></div>
  <div style="display:flex;justify-content:space-between;font-size:13px;"><span>Tax</span><span>{{totals.tax}}</span></div>
  <div style="display:flex;justify-content:space-between;font-size:13px;font-weight:700;"><span>Grand Total</span><span>{{totals.total}}</span></div>
</div>`,footer:'<div style="margin-top:10px;text-align:center;font-size:11px;color:#475569;">{{receipt.footerText}}</div>'}:t==="PAYMENT_VOUCHER"?{companyHeader:`<div style="text-align:center;">
  <div>{{{company.logoHtml}}}</div>
  <div style="font-weight:700;font-size:18px;">{{company.name}}</div>
  <div style="font-size:12px;color:#475569;">{{company.addressLine1}}</div>
  <div style="font-size:12px;color:#475569;">{{company.addressLine2}}</div>
  <div style="font-size:12px;color:#475569;">Mobile: {{company.phone}}</div>
  <div style="font-size:12px;color:#475569;">{{company.website}}</div>
  <div style="font-size:12px;color:#475569;">TIN: {{company.taxId}} &nbsp; Reg: {{company.registrationNo}}</div>
</div>`,documentHeader:`<div style="text-align:center;margin-top:6px;font-size:14px;font-weight:800;">PAYMENT VOUCHER</div>
<div style="text-align:center;margin-top:6px;font-size:12px;color:#475569;">{{payment.headerText}}</div>`,customerBlock:"",itemsTable:`<table style="font-size:12px;margin-top:10px;">
  <thead>
    <tr><th>Description</th><th style="text-align:right;">Amount</th></tr>
  </thead>
  <tbody>
    {{#each items}}
      <tr>
        <td>{{name}}</td>
        <td style="text-align:right;">{{lineTotal}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>`,totalsBlock:`<div style="margin-top:10px;border-top:1px solid #0f172a;padding-top:6px;">
  <div style="display:flex;justify-content:space-between;font-size:13px;"><span>Subtotal</span><span>{{totals.subtotal}}</span></div>
  <div style="display:flex;justify-content:space-between;font-size:13px;"><span>Tax</span><span>{{totals.tax}}</span></div>
  <div style="display:flex;justify-content:space-between;font-size:13px;font-weight:700;"><span>Grand Total</span><span>{{totals.total}}</span></div>
</div>`,footer:'<div style="margin-top:10px;text-align:center;font-size:11px;color:#475569;">{{payment.footerText}}</div>'}:t==="RECEIPT"?{companyHeader:`<div style="text-align:center;">
  <div>{{{company.logoHtml}}}</div>
  <div style="font-weight:700;font-size:18px;">{{company.name}}</div>
  <div style="font-size:12px;color:#475569;">{{company.addressLine1}}</div>
  <div style="font-size:12px;color:#475569;">{{company.addressLine2}}</div>
  <div style="font-size:12px;color:#475569;">Mobile: {{company.phone}}</div>
  <div style="font-size:12px;color:#475569;">{{company.website}}</div>
  <div style="font-size:12px;color:#475569;">TIN: {{company.taxId}} &nbsp; Reg: {{company.registrationNo}}</div>
</div>`,documentHeader:'<div style="text-align:center;margin-top:6px;font-size:12px;color:#475569;">{{receipt.headerText}}</div>',customerBlock:"",itemsTable:`<table style="font-size:12px;margin-top:10px;">
  <thead>
    <tr><th>Item</th><th style="text-align:right;">Qty</th><th style="text-align:right;">Price</th><th style="text-align:right;">Disc</th><th style="text-align:right;">Total</th></tr>
  </thead>
  <tbody>
    {{#each items}}
      <tr>
        <td>{{name}}</td>
        <td style="text-align:right;">{{qty}}</td>
        <td style="text-align:right;">{{price}}</td>
        <td style="text-align:right;">{{discount}}</td>
        <td style="text-align:right;">{{lineTotal}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>`,totalsBlock:`<div style="margin-top:10px;border-top:1px solid #0f172a;padding-top:6px;">
  <div style="display:flex;justify-content:space-between;font-size:13px;"><span>Subtotal</span><span>{{totals.subtotal}}</span></div>
  <div style="display:flex;justify-content:space-between;font-size:13px;"><span>Tax</span><span>{{totals.tax}}</span></div>
  <div style="display:flex;justify-content:space-between;font-size:13px;font-weight:700;"><span>Grand Total</span><span>{{totals.total}}</span></div>
</div>`,footer:'<div style="margin-top:10px;text-align:center;font-size:11px;color:#475569;">{{receipt.footerText}}</div>'}:t==="INVOICE"?{companyHeader:`<div>
  <div>{{{company.logoHtml}}}</div>
  <div style="font-weight:700;font-size:18px;">{{company.name}}</div>
  <div style="font-size:12px;color:#475569;">{{company.address}}</div>
  <div style="font-size:12px;color:#475569;">{{company.city}} {{company.state}} {{company.country}}</div>
  <div style="font-size:12px;color:#475569;">{{company.phone}} {{company.email}}</div>
  <div style="font-size:12px;color:#475569;">{{company.website}}</div>
  <div style="font-size:12px;color:#475569;">TIN: {{company.taxId}} &nbsp; Reg: {{company.registrationNo}}</div>
</div>`,documentHeader:`<div style="text-align:right;">
  <div style="font-weight:800;font-size:20px;">INVOICE</div>
  <div style="font-size:12px;">Invoice #: {{invoice.invoice_no}}</div>
  <div style="font-size:12px;">Date: {{invoice.invoice_date}}</div>
</div>`,customerBlock:`<div style="font-size:12px;margin-bottom:8px;">
  <div><strong>Customer:</strong> {{customer.name}} {{customer.code}}</div>
  <div>{{customer.address}}</div>
  <div>{{customer.city}} {{customer.state}} {{customer.country}}</div>
  <div>{{customer.phone}} {{customer.mobile}} {{customer.email}}</div>
  <div>{{customer.contactPerson}}</div>
</div>`,itemsTable:`<table style="font-size:12px;">
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align:right;">Qty</th>
      <th style="text-align:right;">Unit Price</th>
      <th style="text-align:right;">Total</th>
    </tr>
  </thead>
  <tbody>
    {{#each items}}
      <tr>
        <td>{{item_name}}</td>
        <td style="text-align:right;">{{qty}}</td>
        <td style="text-align:right;">{{unit_price}}</td>
        <td style="text-align:right;">{{total}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>`,totalsBlock:`<div style="margin-top:12px;display:flex;justify-content:flex-end;">
  <table style="width:320px;font-size:12px;">
    <tbody>
      <tr><td>Subtotal</td><td style="text-align:right;">{{totals.subtotal}}</td></tr>
      <tr><td>Discount</td><td style="text-align:right;">{{totals.discount}}</td></tr>
      <tr><td><strong>Total</strong></td><td style="text-align:right;"><strong>{{totals.total}}</strong></td></tr>
    </tbody>
  </table>
</div>`,footer:""}:t==="DELIVERY_NOTE"?{companyHeader:`<div>
  <div>{{{company.logoHtml}}}</div>
  <div style="font-weight:700;font-size:18px;">{{company.name}}</div>
  <div style="font-size:12px;color:#475569;">{{company.address}}</div>
  <div style="font-size:12px;color:#475569;">{{company.city}} {{company.state}} {{company.country}}</div>
  <div style="font-size:12px;color:#475569;">{{company.phone}} {{company.email}}</div>
  <div style="font-size:12px;color:#475569;">{{company.website}}</div>
  <div style="font-size:12px;color:#475569;">TIN: {{company.taxId}} &nbsp; Reg: {{company.registrationNo}}</div>
</div>`,documentHeader:`<div style="text-align:right;">
  <div style="font-weight:800;font-size:20px;">DELIVERY NOTE</div>
  <div style="font-size:12px;">Delivery #: {{delivery.delivery_no}}</div>
  <div style="font-size:12px;">Date: {{delivery.delivery_date}}</div>
</div>`,customerBlock:`<div style="font-size:12px;margin-bottom:8px;">
  <div><strong>Customer:</strong> {{customer.name}} {{customer.code}}</div>
  <div>{{customer.address}}</div>
  <div>{{customer.city}} {{customer.state}} {{customer.country}}</div>
  <div>{{customer.phone}} {{customer.mobile}} {{customer.email}}</div>
  <div>{{customer.contactPerson}}</div>
</div>`,itemsTable:`<table style="font-size:12px;">
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align:right;">Qty</th>
      <th style="text-align:right;">Unit Price</th>
      <th style="text-align:right;">Total</th>
    </tr>
  </thead>
  <tbody>
    {{#each items}}
      <tr>
        <td>{{item_name}}</td>
        <td style="text-align:right;">{{qty}}</td>
        <td style="text-align:right;">{{unit_price}}</td>
        <td style="text-align:right;">{{total}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>`,totalsBlock:`<div style="margin-top:12px;display:flex;justify-content:flex-end;">
  <table style="width:320px;font-size:12px;">
    <tbody>
      <tr><td><strong>Total</strong></td><td style="text-align:right;"><strong>{{totals.total}}</strong></td></tr>
    </tbody>
  </table>
</div>`,footer:""}:t==="SALES_ORDER"?{companyHeader:`<div>
  <div>{{{company.logoHtml}}}</div>
  <div style="font-weight:700;font-size:18px;">{{company.name}}</div>
  <div style="font-size:12px;color:#475569;">{{company.address}}</div>
  <div style="font-size:12px;color:#475569;">{{company.city}} {{company.state}} {{company.country}}</div>
  <div style="font-size:12px;color:#475569;">{{company.phone}} {{company.email}}</div>
  <div style="font-size:12px;color:#475569;">{{company.website}}</div>
  <div style="font-size:12px;color:#475569;">TIN: {{company.taxId}} &nbsp; Reg: {{company.registrationNo}}</div>
</div>`,documentHeader:`<div style="text-align:right;">
  <div style="font-weight:800;font-size:20px;">SALES ORDER</div>
  <div style="font-size:12px;">Order #: {{salesOrder.order_no}}</div>
  <div style="font-size:12px;">Date: {{salesOrder.order_date}}</div>
  <div style="font-size:12px;">Status: {{salesOrder.status}}</div>
</div>`,customerBlock:`<div style="font-size:12px;margin-bottom:8px;">
  <div><strong>Customer:</strong> {{customer.name}} {{customer.code}}</div>
  <div>{{customer.address}}</div>
  <div>{{customer.city}} {{customer.state}} {{customer.country}}</div>
  <div>{{customer.phone}} {{customer.mobile}} {{customer.email}}</div>
  <div>{{customer.contactPerson}}</div>
</div>`,itemsTable:`<table style="font-size:12px;">
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align:right;">Qty</th>
      <th style="text-align:right;">Unit Price</th>
      <th style="text-align:right;">Total</th>
    </tr>
  </thead>
  <tbody>
    {{#each items}}
      <tr>
        <td>{{item_name}}</td>
        <td style="text-align:right;">{{qty}}</td>
        <td style="text-align:right;">{{unit_price}}</td>
        <td style="text-align:right;">{{total}}</td>
      </tr>
    {{/each}}
  </tbody>
</table>`,totalsBlock:`<div style="margin-top:12px;display:flex;justify-content:flex-end;">
  <table style="width:320px;font-size:12px;">
    <tbody>
      <tr><td>Subtotal</td><td style="text-align:right;">{{totals.subtotal}}</td></tr>
      <tr><td>Discount</td><td style="text-align:right;">{{totals.discount}}</td></tr>
      <tr><td>Tax</td><td style="text-align:right;">{{totals.tax}}</td></tr>
      <tr><td><strong>Total</strong></td><td style="text-align:right;"><strong>{{totals.total}}</strong></td></tr>
    </tbody>
  </table>
</div>`,footer:""}:{},[t]),y=v.useMemo(()=>{const Q=x.map(O=>b[O]).filter(Boolean).join(`
<hr />
`);return t==="INVOICE"||t==="DELIVERY_NOTE"||t==="SALES_ORDER"?`<div style="display:flex;justify-content:space-between;gap:16px;align-items:flex-start;">${b.companyHeader||""}${b.documentHeader||""}</div><hr />${b.customerBlock||""}${b.itemsTable||""}${b.totalsBlock||""}${b.footer||""}`:Q},[x,b,t]),N=v.useMemo(()=>{const q=String(c.logoUrl||"").trim(),Q=q?`<img src="${q}" alt="${x4(c.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",O={name:c.name||"OmniSuite Ltd",address:c.address||"123 Business Rd",city:c.city||"Accra",state:c.state||"Greater Accra",country:c.country||"Ghana",phone:c.phone||"+233 000 000 000",email:c.email||"info@example.com",website:c.website||"https://example.com",postalCode:c.postalCode||"00233",taxId:c.taxId||"TIN-000000",registrationNo:c.registrationNo||"REG-000000",logoUrl:q,logoHtml:Q},T=h||{};return t==="RECEIPT_VOUCHER"?{company:{name:O.name,addressLine1:O.address,addressLine2:`${O.city}  ${O.country}`,phone:O.phone,website:O.website,taxId:O.taxId,registrationNo:O.registrationNo,logoUrl:q,logoHtml:Q},receipt:{receiptNo:"RCPT-000001",dateTime:new Date().toLocaleString(),paymentMethod:"Cash",headerText:"Thank you",footerText:"Processed by Finance"},items:[{name:"Payment A",qty:"1",price:"10.00",discount:"0.00",lineTotal:"10.00"},{name:"Payment B",qty:"1",price:"15.00",discount:"0.00",lineTotal:"15.00"}],totals:{subtotal:"25.00",tax:"0.00",total:"25.00"}}:t==="PAYMENT_VOUCHER"?{company:{name:O.name,addressLine1:O.address,addressLine2:`${O.city}  ${O.country}`,phone:O.phone,website:O.website,taxId:O.taxId,registrationNo:O.registrationNo,logoUrl:q,logoHtml:Q},payment:{paymentNo:"PV-000001",dateTime:new Date().toLocaleString(),paymentMethod:"Cash",headerText:"Supplier Payment",footerText:"Processed by Finance"},items:[{name:"Expense A",qty:"1",price:"20.00",discount:"0.00",lineTotal:"20.00"},{name:"Expense B",qty:"1",price:"15.00",discount:"0.00",lineTotal:"15.00"}],totals:{subtotal:"35.00",tax:"0.00",total:"35.00"}}:t==="INVOICE"?{company:O,invoice:{invoice_no:"INV-000001",invoice_date:"2026-01-29"},customer:{code:"CUST001",name:"Customer Name",address:"123 Customer Street",city:"Accra",state:"Greater Accra",zone:"Accra",country:"Ghana",phone:"0200000000",mobile:"0200000000",email:"customer@example.com",contactPerson:"John Customer",type:"BUSINESS",paymentTerms:"Net 30",creditLimit:"0.00"},items:[{item_name:"Item A",qty:"2.00",unit_price:"10.00",total:"20.00"},{item_name:"Item B",qty:"1.00",unit_price:"15.00",total:"15.00"}],totals:{subtotal:"35.00",discount:"0.00",total:"35.00"}}:t==="PAYSLIP"?{company:{name:O.name,address:O.address,logoUrl:q,logoHtml:Q},payslip:{period:"2026-01",employee:"John Doe",netPay:"2500.00",status:"GENERATED"}}:t==="DELIVERY_NOTE"?{company:O,delivery:{delivery_no:"DN-000001",delivery_date:"2026-01-29"},customer:{code:"CUST001",name:"Customer Name",address:"123 Customer Street",city:"Accra",state:"Greater Accra",zone:"Accra",country:"Ghana",phone:"0200000000",mobile:"0200000000",email:"customer@example.com",contactPerson:"John Customer",type:"BUSINESS",paymentTerms:"Net 30",creditLimit:"0.00"},items:[{item_name:"Item A",qty:"2.00",unit_price:"10.00",total:"20.00"},{item_name:"Item B",qty:"1.00",unit_price:"15.00",total:"15.00"}],totals:{total:"35.00"}}:t==="SALES_ORDER"?{company:O,salesOrder:{order_no:"SO-000001",order_date:"2026-01-29",status:"DRAFT"},customer:{code:"CUST001",name:"Customer Name",address:"123 Customer Street",city:"Accra",state:"Greater Accra",zone:"Accra",country:"Ghana",phone:"0200000000",mobile:"0200000000",email:"customer@example.com",contactPerson:"John Customer",type:"BUSINESS",paymentTerms:"Net 30",creditLimit:"0.00"},items:[{item_name:"Item A",qty:"2.00",unit_price:"10.00",total:"20.00"},{item_name:"Item B",qty:"1.00",unit_price:"15.00",total:"15.00"}],totals:{subtotal:"35.00",discount:"0.00",tax:"0.00",total:"35.00"}}:{company:{name:String(T.companyName||O.name),addressLine1:String(T.addressLine1||O.address),addressLine2:String(T.addressLine2||`${O.city}  ${O.country}`),phone:String(T.contactNumber||O.phone),website:O.website,taxId:O.taxId,registrationNo:O.registrationNo,logoUrl:q,logoHtml:Q},receipt:{receiptNo:"RCPT-000001",dateTime:new Date().toLocaleString(),paymentMethod:"Cash",headerText:String(T.headerText||"Thank you for your purchase"),footerText:String(T.footerText||"Please visit again")},items:[{name:"Item A",qty:"2",price:"10.00",discount:"0.00",lineTotal:"20.00"},{name:"Item B",qty:"1",price:"15.00",discount:"0.00",lineTotal:"15.00"}],totals:{subtotal:"35.00",tax:"0.00",total:"35.00"}}},[t,c,h]),j=v.useMemo(()=>{const q=g4(y,N);return TO(q)},[y,N]);v.useEffect(()=>{let q=!0;async function Q(){var O,T,V;a(!0),o("");try{const Y=((O=(await te.get(`/admin/document-templates/${t}`)).data)==null?void 0:O.item)||null,M=String((Y==null?void 0:Y.template_html)||"");q&&d(M||"")}catch(D){q&&o(((V=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:V.message)||(D==null?void 0:D.message)||"Failed to load template")}finally{q&&a(!1)}}return Q(),()=>{q=!1}},[t]);async function S(){var q,Q;i(!0),o("");try{await te.put(`/admin/document-templates/${t}`,{templateHtml:y}),mt.success("Template saved")}catch(O){o(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||(O==null?void 0:O.message)||"Failed to save"),mt.error("Failed to save template")}finally{i(!1)}}function k(q,Q){q.dataTransfer.setData("text/plain",String(Q))}function P(q){q.preventDefault()}function I(q,Q){const O=Number(q.dataTransfer.getData("text/plain"));if(!Number.isFinite(O)||O===Q)return;const T=x.slice(),[V]=T.splice(O,1);T.splice(Q,0,V),g(T)}function B(){g(["companyHeader","documentHeader","customerBlock","itemsTable","totalsBlock","footer"])}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Administration Settings"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure document templates used for print and PDF"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",disabled:n||r,onClick:S,children:n?"Saving...":"Save"})]})]})})}),l?e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:l})}):null,e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700 dark:text-slate-200",children:"Document"}),e.jsx("select",{className:"input w-56",value:t,onChange:q=>s(q.target.value),disabled:r||n,children:IO.map(q=>e.jsx("option",{value:q.value,children:q.label},q.value))})]}),e.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Use ","{{field}}",", blocks like ","{{#each items}}...{{/each}}",", and logo as ","{{{company.logoHtml}}}","."]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:"Arrange Sections"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("ul",{className:"space-y-2",children:x.map((q,Q)=>e.jsxs("li",{draggable:!0,onDragStart:O=>k(O,Q),onDragOver:P,onDrop:O=>I(O,Q),className:"px-3 py-2 rounded-lg border border-slate-200 bg-white dark:bg-slate-800 cursor-move",children:[q==="companyHeader"&&"Company Header",q==="documentHeader"&&"Document Header",q==="customerBlock"&&"Customer Block",q==="itemsTable"&&"Items Table",q==="totalsBlock"&&"Totals Block",q==="footer"&&"Footer"]},q+"_"+Q))}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn-secondary",onClick:B,children:"Reset Default"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:"Preview"}),e.jsx("iframe",{title:"Template Preview",className:"w-full h-[520px] rounded-lg border border-slate-200 dark:border-slate-700 bg-white",srcDoc:j})]})]})]})})]})}function DO(){const[t,s]=Os.useState([{value:"120",label:"Total Users",change:" 5 this month",changeType:"positive",path:"/administration/users"},{value:"15",label:"Active Sessions",change:"Current",changeType:"neutral",path:"/administration/reports"},{value:"5",label:"Pending Workflows",change:"Requires approval",changeType:"neutral",path:"/administration/workflows"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.administration)==null?void 0:o.users)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.administration)==null?void 0:c.active_sessions)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.administration)==null?void 0:f.pending_workflows)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:String(y)},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"System Configuration",badge:"Core",items:[{title:"Company Setup",description:"Manage company information and settings",path:"/administration/companies",icon:"",hidden:!1,actions:[{label:"Manage",path:"/administration/companies",type:"primary"}]},{title:"Branch Setup",description:"Configure and manage company branches",path:"/administration/branches",icon:"",actions:[{label:"View List",path:"/administration/branches",type:"outline"},{label:"Add Branch",path:"/administration/branches/new",type:"primary"}]},{title:"Document Templates",description:"Design receipt, invoice, payslip, delivery note, and sales order templates",path:"/administration/settings",icon:"",actions:[{label:"Open",path:"/administration/settings",type:"primary"}]}]},{title:"User Management",badge:"Access Control",items:[{title:"Role Setup",description:"Configure roles and assign permissions to roles",path:"/administration/roles",icon:"",actions:[{label:"View Roles",path:"/administration/roles",type:"outline"},{label:"New Role",path:"/administration/roles/new",type:"primary"}]},{title:"User Management",description:"Create and manage user accounts with detailed permissions",path:"/administration/users",icon:"",actions:[{label:"View Users",path:"/administration/users",type:"outline"},{label:"Add User",path:"/administration/users/new",type:"primary"}]},{title:"Permissions",description:"Overview of system permissions, roles, and assignments",path:"/administration/permissions",icon:"",actions:[{label:"Dashboard",path:"/administration/permissions",type:"outline"},{label:"Assign Rights",path:"/administration/user-permissions",type:"primary"}]},{title:"Exceptional Permissions",description:"Grant special permissions to users temporarily",path:"/administration/exceptional-permissions",icon:"",actions:[{label:"View Permissions",path:"/administration/exceptional-permissions",type:"outline"},{label:"Grant",path:"/administration/exceptional-permissions/new",type:"primary"}]}]},{title:"Process & Reporting",items:[{title:"Workflow Configuration",description:"Define and configure approval workflows for documents",path:"/administration/workflows",icon:"",actions:[{label:"Configure",path:"/administration/workflows",type:"primary"}]},{title:"Reports",description:"View user activity, audit logs, and system reports",path:"/administration/reports",icon:"",actions:[{label:"View Logs",path:"/administration/reports",type:"primary"},{label:"System Log Book",path:"/administration/reports/system-log-book",type:"outline"}]}]}];return e.jsx(To,{title:"Administration",description:"System configuration and user management",stats:t,sections:r})}function PO(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(DO,{})}),e.jsx(tt,{path:"/roles",element:e.jsx(K6,{})}),e.jsx(tt,{path:"/roles/new",element:e.jsx(aw,{})}),e.jsx(tt,{path:"/roles/:id",element:e.jsx(aw,{})}),e.jsx(tt,{path:"/users",element:e.jsx(z6,{})}),e.jsx(tt,{path:"/users/new",element:e.jsx(nw,{})}),e.jsx(tt,{path:"/users/:id",element:e.jsx(nw,{})}),e.jsx(tt,{path:"/workflows",element:e.jsx(Y6,{})}),e.jsx(tt,{path:"/workflows/new",element:e.jsx(lw,{})}),e.jsx(tt,{path:"/workflows/:id",element:e.jsx(lw,{})}),e.jsx(tt,{path:"/workflows/approvals",element:e.jsx(J6,{})}),e.jsx(tt,{path:"/workflows/approvals/:instanceId",element:e.jsx(Z6,{})}),e.jsx(tt,{path:"/exceptional-permissions",element:e.jsx(eL,{})}),e.jsx(tt,{path:"/exceptional-permissions/new",element:e.jsx(ow,{})}),e.jsx(tt,{path:"/exceptional-permissions/:id",element:e.jsx(ow,{})}),e.jsx(tt,{path:"/companies",element:e.jsx(tL,{})}),e.jsx(tt,{path:"/companies/new",element:e.jsx(cw,{})}),e.jsx(tt,{path:"/companies/:id",element:e.jsx(cw,{})}),e.jsx(tt,{path:"/branches",element:e.jsx(rL,{})}),e.jsx(tt,{path:"/branches/new",element:e.jsx(dw,{})}),e.jsx(tt,{path:"/branches/:id",element:e.jsx(dw,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(aL,{})}),e.jsx(tt,{path:"/reports/system-log-book",element:e.jsx(nL,{})}),e.jsx(tt,{path:"/permissions",element:e.jsx(iL,{})}),e.jsx(tt,{path:"/user-permissions",element:e.jsx(lL,{})}),e.jsx(tt,{path:"/settings",element:e.jsx(LO,{})})]})}function UO(){const t=Ns(),[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,u]=v.useState(""),[d,c]=v.useState("ALL");v.useEffect(()=>{m()},[]);const m=async()=>{var x,g,b;try{n(!0),l("");const y=await te.get("/sales/quotations"),N=y.data&&y.data.data&&y.data.data.items||((x=y.data)==null?void 0:x.items)||[];r(Array.isArray(N)?N:[])}catch(y){l(((b=(g=y==null?void 0:y.response)==null?void 0:g.data)==null?void 0:b.message)||"Error fetching quotations"),console.error("Error fetching quotations:",y)}finally{n(!1)}},h=x=>{const g={DRAFT:"badge badge-warning",SENT:"badge badge-info",ACCEPTED:"badge badge-success",REJECTED:"badge badge-error",EXPIRED:"badge bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"};return e.jsx("span",{className:g[x]||"badge",children:x})},f=s.filter(x=>{const g=String(x.quotation_no||"").toLowerCase().includes(o.toLowerCase())||String(x.customer_name||"").toLowerCase().includes(o.toLowerCase()),b=d==="ALL"||x.status===d;return g&&b});return a?e.jsx("div",{className:"text-center py-8",children:"Loading quotations..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Quotations"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customer quotations and proposals"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/sales/quotations/new",className:"btn-success",children:"+ New Quotation"})]})]})})}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by quotation number or customer...",className:"input",value:o,onChange:x=>u(x.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:d,onChange:x=>c(x.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SENT",children:"Sent"}),e.jsx("option",{value:"ACCEPTED",children:"Accepted"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"EXPIRED",children:"Expired"})]})})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading quotations..."})]}):f.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No quotations found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Quotation No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Valid Until"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:f.map(x=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:x.quotation_no}),e.jsx("td",{children:new Date(x.quotation_date).toLocaleDateString()}),e.jsx("td",{children:x.customer_name}),e.jsx("td",{children:new Date(x.valid_until).toLocaleDateString()}),e.jsx("td",{className:"font-semibold",children:x.total_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:h(x.status)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/sales/quotations/${x.id}?mode=view`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),e.jsx("button",{onClick:()=>t(`/sales/quotations/${x.id}?mode=edit`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"})]})})]},x.id))})]})})]})})]})}const Gs="/assets/OMNISUITE_LOGO_FILL-CeKU3wr4.png";function F2(){var Ve,Ze;const t=Ns(),{id:s}=Ps(),r=!!s,{user:a}=Qa(),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState({quotation_no:"",quotation_date:new Date().toISOString().split("T")[0],customer_id:"",valid_days:30,valid_until:"",status:"DRAFT",terms_and_conditions:"",remarks:"",warehouse_id:"",price_type:"RETAIL",payment_type:"CASH",currency_id:4,exchange_rate:1}),[c,m]=v.useState([]),[h,f]=v.useState({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:"",remarks:""}),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState([]),[S,k]=v.useState([]),[P,I]=v.useState([]),[B,q]=v.useState([]),[Q,O]=v.useState(""),[T,V]=v.useState(!1),[D,Y]=v.useState({}),[M,X]=v.useState(""),[R,H]=v.useState(""),[W,K]=v.useState(""),[_,F]=v.useState(""),[E,L]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""}),[U,J]=v.useState(""),ae=v.useRef(null),Z=[{value:"DRAFT",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"SENT",label:"Sent",color:"bg-blue-100 text-blue-800"},{value:"ACCEPTED",label:"Accepted",color:"bg-green-100 text-green-800"},{value:"REJECTED",label:"Rejected",color:"bg-red-100 text-red-800"},{value:"EXPIRED",label:"Expired",color:"bg-orange-100 text-orange-800"}],oe=(Re,it)=>{if(!Re||!it)return"";const lt=new Date(Re);return lt.setDate(lt.getDate()+parseInt(it)),lt.toISOString().split("T")[0]},ee=Re=>{var pt;const it=parseFloat(Re.qty)||0,lt=parseFloat(Re.unit_price)||0,Ne=parseFloat(Re.discount_percent)||0,Xe=it*lt,Ge=Xe*Ne/100,at=Xe-Ge,xt=((pt=P.find(ge=>String(ge.value)===String(Re.tax_type)))==null?void 0:pt.rate)||0,wt=at*xt/100;return{sub:Xe,discAmt:Ge,net:at,taxAmt:wt,total:at+wt}},se=()=>{const Re=c.reduce((lt,Ne)=>lt+(Ne.net||0),0),it=c.reduce((lt,Ne)=>lt+(Ne.taxAmt||0),0);return{sub:Re,tax:it,total:Re+it}},Ae=()=>{const Re=c.reduce((Ge,at)=>Ge+(at.net||0),0),it={};c.forEach(Ge=>{(D[String(Ge.tax_type)]||[]).forEach(xt=>{const wt=Number(xt.rate_percent)||0,pt=(Ge.net||0)*wt/100,ge=xt.component_name;it[ge]||(it[ge]={amount:0,rate:wt,sort_order:xt.sort_order||0}),it[ge].amount+=pt})});const lt=Object.keys(it).map(Ge=>({name:Ge,amount:it[Ge].amount,rate:it[Ge].rate,sort_order:it[Ge].sort_order})).sort((Ge,at)=>Ge.sort_order-at.sort_order),Ne=lt.reduce((Ge,at)=>Ge+at.amount,0),Xe=Re+Ne;return{sub:Re,components:lt,taxTotal:Ne,total:Xe}},we=()=>{const Re=c.reduce((at,xt)=>at+(xt.sub||0),0),it=c.reduce((at,xt)=>at+(xt.discAmt||0),0),lt=c.reduce((at,xt)=>at+(xt.net||0),0),Ne=Ae(),Xe=Ne.taxTotal,Ge=lt+Xe;return{grossSub:Re,discountTotal:it,netSub:lt,components:Ne.components,taxTotal:Xe,grand:Ge}},ce=async()=>{const it=Array.from(new Set(c.map(lt=>String(lt.tax_type)).filter(Boolean))).filter(lt=>!(lt in D));it.length&&await Promise.all(it.map(lt=>me(lt)))};v.useEffect(()=>{le(),_e(),Qe(),Ie(),ke(),pe(),he(),r?Ue():(d(Re=>({...Re,valid_until:oe(Re.quotation_date,Re.valid_days)})),te.get("/sales/quotations/next-no").then(Re=>{var lt;const it=(lt=Re.data)==null?void 0:lt.nextNo;it&&d(Ne=>({...Ne,quotation_no:it}))}).catch(()=>{d(Re=>({...Re,quotation_no:Re.quotation_no||"QN000001"}))}))},[s]),v.useEffect(()=>{a!=null&&a.username&&J(a.username)},[a]);const le=async()=>{var Re;try{const it=await te.get("/sales/customers");g(Array.isArray((Re=it.data)==null?void 0:Re.items)?it.data.items:[])}catch(it){console.error("Error fetching customers:",it)}},_e=async()=>{var Re;try{const it=await te.get("/inventory/items");y(Array.isArray((Re=it.data)==null?void 0:Re.items)?it.data.items:[])}catch(it){console.error("Error fetching items:",it)}},Qe=async()=>{var Re;try{const it=await te.get("/inventory/warehouses");j(Array.isArray((Re=it.data)==null?void 0:Re.items)?it.data.items:[])}catch(it){console.error("Error fetching warehouses:",it)}},Ie=async()=>{var Re;try{const it=await te.get("/finance/currencies"),lt=Array.isArray((Re=it.data)==null?void 0:Re.items)?it.data.items:[];k(lt);const Ne=lt.find(Xe=>String(Xe.code||Xe.currency_code||"").toUpperCase()==="GHS")||lt.find(Xe=>/ghana|cedi/i.test(String(Xe.name||Xe.currency_name||"")));Ne&&d(Xe=>({...Xe,currency_id:Ne.id}))}catch(it){console.error("Error fetching currencies:",it)}},ke=async()=>{var Re;try{const it=await te.get("/finance/tax-codes"),Ne=(Array.isArray((Re=it.data)==null?void 0:Re.items)?it.data.items:[]).map(Xe=>({value:Xe.id,label:Xe.name,rate:Number(Xe.rate_percent),code:Xe.code}));if(I(Ne),Ne.length>0&&!h.tax_type){const Xe=Ne.find(Ge=>Number(Ge.rate)===20&&/vat/i.test(Ge.label))||Ne.find(Ge=>Number(Ge.rate)===20)||Ne.find(Ge=>/vat/i.test(Ge.label))||Ne[0];f(Ge=>({...Ge,tax_type:Xe==null?void 0:Xe.value,tax_rate:Xe==null?void 0:Xe.rate}))}}catch(it){console.error("Error fetching tax codes:",it)}};v.useEffect(()=>{!P.length||!c.length||m(Re=>Re.map(it=>({...it,...ee(it)})))},[P]);const pe=async()=>{var Re;try{const it=await te.get("/sales/price-types");q(Array.isArray((Re=it.data)==null?void 0:Re.items)?it.data.items:[])}catch(it){console.error("Error fetching price types:",it)}},he=async()=>{var Re,it,lt,Ne,Xe;try{const Ge=(a==null?void 0:a.username)||"";J(Ge);const at=await te.get("/admin/me"),xt=(it=(Re=at.data)==null?void 0:Re.scope)==null?void 0:it.companyId,wt=((Ne=(lt=at.data)==null?void 0:lt.user)==null?void 0:Ne.username)||"";if(!Ge&&wt&&J(wt),xt){const ge=((Xe=(await te.get(`/admin/companies/${xt}`)).data)==null?void 0:Xe.item)||{};L(rt=>({...rt,name:ge.name||rt.name||"",address:ge.address||rt.address||"",phone:ge.telephone||rt.phone||"",email:ge.email||rt.email||"",city:ge.city||rt.city||"",state:ge.state||rt.state||"",country:ge.country||rt.country||"",logoUrl:ge.has_logo===1||ge.has_logo===!0?`/api/admin/companies/${xt}/logo`:Gs}))}else L(pt=>({...pt,logoUrl:pt.logoUrl||Gs}))}catch{a!=null&&a.username&&J(a.username),L(Ge=>({...Ge,logoUrl:Ge.logoUrl||Gs}))}},je=Re=>{if(!Re||!B.length)return null;const it=B.find(lt=>String(lt.name||"").toUpperCase()===String(Re).toUpperCase());return it?it.id:null},me=async Re=>{var lt;const it=String(Re||"");if(it)try{const Ne=await te.get(`/finance/tax-codes/${Re}/components`),Xe=Array.isArray((lt=Ne.data)==null?void 0:lt.items)?Ne.data.items:[];Y(Ge=>({...Ge,[it]:Xe}))}catch{}},xe=async(Re,it)=>{var lt;try{const Ne=await te.get("/sales/prices/standard"),Xe=Array.isArray((lt=Ne.data)==null?void 0:lt.items)?Ne.data.items:[],Ge=je(u.price_type),at=Xe.filter(xt=>String(xt.product_id)===String(Re)&&(Ge?String(xt.price_type_id)===String(Ge):!0)).sort((xt,wt)=>{const pt=xt.effective_date?new Date(xt.effective_date).getTime():0;return(wt.effective_date?new Date(wt.effective_date).getTime():0)-pt||new Date(wt.created_at).getTime()-new Date(xt.created_at).getTime()});return at.length>0?Number(at[0].selling_price)||it||0:it||0}catch(Ne){return console.error("Error fetching standard price:",Ne),it||0}},Ue=async()=>{var Re,it,lt,Ne;try{i(!0);const Xe=await te.get(`/sales/quotations/${s}`),Ge=(Re=Xe.data)==null?void 0:Re.item;if(Ge){if(d({quotation_no:Ge.quotation_no||"",quotation_date:Ge.quotation_date||new Date().toISOString().split("T")[0],customer_id:Ge.customer_id||"",valid_days:Ge.valid_days||30,valid_until:Ge.valid_until||"",status:Ge.status||"DRAFT",terms_and_conditions:Ge.terms_and_conditions||"",remarks:Ge.remarks||"",warehouse_id:Ge.warehouse_id||"",price_type:Ge.price_type||"RETAIL",payment_type:Ge.payment_type||"CASH",currency_id:Ge.currency_id||4,exchange_rate:Ge.exchange_rate||1}),Ge.customer_id){const at=x.find(xt=>String(xt.id)===String(Ge.customer_id));at&&(O(Ge.customer_name||at.customer_name||""),X(Ge.customer_address||at.address||""),H(Ge.customer_city||at.city||""),K(Ge.customer_state||at.state||""),F(Ge.customer_country||at.country||""))}if((it=Xe.data)!=null&&it.details){const at=Xe.data.details.map((xt,wt)=>{var ge;const pt=ee({qty:xt.qty,unit_price:xt.unit_price,discount_percent:xt.discount_percent,tax_type:xt.tax_type||((ge=P==null?void 0:P[0])==null?void 0:ge.value)||""});return{...xt,line_id:wt+1,...pt}});m(at)}}}catch(Xe){o(((Ne=(lt=Xe==null?void 0:Xe.response)==null?void 0:lt.data)==null?void 0:Ne.message)||"Error fetching quotation"),console.error("Error fetching quotation:",Xe)}finally{i(!1)}},ct=async()=>{var it;if(u.customer_id)return Number(u.customer_id);const Re=Q.trim();if(!Re)throw new Error("Please enter a customer name");V(!0);try{const lt=je(u.price_type),Xe=(it=(await te.post("/sales/customers",{customer_name:Re,price_type_id:lt,address:M||null,city:R||null,state:W||null,country:_||null})).data)==null?void 0:it.id;if(!Xe)throw new Error("Failed to create customer");return d(Ge=>({...Ge,customer_id:Xe})),Number(Xe)}finally{V(!1)}},dt=Re=>{const{name:it,value:lt}=Re.target;if(it==="quotation_date"||it==="valid_days"){const Ne=it==="quotation_date"?lt:u.quotation_date,Xe=it==="valid_days"?lt:u.valid_days;d(Ge=>({...Ge,[it]:lt,valid_until:oe(Ne,Xe)}))}else d(Ne=>({...Ne,[it]:lt}))},We=Re=>{var Ne;const{name:it,value:lt}=Re.target;if(it==="item_id"){const Xe=b.find(at=>at.id===parseInt(lt)),Ge=(Xe==null?void 0:Xe.selling_price)||0;f(at=>({...at,item_id:lt,item_name:(Xe==null?void 0:Xe.item_name)||"",unit_price:Ge,qty:1})),xe(lt,Ge).then(at=>f(xt=>({...xt,unit_price:at}))),lt&&te.get(`/finance/item-tax/${lt}`).then(at=>{var wt,pt,ge;const xt=(wt=at.data)==null?void 0:wt.tax;if(xt){const rt=xt.id||((pt=P.find(ft=>ft.code===xt.tax_code))==null?void 0:pt.value)||null,ht=rt?(ge=P.find(ft=>String(ft.value)===String(rt)))==null?void 0:ge.rate:null;f(ft=>({...ft,tax_type:rt??ft.tax_type,tax_rate:ht??xt.tax_rate}))}else f(rt=>({...rt,tax_rate:void 0}))}).catch(()=>{f(at=>({...at,tax_rate:void 0}))})}else{if(it==="tax_type"){const Xe=((Ne=P.find(Ge=>String(Ge.value)===String(lt)))==null?void 0:Ne.rate)||0;f(Ge=>({...Ge,[it]:lt,tax_rate:Xe}));return}f(Xe=>({...Xe,[it]:lt}))}},He=()=>{var it,lt;if(!h.item_id||!h.qty||!h.unit_price){alert("Please fill all required item fields");return}const Re=ee(h);m([...c,{...h,line_id:Date.now(),...Re}]),f({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:((it=P.find(Ne=>Number(Ne.rate)===20&&/vat/i.test(Ne.label))||P.find(Ne=>Number(Ne.rate)===20)||P.find(Ne=>/vat/i.test(Ne.label))||P[0])==null?void 0:it.value)||"",tax_rate:((lt=P.find(Ne=>Number(Ne.rate)===20&&/vat/i.test(Ne.label))||P.find(Ne=>Number(Ne.rate)===20)||P.find(Ne=>/vat/i.test(Ne.label))||P[0])==null?void 0:lt.rate)||void 0,remarks:""})},ze=Re=>{m(c.filter(it=>it.line_id!==Re))},Pe=()=>{ce().finally(()=>window.print())},Te=async()=>{await ce();const Re=ae.current;if(!Re)return;const it=Re.style.cssText;Re.style.cssText=it+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const lt=await Wn(Re,{scale:2,useCORS:!0}),Ne=lt.toDataURL("image/png"),Xe=new As("p","mm","a4"),Ge=Xe.internal.pageSize.getWidth(),at=Xe.internal.pageSize.getHeight(),xt=Ge,wt=lt.height*xt/lt.width;let pt=0;for(;pt<wt;)Xe.addImage(Ne,"PNG",0,-pt,xt,wt),pt+=at,pt<wt&&Xe.addPage();const ge="Quotation_"+(u.quotation_no||new Date().toISOString().slice(0,10))+".pdf";Xe.save(ge)}finally{Re.style.cssText=it}},Ke=Re=>{if(Re==null)return null;if(typeof Re!="object")return Re;if(Array.isArray(Re))return Re.map(lt=>lt===void 0?null:Ke(lt));const it={};return Object.keys(Re).forEach(lt=>{const Ne=Re[lt];it[lt]=Ne===void 0?null:Ke(Ne)}),it},$e=async Re=>{var Ne,Xe,Ge;if(Re.preventDefault(),!u.customer_id&&!Q.trim()||c.length===0){alert("Please enter customer name and add at least one item");return}i(!0);const it=we();let lt=u.quotation_no;if(!lt)try{lt=((Ne=(await te.get("/sales/quotations/next-no")).data)==null?void 0:Ne.nextNo)||"QN000001"}catch{lt="QN000001"}try{const at=await ct();if(!at){alert("Failed to get customer ID. Please try again."),i(!1);return}const xt=c.filter(ge=>ge.item_id&&Number(ge.item_id)>0).map(ge=>{const rt=ee(ge),ht=ge.tax_type!==null&&ge.tax_type!==void 0&&ge.tax_type!==""?Number(ge.tax_type):null,ft=ht!==null?P.find(St=>String(St.value)===String(ht)):null;return{item_id:Number(ge.item_id),qty:Number(ge.qty)||0,quantity:Number(ge.qty)||0,unit_price:Number(ge.unit_price)||0,discount_percent:Number(ge.discount_percent)||0,tax_type:ht,tax_id:ht,tax_rate:ft&&Number(ft.rate)||0,tax_amount:Number(rt.taxAmt)||0,line_total:Number(rt.total)||0,total_amount:Number(rt.total)||0,net_amount:Number(rt.net)||0}}),wt={quotation_no:lt?String(lt):null,quotation_date:u.quotation_date?String(u.quotation_date):null,customer_id:at?Number(at):null,valid_until:u.valid_until?String(u.valid_until):null,status:u.status?String(u.status):"DRAFT",terms_and_conditions:u.terms_and_conditions&&u.terms_and_conditions.trim()?String(u.terms_and_conditions):null,remarks:u.remarks&&u.remarks.trim()?String(u.remarks):null,warehouse_id:u.warehouse_id?Number(u.warehouse_id):null,price_type:u.price_type?String(u.price_type):null,payment_type:u.payment_type?String(u.payment_type):null,customer_name:Q?String(Q):null,customer_address:M?String(M):null,customer_city:R?String(R):null,customer_state:W?String(W):null,customer_country:_?String(_):null,total_amount:it.grand?Number(it.grand):0,items:xt},pt=Ke(wt);if(!pt.customer_id||isNaN(pt.customer_id)){alert("Invalid customer ID. Please try again."),i(!1);return}pt.quotation_no=pt.quotation_no||null,pt.quotation_date=pt.quotation_date||null,pt.valid_until=pt.valid_until||null,pt.status=pt.status||"DRAFT",pt.remarks=pt.remarks||null,pt.terms_and_conditions=pt.terms_and_conditions||null,pt.warehouse_id=pt.warehouse_id||null,pt.price_type=pt.price_type||null,pt.payment_type=pt.payment_type||null,pt.customer_name=pt.customer_name||null,pt.customer_address=pt.customer_address||null,pt.customer_city=pt.customer_city||null,pt.customer_state=pt.customer_state||null,pt.customer_country=pt.customer_country||null,pt.total_amount=pt.total_amount||0,pt.items&&Array.isArray(pt.items)&&(pt.items=pt.items.map(ge=>({item_id:Number(ge.item_id)||null,qty:Number(ge.qty)||0,quantity:Number(ge.qty)||0,unit_price:Number(ge.unit_price)||0,tax_id:ge.tax_id!==null&&ge.tax_id!==void 0?Number(ge.tax_id):null,tax_type:ge.tax_type!==null&&ge.tax_type!==void 0?Number(ge.tax_type):null,tax_rate:Number(ge.tax_rate)||0,tax_amount:Number(ge.tax_amount)||0,line_total:Number(ge.line_total)||0,total_amount:Number(ge.total_amount)||0}))),r?await te.put(`/sales/quotations/${s}`,pt):await te.post("/sales/quotations",pt),console.log("Submitting:",wt),alert(r?"Quotation updated successfully!":"Quotation created successfully!"),t("/sales/quotations")}catch(at){console.error("Error saving quotation:",at);const xt=((Ge=(Xe=at.response)==null?void 0:Xe.data)==null?void 0:Ge.message)||at.message||"Unknown error";alert(`Error saving quotation: ${xt}`)}finally{i(!1)}};return e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden my-6 print:shadow-none print:my-0 print:w-full print:max-w-none",children:[e.jsx("style",{children:`
        @media print {
          @page { margin: 1cm; }
          body { 
            background: white; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          #root > div > header,
          #root > div > div > aside { display: none !important; }
          .print\\:hidden { display: none !important; }
          .print\\:block { display: block !important; }
          #root > div > div > main { padding: 0 !important; }
          input, select, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            resize: none;
            overflow: visible;
          }
        }
        .quotation-table { 
          border-collapse: collapse; 
          table-layout: fixed; 
          width: 100%; 
          max-width: 100%; 
          border-spacing: 0; 
          box-sizing: border-box;
          margin: 0;
        }
        .quotation-table th, .quotation-table td { 
          border: 1px solid #000000; 
          box-sizing: border-box; 
          word-break: break-word; 
          overflow-wrap: anywhere; 
          white-space: normal; 
          padding: 6px 4px;
          font-size: 10px;
        }
        .quotation-table td {
          overflow: visible;
        }
        .quotation-table thead th { 
          background: #0E3646; 
          color: #ffffff; 
        }
        .quotation-table thead th:last-child,
        .quotation-table tbody td:last-child {
          background: #ffffff;
          color: #000000;
        }
        .quotation-table thead th:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        .quotation-table tbody td:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        @media print {
          .quotation-table {
            width: 100%;
            max-width: 100%;
          }
          .quotation-table thead th:last-child,
          .quotation-table tbody td:last-child {
            background: #ffffff !important;
            color: #000000 !important;
          }
          .quotation-table thead th:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
          .quotation-table tbody td:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
        }
      `}),e.jsx("div",{className:"p-6 border-b text-white print:hidden",style:{backgroundColor:"#0E3646"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:[r?"Edit":"New"," Quotation"]}),e.jsx("p",{className:"text-sm opacity-80",children:r?"Update quotation details":"Create a new sales quotation"})]}),e.jsxs("div",{className:"flex gap-4 print:hidden items-center",children:[e.jsxs("button",{onClick:Te,className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-lg transition-colors text-sm font-medium border border-white/20",title:"Save as PDF",children:[e.jsx(gu,{className:"w-4 h-4"}),"Download PDF"]}),e.jsx("button",{onClick:Pe,className:"text-white hover:text-gray-200",title:"Print",children:e.jsx(Mh,{className:"w-6 h-6"})}),e.jsx(Ee,{to:"/sales/quotations",className:"text-white hover:text-gray-200",children:e.jsx(If,{className:"w-6 h-6"})})]})]})}),e.jsx("div",{className:"p-6 print:hidden",children:e.jsxs("form",{onSubmit:$e,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quotation #"}),e.jsx("input",{type:"text",name:"quotation_no",value:u.quotation_no,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Auto-generated",readOnly:!r&&!u.quotation_no})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"quotation_date",value:u.quotation_date,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),e.jsx("input",{type:"text",value:Q,onChange:Re=>O(Re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Type customer name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:M,onChange:Re=>X(Re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:R,onChange:Re=>H(Re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter city"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:W,onChange:Re=>K(Re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter state"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:_,onChange:Re=>F(Re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter country"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:u.warehouse_id,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),N.map(Re=>e.jsx("option",{value:Re.id,children:Re.warehouse_name},Re.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valid Days *"}),e.jsx("input",{type:"number",name:"valid_days",value:u.valid_days,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),e.jsx("input",{type:"date",value:u.valid_until,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{name:"status",value:u.status,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:Z.map(Re=>e.jsx("option",{value:Re.value,children:Re.label},Re.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Type"}),e.jsxs("select",{name:"price_type",value:u.price_type,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"RETAIL",children:"Retail"}),e.jsx("option",{value:"WHOLESALE",children:"Wholesale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),e.jsxs("select",{name:"payment_type",value:u.payment_type,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"}),e.jsx("option",{value:"CREDIT",children:"Credit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),e.jsx("select",{name:"currency_id",value:u.currency_id,onChange:dt,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:S.map(Re=>e.jsxs("option",{value:Re.id,children:[Re.code||Re.currency_code," - ",Re.name||Re.currency_name]},Re.id))})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terms & Conditions"}),e.jsx("textarea",{name:"terms_and_conditions",value:u.terms_and_conditions,onChange:dt,rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646] print:hidden",placeholder:"Enter terms and conditions..."}),e.jsx("div",{className:"hidden print:block whitespace-pre-wrap text-sm text-gray-800 border-none p-0",children:u.terms_and_conditions||"None"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{name:"remarks",value:u.remarks,onChange:dt,rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646] print:hidden",placeholder:"Enter remarks..."}),e.jsx("div",{className:"hidden print:block whitespace-pre-wrap text-sm text-gray-800 border-none p-0",children:u.remarks||"None"})]})]}),e.jsxs("div",{className:"border-t pt-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Quotation Items"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200 print:hidden",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 mb-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Item *"}),e.jsxs("select",{name:"item_id",value:h.item_id,onChange:We,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Item"}),b.map(Re=>e.jsxs("option",{value:Re.id,children:[Re.item_code," - ",Re.item_name]},Re.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),e.jsx("input",{type:"number",name:"qty",value:h.qty,onChange:We,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",name:"unit_price",value:h.unit_price,onChange:We,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Disc %"}),e.jsx("input",{type:"number",name:"discount_percent",value:h.discount_percent,onChange:We,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"0",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),e.jsx("select",{name:"tax_type",value:h.tax_type,onChange:We,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:P.map(Re=>e.jsx("option",{value:Re.value,children:Re.label},Re.value))}),h.tax_rate!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Tax rate: ",Number(h.tax_rate).toFixed(2),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:He,className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#0E3646"},children:[e.jsx(vu,{className:"w-4 h-4"}),"Add Item"]})})]}),c.length>0&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Disc%"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider print:hidden",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:c.map(Re=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Re.item_name}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Re.qty}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(Re.unit_price).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(Re.discount_percent||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Re.net.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Re.taxAmt.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:Re.total.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 print:hidden",children:e.jsx("button",{type:"button",onClick:()=>ze(Re.line_id),className:"text-red-600 hover:text-red-900 transition-colors",children:e.jsx(Gl,{className:"w-4 h-4"})})})]},Re.line_id))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Totals:"}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:se().sub.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:se().tax.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:se().total.toFixed(2)}),e.jsx("td",{className:"print:hidden"})]})})]})}),c.length===0&&e.jsx("div",{className:"text-center py-10 text-gray-500 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:e.jsx("p",{children:"No items added yet. Use the form above to add items to this quotation."})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 print:hidden",children:[e.jsx(Ee,{to:"/sales/quotations",className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#0E3646"},disabled:n,children:[e.jsx(Hh,{className:"w-5 h-5"}),n?"Saving...":r?"Update Quotation":"Create Quotation"]})]})]})}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:E.logoUrl||Gs,alt:E.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:E.name||"Company"}),E.address&&e.jsx("div",{children:E.address}),(E.city||E.state||E.country)&&e.jsx("div",{children:[E.city,E.state,E.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[E.phone&&e.jsx("span",{children:E.phone}),E.email&&e.jsx("span",{children:E.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Quotation"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",u.quotation_date||""]}),e.jsxs("div",{children:["Quotation #: ",u.quotation_no||""]}),e.jsxs("div",{children:["Customer:"," ",Q||u.potential_cust_name||""]}),e.jsxs("div",{children:["Valid until: ",u.valid_until||""]}),e.jsxs("div",{children:["Prepared by: ",U||""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Customer Name"}),e.jsx("div",{className:"flex-1",children:Q||((Ve=x.find(Re=>String(Re.id)===String(u.customer_id)))==null?void 0:Ve.customer_name)||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Address"}),e.jsx("div",{className:"flex-1",children:M||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"City"}),e.jsx("div",{className:"flex-1",children:R||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"State"}),e.jsx("div",{className:"flex-1",children:W||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Country"}),e.jsx("div",{className:"flex-1",children:_||""})]})]}),e.jsx("div",{className:"text-right"})]}),e.jsx("div",{className:"mb-2",children:e.jsxs("table",{className:"quotation-table text-sm",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:c.map((Re,it)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Re.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Re.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Re.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Re.total||0).toFixed(2)})]},Re.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:we().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:we().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:we().netSub.toFixed(2)}),we().components.map(Re=>e.jsxs(Os.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[Re.name," [",Re.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Re.amount.toFixed(2)})]},Re.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:we().grand.toFixed(2)})]})})})]}),e.jsxs("div",{className:"mt-6 text-sm",children:[e.jsx("div",{children:"Terms and conditions :"}),e.jsx("div",{className:"mt-1",children:u.terms_and_conditions||"None"})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]}),e.jsxs("div",{ref:ae,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:E.logoUrl||Gs,alt:E.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:E.name||"Company"}),E.address&&e.jsx("div",{children:E.address}),(E.city||E.state||E.country)&&e.jsx("div",{children:[E.city,E.state,E.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[E.phone&&e.jsx("span",{children:E.phone}),E.email&&e.jsx("span",{children:E.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Quotation"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",u.quotation_date||""]}),e.jsxs("div",{children:["Quotation #: ",u.quotation_no||""]}),e.jsxs("div",{children:["Customer: ",Q||""]}),e.jsxs("div",{children:["Valid until: ",u.valid_until||""]}),e.jsxs("div",{children:["Prepared by: ",U||""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Customer Name"}),e.jsx("div",{className:"flex-1",children:Q||((Ze=x.find(Re=>String(Re.id)===String(u.customer_id)))==null?void 0:Ze.customer_name)||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Address"}),e.jsx("div",{className:"flex-1",children:M||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"City"}),e.jsx("div",{className:"flex-1",children:R||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"State"}),e.jsx("div",{className:"flex-1",children:W||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Country"}),e.jsx("div",{className:"flex-1",children:_||""})]})]}),e.jsx("div",{className:"text-right"})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible"},children:e.jsxs("table",{className:"quotation-table text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:c.map(Re=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Re.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Re.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Re.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Re.total||0).toFixed(2)})]},Re.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:we().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:we().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:we().netSub.toFixed(2)}),we().components.map(Re=>e.jsxs(Os.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[Re.name," [",Re.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Re.amount.toFixed(2)})]},Re.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:we().grand.toFixed(2)})]})})})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]})]})}function RO(){const t=Ns(),[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,u]=v.useState(""),[d,c]=v.useState("ALL"),[m,h]=v.useState(!1),[f,x]=v.useState(!1),[g,b]=v.useState(""),[y,N]=v.useState(null),[j,S]=v.useState([]),[k,P]=v.useState(null),[I,B]=v.useState(null),[q,Q]=v.useState(null),[O,T]=v.useState(!1),[V,D]=v.useState(null);v.useEffect(()=>{Y()},[]);const Y=async()=>{var _,F,E;try{n(!0),l("");const L=await te.get("/sales/orders");r(Array.isArray((_=L.data)==null?void 0:_.items)?L.data.items:[])}catch(L){l(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Error fetching orders"),console.error("Error fetching orders:",L)}finally{n(!1)}},M=_=>{const F={DRAFT:"badge badge-warning",CONFIRMED:"badge badge-info",PROCESSING:"badge badge-primary",SHIPPED:"badge badge-secondary",DELIVERED:"badge badge-success",CANCELLED:"badge badge-error"};return e.jsx("span",{className:F[_]||"badge",children:_})},X=s.filter(_=>{const F=String(_.order_no||"").toLowerCase().includes(o.toLowerCase())||String(_.customer_name||"").toLowerCase().includes(o.toLowerCase()),E=d==="ALL"||_.status===d;return F&&E}),R=async _=>{var F,E,L;if(D(_),h(!0),b(""),I)await W();else try{x(!0);const U=await te.get("/workflows"),J=Array.isArray((F=U.data)==null?void 0:F.items)?U.data.items:[];B(J),await H(J)}catch(U){b(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load workflows")}finally{x(!1)}},H=async _=>{var U,J,ae;if(!_||!_.length){N(null),P(null),b("");return}const F="/sales/sales-orders",E=Z=>String(Z||"").trim().toUpperCase().replace(/\s+/g,"_"),L=_.find(Z=>Number(Z.is_active)===1&&String(Z.document_route)===F)||_.find(Z=>Number(Z.is_active)===1&&E(Z.document_type)==="SALES_ORDER")||null;if(N(L||null),P(null),!!L)try{x(!0);const oe=(U=(await te.get(`/workflows/${L.id}`)).data)==null?void 0:U.item,ee=Array.isArray(oe==null?void 0:oe.steps)?oe.steps:[];S(ee);const se=ee[0]||null;if(P(se?{userId:se.approver_user_id,name:se.approver_name,stepName:se.step_name,stepOrder:se.step_order,approvalLimit:se.approval_limit}:null),se){const Ae=(Array.isArray(se.approvers)&&se.approvers.length?se.approvers[0].id:se.approver_user_id)||null;Q(Ae)}else Q(null)}catch(Z){b(((ae=(J=Z==null?void 0:Z.response)==null?void 0:J.data)==null?void 0:ae.message)||"Failed to load workflow details")}finally{x(!1)}},W=async()=>{var L,U,J;if(!I||!I.length){N(null),P(null),b("");return}const _="/sales/sales-orders",F=ae=>String(ae||"").trim().toUpperCase().replace(/\s+/g,"_"),E=I.find(ae=>Number(ae.is_active)===1&&String(ae.document_route)===_)||I.find(ae=>Number(ae.is_active)===1&&F(ae.document_type)==="SALES_ORDER")||null;if(N(E||null),P(null),!!E)try{x(!0);const Z=(L=(await te.get(`/workflows/${E.id}`)).data)==null?void 0:L.item,oe=Array.isArray(Z==null?void 0:Z.steps)?Z.steps:[];S(oe);const ee=oe[0]||null;if(P(ee?{userId:ee.approver_user_id,name:ee.approver_name,stepName:ee.step_name,stepOrder:ee.step_order,approvalLimit:ee.approval_limit}:null),ee){const se=(Array.isArray(ee.approvers)&&ee.approvers.length?ee.approvers[0].id:ee.approver_user_id)||null;Q(se)}else Q(null)}catch(ae){b(((J=(U=ae==null?void 0:ae.response)==null?void 0:U.data)==null?void 0:J.message)||"Failed to load workflow details")}finally{x(!1)}};async function K(){var _,F,E;if(V){T(!0),b("");try{const L=V.total_amount===void 0||V.total_amount===null?null:Number(V.total_amount||0),U=await te.post(`/sales/orders/${V.id}/submit`,{amount:L,workflow_id:y?y.id:null,target_user_id:q||null}),J=((_=U==null?void 0:U.data)==null?void 0:_.status)||"PENDING_APPROVAL";r(ae=>ae.map(Z=>Z.id===V.id?{...Z,status:J}:Z)),h(!1),D(null)}catch(L){b(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Failed to forward for approval")}finally{T(!1)}}}return a?e.jsx("div",{className:"text-center py-8",children:"Loading orders..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customer orders and track fulfillment"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/sales/sales-orders/new",className:"btn-success",children:"+ New Sales Order"})]})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by order number or customer...",className:"input",value:o,onChange:_=>u(_.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:d,onChange:_=>c(_.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"CONFIRMED",children:"Confirmed"}),e.jsx("option",{value:"PROCESSING",children:"Processing"}),e.jsx("option",{value:"SHIPPED",children:"Shipped"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading sales orders..."})]}):X.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No sales orders found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order No"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:X.map(_=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:_.order_no}),e.jsx("td",{children:new Date(_.order_date).toLocaleDateString()}),e.jsx("td",{children:_.customer_name}),e.jsx("td",{children:_.priority||"-"}),e.jsx("td",{className:"font-semibold",children:_.total_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:M(_.status)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/sales/sales-orders/${_.id}?mode=view`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),String(_.status||"").toUpperCase()!=="CONFIRMED"&&e.jsx("button",{onClick:()=>t(`/sales/sales-orders/${_.id}?mode=edit`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"}),_.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):_.status==="DRAFT"?e.jsx("button",{type:"button",className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",onClick:()=>R(_),disabled:O,children:"Forward for Approval"}):null]})})]},_.id))})]})})]})}),m?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{h(!1),D(null),N(null),P(null),Q(null),S([]),b("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:(V==null?void 0:V.order_no)||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:y?`${y.workflow_name} (${y.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:f?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const F=Array.isArray(j)&&j.length>0?j[0]:null,E=F?Array.isArray(F.approvers)&&F.approvers.length?F.approvers.map(L=>({id:L.id,name:L.username})):F.approver_user_id?[{id:F.approver_user_id,name:F.approver_name||String(F.approver_user_id)}]:[]:[];return E.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:q||"",onChange:L=>Q(L.target.value?Number(L.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),E.map(L=>e.jsx("option",{value:L.id,children:L.name},L.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:k?`Step ${k.stepOrder}  ${k.stepName}${k.approvalLimit!=null?`  Limit: ${Number(k.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:y?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{h(!1),D(null),N(null),P(null),Q(null),S([]),b("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:K,disabled:O||!V||Array.isArray(j)&&j.length>0&&y&&!q,children:O?"Forwarding...":"Forward"})]})]})}):null]})}function v4(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Mc(t,s){const r=String(s||"").trim().replace(/^\./,"");if(!r)return;const a=r.split(".").filter(Boolean);let n=t;for(const i of a){if(n==null)return;n=n[i]}return n}function xy(t,s,r=s){let a=String(t??"");return a=a.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(n,i,l)=>{const o=String(i||"").trim(),u=o.startsWith("@root.")?Mc(r,o.slice(6)):Mc(s,o)??Mc(r,o);return(Array.isArray(u)?u:[]).map(c=>xy(l,c??{},r)).join("")}),a=a.replace(/{{{\s*([^}]+?)\s*}}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Mc(r,l.slice(6)):o=Mc(s,l)??Mc(r,l),String(o??"")}),a=a.replace(/{{\s*([^}]+?)\s*}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Mc(r,l.slice(6)):o=Mc(s,l)??Mc(r,l),v4(o)}),a}function OO(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sales Order</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; color: #0f172a; background: #fff; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
      .right { text-align: right; }
      .center { text-align: center; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}async function QO(t){const s=Array.from(t.querySelectorAll("img"));s.length&&await Promise.all(s.map(r=>new Promise(a=>{if(r.complete)return a();const n=()=>a();r.addEventListener("load",n,{once:!0}),r.addEventListener("error",n,{once:!0})})))}function T2(){var $e,Ve,Ze,Re,it,lt;const t=Ns(),{id:s}=Ps(),r=!!s,{user:a}=Qa(),[n]=_0(),i=String(n.get("mode")||"").toLowerCase()==="view",[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState("details"),[h,f]=v.useState({order_no:"",order_date:new Date().toISOString().split("T")[0],customer_id:"",quotation_id:"",status:"DRAFT",currency_id:4,exchange_rate:1,sales_person_id:"",warehouse_id:"",price_type:"RETAIL",payment_type:"CASH",payment_terms:"",priority:"MEDIUM",shipping_charges:0,delivery_time:"",internal_notes:"",customer_notes:"",city:"",state:"",country:"",phone:"",remarks:""}),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState([]),[S,k]=v.useState([]),[P,I]=v.useState([]),[B,q]=v.useState([]),[Q,O]=v.useState([]),T=v.useRef(null),[V,D]=v.useState({}),[Y,M]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",postalCode:"",country:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[X,R]=v.useState(""),[H,W]=v.useState(null),[K,_]=v.useState({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:"",remarks:""}),F=[{value:"DRAFT",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"CONFIRMED",label:"Confirmed",color:"bg-blue-100 text-blue-800"},{value:"PROCESSING",label:"Processing",color:"bg-yellow-100 text-yellow-800"},{value:"SHIPPED",label:"Shipped",color:"bg-purple-100 text-purple-800"},{value:"DELIVERED",label:"Delivered",color:"bg-green-100 text-green-800"},{value:"CANCELLED",label:"Cancelled",color:"bg-red-100 text-red-800"}],E=[{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"URGENT",label:"Urgent"}],L=Ne=>{var ht;const Xe=parseFloat(Ne.qty)||0,Ge=parseFloat(Ne.unit_price)||0,at=parseFloat(Ne.discount_percent)||0,xt=Xe*Ge,wt=xt*at/100,pt=xt-wt,ge=((ht=Q.find(ft=>String(ft.value)===String(Ne.tax_type)))==null?void 0:ht.rate)||0,rt=pt*ge/100;return{sub:xt,discAmt:wt,net:pt,taxAmt:rt,total:pt+rt}},U=()=>{const Ne=x.reduce((Ge,at)=>Ge+(at.net||0),0),Xe=x.reduce((Ge,at)=>Ge+(at.taxAmt||0),0);return{sub:Ne,tax:Xe,total:Ne+Xe}},J=Ne=>{if(Ne==null||Ne==="")return null;const Xe=Number(Ne);if(Number.isFinite(Xe)&&String(Xe)===String(Ne))return Xe;const Ge=Q.find(at=>String(at.code||"")===String(Ne||""));return Ge?Ge.value:null},ae=async(Ne,Xe)=>{var Ge;if(!Ne||!Xe)return 0;try{const at=await te.get(`/inventory/stock/available?warehouse_id=${Ne}&item_id=${Xe}`);return Number(((Ge=at.data)==null?void 0:Ge.qty)||0)}catch{return 0}};v.useEffect(()=>{oe(),ee(),Ie(),se(),Ae(),we(),Z(),r?ke():te.get("/sales/orders/next-no").then(Ne=>{var Ge;const Xe=(Ge=Ne.data)==null?void 0:Ge.nextNo;Xe&&f(at=>({...at,order_no:Xe}))}).catch(()=>{f(Ne=>({...Ne,order_no:Ne.order_no||"SO-000001"}))})},[s]),v.useEffect(()=>{a!=null&&a.username&&R(a.username)},[a]);const Z=async()=>{var Ne,Xe,Ge,at,xt;try{const wt=(a==null?void 0:a.username)||"";R(wt);const pt=await te.get("/admin/me"),ge=(Xe=(Ne=pt.data)==null?void 0:Ne.scope)==null?void 0:Xe.companyId,rt=((at=(Ge=pt.data)==null?void 0:Ge.user)==null?void 0:at.username)||"";if(!wt&&rt&&R(rt),ge){const ft=((xt=(await te.get(`/admin/companies/${ge}`)).data)==null?void 0:xt.item)||{};M(St=>({...St,name:ft.name||St.name||"",address:ft.address||St.address||"",phone:ft.telephone||St.phone||"",email:ft.email||St.email||"",city:ft.city||St.city||"",state:ft.state||St.state||"",postalCode:ft.postal_code||St.postalCode||"",country:ft.country||St.country||"",website:ft.website||St.website||"",taxId:ft.tax_id||St.taxId||"",registrationNo:ft.registration_no||St.registrationNo||"",logoUrl:ft.has_logo===1||ft.has_logo===!0?`/api/admin/companies/${ge}/logo`:Gs}))}else M(ht=>({...ht,logoUrl:ht.logoUrl||Gs}))}catch{a!=null&&a.username&&R(a.username),M(wt=>({...wt,logoUrl:wt.logoUrl||Gs}))}},oe=async()=>{var Ne;try{const Xe=await te.get("/sales/customers");y(Array.isArray((Ne=Xe.data)==null?void 0:Ne.items)?Xe.data.items:[])}catch(Xe){console.error("Error fetching customers:",Xe)}},ee=async()=>{var Ne;try{const Xe=await te.get("/inventory/items");j(Array.isArray((Ne=Xe.data)==null?void 0:Ne.items)?Xe.data.items:[])}catch(Xe){console.error("Error fetching items:",Xe)}},se=async()=>{var Ne;try{const Xe=await te.get("/inventory/warehouses");I(Array.isArray((Ne=Xe.data)==null?void 0:Ne.items)?Xe.data.items:[])}catch(Xe){console.error("Error fetching warehouses:",Xe)}},Ae=async()=>{var Ne;try{const Xe=await te.get("/finance/currencies"),Ge=Array.isArray((Ne=Xe.data)==null?void 0:Ne.items)?Xe.data.items:[];q(Ge);const at=Ge.find(xt=>String(xt.code||xt.currency_code||"").toUpperCase()==="GHS")||Ge.find(xt=>/ghana|cedi/i.test(String(xt.name||xt.currency_name||"")));!r&&at&&f(xt=>({...xt,currency_id:at.id}))}catch(Xe){console.error("Error fetching currencies:",Xe)}},we=async()=>{var Ne;try{const Xe=await te.get("/finance/tax-codes"),at=(Array.isArray((Ne=Xe.data)==null?void 0:Ne.items)?Xe.data.items:[]).map(xt=>({value:xt.id,label:xt.name,rate:Number(xt.rate_percent),code:xt.code}));O(at),at.length>0&&!K.tax_type&&_(xt=>({...xt,tax_type:at[0].value}))}catch(Xe){console.error("Error fetching tax codes:",Xe)}},ce=async Ne=>{var Ge;const Xe=String(Ne||"");if(Xe)try{const at=await te.get(`/finance/tax-codes/${Ne}/components`),xt=Array.isArray((Ge=at.data)==null?void 0:Ge.items)?at.data.items:[];D(wt=>({...wt,[Xe]:xt}))}catch{}},le=async()=>{const Xe=Array.from(new Set(x.map(Ge=>String(Ge.tax_type)).filter(Boolean))).filter(Ge=>!(Ge in V));Xe.length&&await Promise.all(Xe.map(Ge=>ce(Ge)))},_e=()=>{const Ne=x.reduce((wt,pt)=>wt+(pt.net||0),0),Xe={};x.forEach(wt=>{(V[String(wt.tax_type)]||[]).forEach(ge=>{const rt=Number(ge.rate_percent)||0,ht=(wt.net||0)*rt/100,ft=ge.component_name;Xe[ft]||(Xe[ft]={amount:0,rate:rt,sort_order:ge.sort_order||0}),Xe[ft].amount+=ht})});const Ge=Object.keys(Xe).map(wt=>({name:wt,amount:Xe[wt].amount,rate:Xe[wt].rate,sort_order:Xe[wt].sort_order})).sort((wt,pt)=>wt.sort_order-pt.sort_order),at=Ge.reduce((wt,pt)=>wt+pt.amount,0),xt=Ne+at;return{sub:Ne,components:Ge,taxTotal:at,total:xt}},Qe=()=>{const Ne=x.reduce((wt,pt)=>wt+(pt.sub||0),0),Xe=x.reduce((wt,pt)=>wt+(pt.discAmt||0),0),Ge=x.reduce((wt,pt)=>wt+(pt.net||0),0),at=_e(),xt=Ge+at.taxTotal;return{grossSub:Ne,discountTotal:Xe,netSub:Ge,components:at.components,taxTotal:at.taxTotal,grand:xt}},Ie=async()=>{var Ne;try{const Xe=await te.get("/sales/quotations");k(Array.isArray((Ne=Xe.data)==null?void 0:Ne.items)?Xe.data.items:[])}catch(Xe){console.error("Error fetching quotations:",Xe)}},ke=async()=>{var Ne,Xe,Ge,at;try{o(!0);const xt=await te.get(`/sales/orders/${s}`),wt=(Ne=xt.data)==null?void 0:Ne.item;if(wt&&(f(pt=>({order_no:wt.order_no||"",order_date:wt.order_date?new Date(wt.order_date).toISOString().split("T")[0]:"",customer_id:wt.customer_id||"",quotation_id:wt.quotation_id||"",status:wt.status||"DRAFT",warehouse_id:wt.warehouse_id||"",price_type:wt.price_type||"RETAIL",payment_type:wt.payment_type||"CASH",currency_id:wt.currency_id??pt.currency_id??"",exchange_rate:wt.exchange_rate||1,sales_person_id:wt.sales_person_id||"",payment_terms:wt.payment_terms||"",priority:wt.priority||"MEDIUM",shipping_charges:wt.shipping_charges||0,delivery_time:wt.delivery_time||"",internal_notes:wt.internal_notes||"",customer_notes:wt.customer_notes||"",remarks:wt.remarks||""})),(Xe=xt.data)!=null&&Xe.details)){let pt=xt.data.details.map((rt,ht)=>{var St;const ft=L({qty:rt.qty??rt.quantity??0,unit_price:rt.unit_price??0,discount_percent:rt.discount_percent??0,tax_type:rt.tax_id??((St=Q==null?void 0:Q[0])==null?void 0:St.value)??""});return{...rt,line_id:ht+1,...ft}});const ge=wt.warehouse_id||h.warehouse_id||"";ge&&(pt=await Promise.all(pt.map(async ht=>({...ht,available_qty:await ae(ge,ht.item_id)})))),g(pt)}}catch(xt){d(((at=(Ge=xt==null?void 0:xt.response)==null?void 0:Ge.data)==null?void 0:at.message)||"Error fetching order"),console.error("Error fetching order:",xt)}finally{o(!1)}},pe=async Ne=>{const Xe=Ne.target.value;if(f(Ge=>({...Ge,quotation_id:Xe})),!!Xe)try{o(!0);const Ge=await te.get(`/sales/quotations/${Xe}`),{item:at,details:xt}=Ge.data;if(at&&f(wt=>({...wt,customer_id:at.customer_id||"",currency_id:at.currency_id||wt.currency_id||"",exchange_rate:at.exchange_rate||wt.exchange_rate||1,remarks:at.remarks||"",payment_terms:at.terms_and_conditions||wt.payment_terms||"",price_type:at.price_type||wt.price_type||"RETAIL",payment_type:at.payment_type||wt.payment_type||"CASH",warehouse_id:at.warehouse_id||wt.warehouse_id||""})),xt&&Array.isArray(xt)){const wt=xt.map((pt,ge)=>{var fe,Oe;const rt=N.find(Se=>Se.id==pt.item_id),ht=pt.qty??pt.quantity??0,ft=pt.unit_price??0,St=J(pt.tax_id??((fe=Q==null?void 0:Q[0])==null?void 0:fe.value)??""),Je=L({qty:ht,unit_price:ft,discount_percent:pt.discount_percent??0,tax_type:St}),ts=pt.tax_amount!==void 0&&pt.tax_amount!==null?Number(pt.tax_amount):Je.taxAmt,Kt=pt.total_amount!==void 0&&pt.total_amount!==null?Number(pt.total_amount):Je.total;return{item_id:pt.item_id,item_name:(rt==null?void 0:rt.item_name)||pt.item_name||"Item "+pt.item_id,qty:ht,unit_price:ft,discount_percent:pt.discount_percent??0,tax_type:St,tax_rate:pt.tax_rate!==void 0&&pt.tax_rate!==null?Number(pt.tax_rate):(Oe=Q.find(Se=>String(Se.value)===String(St)))==null?void 0:Oe.rate,remarks:pt.remarks||"",line_id:Date.now()+ge,...Je,taxAmt:ts,total:Kt}});g(wt)}}catch(Ge){console.error("Error fetching quotation details:",Ge),alert("Failed to load quotation details")}finally{o(!1)}},he=Ne=>{const{name:Xe,value:Ge}=Ne.target;if(Xe==="customer_id"){const at=b.find(xt=>String(xt.id)===String(Ge));f(xt=>({...xt,customer_id:Ge,city:(at==null?void 0:at.city)||"",state:(at==null?void 0:at.state)||"",country:(at==null?void 0:at.country)||"",phone:(at==null?void 0:at.phone)||(at==null?void 0:at.customer_phone)||""}));return}f(at=>({...at,[Xe]:Ge}))},je=Ne=>{const{name:Xe,value:Ge}=Ne.target;if(Xe==="item_id"){const at=N.find(xt=>xt.id===parseInt(Ge));if(_(xt=>({...xt,item_id:Ge,item_name:(at==null?void 0:at.item_name)||"",unit_price:(at==null?void 0:at.selling_price)||"",qty:1})),Ge){h.customer_id&&te.post("/sales/prices/best-price",{product_id:Ge,customer_id:h.customer_id,quantity:1,date:h.order_date,price_type:typeof h.price_type=="string"?h.price_type:String(h.price_type||""),only_standard:!0}).then(wt=>{wt.data&&wt.data.price!==void 0&&_(pt=>({...pt,unit_price:wt.data.price}))}).catch(wt=>console.error("Error fetching price:",wt)),te.get(`/finance/item-tax/${Ge}`).then(wt=>{var ge,rt,ht;const pt=(ge=wt.data)==null?void 0:ge.tax;if(pt){const ft=pt.id||((rt=Q.find(Je=>Je.code===pt.tax_code))==null?void 0:rt.value)||null,St=ft?(ht=Q.find(Je=>String(Je.value)===String(ft)))==null?void 0:ht.rate:null;_(Je=>({...Je,tax_type:ft??Je.tax_type,tax_rate:St??pt.tax_rate}))}else _(ft=>({...ft,tax_rate:void 0}))}).catch(()=>{_(wt=>({...wt,tax_rate:void 0}))});const xt=h.warehouse_id;xt?ae(xt,Number(Ge)).then(wt=>_(pt=>({...pt,available_qty:wt}))):_(wt=>({...wt,available_qty:void 0}))}}else _(at=>({...at,[Xe]:Ge}))},me=()=>{if(!K.item_id||!K.qty||!K.unit_price){alert("Please fill all required item fields");return}if(h.warehouse_id&&K.available_qty!==void 0&&Number(K.qty||0)>Number(K.available_qty||0)){alert("Quantity exceeds available stock for selected warehouse");return}const Ne=J(K.tax_type)??(Q.length>0?Q[0].value:null),Xe=L({...K,tax_type:Ne});g([...x,{...K,tax_type:Ne,line_id:Date.now(),...Xe,available_qty:K.available_qty}]),_({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:Q.length>0?Q[0].value:"",tax_rate:void 0,remarks:"",available_qty:void 0})},xe=Ne=>{g(x.filter(Xe=>Xe.line_id!==Ne))},Ue=async()=>{var Ne,Xe;if(H!==null)return H;try{const Ge=await te.get("/admin/document-templates/SALES_ORDER"),at=String(((Xe=(Ne=Ge.data)==null?void 0:Ne.item)==null?void 0:Xe.template_html)||"").trim();return W(at),at}catch{return W(""),""}},ct=()=>{var wt;const Ne=String(Y.logoUrl||"").trim(),Xe=Ne?`<img src="${Ne}" alt="${v4(Y.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",Ge=b.find(pt=>String(pt.id)===String(h.customer_id)),at=Qe(),xt=(Array.isArray(x)?x:[]).map(pt=>{const ge=Number(pt.qty||0),rt=Number(pt.unit_price||0),ht=Number(pt.total||ge*rt);return{item_name:String(pt.item_name||""),qty:ge.toFixed(2),unit_price:rt.toFixed(2),total:ht.toFixed(2)}});return{company:{name:Y.name||"Company",address:Y.address||"",city:Y.city||"",state:Y.state||"",postalCode:Y.postalCode||"",country:Y.country||"",phone:Y.phone||"",email:Y.email||"",website:Y.website||"",taxId:Y.taxId||"",registrationNo:Y.registrationNo||"",logoUrl:Ne,logoHtml:Xe},salesOrder:{order_no:String(h.order_no||""),order_date:String(h.order_date||""),status:String(h.status||""),currency:String(((wt=B.find(pt=>String(pt.id)===String(h.currency_id)))==null?void 0:wt.code)||""),payment_type:String(h.payment_type||""),price_type:String(h.price_type||""),prepared_by:String(X||"")},customer:{id:String((Ge==null?void 0:Ge.id)||""),code:String((Ge==null?void 0:Ge.customer_code)||""),name:String((Ge==null?void 0:Ge.customer_name)||""),type:String((Ge==null?void 0:Ge.customer_type)||""),contactPerson:String((Ge==null?void 0:Ge.contact_person)||""),email:String((Ge==null?void 0:Ge.email)||""),phone:String((Ge==null?void 0:Ge.phone)||h.phone||""),mobile:String((Ge==null?void 0:Ge.mobile)||""),address:String((Ge==null?void 0:Ge.address)||""),city:String((Ge==null?void 0:Ge.city)||h.city||""),state:String((Ge==null?void 0:Ge.state)||h.state||""),zone:String((Ge==null?void 0:Ge.zone)||""),country:String((Ge==null?void 0:Ge.country)||h.country||""),paymentTerms:String((Ge==null?void 0:Ge.payment_terms)||""),creditLimit:Number((Ge==null?void 0:Ge.credit_limit)||0).toFixed(2)},items:xt,totals:{subtotal:Number(at.grossSub||0).toFixed(2),discount:Number(at.discountTotal||0).toFixed(2),tax:Number(at.taxTotal||0).toFixed(2),total:Number(at.grand||0).toFixed(2)}}},dt=async()=>{var ge;const Ne=await Ue();if(!Ne)return!1;await le();const Xe=ct(),Ge=OO(xy(Ne,Xe)),at=document.createElement("iframe");at.style.position="fixed",at.style.right="0",at.style.bottom="0",at.style.width="0",at.style.height="0",at.style.border="0",document.body.appendChild(at);const xt=((ge=at.contentWindow)==null?void 0:ge.document)||at.contentDocument||null;if(!xt)return document.body.removeChild(at),!0;xt.open(),xt.write(Ge),xt.close();const wt=at.contentWindow||window;return setTimeout(()=>{wt.focus();try{wt.print()}catch{}setTimeout(()=>{document.body.removeChild(at)},100)},200),!0},We=async()=>{const Ne=await Ue();if(!Ne)return!1;await le();const Xe=ct(),Ge=xy(Ne,Xe),at=document.createElement("div");at.style.position="fixed",at.style.left="-10000px",at.style.top="0",at.style.width="794px",at.style.background="white",at.style.padding="32px",at.innerHTML=Ge,document.body.appendChild(at);try{await QO(at);const xt=await Wn(at,{scale:2,useCORS:!0}),wt=xt.toDataURL("image/png"),pt=new As("p","mm","a4"),ge=pt.internal.pageSize.getWidth(),rt=pt.internal.pageSize.getHeight(),ht=ge,ft=xt.height*ht/xt.width;let St=0;for(;St<ft;)pt.addImage(wt,"PNG",0,-St,ht,ft),St+=rt,St<ft&&pt.addPage();const Je="SalesOrder_"+(h.order_no||new Date().toISOString().slice(0,10))+".pdf";pt.save(Je)}finally{document.body.removeChild(at)}return!0};v.useEffect(()=>{const Ne=h.warehouse_id;if(!Ne){g(Xe=>Xe.map(Ge=>({...Ge,available_qty:void 0}))),_(Xe=>({...Xe,available_qty:void 0}));return}(async()=>{const Xe=await Promise.all(x.map(async Ge=>({...Ge,available_qty:await ae(Ne,Ge.item_id)})));if(g(Xe),K.item_id){const Ge=await ae(Ne,Number(K.item_id));_(at=>({...at,available_qty:Ge}))}})()},[h.warehouse_id]);const He=async()=>{try{if(await dt())return}catch{}le().finally(()=>window.print())},ze=async()=>{if(await We())return;await le();const Ne=T.current;if(!Ne)return;const Xe=Ne.style.cssText;Ne.style.cssText=Xe+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const Ge=await Wn(Ne,{scale:2,useCORS:!0}),at=Ge.toDataURL("image/png"),xt=new As("p","mm","a4"),wt=xt.internal.pageSize.getWidth(),pt=xt.internal.pageSize.getHeight(),ge=wt,rt=Ge.height*ge/Ge.width;let ht=0;for(;ht<rt;)xt.addImage(at,"PNG",0,-ht,ge,rt),ht+=pt,ht<rt&&xt.addPage();const ft="SalesOrder_"+(h.order_no||new Date().toISOString().slice(0,10))+".pdf";xt.save(ft)}finally{Ne.style.cssText=Xe}},Pe=async Ne=>{var at,xt;if(Ne.preventDefault(),!h.customer_id||x.length===0){alert("Please select a customer and add at least one item");return}o(!0);const Xe=U();let Ge=h.order_no;if(!Ge){const wt=new Date().toISOString().slice(0,10).replace(/-/g,""),pt=Math.floor(Math.random()*1e3).toString().padStart(3,"0");Ge=`SO-${wt}-${pt}`}try{const wt={...h,order_no:Ge,customer_id:Number(h.customer_id),quotation_id:h.quotation_id?Number(h.quotation_id):null,total_amount:Xe.total,sub_total:Xe.sub,tax_amount:Xe.tax,items:x.map(pt=>{const ge=J(pt.tax_type),rt=Q.find(ht=>String(ht.value)===String(ge));return{item_id:pt.item_id,quantity:Number(pt.qty),unit_price:Number(pt.unit_price),discount_percent:Number(pt.discount_percent),tax_id:ge,tax_rate:rt?rt.rate:Number(pt.tax_rate||0)||0,tax_amount:pt.taxAmt,total_amount:pt.total,net_amount:pt.net}})};r?await te.put(`/sales/orders/${s}`,wt):await te.post("/sales/orders",wt),alert(r?"Order updated successfully!":"Order created successfully!"),t("/sales/sales-orders")}catch(wt){console.error("Error saving order:",wt);const pt=((xt=(at=wt.response)==null?void 0:at.data)==null?void 0:xt.message)||wt.message||"Unknown error";alert(`Error saving order: ${pt}`)}finally{o(!1)}},Te=String(h.status||"").toUpperCase()==="CONFIRMED",Ke=i&&Te;return e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden my-6 print:shadow-none print:my-0 print:w-full print:max-w-none",children:[e.jsx("style",{children:`
        @media print {
          @page { margin: 1cm; }
          body { 
            background: white; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          #root > div > header,
          #root > div > div > aside { display: none !important; }
          .print\\:hidden { display: none !important; }
          .print\\:block { display: block !important; }
          #root > div > div > main { padding: 0 !important; }
          input, select, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            resize: none;
            overflow: visible;
          }
        }
        .quotation-table { 
          border-collapse: collapse; 
          table-layout: fixed; 
          width: 100%; 
          max-width: 100%; 
          border-spacing: 0; 
          box-sizing: border-box;
          margin: 0 auto;
        }
        .view-mode input, .view-mode select, .view-mode textarea {
          background-color: #eff6ff !important;
        }
        .quotation-table th, .quotation-table td { 
          border: 1px solid #000000; 
          box-sizing: border-box; 
          word-break: break-word; 
          overflow-wrap: anywhere; 
          white-space: normal; 
          padding: 6px 4px;
          font-size: 10px;
        }
        .quotation-table td {
          overflow: visible;
        }
        .quotation-table thead th { 
          background: #0E3646; 
          color: #ffffff; 
        }
        .quotation-table thead th:last-child,
        .quotation-table tbody td:last-child {
          background: #ffffff;
          color: #000000;
        }
        .quotation-table thead th:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        .quotation-table tbody td:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        @media print {
          .quotation-table {
            width: 100%;
            max-width: 100%;
          }
          .quotation-table thead th:last-child,
          .quotation-table tbody td:last-child {
            background: #ffffff !important;
            color: #000000 !important;
          }
          .quotation-table thead th:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
          .quotation-table tbody td:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
        }
      `}),e.jsx("div",{className:"p-6 border-b text-white print:hidden",style:{backgroundColor:"#0E3646"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:[r?"Edit":"New"," Sales Order"]}),e.jsx("p",{className:"text-sm opacity-80",children:r?"Update order details":"Create a new sales order"})]}),e.jsxs("div",{className:"flex gap-4 print:hidden items-center",children:[e.jsxs("button",{onClick:ze,className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-lg transition-colors text-sm font-medium border border-white/20",children:[e.jsx(gu,{className:"w-4 h-4"}),"Download PDF"]}),e.jsx("button",{onClick:He,className:"text-white hover:text-gray-200",children:e.jsx(Mh,{className:"w-6 h-6"})}),e.jsx(Ee,{to:"/sales/sales-orders",className:"text-white hover:text-gray-200",children:e.jsx(If,{className:"w-6 h-6"})})]})]})}),e.jsx("div",{className:"p-6 print:hidden",children:e.jsxs("form",{onSubmit:Pe,children:[e.jsx("div",{className:"flex gap-4 border-b mb-6 print:hidden",children:e.jsx("button",{type:"button",onClick:()=>m("details"),className:`pb-2 px-4 font-medium transition-colors ${c==="details"?"border-b-2 border-[#0E3646] text-[#0E3646]":"text-gray-500 hover:text-gray-700"}`,children:"Order Details"})}),e.jsx("fieldset",{disabled:Ke,className:i?"view-mode":"",children:e.jsxs("div",{className:"block",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order #"}),e.jsx("input",{type:"text",name:"order_no",value:h.order_no,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Auto-generated",readOnly:!r&&!h.order_no})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"order_date",value:h.order_date,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),e.jsxs("select",{name:"customer_id",value:h.customer_id,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0,children:[e.jsx("option",{value:"",children:"Select Customer"}),b.map(Ne=>e.jsx("option",{value:Ne.id,children:Ne.customer_name},Ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:h.warehouse_id,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),P.map(Ne=>e.jsx("option",{value:Ne.id,children:Ne.warehouse_name},Ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quotation Ref"}),e.jsxs("select",{name:"quotation_id",value:h.quotation_id,onChange:pe,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Quotation"}),S.map(Ne=>e.jsxs("option",{value:Ne.id,children:[Ne.quotation_no," - ",Ne.customer_name]},Ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{name:"status",value:h.status,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:F.map(Ne=>e.jsx("option",{value:Ne.value,children:Ne.label},Ne.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{name:"priority",value:h.priority,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:E.map(Ne=>e.jsx("option",{value:Ne.value,children:Ne.label},Ne.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Type"}),e.jsxs("select",{name:"price_type",value:h.price_type,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"RETAIL",children:"Retail"}),e.jsx("option",{value:"WHOLESALE",children:"Wholesale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),e.jsxs("select",{name:"payment_type",value:h.payment_type,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"}),e.jsx("option",{value:"CREDIT",children:"Credit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),e.jsx("select",{name:"currency_id",value:h.currency_id,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:B.map(Ne=>e.jsxs("option",{value:Ne.id,children:[Ne.code||Ne.currency_code," -"," ",Ne.name||Ne.currency_name]},Ne.id))})]})]}),e.jsxs("div",{className:"border-t pt-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Order Items"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200 print:hidden",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 mb-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Item *"}),e.jsxs("select",{name:"item_id",value:K.item_id,onChange:je,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Item"}),N.map(Ne=>e.jsxs("option",{value:Ne.id,children:[Ne.item_code," - ",Ne.item_name]},Ne.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),e.jsx("input",{type:"number",name:"qty",value:K.qty,onChange:je,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Available"}),e.jsx("input",{type:"text",value:h.warehouse_id?Number(K.available_qty||0).toFixed(2):"",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",name:"unit_price",value:K.unit_price,onChange:je,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Disc %"}),e.jsx("input",{type:"number",name:"discount_percent",value:K.discount_percent,onChange:je,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"0",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),e.jsx("select",{name:"tax_type",value:K.tax_type,onChange:je,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:Q.map(Ne=>e.jsx("option",{value:Ne.value,children:Ne.label},Ne.value))}),K.tax_rate!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Tax rate: ",Number(K.tax_rate).toFixed(2),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:me,className:"bg-[#0E3646] text-white px-4 py-2 rounded-lg hover:bg-[#092530] flex items-center gap-2 transition-colors text-sm",children:[e.jsx(vu,{className:"w-4 h-4"})," Add Item"]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Available"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Disc%"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider print:hidden",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No items added yet"})}):x.map(Ne=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ne.item_name}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ne.qty}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:h.warehouse_id?Number(Ne.available_qty||0).toFixed(2):""}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(Ne.unit_price).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(Ne.discount_percent||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ne.net.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ne.taxAmt.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:Ne.total.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 print:hidden",children:e.jsx("button",{type:"button",onClick:()=>xe(Ne.line_id),className:"text-red-600 hover:text-red-900 transition-colors",children:e.jsx(Gl,{className:"w-4 h-4"})})})]},Ne.line_id))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Totals:"}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:U().sub.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:U().tax.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:U().total.toFixed(2)}),e.jsx("td",{className:"print:hidden"})]})})]})})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t print:hidden",children:[e.jsx(Ee,{to:"/sales/sales-orders",className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-[#0E3646] text-white rounded-lg hover:bg-[#092530] font-medium transition-colors flex items-center gap-2",children:l?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Hh,{className:"w-4 h-4"}),r?"Update Order":"Create Order"]})})]})]})}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Y.logoUrl||Gs,alt:Y.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:Y.name||"Company"}),Y.address&&e.jsx("div",{children:Y.address}),(Y.city||Y.state||Y.country)&&e.jsx("div",{children:[Y.city,Y.state,Y.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[Y.phone&&e.jsx("span",{children:Y.phone}),Y.email&&e.jsx("span",{children:Y.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Sales Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",h.order_date||""]}),e.jsxs("div",{children:["Order #: ",h.order_no||""]}),e.jsxs("div",{children:["Customer:"," ",(($e=b.find(Ne=>String(Ne.id)===String(h.customer_id)))==null?void 0:$e.customer_name)||""]}),e.jsxs("div",{children:["City: ",h.city||""]}),e.jsxs("div",{children:["State: ",h.state||""]}),e.jsxs("div",{children:["Country: ",h.country||""]}),e.jsxs("div",{children:["Phone: ",h.phone||""]}),e.jsxs("div",{children:["Price Type: ",h.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",h.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((Ve=B.find(Ne=>String(Ne.id)===String(h.currency_id)))==null?void 0:Ve.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((Ze=P.find(Ne=>String(Ne.id)===String(h.warehouse_id)))==null?void 0:Ze.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",X||""]})]})]}),e.jsx("div",{className:"mb-2 mx-auto",children:e.jsxs("table",{className:"quotation-table text-sm",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:x.map(Ne=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ne.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ne.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ne.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ne.total||0).toFixed(2)})]},Ne.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Qe().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Qe().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Qe().netSub.toFixed(2)}),Qe().components.map(Ne=>e.jsxs(Os.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[Ne.name," [",Ne.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ne.amount.toFixed(2)})]},Ne.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Qe().grand.toFixed(2)})]})})})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]}),e.jsxs("div",{ref:T,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:Y.logoUrl||Gs,alt:Y.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:Y.name||"Company"}),Y.address&&e.jsx("div",{children:Y.address}),(Y.city||Y.state||Y.country)&&e.jsx("div",{children:[Y.city,Y.state,Y.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[Y.phone&&e.jsx("span",{children:Y.phone}),Y.email&&e.jsx("span",{children:Y.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Sales Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",h.order_date||""]}),e.jsxs("div",{children:["Order #: ",h.order_no||""]}),e.jsxs("div",{children:["Customer:"," ",((Re=b.find(Ne=>String(Ne.id)===String(h.customer_id)))==null?void 0:Re.customer_name)||""]}),e.jsxs("div",{children:["City: ",h.city||""]}),e.jsxs("div",{children:["State: ",h.state||""]}),e.jsxs("div",{children:["Country: ",h.country||""]}),e.jsxs("div",{children:["Phone: ",h.phone||""]}),e.jsxs("div",{children:["Price Type: ",h.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",h.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((it=B.find(Ne=>String(Ne.id)===String(h.currency_id)))==null?void 0:it.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((lt=P.find(Ne=>String(Ne.id)===String(h.warehouse_id)))==null?void 0:lt.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",X||""]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"quotation-table text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:x.map(Ne=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ne.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ne.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ne.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ne.total||0).toFixed(2)})]},Ne.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Gross Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Qe().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Qe().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Qe().netSub.toFixed(2)}),Qe().components.map(Ne=>e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"px-2 py-1",children:[Ne.name," [",Ne.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ne.amount.toFixed(2)})]},Ne.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Qe().grand.toFixed(2)})]})})})]})]})]})}function MO(){const t=Ns(),[s,r]=v.useState([]),[a,n]=v.useState([]),[i,l]=v.useState([]),[o,u]=v.useState(!0),[d,c]=v.useState(""),[m,h]=v.useState(""),[f,x]=v.useState("ALL"),[g,b]=v.useState(null),[y,N]=v.useState({name:"",address:"",city:"",state:"",country:"",postalCode:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[j,S]=v.useState(null);v.useEffect(()=>{k()},[]);const k=async()=>{var R,H,W,K,_;try{u(!0),c("");const[F,E,L]=await Promise.all([te.get("/sales/invoices"),te.get("/finance/currencies"),te.get("/inventory/warehouses")]);r(Array.isArray((R=F.data)==null?void 0:R.items)?F.data.items:[]),n(Array.isArray((H=E.data)==null?void 0:H.items)?E.data.items:[]),l(Array.isArray((W=L.data)==null?void 0:W.items)?L.data.items:[])}catch(F){c(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Error fetching invoices"),console.error("Error fetching invoices:",F)}finally{u(!1)}};v.useEffect(()=>{let R=!0;async function H(){var W,K,_;try{const E=(K=(W=(await te.get("/admin/me")).data)==null?void 0:W.scope)==null?void 0:K.companyId;if(!E)return void 0;const U=((_=(await te.get(`/admin/companies/${E}`)).data)==null?void 0:_.item)||{};if(!R)return;N(J=>({...J,name:U.name||J.name||"",address:U.address||J.address||"",city:U.city||J.city||"",state:U.state||J.state||"",country:U.country||J.country||"",postalCode:U.postal_code||J.postalCode||"",phone:U.telephone||J.phone||"",email:U.email||J.email||"",website:U.website||J.website||"",taxId:U.tax_id||J.taxId||"",registrationNo:U.registration_no||J.registrationNo||"",logoUrl:U.has_logo===1||U.has_logo===!0?`/api/admin/companies/${E}/logo`:J.logoUrl||""}))}catch{}}return H(),()=>{R=!1}},[]);function P(R){return String(R??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function I(R,H){const W=String(H||"").trim().replace(/^\./,"");if(!W)return;const K=W.split(".").filter(Boolean);let _=R;for(const F of K){if(_==null)return;_=_[F]}return _}function B(R,H,W=H){let K=String(R??"");return K=K.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(_,F,E)=>{const L=String(F||"").trim(),U=L.startsWith("@root.")?I(W,L.slice(6)):I(H,L)??I(W,L);return(Array.isArray(U)?U:[]).map(ae=>B(E,ae??{},W)).join("")}),K=K.replace(/{{{\s*([^}]+?)\s*}}}/g,(_,F)=>{const E=String(F||"").trim();let L;return E==="this"||E==="."?L=H:E.startsWith("@root.")?L=I(W,E.slice(6)):L=I(H,E)??I(W,E),String(L??"")}),K=K.replace(/{{\s*([^}]+?)\s*}}/g,(_,F)=>{const E=String(F||"").trim();let L;return E==="this"||E==="."?L=H:E.startsWith("@root.")?L=I(W,E.slice(6)):L=I(H,E)??I(W,E),P(L)}),K}function q(R){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Invoice</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${R||""}</body>
</html>`}async function Q(R){var W;const H=Array.from(((W=R==null?void 0:R.querySelectorAll)==null?void 0:W.call(R,"img"))||[]);H.length&&await Promise.all(H.map(K=>new Promise(_=>{if(K.complete)return _();const F=()=>_();K.addEventListener("load",F,{once:!0}),K.addEventListener("error",F,{once:!0})})))}const O=async()=>{var R,H;if(j!==null)return j;try{const W=await te.get("/admin/document-templates/INVOICE"),K=String(((H=(R=W.data)==null?void 0:R.item)==null?void 0:H.template_html)||"").trim();return S(K),K}catch{return S(""),""}},T=(R,H)=>{var _;const W=(Array.isArray(H)?H:[]).map(F=>{const E=Number(F.quantity||F.qty||0),L=Number(F.unit_price||0),U=Number(F.discount_percent||0),J=Number(F.total_amount||E*L),ae=Number(F.net_amount||J-E*L*U/100);return{item_name:String(F.item_name||""),qty:E.toFixed(2),unit_price:L.toFixed(2),total:J.toFixed(2),discount:Number(U||0).toFixed(2),net:ae.toFixed(2)}}),K=((_=a.find(F=>String(F.id)===String(R.currency_id)))==null?void 0:_.code)||"";return{company:{name:y.name||"Company",address:y.address||"",city:y.city||"",state:y.state||"",postalCode:y.postalCode||"",country:y.country||"",phone:y.phone||"",email:y.email||"",website:y.website||"",taxId:y.taxId||"",registrationNo:y.registrationNo||"",logoUrl:String(y.logoUrl||""),logoHtml:String(y.logoUrl||"")?`<img src="${String(y.logoUrl||"")}" alt="${P(y.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:""},invoice:{invoice_no:String(R.invoice_no||""),invoice_date:R.invoice_date?String(R.invoice_date).slice(0,10):"",due_date:String(R.due_date||""),payment_type:String(R.payment_type||""),price_type:String(R.price_type||""),currency:String(K||""),prepared_by:""},customer:{id:String(R.customer_id||""),code:"",name:String(R.customer_name||""),type:"",contactPerson:"",email:"",phone:String(R.phone||""),mobile:"",address:String(R.address||""),city:String(R.city||""),state:String(R.state||""),zone:"",country:String(R.country||""),paymentTerms:"",creditLimit:"0.00"},items:W,totals:{subtotal:Number(W.reduce((F,E)=>F+Number(E.total||0),0)).toFixed(2),discount:Number(W.reduce((F,E)=>F+Number(E.discount||0),0)).toFixed(2),netSubtotal:Number(W.reduce((F,E)=>F+Number(E.net||0),0)).toFixed(2),tax:"0.00",total:Number(R.net_amount||R.total_amount||0).toFixed(2)}}};async function V(R){var H,W,K,_,F;try{const E=await O();if(!E)return;const L=await te.get(`/sales/invoices/${R}`),U=((H=L.data)==null?void 0:H.item)||{},J=Array.isArray((W=L.data)==null?void 0:W.details)?L.data.details:[],ae=q(B(E,T(U,J))),Z=document.createElement("iframe");Z.style.position="fixed",Z.style.right="0",Z.style.bottom="0",Z.style.width="0",Z.style.height="0",Z.style.border="0",document.body.appendChild(Z);const oe=((K=Z.contentWindow)==null?void 0:K.document)||Z.contentDocument||null;if(!oe){document.body.removeChild(Z);return}oe.open(),oe.write(ae),oe.close();const ee=Z.contentWindow||window;setTimeout(()=>{ee.focus();try{ee.print()}catch{}setTimeout(()=>{document.body.removeChild(Z)},100)},200)}catch(E){mt.error(((F=(_=E==null?void 0:E.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to print invoice")}}async function D(R){var H,W,K,_;try{const F=await O();if(!F)return;const E=await te.get(`/sales/invoices/${R}`),L=((H=E.data)==null?void 0:H.item)||{},U=Array.isArray((W=E.data)==null?void 0:W.details)?E.data.details:[],J=B(F,T(L,U)),ae=document.createElement("div");ae.style.position="fixed",ae.style.left="-10000px",ae.style.top="0",ae.style.width="794px",ae.style.background="white",ae.style.padding="32px",ae.innerHTML=J,document.body.appendChild(ae);try{await Q(ae);const Z=await Wn(ae,{scale:2,useCORS:!0}),oe=Z.toDataURL("image/png"),ee=new As("p","mm","a4"),se=ee.internal.pageSize.getWidth(),Ae=ee.internal.pageSize.getHeight(),we=se,ce=Z.height*we/Z.width;let le=0;for(;le<ce;)ee.addImage(oe,"PNG",0,-le,we,ce),le+=Ae,le<ce&&ee.addPage();const _e="Invoice_"+(String(L.invoice_no||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";ee.save(_e)}finally{document.body.removeChild(ae)}}catch(F){mt.error(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to download invoice")}}const Y=R=>{const H={DRAFT:"badge badge-warning",POSTED:"badge badge-success",CANCELLED:"badge badge-error"};return e.jsx("span",{className:H[R]||"badge",children:R})},M=R=>{const H={UNPAID:"badge badge-error",PARTIALLY_PAID:"badge badge-warning",PAID:"badge badge-success"},W=String(R||"").trim()||"UNPAID";return e.jsx("span",{className:H[W]||"badge",children:W})},X=s.filter(R=>{const H=R.invoice_no.toLowerCase().includes(m.toLowerCase())||R.customer_name.toLowerCase().includes(m.toLowerCase()),W=f==="ALL"||R.status===f;return H&&W});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Invoices"}),e.jsx("p",{className:"text-sm mt-1",children:"Generate and manage customer invoices"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/sales/invoices/new",className:"btn-success",children:"+ New Invoice"})]})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by invoice number or customer...",className:"input",value:m,onChange:R=>h(R.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:f,onChange:R=>x(R.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]}),o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading invoices..."})]}):X.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No invoices found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Net Amount"}),e.jsx("th",{children:"Actions"}),e.jsx("th",{children:"Payment Type"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{className:"text-right",children:"Balance"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:X.map(R=>{var H;return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:R.invoice_no}),e.jsx("td",{children:new Date(R.invoice_date).toLocaleDateString()}),e.jsx("td",{children:R.customer_name}),e.jsx("td",{children:M(R.payment_status)}),e.jsx("td",{children:Y(R.status)}),e.jsx("td",{className:"font-semibold",children:R.net_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/sales/invoices/${R.id}?mode=view`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),R.status!=="POSTED"&&e.jsx("button",{onClick:()=>t(`/sales/invoices/${R.id}`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>V(R.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",children:"Print"}),e.jsx("button",{onClick:()=>D(R.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",children:"PDF"})]})}),e.jsx("td",{children:R.payment_type||""}),e.jsx("td",{children:R.price_type||""}),e.jsx("td",{children:((H=i.find(W=>String(W.id)===String(R.warehouse_id)))==null?void 0:H.warehouse_name)||""}),e.jsx("td",{className:"text-right",children:Number(R.balance_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:R.remarks||""})]},R.id)})})]})})]})})]})}function HO(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Hc(t,s){const r=String(s||"").trim().replace(/^\./,"");if(!r)return;const a=r.split(".").filter(Boolean);let n=t;for(const i of a){if(n==null)return;n=n[i]}return n}function gy(t,s,r=s){let a=String(t??"");return a=a.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(n,i,l)=>{const o=String(i||"").trim(),u=o.startsWith("@root.")?Hc(r,o.slice(6)):Hc(s,o)??Hc(r,o);return(Array.isArray(u)?u:[]).map(c=>gy(l,c??{},r)).join("")}),a=a.replace(/{{{\s*([^}]+?)\s*}}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Hc(r,l.slice(6)):o=Hc(s,l)??Hc(r,l),String(o??"")}),a=a.replace(/{{\s*([^}]+?)\s*}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Hc(r,l.slice(6)):o=Hc(s,l)??Hc(r,l),HO(o)}),a}function qO(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Invoice</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; color: #0f172a; background: #fff; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
      .right { text-align: right; }
      .center { text-align: center; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}async function VO(t){const s=Array.from(t.querySelectorAll("img"));s.length&&await Promise.all(s.map(r=>new Promise(a=>{if(r.complete)return a();const n=()=>a();r.addEventListener("load",n,{once:!0}),r.addEventListener("error",n,{once:!0})})))}function I2(){var Xe,Ge,at,xt,wt,pt;const t=Ns(),{id:s}=Ps(),r=!!s,{user:a}=Qa(),{search:n}=Ba(),i=new URLSearchParams(n),l=i.get("action"),u=i.get("mode")==="view",d=!u,[c,m]=v.useState(!1),[h,f]=v.useState(""),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState([]),[S,k]=v.useState([]),[P,I]=v.useState([]),[B,q]=v.useState([]),[Q,O]=v.useState({invoice_no:"",invoice_date:new Date().toISOString().split("T")[0],customer_id:"",sales_order_id:"",status:"POSTED",warehouse_id:"",price_type:"RETAIL",payment_type:"CASH",currency_id:"",exchange_rate:1,city:"",state:"",country:"",phone:"",remarks:""}),[T,V]=v.useState([]),[D,Y]=v.useState({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:"",tax_type:"",tax_rate:void 0,remarks:""}),M=v.useRef(null),[X,R]=v.useState({}),[H,W]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",postalCode:"",country:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[K,_]=v.useState(""),[F,E]=v.useState([]),[L,U]=v.useState(null),J=ge=>!ge||typeof ge!="string"?ge:ge.startsWith("INV")&&ge.length===9&&/^\d{6}$/.test(ge.substring(3))?`INV-${ge.substring(3)}`:ge,ae=async(ge,rt)=>{var ht;if(!ge||!rt)return 0;try{const ft=await te.get(`/inventory/stock/available?warehouse_id=${ge}&item_id=${rt}`);return Number(((ht=ft.data)==null?void 0:ht.qty)||0)}catch{return 0}};v.useEffect(()=>{if(Z(),oe(),ee(),se(),Ae(),we(),xe(),r)Ue();else{const ge=it(Q.invoice_date,Q.payment_terms);O(rt=>({...rt,due_date:ge})),te.get("/sales/invoices/next-no").then(rt=>{var ft;const ht=(ft=rt.data)==null?void 0:ft.nextNo;ht&&O(St=>({...St,invoice_no:J(ht)}))}).catch(()=>{O(rt=>({...rt,invoice_no:rt.invoice_no||"INV-000001"}))})}},[r,s]),v.useEffect(()=>{r&&ee()},[Q.sales_order_id]),v.useEffect(()=>{(async()=>{if(r){if(l==="print"){try{await _e()}catch{}setTimeout(()=>window.print(),200)}else if(l==="pdf"){const rt=M.current;if(!rt)return;const ht=rt.style.cssText;rt.style.cssText=ht+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const ft=await Wn(rt,{scale:2,useCORS:!0}),St=ft.toDataURL("image/png"),Je=new As("p","mm","a4"),ts=Je.internal.pageSize.getWidth(),Kt=Je.internal.pageSize.getHeight(),fe=ts,Oe=ft.height*fe/ft.width;let Se=0;for(;Se<Oe;)Je.addImage(St,"PNG",0,-Se,fe,Oe),Se+=Kt,Se<Oe&&Je.addPage();const Le="Invoice_"+(Q.invoice_no||new Date().toISOString().slice(0,10))+".pdf";Je.save(Le)}finally{rt.style.cssText=ht}}}})()},[l,r]);const Z=async()=>{var ge;try{const rt=await te.get("/sales/customers");g(Array.isArray((ge=rt.data)==null?void 0:ge.items)?rt.data.items:[])}catch(rt){console.error("Error fetching customers:",rt)}},oe=async()=>{var ge,rt,ht,ft;try{const[St,Je]=await Promise.allSettled([te.get("/inventory/items"),te.get("/sales/prices/standard")]),ts=St.status==="fulfilled"&&Array.isArray((rt=(ge=St.value)==null?void 0:ge.data)==null?void 0:rt.items)?St.value.data.items:[],Kt=Je.status==="fulfilled"&&Array.isArray((ft=(ht=Je.value)==null?void 0:ht.data)==null?void 0:ft.items)?Je.value.data.items:[],fe=new Map;for(const Se of Kt){const Le=Se.product_id;Le&&(fe.has(Le)||fe.set(Le,Se))}const Oe=ts.map(Se=>{const Le=fe.get(Se.id),Ye=Le&&Le.selling_price!==void 0&&Le.selling_price!==null?Number(Le.selling_price):Se.selling_price;return{...Se,selling_price:Ye}});y(Oe)}catch(St){console.error("Error fetching items:",St),y([])}},ee=async()=>{var ge,rt,ht;try{const[ft,St]=await Promise.all([te.get("/sales/orders"),te.get("/sales/invoices")]),Je=Array.isArray((ge=ft.data)==null?void 0:ge.items)?ft.data.items:[],ts=Array.isArray((rt=St.data)==null?void 0:rt.items)?St.data.items:[],Kt=new Set(ts.map(Oe=>Oe==null?void 0:Oe.sales_order_id).filter(Oe=>Oe!=null).map(Oe=>String(Oe)));let fe=Je.filter(Oe=>!Kt.has(String(Oe.id)));if(r&&Q.sales_order_id){const Oe=String(Q.sales_order_id);if(!fe.some(Le=>String(Le.id)===Oe))try{const Ye=(ht=(await te.get(`/sales/orders/${Q.sales_order_id}`)).data)==null?void 0:ht.item;Ye&&(fe=[Ye,...fe])}catch{}}j(fe)}catch(ft){console.error("Error fetching orders:",ft)}},se=async()=>{var ge;try{const rt=await te.get("/inventory/warehouses");k(Array.isArray((ge=rt.data)==null?void 0:ge.items)?rt.data.items:[])}catch(rt){console.error("Error fetching warehouses:",rt)}},Ae=async()=>{var ge;try{const rt=await te.get("/finance/currencies"),ht=Array.isArray((ge=rt.data)==null?void 0:ge.items)?rt.data.items:[];I(ht);const ft=ht.find(St=>String(St.code||St.currency_code||"").toUpperCase()==="GHS")||ht.find(St=>/ghana|cedi/i.test(String(St.name||St.currency_name||"")));O(St=>({...St,currency_id:St.currency_id||(ft==null?void 0:ft.id)||"",exchange_rate:St.exchange_rate||1}))}catch(rt){console.error("Error fetching currencies:",rt)}},we=async()=>{var ge;try{const rt=await te.get("/finance/tax-codes"),ft=(Array.isArray((ge=rt.data)==null?void 0:ge.items)?rt.data.items:[]).map(St=>({value:St.id,label:St.name,rate:Number(St.rate_percent)}));q(ft),ft.length>0&&!D.tax_type&&Y(St=>({...St,tax_type:ft[0].value}))}catch(rt){console.error("Error fetching tax codes:",rt)}},ce=async()=>{var ge;if(Q.customer_id)try{const rt=await te.get(`/sales/prices/customer?customer_id=${Q.customer_id}`);E(Array.isArray((ge=rt.data)==null?void 0:ge.items)?rt.data.items:[])}catch(rt){console.error("Error fetching customer prices:",rt)}},le=async ge=>{var ht;const rt=String(ge||"");if(rt)try{const ft=await te.get(`/finance/tax-codes/${ge}/components`),St=Array.isArray((ht=ft.data)==null?void 0:ht.items)?ft.data.items:[];R(Je=>({...Je,[rt]:St}))}catch{}},_e=async()=>{const rt=Array.from(new Set(T.map(ht=>String(ht.tax_type)).filter(Boolean))).filter(ht=>!(ht in X));rt.length&&await Promise.all(rt.map(ht=>le(ht)))},Qe=()=>{const ge=T.reduce((Je,ts)=>Je+(ts.net||0),0),rt={};T.forEach(Je=>{(X[String(Je.tax_type)]||[]).forEach(Kt=>{const fe=Number(Kt.rate_percent)||0,Oe=(Je.net||0)*fe/100,Se=Kt.component_name;rt[Se]||(rt[Se]={amount:0,rate:fe,sort_order:Kt.sort_order||0}),rt[Se].amount+=Oe})});const ht=Object.keys(rt).map(Je=>({name:Je,amount:rt[Je].amount,rate:rt[Je].rate,sort_order:rt[Je].sort_order})).sort((Je,ts)=>Je.sort_order-ts.sort_order),ft=ht.reduce((Je,ts)=>Je+ts.amount,0),St=ge+ft;return{sub:ge,components:ht,taxTotal:ft,total:St}},Ie=()=>{const ge=T.reduce((Je,ts)=>Je+(ts.sub||0),0),rt=T.reduce((Je,ts)=>Je+(ts.discAmt||0),0),ht=T.reduce((Je,ts)=>Je+(ts.net||0),0),ft=Qe(),St=ht+ft.taxTotal;return{grossSub:ge,discountTotal:rt,netSub:ht,components:ft.components,taxTotal:ft.taxTotal,grand:St}},ke=ge=>{const rt=String(ge||"").trim();if(!rt)return"";if(rt.startsWith("http://")||rt.startsWith("https://")||rt.startsWith("data:"))return rt;const ht=typeof window<"u"&&window.location?window.location.origin:"";return ht?rt.startsWith("/")?ht+rt:ht+"/"+rt:rt},pe=async()=>{var ge,rt;if(L!==null)return L;try{const ht=await te.get("/admin/document-templates/INVOICE"),ft=String(((rt=(ge=ht.data)==null?void 0:ge.item)==null?void 0:rt.template_html)||"").trim();return U(ft),ft}catch{return U(""),""}},he=()=>{var ft;const ge=x.find(St=>String(St.id)===String(Q.customer_id)),rt=Ie(),ht=(Array.isArray(T)?T:[]).map(St=>{const Je=Number(St.qty||0),ts=Number(St.unit_price||0),Kt=Number(St.total||0),fe=Number(St.discAmt||0),Oe=Number(St.net||0);return{item_name:String(St.item_name||""),qty:Je.toFixed(2),unit_price:ts.toFixed(2),total:Kt.toFixed(2),discount:fe.toFixed(2),net:Oe.toFixed(2)}});return{company:{name:H.name||"Company",address:H.address||"",city:H.city||"",state:H.state||"",postalCode:H.postalCode||"",country:H.country||"",phone:H.phone||"",email:H.email||"",website:H.website||"",taxId:H.taxId||"",registrationNo:H.registrationNo||"",logoUrl:ke(H.logoUrl||""),logoHtml:ke(H.logoUrl||"")?`<img src="${ke(H.logoUrl||"")}" alt="${String(H.name||"Company").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}" style="max-height:80px;object-fit:contain;" />`:""},invoice:{invoice_no:String(Q.invoice_no||""),invoice_date:String(Q.invoice_date||""),due_date:String(Q.due_date||""),payment_type:String(Q.payment_type||""),price_type:String(Q.price_type||""),currency:String(((ft=P.find(St=>String(St.id)===String(Q.currency_id)))==null?void 0:ft.code)||""),prepared_by:String(K||"")},customer:{id:String((ge==null?void 0:ge.id)||""),code:String((ge==null?void 0:ge.customer_code)||""),name:String((ge==null?void 0:ge.customer_name)||""),type:String((ge==null?void 0:ge.customer_type)||""),contactPerson:String((ge==null?void 0:ge.contact_person)||""),email:String((ge==null?void 0:ge.email)||""),phone:String((ge==null?void 0:ge.phone)||Q.phone||""),mobile:String((ge==null?void 0:ge.mobile)||""),address:String((ge==null?void 0:ge.address)||""),city:String((ge==null?void 0:ge.city)||Q.city||""),state:String((ge==null?void 0:ge.state)||Q.state||""),zone:String((ge==null?void 0:ge.zone)||""),country:String((ge==null?void 0:ge.country)||Q.country||""),paymentTerms:String((ge==null?void 0:ge.payment_terms)||""),creditLimit:Number((ge==null?void 0:ge.credit_limit)||0).toFixed(2)},items:ht,totals:{subtotal:Number(rt.grossSub||0).toFixed(2),discount:Number(rt.discountTotal||0).toFixed(2),netSubtotal:Number(rt.netSub||0).toFixed(2),tax:Number(rt.taxTotal||0).toFixed(2),total:Number(rt.grand||0).toFixed(2)}}},je=async()=>{var Kt;const ge=await pe();if(!ge)return!1;const rt=he(),ht=qO(gy(ge,rt)),ft=document.createElement("iframe");ft.style.position="fixed",ft.style.right="0",ft.style.bottom="0",ft.style.width="0",ft.style.height="0",ft.style.border="0",document.body.appendChild(ft);const St=((Kt=ft.contentWindow)==null?void 0:Kt.document)||ft.contentDocument||null;if(!St)return document.body.removeChild(ft),!0;St.open(),St.write(ht),St.close();const Je=ft.contentWindow||window;return setTimeout(()=>{Je.focus();try{Je.print()}catch{}setTimeout(()=>{document.body.removeChild(ft)},100)},200),!0},me=async()=>{const ge=await pe();if(!ge)return!1;const rt=he(),ht=gy(ge,rt),ft=document.createElement("div");ft.style.position="fixed",ft.style.left="-10000px",ft.style.top="0",ft.style.width="794px",ft.style.background="white",ft.style.padding="32px",ft.innerHTML=ht,document.body.appendChild(ft);try{await VO(ft);const St=await Wn(ft,{scale:2,useCORS:!0}),Je=St.toDataURL("image/png"),ts=new As("p","mm","a4"),Kt=ts.internal.pageSize.getWidth(),fe=ts.internal.pageSize.getHeight(),Oe=Kt,Se=St.height*Oe/St.width;let Le=0;for(;Le<Se;)ts.addImage(Je,"PNG",0,-Le,Oe,Se),Le+=fe,Le<Se&&ts.addPage();const Ye="Invoice_"+(Q.invoice_no||new Date().toISOString().slice(0,10))+".pdf";ts.save(Ye)}finally{document.body.removeChild(ft)}return!0},xe=async()=>{var ge,rt,ht,ft,St;try{const Je=(a==null?void 0:a.username)||"";_(Je);const ts=await te.get("/admin/me"),Kt=(rt=(ge=ts.data)==null?void 0:ge.scope)==null?void 0:rt.companyId,fe=((ft=(ht=ts.data)==null?void 0:ht.user)==null?void 0:ft.username)||"";if(!Je&&fe&&_(fe),Kt){const Se=((St=(await te.get(`/admin/companies/${Kt}`)).data)==null?void 0:St.item)||{};W(Le=>({...Le,name:Se.name||Le.name||"",address:Se.address||Le.address||"",phone:Se.telephone||Le.phone||"",email:Se.email||Le.email||"",city:Se.city||Le.city||"",state:Se.state||Le.state||"",postalCode:Se.postal_code||Le.postalCode||"",country:Se.country||Le.country||"",website:Se.website||Le.website||"",taxId:Se.tax_id||Le.taxId||"",registrationNo:Se.registration_no||Le.registrationNo||"",logoUrl:Se.has_logo===1||Se.has_logo===!0?`/api/admin/companies/${Kt}/logo`:Gs}))}else W(Oe=>({...Oe,logoUrl:Oe.logoUrl||Gs}))}catch{a!=null&&a.username&&_(a.username),W(Je=>({...Je,logoUrl:Je.logoUrl||Gs}))}},Ue=async()=>{var ge,rt,ht,ft;try{m(!0);const St=await te.get(`/sales/invoices/${s}`),Je=(ge=St.data)==null?void 0:ge.item;if(Je){O({invoice_no:Je.invoice_no||"",invoice_date:Re(Je.invoice_date||new Date),customer_id:Je.customer_id||"",status:Je.status||"POSTED",due_date:Re(Je.due_date||""),city:"",state:"",country:"",phone:"",remarks:Je.remarks||"",warehouse_id:Je.warehouse_id||"",price_type:Je.price_type||"RETAIL",payment_type:Je.payment_type||"CASH",currency_id:Je.currency_id||"",exchange_rate:Number(Je.exchange_rate||1),sales_order_id:Je.sales_order_id||""});const ts=x.find(Kt=>String(Kt.id)===String(Je.customer_id));ts&&O(Kt=>({...Kt,city:ts.city||"",state:ts.state||"",country:ts.country||"",phone:ts.phone||ts.customer_phone||""}))}if((rt=St.data)!=null&&rt.details){let ts=St.data.details.map((fe,Oe)=>{var Nt;const Se=Math.round(Number(fe.quantity||0)*100)/100,Le=Math.round(Number(fe.unit_price||0)*100)/100,Ye=Math.round(Number(fe.discount_percent||0)*100)/100,st=fe.tax_id||"",It=fe.tax_rate!==void 0&&fe.tax_rate!==null?Number(fe.tax_rate):((Nt=B.find(Et=>String(Et.value)===String(st)))==null?void 0:Nt.rate)||0,Ft=Ve({qty:Se,unit_price:Le,discount_percent:Ye,tax_type:st}),Bt=fe.net_amount!==void 0&&fe.net_amount!==null?Math.round(Number(fe.net_amount)*100)/100:Ft.net,Tt=fe.tax_amount!==void 0&&fe.tax_amount!==null?Math.round(Number(fe.tax_amount)*100)/100:Ft.taxAmt,Me=fe.total_amount!==void 0&&fe.total_amount!==null?Math.round(Number(fe.total_amount)*100)/100:Ft.total;return{line_id:Oe+1,item_id:fe.item_id,item_name:fe.item_name||"",remarks:fe.remarks||"",qty:Se,unit_price:Le,discount_percent:Ye,tax_rate:It,tax_type:st,sub:Math.round(Number(Se*Le)*100)/100,discAmt:Math.round(Number(Se*Le*Ye/100)*100)/100,net:Bt,taxAmt:Tt,total:Me}});const Kt=Je.warehouse_id||Q.warehouse_id||"";Kt&&(ts=await Promise.all(ts.map(async Oe=>({...Oe,available_qty:await ae(Kt,Oe.item_id)})))),V(ts)}}catch(St){f(((ft=(ht=St==null?void 0:St.response)==null?void 0:ht.data)==null?void 0:ft.message)||"Error fetching invoice"),console.error("Error fetching invoice:",St)}finally{m(!1)}};async function ct(ge){try{const rt=[...T],ht=await Promise.all(rt.map(async ft=>{if(!ft.item_id){const Je={...ft};return{...Je,...Ve(Je)}}try{const Je=await te.post("/sales/prices/best-price",{product_id:ft.item_id,customer_id:Q.customer_id,quantity:Number(ft.qty||1),date:Q.invoice_date,price_type:typeof ge=="string"?ge:String(ge||""),only_standard:!0});if(Je.data&&Je.data.price!==void 0){const ts={...ft,unit_price:Math.round(Number(Je.data.price||0)*100)/100};return{...ts,...Ve(ts)}}}catch{}const St={...ft};return{...St,...Ve(St)}}));V(ht)}catch{}}function dt(ge,rt){let ht={...Q,[ge]:rt};if(ge==="customer_id"){const ft=x.find(St=>St.id==rt);ht.city=(ft==null?void 0:ft.city)||"",ht.state=(ft==null?void 0:ft.state)||"",ht.country=(ft==null?void 0:ft.country)||"",ht.phone=(ft==null?void 0:ft.phone)||(ft==null?void 0:ft.customer_phone)||"",ce()}ge==="sales_order_id"&&rt&&We(rt),ge==="price_type"&&ct(rt),O(ht)}async function We(ge){var rt,ht;try{const ft=await te.get(`/sales/orders/${ge}`),St=(rt=ft.data)==null?void 0:rt.item,Je=Array.isArray((ht=ft.data)==null?void 0:ht.details)?ft.data.details:[];if(St&&O(ts=>({...ts,customer_id:St.customer_id||ts.customer_id,warehouse_id:St.warehouse_id||ts.warehouse_id||""})),Je.length){let ts=Je.map(fe=>{var Me;const Oe=Math.round(Number(fe.qty||0)*100)/100,Se=Math.round(Number(fe.unit_price||0)*100)/100,Le=Math.round(Number(fe.discount_percent||0)*100)/100,Ye=fe.tax_id||"",st=Ve({qty:Oe,unit_price:Se,discount_percent:Le,tax_type:Ye}),It=fe.tax_rate!==void 0&&fe.tax_rate!==null?Number(fe.tax_rate):((Me=B.find(Nt=>String(Nt.value)===String(Ye)))==null?void 0:Me.rate)||0,Ft=fe.tax_amount!==void 0&&fe.tax_amount!==null?Math.round(Number(fe.tax_amount)*100)/100:st.taxAmt,Bt=fe.total_amount!==void 0&&fe.total_amount!==null?Math.round(Number(fe.total_amount)*100)/100:st.total,Tt=b.find(Nt=>Nt.id==fe.item_id);return{line_id:Date.now()+Math.random(),item_id:fe.item_id,item_name:fe.item_name||(Tt==null?void 0:Tt.item_name)||"",qty:Oe,unit_price:Se,discount_percent:Le,tax_type:Ye,tax_rate:It,...st,taxAmt:Ft,total:Bt}});const Kt=(St==null?void 0:St.warehouse_id)||Q.warehouse_id||"";Kt&&(ts=await Promise.all(ts.map(async Oe=>({...Oe,available_qty:await ae(Kt,Oe.item_id)})))),V(ts)}}catch(ft){console.error("Failed to apply order to invoice",ft)}}function He(ge){const{name:rt,value:ht}=ge.target;if(rt==="item_id"){const ft=b.find(St=>St.id===parseInt(ht));if(Y(St=>({...St,item_id:ht,item_name:(ft==null?void 0:ft.item_name)||"",unit_price:"",qty:1})),ht){{const Je={product_id:ht,quantity:1,date:Q.invoice_date,price_type:typeof Q.price_type=="string"?Q.price_type:String(Q.price_type||""),only_standard:!0,...Q.customer_id?{customer_id:Q.customer_id}:{}};te.post("/sales/prices/best-price",Je).then(ts=>{ts.data&&ts.data.price!==void 0&&Y(Kt=>({...Kt,unit_price:Math.round(Number(ts.data.price||0)*100)/100}))}).catch(ts=>console.error("Error fetching price:",ts))}te.get(`/finance/item-tax/${ht}`).then(Je=>{var Kt,fe,Oe;const ts=(Kt=Je.data)==null?void 0:Kt.tax;if(ts){const Se=ts.id||((fe=B.find(Ye=>Ye.code===ts.tax_code))==null?void 0:fe.value)||null,Le=Se?(Oe=B.find(Ye=>String(Ye.value)===String(Se)))==null?void 0:Oe.rate:null;Y(Ye=>({...Ye,tax_type:Se??Ye.tax_type,tax_rate:Le??ts.tax_rate}))}else Y(Se=>({...Se,tax_rate:void 0}))}).catch(()=>{Y(Je=>({...Je,tax_rate:void 0}))});const St=Q.warehouse_id;St?ae(St,Number(ht)).then(Je=>Y(ts=>({...ts,available_qty:Je}))):Y(Je=>({...Je,available_qty:void 0}))}}else if(rt==="unit_price"||rt==="qty"||rt==="discount_percent"){const ft=ht===""?"":Math.round(Number(ht)*100)/100;Y(St=>({...St,[rt]:ft}))}else Y(ft=>({...ft,[rt]:ht}))}function ze(){if(!D.item_id||!D.qty||!D.unit_price)return;if(Q.warehouse_id&&D.available_qty!==void 0&&Number(D.qty||0)>Number(D.available_qty||0)){mt.error("Quantity exceeds available stock for selected warehouse");return}const ge=Ve(D);V(rt=>[...rt,{...D,line_id:Date.now(),...ge,available_qty:D.available_qty}]),Y({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:"",tax_type:B.length>0?B[0].value:"",tax_rate:void 0,remarks:"",available_qty:void 0})}async function Pe(ge,rt){try{const ht={product_id:rt,quantity:1,date:Q.invoice_date,price_type:typeof Q.price_type=="string"?Q.price_type:String(Q.price_type||""),only_standard:!0,...Q.customer_id?{customer_id:Q.customer_id}:{}},ft=await te.post("/sales/prices/best-price",ht);ft.data&&ft.data.price!==void 0&&V(St=>St.map((Je,ts)=>{if(ts!==ge)return Je;const Kt={...Je,unit_price:Math.round(Number(ft.data.price||0)*100)/100};return{...Kt,...Ve(Kt)}}))}catch(ht){console.error("Error fetching price:",ht)}}function Te(ge,rt){rt.item_id&&Pe(ge,rt.item_id),V(ht=>ht.map((ft,St)=>{var ts;if(St!==ge)return ft;let Je={...ft,...rt};if("unit_price"in rt&&(Je.unit_price=rt.unit_price===""||rt.unit_price==null?"":Math.round(Number(rt.unit_price)*100)/100),"qty"in rt&&(Je.qty=rt.qty===""||rt.qty==null?"":Math.round(Number(rt.qty)*100)/100),"discount_percent"in rt&&(Je.discount_percent=rt.discount_percent===""||rt.discount_percent==null?"":Math.round(Number(rt.discount_percent)*100)/100),rt.item_id){const Kt=b.find(fe=>fe.id==rt.item_id);if(Je.item_name=(Kt==null?void 0:Kt.item_name)||Je.item_name||"",lt(rt.item_id,fe=>{Je.tax_rate=fe==null?void 0:fe.tax_rate,Je.tax_type=(fe==null?void 0:fe.tax_code)||Je.tax_type||"VAT15"}),Q.warehouse_id)return ae(Number(Q.warehouse_id),Number(rt.item_id)).then(fe=>{V(Oe=>Oe.map((Se,Le)=>Le===ge?{...Je,available_qty:fe,...Ve(Je)}:Se))}),Je}if(rt.tax_type){const Kt=((ts=B.find(fe=>String(fe.value)===String(rt.tax_type)))==null?void 0:ts.rate)||0;Je.tax_rate=Kt}return Je={...Je,...Ve(Je)},Je}))}function Ke(ge){const rt=b.find(ht=>String(ht.id)===String(ge));return rt&&rt.item_code||""}function $e(ge){V(rt=>rt.filter(ht=>ht.line_id!==ge))}function Ve(ge){var Se;const rt=Math.round(Number(ge.qty||0)*100)/100,ht=Math.round(Number(ge.unit_price||0)*100)/100,ft=Math.round(Number(ge.discount_percent||0)*100)/100,St=Math.round(rt*ht*100)/100,Je=Math.round(St*ft/100*100)/100,ts=Math.round((St-Je)*100)/100,Kt=((Se=B.find(Le=>String(Le.value)===String(ge.tax_type)))==null?void 0:Se.rate)||0,fe=Math.round(ts*Kt/100*100)/100,Oe=Math.round((ts+fe)*100)/100;return{sub:St,discAmt:Je,net:ts,taxAmt:fe,total:Oe,line_total:Oe}}v.useEffect(()=>{const ge=Q.warehouse_id;if(!ge){V(rt=>rt.map(ht=>({...ht,available_qty:void 0}))),Y(rt=>({...rt,available_qty:void 0}));return}(async()=>{const rt=await Promise.all(T.map(async ht=>({...ht,available_qty:await ae(ge,ht.item_id)})));if(V(rt),D.item_id){const ht=await ae(ge,Number(D.item_id));Y(ft=>({...ft,available_qty:ht}))}})()},[Q.warehouse_id]);function Ze(){const ge=T.reduce((ht,ft)=>ht+Number(ft.net||0),0),rt=T.reduce((ht,ft)=>ht+Number(ft.taxAmt||0),0);return{sub:ge,tax:rt,total:ge+rt}}function Re(ge){if(!ge)return"";if(ge instanceof Date)return ge.toISOString().split("T")[0];const rt=String(ge);return rt.includes("T")?rt.split("T")[0]:rt.slice(0,10)}function it(ge,rt){if(!ge)return"";const ht=new Date(ge);return ht.setDate(ht.getDate()+Number(rt||0)),ht.toISOString().split("T")[0]}function lt(ge,rt){te.get(`/finance/item-tax/${ge}`).then(ht=>{var ft;return rt(((ft=ht.data)==null?void 0:ft.tax)||null)}).catch(()=>rt(null))}async function Ne(ge){var rt,ht,ft,St,Je,ts,Kt;ge.preventDefault(),m(!0),f("");try{if(!Q.warehouse_id){mt.error("Select Warehouse before saving the invoice"),m(!1);return}const Oe=D.item_id&&D.qty&&D.unit_price?[...T,{...D,...Ve(D)}]:[...T];if(!Oe.length){mt.error("Add at least one item before saving the invoice"),m(!1);return}const Se=new Date().toISOString().slice(0,10).replace(/-/g,"");let Le=Q.invoice_no;if(!Le){const Ft=Math.floor(Math.random()*1e3).toString().padStart(3,"0");Le=`INV-${Se}-${Ft}`}const Ye=(()=>{const Ft=Oe.reduce((Tt,Me)=>Tt+Number(Me.net||0),0),Bt=Oe.reduce((Tt,Me)=>Tt+Number(Me.taxAmt||0),0);return{sub:Ft,tax:Bt,total:Ft+Bt}})(),st={...Q,invoice_date:Re(Q.invoice_date),invoice_no:Le,customer_id:Number(Q.customer_id),due_date:Re(Q.due_date)||null,warehouse_id:Q.warehouse_id?Number(Q.warehouse_id):null,price_type:Q.price_type,payment_type:Q.payment_type,currency_id:Q.currency_id?Number(Q.currency_id):null,exchange_rate:Number(Q.exchange_rate||1),total_amount:Math.round(Number(Ye.total||0)*100)/100,tax_amount:Math.round(Number(Ye.tax||0)*100)/100,net_amount:Math.round(Number(Ye.sub||0)*100)/100,...Q.sales_order_id?{sales_order_id:Number(Q.sales_order_id)}:{},items:Oe.map(Ft=>{var Et;const Bt=Ft.tax_type,Tt=Number(Bt);let Me=Number.isFinite(Tt)&&Tt>0?Tt:null;if(!Me&&Bt){const $t=B.find(Ht=>String(Ht.label||"").toUpperCase()===String(Bt||"").toUpperCase());$t&&(Me=Number($t.value))}const Nt=((Et=B.find($t=>Number($t.value)===Number(Me)))==null?void 0:Et.rate)||0;return{item_id:Ft.item_id,quantity:Math.round(Number(Ft.qty||0)*100)/100,unit_price:Math.round(Number(Ft.unit_price||0)*100)/100,discount_percent:Math.round(Number(Ft.discount_percent||0)*100)/100,tax_id:Me||null,tax_rate:Nt,tax_amount:Math.round(Number(Ft.taxAmt||0)*100)/100,total_amount:Math.round(Number(Ft.total||0)*100)/100,net_amount:Math.round(Number(Ft.net||0)*100)/100}})};let It=0;if(r){const Ft=await te.put(`/sales/invoices/${s}`,st);It=Number(((rt=Ft==null?void 0:Ft.data)==null?void 0:rt.id)||s)}else{const Ft=await te.post("/sales/invoices",st);It=Number(((ht=Ft==null?void 0:Ft.data)==null?void 0:ht.id)||0)}try{const Ft=await te.post(`/sales/invoices/${It}/submit`),Bt=((ft=Ft==null?void 0:Ft.data)==null?void 0:ft.payment_status)||"UNPAID";mt.success(`Invoice ${Le} saved and submitted (${Bt})`),t("/sales/invoices")}catch(Ft){const Bt=((Je=(St=Ft==null?void 0:Ft.response)==null?void 0:St.data)==null?void 0:Je.message)||"Failed to submit invoice";/already submitted/i.test(Bt)?(mt.info(`Invoice ${Le} already submitted`),t("/sales/invoices")):(/no line items/i.test(Bt)||/warehouse_id is required/i.test(Bt)||/insufficient stock/i.test(Bt),mt.error(Bt))}}catch(fe){const Oe=((Kt=(ts=fe==null?void 0:fe.response)==null?void 0:ts.data)==null?void 0:Kt.message)||"Error saving invoice";f(Oe),mt.error(Oe)}finally{m(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("style",{children:`
        @media print {
          @page { margin: 1cm; }
          body { 
            background: white; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          #root > div > header,
          #root > div > div > aside { display: none !important; }
          .print\\:hidden { display: none !important; }
          .print\\:block { display: block !important; }
          #root > div > div > main { padding: 0 !important; }
          input, select, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            resize: none;
            overflow: visible;
          }
        }
        .quotation-table { 
          border-collapse: collapse; 
          table-layout: fixed; 
          width: 100%; 
          max-width: 100%; 
          border-spacing: 0; 
          box-sizing: border-box;
          margin: 0 auto;
        }
        .quotation-table th, .quotation-table td { 
          border: 1px solid #000000; 
          box-sizing: border-box; 
          word-break: break-word; 
          overflow-wrap: anywhere; 
          white-space: normal; 
          padding: 6px 4px;
          font-size: 10px;
        }
        .quotation-table thead th { 
          background: #0E3646; 
          color: #ffffff; 
        }
        .quotation-table thead th:last-child,
        .quotation-table tbody td:last-child {
          background: #ffffff;
          color: #000000;
        }
        .quotation-table thead th:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        .quotation-table tbody td:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        @media print {
          .quotation-table {
            width: 100%;
            max-width: 100%;
          }
          .quotation-table thead th:last-child,
          .quotation-table tbody td:last-child {
            background: #ffffff !important;
            color: #000000 !important;
          }
          .quotation-table thead th:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
          .quotation-table tbody td:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
        }
      `}),e.jsx("div",{className:"card print:hidden",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Invoice":"New Invoice"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage sales invoices"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("button",{type:"button",onClick:async()=>{try{await _e()}catch{}try{await je()||window.print()}catch{window.print()}},className:"btn-secondary",title:"Print",children:[e.jsx(Mh,{className:"w-4 h-4 inline mr-1"}),"Print"]}),e.jsxs("button",{type:"button",onClick:async()=>{try{if(await me())return}catch{}const ge=M.current;if(!ge)return;const rt=ge.style.cssText;ge.style.cssText=rt+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const ht=await Wn(ge,{scale:2,useCORS:!0}),ft=ht.toDataURL("image/png"),St=new As("p","mm","a4"),Je=St.internal.pageSize.getWidth(),ts=St.internal.pageSize.getHeight(),Kt=Je,fe=ht.height*Kt/ht.width;let Oe=0;for(;Oe<fe;)St.addImage(ft,"PNG",0,-Oe,Kt,fe),Oe+=ts,Oe<fe&&St.addPage();const Se="Invoice_"+(Q.invoice_no||new Date().toISOString().slice(0,10))+".pdf";St.save(Se)}finally{ge.style.cssText=rt}},className:"btn-secondary",title:"Download PDF",children:[e.jsx(gu,{className:"w-4 h-4 inline mr-1"}),"Download PDF"]}),e.jsx(Ee,{to:"/sales/invoices",className:"btn-success",children:"Back"})]})]})})}),e.jsx("form",{onSubmit:Ne,className:"print:hidden",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice #"}),e.jsx("input",{className:"input bg-gray-50",value:Q.invoice_no,onChange:ge=>dt("invoice_no",ge.target.value),placeholder:"Auto-generated",readOnly:!r&&!Q.invoice_no,disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice Date *"}),e.jsx("input",{className:"input",type:"date",value:Q.invoice_date,onChange:ge=>dt("invoice_date",ge.target.value),required:!0,disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer *"}),e.jsxs("select",{className:"input",value:Q.customer_id,onChange:ge=>dt("customer_id",ge.target.value),required:!0,disabled:u,children:[e.jsx("option",{value:"",children:"Select Customer"}),x.map(ge=>e.jsx("option",{value:ge.id,children:ge.customer_name},ge.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:Q.warehouse_id,onChange:ge=>dt("warehouse_id",ge.target.value),required:!0,disabled:u,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),S.map(ge=>e.jsxs("option",{value:ge.id,children:[ge.warehouse_code," - ",ge.warehouse_name]},ge.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sales Order"}),e.jsxs("select",{className:"input",value:Q.sales_order_id,onChange:ge=>dt("sales_order_id",ge.target.value),disabled:u,children:[e.jsx("option",{value:"",children:"Select Sales Order (Optional)"}),N.map(ge=>e.jsx("option",{value:ge.id,children:ge.order_no},ge.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsxs("select",{className:"input",value:Q.price_type,onChange:ge=>dt("price_type",ge.target.value),disabled:u,children:[e.jsx("option",{value:"RETAIL",children:"Retail"}),e.jsx("option",{value:"WHOLESALE",children:"Wholesale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Type"}),e.jsxs("select",{className:"input",value:Q.payment_type,onChange:ge=>dt("payment_type",ge.target.value),disabled:u,children:[e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"}),e.jsx("option",{value:"CREDIT",children:"Credit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:Q.currency_id,onChange:ge=>dt("currency_id",ge.target.value),disabled:u,children:[e.jsx("option",{value:"",children:"Select Currency"}),P.map(ge=>e.jsxs("option",{value:ge.id,children:[ge.code," - ",ge.name]},ge.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input bg-gray-50",value:Q.city,onChange:ge=>dt("city",ge.target.value),placeholder:"Auto",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input bg-gray-50",value:Q.state,onChange:ge=>dt("state",ge.target.value),placeholder:"Auto",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input bg-gray-50",value:Q.country,onChange:ge=>dt("country",ge.target.value),placeholder:"Auto",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{className:"input bg-gray-50",value:Q.phone,onChange:ge=>dt("phone",ge.target.value),placeholder:"Auto",readOnly:!0})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold",children:"Invoice Items"})}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 mb-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Item *"}),e.jsxs("select",{name:"item_id",value:D.item_id,onChange:He,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Item"}),b.map(ge=>e.jsxs("option",{value:ge.id,children:[ge.item_code," - ",ge.item_name]},ge.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),e.jsx("input",{type:"number",name:"qty",value:D.qty===""?"":D.qty,onChange:He,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"1",step:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Available"}),e.jsx("input",{type:"text",value:Q.warehouse_id?Number(D.available_qty||0).toFixed(2):"",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",name:"unit_price",value:D.unit_price===""?"":D.unit_price,onChange:He,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",step:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Disc %"}),e.jsx("input",{type:"number",name:"discount_percent",value:D.discount_percent===""?"":D.discount_percent,onChange:He,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"0",max:"100",step:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),e.jsx("select",{name:"tax_type",value:D.tax_type,onChange:He,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:B.map(ge=>e.jsx("option",{value:ge.value,children:ge.label},ge.value))}),D.tax_rate!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Tax rate: ",Number(D.tax_rate).toFixed(2),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:!u&&e.jsxs("button",{type:"button",onClick:ze,className:"bg-[#0E3646] text-white px-4 py-2 rounded-lg hover:bg-[#092530] flex items-center gap-2 transition-colors text-sm",children:[e.jsx(vu,{className:"w-4 h-4"})," Add Item"]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Available"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Disc%"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Remarks"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:T.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-4 py-8 text-center text-gray-500",children:"No items added yet"})}):T.map((ge,rt)=>{var ht;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsxs("select",{className:"input w-full",value:ge.item_id,onChange:ft=>Te(rt,{item_id:Number(ft.target.value)}),children:[e.jsx("option",{value:"",children:"Select Item"}),b.map(ft=>e.jsxs("option",{value:ft.id,children:[ft.item_code," - ",ft.item_name]},ft.id))]}):ge.item_name}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ke(ge.item_id)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"number",min:"0",step:"1",value:ge.qty===""?"":ge.qty,onChange:ft=>Te(rt,{qty:ft.target.value===""?"":Number(ft.target.value)})}):ge.qty}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Q.warehouse_id?Number(ge.available_qty||0).toFixed(2):""}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"number",step:"1",value:ge.unit_price===""?"":ge.unit_price,onChange:ft=>Te(rt,{unit_price:ft.target.value===""?"":Number(ft.target.value)})}):parseFloat(ge.unit_price).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"number",min:"0",max:"100",step:"1",value:ge.discount_percent===""?"":ge.discount_percent||0,onChange:ft=>Te(rt,{discount_percent:ft.target.value===""?"":Number(ft.target.value)})}):parseFloat(ge.discount_percent||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("select",{className:"input w-full",value:ge.tax_type,onChange:ft=>Te(rt,{tax_type:ft.target.value}),children:B.map(ft=>e.jsx("option",{value:ft.value,children:ft.label},ft.value))}):((ht=B.find(ft=>String(ft.value)===String(ge.tax_type)))==null?void 0:ht.label)||""}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Number(ge.net||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Number(ge.taxAmt||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:Number(ge.total||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"text",value:ge.remarks||"",onChange:ft=>Te(rt,{remarks:ft.target.value})}):ge.remarks||""}),e.jsx("td",{className:"px-4 py-3",children:d&&e.jsx("button",{type:"button",onClick:()=>$e(ge.line_id),className:"text-red-600 hover:text-red-900 transition-colors",children:"Discard"})})]},ge.line_id)})}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"6",className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Totals:"}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:Ze().sub.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:Ze().tax.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:Ze().total.toFixed(2)}),e.jsx("td",{})]})})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:Ie().grossSub.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Total Discount:"}),e.jsx("span",{children:Ie().discountTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Total Tax:"}),e.jsx("span",{children:Ie().taxTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-slate-900",children:[e.jsx("span",{children:"Grand Total:"}),e.jsx("span",{children:Ie().grand.toFixed(2)})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks / Notes"}),e.jsx("textarea",{className:"input",rows:3,value:Q.remarks,onChange:ge=>dt("remarks",ge.target.value),placeholder:"Additional notes or terms...",disabled:u})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/sales/invoices",className:"btn-success",children:"Cancel"}),!u&&e.jsx("button",{className:"btn-success",type:"submit",disabled:c,children:c?"Saving...":"Save Invoice"})]})]})})}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:H.logoUrl||Gs,alt:H.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:H.name||"Company"}),H.address&&e.jsx("div",{children:H.address}),(H.city||H.state||H.country)&&e.jsx("div",{children:[H.city,H.state,H.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[H.phone&&e.jsx("span",{children:H.phone}),H.email&&e.jsx("span",{children:H.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Invoice"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",Q.invoice_date||""]}),e.jsxs("div",{children:["Invoice #: ",Q.invoice_no||""]}),e.jsxs("div",{children:["Customer:"," ",((Xe=x.find(ge=>String(ge.id)===String(Q.customer_id)))==null?void 0:Xe.customer_name)||""]}),e.jsxs("div",{children:["City: ",Q.city||""]}),e.jsxs("div",{children:["State: ",Q.state||""]}),e.jsxs("div",{children:["Country: ",Q.country||""]}),e.jsxs("div",{children:["Phone: ",Q.phone||""]}),e.jsxs("div",{children:["Price Type: ",Q.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",Q.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((Ge=P.find(ge=>String(ge.id)===String(Q.currency_id)))==null?void 0:Ge.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((at=S.find(ge=>String(ge.id)===String(Q.warehouse_id)))==null?void 0:at.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",K||""]})]})]}),e.jsx("div",{className:"mb-2 mx-auto",children:e.jsxs("table",{className:"quotation-table text-sm",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:T.map(ge=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:ge.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ge.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ge.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ge.total||0).toFixed(2)})]},ge.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().netSub.toFixed(2)}),Ie().components.map(ge=>e.jsxs(Os.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[ge.name," [",ge.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:ge.amount.toFixed(2)})]},ge.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().grand.toFixed(2)})]})})})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]}),e.jsxs("div",{ref:M,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:H.logoUrl||Gs,alt:H.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:H.name||"Company"}),H.address&&e.jsx("div",{children:H.address}),(H.city||H.state||H.country)&&e.jsx("div",{children:[H.city,H.state,H.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[H.phone&&e.jsx("span",{children:H.phone}),H.email&&e.jsx("span",{children:H.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Invoice"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",Q.invoice_date||""]}),e.jsxs("div",{children:["Invoice #: ",Q.invoice_no||""]}),e.jsxs("div",{children:["Customer:"," ",((xt=x.find(ge=>String(ge.id)===String(Q.customer_id)))==null?void 0:xt.customer_name)||""]}),e.jsxs("div",{children:["City: ",Q.city||""]}),e.jsxs("div",{children:["State: ",Q.state||""]}),e.jsxs("div",{children:["Country: ",Q.country||""]}),e.jsxs("div",{children:["Phone: ",Q.phone||""]}),e.jsxs("div",{children:["Price Type: ",Q.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",Q.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((wt=P.find(ge=>String(ge.id)===String(Q.currency_id)))==null?void 0:wt.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((pt=S.find(ge=>String(ge.id)===String(Q.warehouse_id)))==null?void 0:pt.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",K||""]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"quotation-table text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:T.map(ge=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:ge.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ge.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ge.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ge.total||0).toFixed(2)})]},ge.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().netSub.toFixed(2)}),Ie().components.map(ge=>e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"px-2 py-1",children:[ge.name," [",ge.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:ge.amount.toFixed(2)})]},ge.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().grand.toFixed(2)})]})})})]})]})]})}function ea(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function $O(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Delivery Note</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; color: #0f172a; background: #fff; }
      .dn { font-size: 12px; }
      .dn table { border-collapse: collapse; width: 100%; }
      .dn th, .dn td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      .dn th { background: #f8fafc; text-align: left; }
      .dn .right { text-align: right; }
      .dn .center { text-align: center; }
      .dn-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 8px; }
      .dn-logo { min-width: 120px; max-width: 200px; }
      .dn-company { text-align: right; font-size: 11px; line-height: 1.35; }
      .dn-company .name { font-weight: 800; font-size: 14px; }
      .dn-titlebar { display: flex; align-items: center; gap: 10px; color: #0f172a; margin: 4px 0 10px; }
      .dn-titlebar .line { flex: 1; height: 1px; background: #0f172a; }
      .dn-titlebar .title { font-weight: 700; }
      .dn-details { width: 100%; margin-bottom: 10px; border: 1px solid #cbd5e1; }
      .dn-details td { border-color: #cbd5e1; }
      .dn-details .label { width: 32%; color: #475569; }
      .dn-details .label-wide { width: 40%; color: #475569; }
      .dn-cust { padding: 8px; }
      .dn-cust .row { display: flex; gap: 6px; margin: 2px 0; }
      .dn-cust .label { color: #475569; min-width: 110px; }
      .dn-cust .value { flex: 1; }
      .dn-items thead th { font-weight: 600; }
      .dn-footer a { color: inherit; text-decoration: underline; }
      .dn-sign { margin-top: 14px; }
      .dn-sign .line { border-bottom: 1px solid #0f172a; display: inline-block; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}function L2(t){var i;const s=t.company||{},r=t.delivery||{},a=t.customer||{},n=Array.isArray(t.items)?t.items:[];return String(((i=t.totals)==null?void 0:i.total)||""),`
  <div class="dn">
  <div class="dn-header">
    <div class="dn-logo">${s.logoHtml||""}</div>
    <div class="dn-company">
      <div class="name">${ea(s.name||"")}</div>
      <div>${ea(s.address||"")}</div>
      <div>${ea([s.city,s.state,s.country].filter(Boolean).join(", "))} ${ea(s.postalCode||"")}</div>
      <div>Telephone: ${ea(s.phone||"")}</div>
      <div>Email: ${ea(s.email||"")}</div>
      <div>${ea(s.website||"")}</div>
      <div>TIN: ${ea(s.taxId||"")} &nbsp; Reg: ${ea(s.registrationNo||"")}</div>
    </div>
  </div>
  <div class="dn-titlebar">
    <div class="line"></div>
    <div class="title">* Delivery Note *</div>
    <div class="line"></div>
  </div>
  <table class="dn-details">
    <tr>
      <td style="width:50%;vertical-align:top;border-right:1px solid #cbd5e1;">
        <div class="dn-cust">
          <div class="row"><div class="label">Customer Name</div><div class="value">: ${ea(a.name||"")}</div></div>
          <div class="row"><div class="label">Address</div><div class="value">: ${ea(a.address||"")}</div></div>
          <div class="row"><div class="label">City</div><div class="value">: ${ea(a.city||"")}</div></div>
          <div class="row"><div class="label">State</div><div class="value">: ${ea(a.state||"")}</div></div>
          <div class="row"><div class="label">Country</div><div class="value">: ${ea(a.country||"")}</div></div>
        </div>
      </td>
      <td style="width:50%;vertical-align:top;">
        <table style="width:100%;">
          <tr><td class="label-wide">Delivery No</td><td>:</td><td>${ea(r.delivery_no||"")}</td></tr>
          <tr><td class="label-wide">Delivery Date</td><td>:</td><td>${ea(r.delivery_date||"")}</td></tr>
          <tr><td class="label-wide">Order No</td><td>:</td><td>${ea(r.order_no||"")}</td></tr>
          <tr><td class="label-wide">Order Date</td><td>:</td><td>${ea(r.order_date||"")}</td></tr>
          <tr><td class="label-wide">Del Method</td><td>:</td><td>${ea(r.delivery_method||"")}</td></tr>
          <tr><td class="label-wide">Our Ref</td><td>:</td><td>${ea(r.our_ref||"")}</td></tr>
        </table>
      </td>
    </tr>
  </table>
  <table class="dn-items">
    <thead>
      <tr>
        <th style="width:6%;">Sr No.</th>
        <th style="width:16%;">Product Code</th>
        <th>Product Description</th>
        <th class="right" style="width:18%;">Quantity Unit</th>
      </tr>
    </thead>
    <tbody>
      ${n.map((l,o)=>`
        <tr>
          <td class="center">${String(o+1)}</td>
          <td>${ea(l.item_code||"")}</td>
          <td>${ea(l.item_name||"")}</td>
          <td class="right">${ea(l.qty_display||l.qty||"")}</td>
        </tr>
      `).join("")}
      <tr>
        <td colspan="3" class="right"><strong>Total Quantity</strong></td>
        <td class="right"><strong>${ea(n.reduce((l,o)=>l+Number(o.qty||0),0).toFixed(2))}</strong></td>
      </tr>
    </tbody>
  </table>
  <div class="dn-footer" style="margin-top:10px;">
    <table style="width:100%;">
      <tr><td style="width:20%;">Item Count</td><td>:</td><td>${String(n.length)}</td></tr>
      <tr><td>Vehicle No</td><td>:</td><td>${ea(r.vehicle_no||"")}</td></tr>
      <tr><td>DRIVER NAME AND SIGN</td><td>:</td><td></td></tr>
      <tr><td>WAY BILL NO & CARRIER</td><td>:</td><td>${ea(r.waybill_no||"")}</td></tr>
      <tr><td>GOODS ISSUED BY (SIGN)</td><td>:</td><td></td></tr>
    </table>
  </div>
  <div class="dn-sign">
    <div style="text-align:right;">
      <span class="line">All above goods received in good order and condition</span>
    </div>
    <div style="height:40px;"></div>
    <div style="text-align:right;">
      <span class="line">Signature with Company's Rubber Stamp</span>
    </div>
  </div>
  </div>
  `}async function WO(t){const s=Array.from(t.querySelectorAll("img"));s.length&&await Promise.all(s.map(r=>new Promise(a=>{if(r.complete)return a();const n=()=>a();r.addEventListener("load",n,{once:!0}),r.addEventListener("error",n,{once:!0})})))}function GO(){const t=Ns(),[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,u]=v.useState(""),[d,c]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",postalCode:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[m,h]=v.useState(null);v.useEffect(()=>{f()},[]),v.useEffect(()=>{let B=!0;async function q(){var Q,O,T;try{const D=(O=(Q=(await te.get("/admin/me")).data)==null?void 0:Q.scope)==null?void 0:O.companyId;if(!D){if(!B)return;c(X=>({...X,logoUrl:X.logoUrl||Gs}));return}const M=((T=(await te.get(`/admin/companies/${D}`)).data)==null?void 0:T.item)||{};if(!B)return;c(X=>({...X,name:M.name||X.name||"",address:M.address||X.address||"",phone:M.telephone||X.phone||"",email:M.email||X.email||"",city:M.city||X.city||"",state:M.state||X.state||"",country:M.country||X.country||"",postalCode:M.postal_code||X.postalCode||"",website:M.website||X.website||"",taxId:M.tax_id||X.taxId||"",registrationNo:M.registration_no||X.registrationNo||"",logoUrl:M.has_logo===1||M.has_logo===!0?`/api/admin/companies/${D}/logo`:X.logoUrl||Gs}))}catch{if(!B)return;c(V=>({...V,logoUrl:V.logoUrl||Gs}))}}return q(),()=>{B=!1}},[]);const f=async()=>{var B,q,Q;try{n(!0),l("");const O=await te.get("/sales/deliveries");r(Array.isArray((B=O.data)==null?void 0:B.items)?O.data.items:[])}catch(O){l(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Error fetching deliveries"),console.error("Error fetching deliveries:",O)}finally{n(!1)}},x=s.filter(B=>{const q=o.trim().toLowerCase();return!q||String(B.delivery_no).toLowerCase().includes(q)||String(B.customer_name).toLowerCase().includes(q)});async function g(B){var D,Y;const q=await te.get(`/sales/deliveries/${B}`),Q=((D=q.data)==null?void 0:D.item)||{},O=Array.isArray((Y=q.data)==null?void 0:Y.details)?q.data.details:[],T=new As("p","mm","a4");let V=15;return T.setFontSize(14),T.text("Delivery Note",10,V),V+=8,T.setFontSize(11),T.text(`Delivery No: ${String(Q.delivery_no||"")}`,10,V),V+=6,T.text(`Date: ${Q.delivery_date?new Date(Q.delivery_date).toLocaleDateString():""}`,10,V),V+=6,T.text(`Customer: ${String(Q.customer_name||"")}`,10,V),V+=10,T.setFontSize(10),T.text("Item",10,V),T.text("Qty",120,V,{align:"right"}),T.text("Unit Price",160,V,{align:"right"}),T.text("Total",200,V,{align:"right"}),V+=4,T.line(10,V,200,V),V+=5,O.forEach(M=>{V>270&&(T.addPage(),V=15);const X=String(M.item_name||M.item_code||M.item_id||""),R=Number(M.quantity||M.qty||0),H=Number(M.unit_price||0),W=H*R;T.text(X.slice(0,60),10,V),T.text(R.toFixed(2),120,V,{align:"right"}),T.text(H.toFixed(2),160,V,{align:"right"}),T.text(W.toFixed(2),200,V,{align:"right"}),V+=5}),T}async function b(B){var q;try{const Q=Number(B),O=await te.get("/sales/customers"),T=Array.isArray((q=O.data)==null?void 0:q.items)?O.data.items:[];if(Number.isFinite(Q)){const V=T.find(D=>Number(D.id)===Q)||null;if(V)return V}return null}catch{return null}}async function y(){var B,q,Q;try{if(!(!String(d.name||"").trim()||!String(d.address||"").trim()||!String(d.phone||"").trim()||!String(d.email||"").trim()))return;const V=(q=(B=(await te.get("/admin/me")).data)==null?void 0:B.scope)==null?void 0:q.companyId;if(!V)return;const Y=((Q=(await te.get(`/admin/companies/${V}`)).data)==null?void 0:Q.item)||{};c(M=>({...M,name:Y.name||M.name||"",address:Y.address||M.address||"",phone:Y.telephone||M.phone||"",email:Y.email||M.email||"",city:Y.city||M.city||"",state:Y.state||M.state||"",country:Y.country||M.country||"",postalCode:Y.postal_code||M.postalCode||"",website:Y.website||M.website||"",taxId:Y.tax_id||M.taxId||"",registrationNo:Y.registration_no||M.registrationNo||"",logoUrl:Y.has_logo===1||Y.has_logo===!0?`/api/admin/companies/${V}/logo`:M.logoUrl||Gs}))}catch{}}async function N(B){var q;try{const Q=await te.get("/sales/customers"),O=Array.isArray((q=Q.data)==null?void 0:q.items)?Q.data.items:[],T=Number(B.customer_id);if(Number.isFinite(T)){const D=O.find(Y=>Number(Y.id)===T)||null;if(D)return D}const V=String(B.customer_name||"").trim().toLowerCase();if(V){const D=O.find(Y=>String(Y.customer_name||"").trim().toLowerCase()===V)||null;if(D)return D}return null}catch{return null}}const j=(B,q,Q)=>{const O=String(d.logoUrl||"").trim(),T=O?`<img src="${O}" alt="${ea(d.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",V=(Array.isArray(q)?q:[]).map((M,X)=>{const R=Number(M.quantity||M.qty||0),H=Number(M.unit_price||0),W=R*H;return{sr_no:X+1,item_code:String(M.item_code||M.item_id||""),item_name:String(M.item_name||M.item_code||M.item_id||""),qty:R.toFixed(2),qty_display:[R.toFixed(2),String(M.uom||"").trim()].filter(Boolean).join(" "),unit_price:H.toFixed(2),total:W.toFixed(2)}}),D=V.reduce((M,X)=>M+Number(X.total||0),0),Y=V.reduce((M,X)=>M+Number(X.qty||0),0);return{company:{name:d.name||"Company",address:d.address||"",city:d.city||"",state:d.state||"",country:d.country||"",postalCode:d.postalCode||"",phone:d.phone||"",email:d.email||"",website:d.website||"",taxId:d.taxId||"",registrationNo:d.registrationNo||"",logoUrl:O,logoHtml:T},delivery:{delivery_no:String(B.delivery_no||""),delivery_date:B.delivery_date?String(B.delivery_date).slice(0,10):"",order_no:String(B.order_no||""),order_date:B.order_date?String(B.order_date).slice(0,10):"",delivery_method:String(B.delivery_method||""),our_ref:String(B.our_ref||""),vehicle_no:String(B.vehicle_no||""),waybill_no:String(B.waybill_no||"")},customer:{id:String((Q&&Q.id)??B.customer_id??""),code:String((Q&&Q.customer_code)??B.customer_code??""),name:String((Q&&Q.customer_name)??B.customer_name??""),type:String((Q&&Q.customer_type)??B.customer_type??""),contactPerson:String((Q&&Q.contact_person)??B.contact_person??""),email:String((Q&&Q.email)??B.email??""),phone:String((Q&&Q.phone)??B.phone??""),mobile:String((Q&&Q.mobile)??B.mobile??""),address:String((Q&&Q.address)??B.address??""),city:String((Q&&Q.city)??B.city??""),state:String((Q&&Q.state)??B.state??""),zone:String((Q&&Q.zone)??B.zone??""),country:String((Q&&Q.country)??B.country??""),paymentTerms:String((Q&&Q.payment_terms)??B.payment_terms??""),creditLimit:Number((Q&&Q.credit_limit)??B.credit_limit??0).toFixed(2),priceTypeName:String((Q&&Q.price_type_name)??""),currencyId:String((Q&&Q.currency_id)??"")},items:V,totals:{total:D.toFixed(2),total_qty:Y.toFixed(2)}}},S=async B=>{var W,K,_;await y();const q=await te.get(`/sales/deliveries/${B}`),Q=((W=q.data)==null?void 0:W.item)||{},O=Array.isArray((K=q.data)==null?void 0:K.details)?q.data.details:[],T=await N(Q)||await b(Q.customer_id)||null,V=j(Q,O,T),D=L2(V),Y=$O(D),M=document.createElement("iframe");M.style.position="fixed",M.style.right="0",M.style.bottom="0",M.style.width="0",M.style.height="0",M.style.border="0",document.body.appendChild(M);const X=((_=M.contentWindow)==null?void 0:_.document)||M.contentDocument||null;if(!X)return document.body.removeChild(M),!1;X.open(),X.write(Y),X.close();const R=M.contentWindow||window;return setTimeout(()=>{R.focus();try{R.print()}catch{}setTimeout(()=>{document.body.removeChild(M)},100)},200),!0},k=async B=>{var M,X;await y();const q=await te.get(`/sales/deliveries/${B}`),Q=((M=q.data)==null?void 0:M.item)||{},O=Array.isArray((X=q.data)==null?void 0:X.details)?q.data.details:[],T=await N(Q)||await b(Q.customer_id)||null,V=j(Q,O,T),D=L2(V),Y=document.createElement("div");Y.style.position="fixed",Y.style.left="-10000px",Y.style.top="0",Y.style.width="794px",Y.style.background="white",Y.style.padding="32px",Y.innerHTML=D,document.body.appendChild(Y);try{await WO(Y);const R=await Wn(Y,{scale:2,useCORS:!0}),H=R.toDataURL("image/png"),W=new As("p","mm","a4"),K=W.internal.pageSize.getWidth(),_=W.internal.pageSize.getHeight(),F=K,E=R.height*F/R.width;let L=0;for(;L<E;)W.addImage(H,"PNG",0,-L,F,E),L+=_,L<E&&W.addPage();const U=String(Q.delivery_no||"DN").replaceAll(" ","_");W.save(`delivery-${U}.pdf`)}finally{document.body.removeChild(Y)}return!0};async function P(B){var q,Q;try{if(l(""),await S(B))return;const O=await g(B);O.autoPrint&&O.autoPrint(),O.output("dataurlnewwindow")}catch(O){l(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to print delivery"),console.error(O)}}async function I(B){var q,Q,O;try{if(l(""),await k(B))return;const T=await g(B),V=String(((q=s.find(D=>String(D.id)===String(B)))==null?void 0:q.delivery_no)||"DN").replaceAll(" ","_");T.save(`delivery-${V}.pdf`)}catch(T){l(((O=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:O.message)||"Failed to download delivery"),console.error(T)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Delivery Notes"}),e.jsx("p",{className:"text-sm mt-1",children:"Track deliveries issued for sales orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/sales/delivery/new",className:"btn-success",children:"+ New Delivery"})]})]})})}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"input",placeholder:"Search delivery no or customer...",value:o,onChange:B=>u(B.target.value)})})}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading deliveries..."})]}):x.length===0?e.jsx("div",{className:"text-center py-12",children:"No deliveries found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Delivery No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.map(B=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:B.delivery_no}),e.jsx("td",{children:new Date(B.delivery_date).toLocaleDateString()}),e.jsx("td",{children:B.customer_name}),e.jsx("td",{children:B.status}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-brand hover:text-brand-600 font-medium text-sm",onClick:()=>t(`/sales/delivery/${B.id}`),children:"View"}),e.jsxs("button",{type:"button",className:"ml-2 btn-primary text-xs px-3 py-1.5 gap-1",onClick:()=>P(B.id),children:[e.jsx(kC,{className:"w-4 h-4"}),"Print"]}),e.jsxs("button",{type:"button",className:"ml-1 btn-outline text-xs px-3 py-1.5 gap-1",onClick:()=>I(B.id),children:[e.jsx(gu,{className:"w-4 h-4"}),"Download"]}),String(B.status||"").toUpperCase()!=="DELIVERED"&&e.jsx("button",{className:"text-blue-600 hover:text-blue-700 font-medium text-sm",onClick:()=>t(`/sales/delivery/${B.id}`),children:"Edit"})]})})]},B.id))})]})})]})})]})}function D2(){const t=Ns(),{id:s}=Ps(),r=!!s,{scope:a}=Qa(),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[u,d]=v.useState(null),[c,m]=v.useState(null),[h,f]=v.useState([]),[x,g]=v.useState({delivery_no:"",delivery_date:new Date().toISOString().split("T")[0],customer_id:"",sales_order_id:"",status:"DRAFT",remarks:"",items:[]}),[b,y]=v.useState(""),[N,j]=v.useState([]),[S,k]=v.useState([]),[P,I]=v.useState([]);v.useEffect(()=>{B(),q(),Q(),T(),r?V(s):(async()=>{try{const X=await O();g(R=>({...R,delivery_no:X}))}catch{g(X=>({...X,delivery_no:"DN-000001"}))}})()},[s]);async function B(){try{const X=await te.get("/sales/customers");j(X.data.items||[])}catch(X){console.error("Failed to load customers",X)}}async function q(){try{const X=await te.get("/sales/invoices");k(X.data.items||[])}catch(X){console.error("Failed to load invoices",X)}}async function Q(){var X;try{const R=await te.get("/inventory/items");I(Array.isArray((X=R.data)==null?void 0:X.items)?R.data.items:[])}catch(R){console.error("Failed to load items",R)}}async function O(){var X;try{return((X=(await te.get("/sales/deliveries/next-no")).data)==null?void 0:X.nextNo)||""||"DN-000001"}catch(R){return console.error("Failed to fetch deliveries for next no",R),"DN-000001"}}const T=async()=>{var X;try{const R=await te.get("/finance/tax-codes"),W=(Array.isArray((X=R.data)==null?void 0:X.items)?R.data.items:[]).map(K=>({value:K.id,label:K.name,rate:Number(K.rate_percent)}));f(W)}catch(R){console.error("Error fetching tax codes:",R)}};async function V(X){var R,H;try{i(!0);const W=await te.get(`/sales/deliveries/${X}`),K=((R=W.data)==null?void 0:R.item)||{},_=Array.isArray((H=W.data)==null?void 0:H.details)?W.data.details:[];g(F=>({...F,delivery_no:K.delivery_no||F.delivery_no,delivery_date:(K.delivery_date?String(K.delivery_date).slice(0,10):F.delivery_date)||F.delivery_date,customer_id:K.customer_id||"",sales_order_id:K.sales_order_id||"",status:K.status||F.status,remarks:K.remarks||"",items:_.map(E=>({item_id:E.item_id,item_name:E.item_name||"",quantity:Number(E.quantity||0),ordered_qty:Number(E.quantity||0),tax_type:E.tax_id||"",uom:E.uom||"PCS",unit_price:Number(E.unit_price||0)}))})),i(!1)}catch{d("Failed to load delivery"),i(!1)}}async function D(X){if(X)try{i(!0);const R=S.find(H=>String(H.id)===String(X));if(R){R.sales_order_id||console.warn("This invoice is not linked to a sales order.");let H=null,W=[];if(R.sales_order_id){const _=await te.get(`/sales/orders/${R.sales_order_id}`);H=_.data.item,W=_.data.details}const K=W.length>0?W:[];g(_=>({..._,customer_id:R.customer_id,sales_order_id:R.sales_order_id||"",items:K.map(F=>{var E;return{item_id:F.item_id,item_name:F.item_name||((E=P.find(L=>String(L.id)===String(F.item_id)))==null?void 0:E.item_name)||"",quantity:F.quantity,ordered_qty:F.quantity,tax_type:F.tax_id||(h.length>0?h[0].value:""),uom:F.uom||"PCS",unit_price:Number(F.unit_price||0)}})})),y(H?H.order_no:""),m(`Loaded from Invoice ${R.invoice_no}`)}}catch(R){console.error(R),alert("Error loading invoice details")}finally{i(!1)}}async function Y(X){if(X.preventDefault(),!x.customer_id){alert("Please select a customer");return}try{o(!0);const R={...x,company_id:a==null?void 0:a.companyId,branch_id:a==null?void 0:a.branchId,items:x.items.map(H=>{const W=h.find(K=>K.value==H.tax_type);return{item_id:H.item_id,quantity:Number(H.quantity),tax_id:H.tax_type,tax_rate:W?W.rate:0,tax_amount:0}})};r?await te.put(`/sales/deliveries/${s}`,R):await te.post("/sales/deliveries",R),m("Delivery saved successfully"),setTimeout(()=>t("/sales/delivery"),1500)}catch(R){d("Failed to save delivery"),console.error(R)}finally{o(!1)}}function M(X){r&&s?(async()=>{try{await te.put(`/sales/deliveries/${s}/status`,{status:X}),g(R=>({...R,status:X})),m(`Status updated to ${X}`)}catch(R){d("Failed to update status"),console.error(R)}})():g(R=>({...R,status:X}))}return n&&!x.customer_id?e.jsx("div",{className:"p-8",children:"Loading..."}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(If,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-2xl font-bold",children:r?"Edit Delivery":"New Delivery"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>M("DELIVERED"),disabled:!r||l||String(x.status||"").toUpperCase()==="DELIVERED",className:"btn-success flex items-center gap-2",children:[e.jsx(YT,{className:"w-4 h-4"}),"Auto Delivery"]}),e.jsxs("button",{onClick:Y,disabled:l,className:"btn-primary flex items-center gap-2",children:[e.jsx(Hh,{className:"w-4 h-4"}),"Save Delivery"]})]})]}),u&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded mb-6",children:u}),c&&e.jsx("div",{className:"bg-green-50 text-green-600 p-4 rounded mb-6",children:c}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Delivery Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery No"}),e.jsx("input",{type:"text",value:x.delivery_no,onChange:X=>g({...x,delivery_no:X.target.value}),className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:x.delivery_date,onChange:X=>g({...x,delivery_date:X.target.value}),className:"w-full border rounded p-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),e.jsxs("select",{id:"customer",value:x.customer_id,onChange:X=>g({...x,customer_id:X.target.value}),className:"w-full border rounded p-2",children:[e.jsx("option",{value:"",children:"Select Customer"}),N.map(X=>e.jsx("option",{value:X.id,children:X.customer_name},X.id))]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Load Items"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded border col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Invoice"}),e.jsxs("select",{className:"w-full border rounded p-2",onChange:X=>D(X.target.value),defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select an Invoice..."}),S.map(X=>e.jsxs("option",{value:X.id,children:[X.invoice_no," -"," ",new Date(X.invoice_date).toLocaleDateString()," (",X.total_amount,")"]},X.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecting an invoice will populate customer and order details."})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded border col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sales Order Number"}),e.jsx("input",{type:"text",placeholder:"Sales Order No",value:b,readOnly:!0,className:"w-full border rounded p-2 bg-gray-100 text-gray-500 cursor-not-allowed"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Item"}),e.jsx("th",{className:"p-3 w-28",children:"Ordered"}),e.jsx("th",{className:"p-3 w-28",children:"To Deliver"}),e.jsx("th",{className:"p-3 w-20",children:"UOM"}),e.jsx("th",{className:"p-3 w-28",children:"Unit Price"}),e.jsx("th",{className:"p-3 w-40",children:"Tax"}),e.jsx("th",{className:"p-3 w-12",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:x.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-500",children:"No items loaded. Search for an order or invoice."})}):x.items.map((X,R)=>{var H;return e.jsxs("tr",{children:[e.jsx("td",{className:"p-3",children:X.item_name||((H=P.find(W=>String(W.id)===String(X.item_id)))==null?void 0:H.item_name)||""}),e.jsx("td",{className:"p-3",children:X.ordered_qty}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:X.quantity,onChange:W=>{const K=[...x.items];K[R].quantity=parseFloat(W.target.value)||0,g({...x,items:K})},className:"w-full border rounded p-1"})}),e.jsx("td",{className:"p-3",children:X.uom||"PCS"}),e.jsx("td",{className:"p-3",children:Number(X.unit_price||0).toFixed(2)}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:X.tax_type||"",onChange:W=>{const K=[...x.items];K[R].tax_type=W.target.value,g({...x,items:K})},className:"w-full border rounded p-1",children:[e.jsx("option",{value:"",children:"None"}),h.map(W=>e.jsx("option",{value:W.value,children:W.label},W.value))]})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>{const W=x.items.filter((K,_)=>_!==R);g({...x,items:W})},className:"text-red-500 hover:text-red-700",children:""})})]},R)})})]})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Shipping Info"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{value:x.remarks,onChange:X=>g({...x,remarks:X.target.value}),rows:"4",className:"w-full border rounded p-2"})]})})]})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var i0={};i0.version="0.18.5";var b4=1252,KO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],l1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},o1=function(t){KO.indexOf(t)!=-1&&(b4=l1[0]=t)};function zO(){o1(1252)}var So=function(t){o1(t)};function c1(){So(1200),zO()}function P2(t){for(var s=[],r=0,a=t.length;r<a;++r)s[r]=t.charCodeAt(r);return s}function YO(t){for(var s=[],r=0;r<t.length>>1;++r)s[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return s.join("")}function y4(t){for(var s=[],r=0;r<t.length>>1;++r)s[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return s.join("")}var Lm=function(t){var s=t.charCodeAt(0),r=t.charCodeAt(1);return s==255&&r==254?YO(t.slice(2)):s==254&&r==255?y4(t.slice(2)):s==65279?t.slice(1):t},ix=function(s){return String.fromCharCode(s)},U2=function(s){return String.fromCharCode(s)},hf,au="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mf(t){for(var s="",r=0,a=0,n=0,i=0,l=0,o=0,u=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,a=t.charCodeAt(d++),l=(r&3)<<4|a>>4,n=t.charCodeAt(d++),o=(a&15)<<2|n>>6,u=n&63,isNaN(a)?o=u=64:isNaN(n)&&(u=64),s+=au.charAt(i)+au.charAt(l)+au.charAt(o)+au.charAt(u);return s}function wl(t){var s="",r=0,a=0,n=0,i=0,l=0,o=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=au.indexOf(t.charAt(d++)),l=au.indexOf(t.charAt(d++)),r=i<<2|l>>4,s+=String.fromCharCode(r),o=au.indexOf(t.charAt(d++)),a=(l&15)<<4|o>>2,o!==64&&(s+=String.fromCharCode(a)),u=au.indexOf(t.charAt(d++)),n=(o&3)<<6|u,u!==64&&(s+=String.fromCharCode(n));return s}var or=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),nd=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(s,r){return r?new Buffer(s,r):new Buffer(s)}:Buffer.from.bind(Buffer)}return function(){}})();function hu(t){return or?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function R2(t){return or?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var gl=function(s){return or?nd(s,"binary"):s.split("").map(function(r){return r.charCodeAt(0)&255})};function sg(t){if(typeof ArrayBuffer>"u")return gl(t);for(var s=new ArrayBuffer(t.length),r=new Uint8Array(s),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return s}function bu(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var s=[],r=0;r<t.length;++r)s[r]=String.fromCharCode(t[r]);return s.join("")}function XO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function d1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return d1(new Uint8Array(t));for(var s=new Array(t.length),r=0;r<t.length;++r)s[r]=t[r];return s}var kn=or?function(t){return Buffer.concat(t.map(function(s){return Buffer.isBuffer(s)?s:nd(s)}))}:function(t){if(typeof Uint8Array<"u"){var s=0,r=0;for(s=0;s<t.length;++s)r+=t[s].length;var a=new Uint8Array(r),n=0;for(s=0,r=0;s<t.length;r+=n,++s)if(n=t[s].length,t[s]instanceof Uint8Array)a.set(t[s],r);else{if(typeof t[s]=="string")throw"wtf";a.set(new Uint8Array(t[s]),r)}return a}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function JO(t){for(var s=[],r=0,a=t.length+250,n=hu(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=t.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(s.push(n.slice(0,r)),r=0,n=hu(65535),a=65530)}return s.push(n.slice(0,r)),kn(s)}var Ui=/\u0000/g,Dm=/[\u0001-\u0006]/g;function _h(t){for(var s="",r=t.length-1;r>=0;)s+=t.charAt(r--);return s}function Co(t,s){var r=""+t;return r.length>=s?r:Ua("0",s-r.length)+r}function u1(t,s){var r=""+t;return r.length>=s?r:Ua(" ",s-r.length)+r}function l0(t,s){var r=""+t;return r.length>=s?r:r+Ua(" ",s-r.length)}function ZO(t,s){var r=""+Math.round(t);return r.length>=s?r:Ua("0",s-r.length)+r}function eQ(t,s){var r=""+t;return r.length>=s?r:Ua("0",s-r.length)+r}var O2=Math.pow(2,32);function ih(t,s){if(t>O2||t<-O2)return ZO(t,s);var r=Math.round(t);return eQ(r,s)}function o0(t,s){return s=s||0,t.length>=7+s&&(t.charCodeAt(s)|32)===103&&(t.charCodeAt(s+1)|32)===101&&(t.charCodeAt(s+2)|32)===110&&(t.charCodeAt(s+3)|32)===101&&(t.charCodeAt(s+4)|32)===114&&(t.charCodeAt(s+5)|32)===97&&(t.charCodeAt(s+6)|32)===108}var Q2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],zv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function tQ(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ws={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},M2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},sQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function c0(t,s,r){for(var a=t<0?-1:1,n=t*a,i=0,l=1,o=0,u=1,d=0,c=0,m=Math.floor(n);d<s&&(m=Math.floor(n),o=m*l+i,c=m*d+u,!(n-m<5e-8));)n=1/(n-m),i=l,l=o,u=d,d=c;if(c>s&&(d>s?(c=u,o=i):(c=d,o=l)),!r)return[0,a*o,c];var h=Math.floor(a*o/c);return[h,a*o-h*c,c]}function nA(t,s,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),i=0,l=[],o={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),s&&s.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),l=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),a<60&&(i=(i+6)%7),r&&(i=oQ(u,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var j4=new Date(1899,11,31,0,0,0),rQ=j4.getTime(),aQ=new Date(1900,2,1,0,0,0);function N4(t,s){var r=t.getTime();return s?r-=1461*24*60*60*1e3:t>=aQ&&(r+=1440*60*1e3),(r-(rQ+(t.getTimezoneOffset()-j4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function A1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function nQ(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function iQ(t){var s=t<0?12:11,r=A1(t.toFixed(12));return r.length<=s||(r=t.toPrecision(10),r.length<=s)?r:t.toExponential(5)}function lQ(t){var s=A1(t.toFixed(11));return s.length>(t<0?12:11)||s==="0"||s==="-0"?t.toPrecision(6):s}function ff(t){var s=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return s>=-4&&s<=-1?r=t.toPrecision(10+s):Math.abs(s)<=9?r=iQ(t):s===10?r=t.toFixed(10).substr(0,12):r=lQ(t),A1(nQ(r.toUpperCase()))}function xA(t,s){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):ff(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Xl(14,N4(t,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+t)}function oQ(t,s){s[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function cQ(t,s,r,a){var n="",i=0,l=0,o=r.y,u,d=0;switch(t){case 98:o=r.y+543;case 121:switch(s.length){case 1:case 2:u=o%100,d=2;break;default:u=o%1e4,d=4;break}break;case 109:switch(s.length){case 1:case 2:u=r.m,d=s.length;break;case 3:return zv[r.m-1][1];case 5:return zv[r.m-1][0];default:return zv[r.m-1][2]}break;case 100:switch(s.length){case 1:case 2:u=r.d,d=s.length;break;case 3:return Q2[r.q][0];default:return Q2[r.q][1]}break;case 104:switch(s.length){case 1:case 2:u=1+(r.H+11)%12,d=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:u=r.H,d=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:u=r.M,d=s.length;break;default:throw"bad minute format: "+s}break;case 115:if(s!="s"&&s!="ss"&&s!=".0"&&s!=".00"&&s!=".000")throw"bad second format: "+s;return r.u===0&&(s=="s"||s=="ss")?Co(r.S,s.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),s==="s"?i===0?"0":""+i/l:(n=Co(i,2+a),s==="ss"?n.substr(0,2):"."+n.substr(2,s.length-1)));case 90:switch(s){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+s}d=s.length===3?1:2;break;case 101:u=o,d=1;break}var c=d>0?Co(u,d):"";return c}function nu(t){var s=3;if(t.length<=s)return t;for(var r=t.length%s,a=t.substr(0,r);r!=t.length;r+=s)a+=(a.length>0?",":"")+t.substr(r,s);return a}var w4=/%/g;function dQ(t,s,r){var a=s.replace(w4,""),n=s.length-a.length;return Xc(t,a,r*Math.pow(10,2*n))+Ua("%",n)}function uQ(t,s,r){for(var a=s.length-1;s.charCodeAt(a-1)===44;)--a;return Xc(t,s.substr(0,a),r/Math.pow(10,3*(s.length-a)))}function _4(t,s){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+_4(t,-s);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(s)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(s/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(s)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,d,c){return u+d+c.substr(0,(n+i)%n)+"."+c.substr(i)+"E"})}else r=s.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var S4=/# (\?+)( ?)\/( ?)(\d+)/;function AQ(t,s,r){var a=parseInt(t[4],10),n=Math.round(s*a),i=Math.floor(n/a),l=n-i*a,o=a;return r+(i===0?"":""+i)+" "+(l===0?Ua(" ",t[1].length+1+t[4].length):u1(l,t[1].length)+t[2]+"/"+t[3]+Co(o,t[4].length))}function hQ(t,s,r){return r+(s===0?"":""+s)+Ua(" ",t[1].length+2+t[4].length)}var C4=/^#*0*\.([0#]+)/,B4=/\).*[0#]/,k4=/\(###\) ###\\?-####/;function Li(t){for(var s="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(r)}return s}function H2(t,s){var r=Math.pow(10,s);return""+Math.round(t*r)/r}function q2(t,s){var r=t-Math.floor(t),a=Math.pow(10,s);return s<(""+Math.round(r*a)).length?0:Math.round(r*a)}function mQ(t,s){return s<(""+Math.round((t-Math.floor(t))*Math.pow(10,s))).length?1:0}function fQ(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ql(t,s,r){if(t.charCodeAt(0)===40&&!s.match(B4)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ql("n",a,r):"("+Ql("n",a,-r)+")"}if(s.charCodeAt(s.length-1)===44)return uQ(t,s,r);if(s.indexOf("%")!==-1)return dQ(t,s,r);if(s.indexOf("E")!==-1)return _4(s,r);if(s.charCodeAt(0)===36)return"$"+Ql(t,s.substr(s.charAt(1)==" "?2:1),r);var n,i,l,o,u=Math.abs(r),d=r<0?"-":"";if(s.match(/^00+$/))return d+ih(u,s.length);if(s.match(/^[#?]+$/))return n=ih(r,0),n==="0"&&(n=""),n.length>s.length?n:Li(s.substr(0,s.length-n.length))+n;if(i=s.match(S4))return AQ(i,u,d);if(s.match(/^#+0+$/))return d+ih(u,s.length-s.indexOf("0"));if(i=s.match(C4))return n=H2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Li(i[1])).replace(/\.$/,"."+Li(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+Ua("0",Li(i[1]).length-g.length)}),s.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),i=s.match(/^(0*)\.(#*)$/))return d+H2(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=s.match(/^#{1,3},##0(\.?)$/))return d+nu(ih(u,0));if(i=s.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ql(t,s,-r):nu(""+(Math.floor(r)+mQ(r,i[1].length)))+"."+Co(q2(r,i[1].length),i[1].length);if(i=s.match(/^#,#*,#0/))return Ql(t,s.replace(/^#,#*,/,""),r);if(i=s.match(/^([0#]+)(\\?-([0#]+))+$/))return n=_h(Ql(t,s.replace(/[\\-]/g,""),r)),l=0,_h(_h(s.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<n.length?n.charAt(l++):x==="0"?"0":""}));if(s.match(k4))return n=Ql(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var c="";if(i=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=c0(u,Math.pow(10,l)-1,!1),n=""+d,c=Xc("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),n+=c+i[2]+"/"+i[3],c=l0(o[2],l),c.length<i[4].length&&(c=Li(i[4].substr(i[4].length-c.length))+c),n+=c,n;if(i=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=c0(u,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?u1(o[1],l)+i[2]+"/"+i[3]+l0(o[2],l):Ua(" ",2*l+1+i[2].length+i[3].length));if(i=s.match(/^[#0?]+$/))return n=ih(r,0),s.length<=n.length?n:Li(s.substr(0,s.length-n.length))+n;if(i=s.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var m=s.indexOf(".")-l,h=s.length-n.length-m;return Li(s.substr(0,m)+n+s.substr(s.length-h))}if(i=s.match(/^00,000\.([#0]*0)$/))return l=q2(r,i[1].length),r<0?"-"+Ql(t,s,-r):nu(fQ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Co(0,3-x.length):"")+x})+"."+Co(l,i[1].length);switch(s){case"###,##0.00":return Ql(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=nu(ih(u,0));return f!=="0"?d+f:"";case"###,###.00":return Ql(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ql(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+s+"|")}function pQ(t,s,r){for(var a=s.length-1;s.charCodeAt(a-1)===44;)--a;return Xc(t,s.substr(0,a),r/Math.pow(10,3*(s.length-a)))}function xQ(t,s,r){var a=s.replace(w4,""),n=s.length-a.length;return Xc(t,a,r*Math.pow(10,2*n))+Ua("%",n)}function E4(t,s){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+E4(t,-s);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(s)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(s/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(s)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,d,c){return u+d+c.substr(0,(n+i)%n)+"."+c.substr(i)+"E"})}else r=s.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function rc(t,s,r){if(t.charCodeAt(0)===40&&!s.match(B4)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rc("n",a,r):"("+rc("n",a,-r)+")"}if(s.charCodeAt(s.length-1)===44)return pQ(t,s,r);if(s.indexOf("%")!==-1)return xQ(t,s,r);if(s.indexOf("E")!==-1)return E4(s,r);if(s.charCodeAt(0)===36)return"$"+rc(t,s.substr(s.charAt(1)==" "?2:1),r);var n,i,l,o,u=Math.abs(r),d=r<0?"-":"";if(s.match(/^00+$/))return d+Co(u,s.length);if(s.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>s.length?n:Li(s.substr(0,s.length-n.length))+n;if(i=s.match(S4))return hQ(i,u,d);if(s.match(/^#+0+$/))return d+Co(u,s.length-s.indexOf("0"));if(i=s.match(C4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Li(i[1])).replace(/\.$/,"."+Li(i[1])),n=n.replace(/\.(\d*)$/,function(x,g){return"."+g+Ua("0",Li(i[1]).length-g.length)}),s.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),i=s.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=s.match(/^#{1,3},##0(\.?)$/))return d+nu(""+u);if(i=s.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rc(t,s,-r):nu(""+r)+"."+Ua("0",i[1].length);if(i=s.match(/^#,#*,#0/))return rc(t,s.replace(/^#,#*,/,""),r);if(i=s.match(/^([0#]+)(\\?-([0#]+))+$/))return n=_h(rc(t,s.replace(/[\\-]/g,""),r)),l=0,_h(_h(s.replace(/\\/g,"")).replace(/[0#]/g,function(x){return l<n.length?n.charAt(l++):x==="0"?"0":""}));if(s.match(k4))return n=rc(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var c="";if(i=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=c0(u,Math.pow(10,l)-1,!1),n=""+d,c=Xc("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),n+=c+i[2]+"/"+i[3],c=l0(o[2],l),c.length<i[4].length&&(c=Li(i[4].substr(i[4].length-c.length))+c),n+=c,n;if(i=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=c0(u,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?u1(o[1],l)+i[2]+"/"+i[3]+l0(o[2],l):Ua(" ",2*l+1+i[2].length+i[3].length));if(i=s.match(/^[#0?]+$/))return n=""+r,s.length<=n.length?n:Li(s.substr(0,s.length-n.length))+n;if(i=s.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var m=s.indexOf(".")-l,h=s.length-n.length-m;return Li(s.substr(0,m)+n+s.substr(s.length-h))}if(i=s.match(/^00,000\.([#0]*0)$/))return r<0?"-"+rc(t,s,-r):nu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Co(0,3-x.length):"")+x})+"."+Co(0,i[1].length);switch(s){case"###,###":case"##,###":case"#,###":var f=nu(""+u);return f!=="0"?d+f:"";default:if(s.match(/\.[0#?]*$/))return rc(t,s.slice(0,s.lastIndexOf(".")),r)+Li(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}function Xc(t,s,r){return(r|0)===r?rc(t,s,r):Ql(t,s,r)}function gQ(t){for(var s=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:s[s.length]=t.substr(n,a-n),n=a+1}if(s[s.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return s}var F4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Vh(t){for(var s=0,r="",a="";s<t.length;)switch(r=t.charAt(s)){case"G":o0(t,s)&&(s+=6),s++;break;case'"':for(;t.charCodeAt(++s)!==34&&s<t.length;);++s;break;case"\\":s+=2;break;case"_":s+=2;break;case"@":++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(s,3).toUpperCase()==="A/P"||t.substr(s,5).toUpperCase()==="AM/PM"||t.substr(s,5).toUpperCase()==="/")return!0;++s;break;case"[":for(a=r;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.match(F4))return!0;break;case".":case"0":case"#":for(;s<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++s))>-1||r=="\\"&&t.charAt(s+1)=="-"&&"0#".indexOf(t.charAt(s+2))>-1););break;case"?":for(;t.charAt(++s)===r;);break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;);break;case" ":++s;break;default:++s;break}return!1}function vQ(t,s,r,a){for(var n=[],i="",l=0,o="",u="t",d,c,m,h="H";l<t.length;)switch(o=t.charAt(l)){case"G":if(!o0(t,l))throw new Error("unrecognized character "+o+" in "+t);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(m=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(m);n[n.length]={t:"t",v:i},++l;break;case"\\":var f=t.charAt(++l),x=f==="("||f===")"?f:"t";n[n.length]={t:x,v:f},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:s},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=nA(s,r,t.charAt(l+1)==="2"),d==null))return"";n[n.length]={t:"X",v:t.substr(l,2)},u=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0||d==null&&(d=nA(s,r),d==null))return"";for(i=o;++l<t.length&&t.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),n[n.length]={t:o,v:i},u=o;break;case"A":case"a":case"":var g={t:o,v:o};if(d==null&&(d=nA(s,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(g.v=d.H>=12?"P":"A"),g.t="T",h="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(g.v=d.H>=12?"PM":"AM"),g.t="T",l+=5,h="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(g.v=d.H>=12?"":""),g.t="T",l+=5,h="h"):(g.t="t",++l),d==null&&g.t==="T")return"";n[n.length]=g,u=o;break;case"[":for(i=o;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(F4)){if(d==null&&(d=nA(s,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Vh(t)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<t.length&&(o=t.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},u=o;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);n[n.length]={t:"t",v:o},++l;break}var b=0,y=0,N;for(l=n.length-1,u="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=h,u="h",b<1&&(b=1);break;case"s":(N=n[l].v.match(/\.0+$/))&&(y=Math.max(y,N[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=n[l].t;break;case"m":u==="s"&&(n[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&n[l].v.match(/[Hh]/)&&(b=1),b<2&&n[l].v.match(/[Mm]/)&&(b=2),b<3&&n[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var j="",S;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=cQ(n[l].t.charCodeAt(0),n[l].v,d,y),n[l].t="t";break;case"n":case"?":for(S=l+1;n[S]!=null&&((o=n[S].t)==="?"||o==="D"||(o===" "||o==="t")&&n[S+1]!=null&&(n[S+1].t==="?"||n[S+1].t==="t"&&n[S+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[S].v==="/"||n[S].v===" "&&n[S+1]!=null&&n[S+1].t=="?"));)n[l].v+=n[S].v,n[S]={v:"",t:";"},++S;j+=n[l].v,l=S-1;break;case"G":n[l].t="t",n[l].v=xA(s,r);break}var k="",P,I;if(j.length>0){j.charCodeAt(0)==40?(P=s<0&&j.charCodeAt(0)===45?-s:s,I=Xc("n",j,P)):(P=s<0&&a>1?-s:s,I=Xc("n",j,P),P<0&&n[0]&&n[0].t=="t"&&(I=I.substr(1),n[0].v="-"+n[0].v)),S=I.length-1;var B=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){B=l;break}var q=n.length;if(B===n.length&&I.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(S>=n[l].v.length-1?(S-=n[l].v.length,n[l].v=I.substr(S+1,n[l].v.length)):S<0?n[l].v="":(n[l].v=I.substr(0,S+1),S=-1),n[l].t="t",q=l);S>=0&&q<n.length&&(n[q].v=I.substr(0,S+1)+n[q].v)}else if(B!==n.length&&I.indexOf("E")===-1){for(S=I.indexOf(".")-1,l=B;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(c=n[l].v.indexOf(".")>-1&&l===B?n[l].v.indexOf(".")-1:n[l].v.length-1,k=n[l].v.substr(c+1);c>=0;--c)S>=0&&(n[l].v.charAt(c)==="0"||n[l].v.charAt(c)==="#")&&(k=I.charAt(S--)+k);n[l].v=k,n[l].t="t",q=l}for(S>=0&&q<n.length&&(n[q].v=I.substr(0,S+1)+n[q].v),S=I.indexOf(".")+1,l=B;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==B)){for(c=n[l].v.indexOf(".")>-1&&l===B?n[l].v.indexOf(".")+1:0,k=n[l].v.substr(0,c);c<n[l].v.length;++c)S<I.length&&(k+=I.charAt(S++));n[l].v=k,n[l].t="t",q=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(P=a>1&&s<0&&l>0&&n[l-1].v==="-"?-s:s,n[l].v=Xc(n[l].t,n[l].v,P),n[l].t="t");var Q="";for(l=0;l!==n.length;++l)n[l]!=null&&(Q+=n[l].v);return Q}var V2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $2(t,s){if(s==null)return!1;var r=parseFloat(s[2]);switch(s[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function bQ(t,s){var r=gQ(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof s!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=s>0?r[0]:s<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(V2),o=r[1].match(V2);return $2(s,l)?[a,r[0]]:$2(s,o)?[a,r[1]]:[a,r[l!=null&&o!=null?2:1]]}return[a,i]}function Xl(t,s,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ws)[t],a==null&&(a=r.table&&r.table[M2[t]]||Ws[M2[t]]),a==null&&(a=sQ[t]||"General");break}if(o0(a,0))return xA(s,r);s instanceof Date&&(s=N4(s,r.date1904));var n=bQ(a,s);if(o0(n[1]))return xA(s,r);if(s===!0)s="TRUE";else if(s===!1)s="FALSE";else if(s===""||s==null)return"";return vQ(n[1],s,r,n[0])}function Jc(t,s){if(typeof s!="number"){s=+s||-1;for(var r=0;r<392;++r){if(Ws[r]==null){s<0&&(s=r);continue}if(Ws[r]==t){s=r;break}}s<0&&(s=391)}return Ws[s]=t,s}function rg(t){for(var s=0;s!=392;++s)t[s]!==void 0&&Jc(t[s],s)}function $h(){Ws=tQ()}var yQ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},T4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function jQ(t){var s=typeof t=="number"?Ws[t]:t;return s=s.replace(T4,"(\\d+)"),new RegExp("^"+s+"$")}function NQ(t,s,r){var a=-1,n=-1,i=-1,l=-1,o=-1,u=-1;(s.match(T4)||[]).forEach(function(m,h){var f=parseInt(r[h+1],10);switch(m.toLowerCase().charAt(0)){case"y":a=f;break;case"d":i=f;break;case"h":l=f;break;case"s":u=f;break;case"m":l>=0?o=f:n=f;break}}),u>=0&&o==-1&&n>=0&&(o=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var c=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return l==-1&&o==-1&&u==-1?d:a==-1&&n==-1&&i==-1?c:d+"T"+c}var wQ=(function(){var t={};t.version="1.2.0";function s(){for(var I=0,B=new Array(256),q=0;q!=256;++q)I=q,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,B[q]=I;return typeof Int32Array<"u"?new Int32Array(B):B}var r=s();function a(I){var B=0,q=0,Q=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Q=0;Q!=256;++Q)O[Q]=I[Q];for(Q=0;Q!=256;++Q)for(q=I[Q],B=256+Q;B<4096;B+=256)q=O[B]=q>>>8^I[q&255];var T=[];for(Q=1;Q!=16;++Q)T[Q-1]=typeof Int32Array<"u"?O.subarray(Q*256,Q*256+256):O.slice(Q*256,Q*256+256);return T}var n=a(r),i=n[0],l=n[1],o=n[2],u=n[3],d=n[4],c=n[5],m=n[6],h=n[7],f=n[8],x=n[9],g=n[10],b=n[11],y=n[12],N=n[13],j=n[14];function S(I,B){for(var q=B^-1,Q=0,O=I.length;Q<O;)q=q>>>8^r[(q^I.charCodeAt(Q++))&255];return~q}function k(I,B){for(var q=B^-1,Q=I.length-15,O=0;O<Q;)q=j[I[O++]^q&255]^N[I[O++]^q>>8&255]^y[I[O++]^q>>16&255]^b[I[O++]^q>>>24]^g[I[O++]]^x[I[O++]]^f[I[O++]]^h[I[O++]]^m[I[O++]]^c[I[O++]]^d[I[O++]]^u[I[O++]]^o[I[O++]]^l[I[O++]]^i[I[O++]]^r[I[O++]];for(Q+=15;O<Q;)q=q>>>8^r[(q^I[O++])&255];return~q}function P(I,B){for(var q=B^-1,Q=0,O=I.length,T=0,V=0;Q<O;)T=I.charCodeAt(Q++),T<128?q=q>>>8^r[(q^T)&255]:T<2048?(q=q>>>8^r[(q^(192|T>>6&31))&255],q=q>>>8^r[(q^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,V=I.charCodeAt(Q++)&1023,q=q>>>8^r[(q^(240|T>>8&7))&255],q=q>>>8^r[(q^(128|T>>2&63))&255],q=q>>>8^r[(q^(128|V>>6&15|(T&3)<<4))&255],q=q>>>8^r[(q^(128|V&63))&255]):(q=q>>>8^r[(q^(224|T>>12&15))&255],q=q>>>8^r[(q^(128|T>>6&63))&255],q=q>>>8^r[(q^(128|T&63))&255]);return~q}return t.table=r,t.bstr=S,t.buf=k,t.str=P,t})(),Qs=(function(){var s={};s.version="1.2.1";function r(fe,Oe){for(var Se=fe.split("/"),Le=Oe.split("/"),Ye=0,st=0,It=Math.min(Se.length,Le.length);Ye<It;++Ye){if(st=Se[Ye].length-Le[Ye].length)return st;if(Se[Ye]!=Le[Ye])return Se[Ye]<Le[Ye]?-1:1}return Se.length-Le.length}function a(fe){if(fe.charAt(fe.length-1)=="/")return fe.slice(0,-1).indexOf("/")===-1?fe:a(fe.slice(0,-1));var Oe=fe.lastIndexOf("/");return Oe===-1?fe:fe.slice(0,Oe+1)}function n(fe){if(fe.charAt(fe.length-1)=="/")return n(fe.slice(0,-1));var Oe=fe.lastIndexOf("/");return Oe===-1?fe:fe.slice(Oe+1)}function i(fe,Oe){typeof Oe=="string"&&(Oe=new Date(Oe));var Se=Oe.getHours();Se=Se<<6|Oe.getMinutes(),Se=Se<<5|Oe.getSeconds()>>>1,fe.write_shift(2,Se);var Le=Oe.getFullYear()-1980;Le=Le<<4|Oe.getMonth()+1,Le=Le<<5|Oe.getDate(),fe.write_shift(2,Le)}function l(fe){var Oe=fe.read_shift(2)&65535,Se=fe.read_shift(2)&65535,Le=new Date,Ye=Se&31;Se>>>=5;var st=Se&15;Se>>>=4,Le.setMilliseconds(0),Le.setFullYear(Se+1980),Le.setMonth(st-1),Le.setDate(Ye);var It=Oe&31;Oe>>>=5;var Ft=Oe&63;return Oe>>>=6,Le.setHours(Oe),Le.setMinutes(Ft),Le.setSeconds(It<<1),Le}function o(fe){qn(fe,0);for(var Oe={},Se=0;fe.l<=fe.length-4;){var Le=fe.read_shift(2),Ye=fe.read_shift(2),st=fe.l+Ye,It={};switch(Le){case 21589:Se=fe.read_shift(1),Se&1&&(It.mtime=fe.read_shift(4)),Ye>5&&(Se&2&&(It.atime=fe.read_shift(4)),Se&4&&(It.ctime=fe.read_shift(4))),It.mtime&&(It.mt=new Date(It.mtime*1e3));break}fe.l=st,Oe[Le]=It}return Oe}var u;function d(){return u||(u={})}function c(fe,Oe){if(fe[0]==80&&fe[1]==75)return lt(fe,Oe);if((fe[0]|32)==109&&(fe[1]|32)==105)return rt(fe,Oe);if(fe.length<512)throw new Error("CFB file size "+fe.length+" < 512");var Se=3,Le=512,Ye=0,st=0,It=0,Ft=0,Bt=0,Tt=[],Me=fe.slice(0,512);qn(Me,0);var Nt=m(Me);switch(Se=Nt[0],Se){case 3:Le=512;break;case 4:Le=4096;break;case 0:if(Nt[1]==0)return lt(fe,Oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+Se)}Le!==512&&(Me=fe.slice(0,Le),qn(Me,28));var Et=fe.slice(0,Le);h(Me,Se);var $t=Me.read_shift(4,"i");if(Se===3&&$t!==0)throw new Error("# Directory Sectors: Expected 0 saw "+$t);Me.l+=4,It=Me.read_shift(4,"i"),Me.l+=4,Me.chk("00100000","Mini Stream Cutoff Size: "),Ft=Me.read_shift(4,"i"),Ye=Me.read_shift(4,"i"),Bt=Me.read_shift(4,"i"),st=Me.read_shift(4,"i");for(var Ht=-1,Ot=0;Ot<109&&(Ht=Me.read_shift(4,"i"),!(Ht<0));++Ot)Tt[Ot]=Ht;var ls=f(fe,Le);b(Bt,st,ls,Le,Tt);var Ls=N(ls,It,Tt,Le);Ls[It].name="!Directory",Ye>0&&Ft!==V&&(Ls[Ft].name="!MiniFAT"),Ls[Tt[0]].name="!FAT",Ls.fat_addrs=Tt,Ls.ssz=Le;var Is={},Hs=[],Ir=[],ya=[];j(It,Ls,ls,Hs,Ye,Is,Ir,Ft),x(Ir,ya,Hs),Hs.shift();var yr={FileIndex:Ir,FullPaths:ya};return Oe&&Oe.raw&&(yr.raw={header:Et,sectors:ls}),yr}function m(fe){if(fe[fe.l]==80&&fe[fe.l+1]==75)return[0,0];fe.chk(D,"Header Signature: "),fe.l+=16;var Oe=fe.read_shift(2,"u");return[fe.read_shift(2,"u"),Oe]}function h(fe,Oe){var Se=9;switch(fe.l+=2,Se=fe.read_shift(2)){case 9:if(Oe!=3)throw new Error("Sector Shift: Expected 9 saw "+Se);break;case 12:if(Oe!=4)throw new Error("Sector Shift: Expected 12 saw "+Se);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Se)}fe.chk("0600","Mini Sector Shift: "),fe.chk("000000000000","Reserved: ")}function f(fe,Oe){for(var Se=Math.ceil(fe.length/Oe)-1,Le=[],Ye=1;Ye<Se;++Ye)Le[Ye-1]=fe.slice(Ye*Oe,(Ye+1)*Oe);return Le[Se-1]=fe.slice(Se*Oe),Le}function x(fe,Oe,Se){for(var Le=0,Ye=0,st=0,It=0,Ft=0,Bt=Se.length,Tt=[],Me=[];Le<Bt;++Le)Tt[Le]=Me[Le]=Le,Oe[Le]=Se[Le];for(;Ft<Me.length;++Ft)Le=Me[Ft],Ye=fe[Le].L,st=fe[Le].R,It=fe[Le].C,Tt[Le]===Le&&(Ye!==-1&&Tt[Ye]!==Ye&&(Tt[Le]=Tt[Ye]),st!==-1&&Tt[st]!==st&&(Tt[Le]=Tt[st])),It!==-1&&(Tt[It]=Le),Ye!==-1&&Le!=Tt[Le]&&(Tt[Ye]=Tt[Le],Me.lastIndexOf(Ye)<Ft&&Me.push(Ye)),st!==-1&&Le!=Tt[Le]&&(Tt[st]=Tt[Le],Me.lastIndexOf(st)<Ft&&Me.push(st));for(Le=1;Le<Bt;++Le)Tt[Le]===Le&&(st!==-1&&Tt[st]!==st?Tt[Le]=Tt[st]:Ye!==-1&&Tt[Ye]!==Ye&&(Tt[Le]=Tt[Ye]));for(Le=1;Le<Bt;++Le)if(fe[Le].type!==0){if(Ft=Le,Ft!=Tt[Ft])do Ft=Tt[Ft],Oe[Le]=Oe[Ft]+"/"+Oe[Le];while(Ft!==0&&Tt[Ft]!==-1&&Ft!=Tt[Ft]);Tt[Le]=-1}for(Oe[0]+="/",Le=1;Le<Bt;++Le)fe[Le].type!==2&&(Oe[Le]+="/")}function g(fe,Oe,Se){for(var Le=fe.start,Ye=fe.size,st=[],It=Le;Se&&Ye>0&&It>=0;)st.push(Oe.slice(It*T,It*T+T)),Ye-=T,It=Zu(Se,It*4);return st.length===0?Jt(0):kn(st).slice(0,fe.size)}function b(fe,Oe,Se,Le,Ye){var st=V;if(fe===V){if(Oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(fe!==-1){var It=Se[fe],Ft=(Le>>>2)-1;if(!It)return;for(var Bt=0;Bt<Ft&&(st=Zu(It,Bt*4))!==V;++Bt)Ye.push(st);b(Zu(It,Le-4),Oe-1,Se,Le,Ye)}}function y(fe,Oe,Se,Le,Ye){var st=[],It=[];Ye||(Ye=[]);var Ft=Le-1,Bt=0,Tt=0;for(Bt=Oe;Bt>=0;){Ye[Bt]=!0,st[st.length]=Bt,It.push(fe[Bt]);var Me=Se[Math.floor(Bt*4/Le)];if(Tt=Bt*4&Ft,Le<4+Tt)throw new Error("FAT boundary crossed: "+Bt+" 4 "+Le);if(!fe[Me])break;Bt=Zu(fe[Me],Tt)}return{nodes:st,data:r_([It])}}function N(fe,Oe,Se,Le){var Ye=fe.length,st=[],It=[],Ft=[],Bt=[],Tt=Le-1,Me=0,Nt=0,Et=0,$t=0;for(Me=0;Me<Ye;++Me)if(Ft=[],Et=Me+Oe,Et>=Ye&&(Et-=Ye),!It[Et]){Bt=[];var Ht=[];for(Nt=Et;Nt>=0;){Ht[Nt]=!0,It[Nt]=!0,Ft[Ft.length]=Nt,Bt.push(fe[Nt]);var Ot=Se[Math.floor(Nt*4/Le)];if($t=Nt*4&Tt,Le<4+$t)throw new Error("FAT boundary crossed: "+Nt+" 4 "+Le);if(!fe[Ot]||(Nt=Zu(fe[Ot],$t),Ht[Nt]))break}st[Et]={nodes:Ft,data:r_([Bt])}}return st}function j(fe,Oe,Se,Le,Ye,st,It,Ft){for(var Bt=0,Tt=Le.length?2:0,Me=Oe[fe].data,Nt=0,Et=0,$t;Nt<Me.length;Nt+=128){var Ht=Me.slice(Nt,Nt+128);qn(Ht,64),Et=Ht.read_shift(2),$t=v1(Ht,0,Et-Tt),Le.push($t);var Ot={name:$t,type:Ht.read_shift(1),color:Ht.read_shift(1),L:Ht.read_shift(4,"i"),R:Ht.read_shift(4,"i"),C:Ht.read_shift(4,"i"),clsid:Ht.read_shift(16),state:Ht.read_shift(4,"i"),start:0,size:0},ls=Ht.read_shift(2)+Ht.read_shift(2)+Ht.read_shift(2)+Ht.read_shift(2);ls!==0&&(Ot.ct=S(Ht,Ht.l-8));var Ls=Ht.read_shift(2)+Ht.read_shift(2)+Ht.read_shift(2)+Ht.read_shift(2);Ls!==0&&(Ot.mt=S(Ht,Ht.l-8)),Ot.start=Ht.read_shift(4,"i"),Ot.size=Ht.read_shift(4,"i"),Ot.size<0&&Ot.start<0&&(Ot.size=Ot.type=0,Ot.start=V,Ot.name=""),Ot.type===5?(Bt=Ot.start,Ye>0&&Bt!==V&&(Oe[Bt].name="!StreamData")):Ot.size>=4096?(Ot.storage="fat",Oe[Ot.start]===void 0&&(Oe[Ot.start]=y(Se,Ot.start,Oe.fat_addrs,Oe.ssz)),Oe[Ot.start].name=Ot.name,Ot.content=Oe[Ot.start].data.slice(0,Ot.size)):(Ot.storage="minifat",Ot.size<0?Ot.size=0:Bt!==V&&Ot.start!==V&&Oe[Bt]&&(Ot.content=g(Ot,Oe[Bt].data,(Oe[Ft]||{}).data))),Ot.content&&qn(Ot.content,0),st[$t]=Ot,It.push(Ot)}}function S(fe,Oe){return new Date((xl(fe,Oe+4)/1e7*Math.pow(2,32)+xl(fe,Oe)/1e7-11644473600)*1e3)}function k(fe,Oe){return d(),c(u.readFileSync(fe),Oe)}function P(fe,Oe){var Se=Oe&&Oe.type;switch(Se||or&&Buffer.isBuffer(fe)&&(Se="buffer"),Se||"base64"){case"file":return k(fe,Oe);case"base64":return c(gl(wl(fe)),Oe);case"binary":return c(gl(fe),Oe)}return c(fe,Oe)}function I(fe,Oe){var Se=Oe||{},Le=Se.root||"Root Entry";if(fe.FullPaths||(fe.FullPaths=[]),fe.FileIndex||(fe.FileIndex=[]),fe.FullPaths.length!==fe.FileIndex.length)throw new Error("inconsistent CFB structure");fe.FullPaths.length===0&&(fe.FullPaths[0]=Le+"/",fe.FileIndex[0]={name:Le,type:5}),Se.CLSID&&(fe.FileIndex[0].clsid=Se.CLSID),B(fe)}function B(fe){var Oe="Sh33tJ5";if(!Qs.find(fe,"/"+Oe)){var Se=Jt(4);Se[0]=55,Se[1]=Se[3]=50,Se[2]=54,fe.FileIndex.push({name:Oe,type:2,content:Se,size:4,L:69,R:69,C:69}),fe.FullPaths.push(fe.FullPaths[0]+Oe),q(fe)}}function q(fe,Oe){I(fe);for(var Se=!1,Le=!1,Ye=fe.FullPaths.length-1;Ye>=0;--Ye){var st=fe.FileIndex[Ye];switch(st.type){case 0:Le?Se=!0:(fe.FileIndex.pop(),fe.FullPaths.pop());break;case 1:case 2:case 5:Le=!0,isNaN(st.R*st.L*st.C)&&(Se=!0),st.R>-1&&st.L>-1&&st.R==st.L&&(Se=!0);break;default:Se=!0;break}}if(!(!Se&&!Oe)){var It=new Date(1987,1,19),Ft=0,Bt=Object.create?Object.create(null):{},Tt=[];for(Ye=0;Ye<fe.FullPaths.length;++Ye)Bt[fe.FullPaths[Ye]]=!0,fe.FileIndex[Ye].type!==0&&Tt.push([fe.FullPaths[Ye],fe.FileIndex[Ye]]);for(Ye=0;Ye<Tt.length;++Ye){var Me=a(Tt[Ye][0]);Le=Bt[Me],Le||(Tt.push([Me,{name:n(Me).replace("/",""),type:1,clsid:M,ct:It,mt:It,content:null}]),Bt[Me]=!0)}for(Tt.sort(function($t,Ht){return r($t[0],Ht[0])}),fe.FullPaths=[],fe.FileIndex=[],Ye=0;Ye<Tt.length;++Ye)fe.FullPaths[Ye]=Tt[Ye][0],fe.FileIndex[Ye]=Tt[Ye][1];for(Ye=0;Ye<Tt.length;++Ye){var Nt=fe.FileIndex[Ye],Et=fe.FullPaths[Ye];if(Nt.name=n(Et).replace("/",""),Nt.L=Nt.R=Nt.C=-(Nt.color=1),Nt.size=Nt.content?Nt.content.length:0,Nt.start=0,Nt.clsid=Nt.clsid||M,Ye===0)Nt.C=Tt.length>1?1:-1,Nt.size=0,Nt.type=5;else if(Et.slice(-1)=="/"){for(Ft=Ye+1;Ft<Tt.length&&a(fe.FullPaths[Ft])!=Et;++Ft);for(Nt.C=Ft>=Tt.length?-1:Ft,Ft=Ye+1;Ft<Tt.length&&a(fe.FullPaths[Ft])!=a(Et);++Ft);Nt.R=Ft>=Tt.length?-1:Ft,Nt.type=1}else a(fe.FullPaths[Ye+1]||"")==a(Et)&&(Nt.R=Ye+1),Nt.type=2}}}function Q(fe,Oe){var Se=Oe||{};if(Se.fileType=="mad")return ht(fe,Se);switch(q(fe),Se.fileType){case"zip":return Xe(fe,Se)}var Le=(function($t){for(var Ht=0,Ot=0,ls=0;ls<$t.FileIndex.length;++ls){var Ls=$t.FileIndex[ls];if(Ls.content){var Is=Ls.content.length;Is>0&&(Is<4096?Ht+=Is+63>>6:Ot+=Is+511>>9)}}for(var Hs=$t.FullPaths.length+3>>2,Ir=Ht+7>>3,ya=Ht+127>>7,yr=Ir+Ot+Hs+ya,cr=yr+127>>7,ka=cr<=109?0:Math.ceil((cr-109)/127);yr+cr+ka+127>>7>cr;)ka=++cr<=109?0:Math.ceil((cr-109)/127);var Ks=[1,ka,cr,ya,Hs,Ot,Ht,0];return $t.FileIndex[0].size=Ht<<6,Ks[7]=($t.FileIndex[0].start=Ks[0]+Ks[1]+Ks[2]+Ks[3]+Ks[4]+Ks[5])+(Ks[6]+7>>3),Ks})(fe),Ye=Jt(Le[7]<<9),st=0,It=0;{for(st=0;st<8;++st)Ye.write_shift(1,Y[st]);for(st=0;st<8;++st)Ye.write_shift(2,0);for(Ye.write_shift(2,62),Ye.write_shift(2,3),Ye.write_shift(2,65534),Ye.write_shift(2,9),Ye.write_shift(2,6),st=0;st<3;++st)Ye.write_shift(2,0);for(Ye.write_shift(4,0),Ye.write_shift(4,Le[2]),Ye.write_shift(4,Le[0]+Le[1]+Le[2]+Le[3]-1),Ye.write_shift(4,0),Ye.write_shift(4,4096),Ye.write_shift(4,Le[3]?Le[0]+Le[1]+Le[2]-1:V),Ye.write_shift(4,Le[3]),Ye.write_shift(-4,Le[1]?Le[0]-1:V),Ye.write_shift(4,Le[1]),st=0;st<109;++st)Ye.write_shift(-4,st<Le[2]?Le[1]+st:-1)}if(Le[1])for(It=0;It<Le[1];++It){for(;st<236+It*127;++st)Ye.write_shift(-4,st<Le[2]?Le[1]+st:-1);Ye.write_shift(-4,It===Le[1]-1?V:It+1)}var Ft=function($t){for(It+=$t;st<It-1;++st)Ye.write_shift(-4,st+1);$t&&(++st,Ye.write_shift(-4,V))};for(It=st=0,It+=Le[1];st<It;++st)Ye.write_shift(-4,X.DIFSECT);for(It+=Le[2];st<It;++st)Ye.write_shift(-4,X.FATSECT);Ft(Le[3]),Ft(Le[4]);for(var Bt=0,Tt=0,Me=fe.FileIndex[0];Bt<fe.FileIndex.length;++Bt)Me=fe.FileIndex[Bt],Me.content&&(Tt=Me.content.length,!(Tt<4096)&&(Me.start=It,Ft(Tt+511>>9)));for(Ft(Le[6]+7>>3);Ye.l&511;)Ye.write_shift(-4,X.ENDOFCHAIN);for(It=st=0,Bt=0;Bt<fe.FileIndex.length;++Bt)Me=fe.FileIndex[Bt],Me.content&&(Tt=Me.content.length,!(!Tt||Tt>=4096)&&(Me.start=It,Ft(Tt+63>>6)));for(;Ye.l&511;)Ye.write_shift(-4,X.ENDOFCHAIN);for(st=0;st<Le[4]<<2;++st){var Nt=fe.FullPaths[st];if(!Nt||Nt.length===0){for(Bt=0;Bt<17;++Bt)Ye.write_shift(4,0);for(Bt=0;Bt<3;++Bt)Ye.write_shift(4,-1);for(Bt=0;Bt<12;++Bt)Ye.write_shift(4,0);continue}Me=fe.FileIndex[st],st===0&&(Me.start=Me.size?Me.start-1:V);var Et=st===0&&Se.root||Me.name;if(Tt=2*(Et.length+1),Ye.write_shift(64,Et,"utf16le"),Ye.write_shift(2,Tt),Ye.write_shift(1,Me.type),Ye.write_shift(1,Me.color),Ye.write_shift(-4,Me.L),Ye.write_shift(-4,Me.R),Ye.write_shift(-4,Me.C),Me.clsid)Ye.write_shift(16,Me.clsid,"hex");else for(Bt=0;Bt<4;++Bt)Ye.write_shift(4,0);Ye.write_shift(4,Me.state||0),Ye.write_shift(4,0),Ye.write_shift(4,0),Ye.write_shift(4,0),Ye.write_shift(4,0),Ye.write_shift(4,Me.start),Ye.write_shift(4,Me.size),Ye.write_shift(4,0)}for(st=1;st<fe.FileIndex.length;++st)if(Me=fe.FileIndex[st],Me.size>=4096)if(Ye.l=Me.start+1<<9,or&&Buffer.isBuffer(Me.content))Me.content.copy(Ye,Ye.l,0,Me.size),Ye.l+=Me.size+511&-512;else{for(Bt=0;Bt<Me.size;++Bt)Ye.write_shift(1,Me.content[Bt]);for(;Bt&511;++Bt)Ye.write_shift(1,0)}for(st=1;st<fe.FileIndex.length;++st)if(Me=fe.FileIndex[st],Me.size>0&&Me.size<4096)if(or&&Buffer.isBuffer(Me.content))Me.content.copy(Ye,Ye.l,0,Me.size),Ye.l+=Me.size+63&-64;else{for(Bt=0;Bt<Me.size;++Bt)Ye.write_shift(1,Me.content[Bt]);for(;Bt&63;++Bt)Ye.write_shift(1,0)}if(or)Ye.l=Ye.length;else for(;Ye.l<Ye.length;)Ye.write_shift(1,0);return Ye}function O(fe,Oe){var Se=fe.FullPaths.map(function(Bt){return Bt.toUpperCase()}),Le=Se.map(function(Bt){var Tt=Bt.split("/");return Tt[Tt.length-(Bt.slice(-1)=="/"?2:1)]}),Ye=!1;Oe.charCodeAt(0)===47?(Ye=!0,Oe=Se[0].slice(0,-1)+Oe):Ye=Oe.indexOf("/")!==-1;var st=Oe.toUpperCase(),It=Ye===!0?Se.indexOf(st):Le.indexOf(st);if(It!==-1)return fe.FileIndex[It];var Ft=!st.match(Dm);for(st=st.replace(Ui,""),Ft&&(st=st.replace(Dm,"!")),It=0;It<Se.length;++It)if((Ft?Se[It].replace(Dm,"!"):Se[It]).replace(Ui,"")==st||(Ft?Le[It].replace(Dm,"!"):Le[It]).replace(Ui,"")==st)return fe.FileIndex[It];return null}var T=64,V=-2,D="d0cf11e0a1b11ae1",Y=[208,207,17,224,161,177,26,225],M="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:D,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:M,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function R(fe,Oe,Se){d();var Le=Q(fe,Se);u.writeFileSync(Oe,Le)}function H(fe){for(var Oe=new Array(fe.length),Se=0;Se<fe.length;++Se)Oe[Se]=String.fromCharCode(fe[Se]);return Oe.join("")}function W(fe,Oe){var Se=Q(fe,Oe);switch(Oe&&Oe.type||"buffer"){case"file":return d(),u.writeFileSync(Oe.filename,Se),Se;case"binary":return typeof Se=="string"?Se:H(Se);case"base64":return mf(typeof Se=="string"?Se:H(Se));case"buffer":if(or)return Buffer.isBuffer(Se)?Se:nd(Se);case"array":return typeof Se=="string"?gl(Se):Se}return Se}var K;function _(fe){try{var Oe=fe.InflateRaw,Se=new Oe;if(Se._processChunk(new Uint8Array([3,0]),Se._finishFlushFlag),Se.bytesRead)K=fe;else throw new Error("zlib does not expose bytesRead")}catch(Le){console.error("cannot use native zlib: "+(Le.message||Le))}}function F(fe,Oe){if(!K)return Re(fe,Oe);var Se=K.InflateRaw,Le=new Se,Ye=Le._processChunk(fe.slice(fe.l),Le._finishFlushFlag);return fe.l+=Le.bytesRead,Ye}function E(fe){return K?K.deflateRawSync(fe):He(fe)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(fe){var Oe=(fe<<1|fe<<11)&139536|(fe<<5|fe<<15)&558144;return(Oe>>16|Oe>>8|Oe)&255}for(var Z=typeof Uint8Array<"u",oe=Z?new Uint8Array(256):[],ee=0;ee<256;++ee)oe[ee]=ae(ee);function se(fe,Oe){var Se=oe[fe&255];return Oe<=8?Se>>>8-Oe:(Se=Se<<8|oe[fe>>8&255],Oe<=16?Se>>>16-Oe:(Se=Se<<8|oe[fe>>16&255],Se>>>24-Oe))}function Ae(fe,Oe){var Se=Oe&7,Le=Oe>>>3;return(fe[Le]|(Se<=6?0:fe[Le+1]<<8))>>>Se&3}function we(fe,Oe){var Se=Oe&7,Le=Oe>>>3;return(fe[Le]|(Se<=5?0:fe[Le+1]<<8))>>>Se&7}function ce(fe,Oe){var Se=Oe&7,Le=Oe>>>3;return(fe[Le]|(Se<=4?0:fe[Le+1]<<8))>>>Se&15}function le(fe,Oe){var Se=Oe&7,Le=Oe>>>3;return(fe[Le]|(Se<=3?0:fe[Le+1]<<8))>>>Se&31}function _e(fe,Oe){var Se=Oe&7,Le=Oe>>>3;return(fe[Le]|(Se<=1?0:fe[Le+1]<<8))>>>Se&127}function Qe(fe,Oe,Se){var Le=Oe&7,Ye=Oe>>>3,st=(1<<Se)-1,It=fe[Ye]>>>Le;return Se<8-Le||(It|=fe[Ye+1]<<8-Le,Se<16-Le)||(It|=fe[Ye+2]<<16-Le,Se<24-Le)||(It|=fe[Ye+3]<<24-Le),It&st}function Ie(fe,Oe,Se){var Le=Oe&7,Ye=Oe>>>3;return Le<=5?fe[Ye]|=(Se&7)<<Le:(fe[Ye]|=Se<<Le&255,fe[Ye+1]=(Se&7)>>8-Le),Oe+3}function ke(fe,Oe,Se){var Le=Oe&7,Ye=Oe>>>3;return Se=(Se&1)<<Le,fe[Ye]|=Se,Oe+1}function pe(fe,Oe,Se){var Le=Oe&7,Ye=Oe>>>3;return Se<<=Le,fe[Ye]|=Se&255,Se>>>=8,fe[Ye+1]=Se,Oe+8}function he(fe,Oe,Se){var Le=Oe&7,Ye=Oe>>>3;return Se<<=Le,fe[Ye]|=Se&255,Se>>>=8,fe[Ye+1]=Se&255,fe[Ye+2]=Se>>>8,Oe+16}function je(fe,Oe){var Se=fe.length,Le=2*Se>Oe?2*Se:Oe+5,Ye=0;if(Se>=Oe)return fe;if(or){var st=R2(Le);if(fe.copy)fe.copy(st);else for(;Ye<fe.length;++Ye)st[Ye]=fe[Ye];return st}else if(Z){var It=new Uint8Array(Le);if(It.set)It.set(fe);else for(;Ye<Se;++Ye)It[Ye]=fe[Ye];return It}return fe.length=Le,fe}function me(fe){for(var Oe=new Array(fe),Se=0;Se<fe;++Se)Oe[Se]=0;return Oe}function xe(fe,Oe,Se){var Le=1,Ye=0,st=0,It=0,Ft=0,Bt=fe.length,Tt=Z?new Uint16Array(32):me(32);for(st=0;st<32;++st)Tt[st]=0;for(st=Bt;st<Se;++st)fe[st]=0;Bt=fe.length;var Me=Z?new Uint16Array(Bt):me(Bt);for(st=0;st<Bt;++st)Tt[Ye=fe[st]]++,Le<Ye&&(Le=Ye),Me[st]=0;for(Tt[0]=0,st=1;st<=Le;++st)Tt[st+16]=Ft=Ft+Tt[st-1]<<1;for(st=0;st<Bt;++st)Ft=fe[st],Ft!=0&&(Me[st]=Tt[Ft+16]++);var Nt=0;for(st=0;st<Bt;++st)if(Nt=fe[st],Nt!=0)for(Ft=se(Me[st],Le)>>Le-Nt,It=(1<<Le+4-Nt)-1;It>=0;--It)Oe[Ft|It<<Nt]=Nt&15|st<<4;return Le}var Ue=Z?new Uint16Array(512):me(512),ct=Z?new Uint16Array(32):me(32);if(!Z){for(var dt=0;dt<512;++dt)Ue[dt]=0;for(dt=0;dt<32;++dt)ct[dt]=0}(function(){for(var fe=[],Oe=0;Oe<32;Oe++)fe.push(5);xe(fe,ct,32);var Se=[];for(Oe=0;Oe<=143;Oe++)Se.push(8);for(;Oe<=255;Oe++)Se.push(9);for(;Oe<=279;Oe++)Se.push(7);for(;Oe<=287;Oe++)Se.push(8);xe(Se,Ue,288)})();var We=(function(){for(var Oe=Z?new Uint8Array(32768):[],Se=0,Le=0;Se<J.length-1;++Se)for(;Le<J[Se+1];++Le)Oe[Le]=Se;for(;Le<32768;++Le)Oe[Le]=29;var Ye=Z?new Uint8Array(259):[];for(Se=0,Le=0;Se<U.length-1;++Se)for(;Le<U[Se+1];++Le)Ye[Le]=Se;function st(Ft,Bt){for(var Tt=0;Tt<Ft.length;){var Me=Math.min(65535,Ft.length-Tt),Nt=Tt+Me==Ft.length;for(Bt.write_shift(1,+Nt),Bt.write_shift(2,Me),Bt.write_shift(2,~Me&65535);Me-- >0;)Bt[Bt.l++]=Ft[Tt++]}return Bt.l}function It(Ft,Bt){for(var Tt=0,Me=0,Nt=Z?new Uint16Array(32768):[];Me<Ft.length;){var Et=Math.min(65535,Ft.length-Me);if(Et<10){for(Tt=Ie(Bt,Tt,+(Me+Et==Ft.length)),Tt&7&&(Tt+=8-(Tt&7)),Bt.l=Tt/8|0,Bt.write_shift(2,Et),Bt.write_shift(2,~Et&65535);Et-- >0;)Bt[Bt.l++]=Ft[Me++];Tt=Bt.l*8;continue}Tt=Ie(Bt,Tt,+(Me+Et==Ft.length)+2);for(var $t=0;Et-- >0;){var Ht=Ft[Me];$t=($t<<5^Ht)&32767;var Ot=-1,ls=0;if((Ot=Nt[$t])&&(Ot|=Me&-32768,Ot>Me&&(Ot-=32768),Ot<Me))for(;Ft[Ot+ls]==Ft[Me+ls]&&ls<250;)++ls;if(ls>2){Ht=Ye[ls],Ht<=22?Tt=pe(Bt,Tt,oe[Ht+1]>>1)-1:(pe(Bt,Tt,3),Tt+=5,pe(Bt,Tt,oe[Ht-23]>>5),Tt+=3);var Ls=Ht<8?0:Ht-4>>2;Ls>0&&(he(Bt,Tt,ls-U[Ht]),Tt+=Ls),Ht=Oe[Me-Ot],Tt=pe(Bt,Tt,oe[Ht]>>3),Tt-=3;var Is=Ht<4?0:Ht-2>>1;Is>0&&(he(Bt,Tt,Me-Ot-J[Ht]),Tt+=Is);for(var Hs=0;Hs<ls;++Hs)Nt[$t]=Me&32767,$t=($t<<5^Ft[Me])&32767,++Me;Et-=ls-1}else Ht<=143?Ht=Ht+48:Tt=ke(Bt,Tt,1),Tt=pe(Bt,Tt,oe[Ht]),Nt[$t]=Me&32767,++Me}Tt=pe(Bt,Tt,0)-1}return Bt.l=(Tt+7)/8|0,Bt.l}return function(Bt,Tt){return Bt.length<8?st(Bt,Tt):It(Bt,Tt)}})();function He(fe){var Oe=Jt(50+Math.floor(fe.length*1.1)),Se=We(fe,Oe);return Oe.slice(0,Se)}var ze=Z?new Uint16Array(32768):me(32768),Pe=Z?new Uint16Array(32768):me(32768),Te=Z?new Uint16Array(128):me(128),Ke=1,$e=1;function Ve(fe,Oe){var Se=le(fe,Oe)+257;Oe+=5;var Le=le(fe,Oe)+1;Oe+=5;var Ye=ce(fe,Oe)+4;Oe+=4;for(var st=0,It=Z?new Uint8Array(19):me(19),Ft=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Bt=1,Tt=Z?new Uint8Array(8):me(8),Me=Z?new Uint8Array(8):me(8),Nt=It.length,Et=0;Et<Ye;++Et)It[L[Et]]=st=we(fe,Oe),Bt<st&&(Bt=st),Tt[st]++,Oe+=3;var $t=0;for(Tt[0]=0,Et=1;Et<=Bt;++Et)Me[Et]=$t=$t+Tt[Et-1]<<1;for(Et=0;Et<Nt;++Et)($t=It[Et])!=0&&(Ft[Et]=Me[$t]++);var Ht=0;for(Et=0;Et<Nt;++Et)if(Ht=It[Et],Ht!=0){$t=oe[Ft[Et]]>>8-Ht;for(var Ot=(1<<7-Ht)-1;Ot>=0;--Ot)Te[$t|Ot<<Ht]=Ht&7|Et<<3}var ls=[];for(Bt=1;ls.length<Se+Le;)switch($t=Te[_e(fe,Oe)],Oe+=$t&7,$t>>>=3){case 16:for(st=3+Ae(fe,Oe),Oe+=2,$t=ls[ls.length-1];st-- >0;)ls.push($t);break;case 17:for(st=3+we(fe,Oe),Oe+=3;st-- >0;)ls.push(0);break;case 18:for(st=11+_e(fe,Oe),Oe+=7;st-- >0;)ls.push(0);break;default:ls.push($t),Bt<$t&&(Bt=$t);break}var Ls=ls.slice(0,Se),Is=ls.slice(Se);for(Et=Se;Et<286;++Et)Ls[Et]=0;for(Et=Le;Et<30;++Et)Is[Et]=0;return Ke=xe(Ls,ze,286),$e=xe(Is,Pe,30),Oe}function Ze(fe,Oe){if(fe[0]==3&&!(fe[1]&3))return[hu(Oe),2];for(var Se=0,Le=0,Ye=R2(Oe||1<<18),st=0,It=Ye.length>>>0,Ft=0,Bt=0;(Le&1)==0;){if(Le=we(fe,Se),Se+=3,Le>>>1)Le>>1==1?(Ft=9,Bt=5):(Se=Ve(fe,Se),Ft=Ke,Bt=$e);else{Se&7&&(Se+=8-(Se&7));var Tt=fe[Se>>>3]|fe[(Se>>>3)+1]<<8;if(Se+=32,Tt>0)for(!Oe&&It<st+Tt&&(Ye=je(Ye,st+Tt),It=Ye.length);Tt-- >0;)Ye[st++]=fe[Se>>>3],Se+=8;continue}for(;;){!Oe&&It<st+32767&&(Ye=je(Ye,st+32767),It=Ye.length);var Me=Qe(fe,Se,Ft),Nt=Le>>>1==1?Ue[Me]:ze[Me];if(Se+=Nt&15,Nt>>>=4,(Nt>>>8&255)===0)Ye[st++]=Nt;else{if(Nt==256)break;Nt-=257;var Et=Nt<8?0:Nt-4>>2;Et>5&&(Et=0);var $t=st+U[Nt];Et>0&&($t+=Qe(fe,Se,Et),Se+=Et),Me=Qe(fe,Se,Bt),Nt=Le>>>1==1?ct[Me]:Pe[Me],Se+=Nt&15,Nt>>>=4;var Ht=Nt<4?0:Nt-2>>1,Ot=J[Nt];for(Ht>0&&(Ot+=Qe(fe,Se,Ht),Se+=Ht),!Oe&&It<$t&&(Ye=je(Ye,$t+100),It=Ye.length);st<$t;)Ye[st]=Ye[st-Ot],++st}}}return Oe?[Ye,Se+7>>>3]:[Ye.slice(0,st),Se+7>>>3]}function Re(fe,Oe){var Se=fe.slice(fe.l||0),Le=Ze(Se,Oe);return fe.l+=Le[1],Le[0]}function it(fe,Oe){if(fe)typeof console<"u"&&console.error(Oe);else throw new Error(Oe)}function lt(fe,Oe){var Se=fe;qn(Se,0);var Le=[],Ye=[],st={FileIndex:Le,FullPaths:Ye};I(st,{root:Oe.root});for(var It=Se.length-4;(Se[It]!=80||Se[It+1]!=75||Se[It+2]!=5||Se[It+3]!=6)&&It>=0;)--It;Se.l=It+4,Se.l+=4;var Ft=Se.read_shift(2);Se.l+=6;var Bt=Se.read_shift(4);for(Se.l=Bt,It=0;It<Ft;++It){Se.l+=20;var Tt=Se.read_shift(4),Me=Se.read_shift(4),Nt=Se.read_shift(2),Et=Se.read_shift(2),$t=Se.read_shift(2);Se.l+=8;var Ht=Se.read_shift(4),Ot=o(Se.slice(Se.l+Nt,Se.l+Nt+Et));Se.l+=Nt+Et+$t;var ls=Se.l;Se.l=Ht+4,Ne(Se,Tt,Me,st,Ot),Se.l=ls}return st}function Ne(fe,Oe,Se,Le,Ye){fe.l+=2;var st=fe.read_shift(2),It=fe.read_shift(2),Ft=l(fe);if(st&8257)throw new Error("Unsupported ZIP encryption");for(var Bt=fe.read_shift(4),Tt=fe.read_shift(4),Me=fe.read_shift(4),Nt=fe.read_shift(2),Et=fe.read_shift(2),$t="",Ht=0;Ht<Nt;++Ht)$t+=String.fromCharCode(fe[fe.l++]);if(Et){var Ot=o(fe.slice(fe.l,fe.l+Et));(Ot[21589]||{}).mt&&(Ft=Ot[21589].mt),((Ye||{})[21589]||{}).mt&&(Ft=Ye[21589].mt)}fe.l+=Et;var ls=fe.slice(fe.l,fe.l+Tt);switch(It){case 8:ls=F(fe,Me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+It)}var Ls=!1;st&8&&(Bt=fe.read_shift(4),Bt==134695760&&(Bt=fe.read_shift(4),Ls=!0),Tt=fe.read_shift(4),Me=fe.read_shift(4)),Tt!=Oe&&it(Ls,"Bad compressed size: "+Oe+" != "+Tt),Me!=Se&&it(Ls,"Bad uncompressed size: "+Se+" != "+Me),St(Le,$t,ls,{unsafe:!0,mt:Ft})}function Xe(fe,Oe){var Se=Oe||{},Le=[],Ye=[],st=Jt(1),It=Se.compression?8:0,Ft=0,Bt=0,Tt=0,Me=0,Nt=0,Et=fe.FullPaths[0],$t=Et,Ht=fe.FileIndex[0],Ot=[],ls=0;for(Bt=1;Bt<fe.FullPaths.length;++Bt)if($t=fe.FullPaths[Bt].slice(Et.length),Ht=fe.FileIndex[Bt],!(!Ht.size||!Ht.content||$t=="Sh33tJ5")){var Ls=Me,Is=Jt($t.length);for(Tt=0;Tt<$t.length;++Tt)Is.write_shift(1,$t.charCodeAt(Tt)&127);Is=Is.slice(0,Is.l),Ot[Nt]=wQ.buf(Ht.content,0);var Hs=Ht.content;It==8&&(Hs=E(Hs)),st=Jt(30),st.write_shift(4,67324752),st.write_shift(2,20),st.write_shift(2,Ft),st.write_shift(2,It),Ht.mt?i(st,Ht.mt):st.write_shift(4,0),st.write_shift(-4,Ot[Nt]),st.write_shift(4,Hs.length),st.write_shift(4,Ht.content.length),st.write_shift(2,Is.length),st.write_shift(2,0),Me+=st.length,Le.push(st),Me+=Is.length,Le.push(Is),Me+=Hs.length,Le.push(Hs),st=Jt(46),st.write_shift(4,33639248),st.write_shift(2,0),st.write_shift(2,20),st.write_shift(2,Ft),st.write_shift(2,It),st.write_shift(4,0),st.write_shift(-4,Ot[Nt]),st.write_shift(4,Hs.length),st.write_shift(4,Ht.content.length),st.write_shift(2,Is.length),st.write_shift(2,0),st.write_shift(2,0),st.write_shift(2,0),st.write_shift(2,0),st.write_shift(4,0),st.write_shift(4,Ls),ls+=st.l,Ye.push(st),ls+=Is.length,Ye.push(Is),++Nt}return st=Jt(22),st.write_shift(4,101010256),st.write_shift(2,0),st.write_shift(2,0),st.write_shift(2,Nt),st.write_shift(2,Nt),st.write_shift(4,ls),st.write_shift(4,Me),st.write_shift(2,0),kn([kn(Le),kn(Ye),st])}var Ge={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function at(fe,Oe){if(fe.ctype)return fe.ctype;var Se=fe.name||"",Le=Se.match(/\.([^\.]+)$/);return Le&&Ge[Le[1]]||Oe&&(Le=(Se=Oe).match(/[\.\\]([^\.\\])+$/),Le&&Ge[Le[1]])?Ge[Le[1]]:"application/octet-stream"}function xt(fe){for(var Oe=mf(fe),Se=[],Le=0;Le<Oe.length;Le+=76)Se.push(Oe.slice(Le,Le+76));return Se.join(`\r
`)+`\r
`}function wt(fe){var Oe=fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Tt){var Me=Tt.charCodeAt(0).toString(16).toUpperCase();return"="+(Me.length==1?"0"+Me:Me)});Oe=Oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Oe.charAt(0)==`
`&&(Oe="=0D"+Oe.slice(1)),Oe=Oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Se=[],Le=Oe.split(`\r
`),Ye=0;Ye<Le.length;++Ye){var st=Le[Ye];if(st.length==0){Se.push("");continue}for(var It=0;It<st.length;){var Ft=76,Bt=st.slice(It,It+Ft);Bt.charAt(Ft-1)=="="?Ft--:Bt.charAt(Ft-2)=="="?Ft-=2:Bt.charAt(Ft-3)=="="&&(Ft-=3),Bt=st.slice(It,It+Ft),It+=Ft,It<st.length&&(Bt+="="),Se.push(Bt)}}return Se.join(`\r
`)}function pt(fe){for(var Oe=[],Se=0;Se<fe.length;++Se){for(var Le=fe[Se];Se<=fe.length&&Le.charAt(Le.length-1)=="=";)Le=Le.slice(0,Le.length-1)+fe[++Se];Oe.push(Le)}for(var Ye=0;Ye<Oe.length;++Ye)Oe[Ye]=Oe[Ye].replace(/[=][0-9A-Fa-f]{2}/g,function(st){return String.fromCharCode(parseInt(st.slice(1),16))});return gl(Oe.join(`\r
`))}function ge(fe,Oe,Se){for(var Le="",Ye="",st="",It,Ft=0;Ft<10;++Ft){var Bt=Oe[Ft];if(!Bt||Bt.match(/^\s*$/))break;var Tt=Bt.match(/^(.*?):\s*([^\s].*)$/);if(Tt)switch(Tt[1].toLowerCase()){case"content-location":Le=Tt[2].trim();break;case"content-type":st=Tt[2].trim();break;case"content-transfer-encoding":Ye=Tt[2].trim();break}}switch(++Ft,Ye.toLowerCase()){case"base64":It=gl(wl(Oe.slice(Ft).join("")));break;case"quoted-printable":It=pt(Oe.slice(Ft));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ye)}var Me=St(fe,Le.slice(Se.length),It,{unsafe:!0});st&&(Me.ctype=st)}function rt(fe,Oe){if(H(fe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Se=Oe&&Oe.root||"",Le=(or&&Buffer.isBuffer(fe)?fe.toString("binary"):H(fe)).split(`\r
`),Ye=0,st="";for(Ye=0;Ye<Le.length;++Ye)if(st=Le[Ye],!!/^Content-Location:/i.test(st)&&(st=st.slice(st.indexOf("file")),Se||(Se=st.slice(0,st.lastIndexOf("/")+1)),st.slice(0,Se.length)!=Se))for(;Se.length>0&&(Se=Se.slice(0,Se.length-1),Se=Se.slice(0,Se.lastIndexOf("/")+1),st.slice(0,Se.length)!=Se););var It=(Le[1]||"").match(/boundary="(.*?)"/);if(!It)throw new Error("MAD cannot find boundary");var Ft="--"+(It[1]||""),Bt=[],Tt=[],Me={FileIndex:Bt,FullPaths:Tt};I(Me);var Nt,Et=0;for(Ye=0;Ye<Le.length;++Ye){var $t=Le[Ye];$t!==Ft&&$t!==Ft+"--"||(Et++&&ge(Me,Le.slice(Nt,Ye),Se),Nt=Ye)}return Me}function ht(fe,Oe){var Se=Oe||{},Le=Se.boundary||"SheetJS";Le="------="+Le;for(var Ye=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Le.slice(2)+'"',"","",""],st=fe.FullPaths[0],It=st,Ft=fe.FileIndex[0],Bt=1;Bt<fe.FullPaths.length;++Bt)if(It=fe.FullPaths[Bt].slice(st.length),Ft=fe.FileIndex[Bt],!(!Ft.size||!Ft.content||It=="Sh33tJ5")){It=It.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ls){return"_x"+ls.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ls){return"_u"+ls.charCodeAt(0).toString(16)+"_"});for(var Tt=Ft.content,Me=or&&Buffer.isBuffer(Tt)?Tt.toString("binary"):H(Tt),Nt=0,Et=Math.min(1024,Me.length),$t=0,Ht=0;Ht<=Et;++Ht)($t=Me.charCodeAt(Ht))>=32&&$t<128&&++Nt;var Ot=Nt>=Et*4/5;Ye.push(Le),Ye.push("Content-Location: "+(Se.root||"file:///C:/SheetJS/")+It),Ye.push("Content-Transfer-Encoding: "+(Ot?"quoted-printable":"base64")),Ye.push("Content-Type: "+at(Ft,It)),Ye.push(""),Ye.push(Ot?wt(Me):xt(Me))}return Ye.push(Le+`--\r
`),Ye.join(`\r
`)}function ft(fe){var Oe={};return I(Oe,fe),Oe}function St(fe,Oe,Se,Le){var Ye=Le&&Le.unsafe;Ye||I(fe);var st=!Ye&&Qs.find(fe,Oe);if(!st){var It=fe.FullPaths[0];Oe.slice(0,It.length)==It?It=Oe:(It.slice(-1)!="/"&&(It+="/"),It=(It+Oe).replace("//","/")),st={name:n(Oe),type:2},fe.FileIndex.push(st),fe.FullPaths.push(It),Ye||Qs.utils.cfb_gc(fe)}return st.content=Se,st.size=Se?Se.length:0,Le&&(Le.CLSID&&(st.clsid=Le.CLSID),Le.mt&&(st.mt=Le.mt),Le.ct&&(st.ct=Le.ct)),st}function Je(fe,Oe){I(fe);var Se=Qs.find(fe,Oe);if(Se){for(var Le=0;Le<fe.FileIndex.length;++Le)if(fe.FileIndex[Le]==Se)return fe.FileIndex.splice(Le,1),fe.FullPaths.splice(Le,1),!0}return!1}function ts(fe,Oe,Se){I(fe);var Le=Qs.find(fe,Oe);if(Le){for(var Ye=0;Ye<fe.FileIndex.length;++Ye)if(fe.FileIndex[Ye]==Le)return fe.FileIndex[Ye].name=n(Se),fe.FullPaths[Ye]=Se,!0}return!1}function Kt(fe){q(fe,!0)}return s.find=O,s.read=P,s.parse=c,s.write=W,s.writeFile=R,s.utils={cfb_new:ft,cfb_add:St,cfb_del:Je,cfb_mov:ts,cfb_gc:Kt,ReadShift:Gm,CheckField:eB,prep_blob:qn,bconcat:kn,use_zlib:_,_deflateRaw:He,_inflateRaw:Re,consts:X},s})();function _Q(t){return typeof t=="string"?sg(t):Array.isArray(t)?XO(t):t}function Uf(t,s,r){if(typeof Deno<"u"){if(r&&typeof s=="string")switch(r){case"utf8":s=new TextEncoder(r).encode(s);break;case"binary":s=sg(s);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,s)}var a=r=="utf8"?lc(s):s;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([_Q(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(s)&&(s=bu(s)),o.write(s),o.close(),s}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function SQ(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(t);s.open("r"),s.encoding="binary";var r=s.read();return s.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function Oa(t){for(var s=Object.keys(t),r=[],a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t,s[a])&&r.push(s[a]);return r}function W2(t,s){for(var r=[],a=Oa(t),n=0;n!==a.length;++n)r[t[a[n]][s]]==null&&(r[t[a[n]][s]]=a[n]);return r}function ag(t){for(var s=[],r=Oa(t),a=0;a!==r.length;++a)s[t[r[a]]]=r[a];return s}function ng(t){for(var s=[],r=Oa(t),a=0;a!==r.length;++a)s[t[r[a]]]=parseInt(r[a],10);return s}function CQ(t){for(var s=[],r=Oa(t),a=0;a!==r.length;++a)s[t[r[a]]]==null&&(s[t[r[a]]]=[]),s[t[r[a]]].push(r[a]);return s}var d0=new Date(1899,11,30,0,0,0);function xn(t,s){var r=t.getTime(),a=d0.getTime()+(t.getTimezoneOffset()-d0.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var I4=new Date,BQ=d0.getTime()+(I4.getTimezoneOffset()-d0.getTimezoneOffset())*6e4,G2=I4.getTimezoneOffset();function ig(t){var s=new Date;return s.setTime(t*24*60*60*1e3+BQ),s.getTimezoneOffset()!==G2&&s.setTime(s.getTime()+(s.getTimezoneOffset()-G2)*6e4),s}function kQ(t){var s=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}s+=r*parseInt(n[i],10)}return s}var K2=new Date("2017-02-19T19:06:09.000Z"),L4=isNaN(K2.getFullYear())?new Date("2/19/17"):K2,EQ=L4.getFullYear()==2017;function Aa(t,s){var r=new Date(t);if(EQ)return s>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):s<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(L4.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function gA(t,s){if(or&&Buffer.isBuffer(t)){if(s){if(t[0]==255&&t[1]==254)return lc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return lc(y4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(s){if(t[0]==255&&t[1]==254)return lc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return lc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function ha(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=ha(t[r]));return s}function Ua(t,s){for(var r="";r.length<s;)r+=t;return r}function Bo(t){var s=Number(t);if(!isNaN(s))return isFinite(s)?s:NaN;if(!/\d/.test(t))return s;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(s=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(s=Number(a)))?s/r:s}var FQ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lh(t){var s=new Date(t),r=new Date(NaN),a=s.getYear(),n=s.getMonth(),i=s.getDate();if(isNaN(i))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&FQ.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?s:t.match(/[^-0-9:,\/\\]/)?r:s}var TQ=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}})();function D4(t){return t?t.content&&t.type?gA(t.content,!0):t.data?Lm(t.data):t.asNodeBuffer&&or?Lm(t.asNodeBuffer().toString("binary")):t.asBinary?Lm(t.asBinary()):t._data&&t._data.getContent?Lm(gA(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function P4(t){if(!t)return null;if(t.data)return P2(t.data);if(t.asNodeBuffer&&or)return t.asNodeBuffer();if(t._data&&t._data.getContent){var s=t._data.getContent();return typeof s=="string"?P2(s):Array.prototype.slice.call(s)}return t.content&&t.type?t.content:null}function IQ(t){return t&&t.name.slice(-4)===".bin"?P4(t):D4(t)}function Vl(t,s){for(var r=t.FullPaths||Oa(t.files),a=s.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function h1(t,s){var r=Vl(t,s);if(r==null)throw new Error("Cannot find file "+s+" in zip");return r}function an(t,s,r){if(!r)return IQ(h1(t,s));if(!s)return null;try{return an(t,s)}catch{return null}}function vl(t,s,r){if(!r)return D4(h1(t,s));if(!s)return null;try{return vl(t,s)}catch{return null}}function LQ(t,s,r){return P4(h1(t,s))}function z2(t){for(var s=t.FullPaths||Oa(t.files),r=[],a=0;a<s.length;++a)s[a].slice(-1)!="/"&&r.push(s[a].replace(/^Root Entry[\/]/,""));return r.sort()}function lr(t,s,r){if(t.FullPaths){if(typeof r=="string"){var a;return or?a=nd(r):a=JO(r),Qs.utils.cfb_add(t,s,a)}Qs.utils.cfb_add(t,s,r)}else t.file(s,r)}function m1(){return Qs.utils.cfb_new()}function U4(t,s){switch(s.type){case"base64":return Qs.read(t,{type:"base64"});case"binary":return Qs.read(t,{type:"binary"});case"buffer":case"array":return Qs.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+s.type)}function Pm(t,s){if(t.charAt(0)=="/")return t.slice(1);var r=s.split("/");s.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Za=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,DQ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Y2=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,PQ=/<[^>]*>/g,bi=Za.match(Y2)?Y2:PQ,UQ=/<\w*:/,RQ=/<(\/?)\w+:/;function Js(t,s,r){for(var a={},n=0,i=0;n!==t.length&&!((i=t.charCodeAt(n))===32||i===10||i===13);++n);if(s||(a[0]=t.slice(0,n)),n===t.length)return a;var l=t.match(DQ),o=0,u="",d=0,c="",m="",h=1;if(l)for(d=0;d!=l.length;++d){for(m=l[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(c=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(h=(n=m.charCodeAt(i+1))==34||n==39?1:0,u=m.slice(i+1+h,m.length-h),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),a[c]=u,a[c.toLowerCase()]=u;else{var f=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(a[f]&&c.slice(o-3,o)=="ext")continue;a[f]=u,a[f.toLowerCase()]=u}}return a}function hc(t){return t.replace(RQ,"<$1")}var R4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},f1=ag(R4),Sr=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,s=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(t,function(o,u){return R4[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(s,function(o,u){return String.fromCharCode(parseInt(u,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}})(),p1=/[&<>'"]/g,OQ=/[\u0000-\u0008\u000b-\u001f]/g;function Kr(t){var s=t+"";return s.replace(p1,function(r){return f1[r]}).replace(OQ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function X2(t){return Kr(t).replace(/ /g,"_x0020_")}var O4=/[\u0000-\u001f]/g;function x1(t){var s=t+"";return s.replace(p1,function(r){return f1[r]}).replace(/\n/g,"<br/>").replace(O4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function QQ(t){var s=t+"";return s.replace(p1,function(r){return f1[r]}).replace(O4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var J2=(function(){var t=/&#(\d+);/g;function s(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,s)}})();function MQ(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function da(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yv(t){for(var s="",r=0,a=0,n=0,i=0,l=0,o=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){s+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,s+=String.fromCharCode(l);continue}if(i=t.charCodeAt(r++),a<240){s+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}l=t.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,s+=String.fromCharCode(55296+(o>>>10&1023)),s+=String.fromCharCode(56320+(o&1023))}return s}function Z2(t){var s=hu(2*t.length),r,a,n=1,i=0,l=0,o;for(a=0;a<t.length;a+=n)n=1,(o=t.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(s[i++]=l&255,s[i++]=l>>>8,l=0),s[i++]=r%256,s[i++]=r>>>8;return s.slice(0,i).toString("ucs2")}function e_(t){return nd(t,"binary").toString("utf8")}var lx="foo bar baz",Xr=or&&(e_(lx)==Yv(lx)&&e_||Z2(lx)==Yv(lx)&&Z2)||Yv,lc=or?function(t){return nd(t,"utf8").toString("binary")}:function(t){for(var s=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:s.push(String.fromCharCode(a));break;case a<2048:s.push(String.fromCharCode(192+(a>>6))),s.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),s.push(String.fromCharCode(240+(n>>18&7))),s.push(String.fromCharCode(144+(n>>12&63))),s.push(String.fromCharCode(128+(n>>6&63))),s.push(String.fromCharCode(128+(n&63)));break;default:s.push(String.fromCharCode(224+(a>>12))),s.push(String.fromCharCode(128+(a>>6&63))),s.push(String.fromCharCode(128+(a&63)))}return s.join("")},pf=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),Q4=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),HQ=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),qQ=/<\/?(?:vt:)?variant>/g,VQ=/<(?:vt:)([^>]*)>([\s\S]*)</;function t_(t,s){var r=Js(t),a=t.match(HQ(r.baseType))||[],n=[];if(a.length!=r.size){if(s.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var l=i.replace(qQ,"").match(VQ);l&&n.push({v:Xr(l[2]),t:l[1]})}),n}var M4=/(^\s|\s$|\n)/;function Vn(t,s){return"<"+t+(s.match(M4)?' xml:space="preserve"':"")+">"+s+"</"+t+">"}function xf(t){return Oa(t).map(function(s){return" "+s+'="'+t[s]+'"'}).join("")}function xs(t,s,r){return"<"+t+(r!=null?xf(r):"")+(s!=null?(s.match(M4)?' xml:space="preserve"':"")+">"+s+"</"+t:"/")+">"}function vy(t,s){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(s)throw r}return""}function $Q(t,s){switch(typeof t){case"string":var r=xs("vt:lpwstr",Kr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return xs((t|0)==t?"vt:i4":"vt:r8",Kr(String(t)));case"boolean":return xs("vt:bool",t?"true":"false")}if(t instanceof Date)return xs("vt:filetime",vy(t));throw new Error("Unable to serialize "+t)}function g1(t){if(or&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Xr(bu(d1(t)));throw new Error("Bad input format: expected Buffer or string")}var gf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,pn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},wA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],pl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function WQ(t,s){for(var r=1-2*(t[s+7]>>>7),a=((t[s+7]&127)<<4)+(t[s+6]>>>4&15),n=t[s+6]&15,i=5;i>=0;--i)n=n*256+t[s+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function GQ(t,s,r){var a=(s<0||1/s==-1/0?1:0)<<7,n=0,i=0,l=a?-s:s;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(s)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(n&15)<<4|i&15,t[r+7]=n>>4|a}var s_=function(t){for(var s=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,i=t[0][a].length;n<i;n+=r)s.push.apply(s,t[0][a].slice(n,n+r));return s},r_=or?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(s){return Buffer.isBuffer(s)?s:nd(s)})):s_(t)}:s_,a_=function(t,s,r){for(var a=[],n=s;n<r;n+=2)a.push(String.fromCharCode(Gc(t,n)));return a.join("").replace(Ui,"")},v1=or?function(t,s,r){return Buffer.isBuffer(t)?t.toString("utf16le",s,r).replace(Ui,""):a_(t,s,r)}:a_,n_=function(t,s,r){for(var a=[],n=s;n<s+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},H4=or?function(t,s,r){return Buffer.isBuffer(t)?t.toString("hex",s,s+r):n_(t,s,r)}:n_,i_=function(t,s,r){for(var a=[],n=s;n<r;n++)a.push(String.fromCharCode(fh(t,n)));return a.join("")},Rf=or?function(s,r,a){return Buffer.isBuffer(s)?s.toString("utf8",r,a):i_(s,r,a)}:i_,q4=function(t,s){var r=xl(t,s);return r>0?Rf(t,s+4,s+4+r-1):""},V4=q4,$4=function(t,s){var r=xl(t,s);return r>0?Rf(t,s+4,s+4+r-1):""},W4=$4,G4=function(t,s){var r=2*xl(t,s);return r>0?Rf(t,s+4,s+4+r-1):""},K4=G4,z4=function(s,r){var a=xl(s,r);return a>0?v1(s,r+4,r+4+a):""},Y4=z4,X4=function(t,s){var r=xl(t,s);return r>0?Rf(t,s+4,s+4+r):""},J4=X4,Z4=function(t,s){return WQ(t,s)},u0=Z4,b1=function(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};or&&(V4=function(s,r){if(!Buffer.isBuffer(s))return q4(s,r);var a=s.readUInt32LE(r);return a>0?s.toString("utf8",r+4,r+4+a-1):""},W4=function(s,r){if(!Buffer.isBuffer(s))return $4(s,r);var a=s.readUInt32LE(r);return a>0?s.toString("utf8",r+4,r+4+a-1):""},K4=function(s,r){if(!Buffer.isBuffer(s))return G4(s,r);var a=2*s.readUInt32LE(r);return s.toString("utf16le",r+4,r+4+a-1)},Y4=function(s,r){if(!Buffer.isBuffer(s))return z4(s,r);var a=s.readUInt32LE(r);return s.toString("utf16le",r+4,r+4+a)},J4=function(s,r){if(!Buffer.isBuffer(s))return X4(s,r);var a=s.readUInt32LE(r);return s.toString("utf8",r+4,r+4+a)},u0=function(s,r){return Buffer.isBuffer(s)?s.readDoubleLE(r):Z4(s,r)},b1=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array});var fh=function(t,s){return t[s]},Gc=function(t,s){return t[s+1]*256+t[s]},KQ=function(t,s){var r=t[s+1]*256+t[s];return r<32768?r:(65535-r+1)*-1},xl=function(t,s){return t[s+3]*(1<<24)+(t[s+2]<<16)+(t[s+1]<<8)+t[s]},Zu=function(t,s){return t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s]},zQ=function(t,s){return t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3]};function Gm(t,s){var r="",a,n,i=[],l,o,u,d;switch(s){case"dbcs":if(d=this.l,or&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(Gc(this,d)),d+=2;t*=2;break;case"utf8":r=Rf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=v1(this,this.l,this.l+t);break;case"wstr":return Gm.call(this,t,"dbcs");case"lpstr-ansi":r=V4(this,this.l),t=4+xl(this,this.l);break;case"lpstr-cp":r=W4(this,this.l),t=4+xl(this,this.l);break;case"lpwstr":r=K4(this,this.l),t=4+2*xl(this,this.l);break;case"lpp4":t=4+xl(this,this.l),r=Y4(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+xl(this,this.l),r=J4(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=fh(this,this.l+t++))!==0;)i.push(ix(l));r=i.join("");break;case"_wstr":for(t=0,r="";(l=Gc(this,this.l+t))!==0;)i.push(ix(l)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return l=fh(this,d),this.l=d+1,o=Gm.call(this,t-u,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ix(Gc(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return l=fh(this,d),this.l=d+1,o=Gm.call(this,t-u,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ix(fh(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return a=fh(this,this.l),this.l++,a;case 2:return a=(s==="i"?KQ:Gc)(this,this.l),this.l+=2,a;case 4:case-4:return s==="i"||(this[this.l+3]&128)===0?(a=(t>0?Zu:zQ)(this,this.l),this.l+=4,a):(n=xl(this,this.l),this.l+=4,n);case 8:case-8:if(s==="f")return t==8?n=u0(this,this.l):n=u0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=H4(this,this.l,t);break}}return this.l+=t,r}var YQ=function(t,s,r){t[r]=s&255,t[r+1]=s>>>8&255,t[r+2]=s>>>16&255,t[r+3]=s>>>24&255},XQ=function(t,s,r){t[r]=s&255,t[r+1]=s>>8&255,t[r+2]=s>>16&255,t[r+3]=s>>24&255},JQ=function(t,s,r){t[r]=s&255,t[r+1]=s>>>8&255};function ZQ(t,s,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=s.length;++n)JQ(this,s.charCodeAt(n),this.l+2*n);a=2*s.length}else if(r==="sbcs"){for(s=s.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=s.length;++n)this[this.l+n]=s.charCodeAt(n)&255;a=s.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(s.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(n=0;n<Math.min(s.length,t);++n){var l=s.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=s&255;break;case 2:a=2,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255;break;case 3:a=3,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255,s>>>=8,this[this.l+2]=s&255;break;case 4:a=4,YQ(this,s,this.l);break;case 8:if(a=8,r==="f"){GQ(this,s,this.l);break}case 16:break;case-4:a=4,XQ(this,s,this.l);break}return this.l+=a,this}function eB(t,s){var r=H4(this,this.l,t.length>>1);if(r!==t)throw new Error(s+"Expected "+t+" saw "+r);this.l+=t.length>>1}function qn(t,s){t.l=s,t.read_shift=Gm,t.chk=eB,t.write_shift=ZQ}function vi(t,s){t.l+=s}function Jt(t){var s=hu(t);return qn(s,0),s}function id(t,s,r){if(t){var a,n,i;qn(t,t.l||0);for(var l=t.length,o=0,u=0;t.l<l;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var d=wf[o]||wf[65535];for(a=t.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=t.read_shift(1))&127)<<7*n;u=t.l+i;var c=d.f&&d.f(t,i,r);if(t.l=u,s(c,d,o))return}}}function sl(){var t=[],s=or?256:2048,r=function(d){var c=Jt(d);return qn(c,0),c},a=r(s),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(n(),a=r(Math.max(d+1,s)))},l=function(){return n(),kn(t)},o=function(d){n(),a=d,a.l==null&&(a.l=a.length),i(s)};return{next:i,push:o,end:l,_bufs:t}}function is(t,s,r,a){var n=+s,i;if(!isNaN(n)){a||(a=wf[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=t.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&b1(r)&&t.push(r)}}function Km(t,s,r){var a=ha(t);if(s.s?(a.cRel&&(a.c+=s.s.c),a.rRel&&(a.r+=s.s.r)):(a.cRel&&(a.c+=s.c),a.rRel&&(a.r+=s.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function l_(t,s,r){var a=ha(t);return a.s=Km(a.s,s.s,r),a.e=Km(a.e,s.s,r),a}function zm(t,s){if(t.cRel&&t.c<0)for(t=ha(t);t.c<0;)t.c+=s>8?16384:256;if(t.rRel&&t.r<0)for(t=ha(t);t.r<0;)t.r+=s>8?1048576:s>5?65536:16384;var r=Ys(t);return!t.cRel&&t.cRel!=null&&(r=s7(r)),!t.rRel&&t.rRel!=null&&(r=e7(r)),r}function Xv(t,s){return t.s.r==0&&!t.s.rRel&&t.e.r==(s.biff>=12?1048575:s.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+_a(t.s.c)+":"+(t.e.cRel?"":"$")+_a(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(s.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Xa(t.s.r)+":"+(t.e.rRel?"":"$")+Xa(t.e.r):zm(t.s,s.biff)+":"+zm(t.e,s.biff)}function y1(t){return parseInt(t7(t),10)-1}function Xa(t){return""+(t+1)}function e7(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function t7(t){return t.replace(/\$(\d+)$/,"$1")}function j1(t){for(var s=r7(t),r=0,a=0;a!==s.length;++a)r=26*r+s.charCodeAt(a)-64;return r-1}function _a(t){if(t<0)throw new Error("invalid column "+t);var s="";for(++t;t;t=Math.floor((t-1)/26))s=String.fromCharCode((t-1)%26+65)+s;return s}function s7(t){return t.replace(/^([A-Z])/,"$$$1")}function r7(t){return t.replace(/^\$([A-Z])/,"$1")}function a7(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sa(t){for(var s=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?s=10*s+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:s-1}}function Ys(t){for(var s=t.c+1,r="";s;s=(s-1)/26|0)r=String.fromCharCode((s-1)%26+65)+r;return r+(t.r+1)}function rl(t){var s=t.indexOf(":");return s==-1?{s:Sa(t),e:Sa(t)}:{s:Sa(t.slice(0,s)),e:Sa(t.slice(s+1))}}function ir(t,s){return typeof s>"u"||typeof s=="number"?ir(t.s,t.e):(typeof t!="string"&&(t=Ys(t)),typeof s!="string"&&(s=Ys(s)),t==s?t:t+":"+s)}function Cr(t){var s={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=t.length;for(r=0;a<i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(s.s.c=--r,r=0;a<i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(s.s.r=--r,a===i||n!=10)return s.e.c=s.s.c,s.e.r=s.s.r,s;for(++a,r=0;a!=i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(s.e.c=--r,r=0;a!=i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return s.e.r=--r,s}function o_(t,s){var r=t.t=="d"&&s instanceof Date;if(t.z!=null)try{return t.w=Xl(t.z,r?xn(s):s)}catch{}try{return t.w=Xl((t.XF||{}).numFmtId||(r?14:0),r?xn(s):s)}catch{return""+s}}function sd(t,s,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?ld[t.v]||t.v:s==null?o_(t,t.v):o_(t,s))}function yu(t,s){var r=s&&s.sheet?s.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function tB(t,s,r){var a=r||{},n=t?Array.isArray(t):a.dense,i=t||(n?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var u=typeof a.origin=="string"?Sa(a.origin):a.origin;l=u.r,o=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=Cr(i["!ref"]);d.s.c=c.s.c,d.s.r=c.s.r,d.e.c=Math.max(d.e.c,c.e.c),d.e.r=Math.max(d.e.r,c.e.r),l==-1&&(d.e.r=l=c.e.r+1)}for(var m=0;m!=s.length;++m)if(s[m]){if(!Array.isArray(s[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=s[m].length;++h)if(!(typeof s[m][h]>"u")){var f={v:s[m][h]},x=l+m,g=o+h;if(d.s.r>x&&(d.s.r=x),d.s.c>g&&(d.s.c=g),d.e.r<x&&(d.e.r=x),d.e.c<g&&(d.e.c=g),s[m][h]&&typeof s[m][h]=="object"&&!Array.isArray(s[m][h])&&!(s[m][h]instanceof Date))f=s[m][h];else if(Array.isArray(f.v)&&(f.f=s[m][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(a.nullError)f.t="e",f.v=0;else if(a.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=a.dateNF||Ws[14],a.cellDates?(f.t="d",f.w=Xl(f.z,xn(f.v))):(f.t="n",f.v=xn(f.v),f.w=Xl(f.z,f.v))):f.t="s";if(n)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(f.z=i[x][g].z),i[x][g]=f;else{var b=Ys({c:g,r:x});i[b]&&i[b].z&&(f.z=i[b].z),i[b]=f}}}return d.s.c<1e7&&(i["!ref"]=ir(d)),i}function Wh(t,s){return tB(null,t,s)}function n7(t){return t.read_shift(4,"i")}function ko(t,s){return s||(s=Jt(4)),s.write_shift(4,t),s}function gi(t){var s=t.read_shift(4);return s===0?"":t.read_shift(s,"dbcs")}function En(t,s){var r=!1;return s==null&&(r=!0,s=Jt(4+2*t.length)),s.write_shift(4,t.length),t.length>0&&s.write_shift(0,t,"dbcs"),r?s.slice(0,s.l):s}function i7(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function l7(t,s){return s||(s=Jt(4)),s.write_shift(2,0),s.write_shift(2,0),s}function N1(t,s){var r=t.l,a=t.read_shift(1),n=gi(t),i=[],l={t:n,h:n};if((a&1)!==0){for(var o=t.read_shift(4),u=0;u!=o;++u)i.push(i7(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=r+s,l}function o7(t,s){var r=!1;return s==null&&(r=!0,s=Jt(15+4*t.t.length)),s.write_shift(1,0),En(t.t,s),r?s.slice(0,s.l):s}var c7=N1;function d7(t,s){var r=!1;return s==null&&(r=!0,s=Jt(23+4*t.t.length)),s.write_shift(1,1),En(t.t,s),s.write_shift(4,1),l7({},s),r?s.slice(0,s.l):s}function Jl(t){var s=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:s,iStyleRef:r}}function _A(t,s){return s==null&&(s=Jt(8)),s.write_shift(-4,t.c),s.write_shift(3,t.iStyleRef||t.s),s.write_shift(1,0),s}function SA(t){var s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:s}}function CA(t,s){return s==null&&(s=Jt(4)),s.write_shift(3,t.iStyleRef||t.s),s.write_shift(1,0),s}var u7=gi,sB=En;function w1(t){var s=t.read_shift(4);return s===0||s===4294967295?"":t.read_shift(s,"dbcs")}function A0(t,s){var r=!1;return s==null&&(r=!0,s=Jt(127)),s.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&s.write_shift(0,t,"dbcs"),r?s.slice(0,s.l):s}var A7=gi,by=w1,_1=A0;function S1(t){var s=t.slice(t.l,t.l+4),r=s[0]&1,a=s[0]&2;t.l+=4;var n=a===0?u0([0,0,0,0,s[0]&252,s[1],s[2],s[3]],0):Zu(s,0)>>2;return r?n/100:n}function rB(t,s){s==null&&(s=Jt(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)s.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function aB(t){var s={s:{},e:{}};return s.s.r=t.read_shift(4),s.e.r=t.read_shift(4),s.s.c=t.read_shift(4),s.e.c=t.read_shift(4),s}function h7(t,s){return s||(s=Jt(16)),s.write_shift(4,t.s.r),s.write_shift(4,t.e.r),s.write_shift(4,t.s.c),s.write_shift(4,t.e.c),s}var BA=aB,Gh=h7;function xi(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function vA(t,s){return(s||Jt(8)).write_shift(8,t,"f")}function m7(t){var s={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(1);switch(t.l++,a){case 0:s.auto=1;break;case 1:s.index=n;var d=uA[n];d&&(s.rgb=bf(d));break;case 2:s.rgb=bf([l,o,u]);break;case 3:s.theme=n;break}return i!=0&&(s.tint=i>0?i/32767:i/32768),s}function h0(t,s){if(s||(s=Jt(8)),!t||t.auto)return s.write_shift(4,0),s.write_shift(4,0),s;t.index!=null?(s.write_shift(1,2),s.write_shift(1,t.index)):t.theme!=null?(s.write_shift(1,6),s.write_shift(1,t.theme)):(s.write_shift(1,5),s.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),s.write_shift(2,r),!t.rgb||t.theme!=null)s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),s.write_shift(1,parseInt(a.slice(0,2),16)),s.write_shift(1,parseInt(a.slice(2,4),16)),s.write_shift(1,parseInt(a.slice(4,6),16)),s.write_shift(1,255)}return s}function f7(t){var s=t.read_shift(1);t.l++;var r={fBold:s&1,fItalic:s&2,fUnderline:s&4,fStrikeout:s&8,fOutline:s&16,fShadow:s&32,fCondense:s&64,fExtend:s&128};return r}function p7(t,s){s||(s=Jt(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return s.write_shift(1,r),s.write_shift(1,0),s}function nB(t,s){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,s==1?"lpstr":"lpwstr")}function x7(t){return nB(t,1)}function g7(t){return nB(t,2)}var C1=2,Ji=3,ox=11,c_=12,m0=19,cx=64,v7=65,b7=71,y7=4108,j7=4126,Cn=80,iB=81,N7=[Cn,iB],yy={1:{n:"CodePage",t:C1},2:{n:"Category",t:Cn},3:{n:"PresentationFormat",t:Cn},4:{n:"ByteCount",t:Ji},5:{n:"LineCount",t:Ji},6:{n:"ParagraphCount",t:Ji},7:{n:"SlideCount",t:Ji},8:{n:"NoteCount",t:Ji},9:{n:"HiddenCount",t:Ji},10:{n:"MultimediaClipCount",t:Ji},11:{n:"ScaleCrop",t:ox},12:{n:"HeadingPairs",t:y7},13:{n:"TitlesOfParts",t:j7},14:{n:"Manager",t:Cn},15:{n:"Company",t:Cn},16:{n:"LinksUpToDate",t:ox},17:{n:"CharacterCount",t:Ji},19:{n:"SharedDoc",t:ox},22:{n:"HyperlinksChanged",t:ox},23:{n:"AppVersion",t:Ji,p:"version"},24:{n:"DigSig",t:v7},26:{n:"ContentType",t:Cn},27:{n:"ContentStatus",t:Cn},28:{n:"Language",t:Cn},29:{n:"Version",t:Cn},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},jy={1:{n:"CodePage",t:C1},2:{n:"Title",t:Cn},3:{n:"Subject",t:Cn},4:{n:"Author",t:Cn},5:{n:"Keywords",t:Cn},6:{n:"Comments",t:Cn},7:{n:"Template",t:Cn},8:{n:"LastAuthor",t:Cn},9:{n:"RevNumber",t:Cn},10:{n:"EditTime",t:cx},11:{n:"LastPrinted",t:cx},12:{n:"CreatedDate",t:cx},13:{n:"ModifiedDate",t:cx},14:{n:"PageCount",t:Ji},15:{n:"WordCount",t:Ji},16:{n:"CharCount",t:Ji},17:{n:"Thumbnail",t:b7},18:{n:"Application",t:Cn},19:{n:"DocSecurity",t:Ji},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},d_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},w7=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _7(t){return t.map(function(s){return[s>>16&255,s>>8&255,s&255]})}var S7=_7([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),uA=ha(S7),ld={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lB={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Ny={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},dx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function B1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function C7(t){var s=B1();if(!t||!t.match)return s;var r={};if((t.match(bi)||[]).forEach(function(a){var n=Js(a);switch(n[0].replace(UQ,"<")){case"<?xml":break;case"<Types":s.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":s[Ny[n.ContentType]]!==void 0&&s[Ny[n.ContentType]].push(n.PartName);break}}),s.xmlns!==pn.CT)throw new Error("Unknown Namespace: "+s.xmlns);return s.calcchain=s.calcchains.length>0?s.calcchains[0]:"",s.sst=s.strs.length>0?s.strs[0]:"",s.style=s.styles.length>0?s.styles[0]:"",s.defaults=r,delete s.calcchains,s}function oB(t,s){var r=CQ(Ny),a=[],n;a[a.length]=Za,a[a.length]=xs("Types",null,{xmlns:pn.CT,"xmlns:xsd":pn.xsd,"xmlns:xsi":pn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return xs("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){t[u]&&t[u].length>0&&(n=t[u][0],a[a.length]=xs("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:dx[u][s.bookType]||dx[u].xlsx}))},l=function(u){(t[u]||[]).forEach(function(d){a[a.length]=xs("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:dx[u][s.bookType]||dx[u].xlsx})})},o=function(u){(t[u]||[]).forEach(function(d){a[a.length]=xs("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[u][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ur={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function vf(t){var s=t.lastIndexOf("/");return t.slice(0,s+1)+"_rels/"+t.slice(s+1)+".rels"}function Ym(t,s){var r={"!id":{}};if(!t)return r;s.charAt(0)!=="/"&&(s="/"+s);var a={};return(t.match(bi)||[]).forEach(function(n){var i=Js(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Pm(i.Target,s);r[o]=l,a[i.Id]=l}}),r["!id"]=a,r}function Sh(t){var s=[Za,xs("Relationships",null,{xmlns:pn.RELS})];return Oa(t["!id"]).forEach(function(r){s[s.length]=xs("Relationship",null,t["!id"][r])}),s.length>2&&(s[s.length]="</Relationships>",s[1]=s[1].replace("/>",">")),s.join("")}function Wr(t,s,r,a,n,i){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),s<0)for(s=t["!idx"];t["!id"]["rId"+s];++s);if(t["!idx"]=s+1,n.Id="rId"+s,n.Type=a,n.Target=r,[ur.HLINK,ur.XPATH,ur.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+s);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,s}var B7="application/vnd.oasis.opendocument.spreadsheet";function k7(t,s){for(var r=g1(t),a,n;a=gf.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Js(a[0],!1),n.path=="/"&&n.type!==B7)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(s&&s.WTF)throw a}}function E7(t){var s=[Za];s.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),s.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)s.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return s.push("</manifest:manifest>"),s.join("")}function u_(t,s,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+s+`"/>
`,`  </rdf:Description>
`].join("")}function F7(t,s){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+s+`"/>
`,`  </rdf:Description>
`].join("")}function T7(t){var s=[Za];s.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)s.push(u_(t[r][0],t[r][1])),s.push(F7("",t[r][0]));return s.push(u_("","Document","pkg")),s.push("</rdf:RDF>"),s.join("")}function cB(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+i0.version+"</meta:generator></office:meta></office:document-meta>"}var Yl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],I7=(function(){for(var t=new Array(Yl.length),s=0;s<Yl.length;++s){var r=Yl[s],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[s]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function dB(t){var s={};t=Xr(t);for(var r=0;r<Yl.length;++r){var a=Yl[r],n=t.match(I7[r]);n!=null&&n.length>0&&(s[a[1]]=Sr(n[1])),a[2]==="date"&&s[a[1]]&&(s[a[1]]=Aa(s[a[1]]))}return s}function Jv(t,s,r,a,n){n[t]!=null||s==null||s===""||(n[t]=s,s=Kr(s),a[a.length]=r?xs(t,s,r):Vn(t,s))}function uB(t,s){var r=s||{},a=[Za,xs("cp:coreProperties",null,{"xmlns:cp":pn.CORE_PROPS,"xmlns:dc":pn.dc,"xmlns:dcterms":pn.dcterms,"xmlns:dcmitype":pn.dcmitype,"xmlns:xsi":pn.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&Jv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:vy(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&Jv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:vy(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=Yl.length;++i){var l=Yl[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Jv(l[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var AA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],AB=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hB(t,s,r,a){var n=[];if(typeof t=="string")n=t_(t,a);else for(var i=0;i<t.length;++i)n=n.concat(t[i].map(function(c){return{v:c}}));var l=typeof s=="string"?t_(s,a).map(function(c){return c.v}):s,o=0,u=0;if(l.length>0)for(var d=0;d!==n.length;d+=2){switch(u=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=l.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=l.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=l.slice(o,o+u);break}o+=u}}function L7(t,s,r){var a={};return s||(s={}),t=Xr(t),AA.forEach(function(n){var i=(t.match(pf(n[0]))||[])[1];switch(n[2]){case"string":i&&(s[n[1]]=Sr(i));break;case"bool":s[n[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&hB(a.HeadingPairs,a.TitlesOfParts,s,r),s}function mB(t){var s=[],r=xs;return t||(t={}),t.Application="SheetJS",s[s.length]=Za,s[s.length]=xs("Properties",null,{xmlns:pn.EXT_PROPS,"xmlns:vt":pn.vt}),AA.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Kr(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(s[s.length]=r(a[0],n))}}),s[s.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),s[s.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+Kr(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var D7=/<[^>]+>[^<]*/g;function P7(t,s){var r={},a="",n=t.match(D7);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=Js(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Sr(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var u=l.split(">"),d=u[0].slice(4),c=u[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=Sr(c);break;case"bool":r[a]=da(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(c,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(c);break;case"filetime":case"date":r[a]=Aa(c);break;case"cy":case"error":r[a]=Sr(c);break;default:if(d.slice(-1)=="/")break;s.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,u)}}else if(l.slice(0,2)!=="</"){if(s.WTF)throw new Error(l)}}}return r}function fB(t){var s=[Za,xs("Properties",null,{xmlns:pn.CUST_PROPS,"xmlns:vt":pn.vt})];if(!t)return s.join("");var r=1;return Oa(t).forEach(function(n){++r,s[s.length]=xs("property",$Q(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Kr(n)})}),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var wy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Zv;function U7(t,s,r){Zv||(Zv=ag(wy)),s=Zv[s]||s,t[s]=r}function R7(t,s){var r=[];return Oa(wy).map(function(a){for(var n=0;n<Yl.length;++n)if(Yl[n][1]==a)return Yl[n];for(n=0;n<AA.length;++n)if(AA[n][1]==a)return AA[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=s&&s.Props&&s.Props[a[1]]!=null?s.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Vn(wy[a[1]]||a[1],n))}}),xs("DocumentProperties",r.join(""),{xmlns:pl.o})}function O7(t,s){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&Oa(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var l=0;l<Yl.length;++l)if(i==Yl[l][1])return;for(l=0;l<AA.length;++l)if(i==AA[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=t[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),n.push(xs(X2(i),o,{"dt:dt":u}))}}),s&&Oa(s).forEach(function(i){if(Object.prototype.hasOwnProperty.call(s,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var l=s[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(xs(X2(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+pl.o+'">'+n.join("")+"</"+a+">"}function k1(t){var s=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+s/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Q7(t){var s=typeof t=="string"?new Date(Date.parse(t)):t,r=s.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var l=Jt(8);return l.write_shift(4,a),l.write_shift(4,n),l}function pB(t,s,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function xB(t,s,r){var a=t.read_shift(0,"lpwstr");return a}function gB(t,s,r){return s===31?xB(t):pB(t,s,r)}function _y(t,s,r){return gB(t,s,r===!1?0:4)}function M7(t,s){if(!s)throw new Error("VtUnalignedString must have positive length");return gB(t,s,0)}function H7(t){for(var s=t.read_shift(4),r=[],a=0;a!=s;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(Ui,""),t.l-n&2&&(t.l+=2)}return r}function q7(t){for(var s=t.read_shift(4),r=[],a=0;a!=s;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(Ui,"");return r}function V7(t){var s=t.l,r=f0(t,iB);t[t.l]==0&&t[t.l+1]==0&&t.l-s&2&&(t.l+=2);var a=f0(t,Ji);return[r,a]}function $7(t){for(var s=t.read_shift(4),r=[],a=0;a<s/2;++a)r.push(V7(t));return r}function A_(t,s){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var i=t.read_shift(4),l=t.read_shift(4);a[i]=t.read_shift(l,s===1200?"utf16le":"utf8").replace(Ui,"").replace(Dm,"!"),s===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function vB(t){var s=t.read_shift(4),r=t.slice(t.l,t.l+s);return t.l+=s,(s&3)>0&&(t.l+=4-(s&3)&3),r}function W7(t){var s={};return s.Size=t.read_shift(4),t.l+=s.Size+3-(s.Size-1)%4,s}function f0(t,s,r){var a=t.read_shift(2),n,i=r||{};if(t.l+=2,s!==c_&&a!==s&&N7.indexOf(s)===-1&&!((s&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+s+" saw "+a);switch(s===c_?a:s){case 2:return n=t.read_shift(2,"i"),i.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return pB(t,a,4).replace(Ui,"");case 31:return xB(t);case 64:return k1(t);case 65:return vB(t);case 71:return W7(t);case 80:return _y(t,a,!i.raw).replace(Ui,"");case 81:return M7(t,a).replace(Ui,"");case 4108:return $7(t);case 4126:case 4127:return a==4127?H7(t):q7(t);default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+a)}}function h_(t,s){var r=Jt(4),a=Jt(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,s);break;case 5:a=Jt(8),a.write_shift(8,s,"f");break;case 11:a.write_shift(4,s?1:0);break;case 64:a=Q7(s);break;case 31:case 80:for(a=Jt(4+2*(s.length+1)+(s.length%2?0:2)),a.write_shift(4,s.length+1),a.write_shift(0,s,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}return kn([r,a])}function m_(t,s){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),i=[],l=0,o=0,u=-1,d={};for(l=0;l!=n;++l){var c=t.read_shift(4),m=t.read_shift(4);i[l]=[c,m+r]}i.sort(function(N,j){return N[1]-j[1]});var h={};for(l=0;l!=n;++l){if(t.l!==i[l][1]){var f=!0;if(l>0&&s)switch(s[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,f=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],f=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],f=!1);break}if((!s||l==0)&&t.l<=i[l][1]&&(f=!1,t.l=i[l][1]),f)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(s){var x=s[i[l][0]];if(h[x.n]=f0(t,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:So(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[l][0]===1){if(o=h.CodePage=f0(t,C1),So(o),u!==-1){var g=t.l;t.l=i[u][1],d=A_(t,o),t.l=g}}else if(i[l][0]===0){if(o===0){u=l,t.l=i[l+1][1];continue}d=A_(t,o)}else{var b=d[i[l][0]],y;switch(t[t.l]){case 65:t.l+=4,y=vB(t);break;case 30:t.l+=4,y=_y(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=_y(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=Wa(t,4);break;case 64:t.l+=4,y=Aa(k1(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[b]=y}}return t.l=r+a,h}var bB=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function G7(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function f_(t,s,r){var a=Jt(8),n=[],i=[],l=8,o=0,u=Jt(8),d=Jt(8);if(u.write_shift(4,2),u.write_shift(4,1200),d.write_shift(4,1),i.push(u),n.push(d),l+=8+u.length,!s){d=Jt(8),d.write_shift(4,0),n.unshift(d);var c=[Jt(4)];for(c[0].write_shift(4,t.length),o=0;o<t.length;++o){var m=t[o][0];for(u=Jt(8+2*(m.length+1)+(m.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,m.length+1),u.write_shift(0,m,"dbcs");u.l!=u.length;)u.write_shift(1,0);c.push(u)}u=kn(c),i.unshift(u),l+=8+u.length}for(o=0;o<t.length;++o)if(!(s&&!s[t[o][0]])&&!(bB.indexOf(t[o][0])>-1||AB.indexOf(t[o][0])>-1)&&t[o][1]!=null){var h=t[o][1],f=0;if(s){f=+s[t[o][0]];var x=r[f];if(x.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}u=h_(x.t,h)}else{var b=G7(h);b==-1&&(b=31,h=String(h)),u=h_(b,h)}i.push(u),d=Jt(8),d.write_shift(4,s?f:2+o),n.push(d),l+=8+u.length}var y=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,y),y+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),kn([a].concat(n).concat(i))}function p_(t,s,r){var a=t.content;if(!a)return{};qn(a,0);var n,i,l,o,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),c=a.read_shift(16);if(c!==Qs.utils.consts.HEADER_CLSID&&c!==r)throw new Error("Bad PropertySet CLSID "+c);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(l=a.read_shift(16),u=a.read_shift(4));var m=m_(a,s),h={SystemIdentifier:d};for(var f in m)h[f]=m[f];if(h.FMTID=i,n===1)return h;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var x;try{x=m_(a,null)}catch{}for(f in x)h[f]=x[f];return h.FMTID=[i,l],h}function x_(t,s,r,a,n,i){var l=Jt(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Qs.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,s,"hex"),l.write_shift(4,n?68:48);var u=f_(t,r,a);if(o.push(u),n){var d=f_(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+u.length),o.push(d)}return kn(o)}function Wd(t,s){return t.read_shift(s),null}function K7(t,s){s||(s=Jt(t));for(var r=0;r<t;++r)s.write_shift(1,0);return s}function z7(t,s,r){for(var a=[],n=t.l+s;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function Wa(t,s){return t.read_shift(s)===1}function Di(t,s){return s||(s=Jt(2)),s.write_shift(2,+!!t),s}function nn(t){return t.read_shift(2,"u")}function $l(t,s){return s||(s=Jt(2)),s.write_shift(2,t),s}function yB(t,s){return z7(t,s,nn)}function Y7(t){var s=t.read_shift(1),r=t.read_shift(1);return r===1?s:s===1}function jB(t,s,r){return r||(r=Jt(2)),r.write_shift(1,s=="e"?+t:+!!t),r.write_shift(1,s=="e"?1:0),r}function Of(t,s,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?t.read_shift(a,n):"";return l}function X7(t){var s=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,i=1+(r&1),l=0,o,u={};n&&(l=t.read_shift(2)),a&&(o=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",c=s===0?"":t.read_shift(s,d);return n&&(t.l+=4*l),a&&(t.l+=o),u.t=c,n||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function J7(t){var s=t.t||"",r=Jt(3);r.write_shift(2,s.length),r.write_shift(1,1);var a=Jt(2*s.length);a.write_shift(2*s.length,s,"utf16le");var n=[r,a];return kn(n)}function bA(t,s,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(s,"cpstr");if(r.biff>=12)return t.read_shift(s,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(s,"sbcs-cont"):a=t.read_shift(s,"dbcs-cont"),a}function Qf(t,s,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):bA(t,a,r)}function kA(t,s,r){if(r.biff>5)return Qf(t,s,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function NB(t,s,r){return r||(r=Jt(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Z7(t){var s=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[s,r]}function eM(t){var s=t.read_shift(4),r=t.l,a=!1;s>24&&(t.l+=s-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?s-24:s)>>1,"utf16le").replace(Ui,"");return a&&(t.l+=24),n}function tM(t){for(var s=t.read_shift(2),r="";s-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(Ui,"");return r+l}function sM(t,s){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return eM(t);case"0303000000000000c000000000000046":return tM(t);default:throw new Error("Unsupported Moniker "+r)}}function ux(t){var s=t.read_shift(4),r=s>0?t.read_shift(s,"utf16le").replace(Ui,""):"";return r}function g_(t,s){s||(s=Jt(6+t.length*2)),s.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)s.write_shift(2,t.charCodeAt(r));return s.write_shift(2,0),s}function rM(t,s){var r=t.l+s,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var i,l,o,u,d="",c,m;n&16&&(i=ux(t,r-t.l)),n&128&&(l=ux(t,r-t.l)),(n&257)===257&&(o=ux(t,r-t.l)),(n&257)===1&&(u=sM(t,r-t.l)),n&8&&(d=ux(t,r-t.l)),n&32&&(c=t.read_shift(16)),n&64&&(m=k1(t)),t.l=r;var h=l||o||u||"";h&&d&&(h+="#"+d),h||(h="#"+d),n&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),m&&(f.time=m),i&&(f.Tooltip=i),f}function aM(t){var s=Jt(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}s.write_shift(4,2),s.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)s.write_shift(4,l[r]);if(i==28)a=a.slice(1),g_(a,s);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)s.write_shift(1,parseInt(l[r],16));var o=n>-1?a.slice(0,n):a;for(s.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)s.write_shift(2,o.charCodeAt(r));s.write_shift(2,0),i&8&&g_(n>-1?a.slice(n+1):"",s)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)s.write_shift(1,parseInt(l[r],16));for(var u=0;a.slice(u*3,u*3+3)=="../"||a.slice(u*3,u*3+3)=="..\\";)++u;for(s.write_shift(2,u),s.write_shift(4,a.length-3*u+1),r=0;r<a.length-3*u;++r)s.write_shift(1,a.charCodeAt(r+3*u)&255);for(s.write_shift(1,0),s.write_shift(2,65535),s.write_shift(2,57005),r=0;r<6;++r)s.write_shift(4,0)}return s.slice(0,s.l)}function wB(t){var s=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[s,r,a,n]}function _B(t,s){var r=wB(t);return r[3]=0,r}function mc(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:s,c:r,ixfe:a}}function yA(t,s,r,a){return a||(a=Jt(6)),a.write_shift(2,t),a.write_shift(2,s),a.write_shift(2,r||0),a}function nM(t){var s=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:s,flags:r}}function iM(t,s,r){return s===0?"":kA(t,s,r)}function lM(t,s,r){var a=r.biff>8?4:2,n=t.read_shift(a),i=t.read_shift(a,"i"),l=t.read_shift(a,"i");return[n,i,l]}function SB(t){var s=t.read_shift(2),r=S1(t);return[s,r]}function oM(t,s,r){t.l+=4,s-=4;var a=t.l+s,n=Of(t,s,r),i=t.read_shift(2);if(a-=t.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return t.l+=i,n}function lg(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:s},e:{c:n,r}}}function CB(t,s){return s||(s=Jt(8)),s.write_shift(2,t.s.r),s.write_shift(2,t.e.r),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c),s}function BB(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:s},e:{c:n,r}}}var cM=BB;function kB(t){t.l+=4;var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,s,a]}function dM(t){var s={};return t.l+=4,t.l+=16,s.fSharedNote=t.read_shift(2),t.l+=4,s}function uM(t){var s={};return t.l+=4,t.cf=t.read_shift(2),s}function oi(t){t.l+=2,t.l+=t.read_shift(2)}var AM={0:oi,4:oi,5:oi,6:oi,7:uM,8:oi,9:oi,10:oi,11:oi,12:oi,13:dM,14:oi,15:oi,16:oi,17:oi,18:oi,19:oi,20:oi,21:kB};function hM(t,s){for(var r=t.l+s,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(AM[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function Ax(t,s){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),s-=2,s>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(s>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(s),r}function E1(t,s,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Jt(n);return i.write_shift(2,a),i.write_shift(2,s),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function mM(t,s){return s===0||t.read_shift(2),1200}function fM(t,s,r){if(r.enc)return t.l+=s,"";var a=t.l,n=kA(t,0,r);return t.read_shift(s+a-t.l),n}function pM(t,s){var r=!s||s.biff==8,a=Jt(r?112:54);for(a.write_shift(s.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function xM(t,s,r){var a=r&&r.biff==8||s==2?t.read_shift(2):(t.l+=s,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function gM(t,s,r){var a=t.read_shift(4),n=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Of(t,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:i,name:l}}function vM(t,s){var r=!s||s.biff>=8?2:1,a=Jt(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),s.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,s.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function bM(t,s){for(var r=t.l+s,a=t.read_shift(4),n=t.read_shift(4),i=[],l=0;l!=n&&t.l<r;++l)i.push(X7(t));return i.Count=a,i.Unique=n,i}function yM(t,s){var r=Jt(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=J7(t[n]);var i=kn([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function jM(t,s){var r={};return r.dsst=t.read_shift(2),t.l+=s-2,r}function NM(t){var s={};s.r=t.read_shift(2),s.c=t.read_shift(2),s.cnt=t.read_shift(2)-s.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(s.level=a&7),a&32&&(s.hidden=!0),a&64&&(s.hpt=r/20),s}function wM(t){var s=nM(t);if(s.type!=2211)throw new Error("Invalid Future Record "+s.type);var r=t.read_shift(4);return r!==0}function _M(t){return t.read_shift(2),t.read_shift(4)}function v_(t,s,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function SM(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),d=t.read_shift(2);return{Pos:[s,r],Dim:[a,n],Flags:i,CurTab:l,FirstTab:o,Selected:u,TabRatio:d}}function CM(){var t=Jt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function BM(t,s,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function kM(t){var s=Jt(18),r=1718;return t&&t.RTL&&(r|=64),s.write_shift(2,r),s.write_shift(4,0),s.write_shift(4,64),s.write_shift(4,0),s.write_shift(4,0),s}function EM(){}function FM(t,s,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=Of(t,0,r),a}function TM(t,s){var r=t.name||"Arial",a=s&&s.biff==5,n=a?15+r.length:16+2*r.length,i=Jt(n);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function IM(t){var s=mc(t);return s.isst=t.read_shift(4),s}function LM(t,s,r,a){var n=Jt(10);return yA(t,s,a,n),n.write_shift(4,r),n}function DM(t,s,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+s,n=mc(t);r.biff==2&&t.l++;var i=Qf(t,a-t.l,r);return n.val=i,n}function PM(t,s,r,a,n){var i=!n||n.biff==8,l=Jt(8+ +i+(1+i)*r.length);return yA(t,s,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function UM(t,s,r){var a=t.read_shift(2),n=kA(t,0,r);return[a,n]}function RM(t,s,r,a){var n=r&&r.biff==5;a||(a=Jt(n?3+s.length:5+2*s.length)),a.write_shift(2,t),a.write_shift(n?1:2,s.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*s.length,s,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var OM=kA;function b_(t,s,r){var a=t.l+s,n=r.biff==8||!r.biff?4:2,i=t.read_shift(n),l=t.read_shift(n),o=t.read_shift(2),u=t.read_shift(2);return t.l=a,{s:{r:i,c:o},e:{r:l,c:u}}}function QM(t,s){var r=s.biff==8||!s.biff?4:2,a=Jt(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function MM(t){var s=t.read_shift(2),r=t.read_shift(2),a=SB(t);return{r:s,c:r,ixfe:a[0],rknum:a[1]}}function HM(t,s){for(var r=t.l+s-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(SB(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:i}}function qM(t,s){for(var r=t.l+s-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:i}}function VM(t,s,r,a){var n={},i=t.read_shift(4),l=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(2);return n.patternType=w7[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=u&127,n.icvBack=u>>7&127,n.fsxButton=u>>14&1),n}function $M(t,s,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,s-=6,a.data=VM(t,s,a.fStyle,r),a}function y_(t,s,r,a){var n=r&&r.biff==5;a||(a=Jt(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,s<<4));var i=0;return t.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function WM(t){t.l+=4;var s=[t.read_shift(2),t.read_shift(2)];if(s[0]!==0&&s[0]--,s[1]!==0&&s[1]--,s[0]>7||s[1]>7)throw new Error("Bad Gutters: "+s.join("|"));return s}function GM(t){var s=Jt(8);return s.write_shift(4,0),s.write_shift(2,0),s.write_shift(2,0),s}function j_(t,s,r){var a=mc(t);(r.biff==2||s==9)&&++t.l;var n=Y7(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function KM(t,s,r,a,n,i){var l=Jt(8);return yA(t,s,a,l),jB(r,i,l),l}function zM(t,s,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=mc(t),n=xi(t);return a.val=n,a}function YM(t,s,r,a){var n=Jt(14);return yA(t,s,a,n),vA(r,n),n}var N_=iM;function XM(t,s,r){var a=t.l+s,n=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=bA(t,i),o=[];a>t.l;)o.push(Qf(t));return[i,n,l,o]}function w_(t,s,r){var a=t.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=oM(t,s-2,r)),i.body=n||t.read_shift(s-2),typeof n=="string"&&(i.Name=n),i}var JM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function __(t,s,r){var a=t.l+s,n=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=bA(t,l,r);n&32&&(d=JM[d.charCodeAt(0)]);var c=a-t.l;r&&r.biff==2&&--c;var m=a==t.l||o===0||!(c>0)?[]:h$(t,c,r,o);return{chKey:i,Name:d,itab:u,rgce:m}}function EB(t,s,r){if(r.biff<8)return ZM(t,s,r);for(var a=[],n=t.l+s,i=t.read_shift(r.biff>8?4:2);i--!==0;)a.push(lM(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function ZM(t,s,r){t[t.l+1]==3&&t[t.l]++;var a=Of(t,s,r);return a.charCodeAt(0)==3?a.slice(1):a}function eH(t,s,r){if(r.biff<8){t.l+=s;return}var a=t.read_shift(2),n=t.read_shift(2),i=bA(t,a,r),l=bA(t,n,r);return[i,l]}function tH(t,s,r){var a=BB(t);t.l++;var n=t.read_shift(1);return s-=8,[m$(t,s,r),n,a]}function S_(t,s,r){var a=cM(t);switch(r.biff){case 2:t.l++,s-=7;break;case 3:case 4:t.l+=2,s-=8;break;default:t.l+=6,s-=12}return[a,u$(t,s,r)]}function sH(t){var s=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[s,r,a]}function rH(t,s,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=kA(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},o,l,i]}}function aH(t,s,r){return rH(t,s,r)}function nH(t,s){for(var r=[],a=t.read_shift(2);a--;)r.push(lg(t));return r}function iH(t){var s=Jt(2+t.length*8);s.write_shift(2,t.length);for(var r=0;r<t.length;++r)CB(t[r],s);return s}function lH(t,s,r){if(r&&r.biff<8)return cH(t,s,r);var a=kB(t),n=hM(t,s-22,a[1]);return{cmo:a,ft:n}}var oH={8:function(t,s){var r=t.l+s;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function cH(t,s,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,s-=36;var l=[];return l.push((oH[a]||vi)(t,s,r)),{cmo:[n,a,i],ft:l}}function dH(t,s,r){var a=t.l,n="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=Z7(t,6,r);var o=t.read_shift(2);t.read_shift(2),nn(t,2);var u=t.read_shift(2);t.l+=u;for(var d=1;d<t.lens.length-1;++d){if(t.l-a!=t.lens[d])throw new Error("TxO: bad continue record");var c=t[t.l],m=bA(t,t.lens[d+1]-t.lens[d]-1);if(n+=m,n.length>=(c?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return t.l=a+s,{t:n}}catch{return t.l=a+s,{t:n}}}function uH(t,s){var r=lg(t);t.l+=16;var a=rM(t,s-24);return[r,a]}function AH(t){var s=Jt(24),r=Sa(t[0]);s.write_shift(2,r.r),s.write_shift(2,r.r),s.write_shift(2,r.c),s.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)s.write_shift(1,parseInt(a[n],16));return kn([s,aM(t[1])])}function hH(t,s){t.read_shift(2);var r=lg(t),a=t.read_shift((s-10)/2,"dbcs-cont");return a=a.replace(Ui,""),[r,a]}function mH(t){var s=t[1].Tooltip,r=Jt(10+2*(s.length+1));r.write_shift(2,2048);var a=Sa(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<s.length;++n)r.write_shift(2,s.charCodeAt(n));return r.write_shift(2,0),r}function fH(t){var s=[0,0],r;return r=t.read_shift(2),s[0]=d_[r]||r,r=t.read_shift(2),s[1]=d_[r]||r,s}function pH(t){return t||(t=Jt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function xH(t){for(var s=t.read_shift(2),r=[];s-- >0;)r.push(_B(t));return r}function gH(t){for(var s=t.read_shift(2),r=[];s-- >0;)r.push(_B(t));return r}function vH(t){t.l+=2;var s={cxfs:0,crc:0};return s.cxfs=t.read_shift(2),s.crc=t.read_shift(4),s}function FB(t,s,r){if(!r.cellStyles)return vi(t,s);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),i=t.read_shift(a),l=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2);a==2&&(t.l+=2);var d={s:n,e:i,w:l,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(d.level=u>>8&7),d}function bH(t,s){var r=Jt(12);r.write_shift(2,s),r.write_shift(2,s),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function yH(t,s){var r={};return s<32||(t.l+=16,r.header=xi(t),r.footer=xi(t),t.l+=2),r}function jH(t,s,r){var a={area:!1};if(r.biff!=5)return t.l+=s,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function NH(t){for(var s=Jt(2*t),r=0;r<t;++r)s.write_shift(2,r+1);return s}var wH=mc,_H=yB,SH=Qf;function CH(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:s,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function BH(t,s,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=mc(t);++t.l;var n=kA(t,s-7,r);return a.t="str",a.val=n,a}function kH(t){var s=mc(t);++t.l;var r=xi(t);return s.t="n",s.val=r,s}function EH(t,s,r){var a=Jt(15);return Vf(a,t,s),a.write_shift(8,r,"f"),a}function FH(t){var s=mc(t);++t.l;var r=t.read_shift(2);return s.t="n",s.val=r,s}function TH(t,s,r){var a=Jt(9);return Vf(a,t,s),a.write_shift(2,r),a}function IH(t){var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,"sbcs-cont")}function LH(t,s){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=s-13}function DH(t,s,r){var a=t.l+s,n=mc(t),i=t.read_shift(2),l=bA(t,i,r);return t.l=a,n.t="str",n.val=l,n}var PH=[2,3,48,49,131,139,140,245],Sy=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},s=ag({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var d=[],c=hu(1);switch(u.type){case"base64":c=gl(wl(o));break;case"binary":c=gl(o);break;case"buffer":case"array":c=o;break}qn(c,0);var m=c.read_shift(1),h=!!(m&136),f=!1,x=!1;switch(m){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var g=0,b=521;m==2&&(g=c.read_shift(2)),c.l+=3,m!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),m!=2&&(b=c.read_shift(2));var y=c.read_shift(2),N=u.codepage||1252;m!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(N=t[c[c.l]]),c.l+=1,c.l+=2),x&&(c.l+=36);for(var j=[],S={},k=Math.min(c.length,m==2?521:b-10-(f?264:0)),P=x?32:11;c.l<k&&c[c.l]!=13;)switch(S={},S.name=hf.utils.decode(N,c.slice(c.l,c.l+P)).replace(/[\u0000\r\n].*$/g,""),c.l+=P,S.type=String.fromCharCode(c.read_shift(1)),m!=2&&!x&&(S.offset=c.read_shift(4)),S.len=c.read_shift(1),m==2&&(S.offset=c.read_shift(2)),S.dec=c.read_shift(1),S.name.length&&j.push(S),m!=2&&(c.l+=x?13:14),S.type){case"B":(!f||S.len!=8)&&u.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(c[c.l]!==13&&(c.l=b-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=b;var I=0,B=0;for(d[0]=[],B=0;B!=j.length;++B)d[0][B]=j[B].name;for(;g-- >0;){if(c[c.l]===42){c.l+=y;continue}for(++c.l,d[++I]=[],B=0,B=0;B!=j.length;++B){var q=c.slice(c.l,c.l+j[B].len);c.l+=j[B].len,qn(q,0);var Q=hf.utils.decode(N,q);switch(j[B].type){case"C":Q.trim().length&&(d[I][B]=Q.replace(/\s+$/,""));break;case"D":Q.length===8?d[I][B]=new Date(+Q.slice(0,4),+Q.slice(4,6)-1,+Q.slice(6,8)):d[I][B]=Q;break;case"F":d[I][B]=parseFloat(Q.trim());break;case"+":case"I":d[I][B]=x?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(Q.trim().toUpperCase()){case"Y":case"T":d[I][B]=!0;break;case"N":case"F":d[I][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Q+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[I][B]="##MEMO##"+(x?parseInt(Q.trim(),10):q.read_shift(4));break;case"N":Q=Q.replace(/\u0000/g,"").trim(),Q&&Q!="."&&(d[I][B]=+Q||0);break;case"@":d[I][B]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":d[I][B]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":d[I][B]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[I][B]=-q.read_shift(-8,"f");break;case"B":if(f&&j[B].len==8){d[I][B]=q.read_shift(8,"f");break}case"G":case"P":q.l+=j[B].len;break;case"0":if(j[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[B].type)}}}if(m!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return u&&u.sheetRows&&(d=d.slice(0,u.sheetRows)),u.DBF=j,d}function a(o,u){var d=u||{};d.dateNF||(d.dateNF="yyyymmdd");var c=Wh(r(o,d),d);return c["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,c}function n(o,u){try{return yu(a(o,u),u)}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,u){var d=u||{};if(+d.codepage>=0&&So(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var c=sl(),m=v0(o,{header:1,raw:!0,cellDates:!0}),h=m[0],f=m.slice(1),x=o["!cols"]||[],g=0,b=0,y=0,N=1;for(g=0;g<h.length;++g){if(((x[g]||{}).DBF||{}).name){h[g]=x[g].DBF.name,++y;continue}if(h[g]!=null){if(++y,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(b=0;b<1024;++b)if(h.indexOf(h[g]+"_"+b)==-1){h[g]+="_"+b;break}}}}var j=Cr(o["!ref"]),S=[],k=[],P=[];for(g=0;g<=j.e.c-j.s.c;++g){var I="",B="",q=0,Q=[];for(b=0;b<f.length;++b)f[b][g]!=null&&Q.push(f[b][g]);if(Q.length==0||h[g]==null){S[g]="?";continue}for(b=0;b<Q.length;++b){switch(typeof Q[b]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=Q[b]instanceof Date?"D":"C";break;default:B="C"}q=Math.max(q,String(Q[b]).length),I=I&&I!=B?"C":B}q>250&&(q=250),B=((x[g]||{}).DBF||{}).type,B=="C"&&x[g].DBF.len>q&&(q=x[g].DBF.len),I=="B"&&B=="N"&&(I="N",P[g]=x[g].DBF.dec,q=x[g].DBF.len),k[g]=I=="C"||B=="N"?q:i[I]||0,N+=k[g],S[g]=I}var O=c.next(32);for(O.write_shift(4,318902576),O.write_shift(4,f.length),O.write_shift(2,296+32*y),O.write_shift(2,N),g=0;g<4;++g)O.write_shift(4,0);for(O.write_shift(4,0|(+s[b4]||3)<<8),g=0,b=0;g<h.length;++g)if(h[g]!=null){var T=c.next(32),V=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,V,"sbcs"),T.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),T.write_shift(4,b),T.write_shift(1,k[g]||i[S[g]]||0),T.write_shift(1,P[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),b+=k[g]||i[S[g]]||0}var D=c.next(264);for(D.write_shift(4,13),g=0;g<65;++g)D.write_shift(4,0);for(g=0;g<f.length;++g){var Y=c.next(N);for(Y.write_shift(1,0),b=0;b<h.length;++b)if(h[b]!=null)switch(S[b]){case"L":Y.write_shift(1,f[g][b]==null?63:f[g][b]?84:70);break;case"B":Y.write_shift(8,f[g][b]||0,"f");break;case"N":var M="0";for(typeof f[g][b]=="number"&&(M=f[g][b].toFixed(P[b]||0)),y=0;y<k[b]-M.length;++y)Y.write_shift(1,32);Y.write_shift(1,M,"sbcs");break;case"D":f[g][b]?(Y.write_shift(4,("0000"+f[g][b].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(f[g][b].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+f[g][b].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var X=String(f[g][b]!=null?f[g][b]:"").slice(0,k[b]);for(Y.write_shift(1,X,"sbcs"),y=0;y<k[b]-X.length;++y)Y.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),TB=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},s=new RegExp("\x1BN("+Oa(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,f){var x=t[f];return typeof x=="number"?U2(x):x},a=function(h,f,x){var g=f.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?h:U2(g)};t["|"]=254;function n(h,f){switch(f.type){case"base64":return i(wl(h),f);case"binary":return i(h,f);case"buffer":return i(or&&Buffer.isBuffer(h)?h.toString("binary"):bu(h),f);case"array":return i(gA(h),f)}throw new Error("Unrecognized type "+f.type)}function i(h,f){var x=h.split(/[\n\r]+/),g=-1,b=-1,y=0,N=0,j=[],S=[],k=null,P={},I=[],B=[],q=[],Q=0,O;for(+f.codepage>=0&&So(+f.codepage);y!==x.length;++y){Q=0;var T=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(s,r),V=T.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),D=V[0],Y;if(T.length>0)switch(D){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&S.push(T.slice(3).replace(/;;/g,";"));break;case"C":var M=!1,X=!1,R=!1,H=!1,W=-1,K=-1;for(N=1;N<V.length;++N)switch(V[N].charAt(0)){case"A":break;case"X":b=parseInt(V[N].slice(1))-1,X=!0;break;case"Y":for(g=parseInt(V[N].slice(1))-1,X||(b=0),O=j.length;O<=g;++O)j[O]=[];break;case"K":Y=V[N].slice(1),Y.charAt(0)==='"'?Y=Y.slice(1,Y.length-1):Y==="TRUE"?Y=!0:Y==="FALSE"?Y=!1:isNaN(Bo(Y))?isNaN(Lh(Y).getDate())||(Y=Aa(Y)):(Y=Bo(Y),k!==null&&Vh(k)&&(Y=ig(Y))),M=!0;break;case"E":H=!0;var _=Ch(V[N].slice(1),{r:g,c:b});j[g][b]=[j[g][b],_];break;case"S":R=!0,j[g][b]=[j[g][b],"S5S"];break;case"G":break;case"R":W=parseInt(V[N].slice(1))-1;break;case"C":K=parseInt(V[N].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+T)}if(M&&(j[g][b]&&j[g][b].length==2?j[g][b][0]=Y:j[g][b]=Y,k=null),R){if(H)throw new Error("SYLK shared formula cannot have own formula");var F=W>-1&&j[W][K];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");j[g][b][1]=YB(F[1],{r:g-W,c:b-K})}break;case"F":var E=0;for(N=1;N<V.length;++N)switch(V[N].charAt(0)){case"X":b=parseInt(V[N].slice(1))-1,++E;break;case"Y":for(g=parseInt(V[N].slice(1))-1,O=j.length;O<=g;++O)j[O]=[];break;case"M":Q=parseInt(V[N].slice(1))/20;break;case"F":break;case"G":break;case"P":k=S[parseInt(V[N].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=V[N].slice(1).split(" "),O=parseInt(q[0],10);O<=parseInt(q[1],10);++O)Q=parseInt(q[2],10),B[O-1]=Q===0?{hidden:!0}:{wch:Q},mu(B[O-1]);break;case"C":b=parseInt(V[N].slice(1))-1,B[b]||(B[b]={});break;case"R":g=parseInt(V[N].slice(1))-1,I[g]||(I[g]={}),Q>0?(I[g].hpt=Q,I[g].hpx=Ph(Q)):Q===0&&(I[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+T)}E<1&&(k=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+T)}}return I.length>0&&(P["!rows"]=I),B.length>0&&(P["!cols"]=B),f&&f.sheetRows&&(j=j.slice(0,f.sheetRows)),[j,P]}function l(h,f){var x=n(h,f),g=x[0],b=x[1],y=Wh(g,f);return Oa(b).forEach(function(N){y[N]=b[N]}),y}function o(h,f){return yu(l(h,f),f)}function u(h,f,x,g){var b="C;Y"+(x+1)+";X"+(g+1)+";K";switch(h.t){case"n":b+=h.v||0,h.f&&!h.F&&(b+=";E"+P1(h.f,{r:x,c:g}));break;case"b":b+=h.v?"TRUE":"FALSE";break;case"e":b+=h.w||h.v;break;case"d":b+='"'+(h.w||h.v)+'"';break;case"s":b+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(h,f){f.forEach(function(x,g){var b="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?b+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=yf(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=jf(x.wpx)),typeof x.wch=="number"&&(b+=Math.round(x.wch))),b.charAt(b.length-1)!=" "&&h.push(b)})}function c(h,f){f.forEach(function(x,g){var b="F;";x.hidden?b+="M0;":x.hpt?b+="M"+20*x.hpt+";":x.hpx&&(b+="M"+20*Nf(x.hpx)+";"),b.length>2&&h.push(b+"R"+(g+1))})}function m(h,f){var x=["ID;PWXL;N;E"],g=[],b=Cr(h["!ref"]),y,N=Array.isArray(h),j=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&c(x,h["!rows"]),x.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var S=b.s.r;S<=b.e.r;++S)for(var k=b.s.c;k<=b.e.c;++k){var P=Ys({r:S,c:k});y=N?(h[S]||[])[k]:h[P],!(!y||y.v==null&&(!y.f||y.F))&&g.push(u(y,h,S,k))}return x.join(j)+j+g.join(j)+j+"E"+j}return{to_workbook:o,to_sheet:l,from_sheet:m}})(),IB=(function(){function t(i,l){switch(l.type){case"base64":return s(wl(i),l);case"binary":return s(i,l);case"buffer":return s(or&&Buffer.isBuffer(i)?i.toString("binary"):bu(i),l);case"array":return s(gA(i),l)}throw new Error("Unrecognized type "+l.type)}function s(i,l){for(var o=i.split(`
`),u=-1,d=-1,c=0,m=[];c!==o.length;++c){if(o[c].trim()==="BOT"){m[++u]=[],d=0;continue}if(!(u<0)){var h=o[c].trim().split(","),f=h[0],x=h[1];++c;for(var g=o[c]||"";(g.match(/["]/g)||[]).length&1&&c<o.length-1;)g+=`
`+o[++c];switch(g=g.trim(),+f){case-1:if(g==="BOT"){m[++u]=[],d=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?m[u][d]=!0:g==="FALSE"?m[u][d]=!1:isNaN(Bo(x))?isNaN(Lh(x).getDate())?m[u][d]=x:m[u][d]=Aa(x):m[u][d]=Bo(x),++d;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),m[u][d++]=g!==""?g:null;break}if(g==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function r(i,l){return Wh(t(i,l),l)}function a(i,l){return yu(r(i,l),l)}var n=(function(){var i=function(u,d,c,m,h){u.push(d),u.push(c+","+m),u.push('"'+h.replace(/"/g,'""')+'"')},l=function(u,d,c,m){u.push(d+","+c),u.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(u){var d=[],c=Cr(u["!ref"]),m,h=Array.isArray(u);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,c.e.r-c.s.r+1,""),i(d,"TUPLES",0,c.e.c-c.s.c+1,""),i(d,"DATA",0,0,"");for(var f=c.s.r;f<=c.e.r;++f){l(d,-1,0,"BOT");for(var x=c.s.c;x<=c.e.c;++x){var g=Ys({r:f,c:x});if(m=h?(u[f]||[])[x]:u[g],!m){l(d,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?l(d,1,0,"="+m.f):l(d,1,0,""):l(d,0,b,"V");break;case"b":l(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=Xl(m.z||Ws[14],xn(Aa(m.v)))),l(d,0,m.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var y=`\r
`,N=d.join(y);return N}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),LB=(function(){function t(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function s(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(m,h){for(var f=m.split(`
`),x=-1,g=-1,b=0,y=[];b!==f.length;++b){var N=f[b].trim().split(":");if(N[0]==="cell"){var j=Sa(N[1]);if(y.length<=j.r)for(x=y.length;x<=j.r;++x)y[x]||(y[x]=[]);switch(x=j.r,g=j.c,N[2]){case"t":y[x][g]=t(N[3]);break;case"v":y[x][g]=+N[3];break;case"vtf":var S=N[N.length-1];case"vtc":switch(N[3]){case"nl":y[x][g]=!!+N[4];break;default:y[x][g]=+N[4];break}N[2]=="vtf"&&(y[x][g]=[y[x][g],S])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function a(m,h){return Wh(r(m,h),h)}function n(m,h){return yu(a(m,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var h=[],f=[],x,g="",b=rl(m["!ref"]),y=Array.isArray(m),N=b.s.r;N<=b.e.r;++N)for(var j=b.s.c;j<=b.e.c;++j)if(g=Ys({r:N,c:j}),x=y?(m[N]||[])[j]:m[g],!(!x||x.v==null||x.t==="z")){switch(f=["cell",g,"t"],x.t){case"s":case"str":f.push(s(x.v));break;case"n":x.f?(f[2]="vtf",f[3]="n",f[4]=x.v,f[5]=s(x.f)):(f[2]="v",f[3]=x.v);break;case"b":f[2]="vt"+(x.f?"f":"c"),f[3]="nl",f[4]=x.v?"1":"0",f[5]=s(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var S=xn(Aa(x.v));f[2]="vtc",f[3]="nd",f[4]=""+S,f[5]=x.w||Xl(x.z||Ws[14],S);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function c(m){return[i,l,o,l,d(m),u].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:c}})(),Dh=(function(){function t(c,m,h,f,x){x.raw?m[h][f]=c:c===""||(c==="TRUE"?m[h][f]=!0:c==="FALSE"?m[h][f]=!1:isNaN(Bo(c))?isNaN(Lh(c).getDate())?m[h][f]=c:m[h][f]=Aa(c):m[h][f]=Bo(c))}function s(c,m){var h=m||{},f=[];if(!c||c.length===0)return f;for(var x=c.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var b=10,y=0,N=0;N<=g;++N)y=x[N].indexOf(" "),y==-1?y=x[N].length:y++,b=Math.max(b,y);for(N=0;N<=g;++N){f[N]=[];var j=0;for(t(x[N].slice(0,b).trim(),f,N,j,h),j=1;j<=(x[N].length-b)/10+1;++j)t(x[N].slice(b+(j-1)*10,b+j*10).trim(),f,N,j,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(c){for(var m={},h=!1,f=0,x=0;f<c.length;++f)(x=c.charCodeAt(f))==34?h=!h:!h&&x in r&&(m[x]=(m[x]||0)+1);x=[];for(f in m)Object.prototype.hasOwnProperty.call(m,f)&&x.push([m[f],f]);if(!x.length){m=a;for(f in m)Object.prototype.hasOwnProperty.call(m,f)&&x.push([m[f],f])}return x.sort(function(g,b){return g[0]-b[0]||a[g[1]]-a[b[1]]}),r[x.pop()[1]]||44}function i(c,m){var h=m||{},f="",x=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(f=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(f=c.charAt(4),c=c.slice(6)):f=n(c.slice(0,1024)):h&&h.FS?f=h.FS:f=n(c.slice(0,1024));var b=0,y=0,N=0,j=0,S=0,k=f.charCodeAt(0),P=!1,I=0,B=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var q=h.dateNF!=null?jQ(h.dateNF):null;function Q(){var O=c.slice(j,S),T={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)T.t="z";else if(h.raw)T.t="s",T.v=O;else if(O.trim().length===0)T.t="s",T.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(T.t="s",T.v=O.slice(2,-1).replace(/""/g,'"')):Xq(O)?(T.t="n",T.f=O.slice(1)):(T.t="s",T.v=O);else if(O=="TRUE")T.t="b",T.v=!0;else if(O=="FALSE")T.t="b",T.v=!1;else if(!isNaN(N=Bo(O)))T.t="n",h.cellText!==!1&&(T.w=O),T.v=N;else if(!isNaN(Lh(O).getDate())||q&&O.match(q)){T.z=h.dateNF||Ws[14];var V=0;q&&O.match(q)&&(O=NQ(O,h.dateNF,O.match(q)||[]),V=1),h.cellDates?(T.t="d",T.v=Aa(O,V)):(T.t="n",T.v=xn(Aa(O,V))),h.cellText!==!1&&(T.w=Xl(T.z,T.v instanceof Date?xn(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=O;if(T.t=="z"||(h.dense?(x[b]||(x[b]=[]),x[b][y]=T):x[Ys({c:y,r:b})]=T),j=S+1,B=c.charCodeAt(j),g.e.c<y&&(g.e.c=y),g.e.r<b&&(g.e.r=b),I==k)++y;else if(y=0,++b,h.sheetRows&&h.sheetRows<=b)return!0}e:for(;S<c.length;++S)switch(I=c.charCodeAt(S)){case 34:B===34&&(P=!P);break;case k:case 10:case 13:if(!P&&Q())break e;break}return S-j>0&&Q(),x["!ref"]=ir(g),x}function l(c,m){return!(m&&m.PRN)||m.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?i(c,m):Wh(s(c,m),m)}function o(c,m){var h="",f=m.type=="string"?[0,0,0,0]:V1(c,m);switch(m.type){case"base64":h=wl(c);break;case"binary":h=c;break;case"buffer":m.codepage==65001?h=c.toString("utf8"):m.codepage&&typeof hf<"u"||(h=or&&Buffer.isBuffer(c)?c.toString("binary"):bu(c));break;case"array":h=gA(c);break;case"string":h=c;break;default:throw new Error("Unrecognized type "+m.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=Xr(h.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?h=Xr(h):m.type=="binary"&&typeof hf<"u",h.slice(0,19)=="socialcalc:version:"?LB.to_sheet(m.type=="string"?h:Xr(h),m):l(h,m)}function u(c,m){return yu(o(c,m),m)}function d(c){for(var m=[],h=Cr(c["!ref"]),f,x=Array.isArray(c),g=h.s.r;g<=h.e.r;++g){for(var b=[],y=h.s.c;y<=h.e.c;++y){var N=Ys({r:g,c:y});if(f=x?(c[g]||[])[y]:c[N],!f||f.v==null){b.push("          ");continue}for(var j=(f.w||(sd(f),f.w)||"").slice(0,10);j.length<10;)j+=" ";b.push(j+(y===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:d}})();function UH(t,s){var r=s||{},a=!!r.WTF;r.WTF=!0;try{var n=TB.to_workbook(t,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Dh.to_workbook(t,s)}}var hA=(function(){function t(_,F,E){if(_){qn(_,_.l||0);for(var L=E.Enum||W;_.l<_.length;){var U=_.read_shift(2),J=L[U]||L[65535],ae=_.read_shift(2),Z=_.l+ae,oe=J.f&&J.f(_,ae,E);if(_.l=Z,F(oe,J,U))return}}}function s(_,F){switch(F.type){case"base64":return r(gl(wl(_)),F);case"binary":return r(gl(_),F);case"buffer":case"array":return r(_,F)}throw"Unsupported type "+F.type}function r(_,F){if(!_)return _;var E=F||{},L=E.dense?[]:{},U="Sheet1",J="",ae=0,Z={},oe=[],ee=[],se={s:{r:0,c:0},e:{r:0,c:0}},Ae=E.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)E.Enum=W,t(_,function(_e,Qe,Ie){switch(Ie){case 0:E.vers=_e,_e>=4096&&(E.qpro=!0);break;case 6:se=_e;break;case 204:_e&&(J=_e);break;case 222:J=_e;break;case 15:case 51:E.qpro||(_e[1].v=_e[1].v.slice(1));case 13:case 14:case 16:Ie==14&&(_e[2]&112)==112&&(_e[2]&15)>1&&(_e[2]&15)<15&&(_e[1].z=E.dateNF||Ws[14],E.cellDates&&(_e[1].t="d",_e[1].v=ig(_e[1].v))),E.qpro&&_e[3]>ae&&(L["!ref"]=ir(se),Z[U]=L,oe.push(U),L=E.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},ae=_e[3],U=J||"Sheet"+(ae+1),J="");var ke=E.dense?(L[_e[0].r]||[])[_e[0].c]:L[Ys(_e[0])];if(ke){ke.t=_e[1].t,ke.v=_e[1].v,_e[1].z!=null&&(ke.z=_e[1].z),_e[1].f!=null&&(ke.f=_e[1].f);break}E.dense?(L[_e[0].r]||(L[_e[0].r]=[]),L[_e[0].r][_e[0].c]=_e[1]):L[Ys(_e[0])]=_e[1];break}},E);else if(_[2]==26||_[2]==14)E.Enum=K,_[2]==14&&(E.qpro=!0,_.l=0),t(_,function(_e,Qe,Ie){switch(Ie){case 204:U=_e;break;case 22:_e[1].v=_e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(_e[3]>ae&&(L["!ref"]=ir(se),Z[U]=L,oe.push(U),L=E.dense?[]:{},se={s:{r:0,c:0},e:{r:0,c:0}},ae=_e[3],U="Sheet"+(ae+1)),Ae>0&&_e[0].r>=Ae)break;E.dense?(L[_e[0].r]||(L[_e[0].r]=[]),L[_e[0].r][_e[0].c]=_e[1]):L[Ys(_e[0])]=_e[1],se.e.c<_e[0].c&&(se.e.c=_e[0].c),se.e.r<_e[0].r&&(se.e.r=_e[0].r);break;case 27:_e[14e3]&&(ee[_e[14e3][0]]=_e[14e3][1]);break;case 1537:ee[_e[0]]=_e[1],_e[0]==ae&&(U=_e[1]);break}},E);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(L["!ref"]=ir(se),Z[J||U]=L,oe.push(J||U),!ee.length)return{SheetNames:oe,Sheets:Z};for(var we={},ce=[],le=0;le<ee.length;++le)Z[oe[le]]?(ce.push(ee[le]||oe[le]),we[ee[le]]=Z[ee[le]]||Z[oe[le]]):(ce.push(ee[le]),we[ee[le]]={"!ref":"A1"});return{SheetNames:ce,Sheets:we}}function a(_,F){var E=F||{};if(+E.codepage>=0&&So(+E.codepage),E.type=="string")throw new Error("Cannot write WK1 to JS string");var L=sl(),U=Cr(_["!ref"]),J=Array.isArray(_),ae=[];gs(L,0,i(1030)),gs(L,6,u(U));for(var Z=Math.min(U.e.r,8191),oe=U.s.r;oe<=Z;++oe)for(var ee=Xa(oe),se=U.s.c;se<=U.e.c;++se){oe===U.s.r&&(ae[se]=_a(se));var Ae=ae[se]+ee,we=J?(_[oe]||[])[se]:_[Ae];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?gs(L,13,f(oe,se,we.v)):gs(L,14,g(oe,se,we.v));else{var ce=sd(we);gs(L,15,m(oe,se,ce.slice(0,239)))}}return gs(L,1),L.end()}function n(_,F){var E=F||{};if(+E.codepage>=0&&So(+E.codepage),E.type=="string")throw new Error("Cannot write WK3 to JS string");var L=sl();gs(L,0,l(_));for(var U=0,J=0;U<_.SheetNames.length;++U)(_.Sheets[_.SheetNames[U]]||{})["!ref"]&&gs(L,27,H(_.SheetNames[U],J++));var ae=0;for(U=0;U<_.SheetNames.length;++U){var Z=_.Sheets[_.SheetNames[U]];if(!(!Z||!Z["!ref"])){for(var oe=Cr(Z["!ref"]),ee=Array.isArray(Z),se=[],Ae=Math.min(oe.e.r,8191),we=oe.s.r;we<=Ae;++we)for(var ce=Xa(we),le=oe.s.c;le<=oe.e.c;++le){we===oe.s.r&&(se[le]=_a(le));var _e=se[le]+ce,Qe=ee?(Z[we]||[])[le]:Z[_e];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")gs(L,23,Q(we,le,ae,Qe.v));else{var Ie=sd(Qe);gs(L,22,I(we,le,ae,Ie.slice(0,239)))}}++ae}}return gs(L,1),L.end()}function i(_){var F=Jt(2);return F.write_shift(2,_),F}function l(_){var F=Jt(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var E=0,L=0,U=0,J=0;J<_.SheetNames.length;++J){var ae=_.SheetNames[J],Z=_.Sheets[ae];if(!(!Z||!Z["!ref"])){++U;var oe=rl(Z["!ref"]);E<oe.e.r&&(E=oe.e.r),L<oe.e.c&&(L=oe.e.c)}}return E>8191&&(E=8191),F.write_shift(2,E),F.write_shift(1,U),F.write_shift(1,L),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function o(_,F,E){var L={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&E.qpro?(L.s.c=_.read_shift(1),_.l++,L.s.r=_.read_shift(2),L.e.c=_.read_shift(1),_.l++,L.e.r=_.read_shift(2),L):(L.s.c=_.read_shift(2),L.s.r=_.read_shift(2),F==12&&E.qpro&&(_.l+=2),L.e.c=_.read_shift(2),L.e.r=_.read_shift(2),F==12&&E.qpro&&(_.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function u(_){var F=Jt(8);return F.write_shift(2,_.s.c),F.write_shift(2,_.s.r),F.write_shift(2,_.e.c),F.write_shift(2,_.e.r),F}function d(_,F,E){var L=[{c:0,r:0},{t:"n",v:0},0,0];return E.qpro&&E.vers!=20768?(L[0].c=_.read_shift(1),L[3]=_.read_shift(1),L[0].r=_.read_shift(2),_.l+=2):(L[2]=_.read_shift(1),L[0].c=_.read_shift(2),L[0].r=_.read_shift(2)),L}function c(_,F,E){var L=_.l+F,U=d(_,F,E);if(U[1].t="s",E.vers==20768){_.l++;var J=_.read_shift(1);return U[1].v=_.read_shift(J,"utf8"),U}return E.qpro&&_.l++,U[1].v=_.read_shift(L-_.l,"cstr"),U}function m(_,F,E){var L=Jt(7+E.length);L.write_shift(1,255),L.write_shift(2,F),L.write_shift(2,_),L.write_shift(1,39);for(var U=0;U<L.length;++U){var J=E.charCodeAt(U);L.write_shift(1,J>=128?95:J)}return L.write_shift(1,0),L}function h(_,F,E){var L=d(_,F,E);return L[1].v=_.read_shift(2,"i"),L}function f(_,F,E){var L=Jt(7);return L.write_shift(1,255),L.write_shift(2,F),L.write_shift(2,_),L.write_shift(2,E,"i"),L}function x(_,F,E){var L=d(_,F,E);return L[1].v=_.read_shift(8,"f"),L}function g(_,F,E){var L=Jt(13);return L.write_shift(1,255),L.write_shift(2,F),L.write_shift(2,_),L.write_shift(8,E,"f"),L}function b(_,F,E){var L=_.l+F,U=d(_,F,E);if(U[1].v=_.read_shift(8,"f"),E.qpro)_.l=L;else{var J=_.read_shift(2);S(_.slice(_.l,_.l+J),U),_.l+=J}return U}function y(_,F,E){var L=F&32768;return F&=-32769,F=(L?_:0)+(F>=8192?F-16384:F),(L?"":"$")+(E?_a(F):Xa(F))}var N={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(_,F){qn(_,0);for(var E=[],L=0,U="",J="",ae="",Z="";_.l<_.length;){var oe=_[_.l++];switch(oe){case 0:E.push(_.read_shift(8,"f"));break;case 1:J=y(F[0].c,_.read_shift(2),!0),U=y(F[0].r,_.read_shift(2),!1),E.push(J+U);break;case 2:{var ee=y(F[0].c,_.read_shift(2),!0),se=y(F[0].r,_.read_shift(2),!1);J=y(F[0].c,_.read_shift(2),!0),U=y(F[0].r,_.read_shift(2),!1),E.push(ee+se+":"+J+U)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:E.push("("+E.pop()+")");break;case 5:E.push(_.read_shift(2));break;case 6:{for(var Ae="";oe=_[_.l++];)Ae+=String.fromCharCode(oe);E.push('"'+Ae.replace(/"/g,'""')+'"')}break;case 8:E.push("-"+E.pop());break;case 23:E.push("+"+E.pop());break;case 22:E.push("NOT("+E.pop()+")");break;case 20:case 21:Z=E.pop(),ae=E.pop(),E.push(["AND","OR"][oe-20]+"("+ae+","+Z+")");break;default:if(oe<32&&j[oe])Z=E.pop(),ae=E.pop(),E.push(ae+j[oe]+Z);else if(N[oe]){if(L=N[oe][1],L==69&&(L=_[_.l++]),L>E.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+E.join("|")+"|");return}var we=E.slice(-L);E.length-=L,E.push(N[oe][0]+"("+we.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}E.length==1?F[1].f=""+E[0]:console.error("WK1 bad formula parse |"+E.join("|")+"|")}function k(_){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=_.read_shift(2),F[3]=_[_.l++],F[0].c=_[_.l++],F}function P(_,F){var E=k(_);return E[1].t="s",E[1].v=_.read_shift(F-4,"cstr"),E}function I(_,F,E,L){var U=Jt(6+L.length);U.write_shift(2,_),U.write_shift(1,E),U.write_shift(1,F),U.write_shift(1,39);for(var J=0;J<L.length;++J){var ae=L.charCodeAt(J);U.write_shift(1,ae>=128?95:ae)}return U.write_shift(1,0),U}function B(_,F){var E=k(_);E[1].v=_.read_shift(2);var L=E[1].v>>1;if(E[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return E[1].v=L,E}function q(_,F){var E=k(_),L=_.read_shift(4),U=_.read_shift(4),J=_.read_shift(2);if(J==65535)return L===0&&U===3221225472?(E[1].t="e",E[1].v=15):L===0&&U===3489660928?(E[1].t="e",E[1].v=42):E[1].v=0,E;var ae=J&32768;return J=(J&32767)-16446,E[1].v=(1-ae*2)*(U*Math.pow(2,J+32)+L*Math.pow(2,J)),E}function Q(_,F,E,L){var U=Jt(14);if(U.write_shift(2,_),U.write_shift(1,E),U.write_shift(1,F),L==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var J=0,ae=0,Z=0,oe=0;return L<0&&(J=1,L=-L),ae=Math.log2(L)|0,L/=Math.pow(2,ae-31),oe=L>>>0,(oe&2147483648)==0&&(L/=2,++ae,oe=L>>>0),L-=oe,oe|=2147483648,oe>>>=0,L*=Math.pow(2,32),Z=L>>>0,U.write_shift(4,Z),U.write_shift(4,oe),ae+=16383+(J?32768:0),U.write_shift(2,ae),U}function O(_,F){var E=q(_);return _.l+=F-14,E}function T(_,F){var E=k(_),L=_.read_shift(4);return E[1].v=L>>6,E}function V(_,F){var E=k(_),L=_.read_shift(8,"f");return E[1].v=L,E}function D(_,F){var E=V(_);return _.l+=F-10,E}function Y(_,F){return _[_.l+F-1]==0?_.read_shift(F,"cstr"):""}function M(_,F){var E=_[_.l++];E>F-1&&(E=F-1);for(var L="";L.length<E;)L+=String.fromCharCode(_[_.l++]);return L}function X(_,F,E){if(!(!E.qpro||F<21)){var L=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var U=_.read_shift(F-21,"cstr");return[L,U]}}function R(_,F){for(var E={},L=_.l+F;_.l<L;){var U=_.read_shift(2);if(U==14e3){for(E[U]=[0,""],E[U][0]=_.read_shift(2);_[_.l];)E[U][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return E}function H(_,F){var E=Jt(5+_.length);E.write_shift(2,14e3),E.write_shift(2,F);for(var L=0;L<_.length;++L){var U=_.charCodeAt(L);E[E.l++]=U>127?95:U}return E[E.l++]=0,E}var W={0:{n:"BOF",f:nn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:M},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:R},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:D},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:s}})();function RH(t){var s={},r=t.match(bi),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=Js(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":s.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;s.cp=l1[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":s.outline=1;break;case"</outline>":break;case"<rFont":s.name=i.val;break;case"<sz":s.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":s.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":s.uval="double";break;case"singleAccounting":s.uval="single-accounting";break;case"doubleAccounting":s.uval="double-accounting";break}case"<u>":case"<u/>":s.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":s.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":s.i=1;break;case"</i>":break;case"<color":i.rgb&&(s.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":s.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":s.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return s}var OH=(function(){var t=pf("t"),s=pf("rPr");function r(i){var l=i.match(t);if(!l)return{t:"s",v:""};var o={t:"s",v:Sr(l[1])},u=i.match(s);return u&&(o.s=RH(u[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(o){return o.v})}})(),QH=(function(){var s=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var u=n.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),l.push("</"+u+">")),l.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(s,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),MH=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,HH=/<(?:\w+:)?r>/,qH=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function F1(t,s){var r=s?s.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Sr(Xr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Xr(t),r&&(a.h=x1(a.t))):t.match(HH)&&(a.r=Xr(t),a.t=Sr(Xr((t.replace(qH,"").match(MH)||[]).join("").replace(bi,""))),r&&(a.h=QH(OH(a.r)))),a):{t:""}}var VH=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$H=/<(?:\w+:)?(?:si|sstItem)>/g,WH=/<\/(?:\w+:)?(?:si|sstItem)>/;function GH(t,s){var r=[],a="";if(!t)return r;var n=t.match(VH);if(n){a=n[2].replace($H,"").split(WH);for(var i=0;i!=a.length;++i){var l=F1(a[i].trim(),s);l!=null&&(r[r.length]=l)}n=Js(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var KH=/^\s|\s$|[\t\n\r]/;function DB(t,s){if(!s.bookSST)return"";var r=[Za];r[r.length]=xs("sst",null,{xmlns:wA[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(KH)&&(i+=' xml:space="preserve"'),i+=">"+Kr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function zH(t){return[t.read_shift(4),t.read_shift(4)]}function YH(t,s){var r=[],a=!1;return id(t,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||s.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function XH(t,s){return s||(s=Jt(8)),s.write_shift(4,t.Count),s.write_shift(4,t.Unique),s}var JH=o7;function ZH(t){var s=sl();is(s,159,XH(t));for(var r=0;r<t.length;++r)is(s,19,JH(t[r]));return is(s,160),s.end()}function PB(t){for(var s=[],r=t.split(""),a=0;a<r.length;++a)s[a]=r[a].charCodeAt(0);return s}function Zc(t,s){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),s>=4&&(t.l+=s-4),r}function e9(t){var s={};return s.id=t.read_shift(0,"lpp4"),s.R=Zc(t,4),s.U=Zc(t,4),s.W=Zc(t,4),s}function t9(t){for(var s=t.read_shift(4),r=t.l+s-4,a={},n=t.read_shift(4),i=[];n-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function s9(t){var s=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)s.push(t9(t));return s}function r9(t){var s=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)s.push(t.read_shift(0,"lpp4"));return s}function a9(t){var s={};return t.read_shift(4),t.l+=4,s.id=t.read_shift(0,"lpp4"),s.name=t.read_shift(0,"lpp4"),s.R=Zc(t,4),s.U=Zc(t,4),s.W=Zc(t,4),s}function n9(t){var s=a9(t);if(s.ename=t.read_shift(0,"8lpp4"),s.blksz=t.read_shift(4),s.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return s}function UB(t,s){var r=t.l+s,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function RB(t,s){var r={},a=t.l+s;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function i9(t){var s=Zc(t);switch(s.Minor){case 2:return[s.Minor,l9(t)];case 3:return[s.Minor,o9()];case 4:return[s.Minor,c9(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+s.Minor)}function l9(t){var s=t.read_shift(4);if((s&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=UB(t,r),n=RB(t,t.length-t.l);return{t:"Std",h:a,v:n}}function o9(){throw new Error("File is password-protected: ECMA-376 Extensible")}function c9(t){var s=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(bi,function(i){var l=Js(i);switch(hc(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":s.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function d9(t,s){var r={},a=r.EncryptionVersionInfo=Zc(t,4);if(s-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),s-=4;var n=t.read_shift(4);return s-=4,r.EncryptionHeader=UB(t,n),s-=n,r.EncryptionVerifier=RB(t,s),r}function u9(t){var s={},r=s.EncryptionVersionInfo=Zc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return s.Salt=t.read_shift(16),s.EncryptedVerifier=t.read_shift(16),s.EncryptedVerifierHash=t.read_shift(16),s}function T1(t){var s=0,r,a=PB(t),n=a.length+1,i,l,o,u,d;for(r=hu(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)l=r[i],o=(s&16384)===0?0:1,u=s<<1&32767,d=o|u,s=d^l;return s^52811}var OB=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],s=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,o){return a(l^o)},i=function(l){for(var o=s[l.length-1],u=104,d=l.length-1;d>=0;--d)for(var c=l[d],m=0;m!=7;++m)c&64&&(o^=r[u]),c*=2,--u;return o};return function(l){for(var o=PB(l),u=i(o),d=o.length,c=hu(16),m=0;m!=16;++m)c[m]=0;var h,f,x;for((d&1)===1&&(h=u>>8,c[d]=n(t[0],h),--d,h=u&255,f=o[o.length-1],c[d]=n(f,h));d>0;)--d,h=u>>8,c[d]=n(o[d],h),--d,h=u&255,c[d]=n(o[d],h);for(d=15,x=15-o.length;x>0;)h=u>>8,c[d]=n(t[x],h),--d,--x,h=u&255,c[d]=n(o[d],h),--d,--x;return c}})(),A9=function(t,s,r,a,n){n||(n=s),a||(a=OB(t));var i,l;for(i=0;i!=s.length;++i)l=s[i],l^=a[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,a]},h9=function(t){var s=0,r=OB(t);return function(a){var n=A9("",a,s,r);return s=n[1],n[0]}};function m9(t,s,r,a){var n={key:nn(t),verificationBytes:nn(t)};return r.password&&(n.verifier=T1(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=h9(r.password)),n}function f9(t,s,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=u9(t):a.Data=d9(t,s),a}function p9(t,s,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?f9(t,s-2,a):m9(t,r.biff>=8?s:s-2,r,a),a}var QB=(function(){function t(n,i){switch(i.type){case"base64":return s(wl(n),i);case"binary":return s(n,i);case"buffer":return s(or&&Buffer.isBuffer(n)?n.toString("binary"):bu(n),i);case"array":return s(gA(n),i)}throw new Error("Unrecognized type "+i.type)}function s(n,i){var l=i||{},o=l.dense?[]:{},u=n.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(c,m){Array.isArray(o)&&(o[m]=[]);for(var h=/\\\w+\b/g,f=0,x,g=-1;x=h.exec(c);){switch(x[0]){case"\\cell":var b=c.slice(f,h.lastIndex-x[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var y={v:b,t:"s"};Array.isArray(o)?o[m][g]=y:o[Ys({r:m,c:g})]=y}break}f=h.lastIndex}g>d.e.c&&(d.e.c=g)}),o["!ref"]=ir(d),o}function r(n,i){return yu(t(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],l=Cr(n["!ref"]),o,u=Array.isArray(n),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var c=l.s.c;c<=l.e.c;++c)i.push("\\cellx"+(c+1));for(i.push("\\pard\\intbl"),c=l.s.c;c<=l.e.c;++c){var m=Ys({r:d,c});o=u?(n[d]||[])[c]:n[m],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(sd(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function x9(t){var s=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]}function bf(t){for(var s=0,r=1;s!=3;++s)r=r*256+(t[s]>255?255:t[s]<0?0:t[s]);return r.toString(16).toUpperCase().slice(1)}function g9(t){var s=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(s,r,a),i=Math.min(s,r,a),l=n-i;if(l===0)return[0,0,s];var o=0,u=0,d=n+i;switch(u=l/(d>1?2-d:d),n){case s:o=((r-a)/l+6)%6;break;case r:o=(a-s)/l+2;break;case a:o=(s-r)/l+4;break}return[o/6,u,d/2]}function v9(t){var s=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),i=a-n/2,l=[i,i,i],o=6*s,u;if(r!==0)switch(o|0){case 0:case 6:u=n*o,l[0]+=n,l[1]+=u;break;case 1:u=n*(2-o),l[0]+=u,l[1]+=n;break;case 2:u=n*(o-2),l[1]+=n,l[2]+=u;break;case 3:u=n*(4-o),l[1]+=u,l[2]+=n;break;case 4:u=n*(o-4),l[2]+=n,l[0]+=u;break;case 5:u=n*(6-o),l[2]+=u,l[0]+=n;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function p0(t,s){if(s===0)return t;var r=g9(x9(t));return s<0?r[2]=r[2]*(1+s):r[2]=1-(1-r[2])*(1-s),bf(v9(r))}var MB=6,b9=15,y9=1,mi=MB;function yf(t){return Math.floor((t+Math.round(128/mi)/256)*mi)}function jf(t){return Math.floor((t-5)/mi*100+.5)/100}function x0(t){return Math.round((t*mi+5)/mi*256)/256}function eb(t){return x0(jf(yf(t)))}function I1(t){var s=Math.abs(t-eb(t)),r=mi;if(s>.005)for(mi=y9;mi<b9;++mi)Math.abs(t-eb(t))<=s&&(s=Math.abs(t-eb(t)),r=mi);mi=r}function mu(t){t.width?(t.wpx=yf(t.width),t.wch=jf(t.wpx),t.MDW=mi):t.wpx?(t.wch=jf(t.wpx),t.width=x0(t.wch),t.MDW=mi):typeof t.wch=="number"&&(t.width=x0(t.wch),t.wpx=yf(t.width),t.MDW=mi),t.customWidth&&delete t.customWidth}var j9=96,HB=j9;function Nf(t){return t*96/HB}function Ph(t){return t*HB/96}var N9={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function w9(t,s,r,a){s.Borders=[];var n={},i=!1;(t[0].match(bi)||[]).forEach(function(l){var o=Js(l);switch(hc(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=da(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=da(o.diagonalDown)),s.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function _9(t,s,r,a){s.Fills=[];var n={},i=!1;(t[0].match(bi)||[]).forEach(function(l){var o=Js(l);switch(hc(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},s.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":s.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function S9(t,s,r,a){s.Fonts=[];var n={},i=!1;(t[0].match(bi)||[]).forEach(function(l){var o=Js(l);switch(hc(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":s.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=Xr(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?da(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?da(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?da(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?da(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?da(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?da(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?da(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=l1[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=da(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var u=uA[n.color.index];n.color.index==81&&(u=uA[1]),u||(u=uA[1]),n.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=p0(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function C9(t,s,r){s.NumberFmt=[];for(var a=Oa(Ws),n=0;n<a.length;++n)s.NumberFmt[a[n]]=Ws[a[n]];var i=t[0].match(bi);if(i)for(n=0;n<i.length;++n){var l=Js(i[n]);switch(hc(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Sr(Xr(l.formatCode)),u=parseInt(l.numFmtId,10);if(s.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&s.NumberFmt[u]!=null;--u);s.NumberFmt[u]=o}Jc(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function B9(t){var s=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(s[s.length]=xs("numFmt",null,{numFmtId:a,formatCode:Kr(t[a])}))}),s.length===1?"":(s[s.length]="</numFmts>",s[0]=xs("numFmts",null,{count:s.length-2}).replace("/>",">"),s.join(""))}var hx=["numFmtId","fillId","fontId","borderId","xfId"],mx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function k9(t,s,r){s.CellXf=[];var a,n=!1;(t[0].match(bi)||[]).forEach(function(i){var l=Js(i),o=0;switch(hc(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<hx.length;++o)a[hx[o]]&&(a[hx[o]]=parseInt(a[hx[o]],10));for(o=0;o<mx.length;++o)a[mx[o]]&&(a[mx[o]]=da(a[mx[o]]));if(s.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(s.NumberFmt[a.numFmtId]==s.NumberFmt[o]){a.numFmtId=o;break}}s.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};l.vertical&&(u.vertical=l.vertical),l.horizontal&&(u.horizontal=l.horizontal),l.textRotation!=null&&(u.textRotation=l.textRotation),l.indent&&(u.indent=l.indent),l.wrapText&&(u.wrapText=da(l.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function E9(t){var s=[];return s[s.length]=xs("cellXfs",null),t.forEach(function(r){s[s.length]=xs("xf",null,r)}),s[s.length]="</cellXfs>",s.length===2?"":(s[0]=xs("cellXfs",null,{count:s.length-2}).replace("/>",">"),s.join(""))}var F9=(function(){var s=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,d){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=o.match(s))&&C9(m,c,d),(m=o.match(n))&&S9(m,c,u,d),(m=o.match(a))&&_9(m,c,u,d),(m=o.match(i))&&w9(m,c,u,d),(m=o.match(r))&&k9(m,c,d),c}})();function qB(t,s){var r=[Za,xs("styleSheet",null,{xmlns:wA[0],"xmlns:vt":pn.vt})],a;return t.SSF&&(a=B9(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=E9(s.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function T9(t,s){var r=t.read_shift(2),a=gi(t);return[r,a]}function I9(t,s,r){r||(r=Jt(6+4*s.length)),r.write_shift(2,t),En(s,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function L9(t,s,r){var a={};a.sz=t.read_shift(2)/20;var n=f7(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=t.read_shift(2);switch(i===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(a.underline=l);var o=t.read_shift(1);o>0&&(a.family=o);var u=t.read_shift(1);switch(u>0&&(a.charset=u),t.l++,a.color=m7(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=gi(t),a}function D9(t,s){s||(s=Jt(153)),s.write_shift(2,t.sz*20),p7(t,s),s.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),s.write_shift(2,r),s.write_shift(1,t.underline||0),s.write_shift(1,t.family||0),s.write_shift(1,t.charset||0),s.write_shift(1,0),h0(t.color,s);var a=0;return a=2,s.write_shift(1,a),En(t.name,s),s.length>s.l?s.slice(0,s.l):s}var P9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],tb,U9=vi;function C_(t,s){s||(s=Jt(84)),tb||(tb=ag(P9));var r=tb[t.patternType];r==null&&(r=40),s.write_shift(4,r);var a=0;if(r!=40)for(h0({auto:1},s),h0({auto:1},s);a<12;++a)s.write_shift(4,0);else{for(;a<4;++a)s.write_shift(4,0);for(;a<12;++a)s.write_shift(4,0)}return s.length>s.l?s.slice(0,s.l):s}function R9(t,s){var r=t.l+s,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function VB(t,s,r){r||(r=Jt(16)),r.write_shift(2,s||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function bm(t,s){return s||(s=Jt(10)),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(4,0),s}var O9=vi;function Q9(t,s){return s||(s=Jt(51)),s.write_shift(1,0),bm(null,s),bm(null,s),bm(null,s),bm(null,s),bm(null,s),s.length>s.l?s.slice(0,s.l):s}function M9(t,s){return s||(s=Jt(52)),s.write_shift(4,t.xfId),s.write_shift(2,1),s.write_shift(1,0),s.write_shift(1,0),A0(t.name||"",s),s.length>s.l?s.slice(0,s.l):s}function H9(t,s,r){var a=Jt(2052);return a.write_shift(4,t),A0(s,a),A0(r,a),a.length>a.l?a.slice(0,a.l):a}function q9(t,s,r){var a={};a.NumberFmt=[];for(var n in Ws)a.NumberFmt[n]=Ws[n];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return id(t,function(u,d,c){switch(c){case 44:a.NumberFmt[u[0]]=u[1],Jc(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&s&&s.themeElements&&s.themeElements.clrScheme&&(u.color.rgb=p0(s.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(c),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(c);else if(d.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function V9(t,s){if(s){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)s[n]!=null&&++r}),r!=0&&(is(t,615,ko(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)s[n]!=null&&is(t,44,I9(n,s[n]))}),is(t,616))}}function $9(t){var s=1;is(t,611,ko(s)),is(t,43,D9({sz:12,color:{theme:1},name:"Calibri",family:2})),is(t,612)}function W9(t){var s=2;is(t,603,ko(s)),is(t,45,C_({patternType:"none"})),is(t,45,C_({patternType:"gray125"})),is(t,604)}function G9(t){var s=1;is(t,613,ko(s)),is(t,46,Q9()),is(t,614)}function K9(t){var s=1;is(t,626,ko(s)),is(t,47,VB({numFmtId:0},65535)),is(t,627)}function z9(t,s){is(t,617,ko(s.length)),s.forEach(function(r){is(t,47,VB(r,0))}),is(t,618)}function Y9(t){var s=1;is(t,619,ko(s)),is(t,48,M9({xfId:0,name:"Normal"})),is(t,620)}function X9(t){var s=0;is(t,505,ko(s)),is(t,506)}function J9(t){var s=0;is(t,508,H9(s,"TableStyleMedium9","PivotStyleMedium4")),is(t,509)}function Z9(t,s){var r=sl();return is(r,278),V9(r,t.SSF),$9(r),W9(r),G9(r),K9(r),z9(r,s.cellXfs),Y9(r),X9(r),J9(r),is(r,279),r.end()}var eq=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function tq(t,s,r){s.themeElements.clrScheme=[];var a={};(t[0].match(bi)||[]).forEach(function(n){var i=Js(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(s.themeElements.clrScheme[eq.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function sq(){}function rq(){}var aq=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nq=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iq=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function lq(t,s,r){s.themeElements={};var a;[["clrScheme",aq,tq],["fontScheme",nq,sq],["fmtScheme",iq,rq]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,s,r)})}var oq=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function $B(t,s){(!t||t.length===0)&&(t=L1());var r,a={};if(!(r=t.match(oq)))throw new Error("themeElements not found in theme");return lq(r[0],a,s),a.raw=t,a}function L1(t,s){if(s&&s.themeXLSX)return s.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Za];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function cq(t,s,r){var a=t.l+s,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var i=t.slice(t.l);t.l=a;var l;try{l=U4(i,{type:"array"})}catch{return}var o=vl(l,"theme/theme/theme1.xml",!0);if(o)return $B(o,r)}}function dq(t){return t.read_shift(4)}function uq(t){var s={};switch(s.xclrType=t.read_shift(2),s.nTintShade=t.read_shift(2),s.xclrType){case 0:t.l+=4;break;case 1:s.xclrValue=Aq(t,4);break;case 2:s.xclrValue=wB(t);break;case 3:s.xclrValue=dq(t);break;case 4:t.l+=4;break}return t.l+=8,s}function Aq(t,s){return vi(t,s)}function hq(t,s){return vi(t,s)}function mq(t){var s=t.read_shift(2),r=t.read_shift(2)-4,a=[s];switch(s){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=uq(t);break;case 6:a[1]=hq(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+s+" "+r)}return a}function fq(t,s){var r=t.l+s;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),i=[];n-- >0;)i.push(mq(t,r-t.l));return{ixfe:a,ext:i}}function pq(t,s){s.forEach(function(r){r[0]})}function xq(t,s){return{flags:t.read_shift(4),version:t.read_shift(4),name:gi(t)}}function gq(t){var s=Jt(12+2*t.name.length);return s.write_shift(4,t.flags),s.write_shift(4,t.version),En(t.name,s),s.slice(0,s.l)}function vq(t){for(var s=[],r=t.read_shift(4);r-- >0;)s.push([t.read_shift(4),t.read_shift(4)]);return s}function bq(t){var s=Jt(4+8*t.length);s.write_shift(4,t.length);for(var r=0;r<t.length;++r)s.write_shift(4,t[r][0]),s.write_shift(4,t[r][1]);return s}function yq(t,s){var r=Jt(8+2*s.length);return r.write_shift(4,t),En(s,r),r.slice(0,r.l)}function jq(t){return t.l+=4,t.read_shift(4)!=0}function Nq(t,s){var r=Jt(8);return r.write_shift(4,t),r.write_shift(4,1),r}function wq(t,s,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return id(t,function(u,d,c){switch(c){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(m){o==1?a.Cell.push({type:a.Types[m[0]-1].name,index:m[1]}):o==0&&a.Value.push({type:a.Types[m[0]-1].name,index:m[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:i.push(c),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),a}function _q(){var t=sl();return is(t,332),is(t,334,ko(1)),is(t,335,gq({name:"XLDAPR",version:12e4,flags:3496657072})),is(t,336),is(t,339,yq(1,"XLDAPR")),is(t,52),is(t,35,ko(514)),is(t,4096,ko(0)),is(t,4097,$l(1)),is(t,36),is(t,53),is(t,340),is(t,337,Nq(1)),is(t,51,bq([[1,0]])),is(t,338),is(t,333),t.end()}function Sq(t,s,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,i=2,l;return t.replace(bi,function(o){var u=Js(o);switch(hc(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==u.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):i==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+u.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),a}function WB(){var t=[Za];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Cq(t){var s=[];if(!t)return s;var r=1;return(t.match(bi)||[]).forEach(function(a){var n=Js(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,s.push(n);break}}),s}function Bq(t){var s={};s.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),s.r=Ys(r);var a=t.read_shift(1);return a&2&&(s.l="1"),a&8&&(s.a="1"),s}function kq(t,s,r){var a=[];return id(t,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function Eq(t,s,r,a){if(!t)return t;var n=a||{},i=!1;id(t,function(o,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function Fq(t,s){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return s["!id"][r].Target}var gh=1024;function GB(t,s){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[xs("xml",null,{"xmlns:v":pl.v,"xmlns:o":pl.o,"xmlns:x":pl.x,"xmlns:mv":pl.mv}).replace(/\/>/,">"),xs("o:shapelayout",xs("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),xs("v:shapetype",[xs("v:stroke",null,{joinstyle:"miter"}),xs("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];gh<t*1e3;)gh+=1e3;return s.forEach(function(i){var l=Sa(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?xs("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=xs("v:fill",u,o),c={on:"t",obscured:"t"};++gh,n=n.concat(["<v:shape"+xf({id:"_x0000_s"+gh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,xs("v:shadow",null,c),xs("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Vn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Vn("x:AutoFill","False"),Vn("x:Row",String(l.r)),Vn("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function B_(t,s,r,a){var n=Array.isArray(t),i;s.forEach(function(l){var o=Sa(l.ref);if(n?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[l.ref],!i){i={t:"z"},n?t[o.r][o.c]=i:t[l.ref]=i;var u=Cr(t["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var d=ir(u);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var c={a:l.author,t:l.t,r:l.r,T:r};l.h&&(c.h=l.h);for(var m=i.c.length-1;m>=0;--m){if(!r&&i.c[m].T)return;r&&!i.c[m].T&&i.c.splice(m,1)}if(r&&a){for(m=0;m<a.length;++m)if(c.a==a[m].id){c.a=a[m].name||c.a;break}}i.c.push(c)})}function Tq(t,s){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=Js(o[0]),d={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},c=Sa(u.ref);if(!(s.sheetRows&&s.sheetRows<=c.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!m&&!!m[1]&&F1(m[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),s.cellHTML&&(d.h=h.h),a.push(d)}}}}),a}function KB(t){var s=[Za,xs("comments",null,{xmlns:wA[0]})],r=[];return s.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var i=Kr(n.a);r.indexOf(i)==-1&&(r.push(i),s.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),s.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),s.push("<author>SheetJ5</author>")),s.push("</authors>"),s.push("<commentList>"),t.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(u){u.a&&(n=r.indexOf(Kr(u.a))),i.push(u.t||"")}),s.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)s.push(Vn("t",Kr(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;s.push(Vn("t",Kr(l)))}s.push("</text></comment>")}),s.push("</commentList>"),s.length>2&&(s[s.length]="</comments>",s[1]=s[1].replace("/>",">")),s.join("")}function Iq(t,s){var r=[],a=!1,n={},i=0;return t.replace(bi,function(o,u){var d=Js(o);switch(hc(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=u+o.length;break;case"</text>":n.t=t.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function Lq(t,s,r){var a=[Za,xs("ThreadedComments",null,{xmlns:pn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&s.indexOf(l.a)==-1&&s.push(l.a);var u={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=u.id:u.parentId=i,l.ID=u.id,l.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+s.indexOf(l.a)).slice(-12)+"}"),a.push(xs("threadedComment",Vn("text",l.t||""),u))})}),a.push("</ThreadedComments>"),a.join("")}function Dq(t,s){var r=[],a=!1;return t.replace(bi,function(i){var l=Js(i);switch(hc(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function Pq(t){var s=[Za,xs("personList",null,{xmlns:pn.TCMNT,"xmlns:x":wA[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){s.push(xs("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),s.push("</personList>"),s.join("")}function Uq(t){var s={};s.iauthor=t.read_shift(4);var r=BA(t);return s.rfx=r.s,s.ref=Ys(r.s),t.l+=16,s}function Rq(t,s){return s==null&&(s=Jt(36)),s.write_shift(4,t[1].iauthor),Gh(t[0],s),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s}var Oq=gi;function Qq(t){return En(t.slice(0,54))}function Mq(t,s){var r=[],a=[],n={},i=!1;return id(t,function(o,u,d){switch(d){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,s.sheetRows&&n.rfx&&s.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function Hq(t){var s=sl(),r=[];return is(s,628),is(s,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),is(s,632,Qq(n.a)))})}),is(s,631),is(s,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:Sa(a[0]),e:Sa(a[0])};is(s,635,Rq([i,n])),n.t&&n.t.length>0&&is(s,637,d7(n)),is(s,636),delete n.iauthor})}),is(s,634),is(s,629),s.end()}var qq="application/vnd.ms-office.vbaProject";function Vq(t){var s=Qs.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qs.utils.cfb_add(s,n,t.FileIndex[a].content)}}),Qs.write(s)}function $q(t,s){s.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Qs.utils.cfb_add(t,n,s.FileIndex[a].content)}})}var zB=["xlsb","xlsm","xlam","biff8","xla"];function Wq(){return{"!type":"dialog"}}function Gq(){return{"!type":"dialog"}}function Kq(){return{"!type":"macro"}}function zq(){return{"!type":"macro"}}var Ch=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,s={r:0,c:0};function r(a,n,i,l){var o=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,c=l.length>0?parseInt(l,10)|0:0;return o?c+=s.c:--c,u?d+=s.r:--d,n+(o?"":"$")+_a(c)+(u?"":"$")+Xa(d)}return function(n,i){return s=i,n.replace(t,r)}})(),D1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,P1=(function(){return function(s,r){return s.replace(D1,function(a,n,i,l,o,u){var d=j1(l)-(i?0:r.c),c=y1(u)-(o?0:r.r),m=c==0?"":o?c+1:"["+c+"]",h=d==0?"":i?d+1:"["+d+"]";return n+"R"+m+"C"+h})}})();function YB(t,s){return t.replace(D1,function(r,a,n,i,l,o){return a+(n=="$"?n+i:_a(j1(i)+s.c))+(l=="$"?l+o:Xa(y1(o)+s.r))})}function Yq(t,s,r){var a=rl(s),n=a.s,i=Sa(r),l={r:i.r-n.r,c:i.c-n.c};return YB(t,l)}function Xq(t){return t.length!=1}function k_(t){return t.replace(/_xlfn\./g,"")}function rn(t){t.l+=1}function fu(t,s){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function XB(t,s,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return JB(t);r.biff==12&&(a=4)}var n=t.read_shift(a),i=t.read_shift(a),l=fu(t),o=fu(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function JB(t){var s=fu(t),r=fu(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:s[0],c:a,cRel:s[1],rRel:s[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function Jq(t,s,r){if(r.biff<8)return JB(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),i=fu(t),l=fu(t);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function ZB(t,s,r){if(r&&r.biff>=2&&r.biff<=5)return Zq(t);var a=t.read_shift(r&&r.biff==12?4:2),n=fu(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Zq(t){var s=fu(t),r=t.read_shift(1);return{r:s[0],c:r,cRel:s[1],rRel:s[2]}}function eV(t){var s=t.read_shift(2),r=t.read_shift(2);return{r:s,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function tV(t,s,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return sV(t);var n=t.read_shift(a>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function sV(t){var s=t.read_shift(2),r=t.read_shift(1),a=(s&32768)>>15,n=(s&16384)>>14;return s&=16383,a==1&&s>=8192&&(s=s-16384),n==1&&r>=128&&(r=r-256),{r:s,c:r,cRel:n,rRel:a}}function rV(t,s,r){var a=(t[t.l++]&96)>>5,n=XB(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function aV(t,s,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=XB(t,i,r);return[a,n,l]}function nV(t,s,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function iV(t,s,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[a,n]}function lV(t,s,r){var a=(t[t.l++]&96)>>5,n=Jq(t,s-1,r);return[a,n]}function oV(t,s,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function E_(t){var s=t[t.l+1]&1,r=1;return t.l+=4,[s,r]}function cV(t,s,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function dV(t,s,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function uV(t,s,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function AV(t){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(2)]}function hV(t,s,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function ek(t){var s=t.read_shift(1),r=t.read_shift(1);return[s,r]}function mV(t){return t.read_shift(2),ek(t)}function fV(t){return t.read_shift(2),ek(t)}function pV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=ZB(t,0,r);return[a,n]}function xV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=tV(t,0,r);return[a,n]}function gV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=ZB(t,0,r);return[a,n,i]}function vV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[j$[n],rk[n],a]}function bV(t,s,r){var a=t[t.l++],n=t.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:yV(t);return[n,(i[0]===0?rk:y$)[i[1]]]}function yV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function jV(t,s,r){t.l+=r&&r.biff==2?3:4}function NV(t,s,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function wV(t){return t.l++,ld[t.read_shift(1)]}function _V(t){return t.l++,t.read_shift(2)}function SV(t){return t.l++,t.read_shift(1)!==0}function CV(t){return t.l++,xi(t)}function BV(t,s,r){return t.l++,Of(t,s-1,r)}function kV(t,s){var r=[t.read_shift(1)];if(s==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wa(t,1)?"TRUE":"FALSE",s!=12&&(t.l+=7);break;case 37:case 16:r[1]=ld[t[t.l]],t.l+=s==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=xi(t);break;case 2:r[1]=kA(t,0,{biff:s>0&&s<8?2:s});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function EV(t,s,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?BA:lg)(t));return n}function FV(t,s,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=kV(t,r.biff);return l}function TV(t,s,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,i]}function IV(t,s,r){if(r.biff==5)return LV(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),i=t.read_shift(4);return[a,n,i]}function LV(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[s,r,a]}function DV(t,s,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function PV(t,s,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function UV(t,s,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function RV(t,s,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[a,n]}var OV=vi,QV=vi,MV=vi;function Mf(t,s,r){return t.l+=2,[eV(t)]}function U1(t){return t.l+=6,[]}var HV=Mf,qV=U1,VV=U1,$V=Mf;function tk(t){return t.l+=2,[nn(t),t.read_shift(2)&1]}var WV=Mf,GV=tk,KV=U1,zV=Mf,YV=Mf,XV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function JV(t){t.l+=2;var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),i=t.read_shift(2),l=XV[r>>2&31];return{ixti:s,coltype:r&3,rt:l,idx:a,c:n,C:i}}function ZV(t){return t.l+=2,[t.read_shift(4)]}function e$(t,s,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function t$(t,s,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function s$(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[s,r]}function r$(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[s,r]}function a$(t){return t.l+=4,[0,0]}var F_={1:{n:"PtgExp",f:NV},2:{n:"PtgTbl",f:MV},3:{n:"PtgAdd",f:rn},4:{n:"PtgSub",f:rn},5:{n:"PtgMul",f:rn},6:{n:"PtgDiv",f:rn},7:{n:"PtgPower",f:rn},8:{n:"PtgConcat",f:rn},9:{n:"PtgLt",f:rn},10:{n:"PtgLe",f:rn},11:{n:"PtgEq",f:rn},12:{n:"PtgGe",f:rn},13:{n:"PtgGt",f:rn},14:{n:"PtgNe",f:rn},15:{n:"PtgIsect",f:rn},16:{n:"PtgUnion",f:rn},17:{n:"PtgRange",f:rn},18:{n:"PtgUplus",f:rn},19:{n:"PtgUminus",f:rn},20:{n:"PtgPercent",f:rn},21:{n:"PtgParen",f:rn},22:{n:"PtgMissArg",f:rn},23:{n:"PtgStr",f:BV},26:{n:"PtgSheet",f:e$},27:{n:"PtgEndSheet",f:t$},28:{n:"PtgErr",f:wV},29:{n:"PtgBool",f:SV},30:{n:"PtgInt",f:_V},31:{n:"PtgNum",f:CV},32:{n:"PtgArray",f:oV},33:{n:"PtgFunc",f:vV},34:{n:"PtgFuncVar",f:bV},35:{n:"PtgName",f:TV},36:{n:"PtgRef",f:pV},37:{n:"PtgArea",f:rV},38:{n:"PtgMemArea",f:DV},39:{n:"PtgMemErr",f:OV},40:{n:"PtgMemNoMem",f:QV},41:{n:"PtgMemFunc",f:PV},42:{n:"PtgRefErr",f:UV},43:{n:"PtgAreaErr",f:nV},44:{n:"PtgRefN",f:xV},45:{n:"PtgAreaN",f:lV},46:{n:"PtgMemAreaN",f:s$},47:{n:"PtgMemNoMemN",f:r$},57:{n:"PtgNameX",f:IV},58:{n:"PtgRef3d",f:gV},59:{n:"PtgArea3d",f:aV},60:{n:"PtgRefErr3d",f:RV},61:{n:"PtgAreaErr3d",f:iV},255:{}},n$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},i$={1:{n:"PtgElfLel",f:tk},2:{n:"PtgElfRw",f:zV},3:{n:"PtgElfCol",f:HV},6:{n:"PtgElfRwV",f:YV},7:{n:"PtgElfColV",f:$V},10:{n:"PtgElfRadical",f:WV},11:{n:"PtgElfRadicalS",f:KV},13:{n:"PtgElfColS",f:qV},15:{n:"PtgElfColSV",f:VV},16:{n:"PtgElfRadicalLel",f:GV},25:{n:"PtgList",f:JV},29:{n:"PtgSxName",f:ZV},255:{}},l$={0:{n:"PtgAttrNoop",f:a$},1:{n:"PtgAttrSemi",f:hV},2:{n:"PtgAttrIf",f:uV},4:{n:"PtgAttrChoose",f:cV},8:{n:"PtgAttrGoto",f:dV},16:{n:"PtgAttrSum",f:jV},32:{n:"PtgAttrBaxcel",f:E_},33:{n:"PtgAttrBaxcel",f:E_},64:{n:"PtgAttrSpace",f:mV},65:{n:"PtgAttrSpaceSemi",f:fV},128:{n:"PtgAttrIfError",f:AV},255:{}};function Hf(t,s,r,a){if(a.biff<8)return vi(t,s);for(var n=t.l+s,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=FV(t,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=EV(t,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=t.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return s=n-t.l,s!==0&&i.push(vi(t,s)),i}function qf(t,s,r){for(var a=t.l+s,n,i,l=[];a!=t.l;)s=a-t.l,i=t[t.l],n=F_[i]||F_[n$[i]],(i===24||i===25)&&(n=(i===24?i$:l$)[t[t.l+1]]),!n||!n.f?vi(t,s):l.push([n.n,n.f(t,s,r)]);return l}function o$(t){for(var s=[],r=0;r<t.length;++r){for(var a=t[r],n=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}s.push(n.join(","))}return s.join(";")}var c$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function d$(t,s){if(!t&&!(s&&s.biff<=5&&s.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function sk(t,s,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[s]))return t.SheetNames[s];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[s];if(r.biff<8)return s>1e4&&(s-=65536),s<0&&(s=-s),s==0?"":t.XTI[s-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function T_(t,s,r){var a=sk(t,s,r);return a=="#REF"?a:d$(a,r)}function hi(t,s,r,a,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],u,d,c,m=0,h=0,f,x="";if(!t[0]||!t[0][0])return"";for(var g=-1,b="",y=0,N=t[0].length;y<N;++y){var j=t[0][y];switch(j[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),d=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:b=Ua(" ",t[0][g][1][1]);break;case 1:b=Ua("\r",t[0][g][1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}d=d+b,g=-1}o.push(d+c$[j[0]]+u);break;case"PtgIsect":u=o.pop(),d=o.pop(),o.push(d+" "+u);break;case"PtgUnion":u=o.pop(),d=o.pop(),o.push(d+","+u);break;case"PtgRange":u=o.pop(),d=o.pop(),o.push(d+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Km(j[1][1],l,n),o.push(zm(c,i));break;case"PtgRefN":c=r?Km(j[1][1],r,n):j[1][1],o.push(zm(c,i));break;case"PtgRef3d":m=j[1][1],c=Km(j[1][2],l,n),x=T_(a,m,n),o.push(x+"!"+zm(c,i));break;case"PtgFunc":case"PtgFuncVar":var S=j[1][0],k=j[1][1];S||(S=0),S&=127;var P=S==0?[]:o.slice(-S);o.length-=S,k==="User"&&(k=P.shift()),o.push(k+"("+P.join(",")+")");break;case"PtgBool":o.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(j[1]);break;case"PtgNum":o.push(String(j[1]));break;case"PtgStr":o.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(j[1]);break;case"PtgAreaN":f=l_(j[1][1],r?{s:r}:l,n),o.push(Xv(f,n));break;case"PtgArea":f=l_(j[1][1],l,n),o.push(Xv(f,n));break;case"PtgArea3d":m=j[1][1],f=j[1][2],x=T_(a,m,n),o.push(x+"!"+Xv(f,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=j[1][2];var I=(a.names||[])[h-1]||(a[0]||[])[h],B=I?I.Name:"SH33TJSNAME"+String(h);B&&B.slice(0,6)=="_xlfn."&&!n.xlfn&&(B=B.slice(6)),o.push(B);break;case"PtgNameX":var q=j[1][1];h=j[1][2];var Q;if(n.biff<=5)q<0&&(q=-q),a[q]&&(Q=a[q][h]);else{var O="";if(((a[q]||[])[0]||[])[0]==14849||(((a[q]||[])[0]||[])[0]==1025?a[q][h]&&a[q][h].itab>0&&(O=a.SheetNames[a[q][h].itab-1]+"!"):O=a.SheetNames[h-1]+"!"),a[q]&&a[q][h])O+=a[q][h].Name;else if(a[0]&&a[0][h])O+=a[0][h].Name;else{var T=(sk(a,q,n)||"").split(";;");T[h-1]?O=T[h-1]:O+="SH33TJSERRX"}o.push(O);break}Q||(Q={Name:"SH33TJSERRY"}),o.push(Q.Name);break;case"PtgParen":var V="(",D=")";if(g>=0){switch(b="",t[0][g][1][0]){case 2:V=Ua(" ",t[0][g][1][1])+V;break;case 3:V=Ua("\r",t[0][g][1][1])+V;break;case 4:D=Ua(" ",t[0][g][1][1])+D;break;case 5:D=Ua("\r",t[0][g][1][1])+D;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(V+o.pop()+D);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:j[1][1],r:j[1][0]};var Y={c:r.c,r:r.r};if(a.sharedf[Ys(c)]){var M=a.sharedf[Ys(c)];o.push(hi(M,l,Y,a,n))}else{var X=!1;for(u=0;u!=a.arrayf.length;++u)if(d=a.arrayf[u],!(c.c<d[0].s.c||c.c>d[0].e.c)&&!(c.r<d[0].s.r||c.r>d[0].e.r)){o.push(hi(d[1],l,Y,a,n)),X=!0;break}X||o.push(j[1])}break;case"PtgArray":o.push("{"+o$(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var R=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&g>=0&&R.indexOf(t[0][y][0])==-1){j=t[0][g];var H=!0;switch(j[1][0]){case 4:H=!1;case 0:b=Ua(" ",j[1][1]);break;case 5:H=!1;case 1:b=Ua("\r",j[1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}o.push((H?b:"")+o.pop()+(H?"":b)),g=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function u$(t,s,r){var a=t.l+s,n=r.biff==2?1:2,i,l=t.read_shift(n);if(l==65535)return[[],vi(t,s-2)];var o=qf(t,l,r);return s!==l+n&&(i=Hf(t,s-l-n,o,r)),t.l=a,[o,i]}function A$(t,s,r){var a=t.l+s,n=r.biff==2?1:2,i,l=t.read_shift(n);if(l==65535)return[[],vi(t,s-2)];var o=qf(t,l,r);return s!==l+n&&(i=Hf(t,s-l-n,o,r)),t.l=a,[o,i]}function h$(t,s,r,a){var n=t.l+s,i=qf(t,a,r),l;return n!==t.l&&(l=Hf(t,n-t.l,i,r)),[i,l]}function m$(t,s,r){var a=t.l+s,n,i=t.read_shift(2),l=qf(t,i,r);return i==65535?[[],vi(t,s-2)]:(s!==i+2&&(n=Hf(t,a-i-2,l,r)),[l,n])}function f$(t){var s;if(Gc(t,t.l+6)!==65535)return[xi(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return s=t[t.l+2]===1,t.l+=8,[s,"b"];case 2:return s=t[t.l+2],t.l+=8,[s,"e"];case 3:return t.l+=8,["","s"]}return[]}function p$(t){if(t==null){var s=Jt(8);return s.write_shift(1,3),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,65535),s}else if(typeof t=="number")return vA(t);return vA(0)}function sb(t,s,r){var a=t.l+s,n=mc(t);r.biff==2&&++t.l;var i=f$(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=A$(t,a-t.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function x$(t,s,r,a,n){var i=yA(s,r,n),l=p$(t.v),o=Jt(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var d=Jt(t.bf.length),c=0;c<t.bf.length;++c)d[c]=t.bf[c];var m=kn([i,l,o,d]);return m}function og(t,s,r){var a=t.read_shift(4),n=qf(t,a,r),i=t.read_shift(4),l=i>0?Hf(t,i,n,r):null;return[n,l]}var g$=og,cg=og,v$=og,b$=og,y$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},j$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function I_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(s,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function N$(t){var s="of:="+t.replace(D1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return s.replace(/;/g,"|").replace(/,/g,";")}function rb(t){var s=t.split(":"),r=s[0].split(".")[0];return[r,s[0].split(".")[1]+(s.length>1?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}function w$(t){return t.replace(/\./,"!")}var Xm={},Bh={},Jm=typeof Map<"u";function R1(t,s,r){var a=0,n=t.length;if(r){if(Jm?r.has(s):Object.prototype.hasOwnProperty.call(r,s)){for(var i=Jm?r.get(s):r[s];a<i.length;++a)if(t[i[a]].t===s)return t.Count++,i[a]}}else for(;a<n;++a)if(t[a].t===s)return t.Count++,a;return t[n]={t:s},t.Count++,t.Unique++,r&&(Jm?(r.has(s)||r.set(s,[]),r.get(s).push(n)):(Object.prototype.hasOwnProperty.call(r,s)||(r[s]=[]),r[s].push(n))),n}function dg(t,s){var r={min:t+1,max:t+1},a=-1;return s.MDW&&(mi=s.MDW),s.width!=null?r.customWidth=1:s.wpx!=null?a=jf(s.wpx):s.wch!=null&&(a=s.wch),a>-1?(r.width=x0(a),r.customWidth=1):s.width!=null&&(r.width=s.width),s.hidden&&(r.hidden=!0),s.level!=null&&(r.outlineLevel=r.level=s.level),r}function mA(t,s){if(t){var r=[.7,.7,.75,.75,.3,.3];s=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ju(t,s,r){var a=r.revssf[s.z!=null?s.z:"General"],n=60,i=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Jc(s.z,n),r.ssf[n]=s.z,r.revssf[s.z]=a=n;break}}for(n=0;n!=i;++n)if(t[n].numFmtId===a)return n;return t[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function ak(t,s,r,a,n,i){try{a.cellNF&&(t.z=Ws[s])}catch(o){if(a.WTF)throw o}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Aa(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(Ws[s]==null&&Jc(yQ[s]||"General",s),t.t==="e")t.w=t.w||ld[t.v];else if(s===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ff(t.v);else if(t.t==="d"){var l=xn(t.v);(l|0)===l?t.w=l.toString(10):t.w=ff(l)}else{if(t.v===void 0)return"";t.w=xA(t.v,Bh)}else t.t==="d"?t.w=Xl(s,xn(t.v),Bh):t.w=Xl(s,t.v,Bh)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=p0(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=p0(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function _$(t,s,r){if(t&&t["!ref"]){var a=Cr(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function S$(t,s){var r=Cr(s);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ir(r))}var C$=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,B$=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,k$=/<(?:\w:)?hyperlink [^>]*>/mg,E$=/"(\w*:\w*)"/,F$=/<(?:\w:)?col\b[^>]*[\/]?>/g,T$=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,I$=/<(?:\w:)?pageMargins[^>]*\/>/g,nk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,L$=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,D$=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function P$(t,s,r,a,n,i,l){if(!t)return t;a||(a={"!id":{}});var o=s.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",c="",m=t.match(B$);m?(d=t.slice(0,m.index),c=t.slice(m.index+m[0].length)):d=c=t;var h=d.match(nk);h?O1(h[0],o,n,r):(h=d.match(L$))&&R$(h[0],h[1]||"",o,n,r);var f=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var x=d.slice(f,f+50).match(E$);x&&S$(o,x[1])}var g=d.match(D$);g&&g[1]&&X$(g[1],n);var b=[];if(s.cellStyles){var y=d.match(F$);y&&W$(b,y)}m&&eW(m[1],o,s,u,i,l);var N=c.match(T$);N&&(o["!autofilter"]=K$(N[0]));var j=[],S=c.match(C$);if(S)for(f=0;f!=S.length;++f)j[f]=Cr(S[f].slice(S[f].indexOf('"')+1));var k=c.match(k$);k&&q$(o,k,a);var P=c.match(I$);if(P&&(o["!margins"]=V$(Js(P[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=ir(u)),s.sheetRows>0&&o["!ref"]){var I=Cr(o["!ref"]);s.sheetRows<=+I.e.r&&(I.e.r=s.sheetRows-1,I.e.r>u.e.r&&(I.e.r=u.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>u.e.c&&(I.e.c=u.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ir(I))}return b.length>0&&(o["!cols"]=b),j.length>0&&(o["!merges"]=j),o}function U$(t){if(t.length===0)return"";for(var s='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)s+='<mergeCell ref="'+ir(t[r])+'"/>';return s+"</mergeCells>"}function O1(t,s,r,a){var n=Js(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Sr(Xr(n.codeName)))}function R$(t,s,r,a,n){O1(t.slice(0,t.indexOf(">")),r,a,n)}function O$(t,s,r,a,n){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&s.vbaraw){var u=s.SheetNames[r];try{s.Workbook&&(u=s.Workbook.Sheets[r].CodeName||u)}catch{}i=!0,l.codeName=lc(Kr(u))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),o=(o||"")+xs("outlinePr",null,d)}!i&&!o||(n[n.length]=xs("sheetPr",o,l))}var Q$=["objects","scenarios","selectLockedCells","selectUnlockedCells"],M$=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function H$(t){var s={sheet:1};return Q$.forEach(function(r){t[r]!=null&&t[r]&&(s[r]="1")}),M$.forEach(function(r){t[r]!=null&&!t[r]&&(s[r]="0")}),t.password&&(s.password=T1(t.password).toString(16).toUpperCase()),xs("sheetProtection",null,s)}function q$(t,s,r){for(var a=Array.isArray(t),n=0;n!=s.length;++n){var i=Js(Xr(s[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Sr(i.location))):(i.Target="#"+Sr(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Cr(i.ref),u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var c=Ys({c:d,r:u});a?(t[u]||(t[u]=[]),t[u][d]||(t[u][d]={t:"z",v:void 0}),t[u][d].l=i):(t[c]||(t[c]={t:"z",v:void 0}),t[c].l=i)}}}function V$(t){var s={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(s[r]=parseFloat(t[r]))}),s}function $$(t){return mA(t),xs("pageMargins",null,t)}function W$(t,s){for(var r=!1,a=0;a!=s.length;++a){var n=Js(s[a],!0);n.hidden&&(n.hidden=da(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,I1(n.width)),mu(n);i<=l;)t[i++]=ha(n)}}function G$(t,s){for(var r=["<cols>"],a,n=0;n!=s.length;++n)(a=s[n])&&(r[r.length]=xs("col",null,dg(n,a)));return r[r.length]="</cols>",r.join("")}function K$(t){var s={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return s}function z$(t,s,r,a){var n=typeof t.ref=="string"?t.ref:ir(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=rl(n);l.s.r==l.e.r&&(l.e.r=rl(s["!ref"]).e.r,n=ir(l));for(var o=0;o<i.length;++o){var u=i[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),xs("autoFilter",null,{ref:n})}var Y$=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function X$(t,s){s.Views||(s.Views=[{}]),(t.match(Y$)||[]).forEach(function(r,a){var n=Js(r);s.Views[a]||(s.Views[a]={}),+n.zoomScale&&(s.Views[a].zoom=+n.zoomScale),da(n.rightToLeft)&&(s.Views[a].RTL=!0)})}function J$(t,s,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),xs("sheetViews",xs("sheetView",null,n),{})}function Z$(t,s,r,a){if(t.c&&r["!comments"].push([s,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",i=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=ld[t.v];break;case"d":a&&a.cellDates?n=Aa(t.v,-1).toISOString():(t=ha(t),t.t="n",n=""+(t.v=xn(Aa(t.v)))),typeof t.z>"u"&&(t.z=Ws[14]);break;default:n=t.v;break}var o=Vn("v",Kr(n)),u={r:s},d=ju(a.cellXfs,t,a);switch(d!==0&&(u.s=d),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Vn("v",""+R1(a.Strings,t.v,a.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=i&&(t.t=i,t.v=l),typeof t.f=="string"&&t.f){var c=t.F&&t.F.slice(0,s.length)==s?{t:"array",ref:t.F}:null;o=xs("f",Kr(t.f),c)+(t.v!=null?o:"")}return t.l&&r["!links"].push([s,t.l]),t.D&&(u.cm=1),xs("c",o,u)}var eW=(function(){var t=/<(?:\w+:)?c[ \/>]/,s=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=pf("v"),l=pf("f");return function(u,d,c,m,h,f){for(var x=0,g="",b=[],y=[],N=0,j=0,S=0,k="",P,I,B=0,q=0,Q,O,T=0,V=0,D=Array.isArray(f.CellXf),Y,M=[],X=[],R=Array.isArray(d),H=[],W={},K=!1,_=!!c.sheetStubs,F=u.split(s),E=0,L=F.length;E!=L;++E){g=F[E].trim();var U=g.length;if(U!==0){var J=0;e:for(x=0;x<U;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(c&&c.cellStyles){if(I=Js(g.slice(J,x),!0),B=I.r!=null?parseInt(I.r,10):B+1,q=-1,c.sheetRows&&c.sheetRows<B)continue;W={},K=!1,I.ht&&(K=!0,W.hpt=parseFloat(I.ht),W.hpx=Ph(W.hpt)),I.hidden=="1"&&(K=!0,W.hidden=!0),I.outlineLevel!=null&&(K=!0,W.level=+I.outlineLevel),K&&(H[B-1]=W)}break;case"<":J=x;break}if(J>=x)break;if(I=Js(g.slice(J,x),!0),B=I.r!=null?parseInt(I.r,10):B+1,q=-1,!(c.sheetRows&&c.sheetRows<B)){m.s.r>B-1&&(m.s.r=B-1),m.e.r<B-1&&(m.e.r=B-1),c&&c.cellStyles&&(W={},K=!1,I.ht&&(K=!0,W.hpt=parseFloat(I.ht),W.hpx=Ph(W.hpt)),I.hidden=="1"&&(K=!0,W.hidden=!0),I.outlineLevel!=null&&(K=!0,W.level=+I.outlineLevel),K&&(H[B-1]=W)),b=g.slice(x).split(t);for(var ae=0;ae!=b.length&&b[ae].trim().charAt(0)=="<";++ae);for(b=b.slice(ae),x=0;x!=b.length;++x)if(g=b[x].trim(),g.length!==0){if(y=g.match(r),N=x,j=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,y!=null&&y.length===2){for(N=0,k=y[1],j=0;j!=k.length&&!((S=k.charCodeAt(j)-64)<1||S>26);++j)N=26*N+S;--N,q=N}else++q;for(j=0;j!=g.length&&g.charCodeAt(j)!==62;++j);if(++j,I=Js(g.slice(0,j),!0),I.r||(I.r=Ys({r:B-1,c:q})),k=g.slice(j),P={t:""},(y=k.match(i))!=null&&y[1]!==""&&(P.v=Sr(y[1])),c.cellFormula){if((y=k.match(l))!=null&&y[1]!==""){if(P.f=Sr(Xr(y[1])).replace(/\r\n/g,`
`),c.xlfn||(P.f=k_(P.f)),y[0].indexOf('t="array"')>-1)P.F=(k.match(n)||[])[1],P.F.indexOf(":")>-1&&M.push([Cr(P.F),P.F]);else if(y[0].indexOf('t="shared"')>-1){O=Js(y[0]);var Z=Sr(Xr(y[1]));c.xlfn||(Z=k_(Z)),X[parseInt(O.si,10)]=[O,Z,I.r]}}else(y=k.match(/<f[^>]*\/>/))&&(O=Js(y[0]),X[O.si]&&(P.f=Yq(X[O.si][1],X[O.si][2],I.r)));var oe=Sa(I.r);for(j=0;j<M.length;++j)oe.r>=M[j][0].s.r&&oe.r<=M[j][0].e.r&&oe.c>=M[j][0].s.c&&oe.c<=M[j][0].e.c&&(P.F=M[j][1])}if(I.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(_)P.t="z";else continue;else P.t=I.t||"n";switch(m.s.c>q&&(m.s.c=q),m.e.c<q&&(m.e.c=q),P.t){case"n":if(P.v==""||P.v==null){if(!_)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!_)continue;P.t="z"}else Q=Xm[parseInt(P.v,10)],P.v=Q.t,P.r=Q.r,c.cellHTML&&(P.h=Q.h);break;case"str":P.t="s",P.v=P.v!=null?Xr(P.v):"",c.cellHTML&&(P.h=x1(P.v));break;case"inlineStr":y=k.match(a),P.t="s",y!=null&&(Q=F1(y[1]))?(P.v=Q.t,c.cellHTML&&(P.h=Q.h)):P.v="";break;case"b":P.v=da(P.v);break;case"d":c.cellDates?P.v=Aa(P.v,1):(P.v=xn(Aa(P.v,1)),P.t="n");break;case"e":(!c||c.cellText!==!1)&&(P.w=P.v),P.v=lB[P.v];break}if(T=V=0,Y=null,D&&I.s!==void 0&&(Y=f.CellXf[I.s],Y!=null&&(Y.numFmtId!=null&&(T=Y.numFmtId),c.cellStyles&&Y.fillId!=null&&(V=Y.fillId))),ak(P,T,V,c,h,f),c.cellDates&&D&&P.t=="n"&&Vh(Ws[T])&&(P.t="d",P.v=ig(P.v)),I.cm&&c.xlmeta){var ee=(c.xlmeta.Cell||[])[+I.cm-1];ee&&ee.type=="XLDAPR"&&(P.D=!0)}if(R){var se=Sa(I.r);d[se.r]||(d[se.r]=[]),d[se.r][se.c]=P}else d[I.r]=P}}}}H.length>0&&(d["!rows"]=H)}})();function tW(t,s,r,a){var n=[],i=[],l=Cr(t["!ref"]),o="",u,d="",c=[],m=0,h=0,f=t["!rows"],x=Array.isArray(t),g={r:d},b,y=-1;for(h=l.s.c;h<=l.e.c;++h)c[h]=_a(h);for(m=l.s.r;m<=l.e.r;++m){for(i=[],d=Xa(m),h=l.s.c;h<=l.e.c;++h){u=c[h]+d;var N=x?(t[m]||[])[h]:t[u];N!==void 0&&(o=Z$(N,u,t,s))!=null&&i.push(o)}(i.length>0||f&&f[m])&&(g={r:d},f&&f[m]&&(b=f[m],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=Nf(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),n[n.length]=xs("row",i.join(""),g))}if(f)for(;m<f.length;++m)f&&f[m]&&(g={r:m+1},b=f[m],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=Nf(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level),n[n.length]=xs("row","",g));return n.join("")}function ik(t,s,r,a){var n=[Za,xs("worksheet",null,{xmlns:wA[0],"xmlns:r":pn.r})],i=r.SheetNames[t],l=0,o="",u=r.Sheets[i];u==null&&(u={});var d=u["!ref"]||"A1",c=Cr(d);if(c.e.c>16383||c.e.r>1048575){if(s.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),d=ir(c)}a||(a={}),u["!comments"]=[];var m=[];O$(u,r,t,s,n),n[n.length]=xs("dimension",null,{ref:d}),n[n.length]=J$(u,s,t,r),s.sheetFormat&&(n[n.length]=xs("sheetFormatPr",null,{defaultRowHeight:s.sheetFormat.defaultRowHeight||"16",baseColWidth:s.sheetFormat.baseColWidth||"10",outlineLevelRow:s.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(n[n.length]=G$(u,u["!cols"])),n[l=n.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=tW(u,s),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),u["!protect"]&&(n[n.length]=H$(u["!protect"])),u["!autofilter"]!=null&&(n[n.length]=z$(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(n[n.length]=U$(u["!merges"]));var h=-1,f,x=-1;return u["!links"].length>0&&(n[n.length]="<hyperlinks>",u["!links"].forEach(function(g){g[1].Target&&(f={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=Wr(a,-1,Kr(g[1].Target).replace(/#.*$/,""),ur.HLINK),f["r:id"]="rId"+x),(h=g[1].Target.indexOf("#"))>-1&&(f.location=Kr(g[1].Target.slice(h+1))),g[1].Tooltip&&(f.tooltip=Kr(g[1].Tooltip)),n[n.length]=xs("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(n[n.length]=$$(u["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&(n[n.length]=Vn("ignoredErrors",xs("ignoredError",null,{numberStoredAsText:1,sqref:d}))),m.length>0&&(x=Wr(a,-1,"../drawings/drawing"+(t+1)+".xml",ur.DRAW),n[n.length]=xs("drawing",null,{"r:id":"rId"+x}),u["!drawing"]=m),u["!comments"].length>0&&(x=Wr(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ur.VML),n[n.length]=xs("legacyDrawing",null,{"r:id":"rId"+x}),u["!legacy"]=x),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function sW(t,s){var r={},a=t.l+s;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function rW(t,s,r){var a=Jt(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var i=320;n.hpx?i=Nf(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,u=a.l;a.l+=4;for(var d={r:t,c:0},c=0;c<16;++c)if(!(s.s.c>c+1<<10||s.e.c<c<<10)){for(var m=-1,h=-1,f=c<<10;f<c+1<<10;++f){d.c=f;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Ys(d)];x&&(m<0&&(m=f),h=f)}m<0||(++o,a.write_shift(4,m),a.write_shift(4,h))}var g=a.l;return a.l=u,a.write_shift(4,o),a.l=g,a.length>a.l?a.slice(0,a.l):a}function aW(t,s,r,a){var n=rW(a,r,s);(n.length>17||(s["!rows"]||[])[a])&&is(t,0,n)}var nW=BA,iW=Gh;function lW(){}function oW(t,s){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=u7(t),r}function cW(t,s,r){r==null&&(r=Jt(84+4*t.length));var a=192;s&&(s.above&&(a&=-65),s.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return h0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),sB(t,r),r.slice(0,r.l)}function dW(t){var s=Jl(t);return[s]}function uW(t,s,r){return r==null&&(r=Jt(8)),_A(s,r)}function AW(t){var s=SA(t);return[s]}function hW(t,s,r){return r==null&&(r=Jt(4)),CA(s,r)}function mW(t){var s=Jl(t),r=t.read_shift(1);return[s,r,"b"]}function fW(t,s,r){return r==null&&(r=Jt(9)),_A(s,r),r.write_shift(1,t.v?1:0),r}function pW(t){var s=SA(t),r=t.read_shift(1);return[s,r,"b"]}function xW(t,s,r){return r==null&&(r=Jt(5)),CA(s,r),r.write_shift(1,t.v?1:0),r}function gW(t){var s=Jl(t),r=t.read_shift(1);return[s,r,"e"]}function vW(t,s,r){return r==null&&(r=Jt(9)),_A(s,r),r.write_shift(1,t.v),r}function bW(t){var s=SA(t),r=t.read_shift(1);return[s,r,"e"]}function yW(t,s,r){return r==null&&(r=Jt(8)),CA(s,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function jW(t){var s=Jl(t),r=t.read_shift(4);return[s,r,"s"]}function NW(t,s,r){return r==null&&(r=Jt(12)),_A(s,r),r.write_shift(4,s.v),r}function wW(t){var s=SA(t),r=t.read_shift(4);return[s,r,"s"]}function _W(t,s,r){return r==null&&(r=Jt(8)),CA(s,r),r.write_shift(4,s.v),r}function SW(t){var s=Jl(t),r=xi(t);return[s,r,"n"]}function CW(t,s,r){return r==null&&(r=Jt(16)),_A(s,r),vA(t.v,r),r}function lk(t){var s=SA(t),r=xi(t);return[s,r,"n"]}function BW(t,s,r){return r==null&&(r=Jt(12)),CA(s,r),vA(t.v,r),r}function kW(t){var s=Jl(t),r=S1(t);return[s,r,"n"]}function EW(t,s,r){return r==null&&(r=Jt(12)),_A(s,r),rB(t.v,r),r}function FW(t){var s=SA(t),r=S1(t);return[s,r,"n"]}function TW(t,s,r){return r==null&&(r=Jt(8)),CA(s,r),rB(t.v,r),r}function IW(t){var s=Jl(t),r=N1(t);return[s,r,"is"]}function LW(t){var s=Jl(t),r=gi(t);return[s,r,"str"]}function DW(t,s,r){return r==null&&(r=Jt(12+4*t.v.length)),_A(s,r),En(t.v,r),r.length>r.l?r.slice(0,r.l):r}function PW(t){var s=SA(t),r=gi(t);return[s,r,"str"]}function UW(t,s,r){return r==null&&(r=Jt(8+4*t.v.length)),CA(s,r),En(t.v,r),r.length>r.l?r.slice(0,r.l):r}function RW(t,s,r){var a=t.l+s,n=Jl(t);n.r=r["!row"];var i=t.read_shift(1),l=[n,i,"b"];if(r.cellFormula){t.l+=2;var o=cg(t,a-t.l,r);l[3]=hi(o,null,n,r.supbooks,r)}else t.l=a;return l}function OW(t,s,r){var a=t.l+s,n=Jl(t);n.r=r["!row"];var i=t.read_shift(1),l=[n,i,"e"];if(r.cellFormula){t.l+=2;var o=cg(t,a-t.l,r);l[3]=hi(o,null,n,r.supbooks,r)}else t.l=a;return l}function QW(t,s,r){var a=t.l+s,n=Jl(t);n.r=r["!row"];var i=xi(t),l=[n,i,"n"];if(r.cellFormula){t.l+=2;var o=cg(t,a-t.l,r);l[3]=hi(o,null,n,r.supbooks,r)}else t.l=a;return l}function MW(t,s,r){var a=t.l+s,n=Jl(t);n.r=r["!row"];var i=gi(t),l=[n,i,"str"];if(r.cellFormula){t.l+=2;var o=cg(t,a-t.l,r);l[3]=hi(o,null,n,r.supbooks,r)}else t.l=a;return l}var HW=BA,qW=Gh;function VW(t,s){return s==null&&(s=Jt(4)),s.write_shift(4,t),s}function $W(t,s){var r=t.l+s,a=BA(t),n=w1(t),i=gi(t),l=gi(t),o=gi(t);t.l=r;var u={rfx:a,relId:n,loc:i,display:o};return l&&(u.Tooltip=l),u}function WW(t,s){var r=Jt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Gh({s:Sa(t[0]),e:Sa(t[0])},r),_1("rId"+s,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return En(n||"",r),En(t[1].Tooltip||"",r),En("",r),r.slice(0,r.l)}function GW(){}function KW(t,s,r){var a=t.l+s,n=aB(t),i=t.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=g$(t,a-t.l,r);l[1]=o}else t.l=a;return l}function zW(t,s,r){var a=t.l+s,n=BA(t),i=[n];if(r.cellFormula){var l=b$(t,a-t.l,r);i[1]=l,t.l=a}else t.l=a;return i}function YW(t,s,r){r==null&&(r=Jt(18));var a=dg(t,s);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return s.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),s.level&&(n|=s.level<<8),r.write_shift(2,n),r}var ok=["left","right","top","bottom","header","footer"];function XW(t){var s={};return ok.forEach(function(r){s[r]=xi(t)}),s}function JW(t,s){return s==null&&(s=Jt(48)),mA(t),ok.forEach(function(r){vA(t[r],s)}),s}function ZW(t){var s=t.read_shift(2);return t.l+=28,{RTL:s&32}}function eG(t,s,r){r==null&&(r=Jt(30));var a=924;return(((s||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function tG(t){var s=Jt(24);return s.write_shift(4,4),s.write_shift(4,1),Gh(t,s),s}function sG(t,s){return s==null&&(s=Jt(66)),s.write_shift(2,t.password?T1(t.password):0),s.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?s.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):s.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),s}function rG(){}function aG(){}function nG(t,s,r,a,n,i,l){if(!t)return t;var o=s||{};a||(a={"!id":{}});var u=o.dense?[]:{},d,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,h=!1,f,x,g,b,y,N,j,S,k,P=[];o.biff=12,o["!row"]=0;var I=0,B=!1,q=[],Q={},O=o.supbooks||n.supbooks||[[]];if(O.sharedf=Q,O.arrayf=q,O.SheetNames=n.SheetNames||n.Sheets.map(function(R){return R.name}),!o.supbooks&&(o.supbooks=O,n.Names))for(var T=0;T<n.Names.length;++T)O[0][T+1]=n.Names[T];var V=[],D=[],Y=!1;wf[16]={n:"BrtShortReal",f:lk};var M;if(id(t,function(H,W,K){if(!h)switch(K){case 148:d=H;break;case 0:f=H,o.sheetRows&&o.sheetRows<=f.r&&(h=!0),S=Xa(b=f.r),o["!row"]=f.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Ph(H.hpt)),D[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:H[2]},H[2]){case"n":x.v=H[1];break;case"s":j=Xm[H[1]],x.v=j.t,x.r=j.r;break;case"b":x.v=!!H[1];break;case"e":x.v=H[1],o.cellText!==!1&&(x.w=ld[x.v]);break;case"str":x.t="s",x.v=H[1];break;case"is":x.t="s",x.v=H[1].t;break}if((g=l.CellXf[H[0].iStyleRef])&&ak(x,g.numFmtId,null,o,i,l),y=H[0].c==-1?y+1:H[0].c,o.dense?(u[b]||(u[b]=[]),u[b][y]=x):u[_a(y)+S]=x,o.cellFormula){for(B=!1,I=0;I<q.length;++I){var _=q[I];f.r>=_[0].s.r&&f.r<=_[0].e.r&&y>=_[0].s.c&&y<=_[0].e.c&&(x.F=ir(_[0]),B=!0)}!B&&H.length>3&&(x.f=H[3])}if(c.s.r>f.r&&(c.s.r=f.r),c.s.c>y&&(c.s.c=y),c.e.r<f.r&&(c.e.r=f.r),c.e.c<y&&(c.e.c=y),o.cellDates&&g&&x.t=="n"&&Vh(Ws[g.numFmtId])){var F=nA(x.v);F&&(x.t="d",x.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}M&&(M.type=="XLDAPR"&&(x.D=!0),M=void 0);break;case 1:case 12:if(!o.sheetStubs||m)break;x={t:"z",v:void 0},y=H[0].c==-1?y+1:H[0].c,o.dense?(u[b]||(u[b]=[]),u[b][y]=x):u[_a(y)+S]=x,c.s.r>f.r&&(c.s.r=f.r),c.s.c>y&&(c.s.c=y),c.e.r<f.r&&(c.e.r=f.r),c.e.c<y&&(c.e.c=y),M&&(M.type=="XLDAPR"&&(x.D=!0),M=void 0);break;case 176:P.push(H);break;case 49:M=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var E=a["!id"][H.relId];for(E?(H.Target=E.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=E):H.relId==""&&(H.Target="#"+H.loc),b=H.rfx.s.r;b<=H.rfx.e.r;++b)for(y=H.rfx.s.c;y<=H.rfx.e.c;++y)o.dense?(u[b]||(u[b]=[]),u[b][y]||(u[b][y]={t:"z",v:void 0}),u[b][y].l=H):(N=Ys({c:y,r:b}),u[N]||(u[N]={t:"z",v:void 0}),u[N].l=H);break;case 426:if(!o.cellFormula)break;q.push(H),k=o.dense?u[b][y]:u[_a(y)+S],k.f=hi(H[1],c,{r:f.r,c:y},O,o),k.F=ir(H[0]);break;case 427:if(!o.cellFormula)break;Q[Ys(H[0].s)]=H[1],k=o.dense?u[b][y]:u[_a(y)+S],k.f=hi(H[1],c,{r:f.r,c:y},O,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)V[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},Y||(Y=!0,I1(H.w/256)),mu(V[H.e+1]);break;case 161:u["!autofilter"]={ref:ir(H)};break;case 476:u["!margins"]=H;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),H.name&&(n.Sheets[r].CodeName=H.name),(H.above||H.left)&&(u["!outline"]={above:H.above,left:H.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),H.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!W.T){if(!m||o.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(c.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(u["!ref"]=ir(d||c)),o.sheetRows&&u["!ref"]){var X=Cr(u["!ref"]);o.sheetRows<=+X.e.r&&(X.e.r=o.sheetRows-1,X.e.r>c.e.r&&(X.e.r=c.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>c.e.c&&(X.e.c=c.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),u["!fullref"]=u["!ref"],u["!ref"]=ir(X))}return P.length>0&&(u["!merges"]=P),V.length>0&&(u["!cols"]=V),D.length>0&&(u["!rows"]=D),u}function iG(t,s,r,a,n,i,l){if(s.v===void 0)return!1;var o="";switch(s.t){case"b":o=s.v?"1":"0";break;case"d":s=ha(s),s.z=s.z||Ws[14],s.v=xn(Aa(s.v)),s.t="n";break;case"n":case"e":o=""+s.v;break;default:o=s.v;break}var u={r,c:a};switch(u.s=ju(n.cellXfs,s,n),s.l&&i["!links"].push([Ys(u),s.l]),s.c&&i["!comments"].push([Ys(u),s.c]),s.t){case"s":case"str":return n.bookSST?(o=R1(n.Strings,s.v,n.revStrings),u.t="s",u.v=o,l?is(t,18,_W(s,u)):is(t,7,NW(s,u))):(u.t="str",l?is(t,17,UW(s,u)):is(t,6,DW(s,u))),!0;case"n":return s.v==(s.v|0)&&s.v>-1e3&&s.v<1e3?l?is(t,13,TW(s,u)):is(t,2,EW(s,u)):l?is(t,16,BW(s,u)):is(t,5,CW(s,u)),!0;case"b":return u.t="b",l?is(t,15,xW(s,u)):is(t,4,fW(s,u)),!0;case"e":return u.t="e",l?is(t,14,yW(s,u)):is(t,3,vW(s,u)),!0}return l?is(t,12,hW(s,u)):is(t,1,uW(s,u)),!0}function lG(t,s,r,a){var n=Cr(s["!ref"]||"A1"),i,l="",o=[];is(t,145);var u=Array.isArray(s),d=n.e.r;s["!rows"]&&(d=Math.max(n.e.r,s["!rows"].length-1));for(var c=n.s.r;c<=d;++c){l=Xa(c),aW(t,s,n,c);var m=!1;if(c<=n.e.r)for(var h=n.s.c;h<=n.e.c;++h){c===n.s.r&&(o[h]=_a(h)),i=o[h]+l;var f=u?(s[c]||[])[h]:s[i];if(!f){m=!1;continue}m=iG(t,f,c,h,a,s,m)}}is(t,146)}function oG(t,s){!s||!s["!merges"]||(is(t,177,VW(s["!merges"].length)),s["!merges"].forEach(function(r){is(t,176,qW(r))}),is(t,178))}function cG(t,s){!s||!s["!cols"]||(is(t,390),s["!cols"].forEach(function(r,a){r&&is(t,60,YW(a,r))}),is(t,391))}function dG(t,s){!s||!s["!ref"]||(is(t,648),is(t,649,tG(Cr(s["!ref"]))),is(t,650))}function uG(t,s,r){s["!links"].forEach(function(a){if(a[1].Target){var n=Wr(r,-1,a[1].Target.replace(/#.*$/,""),ur.HLINK);is(t,494,WW(a,n))}}),delete s["!links"]}function AG(t,s,r,a){if(s["!comments"].length>0){var n=Wr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",ur.VML);is(t,551,_1("rId"+n)),s["!legacy"]=n}}function hG(t,s,r,a){if(s["!autofilter"]){var n=s["!autofilter"],i=typeof n.ref=="string"?n.ref:ir(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=rl(i);o.s.r==o.e.r&&(o.e.r=rl(s["!ref"]).e.r,i=ir(o));for(var u=0;u<l.length;++u){var d=l[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),is(t,161,Gh(Cr(i))),is(t,162)}}function mG(t,s,r){is(t,133),is(t,137,eG(s,r)),is(t,138),is(t,134)}function fG(t,s){s["!protect"]&&is(t,535,sG(s["!protect"]))}function pG(t,s,r,a){var n=sl(),i=r.SheetNames[t],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var u=Cr(l["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(s.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],is(n,129),(r.vbaraw||l["!outline"])&&is(n,147,cW(o,l["!outline"])),is(n,148,iW(u)),mG(n,l,r.Workbook),cG(n,l),lG(n,l,t,s),fG(n,l),hG(n,l,r,t),oG(n,l),uG(n,l,a),l["!margins"]&&is(n,476,JW(l["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&dG(n,l),AG(n,l,t,a),is(n,130),n.end()}function xG(t){var s=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(s[+l[1]]=r?+l[2]:l[2])});var n=Sr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[s,n,a]}function gG(t,s,r,a,n,i){var l=i||{"!type":"chart"};if(!t)return i;var o=0,u=0,d="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var h=xG(m);c.s.r=c.s.c=0,c.e.c=o,d=_a(o),h[0].forEach(function(f,x){l[d+Xa(x)]={t:"n",v:f,z:h[1]},u=x}),c.e.r<u&&(c.e.r=u),++o}),o>0&&(l["!ref"]=ir(c)),l}function vG(t,s,r,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=t.match(nk);return o&&O1(o[0],i,n,r),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function bG(t,s){t.l+=10;var r=gi(t);return{name:r}}function yG(t,s,r,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return id(t,function(u,d,c){switch(c){case 550:i["!rel"]=u;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),u.name&&(n.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},s),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Q1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],NG=[],wG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function L_(t,s){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=s.length;++n){var i=s[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=da(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function D_(t,s){for(var r=0;r!=s.length;++r){var a=s[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=da(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function ck(t){D_(t.WBProps,Q1),D_(t.CalcPr,wG),L_(t.WBView,jG),L_(t.Sheets,NG),Bh.date1904=da(t.WBProps.date1904)}function _G(t){return!t.Workbook||!t.Workbook.WBProps?"false":da(t.Workbook.WBProps.date1904)?"true":"false"}var SG="][*?/\\".split("");function dk(t,s){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return SG.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function CG(t,s,r){t.forEach(function(a,n){dk(a);for(var i=0;i<n;++i)if(a==t[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=s&&s[n]&&s[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function BG(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var s=t.Workbook&&t.Workbook.Sheets||[];CG(t.SheetNames,s,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)_$(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var kG=/<\w+:workbook/;function EG(t,s){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},l=0;if(t.replace(bi,function(u,d){var c=Js(u);switch(hc(c[0])){case"<?xml":break;case"<workbook":u.match(kG)&&(n="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=c[n];break;case"</workbook>":break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Q1.forEach(function(m){if(c[m[0]]!=null)switch(m[2]){case"bool":r.WBProps[m[0]]=da(c[m[0]]);break;case"int":r.WBProps[m[0]]=parseInt(c[m[0]],10);break;default:r.WBProps[m[0]]=c[m[0]]}}),c.codeName&&(r.WBProps.CodeName=Xr(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Sr(Xr(c.name)),delete c[0],r.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Xr(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),da(c.hidden||"0")&&(i.Hidden=!0),l=d+u.length;break;case"</definedName>":i.Ref=Sr(Xr(t.slice(l,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete c[0],r.CalcPr=c;break;case"<calcPr/>":delete c[0],r.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&s.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return u}),wA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return ck(r),r}function uk(t){var s=[Za];s[s.length]=xs("workbook",null,{xmlns:wA[0],"xmlns:r":pn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Q1.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),s[s.length]=xs("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(s[s.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==t.SheetNames.length&&(i=0),s[s.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',s[s.length]="</bookViews>"}for(s[s.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var l={name:Kr(t.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}s[s.length]=xs("sheet",null,l)}return s[s.length]="</sheets>",r&&(s[s.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(s[s.length]=xs("definedName",Kr(o.Ref),u))}),s[s.length]="</definedNames>"),s.length>2&&(s[s.length]="</workbook>",s[1]=s[1].replace("/>",">")),s.join("")}function FG(t,s){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=by(t),r.name=gi(t),r}function TG(t,s){return s||(s=Jt(127)),s.write_shift(4,t.Hidden),s.write_shift(4,t.iTabID),_1(t.strRelID,s),En(t.name.slice(0,31),s),s.length>s.l?s.slice(0,s.l):s}function IG(t,s){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=s>8?gi(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function LG(t,s){s||(s=Jt(72));var r=0;return t&&t.filterPrivacy&&(r|=8),s.write_shift(4,r),s.write_shift(4,0),sB(t&&t.CodeName||"ThisWorkbook",s),s.slice(0,s.l)}function DG(t,s){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=s-8,r}function PG(t,s,r){var a=t.l+s;t.l+=4,t.l+=1;var n=t.read_shift(4),i=A7(t),l=v$(t,0,r),o=w1(t);t.l=a;var u={Name:i,Ptg:l};return n<268435455&&(u.Sheet=n),o&&(u.Comment=o),u}function UG(t,s){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;s||(s={}),s.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],wf[16]={n:"BrtFRTArchID$",f:DG},id(t,function(u,d,c){switch(c){case 156:l.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(s.SID=u.Sheet),u.Ref=hi(u.Ptg,null,null,l,s),delete s.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([c,u]):l[0]=[c,u],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(u),l.XTI=l.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(c),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(c),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||s.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},s),ck(r),r.Names=i,r.supbooks=l,r}function RG(t,s){is(t,143);for(var r=0;r!=s.SheetNames.length;++r){var a=s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r]&&s.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:s.SheetNames[r]};is(t,156,TG(n))}is(t,144)}function OG(t,s){s||(s=Jt(127));for(var r=0;r!=4;++r)s.write_shift(4,0);return En("SheetJS",s),En(i0.version,s),En(i0.version,s),En("7262",s),s.length>s.l?s.slice(0,s.l):s}function QG(t,s){s||(s=Jt(29)),s.write_shift(-4,0),s.write_shift(-4,460),s.write_shift(4,28800),s.write_shift(4,17600),s.write_shift(4,500),s.write_shift(4,t),s.write_shift(4,t);var r=120;return s.write_shift(1,r),s.length>s.l?s.slice(0,s.l):s}function MG(t,s){if(!(!s.Workbook||!s.Workbook.Sheets)){for(var r=s.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(is(t,135),is(t,158,QG(n)),is(t,136))}}function HG(t,s){var r=sl();return is(r,131),is(r,128,OG()),is(r,153,LG(t.Workbook&&t.Workbook.WBProps||null)),MG(r,t),RG(r,t),is(r,132),r.end()}function qG(t,s,r){return s.slice(-4)===".bin"?UG(t,r):EG(t,r)}function VG(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?nG(t,a,r,n,i,l,o):P$(t,a,r,n,i,l,o)}function $G(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?yG(t,a,r,n,i):vG(t,a,r,n,i)}function WG(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?Kq():zq()}function GG(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?Wq():Gq()}function KG(t,s,r,a){return s.slice(-4)===".bin"?q9(t,r,a):F9(t,r,a)}function zG(t,s,r){return $B(t,r)}function YG(t,s,r){return s.slice(-4)===".bin"?YH(t,r):GH(t,r)}function XG(t,s,r){return s.slice(-4)===".bin"?Mq(t,r):Tq(t,r)}function JG(t,s,r){return s.slice(-4)===".bin"?kq(t):Cq(t)}function ZG(t,s,r,a){return r.slice(-4)===".bin"?Eq(t,s,r,a):void 0}function eK(t,s,r){return s.slice(-4)===".bin"?wq(t,s,r):Sq(t,s,r)}function tK(t,s,r){return(s.slice(-4)===".bin"?HG:uk)(t)}function sK(t,s,r,a,n){return(s.slice(-4)===".bin"?pG:ik)(t,r,a,n)}function rK(t,s,r){return(s.slice(-4)===".bin"?Z9:qB)(t,r)}function aK(t,s,r){return(s.slice(-4)===".bin"?ZH:DB)(t,r)}function nK(t,s,r){return(s.slice(-4)===".bin"?Hq:KB)(t)}function iK(t){return(t.slice(-4)===".bin"?_q:WB)()}var Ak=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,hk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function jo(t,s){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(Ak),i,l,o,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(hk),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function lK(t){var s=t.split(/\s+/),r={};if(s.length===1)return r;var a=t.match(Ak),n,i,l,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(hk),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var Zm;function oK(t,s){var r=Zm[t]||Sr(t);return r==="General"?xA(s):Xl(r,s)}function cK(t,s,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=da(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Aa(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Sr(s)]=n}function dK(t,s,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||ld[t.v]:s==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ff(t.v):t.w=xA(t.v):t.w=oK(s||"General",t.v)}catch(i){if(r.WTF)throw i}try{var a=Zm[s]||s||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&Vh(a)){var n=nA(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function uK(t,s,r){if(r.cellStyles&&s.Interior){var a=s.Interior;a.Pattern&&(a.patternType=N9[a.Pattern]||a.Pattern)}t[s.ID]=s}function AK(t,s,r,a,n,i,l,o,u,d){var c="General",m=a.StyleID,h={};d=d||{};var f=[],x=0;for(m===void 0&&o&&(m=o.StyleID),m===void 0&&l&&(m=l.StyleID);i[m]!==void 0&&(i[m].nf&&(c=i[m].nf),i[m].Interior&&f.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=da(t);break;case"String":a.t="s",a.r=J2(Sr(t)),a.v=t.indexOf("<")>-1?Sr(s||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(Aa(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Sr(t):a.v<60&&(a.v=a.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=lB[t],d.cellText!==!1&&(a.w=t);break;default:t==""&&s==""?a.t="z":(a.t="s",a.v=J2(s||t));break}if(dK(a,c,d),d.cellFormula!==!1)if(a.Formula){var g=Sr(a.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),a.f=Ch(g,n),delete a.Formula,a.ArrayRange=="RC"?a.F=Ch("RC:RC",n):a.ArrayRange&&(a.F=Ch(a.ArrayRange,n),u.push([Cr(a.F),a.F]))}else for(x=0;x<u.length;++x)n.r>=u[x][0].s.r&&n.r<=u[x][0].e.r&&n.c>=u[x][0].s.c&&n.c<=u[x][0].e.c&&(a.F=u[x][1]);d.cellStyles&&(f.forEach(function(b){!h.patternType&&b.patternType&&(h.patternType=b.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function hK(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function ab(t,s){var r=s||{};$h();var a=Lm(g1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Xr(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=ha(r);return l.type="string",Dh.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Qe){n.indexOf("<"+Qe)>=0&&(i=!0)}),i)return JK(a,r);Zm={"General Number":"General","General Date":Ws[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ws[15],"Short Date":Ws[14],"Long Time":Ws[19],"Medium Time":Ws[18],"Short Time":Ws[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ws[2],Standard:Ws[4],Percent:Ws[10],Scientific:Ws[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],d,c={},m=[],h=r.dense?[]:{},f="",x={},g={},b=jo('<Data ss:Type="String">'),y=0,N=0,j=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},P={},I="",B=0,q=[],Q={},O={},T=0,V=[],D=[],Y={},M=[],X,R=!1,H=[],W=[],K={},_=0,F=0,E={Sheets:[],WBProps:{date1904:!1}},L={};gf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var U="";o=gf.exec(a);)switch(o[3]=(U=o[3]).toLowerCase()){case"data":if(U=="data"){if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?AK(a.slice(y,o.index),I,b,u[u.length-1][0]=="comment"?Y:x,{c:N,r:j},k,M[N],g,H,r):(I="",b=jo(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(D.length>0&&(x.c=D),(!r.sheetRows||r.sheetRows>j)&&x.v!==void 0&&(r.dense?(h[j]||(h[j]=[]),h[j][N]=x):h[_a(N)+Xa(j)]=x),x.HRef&&(x.l={Target:Sr(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(_=N+(parseInt(x.MergeAcross,10)|0),F=j+(parseInt(x.MergeDown,10)|0),q.push({s:{c:N,r:j},e:{c:_,r:F}})),!r.sheetStubs)x.MergeAcross?N=_+1:++N;else if(x.MergeAcross||x.MergeDown){for(var J=N;J<=_;++J)for(var ae=j;ae<=F;++ae)(J>N||ae>j)&&(r.dense?(h[ae]||(h[ae]=[]),h[ae][J]={t:"z"}):h[_a(J)+Xa(ae)]={t:"z"});N=_+1}else++N;else x=lK(o[0]),x.Index&&(N=+x.Index-1),N<S.s.c&&(S.s.c=N),N>S.e.c&&(S.e.c=N),o[0].slice(-2)==="/>"&&++N,D=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(j<S.s.r&&(S.s.r=j),j>S.e.r&&(S.e.r=j),o[0].slice(-2)==="/>"&&(g=jo(o[0]),g.Index&&(j=+g.Index-1)),N=0,++j):(g=jo(o[0]),g.Index&&(j=+g.Index-1),K={},(g.AutoFitHeight=="0"||g.Height)&&(K.hpx=parseInt(g.Height,10),K.hpt=Nf(K.hpx),W[j]=K),g.Hidden=="1"&&(K.hidden=!0,W[j]=K));break;case"worksheet":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));m.push(f),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=ir(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=ir(S))),q.length&&(h["!merges"]=q),M.length>0&&(h["!cols"]=M),W.length>0&&(h["!rows"]=W),c[f]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=N=0,u.push([o[3],!1]),d=jo(o[0]),f=Sr(d.Name),h=r.dense?[]:{},q=[],H=[],W=[],L={name:f,Hidden:0},E.Sheets.push(L);break;case"table":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),M=[],R=!1}break;case"style":o[1]==="/"?uK(k,P,r):P=jo(o[0]);break;case"numberformat":P.nf=Sr(jo(o[0]).Format||"General"),Zm[P.nf]&&(P.nf=Zm[P.nf]);for(var Z=0;Z!=392&&Ws[Z]!=P.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(Ws[Z]==null){Jc(P.nf,Z);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(X=jo(o[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!R&&X.wpx>10){R=!0,mi=MB;for(var oe=0;oe<M.length;++oe)M[oe]&&mu(M[oe])}R&&mu(X),M[X.Index-1||M.length]=X;for(var ee=0;ee<+X.Span;++ee)M[M.length]=ha(X);break;case"namedrange":if(o[1]==="/")break;E.Names||(E.Names=[]);var se=Js(o[0]),Ae={Name:se.Name,Ref:Ch(se.RefersTo.slice(1),{r:0,c:0})};E.Sheets.length>0&&(Ae.Sheet=E.Sheets.length-1),E.Names.push(Ae);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?I+=a.slice(B,o.index):B=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=jo(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?U7(Q,U,a.slice(T,o.index)):T=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));hK(Y),D.push(Y)}else u.push([o[3],!1]),d=jo(o[0]),Y={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var we=jo(o[0]);h["!autofilter"]={ref:Ch(we.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return Q_(a,r);var ce=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ce=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ce=!1}break;case"excelworkbook":switch(o[3]){case"date1904":E.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ce=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ce=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(T,o.index)){case"SheetHidden":L.Hidden=1;break;case"SheetVeryHidden":L.Hidden=2;break}else T=o.index+o[0].length;break;case"header":h["!margins"]||mA(h["!margins"]={},"xlml"),isNaN(+Js(o[0]).Margin)||(h["!margins"].header=+Js(o[0]).Margin);break;case"footer":h["!margins"]||mA(h["!margins"]={},"xlml"),isNaN(+Js(o[0]).Margin)||(h["!margins"].footer=+Js(o[0]).Margin);break;case"pagemargins":var le=Js(o[0]);h["!margins"]||mA(h["!margins"]={},"xlml"),isNaN(+le.Top)||(h["!margins"].top=+le.Top),isNaN(+le.Left)||(h["!margins"].left=+le.Left),isNaN(+le.Right)||(h["!margins"].right=+le.Right),isNaN(+le.Bottom)||(h["!margins"].bottom=+le.Bottom);break;case"displayrighttoleft":E.Views||(E.Views=[]),E.Views[0]||(E.Views[0]={}),E.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ce=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ce=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ce=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ce=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ce=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ce=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ce=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ce=!1}break;case"smarttags":break;default:ce=!1;break}if(ce||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?cK(O,U,V,a.slice(T,o.index)):(V=o,T=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var _e={};return!r.bookSheets&&!r.bookProps&&(_e.Sheets=c),_e.SheetNames=m,_e.Workbook=E,_e.SSF=ha(Ws),_e.Props=Q,_e.Custprops=O,_e}function Cy(t,s){switch(H1(s=s||{}),s.type||"base64"){case"base64":return ab(wl(t),s);case"binary":case"buffer":case"file":return ab(t,s);case"array":return ab(bu(t),s)}}function mK(t,s){var r=[];return t.Props&&r.push(R7(t.Props,s)),t.Custprops&&r.push(O7(t.Props,t.Custprops)),r.join("")}function fK(){return""}function pK(t,s){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return s.cellXfs.forEach(function(a,n){var i=[];i.push(xs("NumberFormat",null,{"ss:Format":Kr(Ws[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(xs("Style",i.join(""),l))}),xs("Styles",r.join(""))}function mk(t){return xs("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+P1(t.Ref,{r:0,c:0})})}function xK(t){if(!((t||{}).Workbook||{}).Names)return"";for(var s=t.Workbook.Names,r=[],a=0;a<s.length;++a){var n=s[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(mk(n)))}return xs("Names",r.join(""))}function gK(t,s,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(mk(o)))}return i.join("")}function vK(t,s,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(xs("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(xs("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(xs("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(xs("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(Vn("ProtectContents","True")),t["!protect"].objects&&n.push(Vn("ProtectObjects","True")),t["!protect"].scenarios&&n.push(Vn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(Vn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(Vn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":xs("WorksheetOptions",n.join(""),{xmlns:pl.x})}function bK(t){return t.map(function(s){var r=MQ(s.t||""),a=xs("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return xs("Comment",a,{"ss:Author":s.a})}).join("")}function yK(t,s,r,a,n,i,l){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Kr(P1(t.f,l))),t.F&&t.F.slice(0,s.length)==s){var u=Sa(t.F.slice(s.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==l.r?"":"["+(u.r-l.r)+"]")+"C"+(u.c==l.c?"":"["+(u.c-l.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Kr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Kr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],c=0;c!=d.length;++c)d[c].s.c!=l.c||d[c].s.r!=l.r||(d[c].e.c>d[c].s.c&&(o["ss:MergeAcross"]=d[c].e.c-d[c].s.c),d[c].e.r>d[c].s.r&&(o["ss:MergeDown"]=d[c].e.r-d[c].s.r));var m="",h="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":m="Number",h=String(t.v);break;case"b":m="Boolean",h=t.v?"1":"0";break;case"e":m="Error",h=ld[t.v];break;case"d":m="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ws[14]);break;case"s":m="String",h=QQ(t.v||"");break}var f=ju(a.cellXfs,t,a);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=l.c+1;var x=t.v!=null?h:"",g=t.t=="z"?"":'<Data ss:Type="'+m+'">'+x+"</Data>";return(t.c||[]).length>0&&(g+=bK(t.c)),xs("Cell",g,o)}function jK(t,s){var r='<Row ss:Index="'+(t+1)+'"';return s&&(s.hpt&&!s.hpx&&(s.hpx=Ph(s.hpt)),s.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+s.hpx+'"'),s.hidden&&(r+=' ss:Hidden="1"')),r+">"}function NK(t,s,r,a){if(!t["!ref"])return"";var n=Cr(t["!ref"]),i=t["!merges"]||[],l=0,o=[];t["!cols"]&&t["!cols"].forEach(function(b,y){mu(b);var N=!!b.width,j=dg(y,b),S={"ss:Index":y+1};N&&(S["ss:Width"]=yf(j.width)),b.hidden&&(S["ss:Hidden"]="1"),o.push(xs("Column",null,S))});for(var u=Array.isArray(t),d=n.s.r;d<=n.e.r;++d){for(var c=[jK(d,(t["!rows"]||[])[d])],m=n.s.c;m<=n.e.c;++m){var h=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>m)&&!(i[l].s.r>d)&&!(i[l].e.c<m)&&!(i[l].e.r<d)){(i[l].s.c!=m||i[l].s.r!=d)&&(h=!0);break}if(!h){var f={r:d,c:m},x=Ys(f),g=u?(t[d]||[])[m]:t[x];c.push(yK(g,x,t,s,r,a,f))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function wK(t,s,r){var a=[],n=r.SheetNames[t],i=r.Sheets[n],l=i?gK(i,s,t,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?NK(i,s,t,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(vK(i,s,t,r)),a.join("")}function _K(t,s){s||(s={}),t.SSF||(t.SSF=ha(Ws)),t.SSF&&($h(),rg(t.SSF),s.revssf=ng(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF,s.cellXfs=[],ju(s.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(mK(t,s)),r.push(fK()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(xs("Worksheet",wK(a,s,t),{"ss:Name":Kr(t.SheetNames[a])}));return r[2]=pK(t,s),r[3]=xK(t),Za+xs("Workbook",r.join(""),{xmlns:pl.ss,"xmlns:o":pl.o,"xmlns:x":pl.x,"xmlns:ss":pl.ss,"xmlns:dt":pl.dt,"xmlns:html":pl.html})}function SK(t){var s={},r=t.content;if(r.l=28,s.AnsiUserType=r.read_shift(0,"lpstr-ansi"),s.AnsiClipboardFormat=x7(r),r.length-r.l<=4)return s;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,s.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(s.UnicodeClipboardFormat=g7(r),a=r.read_shift(4),a==0||a>40))return s;r.l-=4,s.Reserved2=r.read_shift(0,"lpwstr")}var CK=[60,1084,2066,2165,2175];function BK(t,s,r,a,n){var i=a,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var u=Gc(r,r.l),d=By[u],c=0;d!=null&&CK.indexOf(u)>-1;)i=Gc(r,r.l+2),c=r.l+4,u==2066?c+=4:(u==2165||u==2175)&&(c+=12),o=r.slice(c,r.l+4+i),l.push(o),r.l+=4+i,d=By[u=Gc(r,r.l)];var m=kn(l);qn(m,0);var h=0;m.lens=[];for(var f=0;f<l.length;++f)m.lens.push(h),h+=l[f].length;if(m.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+m.length+" < "+a;return s.f(m,m.length,n)}function tc(t,s,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,s.cellNF&&(t.z=Ws[a])}catch(i){if(s.WTF)throw i}if(!s||s.cellText!==!1)try{t.t==="e"?t.w=t.w||ld[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=ff(t.v):t.w=xA(t.v):t.w=Xl(a,t.v,{date1904:!!r,dateNF:s&&s.dateNF})}catch(i){if(s.WTF)throw i}if(s.cellDates&&a&&t.t=="n"&&Vh(Ws[a]||String(a))){var n=nA(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function fx(t,s,r){return{v:t,ixfe:s,t:r}}function kK(t,s){var r={opts:{}},a={},n=s.dense?[]:{},i={},l={},o=null,u=[],d="",c={},m,h="",f,x,g,b,y={},N=[],j,S,k=[],P=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},q=function(He){return He<8?uA[He]:He<64&&P[He-8]||uA[He]},Q=function(He,ze,Pe){var Te=ze.XF.data;if(!(!Te||!Te.patternType||!Pe||!Pe.cellStyles)){ze.s={},ze.s.patternType=Te.patternType;var Ke;(Ke=bf(q(Te.icvFore)))&&(ze.s.fgColor={rgb:Ke}),(Ke=bf(q(Te.icvBack)))&&(ze.s.bgColor={rgb:Ke})}},O=function(He,ze,Pe){if(!(K>1)&&!(Pe.sheetRows&&He.r>=Pe.sheetRows)){if(Pe.cellStyles&&ze.XF&&ze.XF.data&&Q(He,ze,Pe),delete ze.ixfe,delete ze.XF,m=He,h=Ys(He),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),He.r<l.s.r&&(l.s.r=He.r),He.c<l.s.c&&(l.s.c=He.c),He.r+1>l.e.r&&(l.e.r=He.r+1),He.c+1>l.e.c&&(l.e.c=He.c+1),Pe.cellFormula&&ze.f){for(var Te=0;Te<N.length;++Te)if(!(N[Te][0].s.c>He.c||N[Te][0].s.r>He.r)&&!(N[Te][0].e.c<He.c||N[Te][0].e.r<He.r)){ze.F=ir(N[Te][0]),(N[Te][0].s.c!=He.c||N[Te][0].s.r!=He.r)&&delete ze.f,ze.f&&(ze.f=""+hi(N[Te][1],l,He,H,T));break}}Pe.dense?(n[He.r]||(n[He.r]=[]),n[He.r][He.c]=ze):n[h]=ze}},T={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:N,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!s&&!!s.cellStyles,WTF:!!s&&!!s.wtf};s.password&&(T.password=s.password);var V,D=[],Y=[],M=[],X=[],R=!1,H=[];H.SheetNames=T.snames,H.sharedf=T.sharedf,H.arrayf=T.arrayf,H.names=[],H.XTI=[];var W=0,K=0,_=0,F=[],E=[],L;T.codepage=1200,So(1200);for(var U=!1;t.l<t.length-1;){var J=t.l,ae=t.read_shift(2);if(ae===0&&W===10)break;var Z=t.l===t.length?0:t.read_shift(2),oe=By[ae];if(oe&&oe.f){if(s.bookSheets&&W===133&&ae!==133)break;if(W=ae,oe.r===2||oe.r==12){var ee=t.read_shift(2);if(Z-=2,!T.enc&&ee!==ae&&((ee&255)<<8|ee>>8)!==ae)throw new Error("rt mismatch: "+ee+"!="+ae);oe.r==12&&(t.l+=10,Z-=10)}var se={};if(ae===10?se=oe.f(t,Z,T):se=BK(ae,oe,t,Z,T),K==0&&[9,521,1033,2057].indexOf(W)===-1)continue;switch(ae){case 34:r.opts.Date1904=I.WBProps.date1904=se;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=se,!s.password)throw new Error("File is password-protected");if(se.valid==null)throw new Error("Encryption scheme unsupported");if(!se.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=se;break;case 66:var Ae=Number(se);switch(Ae){case 21010:Ae=1200;break;case 32768:Ae=1e4;break;case 32769:Ae=1252;break}So(T.codepage=Ae),U=!0;break;case 317:T.rrtabid=se;break;case 25:T.winlocked=se;break;case 439:r.opts.RefreshAll=se;break;case 12:r.opts.CalcCount=se;break;case 16:r.opts.CalcDelta=se;break;case 17:r.opts.CalcIter=se;break;case 13:r.opts.CalcMode=se;break;case 14:r.opts.CalcPrecision=se;break;case 95:r.opts.CalcSaveRecalc=se;break;case 15:T.CalcRefMode=se;break;case 2211:r.opts.FullCalc=se;break;case 129:se.fDialog&&(n["!type"]="dialog"),se.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),se.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:k.push(se);break;case 430:H.push([se]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(se);break;case 24:case 536:L={Name:se.Name,Ref:hi(se.rgce,l,null,H,T)},se.itab>0&&(L.Sheet=se.itab-1),H.names.push(L),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(se),se.Name=="_xlnm._FilterDatabase"&&se.itab>0&&se.rgce&&se.rgce[0]&&se.rgce[0][0]&&se.rgce[0][0][0]=="PtgArea3d"&&(E[se.itab-1]={ref:ir(se.rgce[0][0][1][2])});break;case 22:T.ExternCount=se;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(se),H.XTI=H.XTI.concat(se);break;case 2196:if(T.biff<8)break;L!=null&&(L.Comment=se[1]);break;case 18:n["!protect"]=se;break;case 19:se!==0&&T.WTF&&console.error("Password verifier: "+se);break;case 133:i[se.pos]=se,T.snames.push(se.name);break;case 10:{if(--K)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=ir(l),s.sheetRows&&s.sheetRows<=l.e.r){var we=l.e.r;l.e.r=s.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=ir(l),l.e.r=we}l.e.r++,l.e.c++}D.length>0&&(n["!merges"]=D),Y.length>0&&(n["!objects"]=Y),M.length>0&&(n["!cols"]=M),X.length>0&&(n["!rows"]=X),I.Sheets.push(B)}d===""?c=n:a[d]=n,n=s.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[se.BIFFVer]||8),T.biffguess=se.BIFFVer==0,se.BIFFVer==0&&se.dt==4096&&(T.biff=5,U=!0,So(T.codepage=28591)),T.biff==8&&se.BIFFVer==0&&se.dt==16&&(T.biff=2),K++)break;if(n=s.dense?[]:{},T.biff<8&&!U&&(U=!0,So(T.codepage=s.codepage||1252)),T.biff<5||se.BIFFVer==0&&se.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ce={pos:t.l-Z,name:d};i[ce.pos]=ce,T.snames.push(d)}else d=(i[J]||{name:""}).name;se.dt==32&&(n["!type"]="chart"),se.dt==64&&(n["!type"]="macro"),D=[],Y=[],T.arrayf=N=[],M=[],X=[],R=!1,B={Hidden:(i[J]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(s.dense?(n[se.r]||[])[se.c]:n[Ys({c:se.c,r:se.r})])&&++se.c,j={ixfe:se.ixfe,XF:k[se.ixfe]||{},v:se.val,t:"n"},_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:se.c,r:se.r},j,s);break;case 5:case 517:j={ixfe:se.ixfe,XF:k[se.ixfe],v:se.val,t:se.t},_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:se.c,r:se.r},j,s);break;case 638:j={ixfe:se.ixfe,XF:k[se.ixfe],v:se.rknum,t:"n"},_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:se.c,r:se.r},j,s);break;case 189:for(var le=se.c;le<=se.C;++le){var _e=se.rkrec[le-se.c][0];j={ixfe:_e,XF:k[_e],v:se.rkrec[le-se.c][1],t:"n"},_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:le,r:se.r},j,s)}break;case 6:case 518:case 1030:{if(se.val=="String"){o=se;break}if(j=fx(se.val,se.cell.ixfe,se.tt),j.XF=k[j.ixfe],s.cellFormula){var Qe=se.formula;if(Qe&&Qe[0]&&Qe[0][0]&&Qe[0][0][0]=="PtgExp"){var Ie=Qe[0][0][1][0],ke=Qe[0][0][1][1],pe=Ys({r:Ie,c:ke});y[pe]?j.f=""+hi(se.formula,l,se.cell,H,T):j.F=((s.dense?(n[Ie]||[])[ke]:n[pe])||{}).F}else j.f=""+hi(se.formula,l,se.cell,H,T)}_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O(se.cell,j,s),o=se}break;case 7:case 519:if(o)o.val=se,j=fx(se,o.cell.ixfe,"s"),j.XF=k[j.ixfe],s.cellFormula&&(j.f=""+hi(o.formula,l,o.cell,H,T)),_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O(o.cell,j,s),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{N.push(se);var he=Ys(se[0].s);if(f=s.dense?(n[se[0].s.r]||[])[se[0].s.c]:n[he],s.cellFormula&&f){if(!o||!he||!f)break;f.f=""+hi(se[1],l,se[0],H,T),f.F=ir(se[0])}}break;case 1212:{if(!s.cellFormula)break;if(h){if(!o)break;y[Ys(o.cell)]=se[0],f=s.dense?(n[o.cell.r]||[])[o.cell.c]:n[Ys(o.cell)],(f||{}).f=""+hi(se[0],l,m,H,T)}}break;case 253:j=fx(u[se.isst].t,se.ixfe,"s"),u[se.isst].h&&(j.h=u[se.isst].h),j.XF=k[j.ixfe],_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:se.c,r:se.r},j,s);break;case 513:s.sheetStubs&&(j={ixfe:se.ixfe,XF:k[se.ixfe],t:"z"},_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:se.c,r:se.r},j,s));break;case 190:if(s.sheetStubs)for(var je=se.c;je<=se.C;++je){var me=se.ixfe[je-se.c];j={ixfe:me,XF:k[me],t:"z"},_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:je,r:se.r},j,s)}break;case 214:case 516:case 4:j=fx(se.val,se.ixfe,"s"),j.XF=k[j.ixfe],_>0&&(j.z=F[j.ixfe>>8&63]),tc(j,s,r.opts.Date1904),O({c:se.c,r:se.r},j,s);break;case 0:case 512:K===1&&(l=se);break;case 252:u=se;break;case 1054:if(T.biff==4){F[_++]=se[1];for(var xe=0;xe<_+163&&Ws[xe]!=se[1];++xe);xe>=163&&Jc(se[1],_+163)}else Jc(se[1],se[0]);break;case 30:{F[_++]=se;for(var Ue=0;Ue<_+163&&Ws[Ue]!=se;++Ue);Ue>=163&&Jc(se,_+163)}break;case 229:D=D.concat(se);break;case 93:Y[se.cmo[0]]=T.lastobj=se;break;case 438:T.lastobj.TxO=se;break;case 127:T.lastobj.ImData=se;break;case 440:for(b=se[0].s.r;b<=se[0].e.r;++b)for(g=se[0].s.c;g<=se[0].e.c;++g)f=s.dense?(n[b]||[])[g]:n[Ys({c:g,r:b})],f&&(f.l=se[1]);break;case 2048:for(b=se[0].s.r;b<=se[0].e.r;++b)for(g=se[0].s.c;g<=se[0].e.c;++g)f=s.dense?(n[b]||[])[g]:n[Ys({c:g,r:b})],f&&f.l&&(f.l.Tooltip=se[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;f=s.dense?(n[se[0].r]||[])[se[0].c]:n[Ys(se[0])];var ct=Y[se[2]];f||(s.dense?(n[se[0].r]||(n[se[0].r]=[]),f=n[se[0].r][se[0].c]={t:"z"}):f=n[Ys(se[0])]={t:"z"},l.e.r=Math.max(l.e.r,se[0].r),l.s.r=Math.min(l.s.r,se[0].r),l.e.c=Math.max(l.e.c,se[0].c),l.s.c=Math.min(l.s.c,se[0].c)),f.c||(f.c=[]),x={a:se[1],t:ct.TxO.t},f.c.push(x)}break;case 2173:pq(k[se.ixfe],se.ext);break;case 125:{if(!T.cellStyles)break;for(;se.e>=se.s;)M[se.e--]={width:se.w/256,level:se.level||0,hidden:!!(se.flags&1)},R||(R=!0,I1(se.w/256)),mu(M[se.e+1])}break;case 520:{var dt={};se.level!=null&&(X[se.r]=dt,dt.level=se.level),se.hidden&&(X[se.r]=dt,dt.hidden=!0),se.hpt&&(X[se.r]=dt,dt.hpt=se.hpt,dt.hpx=Ph(se.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||mA(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=se;break;case 161:n["!margins"]||mA(n["!margins"]={}),n["!margins"].header=se.header,n["!margins"].footer=se.footer;break;case 574:se.RTL&&(I.Views[0].RTL=!0);break;case 146:P=se;break;case 2198:V=se;break;case 140:S=se;break;case 442:d?B.CodeName=se||B.name:I.WBProps.CodeName=se||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),t.l+=Z}return r.SheetNames=Oa(i).sort(function(We,He){return Number(We)-Number(He)}).map(function(We){return i[We].name}),s.bookSheets||(r.Sheets=a),!r.SheetNames.length&&c["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=c)):r.Preamble=c,r.Sheets&&E.forEach(function(We,He){r.Sheets[r.SheetNames[He]]["!autofilter"]=We}),r.Strings=u,r.SSF=ha(Ws),T.enc&&(r.Encryption=T.enc),V&&(r.Themes=V),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),H.names.length>0&&(I.Names=H.names),r.Workbook=I,r}var ef={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function EK(t,s,r){var a=Qs.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=p_(a,yy,ef.DSI);for(var i in n)s[i]=n[i]}catch(d){if(r.WTF)throw d}var l=Qs.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var o=p_(l,jy,ef.SI);for(var u in o)s[u]==null&&(s[u]=o[u])}catch(d){if(r.WTF)throw d}s.HeadingPairs&&s.TitlesOfParts&&(hB(s.HeadingPairs,s.TitlesOfParts,s,r),delete s.HeadingPairs,delete s.TitlesOfParts)}function FK(t,s){var r=[],a=[],n=[],i=0,l,o=W2(yy,"n"),u=W2(jy,"n");if(t.Props)for(l=Oa(t.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(u,l[i])?a:n).push([l[i],t.Props[l[i]]]);if(t.Custprops)for(l=Oa(t.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(u,l[i])?a:n).push([l[i],t.Custprops[l[i]]]);var d=[];for(i=0;i<n.length;++i)bB.indexOf(n[i][0])>-1||AB.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);a.length&&Qs.utils.cfb_add(s,"/SummaryInformation",x_(a,ef.SI,u,jy)),(r.length||d.length)&&Qs.utils.cfb_add(s,"/DocumentSummaryInformation",x_(r,ef.DSI,o,yy,d.length?d:null,ef.UDI))}function fk(t,s){s||(s={}),H1(s),c1(),s.codepage&&o1(s.codepage);var r,a;if(t.FullPaths){if(Qs.find(t,"/encryption"))throw new Error("File is password-protected");r=Qs.find(t,"!CompObj"),a=Qs.find(t,"/Workbook")||Qs.find(t,"/Book")}else{switch(s.type){case"base64":t=gl(wl(t));break;case"binary":t=gl(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}qn(t,0),a={content:t}}var n,i;if(r&&SK(r),s.bookProps&&!s.bookSheets)n={};else{var l=or?"buffer":"array";if(a&&a.content)n=kK(a.content,s);else if((i=Qs.find(t,"PerfectOffice_MAIN"))&&i.content)n=hA.to_workbook(i.content,(s.type=l,s));else if((i=Qs.find(t,"NativeContent_MAIN"))&&i.content)n=hA.to_workbook(i.content,(s.type=l,s));else throw(i=Qs.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");s.bookVBA&&t.FullPaths&&Qs.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Vq(t))}var o={};return t.FullPaths&&EK(t,o,s),n.Props=n.Custprops=o,s.bookFiles&&(n.cfb=t),n}function TK(t,s){var r=s||{},a=Qs.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qs.utils.cfb_add(a,n,pk(t,r)),r.biff==8&&(t.Props||t.Custprops)&&FK(t,a),r.biff==8&&t.vbaraw&&$q(a,Qs.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var wf={0:{f:sW},1:{f:dW},2:{f:kW},3:{f:gW},4:{f:mW},5:{f:SW},6:{f:LW},7:{f:jW},8:{f:MW},9:{f:QW},10:{f:RW},11:{f:OW},12:{f:AW},13:{f:FW},14:{f:bW},15:{f:pW},16:{f:lk},17:{f:PW},18:{f:wW},19:{f:N1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PG},40:{},42:{},43:{f:L9},44:{f:T9},45:{f:U9},46:{f:O9},47:{f:R9},48:{},49:{f:n7},50:{},51:{f:vq},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:FB},62:{f:IW},63:{f:Bq},64:{f:rG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ZW},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:oW},148:{f:nW,p:16},151:{f:GW},152:{},153:{f:IG},154:{},155:{},156:{f:FG},157:{},158:{},159:{T:1,f:zH},160:{T:-1},161:{T:1,f:BA},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:HW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:xq},336:{T:-1},337:{f:jq,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:by},357:{},358:{},359:{},360:{T:1},361:{},362:{f:EB},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KW},427:{f:zW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:XW},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:lW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$W},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:by},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Oq},633:{T:1},634:{T:-1},635:{T:1,f:Uq},636:{T:-1},637:{f:c7},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:bG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:aG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},By={6:{f:sb},10:{f:Wd},12:{f:nn},13:{f:nn},14:{f:Wa},15:{f:Wa},16:{f:xi},17:{f:Wa},18:{f:Wa},19:{f:nn},20:{f:N_},21:{f:N_},23:{f:EB},24:{f:__},25:{f:Wa},26:{},27:{},28:{f:aH},29:{},34:{f:Wa},35:{f:w_},38:{f:xi},39:{f:xi},40:{f:xi},41:{f:xi},42:{f:Wa},43:{f:Wa},47:{f:p9},49:{f:FM},51:{f:nn},60:{},61:{f:SM},64:{f:Wa},65:{f:EM},66:{f:nn},77:{},80:{},81:{},82:{},85:{f:nn},89:{},90:{},91:{},92:{f:fM},93:{f:lH},94:{},95:{f:Wa},96:{},97:{},99:{f:Wa},125:{f:FB},128:{f:WM},129:{f:xM},130:{f:nn},131:{f:Wa},132:{f:Wa},133:{f:gM},134:{},140:{f:fH},141:{f:nn},144:{},146:{f:gH},151:{},152:{},153:{},154:{},155:{},156:{f:nn},157:{},158:{},160:{f:_H},161:{f:yH},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:HM},190:{f:qM},193:{f:Wd},197:{},198:{},199:{},200:{},201:{},202:{f:Wa},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:nn},220:{},221:{f:Wa},222:{},224:{f:$M},225:{f:mM},226:{f:Wd},227:{},229:{f:nH},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:bM},253:{f:IM},255:{f:jM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:yB},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wa},353:{f:Wd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:XM},431:{f:Wa},432:{},433:{},434:{},437:{},438:{f:dH},439:{f:Wa},440:{f:uH},441:{},442:{f:Qf},443:{},444:{f:nn},445:{},446:{},448:{f:Wd},449:{f:_M,r:2},450:{f:Wd},512:{f:b_},513:{f:wH},515:{f:zM},516:{f:DM},517:{f:j_},519:{f:SH},520:{f:NM},523:{},545:{f:S_},549:{f:v_},566:{},574:{f:BM},638:{f:MM},659:{},1048:{},1054:{f:UM},1084:{},1212:{f:tH},2048:{f:hH},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ax},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Wd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vH,r:12},2173:{f:fq,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wa,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:eH,r:12},2197:{},2198:{f:cq,r:12},2199:{},2200:{},2201:{},2202:{f:sH,r:12},2203:{f:Wd},2204:{},2205:{},2206:{},2207:{},2211:{f:wM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:nn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jH},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xH},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:b_},1:{},2:{f:FH},3:{f:kH},4:{f:BH},5:{f:j_},7:{f:IH},8:{},9:{f:Ax},11:{},22:{f:nn},30:{f:OM},31:{},32:{},33:{f:S_},36:{},37:{f:v_},50:{f:LH},62:{},52:{},67:{},68:{f:nn},69:{},86:{},126:{},127:{f:CH},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:DH},223:{},234:{},354:{},421:{},518:{f:sb},521:{f:Ax},536:{f:__},547:{f:w_},561:{},579:{},1030:{f:sb},1033:{f:Ax},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function gs(t,s,r,a){var n=s;if(!isNaN(n)){var i=a||(r||[]).length||0,l=t.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&b1(r)&&t.push(r)}}function IK(t,s,r,a){var n=(r||[]).length||0;if(n<=8224)return gs(t,s,r,n);var i=s;if(!isNaN(i)){for(var l=r.parts||[],o=0,u=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var c=t.next(4);for(c.write_shift(2,i),c.write_shift(2,d),t.push(r.slice(u,u+d)),u+=d;u<n;){for(c=t.next(4),c.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;c.write_shift(2,d),t.push(r.slice(u,u+d)),u+=d}}}function Vf(t,s,r){return t||(t=Jt(7)),t.write_shift(2,s),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function LK(t,s,r,a){var n=Jt(9);return Vf(n,t,s),jB(r,a||"b",n),n}function DK(t,s,r){var a=Jt(8+2*r.length);return Vf(a,t,s),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function PK(t,s,r,a){if(s.v!=null)switch(s.t){case"d":case"n":var n=s.t=="d"?xn(Aa(s.v)):s.v;n==(n|0)&&n>=0&&n<65536?gs(t,2,TH(r,a,n)):gs(t,3,EH(r,a,n));return;case"b":case"e":gs(t,5,LK(r,a,s.v,s.t));return;case"s":case"str":gs(t,4,DK(r,a,(s.v||"").slice(0,255)));return}gs(t,1,Vf(null,r,a))}function UK(t,s,r,a){var n=Array.isArray(s),i=Cr(s["!ref"]||"A1"),l,o="",u=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=ir(i)}for(var d=i.s.r;d<=i.e.r;++d){o=Xa(d);for(var c=i.s.c;c<=i.e.c;++c){d===i.s.r&&(u[c]=_a(c)),l=u[c]+o;var m=n?(s[d]||[])[c]:s[l];m&&PK(t,m,d,c)}}}function RK(t,s){for(var r=s||{},a=sl(),n=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return gs(a,r.biff==4?1033:r.biff==3?521:9,E1(t,16,r)),UK(a,t.Sheets[t.SheetNames[n]],n,r),gs(a,10),a.end()}function OK(t,s,r){gs(t,49,TM({sz:12,name:"Arial"},r))}function QK(t,s,r){s&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)s[n]!=null&&gs(t,1054,RM(n,s[n],r))})}function MK(t,s){var r=Jt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),gs(t,2151,r),r=Jt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),CB(Cr(s["!ref"]||"A1"),r),r.write_shift(4,4),gs(t,2152,r)}function HK(t,s){for(var r=0;r<16;++r)gs(t,224,y_({numFmtId:0,style:!0},0,s));s.cellXfs.forEach(function(a){gs(t,224,y_(a,0,s))})}function qK(t,s){for(var r=0;r<s["!links"].length;++r){var a=s["!links"][r];gs(t,440,AH(a)),a[1].Tooltip&&gs(t,2048,mH(a))}delete s["!links"]}function VK(t,s){if(s){var r=0;s.forEach(function(a,n){++r<=256&&a&&gs(t,125,bH(dg(n,a),n))})}}function $K(t,s,r,a,n){var i=16+ju(n.cellXfs,s,n);if(s.v==null&&!s.bf){gs(t,513,yA(r,a,i));return}if(s.bf)gs(t,6,x$(s,r,a,n,i));else switch(s.t){case"d":case"n":var l=s.t=="d"?xn(Aa(s.v)):s.v;gs(t,515,YM(r,a,l,i));break;case"b":case"e":gs(t,517,KM(r,a,s.v,i,n,s.t));break;case"s":case"str":if(n.bookSST){var o=R1(n.Strings,s.v,n.revStrings);gs(t,253,LM(r,a,o,i))}else gs(t,516,PM(r,a,(s.v||"").slice(0,255),i,n));break;default:gs(t,513,yA(r,a,i))}}function WK(t,s,r){var a=sl(),n=r.SheetNames[t],i=r.Sheets[n]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[t]||{},u=Array.isArray(i),d=s.biff==8,c,m="",h=[],f=Cr(i["!ref"]||"A1"),x=d?65536:16384;if(f.e.c>255||f.e.r>=x){if(s.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,x-1)}gs(a,2057,E1(r,16,s)),gs(a,13,$l(1)),gs(a,12,$l(100)),gs(a,15,Di(!0)),gs(a,17,Di(!1)),gs(a,16,vA(.001)),gs(a,95,Di(!0)),gs(a,42,Di(!1)),gs(a,43,Di(!1)),gs(a,130,$l(1)),gs(a,128,GM()),gs(a,131,Di(!1)),gs(a,132,Di(!1)),d&&VK(a,i["!cols"]),gs(a,512,QM(f,s)),d&&(i["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){m=Xa(g);for(var b=f.s.c;b<=f.e.c;++b){g===f.s.r&&(h[b]=_a(b)),c=h[b]+m;var y=u?(i[g]||[])[b]:i[c];y&&($K(a,y,g,b,s),d&&y.l&&i["!links"].push([c,y.l]))}}var N=o.CodeName||o.name||n;return d&&gs(a,574,kM((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&gs(a,229,iH(i["!merges"])),d&&qK(a,i),gs(a,442,NB(N)),d&&MK(a,i),gs(a,10),a.end()}function GK(t,s,r){var a=sl(),n=(t||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=r.biff==8,u=r.biff==5;if(gs(a,2057,E1(t,5,r)),r.bookType=="xla"&&gs(a,135),gs(a,225,o?$l(1200):null),gs(a,193,K7(2)),u&&gs(a,191),u&&gs(a,192),gs(a,226),gs(a,92,pM("SheetJS",r)),gs(a,66,$l(o?1200:1252)),o&&gs(a,353,$l(0)),o&&gs(a,448),gs(a,317,NH(t.SheetNames.length)),o&&t.vbaraw&&gs(a,211),o&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";gs(a,442,NB(d))}gs(a,156,$l(17)),gs(a,25,Di(!1)),gs(a,18,Di(!1)),gs(a,19,$l(0)),o&&gs(a,431,Di(!1)),o&&gs(a,444,$l(0)),gs(a,61,CM()),gs(a,64,Di(!1)),gs(a,141,$l(0)),gs(a,34,Di(_G(t)=="true")),gs(a,14,Di(!0)),o&&gs(a,439,Di(!1)),gs(a,218,$l(0)),OK(a,t,r),QK(a,t.SSF,r),HK(a,r),o&&gs(a,352,Di(!1));var c=a.end(),m=sl();o&&gs(m,140,pH()),o&&r.Strings&&IK(m,252,yM(r.Strings)),gs(m,10);var h=m.end(),f=sl(),x=0,g=0;for(g=0;g<t.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*t.SheetNames[g].length;var b=c.length+x+h.length;for(g=0;g<t.SheetNames.length;++g){var y=i[g]||{};gs(f,133,vM({pos:b,hs:y.Hidden||0,dt:0,name:t.SheetNames[g]},r)),b+=s[g].length}var N=f.end();if(x!=N.length)throw new Error("BS8 "+x+" != "+N.length);var j=[];return c.length&&j.push(c),N.length&&j.push(N),h.length&&j.push(h),kn(j)}function KK(t,s){var r=s||{},a=[];t&&!t.SSF&&(t.SSF=ha(Ws)),t&&t.SSF&&($h(),rg(t.SSF),r.revssf=ng(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,q1(r),r.cellXfs=[],ju(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=WK(n,r,t);return a.unshift(GK(t,a,r)),kn(a)}function pk(t,s){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=rl(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=s||{};switch(i.biff||2){case 8:case 5:return KK(t,s);case 4:case 3:case 2:return RK(t,s)}throw new Error("invalid type "+i.bookType+" for BIFF")}function P_(t,s){var r=s||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=n.index,o=i&&i.index||t.length,u=TQ(t.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,c=0,m=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(l=0;l<u.length;++l){var g=u[l].trim(),b=g.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}c=0;continue}if(!(b!="<td"&&b!="<th")){var y=g.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var N=y[o].trim();if(N.match(/<t[dh]/i)){for(var j=N,S=0;j.charAt(0)=="<"&&(S=j.indexOf(">"))>-1;)j=j.slice(S+1);for(var k=0;k<x.length;++k){var P=x[k];P.s.c==c&&P.s.r<d&&d<=P.e.r&&(c=P.e.c+1,k=-1)}var I=Js(N.slice(0,N.indexOf(">")));h=I.colspan?+I.colspan:1,((m=+I.rowspan)>1||h>1)&&x.push({s:{r:d,c},e:{r:d+(m||1)-1,c:c+h-1}});var B=I.t||I["data-t"]||"";if(!j.length){c+=h;continue}if(j=Q4(j),f.s.r>d&&(f.s.r=d),f.e.r<d&&(f.e.r=d),f.s.c>c&&(f.s.c=c),f.e.c<c&&(f.e.c=c),!j.length){c+=h;continue}var q={t:"s",v:j};r.raw||!j.trim().length||B=="s"||(j==="TRUE"?q={t:"b",v:!0}:j==="FALSE"?q={t:"b",v:!1}:isNaN(Bo(j))?isNaN(Lh(j).getDate())||(q={t:"d",v:Aa(j)},r.cellDates||(q={t:"n",v:xn(q.v)}),q.z=r.dateNF||Ws[14]):q={t:"n",v:Bo(j)}),r.dense?(a[d]||(a[d]=[]),a[d][c]=q):a[Ys({r:d,c})]=q,c+=h}}}}return a["!ref"]=ir(f),x.length&&(a["!merges"]=x),a}function zK(t,s,r,a){for(var n=t["!merges"]||[],i=[],l=s.s.c;l<=s.e.c;++l){for(var o=0,u=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>l)&&!(n[d].e.r<r||n[d].e.c<l)){if(n[d].s.r<r||n[d].s.c<l){o=-1;break}o=n[d].e.r-n[d].s.r+1,u=n[d].e.c-n[d].s.c+1;break}if(!(o<0)){var c=Ys({r,c:l}),m=a.dense?(t[r]||[])[l]:t[c],h=m&&m.v!=null&&(m.h||x1(m.w||(sd(m),m.w)||""))||"",f={};o>1&&(f.rowspan=o),u>1&&(f.colspan=u),a.editable?h='<span contenteditable="true">'+h+"</span>":m&&(f["data-t"]=m&&m.t||"z",m.v!=null&&(f["data-v"]=m.v),m.z!=null&&(f["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+m.l.Target+'">'+h+"</a>")),f.id=(a.id||"sjs")+"-"+c,i.push(xs("td",h,f))}}var x="<tr>";return x+i.join("")+"</tr>"}var YK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XK="</body></html>";function JK(t,s){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return yu(P_(r[0],s),s);var a=W1();return r.forEach(function(n,i){G1(a,P_(n,s),"Sheet"+(i+1))}),a}function ZK(t,s,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xk(t,s){var r=s||{},a=r.header!=null?r.header:YK,n=r.footer!=null?r.footer:XK,i=[a],l=rl(t["!ref"]);r.dense=Array.isArray(t),i.push(ZK(t,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(zK(t,l,o,r));return i.push("</table>"+n),i.join("")}function gk(t,s,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?Sa(a.origin):a.origin;n=l.r,i=l.c}var o=s.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(t["!ref"]){var c=rl(t["!ref"]);d.s.r=Math.min(d.s.r,c.s.r),d.s.c=Math.min(d.s.c,c.s.c),d.e.r=Math.max(d.e.r,c.e.r),d.e.c=Math.max(d.e.c,c.e.c),n==-1&&(d.e.r=n=c.e.r+1)}var m=[],h=0,f=t["!rows"]||(t["!rows"]=[]),x=0,g=0,b=0,y=0,N=0,j=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&g<u;++x){var S=o[x];if(U_(S)){if(a.display)continue;f[g]={hidden:!0}}var k=S.children;for(b=y=0;b<k.length;++b){var P=k[b];if(!(a.display&&U_(P))){var I=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):Q4(P.innerHTML),B=P.getAttribute("data-z")||P.getAttribute("z");for(h=0;h<m.length;++h){var q=m[h];q.s.c==y+i&&q.s.r<g+n&&g+n<=q.e.r&&(y=q.e.c+1-i,h=-1)}j=+P.getAttribute("colspan")||1,((N=+P.getAttribute("rowspan")||1)>1||j>1)&&m.push({s:{r:g+n,c:y+i},e:{r:g+n+(N||1)-1,c:y+i+(j||1)-1}});var Q={t:"s",v:I},O=P.getAttribute("data-t")||P.getAttribute("t")||"";I!=null&&(I.length==0?Q.t=O||"z":a.raw||I.trim().length==0||O=="s"||(I==="TRUE"?Q={t:"b",v:!0}:I==="FALSE"?Q={t:"b",v:!1}:isNaN(Bo(I))?isNaN(Lh(I).getDate())||(Q={t:"d",v:Aa(I)},a.cellDates||(Q={t:"n",v:xn(Q.v)}),Q.z=a.dateNF||Ws[14]):Q={t:"n",v:Bo(I)})),Q.z===void 0&&B!=null&&(Q.z=B);var T="",V=P.getElementsByTagName("A");if(V&&V.length)for(var D=0;D<V.length&&!(V[D].hasAttribute("href")&&(T=V[D].getAttribute("href"),T.charAt(0)!="#"));++D);T&&T.charAt(0)!="#"&&(Q.l={Target:T}),a.dense?(t[g+n]||(t[g+n]=[]),t[g+n][y+i]=Q):t[Ys({c:y+i,r:g+n})]=Q,d.e.c<y+i&&(d.e.c=y+i),y+=j}}++g}return m.length&&(t["!merges"]=(t["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,g-1+n),t["!ref"]=ir(d),g>=u&&(t["!fullref"]=ir((d.e.r=o.length-x+g-1+n,d))),t}function vk(t,s){var r=s||{},a=r.dense?[]:{};return gk(a,t,s)}function ez(t,s){return yu(vk(t,s),s)}function U_(t){var s="",r=tz(t);return r&&(s=r(t).getPropertyValue("display")),s||(s=t.style&&t.style.display),s==="none"}function tz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function sz(t){var s=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Sr(s.replace(/<[^>]*>/g,""));return[r]}var R_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bk(t,s){var r=s||{},a=g1(t),n=[],i,l,o={name:""},u="",d=0,c,m,h={},f=[],x=r.dense?[]:{},g,b,y={value:""},N="",j=0,S=[],k=-1,P=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,q={},Q=[],O={},T=0,V=0,D=[],Y=1,M=1,X=[],R={Names:[]},H={},W=["",""],K=[],_={},F="",E=0,L=!1,U=!1,J=0;for(gf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=gf.exec(a);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?x["!ref"]=ir(I):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=I.e.r&&(x["!fullref"]=x["!ref"],I.e.r=r.sheetRows-1,x["!ref"]=ir(I)),Q.length&&(x["!merges"]=Q),D.length&&(x["!rows"]=D),c.name=c.||c.name,typeof JSON<"u"&&JSON.stringify(c),f.push(c.name),h[c.name]=x,U=!1):g[0].charAt(g[0].length-2)!=="/"&&(c=Js(g[0],!1),k=P=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,x=r.dense?[]:{},Q=[],D=[],U=!0);break;case"table-row-group":g[1]==="/"?--B:++B;break;case"table-row":case"":if(g[1]==="/"){k+=Y,Y=1;break}if(m=Js(g[0],!1),m.?k=m.-1:k==-1&&(k=0),Y=+m["number-rows-repeated"]||1,Y<10)for(J=0;J<Y;++J)B>0&&(D[k+J]={level:B});P=-1;break;case"covered-table-cell":g[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(x[k]||(x[k]=[]),x[k][P]={t:"z"}):x[Ys({r:k,c:P})]={t:"z"}),N="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++P,y=Js(g[0],!1),M=parseInt(y["number-columns-repeated"]||"1",10),b={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(b.f=I_(Sr(y.formula))),(y.||y["value-type"])=="string"&&(b.t="s",b.v=Sr(y["string-value"]||""),r.dense?(x[k]||(x[k]=[]),x[k][P]=b):x[Ys({r:k,c:P})]=b),P+=M-1;else if(g[1]!=="/"){++P,N="",j=0,S=[],M=1;var ae=Y?k+Y-1:k;if(P>I.e.c&&(I.e.c=P),P<I.s.c&&(I.s.c=P),k<I.s.r&&(I.s.r=k),ae>I.e.r&&(I.e.r=ae),y=Js(g[0],!1),K=[],_={},b={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Sr(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(T=parseInt(y["number-matrix-rows-spanned"],10)||0,V=parseInt(y["number-matrix-columns-spanned"],10)||0,O={s:{r:k,c:P},e:{r:k+T-1,c:P+V-1}},b.F=ir(O),X.push([O,b.F])),y.formula)b.f=I_(y.formula);else for(J=0;J<X.length;++J)k>=X[J][0].s.r&&k<=X[J][0].e.r&&P>=X[J][0].s.c&&P<=X[J][0].e.c&&(b.F=X[J][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(T=parseInt(y["number-rows-spanned"],10)||0,V=parseInt(y["number-columns-spanned"],10)||0,O={s:{r:k,c:P},e:{r:k+T-1,c:P+V-1}},Q.push(O)),y["number-columns-repeated"]&&(M=parseInt(y["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=da(y["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(y.value);break;case"percentage":b.t="n",b.v=parseFloat(y.value);break;case"currency":b.t="n",b.v=parseFloat(y.value);break;case"date":b.t="d",b.v=Aa(y["date-value"]),r.cellDates||(b.t="n",b.v=xn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=kQ(y["time-value"])/86400,r.cellDates&&(b.t="d",b.v=ig(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(y.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",y["string-value"]!=null&&(N=Sr(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(L=!1,b.t==="s"&&(b.v=N||"",S.length&&(b.R=S),L=j==0),H.Target&&(b.l=H),K.length>0&&(b.c=K,K=[]),N&&r.cellText!==!1&&(b.w=N),L&&(b.t="z",delete b.v),(!L||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var Z=0;Z<Y;++Z){if(M=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(x[k+Z]||(x[k+Z]=[]),x[k+Z][P]=Z==0?b:ha(b);--M>0;)x[k+Z][P+M]=ha(b);else for(x[Ys({r:k+Z,c:P})]=b;--M>0;)x[Ys({r:k+Z,c:P+M})]=ha(b);I.e.c<=P&&(I.e.c=P)}M=parseInt(y["number-columns-repeated"]||"1",10),P+=M-1,M=0,b={},N="",S=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i;_.t=N,S.length&&(_.R=S),_.a=F,K.push(_)}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);F="",E=0,N="",j=0,S=[];break;case"creator":g[1]==="/"?F=a.slice(E,g.index):E=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&n.push([g[3],!1]);N="",j=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(q[o.name]=u,(i=n.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(u="",o=Js(g[0],!1),n.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Js(g[0],!1),u+=R_[g[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Js(g[0],!1),u+=R_[g[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(d,g.index);break}else d=g.index+g[0].length;break;case"named-range":l=Js(g[0],!1),W=rb(l["cell-range-address"]);var oe={Name:l.name,Ref:W[0]+"!"+W[1]};U&&(oe.Sheet=f.length),R.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(g[1]==="/"&&(!y||!y["string-value"])){var ee=sz(a.slice(j,g.index));N=(N.length>0?N+`
`:"")+ee[0]}else Js(g[0],!1),j=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{W=rb(Js(g[0])["target-range-address"]),h[W[0]]["!autofilter"]={ref:W[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(H=Js(g[0],!1),!H.href)break;H.Target=Sr(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(W=rb(H.Target.slice(1)),H.Target="#"+W[0]+"!"+W[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var se={Sheets:h,SheetNames:f,Workbook:R};return r.bookSheets&&delete se.Sheets,se}function O_(t,s){s=s||{},Vl(t,"META-INF/manifest.xml")&&k7(an(t,"META-INF/manifest.xml"),s);var r=vl(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=bk(Xr(r),s);return Vl(t,"meta.xml")&&(a.Props=dB(an(t,"meta.xml"))),a}function Q_(t,s){return bk(t,s)}var rz=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),s="<office:document-styles "+xf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Za+s}})(),M_=(function(){var t=function(i){return Kr(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},s=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,o){var u=[];u.push('      <table:table table:name="'+Kr(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,c=0,m=rl(i["!ref"]||"A1"),h=i["!merges"]||[],f=0,x=Array.isArray(i);if(i["!cols"])for(c=0;c<=m.e.c;++c)u.push("        <table:table-column"+(i["!cols"][c]?' table:style-name="co'+i["!cols"][c].ods+'"':"")+`></table:table-column>
`);var g="",b=i["!rows"]||[];for(d=0;d<m.s.r;++d)g=b[d]?' table:style-name="ro'+b[d].ods+'"':"",u.push("        <table:table-row"+g+`></table:table-row>
`);for(;d<=m.e.r;++d){for(g=b[d]?' table:style-name="ro'+b[d].ods+'"':"",u.push("        <table:table-row"+g+`>
`),c=0;c<m.s.c;++c)u.push(s);for(;c<=m.e.c;++c){var y=!1,N={},j="";for(f=0;f!=h.length;++f)if(!(h[f].s.c>c)&&!(h[f].s.r>d)&&!(h[f].e.c<c)&&!(h[f].e.r<d)){(h[f].s.c!=c||h[f].s.r!=d)&&(y=!0),N["table:number-columns-spanned"]=h[f].e.c-h[f].s.c+1,N["table:number-rows-spanned"]=h[f].e.r-h[f].s.r+1;break}if(y){u.push(r);continue}var S=Ys({r:d,c}),k=x?(i[d]||[])[c]:i[S];if(k&&k.f&&(N["table:formula"]=Kr(N$(k.f)),k.F&&k.F.slice(0,S.length)==S)){var P=rl(k.F);N["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,N["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!k){u.push(s);continue}switch(k.t){case"b":j=k.v?"TRUE":"FALSE",N["office:value-type"]="boolean",N["office:boolean-value"]=k.v?"true":"false";break;case"n":j=k.w||String(k.v||0),N["office:value-type"]="float",N["office:value"]=k.v||0;break;case"s":case"str":j=k.v==null?"":k.v,N["office:value-type"]="string";break;case"d":j=k.w||Aa(k.v).toISOString(),N["office:value-type"]="date",N["office:date-value"]=Aa(k.v).toISOString(),N["table:style-name"]="ce1";break;default:u.push(s);continue}var I=t(j);if(k.l&&k.l.Target){var B=k.l.Target;B=B.charAt(0)=="#"?"#"+w$(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),I=xs("text:a",I,{"xlink:href":B.replace(/&/g,"&amp;")})}u.push("          "+xs("table:table-cell",xs("text:p",I,{}),N)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var c=0;c<d["!cols"].length;++c)if(d["!cols"][c]){var m=d["!cols"][c];if(m.width==null&&m.wpx==null&&m.wch==null)continue;mu(m),m.ods=o;var h=d["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++o}}});var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var c=0;c<d["!rows"].length;++c)if(d["!rows"][c]){d["!rows"][c].ods=u;var m=d["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var u=[Za],d=xf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=xf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+d+c+`>
`),u.push(cB().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+d+`>
`),n(u,l),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var m=0;m!=l.SheetNames.length;++m)u.push(a(l.Sheets[l.SheetNames[m]],l,m));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function yk(t,s){if(s.bookType=="fods")return M_(t,s);var r=m1(),a="",n=[],i=[];return a="mimetype",lr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",lr(r,a,M_(t,s)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",lr(r,a,rz(t,s)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",lr(r,a,Za+cB()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",lr(r,a,T7(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",lr(r,a,E7(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function jA(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ky(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Xr(bu(t))}function az(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):gl(lc(t))}function nz(t,s){e:for(var r=0;r<=t.length-s.length;++r){for(var a=0;a<s.length;++a)if(t[r+a]!=s[a])continue e;return!0}return!1}function pu(t){var s=t.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(s),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function H_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function iz(t,s){for(var r=(t[s+15]&127)<<7|t[s+14]>>1,a=t[s+14]&1,n=s+13;n>=s;--n)a=a*256+t[n];return(t[s+15]&128?-a:a)*Math.pow(10,r-6176)}function lz(t,s,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[s+15]|=a>>7,t[s+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)t[s+i]=n&255;t[s+15]|=r>=0?0:128}function _f(t,s){var r=s?s[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return s&&(s[0]=r),a}function Vr(t){var s=new Uint8Array(7);s[0]=t&127;var r=1;e:if(t>127){if(s[r-1]|=128,s[r]=t>>7&127,++r,t<=16383||(s[r-1]|=128,s[r]=t>>14&127,++r,t<=2097151)||(s[r-1]|=128,s[r]=t>>21&127,++r,t<=268435455)||(s[r-1]|=128,s[r]=t/256>>>21&127,++r,t<=34359738367)||(s[r-1]|=128,s[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;s[r-1]|=128,s[r]=t/16777216>>>21&127,++r}return s.slice(0,r)}function Ra(t){var s=0,r=t[s]&127;e:if(t[s++]>=128){if(r|=(t[s]&127)<<7,t[s++]<128||(r|=(t[s]&127)<<14,t[s++]<128)||(r|=(t[s]&127)<<21,t[s++]<128))break e;r|=(t[s]&127)<<28}return r}function Tr(t){for(var s=[],r=[0];r[0]<t.length;){var a=r[0],n=_f(t,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var u=r[0];t[r[0]++]>=128;);o=t.slice(u,r[0])}break;case 5:l=4,o=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=_f(t,r),o=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var d={data:o,type:i};s[n]==null?s[n]=[d]:s[n].push(d)}return s}function Qn(t){var s=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(s.push(Vr(a*8+n.type)),n.type==2&&s.push(Vr(n.data.length)),s.push(n.data))})}),pu(s)}function M1(t,s){return(t==null?void 0:t.map(function(r){return s(r.data)}))||[]}function Ml(t){for(var s,r=[],a=[0];a[0]<t.length;){var n=_f(t,a),i=Tr(t.slice(a[0],a[0]+n));a[0]+=n;var l={id:Ra(i[1][0].data),messages:[]};i[2].forEach(function(o){var u=Tr(o.data),d=Ra(u[3][0].data);l.messages.push({meta:u,data:t.slice(a[0],a[0]+d)}),a[0]+=d}),(s=i[3])!=null&&s[0]&&(l.merge=Ra(i[3][0].data)>>>0>0),r.push(l)}return r}function lh(t){var s=[];return t.forEach(function(r){var a=[];a[1]=[{data:Vr(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Vr(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:Vr(l.data.length)}],a[2].push({data:Qn(l.meta),type:2})});var i=Qn(a);s.push(Vr(i.length)),s.push(i),n.forEach(function(l){return s.push(l)})}),pu(s)}function oz(t,s){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=_f(s,r),n=[];r[0]<s.length;){var i=s[r[0]]&3;if(i==0){var l=s[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=s[r[0]],o>1&&(l|=s[r[0]+1]<<8),o>2&&(l|=s[r[0]+2]<<16),o>3&&(l|=s[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(s.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var u=0,d=0;if(i==1?(d=(s[r[0]]>>2&7)+4,u=(s[r[0]++]&224)<<3,u|=s[r[0]++]):(d=(s[r[0]++]>>2)+1,i==2?(u=s[r[0]]|s[r[0]+1]<<8,r[0]+=2):(u=(s[r[0]]|s[r[0]+1]<<8|s[r[0]+2]<<16|s[r[0]+3]<<24)>>>0,r[0]+=4)),n=[pu(n)],u==0)throw new Error("Invalid offset 0");if(u>n[0].length)throw new Error("Invalid offset beyond length");if(d>=u)for(n.push(n[0].slice(-u)),d-=u;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-u,-u+d))}}var c=pu(n);if(c.length!=a)throw new Error("Unexpected length: ".concat(c.length," != ").concat(a));return c}function Hl(t){for(var s=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,s.push(oz(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return pu(s)}function oh(t){for(var s=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);s.push(n);var i=Vr(a),l=i.length;s.push(i),a<=60?(l++,s.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,s.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,s.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,s.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,s.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),s.push(t.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return pu(s)}function cz(t,s,r,a){var n=jA(t),i=n.getUint32(4,!0),l=(a>1?12:8)+H_(i&(a>1?3470:398))*4,o=-1,u=-1,d=NaN,c=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=H_(i&(a>1?12288:4096))*4,i&16&&(u=n.getUint32(l,!0),l+=4),i&32&&(d=n.getFloat64(l,!0),l+=8),i&64&&(c.setTime(c.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var m;switch(t[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:s[u]};break;case 5:m={t:"d",v:c};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(o>-1)m={t:"s",v:r[o]};else if(u>-1)m={t:"s",v:s[u]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return m}function dz(t,s,r){var a=jA(t),n=a.getUint32(8,!0),i=12,l=-1,o=-1,u=NaN,d=NaN,c=new Date(2001,0,1);n&1&&(u=iz(t,i),i+=16),n&2&&(d=a.getFloat64(i,!0),i+=8),n&4&&(c.setTime(c.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(l=a.getUint32(i,!0),i+=4);var m;switch(t[1]){case 0:break;case 2:m={t:"n",v:u};break;case 3:m={t:"s",v:s[o]};break;case 5:m={t:"d",v:c};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:m={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return m}function nb(t,s){var r=new Uint8Array(32),a=jA(r),n=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,lz(r,n,t.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),i|=2,n+=8;break;case"s":if(s.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,s.indexOf(t.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,i,!0),r.slice(0,n)}function ib(t,s){var r=new Uint8Array(32),a=jA(r),n=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),i|=32,n+=8;break;case"s":if(s.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,s.indexOf(t.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,i,!0),r.slice(0,n)}function uz(t,s,r){switch(t[0]){case 0:case 1:case 2:case 3:return cz(t,s,r,t[0]);case 5:return dz(t,s,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ui(t){var s=Tr(t);return _f(s[1][0].data)}function q_(t,s){var r=Tr(s.data),a=Ra(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=Tr(l.data),u=Ra(o[1][0].data)>>>0;switch(a){case 1:i[u]=ky(o[3][0].data);break;case 8:{var d=t[ui(o[9][0].data)][0],c=Tr(d.data),m=t[ui(c[1][0].data)][0],h=Ra(m.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var f=Tr(m.data);i[u]=f[3].map(function(x){return ky(x.data)}).join("")}break}}),i}function Az(t,s){var r,a,n,i,l,o,u,d,c,m,h,f,x,g,b=Tr(t),y=Ra(b[1][0].data)>>>0,N=Ra(b[2][0].data)>>>0,j=((a=(r=b[8])==null?void 0:r[0])==null?void 0:a.data)&&Ra(b[8][0].data)>0||!1,S,k;if((i=(n=b[7])==null?void 0:n[0])!=null&&i.data&&s!=0)S=(o=(l=b[7])==null?void 0:l[0])==null?void 0:o.data,k=(d=(u=b[6])==null?void 0:u[0])==null?void 0:d.data;else if((m=(c=b[4])==null?void 0:c[0])!=null&&m.data&&s!=1)S=(f=(h=b[4])==null?void 0:h[0])==null?void 0:f.data,k=(g=(x=b[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(s," cell storage");for(var P=j?4:1,I=jA(S),B=[],q=0;q<S.length/2;++q){var Q=I.getUint16(q*2,!0);Q<65535&&B.push([q,Q])}if(B.length!=N)throw"Expected ".concat(N," cells, found ").concat(B.length);var O=[];for(q=0;q<B.length-1;++q)O[B[q][0]]=k.subarray(B[q][1]*P,B[q+1][1]*P);return B.length>=1&&(O[B[B.length-1][0]]=k.subarray(B[B.length-1][1]*P)),{R:y,cells:O}}function hz(t,s){var r,a=Tr(s.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?Ra(a[7][0].data)>>>0>0?1:0:-1,i=M1(a[5],function(l){return Az(l,n)});return{nrows:Ra(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(u,d){if(l[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));l[o.R][d]=u}),l},[])}}function mz(t,s,r){var a,n=Tr(s.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ra(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(Ra(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=ir(i);var l=Tr(n[4][0].data),o=q_(t,t[ui(l[4][0].data)][0]),u=(a=l[17])!=null&&a[0]?q_(t,t[ui(l[17][0].data)][0]):[],d=Tr(l[3][0].data),c=0;d[1].forEach(function(m){var h=Tr(m.data),f=t[ui(h[2][0].data)][0],x=Ra(f.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=hz(t,f);g.data.forEach(function(b,y){b.forEach(function(N,j){var S=Ys({r:c+y,c:j}),k=uz(N,o,u);k&&(r[S]=k)})}),c+=g.nrows})}function fz(t,s){var r=Tr(s.data),a={"!ref":"A1"},n=t[ui(r[2][0].data)],i=Ra(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return mz(t,n[0],a),a}function pz(t,s){var r,a=Tr(s.data),n={name:(r=a[1])!=null&&r[0]?ky(a[1][0].data):"",sheets:[]},i=M1(a[2],ui);return i.forEach(function(l){t[l].forEach(function(o){var u=Ra(o.meta[1][0].data);u==6e3&&n.sheets.push(fz(t,o))})}),n}function xz(t,s){var r=W1(),a=Tr(s.data),n=M1(a[1],ui);if(n.forEach(function(i){t[i].forEach(function(l){var o=Ra(l.meta[1][0].data);if(o==2){var u=pz(t,l);u.sheets.forEach(function(d,c){G1(r,d,c==0?u.name:u.name+"_"+c,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function lb(t){var s,r,a,n,i={},l=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var d;try{d=Hl(u.content)}catch(m){return console.log("?? "+u.content.length+" "+(m.message||m))}var c;try{c=Ml(d)}catch(m){return console.log("## "+(m.message||m))}c.forEach(function(m){i[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(a=(r=(s=i==null?void 0:i[1])==null?void 0:s[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&Ra(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(u){i[u].forEach(function(d){var c=Ra(d.meta[1][0].data)>>>0;if(c==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return xz(i,o)}function gz(t,s,r){var a,n,i,l;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=t[8])==null?void 0:i[0])==null?void 0:l.data)&&Ra(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,d=jA(t[7][0].data),c=0,m=[],h=jA(t[4][0].data),f=0,x=[],g=0;g<s.length;++g){if(s[g]==null){d.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}d.setUint16(g*2,c,!0),h.setUint16(g*2,f,!0);var b,y;switch(typeof s[g]){case"string":b=nb({t:"s",v:s[g]},r),y=ib({t:"s",v:s[g]},r);break;case"number":b=nb({t:"n",v:s[g]},r),y=ib({t:"n",v:s[g]},r);break;case"boolean":b=nb({t:"b",v:s[g]},r),y=ib({t:"b",v:s[g]},r);break;default:throw new Error("Unsupported value "+s[g])}m.push(b),c+=b.length,x.push(y),f+=y.length,++u}for(t[2][0].data=Vr(u);g<t[7][0].data.length/2;++g)d.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return t[6][0].data=pu(m),t[3][0].data=pu(x),u}function vz(t,s){if(!s||!s.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=rl(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(ir(a)));var i=v0(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(F){return F.forEach(function(E){typeof E=="string"&&l.push(E)})});var o={},u=[],d=Qs.read(s.numbers,{type:"base64"});d.FileIndex.map(function(F,E){return[F,d.FullPaths[E]]}).forEach(function(F){var E=F[0],L=F[1];if(E.type==2&&E.name.match(/\.iwa/)){var U=E.content,J=Hl(U),ae=Ml(J);ae.forEach(function(Z){u.push(Z.id),o[Z.id]={deps:[],location:L,type:Ra(Z.messages[0].meta[1][0].data)}})}}),u.sort(function(F,E){return F-E});var c=u.filter(function(F){return F>1}).map(function(F){return[F,Vr(F)]});d.FileIndex.map(function(F,E){return[F,d.FullPaths[E]]}).forEach(function(F){var E=F[0];if(F[1],!!E.name.match(/\.iwa/)){var L=Ml(Hl(E.content));L.forEach(function(U){U.messages.forEach(function(J){c.forEach(function(ae){U.messages.some(function(Z){return Ra(Z.meta[1][0].data)!=11006&&nz(Z.data,ae[1])})&&o[ae[0]].deps.push(U.id)})})})}});for(var m=Qs.find(d,o[1].location),h=Ml(Hl(m.content)),f,x=0;x<h.length;++x){var g=h[x];g.id==1&&(f=g)}var b=ui(Tr(f.messages[0].data)[1][0].data);for(m=Qs.find(d,o[b].location),h=Ml(Hl(m.content)),x=0;x<h.length;++x)g=h[x],g.id==b&&(f=g);for(b=ui(Tr(f.messages[0].data)[2][0].data),m=Qs.find(d,o[b].location),h=Ml(Hl(m.content)),x=0;x<h.length;++x)g=h[x],g.id==b&&(f=g);for(b=ui(Tr(f.messages[0].data)[2][0].data),m=Qs.find(d,o[b].location),h=Ml(Hl(m.content)),x=0;x<h.length;++x)g=h[x],g.id==b&&(f=g);var y=Tr(f.messages[0].data);{y[6][0].data=Vr(a.e.r+1),y[7][0].data=Vr(a.e.c+1);var N=ui(y[46][0].data),j=Qs.find(d,o[N].location),S=Ml(Hl(j.content));{for(var k=0;k<S.length&&S[k].id!=N;++k);if(S[k].id!=N)throw"Bad ColumnRowUIDMapArchive";var P=Tr(S[k].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var I=0;I<=a.e.c;++I){var B=[];B[1]=B[2]=[{type:0,data:Vr(I+420690)}],P[1].push({type:2,data:Qn(B)}),P[2].push({type:0,data:Vr(I)}),P[3].push({type:0,data:Vr(I)})}P[4]=[],P[5]=[],P[6]=[];for(var q=0;q<=a.e.r;++q)B=[],B[1]=B[2]=[{type:0,data:Vr(q+726270)}],P[4].push({type:2,data:Qn(B)}),P[5].push({type:0,data:Vr(q)}),P[6].push({type:0,data:Vr(q)});S[k].messages[0].data=Qn(P)}j.content=oh(lh(S)),j.size=j.content.length,delete y[46];var Q=Tr(y[4][0].data);{Q[7][0].data=Vr(a.e.r+1);var O=Tr(Q[1][0].data),T=ui(O[2][0].data);j=Qs.find(d,o[T].location),S=Ml(Hl(j.content));{if(S[0].id!=T)throw"Bad HeaderStorageBucket";var V=Tr(S[0].messages[0].data);for(q=0;q<i.length;++q){var D=Tr(V[2][0].data);D[1][0].data=Vr(q),D[4][0].data=Vr(i[q].length),V[2][q]={type:V[2][0].type,data:Qn(D)}}S[0].messages[0].data=Qn(V)}j.content=oh(lh(S)),j.size=j.content.length;var Y=ui(Q[2][0].data);j=Qs.find(d,o[Y].location),S=Ml(Hl(j.content));{if(S[0].id!=Y)throw"Bad HeaderStorageBucket";for(V=Tr(S[0].messages[0].data),I=0;I<=a.e.c;++I)D=Tr(V[2][0].data),D[1][0].data=Vr(I),D[4][0].data=Vr(a.e.r+1),V[2][I]={type:V[2][0].type,data:Qn(D)};S[0].messages[0].data=Qn(V)}j.content=oh(lh(S)),j.size=j.content.length;var M=ui(Q[4][0].data);(function(){for(var F=Qs.find(d,o[M].location),E=Ml(Hl(F.content)),L,U=0;U<E.length;++U){var J=E[U];J.id==M&&(L=J)}var ae=Tr(L.messages[0].data);{ae[3]=[];var Z=[];l.forEach(function(se,Ae){Z[1]=[{type:0,data:Vr(Ae)}],Z[2]=[{type:0,data:Vr(1)}],Z[3]=[{type:2,data:az(se)}],ae[3].push({type:2,data:Qn(Z)})})}L.messages[0].data=Qn(ae);var oe=lh(E),ee=oh(oe);F.content=ee,F.size=F.content.length})();var X=Tr(Q[3][0].data);{var R=X[1][0];delete X[2];var H=Tr(R.data);{var W=ui(H[2][0].data);(function(){for(var F=Qs.find(d,o[W].location),E=Ml(Hl(F.content)),L,U=0;U<E.length;++U){var J=E[U];J.id==W&&(L=J)}var ae=Tr(L.messages[0].data);{delete ae[6],delete X[7];var Z=new Uint8Array(ae[5][0].data);ae[5]=[];for(var oe=0,ee=0;ee<=a.e.r;++ee){var se=Tr(Z);oe+=gz(se,i[ee],l),se[1][0].data=Vr(ee),ae[5].push({data:Qn(se),type:2})}ae[1]=[{type:0,data:Vr(a.e.c+1)}],ae[2]=[{type:0,data:Vr(a.e.r+1)}],ae[3]=[{type:0,data:Vr(oe)}],ae[4]=[{type:0,data:Vr(a.e.r+1)}]}L.messages[0].data=Qn(ae);var Ae=lh(E),we=oh(Ae);F.content=we,F.size=F.content.length})()}R.data=Qn(H)}Q[3][0].data=Qn(X)}y[4][0].data=Qn(Q)}f.messages[0].data=Qn(y);var K=lh(h),_=oh(K);return m.content=_,m.size=m.content.length,d}function jk(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function H1(t){jk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function q1(t){jk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function bz(t){return ur.WS.indexOf(t)>-1?"sheet":t==ur.CS?"chart":t==ur.DS?"dialog":t==ur.MS?"macro":t&&t.length?t:"sheet"}function yz(t,s){if(!t)return 0;try{t=s.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,bz(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function jz(t,s,r,a,n,i,l,o,u,d,c,m){try{i[a]=Ym(vl(t,r,!0),s);var h=an(t,s),f;switch(o){case"sheet":f=VG(h,s,n,u,i[a],d,c,m);break;case"chart":if(f=$G(h,s,n,u,i[a],d,c,m),!f||!f["!drawel"])break;var x=Pm(f["!drawel"].Target,s),g=vf(x),b=Fq(vl(t,x,!0),Ym(vl(t,g,!0),x)),y=Pm(b,x),N=vf(y);f=gG(vl(t,y,!0),y,u,Ym(vl(t,N,!0),y),d,f);break;case"macro":f=WG(h,s,n,u,i[a],d,c,m);break;case"dialog":f=GG(h,s,n,u,i[a],d,c,m);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=f;var j=[];i&&i[a]&&Oa(i[a]).forEach(function(S){var k="";if(i[a][S].Type==ur.CMNT){k=Pm(i[a][S].Target,s);var P=XG(an(t,k,!0),k,u);if(!P||!P.length)return;B_(f,P,!1)}i[a][S].Type==ur.TCMNT&&(k=Pm(i[a][S].Target,s),j=j.concat(Iq(an(t,k,!0),u)))}),j&&j.length&&B_(f,j,!0,u.people||[])}catch(S){if(u.WTF)throw S}}function Ol(t){return t.charAt(0)=="/"?t.slice(1):t}function Nz(t,s){if($h(),s=s||{},H1(s),Vl(t,"META-INF/manifest.xml")||Vl(t,"objectdata.xml"))return O_(t,s);if(Vl(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof lb<"u"){if(t.FileIndex)return lb(t);var r=Qs.utils.cfb_new();return z2(t).forEach(function(D){lr(r,D,LQ(t,D))}),lb(r)}throw new Error("Unsupported NUMBERS file")}if(!Vl(t,"[Content_Types].xml"))throw Vl(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vl(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=z2(t),n=C7(vl(t,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",an(t,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!an(t,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},d={};if(!s.bookSheets&&!s.bookProps){if(Xm=[],n.sst)try{Xm=YG(an(t,Ol(n.sst)),n.sst,s)}catch(D){if(s.WTF)throw D}s.cellStyles&&n.themes.length&&(u=zG(vl(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],s)),n.style&&(d=KG(an(t,Ol(n.style)),n.style,u,s))}n.links.map(function(D){try{var Y=Ym(vl(t,vf(Ol(D))),D);return ZG(an(t,Ol(D)),Y,D,s)}catch{}});var c=qG(an(t,Ol(n.workbooks[0])),n.workbooks[0],s),m={},h="";n.coreprops.length&&(h=an(t,Ol(n.coreprops[0]),!0),h&&(m=dB(h)),n.extprops.length!==0&&(h=an(t,Ol(n.extprops[0]),!0),h&&L7(h,m,s)));var f={};(!s.bookSheets||s.bookProps)&&n.custprops.length!==0&&(h=vl(t,Ol(n.custprops[0]),!0),h&&(f=P7(h,s)));var x={};if((s.bookSheets||s.bookProps)&&(c.Sheets?l=c.Sheets.map(function(Y){return Y.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),s.bookProps&&(x.Props=m,x.Custprops=f),s.bookSheets&&typeof l<"u"&&(x.SheetNames=l),s.bookSheets?x.SheetNames:s.bookProps))return x;l={};var g={};s.bookDeps&&n.calcchain&&(g=JG(an(t,Ol(n.calcchain)),n.calcchain));var b=0,y={},N,j;{var S=c.Sheets;m.Worksheets=S.length,m.SheetNames=[];for(var k=0;k!=S.length;++k)m.SheetNames[k]=S[k].name}var P=i?"bin":"xml",I=n.workbooks[0].lastIndexOf("/"),B=(n.workbooks[0].slice(0,I+1)+"_rels/"+n.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");Vl(t,B)||(B="xl/_rels/workbook."+P+".rels");var q=Ym(vl(t,B,!0),B.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(s.xlmeta=eK(an(t,Ol(n.metadata[0])),n.metadata[0],s)),(n.people||[]).length>=1&&(s.people=Dq(an(t,Ol(n.people[0])),s)),q&&(q=yz(q,c.Sheets));var Q=an(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=m.Worksheets;++b){var O="sheet";if(q&&q[b]?(N="xl/"+q[b][1].replace(/[\/]?xl\//,""),Vl(t,N)||(N=q[b][1]),Vl(t,N)||(N=B.replace(/_rels\/.*$/,"")+q[b][1]),O=q[b][2]):(N="xl/worksheets/sheet"+(b+1-Q)+"."+P,N=N.replace(/sheet0\./,"sheet.")),j=N.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),s&&s.sheets!=null)switch(typeof s.sheets){case"number":if(b!=s.sheets)continue e;break;case"string":if(m.SheetNames[b].toLowerCase()!=s.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(s.sheets)){for(var T=!1,V=0;V!=s.sheets.length;++V)typeof s.sheets[V]=="number"&&s.sheets[V]==b&&(T=1),typeof s.sheets[V]=="string"&&s.sheets[V].toLowerCase()==m.SheetNames[b].toLowerCase()&&(T=1);if(!T)continue e}}jz(t,N,j,m.SheetNames[b],b,y,l,O,s,c,u,d)}return x={Directory:n,Workbook:c,Props:m,Custprops:f,Deps:g,Sheets:l,SheetNames:m.SheetNames,Strings:Xm,Styles:d,Themes:u,SSF:ha(Ws)},s&&s.bookFiles&&(t.files?(x.keys=a,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(D,Y){D=D.replace(/^Root Entry[\/]/,""),x.keys.push(D),x.files[D]=t.FileIndex[Y]}))),s&&s.bookVBA&&(n.vba.length>0?x.vbaraw=an(t,Ol(n.vba[0]),!0):n.defaults&&n.defaults.bin===qq&&(x.vbaraw=an(t,"xl/vbaProject.bin",!0))),x}function wz(t,s){var r=s||{},a="Workbook",n=Qs.find(t,a);try{if(a="/!DataSpaces/Version",n=Qs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(e9(n.content),a="/!DataSpaces/DataSpaceMap",n=Qs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=s9(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Qs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=r9(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Qs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);n9(n.content)}catch{}if(a="/EncryptionInfo",n=Qs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=i9(n.content);if(a="/EncryptedPackage",n=Qs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function _z(t,s){return s.bookType=="ods"?yk(t,s):s.bookType=="numbers"?vz(t,s):s.bookType=="xlsb"?Sz(t,s):Cz(t,s)}function Sz(t,s){gh=1024,t&&!t.SSF&&(t.SSF=ha(Ws)),t&&t.SSF&&($h(),rg(t.SSF),s.revssf=ng(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,Jm?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var r=s.bookType=="xlsb"?"bin":"xml",a=zB.indexOf(s.bookType)>-1,n=B1();q1(s=s||{});var i=m1(),l="",o=0;if(s.cellXfs=[],ju(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",lr(i,l,uB(t.Props,s)),n.coreprops.push(l),Wr(s.rels,2,l,ur.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&u.push(t.SheetNames[d]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,lr(i,l,mB(t.Props)),n.extprops.push(l),Wr(s.rels,3,l,ur.EXT_PROPS),t.Custprops!==t.Props&&Oa(t.Custprops||{}).length>0&&(l="docProps/custom.xml",lr(i,l,fB(t.Custprops)),n.custprops.push(l),Wr(s.rels,4,l,ur.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var c={"!id":{}},m=t.Sheets[t.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,lr(i,l,sK(o-1,l,s,t,c)),n.sheets.push(l),Wr(s.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(m){var f=m["!comments"],x=!1,g="";f&&f.length>0&&(g="xl/comments"+o+"."+r,lr(i,g,nK(f,g)),n.comments.push(g),Wr(c,-1,"../comments"+o+"."+r,ur.CMNT),x=!0),m["!legacy"]&&x&&lr(i,"xl/drawings/vmlDrawing"+o+".vml",GB(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}c["!id"].rId1&&lr(i,vf(l),Sh(c))}return s.Strings!=null&&s.Strings.length>0&&(l="xl/sharedStrings."+r,lr(i,l,aK(s.Strings,l,s)),n.strs.push(l),Wr(s.wbrels,-1,"sharedStrings."+r,ur.SST)),l="xl/workbook."+r,lr(i,l,tK(t,l)),n.workbooks.push(l),Wr(s.rels,1,l,ur.WB),l="xl/theme/theme1.xml",lr(i,l,L1(t.Themes,s)),n.themes.push(l),Wr(s.wbrels,-1,"theme/theme1.xml",ur.THEME),l="xl/styles."+r,lr(i,l,rK(t,l,s)),n.styles.push(l),Wr(s.wbrels,-1,"styles."+r,ur.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",lr(i,l,t.vbaraw),n.vba.push(l),Wr(s.wbrels,-1,"vbaProject.bin",ur.VBA)),l="xl/metadata."+r,lr(i,l,iK(l)),n.metadata.push(l),Wr(s.wbrels,-1,"metadata."+r,ur.XLMETA),lr(i,"[Content_Types].xml",oB(n,s)),lr(i,"_rels/.rels",Sh(s.rels)),lr(i,"xl/_rels/workbook."+r+".rels",Sh(s.wbrels)),delete s.revssf,delete s.ssf,i}function Cz(t,s){gh=1024,t&&!t.SSF&&(t.SSF=ha(Ws)),t&&t.SSF&&($h(),rg(t.SSF),s.revssf=ng(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,Jm?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var r="xml",a=zB.indexOf(s.bookType)>-1,n=B1();q1(s=s||{});var i=m1(),l="",o=0;if(s.cellXfs=[],ju(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",lr(i,l,uB(t.Props,s)),n.coreprops.push(l),Wr(s.rels,2,l,ur.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&u.push(t.SheetNames[d]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,lr(i,l,mB(t.Props)),n.extprops.push(l),Wr(s.rels,3,l,ur.EXT_PROPS),t.Custprops!==t.Props&&Oa(t.Custprops||{}).length>0&&(l="docProps/custom.xml",lr(i,l,fB(t.Custprops)),n.custprops.push(l),Wr(s.rels,4,l,ur.CUST_PROPS));var c=["SheetJ5"];for(s.tcid=0,o=1;o<=t.SheetNames.length;++o){var m={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,lr(i,l,ik(o-1,s,t,m)),n.sheets.push(l),Wr(s.wbrels,-1,"worksheets/sheet"+o+"."+r,ur.WS[0])}if(h){var x=h["!comments"],g=!1,b="";if(x&&x.length>0){var y=!1;x.forEach(function(N){N[1].forEach(function(j){j.T==!0&&(y=!0)})}),y&&(b="xl/threadedComments/threadedComment"+o+"."+r,lr(i,b,Lq(x,c,s)),n.threadedcomments.push(b),Wr(m,-1,"../threadedComments/threadedComment"+o+"."+r,ur.TCMNT)),b="xl/comments"+o+"."+r,lr(i,b,KB(x)),n.comments.push(b),Wr(m,-1,"../comments"+o+"."+r,ur.CMNT),g=!0}h["!legacy"]&&g&&lr(i,"xl/drawings/vmlDrawing"+o+".vml",GB(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}m["!id"].rId1&&lr(i,vf(l),Sh(m))}return s.Strings!=null&&s.Strings.length>0&&(l="xl/sharedStrings."+r,lr(i,l,DB(s.Strings,s)),n.strs.push(l),Wr(s.wbrels,-1,"sharedStrings."+r,ur.SST)),l="xl/workbook."+r,lr(i,l,uk(t)),n.workbooks.push(l),Wr(s.rels,1,l,ur.WB),l="xl/theme/theme1.xml",lr(i,l,L1(t.Themes,s)),n.themes.push(l),Wr(s.wbrels,-1,"theme/theme1.xml",ur.THEME),l="xl/styles."+r,lr(i,l,qB(t,s)),n.styles.push(l),Wr(s.wbrels,-1,"styles."+r,ur.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",lr(i,l,t.vbaraw),n.vba.push(l),Wr(s.wbrels,-1,"vbaProject.bin",ur.VBA)),l="xl/metadata."+r,lr(i,l,WB()),n.metadata.push(l),Wr(s.wbrels,-1,"metadata."+r,ur.XLMETA),c.length>1&&(l="xl/persons/person.xml",lr(i,l,Pq(c)),n.people.push(l),Wr(s.wbrels,-1,"persons/person.xml",ur.PEOPLE)),lr(i,"[Content_Types].xml",oB(n,s)),lr(i,"_rels/.rels",Sh(s.rels)),lr(i,"xl/_rels/workbook."+r+".rels",Sh(s.wbrels)),delete s.revssf,delete s.ssf,i}function V1(t,s){var r="";switch((s||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=wl(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(s&&s.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Bz(t,s){return Qs.find(t,"EncryptedPackage")?wz(t,s):fk(t,s)}function kz(t,s){var r,a=t,n=s||{};return n.type||(n.type=or&&Buffer.isBuffer(t)?"buffer":"base64"),r=U4(a,n),Nz(r,n)}function Nk(t,s){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Cy(t.slice(r),s);default:break e}return Dh.to_workbook(t,s)}function Ez(t,s){var r="",a=V1(t,s);switch(s.type){case"base64":r=wl(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=gA(t);break;default:throw new Error("Unrecognized type "+s.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Xr(r)),s.type="binary",Nk(r,s)}function Fz(t,s){var r=t;return s.type=="base64"&&(r=wl(r)),r=hf.utils.decode(1200,r.slice(2),"str"),s.type="binary",Nk(r,s)}function Tz(t){return t.match(/[^\x00-\x7F]/)?lc(t):t}function ob(t,s,r,a){return a?(r.type="string",Dh.to_workbook(t,r)):Dh.to_workbook(s,r)}function g0(t,s){c1();var r=s||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return g0(new Uint8Array(t),(r=ha(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Bh={},r.dateNF&&(Bh.dateNF=r.dateNF),r.type||(r.type=or&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=or?"buffer":"binary",a=SQ(t),typeof Uint8Array<"u"&&!or&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=Tz(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=ha(r),r.type="array",g0(d1(a),r)}switch((n=V1(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Bz(Qs.read(a,r),r);break;case 9:if(n[1]<=8)return fk(a,r);break;case 60:return Cy(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return UH(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return IB.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?kz(a,r):ob(t,a,r,i);case 239:return n[3]===60?Cy(a,r):ob(t,a,r,i);case 255:if(n[1]===254)return Fz(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return hA.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return hA.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Sy.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return QB.to_workbook(a,r);break;case 10:case 13:case 32:return Ez(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return PH.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Sy.to_workbook(a,r):ob(t,a,r,i)}function wk(t,s){switch(s.type){case"base64":case"binary":break;case"buffer":case"array":s.type="";break;case"file":return Uf(s.file,Qs.write(t,{type:or?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");default:throw new Error("Unrecognized type "+s.type)}return Qs.write(t,s)}function Iz(t,s){var r=ha(s||{}),a=_z(t,r);return Lz(a,r)}function Lz(t,s){var r={},a=or?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(s.compression&&(r.compression="DEFLATE"),s.password)r.type=a;else switch(s.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+s.type)}var n=t.FullPaths?Qs.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!s.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(s.type=="binary"||s.type=="base64")return n;n=new Uint8Array(sg(n))}return s.password&&typeof encrypt_agile<"u"?wk(encrypt_agile(n,s.password),s):s.type==="file"?Uf(s.file,n):s.type=="string"?Xr(n):n}function Dz(t,s){var r=s||{},a=TK(t,r);return wk(a,r)}function ac(t,s,r){r||(r="");var a=r+t;switch(s.type){case"base64":return mf(lc(a));case"binary":return lc(a);case"string":return t;case"file":return Uf(s.file,a,"utf8");case"buffer":return or?nd(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ac(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function Pz(t,s){switch(s.type){case"base64":return mf(t);case"binary":return t;case"string":return t;case"file":return Uf(s.file,t,"binary");case"buffer":return or?nd(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function px(t,s){switch(s.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return s.type=="base64"?mf(r):s.type=="string"?Xr(r):r;case"file":return Uf(s.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+s.type)}}function _k(t,s){c1(),BG(t);var r=ha(s||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=_k(t,r);return r.type="array",sg(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ac(_K(t,r),r);case"slk":case"sylk":return ac(TB.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return ac(xk(t.Sheets[t.SheetNames[n]],r),r);case"txt":return Pz(Sk(t.Sheets[t.SheetNames[n]],r),r);case"csv":return ac($1(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return ac(IB.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return px(Sy.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return ac(Dh.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return ac(QB.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return ac(LB.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return ac(yk(t,r),r);case"wk1":return px(hA.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return px(hA.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),px(pk(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Dz(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Iz(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Uz(t){if(!t.bookType){var s={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=s[t.bookType]||t.bookType}}function Br(t,s,r){var a={};return a.type="file",a.file=s,Uz(a),_k(t,a)}function Rz(t,s,r,a,n,i,l,o){var u=Xa(r),d=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),m=!0,h=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!l||t[r])for(var f=s.s.c;f<=s.e.c;++f){var x=l?t[r][f]:t[a[f]+u];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[f]!=null&&(h[i[f]]=d);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[f]!=null){if(g==null)if(x.t=="e"&&g===null)h[i[f]]=null;else if(d!==void 0)h[i[f]]=d;else if(c&&g===null)h[i[f]]=null;else continue;else h[i[f]]=c&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:sd(x,g,o);g!=null&&(m=!1)}}return{row:h,isempty:m}}function v0(t,s){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],l=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},d=s||{},c=d.range!=null?d.range:t["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof c){case"string":u=Cr(c);break;case"number":u=Cr(t["!ref"]),u.s.r=c;break;default:u=c}a>0&&(n=0);var m=Xa(u.s.r),h=[],f=[],x=0,g=0,b=Array.isArray(t),y=u.s.r,N=0,j={};b&&!t[y]&&(t[y]=[]);var S=d.skipHidden&&t["!cols"]||[],k=d.skipHidden&&t["!rows"]||[];for(N=u.s.c;N<=u.e.c;++N)if(!(S[N]||{}).hidden)switch(h[N]=_a(N),r=b?t[y][N]:t[h[N]+m],a){case 1:i[N]=N-u.s.c;break;case 2:i[N]=h[N];break;case 3:i[N]=d.header[N-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=sd(r,null,d),g=j[l]||0,!g)j[l]=1;else{do o=l+"_"+g++;while(j[o]);j[l]=g,j[o]=1}i[N]=o}for(y=u.s.r+n;y<=u.e.r;++y)if(!(k[y]||{}).hidden){var P=Rz(t,u,y,h,a,i,b,d);(P.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(f[x++]=P.row)}return f.length=x,f}var V_=/"/g;function Oz(t,s,r,a,n,i,l,o){for(var u=!0,d=[],c="",m=Xa(r),h=s.s.c;h<=s.e.c;++h)if(a[h]){var f=o.dense?(t[r]||[])[h]:t[a[h]+m];if(f==null)c="";else if(f.v!=null){u=!1,c=""+(o.rawNumbers&&f.t=="n"?f.v:sd(f,null,o));for(var x=0,g=0;x!==c.length;++x)if((g=c.charCodeAt(x))===n||g===i||g===34||o.forceQuotes){c='"'+c.replace(V_,'""')+'"';break}c=="ID"&&(c='"ID"')}else f.f!=null&&!f.F?(u=!1,c="="+f.f,c.indexOf(",")>=0&&(c='"'+c.replace(V_,'""')+'"')):c="";d.push(c)}return o.blankrows===!1&&u?null:d.join(l)}function $1(t,s){var r=[],a=s??{};if(t==null||t["!ref"]==null)return"";var n=Cr(t["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,u=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),c="",m=[];a.dense=Array.isArray(t);for(var h=a.skipHidden&&t["!cols"]||[],f=a.skipHidden&&t["!rows"]||[],x=n.s.c;x<=n.e.c;++x)(h[x]||{}).hidden||(m[x]=_a(x));for(var g=0,b=n.s.r;b<=n.e.r;++b)(f[b]||{}).hidden||(c=Oz(t,n,b,m,l,u,i,a),c!=null&&(a.strip&&(c=c.replace(d,"")),(c||a.blankrows!==!1)&&r.push((g++?o:"")+c)));return delete a.dense,r.join("")}function Sk(t,s){s||(s={}),s.FS="	",s.RS=`
`;var r=$1(t,s);return r}function Qz(t){var s="",r,a="";if(t==null||t["!ref"]==null)return[];var n=Cr(t["!ref"]),i="",l=[],o,u=[],d=Array.isArray(t);for(o=n.s.c;o<=n.e.c;++o)l[o]=_a(o);for(var c=n.s.r;c<=n.e.r;++c)for(i=Xa(c),o=n.s.c;o<=n.e.c;++o)if(s=l[o]+i,r=d?(t[c]||[])[o]:t[s],a="",r!==void 0){if(r.F!=null){if(s=r.F,!r.f)continue;a=r.f,s.indexOf(":")==-1&&(s=s+":"+s)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}u[u.length]=s+"="+a}return u}function Ck(t,s,r){var a=r||{},n=+!a.skipHeader,i=t||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var u=typeof a.origin=="string"?Sa(a.origin):a.origin;l=u.r,o=u.c}var d,c={s:{c:0,r:0},e:{c:o,r:l+s.length-1+n}};if(i["!ref"]){var m=Cr(i["!ref"]);c.e.c=Math.max(c.e.c,m.e.c),c.e.r=Math.max(c.e.r,m.e.r),l==-1&&(l=m.e.r+1,c.e.r=l+s.length-1+n)}else l==-1&&(l=0,c.e.r=s.length-1+n);var h=a.header||[],f=0;s.forEach(function(g,b){Oa(g).forEach(function(y){(f=h.indexOf(y))==-1&&(h[f=h.length]=y);var N=g[y],j="z",S="",k=Ys({c:o+f,r:l+b+n});d=Sf(i,k),N&&typeof N=="object"&&!(N instanceof Date)?i[k]=N:(typeof N=="number"?j="n":typeof N=="boolean"?j="b":typeof N=="string"?j="s":N instanceof Date?(j="d",a.cellDates||(j="n",N=xn(N)),S=a.dateNF||Ws[14]):N===null&&a.nullError&&(j="e",N=0),d?(d.t=j,d.v=N,delete d.w,delete d.R,S&&(d.z=S)):i[k]=d={t:j,v:N},S&&(d.z=S))})}),c.e.c=Math.max(c.e.c,o+h.length-1);var x=Xa(l);if(n)for(f=0;f<h.length;++f)i[_a(f+o)+x]={t:"s",v:h[f]};return i["!ref"]=ir(c),i}function Mz(t,s){return Ck(null,t,s)}function Sf(t,s,r){if(typeof s=="string"){if(Array.isArray(t)){var a=Sa(s);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[s]||(t[s]={t:"z"})}return typeof s!="number"?Sf(t,Ys(s)):Sf(t,Ys({r:s,c:r||0}))}function Hz(t,s){if(typeof s=="number"){if(s>=0&&t.SheetNames.length>s)return s;throw new Error("Cannot find sheet # "+s)}else if(typeof s=="string"){var r=t.SheetNames.indexOf(s);if(r>-1)return r;throw new Error("Cannot find sheet name |"+s+"|")}else throw new Error("Cannot find sheet |"+s+"|")}function W1(){return{SheetNames:[],Sheets:{}}}function G1(t,s,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=l+n)!=-1;++n);}if(dk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=s,r}function qz(t,s,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=Hz(t,s);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function Vz(t,s){return t.z=s,t}function Bk(t,s,r){return s?(t.l={Target:s},r&&(t.l.Tooltip=r)):delete t.l,t}function $z(t,s,r){return Bk(t,"#"+s,r)}function Wz(t,s,r){t.c||(t.c=[]),t.c.push({t:s,a:r||"SheetJS"})}function Gz(t,s,r,a){for(var n=typeof s!="string"?s:Cr(s),i=typeof s=="string"?s:ir(s),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var u=Sf(t,l,o);u.t="n",u.F=i,delete u.v,l==n.s.r&&o==n.s.c&&(u.f=r,a&&(u.D=!0))}return t}var us={encode_col:_a,encode_row:Xa,encode_cell:Ys,encode_range:ir,decode_col:j1,decode_row:y1,split_cell:a7,decode_cell:Sa,decode_range:rl,format_cell:sd,sheet_add_aoa:tB,sheet_add_json:Ck,sheet_add_dom:gk,aoa_to_sheet:Wh,json_to_sheet:Mz,table_to_sheet:vk,table_to_book:ez,sheet_to_csv:$1,sheet_to_txt:Sk,sheet_to_json:v0,sheet_to_html:xk,sheet_to_formulae:Qz,sheet_to_row_object_array:v0,sheet_get_cell:Sf,book_new:W1,book_append_sheet:G1,book_set_sheet_visibility:qz,cell_set_number_format:Vz,cell_set_hyperlink:Bk,cell_set_internal_link:$z,cell_add_comment:Wz,sheet_set_array_formula:Gz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Kz(){const[t,s]=v.useState("standard"),[r,a]=v.useState(!1),[n,i]=v.useState([]),[l,o]=v.useState([]),[u,d]=v.useState([]),[c,m]=v.useState([]),[h,f]=v.useState([]),[x,g]=v.useState(!1),[b,y]=v.useState(""),[N,j]=v.useState(null),S=Os.useRef(null),[k,P]=v.useState({product:"",customer:"",category:""}),[I,B]=v.useState({});v.useEffect(()=>{q()},[]),v.useEffect(()=>{Q()},[t,k]);const q=async()=>{try{console.log("Loading initial data...");const[K,_,F,E]=await Promise.all([te.get("/inventory/items"),te.get("/sales/customers"),te.get("/sales/price-types"),te.get("/finance/currencies")]);console.log("Products loaded:",K.data),console.log("Customers loaded:",_.data),console.log("Price Types loaded:",F.data),console.log("Currencies loaded:",E.data),o(K.data.items||[]),d(_.data.items||[]),m(F.data.items||[]),f(E.data.items||[])}catch(K){console.error("Error loading initial data:",K)}},Q=async()=>{a(!0);try{let K="",_={};switch(t){case"standard":K="/sales/prices/standard";break;case"customer":K="/sales/prices/customer",k.customer&&(_.customer_id=k.customer);break;default:return}console.log(`Fetching tab data from ${K}`,_);const F=await te.get(K,{params:_});console.log("Tab data response:",F.data);const E=Array.isArray(F.data)?F.data:F.data.items||[];i(E)}catch(K){console.error("Error loading tab data:",K)}finally{a(!1)}},O=()=>{let K=[],_="",F=[];t==="standard"?(K=["Item Code","Cost Price","Selling Price","Margin %","Effective Date (YYYY-MM-DD)","Price Type","UOM","Currency Name"],_="standard_prices_template.xlsx",F=n.map(U=>{const J=l.find(oe=>oe.id===U.product_id),ae=c.find(oe=>oe.id===U.price_type_id),Z=h.find(oe=>oe.id===U.currency_id);return[J?J.item_code:"",U.cost_price,U.selling_price,U.margin_percent,U.effective_date?U.effective_date.split("T")[0]:"",ae?ae.name:"",U.uom,Z?Z.name:""]})):(K=["Customer Name","Item Code","Standard Price","Customer Price","Discount %","Min Quantity","Effective From (YYYY-MM-DD)","Effective To (YYYY-MM-DD)","Price Type","UOM","Currency Name"],_="customer_prices_template.xlsx",F=n.map(U=>{const J=l.find(ee=>ee.id===U.product_id),ae=u.find(ee=>ee.id===U.customer_id),Z=c.find(ee=>ee.id===U.price_type_id),oe=h.find(ee=>ee.id===U.currency_id);return[ae?ae.customer_name:"",J?J.item_code:"",U.standard_price,U.customer_price,U.discount_percent,U.min_quantity,U.effective_from?U.effective_from.split("T")[0]:"",U.effective_to?U.effective_to.split("T")[0]:"",Z?Z.name:"",U.uom,oe?oe.name:""]}));const E=us.aoa_to_sheet([K,...F]),L=us.book_new();us.book_append_sheet(L,E,"Prices"),Br(L,_)},T=()=>{S.current.click()},V=async K=>{const _=K.target.files[0];if(!_)return;const F=new FileReader;F.onload=async E=>{var L,U;try{const J=new Uint8Array(E.target.result),ae=g0(J,{type:"array"}),Z=ae.SheetNames[0],oe=ae.Sheets[Z],ee=us.sheet_to_json(oe);if(ee.length===0){alert("File is empty or invalid format");return}const se=t==="standard"?"/sales/prices/bulk/standard":"/sales/prices/bulk/customer";await te.post(se,{items:ee}),alert("Uploaded successfully"),Q()}catch(J){console.error("Upload failed",J),alert("Upload failed: "+(((U=(L=J.response)==null?void 0:L.data)==null?void 0:U.message)||J.message))}},F.readAsArrayBuffer(_),K.target.value=""},D=(K,_=null)=>{y(K),j(_),B(_||{}),g(!0)},Y=()=>{g(!1),j(null),B({})},M=async()=>{var K,_;try{let F="";const E={...I};switch(["product_id","customer_id","cost_price","selling_price","margin_percent","standard_price","customer_price","discount_percent","min_quantity","max_quantity","unit_price","price_type_id","currency_id"].forEach(J=>{E[J]!==void 0&&E[J]!==null&&E[J]!==""?E[J]=Number(E[J]):["cost_price","selling_price","customer_price","unit_price"].includes(J)?(E[J]===""||E[J]===void 0)&&(E[J]=0):E[J]===""&&(E[J]=null)}),["effective_date","effective_from","effective_to"].forEach(J=>{E[J]===""&&(E[J]=null)}),b){case"standard":F="/sales/prices/standard";break;case"customer":F="/sales/prices/customer";break;default:return}await te.post(F,E),Y(),Q()}catch(F){console.error("Error saving data:",F),alert("Failed to save data: "+(((_=(K=F.response)==null?void 0:K.data)==null?void 0:_.message)||F.message))}},X=()=>e.jsx("div",{className:"table-container",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Cost Price"}),e.jsx("th",{children:"Selling Price"}),e.jsx("th",{children:"Margin %"}),e.jsx("th",{children:"Effective Date"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map((K,_)=>{const F=l.find(U=>U.id===K.product_id),E=c.find(U=>U.id===K.price_type_id),L=h.find(U=>U.id===K.currency_id);return e.jsxs("tr",{children:[e.jsx("td",{children:F?`${F.item_name} (${F.item_code})`:K.product_id}),e.jsx("td",{children:Number(K.cost_price).toFixed(2)}),e.jsx("td",{children:Number(K.selling_price).toFixed(2)}),e.jsxs("td",{children:[Number(K.margin_percent).toFixed(2),"%"]}),e.jsx("td",{children:new Date(K.effective_date).toLocaleDateString()}),e.jsx("td",{children:E?E.name:"-"}),e.jsx("td",{children:K.uom||"-"}),e.jsx("td",{children:L?`${L.code} - ${L.name}`:K.currency_id||"-"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-info",onClick:()=>D("standard",K),children:"Edit"})})]},_)})})]})}),R=()=>e.jsx("div",{className:"table-container",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Standard Price"}),e.jsx("th",{children:"Customer Price"}),e.jsx("th",{children:"Discount %"}),e.jsx("th",{children:"Min Qty"}),e.jsx("th",{children:"Effective"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map((K,_)=>{const F=u.find(J=>J.id===K.customer_id),E=l.find(J=>J.id===K.product_id),L=c.find(J=>J.id===K.price_type_id),U=h.find(J=>J.id===K.currency_id);return e.jsxs("tr",{children:[e.jsx("td",{children:F?F.customer_name:K.customer_id}),e.jsx("td",{children:E?E.item_name:K.product_id}),e.jsx("td",{children:Number(K.standard_price).toFixed(2)}),e.jsx("td",{children:Number(K.customer_price).toFixed(2)}),e.jsxs("td",{children:[Number(K.discount_percent).toFixed(2),"%"]}),e.jsx("td",{children:K.min_quantity}),e.jsx("td",{children:K.effective_from?new Date(K.effective_from).toLocaleDateString():"-"}),e.jsx("td",{children:L?L.name:"-"}),e.jsx("td",{children:K.uom||"-"}),e.jsx("td",{children:U?`${U.code} - ${U.name}`:K.currency_id||"-"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-info",onClick:()=>D("customer",K),children:"Edit"})})]},_)})})]})}),H=K=>{const _=l.find(F=>F.id==K);B(_?F=>({...F,product_id:K,uom:_.uom,cost_price:_.cost_price,currency_id:_.currency_id,price_type_id:_.price_type_id}):F=>({...F,product_id:K}))},W=()=>{if(b==="standard")return e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Product"}),e.jsxs("select",{value:I.product_id||"",onChange:K=>H(K.target.value),children:[e.jsx("option",{value:"",children:"Select Product"}),l.map(K=>e.jsxs("option",{value:K.id,children:[K.item_name," (",K.item_code,")"]},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price Type"}),e.jsxs("select",{value:I.price_type_id||"",onChange:K=>B({...I,price_type_id:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Price Type"}),c.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"UOM"}),e.jsx("input",{type:"text",value:I.uom||"",onChange:K=>B({...I,uom:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Currency"}),e.jsxs("select",{value:I.currency_id||"",onChange:K=>B({...I,currency_id:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Currency"}),h.map(K=>e.jsxs("option",{value:K.id,children:[K.code," - ",K.name]},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Cost Price"}),e.jsx("input",{type:"number",value:I.cost_price||"",onChange:K=>{const _=Number(K.target.value||0),F=Number(I.margin_percent||0),E=Number((_+_*F/100).toFixed(2));B({...I,cost_price:K.target.value,selling_price:E})}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Selling Price"}),e.jsx("input",{type:"number",value:I.selling_price||"",onChange:K=>{const _=Number(K.target.value||0),F=Number(I.cost_price||0),E=F>0?Number((_-F)/F*100):0;B({...I,selling_price:K.target.value,margin_percent:Number(E.toFixed(2))})}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Margin %"}),e.jsx("input",{type:"number",value:I.margin_percent||"",onChange:K=>{const _=Number(K.target.value||0),F=Number(I.cost_price||0),E=Number((F+F*_/100).toFixed(2));B({...I,margin_percent:K.target.value,selling_price:E})}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Effective Date"}),e.jsx("input",{type:"date",value:I.effective_date?I.effective_date.split("T")[0]:"",onChange:K=>B({...I,effective_date:K.target.value})})]})]});if(b==="customer")return e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Customer"}),e.jsxs("select",{value:I.customer_id||"",onChange:K=>B({...I,customer_id:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Customer"}),u.map(K=>e.jsx("option",{value:K.id,children:K.customer_name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Product"}),e.jsxs("select",{value:I.product_id||"",onChange:K=>H(K.target.value),children:[e.jsx("option",{value:"",children:"Select Product"}),l.map(K=>e.jsxs("option",{value:K.id,children:[K.item_name," (",K.item_code,")"]},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price Type"}),e.jsxs("select",{value:I.price_type_id||"",onChange:K=>B({...I,price_type_id:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Price Type"}),c.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"UOM"}),e.jsx("input",{type:"text",value:I.uom||"",onChange:K=>B({...I,uom:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Currency"}),e.jsxs("select",{value:I.currency_id||"",onChange:K=>B({...I,currency_id:K.target.value}),children:[e.jsx("option",{value:"",children:"Select Currency"}),h.map(K=>e.jsxs("option",{value:K.id,children:[K.code," - ",K.name]},K.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Standard Price"}),e.jsx("input",{type:"number",value:I.standard_price||"",onChange:K=>B({...I,standard_price:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Customer Price"}),e.jsx("input",{type:"number",value:I.customer_price||"",onChange:K=>B({...I,customer_price:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Discount %"}),e.jsx("input",{type:"number",value:I.discount_percent||"",onChange:K=>B({...I,discount_percent:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Min Quantity"}),e.jsx("input",{type:"number",value:I.min_quantity||"",onChange:K=>B({...I,min_quantity:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Effective From"}),e.jsx("input",{type:"date",value:I.effective_from?I.effective_from.split("T")[0]:"",onChange:K=>B({...I,effective_from:K.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Effective To"}),e.jsx("input",{type:"date",value:I.effective_to?I.effective_to.split("T")[0]:"",onChange:K=>B({...I,effective_to:K.target.value})})]})]})};return e.jsxs("div",{className:"price-setup-container",children:[e.jsx("input",{type:"file",ref:S,style:{display:"none"},accept:".csv",onChange:V}),e.jsxs("div",{className:"price-setup-header",children:[e.jsxs("h1",{children:[e.jsx("span",{children:""}),"Price Setup"]}),e.jsxs("div",{className:"header-actions",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:" Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:O,children:" Download Template"}),e.jsx("button",{className:"btn btn-secondary",onClick:T,children:" Upload Prices"}),e.jsx("button",{className:"btn btn-secondary",onClick:Q,children:" Refresh"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>D(t),children:" New Price"})]})]}),e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:`tab ${t==="standard"?"active":""}`,onClick:()=>s("standard"),children:" Standard Prices"}),e.jsx("button",{className:`tab ${t==="customer"?"active":""}`,onClick:()=>s("customer"),children:" Customer Specific Prices"})]}),t==="standard"&&e.jsxs("div",{className:"tab-content active",children:[e.jsx("div",{className:"filter-section",children:e.jsxs("div",{className:"filter-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Search Product"}),e.jsx("input",{type:"text",placeholder:"Search by code or name"})]}),e.jsx("div",{className:"form-group",children:e.jsx("button",{className:"btn btn-primary",children:" Search"})})]})}),r?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):n.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No standard prices found. Click "New Price" to add one.'}):X()]}),t==="customer"&&e.jsxs("div",{className:"tab-content active",children:[e.jsx("div",{className:"filter-section",children:e.jsx("div",{className:"filter-grid",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Select Customer"}),e.jsxs("select",{value:k.customer,onChange:K=>P({...k,customer:K.target.value}),children:[e.jsx("option",{value:"",children:"All Customers"}),u.map(K=>e.jsx("option",{value:K.id,children:K.customer_name},K.id))]})]})})}),r?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):n.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No customer prices found. Click "New Price" to add one.'}):R()]})]}),x&&e.jsx("div",{className:"price-modal-overlay",children:e.jsxs("div",{className:"price-modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:[b==="standard"&&" Standard Price Setup",b==="customer"&&" Customer Price Setup"]}),e.jsx("button",{className:"close-btn",onClick:Y,children:""})]}),e.jsx("div",{className:"modal-body",children:W()}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:Y,children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:M,children:"Save"})]})]})})]})}const cb={scheme_code:"",scheme_name:"",discount_type:"",discount_value:"",effective_from:"",effective_to:"",min_quantity:"",min_purchase_amount:"",max_discount_amount:"",description:"",status:"ACTIVE",itemIds:[]};function zz(){const[t,s]=v.useState([]),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(!1),[u,d]=v.useState(null),[c,m]=v.useState(cb),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState(""),[N,j]=v.useState("");v.useEffect(()=>{S()},[]);async function S(){var D;try{i(!0);const[Y,M]=await Promise.all([te.get("/sales/discount-schemes"),te.get("/inventory/items")]);s(Array.isArray((D=Y.data)==null?void 0:D.items)?Y.data.items:[]),a(M.data.items||[])}catch(Y){console.error(Y),mt.error("Failed to load data")}finally{i(!1)}}const k=v.useMemo(()=>t.filter(D=>{const Y=h?h==="ACTIVE"?D.is_active:!D.is_active:!0,M=x?D.discount_type===x:!0,X=b.toLowerCase(),R=!b||D.scheme_code.toLowerCase().includes(X)||D.scheme_name.toLowerCase().includes(X)||D.description&&D.description.toLowerCase().includes(X);return Y&&M&&R}),[t,h,x,b]),P=v.useMemo(()=>{const D=t.length,Y=t.filter(W=>W.is_active).length,M=t.filter(W=>W.discount_type==="PERCENTAGE"),X=M.length>0?(M.reduce((W,K)=>W+Number(K.discount_value),0)/M.length).toFixed(1):0,R=new Date,H=t.filter(W=>{const K=new Date(W.effective_from);return K.getMonth()===R.getMonth()&&K.getFullYear()===R.getFullYear()}).length;return{total:D,active:Y,avgDiscount:X,thisMonth:H}},[t]),I=async(D=null)=>{if(D){d(D);try{const M=(await te.get(`/sales/discount-schemes/${D}`)).data;m({scheme_code:M.scheme_code,scheme_name:M.scheme_name,discount_type:M.discount_type,discount_value:M.discount_value,effective_from:M.effective_from?M.effective_from.split("T")[0]:"",effective_to:M.effective_to?M.effective_to.split("T")[0]:"",min_quantity:M.min_quantity||"",min_purchase_amount:M.min_purchase_amount||"",max_discount_amount:M.max_discount_amount||"",description:M.description||"",status:M.is_active?"ACTIVE":"INACTIVE",itemIds:M.items?M.items.map(X=>X.id):[]})}catch{mt.error("Failed to load details");return}}else d(null),m(cb);o(!0)},B=()=>{o(!1),m(cb),d(null)},q=D=>{const{name:Y,value:M}=D.target;m(X=>({...X,[Y]:M}))},Q=D=>{m(Y=>{const M=Y.itemIds||[];return M.includes(D)?{...Y,itemIds:M.filter(X=>X!==D)}:{...Y,itemIds:[...M,D]}})},O=async D=>{var Y,M;D.preventDefault();try{const X={...c,is_active:c.status==="ACTIVE"?1:0};u?(await te.put(`/sales/discount-schemes/${u}`,X),mt.success("Discount scheme updated")):(await te.post("/sales/discount-schemes",X),mt.success("Discount scheme created")),B(),S()}catch(X){console.error(X),mt.error(((M=(Y=X.response)==null?void 0:Y.data)==null?void 0:M.message)||"Operation failed")}},T=async D=>{if(window.confirm("Are you sure you want to delete this scheme?"))try{await te.delete(`/sales/discount-schemes/${D}`),mt.success("Deleted successfully"),S()}catch{mt.error("Delete failed")}},V=v.useMemo(()=>{if(!N)return r;const D=N.toLowerCase();return r.filter(Y=>Y.item_code.toLowerCase().includes(D)||Y.item_name.toLowerCase().includes(D))},[r,N]);return n&&!t.length?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):e.jsxs("div",{className:"discount-scheme-container",children:[e.jsx("header",{className:"ds-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:" Discount Scheme Management"}),e.jsx("p",{children:"Manage and configure discount schemes for sales operations"})]}),e.jsx(Ee,{to:"/sales",className:"ds-btn ds-btn-secondary",children:"Return to Menu"})]})}),e.jsxs("div",{className:"ds-stats-grid",children:[e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"Total Schemes"}),e.jsx("div",{className:"value",children:P.total})]}),e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"Active Schemes"}),e.jsx("div",{className:"value",children:P.active})]}),e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"Avg Discount %"}),e.jsxs("div",{className:"value",children:[P.avgDiscount,"%"]})]}),e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"This Month"}),e.jsx("div",{className:"value",children:P.thisMonth})]})]}),e.jsxs("div",{className:"ds-card",children:[e.jsxs("div",{className:"ds-action-bar",children:[e.jsx("div",{className:"ds-search-box",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, or description...",value:b,onChange:D=>y(D.target.value)})}),e.jsx("button",{className:"ds-btn ds-btn-primary",onClick:()=>I(),children:" New Discount Scheme"})]}),e.jsxs("div",{className:"ds-filter-section",children:[e.jsxs("select",{value:h,onChange:D=>f(D.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]}),e.jsxs("select",{value:x,onChange:D=>g(D.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"PERCENTAGE",children:"Percentage"}),e.jsx("option",{value:"FIXED",children:"Fixed Amount"})]})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"ds-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Scheme Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Value"}),e.jsx("th",{children:"Valid From"}),e.jsx("th",{children:"Valid To"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:k.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"ds-empty-state",children:"No discount schemes found"})}):k.map(D=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:D.scheme_code})}),e.jsx("td",{children:D.scheme_name}),e.jsx("td",{children:e.jsx("span",{className:`ds-badge ds-badge-${D.discount_type==="PERCENTAGE"?"percentage":"fixed"}`,children:D.discount_type})}),e.jsx("td",{children:e.jsx("strong",{children:D.discount_type==="PERCENTAGE"?Number(D.discount_value)+"%":"$"+Number(D.discount_value).toFixed(2)})}),e.jsx("td",{children:new Date(D.effective_from).toLocaleDateString()}),e.jsx("td",{children:D.effective_to?new Date(D.effective_to).toLocaleDateString():"No expiry"}),e.jsx("td",{children:e.jsx("span",{className:`ds-badge ds-badge-${D.is_active?"active":"inactive"}`,children:D.is_active?"ACTIVE":"INACTIVE"})}),e.jsx("td",{children:e.jsxs("div",{className:"ds-action-buttons",children:[e.jsx("button",{className:"ds-icon-btn",onClick:()=>I(D.id),title:"Edit",children:""}),e.jsx("button",{className:"ds-icon-btn",onClick:()=>T(D.id),title:"Delete",children:""})]})})]},D.id))})]})})]}),l&&e.jsx("div",{className:"ds-modal-overlay",children:e.jsxs("div",{className:"ds-modal-content",children:[e.jsx("div",{className:"ds-modal-header",children:e.jsx("h2",{children:u?"Edit Discount Scheme":"New Discount Scheme"})}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Scheme Code *"}),e.jsx("input",{name:"scheme_code",value:c.scheme_code,onChange:q,required:!0,disabled:!!u})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Scheme Name *"}),e.jsx("input",{name:"scheme_name",value:c.scheme_name,onChange:q,required:!0})]})]}),e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Discount Type *"}),e.jsxs("select",{name:"discount_type",value:c.discount_type,onChange:q,required:!0,children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"PERCENTAGE",children:"Percentage"}),e.jsx("option",{value:"FIXED",children:"Fixed Amount"})]})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Discount Value *"}),e.jsx("input",{type:"number",name:"discount_value",value:c.discount_value,onChange:q,step:"0.01",min:"0",required:!0})]})]}),e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Valid From *"}),e.jsx("input",{type:"date",name:"effective_from",value:c.effective_from,onChange:q,required:!0})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Valid To"}),e.jsx("input",{type:"date",name:"effective_to",value:c.effective_to,onChange:q})]})]}),e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Min Quantity"}),e.jsx("input",{type:"number",name:"min_quantity",value:c.min_quantity,onChange:q,step:"0.01",min:"0"})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Min Purchase Amount"}),e.jsx("input",{type:"number",name:"min_purchase_amount",value:c.min_purchase_amount,onChange:q,step:"0.01",min:"0"})]})]}),e.jsx("div",{className:"ds-form-row",children:e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Max Discount Amount"}),e.jsx("input",{type:"number",name:"max_discount_amount",value:c.max_discount_amount,onChange:q,step:"0.01",min:"0"})]})}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:c.description,onChange:q,rows:"3"})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Status *"}),e.jsxs("select",{name:"status",value:c.status,onChange:q,required:!0,children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Linked Items (Search to filter)"}),e.jsx("input",{type:"text",placeholder:"Search items...",value:N,onChange:D=>j(D.target.value),className:"mb-2"}),e.jsxs("div",{className:"ds-item-selection",children:[V.slice(0,100).map(D=>e.jsxs("div",{className:"ds-item-checkbox",children:[e.jsx("input",{type:"checkbox",checked:c.itemIds.includes(D.id),onChange:()=>Q(D.id)}),e.jsxs("span",{children:[D.item_code," - ",D.item_name]})]},D.id)),V.length>100&&e.jsx("div",{className:"p-2 text-gray-500 italic",children:"Showing first 100 matches..."})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Selected: ",c.itemIds.length," items"]})]}),e.jsxs("div",{className:"ds-action-buttons",children:[e.jsx("button",{type:"submit",className:"ds-btn ds-btn-success",children:" Save Scheme"}),e.jsx("button",{type:"button",className:"ds-btn ds-btn-secondary",onClick:B,children:" Cancel"})]})]})]})})]})}function Yz(){const t=[{id:1,customer:"ABC Corporation",creditLimit:5e4,currency:"GHS"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Customer Credit Limits"}),e.jsx("p",{className:"text-sm mt-1",children:"Credit limit setup (placeholder)"})]}),e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Credit Limit"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.customer}),e.jsx("td",{className:"text-right",children:Number(s.creditLimit).toFixed(2)}),e.jsx("td",{children:s.currency}),e.jsx("td",{children:e.jsx(Ee,{to:`/sales/customer-credit/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function Xz(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({customer:"",creditLimit:0,currency:"GHS"});v.useEffect(()=>{r&&d()},[s]);async function d(){var h,f,x;try{n(!0),l("");const g=await te.get(`/sales/customer-credit/${s}`);(h=g.data)!=null&&h.item&&u(g.data.item)}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error fetching customer credit")}finally{n(!1)}}function c(h,f){u(x=>({...x,[h]:f}))}async function m(h){var f,x;h.preventDefault(),n(!0),l("");try{r?await te.put(`/sales/customer-credit/${s}`,o):await te.post("/sales/customer-credit",o),t("/sales/customer-credit")}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error saving customer credit")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Credit Limit":"New Credit Limit"})}),e.jsx(Ee,{to:"/sales/customer-credit",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer *"}),e.jsx("input",{className:"input",value:o.customer,onChange:h=>c("customer",h.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Credit Limit"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:o.creditLimit,onChange:h=>c("creditLimit",Number(h.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input",value:o.currency,onChange:h=>c("currency",h.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/sales/customer-credit",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function Jz(){const t=Ns(),s=Os.useRef(null),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(!1),[h,f]=v.useState(""),[x,g]=v.useState(!1),[b,y]=v.useState(!1),[N,j]=v.useState(!1),[S,k]=v.useState(!1),{hasAccess:P,scope:I}=Qa(),[B,q]=v.useState(!1);v.useEffect(()=>{Q()},[]);const Q=async()=>{var D,Y,M;try{i(!0),o("");const X=await te.get("/sales/customers",{params:{active:!0}}),R=X.data&&X.data.data&&X.data.data.items||((D=X.data)==null?void 0:D.items)||[];a(Array.isArray(R)?R:[])}catch(X){o(((M=(Y=X==null?void 0:X.response)==null?void 0:Y.data)==null?void 0:M.message)||"Error fetching customers"),console.error("Error fetching customers:",X)}finally{i(!1)}},O=async()=>{try{const D=await te.get("/sales/customers/template",{responseType:"blob"}),Y=window.URL.createObjectURL(new Blob([D.data])),M=document.createElement("a");M.href=Y,M.setAttribute("download","CustomerTemplate.xlsx"),document.body.appendChild(M),M.click(),M.remove()}catch(D){console.error("Error downloading template",D),alert("Error downloading template")}},T=async D=>{var X,R;const Y=D.target.files[0];if(!Y)return;const M=new FormData;M.append("file",Y);try{i(!0),await te.post("/sales/customers/import",M,{headers:{"Content-Type":"multipart/form-data"}}),alert("Customers imported successfully!"),Q()}catch(H){console.error("Error importing customers",H),alert(((R=(X=H==null?void 0:H.response)==null?void 0:X.data)==null?void 0:R.message)||"Error importing customers")}finally{i(!1),s.current&&(s.current.value="")}},V=r.filter(D=>D&&(String(D.customer_code||"").toLowerCase().includes(u.toLowerCase())||String(D.customer_name||"").toLowerCase().includes(u.toLowerCase())||String(D.email||"").toLowerCase().includes(u.toLowerCase())));return n?e.jsx("div",{className:"text-center py-8",children:"Loading customers..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Customer Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customers and their information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:O,className:"btn btn-secondary",children:"Template"}),e.jsx("button",{onClick:()=>s.current.click(),className:"btn btn-primary",children:"Import"}),e.jsx("input",{type:"file",ref:s,className:"hidden",accept:".xlsx, .xls",onChange:T}),e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/sales/customers/new",className:"btn-success",children:"+ New Customer"})]})]})}),l&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:l})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search customers...",className:"input",value:u,onChange:D=>d(D.target.value)}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:B,onChange:D=>q(D.target.checked)}),e.jsx("span",{children:"Show current branch only"})]}),e.jsx("button",{className:"btn btn-outline",onClick:Q,children:"Refresh"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Email/Phone"}),e.jsx("th",{children:"Credit Limit"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:(B?V.filter(D=>String(D.branch_id||"")===String((I==null?void 0:I.branchId)||"")):V).map(D=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:D.customer_code}),e.jsxs("td",{children:[e.jsx("div",{className:"font-bold",children:D.customer_name}),D.address&&e.jsx("div",{className:"text-xs text-slate-500 truncate max-w-[200px]",children:D.address})]}),e.jsx("td",{children:D.customer_type||"-"}),e.jsx("td",{children:D.price_type_name||"-"}),e.jsx("td",{children:D.contact_person||"-"}),e.jsxs("td",{children:[e.jsx("div",{className:"text-sm",children:D.email}),e.jsx("div",{className:"text-xs text-slate-500",children:D.phone})]}),e.jsx("td",{children:D.credit_limit?`${Number(D.credit_limit).toFixed(2)}`:"-"}),e.jsx("td",{children:D.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx("button",{className:"text-brand hover:text-brand-600 text-sm font-medium",onClick:()=>t(`/sales/customers/${D.id}`),children:"Edit"})})]},D.id))})]}),V.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-600",children:"No customers found"})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-red-600 text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Bulk Delete Customers"}),e.jsx("button",{onClick:()=>{m(!1),f("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Paste names and/or codes. Raw blobs accepted; codes like C00003 will be detected."}),e.jsx("textarea",{className:"input w-full h-40",placeholder:"Enter customer names/codes/raw data...",value:h,onChange:D=>f(D.target.value)}),e.jsx("div",{className:"text-xs text-slate-600",children:"This action deletes matching customers for the current company."}),e.jsxs("label",{className:"flex items-center gap-2 text-sm mt-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:b,onChange:D=>y(D.target.checked)}),e.jsx("span",{children:"Force delete (temporarily disable constraints)"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:N,onChange:D=>j(D.target.checked)}),e.jsx("span",{children:"Cascade delete (remove dependent sales rows)"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:S,onChange:D=>k(D.target.checked)}),e.jsx("span",{children:"Also cleanup finance accounts"})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{m(!1),f("")},disabled:x,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:async()=>{var D,Y,M,X,R,H;if(!h.trim()){alert("Enter names or codes to delete.");return}if(window.confirm("Are you sure you want to delete the provided customers?"))try{g(!0);const W=await te.post("/sales/customers/bulk-delete",{raw:h,force:b,cascade:N,cleanup_finance:S}),K=Number(((D=W==null?void 0:W.data)==null?void 0:D.deletedByName)||0),_=Number(((Y=W==null?void 0:W.data)==null?void 0:Y.deletedByCode)||0),F=Number(((M=W==null?void 0:W.data)==null?void 0:M.matched)||0),E=Number(((X=W==null?void 0:W.data)==null?void 0:X.deleted)||K+_),L=K||_?`Deleted by name: ${K}
Deleted by code: ${_}
Total: ${K+_}`:`Matched: ${F}
Deleted: ${E}`;alert(L),m(!1),f(""),await Q()}catch(W){alert(((H=(R=W==null?void 0:W.response)==null?void 0:R.data)==null?void 0:H.message)||"Bulk delete failed. Ensure you have delete rights.")}finally{g(!1)}},disabled:x,children:x?"Deleting...":"Delete"})]})]})})]})}function $_(){var j;const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState([]),[d,c]=v.useState([]),[m,h]=v.useState({customer_code:"",customer_name:"",email:"",phone:"",is_active:!0,address:"",city:"",state:"",zone:"",country:"",price_type_id:"",currency_id:""});v.useEffect(()=>{x(),g(),r?b():f()},[s]);async function f(){var S;try{const k=await te.get("/sales/customers/next-code");(S=k.data)!=null&&S.code&&y("customer_code",k.data.code)}catch(k){console.error("Error fetching next customer code",k)}}async function x(){var S;try{const k=await te.get("/sales/price-types");u(Array.isArray((S=k.data)==null?void 0:S.items)?k.data.items:[])}catch(k){console.error("Error fetching price types",k)}}async function g(){var S;try{const k=await te.get("/finance/currencies"),P=Array.isArray((S=k.data)==null?void 0:S.items)?k.data.items:[];c(P);const I=P.find(B=>Number(B.is_base)===1);!r&&I&&y("currency_id",String(I.id))}catch(k){console.error("Error fetching currencies",k)}}async function b(){var S,k,P;try{n(!0),l("");const I=await te.get(`/sales/customers/${s}`);(S=I.data)!=null&&S.item&&h(I.data.item)}catch(I){l(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Error fetching customer")}finally{n(!1)}}function y(S,k){h(P=>({...P,[S]:k}))}async function N(S){var k,P;S.preventDefault(),n(!0),l("");try{r?await te.put(`/sales/customers/${s}`,m):await te.post("/sales/customers",m),t("/sales/customers")}catch(I){l(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Error saving customer")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Customer":"New Customer"})}),e.jsx(Ee,{to:"/sales/customers",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:N,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error",children:i}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Code"}),e.jsx("input",{className:"input",value:m.customer_code||"",onChange:S=>y("customer_code",S.target.value),placeholder:"Auto-generated if empty"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Name *"}),e.jsx("input",{className:"input",value:m.customer_name||"",onChange:S=>y("customer_name",S.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Type"}),e.jsxs("select",{className:"input",value:m.customer_type||"Individual",onChange:S=>y("customer_type",S.target.value),children:[e.jsx("option",{value:"Individual",children:"Individual"}),e.jsx("option",{value:"Business",children:"Business"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Person"}),e.jsx("input",{className:"input",value:m.contact_person||"",onChange:S=>y("contact_person",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:m.email||"",onChange:S=>y("email",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{className:"input",value:m.phone||"",onChange:S=>y("phone",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Mobile"}),e.jsx("input",{className:"input",value:m.mobile||"",onChange:S=>y("mobile",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Credit Limit"}),e.jsx("input",{className:"input",type:"number",value:m.credit_limit||"",onChange:S=>y("credit_limit",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsxs("select",{className:"input",value:m.payment_terms||"Net 30",onChange:S=>y("payment_terms",S.target.value),children:[e.jsx("option",{value:"Immediate",children:"Immediate"}),e.jsx("option",{value:"Net 15",children:"Net 15"}),e.jsx("option",{value:"Net 30",children:"Net 30"}),e.jsx("option",{value:"Net 45",children:"Net 45"}),e.jsx("option",{value:"Net 60",children:"Net 60"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:m.is_active?"1":"0",onChange:S=>y("is_active",S.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("textarea",{className:"input",rows:"3",value:m.address||"",onChange:S=>y("address",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:m.city||"",onChange:S=>y("city",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:m.state||"",onChange:S=>y("state",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Zone"}),e.jsx("input",{className:"input",value:m.zone||"",onChange:S=>y("zone",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input",value:m.country||"",onChange:S=>y("country",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsxs("select",{className:"input",value:m.price_type_id||"",onChange:S=>y("price_type_id",S.target.value),children:[e.jsx("option",{value:"",children:"-- Select Price Type --"}),o.map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:m.currency_id||"",onChange:S=>y("currency_id",S.target.value),children:[e.jsx("option",{value:"",children:"-- Select Currency --"}),d.map(S=>e.jsx("option",{value:S.id,children:(S.code||S.currency_code)+" - "+(S.name||S.currency_name||"")},S.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(Ee,{to:"/sales/customers",className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save Customer"})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900 rounded-lg p-6 border border-slate-200 dark:border-slate-700 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 border-b border-slate-200 dark:border-slate-700 pb-2",children:"Customer Preview"}),!m.customer_code&&!m.customer_name?e.jsxs("div",{className:"text-center py-10 text-slate-400",children:[e.jsx("div",{className:"text-5xl mb-3",children:""}),e.jsx("p",{children:"Fill in the form to preview customer details"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Customer Code"}),e.jsx("div",{className:"font-mono text-brand-600 font-medium",children:m.customer_code||"(Auto-generated)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Customer Name"}),e.jsx("div",{className:"text-lg font-bold",children:m.customer_name}),m.customer_type&&e.jsx("span",{className:"inline-block bg-slate-200 dark:bg-slate-700 text-xs px-2 py-0.5 rounded mt-1",children:m.customer_type})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Contact"}),e.jsx("div",{className:"text-sm",children:m.contact_person||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Phone"}),e.jsx("div",{className:"text-sm",children:m.phone||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Email"}),e.jsx("div",{className:"text-sm break-all text-brand-500",children:m.email||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Credit Limit"}),e.jsx("div",{className:"font-medium text-green-600",children:m.credit_limit?`${Number(m.credit_limit).toLocaleString()}`:"0.00"})]}),m.address&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Address"}),e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:m.address})]}),(m.city||m.state||m.country||m.zone)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Location"}),e.jsxs("div",{className:"text-sm",children:[[m.city,m.state,m.country].filter(Boolean).join(", "),m.zone&&e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Zone: ",m.zone]})]})]}),m.price_type_id&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Price Type"}),e.jsx("div",{className:"text-sm",children:((j=o.find(S=>String(S.id)===String(m.price_type_id)))==null?void 0:j.name)||m.price_type_id})]})]})]})})]})]})})})]})}function Zz(){const[t,s]=v.useState("");return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Bulk Customer Upload"}),e.jsx("p",{className:"text-sm mt-1",children:"Upload customers in bulk (placeholder)"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"CSV File"}),e.jsx("input",{className:"input",type:"file",accept:".csv",onChange:r=>{var a,n;return s(((n=(a=r.target.files)==null?void 0:a[0])==null?void 0:n.name)||"")}}),t?e.jsxs("div",{className:"text-sm mt-2",children:["Selected: ",t]}):null]}),e.jsx("div",{className:"text-sm",children:"Expected columns: customer_code, customer_name, email, phone, address"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>window.alert("Upload processing will be implemented in Sales module backend."),children:"Upload"})]})})]})}function eY(){const t=[{title:"Sales by Customer",description:"Sales totals grouped by customer (placeholder)"},{title:"Invoice Aging",description:"Outstanding invoices aging buckets (placeholder)"},{title:"Discount Analysis",description:"Discount usage summary (placeholder)"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Analytics and reports"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function kk(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState([]);v.useEffect(()=>{let c=!0;return a(!0),i(""),te.get("/sales/returns").then(m=>{var h;c&&o(Array.isArray((h=m.data)==null?void 0:h.items)?m.data.items:[])}).catch(m=>{var h,f;c&&i(((f=(h=m==null?void 0:m.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load sales returns")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=v.useMemo(()=>{const c=t.toLowerCase();return l.filter(m=>{const h=String(m.return_no||"").toLowerCase(),f=String(m.customer_name||"").toLowerCase(),x=String(m.invoice_id||"").toLowerCase();return h.includes(c)||f.includes(c)||x.includes(c)})},[l,t]),d=v.useMemo(()=>{const c=l.length,m=l.filter(x=>x.status==="PENDING").length,h=l.filter(x=>x.status==="APPROVED").length,f=l.filter(x=>x.status==="DRAFT").length;return{total:c,pending:m,approved:h,draft:f}},[l]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{children:""})," Sales Returns"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Process customer returns and track status"})]}),e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Total Returns"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:d.total})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Draft"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:d.draft})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Pending"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:d.pending})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Approved"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:d.approved})]})]}),e.jsx("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"input pl-10",placeholder:"Search by return no, customer, or invoice",value:t,onChange:c=>s(c.target.value)}),e.jsx(D0,{className:"w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"})]})})}),n&&e.jsx("div",{className:"alert alert-error mb-4",children:n}),r?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading sales returns..."})]}):u.length===0?e.jsx("div",{className:"text-center py-12 text-slate-600",children:"No sales returns found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Return No"}),e.jsx("th",{children:"Return Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:u.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:c.return_no}),e.jsx("td",{children:c.return_date?new Date(c.return_date).toLocaleDateString():"-"}),e.jsx("td",{children:c.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(c.total_amount||0).toFixed(2)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c.status==="APPROVED"?"badge-success":c.status==="PENDING"?"badge-warning":c.status==="CANCELLED"?"badge-error":"badge-info"}`,children:c.status||"DRAFT"})})]},c.id))})]})})]})]})})}function tY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/sales/reports/sales-return",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["Date","Return No","Customer","Item","Quantity","Amount"],f=(Array.isArray(n)?n:[]).map(N=>[N.return_date?new Date(N.return_date).toLocaleDateString():"-",N.return_no||"-",N.customer_name||"-",N.item_name||N.item_code||"-",Number(N.qty||0).toFixed(2),Number(N.amount||0).toFixed(2)]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="sales_return.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({date:g.return_date?new Date(g.return_date).toLocaleDateString():"-",return_no:g.return_no||"-",customer:g.customer_name||"-",item:g.item_name||g.item_code||"-",quantity:Number(g.qty||0),amount:Number(g.amount||0)})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"SalesReturn"),Br(x,"sales-return.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Sales Return Report",10,f),f+=8,h.setFontSize(10);const x=["Date","Return No","Customer","Item","Qty","Amount"];h.text(x[0],10,f),h.text(x[1],35,f),h.text(x[2],70,f),h.text(x[3],120,f),h.text(x[4],160,f),h.text(x[5],190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=g.return_date?new Date(g.return_date).toLocaleDateString():"-",y=String(g.return_no||"-"),N=String(g.customer_name||"-"),j=String(g.item_name||g.item_code||"-"),S=Number(g.qty||0).toFixed(2),k=Number(g.amount||0).toFixed(2);h.text(b,10,f),h.text(y,35,f),h.text(N.slice(0,40),70,f),h.text(j.slice(0,35),120,f),h.text(S,160,f),h.text(k,190,f,{align:"right"}),f+=5}),h.save("sales-return.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Return Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Returned items and amounts within period"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Return No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:n.map((h,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:h.return_date?new Date(h.return_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:h.return_no||"-"}),e.jsx("td",{children:h.customer_name||"-"}),e.jsx("td",{children:h.item_name||h.item_code}),e.jsx("td",{className:"text-right",children:Number(h.qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.amount||0).toLocaleString()})]},h.id||f))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function sY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/sales/reports/sales-register",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["Date","Invoice No","Customer","Items","Amount","Status"],f=(Array.isArray(n)?n:[]).map(N=>[N.invoice_date?new Date(N.invoice_date).toLocaleDateString():"-",N.invoice_no||"-",N.customer_name||"-",Number(N.items_count||0).toString(),Number(N.total_amount||0).toFixed(2),N.status||"-"]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="sales_register.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({date:g.invoice_date?new Date(g.invoice_date).toLocaleDateString():"-",invoice_no:g.invoice_no||"-",customer:g.customer_name||"-",items:Number(g.items_count||0),amount:Number(g.total_amount||0),status:g.status||"-"})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"SalesRegister"),Br(x,"sales-register.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Sales Register",10,f),f+=8,h.setFontSize(10);const x=["Date","Invoice No","Customer","Items","Amount","Status"];h.text(x[0],10,f),h.text(x[1],35,f),h.text(x[2],75,f),h.text(x[3],130,f),h.text(x[4],160,f),h.text(x[5],190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=g.invoice_date?new Date(g.invoice_date).toLocaleDateString():"-",y=String(g.invoice_no||"-"),N=String(g.customer_name||"-"),j=String(Number(g.items_count||0)),S=Number(g.total_amount||0).toFixed(2),k=String(g.status||"-");h.text(b,10,f),h.text(y,35,f),h.text(N.slice(0,45),75,f),h.text(j,130,f),h.text(S,160,f),h.text(k,190,f,{align:"right"}),f+=5}),h.save("sales-register.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Invoices and totals within the period"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Items"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.invoice_date?new Date(h.invoice_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:h.invoice_no||"-"}),e.jsx("td",{children:h.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(h.items_count||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.total_amount||0).toLocaleString()}),e.jsx("td",{children:h.status||"-"})]},h.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function rY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/sales/reports/delivery-register",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["Date","Delivery No","Customer","Item","Quantity"],f=(Array.isArray(n)?n:[]).map(N=>[N.delivery_date?new Date(N.delivery_date).toLocaleDateString():"-",N.delivery_no||"-",N.customer_name||"-",N.item_name||N.item_code||"-",Number(N.qty||0).toFixed(2)]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="delivery_register.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({date:g.delivery_date?new Date(g.delivery_date).toLocaleDateString():"-",delivery_no:g.delivery_no||"-",customer:g.customer_name||"-",item:g.item_name||g.item_code||"-",quantity:Number(g.qty||0)})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"DeliveryRegister"),Br(x,"delivery-register.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Delivery Register",10,f),f+=8,h.setFontSize(10);const x=["Date","Delivery No","Customer","Item","Qty"];h.text(x[0],10,f),h.text(x[1],40,f),h.text(x[2],80,f),h.text(x[3],130,f),h.text(x[4],190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=g.delivery_date?new Date(g.delivery_date).toLocaleDateString():"-",y=String(g.delivery_no||"-"),N=String(g.customer_name||"-"),j=String(g.item_name||g.item_code||"-"),S=Number(g.qty||0).toFixed(2);h.text(b,10,f),h.text(y,40,f),h.text(N.slice(0,45),80,f),h.text(j.slice(0,40),130,f),h.text(S,190,f,{align:"right"}),f+=5}),h.save("delivery-register.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Delivery Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Deliveries and quantities within the period"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Delivery No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"})]})}),e.jsx("tbody",{children:n.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.delivery_date?new Date(h.delivery_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:h.delivery_no||"-"}),e.jsx("td",{children:h.customer_name||"-"}),e.jsx("td",{children:h.item_name||h.item_code}),e.jsx("td",{className:"text-right",children:Number(h.qty||0).toLocaleString()})]},h.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function aY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),l=v.useMemo(()=>{const m=r.reduce((g,b)=>g+Number(b.opening||0),0),h=r.reduce((g,b)=>g+Number(b.invoiced||0),0),f=r.reduce((g,b)=>g+Number(b.received||0),0),x=r.reduce((g,b)=>g+Number(b.outstanding||0),0);return{opening:m,invoiced:h,received:f,outstanding:x}},[r]);async function o(){var m,h,f;try{i(!0);const x=await te.get("/sales/reports/debtors-balance",{params:{asOf:t||null}});a(((m=x.data)==null?void 0:m.items)||[])}catch(x){mt.error(((f=(h=x==null?void 0:x.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load report")}finally{i(!1)}}function u(){const m=["Customer","Opening","Invoiced","Received","Outstanding"],h=(Array.isArray(r)?r:[]).map(y=>[y.customer_name||"-",Number(y.opening||0).toFixed(2),Number(y.invoiced||0).toFixed(2),Number(y.received||0).toFixed(2),Number(y.outstanding||0).toFixed(2)]),f=[m.join(","),...h.map(y=>y.join(","))].join(`
`),x=new Blob([f],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(x),b=document.createElement("a");b.href=g,b.download="debtors_balance.csv",b.click(),URL.revokeObjectURL(g)}function d(){const m=(Array.isArray(r)?r:[]).map(x=>({customer:x.customer_name||"-",opening:Number(x.opening||0),invoiced:Number(x.invoiced||0),received:Number(x.received||0),outstanding:Number(x.outstanding||0)})),h=us.json_to_sheet(m),f=us.book_new();us.book_append_sheet(f,h,"DebtorsBalance"),Br(f,"debtors-balance.xlsx")}function c(){const m=new As("p","mm","a4");let h=15;m.setFontSize(14),m.text("Debtors Balance",10,h),h+=8,m.setFontSize(10);const f=["Customer","Opening","Invoiced","Received","Outstanding"];m.text(f[0],10,h),m.text(f[1],80,h),m.text(f[2],110,h),m.text(f[3],140,h),m.text(f[4],190,h,{align:"right"}),h+=4,m.line(10,h,200,h),h+=5,(Array.isArray(r)?r:[]).forEach(x=>{h>270&&(m.addPage(),h=15);const g=String(x.customer_name||"-"),b=Number(x.opening||0).toFixed(2),y=Number(x.invoiced||0).toFixed(2),N=Number(x.received||0).toFixed(2),j=Number(x.outstanding||0).toFixed(2);m.text(g.slice(0,60),10,h),m.text(b,80,h),m.text(y,110,h),m.text(N,140,h),m.text(j,190,h,{align:"right"}),h+=5}),m.save("debtors-balance.pdf")}return v.useEffect(()=>{o()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Debtors Balance"}),e.jsx("p",{className:"text-sm mt-1",children:"Customer balances as of a date"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:n||r.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:d,disabled:n||r.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:c,disabled:n||r.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:m=>s(m.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:o,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Opening"}),e.jsx("th",{className:"text-right",children:"Invoiced"}),e.jsx("th",{className:"text-right",children:"Received"}),e.jsx("th",{className:"text-right",children:"Outstanding"})]})}),e.jsx("tbody",{children:r.map((m,h)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:m.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(m.opening||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(m.invoiced||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(m.received||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(m.outstanding||0).toLocaleString()})]},m.id||h))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-right font-medium",children:"Totals"}),e.jsx("td",{className:"text-right font-medium",children:l.opening.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:l.invoiced.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:l.received.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:l.outstanding.toLocaleString()})]})})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function nY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/sales/reports/sales-profitability",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["Date","Invoice No","Customer","Net Sales","Cost","Gross Margin","Margin %"],f=(Array.isArray(n)?n:[]).map(N=>{const j=Number(N.net_sales||0)-Number(N.cost||0),S=Number(N.net_sales||0)?j/Number(N.net_sales||0)*100:0;return[N.invoice_date?new Date(N.invoice_date).toLocaleDateString():"-",N.invoice_no||"-",N.customer_name||"-",Number(N.net_sales||0).toFixed(2),Number(N.cost||0).toFixed(2),Number(j||0).toFixed(2),S.toFixed(2)]}),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="sales_profitability.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>{const b=Number(g.net_sales||0)-Number(g.cost||0),y=Number(g.net_sales||0)?b/Number(g.net_sales||0)*100:0;return{date:g.invoice_date?new Date(g.invoice_date).toLocaleDateString():"-",invoice_no:g.invoice_no||"-",customer:g.customer_name||"-",net_sales:Number(g.net_sales||0),cost:Number(g.cost||0),gross_margin:Number(b||0),margin_pct:Number(y.toFixed(2))}}),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"SalesProfitability"),Br(x,"sales-profitability.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Sales Profitability",10,f),f+=8,h.setFontSize(10);const x=["Date","Invoice No","Customer","Net Sales","Cost","Gross Margin","Margin %"];h.text(x[0],10,f),h.text(x[1],35,f),h.text(x[2],75,f),h.text(x[3],120,f),h.text(x[4],145,f),h.text(x[5],165,f),h.text(x[6],190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=Number(g.net_sales||0)-Number(g.cost||0),y=Number(g.net_sales||0)?b/Number(g.net_sales||0)*100:0,N=g.invoice_date?new Date(g.invoice_date).toLocaleDateString():"-",j=String(g.invoice_no||"-"),S=String(g.customer_name||"-"),k=Number(g.net_sales||0).toFixed(2),P=Number(g.cost||0).toFixed(2),I=Number(b||0).toFixed(2),B=y.toFixed(2);h.text(N,10,f),h.text(j,35,f),h.text(S.slice(0,40),75,f),h.text(k,120,f),h.text(P,145,f),h.text(I,165,f),h.text(B,190,f,{align:"right"}),f+=5}),h.save("sales-profitability.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Profitability"}),e.jsx("p",{className:"text-sm mt-1",children:"Net sales vs cost with margins"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Net Sales"}),e.jsx("th",{className:"text-right",children:"Cost"}),e.jsx("th",{className:"text-right",children:"Gross Margin"}),e.jsx("th",{className:"text-right",children:"Margin %"})]})}),e.jsx("tbody",{children:n.map(h=>{const f=Number(h.net_sales||0)-Number(h.cost||0),x=Number(h.net_sales||0)?f/Number(h.net_sales||0)*100:0;return e.jsxs("tr",{children:[e.jsx("td",{children:h.invoice_date?new Date(h.invoice_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:h.invoice_no||"-"}),e.jsx("td",{children:h.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(h.net_sales||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.cost||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(f||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:x.toFixed(2)})]},h.id)})})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function iY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/sales/reports/sales-tracking",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["Stage","Reference","Customer","Date","Status","Value"],f=(Array.isArray(n)?n:[]).map(N=>[N.stage||"-",N.ref_no||"-",N.customer_name||"-",N.txn_date?new Date(N.txn_date).toLocaleDateString():"-",N.status||"-",Number(N.total_value||0).toFixed(2)]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="sales_tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({stage:g.stage||"-",reference:g.ref_no||"-",customer:g.customer_name||"-",date:g.txn_date?new Date(g.txn_date).toLocaleDateString():"-",status:g.status||"-",value:Number(g.total_value||0)})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"SalesTracking"),Br(x,"sales-tracking.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Sales Tracking",10,f),f+=8,h.setFontSize(10);const x=["Stage","Reference","Customer","Date","Status","Value"];h.text(x[0],10,f),h.text(x[1],45,f),h.text(x[2],90,f),h.text(x[3],130,f),h.text(x[4],160,f),h.text(x[5],190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=String(g.stage||"-"),y=String(g.ref_no||"-"),N=String(g.customer_name||"-"),j=g.txn_date?new Date(g.txn_date).toLocaleDateString():"-",S=String(g.status||"-"),k=Number(g.total_value||0).toFixed(2);h.text(b.slice(0,25),10,f),h.text(y.slice(0,30),45,f),h.text(N.slice(0,35),90,f),h.text(j,130,f),h.text(S,160,f),h.text(k,190,f,{align:"right"}),f+=5}),h.save("sales-tracking.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Tracking across quotations, orders, deliveries, invoices"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Stage"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map((h,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:h.stage||"-"}),e.jsx("td",{className:"font-medium",children:h.ref_no||"-"}),e.jsx("td",{children:h.customer_name||"-"}),e.jsx("td",{children:h.txn_date?new Date(h.txn_date).toLocaleDateString():"-"}),e.jsx("td",{children:h.status||"-"}),e.jsx("td",{className:"text-right",children:Number(h.total_value||0).toLocaleString()})]},h.id||f))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}const lY=()=>{const[t,s]=Os.useState([{icon:"",value:"GHS 5.2M",label:"Total Sales (YTD)",change:" 21.5% from last year",changeType:"positive",path:"/sales/reports"},{icon:"",value:"45",label:"Open Orders",change:"5 new today",changeType:"positive",path:"/sales/sales-orders"},{icon:"",value:"12",label:"Pending Deliveries",change:"2 delayed",changeType:"negative",path:"/sales/delivery"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.sales)==null?void 0:o.total)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.sales)==null?void 0:c.open_orders)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.sales)==null?void 0:f.pending_deliveries)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:`GHS ${Number(g).toLocaleString()}`,label:"Total Sales (Last 30 Days)"},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:String(y)},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Sales Transactions",badge:"Operations",items:[{title:"Quotations",path:"/sales/quotations",description:"Create and manage customer quotations",icon:"",actions:[{label:"View",path:"/sales/quotations",type:"outline"},{label:"New",path:"/sales/quotations/new",type:"primary"}]},{title:"Sales Orders",path:"/sales/sales-orders",description:"Process customer orders and track fulfillment",icon:"",actions:[{label:"View",path:"/sales/sales-orders",type:"outline"},{label:"New",path:"/sales/sales-orders/new",type:"primary"}]},{title:"Invoices",path:"/sales/invoices",description:"Generate and manage sales invoices",icon:"",actions:[{label:"View",path:"/sales/invoices",type:"outline"},{label:"New",path:"/sales/invoices/new",type:"primary"}]},{title:"Delivery Notes",path:"/sales/delivery",description:"Track product deliveries to customers",icon:"",actions:[{label:"View",path:"/sales/delivery",type:"outline"},{label:"New",path:"/sales/delivery/new",type:"primary"}]}]},{title:"Pricing & Discounts",badge:"Configuration",items:[{title:"Price Setup",path:"/sales/price-setup",description:"Manage standard and customer pricing",icon:"",actions:[{label:"Manage",path:"/sales/price-setup",type:"primary"}]},{title:"Discount Schemes",path:"/sales/discount-schemes",description:"Configure discount rules and promotions",icon:"",actions:[{label:"Manage",path:"/sales/discount-schemes",type:"primary"}]}]},{title:"Customer Management",items:[{title:"Customer Setup",path:"/sales/customers",description:"Manage customer information",icon:"",actions:[{label:"View",path:"/sales/customers",type:"outline"},{label:"Add",path:"/sales/customers/new",type:"primary"}]}]},{title:"Analytics & Reports",items:[{title:"Sales Reports",path:"/sales/reports",description:"View sales analytics and reports",icon:"",actions:[{label:"View Reports",path:"/sales/reports",type:"primary"}]},{title:"Sales Register",path:"/sales/reports/sales-register",description:"Invoices within the selected period",icon:""},{title:"Delivery Register",path:"/sales/reports/delivery-register",description:"Deliveries made to customers",icon:""},{title:"Sales Return Report",path:"/sales/reports/sales-return",description:"Items returned by customers",icon:""},{title:"Debtors Balance",path:"/sales/reports/debtors-balance",description:"Customer balances and outstanding",icon:""},{title:"Sales Profitability",path:"/sales/reports/sales-profitability",description:"Margins and profitability by invoice",icon:""},{title:"Sales Tracking",path:"/sales/reports/sales-tracking",description:"Track quotations  orders  deliveries  invoices",icon:""}]}];return e.jsx(To,{title:"Sales Module",description:"Customer orders, quotations, invoicing, and sales analytics",stats:t,sections:r})};function oY(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(lY,{})}),e.jsx(tt,{path:"/quotations",element:e.jsx(UO,{})}),e.jsx(tt,{path:"/quotations/new",element:e.jsx(F2,{})}),e.jsx(tt,{path:"/quotations/:id",element:e.jsx(F2,{})}),e.jsx(tt,{path:"/sales-orders",element:e.jsx(RO,{})}),e.jsx(tt,{path:"/sales-orders/new",element:e.jsx(T2,{})}),e.jsx(tt,{path:"/sales-orders/:id",element:e.jsx(T2,{})}),e.jsx(tt,{path:"/invoices",element:e.jsx(MO,{})}),e.jsx(tt,{path:"/invoices/new",element:e.jsx(I2,{})}),e.jsx(tt,{path:"/invoices/:id",element:e.jsx(I2,{})}),e.jsx(tt,{path:"delivery",element:e.jsx(GO,{})}),e.jsx(tt,{path:"delivery/new",element:e.jsx(D2,{})}),e.jsx(tt,{path:"delivery/:id",element:e.jsx(D2,{})}),e.jsx(tt,{path:"/price-setup",element:e.jsx(Kz,{})}),e.jsx(tt,{path:"/discount-schemes",element:e.jsx(zz,{})}),e.jsx(tt,{path:"/customer-credit",element:e.jsx(Yz,{})}),e.jsx(tt,{path:"/customer-credit/:id",element:e.jsx(Xz,{})}),e.jsx(tt,{path:"/customers",element:e.jsx(Jz,{})}),e.jsx(tt,{path:"/customers/new",element:e.jsx($_,{})}),e.jsx(tt,{path:"/customers/:id",element:e.jsx($_,{})}),e.jsx(tt,{path:"/bulk-upload",element:e.jsx(Zz,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(eY,{})}),e.jsx(tt,{path:"/reports/sales-return",element:e.jsx(tY,{})}),e.jsx(tt,{path:"/reports/sales-register",element:e.jsx(sY,{})}),e.jsx(tt,{path:"/reports/delivery-register",element:e.jsx(rY,{})}),e.jsx(tt,{path:"/reports/debtors-balance",element:e.jsx(aY,{})}),e.jsx(tt,{path:"/reports/sales-profitability",element:e.jsx(nY,{})}),e.jsx(tt,{path:"/reports/sales-tracking",element:e.jsx(iY,{})}),e.jsx(tt,{path:"/returns",element:e.jsx(kk,{})})]})}function cY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState(!1),[c,m]=v.useState(null),[h,f]=v.useState(!1),[x,g]=v.useState(""),[b,y]=v.useState(null),[N,j]=v.useState(null),[S,k]=v.useState([]),[P,I]=v.useState(!1),[B,q]=v.useState(null),[Q,O]=v.useState(null);v.useEffect(()=>{let H=!0;return i(!0),o(""),te.get("/inventory/stock-adjustments").then(W=>{var K;H&&a(Array.isArray((K=W.data)==null?void 0:K.items)?W.data.items:[])}).catch(W=>{var K,_;H&&o(((_=(K=W==null?void 0:W.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load stock adjustments")}).finally(()=>{H&&i(!1)}),()=>{H=!1}},[]);const T=H=>({DRAFT:"badge-info",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-success",POSTED:"badge-success",REJECTED:"badge-error",CANCELLED:"badge-error",RETURNED:"badge-error"})[H]||"badge-info",V=v.useMemo(()=>r.filter(H=>String(H.adjustment_no||"").toLowerCase().includes(t.toLowerCase())),[r,t]),D=H=>{if(!H)return"";let W=new Date(H);return isNaN(W.getTime())&&(isNaN(Number(H))||(W=new Date(Number(H)))),isNaN(W.getTime())?String(H):W.toLocaleDateString()},Y=async H=>{var W,K,_;if(m(H),d(!0),g(""),B)await M();else try{f(!0);const F=await te.get("/workflows"),E=Array.isArray((W=F.data)==null?void 0:W.items)?F.data.items:[];q(E),await X(E)}catch(F){g(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load workflows")}finally{f(!1)}},M=async()=>{var _,F,E;if(!B||!B.length){y(null),j(null),g("");return}const H="/inventory/stock-adjustments",W=L=>String(L||"").trim().toUpperCase().replace(/\s+/g,"_"),K=B.find(L=>Number(L.is_active)===1&&String(L.document_route)===H)||B.find(L=>Number(L.is_active)===1&&W(L.document_type)==="STOCK_ADJUSTMENT")||null;if(y(K||null),j(null),!!K)try{f(!0);const U=(_=(await te.get(`/workflows/${K.id}`)).data)==null?void 0:_.item,J=Array.isArray(U==null?void 0:U.steps)?U.steps:[];k(J);const ae=J[0]||null;if(j(ae?{userId:ae.approver_user_id,name:ae.approver_name,stepName:ae.step_name,stepOrder:ae.step_order,approvalLimit:ae.approval_limit}:null),ae){const Z=(Array.isArray(ae.approvers)&&ae.approvers.length?ae.approvers[0].id:ae.approver_user_id)||null;O(Z)}else O(null)}catch(L){g(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Failed to load workflow details")}finally{f(!1)}},X=async H=>{var F,E,L;if(!H||!H.length){y(null),j(null),g("");return}const W="/inventory/stock-adjustments",K=U=>String(U||"").trim().toUpperCase().replace(/\s+/g,"_"),_=H.find(U=>Number(U.is_active)===1&&String(U.document_route)===W)||H.find(U=>Number(U.is_active)===1&&K(U.document_type)==="STOCK_ADJUSTMENT")||null;if(y(_||null),j(null),!!_)try{f(!0);const J=(F=(await te.get(`/workflows/${_.id}`)).data)==null?void 0:F.item,ae=Array.isArray(J==null?void 0:J.steps)?J.steps:[];k(ae);const Z=ae[0]||null;j(Z?{userId:Z.approver_user_id,name:Z.approver_name,stepName:Z.step_name,stepOrder:Z.step_order,approvalLimit:Z.approval_limit}:null)}catch(U){g(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load workflow details")}finally{f(!1)}},R=async()=>{var H,W,K;if(c){I(!0),g("");try{const _=await te.post(`/inventory/stock-adjustments/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:Q||null}),F=((H=_==null?void 0:_.data)==null?void 0:H.status)||"PENDING_APPROVAL";a(E=>E.map(L=>L.id===c.id?{...L,status:F}:L)),d(!1),m(null)}catch(_){g(((K=(W=_==null?void 0:_.response)==null?void 0:W.data)==null?void 0:K.message)||"Failed to forward for approval")}finally{I(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Stock Adjustments"}),e.jsx("p",{className:"text-sm mt-1",children:"Adjust stock quantities for corrections and reconciliation"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/stock-adjustments/new",className:"btn-success",children:"+ New Adjustment"})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by adjustment number...",className:"input max-w-md",value:t,onChange:H=>s(H.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Adjustment No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:l})}):null,V.map(H=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:H.adjustment_no}),e.jsx("td",{children:D(H.adjustment_date)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${H.adjustment_type==="INCREASE"?"badge-success":"badge-warning"}`,children:H.adjustment_type})}),e.jsx("td",{children:H.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${T(H.status)} `,children:H.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Ee,{to:`/inventory/stock-adjustments/${H.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/stock-adjustments/${H.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),H.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):H.status==="DRAFT"||H.status==="RETURNED"?e.jsx("button",{type:"button",onClick:()=>Y(H),className:"text-sm font-medium px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:"Forward"}):null]})})]},H.id))]})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),m(null),y(null),j(null),g("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.adjustment_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[h?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,x?e.jsx("div",{className:"text-sm text-red-600",children:x}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const W=Array.isArray(S)&&S.length>0?S[0]:null,K=W?Array.isArray(W.approvers)&&W.approvers.length?W.approvers.map(_=>({id:_.id,name:_.username})):W.approver_user_id?[{id:W.approver_user_id,name:W.approver_name||String(W.approver_user_id)}]:[]:[];return K.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:Q||"",onChange:_=>O(_.target.value?Number(_.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),K.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:N?`Step ${N.stepOrder}  ${N.stepName}${N.approvalLimit!=null?`  Limit: ${Number(N.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),m(null),y(null),j(null),g("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:R,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}const Po=(t=0)=>{const s=$y(),r=Kc(l=>l.inventoryRef.uoms),a=Kc(l=>l.inventoryRef.status.uoms),n=Kc(l=>l.inventoryRef.error.uoms);return v.useEffect(()=>{(a==="idle"||t)&&s(Om())},[s,a,t]),{uoms:r,loading:a==="loading",error:n,refresh:()=>{s(Om())}}};function W_(){const{uoms:t,loading:s}=Po(),{id:r}=Ps(),a=Ns(),n=!r||r==="new",[i]=_0(),l=(i.get("mode")||"").toLowerCase(),o=!n&&l==="view",[u,d]=v.useState(!1),[c,m]=v.useState(!1),[h,f]=v.useState(""),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState({adjustmentNo:"",adjustmentDate:new Date().toISOString().split("T")[0],warehouseId:"",adjustmentType:"PHYSICAL_COUNT",referenceDoc:"",reason:"",status:"DRAFT"}),[S,k]=v.useState([]);v.useEffect(()=>{let V=!0;return Promise.all([te.get("/inventory/items"),te.get("/inventory/warehouses")]).then(([D,Y])=>{var M,X;V&&(g(Array.isArray((M=D.data)==null?void 0:M.items)?D.data.items:[]),y(Array.isArray((X=Y.data)==null?void 0:X.items)?Y.data.items:[]))}).catch(D=>{var Y,M;V&&f(((M=(Y=D==null?void 0:D.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to load lookups")}),()=>{V=!1}},[]),v.useEffect(()=>{n&&te.get("/inventory/stock-adjustments/next-no").then(V=>{var D;(D=V.data)!=null&&D.next_no&&j(Y=>({...Y,adjustmentNo:V.data.next_no}))}).catch(()=>{})},[n]),v.useEffect(()=>{if(n){k([{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}]);return}let V=!0;return d(!0),f(""),te.get(`/inventory/stock-adjustments/${r}`).then(D=>{var X,R;if(!V)return;const Y=(X=D.data)==null?void 0:X.item,M=Array.isArray((R=D.data)==null?void 0:R.details)?D.data.details:[];Y&&(j({adjustmentNo:Y.adjustment_no||"",adjustmentDate:Y.adjustment_date?new Date(Y.adjustment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],warehouseId:Y.warehouse_id?String(Y.warehouse_id):"",adjustmentType:Y.adjustment_type||"PHYSICAL_COUNT",referenceDoc:Y.reference_doc||"",reason:Y.reason||"",status:Y.status||"DRAFT"}),k(M.length?M.map(H=>({id:H.id||Date.now()+Math.random(),item_id:H.item_id?String(H.item_id):"",itemCode:H.item_code||"",itemName:H.item_name||"",currentStock:Number(H.current_stock)||0,adjustedStock:Number(H.adjusted_stock)||0,uom:"PCS",unitCost:Number(H.unit_cost)||0,remarks:H.remarks||""})):[]))}).catch(D=>{var Y,M;V&&f(((M=(Y=D==null?void 0:D.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to load stock adjustment")}).finally(()=>{V&&d(!1)}),()=>{V=!1}},[r,n]);const P=v.useMemo(()=>S.filter(V=>V.item_id).map(V=>({item_id:Number(V.item_id),current_stock:Number(V.currentStock)||0,adjusted_stock:Number(V.adjustedStock)||0,qty:Number(V.adjustedStock)-Number(V.currentStock),unit_cost:Number(V.unitCost)||0,remarks:V.remarks})),[S]),I=async V=>{var D,Y;V.preventDefault(),m(!0),f("");try{const M={adjustment_no:N.adjustmentNo||void 0,adjustment_date:N.adjustmentDate,warehouse_id:N.warehouseId?Number(N.warehouseId):null,adjustment_type:N.adjustmentType,reference_doc:N.referenceDoc,reason:N.reason,status:N.status,details:P};n?await te.post("/inventory/stock-adjustments",M):await te.put(`/inventory/stock-adjustments/${r}`,M),a("/inventory/stock-adjustments")}catch(M){f(((Y=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:Y.message)||"Failed to save stock adjustment")}finally{m(!1)}},B=()=>{k([...S,{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}])},q=V=>{k(S.filter(D=>D.id!==V))},Q=(V,D,Y)=>{k(S.map(M=>{if(M.id===V){const X={...M,[D]:Y};if(D==="item_id"){const R=x.find(H=>String(H.id)===String(Y));X.itemCode=(R==null?void 0:R.item_code)||"",X.itemName=(R==null?void 0:R.item_name)||"",X.unitCost=(R==null?void 0:R.cost_price)||0}return X}return M}))},O=V=>{j(D=>({...D,reason:V}))},T=V=>{const D="border-2 rounded-lg p-4 cursor-pointer transition-all text-center hover:shadow-md",Y=N.adjustmentType===V?" ring-2 ring-brand-500 bg-brand-50 border-brand-500":" border-slate-200 bg-white";return V==="INCREASE"?`${D} ${Y} ${N.adjustmentType===V?"border-green-500 ring-green-500 bg-green-50":"hover:border-green-200"}`:V==="DECREASE"?`${D} ${Y} ${N.adjustmentType===V?"border-red-500 ring-red-500 bg-red-50":"hover:border-red-200"}`:`${D} ${Y}`};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:n?"New Stock Adjustment":o?"View Stock Adjustment":"Edit Stock Adjustment"}),e.jsx("p",{className:"text-sm mt-1",children:"Adjust stock quantities for corrections"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Ee,{to:"/inventory/stock-adjustments",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:" Back to List"})})]})}),e.jsx("div",{className:"card-body p-6",children:e.jsxs("form",{onSubmit:I,className:"space-y-8",children:[u&&e.jsx("div",{className:"text-sm",children:"Loading..."}),h&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-md border border-red-200",children:h}),e.jsxs("fieldset",{disabled:o,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Select Adjustment Type"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:T("PHYSICAL_COUNT"),onClick:()=>j({...N,adjustmentType:"PHYSICAL_COUNT"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Physical Count"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Based on actual inventory count"})]}),e.jsxs("div",{className:T("INCREASE"),onClick:()=>j({...N,adjustmentType:"INCREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Increase"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Add stock (found, corrections)"})]}),e.jsxs("div",{className:T("DECREASE"),onClick:()=>j({...N,adjustmentType:"DECREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Decrease"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Reduce stock (damage, theft)"})]}),e.jsxs("div",{className:T("OTHER"),onClick:()=>j({...N,adjustmentType:"OTHER"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Other Adjustment"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Miscellaneous adjustments"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Adjustment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Adjustment No"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:N.adjustmentNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Adjustment Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"input",value:N.adjustmentDate,onChange:V=>j({...N,adjustmentDate:V.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:N.warehouseId,onChange:V=>j({...N,warehouseId:V.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Warehouse --"}),b.map(V=>e.jsx("option",{value:V.id,children:V.warehouse_name},V.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Adjustment Type"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:N.adjustmentType,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference Document"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., PC-2024-001",value:N.referenceDoc,onChange:V=>j({...N,referenceDoc:V.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${N.status==="DRAFT"?"bg-slate-200 text-slate-700":"bg-green-100 text-green-700"}`,children:N.status})})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Adjustment Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"input",rows:"2",placeholder:"Provide detailed reason for this adjustment...",value:N.reason,onChange:V=>j({...N,reason:V.target.value}),required:!0}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["Physical count variance","Damaged goods","Expired items","Theft/Loss","Found items","System error correction","Other"].map(V=>e.jsx("button",{type:"button",onClick:()=>O(V),className:`px-3 py-1 rounded-full text-xs border ${N.reason===V?"bg-brand-500 text-white border-brand-500":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50"}`,children:V},V))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:" Adjustment Items"}),e.jsx("button",{type:"button",onClick:B,className:"btn-primary text-sm px-3 py-1 rounded bg-brand-600 text-white hover:bg-brand-700",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700 uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Item"}),e.jsx("th",{className:"p-3 w-24",children:"Current Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Adjusted Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Diff"}),e.jsx("th",{className:"p-3 w-20",children:"UOM"}),e.jsx("th",{className:"p-3 w-24",children:"Unit Cost"}),e.jsx("th",{className:"p-3 w-28",children:"Impact"}),e.jsx("th",{className:"p-3",children:"Remarks"}),e.jsx("th",{className:"p-3 w-16"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200",children:[S.map(V=>{const D=Number(V.adjustedStock)-Number(V.currentStock),Y=D*Number(V.unitCost);return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"input text-sm py-1",value:V.item_id,onChange:M=>Q(V.id,"item_id",M.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),x.map(M=>e.jsxs("option",{value:M.id,children:[M.item_code," - ",M.item_name]},M.id))]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1 bg-slate-50",value:V.currentStock,onChange:M=>Q(V.id,"currentStock",M.target.value)})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1 font-bold",value:V.adjustedStock,onChange:M=>Q(V.id,"adjustedStock",M.target.value)})}),e.jsx("td",{className:"p-2 font-bold",children:e.jsxs("span",{className:D>0?"text-green-600":D<0?"text-red-600":"text-slate-400",children:[D>0?"+":"",D]})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"input text-sm py-1",value:V.uom,onChange:M=>Q(V.id,"uom",M.target.value),children:s?e.jsx("option",{children:"Loading..."}):t.map(M=>e.jsx("option",{value:M.uom_code,children:M.uom_code},M.id))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1",value:V.unitCost,onChange:M=>Q(V.id,"unitCost",M.target.value)})}),e.jsx("td",{className:"p-2 font-medium",children:Y.toFixed(2)}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",placeholder:"Optional",value:V.remarks,onChange:M=>Q(V.id,"remarks",M.target.value)})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>q(V.id),className:"text-red-500 hover:text-red-700",children:""})})]},V.id)}),S.length===0&&e.jsx("tr",{children:e.jsx("td",{colspan:"9",className:"p-8 text-center text-slate-500",children:'No items added. Click "Add Item" to begin.'})})]})]})})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:" Adjustment Impact Summary"}),e.jsxs("div",{className:"flex gap-8 text-sm",children:[e.jsxs("div",{children:["Total Items Adjusted:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.length})]}),e.jsxs("div",{children:["Net Qty Change:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.reduce((V,D)=>V+(Number(D.adjustedStock)-Number(D.currentStock)),0)})]}),e.jsxs("div",{children:["Total Value Impact:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.reduce((V,D)=>V+(Number(D.adjustedStock)-Number(D.currentStock))*Number(D.unitCost),0).toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[e.jsx(Ee,{to:"/inventory/stock-adjustments",className:"btn-light bg-white border border-slate-300 text-slate-700 hover:bg-slate-50 px-4 py-2 rounded",children:"Cancel"}),o?null:e.jsx("button",{type:"submit",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:c?"Saving...":"Save Adjustment"})]})]})})]})})}function dY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let c=!0;return i(!0),o(""),te.get("/inventory/stock-transfers").then(m=>{var h;c&&a(Array.isArray((h=m.data)==null?void 0:h.items)?m.data.items:[])}).catch(m=>{var h,f;c&&o(((f=(h=m==null?void 0:m.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load stock transfers")}).finally(()=>{c&&i(!1)}),()=>{c=!1}},[]);const u=c=>({DRAFT:"badge-info",IN_TRANSIT:"badge-warning",RECEIVED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=v.useMemo(()=>r.filter(c=>`${c.transfer_no||""} ${c.from_branch||""} ${c.to_branch||""}`.toLowerCase().includes(t.toLowerCase())),[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Stock Transfers"}),e.jsx("p",{className:"text-sm mt-1",children:"Transfer stock between warehouses and branches"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/stock-transfers/new",className:"btn-success",children:"+ New Transfer"})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by transfer number, from or to branch...",className:"input max-w-md",value:t,onChange:c=>s(c.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Transfer No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"From Branch"}),e.jsx("th",{children:"To Branch"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-red-600",children:l})}):null,d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:c.transfer_no}),e.jsx("td",{children:c.transfer_date}),e.jsx("td",{children:c.from_branch}),e.jsx("td",{children:c.to_branch}),e.jsx("td",{children:c.item_count}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/stock-transfers/${c.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/stock-transfers/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))]})]})})]})]})})}function uY(){const{uoms:t,loading:s}=Po(),{id:r}=Ps(),a=Ns(),n=r==="new",[i,l]=v.useState(!1),[o,u]=v.useState(!1),[d,c]=v.useState(""),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState([]),[y,N]=v.useState([]),[j,S]=v.useState([]),[k,P]=v.useState({transferNo:n?"Auto-generated":"ST-2024-001",transferDate:new Date().toISOString().split("T")[0],transferType:"INTER_WAREHOUSE",deliveryDate:"",driverName:"",vehicleNo:"",fromBranchId:"",toBranchId:"",fromWarehouseId:"",toWarehouseId:"",remarks:"",status:"DRAFT"}),[I,B]=v.useState([{id:1,item_id:"",itemCode:"",itemName:"",qty:0,uom:"PCS",batchNumber:"",remarks:""}]);v.useEffect(()=>{let D=!0;return(async()=>{var M,X,R,H,W;try{const[K,_,F]=await Promise.all([te.get("/inventory/items"),te.get("/admin/branches"),te.get("/inventory/warehouses")]);D&&(h(Array.isArray((M=K.data)==null?void 0:M.items)?K.data.items:[]),x(Array.isArray((X=_.data)==null?void 0:X.items)?_.data.items:[]),b(Array.isArray((R=F.data)==null?void 0:R.items)?F.data.items:[]))}catch(K){D&&c(((W=(H=K==null?void 0:K.response)==null?void 0:H.data)==null?void 0:W.message)||"Failed to load initial data")}})(),()=>{D=!1}},[]),v.useEffect(()=>{if(!n)return;let D=!0;return te.get("/inventory/stock-transfers/next-no").then(Y=>{var X;if(!D)return;const M=(X=Y.data)==null?void 0:X.next_no;M&&P(R=>({...R,transferNo:M}))}).catch(()=>{}),()=>{D=!1}},[n]),v.useEffect(()=>{if(n)return;let D=!0;return l(!0),c(""),te.get(`/inventory/stock-transfers/${r}`).then(Y=>{var R,H;if(!D)return;const M=(R=Y.data)==null?void 0:R.item,X=Array.isArray((H=Y.data)==null?void 0:H.details)?Y.data.details:[];M&&(P({transferNo:M.transfer_no||"",transferDate:M.transfer_date?typeof M.transfer_date=="string"?M.transfer_date.split("T")[0]:new Date(M.transfer_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],transferType:M.transfer_type||"INTER_WAREHOUSE",deliveryDate:M.delivery_date?M.delivery_date.split("T")[0]:"",driverName:M.driver_name||"",vehicleNo:M.vehicle_no||"",fromBranchId:M.from_branch_id?String(M.from_branch_id):"",toBranchId:M.to_branch_id?String(M.to_branch_id):"",remarks:M.remarks||"",status:M.status||"DRAFT"}),B(X.length?X.map(W=>({id:W.id||Date.now()+Math.random(),item_id:W.item_id?String(W.item_id):"",itemCode:W.item_code||"",itemName:W.item_name||"",qty:Number(W.qty)||0,uom:W.uom||"PCS",batchNumber:W.batch_number||"",remarks:W.remarks||""})):[{id:1,item_id:"",itemCode:"",itemName:"",qty:0,uom:"PCS",batchNumber:"",remarks:""}]))}).catch(Y=>{var M,X;D&&c(((X=(M=Y==null?void 0:Y.response)==null?void 0:M.data)==null?void 0:X.message)||"Failed to load stock transfer")}).finally(()=>{D&&l(!1)}),()=>{D=!1}},[r,n]),v.useEffect(()=>{if(k.transferType!=="INTER_BRANCH"){N([]);return}const D=Number(k.fromBranchId);if(!D){N([]);return}const Y=f.find(X=>String(X.id)===String(D)),M=Y?Number(Y.company_id):void 0;te.get("/inventory/warehouses",{headers:{"x-branch-id":String(D),...M?{"x-company-id":String(M)}:{}}}).then(X=>{var H;const R=Array.isArray((H=X.data)==null?void 0:H.items)?X.data.items:[];N(R)}).catch(()=>{N([])})},[k.transferType,k.fromBranchId,f]),v.useEffect(()=>{if(k.transferType!=="INTER_BRANCH"){S([]);return}const D=Number(k.toBranchId);if(!D){S([]);return}const Y=f.find(X=>String(X.id)===String(D)),M=Y?Number(Y.company_id):void 0;te.get("/inventory/warehouses",{headers:{"x-branch-id":String(D),...M?{"x-company-id":String(M)}:{}}}).then(X=>{var H;const R=Array.isArray((H=X.data)==null?void 0:H.items)?X.data.items:[];S(R)}).catch(()=>{S([])})},[k.transferType,k.toBranchId,f]),v.useEffect(()=>{P(D=>String(D.fromBranchId)?D:{...D,fromWarehouseId:""})},[k.fromBranchId]),v.useEffect(()=>{P(D=>String(D.toBranchId)?D:{...D,toWarehouseId:""})},[k.toBranchId]);const q=v.useMemo(()=>I.filter(D=>D.item_id).map(D=>({item_id:Number(D.item_id),qty:Number(D.qty)||0,batch_number:D.batchNumber,remarks:D.remarks})),[I]),Q=async D=>{var Y,M;D.preventDefault(),u(!0),c("");try{const X=k.transferType==="INTER_BRANCH",R=k.transferType==="INTER_WAREHOUSE",H=R?Number(k.fromBranchId)||null:Number(k.fromWarehouseId)||null,W=R?Number(k.toBranchId)||null:Number(k.toWarehouseId)||null;let K=Number(k.fromBranchId)||null,_=Number(k.toBranchId)||null;if(R){const E=g.find(U=>String(U.id)===String(H)),L=g.find(U=>String(U.id)===String(W));K=E&&E.branch_id?Number(E.branch_id):K,_=L&&L.branch_id?Number(L.branch_id):_}const F={transfer_no:n?void 0:k.transferNo,transfer_date:k.transferDate,transfer_type:k.transferType,delivery_date:k.deliveryDate,driver_name:k.driverName||null,vehicle_no:k.vehicleNo||null,from_branch_id:K,to_branch_id:_,from_warehouse_id:H,to_warehouse_id:W,status:k.status,remarks:k.remarks,details:q};n?await te.post("/inventory/stock-transfers",F):await te.put(`/inventory/stock-transfers/${r}`,F),a("/inventory/stock-transfers")}catch(X){c(((M=(Y=X==null?void 0:X.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to save stock transfer")}finally{u(!1)}},O=()=>{B([...I,{id:Date.now(),item_id:"",itemCode:"",itemName:"",qty:0,uom:"PCS",batchNumber:"",remarks:""}])},T=D=>{B(I.filter(Y=>Y.id!==D))},V=D=>{if(!D)return"";if(k.transferType==="INTER_WAREHOUSE"){const M=g.find(X=>String(X.id)===String(D));return M?M.warehouse_name:""}const Y=f.find(M=>String(M.id)===String(D));return Y?Y.name:""};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:n?"New Stock Transfer":"Edit Stock Transfer"}),e.jsx("p",{className:"text-sm mt-1",children:"Transfer stock between warehouses and branches"})]}),e.jsx(Ee,{to:"/inventory/stock-transfers",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[i?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,d?e.jsx("div",{className:"text-sm text-red-600",children:d}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer No"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:k.transferNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer Date *"}),e.jsx("input",{type:"date",className:"input",value:k.transferDate,onChange:D=>P({...k,transferDate:D.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer Type *"}),e.jsxs("select",{className:"input",value:k.transferType,onChange:D=>P({...k,transferType:D.target.value,fromBranchId:"",toBranchId:"",fromWarehouseId:"",toWarehouseId:""}),required:!0,children:[e.jsx("option",{value:"INTER_WAREHOUSE",children:"Inter-Warehouse"}),e.jsx("option",{value:"INTER_BRANCH",children:"Inter-Branch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:k.status,onChange:D=>P({...k,status:D.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"IN_TRANSIT",children:"IN TRANSIT"}),e.jsx("option",{value:"RECEIVED",children:"RECEIVED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["From"," ",k.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"," ","*"]}),e.jsxs("select",{className:"input",value:k.fromBranchId,onChange:D=>P({...k,fromBranchId:D.target.value}),required:!0,children:[e.jsxs("option",{value:"",children:["Select"," ",k.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"]}),(k.transferType==="INTER_WAREHOUSE"?g:f).map(D=>e.jsx("option",{value:D.id,children:k.transferType==="INTER_WAREHOUSE"?D.warehouse_name:D.name},D.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["To"," ",k.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"," ","*"]}),e.jsxs("select",{className:"input",value:k.toBranchId,onChange:D=>P({...k,toBranchId:D.target.value}),required:!0,children:[e.jsxs("option",{value:"",children:["Select"," ",k.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"]}),(k.transferType==="INTER_WAREHOUSE"?g:f).map(D=>e.jsx("option",{value:D.id,children:k.transferType==="INTER_WAREHOUSE"?D.warehouse_name:D.name},D.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"input",value:k.deliveryDate,onChange:D=>P({...k,deliveryDate:D.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Driver Name"}),e.jsx("input",{type:"text",className:"input",value:k.driverName,onChange:D=>P({...k,driverName:D.target.value}),placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Number"}),e.jsx("input",{type:"text",className:"input",value:k.vehicleNo,onChange:D=>P({...k,vehicleNo:D.target.value}),placeholder:"Optional"})]})]}),k.transferType==="INTER_BRANCH"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Warehouse (in selected From Branch)"}),e.jsxs("select",{className:"input",value:k.fromWarehouseId,onChange:D=>P({...k,fromWarehouseId:D.target.value}),disabled:!k.fromBranchId,required:!0,children:[e.jsx("option",{value:"",children:k.fromBranchId?"Select Warehouse":"Select From Branch first"}),y.map(D=>e.jsx("option",{value:String(D.id),children:D.warehouse_name},D.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Warehouse (in selected To Branch)"}),e.jsxs("select",{className:"input",value:k.toWarehouseId,onChange:D=>P({...k,toWarehouseId:D.target.value}),disabled:!k.toBranchId,required:!0,children:[e.jsx("option",{value:"",children:k.toBranchId?"Select Warehouse":"Select To Branch first"}),j.map(D=>e.jsx("option",{value:String(D.id),children:D.warehouse_name},D.id))]})]})]}):null,e.jsxs("div",{className:"flex items-center justify-center py-6 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Origin"}),e.jsx("div",{className:"font-bold text-lg text-slate-800 dark:text-slate-200",children:V(k.fromBranchId)||"Select Source"}),k.transferType==="INTER_BRANCH"&&k.fromWarehouseId?e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:(y.find(D=>String(D.id)===String(k.fromWarehouseId))||{warehouse_name:""}).warehouse_name}):null]}),e.jsxs("div",{className:"mx-8 flex flex-col items-center text-brand-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})}),e.jsx("span",{className:"text-xs font-medium mt-1",children:k.transferType.replace("_"," ")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Destination"}),e.jsx("div",{className:"font-bold text-lg text-slate-800 dark:text-slate-200",children:V(k.toBranchId)||"Select Destination"}),k.transferType==="INTER_BRANCH"&&k.toWarehouseId?e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:(j.find(D=>String(D.id)===String(k.toWarehouseId))||{warehouse_name:""}).warehouse_name}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:k.remarks,onChange:D=>P({...k,remarks:D.target.value}),placeholder:"Enter any additional notes..."})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Items to Transfer"}),e.jsx("button",{type:"button",onClick:O,className:"btn-success text-sm",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-1/4 min-w-[200px]",children:"Item Code"}),e.jsx("th",{className:"w-1/4 min-w-[200px]",children:"Item Name"}),e.jsx("th",{className:"w-32 min-w-[120px]",children:"Qty"}),e.jsx("th",{className:"w-32 min-w-[120px]",children:"UOM"}),e.jsx("th",{className:"w-48 min-w-[180px]",children:"Batch No"}),e.jsx("th",{className:"w-64 min-w-[250px]",children:"Remarks"}),e.jsx("th",{className:"w-16"})]})}),e.jsx("tbody",{children:I.map(D=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:D.item_id,onChange:Y=>{const M=Y.target.value,X=m.find(H=>String(H.id)===String(M)),R=I.map(H=>H.id===D.id?{...H,item_id:M,itemCode:(X==null?void 0:X.item_code)||"",itemName:(X==null?void 0:X.item_name)||""}:H);B(R)},required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),m.map(Y=>e.jsx("option",{value:Y.id,children:(Y.item_code||Y.id)+" - "+(Y.item_name||"")},Y.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:D.itemName,disabled:!0})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input",value:D.qty,onChange:Y=>{const M=I.map(X=>X.id===D.id?{...X,qty:parseFloat(Y.target.value)||0}:X);B(M)},min:"0",step:"1"})}),e.jsx("td",{children:e.jsx("select",{className:"input",value:D.uom,onChange:Y=>{const M=I.map(X=>X.id===D.id?{...X,uom:Y.target.value}:X);B(M)},children:s?e.jsx("option",{children:"Loading..."}):t.map(Y=>e.jsx("option",{value:Y.uom_code,children:Y.uom_code},Y.id))})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:D.batchNumber,onChange:Y=>{const M=I.map(X=>X.id===D.id?{...X,batchNumber:Y.target.value}:X);B(M)},placeholder:"Optional"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:D.remarks,onChange:Y=>{const M=I.map(X=>X.id===D.id?{...X,remarks:Y.target.value}:X);B(M)},placeholder:"Optional"})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>T(D.id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})})]},D.id))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/stock-transfers",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",children:o?"Saving...":"Save Transfer"})]})]})})]})})}function AY(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState([]),[u,d]=v.useState(!1),[c,m]=v.useState(null),[h,f]=v.useState(!1),[x,g]=v.useState(""),[b,y]=v.useState(null),[N,j]=v.useState(null),[S,k]=v.useState([]),[P,I]=v.useState(!1),[B,q]=v.useState(null),[Q,O]=v.useState(null);v.useEffect(()=>{let R=!0;return a(!0),i(""),te.get("/inventory/material-requisitions").then(H=>{var W;R&&o(Array.isArray((W=H.data)==null?void 0:W.items)?H.data.items:[])}).catch(H=>{var W,K;R&&i(((K=(W=H==null?void 0:H.response)==null?void 0:W.data)==null?void 0:K.message)||"Failed to load material requisitions")}).finally(()=>{R&&a(!1)}),()=>{R=!1}},[]);const T=R=>({DRAFT:"badge-info",PENDING:"badge-warning",PENDING_APPROVAL:"badge-warning",SUBMITTED:"badge-warning",APPROVED:"badge-success",ISSUED:"badge-success",REJECTED:"badge-error"})[R]||"badge-info",V=v.useMemo(()=>l.filter(R=>{const H=String(R.requisition_no||"").toLowerCase(),W=String(R.requested_by||"").toLowerCase(),K=t.toLowerCase();return H.includes(K)||W.includes(K)}),[l,t]),D=async R=>{var H,W,K,_;if(m(R),d(!0),g(""),B)await Y();else try{f(!0);const F=await te.get("/workflows");q(Array.isArray((H=F.data)==null?void 0:H.items)?F.data.items:[]),await M(Array.isArray((W=F.data)==null?void 0:W.items)?F.data.items:[])}catch(F){g(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load workflows")}finally{f(!1)}},Y=async()=>{var K,_,F;if(!B||!B.length){y(null),j(null),g("");return}const R="/inventory/material-requisitions",H=E=>String(E||"").trim().toUpperCase().replace(/\s+/g,"_"),W=B.find(E=>Number(E.is_active)===1&&String(E.document_route)===R)||B.find(E=>Number(E.is_active)===1&&H(E.document_type)==="MATERIAL_REQUISITION")||null;if(y(W||null),j(null),!!W&&W)try{f(!0);const L=(K=(await te.get(`/workflows/${W.id}`)).data)==null?void 0:K.item,U=Array.isArray(L==null?void 0:L.steps)?L.steps:[];k(U);const J=U[0]||null;if(j(J?{userId:J.approver_user_id,name:J.approver_name,stepName:J.step_name,stepOrder:J.step_order,approvalLimit:J.approval_limit}:null),J){const ae=(Array.isArray(J.approvers)&&J.approvers.length?J.approvers[0].id:J.approver_user_id)||null;O(ae)}else O(null)}catch(E){g(((F=(_=E==null?void 0:E.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to load workflow details")}finally{f(!1)}},M=async R=>{var _,F,E;if(!R||!R.length){y(null),j(null),g("");return}const H="/inventory/material-requisitions",W=L=>String(L||"").trim().toUpperCase().replace(/\s+/g,"_"),K=R.find(L=>Number(L.is_active)===1&&String(L.document_route)===H)||R.find(L=>Number(L.is_active)===1&&W(L.document_type)==="MATERIAL_REQUISITION")||null;if(y(K||null),j(null),!!K)try{f(!0);const U=(_=(await te.get(`/workflows/${K.id}`)).data)==null?void 0:_.item,J=Array.isArray(U==null?void 0:U.steps)?U.steps:[];k(J);const ae=J[0]||null;j(ae?{userId:ae.approver_user_id,name:ae.approver_name,stepName:ae.step_name,stepOrder:ae.step_order,approvalLimit:ae.approval_limit}:null)}catch(L){g(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Failed to load workflow details")}finally{f(!1)}},X=async()=>{var R,H,W;if(c){I(!0),g("");try{const K=await te.post(`/inventory/material-requisitions/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:Q||null}),_=((R=K==null?void 0:K.data)==null?void 0:R.status)||"PENDING_APPROVAL";o(F=>F.map(E=>E.id===c.id?{...E,status:_}:E)),d(!1),m(null)}catch(K){g(((W=(H=K==null?void 0:K.response)==null?void 0:H.data)==null?void 0:W.message)||"Failed to forward for approval")}finally{I(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Material Requisitions"}),e.jsx("p",{className:"text-sm mt-1",children:"Request materials from warehouse inventory"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/material-requisitions/new",className:"btn-success",children:"+ New Requisition"})]})]})}),e.jsxs("div",{className:"card-body",children:[r?e.jsx("div",{className:"text-sm mb-4",children:"Loading..."}):null,n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by requisition number or requested by...",className:"input max-w-md",value:t,onChange:R=>s(R.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Requisition No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Requested By"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:V.map(R=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:R.requisition_no}),e.jsx("td",{children:R.requisition_date}),e.jsx("td",{children:R.requested_by||"-"}),e.jsx("td",{children:R.department_name||"-"}),e.jsx("td",{children:R.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${T(R.status)}`,children:R.status})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/material-requisitions/${R.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/material-requisitions/${R.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"}),R.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",onClick:()=>D(R),className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",disabled:P||R.status==="ISSUED"||R.status==="PENDING_APPROVAL",children:"Forward for Approval"})]})]},R.id))})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),m(null),y(null),j(null),g("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Requisition:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.requisition_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[h?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,x?e.jsx("div",{className:"text-sm text-red-600",children:x}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const H=Array.isArray(S)&&S.length>0?S[0]:null,W=H?Array.isArray(H.approvers)&&H.approvers.length?H.approvers.map(K=>({id:K.id,name:K.username})):H.approver_user_id?[{id:H.approver_user_id,name:H.approver_name||String(H.approver_user_id)}]:[]:[];return W.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:Q||"",onChange:K=>O(K.target.value?Number(K.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),W.map(K=>e.jsx("option",{value:K.id,children:K.name},K.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:N?`Step ${N.stepOrder}  ${N.stepName}${N.approvalLimit!=null?`  Limit: ${Number(N.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),m(null),y(null),j(null),O(null),g("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:X,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function G_(t){if(!t)return new Date().toISOString().split("T")[0];const s=String(t);return s.includes("T")?s.split("T")[0]:s}function hY(){Po();const{id:t}=Ps(),s=Ns(),r=t==="new",[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState([]),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState([]),[y,N]=v.useState(!1),[j,S]=v.useState(""),[k,P]=v.useState({requisitionNo:r?"Auto-generated":"",requisitionDate:new Date().toISOString().split("T")[0],warehouseId:"",departmentId:"",requisitionType:"INTERNAL",priority:"MEDIUM",requestedBy:"",remarks:"",status:"DRAFT"}),[I,B]=v.useState([{id:1,item_id:"",itemCode:"",itemName:"",qtyRequested:0,qtyIssued:0,uom:"PCS"}]);v.useEffect(()=>{let M=!0;return te.get("/admin/users").then(X=>{var R;M&&h(Array.isArray((R=X.data)==null?void 0:R.items)?X.data.items:[])}).catch(X=>console.error("Failed to load users",X)),te.get("/inventory/warehouses").then(X=>{var R;M&&x(Array.isArray((R=X.data)==null?void 0:R.items)?X.data.items:[])}).catch(X=>console.error("Failed to load warehouses",X)),te.get("/admin/departments").then(X=>{var R;M&&b(Array.isArray((R=X.data)==null?void 0:R.items)?X.data.items:[])}).catch(X=>console.error("Failed to load departments",X)),te.get("/inventory/items").then(X=>{var R;M&&c(Array.isArray((R=X.data)==null?void 0:R.items)?X.data.items:[])}).catch(X=>{var R,H;M&&u(((H=(R=X==null?void 0:X.response)==null?void 0:R.data)==null?void 0:H.message)||"Failed to load items")}),()=>{M=!1}},[]),v.useEffect(()=>{if(r)return;let M=!0;return n(!0),u(""),te.get(`/inventory/material-requisitions/${t}`).then(X=>{var W,K;if(!M)return;const R=(W=X.data)==null?void 0:W.item,H=Array.isArray((K=X.data)==null?void 0:K.details)?X.data.details:[];R&&(P({requisitionNo:R.requisition_no||"",requisitionDate:G_(R.requisition_date),warehouseId:R.warehouse_id||"",departmentId:R.department_id||"",requisitionType:R.requisition_type||"INTERNAL",priority:R.priority||"MEDIUM",requestedBy:R.requested_by||"",remarks:R.remarks||"",status:R.status||"DRAFT"}),B(H.length?H.map(_=>({id:_.id||Date.now()+Math.random(),item_id:_.item_id?String(_.item_id):"",itemCode:_.item_code||"",itemName:_.item_name||"",qtyRequested:Number(_.qty_requested)||0,qtyIssued:Number(_.qty_issued)||0,uom:_.uom||"PCS"})):[{id:1,item_id:"",itemCode:"",itemName:"",qtyRequested:0,qtyIssued:0,uom:"PCS"}]))}).catch(X=>{var R,H;M&&u(((H=(R=X==null?void 0:X.response)==null?void 0:R.data)==null?void 0:H.message)||"Failed to load material requisition")}).finally(()=>{M&&n(!1)}),()=>{M=!1}},[t,r]);const q=v.useMemo(()=>I.filter(M=>M.item_id).map(M=>({item_id:Number(M.item_id),qty_requested:Math.max(0,parseInt(M.qtyRequested,10)||0),qty_issued:Number(M.qtyIssued)||0})),[I]),Q={DRAFT:"bg-gray-500 text-white",PENDING:"bg-yellow-400 text-black",PENDING_APPROVAL:"bg-yellow-400 text-black",SUBMITTED:"bg-yellow-300 text-black",APPROVED:"bg-green-500 text-white",ISSUED:"bg-blue-500 text-white",REJECTED:"bg-red-500 text-white"},O=async(M,X)=>{var R,H;M&&M.preventDefault(),l(!0),u("");try{const W={requisition_no:r?void 0:k.requisitionNo,requisition_date:G_(k.requisitionDate),warehouse_id:k.warehouseId||null,department_id:k.departmentId||null,requisition_type:k.requisitionType,priority:k.priority,requested_by:k.requestedBy||null,remarks:k.remarks||null,status:X||k.status,details:q};r?await te.post("/inventory/material-requisitions",W):await te.put(`/inventory/material-requisitions/${t}`,W),s("/inventory/material-requisitions")}catch(W){u(((H=(R=W==null?void 0:W.response)==null?void 0:R.data)==null?void 0:H.message)||"Failed to save material requisition")}finally{l(!1)}},T=()=>{N(!0),S("")},V=M=>{B([...I,{id:Date.now(),item_id:String(M.id),itemCode:M.item_code||"",itemName:M.item_name||"",qtyRequested:0,qtyIssued:0,uom:M.uom||"PCS"}]),N(!1)},D=v.useMemo(()=>{if(!j)return d;const M=j.toLowerCase();return d.filter(X=>X.item_code&&X.item_code.toLowerCase().includes(M)||X.item_name&&X.item_name.toLowerCase().includes(M))},[d,j]),Y=M=>{B(I.filter(X=>X.id!==M))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Material Requisition":"Edit Material Requisition"}),e.jsx("p",{className:"text-sm mt-1",children:"Request materials from warehouse inventory"})]}),e.jsx(Ee,{to:"/inventory/material-requisitions",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[a?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,o?e.jsx("div",{className:"text-sm text-red-600",children:o}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition No"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:k.requisitionNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Date *"}),e.jsx("input",{type:"date",className:"input",value:k.requisitionDate,onChange:M=>P({...k,requisitionDate:M.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Priority"}),e.jsxs("select",{className:"input",value:k.priority,onChange:M=>P({...k,priority:M.target.value}),children:[e.jsx("option",{value:"LOW",children:"Low"}),e.jsx("option",{value:"MEDIUM",children:"Medium"}),e.jsx("option",{value:"HIGH",children:"High"}),e.jsx("option",{value:"CRITICAL",children:"Critical"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"pt-2",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${Q[k.status]||"bg-gray-500 text-white"}`,children:k.status})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Source Warehouse"}),e.jsxs("select",{className:"input",value:k.warehouseId,onChange:M=>P({...k,warehouseId:M.target.value}),children:[e.jsx("option",{value:"",children:"Select Warehouse"}),f.map(M=>e.jsx("option",{value:M.id,children:M.warehouse_name},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Destination Department"}),e.jsxs("select",{className:"input",value:k.departmentId,onChange:M=>P({...k,departmentId:M.target.value}),children:[e.jsx("option",{value:"",children:"Select Department"}),g.map(M=>e.jsx("option",{value:M.id,children:M.name},M.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Type"}),e.jsxs("select",{className:"input",value:k.requisitionType,onChange:M=>P({...k,requisitionType:M.target.value}),children:[e.jsx("option",{value:"INTERNAL",children:"Internal Use"}),e.jsx("option",{value:"PROJECT",children:"Project"}),e.jsx("option",{value:"SALES",children:"Sales Order"}),e.jsx("option",{value:"PRODUCTION",children:"Production"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requested By *"}),e.jsxs("select",{className:"input",value:k.requestedBy,onChange:M=>P({...k,requestedBy:M.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select User"}),m.map(M=>e.jsx("option",{value:M.username,children:M.username},M.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:k.remarks,onChange:M=>P({...k,remarks:M.target.value}),placeholder:"Enter any additional notes..."})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Items"}),e.jsx("button",{type:"button",onClick:T,className:"btn-success text-sm",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty Requested"}),e.jsx("th",{children:"Qty Issued"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:I.map(M=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:M.item_id,onChange:X=>{const R=X.target.value,H=d.find(K=>String(K.id)===String(R)),W=I.map(K=>K.id===M.id?{...K,item_id:R,itemCode:(H==null?void 0:H.item_code)||"",itemName:(H==null?void 0:H.item_name)||""}:K);B(W)},required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),!d.some(X=>String(X.id)===String(M.item_id))&&M.item_id&&e.jsx("option",{value:M.item_id,children:M.itemCode||M.item_id}),d.map(X=>e.jsx("option",{value:X.id,children:X.item_code||X.id},X.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:M.itemName,disabled:!0})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input",value:M.qtyRequested,onChange:X=>{const R=I.map(H=>H.id===M.id?{...H,qtyRequested:Math.max(0,parseInt(X.target.value,10)||0)}:H);B(R)},min:"0",step:"1",inputMode:"numeric",pattern:"[0-9]*"})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input bg-slate-100 dark:bg-slate-700",value:M.qtyIssued,disabled:!0})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:M.uom,onChange:X=>{const R=I.map(H=>H.id===M.id?{...H,uom:X.target.value}:H);B(R)},children:[e.jsx("option",{value:"EA",children:"EA"}),e.jsx("option",{value:"PCS",children:"PCS"}),e.jsx("option",{value:"KG",children:"KG"}),e.jsx("option",{value:"LTR",children:"LTR"}),e.jsx("option",{value:"MTR",children:"MTR"})]})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>Y(M.id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})})]},M.id))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/material-requisitions",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:M=>O(M,"DRAFT"),className:"btn-success",disabled:i,children:i?"Saving...":" Save Draft"}),e.jsx("button",{type:"button",onClick:M=>O(M,"PENDING"),className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition-colors",disabled:i,children:i?"Saving...":" Save as Pending"})]})]})})]}),y&&e.jsx("div",{className:"custom-modal-overlay",onClick:()=>N(!1),children:e.jsxs("div",{className:"custom-modal-content",onClick:M=>M.stopPropagation(),children:[e.jsxs("div",{className:"p-4 bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Select Item"}),e.jsx("button",{onClick:()=>N(!1),className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label",children:"Search Items"}),e.jsx("input",{type:"text",className:"input",placeholder:"Search by item code or name...",value:j,onChange:M=>S(M.target.value),autoFocus:!0})]}),e.jsx("div",{className:"item-list-container flex-1 overflow-y-auto",children:D.length===0?e.jsx("div",{className:"text-center p-4 text-gray-500",children:"No items found"}):D.map(M=>e.jsxs("div",{className:"item-card cursor-pointer hover:bg-slate-100 mb-2 p-3 border rounded",onClick:()=>V(M),children:[e.jsx("div",{className:"font-bold text-brand",children:M.item_code||"N/A"}),e.jsx("div",{className:"text-gray-800",children:M.item_name||"Unnamed Item"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["UOM: ",M.uom||"N/A"]})]},M.id))})]}),e.jsx("div",{className:"p-4 border-t flex justify-end bg-gray-50 rounded-b-lg",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>N(!1),children:"Close"})})]})})]})}function mY(){const[t,s]=v.useState([]),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState(""),[x,g]=v.useState(25),[b,y]=v.useState(1),[N,j]=v.useState({key:"item_code",asc:!0}),S=v.useRef(null);v.useEffect(()=>{let D=!0;return a(!0),i(""),te.get("/inventory/items").then(Y=>{var M;D&&s(Array.isArray((M=Y.data)==null?void 0:M.items)?Y.data.items:[])}).catch(Y=>{var M,X;D&&i(((X=(M=Y==null?void 0:Y.response)==null?void 0:M.data)==null?void 0:X.message)||"Failed to load items")}).finally(()=>{D&&a(!1)}),()=>{D=!1}},[]);const k=v.useMemo(()=>{const D=t.length,Y=t.filter(R=>!!R.is_active).length,M=D-Y,X=t.filter(R=>Number(R.stock_level||0)<=Number(R.reorder_level||-1)&&R.reorder_level!=null).length;return{total:D,active:Y,inactive:M,lowStock:X}},[t]),P=v.useMemo(()=>{const D=l.toLowerCase();return t.filter(Y=>u&&String(Y.item_type||"")!==u||c&&(c==="Y"?!Y.is_active:Y.is_active)||h==="Y"&&!Y.barcode||h==="N"&&Y.barcode?!1:String(Y.item_code||"").toLowerCase().includes(D)||String(Y.item_name||"").toLowerCase().includes(D)||String(Y.barcode||"").toLowerCase().includes(D)).sort((Y,M)=>{const X=Y[N.key],R=M[N.key];if(X==null&&R==null)return 0;if(X==null)return N.asc?-1:1;if(R==null)return N.asc?1:-1;if(typeof X=="number"&&typeof R=="number")return N.asc?X-R:R-X;const H=String(X).toLowerCase(),W=String(R).toLowerCase();return H<W?N.asc?-1:1:H>W?N.asc?1:-1:0})},[t,l,u,c,h,N]),I=Math.max(1,Math.ceil(P.length/x)),B=v.useMemo(()=>{const D=(b-1)*x;return P.slice(D,D+x)},[P,b,x]),q=D=>{j(Y=>Y.key===D?{key:D,asc:!Y.asc}:{key:D,asc:!0})},Q=()=>{S.current&&S.current.click()},O=async D=>{const Y=D.target.files[0];if(!Y)return;const M=new FileReader;M.onload=async X=>{var ee,se,Ae,we,ce,le,_e,Qe;const H=X.target.result.split(`
`),W=H[0].split(",").map(Ie=>Ie.trim()),_=["ITEM_NAME*","ITEM_TYPE*","BASE_UOM*"].filter(Ie=>!W.includes(Ie));if(_.length>0){mt.error(`Invalid CSV format: Missing required header(s): ${_.join(", ")}`);return}let F=0,E=0;const L=[];a(!0);let U=new Map,J=new Map,ae=new Map,Z=new Map,oe=new Map;try{const[Ie,ke,pe,he,je]=await Promise.all([te.get("/inventory/item-categories"),te.get("/inventory/item-groups"),te.get("/finance/currencies"),te.get("/finance/tax-codes"),te.get("/finance/accounts")]),me=Array.isArray((ee=Ie==null?void 0:Ie.data)==null?void 0:ee.items)?Ie.data.items:[],xe=Array.isArray((se=ke==null?void 0:ke.data)==null?void 0:se.items)?ke.data.items:[],Ue=Array.isArray((Ae=pe==null?void 0:pe.data)==null?void 0:Ae.items)?pe.data.items:[],ct=Array.isArray((we=he==null?void 0:he.data)==null?void 0:we.items)?he.data.items:[],dt=Array.isArray((ce=je==null?void 0:je.data)==null?void 0:ce.items)?je.data.items:[];me.forEach(We=>{const He=Number(We.id),ze=String(We.category_code||"").toUpperCase(),Pe=String(We.category_name||"").toUpperCase();He>0&&(ze&&U.set(ze,He),Pe&&U.set(Pe,He))}),xe.forEach(We=>{const He=Number(We.id),ze=String(We.group_code||"").toUpperCase(),Pe=String(We.group_name||"").toUpperCase();He>0&&(ze&&J.set(ze,He),Pe&&J.set(Pe,He))}),Ue.forEach(We=>{const He=Number(We.id),ze=String(We.code||"").toUpperCase(),Pe=String(We.name||"").toUpperCase();He>0&&(ze&&ae.set(ze,He),Pe&&ae.set(Pe,He))}),ct.forEach(We=>{const He=Number(We.id),ze=String(We.code||"").toUpperCase(),Pe=String(We.name||"").toUpperCase();He>0&&(ze&&Z.set(ze,He),Pe&&Z.set(Pe,He))}),dt.forEach(We=>{const He=Number(We.id),ze=String(We.code||"").toUpperCase(),Pe=String(We.name||"").toUpperCase();He>0&&(ze&&oe.set(ze,He),Pe&&oe.set(Pe,He))})}catch{}for(let Ie=1;Ie<H.length;Ie++){const ke=H[Ie].trim();if(!ke)continue;const pe=ke.split(",").map(xe=>xe.trim());if(pe.length<W.length)continue;const he={};W.forEach((xe,Ue)=>{const ct=xe.replace("*","");he[ct]=pe[Ue]});let je=he.ITEM_CODE;if(!je)try{const xe=await te.get("/inventory/items/next-code");(le=xe==null?void 0:xe.data)!=null&&le.nextCode&&(je=xe.data.nextCode)}catch{}const me={item_code:je,item_name:he.ITEM_NAME,item_type:he.ITEM_TYPE,category_id:he.ITEM_CATEGORY&&U.get(String(he.ITEM_CATEGORY).toUpperCase())||he.ITEM_CATEGORY_CODE&&U.get(String(he.ITEM_CATEGORY_CODE).toUpperCase())||he.ITEM_CATEGORY_ID||null,item_group_id:he.ITEM_GROUP&&J.get(String(he.ITEM_GROUP).toUpperCase())||he.ITEM_GROUP_CODE&&J.get(String(he.ITEM_GROUP_CODE).toUpperCase())||he.ITEM_GROUP_ID||null,uom:he.BASE_UOM,barcode:he.BARCODE||null,cost_price:Number(he.STANDARD_COST)||0,selling_price:Number(he.SELLING_PRICE)||0,currency_id:he.CURRENCY_CODE&&ae.get(String(he.CURRENCY_CODE).toUpperCase())||he.CURRENCY_ID||null,description:he.DESCRIPTION,is_stockable:he.IS_STOCKABLE==="Y",is_sellable:he.IS_SELLABLE==="Y",is_purchasable:he.IS_PURCHASABLE==="Y",min_stock_level:Number(he.MIN_STOCK_LEVEL)||0,max_stock_level:Number(he.MAX_STOCK_LEVEL)||0,reorder_level:Number(he.REORDER_LEVEL)||0,safety_stock:Number(he.SAFETY_STOCK)||0,vat_on_purchase_id:he.VAT_PURCHASE_CODE&&Z.get(String(he.VAT_PURCHASE_CODE).toUpperCase())||he.VAT_ON_PURCHASE_ID||null,vat_on_sales_id:he.VAT_SALES_CODE&&Z.get(String(he.VAT_SALES_CODE).toUpperCase())||he.VAT_ON_SALES_ID||null,purchase_account_id:he.PURCHASE_ACCOUNT_CODE&&oe.get(String(he.PURCHASE_ACCOUNT_CODE).toUpperCase())||he.PURCHASE_ACCOUNT_ID||null,sales_account_id:he.SALES_ACCOUNT_CODE&&oe.get(String(he.SALES_ACCOUNT_CODE).toUpperCase())||he.SALES_ACCOUNT_ID||null,is_active:Object.prototype.hasOwnProperty.call(he,"ACTIVE_STATUS")?he.ACTIVE_STATUS==="Y":!0};try{await te.post("/inventory/items",me),F++}catch(xe){E++,L.push(`Row ${Ie+1} (${me.item_code}): ${((Qe=(_e=xe.response)==null?void 0:_e.data)==null?void 0:Qe.message)||xe.message}`)}}a(!1),D.target.value=null,F>0&&(mt.success(`Successfully imported ${F} items`),te.get("/inventory/items").then(Ie=>{var ke;s(Array.isArray((ke=Ie.data)==null?void 0:ke.items)?Ie.data.items:[])})),E>0&&(mt.error(`Failed to import ${E} items`),console.error("Import errors:",L),alert(`Import completed with errors:
`+L.slice(0,10).join(`
`)+(L.length>10?`
...`:"")))},M.readAsText(Y)},T=async()=>{var ae,Z;let D=[],Y=[];try{const[oe,ee]=await Promise.all([te.get("/finance/tax-codes"),te.get("/finance/accounts")]);D=(Array.isArray((ae=oe==null?void 0:oe.data)==null?void 0:ae.items)?oe.data.items:[]).map(se=>String(se.code||"").trim()).filter(Boolean),Y=(Array.isArray((Z=ee==null?void 0:ee.data)==null?void 0:Z.items)?ee.data.items:[]).map(se=>String(se.code||"").trim()).filter(Boolean)}catch{}const M=(oe,ee=0,se="")=>String((oe==null?void 0:oe[ee])||se),X=(oe,ee)=>String((oe==null?void 0:oe.find(se=>String(se).toUpperCase().includes(ee)))||""),R=M(D,0,"VAT"),H=M(D,1,R);let W=X(Y,"PURCHASE")||M(Y,0,"PURCHASE"),K=X(Y,"SALES")||M(Y,1,M(Y,0,"SALES"));const _=["ITEM_NAME*","ITEM_TYPE*","ITEM_CATEGORY","ITEM_GROUP","BASE_UOM*","BARCODE","STANDARD_COST","SELLING_PRICE","CURRENCY_CODE","VAT_PURCHASE_CODE","VAT_SALES_CODE","PURCHASE_ACCOUNT_CODE","SALES_ACCOUNT_CODE","DESCRIPTION","IS_STOCKABLE","IS_SELLABLE","IS_PURCHASABLE","MIN_STOCK_LEVEL","MAX_STOCK_LEVEL","REORDER_LEVEL","SAFETY_STOCK"],F=[["Raw Material 1","RAW_MATERIAL","","","PCS","","100.00","120.00","GHS",R,H,W,K,"Sample raw material","Y","Y","Y","10","100","20","5"],["Finished Good 1","FINISHED_GOOD","","","PCS","5060072082361","150.00","180.00","GHS",R,H,W,K,"Sample finished product","Y","Y","Y","5","50","10","3"]],E=[_.join(","),...F.map(oe=>oe.join(","))].join(`
`),L=new Blob([E],{type:"text/csv;charset=utf-8;"}),U=URL.createObjectURL(L),J=document.createElement("a");J.href=U,J.download="items_bulk_upload_template.csv",document.body.appendChild(J),J.click(),document.body.removeChild(J),setTimeout(()=>URL.revokeObjectURL(U),100)},V=()=>{const Y=[["item_code","item_name","item_type","category_name","uom","barcode","stock_level","cost_price","selling_price","is_active"].join(","),...P.map(H=>[H.item_code??"",H.item_name??"",H.item_type??"",H.category_name??"",H.uom??"",H.barcode??"",H.stock_level??"",H.cost_price??"",H.selling_price??"",H.is_active?"Y":"N"].map(W=>{const K=String(W);return K.includes(",")||K.includes('"')||K.includes(`
`)?`"${K.replace(/"/g,'""')}"`:K}).join(","))].join(`
`),M=new Blob([Y],{type:"text/csv;charset=utf-8;"}),X=URL.createObjectURL(M),R=document.createElement("a");R.href=X,R.download="items_export.csv",document.body.appendChild(R),R.click(),document.body.removeChild(R),setTimeout(()=>URL.revokeObjectURL(X),100)};return v.useEffect(()=>{y(1)},[l,u,c,h,x]),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Items Master"}),e.jsx("p",{className:"text-sm mt-1 text-slate-500 dark:text-slate-400",children:"Configure items, UOM, pricing and barcodes"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap w-full md:w-auto justify-start md:justify-end",children:[e.jsx(Ee,{to:"/inventory",className:"btn-secondary",children:"Return to Menu"}),e.jsx("input",{type:"file",ref:S,onChange:O,className:"hidden",accept:".csv"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Q,children:"Bulk Upload"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:T,children:"Download Template"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:V,children:"Export Items"}),e.jsx(Ee,{to:"/inventory/items/new",className:"btn-primary",children:"+ New Item"})]})]})}),e.jsxs("div",{className:"card-body",children:[n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mb-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, barcode...",className:"input w-full",value:l,onChange:D=>o(D.target.value)})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:u,onChange:D=>d(D.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"RAW_MATERIAL",children:"Raw Material"}),e.jsx("option",{value:"FINISHED_GOOD",children:"Finished Good"}),e.jsx("option",{value:"SEMI_FINISHED",children:"Semi-Finished"}),e.jsx("option",{value:"CONSUMABLE",children:"Consumable"}),e.jsx("option",{value:"SERVICE",children:"Service"})]})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:c,onChange:D=>m(D.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Y",children:"Active"}),e.jsx("option",{value:"N",children:"Inactive"})]})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:h,onChange:D=>f(D.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Y",children:"With Barcode"}),e.jsx("option",{value:"N",children:"Without Barcode"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:k.total}),e.jsx("div",{className:"text-sm text-slate-500",children:"Total Items"})]}),e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:k.active}),e.jsx("div",{className:"text-sm text-slate-500",children:"Active Items"})]}),e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:k.lowStock}),e.jsx("div",{className:"text-sm text-slate-500",children:"Low Stock"})]}),e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:k.inactive}),e.jsx("div",{className:"text-sm text-slate-500",children:"Inactive Items"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",Math.min(B.length,P.length)," of"," ",P.length," items"]}),e.jsx("div",{children:e.jsxs("select",{className:"input",value:x,onChange:D=>g(Number(D.target.value)),children:[e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:25,children:"25 per page"}),e.jsx("option",{value:50,children:"50 per page"}),e.jsx("option",{value:100,children:"100 per page"})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{onClick:()=>q("item_code"),children:"Item Code"}),e.jsx("th",{onClick:()=>q("item_name"),children:"Item Name"}),e.jsx("th",{onClick:()=>q("item_type"),children:"Type"}),e.jsx("th",{onClick:()=>q("category_name"),children:"Category"}),e.jsx("th",{onClick:()=>q("uom"),children:"UOM"}),e.jsx("th",{children:"Barcode"}),e.jsx("th",{onClick:()=>q("stock_level"),children:"Stock Level"}),e.jsx("th",{className:"text-right",onClick:()=>q("cost_price"),children:"Std Cost"}),e.jsx("th",{className:"text-right",onClick:()=>q("selling_price"),children:"Sell Price"}),e.jsx("th",{onClick:()=>q("is_active"),children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!r&&!B.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No items found"})}):null,B.map(D=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:D.item_code}),e.jsx("td",{children:D.item_name}),e.jsx("td",{children:D.item_type_name||D.item_type||"-"}),e.jsx("td",{children:D.category_name||"-"}),e.jsx("td",{children:D.uom}),e.jsx("td",{children:D.barcode||"-"}),e.jsx("td",{children:D.stock_level??"-"}),e.jsx("td",{className:"text-right",children:Number(D.cost_price||0).toFixed(2)}),e.jsx("td",{className:"text-right",children:Number(D.selling_price||0).toFixed(2)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${D.is_active?"badge-success":"badge-error"}`,children:D.is_active?"ACTIVE":"INACTIVE"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/items/${D.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/items/${D.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},D.id))]})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center py-3 border-t gap-4",children:[e.jsxs("div",{className:"text-sm text-slate-600 order-2 md:order-1",children:["Page ",b," of ",I]}),e.jsxs("div",{className:"flex gap-2 items-center order-1 md:order-2",children:[e.jsx("button",{className:"btn-success",disabled:b===1,onClick:()=>y(1),children:""}),e.jsx("button",{className:"btn-success",disabled:b===1,onClick:()=>y(D=>Math.max(1,D-1)),children:""}),e.jsxs("span",{className:"text-sm",children:[(b-1)*x+1,"-",Math.min(b*x,P.length)," of"," ",P.length]}),e.jsx("button",{className:"btn-success",disabled:b===I,onClick:()=>y(D=>Math.min(I,D+1)),children:""}),e.jsx("button",{className:"btn-success",disabled:b===I,onClick:()=>y(I),children:""})]})]})]})]})})}function Ek(){const t=$y(),s=Kc(i=>i.inventoryRef.categories),r=Kc(i=>i.inventoryRef.status.categories),a=Kc(i=>i.inventoryRef.error.categories),n=v.useCallback(()=>{t(Qm())},[t]);return v.useEffect(()=>{(r==="idle"||r==="failed"&&(!Array.isArray(s)||s.length===0))&&t(Qm())},[s,t,r]),{categories:s,loading:r==="loading",error:a,refresh:n}}function Fk(){const t=$y(),s=Kc(i=>i.inventoryRef.itemTypes),r=Kc(i=>{var l;return(l=i.inventoryRef.status)==null?void 0:l.itemTypes}),a=Kc(i=>{var l;return(l=i.inventoryRef.error)==null?void 0:l.itemTypes}),n=v.useCallback(()=>{t(rA())},[t]);return v.useEffect(()=>{const i=Array.isArray(s)&&s.length>0;if(r==null){t(rA());return}if(r==="idle"){t(rA());return}r==="failed"&&!i&&t(rA())},[t,s,r]),{itemTypes:s,loading:r==="loading",error:a,refresh:n}}function Tk({forceNew:t=!1,onSaved:s,initialValues:r}){const{uoms:a,loading:n}=Po(),{categories:i,loading:l}=Ek(),{itemTypes:o,loading:u}=Fk();console.log("ItemForm mounting");const{id:d}=Ps(),c=Ns(),m=t||d==="new",[h,f]=v.useState(!1),[x,g]=v.useState(!1),[b,y]=v.useState(!1),[N,j]=v.useState(""),[S,k]=v.useState([]),[P,I]=v.useState([]),[B,q]=v.useState([]),[Q,O]=v.useState([]),[T,V]=v.useState({item_code:"",item_name:"",uom:"PCS",barcode:"",cost_price:0,selling_price:0,currency_id:"",image_url:"",is_active:!0,item_type:"",category_id:"",item_group_id:"",description:"",min_stock_level:0,max_stock_level:0,reorder_level:0,safety_stock:0,vat_on_purchase_id:"",vat_on_sales_id:"",purchase_account_id:"",sales_account_id:"",is_stockable:!0,is_sellable:!0,is_purchasable:!0});v.useEffect(()=>{if(Promise.all([te.get("/inventory/item-groups"),te.get("/finance/accounts").catch(()=>({data:{items:[]}})),te.get("/finance/tax-codes").catch(()=>({data:{items:[]}})),te.get("/finance/currencies").catch(()=>({data:{items:[]}}))]).then(([X,R,H,W])=>{var K,_,F,E;k(Array.isArray((K=X.data)==null?void 0:K.items)?X.data.items:[]),I(Array.isArray((_=R.data)==null?void 0:_.items)?R.data.items:[]),q(Array.isArray((F=H.data)==null?void 0:F.items)?H.data.items:[]),O(Array.isArray((E=W.data)==null?void 0:E.items)?W.data.items:[])}).catch(()=>{}),m){te.get("/inventory/items/next-code").then(X=>{var R;(R=X.data)!=null&&R.nextCode&&V(H=>{const W={...H,item_code:X.data.nextCode};return r&&typeof r=="object"?{...W,...r}:W})}).catch(()=>{});return}let M=!0;return f(!0),j(""),te.get(`/inventory/items/${d}`).then(X=>{var H;if(!M)return;const R=(H=X.data)==null?void 0:H.item;R&&V({item_code:R.item_code||"",item_name:R.item_name||"",uom:R.uom||"PCS",barcode:R.barcode||"",cost_price:Number(R.cost_price||0),selling_price:Number(R.selling_price||0),currency_id:R.currency_id||"",image_url:R.image_url||"",is_active:!!R.is_active,item_type:R.item_type||"",category_id:R.category_id||"",item_group_id:R.item_group_id||"",description:R.description||"",min_stock_level:Number(R.min_stock_level||0),max_stock_level:Number(R.max_stock_level||0),reorder_level:Number(R.reorder_level||0),safety_stock:Number(R.safety_stock||0),vat_on_purchase_id:R.vat_on_purchase_id||"",vat_on_sales_id:R.vat_on_sales_id||"",purchase_account_id:R.purchase_account_id||"",sales_account_id:R.sales_account_id||"",is_stockable:R.is_stockable??!0,is_sellable:R.is_sellable??!0,is_purchasable:R.is_purchasable??!0})}).catch(X=>{var R,H;M&&j(((H=(R=X==null?void 0:X.response)==null?void 0:R.data)==null?void 0:H.message)||"Failed to load item")}).finally(()=>{M&&f(!1)}),()=>{M=!1}},[d,m]);const D=async M=>{const X=M.target.files[0];if(!X)return;const R=new FormData;R.append("file",X),y(!0);try{const H=await te.post("/upload",R);V(W=>({...W,image_url:H.data.url})),mt.success("Image uploaded successfully")}catch(H){console.error(H),mt.error("Failed to upload image")}finally{y(!1)}},Y=async M=>{var X,R;M.preventDefault(),g(!0),j("");try{const H={item_code:T.item_code,item_name:T.item_name,uom:T.uom,barcode:T.barcode||null,cost_price:Number(T.cost_price)||0,selling_price:Number(T.selling_price)||0,currency_id:T.currency_id||null,is_active:!!T.is_active,item_type:T.item_type||null,category_id:T.category_id||null,item_group_id:T.item_group_id||null,description:T.description||null,min_stock_level:Number(T.min_stock_level)||0,max_stock_level:Number(T.max_stock_level)||0,reorder_level:Number(T.reorder_level)||0,safety_stock:Number(T.safety_stock)||0,vat_on_purchase_id:T.vat_on_purchase_id||null,vat_on_sales_id:T.vat_on_sales_id||null,purchase_account_id:T.purchase_account_id||null,sales_account_id:T.sales_account_id||null,is_stockable:!!T.is_stockable,is_sellable:!!T.is_sellable,is_purchasable:!!T.is_purchasable};if(m){const W=await te.post("/inventory/items",H);if(s)try{s((W==null?void 0:W.data)||{item:H})}catch{}else c("/inventory/items")}else{const W=await te.put(`/inventory/items/${d}`,H);if(s)try{s((W==null?void 0:W.data)||{item:H})}catch{}else c("/inventory/items")}}catch(H){j(((R=(X=H==null?void 0:H.response)==null?void 0:X.data)==null?void 0:R.message)||"Failed to save item")}finally{g(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center text-white gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:m?"New Item":"Edit Item"}),e.jsx("p",{className:"text-sm mt-1",children:"Define item attributes, pricing and stock rules"})]}),e.jsx(Ee,{to:"/inventory/items",className:"btn-success w-full md:w-auto text-center",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[h?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,N?e.jsx("div",{className:"text-sm text-red-600",children:N}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Code * (System Generated)"}),e.jsx("input",{type:"text",className:"input bg-gray-100 cursor-not-allowed",value:T.item_code,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Name *"}),e.jsx("input",{type:"text",className:"input",value:T.item_name,onChange:M=>V({...T,item_name:M.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Barcode"}),e.jsx("input",{type:"text",className:"input",value:T.barcode,onChange:M=>V({...T,barcode:M.target.value}),placeholder:"Scan or enter barcode"})]})]})}),e.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50",children:[T.image_url?e.jsxs("div",{className:"relative w-full h-40 mb-2",children:[e.jsx("img",{src:T.image_url,alt:"Item",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs",onClick:()=>V({...T,image_url:""}),children:""})]}):e.jsxs("div",{className:"text-gray-400 mb-2 flex flex-col items-center",children:[e.jsx("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:"No Image"})]}),e.jsxs("label",{className:`btn-secondary cursor-pointer ${b?"opacity-50 cursor-not-allowed":""}`,children:[b?"Uploading...":"Upload Image",e.jsx("input",{type:"file",className:"hidden",onChange:D,accept:"image/*",disabled:b})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Type *"}),e.jsxs("select",{className:"input",value:T.item_type,onChange:M=>V({...T,item_type:M.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Type --"}),u?e.jsx("option",{children:"Loading..."}):(Array.isArray(o)?o:[]).map(M=>M?e.jsx("option",{value:M.type_code,children:M.type_name},M.id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{className:"input",value:T.category_id,onChange:M=>V({...T,category_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Category --"}),l?e.jsx("option",{children:"Loading..."}):i.map(M=>M?e.jsx("option",{value:M.id,children:M.category_name},M.id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Base UOM"}),e.jsxs("select",{className:"input",value:T.uom,onChange:M=>V({...T,uom:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select UOM --"}),n?e.jsx("option",{children:"Loading..."}):a.map(M=>e.jsx("option",{value:M.uom_code,children:M.uom_code},M.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Group"}),e.jsxs("select",{className:"input",value:T.item_group_id,onChange:M=>V({...T,item_group_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Group --"}),S.map(M=>M?e.jsx("option",{value:M.id,children:M.group_name},M.id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:T.is_active?"ACTIVE":"INACTIVE",onChange:M=>V({...T,is_active:M.target.value==="ACTIVE"}),children:[e.jsx("option",{value:"ACTIVE",children:"ACTIVE"}),e.jsx("option",{value:"INACTIVE",children:"INACTIVE"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cost Price"}),e.jsx("input",{type:"number",className:"input",value:T.cost_price,onChange:M=>V({...T,cost_price:M.target.value}),min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Selling Price"}),e.jsx("input",{type:"number",className:"input",value:T.selling_price,onChange:M=>V({...T,selling_price:M.target.value}),min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:T.currency_id,onChange:M=>V({...T,currency_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Currency --"}),Q.map(M=>e.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},M.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t pt-4",children:[e.jsx("h3",{className:"col-span-full font-semibold text-gray-700",children:"Financial Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"TAX on Purchase"}),e.jsxs("select",{className:"input",value:T.vat_on_purchase_id,onChange:M=>V({...T,vat_on_purchase_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Tax Code --"}),B.map(M=>e.jsxs("option",{value:M.id,children:[M.code," (",Number(M.rate_percent),"%)"]},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"TAX on Sales"}),e.jsxs("select",{className:"input",value:T.vat_on_sales_id,onChange:M=>V({...T,vat_on_sales_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Tax Code --"}),B.map(M=>e.jsxs("option",{value:M.id,children:[M.code," (",Number(M.rate_percent),"%)"]},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Account"}),e.jsxs("select",{className:"input",value:T.purchase_account_id,onChange:M=>V({...T,purchase_account_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Account --"}),P.filter(M=>!M.nature||["EXPENSE","COST_OF_SALES"].includes(M.nature)).map(M=>e.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},M.id)),e.jsx("option",{disabled:!0,children:""}),P.map(M=>e.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},`all-${M.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sales Account"}),e.jsxs("select",{className:"input",value:T.sales_account_id,onChange:M=>V({...T,sales_account_id:M.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Account --"}),P.filter(M=>!M.group_name||M.group_name.toUpperCase().includes("INCOME")||M.group_name.toUpperCase().includes("REVENUE")||M.group_name.toUpperCase().includes("SALES")).map(M=>e.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},M.id)),e.jsx("option",{disabled:!0,children:""}),P.map(M=>e.jsxs("option",{value:M.id,children:[M.code," - ",M.name]},`all-${M.id}`))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("textarea",{className:"input",value:T.description,onChange:M=>V({...T,description:M.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Min Stock Level"}),e.jsx("input",{type:"number",className:"input",value:T.min_stock_level,onChange:M=>V({...T,min_stock_level:M.target.value}),min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Max Stock Level"}),e.jsx("input",{type:"number",className:"input",value:T.max_stock_level,onChange:M=>V({...T,max_stock_level:M.target.value}),min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reorder Level"}),e.jsx("input",{type:"number",className:"input",value:T.reorder_level,onChange:M=>V({...T,reorder_level:M.target.value}),min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Safety Stock"}),e.jsx("input",{type:"number",className:"input",value:T.safety_stock,onChange:M=>V({...T,safety_stock:M.target.value}),min:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:T.is_stockable,onChange:M=>V({...T,is_stockable:M.target.checked})}),e.jsx("span",{children:"Is Stockable"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:T.is_sellable,onChange:M=>V({...T,is_sellable:M.target.checked})}),e.jsx("span",{children:"Is Sellable"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:T.is_purchasable,onChange:M=>V({...T,is_purchasable:M.target.checked})}),e.jsx("span",{children:"Is Purchasable"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse md:flex-row justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/items",className:"btn-secondary w-full md:w-auto text-center",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary w-full md:w-auto",disabled:x,children:x?"Saving...":"Save Item"})]})]})})]})})}function fY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let d=!0;return i(!0),o(""),te.get("/inventory/warehouses").then(c=>{var m;d&&a(Array.isArray((m=c.data)==null?void 0:m.items)?c.data.items:[])}).catch(c=>{var m,h;d&&o(((h=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load warehouses")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=v.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.warehouse_code||"").toLowerCase().includes(d)||String(c.warehouse_name||"").toLowerCase().includes(d)||String(c.location||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Warehouse Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure warehouses for stock operations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/warehouses/new",className:"btn-success",children:"+ New Warehouse"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, location...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No warehouses found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.warehouse_code}),e.jsx("td",{children:d.warehouse_name}),e.jsx("td",{children:d.location||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d.is_active?"badge-success":"badge-error"}`,children:d.is_active?"ACTIVE":"INACTIVE"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/warehouses/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/warehouses/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function pY(){const{id:t}=Ps(),s=Ns(),r=t==="new",{scope:a}=Qa(),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState({warehouse_code:"",warehouse_name:"",location:"",is_active:!0}),[h,f]=v.useState([]),[x,g]=v.useState(""),[b,y]=v.useState("");v.useEffect(()=>{let j=!0;return d(""),te.get("/admin/branches").then(S=>{var I;if(!j)return;const k=Array.isArray((I=S.data)==null?void 0:I.items)?S.data.items:[];f(k);const P=String((a==null?void 0:a.branchId)||"")||(k.length?String(k[0].id):"");g(P)}).catch(()=>{}),()=>{j=!1}},[a==null?void 0:a.branchId]),v.useEffect(()=>{if(r)return;let j=!0;return i(!0),d(""),te.get(`/inventory/warehouses/${t}`).then(S=>{var P;if(!j)return;const k=(P=S.data)==null?void 0:P.item;k&&(m({warehouse_code:k.warehouse_code||"",warehouse_name:k.warehouse_name||"",location:k.location||"",is_active:!!k.is_active}),k.branch_id&&(g(String(k.branch_id)),y(String(k.branch_id))))}).catch(S=>{var k,P;j&&d(((P=(k=S==null?void 0:S.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to load warehouse")}).finally(()=>{j&&i(!1)}),()=>{j=!1}},[t,r]);const N=async j=>{var S,k;j.preventDefault(),o(!0),d("");try{if(!x)throw new Error("Select a branch for this warehouse");const P=h.find(q=>String(q.id)===String(x)),I=P?Number(P.company_id):void 0,B={warehouse_code:c.warehouse_code,warehouse_name:c.warehouse_name,location:c.location||null,is_active:!!c.is_active};r?await te.post("/inventory/warehouses",B,{headers:{"x-branch-id":String(x),...I?{"x-company-id":String(I)}:{}}}):(b&&String(b)!==String(x)&&await te.put(`/inventory/warehouses/${t}/link-branch`,{branch_id:Number(x)},{headers:{...I?{"x-company-id":String(I)}:{}}}),await te.put(`/inventory/warehouses/${t}`,B,{headers:{"x-branch-id":String(x),...I?{"x-company-id":String(I)}:{}}})),s("/inventory/warehouses")}catch(P){d(((k=(S=P==null?void 0:P.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to save warehouse")}finally{o(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Warehouse":"Edit Warehouse"}),e.jsx("p",{className:"text-sm mt-1",children:"Maintain warehouse master data"})]}),e.jsx(Ee,{to:"/inventory/warehouses",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[n?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,u?e.jsx("div",{className:"text-sm text-red-600",children:u}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branch *"}),e.jsxs("select",{className:"input",value:x,onChange:j=>g(j.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select a branch"}),h.map(j=>e.jsxs("option",{value:String(j.id),children:[j.name," (",j.company_name||`Company #${j.company_id}`,")"]},j.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse Code *"}),e.jsx("input",{type:"text",className:"input",value:c.warehouse_code,onChange:j=>m({...c,warehouse_code:j.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse Name *"}),e.jsx("input",{type:"text",className:"input",value:c.warehouse_name,onChange:j=>m({...c,warehouse_name:j.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("input",{type:"text",className:"input",value:c.location,onChange:j=>m({...c,location:j.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:c.is_active?"ACTIVE":"INACTIVE",onChange:j=>m({...c,is_active:j.target.value==="ACTIVE"}),children:[e.jsx("option",{value:"ACTIVE",children:"ACTIVE"}),e.jsx("option",{value:"INACTIVE",children:"INACTIVE"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/warehouses",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:l,children:l?"Saving...":"Save Warehouse"})]})]})})]})})}function xY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState(!1),[c,m]=v.useState(!1),[h,f]=v.useState(""),[x,g]=v.useState(null),[b,y]=v.useState(null),[N,j]=v.useState([]),[S,k]=v.useState(null),[P,I]=v.useState(null),[B,q]=v.useState(null),[Q,O]=v.useState(null),[T,V]=v.useState(!1),[D,Y]=v.useState(!1),[M,X]=v.useState(""),[R,H]=v.useState(null),[W,K]=v.useState([]),[_,F]=v.useState("");v.useEffect(()=>{let ee=!0;return i(!0),o(""),te.get("/inventory/grn",{params:{grn_type:"LOCAL"}}).then(se=>{var Ae;ee&&a(Array.isArray((Ae=se.data)==null?void 0:Ae.items)?se.data.items:[])}).catch(se=>{var Ae,we;ee&&o(((we=(Ae=se==null?void 0:se.response)==null?void 0:Ae.data)==null?void 0:we.message)||"Failed to load GRNs")}).finally(()=>{ee&&i(!1)}),()=>{ee=!1}},[]);const E=v.useMemo(()=>{const ee=t.toLowerCase();return r.filter(se=>String(se.grn_no||"").toLowerCase().includes(ee)||String(se.supplier_name||"").toLowerCase().includes(ee)||String(se.status||"").toLowerCase().includes(ee))},[r,t]),L=ee=>{const se=String(ee||"").toUpperCase();return se!=="PENDING_APPROVAL"&&se!=="APPROVED"&&se!=="CANCELLED"},U=async ee=>{var se,Ae,we,ce,le,_e;I(null),d(!0),f("");try{const Qe=await te.get(`/inventory/grn/${ee.id}`),Ie=((se=Qe==null?void 0:Qe.data)==null?void 0:se.item)||{},ke=Ie==null?void 0:Ie.invoice_amount,pe=ke===""||ke==null?null:Number(ke||0);I({id:ee.id,grn_no:ee.grn_no,invoice_amount:pe,status:ee.status})}catch(Qe){f(((we=(Ae=Qe==null?void 0:Qe.response)==null?void 0:Ae.data)==null?void 0:we.message)||"Failed to load GRN")}if(x)await J();else try{m(!0);const Qe=await te.get("/workflows"),Ie=Array.isArray((ce=Qe.data)==null?void 0:ce.items)?Qe.data.items:[];g(Ie),await ae(Ie)}catch(Qe){f(((_e=(le=Qe==null?void 0:Qe.response)==null?void 0:le.data)==null?void 0:_e.message)||"Failed to load workflows")}finally{m(!1)}},J=async()=>{var we,ce,le;if(!x||!x.length){y(null),k(null),f("");return}const ee="/inventory/grn-local",se=_e=>String(_e||"").trim().toUpperCase().replace(/\s+/g,"_"),Ae=x.find(_e=>Number(_e.is_active)===1&&String(_e.document_route)===ee)||x.find(_e=>Number(_e.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(se(_e.document_type)))||null;if(y(Ae||null),k(null),!!Ae)try{m(!0);const Qe=(we=(await te.get(`/workflows/${Ae.id}`)).data)==null?void 0:we.item,Ie=Array.isArray(Qe==null?void 0:Qe.steps)?Qe.steps:[];j(Ie);const ke=Ie[0]||null;if(k(ke?{userId:ke.approver_user_id,name:ke.approver_name,stepName:ke.step_name,stepOrder:ke.step_order,approvalLimit:ke.approval_limit}:null),ke){const pe=(Array.isArray(ke.approvers)&&ke.approvers.length?ke.approvers[0].id:ke.approver_user_id)||null;q(pe)}else q(null)}catch(_e){f(((le=(ce=_e==null?void 0:_e.response)==null?void 0:ce.data)==null?void 0:le.message)||"Failed to load workflow details")}finally{m(!1)}},ae=async ee=>{var ce,le,_e;if(!ee||!ee.length){y(null),k(null),f("");return}const se="/inventory/grn-local",Ae=Qe=>String(Qe||"").trim().toUpperCase().replace(/\s+/g,"_"),we=ee.find(Qe=>Number(Qe.is_active)===1&&String(Qe.document_route)===se)||ee.find(Qe=>Number(Qe.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(Ae(Qe.document_type)))||null;if(y(we||null),k(null),!!we)try{m(!0);const Ie=(ce=(await te.get(`/workflows/${we.id}`)).data)==null?void 0:ce.item,ke=Array.isArray(Ie==null?void 0:Ie.steps)?Ie.steps:[];j(ke);const pe=ke[0]||null;if(k(pe?{userId:pe.approver_user_id,name:pe.approver_name,stepName:pe.step_name,stepOrder:pe.step_order,approvalLimit:pe.approval_limit}:null),pe){const he=(Array.isArray(pe.approvers)&&pe.approvers.length?pe.approvers[0].id:pe.approver_user_id)||null;q(he)}else q(null)}catch(Qe){f(((_e=(le=Qe==null?void 0:Qe.response)==null?void 0:le.data)==null?void 0:_e.message)||"Failed to load workflow details")}finally{m(!1)}},Z=async()=>{var ee,se;if(P){O(P.id),f("");try{await te.post(`/inventory/grn/${P.id}/submit`,{amount:P.invoice_amount,workflow_id:b?b.id:null,target_user_id:B||null}),a(Ae=>Ae.map(we=>we.id===P.id?{...we,status:"PENDING_APPROVAL"}:we)),d(!1)}catch(Ae){f(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to forward for approval")}finally{O(null)}}},oe=async ee=>{var se,Ae,we,ce;V(!0),Y(!0),X(""),H(null),K([]),F("");try{const le=await te.get(`/inventory/grn/${ee.id}`),_e=((se=le==null?void 0:le.data)==null?void 0:se.item)||{},Qe=Array.isArray(_e==null?void 0:_e.details)?_e.details:[];H(_e),K(Qe);const Ie=Number((_e==null?void 0:_e.po_id)||0)||0;if(Ie)try{const ke=await te.get("/purchase/orders"),he=(Array.isArray((Ae=ke==null?void 0:ke.data)==null?void 0:Ae.items)?ke.data.items:[]).find(je=>Number(je.id)===Ie);F(he?he.po_no||String(he.id):String(Ie))}catch{F(String(Ie))}}catch(le){X(((ce=(we=le==null?void 0:le.response)==null?void 0:we.data)==null?void 0:ce.message)||"Failed to load GRN details")}finally{Y(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Material Receipt (GRN) - Local"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive local purchase deliveries"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/grn-local/new",className:"btn-success",children:"+ New GRN"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by GRN no, supplier, status...",className:"input max-w-md",value:t,onChange:ee=>s(ee.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!E.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No GRNs found"})}):null,E.map(ee=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:ee.grn_no}),e.jsx("td",{children:ee.grn_date?String(ee.grn_date).slice(0,10):"-"}),e.jsx("td",{children:ee.supplier_name||"-"}),e.jsx("td",{children:ee.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:ee.status||"DRAFT"})}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/inventory/grn-local/${ee.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx("button",{type:"button",className:"text-brand hover:text-brand-700 text-sm font-medium",onClick:()=>oe(ee),children:"Details"}),String(ee.status||"").toUpperCase()!=="APPROVED"&&e.jsx(Ee,{to:`/inventory/grn-local/${ee.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"})]}),String(ee.status||"").toUpperCase()==="APPROVED"?e.jsx("span",{className:"ml-2 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:()=>U(ee),disabled:Q===ee.id||!L(ee.status),children:Q===ee.id?"Forwarding...":"Forward for Approval"})]})]},ee.id))]})]})})]})]}),u?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),y(null),k(null),f("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:P==null?void 0:P.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:c?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:h?e.jsx("div",{className:"text-sm text-red-600",children:h}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const se=Array.isArray(N)&&N.length>0?N[0]:null,Ae=se?Array.isArray(se.approvers)&&se.approvers.length?se.approvers.map(we=>({id:we.id,name:we.username})):se.approver_user_id?[{id:se.approver_user_id,name:se.approver_name||String(se.approver_user_id)}]:[]:[];return Ae.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:B||"",onChange:we=>q(we.target.value?Number(we.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Ae.map(we=>e.jsx("option",{value:we.id,children:we.name},we.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),y(null),k(null),f("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:Z,disabled:Q!=null,children:Q!=null?"Forwarding...":"Forward"})]})]})}):null,T?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[900px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"View GRN Details"}),e.jsx("button",{type:"button",onClick:()=>{V(!1),H(null),K([]),X("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[D?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,M?e.jsx("div",{className:"text-sm text-red-600",children:M}):null,R?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"GRN No"}),e.jsx("div",{className:"font-semibold",children:R.grn_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("div",{className:"font-semibold",children:R.grn_date?String(R.grn_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-semibold",children:R.supplier_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-semibold",children:R.warehouse_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),e.jsx("div",{className:"font-semibold",children:R.status||"DRAFT"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Purchase Order"}),e.jsx("div",{className:"font-semibold",children:_||(R.po_id?String(R.po_id):"-")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery No"}),e.jsx("div",{className:"font-semibold",children:R.delivery_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery Date"}),e.jsx("div",{className:"font-semibold",children:R.delivery_date?String(R.delivery_date).slice(0,10):"-"})]})]}):null,e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Remarks"})]})}),e.jsxs("tbody",{children:[W.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No item details"})}),W.map((ee,se)=>{const Ae=ee.line_amount==null||ee.line_amount===""?Number(ee.qty_accepted||0)*Number(ee.unit_price||0):Number(ee.line_amount||0);return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:ee.item_code||""}),e.jsx("td",{children:ee.item_name||""}),e.jsx("td",{children:ee.qty_ordered??""}),e.jsx("td",{children:ee.qty_received??""}),e.jsx("td",{children:ee.qty_accepted??""}),e.jsx("td",{children:ee.uom||""}),e.jsx("td",{children:Number(ee.unit_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:Number(Ae||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:ee.batch_serial||ee.batch_number||""}),e.jsx("td",{children:ee.remarks||""})]},se)})]})]})})]}),e.jsx("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{V(!1),H(null),K([]),X("")},children:"Close"})})]})}):null]})}function Gu(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function gY(){const{id:t}=Ps(),s=Ns(),r=Ba(),a=t==="new",n=!!t&&t!=="new"&&(r.pathname.includes("/edit")||(()=>{try{const he=new URLSearchParams(r.search||""),je=String(he.get("mode")||"").toLowerCase(),me=String(he.get("edit")||"").toLowerCase();return je==="edit"||me==="1"||me==="true"}catch{return!1}})()),i=!!t&&t!=="new"&&!n,[l,o]=v.useState(!1),[u,d]=v.useState(!1),[c,m]=v.useState(""),[h,f]=v.useState(!1),[x,g]=v.useState(!1),[b,y]=v.useState(""),[N,j]=v.useState(null),[S,k]=v.useState(null),[P,I]=v.useState([]),[B,q]=v.useState(!1),[Q,O]=v.useState(null),[T,V]=v.useState(null),[D,Y]=v.useState([]),[M,X]=v.useState([]),[R,H]=v.useState([]),[W,K]=v.useState([]),{uoms:_}=Po(),[F,E]=v.useState([]),[L,U]=v.useState({grn_no:"",grn_date:Gu(new Date),supplier_id:"",warehouse_id:"",po_id:"",invoice_no:"",invoice_date:"",invoice_amount:"",invoice_due_date:"",delivery_number:"",delivery_date:"",status:"DRAFT",remarks:"",details:[]}),J=String(L.status||"").toUpperCase()==="APPROVED",ae=i&&J,Z=v.useRef(a);v.useEffect(()=>{let he=!0;return m(""),Promise.all([te.get("/inventory/items"),te.get("/purchase/suppliers"),te.get("/inventory/warehouses"),te.get("/purchase/orders",{params:{status:"APPROVED"}}),te.get("/sales/prices/standard")]).then(([je,me,xe,Ue,ct])=>{var We,He,ze,Pe,Te;if(!he)return;Y(Array.isArray((We=je.data)==null?void 0:We.items)?je.data.items:[]),X(Array.isArray((He=me.data)==null?void 0:He.items)?me.data.items.filter(Ke=>String(Ke.supplier_type||"").toUpperCase()==="LOCAL"):[]),H(Array.isArray((ze=xe.data)==null?void 0:ze.items)?xe.data.items:[]);const dt=Array.isArray((Pe=Ue.data)==null?void 0:Pe.items)?Ue.data.items:[];K(dt.filter(Ke=>String(Ke.po_type||"").toUpperCase()==="LOCAL"&&String(Ke.status||"").toUpperCase()==="APPROVED")),E(Array.isArray((Te=ct.data)==null?void 0:Te.items)?ct.data.items:[])}).catch(je=>{var me,xe;he&&m(((xe=(me=je==null?void 0:je.response)==null?void 0:me.data)==null?void 0:xe.message)||"Failed to load lookups")}),()=>{he=!1}},[]);const oe=v.useMemo(()=>{const he=Array.isArray(_)?_:[],je=he.find(me=>String(me.uom_code||"").toUpperCase()==="PCS")||he[0];return je&&je.uom_code?je.uom_code:"PCS"},[_]);v.useCallback((he,je)=>{const me=Array.isArray(F)?F:[],xe=String(he||""),Ue=je?String(je):"",ct=me.filter(He=>String(He.product_id)===xe&&(Ue?String(He.uom||"")===Ue:!0)).sort((He,ze)=>{const Pe=He.effective_date?new Date(He.effective_date).getTime():0;return(ze.effective_date?new Date(ze.effective_date).getTime():0)-Pe||new Date(ze.created_at).getTime()-new Date(He.created_at).getTime()});if(ct.length>0&&ct[0].cost_price!=null)return String(ct[0].cost_price);const dt=me.filter(He=>String(He.product_id)===xe).sort((He,ze)=>{const Pe=He.effective_date?new Date(He.effective_date).getTime():0;return(ze.effective_date?new Date(ze.effective_date).getTime():0)-Pe||new Date(ze.created_at).getTime()-new Date(He.created_at).getTime()});if(dt.length>0&&dt[0].cost_price!=null)return String(dt[0].cost_price);const We=(Array.isArray(D)?D:[]).find(He=>String(He.id)===xe);return We&&We.cost_price!=null?String(We.cost_price):""},[F,D]),v.useMemo(()=>{const he=new Map;for(const je of Array.isArray(F)?F:[]){const me=String(je.product_id);he.has(me)||he.set(me,je)}return he},[F]),v.useEffect(()=>{a&&te.get("/inventory/grn/next-no?type=LOCAL").then(he=>{var je;(je=he.data)!=null&&je.nextNo&&U(me=>({...me,grn_no:he.data.nextNo}))}).catch(console.error)},[a]),v.useEffect(()=>{if(a)return;let he=!0;return o(!0),m(""),te.get(`/inventory/grn/${t}`).then(je=>{var Ue;if(!he)return;const me=(Ue=je.data)==null?void 0:Ue.item,xe=Array.isArray(me==null?void 0:me.details)?me.details:[];me&&(U({grn_no:me.grn_no||"",grn_date:Gu(me.grn_date),supplier_id:me.supplier_id?String(me.supplier_id):"",warehouse_id:me.warehouse_id?String(me.warehouse_id):"",po_id:me.po_id?String(me.po_id):"",invoice_no:me.invoice_no||"",invoice_date:Gu(me.invoice_date),invoice_amount:me.invoice_amount!=null?String(me.invoice_amount):"",invoice_due_date:Gu(me.invoice_due_date),delivery_number:me.delivery_number||"",delivery_date:Gu(me.delivery_date),status:me.status||"DRAFT",remarks:me.remarks||"",details:xe.map(ct=>({item_id:ct.item_id?String(ct.item_id):"",qty_ordered:ct.qty_ordered??"",qty_received:ct.qty_received??"",qty_accepted:ct.qty_accepted??"",qty_rejected:ct.qty_rejected??"",uom:ct.uom||"",unit_price:ct.unit_price!=null?String(ct.unit_price):"",amount:ct.line_amount!=null?String(ct.line_amount):(()=>{const dt=ct.unit_price!=null?Number(ct.unit_price):0,We=ct.qty_accepted!=null?Number(ct.qty_accepted):ct.qty_received!=null?Number(ct.qty_received):ct.qty_ordered!=null?Number(ct.qty_ordered):0;return String(Number(We||0)*Number(dt||0))})(),batch_serial:ct.batch_serial||ct.batch_number||"",mfg_date:Gu(ct.mfg_date),expiry_date:Gu(ct.expiry_date),inspection_status:ct.inspection_status||"PENDING",line_remarks:ct.remarks||""}))}),Z.current=!1,me.po_id&&te.get(`/purchase/orders/${me.po_id}`).then(ct=>{var We;const dt=(We=ct.data)==null?void 0:We.item;dt&&K(He=>He.some(Pe=>String(Pe.id)===String(dt.id))?He:[...He,dt])}).catch(()=>{}))}).catch(je=>{var me,xe;he&&m(((xe=(me=je==null?void 0:je.response)==null?void 0:me.data)==null?void 0:xe.message)||"Failed to load GRN")}).finally(()=>{he&&o(!1)}),()=>{he=!1}},[t,a]);const ee=v.useMemo(()=>{const he=new Map;for(const je of D)he.set(String(je.id),je);return he},[D]),se=v.useMemo(()=>{const he=L.supplier_id?String(L.supplier_id):"";return he?W.filter(je=>String(je.supplier_id)===he):W},[W,L.supplier_id]);v.useEffect(()=>{if(!L.po_id||!a)return;se.some(je=>String(je.id)===String(L.po_id))||U(je=>({...je,po_id:""}))},[se,L.po_id]);const Ae=()=>{U(he=>{var je,me,xe;return{...he,details:[...he.details,{item_id:(je=D[0])!=null&&je.id?String(D[0].id):"",qty_ordered:"",qty_received:"",uom:((me=D[0])==null?void 0:me.uom)&&String(D[0].uom)||(oe?String(oe):""),unit_price:String(((xe=D[0])==null?void 0:xe.cost_price)??"")}]}})},we=he=>{U(je=>({...je,details:je.details.filter((me,xe)=>xe!==he)}))},ce=(he,je)=>{U(me=>{const xe=me.details.map((Pe,Te)=>Te===he?{...Pe,...je}:Pe);let Ue=xe[he];if(Object.prototype.hasOwnProperty.call(je,"item_id")){const Pe=ee.get(String(je.item_id)),Te=(Pe==null?void 0:Pe.uom)&&String(Pe.uom)||Ue.uom&&String(Ue.uom)||(oe?String(oe):""),Ke=String((Pe==null?void 0:Pe.cost_price)??"");Ue={...Ue,uom:Te,unit_price:Ke},xe[he]=Ue}const ct=Ue.unit_price===""?0:Number(Ue.unit_price||0),dt=Ue.qty_accepted===""||Ue.qty_accepted==null?null:Number(Ue.qty_accepted||0),We=Ue.qty_received===""||Ue.qty_received==null?null:Number(Ue.qty_received||0),He=Ue.qty_ordered===""||Ue.qty_ordered==null?null:Number(Ue.qty_ordered||0),ze=dt??null??We??null??He??0;return xe[he]={...Ue,amount:String(Number(ze||0)*ct)},{...me,details:xe}})},le=(he,je)=>{const me=je?ee.get(String(je)):null,xe=(me==null?void 0:me.uom)&&String(me.uom)||(oe?String(oe):""),Ue=String((me==null?void 0:me.cost_price)??"");ce(he,{item_id:je,uom:xe,unit_price:Ue})};v.useEffect(()=>{if(!L.po_id||!Z.current)return;let he=!0;return o(!0),te.get(`/purchase/orders/${L.po_id}`).then(je=>{var Ue,ct,dt;if(!he)return;const me=(Ue=je.data)==null?void 0:Ue.item,xe=Array.isArray((dt=(ct=je.data)==null?void 0:ct.item)==null?void 0:dt.details)?je.data.item.details:[];me&&U(We=>({...We,supplier_id:me.supplier_id?String(me.supplier_id):We.supplier_id,warehouse_id:me.warehouse_id?String(me.warehouse_id):We.warehouse_id,details:xe.map(He=>{const ze=D.find(Pe=>String(Pe.id)===String(He.item_id));return{item_id:He.item_id?String(He.item_id):"",qty_ordered:He.qty??"",qty_received:"",qty_accepted:"",qty_rejected:"",uom:(ze==null?void 0:ze.uom)||"",unit_price:String((ze==null?void 0:ze.cost_price)??""),amount:"",batch_serial:"",mfg_date:"",expiry_date:"",inspection_status:"PENDING",line_remarks:""}})}))}).catch(je=>{var me,xe;m(((xe=(me=je==null?void 0:je.response)==null?void 0:me.data)==null?void 0:xe.message)||"Failed to load PO details")}).finally(()=>{he&&o(!1)}),()=>{he=!1}},[L.po_id]);const _e=async he=>{var je,me;he.preventDefault(),d(!0),m("");try{const xe={grn_no:L.grn_no||null,grn_date:L.grn_date,grn_type:"LOCAL",supplier_id:L.supplier_id?Number(L.supplier_id):null,warehouse_id:L.warehouse_id?Number(L.warehouse_id):null,po_id:L.po_id?Number(L.po_id):null,invoice_no:L.invoice_no||null,invoice_date:L.invoice_date||null,invoice_amount:L.invoice_amount===""||L.invoice_amount==null?null:Number(L.invoice_amount),invoice_due_date:L.invoice_due_date||null,delivery_number:L.delivery_number||null,delivery_date:L.delivery_date||null,remarks:L.remarks||null,details:(L.details||[]).map(Ue=>({item_id:Ue.item_id?Number(Ue.item_id):null,qty_ordered:Ue.qty_ordered===""?null:Number(Ue.qty_ordered),qty_received:Ue.qty_received===""?null:Number(Ue.qty_received),qty_accepted:Ue.qty_accepted===""?null:Number(Ue.qty_accepted),uom:Ue.uom||null,unit_price:Ue.unit_price===""?null:Number(Ue.unit_price),line_amount:Ue.amount===""?null:Number(Ue.amount),batch_serial:Ue.batch_serial||null,mfg_date:Ue.mfg_date||null,expiry_date:Ue.expiry_date||null,inspection_status:Ue.inspection_status||"PENDING",remarks:Ue.line_remarks||null}))};if(!xe.grn_date||!xe.supplier_id)throw new Error("GRN date and supplier are required");if(!xe.po_id)throw new Error("Purchase order is required");if(!xe.invoice_no||!xe.invoice_date)throw new Error("Invoice number and date are required");a?await te.post("/inventory/grn",xe):await te.put(`/inventory/grn/${t}`,xe),s("/inventory/grn-local")}catch(xe){m(((me=(je=xe==null?void 0:xe.response)==null?void 0:je.data)==null?void 0:me.message)||(xe==null?void 0:xe.message)||"Failed to save GRN")}finally{d(!1)}},Qe=async()=>{var he,je,me;if(!a){q(!0),y("");try{const xe=await te.post(`/inventory/grn/${t}/submit`,{amount:L.invoice_amount===""||L.invoice_amount==null?null:Number(L.invoice_amount||0),workflow_id:N?N.id:null,target_user_id:T||null}),Ue=((he=xe==null?void 0:xe.data)==null?void 0:he.status)||"PENDING_APPROVAL";U(ct=>({...ct,status:Ue})),f(!1)}catch(xe){y(((me=(je=xe==null?void 0:xe.response)==null?void 0:je.data)==null?void 0:me.message)||"Failed to forward for approval")}finally{q(!1)}}},Ie=async()=>{var he,je,me;if(!a)if(f(!0),y(""),Q)await ke();else try{g(!0);const xe=await te.get("/workflows"),Ue=Array.isArray((he=xe.data)==null?void 0:he.items)?xe.data.items:[];O(Ue),await pe(Ue)}catch(xe){y(((me=(je=xe==null?void 0:xe.response)==null?void 0:je.data)==null?void 0:me.message)||"Failed to load workflows")}finally{g(!1)}},ke=async()=>{var xe,Ue,ct;if(!Q||!Q.length){j(null),k(null),y("");return}const he="/inventory/grn-local",je=dt=>String(dt||"").trim().toUpperCase().replace(/\s+/g,"_"),me=Q.find(dt=>Number(dt.is_active)===1&&String(dt.document_route)===he)||Q.find(dt=>Number(dt.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(je(dt.document_type)))||null;if(j(me||null),k(null),!!me)try{g(!0);const We=(xe=(await te.get(`/workflows/${me.id}`)).data)==null?void 0:xe.item,He=Array.isArray(We==null?void 0:We.steps)?We.steps:[];I(He);const ze=He[0]||null;if(k(ze?{userId:ze.approver_user_id,name:ze.approver_name,stepName:ze.step_name,stepOrder:ze.step_order,approvalLimit:ze.approval_limit}:null),ze){const Pe=(Array.isArray(ze.approvers)&&ze.approvers.length?ze.approvers[0].id:ze.approver_user_id)||null;V(Pe)}else V(null)}catch(dt){y(((ct=(Ue=dt==null?void 0:dt.response)==null?void 0:Ue.data)==null?void 0:ct.message)||"Failed to load workflow details")}finally{g(!1)}},pe=async he=>{var Ue,ct,dt;if(!he||!he.length){j(null),k(null),y("");return}const je="/inventory/grn-local",me=We=>String(We||"").trim().toUpperCase().replace(/\s+/g,"_"),xe=he.find(We=>Number(We.is_active)===1&&String(We.document_route)===je)||he.find(We=>Number(We.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(me(We.document_type)))||null;if(j(xe||null),k(null),!!xe)try{g(!0);const He=(Ue=(await te.get(`/workflows/${xe.id}`)).data)==null?void 0:Ue.item,ze=Array.isArray(He==null?void 0:He.steps)?He.steps:[];I(ze);const Pe=ze[0]||null;if(k(Pe?{userId:Pe.approver_user_id,name:Pe.approver_name,stepName:Pe.step_name,stepOrder:Pe.step_order,approvalLimit:Pe.approval_limit}:null),Pe){const Te=(Array.isArray(Pe.approvers)&&Pe.approvers.length?Pe.approvers[0].id:Pe.approver_user_id)||null;V(Te)}else V(null)}catch(We){y(((dt=(ct=We==null?void 0:We.response)==null?void 0:ct.data)==null?void 0:dt.message)||"Failed to load workflow details")}finally{g(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:a?"New GRN (Local)":i?"View GRN (Local)":"Edit GRN (Local)"}),e.jsx("p",{className:"text-sm mt-1",children:"Goods receipt note for local purchases"})]}),e.jsx(Ee,{to:"/inventory/grn-local",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("form",{onSubmit:_e,className:"space-y-6",children:e.jsxs("fieldset",{disabled:i,className:i?"disabled-light-blue":"",children:[l?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,c?e.jsx("div",{className:"text-sm text-red-600",children:c}):null,e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN No"}),e.jsx("input",{type:"text",className:"input w-full",value:L.grn_no,onChange:he=>U({...L,grn_no:he.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN Date *"}),e.jsx("input",{type:"date",className:"input w-full",value:L.grn_date,onChange:he=>U({...L,grn_date:he.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input w-full",value:L.warehouse_id,onChange:he=>U({...L,warehouse_id:he.target.value}),children:[e.jsx("option",{value:"",children:"Select warehouse..."}),R.map(he=>e.jsx("option",{value:String(he.id),children:(he.warehouse_code?`${he.warehouse_code} - `:"")+he.warehouse_name},he.id))]})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{className:"input w-full",value:L.supplier_id,onChange:he=>U({...L,supplier_id:he.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select supplier..."}),M.map(he=>e.jsx("option",{value:String(he.id),children:he.supplier_name},he.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Order *"}),e.jsxs("select",{className:"input w-full",value:L.po_id,onChange:he=>U({...L,po_id:he.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select purchase order..."}),se.map(he=>e.jsx("option",{value:String(he.id),children:he.po_no},he.id))]})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Invoice & Delivery Details"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier's Invoice Number *"}),e.jsx("input",{type:"text",className:"input w-full",value:L.invoice_no,onChange:he=>U({...L,invoice_no:he.target.value}),placeholder:"Enter number",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice Date *"}),e.jsx("input",{type:"date",className:"input w-full",value:L.invoice_date,onChange:he=>U({...L,invoice_date:he.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{type:"date",className:"input w-full",value:L.invoice_due_date,onChange:he=>U({...L,invoice_due_date:he.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Number"}),e.jsx("input",{type:"text",className:"input w-full",value:L.delivery_number,onChange:he=>U({...L,delivery_number:he.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"input w-full",value:L.delivery_date,onChange:he=>U({...L,delivery_date:he.target.value})})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:L.remarks,onChange:he=>U({...L,remarks:he.target.value})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Items"}),e.jsx("button",{type:"button",className:"btn-success",onClick:Ae,children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Mfg Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Inspection"}),e.jsx("th",{children:"Remarks"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[L.details.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"13",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:'No items. Click "Add Item" to begin.'})}),L.details.map((he,je)=>{const me=he.item_id?ee.get(String(he.item_id)):null,xe=me?`${me.item_code} - ${me.item_name}`:"Select item...";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("select",{className:"input min-w-[320px] w-[480px]",value:he.item_id,onChange:Ue=>le(je,Ue.target.value),children:[e.jsx("option",{value:"",children:"Select item..."}),D.map(Ue=>e.jsxs("option",{value:String(Ue.id),children:[Ue.item_code," - ",Ue.item_name]},Ue.id))]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:xe})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:he.qty_ordered,onChange:Ue=>ce(je,{qty_ordered:Ue.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:he.qty_received,onChange:Ue=>ce(je,{qty_received:Ue.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:he.qty_accepted,onChange:Ue=>ce(je,{qty_accepted:Ue.target.value})})}),e.jsx("td",{children:e.jsxs("select",{className:"input min-w-[160px]",value:he.uom||oe||"",onChange:Ue=>ce(je,{uom:Ue.target.value}),children:[e.jsx("option",{value:"",children:"Select UOM"}),(Array.isArray(_)?_:[]).map(Ue=>e.jsx("option",{value:Ue.uom_code,children:Ue.uom_name?`${Ue.uom_name} (${Ue.uom_code})`:Ue.uom_code},Ue.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:he.unit_price,onChange:Ue=>ce(je,{unit_price:Ue.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[160px]",value:he.amount,onChange:Ue=>ce(je,{amount:Ue.target.value}),readOnly:!0})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[160px]",value:he.batch_serial,onChange:Ue=>ce(je,{batch_serial:Ue.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:he.mfg_date,onChange:Ue=>ce(je,{mfg_date:Ue.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:he.expiry_date,onChange:Ue=>ce(je,{expiry_date:Ue.target.value})})}),e.jsx("td",{children:e.jsxs("select",{className:"input min-w-[140px]",value:he.inspection_status||"PENDING",onChange:Ue=>ce(je,{inspection_status:Ue.target.value}),children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"PASSED",children:"Passed"}),e.jsx("option",{value:"FAILED",children:"Failed"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[200px]",value:he.line_remarks,onChange:Ue=>ce(je,{line_remarks:Ue.target.value})})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>we(je),children:"Remove"})})]},je)})]})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/grn-local",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||i,children:u?"Saving...":"Save GRN"}),e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:Ie,disabled:u||a||ae,children:String(L.status||"").toUpperCase()==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):"Forward for Approval"})]})]})})})]}),h?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{f(!1),j(null),k(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:L.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:N?`${N.workflow_name} (${N.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:x?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const je=Array.isArray(P)&&P.length>0?P[0]:null,me=je?Array.isArray(je.approvers)&&je.approvers.length?je.approvers.map(xe=>({id:xe.id,name:xe.username})):je.approver_user_id?[{id:je.approver_user_id,name:je.approver_name||String(je.approver_user_id)}]:[]:[];return me.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:T||"",onChange:xe=>V(xe.target.value?Number(xe.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),me.map(xe=>e.jsx("option",{value:xe.id,children:xe.name},xe.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:N?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{f(!1),j(null),k(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:Qe,disabled:B||a,children:B?"Forwarding...":"Forward"})]})]})}):null]})}function vY(){Ns();const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState(null),[c,m]=v.useState(!1),[h,f]=v.useState(!1),[x,g]=v.useState(""),[b,y]=v.useState(null),[N,j]=v.useState(null),[S,k]=v.useState([]),[P,I]=v.useState(!1),[B,q]=v.useState(null),[Q,O]=v.useState(null),[T,V]=v.useState(null),[D,Y]=v.useState(!1),[M,X]=v.useState(!1),[R,H]=v.useState(""),[W,K]=v.useState(null),[_,F]=v.useState([]),[E,L]=v.useState("");v.useEffect(()=>{let Ae=!0;return i(!0),o(""),te.get("/inventory/grn",{params:{grn_type:"IMPORT"}}).then(we=>{var ce;Ae&&a(Array.isArray((ce=we.data)==null?void 0:ce.items)?we.data.items:[])}).catch(we=>{var ce,le;Ae&&o(((le=(ce=we==null?void 0:we.response)==null?void 0:ce.data)==null?void 0:le.message)||"Failed to load GRNs")}).finally(()=>{Ae&&i(!1)}),()=>{Ae=!1}},[]);const U=v.useMemo(()=>{const Ae=t.toLowerCase();return r.filter(we=>String(we.grn_no||"").toLowerCase().includes(Ae)||String(we.supplier_name||"").toLowerCase().includes(Ae)||String(we.status||"").toLowerCase().includes(Ae))},[r,t]),J=Ae=>{const we=String(Ae||"").toUpperCase();return we!=="PENDING_APPROVAL"&&we!=="APPROVED"&&we!=="CANCELLED"},ae=async Ae=>{var we,ce,le,_e,Qe,Ie;V(null),m(!0),g("");try{const ke=await te.get(`/inventory/grn/${Ae.id}`),pe=((we=ke==null?void 0:ke.data)==null?void 0:we.item)||{},he=pe==null?void 0:pe.invoice_amount,je=he===""||he==null?null:Number(he||0);V({id:Ae.id,grn_no:Ae.grn_no,invoice_amount:je,status:Ae.status})}catch(ke){g(((le=(ce=ke==null?void 0:ke.response)==null?void 0:ce.data)==null?void 0:le.message)||"Failed to load GRN")}if(B)await Z();else try{f(!0);const ke=await te.get("/workflows"),pe=Array.isArray((_e=ke.data)==null?void 0:_e.items)?ke.data.items:[];q(pe),await oe(pe)}catch(ke){g(((Ie=(Qe=ke==null?void 0:ke.response)==null?void 0:Qe.data)==null?void 0:Ie.message)||"Failed to load workflows")}finally{f(!1)}},Z=async()=>{var le,_e,Qe;if(!B||!B.length){y(null),j(null),g("");return}const Ae="/inventory/grn-import",we=Ie=>String(Ie||"").trim().toUpperCase().replace(/\s+/g,"_"),ce=B.find(Ie=>Number(Ie.is_active)===1&&String(Ie.document_route)===Ae)||B.find(Ie=>Number(Ie.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(we(Ie.document_type)))||null;if(y(ce||null),j(null),!!ce)try{f(!0);const ke=(le=(await te.get(`/workflows/${ce.id}`)).data)==null?void 0:le.item,pe=Array.isArray(ke==null?void 0:ke.steps)?ke.steps:[];k(pe);const he=pe[0]||null;if(j(he?{userId:he.approver_user_id,name:he.approver_name,stepName:he.step_name,stepOrder:he.step_order,approvalLimit:he.approval_limit}:null),he){const je=(Array.isArray(he.approvers)&&he.approvers.length?he.approvers[0].id:he.approver_user_id)||null;O(je)}else O(null)}catch(Ie){g(((Qe=(_e=Ie==null?void 0:Ie.response)==null?void 0:_e.data)==null?void 0:Qe.message)||"Failed to load workflow details")}finally{f(!1)}},oe=async Ae=>{var _e,Qe,Ie;if(!Ae||!Ae.length){y(null),j(null),g("");return}const we="/inventory/grn-import",ce=ke=>String(ke||"").trim().toUpperCase().replace(/\s+/g,"_"),le=Ae.find(ke=>Number(ke.is_active)===1&&String(ke.document_route)===we)||Ae.find(ke=>Number(ke.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(ce(ke.document_type)))||null;if(y(le||null),j(null),!!le)try{f(!0);const pe=(_e=(await te.get(`/workflows/${le.id}`)).data)==null?void 0:_e.item,he=Array.isArray(pe==null?void 0:pe.steps)?pe.steps:[];k(he);const je=he[0]||null;if(j(je?{userId:je.approver_user_id,name:je.approver_name,stepName:je.step_name,stepOrder:je.step_order,approvalLimit:je.approval_limit}:null),je){const me=(Array.isArray(je.approvers)&&je.approvers.length?je.approvers[0].id:je.approver_user_id)||null;O(me)}else O(null)}catch(ke){g(((Ie=(Qe=ke==null?void 0:ke.response)==null?void 0:Qe.data)==null?void 0:Ie.message)||"Failed to load workflow details")}finally{f(!1)}},ee=async()=>{var Ae,we,ce;if(T){I(!0),g("");try{const le=await te.post(`/inventory/grn/${T.id}/submit`,{amount:T.invoice_amount??null,workflow_id:b?b.id:null,target_user_id:Q||null}),_e=((Ae=le==null?void 0:le.data)==null?void 0:Ae.status)||"PENDING_APPROVAL";a(Qe=>Qe.map(Ie=>Ie.id===T.id?{...Ie,status:_e}:Ie)),m(!1),V(null)}catch(le){g(((ce=(we=le==null?void 0:le.response)==null?void 0:we.data)==null?void 0:ce.message)||"Failed to forward for approval")}finally{I(!1)}}},se=async Ae=>{var we,ce,le,_e;Y(!0),X(!0),H(""),K(null),F([]),L("");try{const Qe=await te.get(`/inventory/grn/${Ae.id}`),Ie=((we=Qe==null?void 0:Qe.data)==null?void 0:we.item)||{},ke=Array.isArray(Ie==null?void 0:Ie.details)?Ie.details:[];K(Ie),F(ke);const pe=Number((Ie==null?void 0:Ie.po_id)||0)||0;if(pe)try{const he=await te.get("/purchase/orders"),me=(Array.isArray((ce=he==null?void 0:he.data)==null?void 0:ce.items)?he.data.items:[]).find(xe=>Number(xe.id)===pe);L(me?me.po_no||String(me.id):String(pe))}catch{L(String(pe))}}catch(Qe){H(((_e=(le=Qe==null?void 0:Qe.response)==null?void 0:le.data)==null?void 0:_e.message)||"Failed to load GRN details")}finally{X(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Material Receipt (GRN) - Import"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive import purchase deliveries"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/grn-import/new",className:"btn-success",children:"+ New GRN"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by GRN no, supplier, status...",className:"input max-w-md",value:t,onChange:Ae=>s(Ae.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!U.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No GRNs found"})}):null,U.map(Ae=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:Ae.grn_no}),e.jsx("td",{children:Ae.grn_date?String(Ae.grn_date).slice(0,10):"-"}),e.jsx("td",{children:Ae.supplier_name||"-"}),e.jsx("td",{children:Ae.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:Ae.status||"DRAFT"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{to:`/inventory/grn-import/${Ae.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx("button",{type:"button",className:"text-brand hover:text-brand-700 text-sm font-medium",onClick:()=>se(Ae),children:"Details"}),String(Ae.status||"").toUpperCase()!=="APPROVED"&&e.jsx(Ee,{to:`/inventory/grn-import/${Ae.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),String(Ae.status||"").toUpperCase()==="APPROVED"?e.jsx("span",{className:"ml-2 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:()=>ae(Ae),disabled:u===Ae.id||!J(Ae.status),children:u===Ae.id?"Forwarding...":"Forward for Approval"})]})})]},Ae.id))]})]})})]})]}),c?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{m(!1),V(null),y(null),j(null),g("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:T==null?void 0:T.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:h?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:x?e.jsx("div",{className:"text-sm text-red-600",children:x}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const we=Array.isArray(S)&&S.length>0?S[0]:null,ce=we?Array.isArray(we.approvers)&&we.approvers.length?we.approvers.map(le=>({id:le.id,name:le.username})):we.approver_user_id?[{id:we.approver_user_id,name:we.approver_name||String(we.approver_user_id)}]:[]:[];return ce.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:Q||"",onChange:le=>O(le.target.value?Number(le.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),ce.map(le=>e.jsx("option",{value:le.id,children:le.name},le.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:N?`Step ${N.stepOrder}  ${N.stepName}${N.approvalLimit!=null?`  Limit: ${Number(N.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{m(!1),V(null),y(null),j(null),g("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:ee,disabled:P||!T,children:P?"Forwarding...":"Forward"})]})]})}):null,D?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[900px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"View GRN Details"}),e.jsx("button",{type:"button",onClick:()=>{Y(!1),K(null),F([]),H("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[M?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,R?e.jsx("div",{className:"text-sm text-red-600",children:R}):null,W?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"GRN No"}),e.jsx("div",{className:"font-semibold",children:W.grn_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("div",{className:"font-semibold",children:W.grn_date?String(W.grn_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-semibold",children:W.supplier_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-semibold",children:W.warehouse_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),e.jsx("div",{className:"font-semibold",children:W.status||"DRAFT"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Purchase Order"}),e.jsx("div",{className:"font-semibold",children:E||(W.po_id?String(W.po_id):"-")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery No"}),e.jsx("div",{className:"font-semibold",children:W.delivery_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery Date"}),e.jsx("div",{className:"font-semibold",children:W.delivery_date?String(W.delivery_date).slice(0,10):"-"})]})]}):null,e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Remarks"})]})}),e.jsxs("tbody",{children:[_.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No item details"})}),_.map((Ae,we)=>{const ce=Ae.line_amount==null||Ae.line_amount===""?Number(Ae.qty_accepted||0)*Number(Ae.unit_price||0):Number(Ae.line_amount||0);return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:Ae.item_code||""}),e.jsx("td",{children:Ae.item_name||""}),e.jsx("td",{children:Ae.qty_ordered??""}),e.jsx("td",{children:Ae.qty_received??""}),e.jsx("td",{children:Ae.qty_accepted??""}),e.jsx("td",{children:Ae.uom||""}),e.jsx("td",{children:Number(Ae.unit_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:Number(ce||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:Ae.batch_serial||Ae.batch_number||""}),e.jsx("td",{children:Ae.remarks||""})]},we)})]})]})})]}),e.jsx("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{Y(!1),K(null),F([]),H("")},children:"Close"})})]})}):null]})}function Ku(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function bY(){const{id:t}=Ps(),s=Ns(),r=t==="new",[a]=_0(),n=(a.get("mode")||"").toLowerCase(),i=!r&&n==="view",[l,o]=v.useState(!1),[u,d]=v.useState(!1),[c,m]=v.useState(""),[h,f]=v.useState(!1),[x,g]=v.useState(!1),[b,y]=v.useState(""),[N,j]=v.useState(null),[S,k]=v.useState(null),[P,I]=v.useState([]),[B,q]=v.useState(!1),[Q,O]=v.useState(null),[T,V]=v.useState(null),[D,Y]=v.useState([]),[M,X]=v.useState([]),[R,H]=v.useState([]),[W,K]=v.useState([]),[_,F]=v.useState([]),{uoms:E,loading:L}=Po(),[U,J]=v.useState([]),ae=v.useRef(r),[Z,oe]=v.useState({grn_no:"",grn_date:Ku(new Date),supplier_id:"",warehouse_id:"",po_id:"",port_clearance_id:"",invoice_no:"",invoice_date:"",invoice_amount:"",invoice_due_date:"",delivery_number:"",delivery_date:"",bill_of_lading:"",customs_entry_no:"",shipping_company:"",port_of_entry:"",status:"DRAFT",remarks:"",details:[]}),ee=v.useMemo(()=>{const pe=Array.isArray(E)?E:[],he=pe.find(je=>String(je.uom_code||"").toUpperCase()==="PCS")||pe[0];return he&&he.uom_code?he.uom_code:"PCS"},[E]);v.useCallback((pe,he)=>{const je=Array.isArray(U)?U:[],me=String(pe||""),xe=he?String(he):"",Ue=je.filter(dt=>String(dt.product_id)===me&&(xe?String(dt.uom||"")===xe:!0)).sort((dt,We)=>{const He=dt.effective_date?new Date(dt.effective_date).getTime():0;return(We.effective_date?new Date(We.effective_date).getTime():0)-He||new Date(We.created_at).getTime()-new Date(dt.created_at).getTime()});if(Ue.length>0&&Ue[0].cost_price!=null)return String(Ue[0].cost_price);const ct=je.filter(dt=>String(dt.product_id)===me).sort((dt,We)=>{const He=dt.effective_date?new Date(dt.effective_date).getTime():0;return(We.effective_date?new Date(We.effective_date).getTime():0)-He||new Date(We.created_at).getTime()-new Date(dt.created_at).getTime()});return ct.length>0&&ct[0].cost_price!=null?String(ct[0].cost_price):(()=>{const dt=(Array.isArray(D)?D:[]).find(We=>String(We.id)===me);return dt&&dt.cost_price!=null?String(dt.cost_price):""})()},[U,D]),v.useEffect(()=>{let pe=!0;return m(""),Promise.all([te.get("/inventory/items"),te.get("/purchase/suppliers"),te.get("/inventory/warehouses"),te.get("/purchase/orders"),te.get("/purchase/port-clearances"),te.get("/sales/prices/standard")]).then(([he,je,me,xe,Ue,ct])=>{var ze,Pe,Te,Ke,$e,Ve;if(!pe)return;Y(Array.isArray((ze=he.data)==null?void 0:ze.items)?he.data.items:[]),X(Array.isArray((Pe=je.data)==null?void 0:Pe.items)?je.data.items:[]),H(Array.isArray((Te=me.data)==null?void 0:Te.items)?me.data.items:[]);const We=(Array.isArray((Ke=xe.data)==null?void 0:Ke.items)?xe.data.items:[]).filter(Ze=>String(Ze.po_type||"").toUpperCase()==="IMPORT"),He=Array.isArray(($e=Ue.data)==null?void 0:$e.items)?Ue.data.items:[];K(We),F(He),J(Array.isArray((Ve=ct.data)==null?void 0:Ve.items)?ct.data.items:[]),r&&te.get("/inventory/grn",{params:{grn_type:"IMPORT"}}).then(Ze=>{var Ne;const Re=Array.isArray((Ne=Ze.data)==null?void 0:Ne.items)?Ze.data.items:[],it=new Set(Re.map(Xe=>Xe.po_id||Xe.poId).filter(Xe=>Xe!=null).map(Xe=>String(Xe))),lt=new Set(Re.map(Xe=>Xe.port_clearance_id||Xe.port_clearanceId).filter(Xe=>Xe!=null).map(Xe=>String(Xe)));K(Xe=>Xe.filter(Ge=>!it.has(String(Ge.id)))),F(Xe=>Xe.filter(Ge=>!lt.has(String(Ge.id))))}).catch(()=>{})}).catch(he=>{var je,me;pe&&m(((me=(je=he==null?void 0:he.response)==null?void 0:je.data)==null?void 0:me.message)||"Failed to load lookups")}),()=>{pe=!1}},[]),v.useEffect(()=>{r&&te.get("/purchase/grns/next-no?type=IMPORT").then(pe=>{var he;(he=pe.data)!=null&&he.nextNo&&oe(je=>({...je,grn_no:pe.data.nextNo}))}).catch(console.error)},[r]),v.useEffect(()=>{Z.port_clearance_id&&te.get(`/purchase/port-clearances/${Z.port_clearance_id}`).then(pe=>{var je;const he=(je=pe.data)==null?void 0:je.item;he&&(oe(me=>({...me,customs_entry_no:he.customs_entry_no||me.customs_entry_no})),he.advice_id&&te.get(`/purchase/shipping-advices/${he.advice_id}`).then(me=>{var Ue;const xe=(Ue=me.data)==null?void 0:Ue.item;xe&&(oe(ct=>({...ct,po_id:xe.po_id?String(xe.po_id):ct.po_id,bill_of_lading:xe.bill_of_lading||ct.bill_of_lading,shipping_company:xe.vessel_name||ct.shipping_company})),xe.po_id&&te.get(`/purchase/orders/${xe.po_id}`).then(ct=>{var We;const dt=(We=ct.data)==null?void 0:We.item;dt&&oe(He=>({...He,supplier_id:dt.supplier_id?String(dt.supplier_id):He.supplier_id,warehouse_id:dt.warehouse_id?String(dt.warehouse_id):He.warehouse_id}))}).catch(console.error))}).catch(console.error))}).catch(console.error)},[Z.port_clearance_id]),v.useEffect(()=>{if(r)return;let pe=!0;return o(!0),m(""),te.get(`/inventory/grn/${t}`).then(he=>{var xe;if(!pe)return;const je=(xe=he.data)==null?void 0:xe.item,me=Array.isArray(je==null?void 0:je.details)?je.details:[];je&&(oe({grn_no:je.grn_no||"",grn_date:Ku(je.grn_date),supplier_id:je.supplier_id?String(je.supplier_id):"",warehouse_id:je.warehouse_id?String(je.warehouse_id):"",po_id:je.po_id?String(je.po_id):"",port_clearance_id:je.port_clearance_id?String(je.port_clearance_id):"",invoice_no:je.invoice_no||"",invoice_date:Ku(je.invoice_date),invoice_amount:je.invoice_amount!=null?String(je.invoice_amount):"",invoice_due_date:Ku(je.invoice_due_date),delivery_number:je.delivery_number||"",delivery_date:Ku(je.delivery_date),bill_of_lading:je.bill_of_lading||"",customs_entry_no:je.customs_entry_no||"",shipping_company:je.shipping_company||"",port_of_entry:je.port_of_entry||"",status:je.status||"DRAFT",remarks:je.remarks||"",details:me.map(Ue=>({item_id:Ue.item_id?String(Ue.item_id):"",qty_ordered:Ue.qty_ordered??"",qty_received:Ue.qty_received??"",qty_accepted:Ue.qty_accepted??"",qty_rejected:Ue.qty_rejected??"",uom:Ue.uom||"",unit_price:Ue.unit_price!=null?String(Ue.unit_price):"",amount:Ue.line_amount!=null?String(Ue.line_amount):(()=>{const ct=Ue.unit_price!=null?Number(Ue.unit_price):0,dt=Ue.qty_accepted!=null?Number(Ue.qty_accepted):Ue.qty_received!=null?Number(Ue.qty_received):Ue.qty_ordered!=null?Number(Ue.qty_ordered):0;return String(Number(dt||0)*Number(ct||0))})(),batch_serial:Ue.batch_serial||Ue.batch_number||"",mfg_date:Ku(Ue.mfg_date),expiry_date:Ku(Ue.expiry_date),inspection_status:Ue.inspection_status||"PENDING",line_remarks:Ue.remarks||""}))}),ae.current=!1,je.po_id&&te.get(`/purchase/orders/${je.po_id}`).then(Ue=>{var dt;const ct=(dt=Ue.data)==null?void 0:dt.item;ct&&K(We=>We.some(ze=>String(ze.id)===String(ct.id))?We:[...We,ct])}).catch(()=>{}))}).catch(he=>{var je,me;pe&&m(((me=(je=he==null?void 0:he.response)==null?void 0:je.data)==null?void 0:me.message)||"Failed to load GRN")}).finally(()=>{pe&&o(!1)}),()=>{pe=!1}},[t,r]);const se=v.useMemo(()=>{const pe=new Map;for(const he of D)pe.set(String(he.id),he);return pe},[D]);v.useMemo(()=>{const pe=new Map;for(const he of Array.isArray(U)?U:[]){const je=String(he.product_id);pe.has(je)||pe.set(je,he)}return pe},[U]);const Ae=()=>{oe(pe=>{var he,je,me;return{...pe,details:[...pe.details,{item_id:(he=D[0])!=null&&he.id?String(D[0].id):"",qty_ordered:"",qty_received:"",uom:((je=D[0])==null?void 0:je.uom)&&String(D[0].uom)||(ee?String(ee):""),unit_price:String(((me=D[0])==null?void 0:me.cost_price)??"")}]}})},we=pe=>{oe(he=>({...he,details:he.details.filter((je,me)=>me!==pe)}))},ce=(pe,he)=>{oe(je=>{const me=je.details.map((ze,Pe)=>Pe===pe?{...ze,...he}:ze);let xe=me[pe];if(Object.prototype.hasOwnProperty.call(he,"item_id")){const ze=se.get(String(he.item_id)),Pe=(ze==null?void 0:ze.uom)&&String(ze.uom)||xe.uom&&String(xe.uom)||(ee?String(ee):""),Te=String((ze==null?void 0:ze.cost_price)??"");xe={...xe,uom:Pe,unit_price:Te},me[pe]=xe}Object.prototype.hasOwnProperty.call(he,"uom")&&(me[pe]={...xe,uom:he.uom},xe=me[pe]);const Ue=xe.unit_price===""?0:Number(xe.unit_price||0),ct=xe.qty_accepted===""||xe.qty_accepted==null?null:Number(xe.qty_accepted||0),dt=xe.qty_received===""||xe.qty_received==null?null:Number(xe.qty_received||0),We=xe.qty_ordered===""||xe.qty_ordered==null?null:Number(xe.qty_ordered||0),He=ct??null??dt??null??We??0;return me[pe]={...xe,amount:String(Number(He||0)*Ue)},{...je,details:me}})};v.useEffect(()=>{if(!Z.po_id||!ae.current)return;let pe=!0;return o(!0),te.get(`/purchase/orders/${Z.po_id}`).then(he=>{var xe,Ue,ct;if(!pe)return;const je=(xe=he.data)==null?void 0:xe.item,me=Array.isArray((ct=(Ue=he.data)==null?void 0:Ue.item)==null?void 0:ct.details)?he.data.item.details:[];je&&oe(dt=>({...dt,supplier_id:je.supplier_id?String(je.supplier_id):dt.supplier_id,details:me.map(We=>{const He=D.find(ze=>String(ze.id)===String(We.item_id));return{item_id:We.item_id?String(We.item_id):"",qty_ordered:We.qty??"",qty_received:"",qty_accepted:"",qty_rejected:"",uom:(He==null?void 0:He.uom)||"",unit_price:String((He==null?void 0:He.cost_price)??""),amount:"",batch_serial:"",mfg_date:"",expiry_date:"",inspection_status:"PENDING",line_remarks:""}})}))}).catch(he=>{var je,me;m(((me=(je=he==null?void 0:he.response)==null?void 0:je.data)==null?void 0:me.message)||"Failed to load PO details")}).finally(()=>{pe&&o(!1)}),()=>{pe=!1}},[Z.po_id]);const le=async pe=>{var he,je;pe.preventDefault(),d(!0),m("");try{const me={grn_no:Z.grn_no||null,grn_date:Z.grn_date,grn_type:"IMPORT",supplier_id:Z.supplier_id?Number(Z.supplier_id):null,warehouse_id:Z.warehouse_id?Number(Z.warehouse_id):null,po_id:Z.po_id?Number(Z.po_id):null,invoice_no:Z.invoice_no||null,invoice_date:Z.invoice_date||null,invoice_amount:Z.invoice_amount===""||Z.invoice_amount==null?null:Number(Z.invoice_amount),invoice_due_date:Z.invoice_due_date||null,delivery_number:Z.delivery_number||null,delivery_date:Z.delivery_date||null,bill_of_lading:Z.bill_of_lading||null,customs_entry_no:Z.customs_entry_no||null,shipping_company:Z.shipping_company||null,port_of_entry:Z.port_of_entry||null,remarks:Z.remarks||null,details:(Z.details||[]).map(xe=>({item_id:xe.item_id?Number(xe.item_id):null,qty_ordered:xe.qty_ordered===""?null:Number(xe.qty_ordered),qty_received:xe.qty_received===""?null:Number(xe.qty_received),qty_accepted:xe.qty_accepted===""?null:Number(xe.qty_accepted),uom:xe.uom||null,unit_price:xe.unit_price===""?null:Number(xe.unit_price),line_amount:xe.amount===""?null:Number(xe.amount),batch_serial:xe.batch_serial||null,mfg_date:xe.mfg_date||null,expiry_date:xe.expiry_date||null,inspection_status:xe.inspection_status||"PENDING",remarks:xe.line_remarks||null}))};if(!me.grn_date||!me.supplier_id)throw new Error("GRN date and supplier are required");if(!me.po_id)throw new Error("Purchase order is required");if(!me.invoice_no||!me.invoice_date)throw new Error("Invoice number and date are required");r?await te.post("/inventory/grn",{...me,port_clearance_id:Z.port_clearance_id?Number(Z.port_clearance_id):null}):await te.put(`/inventory/grn/${t}`,{...me,port_clearance_id:Z.port_clearance_id?Number(Z.port_clearance_id):null}),s("/inventory/grn-import")}catch(me){m(((je=(he=me==null?void 0:me.response)==null?void 0:he.data)==null?void 0:je.message)||(me==null?void 0:me.message)||"Failed to save GRN")}finally{d(!1)}},_e=async()=>{var pe,he,je;if(!r){q(!0),y("");try{const me=await te.post(`/inventory/grn/${t}/submit`,{amount:Z.invoice_amount===""||Z.invoice_amount==null?null:Number(Z.invoice_amount||0),workflow_id:N?N.id:null,target_user_id:T||null}),xe=((pe=me==null?void 0:me.data)==null?void 0:pe.status)||"PENDING_APPROVAL";oe(Ue=>({...Ue,status:xe})),f(!1)}catch(me){y(((je=(he=me==null?void 0:me.response)==null?void 0:he.data)==null?void 0:je.message)||"Failed to forward for approval")}finally{q(!1)}}},Qe=async()=>{var pe,he,je;if(!r)if(f(!0),y(""),Q)await Ie();else try{g(!0);const me=await te.get("/workflows"),xe=Array.isArray((pe=me.data)==null?void 0:pe.items)?me.data.items:[];O(xe),await ke(xe)}catch(me){y(((je=(he=me==null?void 0:me.response)==null?void 0:he.data)==null?void 0:je.message)||"Failed to load workflows")}finally{g(!1)}},Ie=async()=>{var me,xe,Ue;if(!Q||!Q.length){j(null),k(null),y("");return}const pe="/inventory/grn-import",he=ct=>String(ct||"").trim().toUpperCase().replace(/\s+/g,"_"),je=Q.find(ct=>Number(ct.is_active)===1&&String(ct.document_route)===pe)||Q.find(ct=>Number(ct.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(he(ct.document_type)))||null;if(j(je||null),k(null),!!je)try{g(!0);const dt=(me=(await te.get(`/workflows/${je.id}`)).data)==null?void 0:me.item,We=Array.isArray(dt==null?void 0:dt.steps)?dt.steps:[];I(We);const He=We[0]||null;if(k(He?{userId:He.approver_user_id,name:He.approver_name,stepName:He.step_name,stepOrder:He.step_order,approvalLimit:He.approval_limit}:null),He){const ze=(Array.isArray(He.approvers)&&He.approvers.length?He.approvers[0].id:He.approver_user_id)||null;V(ze)}else V(null)}catch(ct){y(((Ue=(xe=ct==null?void 0:ct.response)==null?void 0:xe.data)==null?void 0:Ue.message)||"Failed to load workflow details")}finally{g(!1)}},ke=async pe=>{var xe,Ue,ct;if(!pe||!pe.length){j(null),k(null),y("");return}const he="/inventory/grn-import",je=dt=>String(dt||"").trim().toUpperCase().replace(/\s+/g,"_"),me=pe.find(dt=>Number(dt.is_active)===1&&String(dt.document_route)===he)||pe.find(dt=>Number(dt.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(je(dt.document_type)))||null;if(j(me||null),k(null),!!me)try{g(!0);const We=(xe=(await te.get(`/workflows/${me.id}`)).data)==null?void 0:xe.item,He=Array.isArray(We==null?void 0:We.steps)?We.steps:[];I(He);const ze=He[0]||null;if(k(ze?{userId:ze.approver_user_id,name:ze.approver_name,stepName:ze.step_name,stepOrder:ze.step_order,approvalLimit:ze.approval_limit}:null),ze){const Pe=(Array.isArray(ze.approvers)&&ze.approvers.length?ze.approvers[0].id:ze.approver_user_id)||null;V(Pe)}else V(null)}catch(dt){y(((ct=(Ue=dt==null?void 0:dt.response)==null?void 0:Ue.data)==null?void 0:ct.message)||"Failed to load workflow details")}finally{g(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:r?"New GRN (Import)":i?"View GRN (Import)":"Edit GRN (Import)"}),e.jsx("p",{className:"text-sm mt-1",children:"Goods receipt note for import purchases"})]}),e.jsx(Ee,{to:"/inventory/grn-import",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:le,className:"space-y-6",children:[l?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,c?e.jsx("div",{className:"text-sm text-red-600",children:c}):null,e.jsxs("fieldset",{disabled:i,className:`space-y-6 ${i?"disabled-light-blue":""}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN No"}),e.jsx("input",{type:"text",className:"input",value:Z.grn_no,onChange:pe=>oe({...Z,grn_no:pe.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN Date *"}),e.jsx("input",{type:"date",className:"input",value:Z.grn_date,onChange:pe=>oe({...Z,grn_date:pe.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{className:"input",value:Z.supplier_id,onChange:pe=>oe({...Z,supplier_id:pe.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select supplier..."}),M.map(pe=>e.jsx("option",{value:String(pe.id),children:pe.supplier_name},pe.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port Clearance (Optional)"}),e.jsxs("select",{className:"input",value:Z.port_clearance_id,onChange:pe=>oe({...Z,port_clearance_id:pe.target.value}),children:[e.jsx("option",{value:"",children:"Select port clearance..."}),_.map(pe=>e.jsx("option",{value:String(pe.id),children:pe.clearance_no},pe.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:Z.warehouse_id,onChange:pe=>oe({...Z,warehouse_id:pe.target.value}),children:[e.jsx("option",{value:"",children:"Select warehouse..."}),R.map(pe=>e.jsx("option",{value:String(pe.id),children:pe.warehouse_name||pe.name||"Unknown Warehouse"},pe.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Order *"}),e.jsxs("select",{className:"input",value:Z.po_id,onChange:pe=>oe({...Z,po_id:pe.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select purchase order..."}),W.map(pe=>e.jsx("option",{value:String(pe.id),children:pe.po_no},pe.id))]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Supplier Invoice Details"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier's Invoice Number *"}),e.jsx("input",{type:"text",className:"input",value:Z.invoice_no,onChange:pe=>oe({...Z,invoice_no:pe.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice Date *"}),e.jsx("input",{type:"date",className:"input",value:Z.invoice_date,onChange:pe=>oe({...Z,invoice_date:pe.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{type:"date",className:"input",value:Z.invoice_due_date,onChange:pe=>oe({...Z,invoice_due_date:pe.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Number"}),e.jsx("input",{type:"text",className:"input",value:Z.delivery_number,onChange:pe=>oe({...Z,delivery_number:pe.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"input",value:Z.delivery_date,onChange:pe=>oe({...Z,delivery_date:pe.target.value})})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Import Documentation"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bill of Lading *"}),e.jsx("input",{type:"text",className:"input",value:Z.bill_of_lading,onChange:pe=>oe({...Z,bill_of_lading:pe.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customs Entry No *"}),e.jsx("input",{type:"text",className:"input",value:Z.customs_entry_no,onChange:pe=>oe({...Z,customs_entry_no:pe.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shipping Company"}),e.jsx("input",{type:"text",className:"input",value:Z.shipping_company,onChange:pe=>oe({...Z,shipping_company:pe.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Entry"}),e.jsx("input",{type:"text",className:"input",value:Z.port_of_entry,onChange:pe=>oe({...Z,port_of_entry:pe.target.value})})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:Z.remarks,onChange:pe=>oe({...Z,remarks:pe.target.value})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Items"}),e.jsx("button",{type:"button",className:"btn-success",onClick:Ae,children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Mfg Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Inspection"}),e.jsx("th",{children:"Remarks"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[Z.details.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"13",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:'No items. Click "Add Item" to begin.'})}),Z.details.map((pe,he)=>{const je=pe.item_id?se.get(String(pe.item_id)):null,me=je?`${je.item_code} - ${je.item_name}`:"Select item...";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("select",{className:"input min-w-[320px]",value:pe.item_id,onChange:xe=>ce(he,{item_id:xe.target.value}),children:[e.jsx("option",{value:"",children:"Select item..."}),D.map(xe=>e.jsx("option",{value:String(xe.id),children:xe.item_name},xe.id))]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:me})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:pe.qty_ordered,onChange:xe=>ce(he,{qty_ordered:xe.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:pe.qty_received,onChange:xe=>ce(he,{qty_received:xe.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:pe.qty_accepted,onChange:xe=>ce(he,{qty_accepted:xe.target.value})})}),e.jsx("td",{children:e.jsxs("select",{className:"input min-w-[160px]",value:pe.uom||"",onChange:xe=>ce(he,{uom:xe.target.value}),children:[e.jsx("option",{value:"",children:"Select UOM"}),L?e.jsx("option",{children:"Loading..."}):Array.isArray(E)&&E.map(xe=>xe&&e.jsx("option",{value:xe.uom_code,children:xe.uom_code},xe.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:pe.unit_price,onChange:xe=>ce(he,{unit_price:xe.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[160px]",value:pe.amount,onChange:xe=>ce(he,{amount:xe.target.value}),readOnly:!0})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[160px]",value:pe.batch_serial,onChange:xe=>ce(he,{batch_serial:xe.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:pe.mfg_date,onChange:xe=>ce(he,{mfg_date:xe.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:pe.expiry_date,onChange:xe=>ce(he,{expiry_date:xe.target.value})})}),e.jsx("td",{children:e.jsxs("select",{className:"input min-w-[140px]",value:pe.inspection_status||"PENDING",onChange:xe=>ce(he,{inspection_status:xe.target.value}),children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"PASSED",children:"Passed"}),e.jsx("option",{value:"FAILED",children:"Failed"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[200px]",value:pe.line_remarks,onChange:xe=>ce(he,{line_remarks:xe.target.value})})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>we(he),children:"Remove"})})]},he)})]})]})})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/grn-import",className:"btn-success",children:"Cancel"}),i?null:e.jsx("button",{type:"submit",className:"btn-success",disabled:u,children:u?"Saving...":"Save GRN"}),e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:Qe,disabled:u||r,children:String(Z.status||"").toUpperCase()==="APPROVED"?"Approved":"Forward for Approval"})]})]})})]}),h?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{f(!1),j(null),k(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:Z.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:N?`${N.workflow_name} (${N.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:x?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const he=Array.isArray(P)&&P.length>0?P[0]:null,je=he?Array.isArray(he.approvers)&&he.approvers.length?he.approvers.map(me=>({id:me.id,name:me.username})):he.approver_user_id?[{id:he.approver_user_id,name:he.approver_name||String(he.approver_user_id)}]:[]:[];return je.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:T||"",onChange:me=>V(me.target.value?Number(me.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),je.map(me=>e.jsx("option",{value:me.id,children:me.name},me.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:N?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{f(!1),j(null),k(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:_e,disabled:B||r,children:B?"Forwarding...":"Forward"})]})]})}):null]})}function yY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let d=!0;return i(!0),o(""),te.get("/inventory/transfer-acceptance").then(c=>{var m;d&&a(Array.isArray((m=c.data)==null?void 0:m.items)?c.data.items:[])}).catch(c=>{var m,h;d&&o(((h=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load transfers")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=v.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.transfer_no||"").toLowerCase().includes(d)||String(c.from_warehouse_name||c.from_warehouse_id||"").toLowerCase().includes(d)||String(c.to_warehouse_name||c.to_warehouse_id||"").toLowerCase().includes(d)||String(c.status||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Transfer Acceptance"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive transferred stock"})]}),e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by transfer no, from warehouse, status...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Transfer No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"From Warehouse"}),e.jsx("th",{children:"To Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No transfers available for acceptance"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.transfer_no}),e.jsx("td",{children:d.transfer_date?String(d.transfer_date).slice(0,10):"-"}),e.jsx("td",{children:d.from_warehouse_name||d.from_warehouse_id||"-"}),e.jsx("td",{children:d.to_warehouse_name||d.to_warehouse_id||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d.status==="IN_TRANSIT"?"badge-warning":"badge-info"}`,children:d.status})}),e.jsx("td",{children:e.jsx(Ee,{to:`/inventory/transfer-acceptance/${d.id}`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"Open"})})]},d.id))]})]})})]})]})})}function jY(){const{id:t}=Ps(),s=Ns(),[r,a]=v.useState(!1),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState(null),[c,m]=v.useState([]);v.useEffect(()=>{let b=!0;return a(!0),o(""),te.get(`/inventory/transfer-acceptance/${t}`).then(y=>{var j,S;if(!b)return;d(((j=y.data)==null?void 0:j.item)||null);const N=Array.isArray((S=y.data)==null?void 0:S.details)?y.data.details:[];m(N.map(k=>({...k,received_qty:Number(k.remaining_qty??k.qty??0),variance:0,rejected_now:0,remarks:""})))}).catch(y=>{var N,j;b&&o(((j=(N=y==null?void 0:y.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to load transfer")}).finally(()=>{b&&a(!1)}),()=>{b=!1}},[t]);const h=(b,y)=>{const N=parseFloat(y)||0;m(j=>j.map(S=>{if(S.id===b){const k=Number(S.remaining_qty??S.qty??0),P=Number(S.rejected_now||0),I=N+P-k;return{...S,received_qty:N,variance:I}}return S}))},f=(b,y)=>{const N=parseFloat(y)||0;m(j=>j.map(S=>{if(S.id===b){const k=Number(S.remaining_qty??S.qty??0),I=Number(S.received_qty||0)+N-k;return{...S,rejected_now:N,variance:I}}return S}))},x=(b,y)=>{m(N=>N.map(j=>j.id===b?{...j,remarks:y}:j))},g=async()=>{var b,y;i(!0),o("");try{const N={details:c.map(j=>{const S=Math.max(0,Number(j.remaining_qty??0)),k=Math.max(0,Math.min(Number(j.received_qty)||0,S)),P=Math.max(0,Number(j.rejected_now)||0),I=Math.max(0,Math.min(P,Math.max(0,S-k)));return{id:j.id,item_id:j.item_id,qty:Number(j.qty)||0,received_qty:k,accepted_qty:k,rejected_qty:I,acceptance_remarks:j.remarks}})};await te.put(`/inventory/transfer-acceptance/${t}`,N),s("/inventory/transfer-acceptance")}catch(N){o(((y=(b=N==null?void 0:N.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to accept transfer")}finally{i(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Transfer Acceptance"}),e.jsx("p",{className:"text-sm mt-1",children:"Review items and accept inbound transfer"})]}),e.jsx(Ee,{to:"/inventory/transfer-acceptance",className:"btn-success",children:"Back to List"})]})}),e.jsxs("div",{className:"card-body space-y-6",children:[r?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,l?e.jsx("div",{className:"text-sm text-red-600",children:l}):null,u?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Transfer No"}),e.jsx("div",{className:"font-semibold",children:u.transfer_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("div",{className:"font-semibold",children:u.transfer_date?String(u.transfer_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"From Warehouse"}),e.jsx("div",{className:"font-semibold",children:u.from_warehouse_name||u.from_warehouse_id||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"To Warehouse"}),e.jsx("div",{className:"font-semibold",children:u.to_warehouse_name||u.to_warehouse_id||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),e.jsx("div",{children:e.jsx("span",{className:`badge ${u.status==="IN_TRANSIT"?"badge-warning":"badge-info"}`,children:u.status})})]})]}):null,e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-100 dark:text-slate-100",children:"Items Verification"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{className:"w-24",children:"Transferred"}),e.jsx("th",{className:"w-24",children:"Remaining"}),e.jsx("th",{className:"w-28",children:"Receive Now"}),e.jsx("th",{className:"w-28",children:"Reject Now"}),e.jsx("th",{className:"w-24",children:"Variance"}),e.jsx("th",{children:"Remarks"})]})}),e.jsxs("tbody",{children:[c.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No items"})}),c.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:b.item_code}),e.jsx("td",{children:b.item_name}),e.jsx("td",{children:b.qty}),e.jsx("td",{children:Number(b.remaining_qty??0)}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input h-8",value:b.received_qty,onChange:y=>h(b.id,y.target.value),min:"0",step:"0.001",max:Math.max(0,Number(b.remaining_qty??0)-Number(b.rejected_now||0)),disabled:(u==null?void 0:u.status)==="RECEIVED"})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input h-8",value:b.rejected_now,onChange:y=>f(b.id,y.target.value),min:"0",step:"0.001",max:Math.max(0,Number(b.remaining_qty??0)-Number(b.received_qty||0)),disabled:(u==null?void 0:u.status)==="RECEIVED"})}),e.jsx("td",{children:e.jsxs("span",{className:`font-semibold ${b.variance<0?"text-red-600":b.variance>0?"text-blue-600":"text-green-600"}`,children:[b.variance>0?"+":"",b.variance]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input h-8",value:b.remarks,onChange:y=>x(b.id,y.target.value),placeholder:"Variance reason...",disabled:(u==null?void 0:u.status)==="RECEIVED"})})]},b.id))]})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/transfer-acceptance",className:"btn-success",children:"Close"}),e.jsx("button",{type:"button",className:"btn-success",onClick:g,disabled:n||!u||u.status==="RECEIVED",children:n?"Accepting...":"Accept Transfer"})]})]})]})})}function NY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let d=!0;return i(!0),o(""),te.get("/inventory/stock-takes").then(c=>{var m;d&&a(Array.isArray((m=c.data)==null?void 0:m.items)?c.data.items:[])}).catch(c=>{var m,h;d&&o(((h=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load stock takes")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=v.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.stock_take_no||"").toLowerCase().includes(d)||String(c.status||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Daily Stock Take"}),e.jsx("p",{className:"text-sm mt-1",children:"Perform physical stock counts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/stock-take/new",className:"btn-success",children:"+ New Stock Take"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by stock take no or status...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No stock takes found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.stock_take_no}),e.jsx("td",{children:d.stock_take_date?String(d.stock_take_date).slice(0,10):"-"}),e.jsx("td",{children:d.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:d.status||"DRAFT"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/stock-take/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/stock-take/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function K_(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function wY(){const{id:t}=Ps(),s=Ns(),r=t==="new",[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState([]),[m,h]=v.useState([]),[f,x]=v.useState({stock_take_no:"",stock_take_date:K_(new Date),warehouse_id:"",status:"DRAFT",details:[]});v.useEffect(()=>{let S=!0;return u(""),Promise.all([te.get("/inventory/items"),te.get("/inventory/warehouses")]).then(([k,P])=>{var I,B;S&&(c(Array.isArray((I=k.data)==null?void 0:I.items)?k.data.items:[]),h(Array.isArray((B=P.data)==null?void 0:B.items)?P.data.items:[]))}).catch(k=>{var P,I;S&&u(((I=(P=k==null?void 0:k.response)==null?void 0:P.data)==null?void 0:I.message)||"Failed to load lookups")}),()=>{S=!1}},[]),v.useEffect(()=>{if(r)return;let S=!0;return n(!0),u(""),te.get(`/inventory/stock-takes/${t}`).then(k=>{var B,q;if(!S)return;const P=(B=k.data)==null?void 0:B.item,I=Array.isArray((q=k.data)==null?void 0:q.details)?k.data.details:[];P&&x({stock_take_no:P.stock_take_no||"",stock_take_date:K_(P.stock_take_date),warehouse_id:P.warehouse_id?String(P.warehouse_id):"",status:P.status||"DRAFT",details:I.map(Q=>({item_id:Q.item_id?String(Q.item_id):"",physical_qty:Q.physical_qty??""}))})}).catch(k=>{var P,I;S&&u(((I=(P=k==null?void 0:k.response)==null?void 0:P.data)==null?void 0:I.message)||"Failed to load stock take")}).finally(()=>{S&&n(!1)}),()=>{S=!1}},[t,r]);const g=v.useMemo(()=>{const S=new Map;for(const k of d)S.set(String(k.id),k);return S},[d]),b=()=>{x(S=>{var k;return{...S,details:[...S.details,{item_id:(k=d[0])!=null&&k.id?String(d[0].id):"",physical_qty:""}]}})},y=S=>{x(k=>({...k,details:k.details.filter((P,I)=>I!==S)}))},N=(S,k)=>{x(P=>({...P,details:P.details.map((I,B)=>B===S?{...I,...k}:I)}))},j=async S=>{var k,P;S.preventDefault(),l(!0),u("");try{const I={stock_take_no:f.stock_take_no||null,stock_take_date:f.stock_take_date,warehouse_id:f.warehouse_id?Number(f.warehouse_id):null,status:f.status||"DRAFT",details:(f.details||[]).map(B=>({item_id:B.item_id?Number(B.item_id):null,physical_qty:B.physical_qty===""?null:Number(B.physical_qty)}))};if(!I.stock_take_date)throw new Error("Date is required");r?await te.post("/inventory/stock-takes",I):await te.put(`/inventory/stock-takes/${t}`,I),s("/inventory/stock-take")}catch(I){u(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||(I==null?void 0:I.message)||"Failed to save stock take")}finally{l(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Stock Take":"Edit Stock Take"}),e.jsx("p",{className:"text-sm mt-1",children:"Record physical stock quantities"})]}),e.jsx(Ee,{to:"/inventory/stock-take",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[a?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,o?e.jsx("div",{className:"text-sm text-red-600",children:o}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"No"}),e.jsx("input",{type:"text",className:"input",value:f.stock_take_no,onChange:S=>x({...f,stock_take_no:S.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{type:"date",className:"input",value:f.stock_take_date,onChange:S=>x({...f,stock_take_date:S.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:f.status,onChange:S=>x({...f,status:S.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"COMPLETED",children:"COMPLETED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:f.warehouse_id,onChange:S=>x({...f,warehouse_id:S.target.value}),children:[e.jsx("option",{value:"",children:"All / Not specified"}),m.map(S=>e.jsx("option",{value:String(S.id),children:(S.warehouse_code?`${S.warehouse_code} - `:"")+S.warehouse_name},S.id))]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Count Lines"}),e.jsx("button",{type:"button",className:"btn-success",onClick:b,children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Physical Qty"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[f.details.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:'No lines. Click "Add Item" to begin.'})}),f.details.map((S,k)=>{const P=S.item_id?g.get(String(S.item_id)):null,I=P?`${P.item_code} - ${P.item_name}`:"Select item...";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("select",{className:"input",value:S.item_id,onChange:B=>N(k,{item_id:B.target.value}),children:[e.jsx("option",{value:"",children:"Select item..."}),d.map(B=>e.jsxs("option",{value:String(B.id),children:[B.item_code," - ",B.item_name]},B.id))]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:I})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"0.001",className:"input",value:S.physical_qty,onChange:B=>N(k,{physical_qty:B.target.value})})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>y(k),children:"Remove"})})]},k)})]})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/stock-take",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:i,children:i?"Saving...":"Save"})]})]})})]})})}function _Y(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState([]),[l,o]=v.useState(!1),[u,d]=v.useState(!1),[c,m]=v.useState(""),[h,f]=v.useState("");v.useEffect(()=>{let b=!0;return o(!0),m(""),d(!0),f(""),te.get("/inventory/item-groups").then(y=>{var N;b&&a(Array.isArray((N=y.data)==null?void 0:N.items)?y.data.items:[])}).catch(y=>{var N,j;b&&m(((j=(N=y==null?void 0:y.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to load item groups")}).finally(()=>{b&&o(!1)}),te.get("/inventory/item-categories").then(y=>{var N;b&&i(Array.isArray((N=y.data)==null?void 0:N.items)?y.data.items:[])}).catch(y=>{var N,j;b&&f(((j=(N=y==null?void 0:y.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to load item categories")}).finally(()=>{b&&d(!1)}),()=>{b=!1}},[]);const x=v.useMemo(()=>{const b=t.toLowerCase();return r.filter(y=>String(y.group_code||"").toLowerCase().includes(b)||String(y.group_name||"").toLowerCase().includes(b)||String(y.parent_group_name||"").toLowerCase().includes(b))},[r,t]),g=v.useMemo(()=>{const b=t.toLowerCase();return n.filter(y=>String(y.category_code||"").toLowerCase().includes(b)||String(y.category_name||"").toLowerCase().includes(b)||String(y.parent_category_name||"").toLowerCase().includes(b))},[n,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Item Groups & Sub Groups"}),e.jsx("p",{className:"text-sm mt-1",children:"Organize items by categories"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/item-groups/new",className:"btn-success",children:"+ New Group"})]})]})}),e.jsxs("div",{className:"card-body",children:[c?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:c}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, or parent...",className:"input max-w-md",value:t,onChange:b=>s(b.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Parent"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!l&&!x.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No item groups found"})}):null,x.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:b.group_code}),e.jsx("td",{children:b.group_name}),e.jsx("td",{children:b.parent_group_name||"-"}),e.jsx("td",{children:b.is_active?"Yes":"No"}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/item-groups/${b.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/item-groups/${b.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},b.id))]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex justify-between items-center text-white",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold dark:text-brand-300",children:"Item Categories"}),e.jsx("p",{className:"text-sm mt-1",children:"Organize items by category"})]})})}),e.jsxs("div",{className:"card-body",children:[h?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:h}):null,e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Parent"}),e.jsx("th",{children:"Active"})]})}),e.jsxs("tbody",{children:[u?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!u&&!g.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No item categories found"})}):null,g.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:b.category_code}),e.jsx("td",{children:b.category_name}),e.jsx("td",{children:b.parent_category_name||"-"}),e.jsx("td",{children:b.is_active?"Yes":"No"})]},b.id))]})]})})]})]})]})}const SY=()=>{const[t,s]=v.useState("groups"),[r,a]=v.useState([]),{uoms:n,refresh:i}=Po(),{categories:l,refresh:o}=Ek(),{itemTypes:u,refresh:d}=Fk(),[c,m]=v.useState(!1),[h,f]=v.useState("create"),[x,g]=v.useState("group"),[b,y]=v.useState(""),[N,j]=v.useState(null),[S,k]=v.useState(!1),[P,I]=v.useState({code:"",name:"",type:"COUNT",parent:"",active:"Y"}),B=[{value:"COUNT",label:"Count"},{value:"WEIGHT",label:"Weight"},{value:"VOLUME",label:"Volume"},{value:"LENGTH",label:"Length"}],q=(Array.isArray(l)?l:[]).map(F=>({...F,category_id:F.category_id??F.id,is_active:F.is_active===1||F.is_active===!0||F.is_active==="Y"?"Y":"N"})),Q=(Array.isArray(u)?u:[]).map(F=>({...F,type_id:F.type_id??F.id,is_active:F.is_active===1||F.is_active===!0||F.is_active==="Y"?"Y":"N"}));v.useEffect(()=>{O()},[]);const O=async()=>{var F;try{k(!0);const E=await te.get("/inventory/item-groups"),U=(Array.isArray((F=E.data)==null?void 0:F.items)?E.data.items:[]).map(J=>({group_id:J.id,group_code:J.group_code,group_name:J.group_name,is_active:J.is_active?"Y":"N"}));a(U)}catch(E){console.error("Failed to fetch item groups",E)}finally{k(!1)}},T=(F,E)=>{const L=E.reduce((U,J)=>{const ae=J.group_code||J.category_code||J.uom_code||J.type_code,Z=parseInt(ae.replace(/\D/g,""))||0;return Math.max(U,Z)},0);return`${F}${(L+1).toString().padStart(3,"0")}`},V=(F,E,L=null)=>{if(g(F),f(E),E==="create"){const U=F==="group"?"GRP":F==="category"?"CAT":F==="type"?"TYP":"";I({code:U?T(U,F==="group"?r:F==="category"?q:F==="type"?Q:n):"",name:"",type:"COUNT",parent:"",active:"Y"})}else E==="edit"&&L&&(I({code:L.group_code||L.category_code||L.uom_code||L.type_code,name:L.group_name||L.category_name||L.uom_name||L.type_name,type:L.uom_type||"COUNT",parent:L.parent_category_id||"",active:L.is_active===1||L.is_active==="Y"?"Y":"N"}),j(L));m(!0)},D=async()=>{var F,E;if(!P.name){alert("Please fill in all required fields");return}try{if(x==="group"){const L={group_code:P.code,group_name:P.name,is_active:P.active==="Y"?1:0};h==="create"?await te.post("/inventory/item-groups",L):await te.put(`/inventory/item-groups/${N.group_id}`,L),await O()}else if(x==="category"){const L={category_code:P.code,category_name:P.name,parent_category_id:P.parent||null,is_active:P.active==="Y"?1:0};h==="create"?await te.post("/inventory/item-categories",L):await te.put(`/inventory/item-categories/${N.id}`,L),await o()}else if(x==="uom"){const L={uom_code:P.code,uom_name:P.name,uom_type:P.type,is_active:P.active==="Y"?1:0};h==="create"?await te.post("/inventory/uoms",L):await te.put(`/inventory/uoms/${N.id}`,L),await i()}else if(x==="type"){const L={type_code:P.code,type_name:P.name,is_active:P.active==="Y"?1:0};h==="create"?await te.post("/inventory/item-types",L):await te.put(`/inventory/item-types/${N.type_id}`,L),await d()}m(!1),j(null)}catch(L){alert("Failed to save item: "+(((E=(F=L.response)==null?void 0:F.data)==null?void 0:E.message)||L.message))}},Y=async(F,E)=>{var L,U,J,ae,Z,oe;if(window.confirm("Are you sure you want to delete this item?")){if(F==="group")alert("Delete is not currently supported for Item Groups.");else if(F==="category")try{await te.delete(`/inventory/item-categories/${E}`),await o()}catch(ee){alert("Failed to delete category: "+(((U=(L=ee.response)==null?void 0:L.data)==null?void 0:U.message)||ee.message))}else if(F==="uom")try{await te.delete(`/inventory/uoms/${E}`),await i()}catch(ee){alert("Failed to delete UOM: "+(((ae=(J=ee.response)==null?void 0:J.data)==null?void 0:ae.message)||ee.message))}else if(F==="type")try{await te.delete(`/inventory/item-types/${E}`),await d()}catch(ee){alert("Failed to delete item type: "+(((oe=(Z=ee.response)==null?void 0:Z.data)==null?void 0:oe.message)||ee.message))}}},M=F=>{if(!F)return"Root";const E=q.find(L=>L.category_id===F);return E?E.category_name:"Root"},X=F=>{var E;return((E=B.find(L=>L.value===F))==null?void 0:E.label)||F},R=(F,E)=>F.filter(L=>[L.group_code||"",L.group_name||"",L.category_code||"",L.category_name||"",L.uom_code||"",L.uom_name||"",L.type_code||"",L.type_name||""].some(J=>J.toLowerCase().includes(E.toLowerCase()))),H=R(r,b),W=R(q,b),K=R(n,b),_=R(Q,b);return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Item Setup Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage item groups, categories, and units of measure"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Item Groups"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),e.jsx(tA,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Categories"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.length})]}),e.jsx(ON,{className:"w-10 h-10 text-green-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Item Types"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Q.length})]}),e.jsx(tA,{className:"w-10 h-10 text-amber-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Units of Measure"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]}),e.jsx(QN,{className:"w-10 h-10 text-purple-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px",children:[e.jsx("button",{onClick:()=>s("groups"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="groups"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tA,{className:"w-5 h-5"}),"Item Groups"]})}),e.jsx("button",{onClick:()=>s("categories"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="categories"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ON,{className:"w-5 h-5"}),"Categories"]})}),e.jsx("button",{onClick:()=>s("types"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="types"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tA,{className:"w-5 h-5"}),"Item Types"]})}),e.jsx("button",{onClick:()=>s("uom"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="uom"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(QN,{className:"w-5 h-5"}),"Units of Measure"]})})]})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 w-full md:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(D0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:b,onChange:F=>y(F.target.value)})]})}),e.jsxs("button",{onClick:()=>V(t==="groups"?"group":t==="categories"?"category":t==="types"?"type":"uom","create"),className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#0E3646"},children:[e.jsx(vu,{className:"w-5 h-5"}),"Add New"]})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[t==="groups"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Group Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[S&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-4",children:"Loading..."})}),!S&&H.map(F=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.group_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.group_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${F.is_active==="Y"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:F.is_active==="Y"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V("group","edit",F),className:"text-blue-600 hover:text-blue-900",children:e.jsx(sA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Y("group",F.group_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Gl,{className:"w-5 h-5"})})]})})]},F.group_id))]})]}),t==="categories"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Category Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Parent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(F=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.category_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.category_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:M(F.parent_category_id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${F.is_active==="Y"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:F.is_active==="Y"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V("category","edit",F),className:"text-blue-600 hover:text-blue-900",children:e.jsx(sA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Y("category",F.category_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Gl,{className:"w-5 h-5"})})]})})]},F.category_id))})]}),t==="types"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Type Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(F=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.type_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.type_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${F.is_active==="Y"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:F.is_active==="Y"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V("type","edit",F),className:"text-blue-600 hover:text-blue-900",children:e.jsx(sA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Y("type",F.type_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Gl,{className:"w-5 h-5"})})]})})]},F.type_id))})]}),t==="uom"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"UOM Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(F=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:F.uom_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:F.uom_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:X(F.uom_type)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${F.is_active==="Y"||F.is_active===1||F.is_active===!0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:F.is_active==="Y"||F.is_active===1||F.is_active===!0?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>V("uom","edit",F),className:"text-blue-600 hover:text-blue-900",children:e.jsx(sA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>Y("uom",F.uom_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Gl,{className:"w-5 h-5"})})]})})]},F.uom_id))})]})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full",children:[e.jsx("div",{className:"p-6 border-b",style:{backgroundColor:"#0E3646"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[h==="create"?"Add":"Edit"," ",x==="group"?"Group":x==="category"?"Category":x==="type"?"Item Type":"UOM"]}),e.jsx("button",{onClick:()=>m(!1),className:"text-white hover:text-gray-200",children:e.jsx(EC,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code *"}),e.jsx("input",{type:"text",value:P.code,onChange:F=>I({...P,code:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",readOnly:x!=="uom"&&h==="create"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:P.name,onChange:F=>I({...P,name:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter name"})]}),x==="category"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),e.jsxs("select",{value:P.parent,onChange:F=>I({...P,parent:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Root (No Parent)"}),q.filter(F=>F.category_id!==(N==null?void 0:N.category_id)).map(F=>e.jsx("option",{value:F.category_id,children:F.category_name},F.category_id))]})]}),x==="uom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsx("select",{value:P.type,onChange:F=>I({...P,type:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:B.map(F=>e.jsx("option",{value:F.value,children:F.label},F.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:P.active,onChange:F=>I({...P,active:F.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"Y",children:"Active"}),e.jsx("option",{value:"N",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3 rounded-b-lg",children:[e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:D,className:"px-4 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#0E3646"},children:h==="create"?"Create":"Save Changes"})]})]})})]})};function CY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let d=!0;return i(!0),o(""),te.get("/inventory/unit-conversions").then(c=>{var m;d&&a(Array.isArray((m=c.data)==null?void 0:m.items)?c.data.items:[])}).catch(c=>{var m,h;d&&o(((h=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load unit conversions")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=v.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.item_code||"").toLowerCase().includes(d)||String(c.item_name||"").toLowerCase().includes(d)||String(c.from_uom||"").toLowerCase().includes(d)||String(c.to_uom||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Unit Conversion"}),e.jsx("p",{className:"text-sm mt-1",children:"Define unit conversions per item"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/unit-conversions/new",className:"btn-success",children:"+ New Conversion"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by item, from/to UOM...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{children:"Factor"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No unit conversions found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:[d.item_code," - ",d.item_name]})}),e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.from_uom}),e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.to_uom}),e.jsx("td",{children:d.conversion_factor}),e.jsx("td",{children:d.is_active?"Yes":"No"}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/unit-conversions/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/unit-conversions/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function BY(){const[t,s]=v.useState("conversions"),[r,a]=v.useState(!1),[n,i]=v.useState(""),{uoms:l,loading:o}=Po(),[u,d]=v.useState([]),[c,m]=v.useState([]),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState(""),[N,j]=v.useState(!1),[S,k]=v.useState("create"),[P,I]=v.useState({item_id:"",from_uom:"",to_uom:"",conversion_factor:"1",is_active:!0}),[B,q]=v.useState(""),[Q,O]=v.useState(""),[T,V]=v.useState(""),[D,Y]=v.useState(""),[M,X]=v.useState(null);v.useEffect(()=>{let U=!0;return a(!0),i(""),Promise.all([te.get("/inventory/items"),te.get("/inventory/unit-conversions")]).then(([J,ae])=>{var Z,oe;U&&(d(Array.isArray((Z=J.data)==null?void 0:Z.items)?J.data.items:[]),m(Array.isArray((oe=ae.data)==null?void 0:oe.items)?ae.data.items:[]))}).catch(J=>{var ae,Z;U&&i(((Z=(ae=J==null?void 0:J.response)==null?void 0:ae.data)==null?void 0:Z.message)||"Failed to load data")}).finally(()=>{U&&a(!1)}),()=>{U=!1}},[]),v.useMemo(()=>{const U=new Map;for(const J of u)U.set(String(J.id),J);return U},[u]);const R=async()=>{var U,J,ae,Z;a(!0),i("");try{const[oe,ee]=await Promise.all([te.get("/inventory/items"),te.get("/inventory/unit-conversions")]);d(Array.isArray((U=oe.data)==null?void 0:U.items)?oe.data.items:[]),m(Array.isArray((J=ee.data)==null?void 0:J.items)?ee.data.items:[])}catch(oe){i(((Z=(ae=oe==null?void 0:oe.response)==null?void 0:ae.data)==null?void 0:Z.message)||"Failed to refresh data")}finally{a(!1)}},H=v.useMemo(()=>{const U=h.toLowerCase();return c.filter(J=>{const ae=String(J.item_code||"").toLowerCase().includes(U)||String(J.item_name||"").toLowerCase().includes(U),Z=x?String(J.from_uom||"")===x:!0,oe=b===""?!0:b==="Y"?!!J.is_active:!J.is_active;return ae&&Z&&oe}).sort((J,ae)=>String(J.item_name||"").localeCompare(String(ae.item_name||"")))},[c,h,x,b]),W=(U,J=null)=>{k(U),U==="create"?I({item_id:"",from_uom:"",to_uom:"",conversion_factor:"1",is_active:!0}):J&&I({item_id:J.item_id?String(J.item_id):"",from_uom:J.from_uom||"",to_uom:J.to_uom||"",conversion_factor:J.conversion_factor!=null?String(J.conversion_factor):"1",is_active:!!J.is_active,id:J.id}),j(!0)},K=async()=>{var J,ae;const U={item_id:P.item_id?Number(P.item_id):null,from_uom:String(P.from_uom||"").trim(),to_uom:String(P.to_uom||"").trim(),conversion_factor:Number(P.conversion_factor),is_active:P.is_active?1:0};if(!U.item_id)return alert("Item is required");if(!U.from_uom)return alert("From UOM is required");if(!U.to_uom)return alert("To UOM is required");if(!Number.isFinite(U.conversion_factor)||U.conversion_factor<=0)return alert("Conversion factor must be a positive number");try{S==="create"?await te.post("/inventory/unit-conversions",U):await te.put(`/inventory/unit-conversions/${P.id}`,U),j(!1),await R()}catch(Z){alert(((ae=(J=Z==null?void 0:Z.response)==null?void 0:J.data)==null?void 0:ae.message)||"Failed to save unit conversion")}},_=async U=>{alert("Delete is not currently supported for Unit Conversions.")},F=v.useMemo(()=>{const U=B?Number(B):null;return U?c.filter(J=>Number(J.item_id)===U):[]},[c,B]),E=v.useMemo(()=>{const U=new Set;for(const J of F)U.add(J.from_uom);return Array.from(U)},[F]),L=v.useMemo(()=>{const U=new Set;for(const J of F)U.add(J.to_uom);return Array.from(U)},[F]);return v.useEffect(()=>{if(!B||!T||!D||!Q){X(null);return}const U=F.find(ae=>String(ae.from_uom)===String(T)&&String(ae.to_uom)===String(D));if(!U){X(null);return}const J=Number(Q);if(!Number.isFinite(J)){X(null);return}X(J*Number(U.conversion_factor||0))},[B,T,D,Q,F]),e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-1",children:"Unit Conversion Management"}),e.jsx("p",{className:"text-gray-600",children:"Define and calculate item unit conversions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:R,children:"Refresh"}),e.jsx("button",{className:"btn-success",onClick:()=>W("create"),children:"+ New Conversion"})]})]})}),n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px",children:[e.jsx("button",{onClick:()=>s("conversions"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="conversions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Unit Conversions"}),e.jsx("button",{onClick:()=>s("uom"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="uom"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Units of Measure"}),e.jsx("button",{onClick:()=>s("calculator"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="calculator"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Quick Calculator"})]})}),e.jsxs("div",{className:"p-4",children:[t==="conversions"&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsx("input",{className:"input",placeholder:"Search by item name or code",value:h,onChange:U=>f(U.target.value)}),e.jsxs("select",{className:"input",value:x,onChange:U=>g(U.target.value),children:[e.jsx("option",{value:"",children:"All Units"}),Array.from(new Set(c.map(U=>U.from_uom))).map(U=>U?e.jsx("option",{value:U,children:U},U):null)]}),e.jsxs("select",{className:"input",value:b,onChange:U=>y(U.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Y",children:"Active"}),e.jsx("option",{value:"N",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>{},children:"Search"}),e.jsx("button",{className:"btn-outline",onClick:()=>{f(""),g(""),y("")},children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"From UOM"}),e.jsx("th",{children:"To UOM"}),e.jsx("th",{children:"Conversion Factor"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500",children:"Loading..."})}):null,!r&&!H.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500",children:"No conversions found"})}):null,H.map(U=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:U.item_code}),e.jsx("td",{children:U.item_name}),e.jsx("td",{children:U.from_uom}),e.jsx("td",{children:U.to_uom}),e.jsx("td",{children:Number(U.conversion_factor||0).toString()}),e.jsx("td",{children:e.jsx("span",{className:`badge ${U.is_active?"badge-success":"badge-error"}`,children:U.is_active?"ACTIVE":"INACTIVE"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:()=>W("edit",U),children:"Edit"}),e.jsx("button",{className:"btn-outline",onClick:()=>_(U.id),children:"Delete"})]})})]},U.id))]})]})})]}),t==="uom"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"UOM Code"}),e.jsx("th",{children:"UOM Name"}),e.jsx("th",{children:"UOM Type"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[o?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500",children:"Loading..."})}):null,!o&&!l.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500",children:"No UOMs found"})}):null,l.map(U=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:U.uom_code}),e.jsx("td",{children:U.uom_name}),e.jsx("td",{children:U.uom_type}),e.jsx("td",{children:U.is_active?"Active":"Inactive"})]},U.id))]})]})}),t==="calculator"&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Select Item"}),e.jsxs("select",{className:"input",value:B,onChange:U=>{q(U.target.value),V(""),Y(""),X(null)},children:[e.jsx("option",{value:"",children:"Choose an item..."}),u.map(U=>e.jsx("option",{value:String(U.id),children:(U.item_code||"")+" - "+(U.item_name||"")},U.id))]})]})}),e.jsxs("div",{className:"bg-slate-50 border rounded p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"label",children:"Value to Convert"}),e.jsx("input",{type:"number",step:"0.000001",className:"input",value:Q,onChange:U=>O(U.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Unit"}),e.jsxs("select",{className:"input",value:T,onChange:U=>V(U.target.value),children:[e.jsx("option",{value:"",children:"Select unit"}),E.map(U=>e.jsx("option",{value:U,children:U},U))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Unit"}),e.jsxs("select",{className:"input",value:D,onChange:U=>Y(U.target.value),children:[e.jsx("option",{value:"",children:"Select unit"}),L.map(U=>e.jsx("option",{value:U,children:U},U))]})]}),e.jsx("div",{children:e.jsx("button",{className:"btn-success w-full",onClick:()=>{},children:"Calculate"})})]}),e.jsx("div",{className:"mt-4",children:M!=null?e.jsxs("div",{className:"p-3 border-2 rounded text-center text-lg font-semibold",children:[Q||0," ",T||""," = ",M," ",D||""]}):e.jsx("div",{className:"text-sm text-slate-500",children:"Select item and units to calculate"})})]})]})]})]}),N?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow max-w-xl w-full",children:[e.jsxs("div",{className:"px-5 py-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:S==="create"?"New Conversion":"Edit Conversion"}),e.jsx("button",{className:"btn-outline",onClick:()=>j(!1),children:""})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item *"}),e.jsxs("select",{className:"input",value:P.item_id,onChange:U=>I({...P,item_id:U.target.value}),children:[e.jsx("option",{value:"",children:"Select item..."}),u.map(U=>e.jsx("option",{value:String(U.id),children:(U.item_code||"")+" - "+(U.item_name||"")},U.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:P.is_active,onChange:U=>I({...P,is_active:U.target.checked})}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From UOM *"}),e.jsxs("select",{className:"input",value:P.from_uom,onChange:U=>I({...P,from_uom:U.target.value}),children:[e.jsx("option",{value:"",children:"Select unit"}),o?e.jsx("option",{children:"Loading..."}):l.map(U=>e.jsx("option",{value:U.uom_code,children:U.uom_code},U.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To UOM *"}),e.jsxs("select",{className:"input",value:P.to_uom,onChange:U=>I({...P,to_uom:U.target.value}),children:[e.jsx("option",{value:"",children:"Select unit"}),o?e.jsx("option",{children:"Loading..."}):l.map(U=>e.jsx("option",{value:U.uom_code,children:U.uom_code},U.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Factor *"}),e.jsx("input",{type:"number",step:"0.000001",className:"input",value:P.conversion_factor,onChange:U=>I({...P,conversion_factor:U.target.value})})]})]})]}),e.jsxs("div",{className:"px-5 py-4 border-t flex justify-end gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:()=>j(!1),children:"Cancel"}),e.jsx("button",{className:"btn-success",onClick:K,children:"Save"})]})]})}):null]})})}function kY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState(!1),[c,m]=v.useState(null),[h,f]=v.useState(!1),[x,g]=v.useState(""),[b,y]=v.useState(null),[N,j]=v.useState(null),[S,k]=v.useState([]),[P,I]=v.useState(!1),[B,q]=v.useState(null),[Q,O]=v.useState(null);v.useEffect(()=>{let H=!0;return i(!0),o(""),te.get("/inventory/stock-adjustments").then(W=>{var K;H&&a(Array.isArray((K=W.data)==null?void 0:K.items)?W.data.items:[])}).catch(W=>{var K,_;H&&o(((_=(K=W==null?void 0:W.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load stock updations")}).finally(()=>{H&&i(!1)}),()=>{H=!1}},[]);const T=H=>({DRAFT:"badge-info",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-success",POSTED:"badge-success",REJECTED:"badge-error",CANCELLED:"badge-error",RETURNED:"badge-error"})[H]||"badge-info",V=v.useMemo(()=>r.filter(H=>String(H.adjustment_no||"").toLowerCase().includes(t.toLowerCase())),[r,t]),D=H=>{if(!H)return"";let W=new Date(H);return isNaN(W.getTime())&&(isNaN(Number(H))||(W=new Date(Number(H)))),isNaN(W.getTime())?String(H):W.toLocaleDateString()},Y=async H=>{var W,K,_;if(m(H),d(!0),g(""),B)await M();else try{f(!0);const F=await te.get("/workflows"),E=Array.isArray((W=F.data)==null?void 0:W.items)?F.data.items:[];q(E),await X(E)}catch(F){g(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load workflows")}finally{f(!1)}},M=async()=>{var _,F,E;if(!B||!B.length){y(null),j(null),g("");return}const H="/inventory/stock-adjustments",W=L=>String(L||"").trim().toUpperCase().replace(/\s+/g,"_"),K=B.find(L=>Number(L.is_active)===1&&String(L.document_route)===H)||B.find(L=>Number(L.is_active)===1&&W(L.document_type)==="STOCK_ADJUSTMENT")||null;if(y(K||null),j(null),!!K)try{f(!0);const U=(_=(await te.get(`/workflows/${K.id}`)).data)==null?void 0:_.item,J=Array.isArray(U==null?void 0:U.steps)?U.steps:[];k(J);const ae=J[0]||null;if(j(ae?{userId:ae.approver_user_id,name:ae.approver_name,stepName:ae.step_name,stepOrder:ae.step_order,approvalLimit:ae.approval_limit}:null),ae){const Z=(Array.isArray(ae.approvers)&&ae.approvers.length?ae.approvers[0].id:ae.approver_user_id)||null;O(Z)}else O(null)}catch(L){g(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Failed to load workflow details")}finally{f(!1)}},X=async H=>{var F,E,L;if(!H||!H.length){y(null),j(null),g("");return}const W="/inventory/stock-adjustments",K=U=>String(U||"").trim().toUpperCase().replace(/\s+/g,"_"),_=H.find(U=>Number(U.is_active)===1&&String(U.document_route)===W)||H.find(U=>Number(U.is_active)===1&&K(U.document_type)==="STOCK_ADJUSTMENT")||null;if(y(_||null),j(null),!!_)try{f(!0);const J=(F=(await te.get(`/workflows/${_.id}`)).data)==null?void 0:F.item,ae=Array.isArray(J==null?void 0:J.steps)?J.steps:[];k(ae);const Z=ae[0]||null;j(Z?{userId:Z.approver_user_id,name:Z.approver_name,stepName:Z.step_name,stepOrder:Z.step_order,approvalLimit:Z.approval_limit}:null)}catch(U){g(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load workflow details")}finally{f(!1)}},R=async()=>{var H,W,K;if(c){I(!0),g("");try{const _=await te.post(`/inventory/stock-adjustments/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:Q||null}),F=((H=_==null?void 0:_.data)==null?void 0:H.status)||"PENDING_APPROVAL";a(E=>E.map(L=>L.id===c.id?{...L,status:F}:L)),d(!1),m(null)}catch(_){g(((K=(W=_==null?void 0:_.response)==null?void 0:W.data)==null?void 0:K.message)||"Failed to forward for approval")}finally{I(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Stock Updation"}),e.jsx("p",{className:"text-sm mt-1",children:"Update stock levels (uses Stock Adjustments)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/stock-updation/new",className:"btn-success",children:"+ New Updation"})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by document number...",className:"input max-w-md",value:t,onChange:H=>s(H.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Document No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:l})}):null,V.map(H=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:H.adjustment_no}),e.jsx("td",{children:D(H.adjustment_date)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${H.adjustment_type==="INCREASE"?"badge-success":"badge-warning"}`,children:H.adjustment_type})}),e.jsx("td",{children:H.item_count}),e.jsx("td",{children:e.jsx("span",{className:`badge ${T(H.status)} `,children:H.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Ee,{to:`/inventory/stock-updation/${H.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/stock-updation/${H.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),H.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):H.status==="DRAFT"||H.status==="RETURNED"?e.jsx("button",{type:"button",onClick:()=>Y(H),className:"text-sm font-medium px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:"Forward"}):null]})})]},H.id))]})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),m(null),y(null),j(null),g("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.adjustment_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[h?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,x?e.jsx("div",{className:"text-sm text-red-600",children:x}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const W=Array.isArray(S)&&S.length>0?S[0]:null,K=W?Array.isArray(W.approvers)&&W.approvers.length?W.approvers.map(_=>({id:_.id,name:_.username})):W.approver_user_id?[{id:W.approver_user_id,name:W.approver_name||String(W.approver_user_id)}]:[]:[];return K.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:Q||"",onChange:_=>O(_.target.value?Number(_.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),K.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:N?`Step ${N.stepOrder}  ${N.stepName}${N.approvalLimit!=null?`  Limit: ${Number(N.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),m(null),y(null),j(null),g("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:R,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function EY(){const{uoms:t,loading:s}=Po(),{id:r}=Ps(),a=Ns(),n=r==="new",[i]=_0(),l=(i.get("mode")||"").toLowerCase(),o=!n&&l==="view",[u,d]=v.useState(!1),[c,m]=v.useState(!1),[h,f]=v.useState(""),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState({adjustmentNo:"",adjustmentDate:new Date().toISOString().split("T")[0],warehouseId:"",adjustmentType:"PHYSICAL_COUNT",referenceDoc:"",reason:"",status:"DRAFT"}),[S,k]=v.useState([]);v.useEffect(()=>{let V=!0;return Promise.all([te.get("/inventory/items"),te.get("/inventory/warehouses")]).then(([D,Y])=>{var M,X;V&&(g(Array.isArray((M=D.data)==null?void 0:M.items)?D.data.items:[]),y(Array.isArray((X=Y.data)==null?void 0:X.items)?Y.data.items:[]))}).catch(D=>{var Y,M;V&&f(((M=(Y=D==null?void 0:D.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to load lookups")}),()=>{V=!1}},[]),v.useEffect(()=>{if(n){k([{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}]);return}let V=!0;return d(!0),f(""),te.get(`/inventory/stock-adjustments/${r}`).then(D=>{var X,R;if(!V)return;const Y=(X=D.data)==null?void 0:X.item,M=Array.isArray((R=D.data)==null?void 0:R.details)?D.data.details:[];Y&&(j({adjustmentNo:Y.adjustment_no||"",adjustmentDate:Y.adjustment_date?new Date(Y.adjustment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],warehouseId:Y.warehouse_id?String(Y.warehouse_id):"",adjustmentType:Y.adjustment_type||"PHYSICAL_COUNT",referenceDoc:Y.reference_doc||"",reason:Y.reason||"",status:Y.status||"DRAFT"}),k(M.length?M.map(H=>({id:H.id||Date.now()+Math.random(),item_id:H.item_id?String(H.item_id):"",itemCode:H.item_code||"",itemName:H.item_name||"",currentStock:Number(H.current_stock)||0,adjustedStock:Number(H.adjusted_stock)||0,uom:H.uom||"",unitCost:Number(H.unit_cost)||0,remarks:H.remarks||""})):[]))}).catch(D=>{var Y,M;V&&f(((M=(Y=D==null?void 0:D.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to load stock adjustment")}).finally(()=>{V&&d(!1)}),()=>{V=!1}},[r,n]);const P=v.useMemo(()=>S.filter(V=>V.item_id).map(V=>({item_id:Number(V.item_id),current_stock:Number(V.currentStock)||0,adjusted_stock:Number(V.adjustedStock)||0,qty:Number(V.adjustedStock)-Number(V.currentStock),unit_cost:Number(V.unitCost)||0,remarks:V.remarks})),[S]),I=async V=>{var D,Y;V.preventDefault(),m(!0),f("");try{const M={adjustment_no:n?void 0:N.adjustmentNo,adjustment_date:N.adjustmentDate,warehouse_id:N.warehouseId?Number(N.warehouseId):null,adjustment_type:N.adjustmentType,reference_doc:N.referenceDoc,reason:N.reason,status:N.status,details:P};n?await te.post("/inventory/stock-adjustments",M):await te.put(`/inventory/stock-adjustments/${r}`,M),a("/inventory/stock-updation")}catch(M){f(((Y=(D=M==null?void 0:M.response)==null?void 0:D.data)==null?void 0:Y.message)||"Failed to save stock updation")}finally{m(!1)}},B=()=>{k([...S,{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}])},q=V=>{k(S.filter(D=>D.id!==V))},Q=(V,D,Y)=>{k(S.map(M=>{if(M.id===V){const X={...M,[D]:Y};if(D==="item_id"){const R=x.find(H=>String(H.id)===String(Y));X.itemCode=(R==null?void 0:R.item_code)||"",X.itemName=(R==null?void 0:R.item_name)||"",X.unitCost=(R==null?void 0:R.cost_price)||0}return X}return M}))},O=V=>{j(D=>({...D,reason:V}))},T=V=>{const D="border-2 rounded-lg p-4 cursor-pointer transition-all text-center hover:shadow-md",Y=N.adjustmentType===V?" ring-2 ring-brand-500 bg-brand-50 border-brand-500":" border-slate-200 bg-white";return V==="INCREASE"?`${D} ${Y} ${N.adjustmentType===V?"border-green-500 ring-green-500 bg-green-50":"hover:border-green-200"}`:V==="DECREASE"?`${D} ${Y} ${N.adjustmentType===V?"border-red-500 ring-red-500 bg-red-50":"hover:border-red-200"}`:`${D} ${Y}`};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:n?"New Stock Updation":o?"View Stock Updation":"Edit Stock Updation"}),e.jsx("p",{className:"text-sm mt-1",children:"Update stock levels"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Ee,{to:"/inventory/stock-updation",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:" Back to List"})})]})}),e.jsx("div",{className:"card-body p-6",children:e.jsxs("form",{onSubmit:I,className:"space-y-8",children:[u&&e.jsx("div",{className:"text-sm",children:"Loading..."}),h&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-md border border-red-200",children:h}),e.jsxs("fieldset",{disabled:o,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Select Updation Type"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:T("PHYSICAL_COUNT"),onClick:()=>j({...N,adjustmentType:"PHYSICAL_COUNT"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Physical Count"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Based on actual inventory count"})]}),e.jsxs("div",{className:T("INCREASE"),onClick:()=>j({...N,adjustmentType:"INCREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Increase"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Add stock (found, corrections)"})]}),e.jsxs("div",{className:T("DECREASE"),onClick:()=>j({...N,adjustmentType:"DECREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Decrease"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Reduce stock (damage, theft)"})]}),e.jsxs("div",{className:T("OTHER"),onClick:()=>j({...N,adjustmentType:"OTHER"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Other Adjustment"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Miscellaneous adjustments"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Updation Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Document No"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:N.adjustmentNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"input",value:N.adjustmentDate,onChange:V=>j({...N,adjustmentDate:V.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:N.warehouseId,onChange:V=>j({...N,warehouseId:V.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Warehouse --"}),b.map(V=>e.jsx("option",{value:V.id,children:V.warehouse_name},V.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:N.adjustmentType,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference Document"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., PC-2024-001",value:N.referenceDoc,onChange:V=>j({...N,referenceDoc:V.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${N.status==="DRAFT"?"bg-slate-200 text-slate-700":"bg-green-100 text-green-700"}`,children:N.status})})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"input",rows:"2",placeholder:"Provide detailed reason for this stock updation...",value:N.reason,onChange:V=>j({...N,reason:V.target.value}),required:!0}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["Physical count variance","Damaged goods","Expired items","Theft/Loss","Found items","System error correction","Other"].map(V=>e.jsx("button",{type:"button",onClick:()=>O(V),className:`px-3 py-1 rounded-full text-xs border ${N.reason===V?"bg-brand-500 text-white border-brand-500":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50"}`,children:V},V))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:" Items"}),e.jsx("button",{type:"button",onClick:B,className:"btn-primary text-sm px-3 py-1 rounded bg-brand-600 text-white hover:bg-brand-700",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700 uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Item"}),e.jsx("th",{className:"p-3 w-24",children:"Current Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Adjusted Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Diff"}),e.jsx("th",{className:"p-3 w-20",children:"UOM"}),e.jsx("th",{className:"p-3 w-24",children:"Unit Cost"}),e.jsx("th",{className:"p-3 w-28",children:"Impact"}),e.jsx("th",{className:"p-3",children:"Remarks"}),e.jsx("th",{className:"p-3 w-16"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200",children:[S.map(V=>{const D=Number(V.adjustedStock)-Number(V.currentStock),Y=D*Number(V.unitCost);return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"input text-sm py-1",value:V.item_id,onChange:M=>Q(V.id,"item_id",M.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),x.map(M=>e.jsxs("option",{value:M.id,children:[M.item_code," - ",M.item_name]},M.id))]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1 bg-slate-50",value:V.currentStock,onChange:M=>Q(V.id,"currentStock",M.target.value)})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1 font-bold",value:V.adjustedStock,onChange:M=>Q(V.id,"adjustedStock",M.target.value)})}),e.jsx("td",{className:"p-2 font-bold",children:e.jsxs("span",{className:D>0?"text-green-600":D<0?"text-red-600":"text-slate-400",children:[D>0?"+":"",D]})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"input text-sm py-1",value:V.uom,onChange:M=>Q(V.id,"uom",M.target.value),children:s?e.jsx("option",{children:"Loading..."}):t.map(M=>e.jsx("option",{value:M.uom_code,children:M.uom_code},M.id))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1",value:V.unitCost,onChange:M=>Q(V.id,"unitCost",M.target.value)})}),e.jsx("td",{className:"p-2 font-medium",children:Y.toFixed(2)}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",placeholder:"Optional",value:V.remarks,onChange:M=>Q(V.id,"remarks",M.target.value)})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>q(V.id),className:"text-red-500 hover:text-red-700",children:""})})]},V.id)}),S.length===0&&e.jsx("tr",{children:e.jsx("td",{colspan:"9",className:"p-8 text-center text-slate-500",children:'No items added. Click "Add Item" to begin.'})})]})]})})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:" Impact Summary"}),e.jsxs("div",{className:"flex gap-8 text-sm",children:[e.jsxs("div",{children:["Total Items:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.length})]}),e.jsxs("div",{children:["Net Qty Change:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.reduce((V,D)=>V+(Number(D.adjustedStock)-Number(D.currentStock)),0)})]}),e.jsxs("div",{children:["Total Value Impact:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.reduce((V,D)=>V+(Number(D.adjustedStock)-Number(D.currentStock))*Number(D.unitCost),0).toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[e.jsx(Ee,{to:"/inventory/stock-updation",className:"btn-light bg-white border border-slate-300 text-slate-700 hover:bg-slate-50 px-4 py-2 rounded",children:"Cancel"}),o?null:e.jsx("button",{type:"submit",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:c?"Saving...":"Save Updation"})]})]})})]})})}function FY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState([]),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState("ALL");v.useEffect(()=>{let j=!0;return o(!0),Promise.all([te.get("/inventory/stock-adjustments"),te.get("/inventory/warehouses")]).then(([S,k])=>{var P,I;j&&(a(Array.isArray((P=S.data)==null?void 0:P.items)?S.data.items:[]),i(Array.isArray((I=k.data)==null?void 0:I.items)?k.data.items:[]))}).catch(S=>{var k,P;j&&d(((P=(k=S==null?void 0:S.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to load stock verifications")}).finally(()=>{j&&o(!1)}),()=>{j=!1}},[]);const h=j=>{const S=n.find(k=>k.id===j);return S?S.name:"Unknown Warehouse"},f=[{value:"DRAFT",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"IN_PROGRESS",label:"In Progress",color:"bg-blue-100 text-blue-800"},{value:"COMPLETED",label:"Completed",color:"bg-green-100 text-green-800"},{value:"ADJUSTED",label:"Adjusted",color:"bg-purple-100 text-purple-800"}],x=j=>{const S=f.find(k=>k.value===j);if(!S){if(j==="POSTED")return e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Posted"});if(j==="CANCELLED")return e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Cancelled"})}return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${(S==null?void 0:S.color)||"bg-gray-100 text-gray-800"}`,children:(S==null?void 0:S.label)||j})},g=[{value:"PHYSICAL_COUNT",label:"Physical Count"},{value:"CYCLE_COUNT",label:"Cycle Count"},{value:"SPOT_CHECK",label:"Spot Check"}],b=j=>{var S;return((S=g.find(k=>k.value===j))==null?void 0:S.label)||j},y=v.useMemo(()=>r.filter(j=>{const S=String(j.adjustment_no||"").toLowerCase().includes(t.toLowerCase())||!1,k=c==="ALL"||j.status===c;return S&&k}),[r,t,c]),N={total:r.length,inProgress:r.filter(j=>j.status==="IN_PROGRESS"||j.status==="DRAFT").length,completed:r.filter(j=>j.status==="COMPLETED"||j.status==="POSTED").length,variance:0};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Stock Verification"}),e.jsx("p",{className:"text-gray-600",children:"Manage and track warehouse stock verification activities"})]}),e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Verifications"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:N.total})]}),e.jsx(kC,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"In Progress"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:N.inProgress})]}),e.jsx(tA,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:N.completed})]}),e.jsx(WT,{className:"w-10 h-10 text-green-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Variance"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["$",N.variance.toFixed(2)]})]}),e.jsx(KT,{className:"w-10 h-10 text-orange-500"})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 w-full md:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(D0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by verification number...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t,onChange:j=>s(j.target.value)})]})}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:c,onChange:j=>m(j.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),f.map(j=>e.jsx("option",{value:j.value,children:j.label},j.value))]}),e.jsxs(Ee,{to:"/inventory/stock-verification/new",className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#0E3646"},children:[e.jsx(vu,{className:"w-5 h-5"}),"New Verification"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Verification #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Warehouse"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Variance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No verifications found"})}):y.map(j=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:j.adjustment_no})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:j.adjustment_date})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:h(j.warehouse_id)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:b(j.adjustment_type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:x(j.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/inventory/stock-verification/${j.id}?mode=view`,className:"text-blue-600 hover:text-blue-900",title:"View Details",children:e.jsx(L0,{className:"w-5 h-5"})}),e.jsx(Ee,{to:`/inventory/stock-verification/${j.id}?mode=edit`,className:"text-green-600 hover:text-green-900",title:"Edit",children:e.jsx(sA,{className:"w-5 h-5"})})]})})]},j.id))})]})})})]})})}function TY(){const{id:t}=Ps(),s=Ns(),r=t==="new",[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState([]),[m,h]=v.useState([]),[f,x]=v.useState({verification_number:"",verification_date:new Date().toISOString().split("T")[0],warehouse_id:"",verification_type:"PHYSICAL_COUNT",start_date:new Date().toISOString().split("T")[0],end_date:"",status:"DRAFT",remarks:""}),[g,b]=v.useState([]),y=[{value:"PHYSICAL_COUNT",label:"Physical Count"},{value:"CYCLE_COUNT",label:"Cycle Count"},{value:"SPOT_CHECK",label:"Spot Check"}],N=[{value:"DRAFT",label:"Draft"},{value:"IN_PROGRESS",label:"In Progress"},{value:"COMPLETED",label:"Completed"},{value:"ADJUSTED",label:"Adjusted"}];v.useEffect(()=>{let B=!0;return(async()=>{var Q,O;try{const[T,V]=await Promise.all([te.get("/inventory/items"),te.get("/inventory/warehouses")]);B&&(c(Array.isArray((Q=T.data)==null?void 0:Q.items)?T.data.items:[]),h(Array.isArray((O=V.data)==null?void 0:O.items)?V.data.items:[]))}catch{B&&u("Failed to load initial data")}})(),()=>{B=!1}},[]),v.useEffect(()=>{if(r)return;let B=!0;return n(!0),te.get(`/inventory/stock-adjustments/${t}`).then(q=>{var T,V;if(!B)return;const Q=(T=q.data)==null?void 0:T.item,O=Array.isArray((V=q.data)==null?void 0:V.details)?q.data.details:[];Q&&(x({verification_number:Q.adjustment_no,verification_date:Q.adjustment_date?Q.adjustment_date.split("T")[0]:"",warehouse_id:Q.warehouse_id||"",verification_type:Q.adjustment_type||"PHYSICAL_COUNT",start_date:new Date().toISOString().split("T")[0],end_date:"",status:Q.status||"DRAFT",remarks:Q.reason||""}),b(O.map(D=>({id:D.id||Date.now()+Math.random(),item_id:D.item_id,qty:Number(D.qty)||0,uom:""}))))}).catch(q=>{var Q,O;B&&u(((O=(Q=q==null?void 0:q.response)==null?void 0:Q.data)==null?void 0:O.message)||"Failed to load verification")}).finally(()=>{B&&n(!1)}),()=>{B=!1}},[t,r]);const j=B=>{const{name:q,value:Q}=B.target;x(O=>({...O,[q]:Q}))},S=()=>{b([...g,{id:Date.now(),item_id:"",qty:0,uom:"PCS"}])},k=B=>{b(g.filter(q=>q.id!==B))},P=(B,q,Q)=>{b(g.map(O=>{if(O.id===B){const T={...O,[q]:Q};if(q==="item_id"){const V=d.find(D=>String(D.id)===String(Q));V&&(T.uom=V.uom||"")}return T}return O}))},I=async B=>{var q,Q;if(B.preventDefault(),!f.warehouse_id||!f.verification_date){alert("Please fill in all required fields");return}l(!0),u("");try{const O={adjustment_no:r?void 0:f.verification_number,adjustment_date:f.verification_date,warehouse_id:Number(f.warehouse_id),adjustment_type:f.verification_type,start_date:f.start_date||null,end_date:f.end_date||null,status:f.status,reason:f.remarks,details:g.filter(T=>T.item_id).map(T=>({item_id:Number(T.item_id),qty:Number(T.qty)}))};r?await te.post("/inventory/stock-adjustments",O):await te.put(`/inventory/stock-adjustments/${t}`,O),s("/inventory/stock-verification")}catch(O){u(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to save verification")}finally{l(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ee,{to:"/inventory/stock-verification",className:"p-2 bg-white rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:e.jsx(If,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"New Stock Verification":"Edit Stock Verification"}),e.jsx("p",{className:"text-sm text-gray-600",children:r?"Create a new stock verification record":`Editing ${f.verification_number}`})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ee,{to:"/inventory/stock-verification",className:"px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:I,disabled:i,className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#0E3646"},children:[e.jsx(Hh,{className:"w-5 h-5"}),i?"Saving...":"Save Verification"]})]})]}),o&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:o}),a?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-2 border-b",children:"Verification Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Number"}),e.jsx("input",{type:"text",name:"verification_number",value:f.verification_number,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Date *"}),e.jsx("input",{type:"date",name:"verification_date",value:f.verification_date,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse *"}),e.jsxs("select",{name:"warehouse_id",value:f.warehouse_id,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),m.map(B=>e.jsx("option",{value:B.id,children:B.warehouse_name},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Type *"}),e.jsx("select",{name:"verification_type",value:f.verification_type,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:y.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"start_date",value:f.start_date,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"end_date",value:f.end_date,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsx("select",{name:"status",value:f.status,onChange:j,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:N.map(B=>e.jsx("option",{value:B.value,children:B.label},B.value))})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{name:"remarks",value:f.remarks,onChange:j,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter any additional remarks..."})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Items"}),e.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-3 py-1.5 text-white text-sm font-medium rounded-md hover:opacity-90 transition-opacity",style:{backgroundColor:"#0E3646"},children:[e.jsx(vu,{className:"w-4 h-4"}),"Add Item"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"Variance Qty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"UOM"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:'No items added yet. Click "Add Item" to start.'})}):g.map(B=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:B.item_id,onChange:q=>P(B.id,"item_id",q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Item"}),d.map(q=>e.jsxs("option",{value:q.id,children:[q.item_code," - ",q.item_name]},q.id))]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"number",value:B.qty,onChange:q=>P(B.id,"qty",parseFloat(q.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",step:"1"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",value:B.uom,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>k(B.id),className:"text-red-600 hover:text-red-900 p-2 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(Gl,{className:"w-5 h-5"})})})]},B.id))})]})})]})]})]})})}function IY(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState([]),[u,d]=v.useState(!1),[c,m]=v.useState(null),[h,f]=v.useState(!1),[x,g]=v.useState(""),[b,y]=v.useState(null),[N,j]=v.useState(null),[S,k]=v.useState([]),[P,I]=v.useState(!1),[B,q]=v.useState(null),[Q,O]=v.useState(null);v.useEffect(()=>{let H=!0;return a(!0),i(""),te.get("/inventory/return-to-stores").then(W=>{var K;H&&o(Array.isArray((K=W.data)==null?void 0:K.items)?W.data.items:[])}).catch(W=>{var K,_;H&&i(((_=(K=W==null?void 0:W.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load return to stores")}).finally(()=>{H&&a(!1)}),()=>{H=!1}},[]);const T=H=>({DRAFT:"bg-slate-100 text-slate-700",PENDING:"bg-yellow-100 text-yellow-800",PENDING_APPROVAL:"bg-yellow-100 text-yellow-800",SUBMITTED:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",POSTED:"bg-blue-100 text-blue-800",REJECTED:"bg-red-100 text-red-800"})[H]||"bg-slate-100 text-slate-700",V=v.useMemo(()=>{const H=l.length,W=l.filter(F=>F.status==="PENDING").length,K=l.filter(F=>F.status==="APPROVED"||F.status==="POSTED").length,_=l.filter(F=>F.status==="REJECTED").length;return{total:H,pending:W,approved:K,rejected:_}},[l]),D=v.useMemo(()=>{const H=t.toLowerCase();return l.filter(W=>{const K=String(W.rts_no||"").toLowerCase(),_=String(W.warehouse_name||"").toLowerCase();return K.includes(H)||_.includes(H)})},[l,t]),Y=async H=>{var W,K,_;if(m(H),d(!0),g(""),B)await M();else try{f(!0);const F=await te.get("/workflows"),E=Array.isArray((W=F.data)==null?void 0:W.items)?F.data.items:[];q(E),await X(E)}catch(F){g(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load workflows")}finally{f(!1)}},M=async()=>{var _,F,E;if(!B||!B.length){y(null),j(null),g("");return}const H="/inventory/return-to-stores",W=L=>String(L||"").trim().toUpperCase().replace(/\s+/g,"_"),K=B.find(L=>Number(L.is_active)===1&&String(L.document_route)===H)||B.find(L=>Number(L.is_active)===1&&W(L.document_type)==="RETURN_TO_STORES")||null;if(y(K||null),j(null),!!K)try{f(!0);const U=(_=(await te.get(`/workflows/${K.id}`)).data)==null?void 0:_.item,J=Array.isArray(U==null?void 0:U.steps)?U.steps:[];k(J);const ae=J[0]||null;if(j(ae?{userId:ae.approver_user_id,name:ae.approver_name,stepName:ae.step_name,stepOrder:ae.step_order,approvalLimit:ae.approval_limit}:null),ae){const Z=(Array.isArray(ae.approvers)&&ae.approvers.length?ae.approvers[0].id:ae.approver_user_id)||null;O(Z)}else O(null)}catch(L){g(((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.message)||"Failed to load workflow details")}finally{f(!1)}},X=async H=>{var F,E,L;if(!H||!H.length){y(null),j(null),g("");return}const W="/inventory/return-to-stores",K=U=>String(U||"").trim().toUpperCase().replace(/\s+/g,"_"),_=H.find(U=>Number(U.is_active)===1&&String(U.document_route)===W)||H.find(U=>Number(U.is_active)===1&&K(U.document_type)==="RETURN_TO_STORES")||null;if(y(_||null),j(null),!!_)try{f(!0);const J=(F=(await te.get(`/workflows/${_.id}`)).data)==null?void 0:F.item,ae=Array.isArray(J==null?void 0:J.steps)?J.steps:[];k(ae);const Z=ae[0]||null;j(Z?{userId:Z.approver_user_id,name:Z.approver_name,stepName:Z.step_name,stepOrder:Z.step_order,approvalLimit:Z.approval_limit}:null)}catch(U){g(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load workflow details")}finally{f(!1)}},R=async()=>{var H,W,K;if(c){I(!0),g("");try{const _=await te.post(`/inventory/return-to-stores/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:Q||null}),F=((H=_==null?void 0:_.data)==null?void 0:H.status)||"PENDING_APPROVAL";o(E=>E.map(L=>L.id===c.id?{...L,status:F}:L)),d(!1),m(null)}catch(_){g(((K=(W=_==null?void 0:_.response)==null?void 0:W.data)==null?void 0:K.message)||"Failed to forward for approval")}finally{I(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Total Returns"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white mt-1",children:V.total})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400 mt-1",children:V.pending})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1",children:V.approved})]}),e.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400 mt-1",children:V.rejected})]}),e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{children:""})," Return to Stores"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Manage material returns and approvals"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsxs(Ee,{to:"/inventory/return-to-stores/new",className:"btn btn-primary bg-[#2E7D9F] hover:bg-[#24637e] text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx("span",{children:"+"})," New Return"]})]})]})}),e.jsxs("div",{className:"card-body p-0",children:[r?e.jsxs("div",{className:"p-8 text-center text-slate-500",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-[#2E7D9F] border-t-transparent rounded-full mx-auto mb-4"}),"Loading returns..."]}):null,n?e.jsxs("div",{className:"p-4 m-4 bg-red-50 text-red-600 rounded-lg border border-red-100 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n]}):null,e.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("input",{type:"text",placeholder:"Search by advice number or warehouse...",className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2E7D9F] focus:border-transparent dark:bg-slate-700 dark:text-white",value:t,onChange:H=>s(H.target.value)}),e.jsx("svg",{className:"w-5 h-5 text-slate-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-600 dark:text-slate-300 text-xs uppercase font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Advice No"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Type"}),e.jsx("th",{className:"px-6 py-4",children:"Department"}),e.jsx("th",{className:"px-6 py-4",children:"Warehouse"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Items"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:[D.map(H=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-[#2E7D9F] dark:text-[#5fb8e3]",children:e.jsx(Ee,{to:`/inventory/return-to-stores/${H.id}`,children:H.rts_no})}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:H.rts_date}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:H.return_type||"-"})}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:H.department_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:H.warehouse_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 text-xs font-bold",children:H.item_count})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${T(H.status)}`,children:H.status})}),e.jsxs("td",{className:"px-6 py-4 text-right",children:[e.jsx(Ee,{to:`/inventory/return-to-stores/${H.id}`,className:"text-slate-400 hover:text-[#2E7D9F] transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),H.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",onClick:()=>Y(H),className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-[#2E7D9F] text-white hover:bg-[#24637e] transition-colors",disabled:P||H.status==="POSTED"||H.status==="REJECTED"||H.status==="PENDING_APPROVAL"||H.status==="SUBMITTED",children:P?"Forwarding...":"Forward for Approval"})]})]},H.id)),D.length===0&&!r&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-400",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{children:"No return records found"})]})})})]})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),m(null),y(null),j(null),g("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Return Advice:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.rts_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[h?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,x?e.jsx("div",{className:"text-sm text-red-600",children:x}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const W=Array.isArray(S)&&S.length>0?S[0]:null,K=W?Array.isArray(W.approvers)&&W.approvers.length?W.approvers.map(_=>({id:_.id,name:_.username})):W.approver_user_id?[{id:W.approver_user_id,name:W.approver_name||String(W.approver_user_id)}]:[]:[];return K.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:Q||"",onChange:_=>O(_.target.value?Number(_.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),K.map(_=>e.jsx("option",{value:_.id,children:_.name},_.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:N?`Step ${N.stepOrder}  ${N.stepName}${N.approvalLimit!=null?`  Limit: ${Number(N.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),m(null),y(null),j(null),g("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:R,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function z_(){const{id:t}=Ps(),s=Ns(),r=!t||t==="new",[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState([]),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState([]),[y,N]=v.useState({rtsNo:r?"Auto-generated":"RT-000000",rtsDate:new Date().toISOString().split("T")[0],warehouseId:"",departmentId:"",returnType:"EXCESS",requisitionId:"",status:"DRAFT",remarks:""}),[j,S]=v.useState([{id:1,item_id:"",itemCode:"",itemName:"",uom:"",qtyReturned:0,reason:"",condition:"GOOD",batchSerial:"",location:"",remarks:""}]),[k,P]=v.useState(null);v.useEffect(()=>{let R=!0;return(async()=>{var W,K,_,F,E,L;try{const[U,J,ae,Z]=await Promise.all([te.get("/inventory/items"),te.get("/inventory/warehouses"),te.get("/admin/departments"),r?te.get("/inventory/return-to-stores/next-no"):Promise.resolve({data:null})]);R&&(c(Array.isArray((W=U.data)==null?void 0:W.items)?U.data.items:[]),h(Array.isArray((K=J.data)==null?void 0:K.items)?J.data.items:[]),x(Array.isArray((_=ae.data)==null?void 0:_.items)?ae.data.items:[]),r&&((F=Z==null?void 0:Z.data)!=null&&F.next_no)&&N(oe=>({...oe,rtsNo:Z.data.next_no})))}catch(U){R&&u(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load initial data")}})(),()=>{R=!1}},[]),v.useEffect(()=>{if(r)return;let R=!0;return n(!0),u(""),te.get(`/inventory/return-to-stores/${t}`).then(H=>{var _,F;if(!R)return;const W=(_=H.data)==null?void 0:_.item,K=Array.isArray((F=H.data)==null?void 0:F.details)?H.data.details:[];W&&(N({rtsNo:W.rts_no||"",rtsDate:W.rts_date||new Date().toISOString().split("T")[0],warehouseId:W.warehouse_id?String(W.warehouse_id):"",departmentId:W.department_id?String(W.department_id):"",returnType:W.return_type||"EXCESS",requisitionId:W.requisition_id?String(W.requisition_id):"",status:W.status||"DRAFT",remarks:W.remarks||""}),W.requisition_id&&te.get(`/inventory/material-requisitions/${W.requisition_id}`).then(E=>{var L;R&&((L=E.data)!=null&&L.item)&&P(E.data.item)}).catch(()=>{}),S(K.length?K.map(E=>({id:E.id||Date.now()+Math.random(),item_id:E.item_id?String(E.item_id):"",itemCode:E.item_code||"",itemName:E.item_name||"",uom:E.uom||"PCS",qtyReturned:Number(E.qty_returned)||0,reason:E.reason||"",condition:E.condition||"GOOD",batchSerial:E.batch_serial||"",location:E.location||"",remarks:E.remarks||""})):[]),K.length===0&&q())}).catch(H=>{var W,K;R&&u(((K=(W=H==null?void 0:H.response)==null?void 0:W.data)==null?void 0:K.message)||"Failed to load return to stores")}).finally(()=>{R&&n(!1)}),()=>{R=!1}},[t,r]);const I=v.useMemo(()=>j.filter(R=>R.item_id).map(R=>({item_id:Number(R.item_id),qty_returned:Number(R.qtyReturned)||0,reason:R.reason||null,condition:R.condition||null,batch_serial:R.batchSerial||null,location:R.location||null,remarks:R.remarks||null})),[j]),B=v.useMemo(()=>{const R=j.filter(_=>_.item_id).length,H=j.reduce((_,F)=>_+(Number(F.qtyReturned)||0),0),W=j.filter(_=>_.condition==="GOOD").reduce((_,F)=>_+(Number(F.qtyReturned)||0),0),K=j.filter(_=>_.condition==="DAMAGED").reduce((_,F)=>_+(Number(F.qtyReturned)||0),0);return{totalItems:R,totalQty:H,goodCondition:W,damagedQty:K}},[j]),q=()=>{S([...j,{id:Date.now(),item_id:"",itemCode:"",itemName:"",uom:"",qtyReturned:0,reason:"",condition:"GOOD",batchSerial:"",location:"",remarks:""}])},Q=R=>{S(j.filter(H=>H.id!==R))},O=(R,H)=>{const W=d.find(K=>String(K.id)===String(H));S(j.map(K=>K.id!==R?K:{...K,item_id:H,itemCode:(W==null?void 0:W.item_code)||"",itemName:(W==null?void 0:W.item_name)||"",uom:(W==null?void 0:W.uom)||"PCS"}))},T=(R,H,W)=>{S(j.map(K=>K.id!==R?K:{...K,[H]:W}))},V=async()=>{var R;try{const H=await te.get("/inventory/material-requisitions");(R=H.data)!=null&&R.items&&b(H.data.items)}catch(H){console.error(H)}};v.useEffect(()=>{y.returnType==="UNUSED"&&V()},[y.returnType]);const D=R=>{N({...y,requisitionId:R});const H=g.find(W=>String(W.id)===String(R));P(H||null),R&&te.get(`/inventory/material-requisitions/${R}`).then(W=>{var F,E;const K=(F=W.data)==null?void 0:F.item,_=Array.isArray((E=W.data)==null?void 0:E.details)?W.data.details:[];if(K&&N(L=>({...L,returnType:"UNUSED",warehouseId:K.warehouse_id?String(K.warehouse_id):L.warehouseId,departmentId:K.department_id?String(K.department_id):L.departmentId,requisitionId:String(R),remarks:L.remarks||""})),_.length){const L=_.filter(U=>U.item_id).map(U=>{const J=d.find(ae=>String(ae.id)===String(U.item_id));return{id:U.id||Date.now()+Math.random(),item_id:U.item_id?String(U.item_id):"",itemCode:U.item_code||"",itemName:U.item_name||"",uom:U.uom||(J==null?void 0:J.uom)||"PCS",qtyReturned:Number(U.qty_issued)||0,reason:"UNUSED",condition:"GOOD",batchSerial:"",location:"",remarks:""}});S(L.length?L:j)}}).catch(()=>{})},Y=()=>{N({...y,requisitionId:""}),P(null)},M=async R=>{var H,W;R.preventDefault(),l(!0),u("");try{const K={rts_no:r?void 0:y.rtsNo,rts_date:y.rtsDate,warehouse_id:y.warehouseId?Number(y.warehouseId):null,department_id:y.departmentId?Number(y.departmentId):null,return_type:y.returnType,requisition_id:y.requisitionId?Number(y.requisitionId):null,status:y.status,remarks:y.remarks||null,details:I};r?await te.post("/inventory/return-to-stores",K):await te.put(`/inventory/return-to-stores/${t}`,K),s("/inventory/return-to-stores")}catch(K){u(((W=(H=K==null?void 0:K.response)==null?void 0:H.data)==null?void 0:W.message)||"Failed to save return to stores")}finally{l(!1)}},X=[{id:"EXCESS",icon:"",title:"Excess Material"},{id:"UNUSED",icon:"",title:"Unused"},{id:"DAMAGED",icon:"",title:"Damaged"},{id:"WRONG_ITEM",icon:"",title:"Wrong Item"},{id:"QUALITY_ISSUE",icon:"",title:"Quality Issue"}];return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Return to Stores Advice":"Edit Return to Stores Advice"}),e.jsx("p",{className:"text-sm mt-1",children:"Record materials being returned to stores"})]}),e.jsx(Ee,{to:"/inventory/return-to-stores",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body p-6",children:e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[a?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,o?e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded",children:o}):null,e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-500 uppercase mb-3",children:"Return Reason"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:X.map(R=>e.jsxs("div",{onClick:()=>N({...y,returnType:R.id}),className:`cursor-pointer border rounded-lg p-4 text-center transition-all ${y.returnType===R.id?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white hover:bg-slate-50 border-slate-200"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:R.icon}),e.jsx("div",{className:"text-sm font-medium",children:R.title})]},R.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-500 uppercase mb-3",children:"Return Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Return Number"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:y.rtsNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Return Date *"}),e.jsx("input",{type:"date",className:"input",value:y.rtsDate,onChange:R=>N({...y,rtsDate:R.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${y.status==="DRAFT"?"bg-slate-100 text-slate-800":y.status==="PENDING"?"bg-yellow-100 text-yellow-800":y.status==="APPROVED"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsxs("select",{className:"input",value:y.departmentId,onChange:R=>N({...y,departmentId:R.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Department --"}),f.map(R=>e.jsx("option",{value:R.id,children:R.name},R.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:y.warehouseId,onChange:R=>N({...y,warehouseId:R.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Warehouse --"}),m.map(R=>e.jsx("option",{value:R.id,children:R.warehouse_name},R.id))]})]}),y.returnType==="UNUSED"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference Requisition"}),e.jsxs("select",{className:"input",value:y.requisitionId,onChange:R=>D(R.target.value),children:[e.jsx("option",{value:"",children:"-- Select Requisition --"}),g.map(R=>e.jsxs("option",{value:R.id,children:[R.requisition_no," - ",R.department_name]},R.id))]})]})]})]}),y.returnType==="UNUSED"&&k&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-blue-600 dark:text-blue-400 font-semibold flex items-center",children:" Requisition Reference"}),e.jsx("button",{type:"button",onClick:Y,className:"text-xs bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 px-2 py-1 rounded hover:bg-slate-50",children:"Clear"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requisition No"}),e.jsx("div",{className:"font-medium",children:k.requisition_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Department"}),e.jsx("div",{className:"font-medium",children:k.department_name||"--"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Issued Date"}),e.jsx("div",{className:"font-medium",children:k.requisition_date})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Type"}),e.jsx("div",{className:"font-medium",children:k.requisition_type})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:" Return Items"}),e.jsx("button",{type:"button",onClick:q,className:"btn-primary text-sm",children:" Add Item"})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 uppercase font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 w-10",children:"#"}),e.jsx("th",{className:"px-4 py-3 w-64",children:"Item"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Return Qty"}),e.jsx("th",{className:"px-4 py-3 w-24",children:"UOM"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Condition"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Batch/Serial"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Location"}),e.jsx("th",{className:"px-4 py-3",children:"Remarks"}),e.jsx("th",{className:"px-4 py-3 w-16"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700 bg-white dark:bg-slate-900",children:j.map((R,H)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-center text-slate-500",children:H+1}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("select",{className:"input text-sm py-1",value:R.item_id,onChange:W=>O(R.id,W.target.value),children:[e.jsx("option",{value:"",children:"Select Item"}),d.map(W=>e.jsxs("option",{value:W.id,children:[W.item_code," - ",W.item_name]},W.id))]})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1",value:R.qtyReturned,onChange:W=>T(R.id,"qtyReturned",W.target.value),min:"0"})}),e.jsx("td",{className:"px-4 py-2 text-slate-500",children:R.uom}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("select",{className:"input text-sm py-1",value:R.condition,onChange:W=>T(R.id,"condition",W.target.value),children:[e.jsx("option",{value:"GOOD",children:"Good"}),e.jsx("option",{value:"DAMAGED",children:"Damaged"})]})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",value:R.batchSerial,onChange:W=>T(R.id,"batchSerial",W.target.value),placeholder:"Optional"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",value:R.location,onChange:W=>T(R.id,"location",W.target.value),placeholder:"Optional"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",value:R.remarks,onChange:W=>T(R.id,"remarks",W.target.value),placeholder:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>Q(R.id),className:"text-red-500 hover:text-red-700",children:""})})]},R.id))})]})})]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Total Items"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:B.totalItems})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Total Quantity"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:B.totalQty})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Good Condition"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:B.goodCondition})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Damaged"}),e.jsx("div",{className:"text-2xl font-bold text-red-500",children:B.damagedQty})]})]})}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"label mb-2",children:"General Remarks"}),e.jsx("textarea",{className:"input h-24",value:y.remarks,onChange:R=>N({...y,remarks:R.target.value}),placeholder:"Enter any additional notes about this return..."})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s("/inventory/return-to-stores"),className:"btn-secondary",children:"Cancel"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{N({...y,status:"DRAFT"}),M({preventDefault:()=>{}})},disabled:i,className:"btn-success",children:i&&y.status==="DRAFT"?"Saving...":" Save Draft"}),e.jsx("button",{type:"submit",disabled:i,onClick:()=>N({...y,status:"PENDING"}),className:"btn-primary",children:i&&y.status==="PENDING"?"Saving...":" Submit Return"})]})]})]})})]})})}function LY(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState([]);v.useEffect(()=>{let c=!0;return a(!0),i(""),te.get("/inventory/issue-to-requirement").then(m=>{var h;c&&o(Array.isArray((h=m.data)==null?void 0:h.items)?m.data.items:[])}).catch(m=>{var h,f;c&&i(((f=(h=m==null?void 0:m.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load issues")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=c=>({DRAFT:"badge-info",ISSUED:"badge-warning",POSTED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=v.useMemo(()=>{const c=t.toLowerCase();return l.filter(m=>{const h=String(m.issue_no||"").toLowerCase(),f=String(m.department_name||"").toLowerCase();return h.includes(c)||f.includes(c)})},[l,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Issue to Requirement Area"}),e.jsx("p",{className:"text-sm mt-1",children:"Issue materials to departments / requirement areas"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/inventory/issue-to-requirement/new",className:"btn-success",children:"+ New Issue"})]})]})}),e.jsxs("div",{className:"card-body",children:[r?e.jsx("div",{className:"text-sm mb-4",children:"Loading..."}):null,n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by issue number or department...",className:"input max-w-md",value:t,onChange:c=>s(c.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Issue No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:c.issue_no}),e.jsx("td",{children:c.issue_date}),e.jsx("td",{children:c.issue_type||"-"}),e.jsx("td",{children:c.warehouse_name||"-"}),e.jsx("td",{children:c.department_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/inventory/issue-to-requirement/${c.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/inventory/issue-to-requirement/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))})]})})]})]})})}function Y_(){const{id:t}=Ps(),s=Ns(),r=!t||t==="new",a=T=>{if(!T)return"";const V=String(T);return V.includes("T")?V.split("T")[0]:V},[n,i]=v.useState(!1),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState([]),[h,f]=v.useState([]),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState({issueNo:r?"Auto-generated":"ISS-000",issueDate:new Date().toISOString().split("T")[0],warehouseId:"",issuedTo:"",departmentId:"",issueType:"GENERAL",requisitionId:"",status:"DRAFT",remarks:""}),[S,k]=v.useState([{id:1,item_id:"",itemCode:"",itemName:"",qtyIssued:0,uom:"",batchNumber:"",serialNumber:""}]),P=T=>{const V=String(T||"").toUpperCase();return V==="PRODUCTION"?"PRODUCTION":V==="MAINTENANCE"?"MAINTENANCE":"GENERAL"},I=async T=>{var V,D,Y,M;if(T)try{const X=await te.get(`/inventory/material-requisitions/${T}`),R=((V=X.data)==null?void 0:V.item)||null,H=Array.isArray((D=X.data)==null?void 0:D.details)?X.data.details:[];if(R&&j(W=>({...W,requisitionId:String(T),warehouseId:R.warehouse_id?String(R.warehouse_id):W.warehouseId,departmentId:R.department_id?String(R.department_id):W.departmentId,issueType:P(R.requisition_type),issuedTo:R.requested_by||W.issuedTo,remarks:W.remarks||""})),H.length){const W=H.map(K=>{const _=Number(K.qty_requested||0)-Number(K.qty_issued||0);return{id:K.id||Date.now()+Math.random(),item_id:K.item_id?String(K.item_id):"",itemCode:K.item_code||"",itemName:K.item_name||"",qtyIssued:_>0?_:Number(K.qty_requested||0),uom:K.uom||"",batchNumber:"",serialNumber:""}});k(W)}}catch(X){d(((M=(Y=X==null?void 0:X.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to populate from requisition")}};v.useEffect(()=>{let T=!0;return(async()=>{var D,Y,M,X,R,H;try{const[W,K,_,F]=await Promise.all([te.get("/inventory/items"),te.get("/inventory/warehouses"),te.get("/admin/departments"),te.get("/inventory/material-requisitions")]);T&&(m(Array.isArray((D=W.data)==null?void 0:D.items)?W.data.items:[]),f(Array.isArray((Y=K.data)==null?void 0:Y.items)?K.data.items:[]),g(Array.isArray((M=_.data)==null?void 0:M.items)?_.data.items:[]),y(Array.isArray((X=F.data)==null?void 0:X.items)?F.data.items.filter(E=>String(E.status||"").toUpperCase()==="APPROVED"):[]))}catch(W){T&&d(((H=(R=W==null?void 0:W.response)==null?void 0:R.data)==null?void 0:H.message)||"Failed to load initial data")}})(),()=>{T=!1}},[]),v.useEffect(()=>{if(r)return;let T=!0;return i(!0),d(""),te.get(`/inventory/issue-to-requirement/${t}`).then(V=>{var M,X;if(!T)return;const D=(M=V.data)==null?void 0:M.item,Y=Array.isArray((X=V.data)==null?void 0:X.details)?V.data.details:[];D&&(j({issueNo:D.issue_no||"",issueDate:a(D.issue_date)||new Date().toISOString().split("T")[0],warehouseId:D.warehouse_id?String(D.warehouse_id):"",issuedTo:D.issued_to||"",departmentId:D.department_id?String(D.department_id):"",issueType:D.issue_type||"GENERAL",requisitionId:D.requisition_id?String(D.requisition_id):"",status:D.status||"DRAFT",remarks:D.remarks||""}),k(Y.length?Y.map(R=>({id:R.id||Date.now()+Math.random(),item_id:R.item_id?String(R.item_id):"",itemCode:R.item_code||"",itemName:R.item_name||"",qtyIssued:Number(R.qty_issued)||0,uom:R.uom||"",batchNumber:R.batch_number||"",serialNumber:R.serial_number||""})):[{id:1,item_id:"",itemCode:"",itemName:"",qtyIssued:0,uom:"",batchNumber:"",serialNumber:""}]))}).catch(V=>{var D,Y;T&&d(((Y=(D=V==null?void 0:V.response)==null?void 0:D.data)==null?void 0:Y.message)||"Failed to load issue to requirement")}).finally(()=>{T&&i(!1)}),()=>{T=!1}},[t,r]);const B=v.useMemo(()=>S.filter(T=>T.item_id).map(T=>({item_id:Number(T.item_id),qty_issued:Number(T.qtyIssued)||0,uom:T.uom||"",batch_number:T.batchNumber||null,serial_number:T.serialNumber||null})),[S]),q=()=>{k([...S,{id:Date.now(),item_id:"",itemCode:"",itemName:"",qtyIssued:0,uom:"",batchNumber:"",serialNumber:""}])},Q=T=>{k(S.filter(V=>V.id!==T))},O=async(T,V)=>{var Y,M;T&&T.preventDefault(),o(!0),d("");const D=V||N.status;try{const X={issue_no:r?void 0:N.issueNo,issue_date:N.issueDate,warehouse_id:N.warehouseId?Number(N.warehouseId):null,issued_to:N.issuedTo||null,department_id:N.departmentId?Number(N.departmentId):null,issue_type:N.issueType,requisition_id:N.requisitionId?Number(N.requisitionId):null,status:D,remarks:N.remarks||null,details:B};r?await te.post("/inventory/issue-to-requirement",X):await te.put(`/inventory/issue-to-requirement/${t}`,X),s("/inventory/issue-to-requirement")}catch(X){d(((M=(Y=X==null?void 0:X.response)==null?void 0:Y.data)==null?void 0:M.message)||"Failed to save issue to requirement")}finally{o(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Issue to Requirement Area":"Edit Issue to Requirement Area"}),e.jsx("p",{className:"text-sm mt-1",children:"Issue materials to departments / requirement areas"})]}),e.jsx(Ee,{to:"/inventory/issue-to-requirement",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:O,className:"space-y-6",children:[n?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,u?e.jsx("div",{className:"text-sm text-red-600",children:u}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Issue No"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:N.issueNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Issue Date *"}),e.jsx("input",{type:"date",className:"input",value:N.issueDate,onChange:T=>j({...N,issueDate:T.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Issue Type"}),e.jsxs("select",{className:"input",value:N.issueType,onChange:T=>j({...N,issueType:T.target.value}),children:[e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"PRODUCTION",children:"Production"}),e.jsx("option",{value:"MAINTENANCE",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsxs("select",{className:"input",value:N.departmentId,onChange:T=>j({...N,departmentId:T.target.value}),children:[e.jsx("option",{value:"",children:"Select Department"}),x.map(T=>e.jsx("option",{value:T.id,children:T.name||T.department_name},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:N.warehouseId,onChange:T=>j({...N,warehouseId:T.target.value}),children:[e.jsx("option",{value:"",children:"Select Warehouse"}),h.map(T=>e.jsx("option",{value:T.id,children:T.warehouse_name||T.warehouse_code||T.id},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Reference"}),e.jsxs("select",{className:"input",value:N.requisitionId,onChange:async T=>{const V=T.target.value;j({...N,requisitionId:V}),V&&await I(V)},children:[e.jsx("option",{value:"",children:"Select Requisition (Optional)"}),b.map(T=>e.jsx("option",{value:T.id,children:T.requisition_no},T.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:N.status,onChange:T=>j({...N,status:T.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"ISSUED",children:"ISSUED"}),e.jsx("option",{value:"POSTED",children:"POSTED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("input",{type:"text",className:"input",value:N.remarks,onChange:T=>j({...N,remarks:T.target.value}),placeholder:"Enter any additional notes or remarks"})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Items"}),e.jsx("button",{type:"button",onClick:q,className:"btn-success text-sm",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12",children:"#"}),e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Qty Issued"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Batch No"}),e.jsx("th",{children:"Serial No"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:S.map((T,V)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center text-slate-500",children:V+1}),e.jsx("td",{className:"w-1/3",children:e.jsxs("select",{className:"input",value:T.item_id,onChange:D=>{const Y=D.target.value,M=c.find(X=>String(X.id)===String(Y));k(S.map(X=>X.id===T.id?{...X,item_id:Y,itemCode:(M==null?void 0:M.item_code)||"",itemName:(M==null?void 0:M.item_name)||"",uom:(M==null?void 0:M.uom)||""}:X))},required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),c.map(D=>e.jsx("option",{value:D.id,children:(D.item_code||D.id)+" - "+(D.item_name||"")},D.id))]})}),e.jsx("td",{className:"w-24",children:e.jsx("input",{type:"number",className:"input",value:T.qtyIssued,onChange:D=>{const Y=parseFloat(D.target.value);k(S.map(M=>M.id===T.id?{...M,qtyIssued:Number.isFinite(Y)?Y:0}:M))},min:"0",step:"0.001"})}),e.jsx("td",{className:"w-24",children:e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:T.uom||"",readOnly:!0})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:T.batchNumber,onChange:D=>k(S.map(Y=>Y.id===T.id?{...Y,batchNumber:D.target.value}:Y)),placeholder:"Batch No"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:T.serialNumber,onChange:D=>k(S.map(Y=>Y.id===T.id?{...Y,serialNumber:D.target.value}:Y)),placeholder:"Serial No"})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>Q(T.id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})})]},T.id))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Ee,{to:"/inventory/issue-to-requirement",className:"px-4 py-2 border border-slate-300 rounded text-slate-700 hover:bg-slate-50 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-800",children:"Cancel"}),e.jsx("button",{type:"button",onClick:T=>O(T,"DRAFT"),className:"px-4 py-2 bg-slate-500 text-white rounded hover:bg-slate-600",disabled:l,children:"Save as Draft"}),e.jsx("button",{type:"button",onClick:T=>O(T,"POSTED"),className:"btn-success",disabled:l,children:l?"Saving...":"Save & Post"})]})]})})]})})}function DY(){const[t,s]=v.useState([]),[r,a]=v.useState([]),[n,i]=v.useState([]),[l,o]=v.useState([]),[u,d]=v.useState(!0),[c,m]=v.useState(""),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState({item_id:"",warehouse_id:"",min_stock:"",max_stock:"",reorder_qty:"",lead_time:"0",supplier_id:""}),[N,j]=v.useState(null),S=v.useMemo(()=>{let T=0,V=0;return t.forEach(D=>{const Y=Number(D.current_stock||0),M=Number(D.min_stock||0);Y<M?T++:Y<M*1.2&&V++}),{total:t.length,critical:T,low:V,activeWarehouses:new Set(t.map(D=>D.warehouse_id)).size}},[t]);v.useEffect(()=>{k()},[]);const k=async()=>{d(!0);try{const[T,V,D,Y]=await Promise.all([te.get("/inventory/reorder-points"),te.get("/inventory/items"),te.get("/inventory/warehouses"),te.get("/purchase/suppliers")]);s(T.data.items||[]),a(V.data.items||[]),i(D.data.items||[]),o(Y.data.items||[])}catch(T){console.error(T),mt.error("Failed to load data")}finally{d(!1)}},P=async()=>{d(!0);try{const T={};c&&(T.warehouseId=c),h&&(T.search=h),x&&(T.status=x);const V=await te.get("/inventory/reorder-points",{params:T});s(V.data.items||[])}catch(T){console.error(T),mt.error("Failed to apply filters")}finally{d(!1)}},I=async T=>{if(window.confirm("Are you sure you want to delete this reorder point?"))try{await te.delete(`/inventory/reorder-points/${T}`),mt.success("Reorder point deleted"),k()}catch(V){console.error(V),mt.error("Failed to delete reorder point")}},B=T=>{var V;j(T.id),y({item_id:T.item_id,warehouse_id:T.warehouse_id,min_stock:T.min_stock,max_stock:T.max_stock,reorder_qty:T.reorder_qty,lead_time:T.lead_time,supplier_id:T.supplier_id||""}),(V=document.getElementById("reorderFormCard"))==null||V.scrollIntoView({behavior:"smooth"})},q=()=>{j(null),y({item_id:"",warehouse_id:"",min_stock:"",max_stock:"",reorder_qty:"",lead_time:"0",supplier_id:""})},Q=async T=>{var V,D;T.preventDefault();try{await te.post("/inventory/reorder-points",b),mt.success("Reorder point saved"),q(),k()}catch(Y){console.error(Y),mt.error(((D=(V=Y.response)==null?void 0:V.data)==null?void 0:D.message)||"Failed to save reorder point")}},O=(T,V,D)=>(T=Number(T),V=Number(V),T<V?{className:"bg-red-100 text-red-700 border-red-200",text:"Critical"}:T<V*1.2?{className:"bg-yellow-100 text-yellow-700 border-yellow-200",text:"Low Stock"}:{className:"bg-green-100 text-green-700 border-green-200",text:"Normal"});return e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:""})," Stock Reorder Management System"]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage inventory reorder points and maintain optimal stock levels"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Ee,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-cyan-800",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(tA,{})," Total Items"]}),e.jsx("div",{className:"text-3xl font-bold text-cyan-900 dark:text-cyan-100",children:S.total})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-red-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(xI,{className:"text-red-500"})," Critical Stock"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:S.critical})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-yellow-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(qT,{className:"text-yellow-500"})," Low Stock"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:S.low})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-blue-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(vI,{className:"text-blue-500"})," Active Warehouses"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:S.activeWarehouses})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4 pb-2 border-b border-slate-100 dark:border-slate-700",children:"Stock Reorder List"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Warehouse"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",value:c,onChange:T=>m(T.target.value),children:[e.jsx("option",{value:"",children:"All Warehouses"}),n.map(T=>e.jsx("option",{value:T.id,children:T.warehouse_name},T.id))]})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Item Search"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search by item name...",className:"input input-bordered w-full input-sm pr-8",value:h,onChange:T=>f(T.target.value)}),e.jsx(D0,{className:"absolute right-3 top-2 text-slate-400",size:16})]})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Status"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",value:x,onChange:T=>g(T.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"low",children:"Low Stock"}),e.jsx("option",{value:"normal",children:"Normal"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{className:"btn btn-primary btn-sm w-full",onClick:P,disabled:u,children:[e.jsx(rI,{})," Filter"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Levels (Min/Max)"}),e.jsx("th",{children:"Reorder Qty"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:u?e.jsx("tr",{children:e.jsx("td",{colspan:"7",className:"text-center py-4",children:"Loading..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colspan:"7",className:"text-center py-8 text-slate-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(tA,{className:"text-4xl mb-2 opacity-20"}),"No reorder points found"]})})}):t.map(T=>{const V=O(T.current_stock||0,T.min_stock,T.max_stock);return e.jsxs("tr",{className:"hover",children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-bold",children:T.item_code}),e.jsx("div",{className:"text-xs text-slate-500",children:T.item_name})]}),e.jsx("td",{children:T.warehouse_name}),e.jsxs("td",{className:"font-mono",children:[Number(T.current_stock||0)," ",T.uom]}),e.jsxs("td",{className:"text-xs",children:[e.jsxs("div",{children:["Min: ",Number(T.min_stock)]}),e.jsxs("div",{children:["Max: ",Number(T.max_stock)]})]}),e.jsx("td",{children:Number(T.reorder_qty)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${V.className} font-semibold`,children:V.text})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-ghost btn-xs text-blue-600",onClick:()=>B(T),title:"Edit",children:e.jsx(sA,{})}),e.jsx("button",{className:"btn btn-ghost btn-xs text-red-600",onClick:()=>I(T.id),title:"Delete",children:e.jsx(Gl,{})})]})})]},T.id)})})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{id:"reorderFormCard",className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6 sticky top-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4 pb-2 border-b border-slate-100 dark:border-slate-700",children:N?"Edit Reorder Point":"Add Reorder Point"}),e.jsxs("form",{onSubmit:Q,className:"space-y-4",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold",children:"Item *"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",required:!0,value:b.item_id,onChange:T=>y({...b,item_id:T.target.value}),disabled:!!N,children:[e.jsx("option",{value:"",children:"Select Item"}),r.map(T=>e.jsxs("option",{value:T.id,children:[T.item_code," - ",T.item_name]},T.id))]})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold",children:"Warehouse *"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",required:!0,value:b.warehouse_id,onChange:T=>y({...b,warehouse_id:T.target.value}),disabled:!!N,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),n.map(T=>e.jsx("option",{value:T.id,children:T.warehouse_name},T.id))]})]}),e.jsx("div",{className:"divider text-xs text-slate-400",children:"Stock Levels"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Min Stock *"})}),e.jsx("input",{type:"number",min:"0",step:"1",required:!0,className:"input input-bordered w-full input-sm",value:b.min_stock,onChange:T=>y({...b,min_stock:T.target.value})})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Max Stock *"})}),e.jsx("input",{type:"number",min:"0",step:"1",required:!0,className:"input input-bordered w-full input-sm",value:b.max_stock,onChange:T=>y({...b,max_stock:T.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Reorder Qty *"})}),e.jsx("input",{type:"number",min:"0",step:"1",required:!0,className:"input input-bordered w-full input-sm",value:b.reorder_qty,onChange:T=>y({...b,reorder_qty:T.target.value})})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Lead Time (Days)"})}),e.jsx("input",{type:"number",min:"0",step:"1",className:"input input-bordered w-full input-sm",value:b.lead_time,onChange:T=>y({...b,lead_time:T.target.value})})]})]}),e.jsx("div",{className:"divider text-xs text-slate-400",children:"Supplier"}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Preferred Supplier"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",value:b.supplier_id,onChange:T=>y({...b,supplier_id:T.target.value}),children:[e.jsx("option",{value:"",children:"Select Supplier"}),l.map(T=>e.jsx("option",{value:T.id,children:T.supplier_name},T.id))]})]}),e.jsxs("div",{className:"flex gap-2 mt-6 pt-4 border-t border-slate-100 dark:border-slate-700",children:[e.jsxs("button",{type:"submit",className:"btn btn-success btn-sm flex-1",children:[e.jsx(Hh,{})," ",N?"Update":"Save"]}),e.jsxs("button",{type:"button",className:"btn btn-warning btn-sm",onClick:q,children:[N?e.jsx(EC,{}):e.jsx(oI,{})," Reset"]})]})]})]})})]})]})}function PY(){const[t,s]=v.useState(""),[r,a]=v.useState(30),[n,i]=v.useState([]),[l,o]=v.useState([]),[u,d]=v.useState(!1);async function c(){var h;try{const f=await te.get("/inventory/warehouses");o(((h=f.data)==null?void 0:h.items)||[])}catch{}}async function m(){var h,f,x;try{d(!0);const g=await te.get("/inventory/reports/health-monitor",{params:{warehouseId:t||null,thresholdDays:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{d(!1)}}return v.useEffect(()=>{c(),m()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Inventory Health Monitor"}),e.jsx("p",{className:"text-sm mt-1",children:"Coverage days, low stock, and reorder risks"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:t,onChange:h=>s(h.target.value),children:[e.jsx("option",{value:"",children:"All"}),l.map(h=>e.jsx("option",{value:h.id,children:h.name||h.code},h.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Threshold Days"}),e.jsx("input",{className:"input",type:"number",min:1,value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:m,disabled:u,children:u?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a(30)},disabled:u,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const h=Array.isArray(n)?n:[];if(!h.length)return;const f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"InventoryHealth"),Br(x,"inventory-health-monitor.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const h=Array.isArray(n)?n:[];if(!h.length)return;const f=new As("p","mm","a4");let x=15;f.setFontSize(14),f.text("Inventory Health Monitor",10,x),x+=8,f.setFontSize(10),f.text("Item",10,x),f.text("Available",95,x),f.text("Reorder",130,x),f.text("Days Cover",160,x),f.text("Status",190,x,{align:"right"}),x+=4,f.line(10,x,200,x),x+=5,h.forEach(g=>{x>270&&(f.addPage(),x=15),f.text(String(g.item_name||g.item_code||"-").slice(0,60),10,x),f.text(String(Number(g.available_qty||0).toLocaleString()),95,x),f.text(String(Number(g.reorder_level||0).toLocaleString()),130,x),f.text(String(Number(g.days_of_cover||0).toLocaleString()),160,x),f.text(String(g.status||"-"),190,x,{align:"right"}),x+=5}),f.save("inventory-health-monitor.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Available"}),e.jsx("th",{className:"text-right",children:"Reorder Level"}),e.jsx("th",{className:"text-right",children:"Days of Cover"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.item_name||h.item_code}),e.jsx("td",{className:"text-right",children:Number(h.available_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.reorder_level||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.days_of_cover||0).toLocaleString()}),e.jsx("td",{children:h.status||"-"})]},h.item_id))})]})}),n.length===0&&!u?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function UY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/inventory/reports/periodical-stock-summary",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Periodical Stock Summary"}),e.jsx("p",{className:"text-sm mt-1",children:"Opening, receipts, issues, closing per period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"PeriodicalStockSummary"),Br(m,"periodical-stock-summary.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Periodical Stock Summary",10,m),m+=8,c.setFontSize(10),c.text("Item",10,m),c.text("Opening",95,m),c.text("Receipts",130,m),c.text("Issues",160,m),c.text("Closing",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15),c.text(String(h.item_name||h.item_code||"-").slice(0,60),10,m),c.text(String(Number(h.opening_qty||0).toLocaleString()),95,m),c.text(String(Number(h.receipts_qty||0).toLocaleString()),130,m),c.text(String(Number(h.issues_qty||0).toLocaleString()),160,m),c.text(String(Number(h.closing_qty||0).toLocaleString()),190,m,{align:"right"}),m+=5}),c.save("periodical-stock-summary.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Opening"}),e.jsx("th",{className:"text-right",children:"Receipts"}),e.jsx("th",{className:"text-right",children:"Issues"}),e.jsx("th",{className:"text-right",children:"Closing"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.opening_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.receipts_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.issues_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.closing_qty||0).toLocaleString()})]},d.item_id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function RY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/inventory/reports/periodical-stock-statement",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Periodical Stock Statement"}),e.jsx("p",{className:"text-sm mt-1",children:"Detailed stock movements within the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"PeriodicalStockStatement"),Br(m,"periodical-stock-statement.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Periodical Stock Statement",10,m),m+=8,c.setFontSize(10),c.text("Date",10,m),c.text("Document",45,m),c.text("Item",95,m),c.text("In",140,m),c.text("Out",165,m),c.text("Balance",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.txn_date?new Date(h.txn_date).toLocaleDateString():"-",x=String(h.doc_no||"-"),g=String(h.item_name||h.item_code||"-").slice(0,40),b=String(Number(h.qty_in||0).toLocaleString()),y=String(Number(h.qty_out||0).toLocaleString()),N=String(Number(h.balance_qty||0).toLocaleString());c.text(f,10,m),c.text(x,45,m),c.text(g,95,m),c.text(b,140,m),c.text(y,165,m),c.text(N,190,m,{align:"right"}),m+=5}),c.save("periodical-stock-statement.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"In"}),e.jsx("th",{className:"text-right",children:"Out"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:n.map((d,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:d.txn_date?new Date(d.txn_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.doc_no||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.qty_in||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.qty_out||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.balance_qty||0).toLocaleString()})]},d.id||c))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function OY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/inventory/reports/issue-register",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Issue Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Items issued to departments or projects"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"IssueRegister"),Br(m,"issue-register.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Issue Register",10,m),m+=8,c.setFontSize(10),c.text("Date",10,m),c.text("Issue No",45,m),c.text("Department",85,m),c.text("Item",130,m),c.text("Qty",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.issue_date?new Date(h.issue_date).toLocaleDateString():"-",x=String(h.issue_no||"-"),g=String(h.department_name||"-").slice(0,35),b=String(h.item_name||h.item_code||"-").slice(0,35),y=String(Number(h.qty||0).toLocaleString());c.text(f,10,m),c.text(x,45,m),c.text(g,85,m),c.text(b,130,m),c.text(y,190,m,{align:"right"}),m+=5}),c.save("issue-register.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Issue No"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.issue_date?new Date(d.issue_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.issue_no||"-"}),e.jsx("td",{children:d.department_name||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.qty||0).toLocaleString()})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function QY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/inventory/reports/stock-transfer-register",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Stock Transfer Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Transfers between warehouses with quantities"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"StockTransferRegister"),Br(m,"stock-transfer-register.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Stock Transfer Register",10,m),m+=8,c.setFontSize(10),c.text("Date",10,m),c.text("Transfer No",45,m),c.text("From",90,m),c.text("To",125,m),c.text("Item",155,m),c.text("Qty",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.transfer_date?new Date(h.transfer_date).toLocaleDateString():"-",x=String(h.transfer_no||"-"),g=String(h.from_warehouse_name||"-").slice(0,25),b=String(h.to_warehouse_name||"-").slice(0,25),y=String(h.item_name||h.item_code||"-").slice(0,25),N=String(Number(h.qty||0).toLocaleString());c.text(f,10,m),c.text(x,45,m),c.text(g,90,m),c.text(b,125,m),c.text(y,155,m),c.text(N,190,m,{align:"right"}),m+=5}),c.save("stock-transfer-register.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Transfer No"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.transfer_date?new Date(d.transfer_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.transfer_no||"-"}),e.jsx("td",{children:d.from_warehouse_name||"-"}),e.jsx("td",{children:d.to_warehouse_name||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.qty||0).toLocaleString()})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function MY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/inventory/reports/stock-verification",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Stock Verification Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Variances identified during stock verification"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"StockVerification"),Br(m,"stock-verification.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Stock Verification Report",10,m),m+=8,c.setFontSize(10),c.text("Date",10,m),c.text("Verify No",45,m),c.text("Item",85,m),c.text("System Qty",130,m),c.text("Physical Qty",160,m),c.text("Variance",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.verify_date?new Date(h.verify_date).toLocaleDateString():"-",x=String(h.verify_no||"-"),g=String(h.item_name||h.item_code||"-").slice(0,40),b=String(Number(h.system_qty||0).toLocaleString()),y=String(Number(h.physical_qty||0).toLocaleString()),N=String(Number((h.physical_qty||0)-(h.system_qty||0)).toLocaleString());c.text(f,10,m),c.text(x,45,m),c.text(g,85,m),c.text(b,130,m),c.text(y,160,m),c.text(N,190,m,{align:"right"}),m+=5}),c.save("stock-verification.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Verification No"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"System Qty"}),e.jsx("th",{className:"text-right",children:"Physical Qty"}),e.jsx("th",{className:"text-right",children:"Variance"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.verify_date?new Date(d.verify_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.verify_no||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.system_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.physical_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number((d.physical_qty||0)-(d.system_qty||0)).toLocaleString()})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function HY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await te.get("/inventory/reports/stock-aging-analysis",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){mt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return v.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Stock Aging Analysis"}),e.jsx("p",{className:"text-sm mt-1",children:"Age buckets for inventory holding"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=us.json_to_sheet(o),d=us.book_new();us.book_append_sheet(d,u,"StockAging"),Br(d,"stock-aging-analysis.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new As("p","mm","a4");let d=15;u.setFontSize(14),u.text("Stock Aging Analysis",10,d),d+=8,u.setFontSize(10),u.text("Item",10,d),u.text("0-30",95,d),u.text("31-60",120,d),u.text("61-90",145,d),u.text("90+",190,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15),u.text(String(c.item_name||c.item_code||"-").slice(0,70),10,d),u.text(String(Number(c.bucket_0_30||0).toLocaleString()),95,d),u.text(String(Number(c.bucket_31_60||0).toLocaleString()),120,d),u.text(String(Number(c.bucket_61_90||0).toLocaleString()),145,d),u.text(String(Number(c.bucket_90_plus||0).toLocaleString()),190,d,{align:"right"}),d+=5}),u.save("stock-aging-analysis.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"030"}),e.jsx("th",{className:"text-right",children:"3160"}),e.jsx("th",{className:"text-right",children:"6190"}),e.jsx("th",{className:"text-right",children:"90+"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.item_name||o.item_code}),e.jsx("td",{className:"text-right",children:Number(o.bucket_0_30||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.bucket_31_60||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.bucket_61_90||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.bucket_90_plus||0).toLocaleString()})]},o.item_id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function qY(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/inventory/reports/slow-moving",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Slow Moving Items"}),e.jsx("p",{className:"text-sm mt-1",children:"Items with low turnover in the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"SlowMoving"),Br(m,"slow-moving.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Slow Moving Items",10,m),m+=8,c.setFontSize(10),c.text("Item",10,m),c.text("Issued Qty",130,m),c.text("Turnover",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15),c.text(String(h.item_name||h.item_code||"-").slice(0,80),10,m),c.text(String(Number(h.issued_qty||0).toLocaleString()),130,m),c.text(String(Number(h.turnover||0).toLocaleString()),190,m,{align:"right"}),m+=5}),c.save("slow-moving.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Issued Qty"}),e.jsx("th",{className:"text-right",children:"Turnover"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.issued_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.turnover||0).toLocaleString()})]},d.item_id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function VY(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await te.get("/inventory/reports/non-moving",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){mt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return v.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Non Moving Items"}),e.jsx("p",{className:"text-sm mt-1",children:"Items with no movement within the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=us.json_to_sheet(o),d=us.book_new();us.book_append_sheet(d,u,"NonMoving"),Br(d,"non-moving.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new As("p","mm","a4");let d=15;u.setFontSize(14),u.text("Non Moving Items",10,d),d+=8,u.setFontSize(10),u.text("Item",10,d),u.text("Available",130,d),u.text("Days Since Last",190,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15),u.text(String(c.item_name||c.item_code||"-").slice(0,80),10,d),u.text(String(Number(c.available_qty||0).toLocaleString()),130,d),u.text(String(Number(c.days_since_last||0).toLocaleString()),190,d,{align:"right"}),d+=5}),u.save("non-moving.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Available"}),e.jsx("th",{className:"text-right",children:"Days Since Last Movement"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.item_name||o.item_code}),e.jsx("td",{className:"text-right",children:Number(o.available_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.days_since_last||0).toLocaleString()})]},o.item_id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function $Y({title:t,description:s}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:t}),s?e.jsx("p",{className:"text-sm mt-1",children:s}):null]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-sm",children:"This page is ready to be implemented."})})]})}function WY(){const[t,s]=Os.useState([{value:"45",label:"Items Tracked",change:"5 critical",changeType:"negative",path:"/inventory/reports"},{value:"12",label:"Pending Requisitions",change:"3 urgent",changeType:"neutral",path:"/inventory/material-requisitions"},{value:"8",label:"Incoming Transfers",change:"Expected today",changeType:"positive",path:"/inventory/transfer-acceptance"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.inventory)==null?void 0:o.items)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.inventory)==null?void 0:c.pending_requisitions)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.inventory)==null?void 0:f.incoming_transfers)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:String(y)},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Stock Operations",features:[{name:"Material Requisition",path:"/inventory/material-requisitions",description:"Request materials from warehouse",icon:""},{name:"Stock Updation",path:"/inventory/stock-updation",description:"Update stock levels",icon:""},{name:"Stock Verification",path:"/inventory/stock-verification",description:"Verify stock balances",icon:""},{name:"Return to Stores Advice",path:"/inventory/return-to-stores",description:"Return unused materials",icon:""},{name:"Stock Adjustment",path:"/inventory/stock-adjustments",description:"Adjust stock quantities",icon:""},{name:"Issue to Requirement Area",path:"/inventory/issue-to-requirement",description:"Issue materials to departments",icon:""}]},{title:"Stock Movements",features:[{name:"Warehouse Stock Transfer",path:"/inventory/stock-transfers",description:"Transfer stock between warehouses/branches",icon:""},{name:"Transfer Acceptance",path:"/inventory/transfer-acceptance",description:"Receive transferred stock",icon:""},{name:"Stock Reorder",path:"/inventory/stock-reorder",description:"Manage reorder points",icon:""}]},{title:"Stock Count",features:[{name:"Daily Stock Take",path:"/inventory/stock-take",description:"Perform physical stock counts",icon:""}]},{title:"Goods Receipt",features:[{name:"Material Receipt (GRN) - Local",path:"/inventory/grn-local",description:"Receive local purchases",icon:""},{name:"Material Receipt (GRN) - Import",path:"/inventory/grn-import",description:"Receive import purchases",icon:""}]},{title:"Returns",features:[{name:"Sales Return",path:"/inventory/sales-returns",description:"Process customer returns",icon:""}]},{title:"Master Data Setup",features:[{name:"Items Setup",path:"/inventory/items",description:"Configure items with barcodes",icon:""},{name:"Item Groups & Sub Groups",path:"/inventory/item-groups",description:"Organize items by categories",icon:""},{name:"Unit Conversion",path:"/inventory/unit-conversions",description:"Define unit conversions",icon:""},{name:"Warehouse Setup",path:"/inventory/warehouses",description:"Configure warehouses",icon:""}]},{title:"Reports",features:[{name:"Inventory Reports",path:"/inventory/reports",description:"Stock reports and analytics",icon:""},{name:"Health Monitor",path:"/inventory/reports/health-monitor",description:"Low stock and coverage analysis",icon:""},{name:"Periodical Stock Summary",path:"/inventory/reports/periodical-stock-summary",description:"Summary of movements by period",icon:""},{name:"Periodical Stock Statement",path:"/inventory/reports/periodical-stock-statement",description:"Detailed item movements by period",icon:""},{name:"Issue Register",path:"/inventory/reports/issue-register",description:"Issued items to departments/projects",icon:""},{name:"Stock Transfer Register",path:"/inventory/reports/stock-transfer-register",description:"Transfers between warehouses",icon:""},{name:"Stock Verification",path:"/inventory/reports/stock-verification",description:"Verification variances by item",icon:""},{name:"Stock Aging Analysis",path:"/inventory/reports/stock-aging-analysis",description:"Age buckets and holding",icon:""},{name:"Slow Moving Items",path:"/inventory/reports/slow-moving",description:"Low turnover items",icon:""},{name:"Non Moving Items",path:"/inventory/reports/non-moving",description:"No movement in period",icon:""}]}];return e.jsx(To,{title:"Inventory Management",description:"Stock management, warehouse operations, and inventory control",stats:t,sections:r})}function GY(){return e.jsxs(_l,{children:[e.jsx(tt,{index:!0,element:e.jsx(WY,{})}),e.jsx(tt,{path:"material-requisitions",element:e.jsx(AY,{})}),e.jsx(tt,{path:"material-requisitions/:id",element:e.jsx(hY,{})}),e.jsx(tt,{path:"stock-updation",element:e.jsx(kY,{})}),e.jsx(tt,{path:"stock-verification",element:e.jsx(FY,{})}),e.jsx(tt,{path:"stock-updation/:id",element:e.jsx(EY,{})}),e.jsx(tt,{path:"stock-verification/:id",element:e.jsx(TY,{})}),e.jsx(tt,{path:"return-to-stores",element:e.jsx(IY,{})}),e.jsx(tt,{path:"return-to-stores/new",element:e.jsx(z_,{})}),e.jsx(tt,{path:"return-to-stores/:id",element:e.jsx(z_,{})}),e.jsx(tt,{path:"stock-adjustments",element:e.jsx(cY,{})}),e.jsx(tt,{path:"stock-adjustments/new",element:e.jsx(W_,{})}),e.jsx(tt,{path:"stock-adjustments/:id",element:e.jsx(W_,{})}),e.jsx(tt,{path:"issue-to-requirement",element:e.jsx(LY,{})}),e.jsx(tt,{path:"issue-to-requirement/new",element:e.jsx(Y_,{})}),e.jsx(tt,{path:"issue-to-requirement/:id",element:e.jsx(Y_,{})}),e.jsx(tt,{path:"stock-transfers",element:e.jsx(dY,{})}),e.jsx(tt,{path:"stock-transfers/:id",element:e.jsx(uY,{})}),e.jsx(tt,{path:"transfer-acceptance",element:e.jsx(yY,{})}),e.jsx(tt,{path:"transfer-acceptance/:id",element:e.jsx(jY,{})}),e.jsx(tt,{path:"stock-reorder",element:e.jsx(DY,{})}),e.jsx(tt,{path:"stock-take",element:e.jsx(NY,{})}),e.jsx(tt,{path:"stock-take/:id",element:e.jsx(wY,{})}),e.jsx(tt,{path:"grn-local",element:e.jsx(xY,{})}),e.jsx(tt,{path:"grn-local/:id",element:e.jsx(gY,{})}),e.jsx(tt,{path:"grn-import",element:e.jsx(vY,{})}),e.jsx(tt,{path:"grn-import/:id",element:e.jsx(bY,{})}),e.jsx(tt,{path:"sales-returns",element:e.jsx(kk,{})}),e.jsx(tt,{path:"items",element:e.jsx(mY,{})}),e.jsx(tt,{path:"items/:id",element:e.jsx(Tk,{})}),e.jsx(tt,{path:"item-groups",element:e.jsx(_Y,{})}),e.jsx(tt,{path:"item-groups/:id",element:e.jsx(SY,{})}),e.jsx(tt,{path:"unit-conversions",element:e.jsx(CY,{})}),e.jsx(tt,{path:"unit-conversions/:id",element:e.jsx(BY,{})}),e.jsx(tt,{path:"warehouses",element:e.jsx(fY,{})}),e.jsx(tt,{path:"warehouses/:id",element:e.jsx(pY,{})}),e.jsx(tt,{path:"reports",element:e.jsx($Y,{title:"Inventory Reports",description:"Stock reports and analytics"})}),e.jsx(tt,{path:"reports/health-monitor",element:e.jsx(PY,{})}),e.jsx(tt,{path:"reports/periodical-stock-summary",element:e.jsx(UY,{})}),e.jsx(tt,{path:"reports/periodical-stock-statement",element:e.jsx(RY,{})}),e.jsx(tt,{path:"reports/issue-register",element:e.jsx(OY,{})}),e.jsx(tt,{path:"reports/stock-transfer-register",element:e.jsx(QY,{})}),e.jsx(tt,{path:"reports/stock-verification",element:e.jsx(MY,{})}),e.jsx(tt,{path:"reports/stock-aging-analysis",element:e.jsx(HY,{})}),e.jsx(tt,{path:"reports/slow-moving",element:e.jsx(qY,{})}),e.jsx(tt,{path:"reports/non-moving",element:e.jsx(VY,{})}),e.jsx(tt,{path:"*",element:e.jsx(Wc,{to:"/inventory",replace:!0})})]})}function KY(){const[t,s]=v.useState(""),[r,a]=v.useState("ALL"),[n,i]=v.useState([]),[l,o]=v.useState(!1),[u,d]=v.useState("");v.useEffect(()=>{let h=!0;return o(!0),d(""),te.get("/purchase/rfqs").then(f=>{var x;h&&i(Array.isArray((x=f.data)==null?void 0:x.items)?f.data.items:[])}).catch(f=>{var x,g;h&&d(((g=(x=f==null?void 0:f.response)==null?void 0:x.data)==null?void 0:g.message)||"Failed to load RFQs")}).finally(()=>{h&&o(!1)}),()=>{h=!1}},[]);const c=h=>({DRAFT:"badge-neutral",SENT:"badge-info",EXPIRED:"badge-error",CLOSED:"badge-success"})[h]||"badge-info",m=v.useMemo(()=>n.filter(h=>{const f=String(h.rfq_no||"").toLowerCase().includes(t.toLowerCase())||String(h.delivery_terms||"").toLowerCase().includes(t.toLowerCase()),x=r==="ALL"||h.status===r;return f&&x}),[n,t,r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Request for Quotation (RFQ)"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and send RFQs to suppliers for competitive bidding"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/rfqs/new",className:"btn-success",children:"+ New RFQ"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by RFQ no or delivery terms...",className:"input",value:t,onChange:h=>s(h.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:h=>a(h.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SENT",children:"Sent"}),e.jsx("option",{value:"EXPIRED",children:"Expired"}),e.jsx("option",{value:"CLOSED",children:"Closed"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"RFQ No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Delivery Terms"}),e.jsx("th",{children:"Suppliers"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-red-600",children:u})}):null,m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No RFQs found"})}):m.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.rfq_no}),e.jsx("td",{children:new Date(h.rfq_date).toLocaleDateString()}),e.jsx("td",{children:h.expiry_date?new Date(h.expiry_date).toLocaleDateString():"-"}),e.jsx("td",{children:h.delivery_terms||"-"}),e.jsx("td",{children:h.supplier_count||0}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c(h.status)}`,children:h.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/purchase/rfqs/${h.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/rfqs/${h.id}/edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"})]})})]},h.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",m.length," of ",n.length," ","RFQs"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]})]})}const Ik=6048e5,zY=864e5,X_=Symbol.for("constructDateFrom");function xu(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&X_ in t?t[X_](s):t instanceof Date?new t.constructor(s):new Date(s)}function Uo(t,s){return xu(s||t,t)}let YY={};function ug(){return YY}function Cf(t,s){var o,u,d,c;const r=ug(),a=(s==null?void 0:s.weekStartsOn)??((u=(o=s==null?void 0:s.locale)==null?void 0:o.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((c=(d=r.locale)==null?void 0:d.options)==null?void 0:c.weekStartsOn)??0,n=Uo(t,s==null?void 0:s.in),i=n.getDay(),l=(i<a?7:0)+i-a;return n.setDate(n.getDate()-l),n.setHours(0,0,0,0),n}function b0(t,s){return Cf(t,{...s,weekStartsOn:1})}function Lk(t,s){const r=Uo(t,s==null?void 0:s.in),a=r.getFullYear(),n=xu(r,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const i=b0(n),l=xu(r,0);l.setFullYear(a,0,4),l.setHours(0,0,0,0);const o=b0(l);return r.getTime()>=i.getTime()?a+1:r.getTime()>=o.getTime()?a:a-1}function J_(t){const s=Uo(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function XY(t,...s){const r=xu.bind(null,s.find(a=>typeof a=="object"));return s.map(r)}function Z_(t,s){const r=Uo(t,s==null?void 0:s.in);return r.setHours(0,0,0,0),r}function JY(t,s,r){const[a,n]=XY(r==null?void 0:r.in,t,s),i=Z_(a),l=Z_(n),o=+i-J_(i),u=+l-J_(l);return Math.round((o-u)/zY)}function ZY(t,s){const r=Lk(t,s),a=xu(t,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),b0(a)}function eX(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function tX(t){return!(!eX(t)&&typeof t!="number"||isNaN(+Uo(t)))}function sX(t,s){const r=Uo(t,s==null?void 0:s.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const rX={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},aX=(t,s,r)=>{let a;const n=rX[t];return typeof n=="string"?a=n:s===1?a=n.one:a=n.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function db(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const nX={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},iX={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lX={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},oX={date:db({formats:nX,defaultWidth:"full"}),time:db({formats:iX,defaultWidth:"full"}),dateTime:db({formats:lX,defaultWidth:"full"})},cX={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},dX=(t,s,r,a)=>cX[t];function ym(t){return(s,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let n;if(a==="formatting"&&t.formattingValues){const l=t.defaultFormattingWidth||t.defaultWidth,o=r!=null&&r.width?String(r.width):l;n=t.formattingValues[o]||t.formattingValues[l]}else{const l=t.defaultWidth,o=r!=null&&r.width?String(r.width):t.defaultWidth;n=t.values[o]||t.values[l]}const i=t.argumentCallback?t.argumentCallback(s):s;return n[i]}}const uX={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},AX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},hX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},mX={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},fX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},pX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xX=(t,s)=>{const r=Number(t),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},gX={ordinalNumber:xX,era:ym({values:uX,defaultWidth:"wide"}),quarter:ym({values:AX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ym({values:hX,defaultWidth:"wide"}),day:ym({values:mX,defaultWidth:"wide"}),dayPeriod:ym({values:fX,defaultWidth:"wide",formattingValues:pX,defaultFormattingWidth:"wide"})};function jm(t){return(s,r={})=>{const a=r.width,n=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],i=s.match(n);if(!i)return null;const l=i[0],o=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?bX(o,m=>m.test(l)):vX(o,m=>m.test(l));let d;d=t.valueCallback?t.valueCallback(u):u,d=r.valueCallback?r.valueCallback(d):d;const c=s.slice(l.length);return{value:d,rest:c}}}function vX(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function bX(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function yX(t){return(s,r={})=>{const a=s.match(t.matchPattern);if(!a)return null;const n=a[0],i=s.match(t.parsePattern);if(!i)return null;let l=t.valueCallback?t.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const o=s.slice(n.length);return{value:l,rest:o}}}const jX=/^(\d+)(th|st|nd|rd)?/i,NX=/\d+/i,wX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_X={any:[/^b/i,/^(a|c)/i]},SX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},CX={any:[/1/i,/2/i,/3/i,/4/i]},BX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},kX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},EX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},FX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},TX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},IX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},LX={ordinalNumber:yX({matchPattern:jX,parsePattern:NX,valueCallback:t=>parseInt(t,10)}),era:jm({matchPatterns:wX,defaultMatchWidth:"wide",parsePatterns:_X,defaultParseWidth:"any"}),quarter:jm({matchPatterns:SX,defaultMatchWidth:"wide",parsePatterns:CX,defaultParseWidth:"any",valueCallback:t=>t+1}),month:jm({matchPatterns:BX,defaultMatchWidth:"wide",parsePatterns:kX,defaultParseWidth:"any"}),day:jm({matchPatterns:EX,defaultMatchWidth:"wide",parsePatterns:FX,defaultParseWidth:"any"}),dayPeriod:jm({matchPatterns:TX,defaultMatchWidth:"any",parsePatterns:IX,defaultParseWidth:"any"})},DX={code:"en-US",formatDistance:aX,formatLong:oX,formatRelative:dX,localize:gX,match:LX,options:{weekStartsOn:0,firstWeekContainsDate:1}};function PX(t,s){const r=Uo(t,s==null?void 0:s.in);return JY(r,sX(r))+1}function UX(t,s){const r=Uo(t,s==null?void 0:s.in),a=+b0(r)-+ZY(r);return Math.round(a/Ik)+1}function Dk(t,s){var c,m,h,f;const r=Uo(t,s==null?void 0:s.in),a=r.getFullYear(),n=ug(),i=(s==null?void 0:s.firstWeekContainsDate)??((m=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(h=n.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,l=xu((s==null?void 0:s.in)||t,0);l.setFullYear(a+1,0,i),l.setHours(0,0,0,0);const o=Cf(l,s),u=xu((s==null?void 0:s.in)||t,0);u.setFullYear(a,0,i),u.setHours(0,0,0,0);const d=Cf(u,s);return+r>=+o?a+1:+r>=+d?a:a-1}function RX(t,s){var o,u,d,c;const r=ug(),a=(s==null?void 0:s.firstWeekContainsDate)??((u=(o=s==null?void 0:s.locale)==null?void 0:o.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((c=(d=r.locale)==null?void 0:d.options)==null?void 0:c.firstWeekContainsDate)??1,n=Dk(t,s),i=xu((s==null?void 0:s.in)||t,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),Cf(i,s)}function OX(t,s){const r=Uo(t,s==null?void 0:s.in),a=+Cf(r,s)-+RX(r,s);return Math.round(a/Ik)+1}function $r(t,s){const r=t<0?"-":"",a=Math.abs(t).toString().padStart(s,"0");return r+a}const Gd={y(t,s){const r=t.getFullYear(),a=r>0?r:1-r;return $r(s==="yy"?a%100:a,s.length)},M(t,s){const r=t.getMonth();return s==="M"?String(r+1):$r(r+1,2)},d(t,s){return $r(t.getDate(),s.length)},a(t,s){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,s){return $r(t.getHours()%12||12,s.length)},H(t,s){return $r(t.getHours(),s.length)},m(t,s){return $r(t.getMinutes(),s.length)},s(t,s){return $r(t.getSeconds(),s.length)},S(t,s){const r=s.length,a=t.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return $r(n,s.length)}},ch={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},eS={G:function(t,s,r){const a=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(t,s,r){if(s==="yo"){const a=t.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return Gd.y(t,s)},Y:function(t,s,r,a){const n=Dk(t,a),i=n>0?n:1-n;if(s==="YY"){const l=i%100;return $r(l,2)}return s==="Yo"?r.ordinalNumber(i,{unit:"year"}):$r(i,s.length)},R:function(t,s){const r=Lk(t);return $r(r,s.length)},u:function(t,s){const r=t.getFullYear();return $r(r,s.length)},Q:function(t,s,r){const a=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(a);case"QQ":return $r(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,s,r){const a=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(a);case"qq":return $r(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,s,r){const a=t.getMonth();switch(s){case"M":case"MM":return Gd.M(t,s);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(t,s,r){const a=t.getMonth();switch(s){case"L":return String(a+1);case"LL":return $r(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(t,s,r,a){const n=OX(t,a);return s==="wo"?r.ordinalNumber(n,{unit:"week"}):$r(n,s.length)},I:function(t,s,r){const a=UX(t);return s==="Io"?r.ordinalNumber(a,{unit:"week"}):$r(a,s.length)},d:function(t,s,r){return s==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Gd.d(t,s)},D:function(t,s,r){const a=PX(t);return s==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):$r(a,s.length)},E:function(t,s,r){const a=t.getDay();switch(s){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(t,s,r,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return $r(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(t,s,r,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return $r(i,s.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(t,s,r){const a=t.getDay(),n=a===0?7:a;switch(s){case"i":return String(n);case"ii":return $r(n,s.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(t,s,r){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,s,r){const a=t.getHours();let n;switch(a===12?n=ch.noon:a===0?n=ch.midnight:n=a/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,s,r){const a=t.getHours();let n;switch(a>=17?n=ch.evening:a>=12?n=ch.afternoon:a>=4?n=ch.morning:n=ch.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,s,r){if(s==="ho"){let a=t.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return Gd.h(t,s)},H:function(t,s,r){return s==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Gd.H(t,s)},K:function(t,s,r){const a=t.getHours()%12;return s==="Ko"?r.ordinalNumber(a,{unit:"hour"}):$r(a,s.length)},k:function(t,s,r){let a=t.getHours();return a===0&&(a=24),s==="ko"?r.ordinalNumber(a,{unit:"hour"}):$r(a,s.length)},m:function(t,s,r){return s==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Gd.m(t,s)},s:function(t,s,r){return s==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Gd.s(t,s)},S:function(t,s){return Gd.S(t,s)},X:function(t,s,r){const a=t.getTimezoneOffset();if(a===0)return"Z";switch(s){case"X":return sS(a);case"XXXX":case"XX":return Yu(a);case"XXXXX":case"XXX":default:return Yu(a,":")}},x:function(t,s,r){const a=t.getTimezoneOffset();switch(s){case"x":return sS(a);case"xxxx":case"xx":return Yu(a);case"xxxxx":case"xxx":default:return Yu(a,":")}},O:function(t,s,r){const a=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+tS(a,":");case"OOOO":default:return"GMT"+Yu(a,":")}},z:function(t,s,r){const a=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+tS(a,":");case"zzzz":default:return"GMT"+Yu(a,":")}},t:function(t,s,r){const a=Math.trunc(+t/1e3);return $r(a,s.length)},T:function(t,s,r){return $r(+t,s.length)}};function tS(t,s=""){const r=t>0?"-":"+",a=Math.abs(t),n=Math.trunc(a/60),i=a%60;return i===0?r+String(n):r+String(n)+s+$r(i,2)}function sS(t,s){return t%60===0?(t>0?"-":"+")+$r(Math.abs(t)/60,2):Yu(t,s)}function Yu(t,s=""){const r=t>0?"-":"+",a=Math.abs(t),n=$r(Math.trunc(a/60),2),i=$r(a%60,2);return r+n+s+i}const rS=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},Pk=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},QX=(t,s)=>{const r=t.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return rS(t,s);let i;switch(a){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",rS(a,s)).replace("{{time}}",Pk(n,s))},MX={p:Pk,P:QX},HX=/^D+$/,qX=/^Y+$/,VX=["D","DD","YY","YYYY"];function $X(t){return HX.test(t)}function WX(t){return qX.test(t)}function GX(t,s,r){const a=KX(t,s,r);if(console.warn(a),VX.includes(t))throw new RangeError(a)}function KX(t,s,r){const a=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zX=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,YX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,XX=/^'([^]*?)'?$/,JX=/''/g,ZX=/[a-zA-Z]/;function vh(t,s,r){var c,m,h,f;const a=ug(),n=a.locale??DX,i=a.firstWeekContainsDate??((m=(c=a.locale)==null?void 0:c.options)==null?void 0:m.firstWeekContainsDate)??1,l=a.weekStartsOn??((f=(h=a.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,o=Uo(t,r==null?void 0:r.in);if(!tX(o))throw new RangeError("Invalid time value");let u=s.match(YX).map(x=>{const g=x[0];if(g==="p"||g==="P"){const b=MX[g];return b(x,n.formatLong)}return x}).join("").match(zX).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const g=x[0];if(g==="'")return{isToken:!1,value:eJ(x)};if(eS[g])return{isToken:!0,value:x};if(g.match(ZX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+g+"`");return{isToken:!1,value:x}});n.localize.preprocessor&&(u=n.localize.preprocessor(o,u));const d={firstWeekContainsDate:i,weekStartsOn:l,locale:n};return u.map(x=>{if(!x.isToken)return x.value;const g=x.value;(WX(g)||$X(g))&&GX(g,s,String(t));const b=eS[g[0]];return b(o,g,n.localize,d)}).join("")}function eJ(t){const s=t.match(XX);return s?s[1].replace(JX,"'"):t}function ub(){const{id:t}=Ps(),s=Ns(),r=!!t&&t!=="new",[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState({rfq_no:"",rfq_date:vh(new Date,"yyyy-MM-dd"),expiry_date:"",status:"DRAFT",delivery_terms:"FOB",terms_conditions:`1. Price validity: 30 days from quote date
2. Delivery: As per agreed schedule
3. Payment terms: Net 30 days
4. Quality standards must be met
5. All prices should be quoted in GHS`}),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState([]),[y,N]=v.useState([]),[j,S]=v.useState([]),[k,P]=v.useState(!1),[I,B]=v.useState(""),q=v.useRef(null),[Q,O]=v.useState("");v.useEffect(()=>{T()},[]),v.useEffect(()=>{r&&V()},[t,r]),v.useEffect(()=>{r||te.get("/purchase/rfqs/next-no").then(E=>{var L;(L=E.data)!=null&&L.nextNo&&c(U=>({...U,rfq_no:E.data.nextNo}))}).catch(E=>console.error("Failed to load next RFQ number",E))},[r]);const T=async()=>{try{const[E,L,U]=await Promise.all([te.get("/purchase/suppliers?active=true"),te.get("/inventory/items"),te.get("/inventory/uoms")]);b(E.data.items||[]),N(L.data.items||[]),S(U.data.items||[])}catch(E){console.error("Failed to load dependencies",E)}},V=async()=>{var E,L;n(!0);try{const U=await te.get(`/purchase/rfqs/${t}`),{item:J,items:ae,suppliers:Z}=U.data;c({rfq_no:J.rfq_no,rfq_date:J.rfq_date?vh(new Date(J.rfq_date),"yyyy-MM-dd"):"",expiry_date:J.expiry_date?vh(new Date(J.expiry_date),"yyyy-MM-dd"):"",status:J.status,delivery_terms:J.delivery_terms||"FOB",terms_conditions:J.terms_conditions||""}),h(ae.map(oe=>({...oe,required_date:oe.required_date?vh(new Date(oe.required_date),"yyyy-MM-dd"):""}))),x(Z.map(oe=>({id:oe.supplier_id,supplier_name:oe.supplier_name,email:oe.email,phone:oe.phone})))}catch(U){u(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load RFQ")}finally{n(!1)}},D=E=>{const{id:L,value:U}=E.target;c(J=>({...J,[L]:U}))},Y=(E,L,U)=>{const J=[...m];J[E]={...J[E],[L]:U},h(J)},M=(E,L)=>{const U=y.find(J=>J.id===Number(L));if(U){const J=[...m];J[E]={...J[E],item_id:U.id,item_name:U.item_name,uom:U.uom||"PCS"},h(J)}},X=()=>{h([...m,{item_name:"",qty:0,uom:"PCS",required_date:"",specifications:""}])},R=E=>{h(m.filter((L,U)=>U!==E))},H=E=>{const L=f.find(U=>U.id===E.id);x(L?f.filter(U=>U.id!==E.id):[...f,E])},W=v.useMemo(()=>I?g.filter(E=>E.supplier_name.toLowerCase().includes(I.toLowerCase())||E.email&&E.email.toLowerCase().includes(I.toLowerCase())):g,[g,I]),K=()=>{window.print()},_=async()=>{const E=q.current;if(!E)return;const L=E.style.cssText;E.style.cssText=L+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const U=await Wn(E,{scale:2,useCORS:!0}),J=U.toDataURL("image/png"),ae=new As("p","mm","a4"),Z=ae.internal.pageSize.getWidth(),oe=ae.internal.pageSize.getHeight(),ee=Z,se=U.height*ee/U.width;let Ae=0;for(;Ae<se;)ae.addImage(J,"PNG",0,-Ae,ee,se),Ae+=oe,Ae<se&&ae.addPage();const we="RFQ_"+(d.rfq_no||new Date().toISOString().slice(0,10))+".pdf";ae.save(we)}finally{E.style.cssText=L}},F=async(E=null)=>{var U,J;if(!d.rfq_date){alert("RFQ Date is required");return}if(m.length===0){alert("Please add at least one item to the RFQ");return}if(m.filter(ae=>!ae.item_name||!ae.qty||Number(ae.qty)<=0).length>0){alert("All items must have a name and quantity greater than 0");return}l(!0);try{const ae={...d,rfq_no:d.rfq_no||null,status:E||d.status,items:m,supplier_ids:f.map(Z=>Z.id)};r?await te.put(`/purchase/rfqs/${t}`,ae):(await te.post("/purchase/rfqs",ae)).data.id,E&&c(Z=>({...Z,status:E})),O("RFQ Saved Successfully"),setTimeout(()=>{s("/purchase/rfqs")},1e3)}catch(ae){console.error(ae),alert(((J=(U=ae==null?void 0:ae.response)==null?void 0:U.data)==null?void 0:J.message)||"Failed to save RFQ")}finally{l(!1)}};return a?e.jsx("div",{className:"p-4",children:"Loading..."}):o?e.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",o]}):e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"print:hidden",children:[Q&&e.jsx("div",{className:"mb-3 p-3 rounded border border-green-300 bg-green-100 text-green-700",children:Q}),e.jsxs("div",{className:"bg-gradient-to-r from-[#0E3646] to-[#1a5570] p-6 rounded-xl text-white shadow-lg",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx("span",{children:""})," Request for Quotation (RFQ)"]}),e.jsx("p",{className:"opacity-90 text-sm mt-1",children:"Create and send RFQs to suppliers for competitive bidding"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx("button",{onClick:()=>P(!0),className:"px-4 py-2 bg-[#17a2b8] text-white rounded hover:bg-cyan-700 transition flex items-center gap-2",children:" Select Suppliers"}),e.jsx("button",{onClick:()=>s("/purchase/rfqs"),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition flex items-center gap-2 ml-auto",children:" View List"}),e.jsxs("div",{className:"flex items-center gap-3 ml-4",children:[e.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition text-sm",children:[e.jsx(gu,{className:"w-4 h-4"}),"Download PDF"]}),e.jsxs("button",{onClick:K,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition text-sm",children:[e.jsx(Mh,{className:"w-4 h-4"}),"Print"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center gap-2 border-b-2 border-[#0E3646] pb-2 mb-4",children:e.jsx("h2",{className:"text-lg font-semibold text-[#0E3646]",children:" RFQ Information"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"RFQ Number"}),e.jsx("input",{type:"text",value:d.rfq_no,readOnly:!0,className:"p-2 border border-gray-300 rounded bg-gray-100 text-gray-600"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646] after:content-['*'] after:text-red-500",children:"RFQ Date"}),e.jsx("input",{type:"date",id:"rfq_date",value:d.rfq_date,onChange:D,className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Expiry Date"}),e.jsx("input",{type:"date",id:"expiry_date",value:d.expiry_date,onChange:D,className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Status"}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold w-fit ${d.status==="SENT"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:d.status})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Delivery Terms"}),e.jsxs("select",{id:"delivery_terms",value:d.delivery_terms,onChange:D,className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",children:[e.jsx("option",{value:"FOB",children:"FOB - Free on Board"}),e.jsx("option",{value:"CIF",children:"CIF - Cost, Insurance & Freight"}),e.jsx("option",{value:"EXW",children:"EXW - Ex Works"}),e.jsx("option",{value:"DDP",children:"DDP - Delivered Duty Paid"})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 lg:col-span-2 flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Terms & Conditions"}),e.jsx("textarea",{id:"terms_conditions",value:d.terms_conditions,onChange:D,rows:"3",className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",placeholder:"Enter terms and conditions..."})]})]})]}),e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center gap-2 border-b-2 border-[#0E3646] pb-2 mb-4",children:e.jsxs("h2",{className:"text-lg font-semibold text-[#0E3646]",children:[" Selected Suppliers (",f.length,")"]})}),f.length===0?e.jsx("div",{className:"text-center p-8 bg-gray-50 rounded border border-dashed border-gray-300 text-gray-500",children:'No suppliers selected. Click "Select Suppliers" to add.'}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(E=>e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded p-4 relative hover:border-[#0E3646] transition group",children:[e.jsx("button",{onClick:()=>H(E),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition",children:""}),e.jsxs("div",{className:"font-semibold text-[#0E3646]",children:[E.supplier_name,E.supplier_code&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",E.supplier_code,")"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[E.contact_person&&e.jsxs("div",{className:"flex items-center gap-2",children:[" ",E.contact_person]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",E.email||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",E.phone||"N/A"]})]})]},E.id))})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h2",{className:"text-lg font-semibold text-[#0E3646]",children:" RFQ Items"})}),e.jsx("button",{onClick:X,className:"px-3 py-1 bg-[#0E3646] text-white text-sm rounded hover:bg-[#082330] transition",children:" Add Item"})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-[#0E3646] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-12",children:"#"}),e.jsx("th",{className:"p-3",children:"Item Name"}),e.jsx("th",{className:"p-3 w-32",children:"Quantity"}),e.jsx("th",{className:"p-3 w-24",children:"UOM"}),e.jsx("th",{className:"p-3 w-40",children:"Required Date"}),e.jsx("th",{className:"p-3 w-64",children:"Specifications"}),e.jsx("th",{className:"p-3 w-20",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-500",children:'No items added. Click "Add Item" to start.'})}):m.map((E,L)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-3",children:L+1}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:E.item_id||"",onChange:U=>M(L,U.target.value),className:"w-full p-1 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"Select Item"}),y.map(U=>e.jsxs("option",{value:U.id,children:[U.item_name," (",U.item_code,")"]},U.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:E.qty,onChange:U=>Y(L,"qty",U.target.value),className:"w-full p-1 border border-gray-300 rounded"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:E.uom||"",onChange:U=>Y(L,"uom",U.target.value),className:"w-full p-1 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"Select UOM"}),j.map(U=>e.jsxs("option",{value:U.uom_code,children:[U.uom_name," (",U.uom_code,")"]},U.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"date",value:E.required_date||"",onChange:U=>Y(L,"required_date",U.target.value),className:"w-full p-1 border border-gray-300 rounded"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"text",value:E.specifications||"",onChange:U=>Y(L,"specifications",U.target.value),className:"w-full p-1 border border-gray-300 rounded"})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>R(L),className:"text-red-500 hover:bg-red-50 p-1 rounded transition",children:""})})]},L))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{window.confirm("Are you sure? Unsaved changes will be lost.")&&(h([]),x([]),c(E=>({...E,terms_conditions:""})))},className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition",children:" Clear"}),e.jsx("button",{onClick:()=>F("DRAFT"),disabled:i,className:"px-4 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition disabled:opacity-50",children:i?"Saving...":" Save as Draft"}),e.jsx("button",{onClick:()=>F("SENT"),disabled:i,className:"px-4 py-2 bg-[#28a745] text-white rounded hover:bg-green-700 transition disabled:opacity-50",children:i?"Sending...":" Send RFQ to Suppliers"})]})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 bg-[#0E3646] text-white rounded-t-xl flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Select Suppliers"}),e.jsx("button",{onClick:()=>P(!1),className:"text-white hover:bg-white/10 w-8 h-8 rounded flex items-center justify-center text-xl",children:""})]}),e.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:" Search suppliers...",value:I,onChange:E=>B(E.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0E3646] outline-none"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[W.map(E=>{const L=f.some(U=>U.id===E.id);return e.jsx("div",{onClick:()=>H(E),className:`
                        border-2 rounded-lg p-4 cursor-pointer transition
                        ${L?"border-[#0E3646] bg-blue-50":"border-gray-200 hover:border-blue-300"}
                      `,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`
                          w-5 h-5 rounded border flex items-center justify-center mt-1
                          ${L?"bg-[#0E3646] border-[#0E3646]":"border-gray-400 bg-white"}
                        `,children:L&&e.jsx("span",{className:"text-white text-xs",children:""})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-[#0E3646]",children:[E.supplier_name,E.supplier_code&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2 font-normal",children:["(",E.supplier_code,")"]})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1 space-y-1",children:[E.contact_person&&e.jsxs("div",{className:"flex items-center gap-2",children:[" ",E.contact_person]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",E.email||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",E.phone||"N/A"]})]})]})]})},E.id)}),W.length===0&&e.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:['No suppliers found matching "',I,'"']})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-200 flex justify-end gap-3 bg-gray-50 rounded-b-xl",children:e.jsx("button",{onClick:()=>P(!1),className:"px-6 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition font-medium",children:"Done"})})]})})]}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto bg-white border border-gray-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-[#0E3646]",children:"Request for Quotation"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["RFQ Number: ",d.rfq_no||""]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-700",children:[e.jsxs("div",{children:["Date: ",d.rfq_date||""]}),e.jsxs("div",{children:["Expiry Date: ",d.expiry_date||""]}),e.jsxs("div",{children:["Status: ",d.status]}),e.jsxs("div",{children:["Delivery Terms: ",d.delivery_terms]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Selected Suppliers"}),f.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No suppliers selected."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Supplier"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Email"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Phone"})]})}),e.jsx("tbody",{children:f.map(E=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.supplier_name}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.email||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.phone||""})]},E.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"RFQ Items"}),m.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No items added."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"#"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Item"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-right",children:"Qty"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"UOM"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Required Date"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Specifications"})]})}),e.jsx("tbody",{children:m.map((E,L)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:L+1}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.item_name||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-right",children:E.qty||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.uom||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.required_date||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.specifications||""})]},L))})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Terms and Conditions"}),e.jsx("div",{className:"text-sm whitespace-pre-line",children:d.terms_conditions||"None"})]})]}),e.jsxs("div",{ref:q,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-[#0E3646]",children:"Request for Quotation"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["RFQ Number: ",d.rfq_no||""]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-700",children:[e.jsxs("div",{children:["Date: ",d.rfq_date||""]}),e.jsxs("div",{children:["Expiry Date: ",d.expiry_date||""]}),e.jsxs("div",{children:["Status: ",d.status]}),e.jsxs("div",{children:["Delivery Terms: ",d.delivery_terms]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Selected Suppliers"}),f.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No suppliers selected."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Supplier"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Email"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Phone"})]})}),e.jsx("tbody",{children:f.map(E=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.supplier_name}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.email||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.phone||""})]},E.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"RFQ Items"}),m.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No items added."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"#"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Item"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-right",children:"Qty"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"UOM"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Required Date"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Specifications"})]})}),e.jsx("tbody",{children:m.map((E,L)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:L+1}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.item_name||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-right",children:E.qty||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.uom||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.required_date||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:E.specifications||""})]},L))})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Terms and Conditions"}),e.jsx("div",{className:"text-sm whitespace-pre-line",children:d.terms_conditions||"None"})]})]})]})}function tJ(){const[t,s]=v.useState(""),[r,a]=v.useState("ALL"),[n,i]=v.useState([]),[l,o]=v.useState(!1),[u,d]=v.useState("");v.useEffect(()=>{let h=!0;return o(!0),d(""),te.get("/purchase/supplier-quotations").then(f=>{var x;h&&i(Array.isArray((x=f.data)==null?void 0:x.items)?f.data.items:[])}).catch(f=>{var x,g;h&&d(((g=(x=f==null?void 0:f.response)==null?void 0:x.data)==null?void 0:g.message)||"Failed to load supplier quotations")}).finally(()=>{h&&o(!1)}),()=>{h=!1}},[]);const c=h=>({DRAFT:"badge-neutral",SUBMITTED:"badge-info",RECEIVED:"badge-info",UNDER_REVIEW:"badge-warning",ACCEPTED:"badge-success",REJECTED:"badge-error"})[h]||"badge-info",m=v.useMemo(()=>n.filter(h=>{const f=String(h.quotation_no||"").toLowerCase().includes(t.toLowerCase())||String(h.supplier_name||"").toLowerCase().includes(t.toLowerCase())||String(h.rfq_no||"").toLowerCase().includes(t.toLowerCase()),x=r==="ALL"||h.status===r;return f&&x}),[n,t,r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Supplier Quotations"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive and manage supplier quotations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/supplier-quotations/new",className:"btn-success",children:"+ New Quotation"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by quotation no, supplier, or RFQ no...",className:"input",value:t,onChange:h=>s(h.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:h=>a(h.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"RECEIVED",children:"Received"}),e.jsx("option",{value:"UNDER_REVIEW",children:"Under Review"}),e.jsx("option",{value:"ACCEPTED",children:"Accepted"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Quotation No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"RFQ No"}),e.jsx("th",{children:"Valid Until"}),e.jsx("th",{className:"text-right",children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-red-600",children:u})}):null,m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No quotations found"})}):m.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.quotation_no}),e.jsx("td",{children:new Date(h.quotation_date).toLocaleDateString()}),e.jsx("td",{children:h.supplier_name}),e.jsx("td",{children:h.rfq_no}),e.jsx("td",{children:h.valid_until?new Date(h.valid_until).toLocaleDateString():""}),e.jsx("td",{className:"text-right font-medium",children:h.total_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c(h.status)}`,children:h.status.replace("_"," ")})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/purchase/supplier-quotations/${h.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/supplier-quotations/${h.id}/edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"})]})})]},h.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",m.length," of ",n.length," ","quotations"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]})]})}function Ab(){const{id:t}=Ps(),s=Ns(),r=!!t&&t!=="new",[a,n]=v.useState({quotation_no:"",quotation_date:new Date().toISOString().split("T")[0],supplier_id:"",rfq_id:"",valid_until:"",status:"DRAFT",remarks:"",contact_person:"",email:"",phone:"",currency:"USD",payment_terms:"Net30",delivery_time:"",delivery_terms:"FOB",shipping_cost:0,discount_percent:0}),[i,l]=v.useState([{item_id:"",item_name:"",qty:0,unit_price:0,tax_percent:0,delivery_date:"",line_total:0}]),[o,u]=v.useState([]),[d,c]=v.useState([]),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState(!1),[y,N]=v.useState(!1),[j,S]=v.useState(""),[k,P]=v.useState([]),[I,B]=v.useState(!1),[q,Q]=v.useState([]),[O,T]=v.useState([]),[V,D]=v.useState(null);v.useEffect(()=>{let J=!0;async function ae(){var Z,oe,ee,se,Ae,we,ce;try{const[le,_e,Qe,Ie,ke]=await Promise.all([te.get("/purchase/suppliers"),te.get("/inventory/items"),te.get("/purchase/rfqs"),te.get("/finance/tax-codes"),te.get("/finance/currencies")]);if(!J)return;u(Array.isArray((Z=le.data)==null?void 0:Z.items)?le.data.items:[]),h(Array.isArray((oe=_e.data)==null?void 0:oe.items)?_e.data.items:[]),c(Array.isArray((ee=Qe.data)==null?void 0:ee.items)?Qe.data.items:[]),x(Array.isArray((se=Ie.data)==null?void 0:se.items)?Ie.data.items:[]),T(Array.isArray((Ae=ke.data)==null?void 0:Ae.items)?ke.data.items:[])}catch(le){if(!J)return;S(((ce=(we=le==null?void 0:le.response)==null?void 0:we.data)==null?void 0:ce.message)||"Failed to load suppliers/items")}}return ae(),()=>{J=!1}},[]),v.useEffect(()=>{if(r)return;let J=!0;return te.get("/purchase/supplier-quotations/next-no").then(ae=>{var Z;J&&(Z=ae.data)!=null&&Z.nextNo&&n(oe=>({...oe,quotation_no:ae.data.nextNo}))}).catch(ae=>console.error("Failed to load next supplier quotation number",ae)),()=>{J=!1}},[r]),v.useEffect(()=>{if(!r)return;let J=!0;return b(!0),S(""),te.get(`/purchase/supplier-quotations/${t}`).then(ae=>{var ee,se;if(!J)return;const Z=(ee=ae.data)==null?void 0:ee.item,oe=Array.isArray((se=ae.data)==null?void 0:se.details)?ae.data.details:[];Z&&(n(Ae=>{const we={...Ae,quotation_no:Z.quotation_no||"",quotation_date:Z.quotation_date?String(Z.quotation_date).split("T")[0]:new Date().toISOString().split("T")[0],supplier_id:Z.supplier_id?String(Z.supplier_id):"",rfq_id:Z.rfq_id?String(Z.rfq_id):"",valid_until:Z.valid_until?String(Z.valid_until).split("T")[0]:"",status:Z.status||"DRAFT",remarks:Z.remarks||"",exchange_rate:Z.exchange_rate!==void 0&&Z.exchange_rate!==null?Number(Z.exchange_rate)||Ae.exchange_rate||1:Ae.exchange_rate||1},ce=`supplierQuoteExtras:${t}`;try{const le=window.localStorage.getItem(ce);if(le){const _e=JSON.parse(le);_e&&_e.formData&&Object.assign(we,_e.formData)}}catch{}return we}),D(Z.currency_id||null),l(()=>{let Ae=oe.length&&oe.map(ce=>({item_id:ce.item_id?String(ce.item_id):"",item_name:ce.item_name||"",qty:Number(ce.qty)||0,unit_price:Number(ce.unit_price)||0,line_total:Number(ce.line_total)||0}));(!Ae||!Ae.length)&&(Ae=[{item_id:"",item_name:"",qty:0,unit_price:0,line_total:0}]);const we=`supplierQuoteExtras:${t}`;try{const ce=window.localStorage.getItem(we);if(ce){const le=JSON.parse(ce);if(le&&Array.isArray(le.items))return Ae.map((_e,Qe)=>({..._e,...le.items[Qe]||{}}))}}catch{}return Ae}))}).catch(ae=>{var Z,oe;J&&S(((oe=(Z=ae==null?void 0:ae.response)==null?void 0:Z.data)==null?void 0:oe.message)||"Failed to load supplier quotation")}).finally(()=>{J&&b(!1)}),()=>{J=!1}},[t,r]);const Y=async J=>{var se;const ae=String(J||"").toUpperCase(),Z=Array.isArray(O)?O:[];if(!ae||!Z.length)return;const oe=Z.find(Ae=>String(Ae.is_base)==="1"||Ae.is_base===1||Ae.is_base===!0)||Z.find(Ae=>String(Ae.code||Ae.currency_code||"").toUpperCase()==="GHS")||Z.find(Ae=>/ghana|cedi/i.test(String(Ae.name||Ae.currency_name||""))),ee=Z.find(Ae=>String(Ae.code||Ae.currency_code||"").toUpperCase()===ae);if(!oe||!ee||oe.id===ee.id){n(Ae=>({...Ae,exchange_rate:1}));return}try{const Ae=a.quotation_date||new Date().toISOString().split("T")[0],we=await te.get("/finance/currency-rates",{params:{fromCurrencyId:ee.id,toCurrencyId:oe.id,to:Ae}}),le=(Array.isArray((se=we.data)==null?void 0:se.items)?we.data.items:[])[0];if(le&&le.rate)n(_e=>({..._e,exchange_rate:Number(le.rate)||_e.exchange_rate||1}));else try{await te.post("/finance/currency-rates",{fromCurrencyId:ee.id,toCurrencyId:oe.id,rate:1,rateDate:Ae}),n(_e=>({..._e,exchange_rate:1}))}catch{n(_e=>({..._e,exchange_rate:1}))}}catch{n(Ae=>({...Ae,exchange_rate:Ae.exchange_rate||1}))}};v.useEffect(()=>{if(r&&V&&Array.isArray(O)&&O.length){const J=O.find(ae=>String(ae.id)===String(V));if(J){const ae=String(J.code||J.currency_code||"").toUpperCase();n(Z=>({...Z,currency:ae||Z.currency}))}}},[r,V,O]),v.useEffect(()=>{Y(a.currency)},[O,a.currency,a.quotation_date]);const M=async J=>{var oe,ee,se;const{name:ae,value:Z}=J.target;if(n(Ae=>({...Ae,[ae]:Z})),ae==="rfq_id"&&!Z){Q([]);return}if(ae==="rfq_id"&&Z)try{const Ae=await te.get(`/purchase/rfqs/${Z}`),we=(oe=Ae.data)==null?void 0:oe.item,ce=Array.isArray((ee=Ae.data)==null?void 0:ee.items)?Ae.data.items:[],le=Array.isArray((se=Ae.data)==null?void 0:se.suppliers)?Ae.data.suppliers:[];if(Q(le),we&&n(_e=>{const Qe={..._e,rfq_id:Z,valid_until:we.expiry_date||_e.valid_until,delivery_terms:we.delivery_terms||_e.delivery_terms,remarks:we.remarks||_e.remarks};if(le.length===1){const Ie=le[0];Qe.supplier_id=String(Ie.supplier_id),Qe.contact_person=Ie.supplier_name||_e.contact_person,Qe.email=Ie.email||_e.email,Qe.phone=Ie.phone||_e.phone}else le.length>1&&(Qe.supplier_id="",Qe.contact_person="",Qe.email="",Qe.phone="");return Qe}),ce.length){const _e=ce.map(Qe=>({item_id:String(Qe.item_id),item_name:Qe.item_name||"",qty:Number(Qe.qty)||0,unit_price:0,tax_percent:0,delivery_date:Qe.required_date||"",line_total:0}));l(_e)}}catch(Ae){console.error("Failed to fetch RFQ details",Ae)}ae==="currency"&&await Y(Z)},X=(J,ae,Z)=>{const oe=[...i];if(oe[J][ae]=Z,ae==="item_id"){const ee=m.find(se=>String(se.id)===String(Z));ee&&(oe[J].item_name=ee.item_name||ee.name||"")}if(ae==="qty"||ae==="unit_price"||ae==="tax_percent"){const ee=parseFloat(oe[J].qty||0),se=parseFloat(oe[J].unit_price||0);oe[J].line_total=ee*se}l(oe)},R=()=>{l([...i,{item_id:"",item_name:"",qty:0,unit_price:0,tax_percent:0,delivery_date:"",line_total:0}])},H=J=>{i.length>1&&l(i.filter((ae,Z)=>Z!==J))},W=v.useMemo(()=>i.reduce((J,ae)=>J+(parseFloat(ae.line_total)||0),0),[i]),K=v.useMemo(()=>i.reduce((J,ae)=>{const Z=parseFloat(ae.qty)||0,oe=parseFloat(ae.unit_price)||0,ee=parseFloat(ae.tax_percent)||0,se=Z*oe;return J+se*(ee/100)},0),[i]),_=v.useMemo(()=>{const J=parseFloat(a.shipping_cost)||0,ae=parseFloat(a.discount_percent)||0,Z=W+K+J,oe=Z*(ae/100);return Z-oe},[W,K,a.shipping_cost,a.discount_percent]);v.useMemo(()=>W,[W]);const F=async J=>{var ae,Z,oe;J.preventDefault(),N(!0),S("");try{const se=(Array.isArray(O)?O:[]).find(le=>String(le.code||le.currency_code||"").toUpperCase()===String(a.currency||"").toUpperCase()),Ae=(se==null?void 0:se.id)||null,we={quotation_no:a.quotation_no||void 0,quotation_date:a.quotation_date,supplier_id:Number(a.supplier_id),rfq_id:a.rfq_id?Number(a.rfq_id):null,valid_until:a.valid_until||null,status:a.status,remarks:a.remarks||null,currency_id:Ae,exchange_rate:Number(a.exchange_rate)||1,details:i.filter(le=>le.item_id).map(le=>({item_id:Number(le.item_id),qty:Number(le.qty)||0,unit_price:Number(le.unit_price)||0,line_total:Number(le.line_total)||0})),attachments:k.map(le=>({url:le.url,filename:le.filename,note:le.note||null}))},ce={formData:{contact_person:a.contact_person,email:a.email,phone:a.phone,currency:a.currency,payment_terms:a.payment_terms,delivery_time:a.delivery_time,delivery_terms:a.delivery_terms,shipping_cost:a.shipping_cost,discount_percent:a.discount_percent},items:i.map(le=>({tax_percent:le.tax_percent,delivery_date:le.delivery_date}))};if(r){await te.put(`/purchase/supplier-quotations/${t}`,we);const le=`supplierQuoteExtras:${t}`;window.localStorage.setItem(le,JSON.stringify(ce))}else{const _e=(ae=(await te.post("/purchase/supplier-quotations",we)).data)==null?void 0:ae.id;if(_e){const Qe=`supplierQuoteExtras:${_e}`;window.localStorage.setItem(Qe,JSON.stringify(ce))}}s("/purchase/supplier-quotations")}catch(ee){S(((oe=(Z=ee==null?void 0:ee.response)==null?void 0:Z.data)==null?void 0:oe.message)||"Failed to save supplier quotation")}finally{N(!1)}},E=async J=>{var ae,Z,oe,ee;B(!0);try{const se=new FormData;se.append("file",J);const Ae=await te.post("/upload",se,{headers:{"Content-Type":"multipart/form-data"}}),we=(ae=Ae.data)==null?void 0:ae.url,ce=((Z=Ae.data)==null?void 0:Z.filename)||J.name;we&&P(le=>[...le,{url:we,filename:ce}])}catch(se){S(((ee=(oe=se==null?void 0:se.response)==null?void 0:oe.data)==null?void 0:ee.message)||"File upload failed")}finally{B(!1)}},L=async J=>{const ae=Array.from(J.target.files||[]);for(const Z of ae)await E(Z);J.target.value=""},U=J=>{P(ae=>ae.filter((Z,oe)=>oe!==J))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[r?"Edit":"New"," Supplier Quotation"]}),e.jsx("p",{className:"text-sm mt-1",children:r?"Update quotation details":"Record a new supplier quotation"})]}),e.jsx(Ee,{to:"/purchase/supplier-quotations",className:"btn-success",children:"Back to List"})]}),e.jsxs("form",{onSubmit:F,children:[g?e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-body",children:"Loading..."})}):null,j?e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-body text-red-600",children:j})}):null,e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Quotation Information"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quotation No *"}),e.jsx("input",{type:"text",name:"quotation_no",className:"input",value:a.quotation_no,onChange:M,placeholder:"Auto-generated",disabled:r,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quotation Date *"}),e.jsx("input",{type:"date",name:"quotation_date",className:"input",value:a.quotation_date,onChange:M,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{name:"supplier_id",className:"input",value:a.supplier_id,onChange:M,disabled:q.length>1,required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),o.map(J=>e.jsx("option",{value:J.id,children:J.supplier_name||J.name||J.supplier_code||`Supplier #${J.id}`},J.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"RFQ No"}),e.jsxs("select",{name:"rfq_id",className:"input",value:a.rfq_id,onChange:M,children:[e.jsx("option",{value:"",children:"Select RFQ"}),d.map(J=>e.jsxs("option",{value:J.id,children:[J.rfq_no," ",J.status?`- ${J.status}`:""]},J.id))]})]}),q.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"RFQ Supplier"}),e.jsxs("select",{className:"input",value:a.supplier_id,onChange:J=>{const ae=J.target.value,Z=q.find(oe=>String(oe.supplier_id)===String(ae));n(oe=>({...oe,supplier_id:ae,contact_person:(Z==null?void 0:Z.supplier_name)||oe.contact_person,email:(Z==null?void 0:Z.email)||oe.email,phone:(Z==null?void 0:Z.phone)||oe.phone}))},children:[e.jsx("option",{value:"",children:"Select Supplier from RFQ"}),q.map(J=>e.jsx("option",{value:J.supplier_id,children:J.supplier_name},J.supplier_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Valid Until *"}),e.jsx("input",{type:"date",name:"valid_until",className:"input",value:a.valid_until,onChange:M,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{name:"status",className:"input",value:a.status,onChange:M,children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"})]})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{name:"remarks",className:"input",rows:"3",value:a.remarks,onChange:M,placeholder:"Additional notes..."})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Supplier & Contact"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Person"}),e.jsx("input",{type:"text",name:"contact_person",className:"input",value:a.contact_person,onChange:M,placeholder:"Enter contact person name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:"input",value:a.email,onChange:M,placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",className:"input",value:a.phone,onChange:M,placeholder:"+233-000-000-0000"})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Terms"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{name:"currency",className:"input",value:a.currency,onChange:M,children:[e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"GHS",children:"GHS - Ghana Cedi"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{type:"number",name:"exchange_rate",className:"input text-right",value:a.exchange_rate,onChange:M,step:"0.000001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsxs("select",{name:"payment_terms",className:"input",value:a.payment_terms,onChange:M,children:[e.jsx("option",{value:"Net30",children:"Net 30 days"}),e.jsx("option",{value:"Net60",children:"Net 60 days"}),e.jsx("option",{value:"Advance50",children:"50% Advance"}),e.jsx("option",{value:"COD",children:"Cash on Delivery"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Time"}),e.jsx("input",{type:"text",name:"delivery_time",className:"input",value:a.delivery_time,onChange:M,placeholder:"e.g., 2-3 weeks"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Terms"}),e.jsxs("select",{name:"delivery_terms",className:"input",value:a.delivery_terms,onChange:M,children:[e.jsx("option",{value:"FOB",children:"FOB"}),e.jsx("option",{value:"CIF",children:"CIF"}),e.jsx("option",{value:"EXW",children:"EXW"}),e.jsx("option",{value:"DDP",children:"DDP"})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-WHITE dark:text-slate-100",children:"Quotation Items"}),e.jsx("button",{type:"button",onClick:R,className:"btn-success",children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"30%"},children:"Item"}),e.jsx("th",{className:"text-right",style:{width:"10%"},children:"Quantity"}),e.jsx("th",{className:"text-right",style:{width:"15%"},children:"Unit Price"}),e.jsx("th",{className:"text-right",style:{width:"15%"},children:"Tax"}),e.jsx("th",{className:"text-right",style:{width:"15%"},children:"Line Total"}),e.jsx("th",{style:{width:"15%"},children:"Delivery Date"}),e.jsx("th",{style:{width:"10%"},children:"Action"})]})}),e.jsx("tbody",{children:i.map((J,ae)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:J.item_id,onChange:Z=>X(ae,"item_id",Z.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),m.map(Z=>e.jsx("option",{value:Z.id,children:(Z.item_code||Z.code||Z.id)+" - "+(Z.item_name||Z.name||"")},Z.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right",value:J.qty,onChange:Z=>X(ae,"qty",Z.target.value),step:"1",min:"0",required:!0})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right",value:J.unit_price,onChange:Z=>X(ae,"unit_price",Z.target.value),step:"1",min:"0",required:!0})}),e.jsx("td",{children:e.jsxs("select",{className:"input text-right",value:J.tax_percent,onChange:Z=>X(ae,"tax_percent",Z.target.value),children:[e.jsx("option",{value:0,children:"No Tax"}),f.map(Z=>e.jsxs("option",{value:Z.rate_percent,children:[Z.code," - ",Z.name," (",Number(Z.rate_percent).toFixed(2),"%)"]},Z.id))]})}),e.jsx("td",{className:"text-right font-medium",children:J.line_total.toFixed(2)}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input",value:J.delivery_date,onChange:Z=>X(ae,"delivery_date",Z.target.value)})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>H(ae),className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-sm font-medium",disabled:i.length===1,children:"Remove"})})]},ae))})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Summary"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-7",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{className:"font-semibold",children:W.toFixed(2)})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-center flex-1",children:[e.jsx("div",{children:"Total Tax"}),e.jsx("div",{className:"font-semibold",children:K.toFixed(2)})]}),e.jsx("div",{className:"flex-1"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Shipping Cost"}),e.jsx("div",{children:e.jsx("input",{type:"number",className:"input w-32",value:a.shipping_cost,onChange:J=>n(ae=>({...ae,shipping_cost:J.target.value})),step:"1",min:"0"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Discount (%)"}),e.jsx("div",{children:e.jsx("input",{type:"number",className:"input w-32",value:a.discount_percent,onChange:J=>n(ae=>({...ae,discount_percent:J.target.value})),step:"1",min:"0"})})]}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-4 md:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Grand Total"}),e.jsx("div",{className:"text-lg font-bold",children:_.toFixed(2)})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Supporting Documents"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"file",className:"input",onChange:L,multiple:!0}),e.jsx("span",{className:"text-sm",children:I?"Uploading...":"Attach PDF, DOCX, XLSX, images"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Filename"}),e.jsx("th",{children:"Link"}),e.jsx("th",{children:"Note"}),e.jsx("th",{className:"text-right",children:"Action"})]})}),e.jsxs("tbody",{children:[k.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No attachments"})}),k.map((J,ae)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:J.filename}),e.jsx("td",{children:e.jsx("a",{href:J.url,target:"_blank",rel:"noreferrer",className:"text-brand hover:text-brand-700",children:"View"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:J.note||"",onChange:Z=>P(oe=>oe.map((ee,se)=>se===ae?{...ee,note:Z.target.value}:ee)),placeholder:"Optional note"})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>U(ae),children:"Remove"})})]},`${J.url}-${ae}`))]})]})})]})})]}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx(Ee,{to:"/purchase/supplier-quotations",className:"btn-success",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-success",children:[y?"Saving...":r?"Update":"Create"," Quotation"]})]})]})]})}function sJ(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState([]),[c,m]=v.useState(null),[h,f]=v.useState("comparison");v.useEffect(()=>{let k=!0;return a(!0),o(""),te.get("/purchase/rfqs").then(P=>{var I;k&&d(Array.isArray((I=P.data)==null?void 0:I.items)?P.data.items:[])}).catch(P=>{var I,B;k&&o(((B=(I=P==null?void 0:P.response)==null?void 0:I.data)==null?void 0:B.message)||"Failed to load RFQs")}).finally(()=>{k&&a(!1)}),()=>{k=!1}},[]);const x=async()=>{var k,P;if(t){i(!0),o("");try{const I=await te.get("/purchase/quotation-analysis",{params:{rfq_no:t}});m(I.data)}catch(I){o(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to load quotation analysis"),m(null)}finally{i(!1)}}},g=v.useMemo(()=>{if(!(c!=null&&c.items))return[];const k=new Set;return c.items.forEach(P=>{P.suppliers.forEach(I=>k.add(I.supplier))}),Array.from(k)},[c]),b=k=>!k.suppliers||k.suppliers.length===0?1/0:Math.min(...k.suppliers.map(P=>P.unit_price)),y=(k,P)=>k.suppliers.find(I=>I.supplier===P),N=k=>c!=null&&c.items?c.items.reduce((P,I)=>{const B=y(I,k);return P+(B?B.total:0)},0):0,S=u.find(k=>k.rfq_no===t)||{};return e.jsxs("div",{className:"quotation-analysis-container",children:[e.jsx("style",{children:`
        :root {
            --primary: #0E3646;
            --primary-dark: #082330;
            --primary-light: #1a5570;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
            --light: #f8f9fa;
            --border: #dee2e6;
        }

        .quotation-analysis-container {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #fff;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 30px;
            border-radius: 12px 12px 0 0;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: var(--light);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(14, 54, 70, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .form-content {
            padding: 30px;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 6px;
        }

        .form-control {
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .comparison-table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: white;
            min-width: 1200px;
        }

        .comparison-table thead th {
            background: var(--primary);
            color: white;
            padding: 15px;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            text-align: left;
        }

        .comparison-table tbody td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            border-right: 1px solid var(--border);
            vertical-align: top;
        }

        .comparison-table tbody td:last-child {
            border-right: none;
        }

        .supplier-column {
            min-width: 220px;
            background: #f8f9fa;
        }

        .price-cell {
            font-weight: 600;
            font-size: 15px;
            color: var(--primary);
        }

        .best-price {
            background: #d4edda !important;
            position: relative;
        }

        .best-price::after {
            content: " Best";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 10px;
            background: var(--success);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .tabs {
            display: flex;
            gap: 0;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s;
            font-size: 14px;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(14, 54, 70, 0.05);
        }

        .info-card {
            background: #e7f3ff;
            border-left: 4px solid var(--info);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .supplier-info-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            transition: all 0.3s;
        }

        .supplier-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .supplier-name-large {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .stat-row {
            display: flex;
            gap: 30px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .score-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 12px;
        }
        
        .score-excellent { background: #d4edda; color: #155724; }
        .score-good { background: #d1ecf1; color: #0c5460; }
        .score-average { background: #fff3cd; color: #856404; }

      `}),e.jsxs("div",{className:"container mx-auto bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"header",children:[e.jsx("h1",{children:" Quotation Analysis & Comparison"}),e.jsx("p",{children:"Compare supplier quotations and select the best offer"})]}),e.jsxs("div",{className:"toolbar",children:[e.jsx("div",{className:"form-group",style:{maxWidth:"300px",margin:0},children:e.jsxs("select",{className:"form-control",value:t,onChange:k=>s(k.target.value),children:[e.jsx("option",{value:"",children:"Select RFQ"}),u.map(k=>e.jsxs("option",{value:k.rfq_no,children:[k.rfq_no," -"," ",k.description||k.status||"No Description"]},k.id))]})}),e.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-info",onClick:x,disabled:!t||n,children:n?"Loading...":" Generate Report"}),e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Back to Purchase"})]})]}),e.jsxs("div",{className:"form-content",children:[t&&e.jsxs("div",{className:"form-section",children:[e.jsx("div",{className:"section-title",children:" RFQ Details"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"RFQ Number"}),e.jsx("input",{type:"text",className:"form-control",value:S.rfq_no||"",readOnly:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"RFQ Date"}),e.jsx("input",{type:"text",className:"form-control",value:S.rfq_date?vh(new Date(S.rfq_date),"yyyy-MM-dd"):"",readOnly:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsx("input",{type:"text",className:"form-control",value:S.status||"",readOnly:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Expiry Date"}),e.jsx("input",{type:"text",className:"form-control",value:S.expiry_date?vh(new Date(S.expiry_date),"yyyy-MM-dd"):"",readOnly:!0})]})]})]}),l&&e.jsx("div",{className:"p-4 text-red-600 bg-red-50 rounded mb-4",children:l}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"info-card",children:e.jsxs("p",{children:[e.jsx("strong",{children:" Analysis Status:"})," Quotations loaded. Review the comparison below to make your selection."]})}),e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:`tab ${h==="comparison"?"active":""}`,onClick:()=>f("comparison"),children:" Price Comparison"}),e.jsx("button",{className:`tab ${h==="detailed"?"active":""}`,onClick:()=>f("detailed"),children:" Detailed Analysis"}),e.jsx("button",{className:`tab ${h==="scoring"?"active":""}`,onClick:()=>f("scoring"),children:" Scoring Matrix"})]}),h==="comparison"&&e.jsx("div",{className:"tab-content active",children:e.jsx("div",{className:"comparison-table-container",children:e.jsxs("table",{className:"comparison-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{minWidth:"250px"},children:"Item Details"}),g.map(k=>e.jsx("th",{className:"supplier-column",children:k},k))]})}),e.jsxs("tbody",{children:[c.items.map((k,P)=>{const I=b(k);return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("strong",{children:k.item_name}),e.jsx("br",{}),e.jsx("small",{style:{color:"#6c757d"},children:k.item_code}),e.jsx("br",{}),e.jsxs("small",{style:{color:"#6c757d"},children:["Qty: ",k.qty," ",k.uom||"Units"]})]}),g.map(B=>{const q=y(k,B);if(!q)return e.jsx("td",{children:"-"},B);const Q=q.unit_price===I;return e.jsxs("td",{className:`price-cell ${Q?"best-price":""}`,children:[e.jsxs("div",{style:{fontSize:"16px",marginBottom:"5px"},children:["$",q.unit_price.toFixed(2)]}),e.jsxs("div",{style:{color:"#6c757d",fontWeight:"normal",fontSize:"13px"},children:["Subtotal: $",q.total.toFixed(2)]}),e.jsxs("div",{style:{marginTop:"5px",color:"var(--primary)"},children:["Total: $",q.total.toFixed(2)]}),e.jsx("div",{style:{marginTop:"8px",fontSize:"12px",fontWeight:"normal"},children:e.jsxs("div",{style:{color:"#28a745"},children:[" ",q.delivery_days," days delivery"]})})]},B)})]},P)}),e.jsxs("tr",{style:{background:"var(--primary)",color:"white",fontWeight:700,fontSize:"15px"},children:[e.jsx("td",{children:"GRAND TOTAL"}),g.map(k=>e.jsxs("td",{children:["$",N(k).toLocaleString("en-US",{minimumFractionDigits:2})]},k))]})]})]})})}),h==="detailed"&&e.jsx("div",{className:"tab-content active",children:g.map((k,P)=>e.jsxs("div",{className:"supplier-info-card",children:[e.jsxs("div",{className:"supplier-header",children:[e.jsx("span",{className:"supplier-name-large",children:k}),e.jsx("span",{className:"score-badge score-good",children:"Score: TBD"})]}),e.jsxs("div",{className:"stat-row",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Total Quoted"}),e.jsxs("span",{className:"stat-value",children:["$",N(k).toLocaleString()]})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Status"}),e.jsx("span",{className:"stat-value",children:"Active"})]})]})]},P))}),h==="scoring"&&e.jsx("div",{className:"tab-content active",children:e.jsx("div",{className:"comparison-table-container",children:e.jsxs("table",{className:"comparison-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{minWidth:"250px"},children:"Criteria"}),e.jsx("th",{style:{width:"120px"},children:"Weight"}),g.map(k=>e.jsx("th",{className:"supplier-column",children:k},k))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Price Competitiveness"})}),e.jsx("td",{children:"40%"}),g.map(k=>e.jsx("td",{children:"-"},k))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Delivery Speed"})}),e.jsx("td",{children:"30%"}),g.map(k=>e.jsx("td",{children:"-"},k))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Quality / Specs"})}),e.jsx("td",{children:"20%"}),g.map(k=>e.jsx("td",{children:"-"},k))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Payment Terms"})}),e.jsx("td",{children:"10%"}),g.map(k=>e.jsx("td",{children:"-"},k))]}),e.jsxs("tr",{style:{background:"#f8f9fa",fontWeight:600},children:[e.jsx("td",{children:e.jsx("strong",{children:"TOTAL SCORE"})}),e.jsx("td",{children:"100%"}),g.map(k=>e.jsx("td",{children:"-"},k))]})]})]})})})]})]})]})]})}function rJ(){const[t,s]=v.useState(""),[r,a]=v.useState("ALL"),[n,i]=v.useState([]),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState(!1),[h,f]=v.useState(!1),[x,g]=v.useState(""),[b,y]=v.useState(null),[N,j]=v.useState([]),[S,k]=v.useState(null),[P,I]=v.useState(null),[B,q]=v.useState(null),[Q,O]=v.useState(!1),[T,V]=v.useState(null);v.useEffect(()=>{let W=!0;return o(!0),d(""),te.get("/purchase/orders").then(K=>{var F;if(!W)return;const _=Array.isArray((F=K.data)==null?void 0:F.items)?K.data.items:[];i(_.filter(E=>String(E.po_type||"").toUpperCase()==="LOCAL"))}).catch(K=>{var _,F;W&&d(((F=(_=K==null?void 0:K.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to load purchase orders")}).finally(()=>{W&&o(!1)}),()=>{W=!1}},[]);const D=W=>({DRAFT:"badge-warning",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-info",RECEIVED:"badge-success",RETURNED:"badge-error",CANCELLED:"badge-error"})[W]||"badge-info",Y=v.useMemo(()=>n.filter(W=>{const K=String(W.po_no||"").toLowerCase().includes(t.toLowerCase())||String(W.supplier_name||"").toLowerCase().includes(t.toLowerCase()),_=r==="ALL"||W.status===r;return K&&_}),[n,t,r]),M=async W=>{var K,_,F;if(V(W),m(!0),g(""),P)await X();else try{f(!0);const E=await te.get("/workflows"),L=Array.isArray((K=E.data)==null?void 0:K.items)?E.data.items:[];I(L),await R(L)}catch(E){g(((F=(_=E==null?void 0:E.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to load workflows")}finally{f(!1)}},X=async()=>{var F,E,L;if(!P||!P.length){y(null),k(null),g("");return}const W="/purchase/purchase-orders-local",K=U=>String(U||"").trim().toUpperCase().replace(/\s+/g,"_"),_=P.find(U=>Number(U.is_active)===1&&String(U.document_route)===W)||P.find(U=>Number(U.is_active)===1&&K(U.document_type)==="PURCHASE_ORDER")||null;if(y(_||null),k(null),!!_)try{f(!0);const J=(F=(await te.get(`/workflows/${_.id}`)).data)==null?void 0:F.item,ae=Array.isArray(J==null?void 0:J.steps)?J.steps:[];j(ae);const Z=ae[0]||null;if(k(Z?{userId:Z.approver_user_id,name:Z.approver_name,stepName:Z.step_name,stepOrder:Z.step_order,approvalLimit:Z.approval_limit}:null),Z){const oe=(Array.isArray(Z.approvers)&&Z.approvers.length?Z.approvers[0].id:Z.approver_user_id)||null;q(oe)}else q(null)}catch(U){g(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load workflow details")}finally{f(!1)}},R=async W=>{var E,L,U;if(!W||!W.length){y(null),k(null),g("");return}const K="/purchase/purchase-orders-local",_=J=>String(J||"").trim().toUpperCase().replace(/\s+/g,"_"),F=W.find(J=>Number(J.is_active)===1&&String(J.document_route)===K)||W.find(J=>Number(J.is_active)===1&&_(J.document_type)==="PURCHASE_ORDER")||null;if(y(F||null),k(null),!!F)try{f(!0);const ae=(E=(await te.get(`/workflows/${F.id}`)).data)==null?void 0:E.item,Z=Array.isArray(ae==null?void 0:ae.steps)?ae.steps:[];j(Z);const oe=Z[0]||null;if(k(oe?{userId:oe.approver_user_id,name:oe.approver_name,stepName:oe.step_name,stepOrder:oe.step_order,approvalLimit:oe.approval_limit}:null),oe){const ee=(Array.isArray(oe.approvers)&&oe.approvers.length?oe.approvers[0].id:oe.approver_user_id)||null;q(ee)}else q(null)}catch(J){g(((U=(L=J==null?void 0:J.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to load workflow details")}finally{f(!1)}},H=async()=>{var F,E,L;if(!T)return;const K=Array.isArray(N)&&N.length>0?N[0]:null,_=K?Array.isArray(K.approvers)&&K.approvers.length?K.approvers:K.approver_user_id?[{id:K.approver_user_id}]:[]:[];if(b&&_.length>0&&!B){g("Please select target approver");return}O(!0),g("");try{const U=await te.post(`/purchase/orders/${T.id}/submit`,{amount:T.total_amount===void 0||T.total_amount===null?null:Number(T.total_amount||0),workflow_id:b?b.id:null,target_user_id:B||null}),J=((F=U==null?void 0:U.data)==null?void 0:F.status)||"PENDING_APPROVAL";i(ae=>ae.map(Z=>Z.id===T.id?{...Z,status:J}:Z)),m(!1),V(null)}catch(U){g(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to forward for approval")}finally{O(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Purchase Orders - Local"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage local purchase orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/purchase-orders-local/new",className:"btn-success",children:"+ New Purchase Order"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by PO no or supplier...",className:"input",value:t,onChange:W=>s(W.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:W=>a(W.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"PENDING_APPROVAL",children:"Pending Approval"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"RECEIVED",children:"Received"}),e.jsx("option",{value:"RETURNED",children:"Returned"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"PO Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{className:"text-right",children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:u})}):null,Y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No purchase orders found"})}):Y.map(W=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:W.po_no}),e.jsx("td",{children:W.po_date?new Date(W.po_date).toLocaleDateString():""}),e.jsx("td",{children:W.supplier_name}),e.jsx("td",{className:"text-right font-medium",children:Number(W.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${D(W.status)}`,children:W.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/purchase/purchase-orders-local/${W.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),W.status==="DRAFT"&&e.jsx(Ee,{to:`/purchase/purchase-orders-local/${W.id}/edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"}),W.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):W.status==="DRAFT"||W.status==="RETURNED"?e.jsx("button",{type:"button",className:"text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",onClick:()=>M(W),children:"Forward for Approval"}):null]})})]},W.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",Y.length," of ",n.length," orders"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]}),c?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Purchase Order for Approval"}),e.jsx("button",{type:"button",onClick:()=>{m(!1),y(null),k(null),g(""),V(null)},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:(T==null?void 0:T.po_no)||""})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:h?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:x?e.jsx("div",{className:"text-sm text-red-600",children:x}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const K=Array.isArray(N)&&N.length>0?N[0]:null,_=K?Array.isArray(K.approvers)&&K.approvers.length?K.approvers.map(F=>({id:F.id,name:F.username})):K.approver_user_id?[{id:K.approver_user_id,name:K.approver_name||String(K.approver_user_id)}]:[]:[];return _.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:B||"",onChange:F=>q(F.target.value?Number(F.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),_.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{m(!1),y(null),k(null),g(""),V(null)},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:H,disabled:Q||!T||Array.isArray(N)&&N.length>0&&b&&!B,children:Q?"Forwarding...":"Forward"})]})]})}):null]})}function hb(){var He,ze;const{id:t}=Ps(),s=Ba(),r=Ns(),{user:a}=Qa(),n=!t||t==="new",i=!!t&&t!=="new"&&(s.pathname.includes("/edit")||(()=>{try{const Pe=new URLSearchParams(s.search||""),Te=String(Pe.get("mode")||"").toLowerCase(),Ke=String(Pe.get("edit")||"").toLowerCase();return Te==="edit"||Ke==="1"||Ke==="true"}catch{return!1}})()),[l,o]=v.useState(!1),[u,d]=v.useState(!1),[c,m]=v.useState(""),[h,f]=v.useState(!1),[x,g]=v.useState(!1),[b,y]=v.useState(""),[N,j]=v.useState(null),[S,k]=v.useState(null),[P,I]=v.useState([]),[B,q]=v.useState(!1),[Q,O]=v.useState(null),[T,V]=v.useState(null),[D,Y]=v.useState([]),[M,X]=v.useState([]),[R,H]=v.useState([]),[W,K]=v.useState([]),[_,F]=v.useState([]),[E,L]=v.useState([]),[U,J]=v.useState([]),[ae,Z]=v.useState([]),oe=v.useRef(null),[ee,se]=v.useState({po_no:"",po_date:new Date().toISOString().split("T")[0],supplier_id:"",quotation_id:"",po_type:"LOCAL",status:"DRAFT",warehouse_id:"",currency:"GHS",exchange_rate:1,delivery_date:"",payment_terms:30,remarks:"",port_loading:"",port_discharge:"",incoterms:"",hs_code:"",shipping_date:"",insurance_required:!1,freight_amount:0,other_charges:0,discount_amount:0,tax_amount:0,terms_conditions:`1. All goods must meet specified quality standards
2. Delivery to be made as per schedule
3. Payment terms: Net 30 days from delivery
4. Supplier responsible for any defects within warranty period
5. Late delivery penalties may apply as per agreement
6. All disputes subject to arbitration in Accra, Ghana`}),[Ae,we]=v.useState([{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]),[ce,le]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""}),{uoms:_e}=Po(),Qe=v.useMemo(()=>{const Pe=Array.isArray(_e)?_e:[],Te=Pe.find(Ke=>String(Ke.uom_code||"").toUpperCase()==="PCS")||Pe[0];return Te&&Te.uom_code?Te.uom_code:"PCS"},[_e]);v.useEffect(()=>{let Pe=!0;async function Te(){var Ke,$e,Ve,Ze,Re,it;try{const[lt,Ne,Xe,Ge]=await Promise.allSettled([te.get("/purchase/suppliers"),te.get("/inventory/warehouses"),te.get("/inventory/items"),te.get("/purchase/quotations")]);if(!Pe)return;if(lt.status==="fulfilled"&&Y(Array.isArray((Ke=lt.value.data)==null?void 0:Ke.items)?lt.value.data.items:[]),Ne.status==="fulfilled"&&X(Array.isArray(($e=Ne.value.data)==null?void 0:$e.items)?Ne.value.data.items:[]),Xe.status==="fulfilled"&&H(Array.isArray((Ve=Xe.value.data)==null?void 0:Ve.items)?Xe.value.data.items:[]),Ge.status==="fulfilled"){const at=Array.isArray((Ze=Ge.value.data)==null?void 0:Ze.items)?Ge.value.data.items:[];F(at);const xt=String(ee.supplier_id||""),wt=xt&&xt.length?at.filter(pt=>String(pt.supplier_id)===String(xt)):[];K(wt)}}catch(lt){if(!Pe)return;m(((it=(Re=lt==null?void 0:lt.response)==null?void 0:Re.data)==null?void 0:it.message)||"Failed to load lookups")}}return Te(),()=>{Pe=!1}},[]);const Ie=()=>{window.print()},ke=async()=>{const Pe=oe.current;if(!Pe)return;const Te=Pe.style.cssText;Pe.style.cssText=Te+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const Ke=await Wn(Pe,{scale:2,useCORS:!0}),$e=Ke.toDataURL("image/png"),Ve=new As("p","mm","a4"),Ze=Ve.internal.pageSize.getWidth(),Re=Ve.internal.pageSize.getHeight(),it=Ze,lt=Ke.height*it/Ke.width;let Ne=0;for(;Ne<lt;)Ve.addImage($e,"PNG",0,-Ne,it,lt),Ne+=Re,Ne<lt&&Ve.addPage();const Xe="PurchaseOrder_"+(ee.po_no||new Date().toISOString().slice(0,10))+".pdf";Ve.save(Xe)}finally{Pe.style.cssText=Te}};v.useEffect(()=>{let Pe=!0;async function Te(){var Ke;try{const $e=await te.get("/finance/currencies");if(!Pe)return;const Ve=Array.isArray((Ke=$e.data)==null?void 0:Ke.items)?$e.data.items:[];L(Ve)}catch{}}return Te(),()=>{Pe=!1}},[]),v.useEffect(()=>{async function Pe(){var Te;try{const Ke=Array.isArray(E)?E:[];if(!Ke.length)return;const $e=Ke.find(lt=>String(lt.is_base)==="1"||lt.is_base===1||lt.is_base===!0)||Ke.find(lt=>String(lt.code||lt.currency_code||"").toUpperCase()==="GHS")||Ke.find(lt=>/ghana|cedi/i.test(String(lt.name||lt.currency_name||""))),Ve=Ke.find(lt=>String(lt.code||lt.currency_code||"").toUpperCase()==="USD");if(!$e||!Ve||$e.id===Ve.id)return;const Ze=ee.po_date||new Date().toISOString().split("T")[0],Re=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Ve.id,toCurrencyId:$e.id,to:Ze}});if(!(Array.isArray((Te=Re.data)==null?void 0:Te.items)?Re.data.items:[]).length)try{await te.post("/finance/currency-rates",{fromCurrencyId:Ve.id,toCurrencyId:$e.id,rate:1,rateDate:Ze})}catch{}}catch{}}Pe()},[E,ee.po_date]),v.useEffect(()=>{let Pe=!0;async function Te(){var Ke;try{const $e=await te.get("/sales/prices/standard");if(!Pe)return;const Ve=Array.isArray((Ke=$e.data)==null?void 0:Ke.items)?$e.data.items:[];J(Ve)}catch{}}return Te(),()=>{Pe=!1}},[]),v.useEffect(()=>{let Pe=!0;async function Te(){var Ke;try{const $e=await te.get("/finance/tax-codes");if(!Pe)return;const Ze=(Array.isArray((Ke=$e.data)==null?void 0:Ke.items)?$e.data.items:[]).map(Re=>({value:Re.id,label:Re.name,rate:Number(Re.rate_percent)}));Z(Ze)}catch{}}return Te(),()=>{Pe=!1}},[]);const pe=async Pe=>{var Ze;const Te=String(Pe||"").toUpperCase(),Ke=Array.isArray(E)?E:[];if(!Te||!Ke.length)return;const $e=Ke.find(Re=>String(Re.is_base)==="1"||Re.is_base===1||Re.is_base===!0)||Ke.find(Re=>String(Re.code||Re.currency_code||"").toUpperCase()==="GHS")||Ke.find(Re=>/ghana|cedi/i.test(String(Re.name||Re.currency_name||""))),Ve=Ke.find(Re=>String(Re.code||Re.currency_code||"").toUpperCase()===Te);if(!$e||!Ve||$e.id===Ve.id){se(Re=>({...Re,exchange_rate:1}));return}try{const Re=ee.po_date||new Date().toISOString().split("T")[0],it=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Ve.id,toCurrencyId:$e.id,to:Re}}),Ne=(Array.isArray((Ze=it.data)==null?void 0:Ze.items)?it.data.items:[])[0];if(Ne&&Ne.rate)se(Xe=>({...Xe,exchange_rate:Number(Ne.rate)||Xe.exchange_rate||1}));else try{await te.post("/finance/currency-rates",{fromCurrencyId:Ve.id,toCurrencyId:$e.id,rate:1,rateDate:Re}),se(Xe=>({...Xe,exchange_rate:1}))}catch{se(Xe=>({...Xe,exchange_rate:1}))}}catch{}};v.useEffect(()=>{pe(ee.currency)},[E,ee.currency,ee.po_date]),v.useEffect(()=>{if(i)return;let Pe=!0;return te.get("/purchase/orders/next-no",{params:{po_type:ee.po_type||"LOCAL"}}).then(Te=>{var Ke;if(Pe&&(Ke=Te.data)!=null&&Ke.nextNo){const $e=String(Te.data.nextNo||""),Ve=$e.replace(/^PO-/i,"LP-"),Ze=Ve.toUpperCase().startsWith("LP-")?Ve:`LP-${$e.replace(/^LP-/i,"")}`;se(Re=>({...Re,po_no:Re.po_no||Ze}))}}).catch(Te=>console.error("Failed to load next purchase order number",Te)),()=>{Pe=!1}},[i,ee.po_type]),v.useEffect(()=>{he()},[]);async function he(){var Pe,Te,Ke;try{const Ve=(Te=(Pe=(await te.get("/admin/me")).data)==null?void 0:Pe.scope)==null?void 0:Te.companyId;if(Ve){const Re=((Ke=(await te.get(`/admin/companies/${Ve}`)).data)==null?void 0:Ke.item)||{};le(it=>({...it,name:Re.name||it.name||"",address:Re.address||it.address||"",phone:Re.telephone||it.phone||"",email:Re.email||it.email||"",city:Re.city||it.city||"",state:Re.state||it.state||"",country:Re.country||it.country||"",logoUrl:Re.has_logo===1||Re.has_logo===!0?`/api/admin/companies/${Ve}/logo`:Gs}))}else le(Ze=>({...Ze,logoUrl:Ze.logoUrl||Gs}))}catch{le($e=>({...$e,logoUrl:$e.logoUrl||Gs}))}}v.useEffect(()=>{if(n)return;let Pe=!0;return o(!0),m(""),te.get(`/purchase/orders/${t}`).then(Te=>{var Ve,Ze,Re;if(!Pe)return;const Ke=(Ve=Te.data)==null?void 0:Ve.item,$e=Array.isArray((Re=(Ze=Te.data)==null?void 0:Ze.item)==null?void 0:Re.details)?Te.data.item.details:[];Ke&&(se({po_no:Ke.po_no||"",po_date:Ke.po_date||new Date().toISOString().split("T")[0],supplier_id:Ke.supplier_id?String(Ke.supplier_id):"",po_type:Ke.po_type||"LOCAL",status:Ke.status||"DRAFT",warehouse_id:Ke.warehouse_id?String(Ke.warehouse_id):"",currency:Ke.currency||"GHS",exchange_rate:Number(Ke.exchange_rate)||1,delivery_date:Ke.delivery_date||"",payment_terms:Ke.payment_terms||30,remarks:Ke.remarks||"",port_loading:Ke.port_loading||"",port_discharge:Ke.port_discharge||"",incoterms:Ke.incoterms||"",hs_code:Ke.hs_code||"",shipping_date:Ke.shipping_date||"",insurance_required:!!Ke.insurance_required,freight_amount:Number(Ke.freight_amount)||0,other_charges:Number(Ke.other_charges)||0,discount_amount:Number(Ke.discount_amount)||0,tax_amount:Number(Ke.tax_amount)||0,terms_conditions:Ke.terms_conditions||ee.terms_conditions}),we($e.length?$e.filter(it=>it).map(it=>({item_id:it.item_id?String(it.item_id):"",qty:Number(it.qty)||0,uom:it.uom||"",unit_price:Number(it.unit_price)||0,discount_percent:Number(it.discount_percent)||0,tax_percent:Number(it.tax_percent)||0,line_total:Number(it.line_total)||0})):[{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]))}).catch(Te=>{var Ke,$e;Pe&&m((($e=(Ke=Te==null?void 0:Te.response)==null?void 0:Ke.data)==null?void 0:$e.message)||"Failed to load purchase order")}).finally(()=>{Pe&&o(!1)}),()=>{Pe=!1}},[t]);const je=v.useMemo(()=>{let Pe=0,Te=0,Ke=0;Ae.forEach(Re=>{if(!Re)return;const it=Number(Re.qty)||0,lt=Number(Re.unit_price)||0,Ne=Number(Re.discount_percent)||0,Xe=Number(Re.tax_percent)||0,Ge=it*lt,at=Ge*(Ne/100),wt=(Ge-at)*(Xe/100);Pe+=Ge,Te+=at,Ke+=wt});const $e=Number(ee.freight_amount)||0,Ve=Number(ee.other_charges)||0,Ze=Pe-Te+Ke+$e+Ve;return{subTotal:Pe,totalDiscount:Te,totalTax:Ke,freight:$e,other:Ve,grandTotal:Ze}},[Ae,ee.freight_amount,ee.other_charges]),me=async Pe=>{var Ze,Re;const{name:Te,value:Ke,type:$e,checked:Ve}=Pe.target;if(se(it=>({...it,[Te]:$e==="checkbox"?Ve:Ke})),Te==="supplier_id"){const it=String(Ke||"");if(it){const lt=(Array.isArray(_)?_:[]).filter(Ne=>String(Ne.supplier_id)===it);K(lt),se(Ne=>{const Xe=lt.some(Ge=>String(Ge.id)===String(Ne.quotation_id||""));return{...Ne,quotation_id:Xe?Ne.quotation_id:""}});try{const Ne=D.find(Ge=>String(Ge.id)===it),Xe=Ne&&Ne.supplier_code&&String(Ne.supplier_code).trim()||(Ne?`SU-${String(Number(Ne.id||0)).padStart(6,"0")}`:"");if(Xe){const Ge=await te.get("/finance/accounts",{params:{search:Xe}}),at=Array.isArray((Ze=Ge.data)==null?void 0:Ze.items)?Ge.data.items:[],xt=at.find(pt=>String(pt.code)===Xe)||at[0]||null,wt=xt&&(xt.currency_code||xt.currency||xt.currencyCode)||null;if(wt){const pt=String(wt).toUpperCase();se(ge=>({...ge,currency:pt})),await pe(pt)}}}catch{}}else K(Array.isArray(_)?_:[])}if(Te==="quotation_id"&&Ke)try{const lt=(Re=(await te.get(`/purchase/quotations/${Ke}`)).data)==null?void 0:Re.item;if(lt){const Xe=(Array.isArray(E)?E:[]).find(wt=>String(wt.id)===String(lt.currency_id||"")),Ge=String((Xe==null?void 0:Xe.code)||(Xe==null?void 0:Xe.currency_code)||lt.currency_code||lt.currency||"").toUpperCase()||ee.currency,xt=new Set(["USD","EUR","GBP"]).has(Ge)?Ge:ee.currency;if(se(wt=>({...wt,supplier_id:lt.supplier_id?String(lt.supplier_id):wt.supplier_id,currency:xt,exchange_rate:lt.exchange_rate!==void 0&&lt.exchange_rate!==null?Number(lt.exchange_rate)||wt.exchange_rate||1:wt.exchange_rate,delivery_date:lt.valid_until||wt.delivery_date||"",remarks:lt.remarks||wt.remarks||""})),lt.exchange_rate!==void 0&&lt.exchange_rate!==null||await pe(xt),lt.details){const wt=lt.details.map(pt=>({item_id:String(pt.item_id),qty:Number(pt.qty)||0,uom:pt.uom||Qe,unit_price:Number(pt.unit_price)||0,discount_percent:Number(pt.discount_percent)||0,tax_percent:0,line_total:Number(pt.line_total)||0}));we(wt)}}}catch(it){console.error("Failed to fetch quotation details",it)}Te==="currency"&&await pe(Ke)},xe=(Pe,Te,Ke)=>{const $e=[...Ae];if($e[Pe]={...$e[Pe],[Te]:Ke},Te==="item_id"){const at=R.find(ge=>String(ge.id)===String(Ke)),xt=(at==null?void 0:at.uom)||Qe;$e[Pe].uom=xt;let pt=at&&Number(at.cost_price)||0;if(Array.isArray(U)&&U.length){const ge=U.filter(rt=>String(rt.product_id)===String(Ke)).sort((rt,ht)=>{const ft=rt.effective_date?new Date(rt.effective_date).getTime():0;return(ht.effective_date?new Date(ht.effective_date).getTime():0)-ft||new Date(ht.created_at).getTime()-new Date(rt.created_at).getTime()});ge.length>0&&(pt=Number(ge[0].cost_price)||pt)}$e[Pe].unit_price=pt}const Ve=Number($e[Pe].qty)||0,Ze=Number($e[Pe].unit_price)||0,Re=Number($e[Pe].discount_percent)||0,it=Number($e[Pe].tax_percent)||0,lt=Ve*Ze,Ne=lt*(Re/100),Xe=lt-Ne,Ge=Xe*(it/100);$e[Pe].line_total=Xe+Ge,we($e)},Ue=()=>{we(Pe=>[...Pe,{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}])},ct=Pe=>{we(Te=>Te.length>1?Te.filter((Ke,$e)=>$e!==Pe):Te)},dt=async Pe=>{var Te,Ke,$e,Ve,Ze,Re,it,lt,Ne,Xe,Ge,at,xt;Pe.preventDefault(),d(!0),m("");try{const wt=($e=(Ke=(Te=Pe==null?void 0:Pe.nativeEvent)==null?void 0:Te.submitter)==null?void 0:Ke.dataset)==null?void 0:$e.submitType,pt=wt==="pending"?"PENDING_APPROVAL":wt==="draft"?"DRAFT":ee.status||"DRAFT";if(!ee.supplier_id){m("Supplier is required"),d(!1);return}const ge=Ae.filter(St=>St.item_id&&Number(St.qty)>0&&Number(St.unit_price)>0);if(ge.length===0){m("At least one item with quantity and unit price is required"),d(!1);return}const rt=String(ee.po_no||""),ft={po_no:rt.toUpperCase().startsWith("LP-")?rt:rt.replace(/^PO-/i,"LP-")||(rt.length?`LP-${rt.replace(/^LP-/i,"")}`:""),po_date:ee.po_date,po_type:"LOCAL",status:pt,supplier_id:Number(ee.supplier_id),warehouse_id:Number(ee.warehouse_id)||null,currency:ee.currency,exchange_rate:Number(ee.exchange_rate)||1,delivery_date:ee.delivery_date||"",payment_terms:Number(ee.payment_terms)||0,remarks:ee.remarks||"",port_loading:ee.port_loading||"",port_discharge:ee.port_discharge||"",incoterms:ee.incoterms||"",hs_code:ee.hs_code||"",shipping_date:ee.shipping_date||"",insurance_required:!!ee.insurance_required,freight_amount:Number(ee.freight_amount)||0,other_charges:Number(ee.other_charges)||0,discount_amount:je.totalDiscount,tax_amount:je.totalTax,total_amount:je.grandTotal,terms_conditions:ee.terms_conditions||"",quotation_id:ee.quotation_id?Number(ee.quotation_id):void 0,details:ge.map(St=>({item_id:Number(St.item_id),qty:Number(St.qty)||0,uom:St.uom||"",unit_price:Number(St.unit_price)||0,discount_percent:Number(St.discount_percent)||0,tax_percent:Number(St.tax_percent)||0,line_total:Number(St.line_total)||0}))};if(wt==="pending"){if(i){await te.post(`/purchase/orders/${t}/submit`,{amount:je.grandTotal??null,workflow_id:N?N.id:null,target_user_id:T||null});const St=await te.get(`/purchase/orders/${t}`),Je=(Ve=St.data)==null?void 0:Ve.item,ts=Array.isArray((Re=(Ze=St.data)==null?void 0:Ze.item)==null?void 0:Re.details)?St.data.item.details:[];Je&&(se({po_no:Je.po_no||"",po_date:Je.po_date||new Date().toISOString().split("T")[0],supplier_id:Je.supplier_id?String(Je.supplier_id):"",po_type:Je.po_type||"LOCAL",status:Je.status||"DRAFT",warehouse_id:Je.warehouse_id?String(Je.warehouse_id):"",currency:Je.currency||"GHS",exchange_rate:Number(Je.exchange_rate)||1,delivery_date:Je.delivery_date||"",payment_terms:Je.payment_terms||30,remarks:Je.remarks||"",port_loading:Je.port_loading||"",port_discharge:Je.port_discharge||"",incoterms:Je.incoterms||"",hs_code:Je.hs_code||"",shipping_date:Je.shipping_date||"",insurance_required:!!Je.insurance_required,freight_amount:Number(Je.freight_amount)||0,other_charges:Number(Je.other_charges)||0}),we(ts.map(Kt=>({item_id:Kt.item_id?String(Kt.item_id):"",qty:Number(Kt.qty)||Number(Kt.qty_ordered)||0,uom:Kt.uom||Qe||"",unit_price:Number(Kt.unit_price)||0,discount_percent:Number(Kt.discount_percent)||0,tax_percent:Number(Kt.tax_percent)||0,line_total:Number(Kt.line_total)||Number(Kt.amount)||0}))))}else{const St=await te.post("/purchase/orders",ft),Je=(it=St==null?void 0:St.data)==null?void 0:it.id;Je&&(await te.post(`/purchase/orders/${Je}/submit`,{amount:je.grandTotal??null,workflow_id:N?N.id:null,target_user_id:T||null}),r(`/purchase/purchase-orders-local/${Je}/edit`))}return}if(i){await te.put(`/purchase/orders/${t}/status`,{status:pt});const St=await te.get(`/purchase/orders/${t}`),Je=(lt=St.data)==null?void 0:lt.item,ts=Array.isArray((Xe=(Ne=St.data)==null?void 0:Ne.item)==null?void 0:Xe.details)?St.data.item.details:[];Je&&(se({po_no:Je.po_no||"",po_date:Je.po_date||new Date().toISOString().split("T")[0],supplier_id:Je.supplier_id?String(Je.supplier_id):"",po_type:Je.po_type||"LOCAL",status:Je.status||"DRAFT",warehouse_id:Je.warehouse_id?String(Je.warehouse_id):"",currency:Je.currency||"GHS",exchange_rate:Number(Je.exchange_rate)||1,delivery_date:Je.delivery_date||"",payment_terms:Je.payment_terms||30,remarks:Je.remarks||"",port_loading:Je.port_loading||"",port_discharge:Je.port_discharge||"",incoterms:Je.incoterms||"",hs_code:Je.hs_code||"",shipping_date:Je.shipping_date||"",insurance_required:!!Je.insurance_required,freight_amount:Number(Je.freight_amount)||0,other_charges:Number(Je.other_charges)||0}),we(ts.map(Kt=>({item_id:Kt.item_id?String(Kt.item_id):"",qty:Number(Kt.qty)||Number(Kt.qty_ordered)||0,uom:Kt.uom||Qe||"",unit_price:Number(Kt.unit_price)||0,discount_percent:Number(Kt.discount_percent)||0,tax_percent:Number(Kt.tax_percent)||0,line_total:Number(Kt.line_total)||Number(Kt.amount)||0}))))}else{const St=await te.post("/purchase/orders",ft),Je=(Ge=St==null?void 0:St.data)==null?void 0:Ge.id;Je&&pt!=="DRAFT"?(await te.put(`/purchase/orders/${Je}/status`,{status:pt}),r(`/purchase/purchase-orders-local/${Je}/edit`)):Je&&r(`/purchase/purchase-orders-local/${Je}/edit`)}}catch(wt){const pt=((xt=(at=wt==null?void 0:wt.response)==null?void 0:at.data)==null?void 0:xt.message)||(wt==null?void 0:wt.message)||"Error saving purchase order. Please try again.";m(pt)}finally{d(!1)}},We=async()=>{var Pe,Te,Ke;if(!n){q(!0),y("");try{const $e=await te.post(`/purchase/orders/${t}/submit`,{amount:je.grandTotal??null,workflow_id:N?N.id:null,target_user_id:T||null}),Ve=((Pe=$e==null?void 0:$e.data)==null?void 0:Pe.status)||"PENDING_APPROVAL";se(Ze=>({...Ze,status:Ve})),f(!1)}catch($e){y(((Ke=(Te=$e==null?void 0:$e.response)==null?void 0:Te.data)==null?void 0:Ke.message)||"Failed to forward for approval")}finally{q(!1)}}};return console.log("Rendering PurchaseOrdersLocalForm",{id:t,isNew:n,isEdit:i}),e.jsxs("div",{className:"w-full pb-10",children:[e.jsx("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:ce.logoUrl||Gs,alt:ce.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:ce.name||"Company"}),ce.address&&e.jsx("div",{children:ce.address}),(ce.city||ce.state||ce.country)&&e.jsx("div",{children:[ce.city,ce.state,ce.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[ce.phone&&e.jsx("span",{children:ce.phone}),ce.email&&e.jsx("span",{children:ce.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",ee.po_date||""]}),e.jsxs("div",{children:["PO #: ",ee.po_no||""]})]})]})}),e.jsxs("div",{ref:oe,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:ce.logoUrl||Gs,alt:ce.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:ce.name||"Company"}),ce.address&&e.jsx("div",{children:ce.address}),(ce.city||ce.state||ce.country)&&e.jsx("div",{children:[ce.city,ce.state,ce.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[ce.phone&&e.jsx("span",{children:ce.phone}),ce.email&&e.jsx("span",{children:ce.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",ee.po_date||""]}),e.jsxs("div",{children:["PO #: ",ee.po_no||""]}),e.jsxs("div",{children:["Supplier:"," ",((He=D.find(Pe=>String(Pe.id)===String(ee.supplier_id)))==null?void 0:He.supplier_name)||((ze=D.find(Pe=>String(Pe.id)===String(ee.supplier_id)))==null?void 0:ze.name)||""]}),e.jsxs("div",{children:["Currency: ",ee.currency||""]}),e.jsxs("div",{children:["Exchange Rate: ",Number(ee.exchange_rate||1).toFixed(2)]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Net Amount"})]})}),e.jsx("tbody",{children:Ae.map((Pe,Te)=>{const Ke=R.find(Ve=>String(Ve.id)===String(Pe.item_id)),$e=(Ke==null?void 0:Ke.item_name)||(Ke==null?void 0:Ke.item_code)||"Item";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:$e}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Pe.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Pe.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Pe.line_total||0).toFixed(2)})]},Te)})}),e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Subtotal"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(je.subTotal||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Discount"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(je.totalDiscount||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Tax"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(je.totalTax||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Freight"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(je.freight||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Other Charges"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(je.other||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Grand Total"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(je.grandTotal||0).toFixed(2)})]})]})]})})]}),e.jsxs("div",{className:"w-full bg-white rounded-xl shadow-[0_4px_20px_rgba(14,54,70,0.15)] overflow-hidden",children:[e.jsxs("div",{className:"bg-[#0E3646] text-white p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:" Purchase Order"}),e.jsx("p",{className:"opacity-90",children:"Create local and import purchase orders"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center p-5 bg-[#f8f9fa] border-b border-[#dee2e6] gap-4",children:[e.jsx("div",{className:"flex bg-[#f8f9fa] p-1 rounded-md border border-[#dee2e6]",children:e.jsx("button",{type:"button",className:`px-5 py-2.5 rounded text-sm font-semibold transition-all ${ee.po_type==="LOCAL"?"bg-[#0E3646] text-white":"text-gray-500 hover:bg-gray-200"}`,onClick:()=>se({...ee,po_type:"LOCAL"}),children:" Local Order"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ee,{to:"/purchase/purchase-orders-local",className:"btn btn-secondary font-medium flex items-center gap-2",children:" View Orders"}),e.jsxs("button",{type:"button",onClick:ke,className:"btn-outline font-medium flex items-center gap-2",children:[e.jsx(gu,{className:"w-4 h-4"}),"Download PDF"]}),e.jsxs("button",{type:"button",onClick:Ie,className:"btn-primary font-medium flex items-center gap-2",children:[e.jsx(Mh,{className:"w-4 h-4"}),"Print"]})]})]}),e.jsxs("div",{className:"p-8",children:[l&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),c&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded mb-6 border border-red-200",children:c}),e.jsxs("form",{onSubmit:dt,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Purchase Order Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Number"}),e.jsx("input",{type:"text",name:"po_no",value:ee.po_no,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10 bg-[#e9ecef] cursor-not-allowed",readOnly:!0,placeholder:"Auto-generated"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Date"}),e.jsx("input",{type:"date",name:"po_date",value:ee.po_date,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Order Type"}),e.jsx("input",{type:"text",value:ee.po_type,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm bg-[#e9ecef]",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Status"}),e.jsx("div",{children:e.jsx("span",{className:"px-4 py-1.5 rounded-full text-xs font-bold bg-[#e9ecef] text-[#495057]",children:ee.status})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Supplier"}),e.jsxs("select",{name:"supplier_id",value:ee.supplier_id,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),Array.isArray(D)&&D.map(Pe=>Pe&&e.jsx("option",{value:Pe.id,children:Pe.supplier_name||Pe.name||"Unknown Supplier"},Pe.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Reference Quotation"}),e.jsxs("select",{name:"quotation_id",value:ee.quotation_id,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Quotation"}),Array.isArray(W)&&W.map(Pe=>Pe&&e.jsxs("option",{value:Pe.id,children:[Pe.quotation_no," - ",Pe.supplier_name]},Pe.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:ee.warehouse_id,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),Array.isArray(M)&&M.map(Pe=>Pe&&e.jsx("option",{value:Pe.id,children:Pe.warehouse_name||Pe.name||"Unknown Warehouse"},Pe.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Currency"}),e.jsxs("select",{name:"currency",value:ee.currency,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"GHS",children:"GHS - Ghana Cedi"}),e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Exchange Rate"}),e.jsx("input",{type:"number",name:"exchange_rate",value:ee.exchange_rate,onChange:me,step:"0.0001",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Expected Delivery Date"}),e.jsx("input",{type:"date",name:"delivery_date",value:ee.delivery_date,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",name:"payment_terms",value:ee.payment_terms,onChange:me,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646]",children:" Order Items"}),e.jsx("button",{type:"button",onClick:Ue,className:"px-4 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all text-sm font-medium flex items-center gap-2",children:" Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-[#0E3646] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-[13px] w-[50px]",children:"#"}),e.jsx("th",{className:"p-3 text-left text-[13px]",children:"Item Name"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Qty"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"UOM"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"Unit Price"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Disc %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Tax %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[150px]",children:"Net Amount"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[80px]",children:"Action"})]})}),e.jsx("tbody",{children:Ae.map((Pe,Te)=>Pe&&e.jsxs("tr",{className:"border-b border-[#dee2e6] hover:bg-[#0E3646]/5 transition-colors",children:[e.jsx("td",{className:"p-3 text-sm",children:Te+1}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:Pe.item_id,onChange:Ke=>xe(Te,"item_id",Ke.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm focus:outline-none focus:border-[#0E3646]",required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),Array.isArray(R)&&R.map(Ke=>Ke&&e.jsx("option",{value:Ke.id,children:Ke.item_name||Ke.item_code||"Unknown Item"},Ke.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Pe.qty,onChange:Ke=>xe(Te,"qty",Ke.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:Pe.uom||Qe||"",onChange:Ke=>xe(Te,"uom",Ke.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-center focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select UOM"}),Array.isArray(_e)&&_e.map(Ke=>Ke&&e.jsx("option",{value:Ke.uom_code,children:Ke.uom_name?`${Ke.uom_name} (${Ke.uom_code})`:Ke.uom_code},Ke.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Pe.unit_price,onChange:Ke=>xe(Te,"unit_price",Ke.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Pe.discount_percent,onChange:Ke=>xe(Te,"discount_percent",Ke.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",max:"100",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:(()=>{const Ke=ae.find($e=>Number($e.rate)===Number(Pe.tax_percent||0));return Ke?Ke.value:""})(),onChange:Ke=>{const $e=Ke.target.value,Ve=ae.find(Re=>String(Re.value)===String($e)),Ze=Ve?Ve.rate:0;xe(Te,"tax_percent",Ze)},className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"No Tax"}),ae.map(Ke=>e.jsx("option",{value:Ke.value,children:Ke.label},Ke.value))]})}),e.jsxs("td",{className:"p-3 text-right font-medium text-sm",children:[ee.currency," ",Pe.line_total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>ct(Te),className:"text-[#dc3545] hover:bg-[#dc3545]/10 p-1.5 rounded transition-colors",children:""})})]},Te))})]})}),e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg mt-5 border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Items:"}),e.jsx("span",{className:"font-bold",children:Ae.filter(Pe=>Pe&&Pe.item_id).length})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sub Total:"}),e.jsxs("span",{className:"font-bold",children:[ee.currency," ",je.subTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#dc3545]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Discount:"}),e.jsxs("span",{className:"font-bold",children:["-",ee.currency," ",je.totalDiscount.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#0E3646]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tax Amount:"}),e.jsxs("span",{className:"font-bold",children:[ee.currency," ",je.totalTax.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Freight Charges:"}),e.jsx("input",{type:"number",name:"freight_amount",value:ee.freight_amount,onChange:me,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Other Charges:"}),e.jsx("input",{type:"number",name:"other_charges",value:ee.other_charges,onChange:me,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-3 text-lg font-bold text-[#0E3646]",children:[e.jsx("span",{children:"GRAND TOTAL:"}),e.jsxs("span",{children:[ee.currency," ",je.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Terms & Conditions"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("textarea",{name:"terms_conditions",value:ee.terms_conditions,onChange:me,rows:"6",className:"p-3 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",placeholder:"Enter terms and conditions..."})})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-8 gap-4",children:[e.jsx("div",{children:e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#dc3545] text-white rounded hover:bg-[#c82333] transition-all font-medium flex items-center gap-2",onClick:()=>alert("Delete functionality not implemented yet"),children:" Delete"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#6c757d] text-white rounded hover:bg-[#5a6268] transition-all font-medium flex items-center gap-2",onClick:()=>se({...ee,remarks:""}),children:" Clear"}),e.jsx("button",{type:"submit",disabled:u,"data-submit-type":"draft",className:"px-5 py-2.5 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:u?"Saving...":" Save as Draft"}),e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#17a2b8] text-white rounded hover:bg-[#138496] transition-all font-medium flex items-center gap-2",onClick:()=>window.print(),children:" Print"}),e.jsx("button",{type:"submit",disabled:u,"data-submit-type":"pending",className:"px-5 py-2.5 bg-[#28a745] text-white rounded hover:bg-[#218838] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:" Submit for Approval"})]})]})]})]})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{f(!1),j(null),k(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:ee.po_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:N?`${N.workflow_name} (${N.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:x?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Te=Array.isArray(P)&&P.length>0?P[0]:null,Ke=Te?Array.isArray(Te.approvers)&&Te.approvers.length?Te.approvers.map($e=>({id:$e.id,name:$e.username})):Te.approver_user_id?[{id:Te.approver_user_id,name:Te.approver_name||String(Te.approver_user_id)}]:[]:[];return Ke.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:T||"",onChange:$e=>V($e.target.value?Number($e.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Ke.map($e=>e.jsx("option",{value:$e.id,children:$e.name},$e.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:N?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{f(!1),j(null),k(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:We,disabled:B||n,children:B?"Forwarding...":"Forward"})]})]})})]})}function aJ(){const[t,s]=v.useState(""),[r,a]=v.useState("ALL"),[n,i]=v.useState([]),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState(!1),[h,f]=v.useState(null),[x,g]=v.useState(!1),[b,y]=v.useState(""),[N,j]=v.useState(null),[S,k]=v.useState(null),[P,I]=v.useState([]),[B,q]=v.useState(!1),[Q,O]=v.useState(null),[T,V]=v.useState(null);v.useEffect(()=>{let W=!0;return o(!0),d(""),te.get("/purchase/orders").then(K=>{var F;if(!W)return;const _=Array.isArray((F=K.data)==null?void 0:F.items)?K.data.items:[];i(_.filter(E=>String(E.po_type||"").toUpperCase()==="IMPORT"))}).catch(K=>{var _,F;W&&d(((F=(_=K==null?void 0:K.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to load purchase orders")}).finally(()=>{W&&o(!1)}),()=>{W=!1}},[]);const D=W=>({DRAFT:"badge-warning",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-info",RECEIVED:"badge-success",RETURNED:"badge-error",CANCELLED:"badge-error"})[W]||"badge-info",Y=v.useMemo(()=>n.filter(W=>{const K=String(W.po_no||"").toLowerCase().includes(t.toLowerCase())||String(W.supplier_name||"").toLowerCase().includes(t.toLowerCase()),_=r==="ALL"||W.status===r;return K&&_}),[n,t,r]),M=async W=>{var K,_,F;if(f(W),m(!0),y(""),Q)await X();else try{g(!0);const E=await te.get("/workflows"),L=Array.isArray((K=E.data)==null?void 0:K.items)?E.data.items:[];O(L),await R(L)}catch(E){y(((F=(_=E==null?void 0:E.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to load workflows")}finally{g(!1)}},X=async()=>{var F,E,L;if(!Q||!Q.length){j(null),k(null),y("");return}const W="/purchase/purchase-orders-import",K=U=>String(U||"").trim().toUpperCase().replace(/\s+/g,"_"),_=Q.find(U=>Number(U.is_active)===1&&String(U.document_route)===W)||Q.find(U=>Number(U.is_active)===1&&K(U.document_type)==="PURCHASE_ORDER")||null;if(j(_||null),k(null),!!_)try{g(!0);const J=(F=(await te.get(`/workflows/${_.id}`)).data)==null?void 0:F.item,ae=Array.isArray(J==null?void 0:J.steps)?J.steps:[];I(ae);const Z=ae[0]||null;if(k(Z?{userId:Z.approver_user_id,name:Z.approver_name,stepName:Z.step_name,stepOrder:Z.step_order,approvalLimit:Z.approval_limit}:null),Z){const oe=(Array.isArray(Z.approvers)&&Z.approvers.length?Z.approvers[0].id:Z.approver_user_id)||null;V(oe)}else V(null)}catch(U){y(((L=(E=U==null?void 0:U.response)==null?void 0:E.data)==null?void 0:L.message)||"Failed to load workflow details")}finally{g(!1)}},R=async W=>{var E,L,U;if(!W||!W.length){j(null),k(null),y("");return}const K="/purchase/purchase-orders-import",_=J=>String(J||"").trim().toUpperCase().replace(/\s+/g,"_"),F=W.find(J=>Number(J.is_active)===1&&String(J.document_route)===K)||W.find(J=>Number(J.is_active)===1&&_(J.document_type)==="PURCHASE_ORDER")||null;if(j(F||null),k(null),!!F)try{g(!0);const ae=(E=(await te.get(`/workflows/${F.id}`)).data)==null?void 0:E.item,Z=Array.isArray(ae==null?void 0:ae.steps)?ae.steps:[];I(Z);const oe=Z[0]||null;k(oe?{userId:oe.approver_user_id,name:oe.approver_name,stepName:oe.step_name,stepOrder:oe.step_order,approvalLimit:oe.approval_limit}:null)}catch(J){y(((U=(L=J==null?void 0:J.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to load workflow details")}finally{g(!1)}},H=async()=>{var W,K,_;if(h){q(!0),y("");try{const F=await te.post(`/purchase/orders/${h.id}/submit`,{amount:(h==null?void 0:h.total_amount)??null,workflow_id:N?N.id:null,target_user_id:T||null}),E=((W=F==null?void 0:F.data)==null?void 0:W.status)||"PENDING_APPROVAL";i(L=>L.map(U=>U.id===h.id?{...U,status:E}:U)),m(!1),f(null)}catch(F){y(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to forward for approval")}finally{q(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Purchase Orders - Import"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage import purchase orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/purchase-orders-import/new",className:"btn-success",children:"+ New Purchase Order"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by PO no or supplier...",className:"input",value:t,onChange:W=>s(W.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:W=>a(W.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"RECEIVED",children:"Received"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"PO Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{className:"text-right",children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:u})}):null,Y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No purchase orders found"})}):Y.map(W=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:W.po_no}),e.jsx("td",{children:W.po_date?new Date(W.po_date).toLocaleDateString():""}),e.jsx("td",{children:W.supplier_name}),e.jsx("td",{className:"text-right font-medium",children:Number(W.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${D(W.status)}`,children:W.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/purchase/purchase-orders-import/${W.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),W.status==="DRAFT"?e.jsx(Ee,{to:`/purchase/purchase-orders-import/${W.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"}):null,W.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):W.status==="DRAFT"||W.status==="RETURNED"?e.jsx("button",{type:"button",onClick:()=>M(W),className:"text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",children:"Forward for Approval"}):null]})})]},W.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",Y.length," of ",n.length," orders"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{m(!1),f(null),j(null),k(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:h==null?void 0:h.po_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:N?`${N.workflow_name} (${N.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:x?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const K=Array.isArray(P)&&P.length>0?P[0]:null,_=K?Array.isArray(K.approvers)&&K.approvers.length?K.approvers.map(F=>({id:F.id,name:F.username})):K.approver_user_id?[{id:K.approver_user_id,name:K.approver_name||String(K.approver_user_id)}]:[]:[];return _.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:T||"",onChange:F=>V(F.target.value?Number(F.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),_.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:N?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{m(!1),f(null),j(null),k(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:H,disabled:B,children:B?"Forwarding...":"Forward"})]})]})})]})}function mb(){var ze,Pe;const{id:t}=Ps(),s=Ba(),r=Ns(),{user:a}=Qa(),n=!t||t==="new",i=!!t&&t!=="new"&&(s.pathname.includes("/edit")||(()=>{try{const Te=new URLSearchParams(s.search||""),Ke=String(Te.get("mode")||"").toLowerCase(),$e=String(Te.get("edit")||"").toLowerCase();return Ke==="edit"||$e==="1"||$e==="true"}catch{return!1}})()),l=!!t&&t!=="new"&&!i,[o,u]=v.useState(!1),[d,c]=v.useState(!1),[m,h]=v.useState(""),[f,x]=v.useState(!1),[g,b]=v.useState(!1),[y,N]=v.useState(""),[j,S]=v.useState(null),[k,P]=v.useState(null),[I,B]=v.useState([]),[q,Q]=v.useState(!1),[O,T]=v.useState(null),[V,D]=v.useState(null),[Y,M]=v.useState([]),[X,R]=v.useState([]),[H,W]=v.useState([]),[K,_]=v.useState([]),[F,E]=v.useState([]),[L,U]=v.useState([]),[J,ae]=v.useState([]),[Z,oe]=v.useState([]),ee=v.useRef(null),[se,Ae]=v.useState({po_no:"",po_date:new Date().toISOString().split("T")[0],supplier_id:"",quotation_id:"",po_type:"IMPORT",status:"DRAFT",warehouse_id:"",currency:"USD",exchange_rate:1,delivery_date:"",payment_terms:30,delivery_terms:"",remarks:"",port_loading:"",port_discharge:"",incoterms:"",hs_code:"",shipping_date:"",insurance_required:!1,freight_amount:0,other_charges:0,discount_amount:0,tax_amount:0,terms_conditions:`1. All goods must meet specified quality standards
2. Delivery to be made as per schedule
3. Payment terms: Net 30 days from delivery
4. Supplier responsible for any defects within warranty period
5. Late delivery penalties may apply as per agreement
6. All disputes subject to arbitration in Accra, Ghana`}),[we,ce]=v.useState([{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]),[le,_e]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""}),{uoms:Qe}=Po(),Ie=v.useMemo(()=>{const Te=Array.isArray(Qe)?Qe:[],Ke=Te.find($e=>String($e.uom_code||"").toUpperCase()==="PCS")||Te[0];return Ke&&Ke.uom_code?Ke.uom_code:"PCS"},[Qe]);v.useEffect(()=>{let Te=!0;async function Ke(){var $e,Ve,Ze,Re,it,lt,Ne;try{const[Xe,Ge,at,xt]=await Promise.allSettled([te.get("/purchase/suppliers"),te.get("/inventory/warehouses"),te.get("/inventory/items"),te.get("/purchase/quotations")]);if(!Te)return;if(Xe.status==="fulfilled"){const wt=Array.isArray(($e=Xe.value.data)==null?void 0:$e.items)?Xe.value.data.items:[];M(wt)}if(Ge.status==="fulfilled"&&R(Array.isArray((Ve=Ge.value.data)==null?void 0:Ve.items)?Ge.value.data.items:[]),at.status==="fulfilled"&&W(Array.isArray((Ze=at.value.data)==null?void 0:Ze.items)?at.value.data.items:[]),xt.status==="fulfilled"){const wt=Array.isArray((Re=xt.value.data)==null?void 0:Re.items)?xt.value.data.items:[];E(wt);const pt=String(se.supplier_id||""),ge=pt&&pt.length?wt.filter(rt=>String(rt.supplier_id)===String(pt)):[];_(ge)}if(Xe.status==="rejected"&&xt.status==="fulfilled"){const wt=Array.isArray((it=xt.value.data)==null?void 0:it.items)?xt.value.data.items:[],pt=new Set,ge=[];for(const rt of wt){const ht=rt.supplier_id;ht&&!pt.has(String(ht))&&(pt.add(String(ht)),ge.push({id:ht,supplier_name:rt.supplier_name,supplier_type:rt.supplier_type||null}))}ge.length&&M(ge)}Xe.status==="rejected"&&Ge.status==="rejected"&&at.status==="rejected"&&xt.status==="rejected"&&h("Failed to load lookups")}catch(Xe){if(!Te)return;h(((Ne=(lt=Xe==null?void 0:Xe.response)==null?void 0:lt.data)==null?void 0:Ne.message)||"Failed to load lookups")}}return Ke(),()=>{Te=!1}},[]),v.useEffect(()=>{if(i)return;let Te=!0;return te.get("/purchase/orders/next-no",{params:{po_type:se.po_type||"IMPORT"}}).then(Ke=>{var $e;Te&&($e=Ke.data)!=null&&$e.nextNo&&Ae(Ve=>({...Ve,po_no:Ve.po_no||Ke.data.nextNo}))}).catch(Ke=>console.error("Failed to load next purchase order number",Ke)),()=>{Te=!1}},[i,se.po_type]),v.useEffect(()=>{ke()},[]);async function ke(){var Te,Ke,$e;try{const Ze=(Ke=(Te=(await te.get("/admin/me")).data)==null?void 0:Te.scope)==null?void 0:Ke.companyId;if(Ze){const it=(($e=(await te.get(`/admin/companies/${Ze}`)).data)==null?void 0:$e.item)||{};_e(lt=>({...lt,name:it.name||lt.name||"",address:it.address||lt.address||"",phone:it.telephone||lt.phone||"",email:it.email||lt.email||"",city:it.city||lt.city||"",state:it.state||lt.state||"",country:it.country||lt.country||"",logoUrl:it.has_logo===1||it.has_logo===!0?`/api/admin/companies/${Ze}/logo`:Gs}))}else _e(Re=>({...Re,logoUrl:Re.logoUrl||Gs}))}catch{_e(Ve=>({...Ve,logoUrl:Ve.logoUrl||Gs}))}}v.useEffect(()=>{let Te=!0;async function Ke(){var $e;try{const Ve=await te.get("/finance/currencies");if(!Te)return;const Ze=Array.isArray(($e=Ve.data)==null?void 0:$e.items)?Ve.data.items:[];U(Ze)}catch(Ve){console.error("Error fetching currencies:",Ve)}}return Ke(),()=>{Te=!1}},[]),v.useEffect(()=>{async function Te(){var Ke;try{const $e=Array.isArray(L)?L:[];if(!$e.length)return;const Ve=$e.find(Ne=>String(Ne.is_base)==="1"||Ne.is_base===1||Ne.is_base===!0)||$e.find(Ne=>String(Ne.code||Ne.currency_code||"").toUpperCase()==="GHS")||$e.find(Ne=>/ghana|cedi/i.test(String(Ne.name||Ne.currency_name||""))),Ze=$e.find(Ne=>String(Ne.code||Ne.currency_code||"").toUpperCase()==="USD");if(!Ve||!Ze||Ve.id===Ze.id)return;const Re=se.po_date||new Date().toISOString().split("T")[0],it=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Ze.id,toCurrencyId:Ve.id,to:Re}});if(!(Array.isArray((Ke=it.data)==null?void 0:Ke.items)?it.data.items:[]).length)try{await te.post("/finance/currency-rates",{fromCurrencyId:Ze.id,toCurrencyId:Ve.id,rate:1,rateDate:Re})}catch(Ne){console.error("Failed to seed USD->GHS rate",Ne)}}catch($e){console.error("ensureUsdGhsRate error",$e)}}Te()},[L,se.po_date]),v.useEffect(()=>{let Te=!0;async function Ke(){var $e;try{const Ve=await te.get("/sales/prices/standard");if(!Te)return;const Ze=Array.isArray(($e=Ve.data)==null?void 0:$e.items)?Ve.data.items:[];ae(Ze)}catch(Ve){console.error("Error fetching standard prices:",Ve)}}return Ke(),()=>{Te=!1}},[]),v.useEffect(()=>{let Te=!0;async function Ke(){var $e;try{const Ve=await te.get("/finance/tax-codes");if(!Te)return;const Re=(Array.isArray(($e=Ve.data)==null?void 0:$e.items)?Ve.data.items:[]).map(it=>({value:it.id,label:it.name,rate:Number(it.rate_percent)}));oe(Re)}catch(Ve){console.error("Error fetching tax codes:",Ve)}}return Ke(),()=>{Te=!1}},[]);const pe=async Te=>{var Re;const Ke=String(Te||"").toUpperCase(),$e=Array.isArray(L)?L:[];if(!Ke||!$e.length)return;const Ve=$e.find(it=>String(it.is_base)==="1"||it.is_base===1||it.is_base===!0)||$e.find(it=>String(it.code||it.currency_code||"").toUpperCase()==="GHS")||$e.find(it=>/ghana|cedi/i.test(String(it.name||it.currency_name||""))),Ze=$e.find(it=>String(it.code||it.currency_code||"").toUpperCase()===Ke);if(!Ve||!Ze||Ve.id===Ze.id){Ae(it=>({...it,exchange_rate:1}));return}try{const it=se.po_date||new Date().toISOString().split("T")[0],lt=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Ze.id,toCurrencyId:Ve.id,to:it}}),Xe=(Array.isArray((Re=lt.data)==null?void 0:Re.items)?lt.data.items:[])[0];if(Xe&&Xe.rate)Ae(Ge=>({...Ge,exchange_rate:Number(Xe.rate)||Ge.exchange_rate||1}));else try{await te.post("/finance/currency-rates",{fromCurrencyId:Ze.id,toCurrencyId:Ve.id,rate:1,rateDate:it}),Ae(Ge=>({...Ge,exchange_rate:1}))}catch{Ae(Ge=>({...Ge,exchange_rate:1}))}}catch{}};v.useEffect(()=>{pe(se.currency)},[L,se.currency,se.po_date]),v.useEffect(()=>{if(!t||t==="new")return;let Te=!0;return u(!0),h(""),te.get(`/purchase/orders/${t}`).then(Ke=>{var Ze,Re,it;if(!Te)return;const $e=(Ze=Ke.data)==null?void 0:Ze.item,Ve=Array.isArray((it=(Re=Ke.data)==null?void 0:Re.item)==null?void 0:it.details)?Ke.data.item.details:[];$e&&(Ae({po_no:$e.po_no||"",po_date:$e.po_date||new Date().toISOString().split("T")[0],supplier_id:$e.supplier_id?String($e.supplier_id):"",po_type:$e.po_type||"IMPORT",status:$e.status||"DRAFT",warehouse_id:$e.warehouse_id?String($e.warehouse_id):"",currency:$e.currency||"GHS",exchange_rate:Number($e.exchange_rate)||1,delivery_date:$e.delivery_date||"",payment_terms:$e.payment_terms||30,delivery_terms:$e.delivery_terms||"",remarks:$e.remarks||"",port_loading:$e.port_loading||"",port_discharge:$e.port_discharge||"",incoterms:$e.incoterms||"",hs_code:$e.hs_code||"",shipping_date:$e.shipping_date||"",insurance_required:!!$e.insurance_required,freight_amount:Number($e.freight_amount)||0,other_charges:Number($e.other_charges)||0,discount_amount:Number($e.discount_amount)||0,tax_amount:Number($e.tax_amount)||0,terms_conditions:$e.terms_conditions||se.terms_conditions}),ce(Ve.length?Ve.filter(lt=>lt).map(lt=>({item_id:lt.item_id?String(lt.item_id):"",qty:Number(lt.qty)||0,uom:lt.uom||"",unit_price:Number(lt.unit_price)||0,discount_percent:Number(lt.discount_percent)||0,tax_percent:Number(lt.tax_percent)||0,line_total:Number(lt.line_total)||0})):[{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]))}).catch(Ke=>{var $e,Ve;Te&&h(((Ve=($e=Ke==null?void 0:Ke.response)==null?void 0:$e.data)==null?void 0:Ve.message)||"Failed to load purchase order")}).finally(()=>{Te&&u(!1)}),()=>{Te=!1}},[t]);const he=v.useMemo(()=>{let Te=0,Ke=0,$e=0;we.forEach(it=>{if(!it)return;const lt=Number(it.qty)||0,Ne=Number(it.unit_price)||0,Xe=Number(it.discount_percent)||0,Ge=Number(it.tax_percent)||0,at=lt*Ne,xt=at*(Xe/100),pt=(at-xt)*(Ge/100);Te+=at,Ke+=xt,$e+=pt});const Ve=Number(se.freight_amount)||0,Ze=Number(se.other_charges)||0,Re=Te-Ke+$e+Ve+Ze;return{subTotal:Te,totalDiscount:Ke,totalTax:$e,freight:Ve,other:Ze,grandTotal:Re}},[we,se.freight_amount,se.other_charges]),je=async Te=>{var Re,it;const{name:Ke,value:$e,type:Ve,checked:Ze}=Te.target;if(Ae(lt=>({...lt,[Ke]:Ve==="checkbox"?Ze:$e})),Ke==="supplier_id"){const lt=String($e||"");if(lt){const Ne=(Array.isArray(F)?F:[]).filter(Xe=>String(Xe.supplier_id)===lt);_(Ne),Ae(Xe=>{const Ge=Ne.some(at=>String(at.id)===String(Xe.quotation_id||""));return{...Xe,quotation_id:Ge?Xe.quotation_id:""}});try{const Xe=Y.find(at=>String(at.id)===lt),Ge=Xe&&Xe.supplier_code&&String(Xe.supplier_code).trim()||(Xe?`SU-${String(Number(Xe.id||0)).padStart(6,"0")}`:"");if(Ge){const at=await te.get("/finance/accounts",{params:{search:Ge}}),xt=Array.isArray((Re=at.data)==null?void 0:Re.items)?at.data.items:[],wt=xt.find(ge=>String(ge.code)===Ge)||xt[0]||null,pt=wt&&(wt.currency_code||wt.currency||wt.currencyCode)||null;if(pt){const ge=String(pt).toUpperCase();Ae(rt=>({...rt,currency:ge})),await pe(ge)}}}catch{}}else _(Array.isArray(F)?F:[])}if(Ke==="quotation_id"&&$e)try{const Ne=(it=(await te.get(`/purchase/quotations/${$e}`)).data)==null?void 0:it.item;if(Ne){const Ge=(Array.isArray(L)?L:[]).find(pt=>String(pt.id)===String(Ne.currency_id||"")),at=String((Ge==null?void 0:Ge.code)||(Ge==null?void 0:Ge.currency_code)||Ne.currency_code||Ne.currency||"").toUpperCase()||se.currency,wt=new Set(["USD","EUR","GBP"]).has(at)?at:se.currency;if(Ae(pt=>({...pt,supplier_id:Ne.supplier_id?String(Ne.supplier_id):pt.supplier_id,currency:wt,exchange_rate:Ne.exchange_rate!==void 0&&Ne.exchange_rate!==null?Number(Ne.exchange_rate)||pt.exchange_rate||1:pt.exchange_rate,delivery_date:Ne.valid_until||pt.delivery_date||"",remarks:Ne.remarks||pt.remarks||""})),Ne.exchange_rate!==void 0&&Ne.exchange_rate!==null||await pe(wt),Ne.details){const pt=Ne.details.map(ge=>({item_id:String(ge.item_id),qty:Number(ge.qty)||0,uom:ge.uom||Ie,unit_price:Number(ge.unit_price)||0,discount_percent:Number(ge.discount_percent)||0,tax_percent:0,line_total:Number(ge.line_total)||0}));ce(pt)}}}catch(lt){console.error("Failed to fetch quotation details",lt)}Ke==="currency"&&await pe($e)},me=()=>{window.print()},xe=async()=>{const Te=ee.current;if(!Te)return;const Ke=Te.style.cssText;Te.style.cssText=Ke+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const $e=await Wn(Te,{scale:2,useCORS:!0}),Ve=$e.toDataURL("image/png"),Ze=new As("p","mm","a4"),Re=Ze.internal.pageSize.getWidth(),it=Ze.internal.pageSize.getHeight(),lt=Re,Ne=$e.height*lt/$e.width;let Xe=0;for(;Xe<Ne;)Ze.addImage(Ve,"PNG",0,-Xe,lt,Ne),Xe+=it,Xe<Ne&&Ze.addPage();const Ge="PurchaseOrder_"+(se.po_no||new Date().toISOString().slice(0,10))+".pdf";Ze.save(Ge)}finally{Te.style.cssText=Ke}},Ue=(Te,Ke,$e)=>{const Ve=[...we];if(Ve[Te]={...Ve[Te],[Ke]:$e},Ke==="item_id"){const xt=H.find(rt=>String(rt.id)===String($e)),wt=(xt==null?void 0:xt.uom)||Ie;Ve[Te].uom=wt;let ge=xt&&Number(xt.cost_price)||0;if(Array.isArray(J)&&J.length){const rt=J.filter(ht=>String(ht.product_id)===String($e)).sort((ht,ft)=>{const St=ht.effective_date?new Date(ht.effective_date).getTime():0;return(ft.effective_date?new Date(ft.effective_date).getTime():0)-St||new Date(ft.created_at).getTime()-new Date(ht.created_at).getTime()});rt.length>0&&(ge=Number(rt[0].cost_price)||ge)}Ve[Te].unit_price=ge}const Ze=Number(Ve[Te].qty)||0,Re=Number(Ve[Te].unit_price)||0,it=Number(Ve[Te].discount_percent)||0,lt=Number(Ve[Te].tax_percent)||0,Ne=Ze*Re,Xe=Ne*(it/100),Ge=Ne-Xe,at=Ge*(lt/100);Ve[Te].line_total=Ge+at,ce(Ve)},ct=()=>{ce(Te=>[...Te,{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}])},dt=Te=>{ce(Ke=>Ke.length>1?Ke.filter(($e,Ve)=>Ve!==Te):Ke)},We=async Te=>{var Ke,$e,Ve,Ze,Re,it,lt;Te.preventDefault(),c(!0),h("");try{const Ne=(Ve=($e=(Ke=Te==null?void 0:Te.nativeEvent)==null?void 0:Ke.submitter)==null?void 0:$e.dataset)==null?void 0:Ve.submitType,Xe=Ne==="pending"?"PENDING_APPROVAL":Ne==="draft"?"DRAFT":se.status||"DRAFT";if(!se.supplier_id){h("Supplier is required"),c(!1);return}const Ge=we.filter(xt=>xt.item_id&&Number(xt.qty)>0&&Number(xt.unit_price)>0);if(Ge.length===0){h("At least one item with quantity and unit price is required"),c(!1);return}const at={po_no:se.po_no,po_date:se.po_date,po_type:"IMPORT",status:Xe,supplier_id:Number(se.supplier_id),warehouse_id:Number(se.warehouse_id)||null,currency:se.currency,exchange_rate:Number(se.exchange_rate)||1,delivery_date:se.delivery_date||"",payment_terms:Number(se.payment_terms)||0,delivery_terms:se.delivery_terms||"",remarks:se.remarks||"",port_loading:se.port_loading||"",port_discharge:se.port_discharge||"",incoterms:se.incoterms||"",hs_code:se.hs_code||"",shipping_date:se.shipping_date||"",insurance_required:!!se.insurance_required,freight_amount:Number(se.freight_amount)||0,other_charges:Number(se.other_charges)||0,discount_amount:he.totalDiscount,tax_amount:he.totalTax,total_amount:he.grandTotal,terms_conditions:se.terms_conditions||"",quotation_id:se.quotation_id?Number(se.quotation_id):void 0,details:Ge.map(xt=>({item_id:Number(xt.item_id),qty:Number(xt.qty)||0,uom:xt.uom||"",unit_price:Number(xt.unit_price)||0,discount_percent:Number(xt.discount_percent)||0,tax_percent:Number(xt.tax_percent)||0,line_total:Number(xt.line_total)||0}))};if(Ne==="pending"){if(i)await te.post(`/purchase/orders/${t}/submit`,{amount:he.grandTotal??null,workflow_id:j?j.id:null,target_user_id:V||null});else{const xt=await te.post("/purchase/orders",at),wt=(Ze=xt==null?void 0:xt.data)==null?void 0:Ze.id;wt&&await te.post(`/purchase/orders/${wt}/submit`,{amount:he.grandTotal??null,workflow_id:j?j.id:null,target_user_id:V||null})}r("/purchase/purchase-orders-import");return}if(i)await te.put(`/purchase/orders/${t}/status`,{status:Xe});else{const xt=await te.post("/purchase/orders",at),wt=(Re=xt==null?void 0:xt.data)==null?void 0:Re.id;wt&&Xe!=="DRAFT"&&await te.put(`/purchase/orders/${wt}/status`,{status:Xe})}r("/purchase/purchase-orders-import")}catch(Ne){const Xe=((lt=(it=Ne==null?void 0:Ne.response)==null?void 0:it.data)==null?void 0:lt.message)||(Ne==null?void 0:Ne.message)||"Error saving purchase order. Please try again.";h(Xe)}finally{c(!1)}},He=async()=>{var Te,Ke,$e;if(!n){Q(!0),N("");try{const Ve=await te.post(`/purchase/orders/${t}/submit`,{amount:he.grandTotal??null,workflow_id:j?j.id:null,target_user_id:V||null}),Ze=((Te=Ve==null?void 0:Ve.data)==null?void 0:Te.status)||"PENDING_APPROVAL";Ae(Re=>({...Re,status:Ze})),x(!1)}catch(Ve){N((($e=(Ke=Ve==null?void 0:Ve.response)==null?void 0:Ke.data)==null?void 0:$e.message)||"Failed to forward for approval")}finally{Q(!1)}}};return console.log("Rendering PurchaseOrdersImportForm",{id:t,isNew:n,isEdit:i,isView:l}),e.jsxs("div",{className:"w-full pb-10",children:[e.jsx("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:le.logoUrl||Gs,alt:le.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:le.name||"Company"}),le.address&&e.jsx("div",{children:le.address}),(le.city||le.state||le.country)&&e.jsx("div",{children:[le.city,le.state,le.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[le.phone&&e.jsx("span",{children:le.phone}),le.email&&e.jsx("span",{children:le.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",se.po_date||""]}),e.jsxs("div",{children:["PO #: ",se.po_no||""]})]})]})}),e.jsxs("div",{className:"w-full bg-white rounded-xl shadow-[0_4px_20px_rgba(14,54,70,0.15)] overflow-hidden",children:[e.jsxs("div",{className:"bg-[#0E3646] text-white p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:" Purchase Order"}),e.jsx("p",{className:"opacity-90",children:"Create local and import purchase orders"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center p-5 bg-[#f8f9fa] border-b border-[#dee2e6] gap-4",children:[e.jsx("div",{className:"flex bg-[#f8f9fa] p-1 rounded-md border border-[#dee2e6]",children:e.jsx("button",{type:"button",className:`px-5 py-2.5 rounded text-sm font-semibold transition-all ${se.po_type==="IMPORT"?"bg-[#0E3646] text-white":"text-gray-500 hover:bg-gray-200"}`,onClick:()=>Ae({...se,po_type:"IMPORT"}),children:" Import Order"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ee,{to:"/purchase/purchase-orders-import",className:"btn btn-secondary font-medium flex items-center gap-2",children:" View Orders"}),e.jsxs("button",{type:"button",onClick:xe,className:"btn-outline font-medium flex items-center gap-2",children:[e.jsx(gu,{className:"w-4 h-4"}),"Download PDF"]}),e.jsxs("button",{type:"button",onClick:me,className:"btn-primary font-medium flex items-center gap-2",children:[e.jsx(Mh,{className:"w-4 h-4"}),"Print"]})]})]}),e.jsxs("div",{className:"p-8",children:[o&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),m&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded mb-6 border border-red-200",children:m}),e.jsxs("form",{onSubmit:We,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Purchase Order Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Number"}),e.jsx("input",{type:"text",name:"po_no",value:se.po_no,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10 bg-[#e9ecef] cursor-not-allowed",readOnly:!0,placeholder:"Auto-generated"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Date"}),e.jsx("input",{type:"date",name:"po_date",value:se.po_date,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Order Type"}),e.jsx("input",{type:"text",value:se.po_type,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm bg-[#e9ecef]",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Status"}),e.jsx("div",{children:e.jsx("span",{className:"px-4 py-1.5 rounded-full text-xs font-bold bg-[#e9ecef] text-[#495057]",children:se.status})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Supplier"}),e.jsxs("select",{name:"supplier_id",value:se.supplier_id,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),Array.isArray(Y)&&Y.map(Te=>Te&&e.jsx("option",{value:Te.id,children:Te.supplier_name||Te.name||"Unknown Supplier"},Te.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Reference Quotation"}),e.jsxs("select",{name:"quotation_id",value:se.quotation_id,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Quotation"}),Array.isArray(K)&&K.map(Te=>Te&&e.jsxs("option",{value:Te.id,children:[Te.quotation_no," - ",Te.supplier_name]},Te.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:se.warehouse_id,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),Array.isArray(X)&&X.map(Te=>Te&&e.jsx("option",{value:Te.id,children:Te.warehouse_name||Te.name||"Unknown Warehouse"},Te.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Currency"}),e.jsxs("select",{name:"currency",value:se.currency,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"GHS",children:"GHS - Ghana Cedi"}),e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Exchange Rate"}),e.jsx("input",{type:"number",name:"exchange_rate",value:se.exchange_rate,onChange:je,step:"0.01",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Expected Delivery Date"}),e.jsx("input",{type:"date",name:"delivery_date",value:se.delivery_date,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",name:"payment_terms",value:se.payment_terms,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Delivery Terms"}),e.jsxs("select",{name:"delivery_terms",value:se.delivery_terms,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Terms"}),e.jsx("option",{value:"FOB",children:"FOB - Free on Board"}),e.jsx("option",{value:"CIF",children:"CIF - Cost, Insurance & Freight"}),e.jsx("option",{value:"EXW",children:"EXW - Ex Works"}),e.jsx("option",{value:"DDP",children:"DDP - Delivered Duty Paid"})]})]})]})]}),se.po_type==="IMPORT"&&e.jsxs("div",{className:"mb-8 bg-[#fff3cd] border-l-4 border-[#ffc107] p-6 rounded",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-4",children:" Import Order Details"}),e.jsxs("div",{className:"bg-[#e7f3ff] border-l-4 border-[#17a2b8] p-4 rounded mb-5 text-sm text-[#0c5460]",children:[e.jsx("strong",{children:" Import Order:"})," Additional documentation and compliance requirements apply for international procurement."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Port of Loading"}),e.jsx("input",{type:"text",name:"port_loading",value:se.port_loading,onChange:je,placeholder:"e.g., Shanghai, China",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Port of Discharge"}),e.jsx("input",{type:"text",name:"port_discharge",value:se.port_discharge,onChange:je,placeholder:"e.g., Tema Port, Ghana",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Incoterms"}),e.jsxs("select",{name:"incoterms",value:se.incoterms,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"FOB",children:"FOB"}),e.jsx("option",{value:"CIF",children:"CIF"}),e.jsx("option",{value:"CFR",children:"CFR"}),e.jsx("option",{value:"EXW",children:"EXW"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"HS Code"}),e.jsx("input",{type:"text",name:"hs_code",value:se.hs_code,onChange:je,placeholder:"Harmonized System Code",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Expected Shipping Date"}),e.jsx("input",{type:"date",name:"shipping_date",value:se.shipping_date,onChange:je,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Insurance Required"}),e.jsxs("select",{name:"insurance_required",value:se.insurance_required?"YES":"NO",onChange:Te=>Ae({...se,insurance_required:Te.target.value==="YES"}),className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"YES",children:"Yes"}),e.jsx("option",{value:"NO",children:"No"})]})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646]",children:" Order Items"}),e.jsx("button",{type:"button",onClick:ct,className:"px-4 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all text-sm font-medium flex items-center gap-2",children:" Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-[#0E3646] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-[13px] w-[50px]",children:"#"}),e.jsx("th",{className:"p-3 text-left text-[13px]",children:"Item Name"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Qty"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"UOM"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"Unit Price"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Disc %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[140px]",children:"Tax %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[150px]",children:"Net Amount"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[80px]",children:"Action"})]})}),e.jsx("tbody",{children:we.map((Te,Ke)=>Te&&e.jsxs("tr",{className:"border-b border-[#dee2e6] hover:bg-[#0E3646]/5 transition-colors",children:[e.jsx("td",{className:"p-3 text-sm",children:Ke+1}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:Te.item_id,onChange:$e=>Ue(Ke,"item_id",$e.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm focus:outline-none focus:border-[#0E3646]",required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),Array.isArray(H)&&H.map($e=>$e&&e.jsx("option",{value:$e.id,children:$e.item_name||$e.item_code||"Unknown Item"},$e.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Te.qty,onChange:$e=>Ue(Ke,"qty",$e.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:Te.uom||Ie||"",onChange:$e=>Ue(Ke,"uom",$e.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-center focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select UOM"}),Array.isArray(Qe)&&Qe.map($e=>$e&&e.jsx("option",{value:$e.uom_code,children:$e.uom_name?`${$e.uom_name} (${$e.uom_code})`:$e.uom_code},$e.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Te.unit_price,onChange:$e=>Ue(Ke,"unit_price",$e.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Te.discount_percent,onChange:$e=>Ue(Ke,"discount_percent",$e.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",max:"100",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:(()=>{const $e=Z.find(Ve=>Number(Ve.rate)===Number(Te.tax_percent||0));return $e?$e.value:""})(),onChange:$e=>{const Ve=$e.target.value,Ze=Z.find(it=>String(it.value)===String(Ve)),Re=Ze?Ze.rate:0;Ue(Ke,"tax_percent",Re)},className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"No Tax"}),Z.map($e=>e.jsx("option",{value:$e.value,children:$e.label},$e.value))]})}),e.jsxs("td",{className:"p-3 text-right font-medium text-sm",children:[se.currency," ",Te.line_total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>dt(Ke),className:"text-[#dc3545] hover:bg-[#dc3545]/10 p-1.5 rounded transition-colors",children:""})})]},Ke))})]})}),e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg mt-5 border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Items:"}),e.jsx("span",{className:"font-bold",children:we.filter(Te=>Te&&Te.item_id).length})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sub Total:"}),e.jsxs("span",{className:"font-bold",children:[se.currency," ",he.subTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#dc3545]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Discount:"}),e.jsxs("span",{className:"font-bold",children:["-",se.currency," ",he.totalDiscount.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#0E3646]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tax Amount:"}),e.jsxs("span",{className:"font-bold",children:[se.currency," ",he.totalTax.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Freight Charges:"}),e.jsx("input",{type:"number",name:"freight_amount",value:se.freight_amount,onChange:je,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Other Charges:"}),e.jsx("input",{type:"number",name:"other_charges",value:se.other_charges,onChange:je,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-3 text-lg font-bold text-[#0E3646]",children:[e.jsx("span",{children:"GRAND TOTAL:"}),e.jsxs("span",{children:[se.currency," ",he.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Terms & Conditions"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("textarea",{name:"terms_conditions",value:se.terms_conditions,onChange:je,rows:"6",className:"p-3 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",placeholder:"Enter terms and conditions..."})})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-8 gap-4",children:[e.jsx("div",{children:e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#dc3545] text-white rounded hover:bg-[#c82333] transition-all font-medium flex items-center gap-2",onClick:()=>alert("Delete functionality not implemented yet"),children:" Delete"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#6c757d] text-white rounded hover:bg-[#5a6268] transition-all font-medium flex items-center gap-2",onClick:()=>Ae({...se,remarks:""}),children:" Clear"}),!l&&e.jsx("button",{type:"submit",disabled:d,"data-submit-type":"draft",className:"px-5 py-2.5 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:d?"Saving...":" Save as Draft"}),!l&&e.jsx("button",{type:"submit",disabled:d,"data-submit-type":"pending",className:"px-5 py-2.5 bg-[#28a745] text-white rounded hover:bg-[#218838] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:" Submit for Approval"})]})]})]})]})]}),e.jsxs("div",{ref:ee,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:le.logoUrl||Gs,alt:le.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:le.name||"Company"}),le.address&&e.jsx("div",{children:le.address}),(le.city||le.state||le.country)&&e.jsx("div",{children:[le.city,le.state,le.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[le.phone&&e.jsx("span",{children:le.phone}),le.email&&e.jsx("span",{children:le.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",se.po_date||""]}),e.jsxs("div",{children:["PO #: ",se.po_no||""]}),e.jsxs("div",{children:["Supplier:"," ",((ze=Y.find(Te=>String(Te.id)===String(se.supplier_id)))==null?void 0:ze.supplier_name)||((Pe=Y.find(Te=>String(Te.id)===String(se.supplier_id)))==null?void 0:Pe.name)||""]}),e.jsxs("div",{children:["Currency: ",se.currency||""]}),e.jsxs("div",{children:["Exchange Rate: ",Number(se.exchange_rate||1).toFixed(2)]}),se.incoterms&&e.jsxs("div",{children:["Incoterms: ",se.incoterms]}),se.port_loading&&e.jsxs("div",{children:["Port Loading: ",se.port_loading]}),se.port_discharge&&e.jsxs("div",{children:["Port Discharge: ",se.port_discharge]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Net Amount"})]})}),e.jsx("tbody",{children:we.map((Te,Ke)=>{const $e=H.find(Ze=>String(Ze.id)===String(Te.item_id)),Ve=($e==null?void 0:$e.item_name)||($e==null?void 0:$e.item_code)||"Item";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ve}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Te.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Te.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Te.line_total||0).toFixed(2)})]},Ke)})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Gross Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(he.subTotal||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(he.totalDiscount||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Number(he.subTotal-he.totalDiscount||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Tax Amount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(he.totalTax||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Freight Charges"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(he.freight||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Other Charges"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(he.other||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Number(he.grandTotal||0).toFixed(2)})]})})})]})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{x(!1),S(null),P(null),N("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:se.po_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:j?`${j.workflow_name} (${j.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:y?e.jsx("div",{className:"text-sm text-red-600",children:y}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Ke=Array.isArray(I)&&I.length>0?I[0]:null,$e=Ke?Array.isArray(Ke.approvers)&&Ke.approvers.length?Ke.approvers.map(Ve=>({id:Ve.id,name:Ve.username})):Ke.approver_user_id?[{id:Ke.approver_user_id,name:Ke.approver_name||String(Ke.approver_user_id)}]:[]:[];return $e.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:V||"",onChange:Ve=>D(Ve.target.value?Number(Ve.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),$e.map(Ve=>e.jsx("option",{value:Ve.id,children:Ve.name},Ve.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:k?`Step ${k.stepOrder}  ${k.stepName}${k.approvalLimit!=null?`  Limit: ${Number(k.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:j?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{x(!1),S(null),P(null),N("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:He,disabled:q||n,children:q?"Forwarding...":"Forward"})]})]})})]})}function nJ(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState([]);v.useEffect(()=>{let c=!0;return a(!0),i(""),te.get("/purchase/shipping-advices").then(m=>{var h;c&&o(Array.isArray((h=m.data)==null?void 0:h.items)?m.data.items:[])}).catch(m=>{var h,f;c&&i(((f=(h=m==null?void 0:m.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load shipping advice")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=c=>({DRAFT:"badge-info",IN_TRANSIT:"badge-warning",ARRIVED:"badge-success",CLEARED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=v.useMemo(()=>{const c=t.toLowerCase();return l.filter(m=>{const h=String(m.advice_no||"").toLowerCase(),f=String(m.po_no||"").toLowerCase(),x=String(m.bill_of_lading||"").toLowerCase();return h.includes(c)||f.includes(c)||x.includes(c)})},[l,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Shipping Advice"}),e.jsx("p",{className:"text-sm mt-1",children:"Track shipments and vessel information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/shipping-advice/new",className:"btn-success",children:"+ New Shipping Advice"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by advice no / PO / vessel...",className:"input",value:t,onChange:c=>s(c.target.value)})})})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Advice No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"PO"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"ETD"}),e.jsx("th",{children:"ETA"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):n?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-red-600",children:n})}):null,d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No records"})}):d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:c.advice_no}),e.jsx("td",{children:c.advice_date?new Date(c.advice_date).toLocaleDateString():""}),e.jsx("td",{children:c.po_no}),e.jsx("td",{children:c.supplier_name}),e.jsx("td",{children:c.etd_date?new Date(c.etd_date).toLocaleDateString():"-"}),e.jsx("td",{children:c.eta_date?new Date(c.eta_date).toLocaleDateString():"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/purchase/shipping-advice/${c.id}?mode=view`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/shipping-advice/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))]})]})})]})]})}function aS(){const{id:t}=Ps(),s=Ns(),r=!t||t==="new",{user:a}=Qa(),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState([]),[h,f]=v.useState({advice_no:"Auto-generated",advice_date:new Date().toISOString().split("T")[0],po_id:"",status:"IN_TRANSIT",shipping_method:"",shipping_company:"",tracking_number:"",vessel_name:"",voyage_number:"",port_of_loading:"",port_of_discharge:"",bl_number:"",bl_date:"",container_numbers:"",total_packages:0,gross_weight:0,volume:0,etd:"",eta:"",remarks:""}),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState([]),[S,k]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""});v.useEffect(()=>{te.get("/purchase/orders?status=APPROVED").then(M=>{var H;const R=(Array.isArray((H=M.data)==null?void 0:H.items)?M.data.items:[]).filter(W=>W.po_type==="IMPORT");m(R)}).catch(M=>console.error(M))},[]),v.useEffect(()=>{P()},[]),v.useEffect(()=>{r&&(async()=>{var M;try{const R=(M=(await te.get("/purchase/shipping-advices/next-no")).data)==null?void 0:M.nextNo;R&&f(H=>({...H,advice_no:R}))}catch{}})()},[r]);async function P(){var M,X,R;try{const W=(X=(M=(await te.get("/admin/me")).data)==null?void 0:M.scope)==null?void 0:X.companyId;if(W){const _=((R=(await te.get(`/admin/companies/${W}`)).data)==null?void 0:R.item)||{};k(F=>({...F,name:_.name||F.name||"",address:_.address||F.address||"",phone:_.telephone||F.phone||"",email:_.email||F.email||"",city:_.city||F.city||"",state:_.state||F.state||"",country:_.country||F.country||"",logoUrl:_.has_logo===1||_.has_logo===!0?`/api/admin/companies/${W}/logo`:Gs}))}else k(K=>({...K,logoUrl:K.logoUrl||Gs}))}catch{k(H=>({...H,logoUrl:H.logoUrl||Gs}))}}v.useEffect(()=>{r||(i(!0),te.get(`/purchase/shipping-advices/${t}`).then(M=>{var H;const X=((H=M.data)==null?void 0:H.item)||{},R=X.details||[];f({advice_no:X.advice_no,advice_date:X.advice_date?X.advice_date.split("T")[0]:"",po_id:X.po_id,supplier_id:X.supplier_id,status:X.status,tracking_number:X.bill_of_lading||"",vessel_name:X.vessel_name||"",container_numbers:X.container_no||"",etd:X.etd_date?X.etd_date.split("T")[0]:"",eta:X.eta_date?X.eta_date.split("T")[0]:"",remarks:X.remarks||""}),g(R.map(W=>({item_id:W.item_id,item_code:W.item_code,item_name:W.item_name,ordered_qty:0,shipped_qty:W.qty_shipped,uom:"pcs",remarks:W.remarks||""})))}).catch(M=>{var X,R;return d(((R=(X=M==null?void 0:M.response)==null?void 0:X.data)==null?void 0:R.message)||"Failed to load data")}).finally(()=>i(!1)))},[t,r]),v.useEffect(()=>{h.po_id&&te.get(`/purchase/orders/${h.po_id}`).then(M=>{var H,W,K;const X=((W=(H=M.data)==null?void 0:H.item)==null?void 0:W.details)||[],R=(K=M.data)==null?void 0:K.item;if(j(X),R&&R.supplier_id&&f(_=>({..._,supplier_id:R.supplier_id})),r&&x.length===0){const _=X.map(F=>({item_id:F.item_id,item_code:F.item_code,item_name:F.item_name,ordered_qty:F.qty,shipped_qty:F.qty,uom:F.uom||"pcs",package_numbers:"",remarks:""}));g(_)}else x.length>0&&g(_=>_.map(F=>{const E=X.find(L=>String(L.item_id)===String(F.item_id));return E?{...F,ordered_qty:E.qty}:F}))}).catch(console.error)},[h.po_id,r]);const I=M=>{const{name:X,value:R}=M.target;f(H=>({...H,[X]:R}))},B=(M,X,R)=>{const H=[...x];H[M]={...H[M],[X]:R},g(H)},q=M=>{g(x.filter((X,R)=>R!==M))},Q=()=>{y([{status_title:"",status_date:new Date().toISOString().slice(0,16),description:"",location:""},...b])},O=(M,X,R)=>{const H=[...b];H[M]={...H[M],[X]:R},y(H)},T=M=>{y(b.filter((X,R)=>R!==M))},V=async M=>{var X,R,H;M.preventDefault(),o(!0),d("");try{const W=((X=c.find(_=>String(_.id)===String(h.po_id)))==null?void 0:X.supplier_id)||null,K={advice_no:h.advice_no,advice_date:h.advice_date,po_id:h.po_id,supplier_id:h.supplier_id||W,status:h.status||"IN_TRANSIT",vessel_name:h.vessel_name||null,bill_of_lading:h.tracking_number||null,container_no:h.container_numbers||null,etd_date:h.etd||null,eta_date:h.eta||null,remarks:h.remarks||null,details:x.map(_=>({item_id:_.item_id,qty_shipped:Number(_.shipped_qty)||0,remarks:_.remarks||null}))};r?await te.post("/purchase/shipping-advices",K):await te.put(`/purchase/shipping-advices/${t}`,K),s("/purchase/shipping-advice")}catch(W){d(((H=(R=W==null?void 0:W.response)==null?void 0:R.data)==null?void 0:H.message)||"Failed to save")}finally{o(!1)}},D=()=>{alert("Notification sent to warehouse and stakeholders!")},Y=()=>{window.print()};return e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsx("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:S.logoUrl||Gs,alt:S.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:S.name||"Company"}),S.address&&e.jsx("div",{children:S.address}),(S.city||S.state||S.country)&&e.jsx("div",{children:[S.city,S.state,S.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[S.phone&&e.jsx("span",{children:S.phone}),S.email&&e.jsx("span",{children:S.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Shipping Advice"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",h.advice_date||""]}),e.jsxs("div",{children:["Advice #: ",h.advice_no||""]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[r?"New":"Edit"," Shipping Advice"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Manage shipment details, tracking, and items."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase/shipping-advice",className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{onClick:Y,className:"btn btn-outline",type:"button",children:"Print"}),e.jsx("button",{onClick:V,className:"btn btn-primary",disabled:l,children:l?"Saving...":"Save Advice"})]})]}),u&&e.jsx("div",{className:"p-4 bg-red-50 text-red-700 rounded-lg border border-red-200",children:u}),n?e.jsx("div",{className:"text-center py-10",children:"Loading..."}):e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"General Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Advice No"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:h.advice_no,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Advice Date *"}),e.jsx("input",{type:"date",className:"input",name:"advice_date",value:h.advice_date,onChange:I,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Order *"}),e.jsxs("select",{className:"input",name:"po_id",value:h.po_id,onChange:I,required:!0,disabled:!r&&x.length>0,children:[e.jsx("option",{value:"",children:"Select PO..."}),c.map(M=>e.jsxs("option",{value:M.id,children:[M.po_no," - ",M.supplier_name]},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",name:"status",value:h.status,onChange:I,children:[e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"IN_TRANSIT",children:"In Transit"}),e.jsx("option",{value:"ARRIVED",children:"Arrived"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Shipment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shipping Method"}),e.jsxs("select",{className:"input",name:"shipping_method",value:h.shipping_method,onChange:I,children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"SEA",children:"Sea Freight"}),e.jsx("option",{value:"AIR",children:"Air Freight"}),e.jsx("option",{value:"ROAD",children:"Road Freight"}),e.jsx("option",{value:"COURIER",children:"Courier"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shipping Company"}),e.jsx("input",{type:"text",className:"input",name:"shipping_company",value:h.shipping_company,onChange:I,placeholder:"e.g. Maersk, DHL"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tracking / BL No"}),e.jsx("input",{type:"text",className:"input",name:"tracking_number",value:h.tracking_number,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vessel / Flight Name"}),e.jsx("input",{type:"text",className:"input",name:"vessel_name",value:h.vessel_name,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voyage No"}),e.jsx("input",{type:"text",className:"input",name:"voyage_number",value:h.voyage_number,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Loading"}),e.jsx("input",{type:"text",className:"input",name:"port_of_loading",value:h.port_of_loading,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Discharge"}),e.jsx("input",{type:"text",className:"input",name:"port_of_discharge",value:h.port_of_discharge,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Container Nos"}),e.jsx("input",{type:"text",className:"input",name:"container_numbers",value:h.container_numbers,onChange:I,placeholder:"Comma separated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ETD (Estimated Departure)"}),e.jsx("input",{type:"date",className:"input",name:"etd",value:h.etd,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ETA (Estimated Arrival)"}),e.jsx("input",{type:"date",className:"input",name:"eta",value:h.eta,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Total Packages"}),e.jsx("input",{type:"number",className:"input",name:"total_packages",value:h.total_packages,onChange:I})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Gross Weight (kg)"}),e.jsx("input",{type:"number",className:"input",name:"gross_weight",value:h.gross_weight,onChange:I,step:"0.01"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Items in Shipment"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{},children:"Refresh from PO"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{className:"w-24",children:"Ordered"}),e.jsx("th",{className:"w-32",children:"Shipped Qty"}),e.jsx("th",{className:"w-24",children:"UOM"}),e.jsx("th",{children:"Package Nos"}),e.jsx("th",{children:"Remarks"}),e.jsx("th",{className:"w-10"})]})}),e.jsxs("tbody",{children:[x.map((M,X)=>e.jsxs("tr",{children:[e.jsx("td",{children:M.item_code}),e.jsx("td",{children:M.item_name}),e.jsx("td",{className:"text-slate-500",children:M.ordered_qty}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input input-sm w-full",value:M.shipped_qty,onChange:R=>B(X,"shipped_qty",R.target.value),step:"0.01"})}),e.jsx("td",{children:M.uom}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input input-sm w-full",value:M.package_numbers,onChange:R=>B(X,"package_numbers",R.target.value),placeholder:"e.g. 1-10"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input input-sm w-full",value:M.remarks,onChange:R=>B(X,"remarks",R.target.value)})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700",onClick:()=>q(X),children:""})})]},X)),x.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-4 text-slate-500",children:"No items selected. Select a PO to populate items."})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Tracking Timeline"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:Q,children:"+ Add Event"})]}),e.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[b.map((M,X)=>e.jsxs("div",{className:"flex gap-4 items-start p-3 bg-slate-50 dark:bg-slate-800 rounded-lg border",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",className:"input input-sm font-semibold",placeholder:"Status (e.g. Departed)",value:M.status_title,onChange:R=>O(X,"status_title",R.target.value)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"datetime-local",className:"input input-sm w-full",value:M.status_date?new Date(M.status_date).toISOString().slice(0,16):"",onChange:R=>O(X,"status_date",R.target.value)}),e.jsx("input",{type:"text",className:"input input-sm w-full",placeholder:"Location",value:M.location,onChange:R=>O(X,"location",R.target.value)})]}),e.jsx("textarea",{className:"input input-sm w-full",placeholder:"Description / Notes",rows:"2",value:M.description,onChange:R=>O(X,"description",R.target.value)})]}),e.jsx("button",{type:"button",className:"text-red-500",onClick:()=>T(X),children:""})]},X)),b.length===0&&e.jsx("p",{className:"text-center text-slate-500 py-4",children:"No tracking updates yet."})]})]}),e.jsxs("div",{className:"card p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Additional Remarks"}),e.jsx("textarea",{className:"input w-full h-32",name:"remarks",value:h.remarks,onChange:I,placeholder:"Any internal notes or instructions..."})]}),e.jsxs("div",{className:"pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{type:"button",className:"btn btn-info w-full sm:w-auto",onClick:D,children:" Send Arrival Notification"}),e.jsx("button",{type:"button",className:"btn btn-secondary w-full sm:w-auto",onClick:()=>y(M=>[{status_title:"Arrived at Port",status_date:new Date().toISOString(),location:h.port_of_discharge||"Port",description:"Vessel has arrived at discharge port."},...M]),children:" Mark as Arrived"})]})]})]})]})]})]})}function iJ(){const[t,s]=v.useState(""),[r,a]=v.useState(!1),[n,i]=v.useState(""),[l,o]=v.useState([]);v.useEffect(()=>{let c=!0;return a(!0),i(""),te.get("/purchase/port-clearances").then(m=>{var h;c&&o(Array.isArray((h=m.data)==null?void 0:h.items)?m.data.items:[])}).catch(m=>{var h,f;c&&i(((f=(h=m==null?void 0:m.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to load port clearances")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=c=>({PENDING:"badge-warning",CLEARED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=v.useMemo(()=>{const c=t.toLowerCase();return l.filter(m=>{const h=String(m.clearance_no||"").toLowerCase(),f=String(m.advice_no||"").toLowerCase();return h.includes(c)||f.includes(c)})},[l,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Clearing at Port"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customs and port clearances"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/port-clearances/new",className:"btn-success",children:"+ New Clearance"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by clearance no / shipping advice...",className:"input",value:t,onChange:c=>s(c.target.value)})})})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Clearance No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"PO"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Clearing Agent"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):n?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-red-600",children:n})}):null,d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No records"})}):d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:c.clearance_no}),e.jsx("td",{children:c.clearance_date?new Date(c.clearance_date).toLocaleDateString():""}),e.jsx("td",{children:c.po_no||""}),e.jsx("td",{children:c.supplier_name||""}),e.jsx("td",{children:c.clearing_agent||""}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/purchase/port-clearances/${c.id}?mode=view`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/port-clearances/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))]})]})})]})]})}function nS(){const{id:t}=Ps(),s=Ns(),r=!t||t==="new",[a,n]=v.useState(!1),[i,l]=v.useState(!1),[o,u]=v.useState(""),[d,c]=v.useState([]),[m,h]=v.useState({clearance_no:r?"Auto-generated":"",clearance_date:new Date().toISOString().split("T")[0],shipping_advice_id:"",status:"PENDING",port_of_entry:"",arrival_date:"",clearing_agent:"",target_clearance_date:"",customs_declaration_number:"",declaration_date:"",hs_code:"",assessment_date:"",total_clearance_cost:0}),[f,x]=v.useState([]);v.useEffect(()=>{let S=!0;return te.get("/purchase/shipping-advices?status=IN_TRANSIT").then(k=>{var P;S&&c(Array.isArray((P=k.data)==null?void 0:P.items)?k.data.items:[])}).catch(k=>{S&&console.error("Failed to load shipping advice",k)}),()=>{S=!1}},[]),v.useEffect(()=>{r&&te.get("/purchase/port-clearances/next-no").then(S=>{var P;const k=(P=S.data)==null?void 0:P.nextNo;k&&h(I=>({...I,clearance_no:k}))}).catch(()=>{})},[r]),v.useEffect(()=>{m.shipping_advice_id&&te.get(`/purchase/shipping-advices/${m.shipping_advice_id}`).then(S=>{var P;const k=(P=S.data)==null?void 0:P.item;if(k){const I=k.eta_date&&typeof k.eta_date=="string"?k.eta_date.split("T")[0]:k.eta_date||"";h(B=>({...B,arrival_date:B.arrival_date||I||B.arrival_date,target_clearance_date:B.target_clearance_date||I||B.target_clearance_date}))}}).catch(console.error)},[m.shipping_advice_id]),v.useEffect(()=>{if(r)return;let S=!0;return n(!0),u(""),te.get(`/purchase/port-clearances/${t}`).then(k=>{var I;if(!S)return;const P=(I=k.data)==null?void 0:I.item;if(P)if(h({clearance_no:P.clearance_no||"",clearance_date:P.clearance_date?typeof P.clearance_date=="string"?P.clearance_date.split("T")[0]:P.clearance_date:new Date().toISOString().split("T")[0],shipping_advice_id:P.advice_id?String(P.advice_id):"",status:P.status||"PENDING",port_of_entry:P.port_of_entry||"",arrival_date:P.arrival_date||"",clearing_agent:P.clearing_agent||"",target_clearance_date:P.target_clearance_date||"",customs_declaration_number:P.customs_entry_no||P.customs_declaration_number||"",declaration_date:P.declaration_date||"",hs_code:P.hs_code||"",assessment_date:P.assessment_date||"",total_clearance_cost:Number(P.total_clearance_cost)||Number(P.duty_amount||0)+Number(P.other_charges||0)||0}),k.data.charges&&Array.isArray(k.data.charges))x(k.data.charges.map(B=>({id:B.id,charge_type:B.charge_type,amount:B.amount,vendor_authority:B.vendor_authority||""})));else{const B=[];Number(P.duty_amount)>0&&B.push({charge_type:"DUTY",amount:P.duty_amount,vendor_authority:"Customs"}),Number(P.other_charges)>0&&B.push({charge_type:"OTHER",amount:P.other_charges,vendor_authority:"Other"}),x(B)}}).catch(k=>{var P,I;S&&u(((I=(P=k==null?void 0:k.response)==null?void 0:P.data)==null?void 0:I.message)||"Failed to load port clearance")}).finally(()=>{S&&n(!1)}),()=>{S=!1}},[t,r]),v.useEffect(()=>{const S=f.reduce((k,P)=>k+(Number(P.amount)||0),0);h(k=>({...k,total_clearance_cost:S}))},[f]);const g=S=>{const{name:k,value:P}=S.target;h(I=>({...I,[k]:P}))},b=()=>{x([...f,{charge_type:"DUTY",amount:0,vendor_authority:""}])},y=S=>{const k=[...f];k.splice(S,1),x(k)},N=(S,k,P)=>{const I=[...f];I[S]={...I[S],[k]:P},x(I)},j=async S=>{var k,P;S.preventDefault(),l(!0),u("");try{const I={...m,shipping_advice_id:Number(m.shipping_advice_id),charges:f.map(B=>({charge_type:B.charge_type,amount:Number(B.amount),vendor_authority:B.vendor_authority}))};r?await te.post("/purchase/port-clearances",I):await te.put(`/purchase/port-clearances/${t}`,I),s("/purchase/port-clearances")}catch(I){u(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to save port clearance")}finally{l(!1)}};return a?e.jsx("div",{className:"p-4",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[r?"New":"Edit"," Port Clearance"]}),e.jsx("p",{className:"text-sm mt-1 text-slate-500",children:"Manage customs declarations and port charges"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase/port-clearances",className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:j,disabled:i,className:"btn-primary",children:i?"Saving...":"Save Changes"})]})]}),o&&e.jsx("div",{className:"p-4 bg-red-50 text-red-700 rounded-md border border-red-200",children:o}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Clearance Details"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Clearance No"}),e.jsx("input",{type:"text",className:"input",value:m.clearance_no,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Clearance Date"}),e.jsx("input",{type:"date",className:"input",name:"clearance_date",value:m.clearance_date,onChange:g,required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Shipping Advice"}),e.jsxs("select",{className:"input",name:"shipping_advice_id",value:m.shipping_advice_id,onChange:g,required:!0,children:[e.jsx("option",{value:"",children:"Select Shipping Advice..."}),d.map(S=>e.jsxs("option",{value:S.id,children:[S.advice_no," - ",S.po_no," (",S.supplier_name,")"]},S.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",name:"status",value:m.status,onChange:g,children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"CLEARED",children:"Cleared"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Target Clearance Date"}),e.jsx("input",{type:"date",className:"input",name:"target_clearance_date",value:m.target_clearance_date,onChange:g})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Customs & Import Data"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Entry"}),e.jsx("input",{type:"text",className:"input",name:"port_of_entry",value:m.port_of_entry,onChange:g,placeholder:"e.g. Tema Port"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Arrival Date"}),e.jsx("input",{type:"date",className:"input",name:"arrival_date",value:m.arrival_date,onChange:g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Clearing Agent"}),e.jsx("input",{type:"text",className:"input",name:"clearing_agent",value:m.clearing_agent,onChange:g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"HS Code"}),e.jsx("input",{type:"text",className:"input",name:"hs_code",value:m.hs_code,onChange:g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customs Decl. No"}),e.jsx("input",{type:"text",className:"input",name:"customs_declaration_number",value:m.customs_declaration_number,onChange:g})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Declaration Date"}),e.jsx("input",{type:"date",className:"input",name:"declaration_date",value:m.declaration_date,onChange:g})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex justify-between items-center",children:[e.jsx("h3",{className:"card-title",children:"Charges & Duties"}),e.jsx("button",{type:"button",onClick:b,className:"btn-sm btn-secondary",children:"+ Add Charge"})]}),e.jsxs("div",{className:"card-body space-y-4",children:[f.length===0&&e.jsx("p",{className:"text-sm text-slate-500 italic",children:"No charges added yet."}),f.map((S,k)=>e.jsxs("div",{className:"flex gap-4 items-end border-b border-slate-100 pb-4 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"label text-xs",children:"Type"}),e.jsxs("select",{className:"input text-sm py-1",value:S.charge_type,onChange:P=>N(k,"charge_type",P.target.value),children:[e.jsx("option",{value:"DUTY",children:"Import Duty"}),e.jsx("option",{value:"VAT",children:"VAT"}),e.jsx("option",{value:"LEVY",children:"Import Levy"}),e.jsx("option",{value:"HANDLING",children:"Port Handling"}),e.jsx("option",{value:"STORAGE",children:"Storage Fees"}),e.jsx("option",{value:"OTHER",children:"Other Charges"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"label text-xs",children:"Amount"}),e.jsx("input",{type:"number",step:"1",className:"input text-sm py-1",value:S.amount,onChange:P=>N(k,"amount",P.target.value)})]}),e.jsxs("div",{className:"flex-[2]",children:[e.jsx("label",{className:"label text-xs",children:"Vendor / Authority"}),e.jsx("input",{type:"text",className:"input text-sm py-1",value:S.vendor_authority,onChange:P=>N(k,"vendor_authority",P.target.value),placeholder:"e.g. GRA"})]}),e.jsx("button",{type:"button",onClick:()=>y(k),className:"text-red-500 hover:text-red-700 pb-2",children:""})]},k)),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-100",children:e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 mr-4",children:"Total Cost:"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:m.total_clearance_cost.toLocaleString(void 0,{minimumFractionDigits:2})})]})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Documents"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsx("div",{className:"text-slate-400 mb-2",children:e.jsx("svg",{className:"w-8 h-8 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Click to upload documents"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"PDF, JPG, PNG up to 10MB"})]}),e.jsx("div",{className:"mt-4 space-y-2",children:e.jsx("p",{className:"text-xs text-slate-400 italic text-center",children:"No documents attached"})})]})]}),e.jsx("div",{className:"card bg-blue-50 border-blue-100",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Help & Instructions"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"Ensure all duties are calculated based on the latest HS Code rates."}),e.jsx("li",{children:"Attach scanned copies of the Customs Declaration."}),e.jsx("li",{children:"Update status to 'Cleared' only when goods have left the port."})]})]})})]})]})]})}function iS(){const s=Ba().pathname.includes("purchase-bills-import")?"IMPORT":"LOCAL",[r,a]=v.useState(""),[n,i]=v.useState(!1),[l,o]=v.useState(""),[u,d]=v.useState([]);v.useEffect(()=>{let f=!0;return i(!0),o(""),te.get("/purchase/bills",{params:{bill_type:s}}).then(x=>{var g;f&&d(Array.isArray((g=x.data)==null?void 0:g.items)?x.data.items:[])}).catch(x=>{var g,b;f&&o(((b=(g=x==null?void 0:x.response)==null?void 0:g.data)==null?void 0:b.message)||"Failed to load purchase bills")}).finally(()=>{f&&i(!1)}),()=>{f=!1}},[s]);const c=f=>({DRAFT:"badge-info",POSTED:"badge-success",CANCELLED:"badge-error"})[f]||"badge-info",m=f=>({UNPAID:"badge-error",PARTIALLY_PAID:"badge-warning",PAID:"badge-success"})[f]||"badge-info",h=v.useMemo(()=>{const f=r.toLowerCase();return u.filter(x=>{const g=String(x.bill_no||"").toLowerCase(),b=String(x.supplier_name||"").toLowerCase(),y=String(x.po_no||"").toLowerCase();return g.includes(f)||b.includes(f)||y.includes(f)})},[u,r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:["Purchase Bills - ",s]}),e.jsx("p",{className:"text-sm mt-1",children:"Record and manage supplier bills"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:`/purchase/purchase-bills-${s.toLowerCase()}/new`,className:"btn-success",children:"+ New Bill"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by bill no / supplier / PO...",className:"input",value:r,onChange:f=>a(f.target.value)})})})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bill No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"PO"}),e.jsx("th",{className:"text-right",children:"Total"}),e.jsx("th",{className:"text-right",children:"Tax"}),e.jsx("th",{className:"text-right",children:"Net"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8 text-red-600",children:l})}):null,h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No records"})}):h.map(f=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:f.bill_no}),e.jsx("td",{children:f.bill_date?new Date(f.bill_date).toLocaleDateString():""}),e.jsx("td",{children:f.supplier_name}),e.jsx("td",{children:f.po_no||"-"}),e.jsx("td",{className:"text-right font-medium",children:Number(f.total_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"text-right",children:Number(f.tax_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"text-right font-medium",children:Number(f.net_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${m(String(f.payment_status||""))}`,children:String(f.payment_status||"")||"-"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c(f.status)}`,children:f.status})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/purchase/purchase-bills-${s.toLowerCase()}/${f.id}?mode=view`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/purchase-bills-${s.toLowerCase()}/${f.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ml-2",children:"Edit"})]})]},f.id))]})]})})]})]})}const Nm=[{id:4,code:"GHS",name:"Ghanaian Cedi"},{id:1,code:"USD",name:"US Dollar"},{id:2,code:"EUR",name:"Euro"},{id:3,code:"GBP",name:"British Pound"}];function xx(){const{id:t}=Ps(),s=Ns(),r=Ba(),a=!t||t==="new",n=r.pathname.includes("purchase-bills-import")?"IMPORT":"LOCAL",[i,l]=v.useState(!1),[o,u]=v.useState(!1),[d,c]=v.useState(""),[m,h]=v.useState([]),[f,x]=v.useState([]),[g,b]=v.useState([]),[y,N]=v.useState([]),[j,S]=v.useState([]),[k,P]=v.useState([]),[I,B]=v.useState([]),[q,Q]=v.useState(null),[O,T]=v.useState([]),[V,D]=v.useState(t&&t!=="new"?Number(t):null),[Y,M]=v.useState({bill_no:"",bill_date:new Date().toISOString().split("T")[0],supplier_id:"",po_id:"",grn_id:"",bill_type:n,due_date:"",currency_id:4,exchange_rate:1,payment_terms:30,status:"DRAFT",discount_amount:0,freight_charges:0,other_charges:0}),[X,R]=v.useState([{id:Date.now(),item_id:"",uom_id:"",qty:0,unit_price:0,discount_percent:0,tax_amount:0,line_total:0}]);v.useEffect(()=>{let oe=!0;return(async()=>{var se,Ae,we,ce,le,_e,Qe,Ie;try{if(a){const xe=n==="IMPORT"?`PIB-${String(1).padStart(6,"0")}`:`PLB-${String(1).padStart(6,"0")}`;M(Ue=>({...Ue,bill_no:xe}))}const[ke,pe,he,je,me]=await Promise.all([te.get("/purchase/suppliers").catch(()=>({data:{items:[]}})),te.get("/purchase/orders").catch(()=>({data:{items:[]}})),te.get("/inventory/items").catch(()=>({data:{items:[]}})),te.get("/inventory/uoms").catch(()=>({data:{items:[]}})),te.get("/finance/tax-codes").catch(()=>({data:{items:[]}}))]);oe&&(h(Array.isArray((se=ke.data)==null?void 0:se.items)?ke.data.items:[]),x(Array.isArray((Ae=pe.data)==null?void 0:Ae.items)?pe.data.items:[]),N(Array.isArray((we=he.data)==null?void 0:we.items)?he.data.items:[]),S(Array.isArray((ce=he.data)==null?void 0:ce.items)?he.data.items:[]),P(Array.isArray((le=je.data)==null?void 0:le.items)?je.data.items:[]),T(Array.isArray((_e=me.data)==null?void 0:_e.items)?me.data.items:[]));try{const xe=await te.get("/purchase/grns",{params:{status:"APPROVED"}});oe&&b(Array.isArray((Qe=xe.data)==null?void 0:Qe.items)?xe.data.items:[])}catch{}try{const xe=await te.get("/finance/currencies");if(oe){const Ue=Array.isArray((Ie=xe.data)==null?void 0:Ie.items)?xe.data.items:[];B(Ue);const ct=Ue.find(dt=>Number(dt.is_base)===1);Q(ct?Number(ct.id):null)}}catch{}}catch{oe&&c("Failed to load lookups")}})(),()=>{oe=!1}},[]),v.useEffect(()=>{if(a)return;let oe=!0;return l(!0),c(""),te.get(`/purchase/bills/${t}`).then(ee=>{var we,ce;if(!oe)return;const se=(we=ee.data)==null?void 0:we.item,Ae=Array.isArray((ce=ee.data)==null?void 0:ce.details)?ee.data.details:[];se&&(M({bill_no:se.bill_no||"",bill_date:se.bill_date?se.bill_date.split("T")[0]:"",supplier_id:se.supplier_id?String(se.supplier_id):"",po_id:se.po_id?String(se.po_id):"",grn_id:se.grn_id?String(se.grn_id):"",bill_type:se.bill_type||n,due_date:se.due_date?se.due_date.split("T")[0]:"",currency_id:se.currency_id||4,exchange_rate:Number(se.exchange_rate)||1,payment_terms:Number(se.payment_terms)||30,status:se.status||"DRAFT",discount_amount:Number(se.discount_amount)||0,freight_charges:Number(se.freight_charges)||0,other_charges:Number(se.other_charges)||0}),R(Ae.length?Ae.map(le=>({id:le.id||Date.now()+Math.random(),item_id:le.item_id?String(le.item_id):"",uom_id:le.uom_id?String(le.uom_id):"",qty:Number(le.qty)||0,unit_price:Number(le.unit_price)||0,discount_percent:Number(le.discount_percent)||0,tax_amount:Number(le.tax_amount)||0,line_total:Number(le.line_total)||0})):[]))}).catch(ee=>{oe&&c("Failed to load purchase bill")}).finally(()=>{oe&&l(!1)}),()=>{oe=!1}},[t,a]);const H=oe=>{const ee=Number(oe.qty)||0,se=Number(oe.unit_price)||0,Ae=Number(oe.discount_percent)||0;let we=Number(oe.tax_amount)||0;const ce=ee*se,le=ce*(Ae/100),_e=ce-le;if(oe.tax_code_id){const Ie=O.find(pe=>String(pe.id)===String(oe.tax_code_id)),ke=Ie&&Number(Ie.rate_percent)||0;we=_e*(ke/100)}const Qe=_e+we;return{...oe,tax_amount:we,line_total:Qe}},W=async(oe,ee)=>{var se;try{const we=(se=(await te.get(`/finance/item-tax/${ee}`)).data)==null?void 0:se.tax;if(!we)return;R(ce=>ce.map(le=>{if(le.id!==oe)return le;const _e=Number(le.qty)||0,Qe=Number(le.unit_price)||0,Ie=Number(le.discount_percent)||0,ke=_e*Qe,pe=ke*(Ie/100),he=ke-pe,je=Number(we.tax_rate)||0,me={...le,tax_code_id:String(we.id),tax_amount:he*(je/100)};return H(me)}))}catch{}},K=(oe,ee,se)=>{R(Ae=>Ae.map(we=>{if(we.id!==oe)return we;let ce={...we,[ee]:se};if(ee==="item_id"){const le=y.find(_e=>String(_e.id)===String(se));if(le&&le.uom){const _e=k.find(Qe=>String(Qe.uom_code)===String(le.uom));ce.uom_id=_e?String(_e.id):""}se&&W(oe,se)}if(ee==="tax_code_id"){const le=O.find(me=>String(me.id)===String(se)),_e=Number(ce.qty)||0,Qe=Number(ce.unit_price)||0,Ie=Number(ce.discount_percent)||0,ke=_e*Qe,pe=ke*(Ie/100),he=ke-pe,je=le&&Number(le.rate_percent)||0;ce.tax_amount=he*(je/100)}return H(ce)}))},_=()=>{R(oe=>[...oe,{id:Date.now(),item_id:"",uom_id:"",qty:0,unit_price:0,discount_percent:0,tax_amount:0,line_total:0}])},F=oe=>{R(ee=>ee.filter(se=>se.id!==oe))},E=async oe=>{var ee,se,Ae,we;try{const ce=await te.get(`/purchase/grns/${oe}`),le=(ee=ce.data)==null?void 0:ee.item,_e=(Ae=(se=ce.data)==null?void 0:se.item)==null?void 0:Ae.details;if(le&&(M(ke=>({...ke,po_id:le.po_id?String(le.po_id):ke.po_id,supplier_id:le.supplier_id?String(le.supplier_id):ke.supplier_id,grn_id:String(oe)})),le.po_id))try{const pe=(we=(await te.get(`/purchase/orders/${le.po_id}`)).data)==null?void 0:we.item;if(pe){const he=String(pe.currency||pe.currency_code||pe.currencyCode||"").toUpperCase(),je=Nm.find(me=>String(me.code).toUpperCase()===he)||Nm[0];M(me=>({...me,currency_id:Number(pe.currency_id)||(je?Number(je.id):me.currency_id),exchange_rate:pe.exchange_rate!=null?Number(pe.exchange_rate||1):me.exchange_rate}))}}catch{}if(Array.isArray(_e)&&_e.length>0){const ke=_e.map(pe=>{const he=k.find(Ue=>Ue.uom_code===pe.uom||Ue.uom_name===pe.uom),je=Number(pe.qty_accepted)||0,me=Number(pe.unit_price)||0,xe=je*me;return{id:Date.now()+Math.random(),item_id:pe.item_id?String(pe.item_id):"",uom_id:he?String(he.id):"",qty:je,unit_price:me,discount_percent:0,tax_amount:0,line_total:xe}});R(ke)}const Ie=Array.from(new Set(_e.map(ke=>ke.item_id?String(ke.item_id):"").filter(Boolean))).map(ke=>y.find(he=>String(he.id)===ke)||{id:ke,item_code:ke,item_name:""});S(Ie)}catch(ce){console.error("Failed to load GRN details",ce)}},L=async oe=>{var Ae,we,ce;const{name:ee,value:se}=oe.target;if(M(le=>({...le,[ee]:se})),ee==="supplier_id")if(se){const le=m.find(Qe=>String(Qe.id)===String(se)),_e=le&&le.supplier_code&&String(le.supplier_code).trim()||(le?`SU-${String(Number(le.id||0)).padStart(6,"0")}`:"");if(_e)try{const Qe=await te.get("/finance/accounts",{params:{search:_e}}),Ie=Array.isArray((Ae=Qe.data)==null?void 0:Ae.items)?Qe.data.items:[],ke=Ie.find(he=>String(he.code)===_e)||Ie[0]||null,pe=ke&&ke.currency_code&&String(ke.currency_code)||null;if(pe){const he=Nm.find(je=>String(je.code).toUpperCase()===pe.toUpperCase())||null;he&&M(je=>({...je,currency_id:Number(he.id)}))}}catch{}}else M(le=>({...le,currency_id:4}));if(ee==="grn_id"&&se?await E(se):ee==="grn_id"&&!se&&S(y),ee==="po_id"&&se){const le=f.find(Ie=>String(Ie.id)===se);let _e=Y.supplier_id;le&&le.supplier_id&&(_e=String(le.supplier_id),M(Ie=>({...Ie,supplier_id:_e})));const Qe=g.filter(Ie=>String(Ie.po_id)===se&&Ie.grn_type===n&&String(Ie.status).toUpperCase()==="APPROVED");Qe.length===1?await E(Qe[0].id):(M(Ie=>{const ke=Qe.find(pe=>String(pe.id)===Ie.grn_id);return{...Ie,supplier_id:_e||Ie.supplier_id,grn_id:ke?Ie.grn_id:""}}),S(y))}if(ee==="currency_id"){const le=Nm.find(pe=>Number(pe.id)===Number(se)),_e=le?String(le.code).toUpperCase():null,Qe=_e&&I.find(pe=>String(pe.code).toUpperCase()===_e.toUpperCase()),Ie=Qe?Number(Qe.id):null,ke=q?Number(q):null;if(!Ie||!ke)M(pe=>({...pe,exchange_rate:1}));else if(Ie===ke)M(pe=>({...pe,exchange_rate:1}));else try{const pe=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Ie,toCurrencyId:ke}}),he=Array.isArray((we=pe.data)==null?void 0:we.items)?pe.data.items:[];if(he.length>0){const je=Number(he[0].rate)||1;M(me=>({...me,exchange_rate:je}))}else{const je=await te.get("/finance/currency-rates",{params:{fromCurrencyId:ke,toCurrencyId:Ie}}),me=Array.isArray((ce=je.data)==null?void 0:ce.items)?je.data.items:[];if(me.length>0){const xe=Number(me[0].rate)||1;M(Ue=>({...Ue,exchange_rate:1/xe}))}else M(xe=>({...xe,exchange_rate:1}))}}catch{M(pe=>({...pe,exchange_rate:1}))}}},U=v.useMemo(()=>{const oe=X.reduce((_e,Qe)=>_e+(Number(Qe.qty)||0)*(Number(Qe.unit_price)||0),0),ee=X.reduce((_e,Qe)=>_e+(Number(Qe.tax_amount)||0),0),se=X.reduce((_e,Qe)=>{const Ie=(Number(Qe.qty)||0)*(Number(Qe.unit_price)||0);return _e+Ie*(Number(Qe.discount_percent)||0)/100},0),Ae=se+(Number(Y.discount_amount)||0),we=Number(Y.freight_charges)||0,ce=Number(Y.other_charges)||0,le=oe-Ae+ee+we+ce;return{subTotal:oe,itemDiscounts:se,lineTaxTotal:ee,grandTotal:le}},[X,Y.discount_amount,Y.freight_charges,Y.other_charges]),J=async()=>{var oe,ee,se;if(!Y.bill_date){c("Bill Date is required");return}if(!Y.supplier_id){c("Supplier is required");return}if(!Y.grn_id){c("GRN is required for posting");return}if(X.length===0||!X.some(Ae=>Ae.item_id)){c("At least one item is required");return}try{u(!0);const Ae={...Y,bill_no:Y.bill_no||void 0,supplier_id:Number(Y.supplier_id),po_id:Y.po_id?Number(Y.po_id):null,grn_id:Y.grn_id?Number(Y.grn_id):null,currency_id:Number(Y.currency_id),exchange_rate:Number(Y.exchange_rate),payment_terms:Number(Y.payment_terms),discount_amount:Number(Y.discount_amount),freight_charges:Number(Y.freight_charges),other_charges:Number(Y.other_charges),status:"DRAFT",details:X.filter(le=>le.item_id).map(le=>({item_id:Number(le.item_id),uom_id:le.uom_id?Number(le.uom_id):null,qty:Number(le.qty)||0,unit_price:Number(le.unit_price)||0,discount_percent:Number(le.discount_percent)||0,tax_amount:Number(le.tax_amount)||0,line_total:Number(le.line_total)||0}))};let we=null;if(V)await te.put(`/purchase/bills/${V}`,Ae);else{const le=await te.post("/purchase/bills",Ae);we=Number(((oe=le==null?void 0:le.data)==null?void 0:oe.id)||0)||null,we&&D(we)}const ce=V||we;if(!ce){c("Bill not found for posting");return}await te.post(`/purchase/bills/${ce}/post`,{}),M(le=>({...le,status:"POSTED"})),s(`/purchase/purchase-bills-${n.toLowerCase()}`)}catch(Ae){c(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Posting failed")}finally{u(!1)}},ae=()=>{M(oe=>({...oe,supplier_id:"",po_id:"",grn_id:"",due_date:"",currency_id:4,exchange_rate:1,payment_terms:30,discount_amount:0,freight_charges:0,other_charges:0})),R([{id:Date.now(),item_id:"",uom_id:"",qty:0,unit_price:0,discount_percent:0,tax_amount:0,line_total:0}])},Z=`/purchase/purchase-bills-${n.toLowerCase()}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[a?"New":"Edit"," Purchase Bill - ",n]}),e.jsx("p",{className:"text-sm mt-1",children:"Record and manage supplier bills"})]}),e.jsx(Ee,{to:Z,className:"btn-secondary",children:"Back to List"})]}),i&&e.jsx("div",{className:"p-4 bg-white rounded shadow",children:"Loading..."}),d&&e.jsx("div",{className:"p-4 text-red-600 bg-white rounded shadow",children:d}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg px-4 py-2",children:e.jsx("h3",{className:"font-semibold",children:"Invoice Information"})}),e.jsxs("div",{className:"card-body p-4 grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Invoice Type"}),e.jsxs("select",{className:"input",value:Y.bill_type,disabled:!0,children:[e.jsx("option",{value:"LOCAL",children:"Local"}),e.jsx("option",{value:"IMPORT",children:"Import"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Bill No"}),e.jsx("input",{className:"input bg-gray-100",value:Y.bill_no,placeholder:"Auto-generated",disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label required",children:"Bill Date"}),e.jsx("input",{type:"date",className:"input",name:"bill_date",value:Y.bill_date,onChange:L})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label required",children:"Supplier"}),e.jsxs("select",{className:"input",name:"supplier_id",value:Y.supplier_id,onChange:L,children:[e.jsx("option",{value:"",children:"-- Select Supplier --"}),m.map(oe=>e.jsx("option",{value:oe.id,children:oe.supplier_name},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Related PO"}),e.jsxs("select",{className:"input",name:"po_id",value:Y.po_id,onChange:L,children:[e.jsx("option",{value:"",children:"-- Select PO --"}),f.filter(oe=>(!Y.supplier_id||String(oe.supplier_id)===String(Y.supplier_id))&&oe.po_type===n).map(oe=>e.jsx("option",{value:oe.id,children:oe.po_no},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Related GRN"}),e.jsxs("select",{className:"input",name:"grn_id",value:Y.grn_id,onChange:L,children:[e.jsx("option",{value:"",children:"-- Select GRN --"}),g.filter(oe=>(!Y.supplier_id||String(oe.supplier_id)===String(Y.supplier_id))&&(!Y.po_id||String(oe.po_id)===String(Y.po_id))&&oe.grn_type===n&&String(oe.status).toUpperCase()==="APPROVED").map(oe=>e.jsx("option",{value:oe.id,children:oe.grn_no},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{type:"date",className:"input",name:"due_date",value:Y.due_date,onChange:L})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("select",{className:"input",name:"currency_id",value:Y.currency_id,onChange:L,children:Nm.map(oe=>e.jsx("option",{value:oe.id,children:oe.code},oe.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{type:"number",className:"input text-right",name:"exchange_rate",value:Y.exchange_rate,onChange:L,step:"0.000001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",className:"input text-right",name:"payment_terms",value:Y.payment_terms,onChange:L})]}),e.jsx("div",{className:"form-group"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg px-4 py-2 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:"Items"}),e.jsx("button",{type:"button",className:"btn-success text-xs",onClick:_,children:"+ Add Item"})]}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-1/4",children:"Item"}),e.jsx("th",{className:"w-28 text-right",children:"Qty"}),e.jsx("th",{className:"w-36 text-right",children:"UOM"}),e.jsx("th",{className:"w-32 text-right",children:"Unit Price"}),e.jsx("th",{className:"w-28 text-right",children:"Disc %"}),e.jsx("th",{className:"w-40 text-right",children:"Tax Amt"}),e.jsx("th",{className:"w-32 text-right",children:"Net Amount"}),e.jsx("th",{className:"w-16",children:"Action"})]})}),e.jsx("tbody",{children:X.map(oe=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input text-sm w-full",value:oe.item_id,onChange:ee=>K(oe.id,"item_id",ee.target.value),children:[e.jsx("option",{value:"",children:"Select Item"}),j.map(ee=>e.jsxs("option",{value:String(ee.id),children:[ee.item_code," - ",ee.item_name]},ee.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right text-sm w-full",value:oe.qty,onChange:ee=>K(oe.id,"qty",ee.target.value)})}),e.jsx("td",{children:e.jsxs("select",{className:"input text-sm w-full",value:oe.uom_id,onChange:ee=>K(oe.id,"uom_id",ee.target.value),children:[e.jsx("option",{value:"",children:"Select UOM"}),k.map(ee=>e.jsx("option",{value:String(ee.id),children:ee.uom_name?`${ee.uom_name} (${ee.uom_code})`:ee.uom_code},ee.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right text-sm w-full",value:oe.unit_price,onChange:ee=>K(oe.id,"unit_price",ee.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right text-sm w-full",value:oe.discount_percent,onChange:ee=>K(oe.id,"discount_percent",ee.target.value)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"input text-sm w-full",value:oe.tax_code_id||"",onChange:ee=>K(oe.id,"tax_code_id",ee.target.value),children:[e.jsx("option",{value:"",children:"No Tax"}),O.map(ee=>e.jsx("option",{value:String(ee.id),children:ee.name},ee.id))]}),e.jsx("span",{className:"text-right w-32",children:Number(oe.tax_amount||0).toFixed(2)})]})}),e.jsx("td",{className:"text-right font-medium",children:Number(oe.line_total).toFixed(2)}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",onClick:()=>F(oe.id),title:"Remove",children:e.jsx(fI,{size:16})})})]},oe.id))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"hidden md:block"}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-gray-100 px-4 py-2 border-b",children:e.jsx("h3",{className:"font-semibold text-gray-700",children:"Summary"})}),e.jsxs("div",{className:"card-body p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Sub Total:"}),e.jsx("span",{className:"font-semibold",children:U.subTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center text-red-600",children:[e.jsx("span",{className:"text-gray-600",children:"Discount Amount (Items + Global):"}),e.jsxs("span",{children:["-"," ",(U.itemDiscounts+Number(Y.discount_amount)||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Global Discount Input:"}),e.jsx("input",{type:"number",className:"input w-32 text-right",name:"discount_amount",value:Y.discount_amount,onChange:L})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Tax Amount:"}),e.jsx("span",{className:"font-semibold",children:U.lineTaxTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Freight Charges:"}),e.jsx("input",{type:"number",className:"input w-32 text-right",name:"freight_charges",value:Y.freight_charges,onChange:L})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Other Charges:"}),e.jsx("input",{type:"number",className:"input w-32 text-right",name:"other_charges",value:Y.other_charges,onChange:L})]}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{children:"Grand Total:"}),e.jsx("span",{children:U.grandTotal.toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-end",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:ae,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-success",onClick:J,disabled:o,children:"Post"})]})]})}function lJ(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let d=!0;return i(!0),o(""),te.get("/purchase/suppliers").then(c=>{var m;d&&a(Array.isArray((m=c.data)==null?void 0:m.items)?c.data.items:[])}).catch(c=>{var m,h;d&&o(((h=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load suppliers")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=v.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.supplier_code||"").toLowerCase().includes(d)||String(c.supplier_name||"").toLowerCase().includes(d)||String(c.phone||"").toLowerCase().includes(d)||String(c.email||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Supplier Details Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Add and manage supplier master data"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/suppliers/new",className:"btn-success",children:"+ New Supplier"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, phone, email...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No suppliers found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.supplier_code||"-"}),e.jsx("td",{children:d.supplier_name}),e.jsx("td",{children:d.phone||"-"}),e.jsx("td",{children:d.email||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d.is_active?"badge-success":"badge-error"}`,children:d.is_active?"ACTIVE":"INACTIVE"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/purchase/suppliers/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/suppliers/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function lS(){const{id:t}=Ps(),s=Ns(),r=!t||t==="new",a=v.useRef(null),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState("basic"),[x,g]=v.useState([]),[b,y]=v.useState({supplier_code:"",supplier_name:"",contact_person:"",email:"",phone:"",address:"",payment_terms:"",is_active:!0,supplier_type:"LOCAL",tax_id:"",business_reg_no:"",industry:"",website:"",city:"",country:"GH",currency_id:"",credit_limit:"",bank_name:"",bank_account:"",swift_code:""});v.useEffect(()=>{if(r)return;let P=!0;return i(!0),d(""),te.get(`/purchase/suppliers/${t}`).then(I=>{var q;if(!P)return;const B=(q=I.data)==null?void 0:q.item;B&&y(Q=>({...Q,supplier_code:B.supplier_code||"",supplier_name:B.supplier_name||"",contact_person:B.contact_person||"",email:B.email||"",phone:B.phone||"",address:B.address||"",payment_terms:B.payment_terms||"",is_active:!!B.is_active,supplier_type:B.supplier_type||Q.supplier_type||"LOCAL"}))}).catch(I=>{var B,q;P&&d(((q=(B=I==null?void 0:I.response)==null?void 0:B.data)==null?void 0:q.message)||"Failed to load supplier")}).finally(()=>{P&&i(!1)}),()=>{P=!1}},[t,r]),v.useEffect(()=>{if(!r)return;(async()=>{var I,B,q;try{const Q=await te.get("/purchase/suppliers/next-code");if((I=Q.data)!=null&&I.code){y(O=>({...O,supplier_code:Q.data.code}));return}}catch(Q){console.error("Failed to fetch next supplier code",Q)}try{const Q=await te.get("/purchase/suppliers"),O=Array.isArray((B=Q.data)==null?void 0:B.items)?Q.data.items:[],T=await te.get("/finance/accounts",{params:{search:"SU-"}}),V=Array.isArray((q=T.data)==null?void 0:q.items)?T.data.items:[];let D=0;for(const M of O){const X=String(M.supplier_code||"").match(/^SU-(\d{6})$/);if(X){const R=Number(X[1]);Number.isFinite(R)&&R>D&&(D=R)}}for(const M of V){const X=String(M.code||"").match(/^SU-(\d{6})$/);if(X){const R=Number(X[1]);Number.isFinite(R)&&R>D&&(D=R)}}const Y=`SU-${String(D+1).padStart(6,"0")}`;y(M=>({...M,supplier_code:Y}))}catch{}})()},[r]),v.useEffect(()=>{(async()=>{var I;try{const B=await te.get("/finance/currencies"),q=Array.isArray((I=B.data)==null?void 0:I.items)?B.data.items:[];g(q);const Q=q.find(O=>Number(O.is_base)===1)||q.find(O=>String(O.code||O.currency_code||"").toUpperCase()==="GHS")||q.find(O=>/ghana|cedi/i.test(String(O.name||O.currency_name||"")));Q&&y(O=>({...O,currency_id:O.currency_id||String(Q.id||"")}))}catch(B){console.error("Failed to fetch currencies",B)}})()},[]);const N=P=>{const{name:I,value:B,type:q,checked:Q}=P.target;y(O=>({...O,[I]:q==="checkbox"?Q:B}))},j=async P=>{var I,B;P.preventDefault(),o(!0),d(""),m("");try{const q={supplier_code:b.supplier_code||null,supplier_name:b.supplier_name,contact_person:b.contact_person||null,email:b.email||null,phone:b.phone||null,address:b.address||null,payment_terms:b.payment_terms||null,is_active:!!b.is_active,supplier_type:b.supplier_type||"LOCAL",currency_id:b.currency_id===void 0||b.currency_id===null?null:String(b.currency_id||"")};r?await te.post("/purchase/suppliers",q):await te.put(`/purchase/suppliers/${t}`,q),m("Supplier saved successfully!"),r&&s("/purchase/suppliers")}catch(q){d(((B=(I=q==null?void 0:q.response)==null?void 0:I.data)==null?void 0:B.message)||"Failed to save supplier")}finally{o(!1)}},S=()=>{const I="data:text/csv;charset=utf-8,"+["supplier_name","supplier_code","contact_person","email","phone","address","payment_terms"].join(",")+`
Example Supplier,SUP001,John Doe,john@example.com,1234567890,123 Main St,30 Days`,B=encodeURI(I),q=document.createElement("a");q.setAttribute("href",B),q.setAttribute("download","supplier_template.csv"),document.body.appendChild(q),q.click(),document.body.removeChild(q)},k=P=>{const I=P.target.files[0];if(!I)return;const B=new FileReader;B.onload=async q=>{const O=q.target.result.split(`
`).map(M=>M.trim()).filter(M=>M);if(O.length<2){d("Invalid CSV format or empty file");return}const T=O[0].split(",").map(M=>M.trim()),V=O.slice(1);let D=0,Y=0;i(!0);for(const M of V){const X=M.split(",").map(H=>H.trim());if(X.length<1)continue;const R={};if(T.forEach((H,W)=>{X[W]&&(R[H]=X[W])}),!R.supplier_name){Y++;continue}try{await te.post("/purchase/suppliers",{supplier_name:R.supplier_name,supplier_code:R.supplier_code||null,contact_person:R.contact_person||null,email:R.email||null,phone:R.phone||null,address:R.address||null,payment_terms:R.payment_terms||null,is_active:!0}),D++}catch(H){console.error("Failed to upload row",M,H),Y++}}i(!1),m(`Mass upload completed. Success: ${D}, Failed: ${Y}`),a.current&&(a.current.value="")},B.readAsText(I)};return e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden my-6",children:[e.jsxs("div",{className:"text-white p-8",style:{background:"linear-gradient(135deg, #0E3646 0%, #0E3646 100%)"},children:[e.jsx("h1",{className:"text-3xl font-bold",children:" Supplier Setup & Configuration"}),e.jsx("p",{className:"mt-2 text-slate-300",children:"Manage supplier information, contacts, and performance"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center p-6 bg-slate-50 border-b border-slate-200 gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("input",{type:"text",className:"w-full pl-3 pr-10 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Search suppliers..."}),e.jsx("span",{className:"absolute right-3 top-2.5 text-slate-400",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",onClick:S,children:" Template"}),e.jsx("button",{type:"button",className:"bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",onClick:()=>{var P;return(P=a.current)==null?void 0:P.click()},children:" Mass Upload"}),e.jsx("input",{type:"file",ref:a,className:"hidden",accept:".csv",onChange:k}),!r&&e.jsx("button",{type:"button",className:"text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",style:{backgroundColor:"#0E3646"},onClick:()=>{y({supplier_code:"",supplier_name:"",contact_person:"",email:"",phone:"",address:"",payment_terms:"",is_active:!0,supplier_type:"LOCAL",tax_id:"",business_reg_no:"",industry:"",website:"",city:"",country:"GH",currency:"GHS",credit_limit:"",bank_name:"",bank_account:"",swift_code:""}),s("/purchase/suppliers/new")},children:" New Supplier"}),e.jsx(Ee,{to:"/purchase/suppliers",className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",children:" View All"})]})]}),e.jsxs("div",{className:"p-8",children:[n&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),u&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-md mb-6",children:u}),c&&e.jsx("div",{className:"bg-green-50 text-green-600 p-4 rounded-md mb-6",children:c}),e.jsxs("form",{onSubmit:j,children:[e.jsx("div",{className:"flex border-b-2 border-slate-200 mb-8 overflow-x-auto",children:[{id:"basic",label:" Basic Information"},{id:"financial",label:" Financial Details"},{id:"documents",label:" Documents"}].map(P=>e.jsx("button",{type:"button",className:`px-6 py-3 font-medium whitespace-nowrap transition-colors border-b-2 -mb-[2px] ${h===P.id?"border-[#0E3646] text-[#0E3646]":"border-transparent text-slate-500 hover:bg-slate-50"}`,onClick:()=>f(P.id),children:P.label},P.id))}),e.jsxs("div",{className:h==="basic"?"block":"hidden",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Supplier Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Supplier Code"}),e.jsx("input",{type:"text",name:"supplier_code",className:`w-full px-3 py-2 border border-slate-300 rounded-md ${r?"bg-gray-50":"bg-gray-100 text-slate-500"}`,value:b.supplier_code,onChange:N,placeholder:r?"Auto-generated":"Locked for existing supplier",readOnly:!r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Supplier Name *"}),e.jsx("input",{type:"text",name:"supplier_name",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-transparent outline-none",value:b.supplier_name,onChange:N,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Supplier Type"}),e.jsxs("select",{name:"supplier_type",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.supplier_type,onChange:N,children:[e.jsx("option",{value:"LOCAL",children:"Local Supplier"}),e.jsx("option",{value:"IMPORT",children:"Import Supplier"}),e.jsx("option",{value:"BOTH",children:"Both"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Status"}),e.jsxs("select",{name:"is_active",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.is_active,onChange:P=>N({target:{name:"is_active",value:P.target.value==="true"}}),children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Tax Registration Number"}),e.jsx("input",{type:"text",name:"tax_id",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.tax_id,onChange:N,placeholder:"TIN/VAT number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Industry"}),e.jsxs("select",{name:"industry",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.industry,onChange:N,children:[e.jsx("option",{value:"",children:"Select Industry"}),e.jsx("option",{value:"MANUFACTURING",children:"Manufacturing"}),e.jsx("option",{value:"TRADING",children:"Trading"}),e.jsx("option",{value:"SERVICES",children:"Services"})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Website"}),e.jsx("input",{type:"url",name:"website",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.website,onChange:N,placeholder:"https://www.supplier.com"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Address & Contact"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Address"}),e.jsx("textarea",{name:"address",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.address,onChange:N,placeholder:"Street address"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"city",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.city,onChange:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Country"}),e.jsxs("select",{name:"country",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.country,onChange:N,children:[e.jsx("option",{value:"GH",children:"Ghana"}),e.jsx("option",{value:"NG",children:"Nigeria"}),e.jsx("option",{value:"CN",children:"China"}),e.jsx("option",{value:"US",children:"United States"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.phone,onChange:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.email,onChange:N})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Contact Person (Primary)"}),e.jsx("input",{type:"text",name:"contact_person",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.contact_person,onChange:N})]})})]})]}),e.jsxs("div",{className:h==="financial"?"block":"hidden",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Payment & Financial Terms"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Default Currency"}),e.jsxs("select",{name:"currency_id",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.currency_id,onChange:N,children:[e.jsx("option",{value:"",children:"Select currency"}),x.map(P=>e.jsx("option",{value:P.id,children:(P.code||P.currency_code)+" - "+(P.name||P.currency_name||"")},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Payment Terms (Days)"}),e.jsx("input",{type:"text",name:"payment_terms",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.payment_terms,onChange:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Credit Limit"}),e.jsx("input",{type:"number",name:"credit_limit",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.credit_limit,onChange:N})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bank_name",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.bank_name,onChange:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",name:"bank_account",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.bank_account,onChange:N})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"SWIFT Code"}),e.jsx("input",{type:"text",name:"swift_code",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.swift_code,onChange:N})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Financial Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"GHS 250,000"}),e.jsx("div",{className:"text-sm opacity-90",children:"Total Purchases YTD"})]}),e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"15"}),e.jsx("div",{className:"text-sm opacity-90",children:"Purchase Orders"})]}),e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"GHS 45,000"}),e.jsx("div",{className:"text-sm opacity-90",children:"Outstanding Balance"})]}),e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"28 Days"}),e.jsx("div",{className:"text-sm opacity-90",children:"Avg Payment Time"})]})]})]})]}),e.jsx("div",{className:h==="documents"?"block":"hidden",children:e.jsx("div",{className:"text-center py-10 text-slate-500 bg-slate-50 rounded-lg border border-dashed border-slate-300",children:e.jsx("p",{children:"Document Management coming soon."})})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-slate-200 mt-6",children:[e.jsx(Ee,{to:"/purchase/suppliers",className:"px-6 py-2 border border-slate-300 rounded-md text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",className:"px-6 py-2 text-white rounded-md transition-colors",style:{backgroundColor:"#2E8B1F"},onClick:()=>{window.confirm("Activate this supplier?")&&alert("Supplier activated successfully!")},children:" Activate"}),e.jsx("button",{type:"submit",className:"px-6 py-2 text-white rounded-md transition-colors disabled:opacity-50",style:{backgroundColor:"#0E3646"},disabled:l,children:l?"Saving...":" Save Supplier"})]})]})]})]})}function oJ(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState("");v.useEffect(()=>{let d=!0;return i(!0),o(""),te.get("/purchase/service-confirmations").then(c=>{var m;d&&a(Array.isArray((m=c.data)==null?void 0:m.items)?c.data.items:[])}).catch(c=>{var m,h;d&&o(((h=(m=c==null?void 0:c.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load service confirmations")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=v.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.sc_no||"").toLowerCase().includes(d)||String(c.supplier_name||"").toLowerCase().includes(d)||String(c.status||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Service Confirmation"}),e.jsx("p",{className:"text-sm mt-1",children:"Confirm service receipts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/purchase/service-confirmation/new",className:"btn-success",children:"+ New Confirmation"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by no, supplier, status...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No confirmations found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.sc_no}),e.jsx("td",{children:d.sc_date?String(d.sc_date).slice(0,10):"-"}),e.jsx("td",{children:d.supplier_name||"-"}),e.jsx("td",{children:Number(d.total_amount||0).toFixed(2)}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:d.status||"DRAFT"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:`/purchase/service-confirmation/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/purchase/service-confirmation/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"})]})})]},d.id))]})]})})]})]})})}function fb(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function cJ(){const{id:t}=Ps(),s=Ns(),r=t==="new",[a,n]=v.useState(new Date),[i,l]=v.useState(!1),[o,u]=v.useState(!1),[d,c]=v.useState(""),[m,h]=v.useState([]),[f,x]=v.useState({sc_no:"",sc_date:fb(new Date),supplier_id:"",status:"DRAFT",remarks:"",details:[]}),[g,b]=v.useState(""),[y,N]=v.useState(0);v.useEffect(()=>{let Y=!0;return te.get("/purchase/suppliers").then(M=>{var X;Y&&h(Array.isArray((X=M.data)==null?void 0:X.items)?M.data.items:[])}).catch(M=>{var X,R;Y&&c(((R=(X=M==null?void 0:M.response)==null?void 0:X.data)==null?void 0:R.message)||"Failed to load suppliers")}),()=>{Y=!1}},[]),v.useEffect(()=>{const Y=setInterval(()=>n(new Date),1e3);return()=>clearInterval(Y)},[]),v.useEffect(()=>{if(r)return;let Y=!0;return l(!0),c(""),te.get(`/purchase/service-confirmations/${t}`).then(M=>{var H,W;if(!Y)return;const X=(H=M.data)==null?void 0:H.item,R=Array.isArray((W=M.data)==null?void 0:W.details)?M.data.details:[];X&&x({sc_no:X.sc_no||"",sc_date:fb(X.sc_date),supplier_id:X.supplier_id?String(X.supplier_id):"",status:X.status||"DRAFT",remarks:X.remarks||"",details:R.map(K=>({description:K.description||"",qty:K.qty??"",unit_price:K.unit_price??""}))})}).catch(M=>{var X,R;Y&&c(((R=(X=M==null?void 0:M.response)==null?void 0:X.data)==null?void 0:R.message)||"Failed to load service confirmation")}).finally(()=>{Y&&l(!1)}),()=>{Y=!1}},[t,r]);const j=v.useMemo(()=>[{key:"diagnosis",name:"Diagnosis",icon:"",price:50},{key:"repair",name:"Repair",icon:"",price:150},{key:"maintenance",name:"Maintenance",icon:"",price:100},{key:"installation",name:"Installation",icon:"",price:200},{key:"consultation",name:"Consultation",icon:"",price:75},{key:"upgrade",name:"Upgrade",icon:"",price:220}],[]),S=v.useMemo(()=>{const Y=f.details||[];let M=0;for(const X of Y){const R=Number(X.qty),H=Number(X.unit_price);!Number.isFinite(R)||!Number.isFinite(H)||(M+=R*H)}return M},[f.details]),k=v.useMemo(()=>S*.125,[S]),P=v.useMemo(()=>S+k,[S,k]),I=v.useMemo(()=>P*(Number(y)/100),[P,y]),B=Y=>{x(M=>({...M,details:M.details.filter((X,R)=>R!==Y)}))},q=(Y,M)=>{x(X=>({...X,details:X.details.map((R,H)=>H===Y?{...R,...M}:R)}))},Q=Y=>{const M=f.details.findIndex(X=>String(X.description||"").trim()===Y.name);if(M>=0){B(M);return}x(X=>({...X,details:[...X.details,{description:Y.name,qty:1,unit_price:Y.price}]}))},O=Y=>f.details.some(M=>String(M.description||"").trim()===Y.name),T=async Y=>{var M,X;Y&&typeof Y.preventDefault=="function"&&Y.preventDefault(),u(!0),c("");try{const R={sc_no:f.sc_no||null,sc_date:f.sc_date,supplier_id:f.supplier_id?Number(f.supplier_id):null,status:f.status||"DRAFT",remarks:f.remarks||null,details:(f.details||[]).map(H=>({description:String(H.description||"").trim(),qty:H.qty===""?null:Number(H.qty),unit_price:H.unit_price===""?null:Number(H.unit_price)}))};if(!R.sc_date||!R.supplier_id)throw new Error("Date and supplier are required");r?await te.post("/purchase/service-confirmations",R):await te.put(`/purchase/service-confirmations/${t}`,R),s("/purchase/service-confirmation")}catch(R){c(((X=(M=R==null?void 0:R.response)==null?void 0:M.data)==null?void 0:X.message)||(R==null?void 0:R.message)||"Failed to save service confirmation")}finally{u(!1)}},V=v.useMemo(()=>{const Y=f.supplier_id?Number(f.supplier_id):null;if(!Y)return"";const M=m.find(X=>Number(X.id)===Y);return M&&M.supplier_name||""},[f.supplier_id,m]),D=()=>{x({sc_no:"",sc_date:fb(new Date),supplier_id:"",status:"DRAFT",remarks:"",details:[]}),b(""),N(0)};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Service Confirmation":"Edit Service Confirmation"}),e.jsx("p",{className:"text-sm mt-1",children:"Confirm service receipts"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm",children:a.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold",children:a.toLocaleTimeString()})]})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"No"}),e.jsx("input",{type:"text",className:"input",value:f.sc_no,onChange:Y=>x({...f,sc_no:Y.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{type:"date",className:"input",value:f.sc_date,onChange:Y=>x({...f,sc_date:Y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:f.status,onChange:Y=>x({...f,status:Y.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"CONFIRMED",children:"CONFIRMED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{className:"input",value:f.supplier_id,onChange:Y=>x({...f,supplier_id:Y.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select supplier..."}),m.map(Y=>e.jsx("option",{value:String(Y.id),children:(Y.supplier_code?`${Y.supplier_code} - `:"")+Y.supplier_name},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Time"}),e.jsx("input",{type:"time",className:"input",value:g,onChange:Y=>b(Y.target.value)})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Select Services"}),e.jsx("div",{className:"rounded-lg border border-sky-200 bg-sky-50 text-sky-900 p-3 text-sm",children:"Click on services to select them. You can select multiple services."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3",children:j.map(Y=>{const M=O(Y);return e.jsxs("button",{type:"button",className:`p-4 rounded-lg border transition-colors text-left ${M?"border-brand-500 bg-brand text-white":"border-slate-200 bg-white hover:bg-slate-800 hover:text-white"}`,onClick:()=>Q(Y),children:[e.jsx("div",{className:"text-2xl",children:Y.icon}),e.jsx("div",{className:"font-semibold mt-1",children:Y.name}),e.jsx("div",{className:"mt-2 font-bold",children:`GH ${Number(Y.price).toFixed(2)}`})]},Y.key)})})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:f.remarks,onChange:Y=>x({...f,remarks:Y.target.value})})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Service Summary"})}),e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"flex justify-between py-1 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm",children:"Supplier"}),e.jsx("div",{className:"text-sm font-semibold",children:V||"-"})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm",children:"Appointment"}),e.jsx("div",{className:"text-sm font-semibold",children:(f.sc_date||"")+(g?` ${g}`:"")})]}),e.jsxs("div",{className:"flex justify-between py-1",children:[e.jsx("div",{className:"text-sm",children:"Location"}),e.jsx("div",{className:"text-sm font-semibold",children:"In Shop"})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Selected Services"}),f.details.length?e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:f.details.map((Y,M)=>{const X=Math.max(1,Number(Y.qty||1)),R=Number(Y.unit_price||0),H=X*R;return e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-medium text-brand-700",children:Y.description}),e.jsx("div",{className:"font-semibold",children:`GH ${H.toFixed(2)}`})]}),e.jsx("div",{className:"text-xs text-slate-600",children:`GH ${R.toFixed(2)}  ${X}`}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("button",{type:"button",className:"btn-secondary btn-sm",onClick:()=>q(M,{qty:Math.max(1,X-1)}),children:"-"}),e.jsx("span",{className:"text-sm font-semibold",children:X}),e.jsx("button",{type:"button",className:"btn-secondary btn-sm",onClick:()=>q(M,{qty:X+1}),children:"+"}),e.jsx("button",{type:"button",className:"btn-danger btn-sm ml-auto",onClick:()=>B(M),children:"Remove"})]})]},M)})}):e.jsxs("div",{className:"text-center text-slate-600 p-6",children:[e.jsx("div",{className:"text-3xl",children:""}),e.jsx("div",{className:"text-sm mt-2",children:"No services selected"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Cost Summary"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Services Subtotal"}),e.jsx("div",{children:`GH ${S.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax (12.5%)"}),e.jsx("div",{children:`GH ${k.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-bold",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{children:`GH ${P.toFixed(2)}`})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Deposit"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[0,25,50,75,100].map(Y=>{const M=Number(y)===Y;return e.jsxs("button",{type:"button",className:`p-2 rounded border ${M?"border-brand-500 bg-brand text-white":"border-brand-500 text-brand"}`,onClick:()=>N(Y),children:[Y,"% Deposit"]},Y)})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Deposit Amount"}),e.jsx("div",{className:"font-semibold",children:`GH ${I.toFixed(2)}`})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx(Ee,{to:"/purchase/service-confirmation",className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>window.print(),children:"Print Summary"}),e.jsx("button",{type:"button",className:"btn-success",onClick:T,disabled:o,children:o?"Saving...":"Save Confirmation"})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn-secondary w-full",onClick:D,children:"Reset Form"})})]})})]})]})})]})})}function gx({number:t,title:s}){return e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-100 text-brand-700 flex items-center justify-center font-semibold",children:t}),e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s})]})}function dJ(){const[t,s]=v.useState({fullName:"",email:"",phone:"",company:"",address:"",serviceType:"",department:"",requestTitle:"",description:"",priority:"",preferredDate:"",preferredTime:"",contactMethod:"email",recurring:"no",additionalNotes:"",terms:!1}),[r,a]=v.useState([]),[n,i]=v.useState(!1),[l,o]=v.useState(!1),[u,d]=v.useState({id:null,request_no:""}),[c,m]=v.useState(!1),h=v.useMemo(()=>["fullName","email","phone","serviceType","requestTitle","description","priority","terms"],[]),f=v.useMemo(()=>{let k=0;for(const P of h){const I=t[P];P==="terms"?I===!0&&k++:typeof I=="string"&&I.trim()!==""&&k++}return Math.round(k/h.length*100)},[t,h]);function x(k,P){s(I=>({...I,[k]:P}))}function g(k){const P=Array.from(k.target.files||[]);b(P),k.target.value=""}function b(k){const P=[...r];for(const I of k){if(I.size>10*1024*1024){alert(`File ${I.name} is too large. Max size is 10MB.`);continue}P.push(I)}a(P)}function y(k){a(P=>P.filter(I=>I.name!==k))}function N(){const P=Date.now().toString().slice(-6),I=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`SR-${P}-${I}`}function j(){s({fullName:"",email:"",phone:"",company:"",address:"",serviceType:"",department:"",requestTitle:"",description:"",priority:"",preferredDate:"",preferredTime:"",contactMethod:"email",recurring:"no",additionalNotes:"",terms:!1}),a([])}function S(k){if(k.preventDefault(),h.filter(B=>{const q=t[B];return B==="terms"?!q:!String(q||"").trim()}).length){alert("Please complete all required fields.");return}if(c)return;m(!0);const I={full_name:t.fullName,email:t.email,phone:t.phone,company:t.company||null,address:t.address||null,service_type:t.serviceType,department:t.department||null,request_title:t.requestTitle,description:t.description,priority:t.priority||"low",preferred_date:t.preferredDate||null,preferred_time:t.preferredTime||null,contact_method:t.contactMethod||"email",recurring:t.recurring||"no",additional_notes:t.additionalNotes||null,agreed_terms:t.terms?1:0,attachments:r.map(B=>({name:B.name,size:B.size,type:B.type}))};te.post("/purchase/service-requests",I).then(B=>{var O,T;const q=((O=B==null?void 0:B.data)==null?void 0:O.id)||null,Q=((T=B==null?void 0:B.data)==null?void 0:T.request_no)||"";d({id:q,request_no:Q}),o(!0)}).catch(B=>{var q,Q;alert(((Q=(q=B==null?void 0:B.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to submit request. Please try again.")}).finally(()=>{m(!1)})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/purchase",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Purchase"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Service Request"}),e.jsx("p",{className:"text-sm mt-1",children:"Submit your service request and we will get back to you shortly"})]}),e.jsxs("div",{className:"w-64",children:[e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-brand-600 transition-all",style:{width:`${f}%`}})}),e.jsxs("div",{className:"text-xs mt-1 text-right",children:[f,"%"]})]})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx(gx,{number:"1",title:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Full Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:t.fullName,onChange:k=>x("fullName",k.target.value),placeholder:"John Doe"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Email Address ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"email",value:t.email,onChange:k=>x("email",k.target.value),placeholder:"john.doe@example.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Phone Number ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"tel",value:t.phone,onChange:k=>x("phone",k.target.value),placeholder:"+233 555 123 456"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company/Organization"}),e.jsx("input",{className:"input",value:t.company,onChange:k=>x("company",k.target.value),placeholder:"ABC Corporation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("input",{className:"input",value:t.address,onChange:k=>x("address",k.target.value),placeholder:"Street Address, City, State, ZIP"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx(gx,{number:"2",title:"Service Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Service Type ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{className:"input",value:t.serviceType,onChange:k=>x("serviceType",k.target.value),children:[e.jsx("option",{value:"",children:"Select Service Type"}),e.jsx("option",{value:"maintenance",children:"Maintenance & Repair"}),e.jsx("option",{value:"installation",children:"Installation"}),e.jsx("option",{value:"consultation",children:"Consultation"}),e.jsx("option",{value:"technical",children:"Technical Support"}),e.jsx("option",{value:"upgrade",children:"Upgrade/Enhancement"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsxs("select",{className:"input",value:t.department,onChange:k=>x("department",k.target.value),children:[e.jsx("option",{value:"",children:"Select Department"}),e.jsx("option",{value:"it",children:"IT Department"}),e.jsx("option",{value:"facilities",children:"Facilities Management"}),e.jsx("option",{value:"hr",children:"Human Resources"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"operations",children:"Operations"}),e.jsx("option",{value:"customer",children:"Customer Service"})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Request Title ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:t.requestTitle,onChange:k=>x("requestTitle",k.target.value),placeholder:"Brief title of your request"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Detailed Description ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{className:"input min-h-28",value:t.description,onChange:k=>x("description",k.target.value),placeholder:"Provide a detailed description of your service request..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Priority Level ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[{key:"low",label:"Low",hint:"Can wait a few days"},{key:"medium",label:"Medium",hint:"Within 24-48 hours"},{key:"high",label:"High",hint:"Urgent - ASAP"}].map(k=>e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer ${t.priority===k.key?"border-brand-500 bg-brand-50":"border-slate-200"}`,onClick:()=>x("priority",k.key),children:[e.jsx("input",{type:"radio",className:"checkbox checkbox-sm",checked:t.priority===k.key,onChange:()=>x("priority",k.key)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:k.label}),e.jsx("div",{className:"text-xs text-slate-600",children:k.hint})]})]},k.key))})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx(gx,{number:"3",title:"Schedule & Preferences"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Preferred Date"}),e.jsx("input",{className:"input",type:"date",value:t.preferredDate,onChange:k=>x("preferredDate",k.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Preferred Time"}),e.jsxs("select",{className:"input",value:t.preferredTime,onChange:k=>x("preferredTime",k.target.value),children:[e.jsx("option",{value:"",children:"Select Time"}),e.jsx("option",{value:"morning",children:"Morning (8AM - 12PM)"}),e.jsx("option",{value:"afternoon",children:"Afternoon (12PM - 5PM)"}),e.jsx("option",{value:"evening",children:"Evening (5PM - 8PM)"}),e.jsx("option",{value:"anytime",children:"Anytime"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Preferred Contact Method"}),e.jsx("div",{className:"flex flex-wrap gap-4",children:["email","phone","sms"].map(k=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",className:"checkbox checkbox-sm",checked:t.contactMethod===k,onChange:()=>x("contactMethod",k)}),e.jsx("span",{className:"capitalize",children:k})]},k))})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx(gx,{number:"4",title:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Experienced this issue before?"}),e.jsx("div",{className:"flex gap-4",children:[{key:"yes",label:"Yes"},{key:"no",label:"No"}].map(k=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",className:"checkbox checkbox-sm",checked:t.recurring===k.key,onChange:()=>x("recurring",k.key)}),e.jsx("span",{children:k.label})]},k.key))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Notes/Comments"}),e.jsx("textarea",{className:"input min-h-24",value:t.additionalNotes,onChange:k=>x("additionalNotes",k.target.value),placeholder:"Any other information that might be helpful..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Attach Files"}),e.jsxs("div",{className:`rounded-lg border p-6 text-center ${n?"border-brand-500 bg-brand-50":"border-slate-200"}`,onDragEnter:k=>{k.preventDefault(),i(!0)},onDragOver:k=>{k.preventDefault(),i(!0)},onDragLeave:k=>{k.preventDefault(),i(!1)},onDrop:k=>{k.preventDefault(),i(!1),b(Array.from(k.dataTransfer.files||[]))},onClick:()=>{var k;return(k=document.getElementById("sr-file-input"))==null?void 0:k.click()},children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"text-sm",children:"Click to upload or drag and drop files here"}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"Max file size: 10MB | Supported: PDF, DOC, JPG, PNG"}),e.jsx("input",{id:"sr-file-input",type:"file",className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,.jpg,.jpeg,.png",onChange:g})]}),r.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:r.map(k=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border border-slate-200",children:[e.jsxs("div",{className:"text-sm",children:[" ",k.name," (",(k.size/1024).toFixed(2)," KB)"]}),e.jsx("button",{type:"button",className:"btn-secondary btn-sm",onClick:()=>y(k.name),children:"Remove"})]},k.name))})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-3 text-sm",children:e.jsx("div",{className:"text-blue-900",children:"Note: By submitting this service request, you agree to our terms of service and privacy policy. We will contact you within 2448 hours to confirm your request and provide further details."})}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:t.terms,onChange:k=>x("terms",k.target.checked)}),e.jsx("span",{className:"text-sm",children:"I agree to the terms and conditions"}),e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary w-full md:w-auto",onClick:j,children:"Clear Form"}),e.jsx("button",{type:"submit",className:"btn-primary w-full md:w-auto",children:"Submit Request"})]})]})})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-4xl text-green-600",children:""}),e.jsx("div",{className:"text-xl font-semibold mt-2",children:"Request Submitted Successfully!"}),e.jsx("div",{className:"text-sm mt-1",children:"Your service request has been received and is being processed."}),e.jsxs("div",{className:"mt-3 text-sm",children:["Reference:"," ",e.jsx("span",{className:"font-mono font-semibold",children:u.request_no||N()})]}),u.id&&e.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:["Internal ID: ",String(u.id)]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:"We will contact you shortly via your preferred method. Please save your request ID for reference."}),e.jsx("div",{className:"mt-4",children:e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{o(!1),j()},children:"Close"})})]})})]})}function uJ({status:t}){const s=String(t||"").toLowerCase(),r={paid:{label:" PAID",cls:"bg-green-100 text-green-700 border-green-200"},overdue:{label:" OVERDUE",cls:"bg-red-100 text-red-700 border-red-200"},pending:{label:" PENDING",cls:"bg-amber-100 text-amber-700 border-amber-200"}},a=r[s]||r.pending;return e.jsx("span",{className:`inline-block px-3 py-1 text-xs rounded border ${a.cls}`,children:a.label})}function AJ({idx:t,row:s,onChange:r,onRemove:a}){const n=(u,d)=>r(t,{...s,[u]:d}),i=Number(s.qty||0),l=Number(s.rate||0),o=i*l;return e.jsxs("tr",{children:[e.jsx("td",{className:"p-2",children:t+1}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"input",value:s.desc||"",onChange:u=>n("desc",u.target.value),placeholder:"Service description"})}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"input",value:s.category||"",onChange:u=>n("category",u.target.value),children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{children:"Consultation"}),e.jsx("option",{children:"Maintenance"}),e.jsx("option",{children:"Repair"}),e.jsx("option",{children:"Installation"}),e.jsx("option",{children:"Support"}),e.jsx("option",{children:"Other"})]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"input",type:"number",min:"0",step:"1",value:i,onChange:u=>n("qty",u.target.value)})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:s.rate||0,onChange:u=>n("rate",u.target.value)})}),e.jsx("td",{className:"p-2 text-right",children:o.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"p-2",children:e.jsx("button",{type:"button",className:"btn-danger btn-sm",onClick:()=>a(t),children:"Remove"})})]})}function hJ(){const[t,s]=v.useState({number:"SB-2025-001",clientName:"",clientCompany:"",clientAddress:"",clientPhone:"",clientEmail:"",billDate:new Date().toISOString().slice(0,10),dueDate:(()=>{const j=new Date;return j.setDate(j.getDate()+30),j.toISOString().slice(0,10)})(),serviceDate:new Date().toISOString().slice(0,10),status:"pending",paymentMethod:"cash",paymentReference:"",paymentTerms:"Payment is due within 30 days of the bill date. Please make checks payable to Your Company Name.",notes:"",discountPercent:0,taxPercent:0}),[r,a]=v.useState([{desc:"",category:"",qty:1,rate:0}]),[n,i]=v.useState(!1),[l,o]=v.useState(null),u=v.useMemo(()=>{const j=r.reduce((B,q)=>B+Number(q.qty||0)*Number(q.rate||0),0),S=j*(Number(t.discountPercent||0)/100),k=j-S,P=k*(Number(t.taxPercent||0)/100),I=k+P;return{subtotal:j,discountAmount:S,taxAmount:P,grandTotal:I}},[r,t.discountPercent,t.taxPercent]);function d(j,S){s(k=>({...k,[j]:S}))}function c(){a(j=>[...j,{desc:"",category:"",qty:1,rate:0}])}function m(j,S){a(k=>k.map((P,I)=>I===j?S:P))}function h(j){a(S=>S.filter((k,P)=>P!==j))}function f(j){d("paymentMethod",j)}function x(){window.print()}function g(){if(n)return;i(!0);const j={bill_no:t.number||void 0,bill_date:t.billDate,due_date:t.dueDate,service_date:t.serviceDate,status:t.status,client_name:t.clientName,client_company:t.clientCompany,client_address:t.clientAddress,client_phone:t.clientPhone,client_email:t.clientEmail,payment_method:t.paymentMethod,payment_reference:t.paymentReference,payment_terms:t.paymentTerms,notes:t.notes,discount_percent:t.discountPercent,tax_percent:t.taxPercent,rows:r};te.post("/purchase/service-bills",j).then(S=>{var I,B;const k=((I=S==null?void 0:S.data)==null?void 0:I.id)||null,P=((B=S==null?void 0:S.data)==null?void 0:B.bill_no)||t.number;o(k),s(q=>({...q,number:P})),alert("Bill saved")}).catch(S=>{var k,P;alert(((P=(k=S==null?void 0:S.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to save bill. Please try again.")}).finally(()=>{i(!1)})}function b(){if(!t.clientEmail){alert("Please enter client email address first.");return}alert(`Bill will be sent to: ${t.clientEmail} (demo)`)}function y(){alert("Use browser print to save as PDF (demo).")}function N(){confirm("Clear all data?")&&(s(j=>({...j,clientName:"",clientCompany:"",clientAddress:"",clientPhone:"",clientEmail:"",paymentReference:"",notes:"",discountPercent:0,taxPercent:0,status:"pending"})),a([{desc:"",category:"",qty:1,rate:0}]))}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/purchase",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Purchase"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Service Bill"}),e.jsx("p",{className:"text-sm mt-1",children:"Prepare and issue bill for services provided"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"BILL NO."}),e.jsx("div",{className:"text-lg font-semibold",children:t.number})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold",children:"Bill To"}),e.jsx(uJ,{status:t.status})]})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Client Name"}),e.jsx("input",{className:"input",value:t.clientName,onChange:j=>d("clientName",j.target.value),placeholder:"Client Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name"}),e.jsx("input",{className:"input",value:t.clientCompany,onChange:j=>d("clientCompany",j.target.value),placeholder:"Company Name"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("input",{className:"input",value:t.clientAddress,onChange:j=>d("clientAddress",j.target.value),placeholder:"Address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone Number"}),e.jsx("input",{className:"input",value:t.clientPhone,onChange:j=>d("clientPhone",j.target.value),placeholder:"+233 ..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email Address"}),e.jsx("input",{className:"input",type:"email",value:t.clientEmail,onChange:j=>d("clientEmail",j.target.value),placeholder:"name@example.com"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Bill Information"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bill Date"}),e.jsx("input",{className:"input",type:"date",value:t.billDate,onChange:j=>d("billDate",j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{className:"input",type:"date",value:t.dueDate,onChange:j=>d("dueDate",j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Service Date"}),e.jsx("input",{className:"input",type:"date",value:t.serviceDate,onChange:j=>d("serviceDate",j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:t.status,onChange:j=>d("status",j.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold",children:"Services Provided"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,children:"+ Add Service"})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 w-10",children:"#"}),e.jsx("th",{className:"text-left p-2 w-1/3",children:"Service Description"}),e.jsx("th",{className:"text-left p-2 w-40",children:"Category"}),e.jsx("th",{className:"text-left p-2 w-24",children:"Quantity"}),e.jsx("th",{className:"text-left p-2 w-32",children:"Rate"}),e.jsx("th",{className:"text-right p-2 w-32",children:"Amount"}),e.jsx("th",{className:"p-2 w-24",children:"Action"})]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{className:"p-2 text-center",colSpan:7,children:"No services added"})}):r.map((j,S)=>e.jsx(AJ,{idx:S,row:j,onChange:m,onRemove:h},S))})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Totals"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{className:"font-semibold",children:u.subtotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{children:"Discount"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-20",type:"number",min:"0",max:"100",step:"1",value:t.discountPercent,onChange:j=>d("discountPercent",j.target.value)}),e.jsx("span",{children:"%"}),e.jsx("span",{className:"font-semibold",children:u.discountAmount.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{children:"Tax"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{className:"input w-20",type:"number",min:"0",max:"100",step:"0.1",value:t.taxPercent,onChange:j=>d("taxPercent",j.target.value)}),e.jsx("span",{children:"%"}),e.jsx("span",{className:"font-semibold",children:u.taxAmount.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("div",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("div",{className:"font-bold text-lg",children:u.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[{key:"cash",icon:"",label:"Cash"},{key:"card",icon:"",label:"Credit/Debit"},{key:"bank",icon:"",label:"Bank Transfer"},{key:"check",icon:"",label:"Check"},{key:"mobile",icon:"",label:"Mobile Money"}].map(j=>{const S=t.paymentMethod===j.key;return e.jsxs("button",{type:"button",className:`p-3 rounded border text-left ${S?"border-brand-500 bg-brand-50":"border-slate-200 bg-white"}`,onClick:()=>f(j.key),children:[e.jsx("div",{className:"text-2xl",children:j.icon}),e.jsx("div",{className:"text-sm",children:j.label})]},j.key)})}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Reference / Transaction ID"}),e.jsx("input",{className:"input",value:t.paymentReference,onChange:j=>d("paymentReference",j.target.value),placeholder:"Enter reference number"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Terms & Notes"})}),e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsx("textarea",{className:"input h-24",value:t.paymentTerms,onChange:j=>d("paymentTerms",j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Notes"}),e.jsx("textarea",{className:"input h-24",value:t.notes,onChange:j=>d("notes",j.target.value),placeholder:"Any additional information or special instructions..."})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 mt-2",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:x,children:" Print Bill"}),e.jsx("button",{type:"button",className:"btn-success",onClick:y,children:" Download PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:b,children:" Email to Client"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:g,children:" Save Draft"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:N,children:" Clear All"})]}),e.jsx("div",{className:"text-xs text-slate-600 mt-2",children:"Thank you for your business!"})]})]})]})}function mJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/purchase/reports/import-order-tracking",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["PO No","Supplier","Order Date","Shipment ETA","Status","Value"],f=(Array.isArray(n)?n:[]).map(N=>[N.po_no||"-",N.supplier_name||"-",N.order_date?new Date(N.order_date).toLocaleDateString():"-",N.eta_date?new Date(N.eta_date).toLocaleDateString():"-",N.status||"-",Number(N.total_value||0).toFixed(2)]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="import-order-tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({po_no:g.po_no||"-",supplier:g.supplier_name||"-",order_date:g.order_date?new Date(g.order_date).toLocaleDateString():"-",shipment_eta:g.eta_date?new Date(g.eta_date).toLocaleDateString():"-",status:g.status||"-",value:Number(g.total_value||0)})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"ImportOrderTracking"),Br(x,"import-order-tracking.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Import Order Tracking",10,f),f+=8,h.setFontSize(10),h.text("PO No",10,f),h.text("Supplier",45,f),h.text("Order Date",95,f),h.text("Shipment ETA",130,f),h.text("Status",165,f),h.text("Value",190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(x=>{f>270&&(h.addPage(),f=15);const g=String(x.po_no||"-"),b=String(x.supplier_name||"-"),y=x.order_date?new Date(x.order_date).toLocaleDateString():"-",N=x.eta_date?new Date(x.eta_date).toLocaleDateString():"-",j=String(x.status||"-"),S=Number(x.total_value||0).toFixed(2);h.text(g,10,f),h.text(b.slice(0,35),45,f),h.text(y,95,f),h.text(N,130,f),h.text(j,165,f),h.text(S,190,f,{align:"right"}),f+=5}),h.save("import-order-tracking.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Import Order Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Status and shipment tracking for import POs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Shipment ETA"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.po_no||"-"}),e.jsx("td",{children:h.supplier_name||"-"}),e.jsx("td",{children:h.order_date?new Date(h.order_date).toLocaleDateString():"-"}),e.jsx("td",{children:h.eta_date?new Date(h.eta_date).toLocaleDateString():"-"}),e.jsx("td",{children:h.status||"-"}),e.jsx("td",{className:"text-right",children:Number(h.total_value||0).toLocaleString()})]},h.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function fJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/purchase/reports/local-order-tracking",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["PO No","Supplier","Order Date","Expected Delivery","Status","Value"],f=(Array.isArray(n)?n:[]).map(N=>[N.po_no||"-",N.supplier_name||"-",N.order_date?new Date(N.order_date).toLocaleDateString():"-",N.expected_delivery?new Date(N.expected_delivery).toLocaleDateString():"-",N.status||"-",Number(N.total_value||0).toFixed(2)]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="local_order_tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({po_no:g.po_no||"-",supplier:g.supplier_name||"-",order_date:g.order_date?new Date(g.order_date).toLocaleDateString():"-",expected_delivery:g.expected_delivery?new Date(g.expected_delivery).toLocaleDateString():"-",status:g.status||"-",value:Number(g.total_value||0)})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"LocalOrderTracking"),Br(x,"local-order-tracking.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Local Order Tracking",10,f),f+=8,h.setFontSize(10);const x=["PO No","Supplier","Order Date","Expected","Status","Value"];h.text(x[0],10,f),h.text(x[1],40,f),h.text(x[2],90,f),h.text(x[3],120,f),h.text(x[4],150,f),h.text(x[5],180,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=String(g.po_no||"-"),y=String(g.supplier_name||"-"),N=g.order_date?new Date(g.order_date).toLocaleDateString():"-",j=g.expected_delivery?new Date(g.expected_delivery).toLocaleDateString():"-",S=String(g.status||"-"),k=Number(g.total_value||0).toFixed(2);h.text(b,10,f),h.text(y.slice(0,30),40,f),h.text(N,90,f),h.text(j,120,f),h.text(S,150,f),h.text(k,180,f,{align:"right"}),f+=5}),h.save("local-order-tracking.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Local Order Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Status tracking for local purchase orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Expected Delivery"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.po_no||"-"}),e.jsx("td",{children:h.supplier_name||"-"}),e.jsx("td",{children:h.order_date?new Date(h.order_date).toLocaleDateString():"-"}),e.jsx("td",{children:h.expected_delivery?new Date(h.expected_delivery).toLocaleDateString():"-"}),e.jsx("td",{children:h.status||"-"}),e.jsx("td",{className:"text-right",children:Number(h.total_value||0).toLocaleString()})]},h.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function pJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var h,f,x;try{o(!0);const g=await te.get("/purchase/reports/purchase-tracking",{params:{from:t||null,to:r||null}});i(((h=g.data)==null?void 0:h.items)||[])}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load report")}finally{o(!1)}}function d(){const h=["Stage","Reference","Supplier","Date","Status","Value"],f=(Array.isArray(n)?n:[]).map(N=>[N.stage||"-",N.ref_no||"-",N.supplier_name||"-",N.txn_date?new Date(N.txn_date).toLocaleDateString():"-",N.status||"-",Number(N.total_value||0).toFixed(2)]),x=[h.join(","),...f.map(N=>N.join(","))].join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(g),y=document.createElement("a");y.href=b,y.download="purchase_tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const h=(Array.isArray(n)?n:[]).map(g=>({stage:g.stage||"-",reference:g.ref_no||"-",supplier:g.supplier_name||"-",date:g.txn_date?new Date(g.txn_date).toLocaleDateString():"-",status:g.status||"-",value:Number(g.total_value||0)})),f=us.json_to_sheet(h),x=us.book_new();us.book_append_sheet(x,f,"PurchaseTracking"),Br(x,"purchase-tracking.xlsx")}function m(){const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Purchase Tracking",10,f),f+=8,h.setFontSize(10);const x=["Stage","Reference","Supplier","Date","Status","Value"];h.text(x[0],10,f),h.text(x[1],45,f),h.text(x[2],90,f),h.text(x[3],130,f),h.text(x[4],160,f),h.text(x[5],190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(h.addPage(),f=15);const b=String(g.stage||"-"),y=String(g.ref_no||"-"),N=String(g.supplier_name||"-"),j=g.txn_date?new Date(g.txn_date).toLocaleDateString():"-",S=String(g.status||"-"),k=Number(g.total_value||0).toFixed(2);h.text(b.slice(0,25),10,f),h.text(y.slice(0,30),45,f),h.text(N.slice(0,35),90,f),h.text(j,130,f),h.text(S,160,f),h.text(k,190,f,{align:"right"}),f+=5}),h.save("purchase-tracking.pdf")}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Purchase Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Overall tracking of purchase requests, orders, and bills"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:m,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Stage"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map((h,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:h.stage||"-"}),e.jsx("td",{className:"font-medium",children:h.ref_no||"-"}),e.jsx("td",{children:h.supplier_name||"-"}),e.jsx("td",{children:h.txn_date?new Date(h.txn_date).toLocaleDateString():"-"}),e.jsx("td",{children:h.status||"-"}),e.jsx("td",{className:"text-right",children:Number(h.total_value||0).toLocaleString()})]},h.id||f))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function xJ({title:t,description:s}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:t}),s?e.jsx("p",{className:"text-sm mt-1",children:s}):null]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-sm",children:"This page is ready to be implemented."})})]})}function gJ(){const[t,s]=Os.useState([{icon:"",value:"GHS 2.5M",label:"Total Purchases (YTD)",change:" 15.3% from last year",changeType:"positive",path:"/purchase/reports"},{icon:"",value:"156",label:"Active Purchase Orders",change:" 12 this month",changeType:"positive",path:"/purchase/purchase-orders-local"},{icon:"",value:"48",label:"Active Suppliers",change:" 3 new this month",changeType:"positive",path:"/purchase/suppliers"},{icon:"",value:"23",label:"Pending Approvals",change:"Requires attention",changeType:"neutral",path:"/purchase/purchase-orders-local"},{icon:"",value:"GHS 450K",label:"Outstanding Payables",change:"25 pending invoices",changeType:"neutral",path:"/purchase/purchase-bills-local"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o;try{const u=await te.get("/bi/dashboards"),d=Number(((o=(l=(i=u==null?void 0:u.data)==null?void 0:i.summary)==null?void 0:l.purchase)==null?void 0:o.total)||0);a&&s(c=>{const m=[...c];return m[0]={...m[0],value:`GHS ${Number(d).toLocaleString()}`,label:"Total Purchases (Last 30 Days)"},m})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"RFQ & Quotations",items:[{title:"Request for Quotation",description:"Create and send RFQs to suppliers",path:"/purchase/rfqs",icon:""},{title:"Supplier Quotations",description:"Receive and manage supplier quotations",path:"/purchase/supplier-quotations",icon:""},{title:"Quotation Analysis",description:"Compare quotations from multiple suppliers",path:"/purchase/quotation-analysis",icon:""}]},{title:"Purchase Orders",items:[{title:"Purchase Order - Local",description:"Create and manage local purchase orders",path:"/purchase/purchase-orders-local",icon:""},{title:"Purchase Order - Import",description:"Create and manage import purchase orders",path:"/purchase/purchase-orders-import",icon:""}]},{title:"Shipping & Clearing",items:[{title:"Shipping Advice",description:"Track shipments and vessel information",path:"/purchase/shipping-advice",icon:""},{title:"Clearing at Port",description:"Manage customs and port clearances",path:"/purchase/port-clearances",icon:""}]},{title:"Billing",items:[{title:"Purchase Bill - Local",description:"Record and manage local supplier bills",path:"/purchase/purchase-bills-local",icon:""},{title:"Purchase Bill - Import",description:"Record and manage import supplier bills",path:"/purchase/purchase-bills-import",icon:""}]},{title:"Service Procurement",items:[{title:"Service Requests",description:"Submit and track service requests",path:"/purchase/service-requests",icon:""},{title:"Service Bills",description:"Prepare and issue bills for services",path:"/purchase/service-bills",icon:""},{title:"Service Confirmation",description:"Confirm receipt of supplier services",path:"/purchase/service-confirmation",icon:""}]},{title:"Suppliers",items:[{title:"Supplier Details Setup",description:"Add and manage supplier information",path:"/purchase/suppliers",icon:""}]},{title:"Reports",items:[{title:"Purchase Reports",description:"View purchase analytics and reports",path:"/purchase/reports",icon:""},{title:"Import Order Tracking",description:"Track import PO status and shipments",path:"/purchase/reports/import-order-tracking",icon:""},{title:"Local Order Tracking",description:"Track local PO status and deliveries",path:"/purchase/reports/local-order-tracking",icon:""},{title:"Purchase Tracking",description:"Track end-to-end procurement stages",path:"/purchase/reports/purchase-tracking",icon:""}]}];return e.jsx(To,{title:" Purchase Management Module",description:"Comprehensive procurement solution for local and import purchases, supplier management, and service procurement",stats:t,sections:r})}function vJ(){return e.jsxs(_l,{children:[e.jsx(tt,{index:!0,element:e.jsx(gJ,{})}),e.jsx(tt,{path:"rfqs",element:e.jsx(KY,{})}),e.jsx(tt,{path:"rfqs/new",element:e.jsx(ub,{})}),e.jsx(tt,{path:"rfqs/:id",element:e.jsx(ub,{})}),e.jsx(tt,{path:"rfqs/:id/edit",element:e.jsx(ub,{})}),e.jsx(tt,{path:"supplier-quotations",element:e.jsx(tJ,{})}),e.jsx(tt,{path:"supplier-quotations/new",element:e.jsx(Ab,{})}),e.jsx(tt,{path:"supplier-quotations/:id",element:e.jsx(Ab,{})}),e.jsx(tt,{path:"supplier-quotations/:id/edit",element:e.jsx(Ab,{})}),e.jsx(tt,{path:"quotation-analysis",element:e.jsx(sJ,{})}),e.jsx(tt,{path:"purchase-orders-local",element:e.jsx(rJ,{})}),e.jsx(tt,{path:"purchase-orders-local/new",element:e.jsx(hb,{})}),e.jsx(tt,{path:"purchase-orders-local/:id",element:e.jsx(hb,{})}),e.jsx(tt,{path:"purchase-orders-local/:id/edit",element:e.jsx(hb,{})}),e.jsx(tt,{path:"purchase-orders-import",element:e.jsx(aJ,{})}),e.jsx(tt,{path:"purchase-orders-import/new",element:e.jsx(mb,{})}),e.jsx(tt,{path:"purchase-orders-import/:id",element:e.jsx(mb,{})}),e.jsx(tt,{path:"purchase-orders-import/:id/edit",element:e.jsx(mb,{})}),e.jsx(tt,{path:"shipping-advice",element:e.jsx(nJ,{})}),e.jsx(tt,{path:"shipping-advice/new",element:e.jsx(aS,{})}),e.jsx(tt,{path:"shipping-advice/:id",element:e.jsx(aS,{})}),e.jsx(tt,{path:"port-clearances",element:e.jsx(iJ,{})}),e.jsx(tt,{path:"port-clearances/new",element:e.jsx(nS,{})}),e.jsx(tt,{path:"port-clearances/:id",element:e.jsx(nS,{})}),e.jsx(tt,{path:"purchase-bills-local",element:e.jsx(iS,{})}),e.jsx(tt,{path:"purchase-bills-local/new",element:e.jsx(xx,{})}),e.jsx(tt,{path:"purchase-bills-local/:id",element:e.jsx(xx,{})}),e.jsx(tt,{path:"purchase-bills-import",element:e.jsx(iS,{})}),e.jsx(tt,{path:"purchase-bills-import/new",element:e.jsx(xx,{})}),e.jsx(tt,{path:"purchase-bills-import/:id",element:e.jsx(xx,{})}),e.jsx(tt,{path:"suppliers",element:e.jsx(lJ,{})}),e.jsx(tt,{path:"suppliers/new",element:e.jsx(lS,{})}),e.jsx(tt,{path:"suppliers/:id",element:e.jsx(lS,{})}),e.jsx(tt,{path:"service-confirmation",element:e.jsx(oJ,{})}),e.jsx(tt,{path:"service-confirmation/:id",element:e.jsx(cJ,{})}),e.jsx(tt,{path:"reports",element:e.jsx(xJ,{title:"Purchase Reports",description:"View purchase analytics and reports"})}),e.jsx(tt,{path:"reports/import-order-tracking",element:e.jsx(mJ,{})}),e.jsx(tt,{path:"reports/local-order-tracking",element:e.jsx(fJ,{})}),e.jsx(tt,{path:"reports/purchase-tracking",element:e.jsx(pJ,{})}),e.jsx(tt,{path:"service-requests/new",element:e.jsx(dJ,{})}),e.jsx(tt,{path:"service-bills/new",element:e.jsx(hJ,{})}),e.jsx(tt,{path:"*",element:e.jsx(Wc,{to:"/purchase",replace:!0})})]})}function bJ(){const[t,s]=Os.useState([{icon:"",value:"245,000",label:"Cash Balance",change:" 5% this month",changeType:"positive",path:"/finance/reports"},{icon:"",value:"12",label:"Pending Vouchers",change:"3 urgent",changeType:"neutral",path:"/finance/journal-voucher"},{icon:"",value:"32,000",label:"Monthly Expenses",change:" 2% vs last month",changeType:"positive",path:"/finance/reports"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.finance)==null?void 0:o.cash_balance)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.finance)==null?void 0:c.pending_vouchers)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.finance)==null?void 0:f.monthly_expenses)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:`${g.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:`${y.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Voucher Management",features:[{name:"Journal Entry",path:"/finance/journal-voucher",description:"General ledger journal entries",icon:""},{name:"Make Payment",path:"/finance/payment-voucher",description:"Record outgoing payments",icon:""},{name:"Receive Payment",path:"/finance/receipt-voucher",description:"Record incoming payments",icon:""},{name:"Credit Note",path:"/finance/credit-note",description:"Customer credit notes",icon:""},{name:"Debit Note",path:"/finance/debit-note",description:"Supplier debit notes",icon:""},{name:"Sales Voucher",path:"/finance/sales-voucher",description:"Sales transaction vouchers",icon:""},{name:"Purchase Voucher",path:"/finance/purchase-voucher",description:"Purchase transaction vouchers",icon:""},{name:"Account Transfer",path:"/finance/contra-voucher",description:"Bank or ledger transfers",icon:""},{name:"Voucher Register Report",path:"/finance/reports",description:"Voucher listing with filters (report)",icon:""}]},{title:"Accounting Setup",features:[{name:"Chart of Account Groups",path:"/finance/account-groups",description:"Setup account group hierarchy",icon:""},{name:"Accounts Creation",path:"/finance/accounts",description:"Create and manage accounts",icon:""},{name:"Tax Codes & Deductions",path:"/finance/tax-codes",description:"Configure tax and deduction codes",icon:""},{name:"Currencies",path:"/finance/currencies",description:"Manage currencies and base currency",icon:""},{name:"Fiscal Years",path:"/finance/fiscal-years",description:"Open/close fiscal periods",icon:""}]},{title:"Reports & Analysis",features:[{name:"Voucher Register",path:"/finance/reports/voucher-register",description:"Voucher listing with filters",icon:""},{name:"Payment Due",path:"/finance/reports/payment-due",description:"Upcoming and overdue payables",icon:""},{name:"Customer Outstanding",path:"/finance/reports/customer-outstanding",description:"Receivables outstanding by customer",icon:""},{name:"Trial Balance",path:"/finance/reports/trial-balance",description:"Debits and credits summary",icon:""},{name:"Audit Trail",path:"/finance/reports/audit-trail",description:"System activity on finance transactions",icon:""},{name:"Journal Report",path:"/finance/reports/journals",description:"Journal entries by range",icon:""},{name:"General Ledger",path:"/finance/reports/general-ledger",description:"Account ledger movements",icon:""},{name:"Debtors Ledger",path:"/finance/reports/debtors-ledger",description:"Customer ledger with running balance",icon:""},{name:"Creditors Ledger",path:"/finance/reports/creditors-ledger",description:"Supplier ledger with running balance",icon:""},{name:"Supplier Outstanding",path:"/finance/reports/supplier-outstanding",description:"Payables outstanding by supplier",icon:""},{name:"Profit & Loss",path:"/finance/reports/profit-and-loss",description:"Income vs. expenses summary",icon:""},{name:"Balance Sheet",path:"/finance/reports/balance-sheet",description:"Assets, liabilities, and equity",icon:""},{name:"Cash Flow",path:"/finance/reports/cash-flow",description:"Operating, investing, financing flows",icon:""},{name:"Ratio Analysis",path:"/finance/reports/ratio-analysis",description:"Key performance ratios",icon:""}]},{title:"Banking",features:[{name:"Bank Reconciliation",path:"/finance/bank-reconciliation",description:"Match bank statements with ledger, mark cleared",icon:""},{name:"Post-Dated Cheques (PDC)",path:"/finance/pdc-postings",description:"Register instruments and track status",icon:""}]}];return e.jsx(To,{title:"Finance Module",description:"Comprehensive accounting, budgeting, and financial reporting system",stats:t,sections:r})}function yJ({status:t}){const s=t==="DRAFT"?"badge badge-warning":t==="APPROVED"||t==="POSTED"?"badge badge-success":t==="REVERSED"||t==="CANCELLED"?"badge badge-error":"badge badge-info";return e.jsx("span",{className:s,children:t})}function Kd({voucherTypeCode:t,title:s}){const[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[u,d]=v.useState("ALL"),c=String(t).toUpperCase()==="PV",m=String(t).toUpperCase()==="RV",h=String(t).toUpperCase()==="CV",[f,x]=v.useState(!1),[g,b]=v.useState(null),[y,N]=v.useState(!1),[j,S]=v.useState(""),[k,P]=v.useState(null),[I,B]=v.useState([]),[q,Q]=v.useState(null),[O,T]=v.useState(null),[V,D]=v.useState(null),[Y,M]=v.useState(!1),[X,R]=v.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",postalCode:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[H,W]=v.useState(null),[K,_]=v.useState(null),F=String(t).toUpperCase()==="JV"?"journal-voucher":String(t).toUpperCase()==="PV"?"payment-voucher":String(t).toUpperCase()==="RV"?"receipt-voucher":String(t).toUpperCase()==="CV"?"contra-voucher":String(t).toUpperCase()==="SV"?"sales-voucher":String(t).toUpperCase()==="PUV"?"purchase-voucher":String(t).toUpperCase()==="DN"?"debit-note":"credit-note";async function E(){var We,He,ze;try{i(!0);const Pe=await te.get("/finance/vouchers",{params:{voucherTypeCode:t}});a(((We=Pe.data)==null?void 0:We.items)||[])}catch(Pe){mt.error(((ze=(He=Pe==null?void 0:Pe.response)==null?void 0:He.data)==null?void 0:ze.message)||"Failed to load vouchers")}finally{i(!1)}}const[L,U]=v.useState([]),[J,ae]=v.useState(!1);async function Z(){var We;try{ae(!0);const He=await te.get("/finance/accounts",{params:{active:1}});U(((We=He.data)==null?void 0:We.items)||[])}catch{U([])}finally{ae(!1)}}v.useEffect(()=>{E(),h&&Z()},[t]),v.useEffect(()=>{let We=!0;async function He(){var ze,Pe,Te;try{const $e=(Pe=(ze=(await te.get("/admin/me")).data)==null?void 0:ze.scope)==null?void 0:Pe.companyId;if(!$e)return;const Ze=((Te=(await te.get(`/admin/companies/${$e}`)).data)==null?void 0:Te.item)||{};if(!We)return;R(Re=>({...Re,name:Ze.name||Re.name||"",address:Ze.address||Re.address||"",phone:Ze.telephone||Re.phone||"",email:Ze.email||Re.email||"",city:Ze.city||Re.city||"",state:Ze.state||Re.state||"",country:Ze.country||Re.country||"",postalCode:Ze.postal_code||Re.postalCode||"",website:Ze.website||Re.website||"",taxId:Ze.tax_id||Re.taxId||"",registrationNo:Ze.registration_no||Re.registrationNo||"",logoUrl:Ze.has_logo===1||Ze.has_logo===!0?`/api/admin/companies/${$e}/logo`:Re.logoUrl||""}))}catch{}}return He(),()=>{We=!1}},[]);const oe=v.useMemo(()=>r.filter(We=>{const He=l.trim().toLowerCase(),ze=!He||String(We.voucher_no||"").toLowerCase().includes(He)||String(We.narration||"").toLowerCase().includes(He),Pe=u==="ALL"||We.status===u;return ze&&Pe}),[r,l,u]),ee=v.useMemo(()=>{const We=new Map;for(const He of L||[]){const ze=String(He.code||""),Pe=String(He.name||"");ze&&We.set(ze,Pe)}return We},[L]);function se(We){var Ke,$e;const He=String(We.narration||"");if(!h||!He)return He||"-";const ze=He.split(" | ").map(Ve=>Ve.trim());let Pe="",Te="";for(const Ve of ze)if(Ve.toLowerCase().startsWith("from:")){const Ze=((Ke=Ve.split(":")[1])==null?void 0:Ke.trim())||"";Pe=ee.get(Ze)||Ze}else if(Ve.toLowerCase().startsWith("to:")){const Ze=(($e=Ve.split(":")[1])==null?void 0:$e.trim())||"";Te=ee.get(Ze)||Ze}return Pe&&Te?`${Pe}  ${Te}`:Pe||Te||He||"-"}function Ae(We){return String(We??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function we(We,He){const ze=String(He||"").trim().replace(/^\./,"");if(!ze)return;const Pe=ze.split(".").filter(Boolean);let Te=We;for(const Ke of Pe){if(Te==null)return;Te=Te[Ke]}return Te}function ce(We,He,ze=He){let Pe=String(We??"");return Pe=Pe.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(Te,Ke,$e)=>{const Ve=String(Ke||"").trim(),Ze=Ve.startsWith("@root.")?we(ze,Ve.slice(6)):we(He,Ve)??we(ze,Ve);return(Array.isArray(Ze)?Ze:[]).map(it=>ce($e,it??{},ze)).join("")}),Pe=Pe.replace(/{{{\s*([^}]+?)\s*}}}/g,(Te,Ke)=>{const $e=String(Ke||"").trim();let Ve;return $e==="this"||$e==="."?Ve=He:$e.startsWith("@root.")?Ve=we(ze,$e.slice(6)):Ve=we(He,$e)??we(ze,$e),String(Ve??"")}),Pe=Pe.replace(/{{\s*([^}]+?)\s*}}/g,(Te,Ke)=>{const $e=String(Ke||"").trim();let Ve;return $e==="this"||$e==="."?Ve=He:$e.startsWith("@root.")?Ve=we(ze,$e.slice(6)):Ve=we(He,$e)??we(ze,$e),Ae(Ve)}),Pe}function le(We){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Voucher</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${We||""}</body>
</html>`}async function _e(We){var ze;const He=Array.from(((ze=We==null?void 0:We.querySelectorAll)==null?void 0:ze.call(We,"img"))||[]);He.length&&await Promise.all(He.map(Pe=>new Promise(Te=>{if(Pe.complete)return Te();const Ke=()=>Te();Pe.addEventListener("load",Ke,{once:!0}),Pe.addEventListener("error",Ke,{once:!0})})))}const Qe=async()=>{var We,He;if(H!==null)return H;try{const ze=await te.get("/admin/document-templates/RECEIPT_VOUCHER"),Pe=String(((He=(We=ze.data)==null?void 0:We.item)==null?void 0:He.template_html)||"").trim();return W(Pe),Pe}catch{return W(""),""}},Ie=async()=>{var We,He;if(K!==null)return K;try{const ze=await te.get("/admin/document-templates/PAYMENT_VOUCHER"),Pe=String(((He=(We=ze.data)==null?void 0:We.item)==null?void 0:He.template_html)||"").trim();return _(Pe),Pe}catch{return _(""),""}};function ke(We,He){const ze=String(X.logoUrl||"").trim(),Pe=ze?`<img src="${ze}" alt="${Ae(X.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",Te=(Array.isArray(He)?He:[]).filter($e=>Number($e.credit||0)>0).map($e=>{const Ve=Number($e.credit||0);return{name:String($e.description||$e.account_name||""),qty:"1.00",price:Ve.toFixed(2),discount:"0.00",lineTotal:Ve.toFixed(2)}}),Ke=Te.reduce(($e,Ve)=>{const Ze=Number(Ve.lineTotal||0);return $e.subtotal+=Ze,$e.total+=Ze,$e},{subtotal:0,total:0});return{company:{name:X.name||"",addressLine1:X.address||"",addressLine2:[X.city,X.state,X.country].filter(Boolean).join("  "),phone:X.phone||"",website:X.website||"",taxId:X.taxId||"",registrationNo:X.registrationNo||"",logoUrl:ze,logoHtml:Pe},receipt:{receiptNo:String(We.voucher_no||""),dateTime:We.voucher_date?new Date(We.voucher_date).toLocaleString():new Date().toLocaleString(),paymentMethod:"",headerText:"",footerText:""},items:Te,totals:{subtotal:Ke.subtotal.toFixed(2),tax:"0.00",total:Ke.total.toFixed(2)}}}function pe(We,He){const ze=String(X.logoUrl||"").trim(),Pe=ze?`<img src="${ze}" alt="${Ae(X.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",Te=(Array.isArray(He)?He:[]).filter($e=>Number($e.debit||0)>0).map($e=>{const Ve=Number($e.debit||0);return{name:String($e.description||$e.account_name||""),qty:"1.00",price:Ve.toFixed(2),discount:"0.00",lineTotal:Ve.toFixed(2)}}),Ke=Te.reduce(($e,Ve)=>{const Ze=Number(Ve.lineTotal||0);return $e.subtotal+=Ze,$e.total+=Ze,$e},{subtotal:0,total:0});return{company:{name:X.name||"",addressLine1:X.address||"",addressLine2:[X.city,X.state,X.country].filter(Boolean).join("  "),phone:X.phone||"",website:X.website||"",taxId:X.taxId||"",registrationNo:X.registrationNo||"",logoUrl:ze,logoHtml:Pe},payment:{paymentNo:String(We.voucher_no||""),dateTime:We.voucher_date?new Date(We.voucher_date).toLocaleString():new Date().toLocaleString(),paymentMethod:"",headerText:"",footerText:""},items:Te,totals:{subtotal:Ke.subtotal.toFixed(2),tax:"0.00",total:Ke.total.toFixed(2)}}}async function he(We){var He,ze,Pe,Te;try{const Ke=await te.get(`/finance/vouchers/${We}`),$e=((He=Ke.data)==null?void 0:He.voucher)||{},Ve=Array.isArray((ze=Ke.data)==null?void 0:ze.lines)?Ke.data.lines:[];if(m){const Ze=await Qe();if(Ze){const Re=ce(Ze,ke($e,Ve)),it=le(Re),lt=document.createElement("iframe");lt.style.position="fixed",lt.style.right="0",lt.style.bottom="0",lt.style.width="0",lt.style.height="0",lt.style.border="0",document.body.appendChild(lt);const Ne=((Pe=lt.contentWindow)==null?void 0:Pe.document)||lt.contentDocument||null;if(!Ne){document.body.removeChild(lt),window.print();return}Ne.open(),Ne.write(it),Ne.close();const Xe=lt.contentWindow||window;setTimeout(()=>{Xe.focus();try{Xe.print()}catch{}setTimeout(()=>{document.body.removeChild(lt)},100)},200);return}}else if(c){const Ze=await Ie();if(Ze){const Re=ce(Ze,pe($e,Ve)),it=le(Re),lt=document.createElement("iframe");lt.style.position="fixed",lt.style.right="0",lt.style.bottom="0",lt.style.width="0",lt.style.height="0",lt.style.border="0",document.body.appendChild(lt);const Ne=((Te=lt.contentWindow)==null?void 0:Te.document)||lt.contentDocument||null;if(!Ne){document.body.removeChild(lt),window.print();return}Ne.open(),Ne.write(it),Ne.close();const Xe=lt.contentWindow||window;setTimeout(()=>{Xe.focus();try{Xe.print()}catch{}setTimeout(()=>{document.body.removeChild(lt)},100)},200);return}}window.print()}catch{}}async function je(We){var He,ze;try{const Pe=await te.get(`/finance/vouchers/${We}`),Te=((He=Pe.data)==null?void 0:He.voucher)||{},Ke=Array.isArray((ze=Pe.data)==null?void 0:ze.lines)?Pe.data.lines:[];let $e="";if(m){const Ze=await Qe();$e=(Ze?ce(Ze,ke(Te,Ke)):"")||""}else if(c){const Ze=await Ie();$e=(Ze?ce(Ze,pe(Te,Ke)):"")||""}if(!$e)return;const Ve=document.createElement("div");Ve.style.position="fixed",Ve.style.left="-10000px",Ve.style.top="0",Ve.style.width="794px",Ve.style.background="white",Ve.style.padding="32px",Ve.innerHTML=$e,document.body.appendChild(Ve);try{await _e(Ve);const Ze=await Wn(Ve,{scale:2,useCORS:!0}),Re=Ze.toDataURL("image/png"),it=new As("p","mm","a4"),lt=it.internal.pageSize.getWidth(),Ne=it.internal.pageSize.getHeight(),Xe=lt,Ge=Ze.height*Xe/Ze.width;let at=0;for(;at<Ge;)it.addImage(Re,"PNG",0,-at,Xe,Ge),at+=Ne,at<Ge&&it.addPage();const xt=(m?"ReceiptVoucher_":c?"PaymentVoucher_":"Voucher_")+(String(Te.voucher_no||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";it.save(xt)}finally{document.body.removeChild(Ve)}}catch{}}async function me(We){var He,ze;try{const Pe=window.prompt("Reason for reversal (optional):")||"";await te.post(`/finance/vouchers/${We}/reverse`,{reason:Pe}),mt.success("Voucher reversed"),E()}catch(Pe){mt.error(((ze=(He=Pe==null?void 0:Pe.response)==null?void 0:He.data)==null?void 0:ze.message)||"Failed to reverse voucher")}}async function xe(We){var He,ze,Pe;if(b(We),x(!0),S(""),O)await Ue();else try{N(!0);const Te=await te.get("/workflows"),Ke=Array.isArray((He=Te.data)==null?void 0:He.items)?Te.data.items:[];T(Ke),await ct(Ke)}catch(Te){S(((Pe=(ze=Te==null?void 0:Te.response)==null?void 0:ze.data)==null?void 0:Pe.message)||"Failed to load workflows")}finally{N(!1)}}async function Ue(){var Te,Ke,$e;if(!O||!O.length){P(null),Q(null),B([]),S("");return}const We=c?"/finance/payment-voucher":m?"/finance/receipt-voucher":"/finance/contra-voucher",He=c?["PAYMENT_VOUCHER","Payment Voucher","PV"]:m?["RECEIPT_VOUCHER","Receipt Voucher","RV"]:["CONTRA_VOUCHER","Contra Voucher","CV"],ze=Ve=>String(Ve||"").trim().toUpperCase().replace(/\s+/g,"_"),Pe=O.find(Ve=>Number(Ve.is_active)===1&&String(Ve.document_route||"")===We)||O.find(Ve=>Number(Ve.is_active)===1&&(ze(Ve.document_type)===ze(He[0])||ze(Ve.document_type)===ze(He[1])||ze(Ve.document_type)===ze(He[2])))||null;if(P(Pe||null),Q(null),D(null),B([]),!!Pe)try{N(!0);const Ve=await te.get(`/workflows/${Pe.id}`),Ze=((Te=Ve==null?void 0:Ve.data)==null?void 0:Te.item)||{},Re=Array.isArray(Ze==null?void 0:Ze.steps)?Ze.steps:[];B(Re);const it=Re[0]||null;if(Q(it?{userId:it.approver_user_id,name:it.approver_name,stepName:it.step_name,stepOrder:it.step_order,approvalLimit:it.approval_limit}:null),it){const lt=(Array.isArray(it.approvers)&&it.approvers.length?it.approvers[0].id:it.approver_user_id)||null;D(lt)}else D(null)}catch(Ve){S((($e=(Ke=Ve==null?void 0:Ve.response)==null?void 0:Ke.data)==null?void 0:$e.message)||"Failed to load workflow details")}finally{N(!1)}}async function ct(We){var Ke,$e,Ve;if(!We||!We.length){P(null),Q(null),B([]),S("");return}const He=c?"/finance/payment-voucher":m?"/finance/receipt-voucher":"/finance/contra-voucher",ze=c?["PAYMENT_VOUCHER","Payment Voucher","PV"]:m?["RECEIPT_VOUCHER","Receipt Voucher","RV"]:["CONTRA_VOUCHER","Contra Voucher","CV"],Pe=Ze=>String(Ze||"").trim().toUpperCase().replace(/\s+/g,"_"),Te=We.find(Ze=>Number(Ze.is_active)===1&&String(Ze.document_route||"")===He)||We.find(Ze=>Number(Ze.is_active)===1&&(Pe(Ze.document_type)===Pe(ze[0])||Pe(Ze.document_type)===Pe(ze[1])||Pe(Ze.document_type)===Pe(ze[2])))||null;if(P(Te||null),Q(null),D(null),B([]),!!Te)try{N(!0);const Ze=await te.get(`/workflows/${Te.id}`),Re=((Ke=Ze==null?void 0:Ze.data)==null?void 0:Ke.item)||{},it=Array.isArray(Re==null?void 0:Re.steps)?Re.steps:[];B(it);const lt=it[0]||null;if(Q(lt?{userId:lt.approver_user_id,name:lt.approver_name,stepName:lt.step_name,stepOrder:lt.step_order,approvalLimit:lt.approval_limit}:null),lt){const Ne=(Array.isArray(lt.approvers)&&lt.approvers.length?lt.approvers[0].id:lt.approver_user_id)||null;D(Ne)}else D(null)}catch(Ze){S(((Ve=($e=Ze==null?void 0:Ze.response)==null?void 0:$e.data)==null?void 0:Ve.message)||"Failed to load workflow details")}finally{N(!1)}}async function dt(){var We,He,ze;if(g){M(!0),S("");try{const Pe=g.total_debit===void 0||g.total_debit===null?g.total_credit===void 0||g.total_credit===null?null:Number(g.total_credit||0):Number(g.total_debit||0),Te=await te.post(`/finance/vouchers/${g.id}/submit`,{amount:Pe,workflow_id:k?k.id:null,target_user_id:V||null}),Ke=((We=Te==null?void 0:Te.data)==null?void 0:We.status)||"PENDING_APPROVAL";a($e=>$e.map(Ve=>Ve.id===g.id?{...Ve,status:Ke}:Ve)),x(!1),b(null)}catch(Pe){S(((ze=(He=Pe==null?void 0:Pe.response)==null?void 0:He.data)==null?void 0:ze.message)||"Failed to forward for approval")}finally{M(!1)}}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"List, review, and manage vouchers"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:E,disabled:n,children:"Refresh"}),e.jsx(Ee,{to:"./create",className:"btn-success",children:"Create New"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"input",placeholder:"Search voucher no or narration...",value:l,onChange:We=>o(We.target.value)})}),e.jsx("div",{className:"w-full md:w-56",children:e.jsxs("select",{className:"input",value:u,onChange:We=>d(We.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"REVERSED",children:"Reversed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]}),n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("div",{className:"mt-2",children:"Loading..."})]}):oe.length===0?e.jsx("div",{className:"text-center py-12",children:"No vouchers found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Narration"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:oe.map(We=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:We.voucher_no}),e.jsx("td",{children:new Date(We.voucher_date).toLocaleDateString()}),e.jsx("td",{children:se(We)}),e.jsx("td",{className:"text-right",children:`GH ${Number(We.total_debit||0).toLocaleString()}`}),e.jsx("td",{className:"text-right",children:`GH ${Number(We.total_credit||0).toLocaleString()}`}),e.jsx("td",{children:e.jsx(yJ,{status:We.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ee,{to:`/finance/${F}/${We.id}?mode=view`,className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),e.jsx(Ee,{to:`/finance/${F}/${We.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 font-medium text-sm",style:{display:(c||m)&&We.status==="APPROVED"?"none":"inline"},children:"Edit"}),(c||m)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",onClick:()=>he(We.id),children:"Print"}),e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",onClick:()=>je(We.id),children:"PDF"})]}),(c||m||h)&&(We.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",onClick:()=>xe(We),disabled:Y||We.status==="POSTED"||We.status==="REJECTED"||We.status==="PENDING_APPROVAL"||We.status==="SUBMITTED",children:"Forward for Approval"})),!c&&!m&&!h&&e.jsx("button",{type:"button",className:"text-red-600 hover:text-red-700 font-medium text-sm",onClick:()=>me(We.id),disabled:We.status==="REVERSED",children:"Reverse"})]})})]},We.id))})]})})]})}),f?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{x(!1),b(null),P(null),Q(null),D(null),B([]),S("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Voucher:"," ",e.jsx("span",{className:"font-semibold",children:g==null?void 0:g.voucher_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:k?`${k.workflow_name} (${k.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[y?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,j?e.jsx("div",{className:"text-sm text-red-600",children:j}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const He=Array.isArray(I)&&I.length>0?I[0]:null,ze=He?Array.isArray(He.approvers)&&He.approvers.length?He.approvers.map(Pe=>({id:Pe.id,name:Pe.username})):He.approver_user_id?[{id:He.approver_user_id,name:He.approver_name||String(He.approver_user_id)}]:[]:[];return ze.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:V||"",onChange:Pe=>D(Pe.target.value?Number(Pe.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),ze.map(Pe=>e.jsx("option",{value:Pe.id,children:Pe.name},Pe.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:q?`Step ${q.stepOrder}  ${q.stepName}${q.approvalLimit!=null?`  Limit: ${Number(q.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:k?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{x(!1),b(null),P(null),Q(null),D(null),B([]),S("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:dt,disabled:Y||!g||Array.isArray(I)&&I.length>0&&k&&!V,children:Y?"Forwarding...":"Forward"})]})]})}):null]})}function wm(){return{accountId:"",description:"",debit:"",credit:""}}function ci({voucherTypeCode:t,title:s}){var Ni,zn,Ms;const r=Ns(),{id:a}=Ps(),{search:n}=Ba(),l=new URLSearchParams(n).get("mode")==="view",o=!!a,[u,d]=v.useState(!1),[c,m]=v.useState([]),[h,f]=v.useState([]),[x,g]=v.useState([]),[b,y]=v.useState([]),[N,j]=v.useState([]),[S,k]=v.useState([]),[P,I]=v.useState([]),[B,q]=v.useState([]),[Q,O]=v.useState([]),[T,V]=v.useState(""),[D,Y]=v.useState(new Date().toISOString().split("T")[0]),[M,X]=v.useState(""),[R,H]=v.useState(""),[W,K]=v.useState([wm(),wm()]),_=String(t).toUpperCase()==="RV",F=String(t).toUpperCase()==="PV",E=String(t).toUpperCase()==="CV",L=String(t).toUpperCase()==="DN",U=String(t).toUpperCase()==="CN",[J,ae]=v.useState({receivedFrom:"",receivedFromCode:"",payerAccountId:"",paymentMethod:"Cash",reference:"",chequeDate:"",depositAccountId:"",taxCodeId:"",items:[{description:"",accountId:"",amount:"",referenceNo:""}],notes:""}),[Z,oe]=v.useState({payTo:"",payToCode:"",payToAccountId:"",paymentMethod:"Cash",reference:"",chequeDate:"",paymentAccountId:"",taxCodeId:"",items:[{description:"",accountId:"",amount:""}],notes:""}),[ee,se]=v.useState(""),[Ae,we]=v.useState(""),[ce,le]=v.useState(!1),[_e,Qe]=v.useState(""),[Ie,ke]=v.useState(!1),[pe,he]=v.useState(!1),[je,me]=v.useState(""),[xe,Ue]=v.useState(null),[ct,dt]=v.useState(null),[We,He]=v.useState(null),[ze,Pe]=v.useState(null),[Te,Ke]=v.useState(!1),[$e,Ve]=v.useState("DRAFT"),[Ze,Re]=v.useState({fromAccountId:"",toAccountId:"",transferMethod:"Cash",reference:"",chequeDate:"",taxCodeId:"",items:[{description:"",amount:""}],notes:""}),[it,lt]=v.useState(""),[Ne,Xe]=v.useState([]),[Ge,at]=v.useState(""),xt=v.useMemo(()=>{const be=Array.isArray(Ne)?Ne:[];return be.find(nt=>String(nt.is_base)==="1"||nt.is_base===1||nt.is_base===!0)||be.find(nt=>String(nt.code||nt.currency_code||"").toUpperCase()==="GHS")||be.find(nt=>/ghana|cedi/i.test(String(nt.name||nt.currency_name||"")))},[Ne]),wt=v.useMemo(()=>{const be=W.find(ut=>String(ut.accountId||"")),nt=x.find(ut=>String(ut.id)===String((be==null?void 0:be.accountId)||""));return(nt==null?void 0:nt.currency_id)||null},[W,x]);async function pt(){var be,nt,ut,_t,Qt,qt,Ut,Zt,ss;try{const[fs,js,ns,rs,bs,ms,gr]=await Promise.all([te.get("/finance/voucher-types"),te.get("/finance/fiscal-years"),te.get("/finance/accounts"),te.get("/finance/tax-codes"),te.get("/sales/customers?active=true"),te.get("/purchase/suppliers?active=true"),te.get("/finance/currencies")]),dn=((be=fs.data)==null?void 0:be.items)||[],na=((nt=js.data)==null?void 0:nt.items)||[],hr=((ut=ns.data)==null?void 0:ut.items)||[],fa=(((_t=rs.data)==null?void 0:_t.items)||[]).filter($s=>Number($s.is_active||0)===1),er=Array.isArray((Qt=bs.data)==null?void 0:Qt.items)?bs.data.items:[],Jr=Array.isArray((qt=ms.data)==null?void 0:qt.items)?ms.data.items:[],Ea=Array.isArray((Ut=gr.data)==null?void 0:Ut.items)?gr.data.items:[],Sl=[...er.map($s=>({type:"CUSTOMER",id:$s.id,code:$s.customer_code&&String($s.customer_code).trim()||`C${String(Number($s.id||0)).padStart(5,"0")}`,name:String($s.customer_name||"").trim()})),...Jr.map($s=>({type:"SUPPLIER",id:$s.id,code:$s.supplier_code&&String($s.supplier_code).trim()||`SU-${String(Number($s.id||0)).padStart(6,"0")}`,name:String($s.supplier_name||"").trim()}))].filter($s=>$s.name).sort(($s,mr)=>$s.name.localeCompare(mr.name));m(dn),f(na),g(hr),y(fa),j(Sl),Xe(Ea),!R&&na.length&&H(String(na[0].id))}catch(fs){mt.error(((ss=(Zt=fs==null?void 0:fs.response)==null?void 0:Zt.data)==null?void 0:ss.message)||"Failed to load finance setup")}}async function ge(be){var nt;try{const ut=await te.get("/sales/invoices"),Qt=(Array.isArray((nt=ut.data)==null?void 0:nt.items)?ut.data.items:[]).filter(qt=>String(qt.customer_id)===String(be)&&Number(qt.balance_amount||0)>0).map(qt=>({id:qt.id,invoice_no:qt.invoice_no,balance_amount:Number(qt.balance_amount||0),total_amount:Number(qt.total_amount||0)})).sort((qt,Ut)=>qt.invoice_no.localeCompare(Ut.invoice_no));k(Qt)}catch{k([])}}async function rt(be){var nt;try{const ut=await te.get("/purchase/bills"),Qt=(Array.isArray((nt=ut.data)==null?void 0:nt.items)?ut.data.items:[]).filter(Ut=>String(Ut.supplier_id)===String(be)).map(Ut=>({id:Ut.id,bill_no:Ut.bill_no,payment_status:String(Ut.payment_status||"UNPAID"),net_amount:Number(Ut.net_amount||0),amount_paid:Number(Ut.amount_paid||0),outstanding:Math.max(0,Math.round((Number(Ut.net_amount||0)-Number(Ut.amount_paid||0))*100)/100)})).filter(Ut=>Ut.payment_status!=="PAID"&&Number(Ut.outstanding)>0).sort((Ut,Zt)=>String(Ut.bill_no||"").localeCompare(String(Zt.bill_no||"")));I(Qt);const qt=new Set(Qt.map(Ut=>String(Ut.bill_no)));q(Ut=>Ut.filter(Zt=>qt.has(String(Zt))))}catch{I([])}}v.useEffect(()=>{pt()},[]),v.useEffect(()=>{async function be(){var nt;if(!o&&F)try{const ut=await te.get("/finance/vouchers/next-no?voucherTypeCode=PV"),_t=String(((nt=ut.data)==null?void 0:nt.nextNo)||""),Qt=_t.match(/^PV-?(\d+)$/i),qt=Qt?`PV-${String(Qt[1]).padStart(6,"0")}`:_t;V(qt)}catch{V("")}}be()},[F,o]),v.useEffect(()=>{async function be(){var nt;if(!o&&_)try{const ut=await te.get("/finance/vouchers/next-no?voucherTypeCode=RV"),_t=String(((nt=ut.data)==null?void 0:nt.nextNo)||""),Qt=_t.match(/^RV-?(\d+)$/i),qt=Qt?`RV-${String(Qt[1]).padStart(6,"0")}`:_t;V(qt)}catch{V("")}}be()},[_,o]),v.useEffect(()=>{async function be(){var nt;if(!o&&E)try{const ut=await te.get("/finance/vouchers/next-no?voucherTypeCode=CV"),_t=String(((nt=ut.data)==null?void 0:nt.nextNo)||""),Qt=_t.match(/^CV-?(\d+)$/i),qt=Qt?`CV-${String(Qt[1]).padStart(6,"0")}`:_t;V(qt)}catch{V("")}}be()},[E,o]),v.useEffect(()=>{async function be(){var nt;if(!o&&L)try{const ut=await te.get("/finance/vouchers/next-no?voucherTypeCode=DN"),_t=String(((nt=ut.data)==null?void 0:nt.nextNo)||""),Qt=_t.match(/^DN-?(\d+)$/i),qt=Qt?`DN-${String(Qt[1]).padStart(6,"0")}`:_t;V(qt)}catch{V("")}}be()},[L,o]),v.useEffect(()=>{async function be(){var nt;if(!o&&U)try{const ut=await te.get("/finance/vouchers/next-no?voucherTypeCode=CN"),_t=String(((nt=ut.data)==null?void 0:nt.nextNo)||""),Qt=_t.match(/^CN-?(\d+)$/i),qt=Qt?`CN-${String(Qt[1]).padStart(6,"0")}`:_t;V(qt)}catch{V("")}}be()},[U,o]),v.useEffect(()=>{if(!(U||L))return;const be=wt||null,nt=(xt==null?void 0:xt.id)||null;if(!be||!nt){at("1");return}if(String(be)===String(nt)){at("1");return}(async()=>{var ut,_t;try{const Qt=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Number(be),toCurrencyId:Number(nt),to:D||null}}),Ut=(Array.isArray((ut=Qt.data)==null?void 0:ut.items)?Qt.data.items:[]).slice().sort((ss,fs)=>new Date(fs.rate_date).getTime()-new Date(ss.rate_date).getTime());let Zt=Ut.length?Number(Ut[0].rate||0):0;if(!Zt)try{const ss=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Number(nt),toCurrencyId:Number(be),to:D||null}}),js=(Array.isArray((_t=ss.data)==null?void 0:_t.items)?ss.data.items:[]).slice().sort((rs,bs)=>new Date(bs.rate_date).getTime()-new Date(rs.rate_date).getTime()),ns=js.length?Number(js[0].rate||0):0;Zt=ns?1/ns:0}catch{}at(Zt?String(Zt):"1")}catch{at("1")}})()},[U,L,wt,xt,D]);async function ht(){var be,nt,ut,_t,Qt,qt,Ut,Zt;if(o)try{d(!0);const fs=(await te.get(`/finance/vouchers/${a}`)).data||{},js=fs.item||fs.voucher||fs;if(!js)return;const ns=(js.voucher_date||js.date||new Date().toISOString()).split("T")[0];Y(ns),V(String(js.voucher_no||((be=fs.voucher)==null?void 0:be.voucher_no)||"")),Ve(String(js.status||((nt=fs.voucher)==null?void 0:nt.status)||"DRAFT")),(js.fiscal_year_id||js.fiscalYearId||(ut=fs.voucher)!=null&&ut.fiscal_year_id)&&H(String(js.fiscal_year_id||js.fiscalYearId||((_t=fs.voucher)==null?void 0:_t.fiscal_year_id))),X(js.narration||((Qt=fs.voucher)==null?void 0:Qt.narration)||"");const rs=Array.isArray(fs.lines)?fs.lines:Array.isArray(js.lines)?js.lines:js.items||[],bs=String(js.narration||((qt=fs.voucher)==null?void 0:qt.narration)||""),ms=hr=>{const fa=bs.match(new RegExp(`${hr}\\s*:\\s*([^|]+)`,"i"));return fa?String(fa[1]).trim():""},gr=rs.filter(hr=>Number(hr.credit||0)>0),dn=rs.filter(hr=>Number(hr.debit||0)>0),na=rs.map(hr=>({accountId:String(hr.account_id||hr.accountId||""),description:hr.description||"",debit:Number(hr.debit||0),credit:Number(hr.credit||0)}))||[];if(K(na.length?na:[wm(),wm()]),_){const hr=na.find(mr=>Number(mr.debit||0)>0),fa=na.filter(mr=>Number(mr.credit||0)>0),er=gr[0]||null,Jr=ms("Received from")||(er==null?void 0:er.account_name)||"",Ea=er!=null&&er.account_code?String(er.account_code):"",Sl=er!=null&&er.account_id?String(er.account_id):"",$s=Ea?N.find(mr=>String(mr.code)===Ea):null;String(($s==null?void 0:$s.type)||"").toUpperCase()==="CUSTOMER"&&($s!=null&&$s.id)?await ge($s.id):k([]),ae(mr=>({...mr,depositAccountId:(hr==null?void 0:hr.accountId)||"",receivedFrom:Jr||mr.receivedFrom,receivedFromCode:Ea||mr.receivedFromCode,payerAccountId:Sl||mr.payerAccountId,paymentMethod:ms("Method")||mr.paymentMethod,reference:ms("Ref")||mr.reference,items:fa.length>0?fa.map(ol=>({description:ol.description||"",accountId:String(ol.accountId||""),amount:Number(ol.credit||0),referenceNo:String((gr.find(ja=>String(ja.account_id||"")===String(ol.accountId||""))||{}).reference_no||"")||""})):mr.items}))}else if(F){const hr=na.find($s=>Number($s.credit||0)>0),fa=na.filter($s=>Number($s.debit||0)>0),er=dn[0]||null,Jr=ms("Paid to")||(er==null?void 0:er.account_name)||"",Ea=er!=null&&er.account_code?String(er.account_code):"",Sl=er!=null&&er.account_id?String(er.account_id):"";oe($s=>({...$s,paymentAccountId:(hr==null?void 0:hr.accountId)||"",payTo:Jr||$s.payTo,payToCode:Ea||$s.payToCode,payToAccountId:Sl||$s.payToAccountId,paymentMethod:ms("Method")||$s.paymentMethod,reference:ms("Ref")||$s.reference,items:fa.length>0?fa.map(mr=>({description:mr.description||"",accountId:String(mr.accountId||""),amount:Number(mr.debit||0)})):$s.items}))}else if(E){const hr=na.find(er=>Number(er.debit||0)>0),fa=na.find(er=>Number(er.credit||0)>0);Re(er=>({...er,toAccountId:(hr==null?void 0:hr.accountId)||"",fromAccountId:(fa==null?void 0:fa.accountId)||"",items:na.length>0?na.filter(Jr=>Number(Jr.debit||0)>0||Number(Jr.credit||0)>0).map(Jr=>({description:Jr.description||"",amount:Number(Jr.debit||Jr.credit||0)})):er.items}))}}catch(ss){mt.error(((Zt=(Ut=ss==null?void 0:ss.response)==null?void 0:Ut.data)==null?void 0:Zt.message)||"Failed to load voucher")}finally{d(!1)}}v.useEffect(()=>{ht()},[a]);async function ft(be){var nt,ut,_t;try{const Qt=await te.get("/finance/voucher-types",{params:{code:be}}),qt=Array.isArray((nt=Qt.data)==null?void 0:nt.items)?Qt.data.items:[];if(qt.length>0)return Number(qt[0].id||0);const Ut=String(be||"").toUpperCase(),Zt=Ut==="PV"?"Payment Voucher":Ut==="RV"?"Receipt Voucher":Ut==="CV"?"Contra Voucher":Ut==="CN"?"Credit Note":Ut==="DN"?"Debit Note":"Voucher",ss=Ut==="PV"?"PAYMENT":Ut==="RV"?"RECEIPT":"GENERAL";await te.post("/finance/voucher-types",{code:Ut,name:Zt,category:ss,prefix:Ut,next_number:1,requires_approval:0,is_active:1});const fs=await te.get("/finance/voucher-types",{params:{code:Ut}}),js=Array.isArray((ut=fs.data)==null?void 0:ut.items)?fs.data.items:[];return Number(((_t=js==null?void 0:js[0])==null?void 0:_t.id)||0)}catch{return 0}}const St=v.useMemo(()=>c.find(be=>be.code===t),[c,t]),Je=v.useMemo(()=>{var be,nt,ut;if(_){const _t=J.items.reduce((Ut,Zt)=>Ut+Number(Zt.amount||0),0),Qt=Number(((be=b.find(Ut=>String(Ut.id)===String(J.taxCodeId)))==null?void 0:be.rate_percent)||0),qt=Math.round(_t*Qt)/100;return{debit:_t,credit:_t,subtotal:_t,tax:qt,grand:_t+qt}}if(F){const _t=Z.items.reduce((Ut,Zt)=>Ut+Number(Zt.amount||0),0),Qt=Number(((nt=b.find(Ut=>String(Ut.id)===String(Z.taxCodeId)))==null?void 0:nt.rate_percent)||0),qt=Math.round(_t*Qt)/100;return{debit:_t,credit:_t,subtotal:_t,tax:qt,grand:_t+qt}}if(E){const _t=Ze.items.reduce((Ut,Zt)=>Ut+Number(Zt.amount||0),0),Qt=Number(((ut=b.find(Ut=>String(Ut.id)===String(Ze.taxCodeId)))==null?void 0:ut.rate_percent)||0),qt=Math.round(_t*Qt)/100;return{debit:_t,credit:_t,subtotal:_t,tax:qt,grand:_t+qt}}return W.reduce((_t,Qt)=>(_t.debit+=Number(Qt.debit||0),_t.credit+=Number(Qt.credit||0),_t),{debit:0,credit:0})},[W,J,Z,Ze,_,F,E,b]),ts=Math.round(Je.debit*100)===Math.round(Je.credit*100),[Kt,fe]=v.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""});v.useEffect(()=>{let be=!0;async function nt(){var ut,_t,Qt;try{const Ut=(_t=(ut=(await te.get("/admin/me")).data)==null?void 0:ut.scope)==null?void 0:_t.companyId;if(!Ut)return;const ss=((Qt=(await te.get(`/admin/companies/${Ut}`)).data)==null?void 0:Qt.item)||{},fs=ss.has_logo===1||ss.has_logo===!0?`/api/admin/companies/${Ut}/logo`:"";if(!be)return;fe({name:ss.name||"",address:ss.address||"",city:ss.city||"",state:ss.state||"",country:ss.country||"",phone:ss.telephone||"",email:ss.email||"",website:ss.website||"",taxId:ss.tax_id||"",registrationNo:ss.registration_no||"",logoUrl:fs})}catch{}}return nt(),()=>{be=!1}},[]);function Oe(be){return String(be??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Se(be,nt){const ut=String(nt||"").trim().replace(/^\./,"");if(!ut)return;const _t=ut.split(".").filter(Boolean);let Qt=be;for(const qt of _t){if(Qt==null)return;Qt=Qt[qt]}return Qt}function Le(be,nt,ut=nt){let _t=String(be??"");return _t=_t.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(Qt,qt,Ut)=>{const Zt=String(qt||"").trim(),ss=Zt.startsWith("@root.")?Se(ut,Zt.slice(6)):Se(nt,Zt)??Se(ut,Zt);return(Array.isArray(ss)?ss:[]).map(js=>Le(Ut,js??{},ut)).join("")}),_t=_t.replace(/{{{\s*([^}]+?)\s*}}}/g,(Qt,qt)=>{const Ut=String(qt||"").trim();let Zt;return Ut==="this"||Ut==="."?Zt=nt:Ut.startsWith("@root.")?Zt=Se(ut,Ut.slice(6)):Zt=Se(nt,Ut)??Se(ut,Ut),String(Zt??"")}),_t=_t.replace(/{{\s*([^}]+?)\s*}}/g,(Qt,qt)=>{const Ut=String(qt||"").trim();let Zt;return Ut==="this"||Ut==="."?Zt=nt:Ut.startsWith("@root.")?Zt=Se(ut,Ut.slice(6)):Zt=Se(nt,Ut)??Se(ut,Ut),Oe(Zt)}),_t}function Ye(be){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Voucher</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${be||""}</body>
</html>`}const[st,It]=v.useState(null),Ft=async()=>{var be,nt;if(st!==null)return st;try{const ut=await te.get("/admin/document-templates/RECEIPT_VOUCHER"),_t=String(((nt=(be=ut.data)==null?void 0:be.item)==null?void 0:nt.template_html)||"").trim();return It(_t),_t}catch{return It(""),""}},[Bt,Tt]=v.useState(null),Me=async()=>{var be,nt;if(Bt!==null)return Bt;try{const ut=await te.get("/admin/document-templates/PAYMENT_VOUCHER"),_t=String(((nt=(be=ut.data)==null?void 0:be.item)==null?void 0:nt.template_html)||"").trim();return Tt(_t),_t}catch{return Tt(""),""}},Nt=()=>{const be=String(Kt.logoUrl||"").trim(),nt=be?`<img src="${be}" alt="${Oe(Kt.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",ut=[];Kt.address&&ut.push(Kt.address);const _t=[Kt.city,Kt.state].filter(Boolean).join(", ");_t&&ut.push(_t),Kt.country&&ut.push(Kt.country);const Qt=String(ut[0]||""),qt=String(ut.slice(1).join("  ")||""),Ut=(Array.isArray(J.items)?J.items:[]).map(js=>{const ns=Number(js.amount||0);return{name:String(js.description||""),qty:"1.00",price:ns.toFixed(2),discount:"0.00",lineTotal:ns.toFixed(2)}}),Zt=D?new Date(D):new Date,ss=String(J.paymentMethod||"").toUpperCase(),fs=ss==="CASH"?"Cash":ss==="BANK"?"Bank":ss==="CHEQUE"?"Cheque":ss==="TRANSFER"?"Bank Transfer":ss==="CARD"?"Card":"Other";return{company:{name:Kt.name||"",addressLine1:Qt,addressLine2:qt,phone:Kt.phone||"",website:Kt.website||"",taxId:Kt.taxId||"",registrationNo:Kt.registrationNo||"",logoUrl:be,logoHtml:nt},receipt:{receiptNo:String(T||""),dateTime:Zt.toLocaleString(),paymentMethod:fs,headerText:"",footerText:""},items:Ut,totals:{subtotal:Number(Je.subtotal||0).toFixed(2),tax:Number(Je.tax||0).toFixed(2),total:Number(Je.grand||0).toFixed(2)}}},Et=()=>{const be=String(Kt.logoUrl||"").trim(),nt=be?`<img src="${be}" alt="${Oe(Kt.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",ut=[];Kt.address&&ut.push(Kt.address);const _t=[Kt.city,Kt.state].filter(Boolean).join(", ");_t&&ut.push(_t),Kt.country&&ut.push(Kt.country);const Qt=String(ut[0]||""),qt=String(ut.slice(1).join("  ")||""),Ut=(Array.isArray(Z.items)?Z.items:[]).map(js=>{const ns=Number(js.amount||0);return{name:String(js.description||""),qty:"1.00",price:ns.toFixed(2),discount:"0.00",lineTotal:ns.toFixed(2)}}),Zt=D?new Date(D):new Date,ss=String(Z.paymentMethod||"").toUpperCase(),fs=ss==="CASH"?"Cash":ss==="BANK"?"Bank":ss==="CHEQUE"?"Cheque":ss==="TRANSFER"?"Bank Transfer":ss==="CARD"?"Card":"Other";return{company:{name:Kt.name||"",addressLine1:Qt,addressLine2:qt,phone:Kt.phone||"",website:Kt.website||"",taxId:Kt.taxId||"",registrationNo:Kt.registrationNo||"",logoUrl:be,logoHtml:nt},payment:{paymentNo:String(T||""),dateTime:Zt.toLocaleString(),paymentMethod:fs,headerText:"",footerText:""},items:Ut,totals:{subtotal:Number(Je.subtotal||0).toFixed(2),tax:Number(Je.tax||0).toFixed(2),total:Number(Je.grand||0).toFixed(2)}}};async function $t(be){var ut;const nt=Array.from(((ut=be==null?void 0:be.querySelectorAll)==null?void 0:ut.call(be,"img"))||[]);nt.length!==0&&await Promise.race([Promise.all(nt.map(_t=>new Promise(Qt=>{if(_t.complete)return Qt();const qt=()=>Qt();_t.addEventListener("load",qt,{once:!0}),_t.addEventListener("error",qt,{once:!0})}))),new Promise(_t=>setTimeout(_t,1500))])}const Ht=async()=>{var be,nt;if(_)try{const ut=await Ft();if(ut){const _t=Le(ut,Nt()),Qt=Ye(_t),qt=document.createElement("iframe");qt.style.position="fixed",qt.style.right="0",qt.style.bottom="0",qt.style.width="0",qt.style.height="0",qt.style.border="0",document.body.appendChild(qt);const Ut=((be=qt.contentWindow)==null?void 0:be.document)||qt.contentDocument||null;if(!Ut){document.body.removeChild(qt),window.print();return}Ut.open(),Ut.write(Qt),Ut.close();const Zt=qt.contentWindow||window;setTimeout(()=>{Zt.focus();try{Zt.print()}catch{}setTimeout(()=>{document.body.removeChild(qt)},100)},200);return}}catch{}else if(F)try{const ut=await Me();if(ut){const _t=Le(ut,Et()),Qt=Ye(_t),qt=document.createElement("iframe");qt.style.position="fixed",qt.style.right="0",qt.style.bottom="0",qt.style.width="0",qt.style.height="0",qt.style.border="0",document.body.appendChild(qt);const Ut=((nt=qt.contentWindow)==null?void 0:nt.document)||qt.contentDocument||null;if(!Ut){document.body.removeChild(qt),window.print();return}Ut.open(),Ut.write(Qt),Ut.close();const Zt=qt.contentWindow||window;setTimeout(()=>{Zt.focus();try{Zt.print()}catch{}setTimeout(()=>{document.body.removeChild(qt)},100)},200);return}}catch{}window.print()},Ot=async()=>{try{let be="";if(_){const ut=await Ft();be=(ut?Le(ut,Nt()):"")||""}else if(F){const ut=await Me();be=(ut?Le(ut,Et()):"")||""}if(!be)return;const nt=document.createElement("div");nt.style.position="fixed",nt.style.left="-10000px",nt.style.top="0",nt.style.width="794px",nt.style.background="white",nt.style.padding="32px",nt.innerHTML=be,document.body.appendChild(nt);try{await $t(nt);const ut=await Wn(nt,{scale:2,useCORS:!0}),_t=ut.toDataURL("image/png"),Qt=new As("p","mm","a4"),qt=Qt.internal.pageSize.getWidth(),Ut=Qt.internal.pageSize.getHeight(),Zt=qt,ss=ut.height*Zt/ut.width;let fs=0;for(;fs<ss;)Qt.addImage(_t,"PNG",0,-fs,Zt,ss),fs+=Ut,fs<ss&&Qt.addPage();const js=(_?"ReceiptVoucher_":F?"PaymentVoucher_":"Voucher_")+(T||new Date().toISOString().slice(0,10))+".pdf";Qt.save(js)}finally{document.body.removeChild(nt)}}catch{}};function ls(be,nt){l||K(ut=>ut.map((_t,Qt)=>Qt===be?{..._t,...nt}:_t))}function Ls(){l||K(be=>[...be,wm()])}function Is(be){l||K(nt=>nt.length<=2?nt:nt.filter((ut,_t)=>_t!==be))}async function Hs(be){var Ut,Zt,ss,fs,js,ns;if(be.preventDefault(),l)return;const nt=Number((St==null?void 0:St.id)||0)||await ft(t),ut=Number(nt||0);let _t=[];if(_){if(!J.depositAccountId){mt.error("Select deposit account");return}const rs=J.items.map(ms=>({accountId:Number(ms.accountId||0),description:ms.description||null,amount:Number(ms.amount||0),referenceNo:ms.referenceNo&&String(ms.referenceNo).trim()||null})).filter(ms=>ms.accountId&&ms.amount>0);if(rs.length===0){mt.error("Enter at least one payment detail item");return}const bs=rs.reduce((ms,gr)=>ms+gr.amount,0);_t=[{accountId:Number(J.depositAccountId),description:J.receivedFrom||"Receipt",debit:Number(bs),credit:0},...rs.map(ms=>({accountId:ms.accountId,description:ms.description,debit:0,credit:ms.amount,referenceNo:ms.referenceNo||null}))]}else if(F){if(!Z.paymentAccountId){mt.error("Select payment account");return}const rs=Z.items.map(ms=>({accountId:Number(ms.accountId||0),description:ms.description||null,amount:Number(ms.amount||0),referenceNo:ms.referenceNo&&String(ms.referenceNo).trim()||null})).filter(ms=>ms.accountId&&ms.amount>0);if(rs.length===0){mt.error("Enter at least one payment detail item");return}const bs=rs.reduce((ms,gr)=>ms+gr.amount,0);_t=[...rs.map(ms=>({accountId:ms.accountId,description:ms.description,debit:ms.amount,credit:0,referenceNo:ms.referenceNo||null})),{accountId:Number(Z.paymentAccountId),description:Z.payTo||"Payment",debit:0,credit:Number(bs)}]}else if(E){if(!Ze.fromAccountId||!Ze.toAccountId){mt.error("Select both From and To accounts");return}if(String(Ze.fromAccountId)===String(Ze.toAccountId)){mt.error("From and To accounts must be different");return}const rs=Ze.items.map(ms=>({description:ms.description||null,amount:Number(ms.amount||0)})).filter(ms=>ms.amount>0);if(rs.length===0){mt.error("Enter at least one transfer detail item");return}const bs=rs.reduce((ms,gr)=>ms+gr.amount,0);_t=[{accountId:Number(Ze.toAccountId),description:"Account Transfer",debit:Number(bs),credit:0},{accountId:Number(Ze.fromAccountId),description:"Account Transfer",debit:0,credit:Number(bs)}]}else _t=W.map(rs=>({accountId:Number(rs.accountId||0),description:rs.description||null,debit:Number(rs.debit||0),credit:Number(rs.credit||0)})).filter(rs=>rs.accountId&&(rs.debit||rs.credit));if(_t.length<2){mt.error("Enter at least two posting lines");return}const Qt=_t.reduce((rs,bs)=>rs+Number(bs.debit||0),0),qt=_t.reduce((rs,bs)=>rs+Number(bs.credit||0),0);if(Math.round(Qt*100)!==Math.round(qt*100)){mt.error("Total debit must equal total credit");return}try{d(!0);const rs={voucherTypeId:ut,voucherTypeCode:t,voucherDate:D,narration:_?[J.receivedFrom?`Received from: ${J.receivedFrom}`:null,J.paymentMethod?`Method: ${J.paymentMethod}`:null,J.reference?`Ref: ${J.reference}`:null,M||null].filter(Boolean).join(" | "):F?[Z.payTo?`Paid to: ${Z.payTo}`:null,Z.paymentMethod?`Method: ${Z.paymentMethod}`:null,Z.reference?`Ref: ${Z.reference}`:null,M||null].filter(Boolean).join(" | "):E?[Ze.fromAccountId?`From: ${(Ut=x.find(bs=>String(bs.id)===String(Ze.fromAccountId)))==null?void 0:Ut.code}`:null,Ze.toAccountId?`To: ${(Zt=x.find(bs=>String(bs.id)===String(Ze.toAccountId)))==null?void 0:Zt.code}`:null,Ze.transferMethod?`Method: ${Ze.transferMethod}`:null,Ze.reference?`Ref: ${Ze.reference}`:null,M||null].filter(Boolean).join(" | "):M,lines:_t,...F?{apply_to_purchase_bills:(Z.items||[]).map(bs=>({ref:bs.referenceNo&&String(bs.referenceNo)||"",amount:Number(bs.amount||0)})).filter(bs=>bs.ref&&bs.amount>0).map(bs=>{const ms=P.find(gr=>String(gr.bill_no)===String(bs.ref));return ms?{bill_id:Number(ms.id),amount:bs.amount}:null}).filter(Boolean)}:{}};if(o){const bs=await te.put(`/finance/vouchers/${a}`,rs);mt.success(((ss=bs.data)==null?void 0:ss.message)||"Updated voucher")}else{const bs=await te.post("/finance/vouchers",rs);mt.success(`Created ${((fs=bs.data)==null?void 0:fs.voucherNo)||"voucher"}`)}r(`/finance/${t==="JV"?"journal-voucher":t==="PV"?"payment-voucher":t==="RV"?"receipt-voucher":t==="CV"?"contra-voucher":t==="SV"?"sales-voucher":t==="PUV"?"purchase-voucher":t==="DN"?"debit-note":t==="CN"?"credit-note":"journal-voucher"}`)}catch(rs){mt.error(((ns=(js=rs==null?void 0:rs.response)==null?void 0:js.data)==null?void 0:ns.message)||"Failed to create voucher")}finally{d(!1)}}if(!_&&!F&&!E)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Create a new voucher (double-entry enforced)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"..",className:"btn-success",children:"Back"}),$e==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var be,nt,ut,_t;if(o&&(ke(!0),me(""),!We))try{he(!0);const Qt=await te.get("/workflows"),qt=Array.isArray((be=Qt.data)==null?void 0:be.items)?Qt.data.items:[];He(qt);const Ut=(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0);let Zt=null;const ss=qt.filter(ns=>String(ns.document_route||"")==="/finance/receipt-voucher"),fs=qt.filter(ns=>["RECEIPT_VOUCHER","Receipt Voucher","RV"].includes(String(ns.document_type||""))),js=[...ss,...fs];for(const ns of js){if(Zt)break;if(Number(ns.is_active)!==1)continue;if(Ut===null){Zt=ns;break}const rs=ns.min_amount===null||Number(Ut)>=Number(ns.min_amount),bs=ns.max_amount===null||Number(Ut)<=Number(ns.max_amount);if(rs&&bs){Zt=ns;break}}if(!Zt)for(const ns of fs){if(Zt)break;if(Number(ns.is_active)!==1)continue;if(Ut===null){Zt=ns;break}const rs=ns.min_amount===null||Number(Ut)>=Number(ns.min_amount),bs=ns.max_amount===null||Number(Ut)<=Number(ns.max_amount);if(rs&&bs){Zt=ns;break}}if(Ue(Zt),dt(null),Pe(null),Zt){const ns=await te.get(`/workflows/${Zt.id}`),rs=((nt=ns==null?void 0:ns.data)==null?void 0:nt.item)||{},bs=Number(rs.current_step_order||1),ms=Array.isArray(rs==null?void 0:rs.next_step_approvers)?rs.next_step_approvers:[],gr=ms.length>0?Number(ms[0].id):null;dt({stepOrder:bs||1,stepName:String(rs.step_name||"Step 1"),approvalLimit:ms.length>0?Number(ms[0].approval_limit||0):null,approvers:ms}),Pe(gr)}}catch(Qt){me(((_t=(ut=Qt==null?void 0:Qt.response)==null?void 0:ut.data)==null?void 0:_t.message)||"Failed to load workflows")}finally{he(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:Hs,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:dd,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:T||(U?"CN-000001":L?"DN-000001":""),disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:D,onChange:be=>Y(be.target.value),required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year *"}),e.jsxs("select",{className:`input ${Nr}`,value:R,onChange:be=>H(be.target.value),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),h.map(be=>e.jsx("option",{value:be.id,children:be.code},be.id))]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"label",children:"Narration"}),e.jsx("input",{className:"input",value:M,onChange:be=>X(be.target.value),placeholder:"Optional narration",disabled:l})]})]}),ce&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-xl shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b",children:[e.jsx("div",{className:"font-semibold text-brand",children:"Select Paid To"}),e.jsx("button",{type:"button",className:"text-slate-600 hover:text-slate-800 text-xl font-bold",onClick:()=>le(!1),children:""})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input w-full",placeholder:"Type name or code",value:_e,onChange:be=>Qe(be.target.value),autoFocus:!0}),e.jsx("div",{className:"mt-3 max-h-64 overflow-y-auto border rounded",children:ll.length===0?e.jsx("div",{className:"p-3 text-center text-slate-500",children:"No matches"}):ll.sort((be,nt)=>String(be.name).localeCompare(String(nt.name))).map(be=>e.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-slate-100 border-b last:border-b-0",onClick:()=>{const nt=String(be.id),ut=String(be.name||""),_t=Z.items.length===0?[{description:"",accountId:nt,amount:0}]:Z.items.map((Qt,qt)=>qt===0?{...Qt,accountId:nt}:Qt);ma({payTo:ut,payToAccountId:nt,items:_t}),le(!1),Qe("")},children:[e.jsx("div",{className:"font-medium",children:be.name}),e.jsx("div",{className:"text-xs text-slate-500",children:be.code})]},be.id))}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{le(!1),Qe("")},children:"Close"})})]})]})}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[U||L?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input",value:Ge||"",readOnly:!0})]})}):null,e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Posting Lines"}),e.jsx("button",{type:"button",className:"btn-success",onClick:Ls,disabled:l,children:"+ Add Line"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),U||L?e.jsx("th",{className:"text-right w-32",children:"Currency"}):null,e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:W.map((be,nt)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:be.accountId,onChange:ut=>ls(nt,{accountId:ut.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),x.map(ut=>e.jsxs("option",{value:ut.id,children:[ut.code," - ",ut.name]},ut.id))]})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:be.description,onChange:ut=>ls(nt,{description:ut.target.value}),placeholder:"Line memo",disabled:l})}),U||L?e.jsx("td",{className:"text-right",children:(()=>{const ut=x.find(_t=>String(_t.id)===String(be.accountId||""));return(ut==null?void 0:ut.currency_code)||""})()}):null,e.jsx("td",{children:e.jsx("input",{className:"input text-right",type:"number",min:"0",step:"1",value:be.debit||"",onChange:ut=>ls(nt,{debit:String(ut.target.value||"").replace(/^0+(?=\d)/,""),credit:0}),onFocus:()=>{String(be.debit??"")==="0"&&ls(nt,{debit:""})},disabled:l})}),e.jsx("td",{children:e.jsx("input",{className:"input text-right",type:"number",min:"0",step:"1",value:be.credit||"",onChange:ut=>ls(nt,{credit:String(ut.target.value||"").replace(/^0+(?=\d)/,""),debit:0}),onFocus:()=>{String(be.credit??"")==="0"&&ls(nt,{credit:""})},disabled:l})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"text-red-600 hover:text-red-700 text-sm font-medium",onClick:()=>Is(nt),disabled:l,children:"Remove"})})]},nt))})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs("div",{className:"w-72 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Debit"}),e.jsx("span",{children:`GH ${Je.debit.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Credit"}),e.jsx("span",{children:`GH ${Je.credit.toFixed(2)}`})]}),e.jsxs("div",{className:`flex justify-between text-sm font-semibold ${ts?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:[e.jsx("span",{children:"Status"}),e.jsx("span",{children:ts?"Balanced":"Not Balanced"})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||!ts||l,children:u?"Saving...":"Save Voucher"})]})]})})}),Ie?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Receipt Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:T||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:xe?xe.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:je||""}),e.jsx("div",{children:pe?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):ct&&Array.isArray(ct.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ze||"",onChange:be=>Pe(be.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),ct.approvers.map(be=>e.jsx("option",{value:be.id,children:be.username},be.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:ct?`Step ${ct.stepOrder}  ${ct.stepName}${ct.approvalLimit!=null?`  Limit: ${Number(ct.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:xe?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var be,nt,ut;if(o){Ke(!0),me("");try{const _t=await te.post(`/finance/vouchers/${a}/submit`,{amount:(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0),workflow_id:xe?xe.id:null,target_user_id:ze||null}),Qt=((be=_t==null?void 0:_t.data)==null?void 0:be.status)||"PENDING_APPROVAL";Ve(Qt),ke(!1)}catch(_t){me(((ut=(nt=_t==null?void 0:_t.response)==null?void 0:nt.data)==null?void 0:ut.message)||"Failed to forward for approval")}finally{Ke(!1)}}},disabled:Te||!o,children:Te?"Forwarding...":"Forward"})]})]})}):null]});function Ir(be){l||ae(nt=>({...nt,...be}))}function ya(be,nt){l||Ir({items:J.items.map((ut,_t)=>_t===be?{...ut,...nt}:ut)})}function yr(be){const nt=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],ut=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],_t=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],Qt=Math.floor(be||0),qt=Math.round(((be||0)-Qt)*100);function Ut(ss){return ss===0?"":ss<10?nt[ss]:ss<20?_t[ss-10]:ss<100?ut[Math.floor(ss/10)]+(ss%10!==0?" "+nt[ss%10]:""):ss<1e3?nt[Math.floor(ss/100)]+" Hundred"+(ss%100!==0?" "+Ut(ss%100):""):ss<1e6?Ut(Math.floor(ss/1e3))+" Thousand"+(ss%1e3!==0?" "+Ut(ss%1e3):""):Ut(Math.floor(ss/1e6))+" Million"+(ss%1e6!==0?" "+Ut(ss%1e6):"")}let Zt=Ut(Qt)+" Cedi"+(Qt!==1?"s":"");return qt>0&&(Zt+=" and "+Ut(qt)+" Pesewa"+(qt!==1?"s":"")),Zt}function cr(be){const nt=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],ut=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],_t=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],Qt=Math.floor(be||0),qt=Math.round(((be||0)-Qt)*100);function Ut(fs){return fs===0?"Zero":fs<10?nt[fs]:fs<20?_t[fs-10]:fs<100?ut[Math.floor(fs/10)]+(fs%10!==0?" "+nt[fs%10]:""):fs<1e3?nt[Math.floor(fs/100)]+" Hundred"+(fs%100!==0?" "+Ut(fs%100):""):fs<1e6?Ut(Math.floor(fs/1e3))+" Thousand"+(fs%1e3!==0?" "+Ut(fs%1e3):""):Ut(Math.floor(fs/1e6))+" Million"+(fs%1e6!==0?" "+Ut(fs%1e6):"")}const Zt=Ut(Qt),ss=String(qt).padStart(2,"0");return qt>0?`${Zt} and ${ss}/100`:`${Zt}`}const ka=v.useMemo(()=>["Cheque","Bank Transfer","Credit Card"].includes(J.paymentMethod||""),[J.paymentMethod]),Ks=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(J.depositAccountId||""));return(be==null?void 0:be.currency_code)||""},[x,J.depositAccountId]),jr=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(J.payerAccountId||""));return(be==null?void 0:be.currency_code)||""},[x,J.payerAccountId]),nl=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(J.payerAccountId||""));return(be==null?void 0:be.currency_id)||null},[x,J.payerAccountId]),zr=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(J.depositAccountId||""));return(be==null?void 0:be.currency_id)||null},[x,J.depositAccountId]),sa=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Ze.toAccountId||""));return(be==null?void 0:be.currency_code)||""},[x,Ze.toAccountId]),on=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Ze.fromAccountId||""));return(be==null?void 0:be.currency_code)||""},[x,Ze.fromAccountId]),yi=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Ze.fromAccountId||""));return(be==null?void 0:be.currency_id)||null},[x,Ze.fromAccountId]),en=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Ze.toAccountId||""));return(be==null?void 0:be.currency_id)||null},[x,Ze.toAccountId]),Oi=v.useMemo(()=>{const be=new Set(["BANK ACCOUNTS","CASH AND CASH EQUIVALENTS"]);return(x||[]).filter(nt=>be.has(String(nt.group_name||"").trim().toUpperCase()))},[x]),Qr=v.useMemo(()=>{const be=x.find(Ut=>String(Ut.id)===String(Ze.fromAccountId||"")),nt=x.find(Ut=>String(Ut.id)===String(Ze.toAccountId||"")),ut=String((be==null?void 0:be.group_code)||"").toUpperCase(),_t=String((be==null?void 0:be.group_name)||"").toUpperCase(),Qt=String((nt==null?void 0:nt.group_code)||"").toUpperCase(),qt=String((nt==null?void 0:nt.group_name)||"").toUpperCase();return ut==="AST_BANK"||_t==="BANK ACCOUNTS"||Qt==="AST_BANK"||qt==="BANK ACCOUNTS"},[x,Ze.fromAccountId,Ze.toAccountId]),Fn=v.useMemo(()=>{const be=zr;let nt=Ne.find(ut=>String(ut.id)===String(be));return!nt&&Ks&&(nt=Ne.find(ut=>String(ut.code)===String(Ks))),nt?String(nt.name||""):""},[Ne,zr,Ks]),ji=v.useMemo(()=>["Cheque","Bank Transfer","Credit Card"].includes(Z.paymentMethod||""),[Z.paymentMethod]),Gn=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Z.paymentAccountId||""));return(be==null?void 0:be.currency_code)||""},[x,Z.paymentAccountId]),Kn=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Z.payToAccountId||""));return(be==null?void 0:be.currency_code)||""},[x,Z.payToAccountId]),od=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Z.payToAccountId||""));return(be==null?void 0:be.currency_id)||null},[x,Z.payToAccountId]),il=v.useMemo(()=>{const be=x.find(nt=>String(nt.id)===String(Z.paymentAccountId||""));return(be==null?void 0:be.currency_id)||null},[x,Z.paymentAccountId]),xr=v.useMemo(()=>{const be=il,nt=Ne.find(ut=>String(ut.id)===String(be));return String(nt?nt.name||nt.code||"":Gn||"")},[Ne,il,Gn]),Nr=l?"bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold":"",cd=v.useMemo(()=>{const be=c.find(nt=>String(nt.code).toUpperCase()===String(t).toUpperCase());return(be==null?void 0:be.name)||"Payment Voucher"},[c,t]),fc=v.useMemo(()=>{const be=c.find(nt=>String(nt.code).toUpperCase()===String(t).toUpperCase());return(be==null?void 0:be.name)||"Receive Voucher"},[c,t]),dd=v.useMemo(()=>{const be=c.find(ut=>String(ut.code).toUpperCase()===String(t).toUpperCase());if(be!=null&&be.name)return be.name;const nt=String(t||"").toUpperCase();return nt==="CN"?"Credit Note":nt==="DN"?"Debit Note":"Voucher"},[c,t]);if(v.useEffect(()=>{if(!E)return;const be=yi||null,nt=en||null,ut=on||"",_t=sa||"";if(!be||!nt){we("");return}if(ut&&_t&&ut===_t){we("1");return}(async()=>{var Qt;try{const qt=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Number(be),toCurrencyId:Number(nt),to:D||null}}),Zt=(Array.isArray((Qt=qt.data)==null?void 0:Qt.items)?qt.data.items:[]).slice().sort((fs,js)=>new Date(js.rate_date).getTime()-new Date(fs.rate_date).getTime()),ss=Zt.length?Number(Zt[0].rate||0):0;we(ss?String(ss):"")}catch{we("")}})()},[E,yi,en,on,sa,D]),_)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Record incoming payments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"..",className:"btn-success",children:"Back"}),$e==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var be,nt,ut,_t;if(o&&(ke(!0),me(""),!We))try{he(!0);const Qt=await te.get("/workflows"),qt=Array.isArray((be=Qt.data)==null?void 0:be.items)?Qt.data.items:[];He(qt);const Ut=(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0);let Zt=null;const ss=qt.filter(ns=>String(ns.document_route||"")==="/finance/contra-voucher"),fs=qt.filter(ns=>["CONTRA_VOUCHER","Contra Voucher","CV"].includes(String(ns.document_type||""))),js=[...ss,...fs];for(const ns of js){if(Zt)break;if(Number(ns.is_active)!==1)continue;if(Ut===null){Zt=ns;break}const rs=ns.min_amount===null||Number(Ut)>=Number(ns.min_amount),bs=ns.max_amount===null||Number(Ut)<=Number(ns.max_amount);if(rs&&bs){Zt=ns;break}}if(!Zt)for(const ns of fs){if(Zt)break;if(Number(ns.is_active)!==1)continue;if(Ut===null){Zt=ns;break}const rs=ns.min_amount===null||Number(Ut)>=Number(ns.min_amount),bs=ns.max_amount===null||Number(Ut)<=Number(ns.max_amount);if(rs&&bs){Zt=ns;break}}if(Ue(Zt),dt(null),Pe(null),Zt){const ns=await te.get(`/workflows/${Zt.id}`),rs=((nt=ns==null?void 0:ns.data)==null?void 0:nt.item)||{},bs=Number(rs.current_step_order||1),ms=Array.isArray(rs==null?void 0:rs.next_step_approvers)?rs.next_step_approvers:[],gr=ms.length>0?Number(ms[0].id):null;dt({stepOrder:bs||1,stepName:String(rs.step_name||"Step 1"),approvalLimit:ms.length>0?Number(ms[0].approval_limit||0):null,approvers:ms}),Pe(gr)}}catch(Qt){me(((_t=(ut=Qt==null?void 0:Qt.response)==null?void 0:ut.data)==null?void 0:_t.message)||"Failed to load workflows")}finally{he(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:Hs,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:fc,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:T||"RV-000001",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:D,onChange:be=>Y(be.target.value),required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year *"}),e.jsxs("select",{className:`input ${Nr}`,value:R,onChange:be=>H(be.target.value),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),h.map(be=>e.jsx("option",{value:be.id,children:be.code},be.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Received From"}),e.jsxs("select",{className:`input ${Nr}`,value:J.receivedFromCode||"",onChange:be=>{const nt=be.target.value,ut=N.find(js=>String(js.code)===String(nt)),_t=(ut==null?void 0:ut.name)||"",Qt=x.find(js=>String(js.code)===String(nt)),qt=String((ut==null?void 0:ut.type)||"").toUpperCase()==="CUSTOMER",Ut=String((ut==null?void 0:ut.type)||"").toUpperCase()==="SUPPLIER",Zt=x.find(js=>{const ns=String(js.group_name||"").toUpperCase(),rs=qt?"DEBTORS":Ut?"CREDITORS":"";if(rs&&ns!==rs)return!1;const bs=String(js.name||"").trim().toLowerCase(),ms=String(_t||"").trim().toLowerCase();return bs===ms||bs.includes(ms)||ms.includes(bs)}),ss=Qt||Zt||null,fs=ss!=null&&ss.id?String(ss.id):"";qt&&(ut!=null&&ut.id)?ge(ut.id):k([]),Ir({receivedFrom:_t,receivedFromCode:nt,payerAccountId:fs,items:J.items.length===0?[{description:"",accountId:fs,amount:"",referenceNo:""}]:J.items.map((js,ns)=>ns===0?{...js,accountId:fs}:js)})},disabled:l,children:[e.jsx("option",{value:"",children:"Select customer or supplier"}),N.map(be=>e.jsx("option",{value:be.code,children:be.name},be.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsxs("select",{className:`input ${Nr}`,value:J.paymentMethod,onChange:be=>Ir({paymentMethod:be.target.value}),disabled:l,children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Cheque"}),e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Credit Card"}),e.jsx("option",{children:"Mobile Money"})]})]}),ka?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Cheque No"}),e.jsx("input",{className:`input ${Nr}`,value:J.reference,onChange:be=>Ir({reference:be.target.value}),placeholder:"Reference Number or Cheque Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cheque Date"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:J.chequeDate||"",onChange:be=>Ir({chequeDate:be.target.value}),disabled:l})]})]})}):null]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"label",children:"Deposit Account *"}),e.jsx("span",{className:"text-xs text-slate-500",children:Ks||""})]}),e.jsxs("select",{className:`input ${Nr}`,value:J.depositAccountId,onChange:be=>Ir({depositAccountId:be.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),x.filter(be=>{const nt=String(be.group_code||"").toUpperCase(),ut=String(be.group_name||"").toUpperCase();return ka?nt==="AST_BANK"||ut==="BANK ACCOUNTS":nt==="AST_CASH"||ut==="CASH AND CASH EQUIVALENTS"}).map(be=>e.jsxs("option",{value:be.id,children:[be.code," - ",be.name]},be.id))]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:Ks||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:it||"",readOnly:!0})]})]})})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[U||L?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input",value:Ge||"",readOnly:!0})]})}):null,e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Payment Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:"#"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"w-64",children:"Account"}),e.jsx("th",{className:"w-64",children:"Bill"}),e.jsx("th",{className:"text-right w-32",children:"Currency"}),e.jsx("th",{className:"text-right w-40",children:"Amount"}),e.jsx("th",{className:"w-24"})]})}),e.jsx("tbody",{children:J.items.length===0?e.jsx("tr",{children:e.jsx("td",{className:"text-center p-2",colSpan:7,children:"No items"})}):J.items.map((be,nt)=>e.jsxs("tr",{children:[e.jsx("td",{children:nt+1}),e.jsx("td",{children:e.jsx("input",{className:`input ${Nr}`,value:be.description,onChange:ut=>ya(nt,{description:ut.target.value}),placeholder:"Description",disabled:l})}),e.jsx("td",{children:e.jsxs("select",{className:`input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold ${Nr}`,value:be.accountId,onChange:ut=>{const _t=ut.target.value;if(ya(nt,{accountId:_t}),nt===0){const Qt=x.find(ss=>String(ss.id)===String(_t)),qt=Qt!=null&&Qt.code?String(Qt.code):"",Ut=N.find(ss=>String(ss.code)===String(qt)),Zt=(Ut==null?void 0:Ut.name)||"";Ir({receivedFrom:Zt,receivedFromCode:qt,payerAccountId:String(_t||"")})}},required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),x.map(ut=>e.jsx("option",{value:ut.id,children:ut.name},ut.id))]})}),e.jsx("td",{children:S.length>0?nt===0?e.jsx("select",{multiple:!0,className:`input ${Nr}`,value:Q,onChange:ut=>{const _t=Array.from(ut.target.selectedOptions).map(Ut=>Ut.value);O(_t);const Qt=S.filter(Ut=>_t.includes(String(Ut.invoice_no))),qt=Qt.length>0?Qt.map(Ut=>({description:`Invoice ${Ut.invoice_no} payment`,accountId:J.payerAccountId||"",amount:Number(Ut.balance_amount||0),referenceNo:String(Ut.invoice_no)})):[{description:"",accountId:J.payerAccountId||"",amount:0,referenceNo:""}];Ir({items:qt})},size:Math.min(6,Math.max(3,S.length)),disabled:l,children:S.map(ut=>e.jsxs("option",{value:ut.invoice_no,children:[ut.invoice_no,"  Outstanding"," ",Number(ut.balance_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},ut.id))}):e.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Select invoices using first row"}):e.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"No outstanding invoices for selected customer"})}),e.jsx("td",{className:"text-right",children:jr||""}),e.jsx("td",{children:e.jsx("input",{className:`input text-right ${Nr}`,type:"number",min:"0",step:"1",value:be.amount||"",onChange:ut=>ya(nt,{amount:Number(ut.target.value||0)}),onFocus:()=>{Number(be.amount||0)===0&&ya(nt,{amount:""})},disabled:l})}),e.jsx("td",{children:e.jsx("div",{})})]},nt))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold",children:Number(Je.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Tax (",Number(((Ni=b.find(be=>String(be.id)===String(J.taxCodeId)))==null?void 0:Ni.rate_percent)||0),"%)"]}),e.jsxs("select",{className:`input w-36 ${Nr}`,value:J.taxCodeId,onChange:be=>Ir({taxCodeId:be.target.value}),disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),b.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]})]}),e.jsx("span",{className:"font-semibold",children:Number(Je.tax||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("span",{className:"font-bold",children:Number(Je.grand||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount in Words"}),e.jsx("textarea",{className:"input h-20",value:`${cr(Number(Je.grand||0))} ${Fn}`.trim(),readOnly:!0})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes / Remarks"}),e.jsx("textarea",{className:"input h-24",value:J.notes,onChange:be=>Ir({notes:be.target.value}),placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:Ht,children:"Print Voucher"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Ot,children:"Download PDF"}),e.jsx(Ee,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||l||!ts||!J.depositAccountId||Number(Je.grand||0)<=0,children:u?"Saving...":"Save Voucher"})]})]})})}),Ie?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Contra Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:T||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:xe?xe.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:je||""}),e.jsx("div",{children:pe?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):ct&&Array.isArray(ct.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ze||"",onChange:be=>Pe(be.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),ct.approvers.map(be=>e.jsx("option",{value:be.id,children:be.username},be.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:ct?`Step ${ct.stepOrder}  ${ct.stepName}${ct.approvalLimit!=null?`  Limit: ${Number(ct.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:xe?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var be,nt,ut;if(o){Ke(!0),me("");try{const _t=await te.post(`/finance/vouchers/${a}/submit`,{amount:(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0),workflow_id:xe?xe.id:null,target_user_id:ze||null}),Qt=((be=_t==null?void 0:_t.data)==null?void 0:be.status)||"PENDING_APPROVAL";Ve(Qt),ke(!1)}catch(_t){me(((ut=(nt=_t==null?void 0:_t.response)==null?void 0:nt.data)==null?void 0:ut.message)||"Failed to forward for approval")}finally{Ke(!1)}}},disabled:Te||!o,children:Te?"Forwarding...":"Forward"})]})]})}):null]});function ma(be){l||oe(nt=>({...nt,...be}))}function Qi(be,nt){l||ma({items:Z.items.map((ut,_t)=>_t===be?{...ut,...nt}:ut)})}const ll=v.useMemo(()=>{const be=x.filter(ut=>["DEBTORS","CREDITORS"].includes(String(ut.group_name||"").toUpperCase()));if(!_e)return be;const nt=String(_e).toLowerCase();return be.filter(ut=>String(ut.name||"").toLowerCase().includes(nt)||String(ut.code||"").toLowerCase().includes(nt))},[x,_e]);if(v.useEffect(()=>{if(!F)return;const be=x.find(qt=>String(qt.id)===String(Z.paymentAccountId||""));if(!be)return;const nt=String(be.group_code||"").toUpperCase(),ut=String(be.group_name||"").toUpperCase();(ji?nt==="AST_BANK"||ut==="BANK ACCOUNTS":nt==="AST_CASH"||ut==="CASH AND CASH EQUIVALENTS")||ma({paymentAccountId:""})},[F,ji,x,Z.paymentAccountId]),v.useEffect(()=>{if(!_)return;const be=x.find(qt=>String(qt.id)===String(J.depositAccountId||""));if(!be)return;const nt=String(be.group_code||"").toUpperCase(),ut=String(be.group_name||"").toUpperCase();(ka?nt==="AST_BANK"||ut==="BANK ACCOUNTS":nt==="AST_CASH"||ut==="CASH AND CASH EQUIVALENTS")||Ir({depositAccountId:""})},[_,ka,x,J.depositAccountId]),v.useEffect(()=>{if(!F)return;const be=od||null,nt=il||null,ut=Kn||"",_t=Gn||"";if(!be||!nt){se("");return}if(ut&&_t&&ut===_t){se("1");return}(async()=>{var Qt;try{const qt=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Number(be),toCurrencyId:Number(nt),to:D||null}}),Zt=(Array.isArray((Qt=qt.data)==null?void 0:Qt.items)?qt.data.items:[]).slice().sort((fs,js)=>new Date(js.rate_date).getTime()-new Date(fs.rate_date).getTime()),ss=Zt.length?Number(Zt[0].rate||0):0;se(ss?String(ss):"")}catch{se("")}})()},[F,od,il,Kn,Gn,D]),v.useEffect(()=>{if(!_)return;const be=nl||null,nt=zr||null,ut=jr||"",_t=Ks||"";if(!be||!nt){lt("1");return}if(ut&&_t&&ut===_t){lt("1");return}(async()=>{var Qt,qt;try{const Ut=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Number(be),toCurrencyId:Number(nt),to:D||null}}),ss=(Array.isArray((Qt=Ut.data)==null?void 0:Qt.items)?Ut.data.items:[]).slice().sort((js,ns)=>new Date(ns.rate_date).getTime()-new Date(js.rate_date).getTime());let fs=ss.length?Number(ss[0].rate||0):0;if(!fs)try{const js=await te.get("/finance/currency-rates",{params:{fromCurrencyId:Number(nt),toCurrencyId:Number(be),to:D||null}}),rs=(Array.isArray((qt=js.data)==null?void 0:qt.items)?js.data.items:[]).slice().sort((ms,gr)=>new Date(gr.rate_date).getTime()-new Date(ms.rate_date).getTime()),bs=rs.length?Number(rs[0].rate||0):0;fs=bs?1/bs:0}catch{}lt(fs?String(fs):"1")}catch{lt("1")}})()},[_,nl,zr,jr,Ks,D]),F)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Record outgoing payments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"..",className:"btn-success",children:"Back"}),$e==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var be,nt,ut,_t,Qt;if(o&&(ke(!0),me(""),!We))try{he(!0);const qt=await te.get("/workflows"),Ut=Array.isArray((be=qt.data)==null?void 0:be.items)?qt.data.items:[];He(Ut);const Zt=(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0);let ss=null;const fs=Ut.filter(rs=>String(rs.document_route||"")==="/finance/payment-voucher"),js=Ut.filter(rs=>["PAYMENT_VOUCHER","Payment Voucher","PV"].includes(String(rs.document_type||""))),ns=[...fs,...js];for(const rs of ns){if(ss)break;if(Number(rs.is_active)!==1)continue;if(Zt===null){ss=rs;break}const bs=rs.min_amount===null||Number(Zt)>=Number(rs.min_amount),ms=rs.max_amount===null||Number(Zt)<=Number(rs.max_amount);if(bs&&ms){ss=rs;break}}if(!ss)for(const rs of js){if(ss)break;if(Number(rs.is_active)!==1)continue;if(Zt===null){ss=rs;break}const bs=rs.min_amount===null||Number(Zt)>=Number(rs.min_amount),ms=rs.max_amount===null||Number(Zt)<=Number(rs.max_amount);if(bs&&ms){ss=rs;break}}if(Ue(ss),dt(null),Pe(null),ss){const rs=await te.get(`/workflows/${ss.id}`),bs=((nt=rs==null?void 0:rs.data)==null?void 0:nt.item)||{},ms=Number(bs.current_step_order||1),gr=Array.isArray(bs==null?void 0:bs.next_step_approvers)?bs.next_step_approvers:[],dn=await te.get(`/workflows/${ss.id}`),na=Array.isArray((ut=dn==null?void 0:dn.data)!=null&&ut.item?[dn.data.item]:[])?[]:[],hr=ms||1,fa=gr.length>0?Number(gr[0].id):null;dt({stepOrder:hr,stepName:String(bs.step_name||"Step 1"),approvalLimit:gr.length>0?Number(gr[0].approval_limit||0):null,approvers:gr}),Pe(fa)}}catch(qt){me(((Qt=(_t=qt==null?void 0:qt.response)==null?void 0:_t.data)==null?void 0:Qt.message)||"Failed to load workflows")}finally{he(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:Hs,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:cd,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:T||"PV-000000",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:"input",type:"date",value:D,onChange:be=>Y(be.target.value),required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year *"}),e.jsxs("select",{className:"input",value:R,onChange:be=>H(be.target.value),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),h.map(be=>e.jsx("option",{value:be.id,children:be.code},be.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Paid To"}),e.jsxs("select",{className:`input ${Nr}`,value:Z.payToCode||"",onChange:be=>{const nt=be.target.value,ut=N.find(Zt=>String(Zt.code)===String(nt)),_t=(ut==null?void 0:ut.name)||"",Qt=x.find(Zt=>String(Zt.code)===String(nt)),qt=Qt!=null&&Qt.id?String(Qt.id):"",Ut=Z.items.length===0?[{description:"",accountId:qt,amount:0}]:Z.items.map((Zt,ss)=>ss===0?{...Zt,accountId:qt}:Zt);ma({payTo:_t,payToCode:nt,payToAccountId:qt,items:Ut}),String((ut==null?void 0:ut.type)||"").toUpperCase()==="SUPPLIER"&&(ut!=null&&ut.id)?rt(ut.id):(I([]),q([]))},disabled:l,children:[e.jsx("option",{value:"",children:"Select customer or supplier"}),N.map(be=>e.jsx("option",{value:be.code,children:be.name},be.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsxs("select",{className:`input ${Nr}`,value:Z.paymentMethod,onChange:be=>ma({paymentMethod:be.target.value}),children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Cheque"}),e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Credit Card"}),e.jsx("option",{children:"Mobile Money"})]})]}),ji?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Cheque No"}),e.jsx("input",{className:`input ${Nr}`,value:Z.reference,onChange:be=>ma({reference:be.target.value}),placeholder:"Reference Number or Cheque Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cheque Date"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:Z.chequeDate||"",onChange:be=>ma({chequeDate:be.target.value}),disabled:l})]})]})}):null]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Account *"}),e.jsxs("select",{className:`input ${Nr}`,value:Z.paymentAccountId,onChange:be=>ma({paymentAccountId:be.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select account"}),x.filter(be=>{const nt=String(be.group_code||"").toUpperCase(),ut=String(be.group_name||"").toUpperCase();return ji?nt==="AST_BANK"||ut==="BANK ACCOUNTS":nt==="AST_CASH"||ut==="CASH AND CASH EQUIVALENTS"}).map(be=>e.jsxs("option",{value:be.id,children:[be.code," - ",be.name]},be.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Outstanding Bills"}),P.length>0?e.jsx("select",{multiple:!0,className:`input ${Nr}`,value:B,onChange:be=>{const nt=Array.from(be.target.selectedOptions).map(Qt=>Qt.value);q(nt);const ut=P.filter(Qt=>nt.includes(String(Qt.bill_no))),_t=ut.length>0?ut.map(Qt=>({description:`Bill ${Qt.bill_no} payment`,accountId:Z.payToAccountId||"",amount:Number(Qt.outstanding||0),referenceNo:String(Qt.bill_no)})):[{description:"",accountId:Z.payToAccountId||"",amount:0,referenceNo:""}];ma({items:_t})},size:Math.min(6,Math.max(3,P.length)),disabled:l,children:P.map(be=>e.jsxs("option",{value:be.bill_no,children:[be.bill_no,"  ",be.payment_status,"  Outstanding"," ",Number(be.outstanding||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},be.id))}):e.jsx("div",{className:"input bg-gray-100 text-gray-500",children:"No bills for selected supplier"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:Gn||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:ee||"",readOnly:!0})]})]}),e.jsx("div",{})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Payment Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:"#"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"w-64",children:"Account"}),e.jsx("th",{className:"text-right w-32",children:"Currency"}),e.jsx("th",{className:"text-right w-40",children:"Amount"})]})}),e.jsx("tbody",{children:Z.items.length===0?e.jsx("tr",{children:e.jsx("td",{className:"text-center p-2",colSpan:5,children:"No items"})}):Z.items.map((be,nt)=>e.jsxs("tr",{children:[e.jsx("td",{children:nt+1}),e.jsx("td",{children:e.jsx("input",{className:`input ${Nr}`,value:be.description,onChange:ut=>Qi(nt,{description:ut.target.value}),placeholder:"Description"})}),e.jsx("td",{children:e.jsxs("select",{className:`input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold ${Nr}`,value:be.accountId,onChange:ut=>Qi(nt,{accountId:ut.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),x.map(ut=>e.jsx("option",{value:ut.id,children:ut.name},ut.id))]})}),e.jsx("td",{className:"text-right",children:Kn||""}),e.jsx("td",{children:e.jsx("input",{className:`input text-right ${Nr}`,type:"number",min:"0",step:"1",value:be.amount||"",onChange:ut=>Qi(nt,{amount:Number(ut.target.value||0)}),onFocus:()=>{Number(be.amount||0)===0&&Qi(nt,{amount:""})},disabled:l})})]},nt))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold",children:Number(Je.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Tax (",Number(((zn=b.find(be=>String(be.id)===String(Z.taxCodeId)))==null?void 0:zn.rate_percent)||0),"%)"]}),e.jsxs("select",{className:"input w-36",value:Z.taxCodeId,onChange:be=>ma({taxCodeId:be.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),b.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]})]}),e.jsx("span",{className:"font-semibold",children:Number(Je.tax||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("span",{className:"font-bold",children:Number(Je.grand||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount in Words"}),e.jsx("textarea",{className:"input h-20",value:`${cr(Number(Je.grand||0))} ${xr}`.trim(),readOnly:!0})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes / Remarks"}),e.jsx("textarea",{className:`input h-24 ${Nr}`,value:Z.notes,onChange:be=>ma({notes:be.target.value}),placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:Ht,children:"Print Voucher"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Ot,children:"Download PDF"}),e.jsx(Ee,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||l||!ts||!Z.paymentAccountId||Number(Je.grand||0)<=0,children:u?"Saving...":"Save Voucher"})]})]})})}),Ie?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Payment Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:T||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:xe?xe.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:je||""}),e.jsx("div",{children:pe?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):ct&&Array.isArray(ct.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ze||"",onChange:be=>Pe(be.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),ct.approvers.map(be=>e.jsx("option",{value:be.id,children:be.username},be.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:ct?`Step ${ct.stepOrder}  ${ct.stepName}${ct.approvalLimit!=null?`  Limit: ${Number(ct.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:xe?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var be,nt,ut;if(o){Ke(!0),me("");try{const _t=await te.post(`/finance/vouchers/${a}/submit`,{amount:(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0),workflow_id:xe?xe.id:null,target_user_id:ze||null}),Qt=((be=_t==null?void 0:_t.data)==null?void 0:be.status)||"PENDING_APPROVAL";Ve(Qt),ke(!1)}catch(_t){me(((ut=(nt=_t==null?void 0:_t.response)==null?void 0:nt.data)==null?void 0:ut.message)||"Failed to forward for approval")}finally{Ke(!1)}}},disabled:Te||!o,children:Te?"Forwarding...":"Forward"})]})]})}):null]});function cn(be){l||Re(nt=>({...nt,...be}))}function Mr(be,nt){l||cn({items:Ze.items.map((ut,_t)=>_t===be?{...ut,...nt}:ut)})}if(E)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Transfer funds between accounts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"..",className:"btn-success",children:"Back"}),e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var be,nt,ut,_t;if(o&&(ke(!0),me(""),!We))try{he(!0);const Qt=await te.get("/workflows"),qt=Array.isArray((be=Qt.data)==null?void 0:be.items)?Qt.data.items:[];He(qt);const Ut=(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0);let Zt=null;const ss=qt.filter(ns=>String(ns.document_route||"")==="/finance/contra-voucher"),fs=qt.filter(ns=>["CONTRA_VOUCHER","Contra Voucher","CV"].includes(String(ns.document_type||""))),js=[...ss,...fs];for(const ns of js){if(Zt)break;if(Number(ns.is_active)!==1)continue;if(Ut===null){Zt=ns;break}const rs=ns.min_amount===null||Number(Ut)>=Number(ns.min_amount),bs=ns.max_amount===null||Number(Ut)<=Number(ns.max_amount);if(rs&&bs){Zt=ns;break}}if(!Zt)for(const ns of fs){if(Zt)break;if(Number(ns.is_active)!==1)continue;if(Ut===null){Zt=ns;break}const rs=ns.min_amount===null||Number(Ut)>=Number(ns.min_amount),bs=ns.max_amount===null||Number(Ut)<=Number(ns.max_amount);if(rs&&bs){Zt=ns;break}}if(Ue(Zt),dt(null),Pe(null),Zt){const ns=await te.get(`/workflows/${Zt.id}`),rs=((nt=ns==null?void 0:ns.data)==null?void 0:nt.item)||{},bs=Number(rs.current_step_order||1),ms=Array.isArray(rs==null?void 0:rs.next_step_approvers)?rs.next_step_approvers:[],gr=ms.length>0?Number(ms[0].id):null;dt({stepOrder:bs||1,stepName:String(rs.step_name||"Step 1"),approvalLimit:ms.length>0?Number(ms[0].approval_limit||0):null,approvers:ms}),Pe(gr)}}catch(Qt){me(((_t=(ut=Qt==null?void 0:Qt.response)==null?void 0:ut.data)==null?void 0:_t.message)||"Failed to load workflows")}finally{he(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:Hs,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:"Contra Voucher",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:T||"CV-000001",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:"input",type:"date",value:D,onChange:be=>Y(be.target.value),required:!0,disabled:l})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Account *"}),e.jsxs("select",{className:"input",value:Ze.fromAccountId,onChange:be=>cn({fromAccountId:be.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),Oi.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:on||"",readOnly:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Account *"}),e.jsxs("select",{className:"input",value:Ze.toAccountId,onChange:be=>cn({toAccountId:be.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),Oi.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:sa||"",readOnly:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer Method"}),e.jsxs("select",{className:"input",value:Ze.transferMethod,onChange:be=>cn({transferMethod:be.target.value}),disabled:l,children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Cheque"}),e.jsx("option",{children:"Bank Transfer"})]})]}),Qr?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Cheque No"}),e.jsx("input",{className:"input",value:Ze.reference,onChange:be=>cn({reference:be.target.value}),placeholder:"Reference Number or Cheque Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cheque Date"}),e.jsx("input",{className:"input",type:"date",value:Ze.chequeDate||"",onChange:be=>cn({chequeDate:be.target.value}),disabled:l})]})]})}):e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Instrument No"}),e.jsx("input",{className:"input",value:Ze.reference,onChange:be=>cn({reference:be.target.value}),placeholder:"Reference Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:Ae||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Code"}),e.jsxs("select",{className:"input",value:Ze.taxCodeId,onChange:be=>cn({taxCodeId:be.target.value}),disabled:l,children:[e.jsx("option",{value:"",children:"None"}),b.map(be=>e.jsx("option",{value:be.id,children:be.name},be.id))]})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Transfer Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:"#"}),e.jsx("th",{className:"w-64",children:"Description"}),e.jsx("th",{className:"text-right w-40",children:"Amount to Transfer"}),e.jsx("th",{className:"w-24 hidden"})]})}),e.jsx("tbody",{children:Ze.items.length===0?e.jsx("tr",{children:e.jsx("td",{className:"text-center p-2",colSpan:4,children:"No items"})}):Ze.items.map((be,nt)=>e.jsxs("tr",{children:[e.jsx("td",{children:nt+1}),e.jsx("td",{children:e.jsx("input",{className:"input",value:be.description,onChange:ut=>Mr(nt,{description:ut.target.value}),placeholder:"Description",disabled:l})}),e.jsx("td",{children:e.jsx("input",{className:"input text-right",type:"number",min:"0",step:"1",value:be.amount,onChange:ut=>Mr(nt,{amount:Number(ut.target.value||0)}),onFocus:()=>{Number(be.amount||0)===0&&Mr(nt,{amount:""})},disabled:l})}),e.jsx("td",{className:"hidden"})]},nt))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold",children:Number(Je.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{children:["Tax (",Number(((Ms=b.find(be=>String(be.id)===String(Ze.taxCodeId)))==null?void 0:Ms.rate_percent)||0),"%)"]})}),e.jsx("span",{className:"font-semibold",children:Number(Je.tax||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("span",{className:"font-bold",children:Number(Je.grand||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount in Words"}),e.jsx("textarea",{className:"input h-20",value:yr(Number(Je.grand||0)),readOnly:!0})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes / Remarks"}),e.jsx("textarea",{className:"input h-24",value:Ze.notes,onChange:be=>cn({notes:be.target.value}),placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:Ht,children:"Print Voucher"}),e.jsx(Ee,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||l||!ts||!Ze.fromAccountId||!Ze.toAccountId||Number(Je.grand||0)<=0,children:u?"Saving...":"Save Voucher"})]})]})})}),Ie?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Contra Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:T||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:xe?xe.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:je||""}),e.jsx("div",{children:pe?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):ct&&Array.isArray(ct.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ze||"",onChange:be=>Pe(be.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),ct.approvers.map(be=>e.jsx("option",{value:be.id,children:be.username},be.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:ct?`Step ${ct.stepOrder}  ${ct.stepName}${ct.approvalLimit!=null?`  Limit: ${Number(ct.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:xe?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{ke(!1),Ue(null),dt(null),me("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var be,nt,ut;if(o){Ke(!0),me("");try{const _t=await te.post(`/finance/vouchers/${a}/submit`,{amount:(Je==null?void 0:Je.grand)===""||(Je==null?void 0:Je.grand)==null?null:Number((Je==null?void 0:Je.grand)||0),workflow_id:xe?xe.id:null,target_user_id:ze||null}),Qt=((be=_t==null?void 0:_t.data)==null?void 0:be.status)||"PENDING_APPROVAL";Ve(Qt),ke(!1)}catch(_t){me(((ut=(nt=_t==null?void 0:_t.response)==null?void 0:nt.data)==null?void 0:ut.message)||"Failed to forward for approval")}finally{Ke(!1)}}},disabled:Te||!o,children:Te?"Forwarding...":"Forward"})]})]})}):null]})}function oS(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/finance/reports/voucher-register",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Voucher Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Voucher listing report with date filters"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"VoucherRegister"),Br(m,"voucher-register.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Voucher Register",10,m),m+=8,c.setFontSize(10),c.text("Date",10,m),c.text("Voucher No",45,m),c.text("Type",95,m),c.text("Narration",125,m),c.text("Debit",160,m),c.text("Credit",180,m),c.text("Status",200,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.voucher_date?new Date(h.voucher_date).toLocaleDateString():"-",x=String(h.voucher_no||"-"),g=String(h.voucher_type_code||"-"),b=String(h.narration||"-").slice(0,35),y=String(Number(h.total_debit||0).toLocaleString()),N=String(Number(h.total_credit||0).toLocaleString()),j=String(h.status||"-");c.text(f,10,m),c.text(x,45,m),c.text(g,95,m),c.text(b,125,m),c.text(y,160,m),c.text(N,180,m),c.text(j,200,m,{align:"right"}),m+=5}),c.save("voucher-register.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Narration"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(d.voucher_date).toLocaleDateString()}),e.jsx("td",{className:"font-medium",children:d.voucher_no}),e.jsx("td",{children:d.voucher_type_code}),e.jsx("td",{children:d.narration||"-"}),e.jsx("td",{className:"text-right",children:Number(d.total_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.total_credit||0).toLocaleString()}),e.jsx("td",{children:d.status})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function jJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var c,m,h;try{o(!0);const f=await te.get("/finance/reports/trial-balance",{params:{from:t||null,to:r||null}});i(((c=f.data)==null?void 0:c.items)||[])}catch(f){mt.error(((h=(m=f==null?void 0:f.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load trial balance")}finally{o(!1)}}v.useEffect(()=>{u()},[]);const d=n.reduce((c,m)=>(c.opening_debit+=Number(m.opening_debit||0),c.opening_credit+=Number(m.opening_credit||0),c.movement_debit+=Number(m.movement_debit||0),c.movement_credit+=Number(m.movement_credit||0),c.closing_debit+=Number(m.closing_debit||0),c.closing_credit+=Number(m.closing_credit||0),c),{opening_debit:0,opening_credit:0,movement_debit:0,movement_credit:0,closing_debit:0,closing_credit:0});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Trial Balance"}),e.jsx("p",{className:"text-sm mt-1",children:"Debits and credits by account"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:c=>s(c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:c=>a(c.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const m=us.json_to_sheet(c),h=us.book_new();us.book_append_sheet(h,m,"TrialBalance"),Br(h,"trial-balance.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const m=new As("p","mm","a4");let h=15;m.setFontSize(14),m.text("Trial Balance",10,h),h+=8,m.setFontSize(10),m.text("Account",10,h),m.text("Op Dr",95,h),m.text("Op Cr",115,h),m.text("Mv Dr",135,h),m.text("Mv Cr",155,h),m.text("Cls Dr",175,h),m.text("Cls Cr",190,h,{align:"right"}),h+=4,m.line(10,h,200,h),h+=5,c.forEach(f=>{h>270&&(m.addPage(),h=15);const x=`${String(f.account_code||"-")} ${String(f.account_name||"").slice(0,40)}`.trim();m.text(x,10,h),m.text(String(Number(f.opening_debit||0).toLocaleString()),95,h),m.text(String(Number(f.opening_credit||0).toLocaleString()),115,h),m.text(String(Number(f.movement_debit||0).toLocaleString()),135,h),m.text(String(Number(f.movement_credit||0).toLocaleString()),155,h),m.text(String(Number(f.closing_debit||0).toLocaleString()),175,h),m.text(String(Number(f.closing_credit||0).toLocaleString()),190,h,{align:"right"}),h+=5}),h+=5,m.setFontSize(11),m.text(`Totals  Op Dr: ${d.opening_debit.toLocaleString()}`,10,h),h+=6,m.text(`Op Cr: ${d.opening_credit.toLocaleString()}`,10,h),h+=6,m.text(`Mv Dr: ${d.movement_debit.toLocaleString()}`,10,h),h+=6,m.text(`Mv Cr: ${d.movement_credit.toLocaleString()}`,10,h),h+=6,m.text(`Cls Dr: ${d.closing_debit.toLocaleString()}`,10,h),h+=6,m.text(`Cls Cr: ${d.closing_credit.toLocaleString()}`,10,h),m.save("trial-balance.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{className:"text-right",children:"Opening Dr"}),e.jsx("th",{className:"text-right",children:"Opening Cr"}),e.jsx("th",{className:"text-right",children:"Movement Dr"}),e.jsx("th",{className:"text-right",children:"Movement Cr"}),e.jsx("th",{className:"text-right",children:"Closing Dr"}),e.jsx("th",{className:"text-right",children:"Closing Cr"})]})}),e.jsx("tbody",{children:n.map(c=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:c.account_code}),e.jsx("div",{className:"text-sm",children:c.account_name})]}),e.jsx("td",{className:"text-right",children:Number(c.opening_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.opening_credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.movement_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.movement_credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.closing_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.closing_credit||0).toLocaleString()})]},c.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Totals"}),e.jsx("td",{className:"text-right font-semibold",children:d.opening_debit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.opening_credit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.movement_debit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.movement_credit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.closing_debit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.closing_credit.toLocaleString()})]})})]})})]})})]})}function NJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/finance/reports/journals",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load journals")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Journals"}),e.jsx("p",{className:"text-sm mt-1",children:"Journal entries for the selected period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"Journals"),Br(m,"journals.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Journals",10,m),m+=8,c.setFontSize(10),c.text("Date",10,m),c.text("Voucher No",45,m),c.text("Line",95,m),c.text("Account",115,m),c.text("Debit",160,m),c.text("Credit",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.voucher_date?new Date(h.voucher_date).toLocaleDateString():"-",x=String(h.voucher_no||"-"),g=String(h.line_no||"-"),b=`${String(h.account_code||"-")} ${String(h.account_name||"").slice(0,30)}`.trim(),y=String(Number(h.debit||0).toLocaleString()),N=String(Number(h.credit||0).toLocaleString());c.text(f,10,m),c.text(x,45,m),c.text(g,95,m),c.text(b,115,m),c.text(y,160,m),c.text(N,190,m,{align:"right"}),m+=5}),c.save("journals.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Line"}),e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"})]})}),e.jsx("tbody",{children:n.map((d,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(d.voucher_date).toLocaleDateString()}),e.jsx("td",{className:"font-medium",children:d.voucher_no}),e.jsx("td",{children:d.line_no}),e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:d.account_code}),e.jsx("div",{className:"text-sm",children:d.account_name})]}),e.jsx("td",{children:d.description||"-"}),e.jsx("td",{className:"text-right",children:Number(d.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.credit||0).toLocaleString()})]},`${d.id}-${c}`))})]})})]})})]})}function wJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState(""),[l,o]=v.useState([]),[u,d]=v.useState(0),[c,m]=v.useState([]),[h,f]=v.useState(!1);async function x(){var b,y,N,j;try{const S=await te.get("/finance/accounts",{params:{postable:1,active:1}});o(((b=S.data)==null?void 0:b.items)||[]),!n&&((j=(N=(y=S.data)==null?void 0:y.items)==null?void 0:N[0])!=null&&j.id)&&i(String(S.data.items[0].id))}catch{mt.error("Failed to load accounts")}}async function g(){var b,y,N,j;if(n)try{f(!0);const S=await te.get("/finance/reports/general-ledger",{params:{accountId:n,from:t||null,to:r||null}});d(Number(((b=S.data)==null?void 0:b.opening_balance)||0)),m(((y=S.data)==null?void 0:y.items)||[])}catch(S){mt.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to load general ledger")}finally{f(!1)}}return v.useEffect(()=>{x()},[]),v.useEffect(()=>{g()},[n]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"General Ledger"}),e.jsx("p",{className:"text-sm mt-1",children:"Ledger entries for a selected account"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Account"}),e.jsx("select",{className:"input",value:n,onChange:b=>i(b.target.value),children:l.map(b=>e.jsxs("option",{value:b.id,children:[b.code,"  ",b.name]},b.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:b=>s(b.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:b=>a(b.target.value)})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:g,disabled:h,children:h?"Running...":"Run"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:h,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const b=Array.isArray(c)?c:[];if(!b.length)return;const y=us.json_to_sheet(b),N=us.book_new();us.book_append_sheet(N,y,"GeneralLedger"),Br(N,"general-ledger.xlsx")},disabled:!c.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const b=Array.isArray(c)?c:[];if(!b.length)return;const y=new As("p","mm","a4");let N=15;y.setFontSize(14),y.text("General Ledger",10,N),N+=6,y.setFontSize(10),y.text(`Opening: ${Number(u||0).toLocaleString()}`,10,N),N+=8,y.text("Date",10,N),y.text("Voucher No",45,N),y.text("Line",95,N),y.text("Description",115,N),y.text("Debit",160,N),y.text("Credit",180,N),y.text("Balance",200,N,{align:"right"}),N+=4,y.line(10,N,200,N),N+=5,b.forEach(j=>{N>270&&(y.addPage(),N=15);const S=j.voucher_date?new Date(j.voucher_date).toLocaleDateString():"-",k=String(j.voucher_no||"-"),P=String(j.line_no||"-"),I=String(j.description||"-").slice(0,35),B=String(Number(j.debit||0).toLocaleString()),q=String(Number(j.credit||0).toLocaleString()),Q=String(Number(j.balance||0).toLocaleString());y.text(S,10,N),y.text(k,45,N),y.text(P,95,N),y.text(I,115,N),y.text(B,160,N),y.text(q,180,N),y.text(Q,200,N,{align:"right"}),N+=5}),y.save("general-ledger.pdf")},disabled:!c.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 mb-4",children:[e.jsx("div",{className:"text-sm",children:"Opening Balance"}),e.jsx("div",{className:"text-xl font-semibold",children:Number(u||0).toLocaleString()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Line"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:c.map((b,y)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(b.voucher_date).toLocaleDateString()}),e.jsx("td",{className:"font-medium",children:b.voucher_no}),e.jsx("td",{children:b.line_no}),e.jsx("td",{children:b.description||"-"}),e.jsx("td",{className:"text-right",children:Number(b.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(b.credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(b.balance||0).toLocaleString()})]},`${b.voucher_no}-${b.line_no}-${y}`))})]})})]})})]})}function _J(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState({items:[],total:0}),[l,o]=v.useState({items:[],total:0}),[u,d]=v.useState(0),[c,m]=v.useState(!1);async function h(){var f,x,g,b,y;try{m(!0);const N=await te.get("/finance/reports/profit-and-loss",{params:{from:t||null,to:r||null}});i(((f=N.data)==null?void 0:f.income)||{items:[],total:0}),o(((x=N.data)==null?void 0:x.expenses)||{items:[],total:0}),d(Number(((g=N.data)==null?void 0:g.net_profit)||0))}catch(N){mt.error(((y=(b=N==null?void 0:N.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to load P&L")}finally{m(!1)}}return v.useEffect(()=>{h()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Profit and Loss"}),e.jsx("p",{className:"text-sm mt-1",children:"Income and expense summary"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:f=>s(f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:f=>a(f.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:h,disabled:c,children:c?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:c,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const f=[...n.items.map(b=>({section:"Income",...b})),...l.items.map(b=>({section:"Expenses",...b}))];if(!f.length)return;const x=us.json_to_sheet(f),g=us.book_new();us.book_append_sheet(g,x,"ProfitAndLoss"),Br(g,"profit-and-loss.xlsx")},disabled:!n.items.length&&!l.items.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const f=[...n.items.map(b=>({section:"Income",...b})),...l.items.map(b=>({section:"Expenses",...b}))];if(!f.length)return;const x=new As("p","mm","a4");let g=15;x.setFontSize(14),x.text("Profit and Loss",10,g),g+=8,x.setFontSize(10),x.text("Section",10,g),x.text("Account",60,g),x.text("Amount",190,g,{align:"right"}),g+=4,x.line(10,g,200,g),g+=5,f.forEach(b=>{g>270&&(x.addPage(),g=15);const y=String(b.section),N=`${String(b.account_code||"-")} ${String(b.account_name||"").slice(0,40)}`.trim(),j=String(Number(b.amount||0).toLocaleString());x.text(y,10,g),x.text(N,60,g),x.text(j,190,g,{align:"right"}),g+=5}),g+=5,x.setFontSize(11),x.text(`Total Income: ${Number(n.total||0).toLocaleString()}`,10,g),g+=6,x.text(`Total Expenses: ${Number(l.total||0).toLocaleString()}`,10,g),g+=6,x.text(`Net Profit: ${Number(u||0).toLocaleString()}`,10,g),x.save("profit-and-loss.pdf")},disabled:!n.items.length&&!l.items.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Income"}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:n.items.map(f=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:f.account_code}),e.jsx("div",{className:"text-sm",children:f.account_name})]}),e.jsx("td",{className:"text-right",children:Number(f.amount||0).toLocaleString()})]},f.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Total Income"}),e.jsx("td",{className:"text-right font-semibold",children:Number(n.total||0).toLocaleString()})]})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Expenses"}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:l.items.map(f=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:f.account_code}),e.jsx("div",{className:"text-sm",children:f.account_name})]}),e.jsx("td",{className:"text-right",children:Number(f.amount||0).toLocaleString()})]},f.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Total Expenses"}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.total||0).toLocaleString()})]})})]})})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 mt-6",children:[e.jsx("div",{className:"text-sm",children:"Net Profit"}),e.jsx("div",{className:"text-xl font-semibold",children:Number(u||0).toLocaleString()})]})]})})]})}function SJ(){const[t,s]=v.useState(""),[r,a]=v.useState({items:[],total:0}),[n,i]=v.useState({items:[],total:0}),[l,o]=v.useState({items:[],total:0}),[u,d]=v.useState(0),[c,m]=v.useState(!1);async function h(){var x,g,b,y,N,j;try{m(!0);const S=await te.get("/finance/reports/balance-sheet",{params:{to:t||null}});a(((x=S.data)==null?void 0:x.assets)||{items:[],total:0}),i(((g=S.data)==null?void 0:g.liabilities)||{items:[],total:0}),o(((b=S.data)==null?void 0:b.equity)||{items:[],total:0}),d(Number(((y=S.data)==null?void 0:y.balance)||0))}catch(S){mt.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to load balance sheet")}finally{m(!1)}}v.useEffect(()=>{h()},[]);function f({title:x,data:g}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:x}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:g.items.map(b=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:b.account_code}),e.jsx("div",{className:"text-sm",children:b.account_name})]}),e.jsx("td",{className:"text-right",children:Number(b.amount||0).toLocaleString()})]},b.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"font-semibold",children:["Total ",x]}),e.jsx("td",{className:"text-right font-semibold",children:Number(g.total||0).toLocaleString()})]})})]})})}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Balance Sheet"}),e.jsx("p",{className:"text-sm mt-1",children:"Position at selected date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As Of"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:x=>s(x.target.value)})]}),e.jsxs("div",{className:"md:col-span-3 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:h,disabled:c,children:c?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>s(""),disabled:c,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const x=[...r.items.map(y=>({section:"Assets",...y})),...n.items.map(y=>({section:"Liabilities",...y})),...l.items.map(y=>({section:"Equity",...y}))];if(!x.length)return;const g=us.json_to_sheet(x),b=us.book_new();us.book_append_sheet(b,g,"BalanceSheet"),Br(b,"balance-sheet.xlsx")},disabled:!r.items.length&&!n.items.length&&!l.items.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const x=[...r.items.map(y=>({section:"Assets",...y})),...n.items.map(y=>({section:"Liabilities",...y})),...l.items.map(y=>({section:"Equity",...y}))];if(!x.length)return;const g=new As("p","mm","a4");let b=15;g.setFontSize(14),g.text("Balance Sheet",10,b),b+=8,g.setFontSize(10),g.text("Section",10,b),g.text("Account",60,b),g.text("Amount",190,b,{align:"right"}),b+=4,g.line(10,b,200,b),b+=5,x.forEach(y=>{b>270&&(g.addPage(),b=15);const N=String(y.section),j=`${String(y.account_code||"-")} ${String(y.account_name||"").slice(0,40)}`.trim(),S=String(Number(y.amount||0).toLocaleString());g.text(N,10,b),g.text(j,60,b),g.text(S,190,b,{align:"right"}),b+=5}),b+=5,g.setFontSize(11),g.text(`Total Assets: ${Number(r.total||0).toLocaleString()}`,10,b),b+=6,g.text(`Total Liabilities: ${Number(n.total||0).toLocaleString()}`,10,b),b+=6,g.text(`Total Equity: ${Number(l.total||0).toLocaleString()}`,10,b),b+=6,g.text(`Balance: ${Number(u||0).toLocaleString()}`,10,b),g.save("balance-sheet.pdf")},disabled:!r.items.length&&!n.items.length&&!l.items.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(f,{title:"Assets",data:r}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(f,{title:"Liabilities",data:n}),e.jsx(f,{title:"Equity",data:l})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 mt-6",children:[e.jsx("div",{className:"text-sm",children:"Assets - (Liabilities + Equity)"}),e.jsx("div",{className:"text-xl font-semibold",children:Number(u||0).toLocaleString()})]})]})})]})}function CJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState({inflow:0,outflow:0,net:0}),[u,d]=v.useState(!1);async function c(){var m,h,f,x;try{d(!0);const g=await te.get("/finance/reports/cash-flow",{params:{from:t||null,to:r||null}});i(((m=g.data)==null?void 0:m.items)||[]),o(((h=g.data)==null?void 0:h.totals)||{inflow:0,outflow:0,net:0})}catch(g){mt.error(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Failed to load cash flow")}finally{d(!1)}}return v.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Cash Flow"}),e.jsx("p",{className:"text-sm mt-1",children:"Movements in bank and cash accounts"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:m=>s(m.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:m=>a(m.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:c,disabled:u,children:u?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:u,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const m=Array.isArray(n)?n:[];if(!m.length)return;const h=us.json_to_sheet(m),f=us.book_new();us.book_append_sheet(f,h,"CashFlow"),Br(f,"cash-flow.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const m=Array.isArray(n)?n:[];if(!m.length)return;const h=new As("p","mm","a4");let f=15;h.setFontSize(14),h.text("Cash Flow",10,f),f+=8,h.setFontSize(10),h.text("Bank",10,f),h.text("Account",70,f),h.text("Inflow",130,f),h.text("Outflow",160,f),h.text("Net",190,f,{align:"right"}),f+=4,h.line(10,f,200,f),f+=5,m.forEach(x=>{f>270&&(h.addPage(),f=15);const g=String(x.bank_name||"-").slice(0,40),b=`${String(x.account_code||"-")} ${String(x.account_name||"").slice(0,30)}`.trim(),y=String(Number(x.inflow||0).toLocaleString()),N=String(Number(x.outflow||0).toLocaleString()),j=String(Number(x.net||0).toLocaleString());h.text(g,10,f),h.text(b,70,f),h.text(y,130,f),h.text(N,160,f),h.text(j,190,f,{align:"right"}),f+=5}),f+=5,h.setFontSize(11),h.text(`Totals  Inflow: ${Number(l.inflow||0).toLocaleString()}`,10,f),f+=6,h.text(`Outflow: ${Number(l.outflow||0).toLocaleString()}`,10,f),f+=6,h.text(`Net: ${Number(l.net||0).toLocaleString()}`,10,f),h.save("cash-flow.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"Account"}),e.jsx("th",{className:"text-right",children:"Inflow"}),e.jsx("th",{className:"text-right",children:"Outflow"}),e.jsx("th",{className:"text-right",children:"Net"})]})}),e.jsx("tbody",{children:n.map(m=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:m.bank_name}),e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:m.account_code}),e.jsx("div",{className:"text-sm",children:m.account_name})]}),e.jsx("td",{className:"text-right",children:Number(m.inflow||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(m.outflow||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(m.net||0).toLocaleString()})]},`${m.bank_account_id}-${m.account_id}`))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Totals"}),e.jsx("td",{}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.inflow||0).toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.outflow||0).toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.net||0).toLocaleString()})]})})]})})]})})]})}function BJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/finance/reports/payment-due",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Payment Due Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Upcoming and overdue payables by due date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Due Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Due Date"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=["Due Date","Ref","Party","Amount","Outstanding","Status"],m=d.map(b=>[b.due_date?new Date(b.due_date).toLocaleDateString():"-",String(b.ref_no||"-"),String(b.party_name||"-"),Number(b.amount||0).toFixed(2),Number(b.outstanding||0).toFixed(2),String(b.status||"-")]),h=[c.join(","),...m.map(b=>b.join(","))].join(`
`),f=new Blob([h],{type:"text/csv;charset=utf-8;"}),x=URL.createObjectURL(f),g=document.createElement("a");g.href=x,g.download="payment-due.csv",g.click(),URL.revokeObjectURL(x)},disabled:!n.length,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"PaymentDue"),Br(m,"payment-due.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Payment Due Report",10,m),m+=8,c.setFontSize(10),c.text("Due Date",10,m),c.text("Ref",45,m),c.text("Party",85,m),c.text("Amount",140,m),c.text("Outstanding",165,m),c.text("Status",200,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.due_date?new Date(h.due_date).toLocaleDateString():"-",x=String(h.ref_no||"-"),g=String(h.party_name||"-").slice(0,40),b=String(Number(h.amount||0).toLocaleString()),y=String(Number(h.outstanding||0).toLocaleString()),N=String(h.status||"-");c.text(f,10,m),c.text(x,45,m),c.text(g,85,m),c.text(b,140,m),c.text(y,165,m),c.text(N,200,m,{align:"right"}),m+=5}),c.save("payment-due.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Due Date"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Party"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Outstanding"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.due_date?new Date(d.due_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.ref_no||"-"}),e.jsx("td",{children:d.party_name||"-"}),e.jsx("td",{className:"text-right",children:Number(d.amount||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.outstanding||0).toLocaleString()}),e.jsx("td",{children:d.status||"-"})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function kJ(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await te.get("/finance/reports/customer-outstanding",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){mt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return v.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Customer Outstanding Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Receivables outstanding per customer as of a date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=us.json_to_sheet(o),d=us.book_new();us.book_append_sheet(d,u,"CustomerOutstanding"),Br(d,"customer-outstanding.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new As("p","mm","a4");let d=15;u.setFontSize(14),u.text("Customer Outstanding Report",10,d),d+=8,u.setFontSize(10),u.text("Customer",10,d),u.text("Invoice No",75,d),u.text("Inv Date",115,d),u.text("Due Date",145,d),u.text("Amount",165,d),u.text("Received",180,d),u.text("Outstanding",200,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15);const m=String(c.customer_name||"-").slice(0,60),h=String(c.invoice_no||"-"),f=c.invoice_date?new Date(c.invoice_date).toLocaleDateString():"-",x=c.due_date?new Date(c.due_date).toLocaleDateString():"-",g=String(Number(c.amount||0).toLocaleString()),b=String(Number(c.received||0).toLocaleString()),y=String(Number(c.outstanding||0).toLocaleString());u.text(m,10,d),u.text(h,75,d),u.text(f,115,d),u.text(x,145,d),u.text(g,165,d),u.text(b,180,d),u.text(y,200,d,{align:"right"}),d+=5}),u.save("customer-outstanding.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Invoice Date"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Received"}),e.jsx("th",{className:"text-right",children:"Outstanding"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.customer_name||"-"}),e.jsx("td",{children:o.invoice_no||"-"}),e.jsx("td",{children:o.invoice_date?new Date(o.invoice_date).toLocaleDateString():"-"}),e.jsx("td",{children:o.due_date?new Date(o.due_date).toLocaleDateString():"-"}),e.jsx("td",{className:"text-right",children:Number(o.amount||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.received||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.outstanding||0).toLocaleString()})]},o.id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function EJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/finance/reports/audit-trail",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Audit Trail"}),e.jsx("p",{className:"text-sm mt-1",children:"System activity for finance transactions"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"AuditTrail"),Br(m,"audit-trail.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Audit Trail",10,m),m+=8,c.setFontSize(10),c.text("Date/Time",10,m),c.text("User",60,m),c.text("Action",95,m),c.text("Entity",130,m),c.text("Ref",165,m),c.text("Details",190,m,{align:"right"}),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=h.action_time?new Date(h.action_time).toLocaleString():"-",x=String(h.user_name||"-").slice(0,25),g=String(h.action||"-").slice(0,25),b=String(h.entity||"-").slice(0,25),y=String(h.ref_no||"-").slice(0,25),N=String(h.details||"-").slice(0,60);c.text(f,10,m),c.text(x,60,m),c.text(g,95,m),c.text(b,130,m),c.text(y,165,m),c.text(N,190,m,{align:"right"}),m+=5}),c.save("audit-trail.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Entity"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.action_time?new Date(d.action_time).toLocaleString():"-"}),e.jsx("td",{children:d.user_name||"-"}),e.jsx("td",{children:d.action||"-"}),e.jsx("td",{children:d.entity||"-"}),e.jsx("td",{className:"font-medium",children:d.ref_no||"-"}),e.jsx("td",{children:d.details||"-"})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function FJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1),u=v.useMemo(()=>{const c=n.reduce((f,x)=>f+Number(x.debit||0),0),m=n.reduce((f,x)=>f+Number(x.credit||0),0),h=c-m;return{debit:c,credit:m,balance:h}},[n]);async function d(){var c,m,h;try{o(!0);const f=await te.get("/finance/reports/debtors-ledger",{params:{from:t||null,to:r||null}});i(((c=f.data)==null?void 0:c.items)||[])}catch(f){mt.error(((h=(m=f==null?void 0:f.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{d()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Debtors Ledger"}),e.jsx("p",{className:"text-sm mt-1",children:"Customer ledger movements and running balance"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:c=>s(c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:c=>a(c.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const m=us.json_to_sheet(c),h=us.book_new();us.book_append_sheet(h,m,"DebtorsLedger"),Br(h,"debtors-ledger.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const m=new As("p","mm","a4");let h=15;m.setFontSize(14),m.text("Debtors Ledger",10,h),h+=8,m.setFontSize(10),m.text("Date",10,h),m.text("Document",45,h),m.text("Description",95,h),m.text("Debit",140,h),m.text("Credit",165,h),m.text("Balance",190,h,{align:"right"}),h+=4,m.line(10,h,200,h),h+=5,c.forEach((f,x)=>{h>270&&(m.addPage(),h=15);const g=f.txn_date?new Date(f.txn_date).toLocaleDateString():"-",b=String(f.doc_no||"-"),y=String(f.description||"-").slice(0,35),N=Number(f.debit||0),j=Number(f.credit||0),S=c.slice(0,x+1).reduce((k,P)=>k+Number(P.debit||0)-Number(P.credit||0),0);m.text(g,10,h),m.text(b,45,h),m.text(y,95,h),m.text(String(N.toLocaleString()),140,h),m.text(String(j.toLocaleString()),165,h),m.text(String(Number(S||0).toLocaleString()),190,h,{align:"right"}),h+=5}),h+=5,m.setFontSize(11),m.text(`Totals  Debit: ${Number(u.debit||0).toLocaleString()}`,10,h),h+=6,m.text(`Credit: ${Number(u.credit||0).toLocaleString()}`,10,h),h+=6,m.text(`Balance: ${Number(u.balance||0).toLocaleString()}`,10,h),m.save("debtors-ledger.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:n.map((c,m)=>{const h=n.slice(0,m+1).reduce((f,x)=>f+Number(x.debit||0)-Number(x.credit||0),0);return e.jsxs("tr",{children:[e.jsx("td",{children:c.txn_date?new Date(c.txn_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:c.doc_no||"-"}),e.jsx("td",{children:c.description||"-"}),e.jsx("td",{className:"text-right",children:Number(c.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h||0).toLocaleString()})]},c.id||m)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-right font-medium",children:"Totals"}),e.jsx("td",{className:"text-right font-medium",children:u.debit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.credit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.balance.toLocaleString()})]})})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function TJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1),u=v.useMemo(()=>{const c=n.reduce((f,x)=>f+Number(x.debit||0),0),m=n.reduce((f,x)=>f+Number(x.credit||0),0),h=c-m;return{debit:c,credit:m,balance:h}},[n]);async function d(){var c,m,h;try{o(!0);const f=await te.get("/finance/reports/creditors-ledger",{params:{from:t||null,to:r||null}});i(((c=f.data)==null?void 0:c.items)||[])}catch(f){mt.error(((h=(m=f==null?void 0:f.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{d()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Creditors Ledger"}),e.jsx("p",{className:"text-sm mt-1",children:"Supplier ledger movements and running balance"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:c=>s(c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:c=>a(c.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const m=us.json_to_sheet(c),h=us.book_new();us.book_append_sheet(h,m,"CreditorsLedger"),Br(h,"creditors-ledger.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const m=new As("p","mm","a4");let h=15;m.setFontSize(14),m.text("Creditors Ledger",10,h),h+=8,m.setFontSize(10),m.text("Date",10,h),m.text("Document",45,h),m.text("Description",95,h),m.text("Debit",140,h),m.text("Credit",165,h),m.text("Balance",190,h,{align:"right"}),h+=4,m.line(10,h,200,h),h+=5,c.forEach((f,x)=>{h>270&&(m.addPage(),h=15);const g=f.txn_date?new Date(f.txn_date).toLocaleDateString():"-",b=String(f.doc_no||"-"),y=String(f.description||"-").slice(0,35),N=Number(f.debit||0),j=Number(f.credit||0),S=c.slice(0,x+1).reduce((k,P)=>k+Number(P.debit||0)-Number(P.credit||0),0);m.text(g,10,h),m.text(b,45,h),m.text(y,95,h),m.text(String(N.toLocaleString()),140,h),m.text(String(j.toLocaleString()),165,h),m.text(String(Number(S||0).toLocaleString()),190,h,{align:"right"}),h+=5}),h+=5,m.setFontSize(11),m.text(`Totals  Debit: ${Number(u.debit||0).toLocaleString()}`,10,h),h+=6,m.text(`Credit: ${Number(u.credit||0).toLocaleString()}`,10,h),h+=6,m.text(`Balance: ${Number(u.balance||0).toLocaleString()}`,10,h),m.save("creditors-ledger.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:n.map((c,m)=>{const h=n.slice(0,m+1).reduce((f,x)=>f+Number(x.debit||0)-Number(x.credit||0),0);return e.jsxs("tr",{children:[e.jsx("td",{children:c.txn_date?new Date(c.txn_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:c.doc_no||"-"}),e.jsx("td",{children:c.description||"-"}),e.jsx("td",{className:"text-right",children:Number(c.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h||0).toLocaleString()})]},c.id||m)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-right font-medium",children:"Totals"}),e.jsx("td",{className:"text-right font-medium",children:u.debit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.credit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.balance.toLocaleString()})]})})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function IJ(){const[t,s]=v.useState(""),[r,a]=v.useState([]),[n,i]=v.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await te.get("/finance/reports/supplier-outstanding",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){mt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return v.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Supplier Outstanding Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Payables outstanding per supplier as of a date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=us.json_to_sheet(o),d=us.book_new();us.book_append_sheet(d,u,"SupplierOutstanding"),Br(d,"supplier-outstanding.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new As("p","mm","a4");let d=15;u.setFontSize(14),u.text("Supplier Outstanding Report",10,d),d+=8,u.setFontSize(10),u.text("Supplier",10,d),u.text("Bill No",75,d),u.text("Bill Date",110,d),u.text("Due Date",140,d),u.text("Amount",165,d),u.text("Paid",180,d),u.text("Outstanding",200,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15);const m=String(c.supplier_name||"-").slice(0,60),h=String(c.bill_no||"-"),f=c.bill_date?new Date(c.bill_date).toLocaleDateString():"-",x=c.due_date?new Date(c.due_date).toLocaleDateString():"-",g=String(Number(c.amount||0).toLocaleString()),b=String(Number(c.paid||0).toLocaleString()),y=String(Number(c.outstanding||0).toLocaleString());u.text(m,10,d),u.text(h,75,d),u.text(f,110,d),u.text(x,140,d),u.text(g,165,d),u.text(b,180,d),u.text(y,200,d,{align:"right"}),d+=5}),u.save("supplier-outstanding.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Bill No"}),e.jsx("th",{children:"Bill Date"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Paid"}),e.jsx("th",{className:"text-right",children:"Outstanding"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.supplier_name||"-"}),e.jsx("td",{children:o.bill_no||"-"}),e.jsx("td",{children:o.bill_date?new Date(o.bill_date).toLocaleDateString():"-"}),e.jsx("td",{children:o.due_date?new Date(o.due_date).toLocaleDateString():"-"}),e.jsx("td",{className:"text-right",children:Number(o.amount||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.paid||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.outstanding||0).toLocaleString()})]},o.id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function LJ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState([]),[l,o]=v.useState(!1);async function u(){var d,c,m;try{o(!0);const h=await te.get("/finance/reports/ratio-analysis",{params:{from:t||null,to:r||null}});i(((d=h.data)==null?void 0:d.items)||[])}catch(h){mt.error(((m=(c=h==null?void 0:h.response)==null?void 0:c.data)==null?void 0:m.message)||"Failed to load report")}finally{o(!1)}}return v.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Ratio Analysis"}),e.jsx("p",{className:"text-sm mt-1",children:"Key financial ratios for performance insights"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=us.json_to_sheet(d),m=us.book_new();us.book_append_sheet(m,c,"RatioAnalysis"),Br(m,"ratio-analysis.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new As("p","mm","a4");let m=15;c.setFontSize(14),c.text("Ratio Analysis",10,m),m+=8,c.setFontSize(10),c.text("Ratio",10,m),c.text("Value",95,m),c.text("Notes",130,m),m+=4,c.line(10,m,200,m),m+=5,d.forEach(h=>{m>270&&(c.addPage(),m=15);const f=String(h.name||"-").slice(0,70),x=Number(h.value||0).toFixed(2),g=String(h.notes||"-").slice(0,60);c.text(f,10,m),c.text(x,95,m),c.text(g,130,m),m+=5}),c.save("ratio-analysis.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ratio"}),e.jsx("th",{className:"text-right",children:"Value"}),e.jsx("th",{children:"Notes"})]})}),e.jsx("tbody",{children:n.map((d,c)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.name||"-"}),e.jsx("td",{className:"text-right",children:Number(d.value||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:d.notes||"-"})]},d.key||c))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function DJ(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(!0),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState("ASSET"),[N,j]=v.useState(""),[S,k]=v.useState(""),[P,I]=v.useState(""),[B,q]=v.useState(""),[Q,O]=v.useState("ASSET"),[T,V]=v.useState("");async function D(){var W,K,_;try{a(!0);const F=await te.get("/finance/account-groups",{params:{search:n||null,nature:l||null,active:u||null,includeTotals:c?"1":"0"}});s(((W=F.data)==null?void 0:W.items)||[])}catch(F){mt.error(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to load account groups")}finally{a(!1)}}v.useEffect(()=>{D()},[]);async function Y(W){var K,_;W.preventDefault();try{await te.post("/finance/account-groups",{code:h,name:x,nature:b,parentId:N?Number(N):null,isActive:1}),mt.success("Account group created"),f(""),g(""),j(""),D()}catch(F){mt.error(((_=(K=F==null?void 0:F.response)==null?void 0:K.data)==null?void 0:_.message)||"Failed to create group")}}async function M(W,K){var _,F;try{a(!0),await te.put(`/finance/account-groups/${W}/active`,{isActive:+!!K}),mt.success("Status updated"),await D()}catch(E){mt.error(((F=(_=E==null?void 0:E.response)==null?void 0:_.data)==null?void 0:F.message)||"Failed to update active status")}finally{a(!1)}}function X(W){k(String(W.id)),I(W.code||""),q(W.name||""),O(W.nature||"ASSET"),V(W.parent_id?String(W.parent_id):"")}function R(){k(""),I(""),q(""),O("ASSET"),V("")}async function H(){var W,K;try{a(!0);const _={code:P,name:B,nature:Q,parentId:T?Number(T):null};await te.put(`/finance/account-groups/${S}`,_),mt.success("Group updated"),R(),await D()}catch(_){mt.error(((K=(W=_==null?void 0:_.response)==null?void 0:W.data)==null?void 0:K.message)||"Failed to update group")}finally{a(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Chart of Account Groups"}),e.jsx("p",{className:"text-sm mt-1",children:"Maintain account group hierarchy"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("input",{className:"input w-48",placeholder:"Search code/name...",value:n,onChange:W=>i(W.target.value)}),e.jsxs("select",{className:"input w-40",value:l,onChange:W=>o(W.target.value),children:[e.jsx("option",{value:"",children:"All Nature"}),e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]}),e.jsxs("select",{className:"input w-32",value:u,onChange:W=>d(W.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}),e.jsx("button",{className:"btn-success",onClick:D,disabled:r,children:"Apply"})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:Y,className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:h,onChange:W=>f(W.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:x,onChange:W=>g(W.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Nature *"}),e.jsxs("select",{className:"input",value:b,onChange:W=>y(W.target.value),children:[e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Parent"}),e.jsxs("select",{className:"input",value:N,onChange:W=>j(W.target.value),children:[e.jsx("option",{value:"",children:"None"}),t.map(W=>e.jsxs("option",{value:W.id,children:[W.code," - ",W.name]},W.id))]})]}),e.jsx("div",{className:"md:col-span-5 flex justify-end",children:e.jsx("button",{className:"btn-success",type:"submit",children:"Create Group"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:r?e.jsx("div",{className:"text-center py-10",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Nature"}),e.jsx("th",{children:"Parent"}),e.jsx("th",{className:"text-right",children:"Accounts"}),e.jsx("th",{children:"Active"})]})}),e.jsx("tbody",{children:t.map(W=>e.jsx("tr",{children:String(S)===String(W.id)?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{className:"input",value:P,onChange:K=>I(K.target.value)})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:B,onChange:K=>q(K.target.value)})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:Q,onChange:K=>O(K.target.value),children:[e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:T,onChange:K=>V(K.target.value),children:[e.jsx("option",{value:"",children:"None"}),t.map(K=>e.jsxs("option",{value:K.id,children:[K.code," - ",K.name]},`p-${K.id}`))]})}),e.jsx("td",{className:"text-right",children:typeof W.account_count=="number"?W.account_count:"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",disabled:r,onClick:H,children:"Save"}),e.jsx("button",{className:"btn btn-secondary",disabled:r,onClick:R,children:"Cancel"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"font-medium",children:W.code}),e.jsx("td",{children:W.name}),e.jsx("td",{children:W.nature}),e.jsx("td",{children:W.parent_name||"-"}),e.jsx("td",{className:"text-right",children:typeof W.account_count=="number"?W.account_count:"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>X(W),disabled:r,children:"Edit"}),W.is_active?e.jsx("button",{className:"btn btn-secondary",disabled:r||typeof W.active_account_count=="number"&&W.active_account_count>0,onClick:()=>{window.confirm("Deactivate this group?")&&M(W.id,0)},children:"Deactivate"}):e.jsx("button",{className:"btn-success",disabled:r,onClick:()=>M(W.id,1),children:"Activate"})]})})]})},W.id))})]})})})})]})}function cS(){const[t,s]=v.useState([]),[r,a]=v.useState([]),[n,i]=v.useState([]),[l,o]=v.useState(!0),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState(""),[N,j]=v.useState(""),[S,k]=v.useState(""),[P,I]=v.useState(""),[B,q]=v.useState(""),[Q,O]=v.useState(!0),[T,V]=v.useState(""),[D,Y]=v.useState(""),[M,X]=v.useState(""),[R,H]=v.useState(""),[W,K]=v.useState(""),[_,F]=v.useState(!0);async function E(){var ee,se,Ae,we,ce;try{o(!0);const[le,_e,Qe]=await Promise.all([te.get("/finance/accounts",{params:{search:u||null,groupId:c||null,nature:h||null,active:x||null,postable:b||null}}),te.get("/finance/account-groups"),te.get("/finance/currencies")]);s(((ee=le.data)==null?void 0:ee.items)||[]),a(((se=_e.data)==null?void 0:se.items)||[]),i(((Ae=Qe.data)==null?void 0:Ae.items)||[])}catch(le){mt.error(((ce=(we=le==null?void 0:le.response)==null?void 0:we.data)==null?void 0:ce.message)||"Failed to load accounts")}finally{o(!1)}}async function L(){var ee,se;try{await te.post("/finance/accounts/sync")}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to sync accounts from customers/suppliers")}}v.useEffect(()=>{(async()=>(await L(),await E()))()},[]);async function U(ee){var se,Ae;ee.preventDefault();try{await te.post("/finance/accounts",{groupId:Number(N),code:S,name:P,currencyId:B?Number(B):null,isPostable:Q,isControlAccount:0,isActive:1}),mt.success("Account created"),k(""),I(""),j(""),q(""),O(!0),E()}catch(we){mt.error(((Ae=(se=we==null?void 0:we.response)==null?void 0:se.data)==null?void 0:Ae.message)||"Failed to create account")}}async function J(ee,se){var Ae,we;try{o(!0),await te.put(`/finance/accounts/${ee}/active`,{isActive:+!!se}),mt.success("Status updated"),await E()}catch(ce){mt.error(((we=(Ae=ce==null?void 0:ce.response)==null?void 0:Ae.data)==null?void 0:we.message)||"Failed to update active status")}finally{o(!1)}}function ae(ee){V(String(ee.id)),Y(String(ee.group_id)),X(ee.code||""),H(ee.name||""),K(ee.currency_id?String(ee.currency_id):""),F(!!ee.is_postable)}function Z(){V(""),Y(""),X(""),H(""),K(""),F(!0)}async function oe(){var ee,se;try{o(!0),await te.put(`/finance/accounts/${T}`,{groupId:D?Number(D):null,code:M,name:R,currencyId:W?Number(W):null,isPostable:_?1:0}),mt.success("Account updated"),Z(),await E()}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to update account")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Chart of Accounts"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage ledger accounts"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("input",{className:"input w-48",placeholder:"Search code/name...",value:u,onChange:ee=>d(ee.target.value)}),e.jsxs("select",{className:"input w-48",value:c,onChange:ee=>m(ee.target.value),children:[e.jsx("option",{value:"",children:"All Groups"}),r.map(ee=>e.jsxs("option",{value:ee.id,children:[ee.code," - ",ee.name]},`flt-${ee.id}`))]}),e.jsxs("select",{className:"input w-40",value:h,onChange:ee=>f(ee.target.value),children:[e.jsx("option",{value:"",children:"All Nature"}),e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]}),e.jsxs("select",{className:"input w-32",value:x,onChange:ee=>g(ee.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}),e.jsxs("select",{className:"input w-40",value:b,onChange:ee=>y(ee.target.value),children:[e.jsx("option",{value:"",children:"All Posting"}),e.jsx("option",{value:"1",children:"Postable"}),e.jsx("option",{value:"0",children:"Non-postable"})]}),e.jsx("button",{className:"btn-success",onClick:E,disabled:l,children:"Apply"})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:U,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Group *"}),e.jsxs("select",{className:"input",value:N,onChange:ee=>j(ee.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select group"}),r.map(ee=>e.jsxs("option",{value:ee.id,children:[ee.code," - ",ee.name]},ee.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:S,onChange:ee=>k(ee.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:P,onChange:ee=>I(ee.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:B,onChange:ee=>q(ee.target.value),children:[e.jsx("option",{value:"",children:"Default"}),n.map(ee=>e.jsx("option",{value:ee.id,children:ee.code},ee.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Posting"}),e.jsxs("select",{className:"input",value:Q?"1":"0",onChange:ee=>O(ee.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Postable"}),e.jsx("option",{value:"0",children:"Non-postable"})]})]}),e.jsx("div",{className:"md:col-span-6 flex justify-end",children:e.jsx("button",{className:"btn-success",type:"submit",children:"Create Account"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:l?e.jsx("div",{className:"text-center py-10",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Group"}),e.jsx("th",{children:"Nature"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Postable"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.map(ee=>e.jsx("tr",{children:String(T)===String(ee.id)?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{className:"input",value:M,onChange:se=>X(se.target.value)})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:R,onChange:se=>H(se.target.value)})}),e.jsx("td",{children:e.jsx("select",{className:"input",value:D,onChange:se=>Y(se.target.value),children:r.map(se=>e.jsxs("option",{value:se.id,children:[se.code," - ",se.name]},`g-${se.id}`))})}),e.jsx("td",{children:ee.nature}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:W,onChange:se=>K(se.target.value),children:[e.jsx("option",{value:"",children:"Default"}),n.map(se=>e.jsx("option",{value:se.id,children:se.code},`c-${se.id}`))]})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:_?"1":"0",onChange:se=>F(se.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Yes"}),e.jsx("option",{value:"0",children:"No"})]})}),e.jsx("td",{children:ee.is_active?"Yes":"No"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",disabled:l,onClick:oe,children:"Save"}),e.jsx("button",{className:"btn btn-secondary",disabled:l,onClick:Z,children:"Cancel"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"font-medium",children:ee.code}),e.jsx("td",{children:ee.name}),e.jsx("td",{children:ee.group_name}),e.jsx("td",{children:ee.nature}),e.jsx("td",{children:ee.currency_code||"-"}),e.jsx("td",{children:ee.is_postable?"Yes":"No"}),e.jsx("td",{children:ee.is_active?"Yes":"No"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",disabled:l,onClick:()=>ae(ee),children:"Edit"}),ee.is_active?e.jsx("button",{className:"btn btn-secondary",disabled:l,onClick:()=>J(ee.id,0),children:"Deactivate"}):e.jsx("button",{className:"btn-success",disabled:l,onClick:()=>J(ee.id,1),children:"Activate"})]})})]})},ee.id))})]})})})})]})}function PJ(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState("TAX"),[h,f]=v.useState(!0),[x,g]=v.useState({}),[b,y]=v.useState(null),[N,j]=v.useState(null),[S,k]=v.useState([]),[P,I]=v.useState(""),[B,q]=v.useState(""),[Q,O]=v.useState(""),[T,V]=v.useState(!0);async function D(){var oe,ee,se;try{a(!0);const Ae=await te.get("/finance/tax-codes");s(((oe=Ae.data)==null?void 0:oe.items)||[])}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to load tax codes")}finally{a(!1)}}v.useEffect(()=>{D()},[]);async function Y(oe){var ee,se,Ae;try{const we=await te.get(`/finance/tax-codes/${oe}/components`);k(((ee=we.data)==null?void 0:ee.items)||[])}catch(we){mt.error(((Ae=(se=we==null?void 0:we.response)==null?void 0:se.data)==null?void 0:Ae.message)||"Failed to load tax components")}}function M(oe){y(oe.id),j(oe),I(""),q(""),O(""),V(!0),Y(oe.id)}async function X(oe){var ee,se;if(oe.preventDefault(),!!b)try{await te.post(`/finance/tax-codes/${b}/components`,{componentName:P.trim(),ratePercent:B?Number(B):0,sortOrder:Q?Number(Q):100,isActive:T}),mt.success("Component added"),I(""),q(""),O(""),V(!0),Y(b)}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to add tax component")}}const[R,H]=v.useState({});function W(oe){H(ee=>({...ee,[oe.id]:{component_name:oe.component_name,rate_percent:oe.rate_percent,sort_order:oe.sort_order,is_active:oe.is_active}}))}function K(oe,ee,se){H(Ae=>({...Ae,[oe]:{...Ae[oe]||{},[ee]:se}}))}async function _(oe){var se,Ae;const ee=R[oe];if(ee)try{await te.put(`/finance/tax-components/${oe}`,{componentName:ee.component_name,ratePercent:ee.rate_percent===""||ee.rate_percent===null?void 0:Number(ee.rate_percent),sortOrder:ee.sort_order===""||ee.sort_order===null?void 0:Number(ee.sort_order),isActive:ee.is_active}),mt.success("Component updated"),H(we=>{const ce={...we};return delete ce[oe],ce}),Y(b)}catch(we){mt.error(((Ae=(se=we==null?void 0:we.response)==null?void 0:se.data)==null?void 0:Ae.message)||"Failed to update component")}}async function F(oe){var ee,se;if(window.confirm("Disable this component?"))try{await te.delete(`/finance/tax-components/${oe}`),mt.success("Component disabled"),H(Ae=>{const we={...Ae};return delete we[oe],we}),Y(b)}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to disable component")}}async function E(oe){var ee,se;oe.preventDefault();try{await te.post("/finance/tax-codes",{code:n.trim(),name:l.trim(),ratePercent:u?Number(u):0,type:c,isActive:h}),mt.success("Tax code created"),i(""),o(""),d(""),m("TAX"),f(!0),D()}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to create tax code")}}function L(oe){g(ee=>({...ee,[oe.id]:{name:oe.name,rate_percent:oe.rate_percent,type:oe.type,is_active:oe.is_active}}))}function U(oe,ee,se){g(Ae=>({...Ae,[oe]:{...Ae[oe]||{},[ee]:se}}))}async function J(oe){var se,Ae;const ee=x[oe];if(ee)try{await te.put(`/finance/tax-codes/${oe}`,{name:ee.name,ratePercent:ee.rate_percent===""||ee.rate_percent===null?void 0:Number(ee.rate_percent),type:ee.type,isActive:ee.is_active}),mt.success("Tax code updated"),g(we=>{const ce={...we};return delete ce[oe],ce}),D()}catch(we){mt.error(((Ae=(se=we==null?void 0:we.response)==null?void 0:se.data)==null?void 0:Ae.message)||"Failed to update tax code")}}function ae(oe){g(ee=>{const se={...ee};return delete se[oe],se})}async function Z(oe){var ee,se;try{await te.put(`/finance/tax-codes/${oe.id}`,{isActive:!oe.is_active}),D()}catch(Ae){mt.error(((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.message)||"Failed to toggle status")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Tax Codes & Deductions"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure tax and deduction codes used across modules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:D,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:E,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:n,onChange:oe=>i(oe.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:l,onChange:oe=>o(oe.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate (%)"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:u,onChange:oe=>d(oe.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type *"}),e.jsxs("select",{className:"input",value:c,onChange:oe=>m(oe.target.value),required:!0,children:[e.jsx("option",{value:"TAX",children:"Tax"}),e.jsx("option",{value:"DEDUCTION",children:"Deduction"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:oe=>f(oe.target.checked)}),"Active"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Rate (%)"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(oe=>{const ee=!!x[oe.id],se=x[oe.id]||{};return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:oe.code}),e.jsx("td",{children:ee?e.jsx("input",{className:"input",value:se.name??"",onChange:Ae=>U(oe.id,"name",Ae.target.value)}):oe.name}),e.jsx("td",{children:ee?e.jsxs("select",{className:"input",value:se.type??"TAX",onChange:Ae=>U(oe.id,"type",Ae.target.value),children:[e.jsx("option",{value:"TAX",children:"Tax"}),e.jsx("option",{value:"DEDUCTION",children:"Deduction"})]}):oe.type}),e.jsx("td",{children:ee?e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:se.rate_percent===void 0?oe.rate_percent:se.rate_percent,onChange:Ae=>U(oe.id,"rate_percent",Ae.target.value)}):Number(oe.rate_percent||0).toFixed(2)}),e.jsx("td",{children:ee?e.jsxs("select",{className:"input",value:(se.is_active?1:0).toString(),onChange:Ae=>U(oe.id,"is_active",Ae.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}):oe.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-right",children:ee?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>J(oe.id),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>ae(oe.id),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>L(oe),children:"Edit"}),e.jsx("button",{className:"btn",onClick:()=>M(oe),children:"Components"}),e.jsx("button",{className:"btn",onClick:()=>Z(oe),children:oe.is_active?"Disable":"Enable"})]})})]},oe.id)})})]})})})}),b&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Components for ",N==null?void 0:N.code," - ",N==null?void 0:N.name]}),e.jsx("p",{className:"text-sm",children:"Define composite taxes/deductions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>Y(b),children:"Refresh"}),e.jsx("button",{className:"btn",onClick:()=>y(null),children:"Close"})]})]}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("form",{onSubmit:X,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Component Name *"}),e.jsx("input",{className:"input",value:P,onChange:oe=>I(oe.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate (%)"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:B,onChange:oe=>q(oe.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sort Order"}),e.jsx("input",{className:"input",type:"number",min:"0",value:Q,onChange:oe=>O(oe.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:T,onChange:oe=>V(oe.target.checked)}),"Active"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add Component"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Component"}),e.jsx("th",{children:"Rate (%)"}),e.jsx("th",{children:"Sort"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[S.map(oe=>{const ee=!!R[oe.id],se=R[oe.id]||{};return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:ee?e.jsx("input",{className:"input",value:se.component_name===void 0?oe.component_name:se.component_name,onChange:Ae=>K(oe.id,"component_name",Ae.target.value)}):oe.component_name}),e.jsx("td",{children:ee?e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:se.rate_percent===void 0?oe.rate_percent:se.rate_percent,onChange:Ae=>K(oe.id,"rate_percent",Ae.target.value)}):Number(oe.rate_percent||0).toFixed(2)}),e.jsx("td",{children:ee?e.jsx("input",{className:"input",type:"number",min:"0",value:se.sort_order===void 0?oe.sort_order:se.sort_order,onChange:Ae=>K(oe.id,"sort_order",Ae.target.value)}):oe.sort_order}),e.jsx("td",{children:ee?e.jsxs("select",{className:"input",value:(se.is_active?1:0).toString(),onChange:Ae=>K(oe.id,"is_active",Ae.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}):oe.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-right",children:ee?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>_(oe.id),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>H(Ae=>{const we={...Ae};return delete we[oe.id],we}),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>W(oe),children:"Edit"}),e.jsx("button",{className:"btn",onClick:()=>F(oe.id),children:"Disable"})]})})]},oe.id)}),S.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-slate-600",children:"No components defined"})})]})]})})]})]})]})}function UJ(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(!1),[h,f]=v.useState(!0);async function x(){var S,k,P;try{a(!0);const I=await te.get("/finance/currencies");s(((S=I.data)==null?void 0:S.items)||[])}catch(I){mt.error(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to load currencies")}finally{a(!1)}}v.useEffect(()=>{x()},[]);async function g(S){var k,P;S.preventDefault();try{await te.post("/finance/currencies",{code:n.trim().toUpperCase(),name:l.trim(),symbol:u.trim()||null,isBase:c,isActive:h}),mt.success("Currency created"),i(""),o(""),d(""),m(!1),f(!0),x()}catch(I){mt.error(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to create currency")}}async function b(S){var k,P;try{await te.put(`/finance/currencies/${S}`,{isBase:1}),mt.success("Base currency updated"),x()}catch(I){mt.error(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to set base currency")}}async function y(S){var k,P;try{await te.put(`/finance/currencies/${S.id}`,{isActive:S.is_active?0:1}),x()}catch(I){mt.error(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to toggle status")}}async function N(S){var k,P;try{await te.put(`/finance/currencies/${S.id}`,{name:S._name??S.name,symbol:S._symbol??S.symbol}),mt.success("Currency updated"),x()}catch(I){mt.error(((P=(k=I==null?void 0:I.response)==null?void 0:k.data)==null?void 0:P.message)||"Failed to update currency")}}function j(S,k,P){s(I=>I.map(B=>B.id===S?{...B,[k]:P}:B))}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Currencies"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage currencies and base currency for the company"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:x,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:n,onChange:S=>i(S.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:l,onChange:S=>o(S.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Symbol"}),e.jsx("input",{className:"input",value:u,onChange:S=>d(S.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:S=>m(S.target.checked)}),"Set as Base"]})}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:S=>f(S.target.checked)}),"Active"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Symbol"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(S=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:S.code}),e.jsx("td",{children:e.jsx("input",{className:"input",value:S._name??S.name??"",onChange:k=>j(S.id,"_name",k.target.value)})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:S._symbol??S.symbol??"",onChange:k=>j(S.id,"_symbol",k.target.value)})}),e.jsx("td",{children:S.is_base?e.jsx("span",{className:"badge badge-success",children:"Base"}):e.jsx("button",{className:"btn",onClick:()=>b(S.id),children:"Set Base"})}),e.jsx("td",{children:S.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>N(S),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>y(S),children:S.is_active?"Disable":"Enable"})]})})]},S.id))})]})})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Currency Rates"}),e.jsx("p",{className:"text-sm",children:"Maintain exchange rate history"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"btn btn-secondary",disabled:!1,onClick:()=>{},children:"Help"})})]})}),e.jsx("div",{className:"card-body space-y-4",children:e.jsx(RJ,{items:t})})]})]})}function RJ({items:t}){const[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,u]=v.useState(""),[d,c]=v.useState(""),[m,h]=v.useState(""),[f,x]=v.useState(""),[g,b]=v.useState(""),[y,N]=v.useState(""),[j,S]=v.useState(""),[k,P]=v.useState({});async function I(){var B,q,Q;try{n(!0);const O=await te.get("/finance/currency-rates",{params:{fromCurrencyId:i||null,toCurrencyId:o||null,from:d||null,to:m||null}});r(((B=O.data)==null?void 0:B.items)||[])}catch(O){mt.error(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to load currency rates")}finally{n(!1)}}return v.useEffect(()=>{I()},[i,o,d,m]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Currency"}),e.jsxs("select",{className:"input",value:i,onChange:B=>l(B.target.value),children:[e.jsx("option",{value:"",children:"All"}),t.map(B=>e.jsxs("option",{value:B.id,children:[B.code," - ",B.name]},`f-${B.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Currency"}),e.jsxs("select",{className:"input",value:o,onChange:B=>u(B.target.value),children:[e.jsx("option",{value:"",children:"All"}),t.map(B=>e.jsxs("option",{value:B.id,children:[B.code," - ",B.name]},`t-${B.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Date"}),e.jsx("input",{className:"input",type:"date",value:d,onChange:B=>c(B.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Date"}),e.jsx("input",{className:"input",type:"date",value:m,onChange:B=>h(B.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn btn-secondary",onClick:I,disabled:a,children:"Refresh"})})]}),e.jsxs("form",{onSubmit:async B=>{var q,Q;B.preventDefault();try{await te.post("/finance/currency-rates",{fromCurrencyId:Number(f),toCurrencyId:Number(g),rate:Number(y),rateDate:j||void 0}),mt.success("Rate added"),x(""),b(""),N(""),S(""),I()}catch(O){mt.error(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to add currency rate")}},className:"grid grid-cols-1 md:grid-cols-6 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From *"}),e.jsxs("select",{className:"input",value:f,onChange:B=>x(B.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(B=>e.jsxs("option",{value:B.id,children:[B.code," - ",B.name]},`n-f-${B.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To *"}),e.jsxs("select",{className:"input",value:g,onChange:B=>b(B.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(B=>e.jsxs("option",{value:B.id,children:[B.code," - ",B.name]},`n-t-${B.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate *"}),e.jsx("input",{className:"input",type:"number",step:"0.000001",min:"0",value:y,onChange:B=>N(B.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective Date"}),e.jsx("input",{className:"input",type:"date",value:j,onChange:B=>S(B.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add Rate"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Date"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[s.map(B=>{const q=k[B.id]||{},Q=!!k[B.id];return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:B.from_code}),e.jsx("td",{children:B.to_code}),e.jsx("td",{children:Q?e.jsx("input",{className:"input",type:"number",step:"0.000001",min:"0",value:q.rate===void 0?B.rate:q.rate,onChange:O=>P(T=>({...T,[B.id]:{...T[B.id]||{},rate:O.target.value}}))}):Number(B.rate).toFixed(6)}),e.jsx("td",{children:Q?e.jsx("input",{className:"input",type:"date",value:q.rate_date===void 0?B.rate_date?String(B.rate_date).slice(0,10):"":q.rate_date,onChange:O=>P(T=>({...T,[B.id]:{...T[B.id]||{},rate_date:O.target.value}}))}):B.rate_date?String(B.rate_date).slice(0,10):""}),e.jsx("td",{className:"text-right",children:Q?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:async()=>{var O,T;try{await te.put(`/finance/currency-rates/${B.id}`,{rate:q.rate===""||q.rate===null?void 0:Number(q.rate),rateDate:q.rate_date||void 0}),mt.success("Rate updated"),P(V=>{const D={...V};return delete D[B.id],D}),I()}catch(V){mt.error(((T=(O=V==null?void 0:V.response)==null?void 0:O.data)==null?void 0:T.message)||"Failed to update rate")}},children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>P(O=>{const T={...O};return delete T[B.id],T}),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>P(O=>({...O,[B.id]:{rate:B.rate,rate_date:String(B.rate_date).slice(0,10)}})),children:"Edit"}),e.jsx("button",{className:"btn",onClick:async()=>{var O,T;if(window.confirm("Delete this rate?"))try{await te.delete(`/finance/currency-rates/${B.id}`),mt.success("Rate deleted"),P(V=>{const D={...V};return delete D[B.id],D}),I()}catch(V){mt.error(((T=(O=V==null?void 0:V.response)==null?void 0:O.data)==null?void 0:T.message)||"Failed to delete rate")}},children:"Delete"})]})})]},B.id)}),s.length===0&&!a&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-6 text-slate-600",children:"No rates found"})})]})]})})]})}function OJ(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(!0);async function h(){var b,y,N;try{a(!0);const j=await te.get("/finance/fiscal-years");s(((b=j.data)==null?void 0:b.items)||[])}catch(j){mt.error(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to load fiscal years")}finally{a(!1)}}v.useEffect(()=>{h()},[]);async function f(b){var y,N;b.preventDefault();try{await te.post("/finance/fiscal-years",{code:n.trim(),startDate:l,endDate:u,isOpen:c}),mt.success("Fiscal year created"),i(""),o(""),d(""),m(!0),h()}catch(j){mt.error(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to create fiscal year")}}async function x(b){var y,N;try{await te.post(`/finance/fiscal-years/${b}/open`),mt.success("Fiscal year opened"),h()}catch(j){mt.error(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to open fiscal year")}}async function g(b){var y,N;try{await te.post(`/finance/fiscal-years/${b}/close`),mt.success("Fiscal year closed"),h()}catch(j){mt.error(((N=(y=j==null?void 0:j.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to close fiscal year")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Fiscal Years"}),e.jsx("p",{className:"text-sm mt-1",children:"Open and close fiscal periods, manage reporting ranges"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:h,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:f,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:n,onChange:b=>i(b.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date *"}),e.jsx("input",{className:"input",type:"date",value:l,onChange:b=>o(b.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date *"}),e.jsx("input",{className:"input",type:"date",value:u,onChange:b=>d(b.target.value),required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:b=>m(b.target.checked)}),"Set Open"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:b.code}),e.jsx("td",{children:b.start_date?String(b.start_date).split("T")[0]:""}),e.jsx("td",{children:b.end_date?String(b.end_date).split("T")[0]:""}),e.jsx("td",{children:b.is_open?e.jsx("span",{className:"badge badge-success",children:"Open"}):e.jsx("span",{className:"badge badge-error",children:"Closed"})}),e.jsx("td",{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:b.is_open?e.jsx("button",{className:"btn",onClick:()=>g(b.id),children:"Close"}):e.jsx("button",{className:"btn",onClick:()=>x(b.id),children:"Open"})})})]},b.id))})]})})})})]})}function QJ(){const[t,s]=v.useState([]),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState("");async function x(){var y,N,j,S;try{i(!0);const[k,P]=await Promise.all([te.get("/finance/bank-accounts"),te.get("/finance/bank-reconciliations")]);s(((y=k.data)==null?void 0:y.items)||[]),a(((N=P.data)==null?void 0:N.items)||[])}catch(k){mt.error(((S=(j=k==null?void 0:k.response)==null?void 0:j.data)==null?void 0:S.message)||"Failed to load bank accounts / reconciliations")}finally{i(!1)}}v.useEffect(()=>{x()},[]);async function g(y){var N,j;if(y.preventDefault(),u&&c){const S=new Date(u),k=new Date(c);if(S>k){mt.error("Statement From must be before or equal to Statement To");return}}try{await te.post("/finance/bank-reconciliations",{bankAccountId:Number(l),statementFrom:u,statementTo:c,statementEndingBalance:h?Number(h):void 0}),mt.success("Reconciliation created"),o(""),d(""),m(""),f(""),x()}catch(S){mt.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to create reconciliation")}}async function b(y){var N,j;if(y.status!=="COMPLETED"&&window.confirm("Mark this reconciliation as COMPLETED?"))try{await te.post(`/finance/bank-reconciliations/${y.id}/complete`),mt.success("Reconciliation completed"),x()}catch(S){mt.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to complete reconciliation")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Bank Reconciliation"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage bank reconciliations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",disabled:n,onClick:x,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Bank Account *"}),e.jsxs("select",{className:"input",value:l,onChange:y=>o(y.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(y=>e.jsxs("option",{value:y.id,children:[y.name," (",y.account_number||"No Acc",")"]},y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement From *"}),e.jsx("input",{className:"input",type:"date",value:u,onChange:y=>d(y.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement To *"}),e.jsx("input",{className:"input",type:"date",value:c,onChange:y=>m(y.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Ending Balance"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:h,onChange:y=>f(y.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{className:"text-right",children:"Ending Balance"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[r.map(y=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:y.bank_account_name}),e.jsx("td",{children:String(y.statement_from).slice(0,10)}),e.jsx("td",{children:String(y.statement_to).slice(0,10)}),e.jsx("td",{className:"text-right",children:Number(y.statement_ending_balance||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:y.status==="COMPLETED"?e.jsx("span",{className:"badge badge-success",children:"Completed"}):e.jsx("span",{className:"badge badge-info",children:"Draft"})}),e.jsx("td",{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(Ee,{to:`/finance/bank-reconciliation/${y.id}`,className:"btn btn-secondary",children:"Open"}),y.status!=="COMPLETED"&&e.jsx("button",{className:"btn",onClick:()=>b(y),children:"Complete"})]})})]},y.id)),r.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-6 text-slate-600",children:"No reconciliations found"})})]})]})})})})]})}function MJ(){var _,F;const{id:t}=Ps();Ns();const[s,r]=v.useState(!0),[a,n]=v.useState(null),[i,l]=v.useState([]),[o,u]=v.useState({}),[d,c]=v.useState({voucherId:"",statementDate:"",description:"",amount:"",cleared:!1}),[m,h]=v.useState({}),[f,x]=v.useState([]),[g,b]=v.useState(""),[y,N]=v.useState(!1),[j,S]=v.useState(null),[k,P]=v.useState([]),[I,B]=v.useState(!1),[q,Q]=v.useState({date:"",description:"",amount:"",cleared:"",voucher_no:""}),[O,T]=v.useState(null);async function V(){var E,L,U,J;try{r(!0);const ae=await te.get(`/finance/bank-reconciliations/${t}`);n(((E=ae.data)==null?void 0:E.header)||null),l(((L=ae.data)==null?void 0:L.lines)||[]),u({}),h({});try{const Z=await te.get(`/finance/bank-reconciliations/${t}/summary`);T(Z.data||null)}catch{T(null)}}catch(ae){mt.error(((J=(U=ae==null?void 0:ae.response)==null?void 0:U.data)==null?void 0:J.message)||"Failed to load reconciliation")}finally{r(!1)}}v.useEffect(()=>{V()},[t]),v.useEffect(()=>{(async()=>{var E;try{const L=await te.get("/finance/vouchers");x(((E=L.data)==null?void 0:E.items)||[])}catch{}})()},[]);async function D(){var U,J;const E=o.statement_from||(a==null?void 0:a.statement_from),L=o.statement_to||(a==null?void 0:a.statement_to);if(E&&L){const ae=new Date(E),Z=new Date(L);if(ae>Z){mt.error("Statement From must be before or equal to Statement To");return}}try{await te.put(`/finance/bank-reconciliations/${t}`,{statementFrom:o.statement_from||void 0,statementTo:o.statement_to||void 0,statementEndingBalance:o.statement_ending_balance===""||o.statement_ending_balance===null?void 0:Number(o.statement_ending_balance),status:o.status||void 0}),mt.success("Header updated"),V()}catch(ae){mt.error(((J=(U=ae==null?void 0:ae.response)==null?void 0:U.data)==null?void 0:J.message)||"Failed to update header")}}async function Y(E){var L,U;if(E.preventDefault(),!d.statementDate){mt.error("Statement Date is required");return}if(!d.amount||Number(d.amount)===0){mt.error("Amount must be non-zero");return}if(a!=null&&a.statement_from&&(a!=null&&a.statement_to)){const J=new Date(d.statementDate),ae=new Date(a.statement_from),Z=new Date(a.statement_to);if(J<ae||J>Z){mt.error("Line date must be within reconciliation date range");return}}try{await te.post(`/finance/bank-reconciliations/${t}/lines`,{voucherId:d.voucherId?Number(d.voucherId):void 0,statementDate:d.statementDate,description:d.description||void 0,amount:Number(d.amount),cleared:d.cleared?1:0}),mt.success("Line added"),c({voucherId:"",statementDate:"",description:"",amount:"",cleared:!1}),V()}catch(J){mt.error(((U=(L=J==null?void 0:J.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to add line")}}async function M(E){var U,J;const L=m[E.id]||{};if(L.amount!==void 0&&(L.amount===""||Number(L.amount)===0)){mt.error("Amount must be non-zero");return}if(L.statement_date){const ae=new Date(L.statement_date),Z=new Date(a.statement_from),oe=new Date(a.statement_to);if(ae<Z||ae>oe){mt.error("Line date must be within reconciliation date range");return}}try{await te.put(`/finance/bank-reconciliation-lines/${E.id}`,{voucherId:L.voucher_id===void 0?void 0:Number(L.voucher_id||0),statementDate:L.statement_date||void 0,description:L.description||void 0,amount:L.amount===void 0||L.amount===""?void 0:Number(L.amount),cleared:L.cleared===void 0?void 0:L.cleared?1:0}),mt.success("Line updated"),h(ae=>{const Z={...ae};return delete Z[E.id],Z}),V()}catch(ae){mt.error(((J=(U=ae==null?void 0:ae.response)==null?void 0:U.data)==null?void 0:J.message)||"Failed to update line")}}async function X(E){var L,U;if(window.confirm("Delete this line?"))try{await te.delete(`/finance/bank-reconciliation-lines/${E.id}`),mt.success("Line deleted"),h(J=>{const ae={...J};return delete ae[E.id],ae}),V()}catch(J){mt.error(((U=(L=J==null?void 0:J.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to delete line")}}async function R(E){var L,U,J,ae;if(E.preventDefault(),!j){mt.error("Choose a CSV or XLSX file");return}try{N(!0);const Z=new FormData;if(Z.append("file",j),I){const Ae={};q.date&&(Ae.date=q.date),q.description&&(Ae.description=q.description),q.amount&&(Ae.amount=q.amount),q.cleared&&(Ae.cleared=q.cleared),q.voucher_no&&(Ae.voucher_no=q.voucher_no),Z.append("mapping",JSON.stringify(Ae))}const oe=await te.post(`/finance/bank-reconciliations/${t}/lines/import`,Z,{headers:{"Content-Type":"multipart/form-data"}}),ee=((L=oe.data)==null?void 0:L.insertedCount)||0,se=((U=oe.data)==null?void 0:U.skippedCount)||0;mt.success(`Imported ${ee} lines, skipped ${se}`),S(null),V()}catch(Z){mt.error(((ae=(J=Z==null?void 0:Z.response)==null?void 0:J.data)==null?void 0:ae.message)||"Failed to import lines")}finally{N(!1)}}async function H(E){try{const L=await te.get(`/finance/bank-reconciliations/lines/import-template?format=${E}`,{responseType:"blob"}),U=new Blob([L.data],{type:E==="xlsx"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"}),J=URL.createObjectURL(U),ae=document.createElement("a");ae.href=J,ae.download=E==="xlsx"?"reconciliation_import_template.xlsx":"reconciliation_import_template.csv",document.body.appendChild(ae),ae.click(),ae.remove(),URL.revokeObjectURL(J)}catch{mt.error("Failed to download template")}}function W(E){if(S(E),P([]),!E)return;const L=new FileReader;L.onload=()=>{try{const U=g0(L.result,{type:"binary"}),J=U.Sheets[U.SheetNames[0]],ae=us.sheet_to_json(J,{header:1}),oe=(Array.isArray(ae==null?void 0:ae[0])?ae[0]:[]).map(ee=>String(ee||"").trim()).filter(ee=>ee.length>0);P(oe)}catch{}},L.readAsBinaryString(E)}if(!a&&!s)return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Reconciliation Not Found"})}),e.jsx("div",{className:"card-body",children:e.jsx(Ee,{to:"/finance/bank-reconciliation",className:"btn",children:"Back to List"})})]})});const K=O?{cleared:Number(O.clearedTotal||0),uncleared:Number(O.unclearedTotal||0),ending:Number(O.statementEndingBalance||0),openingBook:Number(O.openingBookBalance||0),periodMovement:Number(O.periodBookMovement||0),endingBook:Number(O.endingBookBalance||0),diffBankVsCleared:Number(O.diffBankVsCleared||0),diffBankVsBook:Number(O.diffBankVsBook||0),outstandingEstimate:Number(O.outstandingEstimate||0)}:{cleared:i.filter(E=>Number(E.cleared)).reduce((E,L)=>E+Number(L.amount||0),0),uncleared:i.filter(E=>!Number(E.cleared)).reduce((E,L)=>E+Number(L.amount||0),0),ending:Number((a==null?void 0:a.statement_ending_balance)||0),openingBook:0,periodMovement:0,endingBook:0,diffBankVsCleared:Number((a==null?void 0:a.statement_ending_balance)||0)-i.filter(E=>Number(E.cleared)).reduce((E,L)=>E+Number(L.amount||0),0),diffBankVsBook:0,outstandingEstimate:0};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Bank Reconciliation Details"}),e.jsxs("p",{className:"text-sm mt-1",children:[a==null?void 0:a.bank_account_name," ",a!=null&&a.account_number?`(${a.account_number})`:""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/finance/bank-reconciliation",className:"btn btn-secondary",children:"Back to List"}),e.jsx("button",{className:"btn btn-secondary",disabled:s,onClick:V,children:"Refresh"})]})]})}),a&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement From"}),e.jsx("input",{className:"input",type:"date",value:o.statement_from===void 0?(_=a.statement_from)==null?void 0:_.slice(0,10):o.statement_from,onChange:E=>u(L=>({...L,statement_from:E.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement To"}),e.jsx("input",{className:"input",type:"date",value:o.statement_to===void 0?(F=a.statement_to)==null?void 0:F.slice(0,10):o.statement_to,onChange:E=>u(L=>({...L,statement_to:E.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Ending Balance"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:o.statement_ending_balance===void 0?a.statement_ending_balance??"":o.statement_ending_balance,onChange:E=>u(L=>({...L,statement_ending_balance:E.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status===void 0?a.status:o.status,onChange:E=>u(L=>({...L,status:E.target.value})),children:[e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"COMPLETED",children:"Completed"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",onClick:D,children:"Save Header"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Cleared Total"}),e.jsx("div",{className:"text-xl font-semibold",children:K.cleared.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Uncleared Total"}),e.jsx("div",{className:"text-xl font-semibold",children:K.uncleared.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Statement Ending Balance"}),e.jsx("div",{className:"text-xl font-semibold",children:K.ending.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Diff (Ending  Cleared)"}),e.jsx("div",{className:`text-xl font-semibold ${K.diffBankVsCleared===0?"text-green-600":"text-red-600"}`,children:K.diffBankVsCleared.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Book Opening"}),e.jsx("div",{className:"text-xl font-semibold",children:K.openingBook.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Book Movement"}),e.jsx("div",{className:"text-xl font-semibold",children:K.periodMovement.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Book Ending"}),e.jsx("div",{className:"text-xl font-semibold",children:K.endingBook.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Diff (Ending  Book)"}),e.jsx("div",{className:`text-xl font-semibold ${K.diffBankVsBook===0?"text-green-600":"text-red-600"}`,children:K.diffBankVsBook.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Outstanding Estimate (Book  Cleared)"}),e.jsx("div",{className:"text-xl font-semibold",children:K.outstandingEstimate.toLocaleString("en-US",{minimumFractionDigits:2})})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Statement Lines"}),e.jsx("p",{className:"text-sm",children:"Add bank statement lines and mark cleared"})]})})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("form",{onSubmit:R,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"label",children:"Import Lines (CSV/XLSX)"}),e.jsx("input",{className:"input",type:"file",accept:".csv,.xlsx",onChange:E=>{var L;return W(((L=E.target.files)==null?void 0:L[0])||null)}})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-secondary",disabled:y,children:y?"Importing...":"Import"})}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>H("csv"),children:"Download CSV Template"}),e.jsx("button",{type:"button",className:"btn",onClick:()=>H("xlsx"),children:"Download XLSX Template"})]}),e.jsxs("div",{className:"md:col-span-6",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:I,onChange:E=>B(E.target.checked)}),"Advanced Mapping"]}),I&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date Column"}),e.jsxs("select",{className:"input",value:q.date,onChange:E=>Q(L=>({...L,date:E.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),k.map(E=>e.jsx("option",{value:E,children:E},`date-${E}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description Column"}),e.jsxs("select",{className:"input",value:q.description,onChange:E=>Q(L=>({...L,description:E.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),k.map(E=>e.jsx("option",{value:E,children:E},`desc-${E}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount Column"}),e.jsxs("select",{className:"input",value:q.amount,onChange:E=>Q(L=>({...L,amount:E.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),k.map(E=>e.jsx("option",{value:E,children:E},`amt-${E}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cleared Column"}),e.jsxs("select",{className:"input",value:q.cleared,onChange:E=>Q(L=>({...L,cleared:E.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),k.map(E=>e.jsx("option",{value:E,children:E},`clr-${E}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No. Column"}),e.jsxs("select",{className:"input",value:q.voucher_no,onChange:E=>Q(L=>({...L,voucher_no:E.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),k.map(E=>e.jsx("option",{value:E,children:E},`vno-${E}`))]})]})]})]})]}),e.jsxs("form",{onSubmit:Y,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher (optional)"}),e.jsx("input",{className:"input mb-2",placeholder:"Search voucher no.",value:g,onChange:E=>b(E.target.value)}),e.jsxs("select",{className:"input",value:d.voucherId,onChange:E=>c(L=>({...L,voucherId:E.target.value})),children:[e.jsx("option",{value:"",children:"None"}),(g?f.filter(E=>String(E.voucher_no||"").toLowerCase().includes(g.toLowerCase())):f).slice(0,50).map(E=>e.jsxs("option",{value:E.id,children:[E.voucher_no," (",E.voucher_type_code,") -"," ",String(E.voucher_date).slice(0,10)]},E.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement Date *"}),e.jsx("input",{className:"input",type:"date",value:d.statementDate,onChange:E=>c(L=>({...L,statementDate:E.target.value})),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:d.description,onChange:E=>c(L=>({...L,description:E.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount *"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:d.amount,onChange:E=>c(L=>({...L,amount:E.target.value})),required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:d.cleared,onChange:E=>c(L=>({...L,cleared:E.target.checked}))}),"Cleared"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add Line"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Voucher"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[i.map(E=>{var J;const L=m[E.id]||{},U=!!m[E.id];return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:U?e.jsx("input",{className:"input",type:"number",min:"0",value:L.voucher_id===void 0?E.voucher_id??"":L.voucher_id,onChange:ae=>h(Z=>({...Z,[E.id]:{...Z[E.id]||{},voucher_id:ae.target.value}}))}):E.voucher_no?`${E.voucher_no}`:""}),e.jsx("td",{children:U?e.jsx("input",{className:"input",type:"date",value:L.statement_date===void 0?(J=E.statement_date)==null?void 0:J.slice(0,10):L.statement_date,onChange:ae=>h(Z=>({...Z,[E.id]:{...Z[E.id]||{},statement_date:ae.target.value}}))}):String(E.statement_date).slice(0,10)}),e.jsx("td",{children:U?e.jsx("input",{className:"input",value:L.description===void 0?E.description??"":L.description,onChange:ae=>h(Z=>({...Z,[E.id]:{...Z[E.id]||{},description:ae.target.value}}))}):E.description}),e.jsx("td",{className:"text-right",children:U?e.jsx("input",{className:"input",type:"number",step:"0.01",value:L.amount===void 0?E.amount??"":L.amount,onChange:ae=>h(Z=>({...Z,[E.id]:{...Z[E.id]||{},amount:ae.target.value}}))}):Number(E.amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:U?e.jsxs("select",{className:"input",value:L.cleared??E.cleared?"1":"0",onChange:ae=>h(Z=>({...Z,[E.id]:{...Z[E.id]||{},cleared:ae.target.value==="1"}})),children:[e.jsx("option",{value:"1",children:"Cleared"}),e.jsx("option",{value:"0",children:"Uncleared"})]}):E.cleared?e.jsx("span",{className:"badge badge-success",children:"Cleared"}):e.jsx("span",{className:"badge badge-error",children:"Uncleared"})}),e.jsx("td",{className:"text-right",children:U?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>M(E),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>h(ae=>{const Z={...ae};return delete Z[E.id],Z}),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>h(ae=>({...ae,[E.id]:{voucher_id:E.voucher_id,statement_date:String(E.statement_date).slice(0,10),description:E.description,amount:E.amount,cleared:!!E.cleared}})),children:"Edit"}),e.jsx("button",{className:"btn",onClick:()=>X(E),children:"Delete"})]})})]},E.id)}),i.length===0&&!s&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-6 text-slate-600",children:"No lines yet"})})]})]})})]})]})]})}function HJ(){const[t,s]=v.useState([]),[r,a]=v.useState([]),[n,i]=v.useState(!0),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState([]),[N,j]=v.useState("");async function S(){var B,q,Q,O;try{i(!0);const[T,V]=await Promise.all([te.get("/finance/pdc-postings"),te.get("/finance/bank-accounts")]);let D=((B=T.data)==null?void 0:B.items)||[];l&&(D=D.filter(Y=>Y.status===l)),s(D),a(((q=V.data)==null?void 0:q.items)||[])}catch(T){mt.error(((O=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:O.message)||"Failed to load PDCs")}finally{i(!1)}}v.useEffect(()=>{S()},[l]),v.useEffect(()=>{(async()=>{var B;try{const q=await te.get("/finance/vouchers");y(((B=q.data)==null?void 0:B.items)||[])}catch{}})()},[]);async function k(B){var Q,O;if(B.preventDefault(),!u){mt.error("Voucher ID is required");return}if(!c.trim()){mt.error("Instrument No. is required");return}if(!h){mt.error("Instrument Date is required");return}const q=b.find(T=>Number(T.id)===Number(u));if(q){const T=new Date(h),V=new Date(q.voucher_date);if(T<V){mt.error("Instrument Date must be on or after voucher date");return}}try{await te.post("/finance/pdc-postings",{voucherId:Number(u),instrumentNo:c.trim(),instrumentDate:h,bankAccountId:x?Number(x):void 0}),mt.success("PDC created"),d(""),m(""),f(""),g(""),S()}catch(T){mt.error(((O=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:O.message)||"Failed to create PDC")}}async function P(B,q){var Q,O;if(window.confirm(`Change status to ${q}?`))try{await te.put(`/finance/pdc-postings/${B.id}`,{status:q}),mt.success("Status updated"),S()}catch(T){mt.error(((O=(Q=T==null?void 0:T.response)==null?void 0:Q.data)==null?void 0:O.message)||"Failed to update status")}}async function I(B){var q,Q;if(window.confirm("Delete this PDC?"))try{await te.delete(`/finance/pdc-postings/${B.id}`),mt.success("PDC deleted"),S()}catch(O){mt.error(((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.message)||"Failed to delete PDC")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Post-Dated Cheques (PDC)"}),e.jsx("p",{className:"text-sm mt-1",children:"Register and manage PDC postings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",disabled:n,onClick:S,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:k,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher *"}),e.jsx("input",{className:"input mb-2",placeholder:"Search voucher no.",value:N,onChange:B=>j(B.target.value)}),e.jsxs("select",{className:"input",value:u,onChange:B=>d(B.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),(N?b.filter(B=>String(B.voucher_no||"").toLowerCase().includes(N.toLowerCase())):b).slice(0,50).map(B=>e.jsxs("option",{value:B.id,children:[B.voucher_no," (",B.voucher_type_code,") -"," ",String(B.voucher_date).slice(0,10)]},B.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Instrument No. *"}),e.jsx("input",{className:"input",value:c,onChange:B=>m(B.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Instrument Date *"}),e.jsx("input",{className:"input",type:"date",value:h,onChange:B=>f(B.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:x,onChange:B=>g(B.target.value),children:[e.jsx("option",{value:"",children:"Select"}),r.map(B=>e.jsxs("option",{value:B.id,children:[B.name," (",B.account_number||"No Acc",")"]},B.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add PDC"})})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:l,onChange:B=>o(B.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"HELD",children:"Held"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Instrument No."}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[t.map(B=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:B.instrument_no}),e.jsx("td",{children:String(B.instrument_date).slice(0,10)}),e.jsx("td",{children:B.voucher_no}),e.jsx("td",{children:e.jsx("span",{className:"badge",children:B.status})}),e.jsx("td",{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(Ee,{to:`/finance/pdc-postings/${B.id}`,className:"btn btn-secondary",children:"Edit"}),B.status==="HELD"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn",onClick:()=>P(B,"POSTED"),children:"Post"}),e.jsx("button",{className:"btn",onClick:()=>P(B,"CANCELLED"),children:"Cancel"}),e.jsx("button",{className:"btn",onClick:()=>I(B),children:"Delete"})]})]})})]},B.id)),t.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-slate-600",children:"No PDCs found"})})]})]})})]})})]})}function qJ(){var g;const{id:t}=Ps(),[s,r]=v.useState(!0),[a,n]=v.useState(null),[i,l]=v.useState([]),[o,u]=v.useState({}),[d,c]=v.useState([]),[m,h]=v.useState("");async function f(){var b,y,N,j;try{r(!0);const[S,k]=await Promise.all([te.get("/finance/pdc-postings"),te.get("/finance/bank-accounts")]),P=(((b=S.data)==null?void 0:b.items)||[]).find(I=>Number(I.id)===Number(t));n(P||null),u({}),l(((y=k.data)==null?void 0:y.items)||[])}catch(S){mt.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to load PDC")}finally{r(!1)}}v.useEffect(()=>{f()},[t]),v.useEffect(()=>{(async()=>{var b;try{const y=await te.get("/finance/vouchers");c(((b=y.data)==null?void 0:b.items)||[])}catch{}})()},[]);async function x(){var N,j;if(o.instrument_date!==void 0&&!String(o.instrument_date).trim()||!(a!=null&&a.instrument_date)&&o.instrument_date===void 0){mt.error("Instrument Date is required");return}const b=o.voucher_id===void 0||o.voucher_id===""?a==null?void 0:a.voucher_id:Number(o.voucher_id),y=o.instrument_date===void 0||!String(o.instrument_date).trim()?a==null?void 0:a.instrument_date:o.instrument_date;if(b&&y){const S=d.find(k=>Number(k.id)===Number(b));if(S){const k=new Date(y),P=new Date(S.voucher_date);if(k<P){mt.error("Instrument Date must be on or after voucher date");return}}}try{await te.put(`/finance/pdc-postings/${t}`,{voucherId:o.voucher_id===void 0?void 0:Number(o.voucher_id),instrumentNo:o.instrument_no||void 0,instrumentDate:o.instrument_date||void 0,bankAccountId:o.bank_account_id===void 0?void 0:o.bank_account_id?Number(o.bank_account_id):null,status:o.status||void 0}),mt.success("PDC updated"),f()}catch(S){mt.error(((j=(N=S==null?void 0:S.response)==null?void 0:N.data)==null?void 0:j.message)||"Failed to update PDC")}}return!a&&!s?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h1",{className:"text-2xl font-bold",children:"PDC Not Found"})}),e.jsx("div",{className:"card-body",children:e.jsx(Ee,{to:"/finance/pdc-postings",className:"btn",children:"Back to List"})})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Edit Post-Dated Cheque"}),e.jsx("p",{className:"text-sm mt-1",children:a==null?void 0:a.instrument_no})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/finance/pdc-postings",className:"btn btn-secondary",children:"Back to List"}),e.jsx("button",{className:"btn btn-secondary",disabled:s,onClick:f,children:"Refresh"})]})]})}),a&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher"}),e.jsx("input",{className:"input mb-2",placeholder:"Search voucher no.",value:m,onChange:b=>h(b.target.value)}),e.jsxs("select",{className:"input",value:o.voucher_id===void 0?a.voucher_id??"":o.voucher_id,onChange:b=>u(y=>({...y,voucher_id:b.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),(m?d.filter(b=>String(b.voucher_no||"").toLowerCase().includes(m.toLowerCase())):d).slice(0,50).map(b=>e.jsxs("option",{value:b.id,children:[b.voucher_no," (",b.voucher_type_code,") -"," ",String(b.voucher_date).slice(0,10)]},b.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Instrument No."}),e.jsx("input",{className:"input",value:o.instrument_no===void 0?a.instrument_no??"":o.instrument_no,onChange:b=>u(y=>({...y,instrument_no:b.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Instrument Date"}),e.jsx("input",{className:"input",type:"date",value:o.instrument_date===void 0?(g=a.instrument_date)==null?void 0:g.slice(0,10):o.instrument_date,onChange:b=>u(y=>({...y,instrument_date:b.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:o.bank_account_id===void 0?a.bank_account_id??"":o.bank_account_id,onChange:b=>u(y=>({...y,bank_account_id:b.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),i.map(b=>e.jsxs("option",{value:b.id,children:[b.name," (",b.account_number||"No Acc",")"]},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status===void 0?a.status:o.status,onChange:b=>u(y=>({...y,status:b.target.value})),children:[e.jsx("option",{value:"HELD",children:"Held"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",onClick:x,children:"Save"})})]})})})]})}function VJ(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(bJ,{})}),e.jsx(tt,{path:"/journal-voucher",element:e.jsx(Kd,{voucherTypeCode:"JV",title:"Journal Entry"})}),e.jsx(tt,{path:"/journal-voucher/create",element:e.jsx(ci,{voucherTypeCode:"JV",title:"New Journal Entry"})}),e.jsx(tt,{path:"/journal-voucher/:id",element:e.jsx(ci,{voucherTypeCode:"JV",title:"Journal Entry"})}),e.jsx(tt,{path:"/payment-voucher",element:e.jsx(Kd,{voucherTypeCode:"PV",title:"Make Payment"})}),e.jsx(tt,{path:"/payment-voucher/create",element:e.jsx(ci,{voucherTypeCode:"PV",title:"Make Payment"})}),e.jsx(tt,{path:"/payment-voucher/:id",element:e.jsx(ci,{voucherTypeCode:"PV",title:"Make Payment"})}),e.jsx(tt,{path:"/receipt-voucher",element:e.jsx(Kd,{voucherTypeCode:"RV",title:"Receive Payment"})}),e.jsx(tt,{path:"/receipt-voucher/create",element:e.jsx(ci,{voucherTypeCode:"RV",title:"Receive Payment"})}),e.jsx(tt,{path:"/receipt-voucher/:id",element:e.jsx(ci,{voucherTypeCode:"RV",title:"Receive Payment"})}),e.jsx(tt,{path:"/contra-voucher",element:e.jsx(Kd,{voucherTypeCode:"CV",title:"Account Transfer"})}),e.jsx(tt,{path:"/contra-voucher/create",element:e.jsx(ci,{voucherTypeCode:"CV",title:"Account Transfer"})}),e.jsx(tt,{path:"/contra-voucher/:id",element:e.jsx(ci,{voucherTypeCode:"CV",title:"Account Transfer"})}),e.jsx(tt,{path:"/sales-voucher",element:e.jsx(Kd,{voucherTypeCode:"SV",title:"Sales Vouchers"})}),e.jsx(tt,{path:"/sales-voucher/create",element:e.jsx(ci,{voucherTypeCode:"SV",title:"New Sales Voucher"})}),e.jsx(tt,{path:"/sales-voucher/:id",element:e.jsx(ci,{voucherTypeCode:"SV",title:"Sales Vouchers"})}),e.jsx(tt,{path:"/purchase-voucher",element:e.jsx(Kd,{voucherTypeCode:"PUV",title:"Purchase Vouchers"})}),e.jsx(tt,{path:"/purchase-voucher/create",element:e.jsx(ci,{voucherTypeCode:"PUV",title:"New Purchase Voucher"})}),e.jsx(tt,{path:"/purchase-voucher/:id",element:e.jsx(ci,{voucherTypeCode:"PUV",title:"Purchase Vouchers"})}),e.jsx(tt,{path:"/debit-note",element:e.jsx(Kd,{voucherTypeCode:"DN",title:"Debit Notes"})}),e.jsx(tt,{path:"/debit-note/create",element:e.jsx(ci,{voucherTypeCode:"DN",title:"New Debit Note"})}),e.jsx(tt,{path:"/debit-note/:id",element:e.jsx(ci,{voucherTypeCode:"DN",title:"Debit Notes"})}),e.jsx(tt,{path:"/credit-note",element:e.jsx(Kd,{voucherTypeCode:"CN",title:"Credit Notes"})}),e.jsx(tt,{path:"/credit-note/create",element:e.jsx(ci,{voucherTypeCode:"CN",title:"New Credit Note"})}),e.jsx(tt,{path:"/credit-note/:id",element:e.jsx(ci,{voucherTypeCode:"CN",title:"Credit Notes"})}),e.jsx(tt,{path:"/account-groups",element:e.jsx(DJ,{})}),e.jsx(tt,{path:"/accounts",element:e.jsx(cS,{})}),e.jsx(tt,{path:"/coa",element:e.jsx(cS,{})}),e.jsx(tt,{path:"/tax-codes",element:e.jsx(PJ,{})}),e.jsx(tt,{path:"/currencies",element:e.jsx(UJ,{})}),e.jsx(tt,{path:"/fiscal-years",element:e.jsx(OJ,{})}),e.jsx(tt,{path:"/bank-reconciliation",element:e.jsx(QJ,{})}),e.jsx(tt,{path:"/bank-reconciliation/:id",element:e.jsx(MJ,{})}),e.jsx(tt,{path:"/pdc-postings",element:e.jsx(HJ,{})}),e.jsx(tt,{path:"/pdc-postings/:id",element:e.jsx(qJ,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(oS,{})}),e.jsx(tt,{path:"/reports/voucher-register",element:e.jsx(oS,{})}),e.jsx(tt,{path:"/reports/trial-balance",element:e.jsx(jJ,{})}),e.jsx(tt,{path:"/reports/journals",element:e.jsx(NJ,{})}),e.jsx(tt,{path:"/reports/general-ledger",element:e.jsx(wJ,{})}),e.jsx(tt,{path:"/reports/payment-due",element:e.jsx(BJ,{})}),e.jsx(tt,{path:"/reports/customer-outstanding",element:e.jsx(kJ,{})}),e.jsx(tt,{path:"/reports/audit-trail",element:e.jsx(EJ,{})}),e.jsx(tt,{path:"/reports/debtors-ledger",element:e.jsx(FJ,{})}),e.jsx(tt,{path:"/reports/creditors-ledger",element:e.jsx(TJ,{})}),e.jsx(tt,{path:"/reports/supplier-outstanding",element:e.jsx(IJ,{})}),e.jsx(tt,{path:"/reports/ratio-analysis",element:e.jsx(LJ,{})}),e.jsx(tt,{path:"/reports/profit-and-loss",element:e.jsx(_J,{})}),e.jsx(tt,{path:"/reports/balance-sheet",element:e.jsx(SJ,{})}),e.jsx(tt,{path:"/reports/cash-flow",element:e.jsx(CJ,{})}),e.jsx(tt,{path:"*",element:e.jsx(Wc,{to:"/finance",replace:!0})})]})}function $J(){const t=Ns(),[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(""),[o,u]=v.useState(""),[d,c]=v.useState("ALL"),[m,h]=v.useState("ALL");v.useEffect(()=>{f()},[]);const f=async()=>{var N,j,S;try{n(!0),l("");const k=await te.get("/hr/employees");r(Array.isArray((N=k.data)==null?void 0:N.items)?k.data.items:[])}catch(k){l(((S=(j=k==null?void 0:k.response)==null?void 0:j.data)==null?void 0:S.message)||"Error fetching employees"),console.error("Error fetching employees:",k)}finally{n(!1)}},x=N=>N?e.jsx("span",{className:"badge badge-success",children:"ACTIVE"}):e.jsx("span",{className:"badge badge-error",children:"INACTIVE"}),g=N=>{const j={PERMANENT:"badge badge-success",CONTRACT:"badge badge-info",TEMPORARY:"badge badge-warning",INTERN:"badge bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"};return e.jsx("span",{className:j[N]||"badge",children:N})},b=s.filter(N=>{const j=String(N.emp_no||"").toLowerCase().includes(o.toLowerCase())||String(N.full_name||"").toLowerCase().includes(o.toLowerCase())||String(N.email||"").toLowerCase().includes(o.toLowerCase()),S=d==="ALL"||(d==="ACTIVE"?N.is_active:!N.is_active),k=m==="ALL"||N.department===m;return j&&S&&k}),y=["ALL",...new Set(s.map(N=>N.department).filter(Boolean))];return a?e.jsx("div",{className:"text-center py-8",children:"Loading employees..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Employee Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage employee records and information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/employees/new",className:"btn-success",children:"+ New Employee"})]})]})})}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by employee number, name, or email...",className:"input",value:o,onChange:N=>u(N.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsx("select",{className:"input",value:m,onChange:N=>h(N.target.value),children:y.map(N=>e.jsx("option",{value:N,children:N==="ALL"?"All Departments":N},N))})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:d,onChange:N=>c(N.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading employees..."})]}):b.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No employees found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Emp No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Designation"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b.map(N=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:N.emp_no}),e.jsx("td",{children:N.full_name}),e.jsx("td",{children:N.designation}),e.jsx("td",{children:N.department}),e.jsx("td",{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:N.email}),e.jsx("div",{className:"text-slate-500",children:N.contact_no})]})}),e.jsx("td",{children:g(N.employment_type)}),e.jsx("td",{children:x(N.is_active)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/human-resources/employees/${N.id}`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),e.jsx("button",{onClick:()=>t(`/human-resources/employees/${N.id}`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"})]})})]},N.id))})]})})]})})]})}function dS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({emp_no:"",full_name:"",designation:"",department:"",email:"",contact_no:"",employment_type:"PERMANENT",date_joined:new Date().toISOString().split("T")[0],is_active:1});v.useEffect(()=>{r&&d()},[s]);async function d(){var h,f,x;try{n(!0),l("");const g=await te.get(`/hr/employees/${s}`);(h=g.data)!=null&&h.item&&u(g.data.item)}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error fetching employee")}finally{n(!1)}}function c(h,f){u(x=>({...x,[h]:f}))}async function m(h){var f,x;h.preventDefault(),n(!0),l("");try{r?await te.put(`/hr/employees/${s}`,o):await te.post("/hr/employees",o),t("/human-resources/employees")}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error saving employee")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Employee":"New Employee"}),e.jsx("p",{className:"text-sm mt-1",children:"Employee setup and configuration"})]}),e.jsx(Ee,{to:"/human-resources/employees",className:"btn-success",children:"Back"})]})})}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee No"}),e.jsx("input",{className:"input",value:o.emp_no,onChange:h=>c("emp_no",h.target.value),placeholder:"Auto-generated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Name *"}),e.jsx("input",{className:"input",value:o.full_name,onChange:h=>c("full_name",h.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Designation"}),e.jsx("input",{className:"input",value:o.designation,onChange:h=>c("designation",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsx("input",{className:"input",value:o.department,onChange:h=>c("department",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:o.email,onChange:h=>c("email",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact No"}),e.jsx("input",{className:"input",value:o.contact_no,onChange:h=>c("contact_no",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employment Type"}),e.jsxs("select",{className:"input",value:o.employment_type,onChange:h=>c("employment_type",h.target.value),children:[e.jsx("option",{value:"PERMANENT",children:"Permanent"}),e.jsx("option",{value:"CONTRACT",children:"Contract"}),e.jsx("option",{value:"TEMPORARY",children:"Temporary"}),e.jsx("option",{value:"INTERN",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date Joined"}),e.jsx("input",{className:"input",type:"date",value:o.date_joined,onChange:h=>c("date_joined",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Active"}),e.jsxs("select",{className:"input",value:String(o.is_active),onChange:h=>c("is_active",Number(h.target.value)),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(Ee,{to:"/human-resources/employees",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save Employee"})]})]})})})]})}function WJ(){const t=[{id:1,code:"ANNUAL",name:"Annual Leave",daysPerYear:21,active:!0},{id:2,code:"SICK",name:"Sick Leave",daysPerYear:10,active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Leave Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure leave types and balances"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/leave-setup/new",className:"btn-success",children:"+ New Leave Type"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Days/Year"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.daysPerYear}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/human-resources/leave-setup/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/human-resources/leave-setup/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})})]})}function uS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({code:"",name:"",daysPerYear:0,active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({code:"ANNUAL",name:"Annual Leave",daysPerYear:21,active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/leave-setup")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Leave Type":"New Leave Type"}),e.jsx("p",{className:"text-sm mt-1",children:"Leave configuration"})]}),e.jsx(Ee,{to:"/human-resources/leave-setup",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:i.code,onChange:d=>o("code",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Days per Year"}),e.jsx("input",{className:"input",type:"number",min:"0",value:i.daysPerYear,onChange:d=>o("daysPerYear",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/leave-setup",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function GJ(){const t=[{id:1,code:"DAY",name:"Day Shift",start:"08:00",end:"17:00",active:!0},{id:2,code:"NIGHT",name:"Night Shift",start:"20:00",end:"05:00",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Shift System Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage work shifts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/shifts/new",className:"btn-success",children:"+ New Shift"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.start}),e.jsx("td",{children:s.end}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Ee,{to:`/human-resources/shifts/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})})]})}function AS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({code:"",name:"",start:"08:00",end:"17:00",active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({code:"DAY",name:"Day Shift",start:"08:00",end:"17:00",active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/shifts")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Shift":"New Shift"}),e.jsx("p",{className:"text-sm mt-1",children:"Shift configuration"})]}),e.jsx(Ee,{to:"/human-resources/shifts",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:i.code,onChange:d=>o("code",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Time"}),e.jsx("input",{className:"input",type:"time",value:i.start,onChange:d=>o("start",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Time"}),e.jsx("input",{className:"input",type:"time",value:i.end,onChange:d=>o("end",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/shifts",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function KJ(){const t=[{id:1,emp:"EMP-001",name:"John Doe",date:"2025-01-02",status:"PRESENT"},{id:2,emp:"EMP-002",name:"Jane Smith",date:"2025-01-02",status:"PRESENT"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Attendance System"}),e.jsx("p",{className:"text-sm mt-1",children:"Track employee attendance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/attendance/new",className:"btn-success",children:"+ New Entry"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Emp No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.emp}),e.jsx("td",{children:s.name}),e.jsx("td",{children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/human-resources/attendance/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/human-resources/attendance/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})})]})}function hS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({empNo:"",date:new Date().toISOString().split("T")[0],status:"PRESENT"});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({empNo:"EMP-001",date:"2025-01-02",status:"PRESENT"}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/attendance")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Attendance":"New Attendance"}),e.jsx("p",{className:"text-sm mt-1",children:"Attendance entry"})]}),e.jsx(Ee,{to:"/human-resources/attendance",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee No *"}),e.jsx("input",{className:"input",value:i.empNo,onChange:d=>o("empNo",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{className:"input",type:"date",value:i.date,onChange:d=>o("date",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.status,onChange:d=>o("status",d.target.value),children:[e.jsx("option",{value:"PRESENT",children:"Present"}),e.jsx("option",{value:"ABSENT",children:"Absent"}),e.jsx("option",{value:"LEAVE",children:"Leave"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/attendance",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function zJ(){const t=[{id:1,name:"Standard Monthly",currency:"GHS",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Salary Configuration"}),e.jsx("p",{className:"text-sm mt-1",children:"Define salary structures and components"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/salary-config/new",className:"btn-success",children:"+ New Config"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.currency}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Ee,{to:`/human-resources/salary-config/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})})]})}function mS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({name:"",currency:"GHS",active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Standard Monthly",currency:"GHS",active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/salary-config")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Salary Config":"New Salary Config"}),e.jsx("p",{className:"text-sm mt-1",children:"Salary config setup"})]}),e.jsx(Ee,{to:"/human-resources/salary-config",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input",value:i.currency,onChange:d=>o("currency",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/salary-config",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function YJ(){const t=[{id:1,name:"Income Tax",active:!0},{id:2,name:"Social Security",active:!0},{id:3,name:"Tier 3",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Tax & Deductions"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure payroll deductions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/tax-config/new",className:"btn-success",children:"+ New Config"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Ee,{to:`/human-resources/tax-config/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})})]})}function fS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({name:"",ratePercent:0,active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Income Tax",ratePercent:0,active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/tax-config")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Tax Config":"New Tax Config"}),e.jsx("p",{className:"text-sm mt-1",children:"Tax and deduction setup"})]}),e.jsx(Ee,{to:"/human-resources/tax-config",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate (%)"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.ratePercent,onChange:d=>o("ratePercent",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/tax-config",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function XJ(){const t=[{id:1,name:"Transport Allowance",amount:200,active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Employee Allowances"}),e.jsx("p",{className:"text-sm mt-1",children:"Allowance setup (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/allowances/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{className:"text-right",children:Number(s.amount).toFixed(2)}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Ee,{className:"text-brand hover:text-brand-600 text-sm font-medium",to:`/human-resources/allowances/${s.id}?mode=view`,children:"View"}),e.jsx(Ee,{className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",to:`/human-resources/allowances/${s.id}?mode=edit`,children:"Edit"})]})]},s.id))})]})})})]})}function pS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({name:"",amount:0,active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Transport Allowance",amount:200,active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/allowances")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Allowance":"New Allowance"})}),e.jsx(Ee,{to:"/human-resources/allowances",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.amount,onChange:d=>o("amount",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{className:"btn-success",to:"/human-resources/allowances",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function JJ(){const t=[{id:1,employee:"John Doe",amount:1e3,balance:600,status:"ACTIVE"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Employee Loans"}),e.jsx("p",{className:"text-sm mt-1",children:"Loan setup and tracking (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/loans/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Balance"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.employee}),e.jsx("td",{className:"text-right",children:Number(s.amount).toFixed(2)}),e.jsx("td",{className:"text-right",children:Number(s.balance).toFixed(2)}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/human-resources/loans/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/human-resources/loans/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function xS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({employee:"",amount:0,status:"ACTIVE"});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({employee:"John Doe",amount:1e3,status:"ACTIVE"}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/loans")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Loan":"New Loan"})}),e.jsx(Ee,{to:"/human-resources/loans",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsx("input",{className:"input",value:i.employee,onChange:d=>o("employee",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.amount,onChange:d=>o("amount",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.status,onChange:d=>o("status",d.target.value),children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"CLOSED",children:"Closed"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/loans",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function ZJ(){const[t]=v.useState([{id:1,period:"2025-01",employee:"John Doe",netPay:2500,status:"GENERATED"}]),[s,r]=v.useState({name:"",address:"",logoUrl:""}),[a,n]=v.useState(null);v.useEffect(()=>{let x=!0;async function g(){var b,y,N;try{const S=(y=(b=(await te.get("/admin/me")).data)==null?void 0:b.scope)==null?void 0:y.companyId;if(!S)return;const P=((N=(await te.get(`/admin/companies/${S}`)).data)==null?void 0:N.item)||{},I=P.has_logo===1||P.has_logo===!0?`/api/admin/companies/${S}/logo`:"";if(!x)return;r({name:String(P.name||""),address:String(P.address||""),logoUrl:String(I||"")})}catch{}}return g(),()=>{x=!1}},[]);function i(x){return String(x??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(x,g){const b=String(g||"").trim().replace(/^\./,"");if(!b)return;const y=b.split(".").filter(Boolean);let N=x;for(const j of y){if(N==null)return;N=N[j]}return N}function o(x,g,b=g){let y=String(x??"");return y=y.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(N,j,S)=>{const k=String(j||"").trim(),P=k.startsWith("@root.")?l(b,k.slice(6)):l(g,k)??l(b,k);return(Array.isArray(P)?P:[]).map(B=>o(S,B??{},b)).join("")}),y=y.replace(/{{{\s*([^}]+?)\s*}}}/g,(N,j)=>{const S=String(j||"").trim();let k;return S==="this"||S==="."?k=g:S.startsWith("@root.")?k=l(b,S.slice(6)):k=l(g,S)??l(b,S),String(k??"")}),y=y.replace(/{{\s*([^}]+?)\s*}}/g,(N,j)=>{const S=String(j||"").trim();let k;return S==="this"||S==="."?k=g:S.startsWith("@root.")?k=l(b,S.slice(6)):k=l(g,S)??l(b,S),i(k)}),y}function u(x){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Payslip</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${x||""}</body>
</html>`}async function d(x){var b;const g=Array.from(((b=x==null?void 0:x.querySelectorAll)==null?void 0:b.call(x,"img"))||[]);g.length&&await Promise.all(g.map(y=>new Promise(N=>{if(y.complete)return N();const j=()=>N();y.addEventListener("load",j,{once:!0}),y.addEventListener("error",j,{once:!0})})))}const c=async()=>{var x,g;if(a!==null)return a;try{const b=await te.get("/admin/document-templates/PAYSLIP"),y=String(((g=(x=b.data)==null?void 0:x.item)==null?void 0:g.template_html)||"").trim();return n(y),y}catch{return n(""),""}},m=x=>{const g=String(s.logoUrl||"").trim(),b=g?`<img src="${g}" alt="${i(s.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"";return{company:{name:s.name||"OmniSuite Ltd",address:s.address||"123 Business Rd",logoUrl:g,logoHtml:b},payslip:{period:String(x.period||""),employee:String(x.employee||""),netPay:Number(x.netPay||0).toFixed(2),status:String(x.status||"")}}};async function h(x){var P;const g=await c(),b=g?o(g,m(x)):`<div>
  <div style="font-weight:800;font-size:18px;">Payslip</div>
  <div>Period: ${i(String(x.period||""))}</div>
  <div>Employee: ${i(String(x.employee||""))}</div>
  <div>Net Pay: ${i(Number(x.netPay||0).toFixed(2))}</div>
  <div>Status: ${i(String(x.status||""))}</div>
</div>`,y=u(b),N=document.createElement("iframe");N.style.position="fixed",N.style.right="0",N.style.bottom="0",N.style.width="0",N.style.height="0",N.style.border="0",document.body.appendChild(N);const j=((P=N.contentWindow)==null?void 0:P.document)||N.contentDocument||null;if(!j){document.body.removeChild(N);return}j.open(),j.write(y),j.close();const S=N.contentWindow||window;setTimeout(()=>{S.focus();try{S.print()}catch{}setTimeout(()=>{document.body.removeChild(N)},100)},200)}async function f(x){const g=await c(),b=g?o(g,m(x)):`<div>
  <div style="font-weight:800;font-size:18px;">Payslip</div>
  <div>Period: ${i(String(x.period||""))}</div>
  <div>Employee: ${i(String(x.employee||""))}</div>
  <div>Net Pay: ${i(Number(x.netPay||0).toFixed(2))}</div>
  <div>Status: ${i(String(x.status||""))}</div>
</div>`,y=document.createElement("div");y.style.position="fixed",y.style.left="-10000px",y.style.top="0",y.style.width="794px",y.style.background="white",y.style.padding="32px",y.innerHTML=b,document.body.appendChild(y);try{await d(y);const N=await Wn(y,{scale:2,useCORS:!0}),j=N.toDataURL("image/png"),S=new As("p","mm","a4"),k=S.internal.pageSize.getWidth(),P=S.internal.pageSize.getHeight(),I=k,B=N.height*I/N.width;let q=0;for(;q<B;)S.addImage(j,"PNG",0,-q,I,B),q+=P,q<B&&S.addPage();const Q="Payslip_"+(String(x.period||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";S.save(Q)}finally{document.body.removeChild(y)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Payslips"}),e.jsx("p",{className:"text-sm mt-1",children:"Payslip configuration (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/payslips/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Period"}),e.jsx("th",{children:"Employee"}),e.jsx("th",{className:"text-right",children:"Net Pay"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(x=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:x.period}),e.jsx("td",{children:x.employee}),e.jsx("td",{className:"text-right",children:Number(x.netPay).toFixed(2)}),e.jsx("td",{children:x.status}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/human-resources/payslips/${x.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/human-resources/payslips/${x.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"}),e.jsx("button",{type:"button",className:"ml-2 inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",onClick:()=>h(x),children:"Print"}),e.jsx("button",{type:"button",className:"ml-1 inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",onClick:()=>f(x),children:"PDF"})]})]},x.id))})]})})})]})}function nc(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function qc(t,s){const r=String(s||"").trim().replace(/^\./,"");if(!r)return;const a=r.split(".").filter(Boolean);let n=t;for(const i of a){if(n==null)return;n=n[i]}return n}function Ey(t,s,r=s){let a=String(t??"");return a=a.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(n,i,l)=>{const o=String(i||"").trim(),u=o.startsWith("@root.")?qc(r,o.slice(6)):qc(s,o)??qc(r,o);return(Array.isArray(u)?u:[]).map(c=>Ey(l,c??{},r)).join("")}),a=a.replace(/{{{\s*([^}]+?)\s*}}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=qc(r,l.slice(6)):o=qc(s,l)??qc(r,l),String(o??"")}),a=a.replace(/{{\s*([^}]+?)\s*}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=qc(r,l.slice(6)):o=qc(s,l)??qc(r,l),nc(o)}),a}function eZ(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Payslip</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}async function tZ(t){var r;const s=Array.from(((r=t==null?void 0:t.querySelectorAll)==null?void 0:r.call(t,"img"))||[]);s.length!==0&&await Promise.race([Promise.all(s.map(a=>new Promise(n=>{if(a.complete)return n();const i=()=>n();a.addEventListener("load",i,{once:!0}),a.addEventListener("error",i,{once:!0})}))),new Promise(a=>setTimeout(a,1500))])}function gS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({period:"",employee:"",netPay:0,status:"GENERATED"}),[o,u]=v.useState(null),[d,c]=v.useState({name:"",address:"",logoUrl:""});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({period:"2025-01",employee:"John Doe",netPay:2500,status:"GENERATED"}),n(!1)},150))},[r]),v.useEffect(()=>{let y=!0;async function N(){var j,S,k;try{const I=(S=(j=(await te.get("/admin/me")).data)==null?void 0:j.scope)==null?void 0:S.companyId;if(!I)return;const q=((k=(await te.get(`/admin/companies/${I}`)).data)==null?void 0:k.item)||{},Q=q.has_logo===1||q.has_logo===!0?`/api/admin/companies/${I}/logo`:"";if(!y)return;c({name:String(q.name||""),address:String(q.address||""),logoUrl:String(Q||"")})}catch{}}return N(),()=>{y=!1}},[]);const m=v.useMemo(()=>{const y=String(d.logoUrl||"").trim(),N=y?`<img src="${y}" alt="${nc(d.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"";return{company:{name:d.name||"OmniSuite Ltd",address:d.address||"123 Business Rd",logoUrl:y,logoHtml:N},payslip:{period:String(i.period||""),employee:String(i.employee||""),netPay:Number(i.netPay||0).toFixed(2),status:String(i.status||"")}}},[i,d]);function h(y,N){l(j=>({...j,[y]:N}))}const f=async()=>{var y,N;if(o!==null)return o;try{const j=await te.get("/admin/document-templates/PAYSLIP"),S=String(((N=(y=j.data)==null?void 0:y.item)==null?void 0:N.template_html)||"").trim();return u(S),S}catch{return u(""),""}};async function x(){var B;const y=await f(),N=y?Ey(y,m):`<div>
  <div style="font-weight:800;font-size:18px;">Payslip</div>
  <div>Period: ${nc(m.payslip.period)}</div>
  <div>Employee: ${nc(m.payslip.employee)}</div>
  <div>Net Pay: ${nc(m.payslip.netPay)}</div>
  <div>Status: ${nc(m.payslip.status)}</div>
</div>`,j=eZ(N),S=document.createElement("iframe");S.style.position="fixed",S.style.right="0",S.style.bottom="0",S.style.width="0",S.style.height="0",S.style.border="0",document.body.appendChild(S);const k=((B=S.contentWindow)==null?void 0:B.document)||S.contentDocument||null;if(!k){document.body.removeChild(S);return}k.open(),k.write(j),k.close();const P=S.contentWindow||window;setTimeout(()=>{P.focus();try{P.print()}catch{}setTimeout(()=>{document.body.removeChild(S)},100)},200)}async function g(){const y=await f(),N=y?Ey(y,m):`<div>
  <div style="font-weight:800;font-size:18px;">Payslip</div>
  <div>Period: ${nc(m.payslip.period)}</div>
  <div>Employee: ${nc(m.payslip.employee)}</div>
  <div>Net Pay: ${nc(m.payslip.netPay)}</div>
  <div>Status: ${nc(m.payslip.status)}</div>
</div>`,j=document.createElement("div");j.style.position="fixed",j.style.left="-10000px",j.style.top="0",j.style.width="794px",j.style.background="white",j.style.padding="32px",j.innerHTML=N,document.body.appendChild(j);try{await tZ(j);const S=await Wn(j,{scale:2,useCORS:!0}),k=S.toDataURL("image/png"),P=new As("p","mm","a4"),I=P.internal.pageSize.getWidth(),B=P.internal.pageSize.getHeight(),q=I,Q=S.height*q/S.width;let O=0;for(;O<Q;)P.addImage(k,"PNG",0,-O,q,Q),O+=B,O<Q&&P.addPage();const T="Payslip_"+(m.payslip.period||new Date().toISOString().slice(0,10))+".pdf";P.save(T)}finally{document.body.removeChild(j)}}async function b(y){y.preventDefault(),n(!0);try{t("/human-resources/payslips")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Payslip":"New Payslip"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:x,children:"Print"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:g,children:"Download PDF"}),e.jsx(Ee,{to:"/human-resources/payslips",className:"btn-success",children:"Back"})]})]})}),e.jsx("form",{onSubmit:b,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Period *"}),e.jsx("input",{className:"input",value:i.period,onChange:y=>h("period",y.target.value),required:!0,placeholder:"YYYY-MM"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsx("input",{className:"input",value:i.employee,onChange:y=>h("employee",y.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Net Pay"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.netPay,onChange:y=>h("netPay",Number(y.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.status,onChange:y=>h("status",y.target.value),children:[e.jsx("option",{value:"GENERATED",children:"Generated"}),e.jsx("option",{value:"PAID",children:"Paid"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/payslips",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function sZ(){const t=[{id:1,employee:"John Doe",effectiveDate:"2025-01-01",from:"Junior",to:"Senior"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Promotions"}),e.jsx("p",{className:"text-sm mt-1",children:"Track employee promotions (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/promotions/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Effective Date"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.employee}),e.jsx("td",{children:new Date(s.effectiveDate).toLocaleDateString()}),e.jsx("td",{children:s.from}),e.jsx("td",{children:s.to}),e.jsx("td",{children:e.jsx(Ee,{to:`/human-resources/promotions/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function vS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({employee:"",effectiveDate:new Date().toISOString().split("T")[0],from:"",to:""});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({employee:"John Doe",effectiveDate:"2025-01-01",from:"Junior",to:"Senior"}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/promotions")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Promotion":"New Promotion"})}),e.jsx(Ee,{to:"/human-resources/promotions",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsx("input",{className:"input",value:i.employee,onChange:d=>o("employee",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective Date"}),e.jsx("input",{className:"input",type:"date",value:i.effectiveDate,onChange:d=>o("effectiveDate",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",value:i.from,onChange:d=>o("from",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",value:i.to,onChange:d=>o("to",d.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/promotions",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function rZ(){const t=[{id:1,provider:"Omni Health",policyName:"Standard Plan",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Medical Policies"}),e.jsx("p",{className:"text-sm mt-1",children:"Employee medical policy setup (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/human-resources/medical-policies/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Provider"}),e.jsx("th",{children:"Policy"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.provider}),e.jsx("td",{children:s.policyName}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/human-resources/medical-policies/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/human-resources/medical-policies/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function bS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({provider:"",policyName:"",active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({provider:"Omni Health",policyName:"Standard Plan",active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/medical-policies")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Medical Policy":"New Medical Policy"})}),e.jsx(Ee,{to:"/human-resources/medical-policies",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Provider *"}),e.jsx("input",{className:"input",value:i.provider,onChange:d=>o("provider",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Policy Name *"}),e.jsx("input",{className:"input",value:i.policyName,onChange:d=>o("policyName",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/human-resources/medical-policies",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function aZ(){const t=[{title:"Attendance Summary",description:"Attendance by date range (placeholder)"},{title:"Payroll Summary",description:"Gross vs deductions (placeholder)"},{title:"Leave Balances",description:"Remaining leave by employee (placeholder)"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"HR Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Attendance, payroll, and leave reports"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function nZ(){const[t,s]=Os.useState([{icon:"",value:"142",label:"Active Employees",change:"5 new this month",changeType:"positive",path:"/human-resources/employees"},{icon:"",value:"8",label:"On Leave",change:"Today",changeType:"neutral",path:"/human-resources/leave-setup"},{icon:"",value:"Pending",label:"Payroll Status",change:"Due in 3 days",changeType:"negative",path:"/human-resources/payslips"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.hr)==null?void 0:o.employees)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.hr)==null?void 0:c.on_leave)||0),y=String(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.hr)==null?void 0:f.payroll_status)||"").trim();a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:y||j[2].value},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Employee Management",features:[{name:"Employee Setup",path:"/human-resources/employees",description:"Manage employee records and information",icon:""},{name:"Promotions",path:"/human-resources/promotions",description:"Record employee promotions and salary changes",icon:""}]},{title:"Leave & Attendance",features:[{name:"Leave Setup",path:"/human-resources/leave-setup",description:"Configure leave types and employee leave balances",icon:""},{name:"Shift Management",path:"/human-resources/shifts",description:"Setup and manage work shifts",icon:""},{name:"Attendance",path:"/human-resources/attendance",description:"Track employee attendance and check-ins",icon:""}]},{title:"Payroll & Compensation",features:[{name:"Salary Configuration",path:"/human-resources/salary-config",description:"Setup salary components and structures",icon:""},{name:"Tax & Deductions",path:"/human-resources/tax-config",description:"Configure income tax, tier 3, and social security",icon:""},{name:"Employee Allowances",path:"/human-resources/allowances",description:"Manage employee allowances and benefits",icon:""},{name:"Employee Loans",path:"/human-resources/loans",description:"Track and manage employee loans",icon:""},{name:"Payslips",path:"/human-resources/payslips",description:"Generate and manage employee payslips",icon:""}]},{title:"Policies & Reports",features:[{name:"Medical Policies",path:"/human-resources/medical-policies",description:"Setup employee medical insurance policies",icon:""},{name:"HR Reports",path:"/human-resources/reports",description:"View attendance, payroll, and leave reports",icon:""}]}];return e.jsx(To,{title:"Human Resources",description:"Employee management and payroll processing",stats:t,sections:r})}function iZ(){return e.jsxs(_l,{children:[e.jsx(tt,{index:!0,element:e.jsx(nZ,{})}),e.jsx(tt,{path:"employees",element:e.jsx($J,{})}),e.jsx(tt,{path:"employees/new",element:e.jsx(dS,{})}),e.jsx(tt,{path:"employees/:id",element:e.jsx(dS,{})}),e.jsx(tt,{path:"leave-setup",element:e.jsx(WJ,{})}),e.jsx(tt,{path:"leave-setup/new",element:e.jsx(uS,{})}),e.jsx(tt,{path:"leave-setup/:id",element:e.jsx(uS,{})}),e.jsx(tt,{path:"shifts",element:e.jsx(GJ,{})}),e.jsx(tt,{path:"shifts/new",element:e.jsx(AS,{})}),e.jsx(tt,{path:"shifts/:id",element:e.jsx(AS,{})}),e.jsx(tt,{path:"attendance",element:e.jsx(KJ,{})}),e.jsx(tt,{path:"attendance/new",element:e.jsx(hS,{})}),e.jsx(tt,{path:"attendance/:id",element:e.jsx(hS,{})}),e.jsx(tt,{path:"salary-config",element:e.jsx(zJ,{})}),e.jsx(tt,{path:"salary-config/new",element:e.jsx(mS,{})}),e.jsx(tt,{path:"salary-config/:id",element:e.jsx(mS,{})}),e.jsx(tt,{path:"tax-config",element:e.jsx(YJ,{})}),e.jsx(tt,{path:"tax-config/new",element:e.jsx(fS,{})}),e.jsx(tt,{path:"tax-config/:id",element:e.jsx(fS,{})}),e.jsx(tt,{path:"allowances",element:e.jsx(XJ,{})}),e.jsx(tt,{path:"allowances/new",element:e.jsx(pS,{})}),e.jsx(tt,{path:"allowances/:id",element:e.jsx(pS,{})}),e.jsx(tt,{path:"loans",element:e.jsx(JJ,{})}),e.jsx(tt,{path:"loans/new",element:e.jsx(xS,{})}),e.jsx(tt,{path:"loans/:id",element:e.jsx(xS,{})}),e.jsx(tt,{path:"payslips",element:e.jsx(ZJ,{})}),e.jsx(tt,{path:"payslips/new",element:e.jsx(gS,{})}),e.jsx(tt,{path:"payslips/:id",element:e.jsx(gS,{})}),e.jsx(tt,{path:"promotions",element:e.jsx(sZ,{})}),e.jsx(tt,{path:"promotions/new",element:e.jsx(vS,{})}),e.jsx(tt,{path:"promotions/:id",element:e.jsx(vS,{})}),e.jsx(tt,{path:"medical-policies",element:e.jsx(rZ,{})}),e.jsx(tt,{path:"medical-policies/new",element:e.jsx(bS,{})}),e.jsx(tt,{path:"medical-policies/:id",element:e.jsx(bS,{})}),e.jsx(tt,{path:"reports",element:e.jsx(aZ,{})}),e.jsx(tt,{path:"*",element:e.jsx(Wc,{to:"/human-resources",replace:!0})})]})}function lZ(){const t=[{id:1,assetNo:"AST-001",name:"Generator",location:"Plant 1",status:"ACTIVE"},{id:2,assetNo:"AST-002",name:"Forklift",location:"Warehouse",status:"ACTIVE"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Assets"}),e.jsx("p",{className:"text-sm mt-1",children:"Register and manage maintainable assets"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/maintenance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/maintenance/assets/new",className:"btn-success",children:"+ New Asset"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Asset No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.assetNo}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.location}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/maintenance/assets/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/maintenance/assets/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function yS(){const t=Ns(),{id:s}=Ps(),r=!!s,{search:a}=Ba(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=v.useState(!1),[u,d]=v.useState({assetNo:"",name:"",location:"",status:"ACTIVE"});v.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({assetNo:"AST-001",name:"Generator",location:"Plant 1",status:"ACTIVE"}),o(!1)},150))},[r]);function c(h,f){d(x=>({...x,[h]:f}))}async function m(h){h.preventDefault(),o(!0);try{t("/maintenance/assets")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/maintenance/assets",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Assets"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Asset":r?"Edit Asset":"New Asset"})]}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Asset No"}),e.jsx("input",{className:"input",value:u.assetNo,onChange:h=>c("assetNo",h.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:u.name,onChange:h=>c("name",h.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("input",{className:"input",value:u.location,onChange:h=>c("location",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.status,onChange:h=>c("status",h.target.value),children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/maintenance/assets",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function oZ(){const t=[{id:1,woNo:"MWO-0001",asset:"AST-001 Generator",priority:"HIGH",status:"OPEN"},{id:2,woNo:"MWO-0002",asset:"AST-002 Forklift",priority:"MEDIUM",status:"IN_PROGRESS"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/maintenance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Maintenance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Maintenance Work Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Corrective and preventive maintenance execution"})]}),e.jsx(Ee,{to:"/maintenance/work-orders/new",className:"btn-success",children:"+ New Work Order"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"WO No"}),e.jsx("th",{children:"Asset"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.woNo}),e.jsx("td",{children:s.asset}),e.jsx("td",{children:s.priority}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/maintenance/work-orders/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/maintenance/work-orders/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function jS(){const t=Ns(),{id:s}=Ps(),r=!!s,{search:a}=Ba(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState({woNo:"",assetNo:"AST-001",description:"",priority:"MEDIUM",status:"OPEN"});v.useEffect(()=>{r&&h()},[s]);async function h(){var g,b,y;try{o(!0),d("");const N=await te.get(`/maintenance/work-orders/${s}`);(g=N.data)!=null&&g.item&&m(N.data.item)}catch(N){d(((y=(b=N==null?void 0:N.response)==null?void 0:b.data)==null?void 0:y.message)||"Error fetching work order")}finally{o(!1)}}function f(g,b){m(y=>({...y,[g]:b}))}async function x(g){var b,y;g.preventDefault(),o(!0),d("");try{r?await te.put(`/maintenance/work-orders/${s}`,c):await te.post("/maintenance/work-orders",c),t("/maintenance/work-orders")}catch(N){d(((y=(b=N==null?void 0:N.response)==null?void 0:b.data)==null?void 0:y.message)||"Error saving work order")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/maintenance/work-orders",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Work Orders"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Work Order":r?"Edit Work Order":"New Work Order"})]}),e.jsx("form",{onSubmit:x,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[u&&e.jsx("div",{className:"alert alert-error mb-4",children:u}),e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"WO No"}),e.jsx("input",{className:"input",value:c.woNo,onChange:g=>f("woNo",g.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Asset No"}),e.jsx("input",{className:"input",value:c.assetNo,onChange:g=>f("assetNo",g.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:c.description,onChange:g=>f("description",g.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Priority"}),e.jsxs("select",{className:"input",value:c.priority,onChange:g=>f("priority",g.target.value),children:[e.jsx("option",{value:"LOW",children:"Low"}),e.jsx("option",{value:"MEDIUM",children:"Medium"}),e.jsx("option",{value:"HIGH",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:c.status,onChange:g=>f("status",g.target.value),children:[e.jsx("option",{value:"OPEN",children:"Open"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"DONE",children:"Done"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/maintenance/work-orders",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function cZ(){const t=[{id:1,code:"PM-001",asset:"AST-001 Generator",frequency:"MONTHLY",active:!0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Preventive Maintenance Schedules"}),e.jsx("p",{className:"text-sm mt-1",children:"Define PM frequency and tasks"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/maintenance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/maintenance/pm-schedules/new",className:"btn-success",children:"+ New Schedule"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Asset"}),e.jsx("th",{children:"Frequency"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.asset}),e.jsx("td",{children:s.frequency}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/maintenance/pm-schedules/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/maintenance/pm-schedules/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function NS(){const t=Ns(),{id:s}=Ps(),r=!!s,{search:a}=Ba(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=v.useState(!1),[u,d]=v.useState({code:"",assetNo:"AST-001",frequency:"MONTHLY",active:!0});v.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({code:"PM-001",assetNo:"AST-001",frequency:"MONTHLY",active:!0}),o(!1)},150))},[r]);function c(h,f){d(x=>({...x,[h]:f}))}async function m(h){h.preventDefault(),o(!0);try{t("/maintenance/pm-schedules")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/maintenance/pm-schedules",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to PM Schedules"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Schedule":r?"Edit Schedule":"New Schedule"})]}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code"}),e.jsx("input",{className:"input",value:u.code,onChange:h=>c("code",h.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Asset No"}),e.jsx("input",{className:"input",value:u.assetNo,onChange:h=>c("assetNo",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Frequency"}),e.jsxs("select",{className:"input",value:u.frequency,onChange:h=>c("frequency",h.target.value),children:[e.jsx("option",{value:"DAILY",children:"Daily"}),e.jsx("option",{value:"WEEKLY",children:"Weekly"}),e.jsx("option",{value:"MONTHLY",children:"Monthly"}),e.jsx("option",{value:"QUARTERLY",children:"Quarterly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.active?"1":"0",onChange:h=>c("active",h.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/maintenance/pm-schedules",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function dZ(){const t=[{title:"Work Order Aging",description:"Open work orders by age (placeholder)"},{title:"Asset Downtime",description:"Downtime by asset (placeholder)"},{title:"Preventive Compliance",description:"PM schedules completed vs due (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/maintenance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Maintenance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Maintenance Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Asset and maintenance KPIs"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function uZ(){const[t,s]=Os.useState([{icon:"",value:"8",label:"Open Work Orders",change:"2 critical",changeType:"negative",path:"/maintenance/work-orders"},{icon:"",value:"4",label:"Overdue PMs",change:"Needs attention",changeType:"negative",path:"/maintenance/pm-schedules"},{icon:"",value:"98%",label:"Asset Health",change:" 1% this month",changeType:"positive",path:"/maintenance/assets"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.maintenance)==null?void 0:o.open_work_orders)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.maintenance)==null?void 0:c.overdue_pms)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.maintenance)==null?void 0:f.asset_health_percent)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:`${y}%`},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Master Data",features:[{name:"Assets",path:"/maintenance/assets",description:"Register and manage assets",icon:""},{name:"New Asset",path:"/maintenance/assets/new",description:"Add an asset",icon:""}]},{title:"Execution",features:[{name:"Work Orders",path:"/maintenance/work-orders",description:"Corrective and preventive work orders",icon:""},{name:"New Work Order",path:"/maintenance/work-orders/new",description:"Create a maintenance work order",icon:""}]},{title:"Preventive Maintenance",features:[{name:"PM Schedules",path:"/maintenance/pm-schedules",description:"Define preventive schedules",icon:""},{name:"New Schedule",path:"/maintenance/pm-schedules/new",description:"Create a new PM schedule",icon:""}]},{title:"Reports",features:[{name:"Maintenance Reports",path:"/maintenance/reports",description:"Asset and maintenance KPIs",icon:""}]}];return e.jsx(To,{title:"Maintenance",description:"Asset maintenance and work order management",stats:t,sections:r})}function AZ(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(uZ,{})}),e.jsx(tt,{path:"/assets",element:e.jsx(lZ,{})}),e.jsx(tt,{path:"/assets/new",element:e.jsx(yS,{})}),e.jsx(tt,{path:"/assets/:id",element:e.jsx(yS,{})}),e.jsx(tt,{path:"/work-orders",element:e.jsx(oZ,{})}),e.jsx(tt,{path:"/work-orders/new",element:e.jsx(jS,{})}),e.jsx(tt,{path:"/work-orders/:id",element:e.jsx(jS,{})}),e.jsx(tt,{path:"/pm-schedules",element:e.jsx(cZ,{})}),e.jsx(tt,{path:"/pm-schedules/new",element:e.jsx(NS,{})}),e.jsx(tt,{path:"/pm-schedules/:id",element:e.jsx(NS,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(dZ,{})})]})}function hZ(){const t=[{id:1,code:"PRJ-001",name:"ERP Rollout",status:"IN_PROGRESS",budget:5e4},{id:2,code:"PRJ-002",name:"Warehouse Upgrade",status:"PLANNED",budget:2e4}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Projects"}),e.jsx("p",{className:"text-sm mt-1",children:"Project portfolio"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/project-management",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/project-management/projects/new",className:"btn-success",children:"+ New Project"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Budget"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.status}),e.jsx("td",{className:"text-right",children:Number(s.budget).toFixed(2)}),e.jsx("td",{children:e.jsx(Ee,{to:`/project-management/projects/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function wS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({code:"",name:"",status:"PLANNED",budget:0,startDate:"",endDate:""});v.useEffect(()=>{r&&d()},[s]);async function d(){var h,f,x;try{n(!0),l("");const g=await te.get(`/projects/projects/${s}`);(h=g.data)!=null&&h.item&&u(g.data.item)}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error fetching project")}finally{n(!1)}}function c(h,f){u(x=>({...x,[h]:f}))}async function m(h){var f,x;h.preventDefault(),n(!0),l("");try{r?await te.put(`/projects/projects/${s}`,o):await te.post("/projects/projects",o),t("/project-management/projects")}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error saving project")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/project-management/projects",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Projects"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:r?"Edit Project":"New Project"})]}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code"}),e.jsx("input",{className:"input",value:o.code,onChange:h=>c("code",h.target.value),placeholder:"Auto"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:o.name,onChange:h=>c("name",h.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status,onChange:h=>c("status",h.target.value),children:[e.jsx("option",{value:"PLANNED",children:"Planned"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"ON_HOLD",children:"On Hold"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Budget"}),e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:o.budget,onChange:h=>c("budget",Number(h.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date"}),e.jsx("input",{className:"input",type:"date",value:o.startDate,onChange:h=>c("startDate",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date"}),e.jsx("input",{className:"input",type:"date",value:o.endDate,onChange:h=>c("endDate",h.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/project-management/projects",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function mZ(){const t=[{id:1,project:"PRJ-001",title:"Define chart of accounts",assignee:"Finance Team",due:"2025-02-15",status:"IN_PROGRESS"},{id:2,project:"PRJ-001",title:"Migrate opening balances",assignee:"Finance Team",due:"2025-02-28",status:"PLANNED"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Tasks"}),e.jsx("p",{className:"text-sm mt-1",children:"Task tracking across projects"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/project-management",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/project-management/tasks/new",className:"btn-success",children:"+ New Task"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Project"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Assignee"}),e.jsx("th",{children:"Due"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.project}),e.jsx("td",{className:"font-medium",children:s.title}),e.jsx("td",{children:s.assignee}),e.jsx("td",{children:new Date(s.due).toLocaleDateString()}),e.jsx("td",{children:s.status}),e.jsx("td",{children:e.jsx(Ee,{to:`/project-management/tasks/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function _S(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState(""),[o,u]=v.useState({projectCode:"PRJ-001",title:"",assignee:"",due:"",status:"PLANNED"});v.useEffect(()=>{r&&d()},[s]);async function d(){var h,f,x;try{n(!0),l("");const g=await te.get(`/projects/tasks/${s}`);(h=g.data)!=null&&h.item&&u(g.data.item)}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error fetching task")}finally{n(!1)}}function c(h,f){u(x=>({...x,[h]:f}))}async function m(h){var f,x;h.preventDefault(),n(!0),l("");try{r?await te.put(`/projects/tasks/${s}`,o):await te.post("/projects/tasks",o),t("/project-management/tasks")}catch(g){l(((x=(f=g==null?void 0:g.response)==null?void 0:f.data)==null?void 0:x.message)||"Error saving task")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/project-management/tasks",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Tasks"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:r?"Edit Task":"New Task"})]}),e.jsx("form",{onSubmit:m,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Project"}),e.jsx("input",{className:"input",value:o.projectCode,onChange:h=>c("projectCode",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assignee"}),e.jsx("input",{className:"input",value:o.assignee,onChange:h=>c("assignee",h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Title *"}),e.jsx("input",{className:"input",value:o.title,onChange:h=>c("title",h.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{className:"input",type:"date",value:o.due,onChange:h=>c("due",h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status,onChange:h=>c("status",h.target.value),children:[e.jsx("option",{value:"PLANNED",children:"Planned"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"DONE",children:"Done"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/project-management/tasks",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function fZ(){const t=[{title:"Project Status Summary",description:"Planned vs in-progress vs completed (placeholder)"},{title:"Task Due Report",description:"Tasks due by date range (placeholder)"},{title:"Budget vs Actual",description:"Budget utilization (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/project-management",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Project Management"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Project Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Portfolio KPIs and reporting"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function pZ(){const[t,s]=Os.useState([{icon:"",value:"8",label:"Active Projects",change:"2 due this week",changeType:"neutral",path:"/project-management/projects"},{icon:"",value:"34",label:"Open Tasks",change:"12 high priority",changeType:"negative",path:"/project-management/tasks"},{icon:"",value:"92%",label:"On Time Completion",change:" 3% this month",changeType:"positive",path:"/project-management/reports"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.projects)==null?void 0:o.active_projects)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.projects)==null?void 0:c.open_tasks)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.projects)==null?void 0:f.on_time_percent)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:`${y}%`},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Portfolio",badge:"Planning",items:[{title:"Projects",path:"/project-management/projects",description:"Create and manage projects",icon:"",actions:[{label:"View Projects",path:"/project-management/projects",type:"outline"},{label:"New Project",path:"/project-management/projects/new",type:"primary"}]}]},{title:"Execution",badge:"Tracking",items:[{title:"Tasks",path:"/project-management/tasks",description:"Assign and track tasks",icon:"",actions:[{label:"View Tasks",path:"/project-management/tasks",type:"outline"},{label:"New Task",path:"/project-management/tasks/new",type:"primary"}]}]},{title:"Reports",items:[{title:"Project Reports",path:"/project-management/reports",description:"Project KPIs and status reporting",icon:"",actions:[{label:"View Reports",path:"/project-management/reports",type:"primary"}]}]}];return e.jsx(To,{title:"Project Management",description:"Project planning, tracking, and resource allocation",stats:t,sections:r})}function xZ(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(pZ,{})}),e.jsx(tt,{path:"/projects",element:e.jsx(hZ,{})}),e.jsx(tt,{path:"/projects/new",element:e.jsx(wS,{})}),e.jsx(tt,{path:"/projects/:id",element:e.jsx(wS,{})}),e.jsx(tt,{path:"/tasks",element:e.jsx(mZ,{})}),e.jsx(tt,{path:"/tasks/new",element:e.jsx(_S,{})}),e.jsx(tt,{path:"/tasks/:id",element:e.jsx(_S,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(fZ,{})})]})}function gZ(){const t=[{id:1,code:"BOM-001",product:"Finished Good A",version:"v1",active:!0},{id:2,code:"BOM-002",product:"Finished Good B",version:"v1",active:!0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Bills of Materials (BOM)"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage BOM definitions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/production",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/production/bom/new",className:"btn-success",children:"+ New BOM"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Version"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.product}),e.jsx("td",{children:s.version}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/production/bom/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/production/bom/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function SS(){const t=Ns(),{id:s}=Ps(),r=!!s,{search:a}=Ba(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=v.useState(!1),[u,d]=v.useState({code:"",product:"",version:"v1",active:!0,lines:[{component:"",qty:1}]});v.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({code:"BOM-001",product:"Finished Good A",version:"v1",active:!0,lines:[{component:"Raw Material X",qty:2}]}),o(!1)},150))},[r]);function c(g,b){d(y=>({...y,[g]:b}))}function m(g,b,y){d(N=>{const j=[...N.lines];return j[g]={...j[g],[b]:y},{...N,lines:j}})}function h(){d(g=>({...g,lines:[...g.lines,{component:"",qty:1}]}))}function f(g){d(b=>({...b,lines:b.lines.filter((y,N)=>N!==g)}))}async function x(g){g.preventDefault(),o(!0);try{t("/production/bom")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/production/bom",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to BOM"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View BOM":r?"Edit BOM":"New BOM"})]}),e.jsx("form",{onSubmit:x,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("fieldset",{disabled:i,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code"}),e.jsx("input",{className:"input",value:u.code,onChange:g=>c("code",g.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Product *"}),e.jsx("input",{className:"input",value:u.product,onChange:g=>c("product",g.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Version"}),e.jsx("input",{className:"input",value:u.version,onChange:g=>c("version",g.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.active?"1":"0",onChange:g=>c("active",g.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Components"}),e.jsx("button",{type:"button",className:"btn-success",onClick:h,disabled:i,children:"+ Add"})]}),e.jsx("div",{className:"space-y-2",children:u.lines.map((g,b)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2",children:[e.jsx("div",{className:"md:col-span-8",children:e.jsx("input",{className:"input",placeholder:"Component",value:g.component,onChange:y=>m(b,"component",y.target.value)})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",placeholder:"Qty",value:g.qty,onChange:y=>m(b,"qty",Number(y.target.value))})}),e.jsx("div",{className:"md:col-span-1 flex md:justify-end",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>f(b),disabled:i||u.lines.length<=1,children:""})})]},b))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/production/bom",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function vZ(){const t=[{id:1,woNo:"WO-0001",product:"Finished Good A",qty:10,status:"PLANNED"},{id:2,woNo:"WO-0002",product:"Finished Good B",qty:5,status:"RELEASED"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Work Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Production order tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/production",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/production/work-orders/new",className:"btn-success",children:"+ New Work Order"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"WO No"}),e.jsx("th",{children:"Product"}),e.jsx("th",{className:"text-right",children:"Qty"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.woNo}),e.jsx("td",{children:s.product}),e.jsx("td",{className:"text-right",children:Number(s.qty).toFixed(2)}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/production/work-orders/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/production/work-orders/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function CS(){const t=Ns(),{id:s}=Ps(),r=!!s,{search:a}=Ba(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=v.useState(!1),[u,d]=v.useState(""),[c,m]=v.useState({woNo:"",product:"",qty:0,status:"PLANNED"});v.useEffect(()=>{r&&h()},[s]);async function h(){var g,b,y;try{o(!0),d("");const N=await te.get(`/production/work-orders/${s}`);(g=N.data)!=null&&g.item&&m(N.data.item)}catch(N){d(((y=(b=N==null?void 0:N.response)==null?void 0:b.data)==null?void 0:y.message)||"Error fetching work order")}finally{o(!1)}}function f(g,b){m(y=>({...y,[g]:b}))}async function x(g){var b,y;g.preventDefault(),o(!0),d("");try{r?await te.put(`/production/work-orders/${s}`,c):await te.post("/production/work-orders",c),t("/production/work-orders")}catch(N){d(((y=(b=N==null?void 0:N.response)==null?void 0:b.data)==null?void 0:y.message)||"Error saving work order")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/production/work-orders",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Work Orders"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Work Order":r?"Edit Work Order":"New Work Order"})]}),e.jsx("form",{onSubmit:x,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[u&&e.jsx("div",{className:"alert alert-error mb-4",children:u}),e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"WO No"}),e.jsx("input",{className:"input",value:c.woNo,onChange:g=>f("woNo",g.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Product *"}),e.jsx("input",{className:"input",value:c.product,onChange:g=>f("product",g.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Qty"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:c.qty,onChange:g=>f("qty",Number(g.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:c.status,onChange:g=>f("status",g.target.value),children:[e.jsx("option",{value:"PLANNED",children:"Planned"}),e.jsx("option",{value:"RELEASED",children:"Released"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/production/work-orders",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function bZ(){const t=[{title:"Work Order Status",description:"Planned vs Released vs Completed (placeholder)"},{title:"BOM Usage",description:"Component usage by BOM (placeholder)"},{title:"Production Output",description:"Output by date range (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/production",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Production"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Production Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Manufacturing analytics and reports"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function yZ(){const[t,s]=Os.useState([{icon:"",value:"12",label:"Active Work Orders",change:"3 due today",changeType:"neutral",path:"/production/work-orders"},{icon:"",value:"94%",label:"Efficiency",change:" 2% this week",changeType:"positive",path:"/production/reports"},{icon:"",value:"45",label:"Active BOMs",change:"5 new this month",changeType:"neutral",path:"/production/bom"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.production)==null?void 0:o.active_work_orders)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.production)==null?void 0:c.efficiency_percent)||0),y=Number(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.production)==null?void 0:f.active_boms)||0);a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:`${b}%`},j[2]={...j[2],value:String(y)},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Master Data",features:[{name:"Bills of Materials",path:"/production/bom",description:"Define BOMs and components",icon:""},{name:"New BOM",path:"/production/bom/new",description:"Create a new BOM",icon:""}]},{title:"Execution",features:[{name:"Work Orders",path:"/production/work-orders",description:"Create and track work orders",icon:""},{name:"New Work Order",path:"/production/work-orders/new",description:"Start a work order",icon:""}]},{title:"Reports",features:[{name:"Production Reports",path:"/production/reports",description:"Manufacturing analytics",icon:""}]}];return e.jsx(To,{title:"Production",description:"Manufacturing and production planning",stats:t,sections:r})}function jZ(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(yZ,{})}),e.jsx(tt,{path:"/bom",element:e.jsx(gZ,{})}),e.jsx(tt,{path:"/bom/new",element:e.jsx(SS,{})}),e.jsx(tt,{path:"/bom/:id",element:e.jsx(SS,{})}),e.jsx(tt,{path:"/work-orders",element:e.jsx(vZ,{})}),e.jsx(tt,{path:"/work-orders/new",element:e.jsx(CS,{})}),e.jsx(tt,{path:"/work-orders/:id",element:e.jsx(CS,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(bZ,{})})]})}function NZ(){const t=[{title:"Daily Sales Summary",description:"Total sales by date (placeholder)"},{title:"Payment Method Breakdown",description:"Cash/Card/Mobile totals (placeholder)"},{title:"Top Selling Items",description:"Best performing items (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Sales analytics and end-of-day reporting"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}const BS="pos_payment_settings",kS="pos_general_settings",wZ=({active:t,onClick:s,children:r})=>e.jsx("button",{type:"button",onClick:s,className:`px-4 py-2 rounded-md border ${t?"bg-slate-100 border-slate-300 text-slate-900":"bg-white border-slate-200 text-slate-600"}`,children:r});function _Z({emoji:t,title:s,subtitle:r}){return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:[t," ",s]}),r?e.jsx("p",{className:"text-sm mt-1",children:r}):null]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Ee,{to:"/pos",className:"btn btn-secondary",children:"Return to Menu"})})]})}function Uk({title:t,children:s}){return e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:t}),e.jsx("div",{className:"text-blue-800",children:s})]})}function ES({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function SZ(){const{scope:t}=Qa(),[s,r]=v.useState([]),[a,n]=v.useState(!0),[i,l]=v.useState(!1),[o,u]=v.useState(-1),[d,c]=v.useState([]),[m,h]=v.useState(!1),[f,x]=v.useState(null),[g,b]=v.useState(!1),[y,N]=v.useState(!1),[j,S]=v.useState([]),[k,P]=v.useState([]),[I,B]=v.useState({}),[q,Q]=v.useState(""),[O,T]=v.useState({name:"",code:"AUTO",warehouse:"",ip_address:"",active:!0});function V(){const U=s.reduce((J,ae)=>{const Z=String(ae.code||"").match(/^T(\d{3})$/);if(!Z)return J;const oe=parseInt(Z[1],10);return Number.isFinite(oe)&&oe>J?oe:J},0)+1;return`T${String(U).padStart(3,"0")}`}function D(){n(!0),te.get("/pos/terminals").then(L=>{var J;const U=Array.isArray((J=L.data)==null?void 0:J.items)?L.data.items:[];r(U.map(ae=>({...ae,active:!!ae.is_active})))}).catch(()=>r([])).finally(()=>n(!1))}v.useEffect(()=>{D()},[]),v.useEffect(()=>{let L=!0;return te.get("/inventory/warehouses").then(U=>{var J;L&&c(Array.isArray((J=U.data)==null?void 0:J.items)?U.data.items:[])}).catch(()=>{L&&c([])}),()=>{L=!1}},[]);function Y(){u(-1),T({name:"",code:V(),warehouse:"",ip_address:"",active:!0}),l(!0)}function M(L){const U=s[L];u(L),T({name:(U==null?void 0:U.name)||"",code:(U==null?void 0:U.code)||"AUTO",warehouse:(U==null?void 0:U.warehouse)||"",ip_address:(U==null?void 0:U.ip_address)||"",active:!!(U!=null&&U.active)}),l(!0)}async function X(){var J,ae,Z,oe;const L=String(O.name||"").trim();let U=String(O.code||"").trim();if(!L){mt.warn("Provide terminal name");return}(!U||U==="AUTO")&&(U=V());try{if(o>=0){const ee=s[o];if(!ee||!ee.id){mt.error("Terminal id is missing");return}await te.put(`/pos/terminals/${ee.id}`,{code:U,name:L,warehouse:O.warehouse||null,counter_no:ee.counter_no||null,ip_address:O.ip_address||null,active:!!O.active})}else await te.post("/pos/terminals",{code:U,name:L,warehouse:O.warehouse||null,counter_no:null,ip_address:O.ip_address||null,active:!!O.active});l(!1),u(-1),D(),mt.success("Terminal saved")}catch(ee){const se=((ae=(J=ee==null?void 0:ee.response)==null?void 0:J.data)==null?void 0:ae.message)||((oe=(Z=ee==null?void 0:ee.response)==null?void 0:Z.data)==null?void 0:oe.error)||"Failed to save terminal";mt.error(se)}}async function R(L){var J,ae,Z,oe;const U=s[L];if(!U||!U.id){r(ee=>ee.filter((se,Ae)=>Ae!==L));return}try{await te.put(`/pos/terminals/${U.id}`,{code:U.code,name:U.name,warehouse:U.warehouse||null,counter_no:U.counter_no||null,ip_address:U.ip_address||null,active:!1}),D(),mt.success("Terminal deactivated")}catch(ee){const se=((ae=(J=ee==null?void 0:ee.response)==null?void 0:J.data)==null?void 0:ae.message)||((oe=(Z=ee==null?void 0:ee.response)==null?void 0:Z.data)==null?void 0:oe.error)||"Failed to deactivate terminal";mt.error(se)}}async function H(L){var ae,Z,oe,ee,se,Ae,we;const U=Number((t==null?void 0:t.companyId)||0)||void 0,J=Number((t==null?void 0:t.branchId)||0)||void 0;b(!0);try{const[ce,le]=await Promise.all([te.get("/admin/users",{params:{...U?{company_id:U}:{},...J?{branch_id:J}:{},active:1,limit:100}}),te.get("/pos/terminal-users",{params:{terminalId:L}})]),_e=Array.isArray((Z=(ae=ce.data)==null?void 0:ae.data)==null?void 0:Z.items)?ce.data.data.items:[],Qe=Array.isArray((oe=le.data)==null?void 0:oe.items)?le.data.items:[];S(_e),B(Qe.reduce((Ie,ke)=>{const pe=String(ke.user_id);return Ie[pe]=String(ke.username||pe),Ie},{})),P(Qe.map(Ie=>Number(Ie.user_id)).filter(Ie=>Number.isFinite(Ie)&&Ie>0).map(String)),Q("")}catch(ce){S([]),P([]),B({}),Q("");const le=((se=(ee=ce==null?void 0:ce.response)==null?void 0:ee.data)==null?void 0:se.message)||((we=(Ae=ce==null?void 0:ce.response)==null?void 0:Ae.data)==null?void 0:we.error)||"Failed to load users for terminal";mt.error(le)}finally{b(!1)}}function W(L){L!=null&&L.id&&(x(L),h(!0),Q(""),H(L.id))}async function K(){var Z,oe,ee,se;const L=f==null?void 0:f.id;if(!L)return;const U=String(q||"").trim(),J=U?[...k,U]:k,ae=Array.from(new Set(J)).map(Ae=>Number(Ae)).filter(Ae=>Number.isFinite(Ae)&&Ae>0);N(!0);try{await te.put("/pos/terminal-users",{terminalId:L,userIds:ae}),mt.success("Terminal users updated"),h(!1),x(null),P([]),Q("")}catch(Ae){const we=((oe=(Z=Ae==null?void 0:Ae.response)==null?void 0:Z.data)==null?void 0:oe.message)||((se=(ee=Ae==null?void 0:Ae.response)==null?void 0:ee.data)==null?void 0:se.error)||"Failed to update terminal users";mt.error(we)}finally{N(!1)}}const _=v.useMemo(()=>{const L=new Map;for(const U of j)U!=null&&U.id&&L.set(String(U.id),U);return L},[j]),F=v.useMemo(()=>new Set(k),[k]),E=v.useMemo(()=>j.filter(L=>(L==null?void 0:L.id)&&!F.has(String(L.id))),[j,F]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(Uk,{title:"About POS Terminals",children:"Configure and manage point-of-sale terminals. Each terminal represents a physical checkout counter or device in your store."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:Y,children:"+ Add Terminal"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:D,children:"Refresh"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-sm mb-3",children:"Manage register identifiers, warehouse/location binding, printer/IP, and activation status."}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Terminal Name"}),e.jsx("th",{children:"Terminal ID"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Receipt Printer"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading..."})}):s.length?s.map(L=>e.jsxs("tr",{children:[e.jsx("td",{children:L.name}),e.jsx("td",{children:L.code}),e.jsx("td",{children:L.warehouse||"-"}),e.jsx("td",{children:L.ip_address||"Not configured"}),e.jsx("td",{children:e.jsx("span",{className:L.active?"badge-success":"badge-secondary",children:L.active?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>M(s.indexOf(L)),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>W(L),children:"Users"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>R(s.indexOf(L)),children:"Delete"})]})})]},L.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:e.jsx("div",{className:"text-center text-slate-600 py-4",children:"No terminals found"})})})})]})})]})}),i?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-brand text-white",children:e.jsx("div",{className:"text-lg font-bold",children:o>=0?"Edit Terminal":"Add Terminal"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal Name"}),e.jsx("input",{className:"input",value:O.name,onChange:L=>T(U=>({...U,name:L.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal ID"}),e.jsx("input",{className:"input",value:O.code,onChange:L=>T(U=>({...U,code:L.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsx(ES,{value:O.warehouse,onChange:L=>T(U=>({...U,warehouse:L})),options:d.map(L=>{const U=`${L.warehouse_code?`${L.warehouse_code} - `:""}${L.warehouse_name||""}`;return{value:U,label:U}}),placeholder:"Select warehouse",filterPlaceholder:"Filter warehouses..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Printer / IP"}),e.jsx("input",{className:"input",value:O.ip_address,onChange:L=>T(U=>({...U,ip_address:L.target.value})),placeholder:"Printer name or IP"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!O.active,onChange:L=>T(U=>({...U,active:L.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(!1),u(-1)},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:X,children:"Save"})]})]})]})}):null,m?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 bg-brand text-white",children:[e.jsx("div",{className:"text-lg font-bold",children:"Assign Users"}),e.jsxs("div",{className:"text-sm opacity-90",children:[f==null?void 0:f.name," (",f==null?void 0:f.code,")"]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[g?e.jsx("div",{className:"py-8 text-center text-slate-600",children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Add User"}),e.jsx(ES,{value:q,onChange:L=>Q(String(L)),options:E.map(L=>({value:String(L.id),label:String(L.username||"")})),placeholder:"Select user",filterPlaceholder:"Filter users..."})]}),e.jsx("button",{type:"button",className:"btn btn-secondary",disabled:!q||y,onClick:()=>{const L=String(q||"").trim();L&&(P(U=>U.includes(L)?U:[...U,L]),Q(""))},children:"Add"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Assigned Users"}),e.jsx("button",{type:"button",className:"btn btn-secondary",disabled:!k.length||y,onClick:()=>P([]),children:"Clear All"})]}),e.jsx("div",{className:"mt-2 overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase text-slate-600",children:"Username"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase text-slate-600",children:"Action"})]})}),e.jsx("tbody",{children:k.length?k.map(L=>{var J;const U=((J=_.get(String(L)))==null?void 0:J.username)||I[String(L)]||String(L);return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:U}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("button",{type:"button",className:"btn btn-danger",disabled:y,onClick:()=>P(ae=>ae.filter(Z=>Z!==String(L))),children:"Remove"})})]},L)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"2",className:"p-4 text-center text-slate-500",children:"No users assigned"})})})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",disabled:y,onClick:()=>{h(!1),x(null)},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:g||y,onClick:K,children:y?"Saving...":"Save"})]})]})]})}):null]})}function CZ(){const[t,s]=v.useState([]),[r,a]=v.useState(!0),[n,i]=v.useState(!1),[l,o]=v.useState(-1),[u,d]=v.useState([]),[c,m]=v.useState({name:"",type:"cash",account:"",requireReference:!1,active:!0}),[h,f]=v.useState(!0),[x,g]=v.useState(!0),[b,y]=v.useState(""),[N,j]=v.useState("10000"),[S,k]=v.useState(!0),[P,I]=v.useState(""),[B,q]=v.useState("2.5"),[Q,O]=v.useState(!0),T=v.useMemo(()=>{const H=new Map;for(const W of u){if(!W||W.id===void 0||W.id===null)continue;const K=String(W.id),_=String(W.name||"").trim();H.set(K,_||K)}return H},[u]);function V(){a(!0),te.get("/pos/payment-modes").then(H=>{var _;const K=(Array.isArray((_=H.data)==null?void 0:_.items)?H.data.items:[]).map(F=>({id:F.id,name:F.name,type:F.type,account:F.account||"",requireReference:!!F.require_reference,active:!!F.is_active}));s(K)}).catch(()=>{s([])}).finally(()=>a(!1))}v.useEffect(()=>{V()},[]),v.useEffect(()=>{let H=!0;return te.get("/finance/accounts",{params:{postable:1,active:1}}).then(W=>{var _;if(!H)return;const K=Array.isArray((_=W.data)==null?void 0:_.items)?W.data.items:[];d(K)}).catch(()=>{H&&d([])}),()=>{H=!1}},[]),v.useEffect(()=>{try{const H=localStorage.getItem(BS);if(!H)return;const W=JSON.parse(H);if(!W||typeof W!="object")return;typeof W.cashEnabled=="boolean"&&f(W.cashEnabled),typeof W.cardEnabled=="boolean"&&g(W.cardEnabled),W.cashAccountId&&y(String(W.cashAccountId)),W.maxCashAmount!==void 0&&j(String(W.maxCashAmount)),typeof W.requireChangeCalc=="boolean"&&k(W.requireChangeCalc),W.cardBankAccountId&&I(String(W.cardBankAccountId)),W.cardProcessingFee!==void 0&&q(String(W.cardProcessingFee)),typeof W.requireCardLast4=="boolean"&&O(W.requireCardLast4)}catch{}},[]);function D(){o(-1),m({name:"",type:"cash",account:"",requireReference:!1,active:!0}),i(!0)}function Y(H){const W=t[H];o(H),m({name:(W==null?void 0:W.name)||"",type:(W==null?void 0:W.type)||"cash",account:(W==null?void 0:W.account)||"",requireReference:!!(W!=null&&W.requireReference),active:!!(W!=null&&W.active)}),i(!0)}async function M(H){var K,_,F,E;const W=t[H];if(!W||!W.id){s(L=>L.filter((U,J)=>J!==H));return}try{await te.put(`/pos/payment-modes/${W.id}`,{name:W.name,type:W.type,account:W.account||"",requireReference:W.requireReference||!1,active:!1}),V(),mt.success("Payment mode deactivated")}catch(L){const U=((_=(K=L==null?void 0:L.response)==null?void 0:K.data)==null?void 0:_.message)||((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.error)||"Failed to deactivate payment mode";mt.error(U)}}async function X(){var K,_,F,E;const H=String(c.name||"").trim(),W=String(c.type||"").trim();if(!H||!W){mt.warn("Provide payment name and type");return}try{if(l>=0){const L=t[l];if(!L||!L.id){mt.error("Payment mode id is missing");return}await te.put(`/pos/payment-modes/${L.id}`,{name:H,type:W,account:c.account||"",requireReference:!!c.requireReference,active:!!c.active})}else await te.post("/pos/payment-modes",{name:H,type:W,account:c.account||"",requireReference:!!c.requireReference,active:!!c.active});i(!1),o(-1),V(),mt.success("Payment mode saved")}catch(L){const U=((_=(K=L==null?void 0:L.response)==null?void 0:K.data)==null?void 0:_.message)||((E=(F=L==null?void 0:L.response)==null?void 0:F.data)==null?void 0:E.error)||"Failed to save payment mode";mt.error(U)}}function R(){const H={cashEnabled:!!h,cardEnabled:!!x,cashAccountId:b||"",maxCashAmount:N===""?"":Number(N||0).toString(),requireChangeCalc:!!S,cardBankAccountId:P||"",cardProcessingFee:B===""?"":Number(B||0).toString(),requireCardLast4:!!Q};try{localStorage.setItem(BS,JSON.stringify(H)),mt.success("Payment settings saved")}catch{mt.error("Failed to save payment settings")}}return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Uk,{title:"About Payment Methods",children:"Configure available payment methods for your POS system. Enable or disable payment options and set processing preferences."}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Payment Methods"}),e.jsx("button",{type:"button",className:"btn-success",onClick:D,children:"+ Add Payment Mode"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Require Reference"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500",children:"Loading..."})}):t.length?t.map((H,W)=>e.jsxs("tr",{children:[e.jsx("td",{children:H.name}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-success",children:H.type})}),e.jsx("td",{children:H.account?T.get(String(H.account))||String(H.account):"N/A"}),e.jsx("td",{children:H.requireReference?"Yes":"No"}),e.jsx("td",{children:e.jsx("span",{className:H.active?"badge-success badge":"badge-secondary badge",children:H.active?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Y(W),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>M(W),children:"Delete"})]})})]},H.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500",children:"No payment modes configured"})})})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Cash Payment"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:H=>f(H.target.checked)}),e.jsx("span",{className:"text-sm",children:"Enable Cash Payments"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cash Account"}),e.jsxs("select",{className:"input",value:b,onChange:H=>y(H.target.value),children:[e.jsx("option",{value:"",children:"Select cash account"}),u.map(H=>e.jsxs("option",{value:String(H.id),children:[H.code," - ",H.name]},H.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Max Cash Amount"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:N,onChange:H=>j(H.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Require Change Calculation"}),e.jsxs("select",{className:"input",value:S?"YES":"NO",onChange:H=>k(H.target.value==="YES"),children:[e.jsx("option",{value:"YES",children:"Yes"}),e.jsx("option",{value:"NO",children:"No"})]})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Card Payment"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:H=>g(H.target.checked)}),e.jsx("span",{className:"text-sm",children:"Enable Card Payments"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:P,onChange:H=>I(H.target.value),children:[e.jsx("option",{value:"",children:"Select bank account"}),u.map(H=>e.jsxs("option",{value:String(H.id),children:[H.code," - ",H.name]},H.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Processing Fee %"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:B,onChange:H=>q(H.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Require Card Last 4 Digits"}),e.jsxs("select",{className:"input",value:Q?"YES":"NO",onChange:H=>O(H.target.value==="YES"),children:[e.jsx("option",{value:"YES",children:"Yes"}),e.jsx("option",{value:"NO",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Card Types Accepted"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:"text-sm",children:"Visa"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:"text-sm",children:"Mastercard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:"text-sm",children:"American Express"})]})]})]})]})})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:R,children:"Save Payment Settings"})}),n?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-brand text-white",children:e.jsx("div",{className:"text-lg font-bold",children:l>=0?"Edit Payment Mode":"Add Payment Mode"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Name"}),e.jsx("input",{className:"input",value:c.name,onChange:H=>m(W=>({...W,name:H.target.value})),placeholder:"e.g., Cash, Credit Card"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Type"}),e.jsxs("select",{className:"input",value:c.type,onChange:H=>m(W=>({...W,type:H.target.value})),children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"mobile",children:"Mobile Money"}),e.jsx("option",{value:"bank",children:"Bank Transfer"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account"}),e.jsxs("select",{className:"input",value:c.account,onChange:H=>m(W=>({...W,account:H.target.value})),children:[e.jsx("option",{value:"",children:"Select account"}),u.map(H=>e.jsxs("option",{value:String(H.id),children:[H.code," - ",H.name]},H.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.requireReference,onChange:H=>m(W=>({...W,requireReference:H.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Require Reference Number"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.active,onChange:H=>m(W=>({...W,active:H.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),o(-1)},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:X,children:"Save Payment Mode"})]})]})]})}):null]})}function BZ(){const[t,s]=v.useState([]),[r,a]=v.useState(""),[n,i]=v.useState(!0),[l,o]=v.useState("Inclusive"),[u,d]=v.useState(!0),[c,m]=v.useState([]),[h,f]=v.useState(""),[x,g]=v.useState(!0);v.useEffect(()=>{let y=!0;return te.get("/finance/tax-codes").then(N=>{var j;y&&s(Array.isArray((j=N.data)==null?void 0:j.items)?N.data.items:[])}).catch(()=>{y&&s([])}).finally(()=>{y&&i(!1)}),()=>{y=!1}},[]),v.useEffect(()=>{let y=!0;return te.get("/pos/tax-settings").then(N=>{var S;if(!y)return;const j=((S=N.data)==null?void 0:S.item)||null;j&&(j.tax_code_id&&a(String(j.tax_code_id)),j.tax_account_id&&f(String(j.tax_account_id)),j.tax_type&&o(String(j.tax_type)),j.is_active!==void 0&&d(!!j.is_active))}).catch(()=>{}),()=>{y=!1}},[]);async function b(){const y={taxCodeId:r||"",taxAccountId:h||"",taxType:l||"",isActive:!!u};try{await te.put("/pos/tax-settings",y),mt.success("Tax settings saved")}catch{mt.error("Failed to save tax settings")}}return v.useEffect(()=>{let y=!0;return te.get("/finance/accounts",{params:{postable:1,active:1}}).then(N=>{var S;if(!y)return;const j=Array.isArray((S=N.data)==null?void 0:S.items)?N.data.items:[];m(j)}).catch(()=>{y&&m([])}).finally(()=>{y&&g(!1)}),()=>{y=!1}},[]),e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Tax Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Tax Code"}),e.jsxs("select",{className:"input",value:r,onChange:y=>a(y.target.value),disabled:n,children:[e.jsx("option",{value:"",children:"Select tax code"}),t.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Type"}),e.jsxs("select",{className:"input",value:l,onChange:y=>o(y.target.value),children:[e.jsx("option",{value:"Inclusive",children:"Inclusive"}),e.jsx("option",{value:"Exclusive",children:"Exclusive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Account"}),e.jsxs("select",{className:"input",value:h,onChange:y=>f(y.target.value),disabled:x,children:[e.jsx("option",{value:"",children:"Select tax account"}),c.map(y=>e.jsxs("option",{value:y.id,children:[y.code,"  ",y.name]},y.id))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:y=>d(y.target.checked)}),e.jsx("label",{className:"label mb-0",children:"Tax Active"})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,children:"Save Tax Settings"})})]})})})}function kZ(){const[t,s]=v.useState(""),[r,a]=v.useState(""),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState(!1),[x,g]=v.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:Gs}),[b,y]=v.useState(!1);v.useEffect(()=>{let j=!0;async function S(){var k;try{const I=((k=(await te.get("/pos/receipt-settings")).data)==null?void 0:k.item)||null;if(!j)return;I&&(I.company_name&&s(String(I.company_name)),I.header_text&&i(String(I.header_text)),I.footer_text&&o(String(I.footer_text)),I.contact_number&&a(String(I.contact_number)),I.address_line1&&d(String(I.address_line1)),I.address_line2&&m(String(I.address_line2)),f(I.show_logo===1||I.show_logo===!0||String(I.show_logo).toLowerCase()==="true"))}catch{}}return S(),()=>{j=!1}},[]),v.useEffect(()=>{let j=!0;async function S(){var k,P,I;try{y(!0);const q=(P=(k=(await te.get("/admin/me")).data)==null?void 0:k.scope)==null?void 0:P.companyId;if(!q){if(!j)return;g(T=>({...T,logoUrl:T.logoUrl||Gs}));return}const O=((I=(await te.get(`/admin/companies/${q}`)).data)==null?void 0:I.item)||{};if(!j)return;g(T=>({...T,name:O.name||T.name||"",address:O.address||T.address||"",city:O.city||T.city||"",state:O.state||T.state||"",country:O.country||T.country||"",phone:O.telephone||T.phone||"",email:O.email||T.email||"",website:O.website||T.website||"",taxId:O.tax_id||T.taxId||"",registrationNo:O.registration_no||T.registrationNo||"",logoUrl:O.has_logo===1||O.has_logo===!0?`/api/admin/companies/${q}/logo`:T.logoUrl||Gs}))}catch{if(!j)return;g(B=>({...B,logoUrl:B.logoUrl||Gs}))}finally{j&&y(!1)}}return S(),()=>{j=!1}},[]);async function N(){var S,k,P,I;const j={companyName:t.trim(),contactNumber:r.trim(),headerText:n.trim(),footerText:l.trim(),addressLine1:u.trim(),addressLine2:c.trim(),logoUrl:x.logoUrl||"",showLogo:!!h};try{await te.put("/pos/receipt-settings",j),mt.success("Receipt settings saved")}catch(B){const q=((k=(S=B==null?void 0:B.response)==null?void 0:S.data)==null?void 0:k.message)||((I=(P=B==null?void 0:B.response)==null?void 0:P.data)==null?void 0:I.error)||"Failed to save receipt settings";mt.error(q)}}return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Receipt Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 border rounded bg-white flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:x.logoUrl,alt:x.name||"Company Logo",className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-sm",children:x.name||"Company Name"}),e.jsxs("div",{children:[x.address,x.city?`, ${x.city}`:"",x.country?`, ${x.country}`:""]}),e.jsx("div",{children:x.phone?`Mobile: ${x.phone}`:x.email||""}),e.jsx("div",{children:x.taxId?`TIN: ${x.taxId}`:""})]})]}),e.jsx("div",{className:"md:col-span-2 text-xs text-slate-500",children:b?"Loading company information from profile...":"Company details are loaded from the company profile (adm_companies)."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Upload Logo"}),e.jsx("input",{type:"file",accept:"image/*",className:"input",onChange:async j=>{var k,P,I,B,q,Q;const S=(k=j.target.files)==null?void 0:k[0];if(S)try{const O=new FormData;O.append("logo",S);const T=await te.post("/pos/receipt-settings/logo",O,{headers:{"Content-Type":"multipart/form-data"}}),V=((P=T==null?void 0:T.data)==null?void 0:P.logoUrl)||x.logoUrl||"";g(D=>({...D,logoUrl:V})),f(!0),mt.success("Logo uploaded and linked to receipts")}catch(O){const T=((B=(I=O==null?void 0:O.response)==null?void 0:I.data)==null?void 0:B.message)||((Q=(q=O==null?void 0:O.response)==null?void 0:q.data)==null?void 0:Q.error)||"Failed to upload logo";mt.error(T)}finally{j.target.value=""}}})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name"}),e.jsx("input",{className:"input",type:"text",placeholder:"Company name",value:t,onChange:j=>s(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Number"}),e.jsx("input",{className:"input",type:"text",placeholder:"+1234567890",value:r,onChange:j=>a(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Header Text"}),e.jsx("textarea",{className:"input h-28",placeholder:"Thank you for your purchase",value:n,onChange:j=>i(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Footer Text"}),e.jsx("textarea",{className:"input h-28",placeholder:"Please visit again",value:l,onChange:j=>o(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address Line 1"}),e.jsx("input",{className:"input",type:"text",placeholder:"Street address",value:u,onChange:j=>d(j.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address Line 2"}),e.jsx("input",{className:"input",type:"text",placeholder:"City, State, ZIP",value:c,onChange:j=>m(j.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:j=>f(j.target.checked)}),e.jsx("span",{className:"text-sm",children:"Show Logo on Receipt"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",disabled:!0}),e.jsx("span",{className:"text-sm",children:"Show Barcode on Receipt"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:N,children:"Save Receipt Settings"})})]})})})}function EZ(){const[t,s]=v.useState("GHS - Ghana Cedi"),[r,a]=v.useState("2"),[n,i]=v.useState("MM/DD/YYYY"),[l,o]=v.useState("12 Hour"),[u,d]=v.useState(!1),[c,m]=v.useState(!1),[h,f]=v.useState(!1),[x,g]=v.useState(!1);v.useEffect(()=>{try{const y=localStorage.getItem(kS);if(!y)return;const N=JSON.parse(y);if(!N||typeof N!="object")return;N.defaultCurrency&&s(String(N.defaultCurrency)),N.decimalPlaces!==void 0&&a(String(N.decimalPlaces)),N.dateFormat&&i(String(N.dateFormat)),N.timeFormat&&o(String(N.timeFormat)),typeof N.allowDiscounts=="boolean"&&d(N.allowDiscounts),typeof N.requireCustomer=="boolean"&&m(N.requireCustomer),typeof N.autoLogoutAfterShiftClose=="boolean"&&f(N.autoLogoutAfterShiftClose),typeof N.autoPrintReceipt=="boolean"&&g(N.autoPrintReceipt)}catch{}},[]);function b(){const y={defaultCurrency:t,decimalPlaces:r||"2",dateFormat:n,timeFormat:l,allowDiscounts:!!u,requireCustomer:!!c,autoLogoutAfterShiftClose:!!h,autoPrintReceipt:!!x};try{localStorage.setItem(kS,JSON.stringify(y)),mt.success("General settings saved")}catch{mt.error("Failed to save general settings")}}return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"General Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Currency"}),e.jsxs("select",{className:"input",value:t,onChange:y=>s(y.target.value),children:[e.jsx("option",{value:"USD - US Dollar",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR - Euro",children:"EUR - Euro"}),e.jsx("option",{value:"GBP - British Pound",children:"GBP - British Pound"}),e.jsx("option",{value:"GHS - Ghana Cedi",children:"GHS - Ghana Cedi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Decimal Places"}),e.jsxs("select",{className:"input",value:r,onChange:y=>a(y.target.value),children:[e.jsx("option",{value:"0",children:"0"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date Format"}),e.jsxs("select",{className:"input",value:n,onChange:y=>i(y.target.value),children:[e.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Time Format"}),e.jsxs("select",{className:"input",value:l,onChange:y=>o(y.target.value),children:[e.jsx("option",{value:"12 Hour",children:"12 Hour"}),e.jsx("option",{value:"24 Hour",children:"24 Hour"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:y=>d(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Allow Discounts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:y=>m(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Require Customer for Sales"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:y=>f(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Auto Logout After Shift Close"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:y=>g(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Auto Print Receipt"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,children:"Save General Settings"})})]})})})}function FZ(){const[t,s]=v.useState("terminals"),r=[{key:"terminals",label:" Terminals"},{key:"payment",label:" Payment Modes"},{key:"taxes",label:" Tax Settings"},{key:"receipts",label:" Receipt Settings"},{key:"general",label:" General Settings"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(_Z,{emoji:"",title:"POS Setup & Configuration",subtitle:"Configure terminals, payment methods, and system settings"}),e.jsx("div",{className:"flex gap-2",children:r.map(a=>e.jsx(wZ,{active:t===a.key,onClick:()=>s(a.key),children:a.label},a.key))}),t==="terminals"&&e.jsx(SZ,{}),t==="payment"&&e.jsx(CZ,{}),t==="taxes"&&e.jsx(BZ,{}),t==="receipts"&&e.jsx(kZ,{}),t==="general"&&e.jsx(EZ,{})]})}function pb({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function FS(){const[t,s]=v.useState(new Date),[r,a]=v.useState(""),[n,i]=v.useState(""),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(!1),[h,f]=v.useState(null),[x,g]=v.useState([]),[b,y]=v.useState("cash"),[N,j]=v.useState(""),[S,k]=v.useState(!1),[P,I]=v.useState({amount:0,method:"",ref:""}),[B,q]=v.useState(null),[Q,O]=v.useState([]),[T,V]=v.useState(!1),[D,Y]=v.useState(!0),[M,X]=v.useState(""),[R,H]=v.useState([]),[W,K]=v.useState(!1),[_,F]=v.useState(""),[E,L]=v.useState([]),[U,J]=v.useState(!1),[ae,Z]=v.useState("");v.useEffect(()=>{const me=setInterval(()=>s(new Date),1e3);return()=>clearInterval(me)},[]),v.useEffect(()=>{let me=!1;return Y(!0),te.get("/pos/day/status").then(xe=>{var dt;if(me)return;const Ue=((dt=xe==null?void 0:xe.data)==null?void 0:dt.item)||null,ct=String((Ue==null?void 0:Ue.status)||"").toUpperCase()==="OPEN";V(ct)}).catch(()=>{me||V(!1)}).finally(()=>{me||Y(!1)}),()=>{me=!0}},[]),v.useEffect(()=>{let me=!0;return K(!0),F(""),te.get("/sales/price-types").then(xe=>{var ct;if(!me)return;const Ue=Array.isArray((ct=xe.data)==null?void 0:ct.items)?xe.data.items:[];if(H(Ue),!M&&Ue.length){let dt=Ue.find(We=>String(We.name||"").trim().toLowerCase()==="retail")||Ue[0];dt&&dt.id&&X(String(dt.id))}}).catch(xe=>{var Ue,ct;me&&F(((ct=(Ue=xe==null?void 0:xe.response)==null?void 0:Ue.data)==null?void 0:ct.message)||"Failed to load price types")}).finally(()=>{me&&K(!1)}),()=>{me=!1}},[M]),v.useEffect(()=>{let me=!0;return J(!0),Z(""),te.get("/inventory/items").then(xe=>{var dt;if(!me)return;const ct=(Array.isArray((dt=xe.data)==null?void 0:dt.items)?xe.data.items:[]).filter(We=>We&&We.is_active!==!1).map(We=>({id:We.id,name:We.item_name||"",code:We.item_code||""}));L(ct)}).catch(xe=>{var Ue,ct;me&&Z(((ct=(Ue=xe==null?void 0:xe.response)==null?void 0:Ue.data)==null?void 0:ct.message)||"Failed to load items")}).finally(()=>{me&&J(!1)}),()=>{me=!1}},[]),v.useEffect(()=>{let me=!1;async function xe(){if(!Array.isArray(x)||!x.length)return;const Ue=await Promise.all(x.map(async ct=>{const dt=E.find(He=>String(He.name||"").trim().toLowerCase()===String(ct.name||"").trim().toLowerCase())||null,We=dt?await oe(dt.id,M,ct.price):ct.price;return{...ct,price:We}}));me||g(Ue)}return xe(),()=>{me=!0}},[M]);async function oe(me,xe,Ue){var ct;try{const dt={product_id:me,quantity:1,price_type:xe||"",only_standard:!0},We=await te.post("/sales/prices/best-price",dt),He=Number((ct=We.data)==null?void 0:ct.price);return Number.isFinite(He)?He:Number(Ue||0)}catch{return Number(Ue||0)}}v.useEffect(()=>{let me=!1;async function xe(){var ct,dt;const Ue=String(n||"").trim();if(a(""),o(""),d(""),f(null),g([]),!Ue){m(!0);try{const We=await te.get("/pos/sales",{params:{limit:200}}),ze=(Array.isArray((ct=We.data)==null?void 0:ct.items)?We.data.items:Array.isArray((dt=We.data)==null?void 0:dt.item)?We.data.item:[]).map(Pe=>({id:Pe.id,receiptNo:String(Pe.sale_no||""),date:String(Pe.sale_date||"").slice(0,10),customer:String(Pe.customer_id||""),payment:String(Pe.payment_method||"").replace(/^./,Te=>Te.toUpperCase())}));O(ze)}catch{O([])}finally{m(!1)}return}m(!0);try{async function We(Pe){var $e,Ve;const Te=await te.get("/pos/sales",{params:{limit:1e3,...Pe}});return Array.isArray(($e=Te.data)==null?void 0:$e.items)?Te.data.items:Array.isArray((Ve=Te.data)==null?void 0:Ve.item)?Te.data.item:[]}let He=[];try{He=await We({date:Ue})}catch{}if(!me&&!He.length)try{He=await We({sale_date:Ue})}catch{}if(!me&&!He.length)try{He=await We({from:Ue,to:Ue})}catch{}if(!me&&!He.length)try{He=(await We({})).filter(Te=>String(Te.sale_date||Te.date||"").slice(0,10)===Ue)}catch{}if(me)return;const ze=He.map(Pe=>({id:Pe.id,receiptNo:String(Pe.sale_no||""),date:String(Pe.sale_date||"").slice(0,10),customer:String(Pe.customer_id||""),payment:String(Pe.payment_method||"").replace(/^./,Te=>Te.toUpperCase())}));O(ze)}catch{if(me)return;O([])}finally{if(me)return;m(!1)}}return xe(),()=>{me=!0}},[n]);const ee=v.useMemo(()=>x.reduce((me,xe)=>me+xe.price*xe.returnQuantity,0),[x]),se=v.useMemo(()=>ee*.125,[ee]),Ae=v.useMemo(()=>ee+se,[ee,se]);async function we(){var Ue;const me=Number(r||0);if(!me)return;const xe=Q.find(ct=>Number(ct.id)===me)||null;if(xe)try{const ct=await te.get(`/pos/sales/${xe.id}`),We=(Array.isArray((Ue=ct.data)==null?void 0:Ue.details)?ct.data.details:[]).map((He,ze)=>({id:ze+1,name:String(He.item_name||""),price:Number(He.unit_price||0),quantity:Number(He.qty||0)}));f({...xe,items:We}),g([])}catch{f({...xe,items:[]}),g([])}}function ce(me,xe){if(!h)return;const Ue=h.items.find(ct=>ct.id===me);Ue&&(xe?(async()=>{const ct=E.find(He=>String(He.name||"").trim().toLowerCase()===String(Ue.name||"").trim().toLowerCase())||null,dt=ct?await oe(ct.id,M,Ue.price):Ue.price,We={id:Ue.id,name:Ue.name,price:dt,soldQty:Ue.quantity,returnQuantity:1,reason:"defective"};g(He=>{const ze=He.findIndex(Pe=>Pe.id===me);if(ze>=0){const Pe=He.slice();return Pe[ze]=We,Pe}return[...He,We]})})():g(ct=>ct.filter(dt=>dt.id!==me)))}function le(me,xe){const Ue=Math.max(1,Number(xe||1));g(ct=>ct.map(dt=>dt.id===me?{...dt,returnQuantity:Ue}:dt))}function _e(me,xe){g(Ue=>Ue.map(ct=>ct.id===me?{...ct,reason:xe}:ct))}function Qe(me){g(xe=>xe.filter(Ue=>Ue.id!==me))}function Ie(){x.length&&g([])}function ke(){if(!x.length)return;const me="RTN-"+Date.now(),xe=new Date;I({amount:Ae,method:b==="cash"?"Cash":b==="card"?"Card Refund":b==="mobile"?"Mobile Money":"Store Credit",ref:me}),q(xe),k(!0)}function pe(){k(!1),f(null),g([]),a(""),i(""),o(""),d(""),j("")}function he(){var Pe;if(!h||!x.length)return;const xe=(B?new Date(B):new Date).toLocaleString(),Ue=x.map(Te=>{const Ke=Number(Te.returnQuantity||0),$e=Number(Te.price||0),Ve=Ke*$e,Ze=String(Te.reason||"").replace(/^./,Re=>Re.toUpperCase());return`<tr>
          <td>${String(Te.name||"")}</td>
          <td class="right">${Ke}</td>
          <td class="right">${$e.toFixed(2)}</td>
          <td class="right">${Ve.toFixed(2)}</td>
          <td>${Ze}</td>
        </tr>`}).join(""),ct=String(N||"").trim()?`<div class="muted" style="margin-top:8px;">Notes: ${String(N||"")}</div>`:"",dt=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Return Receipt</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; vertical-align: top; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        <h1>RETURN RECEIPT</h1>
        <div class="center muted">Sales Return & Refund</div>
        <hr />
        <div class="row"><span>Return Ref:</span><span>${String(P.ref||"-")}</span></div>
        <div class="row"><span>Original Receipt:</span><span>${String(h.receiptNo||"-")}</span></div>
        <div class="row"><span>Sale Date:</span><span>${String(h.date||"-")}</span></div>
        <div class="row"><span>Return Date:</span><span>${xe}</span></div>
        <div class="row"><span>Refund Method:</span><span>${String(P.method||"-")}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Total</th>
              <th>Reason</th>
            </tr>
          </thead>
          <tbody>
            ${Ue}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Items Subtotal</span><span>${ee.toFixed(2)}</span></div>
          <div class="row"><span>Tax Refund</span><span>${se.toFixed(2)}</span></div>
          <div class="row"><strong>Total Refund</strong><strong>${Ae.toFixed(2)}</strong></div>
        </div>
        ${ct}
        <button onclick="window.print()">Print</button>
      </body>
      </html>
    `,We=document.createElement("iframe");We.style.position="fixed",We.style.right="0",We.style.bottom="0",We.style.width="0",We.style.height="0",We.style.border="0",document.body.appendChild(We);const He=((Pe=We.contentWindow)==null?void 0:Pe.document)||We.contentDocument||null;if(!He)return;He.open(),He.write(dt),He.close();const ze=We.contentWindow;ze&&(ze.focus(),setTimeout(()=>{try{ze.print()}catch{}setTimeout(()=>{try{document.body.removeChild(We)}catch{}},500)},150))}const je=v.useMemo(()=>(Array.isArray(Q)?Q:[]).filter(me=>{const xe=String(l||"").trim().toLowerCase(),Ue=String(u||"").trim().toLowerCase();return!(xe&&!String(me.customer||"").toLowerCase().includes(xe)||Ue&&String(me.payment||"").toLowerCase()!==Ue)}).map(me=>{const xe=String(me.receiptNo||"-"),Ue=String(me.date||""),ct=Ue?`${xe}  ${Ue}`:xe;return{value:String(me.id),label:ct}}),[Q,l,u]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Sales Return & Refund"}),e.jsx("p",{className:"text-sm mt-1",children:"Process returns from original receipts"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:t.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:t.toLocaleTimeString()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[!D&&!T&&e.jsxs("div",{className:"alert-danger rounded-lg p-4",children:["Day is not open. Open day before processing returns.",e.jsx("div",{className:"mt-2",children:e.jsx(Ee,{to:"/pos/day-management",className:"btn-secondary",children:"Open Day Management"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Find Original Sale"})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sale Date"}),e.jsx("input",{type:"date",className:"input",value:n,onChange:me=>i(me.target.value),disabled:!T})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Number"}),e.jsx(pb,{value:r,onChange:a,options:je,placeholder:c?"Loading receipts...":"Select receipt",disabled:!T||c,filterPlaceholder:"Filter receipts..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Phone"}),e.jsx("input",{className:"input",placeholder:"e.g., 0244123456",value:l,onChange:me=>o(me.target.value),disabled:!T})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsx(pb,{value:u,onChange:d,options:[{value:"cash",label:"Cash"},{value:"card",label:"Card"},{value:"mobile",label:"Mobile Money"}],placeholder:"All Methods",disabled:!T,filterPlaceholder:"Filter methods..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsx(pb,{value:M,onChange:me=>{X(me),g(xe=>xe.map(Ue=>({...Ue})))},options:R.map(me=>({value:String(me.id),label:String(me.name||"")})),placeholder:W?"Loading price types...":"Select Price Type",disabled:!T||W||!R.length,filterPlaceholder:"Filter price types..."})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn-primary w-full",onClick:we,disabled:!T||!r,children:"Search Receipt"})})]})]}),h?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Receipt Number"}),e.jsx("div",{className:"font-medium",children:h.receiptNo})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Sale Date"}),e.jsx("div",{className:"font-medium",children:h.date})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Customer"}),e.jsx("div",{className:"font-medium",children:h.customer})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Payment Method"}),e.jsx("div",{className:"font-medium",children:h.payment})]}),e.jsxs("div",{className:"flex justify-between md:col-span-2",children:[e.jsx("div",{className:"text-slate-500",children:"Original Total"}),e.jsx("div",{className:"font-medium",children:(()=>{const me=h.items.reduce((Ue,ct)=>Ue+ct.price*ct.quantity,0),xe=me*.125;return`GH ${(me+xe).toFixed(2)}`})()})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"font-semibold",children:"Select Items to Return"})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Return"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{className:"text-right",children:"Price"}),e.jsx("th",{className:"text-right",children:"Sold Qty"}),e.jsx("th",{className:"text-right",children:"Return Qty"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:h.items.map(me=>{const xe=x.find(Ue=>Ue.id===me.id);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",className:"checkbox",checked:!!xe,onChange:Ue=>ce(me.id,Ue.target.checked)})}),e.jsx("td",{className:"font-medium",children:me.name}),e.jsx("td",{className:"text-right",children:`GH ${Number(me.price).toFixed(2)}`}),e.jsx("td",{className:"text-right",children:me.quantity}),e.jsx("td",{className:"text-right",children:e.jsx("input",{type:"number",className:"input w-24 text-right",min:1,max:me.quantity,value:xe?xe.returnQuantity:1,disabled:!xe,onChange:Ue=>le(me.id,Ue.target.value)})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:xe?xe.reason:"defective",disabled:!xe,onChange:Ue=>_e(me.id,Ue.target.value),children:[e.jsx("option",{value:"defective",children:"Defective"}),e.jsx("option",{value:"wrong",children:"Wrong Item"}),e.jsx("option",{value:"damaged",children:"Damaged"}),e.jsx("option",{value:"unwanted",children:"Unwanted"}),e.jsx("option",{value:"other",children:"Other"})]})})]},me.id)})})]})})]})]}):e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-center text-slate-600",children:"Search for a receipt to process returns"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Return Summary"})}),e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:x.length?x.map(me=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-slate-900",children:me.name}),e.jsx("div",{className:"text-red-600 font-semibold",children:`-GH ${(me.price*me.returnQuantity).toFixed(2)}`})]}),e.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[me.returnQuantity,"  GH"," ",Number(me.price).toFixed(2)," "," ",String(me.reason||"").replace(/^./,xe=>xe.toUpperCase())]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>Qe(me.id),children:"Remove"})})]},me.id)):e.jsx("div",{className:"text-center text-slate-600",children:"No items selected for return"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Items Subtotal"}),e.jsx("div",{children:`GH ${ee.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax Refund"}),e.jsx("div",{children:`GH ${se.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("div",{children:"Total Refund"}),e.jsx("div",{className:"text-red-700",children:`GH ${Ae.toFixed(2)}`})]})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"font-semibold",children:"Refund Method"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",className:`btn ${b==="cash"?"btn-primary":"btn-secondary"}`,onClick:()=>y("cash"),children:"Cash"}),e.jsx("button",{type:"button",className:`btn ${b==="card"?"btn-primary":"btn-secondary"}`,onClick:()=>y("card"),children:"Card"}),e.jsx("button",{type:"button",className:`btn ${b==="mobile"?"btn-primary":"btn-secondary"}`,onClick:()=>y("mobile"),children:"Mobile Money"}),e.jsx("button",{type:"button",className:`btn ${b==="credit"?"btn-primary":"btn-secondary"}`,onClick:()=>y("credit"),children:"Store Credit"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Notes"}),e.jsx("textarea",{className:"input",value:N,onChange:me=>j(me.target.value),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("button",{type:"button",className:"btn-primary w-full",onClick:ke,disabled:!T||!x.length,children:"Process Return"}),e.jsx("button",{type:"button",className:"btn-secondary w-full",onClick:Ie,disabled:!T||!x.length,children:"Clear Selection"})]})]})})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"Return Processed"}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Refund Amount"}),e.jsx("div",{className:"font-semibold",children:`GH ${Number(P.amount).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Refund Method"}),e.jsx("div",{className:"font-semibold",children:P.method})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Return Reference"}),e.jsx("div",{className:"font-semibold",children:P.ref})]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:pe,children:"New Return"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{he(),pe()},children:"Print Return Receipt"})]})]})})]})}function xb({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"All"}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function TZ(){const{user:t}=Qa(),[s,r]=v.useState(new Date),[a,n]=v.useState(""),[i,l]=v.useState(""),[o,u]=v.useState(""),[d,c]=v.useState(""),[m,h]=v.useState(""),[f,x]=v.useState([]),[g,b]=v.useState(null),[y,N]=v.useState(1),j=10,[S,k]=v.useState(""),[P,I]=v.useState([]),[B,q]=v.useState(!1);v.useEffect(()=>{const U=setInterval(()=>r(new Date),1e3);return()=>clearInterval(U)},[]),v.useEffect(()=>{let U=!1;async function J(){var ae,Z,oe;q(!0);try{const[ee,se]=await Promise.all([te.get("/pos/terminals"),te.get("/pos/terminal-users")]);if(U)return;const Ae=Array.isArray((ae=ee.data)==null?void 0:ae.items)?ee.data.items:[],we=Array.isArray((Z=se.data)==null?void 0:Z.items)?se.data.items:[],ce=Number((t==null?void 0:t.sub)||0)||Number((t==null?void 0:t.id)||0)||void 0,le=new Set(we.filter(Ie=>Number(Ie==null?void 0:Ie.user_id)===ce).map(Ie=>Number(Ie==null?void 0:Ie.terminal_id)).filter(Ie=>Number.isFinite(Ie)&&Ie>0)),_e=Ae.filter(Ie=>le.has(Number(Ie==null?void 0:Ie.id)));I(_e);const Qe=(_e.length?String(((oe=_e[0])==null?void 0:oe.code)||""):"")||"";k(Qe)}catch{if(U)return;I([]),k("")}finally{if(U)return;q(!1)}}return J(),()=>{U=!0}},[t==null?void 0:t.id,t==null?void 0:t.sub]),v.useEffect(()=>{let U=!1;const J=S?{params:{terminal:S}}:{};return te.get("/pos/sales",J).then(ae=>{var ee;if(U)return;const oe=(Array.isArray((ee=ae.data)==null?void 0:ee.items)?ae.data.items:[]).map(se=>{const Ae=String(se.sale_date||""),we=Ae.slice(0,10),ce=Ae.includes("T")?Ae.split("T")[1].slice(0,8):"";return{id:se.id,receiptNo:String(se.sale_no||""),date:we,time:ce,customer:String(se.customer_id||""),phone:"",payment:String(se.payment_method||"").toLowerCase(),status:String(se.payment_status||"").toLowerCase(),items:[],total_amount:Number(se.total_amount||0),items_count:Number(se.items_count||0)}});x(oe)}).catch(()=>{U||x([])}),()=>{U=!0}},[S]);const Q=U=>{const J=U.reduce((Z,oe)=>Z+oe.price*oe.quantity,0),ae=J*.125;return J+ae},O=U=>U.reduce((J,ae)=>J+ae.price*ae.quantity,0),T=v.useMemo(()=>{const U=String(m||"").toLowerCase();return f.filter(J=>{const ae=(!a||J.date>=a)&&(!i||J.date<=i),Z=!o||J.status===o,oe=!d||J.payment===d,ee=!U||J.receiptNo.toLowerCase().includes(U)||J.customer.toLowerCase().includes(U);return ae&&Z&&oe&&ee})},[f,a,i,o,d,m]),V=Math.max(1,Math.ceil(T.length/j)),D=v.useMemo(()=>{const U=(y-1)*j,J=U+j;return T.slice(U,J)},[T,y]);v.useEffect(()=>{N(1)},[a,i,o,d,m]);function Y(){const U=["Receipt","Date","Time","Customer","Phone","Payment","Status","Items","Total"],J=T.map(se=>[se.receiptNo,se.date,se.time,se.customer,se.phone,se.payment,se.status,se.items.reduce((Ae,we)=>Ae+we.quantity,0),Q(se.items).toFixed(2)]),ae=[U.join(","),...J.map(se=>se.join(","))].join(`
`),Z=new Blob([ae],{type:"text/csv;charset=utf-8;"}),oe=URL.createObjectURL(Z),ee=document.createElement("a");ee.href=oe,ee.download="pos_register.csv",ee.click(),URL.revokeObjectURL(oe)}function M(){window.print()}function X(){alert("Register closing flow will be implemented with sessions.")}function R(U){alert("Printing transaction "+U)}function H(U){x(J=>J.filter(ae=>ae.id!==U))}async function W(U){var J;try{const ae=await te.get(`/pos/sales/${U.id}`),oe=(Array.isArray((J=ae.data)==null?void 0:J.details)?ae.data.details:[]).map(ee=>({name:String(ee.item_name||""),price:Number(ee.unit_price||0),quantity:Number(ee.qty||0)}));b({...U,items:oe})}catch{b(U)}}function K(){b(null)}function _(){alert("Printing receipt "+String((g==null?void 0:g.receiptNo)||""))}function F(){alert("Emailing receipt "+String((g==null?void 0:g.receiptNo)||""))}const E=T.length?(y-1)*j+1:0,L=Math.min(y*j,T.length);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Transactions listing and details"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:s.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:s.toLocaleTimeString()})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal"}),e.jsx(xb,{value:S,onChange:k,placeholder:B?"Loading terminals...":"All Terminals (assigned)",options:(Array.isArray(P)?P:[]).map(U=>({value:String(U.code||""),label:String(U.code||U.name||"")})),disabled:B,filterPlaceholder:"Filter terminals..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{type:"date",className:"input",value:a,onChange:U=>n(U.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{type:"date",className:"input",value:i,onChange:U=>l(U.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx(xb,{value:o,onChange:u,placeholder:"All Status",options:[{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"returned",label:"Returned"}],filterPlaceholder:"Filter status..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment"}),e.jsx(xb,{value:d,onChange:c,placeholder:"All Payments",options:[{value:"cash",label:"Cash"},{value:"card",label:"Card"},{value:"mobile",label:"Mobile Money"}],filterPlaceholder:"Filter payments..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input",placeholder:"Search receipt or customer",value:m,onChange:U=>h(U.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:Y,children:"Export CSV"}),e.jsx("button",{className:"btn-primary",onClick:M,children:"Print"}),e.jsx("button",{className:"btn-danger",onClick:X,children:"Close Register"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Receipt #"}),e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:D.length?D.map(U=>{const J=Number(U.total_amount||0),ae=Number(U.items_count||0);return e.jsxs("tr",{onClick:()=>W(U),className:"cursor-pointer",children:[e.jsx("td",{className:"font-medium",children:U.receiptNo}),e.jsxs("td",{children:[U.date,e.jsx("div",{className:"text-xs text-slate-500",children:U.time})]}),e.jsxs("td",{children:[U.customer,e.jsx("div",{className:"text-xs text-slate-500",children:U.phone})]}),e.jsx("td",{children:ae}),e.jsx("td",{children:e.jsx("span",{className:"px-2 py-1 rounded bg-slate-100 text-slate-700 text-xs",children:String(U.payment||"").toUpperCase()})}),e.jsx("td",{className:"text-right",children:`GH ${Number(J).toFixed(2)}`}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${U.status==="completed"?"bg-green-100 text-green-700":U.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:String(U.status||"").toUpperCase()})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:Z=>{Z.stopPropagation(),W(U)},children:"View"}),e.jsx("button",{className:"btn btn-secondary",onClick:Z=>{Z.stopPropagation(),R(U.id)},children:"Print"}),e.jsx("button",{className:"btn btn-danger",onClick:Z=>{Z.stopPropagation(),H(U.id)},children:"Delete"})]})})]},U.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:e.jsx("div",{className:"text-center text-slate-600 py-6",children:"No transactions found"})})})})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:["Showing ",E," to ",L," of ",T.length," transactions"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>N(U=>Math.max(1,U-1)),disabled:y===1,children:" Previous"}),Array.from({length:V},(U,J)=>J+1).map(U=>e.jsx("button",{className:`btn ${y===U?"btn-primary":"btn-secondary"}`,onClick:()=>N(U),children:U},U)),e.jsx("button",{className:"btn btn-secondary",onClick:()=>N(U=>Math.min(V,U+1)),disabled:y>=V,children:"Next "})]})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xl font-bold",children:"Transaction Details"}),e.jsx("button",{className:"btn btn-secondary",onClick:K,children:"Close"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Receipt Number"}),e.jsx("div",{className:"font-medium",children:g.receiptNo})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Date & Time"}),e.jsxs("div",{className:"font-medium",children:[g.date," ",g.time]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Customer"}),e.jsx("div",{className:"font-medium",children:g.customer})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Payment Method"}),e.jsx("div",{className:"font-medium",children:String(g.payment||"").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Cashier"}),e.jsx("div",{className:"font-medium",children:g.cashier})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Status"}),e.jsx("div",{className:"font-medium",children:String(g.status||"").toUpperCase()})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Items Purchased"}),e.jsx("div",{className:"space-y-2",children:g.items.map((U,J)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:U.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:[U.quantity,"  GH ",Number(U.price).toFixed(2)]})]}),e.jsx("div",{className:"font-semibold",children:`GH ${(U.quantity*U.price).toFixed(2)}`})]},J))})]}),e.jsxs("div",{className:"mt-4 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{children:`GH ${O(g.items).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax"}),e.jsx("div",{children:`GH ${(O(g.items)*.125).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{children:`GH ${Q(g.items).toFixed(2)}`})]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:_,children:"Print Receipt"}),e.jsx("button",{className:"btn btn-secondary",onClick:F,children:"Email Receipt"})]})]})})]})}function IZ({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function LZ(){const{user:t,hasAccess:s}=Qa(),[r,a]=v.useState(new Date),[n,i]=v.useState(""),[l,o]=v.useState([]),[u,d]=v.useState(!1),[c,m]=v.useState(""),[h,f]=v.useState(""),[x,g]=v.useState(""),[b,y]=v.useState(""),[N,j]=v.useState(1),[S,k]=v.useState(""),[P,I]=v.useState([]),[B,q]=v.useState([]),[Q,O]=v.useState(!1),[T,V]=v.useState(""),[D,Y]=v.useState([]),[M,X]=v.useState(!1),[R,H]=v.useState(""),[W,K]=v.useState(!1),[_,F]=v.useState(null),[E,L]=v.useState([]),[U,J]=v.useState(!1),[ae,Z]=v.useState(""),[oe,ee]=v.useState(""),[se,Ae]=v.useState(12.5),[we,ce]=v.useState("Exclusive"),[le,_e]=v.useState(""),[Qe,Ie]=v.useState(!0),[ke,pe]=v.useState(!1),[he,je]=v.useState(!0),[me,xe]=v.useState(""),[Ue,ct]=v.useState(""),[dt,We]=v.useState({open:!1,code:""}),[He,ze]=v.useState({open:!1,itemName:""}),[Pe,Te]=v.useState(!1),[Ke,$e]=v.useState(""),[Ve,Ze]=v.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:Gs});v.useMemo(()=>{const Me=String(n||"").toLowerCase();return Me?B.filter(Nt=>Nt.name.toLowerCase().includes(Me)||Nt.code.toLowerCase().includes(Me)):B},[B,n]);const Re=v.useMemo(()=>(Array.isArray(B)?B:[]).map(Me=>({value:String(Me.id),label:(Me.code?`${Me.code} - `:"")+String(Me.name||"")})),[B]),it=v.useMemo(()=>{const Me=String(b||"").trim().toLowerCase();return Me?Re.filter(Nt=>String(Nt.label||"").trim().toLowerCase().includes(Me)).slice(0,10):[]},[b,Re]);v.useEffect(()=>{const Me=setInterval(()=>a(new Date),1e3);return()=>clearInterval(Me)},[]),v.useEffect(()=>{let Me=!1;async function Nt(){var Et,$t,Ht,Ot;je(!0);try{const ls=Number((t==null?void 0:t.sub)||0)||Number((t==null?void 0:t.id)||0)||void 0,[Ls,Is]=await Promise.all([te.get("/pos/terminals"),te.get("/pos/terminal-users")]),Hs=Array.isArray((Et=Ls.data)==null?void 0:Et.items)?Ls.data.items:[],Ir=Array.isArray(($t=Is.data)==null?void 0:$t.items)?Is.data.items:[],ya=new Set(Ir.filter(zr=>Number(zr==null?void 0:zr.user_id)===Number(ls)).map(zr=>Number(zr==null?void 0:zr.terminal_id)).filter(zr=>Number.isFinite(zr)&&zr>0)),yr=Hs.filter(zr=>ya.has(Number(zr==null?void 0:zr.id))),cr=(yr.length?String(((Ht=yr[0])==null?void 0:Ht.code)||""):"")||"";xe(cr);const ka=cr?{params:{terminal:cr}}:void 0,Ks=await te.get("/pos/day/status",ka),jr=((Ot=Ks==null?void 0:Ks.data)==null?void 0:Ot.item)||null,nl=String((jr==null?void 0:jr.status)||"").toUpperCase()==="OPEN";pe(nl)}catch{if(Me)return;pe(!1)}finally{if(Me)return;je(!1)}}return Nt(),()=>{Me=!0}},[t==null?void 0:t.id,t==null?void 0:t.sub]),v.useEffect(()=>{let Me=!0;return J(!0),Z(""),te.get("/pos/payment-modes").then(Nt=>{var Ht;if(!Me)return;const $t=(Array.isArray((Ht=Nt.data)==null?void 0:Ht.items)?Nt.data.items:[]).filter(Ot=>Ot&&Ot.is_active!==0&&Ot.is_active!==!1);if(L($t),!oe&&$t.length){let Ot=$t.find(ls=>String(ls.type||"").trim().toLowerCase()==="cash")||$t[0];Ot&&Ot.id&&ee(String(Ot.id))}}).catch(Nt=>{var Et,$t;Me&&Z((($t=(Et=Nt==null?void 0:Nt.response)==null?void 0:Et.data)==null?void 0:$t.message)||"Failed to load payment modes")}).finally(()=>{Me&&J(!1)}),()=>{Me=!1}},[oe]),v.useEffect(()=>{let Me=!0;return te.get("/pos/tax-settings").then(Nt=>{var Is;if(!Me)return;const Et=((Is=Nt.data)==null?void 0:Is.item)||null;if(!Et){Ie(!1),Ae(0),ce("Exclusive"),_e("");return}const $t=Et.is_active!==0&&Et.is_active!==!1;if(Ie($t),!$t){Ae(0),ce("Exclusive"),_e("");return}Et.tax_type&&ce(String(Et.tax_type));const Ht=Number(Et.tax_rate_percent??12.5);Ae(Number.isFinite(Ht)?Ht:12.5);const Ot=String(Et.tax_name||"").trim(),ls=String(Et.tax_code||"").trim(),Ls=String(Et.tax_code_id||"").trim();_e(Ot||ls||Ls||"")}).catch(()=>{Me&&(Ie(!1),Ae(0),ce("Exclusive"),_e(""))}),()=>{Me=!1}},[]),v.useEffect(()=>{let Me=!0;async function Nt(){var Et,$t,Ht;try{const ls=($t=(Et=(await te.get("/admin/me")).data)==null?void 0:Et.scope)==null?void 0:$t.companyId;if(!ls){if(!Me)return;Ze(Hs=>({...Hs,logoUrl:Hs.logoUrl||Gs}));return}const Is=((Ht=(await te.get(`/admin/companies/${ls}`)).data)==null?void 0:Ht.item)||{};if(!Me)return;Ze(Hs=>({...Hs,name:Is.name||Hs.name||"",address:Is.address||Hs.address||"",city:Is.city||Hs.city||"",state:Is.state||Hs.state||"",country:Is.country||Hs.country||"",phone:Is.telephone||Hs.phone||"",email:Is.email||Hs.email||"",website:Is.website||Hs.website||"",taxId:Is.tax_id||Hs.taxId||"",registrationNo:Is.registration_no||Hs.registrationNo||"",logoUrl:Is.has_logo===1||Is.has_logo===!0?`/api/admin/companies/${ls}/logo`:Hs.logoUrl||Gs}))}catch{if(!Me)return;Ze(Ot=>({...Ot,logoUrl:Ot.logoUrl||Gs}))}}return Nt(),()=>{Me=!1}},[]),v.useEffect(()=>{let Me=!0;return X(!0),H(""),te.get("/sales/price-types").then(Nt=>{var $t;if(!Me)return;const Et=Array.isArray(($t=Nt.data)==null?void 0:$t.items)?Nt.data.items:[];if(Y(Et),!S&&Et.length){let Ht=Et.find(Ot=>String(Ot.name||"").trim().toLowerCase()==="retail")||Et[0];Ht&&Ht.id&&k(String(Ht.id))}}).catch(Nt=>{var Et,$t;Me&&H((($t=(Et=Nt==null?void 0:Nt.response)==null?void 0:Et.data)==null?void 0:$t.message)||"Failed to load price types")}).finally(()=>{Me&&X(!1)}),()=>{Me=!1}},[S]),v.useEffect(()=>{let Me=!0;return O(!0),V(""),te.get("/inventory/items").then(Nt=>{var Ht;if(!Me)return;const $t=(Array.isArray((Ht=Nt.data)==null?void 0:Ht.items)?Nt.data.items:[]).filter(Ot=>Ot&&Ot.is_active!==!1).map(Ot=>({id:Ot.id,name:Ot.item_name||"",code:Ot.item_code||"",price:Number(Ot.selling_price??0),availQty:Number(Ot.avail_qty??0),image_url:Ot.image_url||"",barcode:Ot.barcode||""}));q($t)}).catch(Nt=>{var Et,$t;Me&&V((($t=(Et=Nt==null?void 0:Nt.response)==null?void 0:Et.data)==null?void 0:$t.message)||"Failed to load items")}).finally(()=>{Me&&O(!1)}),()=>{Me=!1}},[]);const lt=v.useMemo(()=>l.reduce((Me,Nt)=>{const Et=Number(Nt.quantity||0),$t=Number(Nt.price||0);return Me+Et*$t},0),[l]),Ne=v.useMemo(()=>l.reduce((Me,Nt)=>{const Et=Number(Nt.quantity||0),$t=Number(Nt.price||0),Ht=Number(Nt.discount||0),Ot=Math.max(0,Et*$t-Ht);return Me+Ot},0),[l]),Xe=v.useMemo(()=>{const Me=lt-Ne;return!Number.isFinite(Me)||Me<0?0:Me},[lt,Ne]),Ge=v.useMemo(()=>{const Me=Number(se||0)/100;return!Me||Ne<=0?0:Ne*Me},[Ne,se]),at=v.useMemo(()=>Ne+Ge,[Ne,Ge]),xt=v.useMemo(()=>{const Me=Number(Ue||0);return Number.isFinite(Me)?Me:0},[Ue]),wt=v.useMemo(()=>{const Me=xt-at;return Number.isFinite(Me)?Me:0},[xt,at]),pt=v.useRef(null),ge=v.useRef(null),rt=v.useRef(null),ht=v.useMemo(()=>!E.length||!oe?null:E.find(Me=>String(Me.id)===String(oe))||null,[E,oe]);function ft(Me){const Nt=String((Me==null?void 0:Me.type)||"").toLowerCase();return Nt==="cash"?"CASH":Nt==="card"||Nt==="bank"?"CARD":Nt==="mobile"?"MOBILE":"CASH"}async function St(Me,Nt,Et){var $t;try{const Ht={product_id:Me,quantity:1,price_type:Nt||"",only_standard:!0},Ot=await te.post("/sales/prices/best-price",Ht),ls=Number(($t=Ot.data)==null?void 0:$t.price);return Number.isFinite(ls)?ls:Number(Et||0)}catch{return Number(Et||0)}}async function Je(Me,Nt){const $t=Math.max(1,Number(Nt));if(!Me||!$t)return;if(Number(Me.availQty||0)<1){ze({open:!0,itemName:Me.name||Me.code||"Selected item"});return}const Ht=await St(Me.id,S,Me.price);if(o(Ot=>Ot.find(Ls=>Ls.id===Me.id)?Ot.map(Ls=>{if(Ls.id!==Me.id)return Ls;const Is=Ls.quantity+$t;return{...Ls,quantity:Is,price:Ht,discount:Number(Ls.discount||0)}}):[...Ot,{id:Me.id,name:Me.name,code:Me.code,price:Ht,quantity:$t,discount:0}]),I(Ot=>Ot.some(ls=>ls.id===Me.id)?Ot:[...Ot,Me]),g(String(Me.id)),f(""),j(1),rt.current)try{rt.current.focus()}catch{}if(pt.current)try{pt.current.scrollIntoView({behavior:"smooth",block:"start"})}catch{}}function ts(Me){const Nt=B.find(Et=>String(Et.id)===String(Me))||null;Nt&&Je(Nt,1),y("")}function Kt(Me,Nt){o(Et=>Et.map(Ht=>Ht.id===Me?{...Ht,quantity:Math.max(0,Number(Ht.quantity||0)+Nt)}:Ht).filter(Ht=>Number(Ht.quantity||0)>0))}function fe(Me,Nt,Et){o($t=>$t.map(Ht=>{if(Ht.id!==Me)return Ht;if(Nt==="quantity"){const Ot=Number(Et||0);return{...Ht,quantity:Ot>0?Ot:0}}if(Nt==="discount"){const Ot=Number(Et||0);return{...Ht,discount:Ot>=0?Ot:0}}return Ht}).filter(Ht=>Number(Ht.quantity||0)>0))}function Oe(Me){o(Nt=>Nt.filter(Et=>Et.id!==Me)),I(Nt=>Nt.filter(Et=>Et.id!==Me)),Number(x||0)===Me&&(g(""),j(1))}function Se(Me){Oe(Me)}function Le(){l.length&&(o([]),I([]))}v.useEffect(()=>{ge.current&&(clearTimeout(ge.current),ge.current=null);const Me=String(h||"").trim().toLowerCase();if(!Me)return;const Nt=B.find(Et=>{const $t=String(Et.code||"").toLowerCase(),Ht=String(Et.name||"").toLowerCase(),Ot=String(Et.barcode||"").toLowerCase();return $t===Me||Ht===Me||Ot===Me});return Nt?ge.current=setTimeout(()=>{Je(Nt,1)},120):We({open:!0,code:Me}),()=>{ge.current&&(clearTimeout(ge.current),ge.current=null)}},[h,B]),v.useEffect(()=>{const Me=Number(x||0);if(!Me)return;const Nt=l.find($t=>$t.id===Me);if(!Nt){j(1);return}const Et=Number(Nt.quantity||0);j(Et||0)},[l,x]),v.useEffect(()=>{I(Me=>(Array.isArray(Me)?Me:[]).filter(Nt=>l.some(Et=>Et.id===Nt.id)))},[l]),v.useEffect(()=>{if(ke&&rt.current)try{rt.current.focus()}catch{}},[ke]);async function Ye(){var Me,Nt,Et,$t,Ht,Ot;if(!(!l.length||u)){if(!ke)try{const ls=me?{params:{terminal:me}}:void 0,Ls=await te.get("/pos/day/status",ls),Is=((Me=Ls==null?void 0:Ls.data)==null?void 0:Me.item)||null;if(!(String((Is==null?void 0:Is.status)||"").toUpperCase()==="OPEN")){alert("Day is not open. Please open the POS day before sales entry.");return}pe(!0)}catch{alert("Day is not open. Please open the POS day before sales entry.");return}try{d(!0);let ls=oe?String(oe):"";if(!ls){const yr=Array.isArray(E)?E:[],cr=yr.find(ka=>String(ka.type||"").trim().toLowerCase()==="cash")||yr[0];cr!=null&&cr.id&&(ls=String(cr.id),ee(String(cr.id)))}if(!ls){alert("Please configure a POS payment mode before completing a sale.");return}const Ls=l.map(yr=>({item_id:yr.id,name:yr.name,quantity:Number(yr.quantity||0),price:Number(yr.price||0),discount:Number(yr.discount||0)})),Hs={payment_method:ft(ht),payment_mode_id:Number(ls),customer_name:null,lines:Ls,status:"COMPLETED",terminal:me||"",tax_rate_percent:Qe?se:0,tax_type:Qe?we:"Exclusive"},Ir=await te.post("/pos/sales",Hs),ya=String(((Nt=Ir.data)==null?void 0:Nt.receipt_no)||"");m(ya),F(new Date),K(!0)}catch(ls){const Ls=(($t=(Et=ls==null?void 0:ls.response)==null?void 0:Et.data)==null?void 0:$t.message)||((Ot=(Ht=ls==null?void 0:ls.response)==null?void 0:Ht.data)==null?void 0:Ot.error)||"Failed to complete sale";alert(Ls)}finally{d(!1)}}}function st(){if(K(!1),o([]),I([]),m(""),f(""),g(""),j(1),F(null),rt.current)try{rt.current.focus()}catch{}}async function It(){var Me;try{const Et=((Me=(await te.get("/pos/receipt-settings")).data)==null?void 0:Me.item)||null;return Et?{companyName:Et.company_name||"",showLogo:Et.show_logo===1||Et.show_logo===!0||Et.show_logo==="1",headerText:Et.header_text||"",footerText:Et.footer_text||"",contactNumber:Et.contact_number||"",addressLine1:Et.address_line1||"",addressLine2:Et.address_line2||"",logoUrl:Et.logo_url||""}:{}}catch{return{}}}async function Ft(){var Oi;if(!l.length)return;const Me=await It(),Et=(_?new Date(_):new Date).toLocaleString(),$t=(ht==null?void 0:ht.name)||(function(){const Qr=String((ht==null?void 0:ht.type)||"").toLowerCase();return Qr==="cash"?"Cash":Qr==="card"?"Card":Qr==="mobile"?"Mobile Money":Qr==="bank"?"Bank":"Other"})(),Ht=String(Me.companyName||Ve.name||"Company Name"),Ot=[];Ve.address&&Ot.push(Ve.address);const ls=[Ve.city,Ve.state].filter(Boolean).join(", ");ls&&Ot.push(ls),Ve.country&&Ot.push(Ve.country);const Ls=String(Ot[0]||Me.addressLine1||"Street address"),Is=String(Ot.slice(1).join("  ")||Me.addressLine2||"City, State, ZIP"),Hs=String(Ve.phone||Me.contactNumber||"+1234567890"),Ir=String(Me.headerText||"Thank you for your purchase"),ya=String(Me.footerText||"Please visit again"),yr=[];Ve.taxId&&yr.push(`TIN: ${Ve.taxId}`),Ve.website&&yr.push(Ve.website);const cr=yr.join("  ");let Ks=!!Me.showLogo?String(Me.logoUrl||"").trim():"";if(Ks&&!(Ks.startsWith("http://")||Ks.startsWith("https://")||Ks.startsWith("data:"))){const Fn=window.location.origin||"";Ks.startsWith("/")?Ks=Fn+Ks:Ks=Fn+"/"+Ks}const jr=Ks?`<div class="center"><img src="${Ks}" alt="${Ht}" style="max-height:100px;margin-bottom:8px;object-fit:contain;" /></div>`:"",nl=l.map(Qr=>{const Fn=Number(Qr.quantity||0),ji=Number(Qr.price||0),Gn=Number(Qr.discount||0),Kn=Math.max(0,Fn*ji-Gn);return`
          <tr>
            <td>${Qr.name||""}</td>
            <td class="right">${Fn}</td>
            <td class="right">GH ${ji.toFixed(2)}</td>
            <td class="right">GH ${Gn.toFixed(2)}</td>
            <td class="right">GH ${Kn.toFixed(2)}</td>
          </tr>
        `}).join(""),zr=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Receipt</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          .footer { margin-top: 10px; text-align: center; font-size: 11px; white-space: pre-wrap; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        ${jr}
        <h1>${Ht}</h1>
        <div class="center muted">${Ls}</div>
        <div class="center muted">${Is}</div>
        <div class="center muted">Mobile: ${Hs}</div>
        ${cr?`<div class="center muted">${cr}</div>`:""}
        <div class="center muted" style="margin-top:6px;">${Ir}</div>
        <hr />
        <div class="row"><span>Receipt No:</span><span>${c||"-"}</span></div>
        <div class="row"><span>Date:</span><span>${Et}</span></div>
        <div class="row"><span>Payment:</span><span>${$t}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Disc</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${nl}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Subtotal</span><span>GH ${Ne.toFixed(2)}</span></div>${Qe?`<div class="row"><span>Tax</span><span>GH ${Ge.toFixed(2)}</span></div>`:""}
          <div class="row"><strong>Grand Total</strong><strong>GH ${at.toFixed(2)}</strong></div>
          <div class="row"><span>Amount Paid</span><span>GH ${xt.toFixed(2)}</span></div>
          <div class="row"><span>${wt>=0?"Change":"Amount Due"}</span><span>GH ${Math.abs(wt).toFixed(2)}</span></div>
        </div>
        <div class="footer">${ya}</div>
      </body>
      </html>
    `,sa=document.createElement("iframe");sa.style.position="fixed",sa.style.right="0",sa.style.bottom="0",sa.style.width="0",sa.style.height="0",sa.style.border="0",document.body.appendChild(sa);const on=((Oi=sa.contentWindow)==null?void 0:Oi.document)||sa.contentDocument||null;if(!on){document.body.removeChild(sa);return}on.open(),on.write(zr),on.close();const yi=sa.contentWindow||window;setTimeout(()=>{yi.focus();try{yi.print()}catch{}setTimeout(()=>{document.body.removeChild(sa)},100)},200)}async function Bt(){var Me,Nt,Et;try{const $t=await te.get("/inventory/items"),Ot=(Array.isArray((Me=$t.data)==null?void 0:Me.items)?$t.data.items:[]).filter(ls=>ls&&ls.is_active!==!1).map(ls=>({id:ls.id,name:ls.item_name||"",code:ls.item_code||"",price:Number(ls.selling_price??0),availQty:Number(ls.avail_qty??0),image_url:ls.image_url||"",barcode:ls.barcode||""}));q(Ot)}catch($t){V(((Et=(Nt=$t==null?void 0:$t.response)==null?void 0:Nt.data)==null?void 0:Et.message)||"Failed to load items")}}function Tt(){if(!(typeof s=="function"?s("/inventory/items/new","create"):!0)){$e("You do not have permission");return}$e(""),Te(!0)}return e.jsxs("div",{className:"space-y-6 pos-sales-entry",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Sales Entry"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:r.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:r.toLocaleTimeString()}),e.jsxs("div",{className:"mt-1 text-xs",children:[e.jsx("span",{className:"mr-2",children:"Terminal:"}),e.jsx("span",{className:"font-semibold",children:me||"-"}),e.jsxs("span",{className:"ml-3",children:["Status:",e.jsx("span",{className:`ml-1 px-2 py-0.5 rounded ${ke?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ke?"Open":"Closed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[!he&&!ke&&e.jsxs("div",{className:"alert-danger rounded-lg p-4",children:["Day is not open. Open day before sales entry.",e.jsx("div",{className:"mt-2",children:e.jsx(Ee,{to:"/pos/day-management",className:"btn-secondary",children:"Open Day Management"})})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Barcode"}),e.jsx("input",{className:"input",placeholder:"Scan or type barcode",value:h,onChange:Me=>f(Me.target.value),ref:rt,autoFocus:!0,disabled:!ke})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Item"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"input",placeholder:Q?"Loading items...":"Type to search items",value:b,onChange:Me=>y(Me.target.value),onKeyDown:Me=>{Me.key==="Enter"&&it.length&&ts(it[0].value)},disabled:!ke||Q||!B.length}),b&&it.length?e.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-lg max-h-48 overflow-auto",children:it.map(Me=>e.jsx("button",{type:"button",className:"block w-full text-left px-3 py-2 hover:bg-slate-50",onClick:()=>ts(Me.value),children:Me.label},Me.value))}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quantity"}),e.jsx("input",{type:"number",className:"input",min:1,value:N,onChange:Me=>{const Nt=Me.target.value;j(Nt);const Et=Number(x||0);Et&&fe(Et,"quantity",Nt)},disabled:!ke})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsx(IZ,{value:S,onChange:Me=>k(Me),options:D.map(Me=>({value:String(Me.id),label:String(Me.name||"")})),placeholder:M?"Loading price types...":"Select Price Type",disabled:!ke||M||!D.length,filterPlaceholder:"Filter price types..."})]})]})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Item Information"}),P.length?e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 text-slate-700",children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Item Code"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Item Name"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Avail_Qty"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"QTY"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Discount"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:P.map(Me=>{const Nt=l.find(ls=>ls.id===Me.id)||null,Et=Number((Nt==null?void 0:Nt.quantity)||0),$t=Number((Nt==null?void 0:Nt.price)||0),Ht=Number((Nt==null?void 0:Nt.discount)||0),Ot=Math.max(0,Et*$t-Ht);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2",children:Me.code}),e.jsx("td",{className:"px-3 py-2",children:Me.name}),e.jsx("td",{className:"px-3 py-2 text-right",children:`GH ${$t.toFixed(2)}`}),e.jsx("td",{className:"px-3 py-2 text-right",children:Number(Me.availQty||0)}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("input",{type:"number",className:"input text-right w-24",min:0,value:Et,onChange:ls=>fe(Me.id,"quantity",ls.target.value)})}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("input",{type:"number",className:"input text-right w-24",min:0,step:"0.01",value:Ht,onChange:ls=>fe(Me.id,"discount",ls.target.value)})}),e.jsx("td",{className:"px-3 py-2 text-right",children:`GH ${Ot.toFixed(2)}`}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("button",{type:"button",className:"btn-danger inline-flex items-center justify-center",onClick:()=>Se(Me.id),children:e.jsx(Gl,{className:"w-4 h-4"})})})]},Me.id)})})]})}):e.jsx("div",{className:"rounded-lg border border-slate-200 bg-white p-6 text-center text-sm text-slate-600",children:"Select an item by barcode or from the item filter to view details"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Shopping Cart"})}),e.jsxs("div",{className:"card-body space-y-3",ref:pt,children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:l.length?l.map(Me=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:Me.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:["GH ",Number(Me.price).toFixed(2)," each",Number(Me.discount||0)>0?e.jsxs("span",{className:"ml-2 text-amber-600",children:["Disc GH ",Number(Me.discount||0).toFixed(2)]}):null]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Kt(Me.id,-1),children:"-"}),e.jsx("span",{className:"text-sm font-semibold",children:Me.quantity}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Kt(Me.id,1),children:"+"}),e.jsx("button",{type:"button",className:"btn-danger inline-flex items-center justify-center",onClick:()=>Oe(Me.id),children:e.jsx(Gl,{className:"w-4 h-4"})})]})]},Me.id)):e.jsx("div",{className:"text-center text-slate-600",children:"Cart is empty"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Discount"}),e.jsx("div",{children:`GH ${Xe.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{children:`GH ${Ne.toFixed(2)}`})]}),Qe?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax"}),e.jsx("div",{children:`GH ${Ge.toFixed(2)}`})]}):null,e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{children:`GH ${at.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("label",{htmlFor:"amountPaid",className:"mr-2",children:"Amount Paid"}),e.jsx("input",{id:"amountPaid",type:"number",inputMode:"decimal",className:"input text-right w-36",step:"0.01",min:"0",value:Ue,onChange:Me=>ct(Me.target.value),placeholder:"0.00",disabled:!ke})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:wt>=0?"Change":"Amount Due"}),e.jsx("div",{className:wt>=0?"text-emerald-600":"text-red-600",children:`GH ${Math.abs(wt).toFixed(2)}`})]})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:U?e.jsx("div",{className:"col-span-2 text-center text-sm text-slate-500",children:"Loading payment modes..."}):E.length?E.map(Me=>e.jsx("button",{type:"button",className:`btn ${String(oe)===String(Me.id)?"btn-primary":"btn-secondary"}`,onClick:()=>ee(String(Me.id)),disabled:!ke,children:Me.name},Me.id)):e.jsx("div",{className:"col-span-2 text-center text-sm text-slate-500",children:"No payment modes configured"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"button",className:"btn-success w-full",onClick:Le,disabled:!ke,children:"Clear Cart"}),e.jsx("button",{type:"button",className:"btn-success w-full",onClick:Ye,disabled:!ke||!l.length||u||U||!E.length||!oe,children:"Complete Sale"})]})]})})]})]}),dt.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-xl font-bold text-red-700",children:"Item Not Found"}),e.jsxs("div",{className:"mt-2 text-sm",children:['The scanned/entered code "',dt.code,'" is not in the system.']}),Ke?e.jsx("div",{className:"mt-2 text-sm text-red-600",children:Ke}):null,e.jsxs("div",{className:"mt-4 flex gap-2 justify-end",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>We({open:!1,code:""}),children:"Close"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:Tt,children:"Add Item"})]})]})}),Pe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-5xl overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("div",{className:"text-lg font-semibold",children:"New Item Setup"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:()=>Te(!1),children:""})]}),e.jsx("div",{className:"max-h-[80vh] overflow-y-auto p-4",children:e.jsx(Tk,{forceNew:!0,initialValues:{barcode:h||"",item_name:""},onSaved:async()=>{Te(!1),We({open:!1,code:""}),await Bt()}})})]})}),He.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-xl font-bold text-amber-700",children:"No Stock Available"}),e.jsxs("div",{className:"mt-2 text-sm",children:['There is no stock available for "',He.itemName,'". Sales cannot be made for this product.']}),e.jsx("div",{className:"mt-4 flex gap-2 justify-end",children:e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>ze({open:!1,itemName:""}),children:"Close"})})]})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:"Sale Completed"}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Receipt No"}),e.jsx("div",{className:"font-semibold",children:c||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{className:"font-semibold",children:`GH ${at.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Amount Paid"}),e.jsx("div",{className:"font-semibold",children:`GH ${xt.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:wt>=0?"Change":"Amount Due"}),e.jsx("div",{className:"font-semibold",children:`GH ${Math.abs(wt).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Payment Method"}),e.jsx("div",{className:"font-semibold",children:(ht==null?void 0:ht.name)||(function(){const Me=String((ht==null?void 0:ht.type)||"").toLowerCase();return Me==="cash"?"Cash":Me==="card"?"Card":Me==="mobile"?"Mobile Money":Me==="bank"?"Bank":"Other"})()})]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:st,children:"New Sale"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Ft,children:"Print Receipt"})]})]})})]})}function DZ({value:t,onChange:s,options:r,disabled:a,filterPlaceholder:n}){const i=Array.isArray(r)?r:[];return e.jsx("div",{className:"space-y-2",children:e.jsx("select",{className:"input",value:t,onChange:l=>s(l.target.value),disabled:a,children:i.map(l=>e.jsx("option",{value:String(l.value),children:l.label},String(l.value)))})})}function PZ(){const[t,s]=v.useState(!1),[r,a]=v.useState([]),[n,i]=v.useState("ALL"),[l,o]=v.useState(""),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState("ALL"),[x,g]=v.useState(null),[b,y]=v.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:Gs}),[N,j]=v.useState(!1),[S,k]=v.useState(""),[P,I]=v.useState({});v.useEffect(()=>{let R=!1;return s(!0),te.get("/pos/sales").then(H=>{var W;R||a(Array.isArray((W=H.data)==null?void 0:W.items)?H.data.items:[])}).catch(()=>{R||a([])}).finally(()=>{R||s(!1)}),()=>{R=!0}},[]),v.useEffect(()=>{let R=!0;async function H(){var W;try{const _=((W=(await te.get("/pos/receipt-settings")).data)==null?void 0:W.item)||null;if(!R)return;if(!_){I({});return}I({companyName:_.company_name||"",showLogo:_.show_logo===1||_.show_logo===!0||String(_.show_logo).toLowerCase()==="true",headerText:_.header_text||"",footerText:_.footer_text||"",contactNumber:_.contact_number||"",addressLine1:_.address_line1||"",addressLine2:_.address_line2||"",logoUrl:_.logo_url||""})}catch{if(!R)return;I({})}}return H(),()=>{R=!1}},[]),v.useEffect(()=>{let R=!0;async function H(){var W,K,_;try{const E=(K=(W=(await te.get("/admin/me")).data)==null?void 0:W.scope)==null?void 0:K.companyId;if(!E){if(!R)return;y(J=>({...J,logoUrl:J.logoUrl||Gs}));return}const U=((_=(await te.get(`/admin/companies/${E}`)).data)==null?void 0:_.item)||{};if(!R)return;y(J=>({...J,name:U.name||J.name||"",address:U.address||J.address||"",city:U.city||J.city||"",state:U.state||J.state||"",country:U.country||J.country||"",phone:U.telephone||J.phone||"",email:U.email||J.email||"",website:U.website||J.website||"",taxId:U.tax_id||J.taxId||"",registrationNo:U.registration_no||J.registrationNo||"",logoUrl:U.has_logo===1||U.has_logo===!0?`/api/admin/companies/${E}/logo`:J.logoUrl||Gs}))}catch{if(!R)return;y(F=>({...F,logoUrl:F.logoUrl||Gs}))}}return H(),()=>{R=!1}},[]);const B=v.useMemo(()=>{const R=new Map;for(const H of r){const W=String(H.collector_username||"").trim(),K=String(H.collector_full_name||"").trim(),_=W||K;_&&(R.has(_)||R.set(_,{key:_,label:W||K}))}return Array.from(R.values()).sort((H,W)=>String(H.label||"").localeCompare(String(W.label||"")))},[r]),q=v.useMemo(()=>[{value:"ALL",label:"All collectors"},...B.map(R=>({value:R.key,label:R.label}))],[B]),Q=v.useMemo(()=>{const R=String(c||"").trim().toLowerCase(),H=h==="ALL"?"":String(h||"").trim();return r.filter(W=>{const K=R?String(W.sale_no||"").toLowerCase().includes(R):!0,_=n==="ALL"?!0:String(W.payment_status||"")===n,F=String(W.sale_date||"").slice(0,10),E=l?F>=l:!0,L=u?F<=u:!0,U=String(W.collector_username||W.collector_full_name||"").trim();return K&&_&&E&&L&&(H?U===H:!0)})},[r,c,n,l,u,h]),O=v.useMemo(()=>{const R=Q.reduce((K,_)=>K+Number(_.total_amount||0),0),H=Q.reduce((K,_)=>K+(String(_.payment_status||"")==="PAID"?Number(_.total_amount||0):0),0),W=R-H;return{count:Q.length,totalAmount:R,cashCollected:H,outstanding:W}},[Q]),T=v.useMemo(()=>{const R={};for(const H of Q){const W=String(H.payment_method||"").toUpperCase()||"UNKNOWN",K=Number(H.total_amount||0),_=String(H.payment_status||"")==="PAID";R[W]||(R[W]={method:W,invoices:0,totalAmount:0,collectedAmount:0}),R[W].invoices+=1,R[W].totalAmount+=K,_&&(R[W].collectedAmount+=K)}return Object.values(R)},[Q]);function V(R,H){const W=P||{},K=String(b.name||W.companyName||"Company Name"),_=[];b.address&&_.push(b.address);const F=[b.city,b.state].filter(Boolean).join(", ");F&&_.push(F),b.country&&_.push(b.country);const E=String(_[0]||W.addressLine1||"Street address"),L=String(_.slice(1).join("  ")||W.addressLine2||"City, State, ZIP"),U=String(b.phone||W.contactNumber||"+1234567890"),J=String(W.headerText||"Thank you for your purchase"),ae=String(W.footerText||"Please visit again"),Z=[];b.taxId&&Z.push(`TIN: ${b.taxId}`),b.website&&Z.push(b.website);const oe=Z.join("  ");let ee=String(W.logoUrl||b.logoUrl||"").trim();if(ee&&!(ee.startsWith("http://")||ee.startsWith("https://")||ee.startsWith("data:"))){const me=window.location.origin||"";ee.startsWith("/")?ee=me+ee:ee=me+"/"+ee}const se=ee?`<div class="center"><img src="${ee}" alt="${K}" style="max-height:100px;margin-bottom:8px;object-fit:contain;" /></div>`:"",we=(R&&R.sale_date?new Date(R.sale_date):new Date).toLocaleString(),ce=(function(){const je=String((R==null?void 0:R.payment_method)||"").toUpperCase();return je==="CASH"?"Cash":je==="CARD"?"Card":je==="MOBILE"?"Mobile Money":je==="BANK"?"Bank":"Other"})(),le=(Array.isArray(H)?H:[]).map(je=>{const me=Number(je.qty||0),xe=Number(je.unit_price||0),Ue=Number(je.line_total||me*xe||0);return`
          <tr>
            <td>${je.item_name||""}</td>
            <td class="right">${me.toFixed(2)}</td>
            <td class="right">${xe.toFixed(2)}</td>
            <td class="right">${Ue.toFixed(2)}</td>
          </tr>
        `}).join(""),_e=Number((R==null?void 0:R.gross_amount)||0),Qe=Number((R==null?void 0:R.discount_amount)||0),Ie=Number((R==null?void 0:R.tax_amount)||0),ke=_e-Qe,pe=Number((R==null?void 0:R.net_amount)||(R==null?void 0:R.total_amount)||ke+Ie);return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Invoice</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          .footer { margin-top: 10px; text-align: center; font-size: 11px; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        ${se}
        <h1>${K}</h1>
        <div class="center muted">${E}</div>
        <div class="center muted">${L}</div>
        <div class="center muted">Mobile: ${U}</div>
        ${oe?`<div class="center muted">${oe}</div>`:""}
        <div class="center muted" style="margin-top:6px;">${J}</div>
        <hr />
        <div class="row"><span>Receipt No:</span><span>${(R==null?void 0:R.sale_no)||"-"}</span></div>
        <div class="row"><span>Date:</span><span>${we}</span></div>
        <div class="row"><span>Payment:</span><span>${ce}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${le}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Subtotal</span><span>${ke.toFixed(2)}</span></div>
          <div class="row"><span>Discount</span><span>${Qe.toFixed(2)}</span></div>
          <div class="row"><span>Tax</span><span>${Ie.toFixed(2)}</span></div>
          <div class="row"><strong>Total</strong><strong>${pe.toFixed(2)}</strong></div>
        </div>
        <div class="footer">${ae}</div>
      </body>
      </html>
    `}async function D(R){var H,W;if(!(!R||!R.id)){g(R.id);try{const K=await te.get(`/pos/sales/${R.id}`),_=((H=K.data)==null?void 0:H.item)||null,F=Array.isArray((W=K.data)==null?void 0:W.details)?K.data.details:[];if(!_){alert("Invoice not found");return}const E=V(_,F);k(E),j(!0)}catch{alert("Failed to load invoice")}finally{g(null)}}}async function Y(R){var H,W,K;if(!(!R||!R.id)){g(R.id);try{const _=await te.get(`/pos/sales/${R.id}`),F=((H=_.data)==null?void 0:H.item)||null,E=Array.isArray((W=_.data)==null?void 0:W.details)?_.data.details:[];if(!F){alert("Invoice not found");return}const L=V(F,E),U=document.createElement("iframe");U.style.position="fixed",U.style.right="0",U.style.bottom="0",U.style.width="0",U.style.height="0",U.style.border="0",document.body.appendChild(U);const J=((K=U.contentWindow)==null?void 0:K.document)||U.contentDocument||null;if(!J){document.body.removeChild(U);return}J.open(),J.write(L),J.close();const ae=U.contentWindow||window;setTimeout(()=>{ae.focus();try{ae.print()}catch{}setTimeout(()=>{document.body.removeChild(U)},100)},200)}catch{alert("Failed to load invoice"),g(null)}}}async function M(R){var H,W;if(!(!R||!R.id)){g(R.id);try{const K=await te.get(`/pos/sales/${R.id}`),_=((H=K.data)==null?void 0:H.item)||null,F=Array.isArray((W=K.data)==null?void 0:W.details)?K.data.details:[];if(!_){alert("Invoice not found");return}const E=loadReceiptSettings(),L=String(b.name||E.companyName||"Company Name"),U=[];b.address&&U.push(b.address);const J=[b.city,b.state].filter(Boolean).join(", ");J&&U.push(J),b.country&&U.push(b.country);const ae=String(U[0]||E.addressLine1||"Street address"),Z=String(U.slice(1).join("  ")||E.addressLine2||"City, State, ZIP"),oe=String(b.phone||E.contactNumber||"+1234567890"),ee=String(E.headerText||"Thank you for your purchase"),Ae=(_&&_.sale_date?new Date(_.sale_date):new Date).toLocaleString(),we=(function(){const xe=String((_==null?void 0:_.payment_method)||"").toUpperCase();return xe==="CASH"?"Cash":xe==="CARD"?"Card":xe==="MOBILE"?"Mobile Money":xe==="BANK"?"Bank":"Other"})(),ce=Number((_==null?void 0:_.gross_amount)||0),le=Number((_==null?void 0:_.discount_amount)||0),_e=Number((_==null?void 0:_.tax_amount)||0),Qe=ce-le,Ie=Number((_==null?void 0:_.net_amount)||(_==null?void 0:_.total_amount)||Qe+_e),ke=new As("p","mm","a4");let pe=15;ke.setFontSize(14),ke.text(L,10,pe),pe+=6,ke.setFontSize(10),ke.text(ae,10,pe),pe+=5,ke.text(Z,10,pe),pe+=5,ke.text("Mobile: "+oe,10,pe),pe+=5;const he=[];b.taxId&&he.push(`TIN: ${b.taxId}`),b.website&&he.push(b.website);const je=he.join("  ");je&&(ke.text(je,10,pe),pe+=5),pe+=1,ke.text(ee,10,pe),pe+=8,ke.setFontSize(11),ke.text("Receipt No: "+(_.sale_no||"-"),10,pe),pe+=5,ke.text("Date: "+Ae,10,pe),pe+=5,ke.text("Payment: "+we,10,pe),pe+=8,ke.setFontSize(10),ke.text("Item",10,pe),ke.text("Qty",90,pe),ke.text("Price",120,pe),ke.text("Total",160,pe),pe+=4,ke.line(10,pe,200,pe),pe+=5,(Array.isArray(F)?F:[]).forEach(xe=>{const Ue=Number(xe.qty||0),ct=Number(xe.unit_price||0),dt=Number(xe.line_total||Ue*ct||0);pe>270&&(ke.addPage(),pe=15);const We=String(xe.item_name||""),He=40;(We.length>He?[We.slice(0,He),We.slice(He)]:[We]).forEach(Pe=>{ke.text(Pe,10,pe),ke.text(Ue.toFixed(2),90,pe,{align:"right"}),ke.text(ct.toFixed(2),120,pe,{align:"right"}),ke.text(dt.toFixed(2),160,pe,{align:"right"}),pe+=5})}),pe+=4,ke.line(10,pe,200,pe),pe+=6,ke.text("Subtotal:",120,pe,{align:"right"}),ke.text(Qe.toFixed(2),160,pe,{align:"right"}),pe+=5,ke.text("Discount:",120,pe,{align:"right"}),ke.text(le.toFixed(2),160,pe,{align:"right"}),pe+=5,ke.text("Tax:",120,pe,{align:"right"}),ke.text(_e.toFixed(2),160,pe,{align:"right"}),pe+=5,ke.text("Total:",120,pe,{align:"right"}),ke.text(Ie.toFixed(2),160,pe,{align:"right"});const me=`POS_Invoice_${_.sale_no||R.id}.pdf`;ke.save(me)}catch{alert("Failed to download invoice")}finally{g(null)}}}function X(){j(!1),k("")}return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Cash Collection Details"}),e.jsx("p",{className:"text-sm mt-1",children:"List of all invoices from POS sales with collection summary"})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"From Date"}),e.jsx("input",{type:"date",className:"input",value:l,onChange:R=>o(R.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"To Date"}),e.jsx("input",{type:"date",className:"input",value:u,onChange:R=>d(R.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:n,onChange:R=>i(R.target.value),children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"PENDING",children:"Pending"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Collector"}),e.jsx(DZ,{value:h,onChange:f,options:q,disabled:!q.length,filterPlaceholder:"Filter collectors..."})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"label",children:"Invoice No"}),e.jsx("input",{className:"input",placeholder:"Search by invoice number",value:c,onChange:R=>m(R.target.value)})]})]})})}),e.jsxs("div",{className:"xl:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Invoices"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:O.count})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:`GH ${Number(O.totalAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Cash Collected"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:`GH ${Number(O.cashCollected).toFixed(2)}`})]})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Invoice Preview"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:X,children:""})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:S?e.jsx("iframe",{title:"Invoice Preview",srcDoc:S,className:"w-full h-[70vh] border-0"}):e.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"Loading invoice..."})})]})})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Payment Mode Summary"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 mt-3",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Payment Mode"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Invoices"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Total Amount"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Amount Collected"})]})}),e.jsx("tbody",{className:"bg-white",children:T.length?T.map(R=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:R.method}),e.jsx("td",{className:"p-2 text-right",children:Number(R.invoices||0).toLocaleString()}),e.jsx("td",{className:"p-2 text-right",children:`GH ${Number(R.totalAmount||0).toFixed(2)}`}),e.jsx("td",{className:"p-2 text-right",children:`GH ${Number(R.collectedAmount||0).toFixed(2)}`})]},R.method)):e.jsx("tr",{children:e.jsx("td",{className:"p-3 text-center text-slate-500",colSpan:4,children:"No data for selected filters"})})})]})})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Invoice No"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Date"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Payment Mode"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Amount Collected"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Collector"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Status"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white",children:t?e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:6,children:"Loading..."})}):Q.length?Q.map(R=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:R.sale_no}),e.jsx("td",{className:"p-2",children:String(R.sale_date||"").replace("T"," ").slice(0,16)}),e.jsx("td",{className:"p-2",children:String(R.payment_method||"").toUpperCase()||"-"}),e.jsx("td",{className:"p-2 text-right",children:`GH ${Number(R.total_amount||0).toFixed(2)}`}),e.jsx("td",{className:"p-2",children:R.collector_username||R.collector_full_name||"-"}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:String(R.payment_status||"")==="PAID"?"inline-block px-2 py-1 rounded bg-green-100 text-green-800":"inline-block px-2 py-1 rounded bg-yellow-100 text-yellow-800",children:String(R.payment_status||"")||"-"})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"text-brand hover:text-brand-600 font-medium text-sm",onClick:()=>D(R),disabled:x===R.id,children:"View"}),e.jsx("button",{type:"button",className:"btn-primary text-xs px-3 py-1.5",onClick:()=>Y(R),disabled:x===R.id,children:"Print"}),e.jsx("button",{type:"button",className:"btn-outline text-xs px-3 py-1.5",onClick:()=>M(R),disabled:x===R.id,children:"Download"})]})})]},R.id)):e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:6,children:"No invoices found"})})}),e.jsx("tfoot",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-semibold",colSpan:4,children:"Totals"}),e.jsx("td",{className:"p-2 text-right font-bold",children:`GH ${Number(O.totalAmount).toFixed(2)}`}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex flex-col text-xs",children:[e.jsxs("span",{className:"text-green-700",children:["Collected:"," ",`GH ${Number(O.cashCollected).toFixed(2)}`]}),e.jsxs("span",{className:"text-red-700",children:["Outstanding:"," ",`GH ${Number(O.outstanding).toFixed(2)}`]})]})})]})})]})})})})]})}function Rk(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Vc(t,s){const r=String(s||"").trim().replace(/^\./,"");if(!r)return;const a=r.split(".").filter(Boolean);let n=t;for(const i of a){if(n==null)return;n=n[i]}return n}function Fy(t,s,r=s){let a=String(t??"");return a=a.replace(/{{#each\s+([^}]+)}}([\s\S]*?){{\/each}}/g,(n,i,l)=>{const o=String(i||"").trim(),u=o.startsWith("@root.")?Vc(r,o.slice(6)):Vc(s,o)??Vc(r,o);return(Array.isArray(u)?u:[]).map(c=>Fy(l,c??{},r)).join("")}),a=a.replace(/{{{\s*([^}]+?)\s*}}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Vc(r,l.slice(6)):o=Vc(s,l)??Vc(r,l),String(o??"")}),a=a.replace(/{{\s*([^}]+?)\s*}}/g,(n,i)=>{const l=String(i||"").trim();let o;return l==="this"||l==="."?o=s:l.startsWith("@root.")?o=Vc(r,l.slice(6)):o=Vc(s,l)??Vc(r,l),Rk(o)}),a}function UZ(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Document</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}function RZ(t){const s=String(t||"").trim();if(!s)return"";if(s.startsWith("http://")||s.startsWith("https://")||s.startsWith("data:"))return s;const r=window.location.origin||"";return r?s.startsWith("/")?r+s:r+"/"+s:s}async function OZ(t){var r;const s=Array.from(((r=t==null?void 0:t.querySelectorAll)==null?void 0:r.call(t,"img"))||[]);s.length!==0&&await Promise.race([Promise.all(s.map(a=>new Promise(n=>{if(a.complete)return n();const i=()=>n();a.addEventListener("load",i,{once:!0}),a.addEventListener("error",i,{once:!0})}))),new Promise(a=>setTimeout(a,1500))])}function QZ(){const{user:t}=Qa(),[s,r]=v.useState(new Date),[a,n]=v.useState(!1),[i,l]=v.useState([]),[o,u]=v.useState(""),[d,c]=v.useState(""),[m,h]=v.useState("ALL"),[f,x]=v.useState(""),[g,b]=v.useState(null),[y,N]=v.useState(""),[j,S]=v.useState([]),[k,P]=v.useState(!1),[I,B]=v.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:Gs}),[q,Q]=v.useState(!1),[O,T]=v.useState(""),[V,D]=v.useState(null),[Y,M]=v.useState({});v.useEffect(()=>{const ee=setInterval(()=>r(new Date),1e3);return()=>clearInterval(ee)},[]),v.useEffect(()=>{let ee=!0;async function se(){var Ae;try{const ce=((Ae=(await te.get("/pos/receipt-settings")).data)==null?void 0:Ae.item)||null;if(!ee)return;if(!ce){M({});return}M({companyName:ce.company_name||"",showLogo:ce.show_logo===1||ce.show_logo===!0||String(ce.show_logo).toLowerCase()==="true",headerText:ce.header_text||"",footerText:ce.footer_text||"",contactNumber:ce.contact_number||"",addressLine1:ce.address_line1||"",addressLine2:ce.address_line2||"",logoUrl:ce.logo_url||""})}catch{if(!ee)return;M({})}}return se(),()=>{ee=!1}},[]),v.useEffect(()=>{let ee=!1;async function se(){var Ae,we,ce;P(!0);try{const[le,_e]=await Promise.all([te.get("/pos/terminals"),te.get("/pos/terminal-users")]);if(ee)return;const Qe=Array.isArray((Ae=le.data)==null?void 0:Ae.items)?le.data.items:[],Ie=Array.isArray((we=_e.data)==null?void 0:we.items)?_e.data.items:[],ke=Number((t==null?void 0:t.sub)||0)||Number((t==null?void 0:t.id)||0)||void 0,pe=new Set(Ie.filter(me=>Number(me==null?void 0:me.user_id)===ke).map(me=>Number(me==null?void 0:me.terminal_id)).filter(me=>Number.isFinite(me)&&me>0)),he=Qe.filter(me=>pe.has(Number(me==null?void 0:me.id)));S(he);const je=(he.length?String(((ce=he[0])==null?void 0:ce.code)||""):"")||"";N(je)}catch{if(ee)return;S([]),N("")}finally{if(ee)return;P(!1)}}return se(),()=>{ee=!0}},[t==null?void 0:t.id,t==null?void 0:t.sub]),v.useEffect(()=>{let ee=!1;n(!0);const se=y?{params:{terminal:y}}:{};return te.get("/pos/sales",se).then(Ae=>{var we;ee||l(Array.isArray((we=Ae.data)==null?void 0:we.items)?Ae.data.items:[])}).catch(()=>{ee||l([])}).finally(()=>{ee||n(!1)}),()=>{ee=!0}},[y]),v.useEffect(()=>{let ee=!0;async function se(){var Ae,we,ce;try{const _e=(we=(Ae=(await te.get("/admin/me")).data)==null?void 0:Ae.scope)==null?void 0:we.companyId;if(!_e){if(!ee)return;B(ke=>({...ke,logoUrl:ke.logoUrl||Gs}));return}const Ie=((ce=(await te.get(`/admin/companies/${_e}`)).data)==null?void 0:ce.item)||{};if(!ee)return;B(ke=>({...ke,name:Ie.name||ke.name||"",address:Ie.address||ke.address||"",city:Ie.city||ke.city||"",state:Ie.state||ke.state||"",country:Ie.country||ke.country||"",phone:Ie.telephone||ke.phone||"",email:Ie.email||ke.email||"",website:Ie.website||ke.website||"",taxId:Ie.tax_id||ke.taxId||"",registrationNo:Ie.registration_no||ke.registrationNo||"",logoUrl:Ie.has_logo===1||Ie.has_logo===!0?`/api/admin/companies/${_e}/logo`:ke.logoUrl||Gs}))}catch{if(!ee)return;B(le=>({...le,logoUrl:le.logoUrl||Gs}))}}return se(),()=>{ee=!1}},[]);const X=v.useMemo(()=>{const ee=String(f||"").trim().toLowerCase();return i.filter(se=>{const Ae=!ee||String(se.sale_no||"").toLowerCase().includes(ee)||String(se.customer_id||"").toLowerCase().includes(ee),we=m==="ALL"?!0:String(se.payment_status||"")===m,ce=String(se.sale_date||"").slice(0,10),le=o?ce>=o:!0,_e=d?ce<=d:!0;return Ae&&we&&le&&_e})},[i,f,m,o,d]),R=v.useMemo(()=>{const ee=X.length,se=X.reduce((ce,le)=>ce+Number(le.total_amount||0),0),Ae=X.reduce((ce,le)=>ce+(String(le.payment_status||"")==="PAID"?Number(le.total_amount||0):0),0),we=se-Ae;return{count:ee,totalAmount:se,paid:Ae,pending:we}},[X]);function H(){const ee=["Invoice No","Date","Customer","Amount","Status"],se=X.map(_e=>[String(_e.sale_no||""),String(_e.sale_date||"").replace("T"," ").slice(0,16),_e.customer_id?`#${_e.customer_id}`:"-",Number(_e.total_amount||0).toFixed(2),String(_e.payment_status||"")]),Ae=[ee.join(","),...se.map(_e=>_e.join(","))].join(`
`),we=new Blob([Ae],{type:"text/csv;charset=utf-8;"}),ce=URL.createObjectURL(we),le=document.createElement("a");le.href=ce,le.download="pos_invoices.csv",le.click(),URL.revokeObjectURL(ce)}function W(){window.print()}const K=async()=>{var ee,se;if(V!==null)return V;try{const Ae=await te.get("/admin/document-templates/RECEIPT"),we=String(((se=(ee=Ae.data)==null?void 0:ee.item)==null?void 0:se.template_html)||"").trim();return D(we),we}catch{return D(""),""}};function _(ee,se){const Ae=Y||{},ce=(ee&&ee.sale_date?new Date(ee.sale_date):new Date).toLocaleString(),le=(function(){const We=String((ee==null?void 0:ee.payment_method)||"").toUpperCase();return We==="CASH"?"Cash":We==="CARD"?"Card":We==="MOBILE"?"Mobile Money":We==="BANK"?"Bank":"Other"})(),_e=[];I.address&&_e.push(I.address);const Qe=[I.city,I.state].filter(Boolean).join(", ");Qe&&_e.push(Qe),I.country&&_e.push(I.country);const Ie=String(_e[0]||Ae.addressLine1||"Street address"),ke=String(_e.slice(1).join("  ")||Ae.addressLine2||"City, State, ZIP"),pe=RZ(String(Ae.logoUrl||I.logoUrl||"").trim()),he=pe?`<img src="${pe}" alt="${Rk(I.name||Ae.companyName||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",je=Number((ee==null?void 0:ee.gross_amount)||0),me=Number((ee==null?void 0:ee.discount_amount)||0),xe=Number((ee==null?void 0:ee.tax_amount)||0),Ue=je-me,ct=Number((ee==null?void 0:ee.net_amount)||(ee==null?void 0:ee.total_amount)||Ue+xe),dt=(Array.isArray(se)?se:[]).map(We=>{const He=Number(We.qty||0),ze=Number(We.unit_price||0),Pe=Number(We.line_total||He*ze||0);return{name:String(We.item_name||""),qty:He.toFixed(2),price:ze.toFixed(2),discount:"0.00",lineTotal:Pe.toFixed(2)}});return{company:{name:String(I.name||Ae.companyName||"Company Name"),addressLine1:Ie,addressLine2:ke,phone:String(I.phone||Ae.contactNumber||""),logoUrl:pe,logoHtml:he},receipt:{receiptNo:String((ee==null?void 0:ee.sale_no)||"-"),dateTime:ce,paymentMethod:le,headerText:String(Ae.headerText||""),footerText:String(Ae.footerText||"")},items:dt,totals:{subtotal:Ue.toFixed(2),discount:me.toFixed(2),tax:xe.toFixed(2),total:ct.toFixed(2)}}}const F=async(ee,se)=>{const Ae=await K();if(!Ae)return null;const we=_(ee,se);return UZ(Fy(Ae,we))},E=async(ee,se)=>{var Qe;const Ae=await F(ee,se);if(!Ae)return!1;const we=document.createElement("iframe");we.style.position="fixed",we.style.right="0",we.style.bottom="0",we.style.width="0",we.style.height="0",we.style.border="0",document.body.appendChild(we);const ce=((Qe=we.contentWindow)==null?void 0:Qe.document)||we.contentDocument||null;if(!ce)return document.body.removeChild(we),!0;ce.open(),ce.write(Ae),ce.close();const le=we.contentWindow||window;return setTimeout(()=>{le.focus();try{le.print()}catch{}setTimeout(()=>{document.body.removeChild(we)},100)},200),!0},L=async(ee,se,Ae)=>{const we=await K();if(!we)return!1;const ce=_(ee,se),le=Fy(we,ce),_e=document.createElement("div");_e.style.position="fixed",_e.style.left="-10000px",_e.style.top="0",_e.style.width="794px",_e.style.background="white",_e.style.padding="32px",_e.innerHTML=le,document.body.appendChild(_e);try{await OZ(_e);const Qe=await Wn(_e,{scale:2,useCORS:!0}),Ie=Qe.toDataURL("image/png"),ke=new As("p","mm","a4"),pe=ke.internal.pageSize.getWidth(),he=ke.internal.pageSize.getHeight(),je=pe,me=Qe.height*je/Qe.width;let xe=0;for(;xe<me;)ke.addImage(Ie,"PNG",0,-xe,je,me),xe+=he,xe<me&&ke.addPage();const Ue=`POS_Invoice_${(ee==null?void 0:ee.sale_no)||(Ae==null?void 0:Ae.id)||""}.pdf`;ke.save(Ue)}finally{document.body.removeChild(_e)}return!0};function U(ee,se){const Ae=Y||{},we=String(I.name||Ae.companyName||"Company Name"),ce=[];I.address&&ce.push(I.address);const le=[I.city,I.state].filter(Boolean).join(", ");le&&ce.push(le),I.country&&ce.push(I.country);const _e=String(ce[0]||Ae.addressLine1||"Street address"),Qe=String(ce.slice(1).join("  ")||Ae.addressLine2||"City, State, ZIP"),Ie=String(I.phone||Ae.contactNumber||"+1234567890"),ke=String(Ae.headerText||"Thank you for your purchase"),pe=String(Ae.footerText||"Please visit again"),he=[];I.taxId&&he.push(`TIN: ${I.taxId}`),I.website&&he.push(I.website);const je=he.join("  ");let me=String(Ae.logoUrl||I.logoUrl||"").trim();if(me&&!(me.startsWith("http://")||me.startsWith("https://")||me.startsWith("data:"))){const Ze=window.location.origin||"";me.startsWith("/")?me=Ze+me:me=Ze+"/"+me}const xe=me?`<div class="center"><img src="${me}" alt="${we}" style="max-height:100px;margin-bottom:8px;object-fit:contain;" /></div>`:"",ct=(ee&&ee.sale_date?new Date(ee.sale_date):new Date).toLocaleString(),dt=(function(){const Ve=String((ee==null?void 0:ee.payment_method)||"").toUpperCase();return Ve==="CASH"?"Cash":Ve==="CARD"?"Card":Ve==="MOBILE"?"Mobile Money":Ve==="BANK"?"Bank":"Other"})(),We=(Array.isArray(se)?se:[]).map(Ve=>{const Ze=Number(Ve.qty||0),Re=Number(Ve.unit_price||0),it=Number(Ve.line_total||Ze*Re||0);return`
          <tr>
            <td>${Ve.item_name||""}</td>
            <td class="right">${Ze.toFixed(2)}</td>
            <td class="right">GH ${Re.toFixed(2)}</td>
            <td class="right">GH ${it.toFixed(2)}</td>
          </tr>
        `}).join(""),He=Number((ee==null?void 0:ee.gross_amount)||0),ze=Number((ee==null?void 0:ee.discount_amount)||0),Pe=Number((ee==null?void 0:ee.tax_amount)||0),Te=He-ze,Ke=Number((ee==null?void 0:ee.net_amount)||(ee==null?void 0:ee.total_amount)||Te+Pe);return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Invoice</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          .footer { margin-top: 10px; text-align: center; font-size: 11px; white-space: pre-wrap; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        ${xe}
        <h1>${we}</h1>
        <div class="center muted">${_e}</div>
        <div class="center muted">${Qe}</div>
        <div class="center muted">Mobile: ${Ie}</div>
        ${je?`<div class="center muted">${je}</div>`:""}
        <div class="center muted" style="margin-top:6px;">${ke}</div>
        <hr />
        <div class="row"><span>Receipt No:</span><span>${(ee==null?void 0:ee.sale_no)||"-"}</span></div>
        <div class="row"><span>Date:</span><span>${ct}</span></div>
        <div class="row"><span>Payment:</span><span>${dt}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${We.replace(/<td class="right">(\d+(?:\.\d{1,2})?)<\/td>\s*<td class="right">(\d+(?:\.\d{1,2})?)<\/td>$/gm,'<td class="right">$1</td><td class="right">GH $2')}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Subtotal</span><span>GH ${Te.toFixed(2)}</span></div>
          <div class="row"><span>Discount</span><span>GH ${ze.toFixed(2)}</span></div>
          <div class="row"><span>Tax</span><span>GH ${Pe.toFixed(2)}</span></div>
          <div class="row"><strong>Total</strong><strong>GH ${Ke.toFixed(2)}</strong></div>
        </div>
        <div class="footer">${pe}</div>
      </body>
      </html>
    `}async function J(ee){var se,Ae;if(!(!ee||!ee.id)){b(ee.id);try{const we=await te.get(`/pos/sales/${ee.id}`),ce=((se=we.data)==null?void 0:se.item)||null,le=Array.isArray((Ae=we.data)==null?void 0:Ae.details)?we.data.details:[];if(!ce){alert("Invoice not found");return}const _e=await F(ce,le)||U(ce,le);T(_e),Q(!0)}catch{alert("Failed to load invoice")}finally{b(null)}}}async function ae(ee){var se,Ae,we;if(!(!ee||!ee.id)){b(ee.id);try{const ce=await te.get(`/pos/sales/${ee.id}`),le=((se=ce.data)==null?void 0:se.item)||null,_e=Array.isArray((Ae=ce.data)==null?void 0:Ae.details)?ce.data.details:[];if(!le){alert("Invoice not found");return}if(await E(le,_e))return;const Ie=U(le,_e),ke=document.createElement("iframe");ke.style.position="fixed",ke.style.right="0",ke.style.bottom="0",ke.style.width="0",ke.style.height="0",ke.style.border="0",document.body.appendChild(ke);const pe=((we=ke.contentWindow)==null?void 0:we.document)||ke.contentDocument||null;if(!pe){document.body.removeChild(ke);return}pe.open(),pe.write(Ie),pe.close();const he=ke.contentWindow||window;setTimeout(()=>{he.focus();try{he.print()}catch{}setTimeout(()=>{document.body.removeChild(ke)},100)},200)}catch{alert("Failed to load invoice"),b(null)}}}async function Z(ee){var se,Ae,we;if(!(!ee||!ee.id)){b(ee.id);try{const ce=await te.get(`/pos/sales/${ee.id}`),le=((se=ce.data)==null?void 0:se.item)||null,_e=Array.isArray((Ae=ce.data)==null?void 0:Ae.details)?ce.data.details:[];if(!le){alert("Invoice not found");return}if(await L(le,_e,ee))return;const Ie=Y||{},ke=String(I.name||Ie.companyName||"Company Name"),pe=[];I.address&&pe.push(I.address);const he=[I.city,I.state].filter(Boolean).join(", ");he&&pe.push(he),I.country&&pe.push(I.country);const je=String(pe[0]||Ie.addressLine1||"Street address"),me=String(pe.slice(1).join("  ")||Ie.addressLine2||"City, State, ZIP"),xe=String(I.phone||Ie.contactNumber||"+1234567890"),Ue=String(Ie.headerText||"Thank you for your purchase"),ct=String(Ie.footerText||"Please visit again"),We=(le&&le.sale_date?new Date(le.sale_date):new Date).toLocaleString(),He=(function(){const Ge=String((le==null?void 0:le.payment_method)||"").toUpperCase();return Ge==="CASH"?"Cash":Ge==="CARD"?"Card":Ge==="MOBILE"?"Mobile Money":Ge==="BANK"?"Bank":"Other"})(),ze=Number((le==null?void 0:le.gross_amount)||0),Pe=Number((le==null?void 0:le.discount_amount)||0),Te=Number((le==null?void 0:le.tax_amount)||0),Ke=ze-Pe,$e=Number((le==null?void 0:le.net_amount)||(le==null?void 0:le.total_amount)||Ke+Te),Ve=new As("p","mm","a4");let Ze=15;Ve.setFontSize(14),Ve.text(ke,10,Ze),Ze+=6,Ve.setFontSize(10),Ve.text(je,10,Ze),Ze+=5,Ve.text(me,10,Ze),Ze+=5,Ve.text("Mobile: "+xe,10,Ze),Ze+=5;const Re=[];I.taxId&&Re.push(`TIN: ${I.taxId}`),I.website&&Re.push(I.website);const it=Re.join("  ");it&&(Ve.text(it,10,Ze),Ze+=5),Ze+=1,Ve.text(Ue,10,Ze),Ze+=8,Ve.setFontSize(11),Ve.text("Receipt No: "+(le.sale_no||"-"),10,Ze),Ze+=5,Ve.text("Date: "+We,10,Ze),Ze+=5,Ve.text("Payment: "+He,10,Ze),Ze+=8,Ve.setFontSize(10),Ve.text("Item",10,Ze),Ve.text("Qty",90,Ze),Ve.text("Price",120,Ze),Ve.text("Total",160,Ze),Ze+=4,Ve.line(10,Ze,200,Ze),Ze+=5,(Array.isArray(_e)?_e:[]).forEach(Ge=>{const at=Number(Ge.qty||0),xt=Number(Ge.unit_price||0),wt=Number(Ge.line_total||at*xt||0);Ze>270&&(Ve.addPage(),Ze=15);const pt=String(Ge.item_name||""),ge=40;(pt.length>ge?[pt.slice(0,ge),pt.slice(ge)]:[pt]).forEach(ht=>{Ve.text(ht,10,Ze),Ve.text(at.toFixed(2),90,Ze,{align:"right"}),Ve.text(xt.toFixed(2),120,Ze,{align:"right"}),Ve.text(wt.toFixed(2),160,Ze,{align:"right"}),Ze+=5})}),Ze+=4,Ve.line(10,Ze,200,Ze),Ze+=6,Ve.text("Subtotal:",120,Ze,{align:"right"}),Ve.text(Ke.toFixed(2),160,Ze,{align:"right"}),Ze+=5,Ve.text("Discount:",120,Ze,{align:"right"}),Ve.text(Pe.toFixed(2),160,Ze,{align:"right"}),Ze+=5,Ve.text("Tax:",120,Ze,{align:"right"}),Ve.text(Te.toFixed(2),160,Ze,{align:"right"}),Ze+=5,Ve.text("Total:",120,Ze,{align:"right"}),Ve.text($e.toFixed(2),160,Ze,{align:"right"}),Ze+=8;const lt=ct.replace(/\r\n/g,`
`).split(`
`),Ne=((we=Ve.getFont())==null?void 0:we.fontName)||"helvetica";try{Ve.setFont("courier","normal")}catch{}Ve.setFontSize(10),lt.forEach(Ge=>{Ze>270&&(Ve.addPage(),Ze=15),Ve.text(Ge,10,Ze),Ze+=5});try{Ve.setFont(Ne,"normal")}catch{}const Xe=`POS_Invoice_${le.sale_no||ee.id}.pdf`;Ve.save(Xe)}catch{alert("Failed to download invoice")}finally{b(null)}}}function oe(){Q(!1),T("")}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Invoices"}),e.jsx("p",{className:"text-sm mt-1",children:"List of all invoices created from POS sales entry"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:s.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:s.toLocaleTimeString()})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal"}),e.jsxs("select",{className:"input",value:y,onChange:ee=>N(ee.target.value),disabled:k,children:[e.jsx("option",{value:"",children:k?"Loading terminals...":"All Terminals (assigned)"}),(Array.isArray(j)?j:[]).map(ee=>e.jsx("option",{value:String(ee.code||""),children:String(ee.code||ee.name||"")},String(ee.code)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{type:"date",className:"input",value:o,onChange:ee=>u(ee.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{type:"date",className:"input",value:d,onChange:ee=>c(ee.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:m,onChange:ee=>h(ee.target.value),children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"PENDING",children:"Pending"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input",placeholder:"Search invoice no or customer",value:f,onChange:ee=>x(ee.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:H,children:"Export CSV"}),e.jsx("button",{className:"btn-primary",onClick:W,children:"Print"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Invoices"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:R.count})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:`GH ${Number(R.totalAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Paid"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:`GH ${Number(R.paid).toFixed(2)}`})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"Loading..."})}):X.length?X.map(ee=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"font-medium",children:ee.sale_no}),e.jsx("td",{children:String(ee.sale_date||"").replace("T"," ").slice(0,16)}),e.jsx("td",{children:ee.customer_id?`#${ee.customer_id}`:"-"}),e.jsx("td",{className:"text-right",children:`GH ${Number(ee.total_amount||0).toFixed(2)}`}),e.jsx("td",{children:e.jsx("span",{className:String(ee.payment_status||"")==="PAID"?"px-2 py-1 rounded bg-green-100 text-green-700 text-xs":"px-2 py-1 rounded bg-yellow-100 text-yellow-700 text-xs",children:String(ee.payment_status||"")})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"text-brand hover:text-brand-600 font-medium text-sm",onClick:()=>J(ee),disabled:g===ee.id,children:"View"}),e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",onClick:()=>ae(ee),disabled:g===ee.id,children:"Print"}),e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",onClick:()=>Z(ee),disabled:g===ee.id,children:"Download"})]})})]},ee.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:e.jsx("div",{className:"text-center text-slate-600 py-6",children:"No invoices found"})})})})]})})}),q&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Invoice Preview"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:oe,children:""})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:O?e.jsx("iframe",{title:"Invoice Preview",srcDoc:O,className:"w-full h-[70vh] border-0"}):e.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"Loading invoice..."})})]})})]})}const vx=[200,100,50,20,10,5,2,1,.5,.2];function TS({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function MZ(){const[t,s]=v.useState(!1),[r,a]=v.useState([]),[n,i]=v.useState(""),[l,o]=v.useState(new Date().toISOString().slice(0,10)),[u,d]=v.useState(""),[c,m]=v.useState(""),[h,f]=v.useState(""),[x,g]=v.useState(50),[b,y]=v.useState(!1),[N,j]=v.useState([]),[S,k]=v.useState(vx.map(()=>0));v.useEffect(()=>{let F=!1;return s(!0),te.get("/pos/terminals").then(E=>{var U;if(F)return;const L=Array.isArray((U=E.data)==null?void 0:U.items)?E.data.items:[];if(a(L),!u&&L.length){const J=L[0];d(String(J.id)),m(String(J.warehouse||""))}}).catch(()=>{F||a([])}).finally(()=>{F||s(!1)}),()=>{F=!0}},[]),v.useEffect(()=>{const F=r.find(E=>String(E.id)===String(u));F&&F.warehouse&&String(c||"").trim()===""&&m(String(F.warehouse))},[u,r]);const P=v.useMemo(()=>{const F=new Set;for(const E of r){const L=String((E==null?void 0:E.warehouse)||"").trim();L&&F.add(L)}return Array.from(F.values())},[r]),I=v.useMemo(()=>(Array.isArray(r)?r:[]).map(F=>({value:String(F.id),label:String(F.code||F.name||"")})),[r]),B=v.useMemo(()=>{const F=(Array.isArray(P)?P:[]).map(E=>({value:String(E),label:String(E)}));return!F.length&&String(c||"").trim()?[{value:String(c),label:String(c)}]:F},[P,c]),q=v.useMemo(()=>{const F=String(h||"").trim().toLowerCase();return F?N.filter(E=>String(E.account||"").toLowerCase().includes(F)):N},[N,h]),Q=v.useMemo(()=>{const F=Math.max(1,Number(x||0)||1);return q.slice(0,F)},[q,x]),O=v.useMemo(()=>N.reduce((F,E)=>(F.credit+=Number(E.credit||0),F.debit+=Number(E.debit||0),F),{credit:0,debit:0}),[N]),T=v.useMemo(()=>vx.map((F,E)=>D(F*Number(S[E]||0))),[S]),V=v.useMemo(()=>D(T.reduce((F,E)=>F+Number(E||0),0)),[T]);function D(F){return Math.round(Number(F||0)*100)/100}function Y(F,E){const L=F.get(String(E));if(!L)return String(E||"");const U=String(L.code||"").trim(),J=String(L.name||"").trim();return U&&J?`${U} - ${J}`:J||U||String(E||"")}function M(F,E,L){const U=String(L||"").trim();if(!U)return"";const J=Number(U);if(Number.isFinite(J)&&J>0)return Y(E,J);const ae=F.find(Z=>String(Z.code||"")===U);return ae?Y(E,ae.id):U}function X(F){const E=Array.isArray(F)?F.slice():[];E.sort((U,J)=>{const ae=String((U==null?void 0:U.code)||""),Z=String((J==null?void 0:J.code)||""),oe=String((U==null?void 0:U.name)||"").toLowerCase(),ee=String((J==null?void 0:J.name)||"").toLowerCase(),se=ae==="4000"||ae==="400000"?0:oe.includes("sales")?1:ae.toLowerCase().startsWith("4")?2:3,Ae=Z==="4000"||Z==="400000"?0:ee.includes("sales")?1:Z.toLowerCase().startsWith("4")?2:3;return se!==Ae?se-Ae:ae.localeCompare(Z)});const L=E[0];return L!=null&&L.id?Number(L.id):0}function R(F){return String(F||"").slice(0,10)}async function H(){var F,E,L,U;s(!0);try{const[J,ae,Z,oe]=await Promise.all([te.get("/pos/sales"),te.get("/finance/accounts",{params:{postable:1,active:1}}),te.get("/pos/tax-settings"),te.get("/pos/payment-modes")]),ee=Array.isArray((F=J.data)==null?void 0:F.items)?J.data.items:[],se=Array.isArray((E=ae.data)==null?void 0:E.items)?ae.data.items:[],Ae=new Map(se.map(He=>[String(He.id),He])),we=((L=Z.data)==null?void 0:L.item)||null,ce=Array.isArray((U=oe.data)==null?void 0:U.items)?oe.data.items:[],le=R(l),_e=ee.filter(He=>{const ze=R(He.sale_date);return String(He.payment_status||"").toUpperCase()==="PAID"&&ze===le});if(!_e.length){j([]),window.alert("No completed POS sales found for the selected date.");return}const Qe=String((we==null?void 0:we.tax_type)||"Exclusive").toLowerCase(),Ie=we&&Number(we.is_active)===0?0:1,ke=Ie&&Number((we==null?void 0:we.tax_account_id)||0)>0?Number(we.tax_account_id):0,pe=se.filter(He=>String(He.nature||"").toUpperCase()==="INCOME"),he=X(pe);if(!he)throw new Error("Sales account not configured for posting");let je=0,me=0;const xe=new Map;for(const He of _e){const ze=Number(He.gross_amount||0),Pe=Number(He.discount_amount||0),Te=D(ze-Pe),Ke=D(Number(He.tax_amount||0)),$e=D(Number(He.total_amount||0));let Ve=Te;Ie&&Qe==="inclusive"&&Ke>0&&Te>0&&(Ve=D(Te-Ke)),je=D(je+Math.max(0,Ve)),me=D(me+Math.max(0,Ke));const Ze=String(He.payment_method||"CASH").toUpperCase();xe.set(Ze,D((xe.get(Ze)||0)+$e))}if(me>0&&!ke)throw new Error("Tax account not configured in POS Tax Settings");const Ue=[];je>0&&Ue.push({account:Y(Ae,he),credit:je,debit:0}),me>0&&ke&&Ue.push({account:Y(Ae,ke),credit:me,debit:0});const ct=new Map;for(const He of ce){if(Number(He.is_active)===0)continue;const ze=String(He.type||"").toLowerCase();ct.has(ze)||ct.set(ze,He)}const dt=["CASH","CARD","MOBILE"],We=Array.from(xe.keys()).sort((He,ze)=>{const Pe=dt.indexOf(He),Te=dt.indexOf(ze);return Pe===-1&&Te===-1?He.localeCompare(ze):Pe===-1?1:Te===-1?-1:Pe-Te});for(const He of We){const ze=D(xe.get(He)||0);if(ze<=0)continue;const Pe=He==="CARD"?"card":He==="MOBILE"?"mobile":"cash",Te=ct.get(Pe),Ke=M(se,Ae,Te==null?void 0:Te.account);if(!Ke)throw new Error(`No linked Finance account found for payment type: ${Pe}`);Ue.push({account:Ke,credit:0,debit:ze})}j(Ue)}catch(J){j([]),window.alert(String((J==null?void 0:J.message)||"Failed to populate transactions"))}finally{s(!1)}}function W(){i(""),j([]),f(""),k(vx.map(()=>0))}function K(){const F=r.find(oe=>String(oe.id)===String(u)),E=F?String(F.code||F.name||"").trim():"",L=String(n||"").trim()||"Auto-generated",U=l,J=String(c||"").trim()||"-",ae=V.toFixed(2);window.confirm(`Post transaction to finance?

Voucher: ${L}
Date: ${U}
Till: ${E||"-"}
Warehouse: ${J}
Cash Total: GHS ${ae}`)&&(window.alert("Transaction posted to finance successfully!"),W())}const _=v.useMemo(()=>{const F=Q.length?1:0,E=Q.length;return`${F} - ${E}`},[Q.length]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Finance Posting"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher no."}),e.jsx("input",{className:"input",value:n,onChange:F=>i(F.target.value),placeholder:"Auto-generated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date"}),e.jsx("input",{className:"input",type:"date",value:l,onChange:F=>o(F.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Till"}),e.jsx(TS,{value:u,onChange:F=>{const E=String(F||"");d(E);const L=r.find(U=>String(U.id)===String(E));L&&m(String(L.warehouse||""))},options:I,placeholder:r.length?"Select till":"Loading...",filterPlaceholder:"Filter tills...",disabled:t||!r.length})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsx(TS,{value:c,onChange:F=>m(String(F||"")),options:B,placeholder:B.length?"Select":"-",filterPlaceholder:"Filter warehouses...",disabled:t||!B.length})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn-primary",onClick:H,disabled:t,children:"POPULATE DATA"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_350px] gap-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"input",placeholder:"Search...",value:h,onChange:F=>f(F.target.value)})}),e.jsx("button",{type:"button",className:"btn-primary",onClick:H,disabled:t,children:"Go"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Rows"}),e.jsxs("select",{className:"input",value:String(x),onChange:F=>g(Number(F.target.value)),children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>y(F=>!F),children:"Actions "}),b&&e.jsx("div",{className:"absolute right-0 mt-2 w-40 rounded border border-slate-200 bg-white shadow-lg z-10",children:e.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{y(!1),W()},children:"Clear"})})]})]}),e.jsx("div",{className:"overflow-x-auto rounded border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Sr No"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Account Name"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Credit"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Debit"})]})}),e.jsx("tbody",{className:"bg-white",children:N.length?e.jsxs(e.Fragment,{children:[Q.map((F,E)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 text-center",children:E+1}),e.jsx("td",{className:"p-2",children:F.account}),e.jsx("td",{className:"p-2 text-right",children:Number(F.credit||0)>0?Number(F.credit||0).toFixed(2):""}),e.jsx("td",{className:"p-2 text-right",children:Number(F.debit||0)>0?Number(F.debit||0).toFixed(2):""})]},E)),e.jsxs("tr",{className:"border-t bg-slate-50 font-semibold",children:[e.jsx("td",{className:"p-2"}),e.jsx("td",{className:"p-2"}),e.jsx("td",{className:"p-2 text-right",children:O.credit.toFixed(2)}),e.jsx("td",{className:"p-2 text-right",children:O.debit.toFixed(2)})]})]}):e.jsx("tr",{children:e.jsx("td",{className:"p-10 text-center text-slate-500",colSpan:4,children:'Click "POPULATE DATA" to load transactions'})})})]})}),e.jsx("div",{className:"flex justify-end text-xs text-slate-600",children:_})]}),e.jsxs("div",{className:"rounded-lg bg-brand text-white p-4 h-fit",children:[e.jsx("div",{className:"text-center text-base font-semibold",children:"Denomination Cash Count"}),e.jsx("div",{className:"mt-4 space-y-2",children:vx.map((F,E)=>e.jsxs("div",{className:"grid grid-cols-[1fr_90px_110px] gap-2 items-center",children:[e.jsx("div",{className:"text-sm",children:`GHS ${Number(F).toFixed(2)}`}),e.jsx("input",{type:"number",min:"0",className:"rounded px-2 py-1 text-slate-900",value:String(S[E]??0),onChange:L=>{const U=S.slice();U[E]=Number(L.target.value||0),k(U)}}),e.jsx("div",{className:"rounded px-2 py-1 bg-white/20 text-right text-sm",children:T[E].toFixed(2)})]},String(F)))}),e.jsxs("div",{className:"mt-4 rounded bg-white/20 px-3 py-3 flex items-center justify-between font-semibold",children:[e.jsx("div",{children:"TOTAL:"}),e.jsx("div",{children:V.toFixed(2)})]}),e.jsx("button",{type:"button",className:"btn-primary w-full mt-4",onClick:K,disabled:t||!N.length,children:"POST TO FINANCE"})]})]})]})})]})}function HZ(){const{user:t,scope:s}=Qa();function r(ce){try{const le=new Date(ce);if(Number.isNaN(le.getTime()))return"";const _e=me=>String(me).padStart(2,"0"),Qe=le.getFullYear(),Ie=_e(le.getMonth()+1),ke=_e(le.getDate()),pe=_e(le.getHours()),he=_e(le.getMinutes()),je=_e(le.getSeconds());return`${Qe}-${Ie}-${ke}T${pe}:${he}:${je}`}catch{return""}}const[a,n]=v.useState(new Date),[i,l]=v.useState(""),[o,u]=v.useState([]),[d,c]=v.useState(!1),[m,h]=v.useState([]),[f,x]=v.useState({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),g=v.useMemo(()=>Number((t==null?void 0:t.sub)||(t==null?void 0:t.id)||0),[t]),b=v.useMemo(()=>{const ce=(t==null?void 0:t.username)||(t==null?void 0:t.name)||(t==null?void 0:t.fullName)||"Cashier";return String(ce)},[t]),[y,N]=v.useState(!1),[j,S]=v.useState({dateTime:"",float:"",supervisor:"",notes:""}),[k,P]=v.useState(new Array(6).fill(!1)),I=v.useMemo(()=>{const ce=k.length||1,le=k.filter(Boolean).length;return Math.round(le/ce*100)},[k]),[B,q]=v.useState({cash:{count:0,amount:0},card:{count:0,amount:0},mobile:{count:0,amount:0}}),Q=v.useMemo(()=>{const ce=Number(B.cash.amount||0)+Number(B.card.amount||0)+Number(B.mobile.amount||0),le=Number(B.cash.count||0)+Number(B.card.count||0)+Number(B.mobile.count||0);return{totalAmount:ce,totalCount:le}},[B]),O=v.useMemo(()=>Number(j.float||0)+Number(B.cash.amount||0),[j.float,B.cash.amount]),[T,V]=v.useState({dateTime:"",actualCash:"",notes:""}),D=v.useMemo(()=>Number(T.actualCash||0)-Number(O||0),[T.actualCash,O]),[Y,M]=v.useState([{time:new Date,title:"Waiting",description:"No activity yet"}]),[X,R]=v.useState({open:!1,title:"",icon:"",message:""}),[H,W]=v.useState([]),K=v.useMemo(()=>({cashCount:Number(B.cash.count||0),cashAmount:Number(B.cash.amount||0),cardCount:Number(B.card.count||0),cardAmount:Number(B.card.amount||0),mobileCount:Number(B.mobile.count||0),mobileAmount:Number(B.mobile.amount||0)}),[B]),_=v.useMemo(()=>f.open?f.index>=0&&f.index<H.length?H[f.index]:f.item:null,[f.open,f.index,f.item,H]);v.useEffect(()=>{const ce=setInterval(()=>n(new Date),1e3);return()=>clearInterval(ce)},[]),v.useEffect(()=>{const ce=String((t==null?void 0:t.username)||"").trim();ce&&!j.supervisor&&S(le=>({...le,supervisor:ce}))},[t==null?void 0:t.username]),v.useEffect(()=>{let ce=!1;async function le(){var _e,Qe,Ie;if(g){c(!0);try{const[ke,pe]=await Promise.all([te.get("/pos/terminals"),te.get("/pos/terminal-users")]);if(ce)return;const he=Array.isArray((_e=ke.data)==null?void 0:_e.items)?ke.data.items:[],je=Array.isArray((Qe=pe.data)==null?void 0:Qe.items)?pe.data.items:[],me=new Set(je.filter(dt=>Number(dt==null?void 0:dt.user_id)===Number(g)).map(dt=>Number(dt==null?void 0:dt.terminal_id)).filter(dt=>Number.isFinite(dt)&&dt>0)),xe=he.filter(dt=>me.has(Number(dt==null?void 0:dt.id)));u(xe);const ct=xe.some(dt=>String((dt==null?void 0:dt.code)||"")===String(i||""))?i:((Ie=xe[0])==null?void 0:Ie.code)||"";l(ct?String(ct):"")}catch{if(ce)return;u([]),l("")}finally{ce||c(!1)}}}return le(),()=>{ce=!0}},[g,b]),v.useEffect(()=>{let ce=!1;async function le(){var _e;try{const Qe=Number((s==null?void 0:s.companyId)||0)||void 0,Ie=Number((s==null?void 0:s.branchId)||0)||void 0,ke=await te.get("/admin/users",{params:{...Qe?{company_id:Qe}:{},...Ie?{branch_id:Ie}:{},active:1,limit:100}});if(ce)return;h(Array.isArray((_e=ke.data)==null?void 0:_e.items)?ke.data.items:[])}catch{if(ce)return;h([])}}return le(),()=>{ce=!0}},[s==null?void 0:s.companyId,s==null?void 0:s.branchId]),v.useEffect(()=>{let ce=!1;return te.get("/pos/analytics/day-summary").then(le=>{var Ie;if(ce)return;const _e=((Ie=le==null?void 0:le.data)==null?void 0:Ie.summary)||{},Qe={cash:{count:Number(_e.cashCount||0),amount:Number(_e.cashAmount||0)},card:{count:Number(_e.cardCount||0),amount:Number(_e.cardAmount||0)},mobile:{count:Number(_e.mobileCount||0),amount:Number(_e.mobileAmount||0)}};q(Qe)}).catch(()=>{}),()=>{ce=!0}},[]),v.useEffect(()=>{let ce=!1;const le=i;if(le)return te.get("/pos/day/status",{params:{terminal:le}}).then(_e=>{var pe;if(ce)return;const Qe=(pe=_e==null?void 0:_e.data)==null?void 0:pe.item;if(!Qe){N(!1),W([]);return}const Ie=String(Qe.status||"").toUpperCase()==="OPEN";N(Ie),S({dateTime:r(Qe.open_datetime||""),float:Qe.opening_float===null||Qe.opening_float===void 0?"":String(Qe.opening_float),supervisor:Qe.supervisor_name||"",notes:Qe.open_notes||""}),V(he=>({...he,dateTime:r(Qe.close_datetime||""),actualCash:Qe.actual_cash===null||Qe.actual_cash===void 0?"":String(Qe.actual_cash),notes:Qe.close_notes||""}));const ke={dayStatusId:Number(Qe.id||0)||null,no:`DAY-${String(Qe.id||"").padStart(6,"0")}`,terminal:String(Qe.terminal_code||le||""),cashier:b,start:Qe.open_datetime?new Date(Qe.open_datetime).toLocaleString():"-",startTime:Qe.open_datetime||null,end:Qe.close_datetime?new Date(Qe.close_datetime).toLocaleString():"-",endTime:Qe.close_datetime||null,opening:Number(Qe.opening_float||0),status:Ie?"Open":"Closed",startSummary:oe({}),endSummary:Ie?null:K,expectedCash:null,actualCash:Qe.actual_cash===null||Qe.actual_cash===void 0?null:Number(Qe.actual_cash||0),cashVariance:null,closeNotes:Qe.close_notes||""};if(!Ie&&ke.actualCash!==null){const he=Number(ke.opening||0)+Number(K.cashAmount||0);ke.expectedCash=he,ke.cashVariance=Number(ke.actualCash||0)-he}W([ke]),F(Ie?"Day Status":"Last Day Status",Ie?"Day is currently open":"Last day is closed")}).catch(()=>{}),()=>{ce=!0}},[i]);function F(ce,le){const _e={time:new Date,title:ce,description:le};M(Qe=>{var pe;const ke=Qe.length===1&&String((pe=Qe[0])==null?void 0:pe.title).includes("Waiting")?[]:Qe.slice();return[_e,...ke].slice(0,50)})}function E(ce,le,_e){R({open:!0,title:ce,icon:le,message:_e})}function L(){R(ce=>({...ce,open:!1}))}function U(ce){P(le=>{const _e=le.slice();_e[ce]=!_e[ce];const Qe=["Verify cash float count","Check POS system connectivity","Verify printer and receipt paper","Test card payment terminal","Review pending transactions","Confirm inventory sync"][ce];return F(_e[ce]?"Checklist Completed":"Checklist Unchecked",Qe),_e})}async function J(ce){var _e,Qe,Ie,ke,pe;if(ce.preventDefault(),!k.every(Boolean)){mt.warn("Complete all opening checklist items");return}if(!j.supervisor){mt.warn("Provide supervisor");return}try{const he=r(new Date),je={terminal:i,openingDateTime:he,openingFloat:Number(j.float||0),supervisor:j.supervisor,notes:j.notes},me=await te.post("/pos/day/open",je),xe=(_e=me==null?void 0:me.data)==null?void 0:_e.item;xe?(N(String(xe.status||"").toUpperCase()==="OPEN"),S({dateTime:r(xe.open_datetime||"")||j.dateTime,float:xe.opening_float===null||xe.opening_float===void 0?String(j.float||""):String(xe.opening_float),supervisor:xe.supervisor_name||j.supervisor,notes:xe.open_notes||j.notes}),W([{dayStatusId:Number(xe.id||0)||null,no:`DAY-${String(xe.id||"").padStart(6,"0")}`,terminal:String(xe.terminal_code||i||""),cashier:b,start:xe.open_datetime?new Date(xe.open_datetime).toLocaleString():new Date(j.dateTime).toLocaleString(),startTime:xe.open_datetime||j.dateTime,end:"-",endTime:null,opening:Number(xe.opening_float??j.float??0),status:"Open",startSummary:oe({}),endSummary:null,expectedCash:null,actualCash:null,cashVariance:null,closeNotes:""}])):N(!0),E("Day Opened","","Day is open. Complete transactions and close day when finished."),F("Day Opened","Operations started")}catch(he){const je=((Ie=(Qe=he==null?void 0:he.response)==null?void 0:Qe.data)==null?void 0:Ie.message)||((pe=(ke=he==null?void 0:he.response)==null?void 0:ke.data)==null?void 0:pe.error)||"Failed to open day";mt.error(je)}}async function ae(ce){var le,_e,Qe,Ie,ke,pe;if(ce.preventDefault(),!y){mt.error("Open the day first");return}if(!T.dateTime){mt.warn("Provide closing date/time");return}try{const he={terminal:i,closingDateTime:T.dateTime,actualCash:Number(T.actualCash||0),notes:T.notes},je=await te.post("/pos/day/close",he),me=(le=je==null?void 0:je.data)==null?void 0:le.item;if(me){V(Ue=>({...Ue,dateTime:r(me.close_datetime||"")||T.dateTime,actualCash:me.actual_cash===null||me.actual_cash===void 0?String(T.actualCash||""):String(me.actual_cash),notes:me.close_notes||T.notes})),N(String(me.status||"").toUpperCase()==="OPEN");let xe=K;try{const Ue=await te.get("/pos/analytics/day-summary");xe=oe(((_e=Ue==null?void 0:Ue.data)==null?void 0:_e.summary)||{})}catch{}W(Ue=>{const ct=Array.isArray(Ue)&&Ue.length?Ue[0]:{},dt=Number(ct.opening??j.float??me.opening_float??0),We=dt+Number(xe.cashAmount||0),He=Number(me.actual_cash??T.actualCash??0);return[{...ct,dayStatusId:Number(me.id||ct.dayStatusId||0)||null,no:ct.no||`DAY-${String(me.id||"").padStart(6,"0")}`,terminal:String(me.terminal_code||i||ct.terminal||""),cashier:b,start:ct.start||(j.dateTime?new Date(j.dateTime).toLocaleString():"-"),startTime:ct.startTime||j.dateTime||null,end:me.close_datetime?new Date(me.close_datetime).toLocaleString():new Date(T.dateTime).toLocaleString(),endTime:me.close_datetime||T.dateTime,opening:dt,status:"Closed",startSummary:ct.startSummary||oe({}),endSummary:xe,expectedCash:We,actualCash:He,cashVariance:He-We,closeNotes:me.close_notes||T.notes||""}]})}else N(!1);E("Day Closed","","End-of-day reconciliation complete. See report summary below."),F("Day Closed","Operations ended")}catch(he){const je=((Ie=(Qe=he==null?void 0:he.response)==null?void 0:Qe.data)==null?void 0:Ie.message)||((pe=(ke=he==null?void 0:he.response)==null?void 0:ke.data)==null?void 0:pe.error)||"Failed to close day";mt.error(je)}}function Z(ce){return`${Number(ce||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}function oe(ce){const le=ce||{};return{cashCount:Number(le.cashCount||0),cashAmount:Number(le.cashAmount||0),cardCount:Number(le.cardCount||0),cardAmount:Number(le.cardAmount||0),mobileCount:Number(le.mobileCount||0),mobileAmount:Number(le.mobileAmount||0)}}function ee(ce,le){const _e=oe(ce),Qe=oe(le),Ie=(ke,pe)=>Math.max(0,Number(ke||0)-Number(pe||0));return{cashCount:Ie(_e.cashCount,Qe.cashCount),cashAmount:Ie(_e.cashAmount,Qe.cashAmount),cardCount:Ie(_e.cardCount,Qe.cardCount),cardAmount:Ie(_e.cardAmount,Qe.cardAmount),mobileCount:Ie(_e.mobileCount,Qe.mobileCount),mobileAmount:Ie(_e.mobileAmount,Qe.mobileAmount)}}function se(ce){const le=(ce==null?void 0:ce.startSummary)!==null&&(ce==null?void 0:ce.startSummary)!==void 0,_e=(ce==null?void 0:ce.endSummary)||K,Qe=le?ee(_e,(ce==null?void 0:ce.startSummary)||null):{cashCount:0,cashAmount:0,cardCount:0,cardAmount:0,mobileCount:0,mobileAmount:0},Ie=Number(Qe.cashCount||0)+Number(Qe.cardCount||0)+Number(Qe.mobileCount||0),ke=Number(Qe.cashAmount||0)+Number(Qe.cardAmount||0)+Number(Qe.mobileAmount||0),pe=le?ke:Number((ce==null?void 0:ce.sales)||0),he=(ce==null?void 0:ce.status)==="Closed"&&(ce==null?void 0:ce.expectedCash)!==null&&(ce==null?void 0:ce.expectedCash)!==void 0?Number(ce.expectedCash||0):Number((ce==null?void 0:ce.opening)||0)+Number(Qe.cashAmount||0),je=(ce==null?void 0:ce.status)==="Closed"&&(ce==null?void 0:ce.actualCash)!==null&&(ce==null?void 0:ce.actualCash)!==void 0?Number(ce.actualCash||0):(ce==null?void 0:ce.actualCash)===null||(ce==null?void 0:ce.actualCash)===void 0?null:Number(ce.actualCash||0),me=(ce==null?void 0:ce.status)==="Closed"&&(ce==null?void 0:ce.cashVariance)!==null&&(ce==null?void 0:ce.cashVariance)!==void 0?Number(ce.cashVariance||0):je===null?null:je-he;return{diff:Qe,totalCount:Ie,totalAmount:pe,expectedCashAtClose:he,actualCashAtClose:je,cashVarianceAtClose:me}}function Ae(ce){try{return new Date(ce).toLocaleTimeString()}catch{return"--:--"}}function we(){const ce=Q.totalAmount,le=Q.totalCount,_e=window.open("","_blank");if(!_e)return;const Qe=a.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Ie=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>POS End of Day Report</title>
        <style>
          body { font-family: 'Courier New', monospace; padding: 20px; max-width: 700px; margin: 0 auto; }
          h1 { text-align: center; border-bottom: 2px solid #0E3646; padding-bottom: 10px; color: #0E3646; }
          .row { display: flex; justify-content: space-between; margin: 5px 0; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
          th { background: #0E3646; color: white; }
          .totals { background: #f0f0f0; font-weight: bold; }
          .footer { margin-top: 20px; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        <h1>END OF DAY REPORT</h1>
        <div class="row"><strong>Terminal:</strong><span>${i}</span></div>
        <div class="row"><strong>Cashier:</strong><span>${b}</span></div>
        <div class="row"><strong>Date:</strong><span>${Qe}</span></div>
        <div class="row"><strong>Opening Float:</strong><span>${Z(j.float)}</span></div>
        <table>
          <thead>
            <tr><th>Payment Method</th><th>Transactions</th><th>Amount Received</th></tr>
          </thead>
          <tbody>
            <tr><td>Cash</td><td>${B.cash.count}</td><td>${Z(B.cash.amount)}</td></tr>
            <tr><td>Card</td><td>${B.card.count}</td><td>${Z(B.card.amount)}</td></tr>
            <tr><td>Mobile Money</td><td>${B.mobile.count}</td><td>${Z(B.mobile.amount)}</td></tr>
            <tr class="totals"><td><strong>TOTAL</strong></td><td><strong>${le}</strong></td><td><strong>${Z(ce)}</strong></td></tr>
          </tbody>
        </table>
        <div class="footer">
          <div class="row"><strong>Expected Cash:</strong><span>${Z(O)}</span></div>
          <div class="row"><strong>Actual Cash Count:</strong><span>${Z(T.actualCash||0)}</span></div>
          <div class="row"><strong>Variance:</strong><span>${Z(D)}</span></div>
        </div>
        <button onclick="window.print()">Print</button>
      </body>
      </html>
    `;_e.document.write(Ie),_e.document.close()}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"POS Day Management"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Open and close POS business day with reconciliation"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:a.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700 dark:text-brand-300",children:a.toLocaleTimeString()})]})]}),e.jsx("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Terminal"}),e.jsx("div",{className:"space-y-1",children:e.jsxs("select",{className:"input py-1 px-2 text-sm",value:i,onChange:ce=>l(ce.target.value),disabled:d||!o.length,children:[!o.length&&e.jsx("option",{value:"",children:d?"Loading...":"No terminals assigned"}),o.map(ce=>e.jsx("option",{value:String(ce.code||""),children:String(ce.code||"")},ce.id))]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Cashier"}),e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:b})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Date"}),e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:a.toLocaleDateString()})]}),e.jsx("div",{children:e.jsx("span",{className:y?"badge-success":"badge-danger",children:y?"OPEN":"CLOSED"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Open Day"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsxs("div",{className:"card-body",children:[!y&&e.jsxs("form",{onSubmit:J,className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Day Opening Procedure"}),e.jsx("div",{className:"text-blue-800",children:"Complete the checklist and verify opening float before starting operations."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Opening Date & Time"}),e.jsx("input",{type:"datetime-local",className:"input",value:r(a),readOnly:!0,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Opening Float ()"}),e.jsx("input",{type:"number",className:"input",step:"1",value:j.float,onChange:ce=>S(le=>({...le,float:ce.target.value})),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supervisor Name"}),e.jsxs("select",{className:"input",value:j.supervisor,onChange:ce=>S(le=>({...le,supervisor:ce.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Select supervisor"}),j.supervisor&&!m.some(ce=>String((ce==null?void 0:ce.username)||"")===String(j.supervisor))&&e.jsx("option",{value:j.supervisor,children:j.supervisor}),m.map(ce=>e.jsx("option",{value:String(ce.username||""),children:String(ce.username||"")},ce.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes"}),e.jsx("textarea",{className:"input",rows:3,value:j.notes,onChange:ce=>S(le=>({...le,notes:ce.target.value}))})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold text-slate-700",children:"Opening Checklist"}),e.jsxs("div",{className:"font-semibold text-brand-700",children:[I,"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-slate-200 rounded",children:e.jsx("div",{className:"h-3 rounded bg-gradient-to-r from-brand-700 to-brand-500",style:{width:`${I}%`}})}),e.jsx("ul",{className:"mt-3 space-y-2",children:["Verify cash float count","Check POS system connectivity","Verify printer and receipt paper","Test card payment terminal","Review pending transactions","Confirm inventory sync"].map((ce,le)=>e.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg border ${k[le]?"bg-green-50 border-green-200":"bg-slate-50 border-slate-200"}`,children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:k[le],onChange:()=>U(le)}),e.jsx("div",{className:`text-sm ${k[le]?"line-through":""}`,children:ce})]},le))})]}),e.jsx("button",{type:"submit",className:"btn-success w-full",children:" Open Day"})]}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"alert-success rounded-lg p-4 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsx("div",{children:"Day is currently open. Complete transactions and close day when finished."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Opened At"}),e.jsx("div",{className:"font-semibold",children:Ae(j.dateTime)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Opening Float"}),e.jsx("div",{className:"font-bold",children:Z(j.float)})]})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Close Day"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Day Closing Procedure"}),e.jsx("div",{className:"text-blue-800",children:"Complete end-of-day reconciliation and verify all transactions before closing."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Closing Date & Time"}),e.jsx("input",{type:"datetime-local",className:"input",value:T.dateTime,onChange:ce=>V(le=>({...le,dateTime:ce.target.value})),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Total Sales"}),e.jsx("div",{className:"font-bold",children:Z(Q.totalAmount)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Transactions"}),e.jsx("div",{className:"font-semibold",children:Q.totalCount})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Actual Cash Count ()"}),e.jsx("input",{type:"number",className:"input",step:"1",value:T.actualCash,onChange:ce=>V(le=>({...le,actualCash:ce.target.value})),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Expected Cash"}),e.jsx("input",{type:"text",className:"input",disabled:!0,value:Z(O)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cash Variance"}),e.jsx("input",{type:"text",className:"input",disabled:!0,value:Z(D),style:{color:D>=0?"#28a745":"#dc3545",fontWeight:700}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Closing Notes"}),e.jsx("textarea",{className:"input",rows:3,value:T.notes,onChange:ce=>V(le=>({...le,notes:ce.target.value}))})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200",children:[e.jsx("div",{className:"p-3 font-semibold",children:"Sales Report"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Transactions"}),e.jsx("th",{children:"Amount Received"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:B.cash.count}),e.jsx("td",{children:Z(B.cash.amount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Card"}),e.jsx("td",{children:B.card.count}),e.jsx("td",{children:Z(B.card.amount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Mobile Money"}),e.jsx("td",{children:B.mobile.count}),e.jsx("td",{children:Z(B.mobile.amount)})]}),e.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{children:Q.totalCount}),e.jsx("td",{children:Z(Q.totalAmount)})]})]})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-danger flex-1",children:" Close Day"}),e.jsx("button",{type:"button",className:"btn-info flex-1",onClick:we,children:" Print Report"})]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Activity Timeline"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-3",children:[Y.map((ce,le)=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"text-sm font-semibold text-brand-700",children:[new Date(ce.time).toLocaleTimeString()," - ",ce.title]}),e.jsx("div",{className:"text-sm",children:ce.description})]},le)),!Y.length&&e.jsx("div",{className:"text-sm text-slate-500",children:"No activity yet"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Sessions/Shifts"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsx("div",{className:"card-body space-y-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Session History"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Session #"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Terminal"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Cashier"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Start Time"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"End Time"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Opening Cash"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Total Sales"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Status"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white",children:H.map((ce,le)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:ce.no}),e.jsx("td",{className:"p-2",children:ce.terminal}),e.jsx("td",{className:"p-2",children:ce.cashier}),e.jsx("td",{className:"p-2",children:ce.start}),e.jsx("td",{className:"p-2",children:ce.end}),e.jsx("td",{className:"p-2",children:Number(ce.opening).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"p-2",children:Number(ce.sales).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${ce.status==="Open"?"bg-blue-100 text-blue-700":ce.status==="Closed"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:ce.status})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-info",onClick:()=>x({open:!0,mode:"details",index:le,item:ce,actualCash:"",notes:""}),children:"Details"}),ce.status==="Open"?e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{x({open:!0,mode:"close",index:le,item:ce,actualCash:"",notes:""})},children:"Close"}):e.jsx("button",{type:"button",className:"btn btn-info",disabled:!0,children:"Closed"})]})})]},le))})]})})]})})]}),f.open&&_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"rounded-xl bg-white dark:bg-slate-800 shadow-lg w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:f.mode==="close"?`Close ${_.no}`:`Session ${_.no}`}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:()=>x({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),children:""})]}),(()=>{const ce=_,le=se(ce),_e=ce.start||(ce.startTime?new Date(ce.startTime).toLocaleString():"-"),Qe=ce.end&&ce.end!=="-"?ce.end:ce.endTime?new Date(ce.endTime).toLocaleString():"-",Ie=le.cashVarianceAtClose!==null;return f.mode==="close"?e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Terminal"}),e.jsx("div",{className:"font-semibold",children:ce.terminal})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cashier"}),e.jsx("div",{className:"font-semibold",children:ce.cashier})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Start Time"}),e.jsx("div",{className:"font-semibold",children:_e})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Expected Cash"}),e.jsx("div",{className:"font-bold",children:Z(le.expectedCashAtClose)})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3 font-semibold bg-slate-50",children:"Sales (Since Session Start)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Transactions"}),e.jsx("th",{children:"Amount Received"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:le.diff.cashCount}),e.jsx("td",{children:Z(le.diff.cashAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Card"}),e.jsx("td",{children:le.diff.cardCount}),e.jsx("td",{children:Z(le.diff.cardAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Mobile Money"}),e.jsx("td",{children:le.diff.mobileCount}),e.jsx("td",{children:Z(le.diff.mobileAmount)})]}),e.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{children:le.totalCount}),e.jsx("td",{children:Z(le.totalAmount)})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Actual Cash Count ()"}),e.jsx("input",{type:"number",className:"input",step:"1",value:f.actualCash,onChange:ke=>x(pe=>({...pe,actualCash:ke.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Closing Notes"}),e.jsx("textarea",{className:"input",rows:3,value:f.notes,onChange:ke=>x(pe=>({...pe,notes:ke.target.value}))})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>x({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-danger",onClick:async()=>{var me;const ke=f.index;if(ke<0||ke>=H.length)return;if(String(f.actualCash||"").trim()===""){mt.warn("Provide actual cash count");return}let pe=K;try{const xe=await te.get("/pos/analytics/day-summary");pe=oe(((me=xe==null?void 0:xe.data)==null?void 0:me.summary)||{})}catch{}const he=new Date,je=Number(f.actualCash||0);W(xe=>xe.map((Ue,ct)=>{if(ct!==ke)return Ue;const dt=ee(pe,(Ue==null?void 0:Ue.startSummary)||null),We=Number(dt.cashAmount||0)+Number(dt.cardAmount||0)+Number(dt.mobileAmount||0),He=Number((Ue==null?void 0:Ue.opening)||0)+Number(dt.cashAmount||0),ze=je-He;return{...Ue,end:he.toLocaleString(),endTime:he.toISOString(),status:"Closed",sales:We,endSummary:pe,expectedCash:He,actualCash:je,cashVariance:ze,closeNotes:f.notes||""}})),F("Session Closed",`${_.cashier} on ${_.terminal}`),x({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""})},children:"Close Session"})]})]}):e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Terminal"}),e.jsx("div",{className:"font-semibold",children:ce.terminal})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cashier"}),e.jsx("div",{className:"font-semibold",children:ce.cashier})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Status"}),e.jsx("div",{className:"font-semibold",children:ce.status})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Start Time"}),e.jsx("div",{className:"font-semibold",children:_e})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"End Time"}),e.jsx("div",{className:"font-semibold",children:Qe})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Opening Cash"}),e.jsx("div",{className:"font-bold",children:Z(ce.opening)})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3 font-semibold bg-slate-50",children:"Sales Breakdown"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Transactions"}),e.jsx("th",{children:"Amount Received"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:le.diff.cashCount}),e.jsx("td",{children:Z(le.diff.cashAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Card"}),e.jsx("td",{children:le.diff.cardCount}),e.jsx("td",{children:Z(le.diff.cardAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Mobile Money"}),e.jsx("td",{children:le.diff.mobileCount}),e.jsx("td",{children:Z(le.diff.mobileAmount)})]}),e.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{children:le.totalCount}),e.jsx("td",{children:Z(le.totalAmount)})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3 font-semibold bg-slate-50",children:"Cash Reconciliation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Expected Cash"}),e.jsx("div",{className:"font-bold",children:Z(le.expectedCashAtClose)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Actual Cash"}),e.jsx("div",{className:"font-bold",children:le.actualCashAtClose===null?"-":Z(le.actualCashAtClose)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Variance"}),e.jsx("div",{className:"font-bold",style:{color:le.cashVarianceAtClose===null?void 0:le.cashVarianceAtClose>=0?"#28a745":"#dc3545"},children:Ie?Z(le.cashVarianceAtClose):"-"})]})]}),(ce.closeNotes||(_==null?void 0:_.closeNotes))&&e.jsx("div",{className:"px-4 pb-4 text-sm text-slate-700",children:ce.closeNotes||(_==null?void 0:_.closeNotes)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>x({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),children:"Close"})})]})})()]})}),X.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"rounded-xl bg-white dark:bg-slate-800 shadow-lg w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:X.title}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:L,children:""})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"text-center text-6xl",children:X.icon}),e.jsx("div",{className:"text-center",children:X.message}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(Ee,{to:"/pos",className:"btn-secondary",children:"Return to POS"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:L,children:"Continue"})]})]})]})})]})}function qZ(){const[t,s]=v.useState(null),[r,a]=v.useState(new Date),{token:n}=Qa();v.useEffect(()=>{let u=!1;return te.get("/pos/analytics/overview").then(d=>{u||s(d.data||null)}).catch(()=>{u||s(null)}),()=>{u=!0}},[n]),v.useEffect(()=>{const u=setInterval(()=>a(new Date),1e3);return()=>clearInterval(u)},[]);const i=u=>`GH${Number(u||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,l=[{icon:"",value:i((t==null?void 0:t.todaySales)||0),label:"Today Sales",path:"/pos/reports"},{icon:"",value:String((t==null?void 0:t.totalCustomers)??0),label:"Total Customers",path:"/sales/customers"},{icon:"",value:i((t==null?void 0:t.averageOrder)||0),label:"Average Order",path:"/pos/reports"},{icon:"",value:i((t==null?void 0:t.monthlyRevenue)||0),label:"Monthly Revenue",path:"/finance/reports"}],o=[{title:"Transactions",features:[{name:"Sales Entry",path:"/pos/sales-entry",description:"Quick sales entry",icon:""},{name:"Start/End Business Day",path:"/pos/day-management",description:"Open/close POS business day and reconciliation",icon:""},{name:"Cash Collection",path:"/pos/cash-collection",description:"Invoices list and collection summary",icon:""},{name:"POS Invoices",path:"/pos/invoices",description:"All invoices created from sales entry",icon:""},{name:"Post to Finance",path:"/pos/post-to-finance",description:"Post POS sales as finance sales vouchers",icon:""},{name:"POS Returns",path:"/pos/returns",description:"Process sales returns and refunds",icon:""},{name:"POS Register",path:"/pos/register",description:"Transactions listing and details",icon:""}]},{title:"Setup",features:[{name:"POS Setup",path:"/pos/setup",description:"Configure terminals, shifts, payments, and settings",icon:""}]},{title:"Reports",features:[{name:"POS Reports",path:"/pos/reports",description:"Daily sales and performance reports",icon:""}]}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:"Point of Sale"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Retail sales and transaction management"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:r.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:r.toLocaleTimeString()})]})]}),e.jsx(To,{title:"Point of Sale",description:"Retail sales and transaction management",stats:l,sections:o})]})}function VZ(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(qZ,{})}),e.jsx(tt,{path:"/returns",element:e.jsx(FS,{})}),e.jsx(tt,{path:"/returns/new",element:e.jsx(FS,{})}),e.jsx(tt,{path:"/register",element:e.jsx(TZ,{})}),e.jsx(tt,{path:"/sales-entry",element:e.jsx(LZ,{})}),e.jsx(tt,{path:"/cash-collection",element:e.jsx(PZ,{})}),e.jsx(tt,{path:"/invoices",element:e.jsx(QZ,{})}),e.jsx(tt,{path:"/post-to-finance",element:e.jsx(MZ,{})}),e.jsx(tt,{path:"/day-management",element:e.jsx(HZ,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(NZ,{})}),e.jsx(tt,{path:"/setup",element:e.jsx(FZ,{})})]})}function $Z(){const t=[{id:1,name:"Executive Overview",description:"Enterprise KPIs across all modules",active:!0,icon:"",color:"from-emerald-600 to-emerald-800"},{id:2,name:"Sales KPIs",description:"Revenue, average order, customer growth, profitability",active:!0,icon:"",color:"from-blue-600 to-blue-800"},{id:3,name:"Purchase KPIs",description:"Spend, supplier performance, order cycle times",active:!0,icon:"",color:"from-indigo-600 to-indigo-800"},{id:4,name:"Inventory KPIs",description:"Stock valuation, turns, low-stock, aging",active:!0,icon:"",color:"from-purple-600 to-purple-800"},{id:5,name:"Finance KPIs",description:"P&L highlights, cash flow, ratios, ledger health",active:!0,icon:"",color:"from-rose-600 to-rose-800"},{id:6,name:"Human Resources KPIs",description:"Headcount, attendance, payroll, attrition",active:!0,icon:"",color:"from-teal-600 to-teal-800"},{id:7,name:"POS KPIs",description:"Terminal sales, peak hours, basket size, payment mix",active:!0,icon:"",color:"from-orange-600 to-orange-800"},{id:8,name:"Production KPIs",description:"WO throughput, yield, downtime, OEE",active:!0,icon:"",color:"from-yellow-600 to-yellow-700"},{id:9,name:"Project Management KPIs",description:"Progress, burn-down, cycle time, blockers",active:!0,icon:"",color:"from-cyan-600 to-cyan-800"},{id:10,name:"Maintenance KPIs",description:"Work orders, MTTR, compliance, asset health",active:!0,icon:"",color:"from-lime-600 to-lime-700"},{id:11,name:"Administration KPIs",description:"User activity, permissions, audit status",active:!0,icon:"",color:"from-slate-600 to-slate-800"},{id:12,name:"Custom Analytics",description:"Cross-module insights and ad-hoc dashboards",active:!0,icon:"",color:"from-fuchsia-600 to-fuchsia-800"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Dashboards"}),e.jsx("p",{className:"text-sm mt-1",children:"Saved KPI dashboards covering all modules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/business-intelligence",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/business-intelligence/dashboards/new",className:"btn-success",children:"+ New Dashboard"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(s=>e.jsx("div",{className:`rounded-xl shadow-erp border border-slate-200 dark:border-slate-700 overflow-hidden bg-gradient-to-br ${s.color} text-white`,children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-2xl",children:s.icon}),e.jsx("span",{className:s.active?"badge badge-success":"badge badge-error",children:s.active?"Active":"Inactive"})]}),e.jsx("div",{className:"mt-3 font-bold text-lg",children:s.name}),e.jsx("div",{className:"mt-1 text-sm opacity-90",children:s.description}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(Ee,{to:`/business-intelligence/dashboards/${s.id}?mode=view`,className:"btn btn-sm btn-secondary",children:"View"}),e.jsx(Ee,{to:`/business-intelligence/dashboards/${s.id}?mode=edit`,className:"btn btn-sm btn-secondary",children:"Edit"})]})]})},s.id))})]})}function IS(){var P,I,B,q,Q,O,T;const t=Ns(),{id:s}=Ps(),r=!!s,{search:a}=Ba(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=v.useState(!1),[u,d]=v.useState({name:"",description:"",active:!0}),[c,m]=v.useState(null),[h,f]=v.useState([]),[x,g]=v.useState([]),[b,y]=v.useState([]);v.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({name:"Executive Overview",description:"High-level KPIs across modules",active:!0}),o(!1)},150))},[r]),v.useEffect(()=>{if(!i)return;let V=!1;return o(!0),Promise.all([te.get("/bi/dashboards").catch(()=>({data:{}})),te.get("/bi/sales-report").catch(()=>({data:{items:[]}})),te.get("/bi/purchase-report").catch(()=>({data:{items:[]}})),te.get("/bi/inventory-report").catch(()=>({data:{items:[]}}))]).then(([D,Y,M,X])=>{var H,W,K;if(V)return;const R=D.data||{};m(R.summary||null),f(Array.isArray((H=Y.data)==null?void 0:H.items)?Y.data.items:[]),g(Array.isArray((W=M.data)==null?void 0:W.items)?M.data.items:[]),y(Array.isArray((K=X.data)==null?void 0:K.items)?X.data.items:[])}).finally(()=>{V||o(!1)}),()=>{V=!0}},[i]);function N(V,D){d(Y=>({...Y,[V]:D}))}async function j(V){V.preventDefault(),o(!0);try{t("/business-intelligence/dashboards")}finally{o(!1)}}function S(V){return`${Number(V||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}function k({data:V}){const D=Math.max(1,...V.map(Y=>Number(Y.total||Y.count||0)));return e.jsx("div",{className:"flex items-end gap-1 h-24",children:V.slice().reverse().map((Y,M)=>{const X=Number(Y.total||Y.count||0),R=Math.max(4,Math.round(X/D*96));return e.jsx("div",{className:"w-3 bg-brand-500/70 rounded-t",style:{height:`${R}px`},title:`${Y.date||""}  ${S(Y.total||0)}  ${Y.count||0}`},M)})})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/business-intelligence/dashboards",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Dashboards"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"Executive Overview":r?"Edit Dashboard":"New Dashboard"})]}),i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Sales (30 days)"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:S(((P=c==null?void 0:c.sales)==null?void 0:P.total)||0)}),e.jsxs("div",{className:"text-xs mt-1",children:[((I=c==null?void 0:c.sales)==null?void 0:I.documents)||0," documents"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Purchases (30 days)"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:S(((B=c==null?void 0:c.purchase)==null?void 0:B.total)||0)}),e.jsxs("div",{className:"text-xs mt-1",children:[((q=c==null?void 0:c.purchase)==null?void 0:q.documents)||0," orders"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Inventory Items"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:Number(((Q=c==null?void 0:c.inventory)==null?void 0:Q.items)||0).toLocaleString()}),e.jsxs("div",{className:"text-xs mt-1",children:[Number(((O=c==null?void 0:c.inventory)==null?void 0:O.quantity)||0).toLocaleString()," units"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Active Employees"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:Number(((T=c==null?void 0:c.hr)==null?void 0:T.employees)||0).toLocaleString()}),e.jsx("div",{className:"text-xs mt-1",children:"HR status"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Sales Trend"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Last 30 days"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(k,{data:h}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Bars show totals by day"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Purchase Trend"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Last 30 days"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(k,{data:x}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Bars show totals by day"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-slate-50 rounded-t-lg",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Low Stock Watchlist"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Least available items"})]}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{className:"text-right",children:"Qty"}),e.jsx("th",{className:"text-right",children:"Reorder"}),e.jsx("th",{className:"text-right",children:"Max"})]})}),e.jsxs("tbody",{children:[b.map((V,D)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:V.item_code}),e.jsx("td",{children:V.item_name}),e.jsx("td",{className:"text-right",children:Number(V.qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(V.reorder_level||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(V.max_stock_level||0).toLocaleString()})]},D)),b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-slate-500 text-sm",children:"No low stock items"})}):null]})]})})]})]}):e.jsx("form",{onSubmit:j,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:u.name,onChange:V=>N("name",V.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.active?"1":"0",onChange:V=>N("active",V.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:u.description,onChange:V=>N("description",V.target.value)})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/business-intelligence/dashboards",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function WZ(){const t=[{id:1,name:"Sales Summary",module:"Sales",active:!0},{id:2,name:"Voucher Register",module:"Finance",active:!0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Saved Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Report definitions and schedules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ee,{to:"/business-intelligence",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Ee,{to:"/business-intelligence/reports/new",className:"btn-success",children:"+ New Report"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Module"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.module}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Ee,{to:`/business-intelligence/reports/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Ee,{to:`/business-intelligence/reports/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function LS(){const t=Ns(),{id:s}=Ps(),r=!!s,[a,n]=v.useState(!1),[i,l]=v.useState({name:"",module:"Sales",query:"",active:!0});v.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Sales Summary",module:"Sales",query:"SELECT ...",active:!0}),n(!1)},150))},[r]);function o(d,c){l(m=>({...m,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/business-intelligence/reports")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Ee,{to:"/business-intelligence/reports",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Reports"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:r?"Edit Report":"New Report"})]}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Module"}),e.jsxs("select",{className:"input",value:i.module,onChange:d=>o("module",d.target.value),children:[e.jsx("option",{value:"Sales",children:"Sales"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Inventory",children:"Inventory"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Query/Definition"}),e.jsx("input",{className:"input",value:i.query,onChange:d=>o("query",d.target.value),placeholder:"Placeholder"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ee,{to:"/business-intelligence/reports",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function GZ(){const t=[{title:"Executive Dashboard",description:"KPIs across ERP modules (placeholder)"},{title:"Trend Analysis",description:"Time series trends (placeholder)"},{title:"Operational KPIs",description:"Daily operational performance (placeholder)"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Business Intelligence Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Dashboards and analytics"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function KZ(){const[t,s]=Os.useState([{icon:"",value:"15",label:"Active Dashboards",change:"2 created this week",changeType:"positive",path:"/business-intelligence/dashboards"},{icon:"",value:"8",label:"Scheduled Reports",change:"Running daily",changeType:"neutral",path:"/business-intelligence/reports"},{icon:"",value:"Connected",label:"Data Sources",change:"All systems online",changeType:"positive",path:"/business-intelligence/bi-reports"}]);Os.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,m,h,f;try{const x=await te.get("/bi/dashboards"),g=Number(((o=(l=(i=x==null?void 0:x.data)==null?void 0:i.summary)==null?void 0:l.bi)==null?void 0:o.active_dashboards)||0),b=Number(((c=(d=(u=x==null?void 0:x.data)==null?void 0:u.summary)==null?void 0:d.bi)==null?void 0:c.scheduled_reports)||0),y=String(((f=(h=(m=x==null?void 0:x.data)==null?void 0:m.summary)==null?void 0:h.bi)==null?void 0:f.data_sources_status)||"").trim();a&&s(N=>{const j=[...N];return j[0]={...j[0],value:String(g)},j[1]={...j[1],value:String(b)},j[2]={...j[2],value:y||j[2].value},j})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Dashboards",features:[{name:"Dashboard List",path:"/business-intelligence/dashboards",description:"Manage KPI dashboards",icon:""},{name:"New Dashboard",path:"/business-intelligence/dashboards/new",description:"Create a new dashboard",icon:""}]},{title:"Reports",features:[{name:"Saved Reports",path:"/business-intelligence/reports",description:"Report definitions and schedules",icon:""},{name:"New Report",path:"/business-intelligence/reports/new",description:"Create a new report definition",icon:""},{name:"BI Reports",path:"/business-intelligence/bi-reports",description:"Quick report shortcuts",icon:""}]}];return e.jsx(To,{title:"Business Intelligence",description:"Analytics, reporting, and data insights",stats:t,sections:r})}function zZ(){return e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(KZ,{})}),e.jsx(tt,{path:"/dashboards",element:e.jsx($Z,{})}),e.jsx(tt,{path:"/dashboards/new",element:e.jsx(IS,{})}),e.jsx(tt,{path:"/dashboards/:id",element:e.jsx(IS,{})}),e.jsx(tt,{path:"/reports",element:e.jsx(WZ,{})}),e.jsx(tt,{path:"/reports/new",element:e.jsx(LS,{})}),e.jsx(tt,{path:"/reports/:id",element:e.jsx(LS,{})}),e.jsx(tt,{path:"/bi-reports",element:e.jsx(GZ,{})})]})}const YZ="/assets/OMNISUITE_WHITE_LOGO-C3pcEyUY.png";function XZ(){const[t,s]=v.useState(()=>wC()),[r,a]=v.useState(null);v.useEffect(()=>{const u=_T(({event:d,snapshot:c})=>{s(c),a(d)});return()=>u()},[]);const n=v.useMemo(()=>t.pending||0,[t.pending]),i=v.useMemo(()=>t.failed||0,[t.failed]),l=v.useMemo(()=>t.completed||0,[t.completed]),o=v.useMemo(()=>t.items||[],[t.items]);return{lastEvent:r,pending:n,failed:i,completed:l,items:o}}function JZ(){const[t,s]=v.useState(null),[r,a]=v.useState(!1),[n,i]=v.useState(!1);v.useEffect(()=>{i("serviceWorker"in navigator);function d(f){var x;(x=f.preventDefault)==null||x.call(f),s(f)}function c(){a(!0),s(null)}window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",c);const m=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches,h=navigator.standalone===!0;return(m||h)&&a(!0),()=>{window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",c)}},[]);const l=v.useMemo(()=>!!t,[t]);async function o(){var c;if(!t)return!1;const d=await((c=t.prompt)==null?void 0:c.call(t));return s(null),d}function u(){s(null)}return{isInstallable:l,isInstalled:r,isPWASupported:n,handleInstall:o,dismissPrompt:u}}function ZZ(){const{isInstallable:t,handleInstall:s}=JZ(),[r,a]=v.useState(!1),[n,i]=v.useState(!0);return v.useEffect(()=>{i(!0)},[]),n?e.jsxs("div",{className:"fixed bottom-4 right-4 z-[60] flex flex-col items-end gap-2",children:[r&&e.jsxs("div",{className:"card p-3 shadow-erp-lg bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Install"}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Use browser menu to install if prompt does not appear."}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{type:"button",className:"btn-secondary px-2 py-1",onClick:()=>a(!1),children:"Close"})})]}),e.jsx("button",{type:"button",className:"btn-primary rounded-full w-12 h-12 shadow-erp-lg flex items-center justify-center","aria-label":"Install app",onClick:async()=>{t?await s():(a(!0),setTimeout(()=>a(!1),4e3))},title:"Install OmniSuite",children:e.jsx(gu,{className:"w-5 h-5"})})]}):null}const DS=[{key:"administration",label:"Administration",path:"/administration",icon:""},{key:"sales",label:"Sales",path:"/sales",icon:""},{key:"inventory",label:"Inventory",path:"/inventory",icon:""},{key:"purchase",label:"Purchase",path:"/purchase",icon:""},{key:"finance",label:"Finance",path:"/finance",icon:""},{key:"human-resources",label:"Human Resources",path:"/human-resources",icon:""},{key:"maintenance",label:"Maintenance",path:"/maintenance",icon:""},{key:"project-management",label:"Project Management",path:"/project-management",icon:""},{key:"production",label:"Production",path:"/production",icon:""},{key:"pos",label:"POS",path:"/pos",icon:""},{key:"business-intelligence",label:"Business Intelligence",path:"/business-intelligence",icon:""}];function eee(){const{user:t,scope:s,setScope:r,logout:a,hasModuleAccess:n}=Qa(),{theme:i}=CC(),{pending:l,failed:o,completed:u,items:d,lastEvent:c}=XZ(),[m,h]=v.useState(!1),[f,x]=v.useState(!1);v.useEffect(()=>{if(c==="queued"){x(!0);const ae=setTimeout(()=>x(!1),3e3);return()=>clearTimeout(ae)}},[c]);const[g,b]=v.useState(typeof navigator<"u"?navigator.onLine!==!1:!0);v.useEffect(()=>{function ae(){b(!0)}function Z(){b(!1)}return window.addEventListener("online",ae),window.addEventListener("offline",Z),()=>{window.removeEventListener("online",ae),window.removeEventListener("offline",Z)}},[]);const[y,N]=v.useState(()=>typeof window<"u"?window.matchMedia("(min-width: 768px)").matches:!1),[j,S]=v.useState(!1),k=v.useRef(null),[P,I]=v.useState(!1),B=v.useMemo(()=>{const ae=(t==null?void 0:t.username)||(t==null?void 0:t.name)||"Guest",Z=(t==null?void 0:t.role)||(Array.isArray(t==null?void 0:t.roles)?t.roles[0]:null)||"Developer",oe=(t==null?void 0:t.companyName)||`Company #${(s==null?void 0:s.companyId)??"-"}`,ee=(t==null?void 0:t.branchName)||`Branch #${(s==null?void 0:s.branchId)??"-"}`;return{username:ae,role:Z,companyName:oe,branchName:ee}},[s==null?void 0:s.branchId,s==null?void 0:s.companyId,t]),q=v.useMemo(()=>Array.isArray(t==null?void 0:t.roles)?t.roles:t!=null&&t.role?[t.role]:[],[t==null?void 0:t.roles,t==null?void 0:t.role]),[Q,O]=v.useState(()=>Array.isArray(t==null?void 0:t.roles)?t.roles[0]:(t==null?void 0:t.role)||null),[T,V]=v.useState([]),[D,Y]=v.useState(!1);v.useEffect(()=>{const ae=Number((t==null?void 0:t.sub)||(t==null?void 0:t.id));if(!Number.isFinite(ae)){V([]);return}let Z=!0;async function oe(){var ee,se,Ae;Y(!0);try{const we=await te.get(`/admin/users/${ae}/roles`),ce=Array.isArray((ee=we.data)==null?void 0:ee.items)?we.data.items:[];Z&&V(ce),Z&&ce.length>0&&!Q&&O(((se=ce[0])==null?void 0:se.name)||((Ae=ce[0])==null?void 0:Ae.code)||null)}catch{Z&&V([])}finally{Z&&Y(!1)}}return oe(),()=>{Z=!1}},[]),v.useEffect(()=>{const ae=Array.isArray(t==null?void 0:t.roles)?t.roles:t!=null&&t.role?[t.role]:[];ae.length&&!ae.includes(Q)&&O(ae[0])},[t==null?void 0:t.roles,t==null?void 0:t.role,Q]);const M=v.useMemo(()=>Number((t==null?void 0:t.sub)||(t==null?void 0:t.id)),[t==null?void 0:t.sub,t==null?void 0:t.id]),[X,R]=v.useState([]),[H,W]=v.useState(null),[K,_]=v.useState([]);v.useEffect(()=>{let ae=!0;async function Z(){var oe,ee;try{if(!Number.isFinite(M))return;const se=await te.get(`/admin/users/${M}/branches`),Ae=Array.isArray((oe=se.data)==null?void 0:oe.items)?se.data.items:[];ae&&(R(Ae),!H&&Ae.length>0&&W(Number(Ae[0].id)))}catch{try{const se=await te.get("/admin/branches"),Ae=Array.isArray((ee=se.data)==null?void 0:ee.items)?se.data.items:[],we=Array.isArray(t==null?void 0:t.branchIds)?t.branchIds.map(Number).filter(le=>Number.isFinite(le)):[],ce=Ae.filter(le=>we.includes(Number(le.id)));ae&&(R(ce),!H&&ce.length>0&&W(Number(ce[0].id)))}catch{}}}return Z(),()=>{ae=!1}},[M,t==null?void 0:t.branchIds,H]),v.useEffect(()=>{let ae=!0;async function Z(){var oe;try{const ee=await te.get("/admin/companies"),se=Array.isArray((oe=ee.data)==null?void 0:oe.items)?ee.data.items:[];ae&&_(se)}catch{}}return Z(),()=>{ae=!1}},[]);const F=v.useMemo(()=>{const ae=X.find(Z=>Number(Z.id)===Number(s==null?void 0:s.branchId));if(ae){const Z=ae.company_name||`Company #${ae.company_id}`;return`${ae.name} (${Z})`}return B.branchName},[X,s==null?void 0:s.branchId,B.branchName]),E=v.useMemo(()=>{const ae=X.find(oe=>Number(oe.id)===Number(s==null?void 0:s.branchId));if(ae)return ae.company_name||`Company #${ae.company_id}`;if(X.length===1){const oe=X[0];return oe.company_name||`Company #${oe.company_id}`}const Z=K.find(oe=>Number(oe.id)===Number(s==null?void 0:s.companyId));return Z?Z.name:(t==null?void 0:t.companyName)||`Company #${(s==null?void 0:s.companyId)??"-"}`},[X,s==null?void 0:s.branchId,t==null?void 0:t.companyName,s==null?void 0:s.companyId,K]);v.useEffect(()=>{const ae=Array.isArray(T)&&T.length>1||Array.isArray(q)&&q.length>1,Z=Array.isArray(X)?X.length>1:!1;ae&&Z&&I(!0)},[T,q,X]);const L=Ns(),U=Ba(),J=v.useMemo(()=>{const ae=U.pathname.replace(/\/+$/,"")||"/";return ae==="/"||ae==="/dashboard"?!0:DS.some(Z=>Z.path===ae)},[U.pathname]);return v.useEffect(()=>{typeof window<"u"&&(window.matchMedia("(min-width: 768px)").matches?N(J):N(!1))},[U.pathname,J]),v.useEffect(()=>{function ae(Z){k.current&&(k.current.contains(Z.target)||S(!1))}return document.addEventListener("mousedown",ae),()=>document.removeEventListener("mousedown",ae)},[]),e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100 flex flex-col",children:[e.jsxs("header",{className:"flex justify-between items-center px-6 py-1 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 shadow-sm z-50 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button","aria-label":"Open menu",onClick:()=>N(ae=>!ae),className:"inline-flex items-center justify-center w-9 h-9 rounded-lg text-slate-500 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800 transition-colors",children:e.jsx("span",{className:"text-xl leading-none","aria-hidden":"true",children:""})}),e.jsx(Ee,{to:"/",className:"inline-flex items-center","aria-label":"Go to Home",children:e.jsx("img",{src:i==="dark"?YZ:Gs,alt:"OmniSuite",className:"h-8 w-auto"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($6,{}),e.jsxs("div",{className:"relative",ref:k,children:[e.jsxs("button",{type:"button",onClick:()=>S(ae=>!ae),className:"inline-flex items-center gap-2 px-3 py-1 rounded-lg text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800 transition-colors",children:[e.jsx("span",{className:"text-sm font-semibold",children:"User Profile"}),e.jsx("span",{"aria-hidden":"true",children:""})]}),j&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 shadow-erp-lg overflow-hidden z-50",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:B.username})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Company"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100 text-right",children:E})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Branch"}),e.jsx("div",{className:"text-right",children:X.length>1?e.jsx("select",{className:"input",value:String((s==null?void 0:s.branchId)||H||""),onChange:ae=>{const Z=Number(ae.target.value);W(Z),r(oe=>{const ee=X.find(Ae=>Number(Ae.id)===Z),se=ee?Number(ee.company_id):oe.companyId;return{...oe,companyId:se,branchId:Z}}),S(!1)},children:X.map(ae=>e.jsxs("option",{value:ae.id,children:[ae.name," (",ae.company_name||`Company #${ae.company_id}`,")"]},ae.id))}):e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:F})})]}),e.jsx("div",{className:"pt-1",children:e.jsx("button",{type:"button",onClick:()=>I(!0),className:"btn-primary w-full",disabled:(T.length>1||q.length>1)&&X.length>1,children:"Switch Context"})}),e.jsx("div",{className:"pt-3 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>{S(!1),a(),L("/login",{replace:!0})},className:"btn-secondary",children:"Logout"})})]})]})]})]})]}),f&&e.jsx("div",{className:"px-6 py-2 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 border-b border-green-300 dark:border-green-800 text-sm",children:"Saved Offline"}),!g&&e.jsx("div",{className:"px-6 py-2 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 border-b border-yellow-300 dark:border-yellow-800 text-sm",children:"Offline mode enabled. Pages and assets are cached. Actions queue for sync."}),m&&e.jsxs("div",{className:"px-6 py-3 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950",children:[e.jsxs("div",{className:"text-sm",children:["Pending ",l,"  Failed ",o,"  Completed ",u]}),e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[d.map(ae=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:ae.method.toUpperCase()})," ",e.jsx("span",{className:"text-slate-500",children:ae.url})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:ae.status==="pending"?"badge bg-yellow-100 text-yellow-800 border-yellow-300 dark:bg-yellow-900 dark:text-yellow-200 dark:border-yellow-800":ae.status==="failed"?"badge bg-red-100 text-red-800 border-red-300 dark:bg-red-900 dark:text-red-200 dark:border-red-800":"badge bg-green-100 text-green-800 border-green-300 dark:bg-green-900 dark:text-green-200 dark:border-green-800",children:ae.status})})]},ae.id)),d.length===0&&e.jsx("div",{className:"text-xs text-slate-500",children:"No queued items"})]})})]}),P&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-md card p-6 shadow-erp-lg bg-white dark:bg-slate-900",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Switch Role & Branch"}),e.jsx("button",{type:"button",className:"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200",onClick:()=>I(!1),"aria-label":"Close",children:""})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company"}),e.jsx("div",{className:"input",children:E})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),T.length>1||q.length>1?e.jsx("select",{className:"input w-full",value:Q||"",onChange:ae=>O(ae.target.value),disabled:D,children:(T.length?T:q).map(ae=>{const Z=typeof ae=="string"?ae:ae.name||ae.code,oe=typeof ae=="string"?ae:ae.id;return e.jsx("option",{value:Z,children:Z},oe)})}):e.jsx("div",{className:"input",children:Q||B.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branch"}),X.length>1?e.jsx("select",{className:"input w-full",value:String(H||(s==null?void 0:s.branchId)||""),onChange:ae=>W(Number(ae.target.value)),children:X.map(ae=>e.jsxs("option",{value:ae.id,children:[ae.name," (",ae.company_name||`Company #${ae.company_id}`,")"]},ae.id))}):e.jsx("div",{className:"input",children:F})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>I(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",disabled:(T.length>1||q.length>1)&&!Q||X.length>1&&!H,onClick:()=>{const ae=X.find(Z=>Number(Z.id)===Number(H||(s==null?void 0:s.branchId)));r(Z=>({...Z,companyId:ae?Number(ae.company_id):Z.companyId,branchId:ae?Number(ae.id):Z.branchId})),I(!1),S(!1)},children:"Apply"})]})]})}),e.jsxs("div",{className:"flex-1 "+(y?"grid md:grid-cols-[280px_1fr]":"grid grid-cols-1"),children:[y&&e.jsx("button",{type:"button","aria-label":"Close menu",onClick:()=>N(!1),className:"fixed inset-0 z-40 bg-black/40 md:hidden"}),e.jsx("aside",{className:"border-b md:border-b-0 md:border-r border-slate-800 dark:border-slate-800 p-5 md:sticky md:top-[45px] md:h-[calc(100vh-45px)] bg-brand-950 dark:bg-slate-950 shadow-lg overflow-y-auto no-scrollbar z-40 "+(y?"fixed md:static inset-y-0 left-0 w-[280px] top-[45px]":"hidden"),children:e.jsxs("nav",{className:"space-y-1 pb-6",children:[e.jsxs(AN,{to:"/",end:!0,className:({isActive:ae})=>"flex items-center px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group "+(ae?"bg-brand-800 text-white shadow-lg border-l-4 border-primary-light":"text-brand-200 hover:bg-brand-800 hover:text-white border-l-4 border-transparent"),children:[e.jsx("span",{className:"w-6 text-lg leading-none opacity-80 group-hover:opacity-100 transition-opacity","aria-hidden":"true",children:""}),"Home"]}),DS.filter(ae=>n(ae.label)).map(ae=>e.jsxs(AN,{to:ae.path,className:({isActive:Z})=>"flex items-center px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group "+(Z?"bg-brand-800 text-white shadow-lg border-l-4 border-primary-light":"text-brand-200 hover:bg-brand-800 hover:text-white border-l-4 border-transparent"),children:[e.jsx("span",{className:"w-6 text-lg leading-none opacity-80 group-hover:opacity-100 transition-opacity","aria-hidden":"true",children:ae.icon}),e.jsx("span",{children:ae.label})]},ae.key))]})}),e.jsx("main",{className:"bg-slate-50 dark:bg-slate-900",children:e.jsx("div",{className:"w-full max-w-full lg:max-w-[1200px] mx-auto p-3 md:p-4 lg:p-6",children:e.jsxs(_l,{children:[e.jsx(tt,{path:"/",element:e.jsx(G6,{})}),e.jsx(tt,{path:"/dashboard",element:e.jsx(W6,{})}),e.jsx(tt,{path:"/administration/*",element:e.jsx(PO,{})}),e.jsx(tt,{path:"/sales/*",element:e.jsx(oY,{})}),e.jsx(tt,{path:"/inventory/*",element:e.jsx(GY,{})}),e.jsx(tt,{path:"/purchase/*",element:e.jsx(vJ,{})}),e.jsx(tt,{path:"/finance/*",element:e.jsx(VJ,{})}),e.jsx(tt,{path:"/human-resources/*",element:e.jsx(iZ,{})}),e.jsx(tt,{path:"/maintenance/*",element:e.jsx(AZ,{})}),e.jsx(tt,{path:"/project-management/*",element:e.jsx(xZ,{})}),e.jsx(tt,{path:"/production/*",element:e.jsx(jZ,{})}),e.jsx(tt,{path:"/pos/*",element:e.jsx(VZ,{})}),e.jsx(tt,{path:"/business-intelligence/*",element:e.jsx(zZ,{})})]})})})]}),e.jsx(ZZ,{})]})}function tee(){const t="/".replace(/\/+$/,""),s=t.startsWith("/")?t:"/";return e.jsx(CF,{basename:s,children:e.jsx(RI,{store:q6,children:e.jsx(PT,{children:e.jsxs(DT,{children:[e.jsx(VF,{position:"top-right",theme:"dark"}),e.jsxs(_l,{children:[e.jsx(tt,{path:"/login",element:e.jsx(yI,{})}),e.jsx(tt,{path:"/forgot-password",element:e.jsx(jI,{})}),e.jsx(tt,{path:"/reset-password",element:e.jsx(NI,{})}),e.jsx(tt,{path:"/select-branch",element:e.jsx(UN,{children:e.jsx(V6,{})})}),e.jsx(tt,{path:"/*",element:e.jsx(UN,{children:e.jsx(eee,{})})}),e.jsx(tt,{path:"*",element:e.jsx(Wc,{to:"/",replace:!0})})]})]})})})})}const see="/assets/OMNISUITE_ICON_CLEAR-n2Vk6MyQ.png";function ree(t={}){const{immediate:s=!1,onNeedRefresh:r,onOfflineReady:a,onRegistered:n,onRegisteredSW:i,onRegisterError:l}=t;let o,u;const d=async(m=!0)=>{await u};async function c(){if("serviceWorker"in navigator){if(o=await Gx(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-BIl4cyR9.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{l==null||l(m)}),!o)return;o.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),o.addEventListener("installed",m=>{m.isUpdate||a==null||a()}),o.register({immediate:s}).then(m=>{i?i("/sw.js",m):n==null||n(m)}).catch(m=>{l==null||l(m)})}}return u=c(),d}ree({immediate:!0});(function(){try{const s=document.head||document.getElementsByTagName("head")[0];["icon","shortcut icon","apple-touch-icon","apple-touch-icon-precomposed"].forEach(a=>{let n=document.querySelector(`link[rel="${a}"]`);n||(n=document.createElement("link"),n.setAttribute("rel",a),n.setAttribute("type","image/png"),a.startsWith("apple-touch-icon")&&n.setAttribute("sizes","180x180"),s.appendChild(n)),n.setAttribute("href",see)})}catch{}})();kE.createRoot(document.getElementById("root")).render(e.jsx(Os.StrictMode,{children:e.jsx(tee,{})}));export{Gr as _,nee as c,PS as g};
