var NE=Object.defineProperty;var wE=(t,s,r)=>s in t?NE(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Xg=(t,s,r)=>wE(t,typeof s!="symbol"?s+"":s,r);function _E(t,s){for(var r=0;r<s.length;r++){const a=s[r];if(typeof a!="string"&&!Array.isArray(a)){for(const n in a)if(n!=="default"&&!(n in t)){const i=Object.getOwnPropertyDescriptor(a,n);i&&Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:()=>a[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var fee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iy(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Jg={exports:{}},mm={},Zg={exports:{}},cr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z1;function SE(){if(Z1)return cr;Z1=1;var t=Symbol.for("react.element"),s=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),h=Symbol.iterator;function A(Q){return Q===null||typeof Q!="object"?null:(Q=h&&Q[h]||Q["@@iterator"],typeof Q=="function"?Q:null)}var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function b(Q,C,E){this.props=Q,this.context=C,this.refs=v,this.updater=E||f}b.prototype.isReactComponent={},b.prototype.setState=function(Q,C){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,C,"setState")},b.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function y(){}y.prototype=b.prototype;function j(Q,C,E){this.props=Q,this.context=C,this.refs=v,this.updater=E||f}var N=j.prototype=new y;N.constructor=j,g(N,b.prototype),N.isPureReactComponent=!0;var S=Array.isArray,B=Object.prototype.hasOwnProperty,P={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function U(Q,C,E){var w,O={},R=null,X=null;if(C!=null)for(w in C.ref!==void 0&&(X=C.ref),C.key!==void 0&&(R=""+C.key),C)B.call(C,w)&&!L.hasOwnProperty(w)&&(O[w]=C[w]);var ne=arguments.length-2;if(ne===1)O.children=E;else if(1<ne){for(var te=Array(ne),oe=0;oe<ne;oe++)te[oe]=arguments[oe+2];O.children=te}if(Q&&Q.defaultProps)for(w in ne=Q.defaultProps,ne)O[w]===void 0&&(O[w]=ne[w]);return{$$typeof:t,type:Q,key:R,ref:X,props:O,_owner:P.current}}function H(Q,C){return{$$typeof:t,type:Q.type,key:C,ref:Q.ref,props:Q.props,_owner:Q._owner}}function q(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function V(Q){var C={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(E){return C[E]})}var M=/\/+/g;function z(Q,C){return typeof Q=="object"&&Q!==null&&Q.key!=null?V(""+Q.key):C.toString(36)}function I(Q,C,E,w,O){var R=typeof Q;(R==="undefined"||R==="boolean")&&(Q=null);var X=!1;if(Q===null)X=!0;else switch(R){case"string":case"number":X=!0;break;case"object":switch(Q.$$typeof){case t:case s:X=!0}}if(X)return X=Q,O=O(X),Q=w===""?"."+z(X,0):w,S(O)?(E="",Q!=null&&(E=Q.replace(M,"$&/")+"/"),I(O,C,E,"",function(oe){return oe})):O!=null&&(q(O)&&(O=H(O,E+(!O.key||X&&X.key===O.key?"":(""+O.key).replace(M,"$&/")+"/")+Q)),C.push(O)),1;if(X=0,w=w===""?".":w+":",S(Q))for(var ne=0;ne<Q.length;ne++){R=Q[ne];var te=w+z(R,ne);X+=I(R,C,E,te,O)}else if(te=A(Q),typeof te=="function")for(Q=te.call(Q),ne=0;!(R=Q.next()).done;)R=R.value,te=w+z(R,ne++),X+=I(R,C,E,te,O);else if(R==="object")throw C=String(Q),Error("Objects are not valid as a React child (found: "+(C==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":C)+"). If you meant to render a collection of children, use an array instead.");return X}function G(Q,C,E){if(Q==null)return Q;var w=[],O=0;return I(Q,w,"","",function(R){return C.call(E,R,O++)}),w}function Y(Q){if(Q._status===-1){var C=Q._result;C=C(),C.then(function(E){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=E)},function(E){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=E)}),Q._status===-1&&(Q._status=0,Q._result=C)}if(Q._status===1)return Q._result.default;throw Q._result}var J={current:null},T={transition:null},k={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:T,ReactCurrentOwner:P};function D(){throw Error("act(...) is not supported in production builds of React.")}return cr.Children={map:G,forEach:function(Q,C,E){G(Q,function(){C.apply(this,arguments)},E)},count:function(Q){var C=0;return G(Q,function(){C++}),C},toArray:function(Q){return G(Q,function(C){return C})||[]},only:function(Q){if(!q(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},cr.Component=b,cr.Fragment=r,cr.Profiler=n,cr.PureComponent=j,cr.StrictMode=a,cr.Suspense=u,cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,cr.act=D,cr.cloneElement=function(Q,C,E){if(Q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Q+".");var w=g({},Q.props),O=Q.key,R=Q.ref,X=Q._owner;if(C!=null){if(C.ref!==void 0&&(R=C.ref,X=P.current),C.key!==void 0&&(O=""+C.key),Q.type&&Q.type.defaultProps)var ne=Q.type.defaultProps;for(te in C)B.call(C,te)&&!L.hasOwnProperty(te)&&(w[te]=C[te]===void 0&&ne!==void 0?ne[te]:C[te])}var te=arguments.length-2;if(te===1)w.children=E;else if(1<te){ne=Array(te);for(var oe=0;oe<te;oe++)ne[oe]=arguments[oe+2];w.children=ne}return{$$typeof:t,type:Q.type,key:O,ref:R,props:w,_owner:X}},cr.createContext=function(Q){return Q={$$typeof:l,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Q.Provider={$$typeof:i,_context:Q},Q.Consumer=Q},cr.createElement=U,cr.createFactory=function(Q){var C=U.bind(null,Q);return C.type=Q,C},cr.createRef=function(){return{current:null}},cr.forwardRef=function(Q){return{$$typeof:o,render:Q}},cr.isValidElement=q,cr.lazy=function(Q){return{$$typeof:c,_payload:{_status:-1,_result:Q},_init:Y}},cr.memo=function(Q,C){return{$$typeof:d,type:Q,compare:C===void 0?null:C}},cr.startTransition=function(Q){var C=T.transition;T.transition={};try{Q()}finally{T.transition=C}},cr.unstable_act=D,cr.useCallback=function(Q,C){return J.current.useCallback(Q,C)},cr.useContext=function(Q){return J.current.useContext(Q)},cr.useDebugValue=function(){},cr.useDeferredValue=function(Q){return J.current.useDeferredValue(Q)},cr.useEffect=function(Q,C){return J.current.useEffect(Q,C)},cr.useId=function(){return J.current.useId()},cr.useImperativeHandle=function(Q,C,E){return J.current.useImperativeHandle(Q,C,E)},cr.useInsertionEffect=function(Q,C){return J.current.useInsertionEffect(Q,C)},cr.useLayoutEffect=function(Q,C){return J.current.useLayoutEffect(Q,C)},cr.useMemo=function(Q,C){return J.current.useMemo(Q,C)},cr.useReducer=function(Q,C,E){return J.current.useReducer(Q,C,E)},cr.useRef=function(Q){return J.current.useRef(Q)},cr.useState=function(Q){return J.current.useState(Q)},cr.useSyncExternalStore=function(Q,C,E){return J.current.useSyncExternalStore(Q,C,E)},cr.useTransition=function(){return J.current.useTransition()},cr.version="18.3.1",cr}var eN;function Rh(){return eN||(eN=1,Zg.exports=SE()),Zg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tN;function CE(){if(tN)return mm;tN=1;var t=Rh(),s=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(o,u,d){var c,h={},A=null,f=null;d!==void 0&&(A=""+d),u.key!==void 0&&(A=""+u.key),u.ref!==void 0&&(f=u.ref);for(c in u)a.call(u,c)&&!i.hasOwnProperty(c)&&(h[c]=u[c]);if(o&&o.defaultProps)for(c in u=o.defaultProps,u)h[c]===void 0&&(h[c]=u[c]);return{$$typeof:s,type:o,key:A,ref:f,props:h,_owner:n.current}}return mm.Fragment=r,mm.jsx=l,mm.jsxs=l,mm}var sN;function kE(){return sN||(sN=1,Jg.exports=CE()),Jg.exports}var e=kE(),x=Rh();const Ts=Iy(x),BE=_E({__proto__:null,default:Ts},[x]);var kp={},ev={exports:{}},$i={},tv={exports:{}},sv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rN;function EE(){return rN||(rN=1,(function(t){function s(T,k){var D=T.length;T.push(k);e:for(;0<D;){var Q=D-1>>>1,C=T[Q];if(0<n(C,k))T[Q]=k,T[D]=C,D=Q;else break e}}function r(T){return T.length===0?null:T[0]}function a(T){if(T.length===0)return null;var k=T[0],D=T.pop();if(D!==k){T[0]=D;e:for(var Q=0,C=T.length,E=C>>>1;Q<E;){var w=2*(Q+1)-1,O=T[w],R=w+1,X=T[R];if(0>n(O,D))R<C&&0>n(X,O)?(T[Q]=X,T[R]=D,Q=R):(T[Q]=O,T[w]=D,Q=w);else if(R<C&&0>n(X,D))T[Q]=X,T[R]=D,Q=R;else break e}}return k}function n(T,k){var D=T.sortIndex-k.sortIndex;return D!==0?D:T.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,o=l.now();t.unstable_now=function(){return l.now()-o}}var u=[],d=[],c=1,h=null,A=3,f=!1,g=!1,v=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(T){for(var k=r(d);k!==null;){if(k.callback===null)a(d);else if(k.startTime<=T)a(d),k.sortIndex=k.expirationTime,s(u,k);else break;k=r(d)}}function S(T){if(v=!1,N(T),!g)if(r(u)!==null)g=!0,Y(B);else{var k=r(d);k!==null&&J(S,k.startTime-T)}}function B(T,k){g=!1,v&&(v=!1,y(U),U=-1),f=!0;var D=A;try{for(N(k),h=r(u);h!==null&&(!(h.expirationTime>k)||T&&!V());){var Q=h.callback;if(typeof Q=="function"){h.callback=null,A=h.priorityLevel;var C=Q(h.expirationTime<=k);k=t.unstable_now(),typeof C=="function"?h.callback=C:h===r(u)&&a(u),N(k)}else a(u);h=r(u)}if(h!==null)var E=!0;else{var w=r(d);w!==null&&J(S,w.startTime-k),E=!1}return E}finally{h=null,A=D,f=!1}}var P=!1,L=null,U=-1,H=5,q=-1;function V(){return!(t.unstable_now()-q<H)}function M(){if(L!==null){var T=t.unstable_now();q=T;var k=!0;try{k=L(!0,T)}finally{k?z():(P=!1,L=null)}}else P=!1}var z;if(typeof j=="function")z=function(){j(M)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,G=I.port2;I.port1.onmessage=M,z=function(){G.postMessage(null)}}else z=function(){b(M,0)};function Y(T){L=T,P||(P=!0,z())}function J(T,k){U=b(function(){T(t.unstable_now())},k)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,Y(B))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(T){switch(A){case 1:case 2:case 3:var k=3;break;default:k=A}var D=A;A=k;try{return T()}finally{A=D}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,k){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var D=A;A=T;try{return k()}finally{A=D}},t.unstable_scheduleCallback=function(T,k,D){var Q=t.unstable_now();switch(typeof D=="object"&&D!==null?(D=D.delay,D=typeof D=="number"&&0<D?Q+D:Q):D=Q,T){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=D+C,T={id:c++,callback:k,priorityLevel:T,startTime:D,expirationTime:C,sortIndex:-1},D>Q?(T.sortIndex=D,s(d,T),r(u)===null&&T===r(d)&&(v?(y(U),U=-1):v=!0,J(S,D-Q))):(T.sortIndex=C,s(u,T),g||f||(g=!0,Y(B))),T},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(T){var k=A;return function(){var D=A;A=k;try{return T.apply(this,arguments)}finally{A=D}}}})(sv)),sv}var aN;function FE(){return aN||(aN=1,tv.exports=EE()),tv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nN;function TE(){if(nN)return $i;nN=1;var t=Rh(),s=FE();function r(m){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+m,_=1;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+m+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,n={};function i(m,p){l(m,p),l(m+"Capture",p)}function l(m,p){for(n[m]=p,m=0;m<p.length;m++)a.add(p[m])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,c={},h={};function A(m){return u.call(h,m)?!0:u.call(c,m)?!1:d.test(m)?h[m]=!0:(c[m]=!0,!1)}function f(m,p,_,W){if(_!==null&&_.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return W?!1:_!==null?!_.acceptsBooleans:(m=m.toLowerCase().slice(0,5),m!=="data-"&&m!=="aria-");default:return!1}}function g(m,p,_,W){if(p===null||typeof p>"u"||f(m,p,_,W))return!0;if(W)return!1;if(_!==null)switch(_.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function v(m,p,_,W,ae,me,Re){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=W,this.attributeNamespace=ae,this.mustUseProperty=_,this.propertyName=m,this.type=p,this.sanitizeURL=me,this.removeEmptyString=Re}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(m){b[m]=new v(m,0,!1,m,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(m){var p=m[0];b[p]=new v(p,1,!1,m[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(m){b[m]=new v(m,2,!1,m.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(m){b[m]=new v(m,2,!1,m,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(m){b[m]=new v(m,3,!1,m.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(m){b[m]=new v(m,3,!0,m,null,!1,!1)}),["capture","download"].forEach(function(m){b[m]=new v(m,4,!1,m,null,!1,!1)}),["cols","rows","size","span"].forEach(function(m){b[m]=new v(m,6,!1,m,null,!1,!1)}),["rowSpan","start"].forEach(function(m){b[m]=new v(m,5,!1,m.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function j(m){return m[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(m){var p=m.replace(y,j);b[p]=new v(p,1,!1,m,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(m){var p=m.replace(y,j);b[p]=new v(p,1,!1,m,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(m){var p=m.replace(y,j);b[p]=new v(p,1,!1,m,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(m){b[m]=new v(m,1,!1,m.toLowerCase(),null,!1,!1)}),b.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(m){b[m]=new v(m,1,!1,m.toLowerCase(),null,!0,!0)});function N(m,p,_,W){var ae=b.hasOwnProperty(p)?b[p]:null;(ae!==null?ae.type!==0:W||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(g(p,_,ae,W)&&(_=null),W||ae===null?A(p)&&(_===null?m.removeAttribute(p):m.setAttribute(p,""+_)):ae.mustUseProperty?m[ae.propertyName]=_===null?ae.type===3?!1:"":_:(p=ae.attributeName,W=ae.attributeNamespace,_===null?m.removeAttribute(p):(ae=ae.type,_=ae===3||ae===4&&_===!0?"":""+_,W?m.setAttributeNS(W,p,_):m.setAttribute(p,_))))}var S=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),P=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),V=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),T=Symbol.iterator;function k(m){return m===null||typeof m!="object"?null:(m=T&&m[T]||m["@@iterator"],typeof m=="function"?m:null)}var D=Object.assign,Q;function C(m){if(Q===void 0)try{throw Error()}catch(_){var p=_.stack.trim().match(/\n( *(at )?)/);Q=p&&p[1]||""}return`
`+Q+m}var E=!1;function w(m,p){if(!m||E)return"";E=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(Mt){var W=Mt}Reflect.construct(m,[],p)}else{try{p.call()}catch(Mt){W=Mt}m.call(p.prototype)}else{try{throw Error()}catch(Mt){W=Mt}m()}}catch(Mt){if(Mt&&W&&typeof Mt.stack=="string"){for(var ae=Mt.stack.split(`
`),me=W.stack.split(`
`),Re=ae.length-1,At=me.length-1;1<=Re&&0<=At&&ae[Re]!==me[At];)At--;for(;1<=Re&&0<=At;Re--,At--)if(ae[Re]!==me[At]){if(Re!==1||At!==1)do if(Re--,At--,0>At||ae[Re]!==me[At]){var Nt=`
`+ae[Re].replace(" at new "," at ");return m.displayName&&Nt.includes("<anonymous>")&&(Nt=Nt.replace("<anonymous>",m.displayName)),Nt}while(1<=Re&&0<=At);break}}}finally{E=!1,Error.prepareStackTrace=_}return(m=m?m.displayName||m.name:"")?C(m):""}function O(m){switch(m.tag){case 5:return C(m.type);case 16:return C("Lazy");case 13:return C("Suspense");case 19:return C("SuspenseList");case 0:case 2:case 15:return m=w(m.type,!1),m;case 11:return m=w(m.type.render,!1),m;case 1:return m=w(m.type,!0),m;default:return""}}function R(m){if(m==null)return null;if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case L:return"Fragment";case P:return"Portal";case H:return"Profiler";case U:return"StrictMode";case z:return"Suspense";case I:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case V:return(m.displayName||"Context")+".Consumer";case q:return(m._context.displayName||"Context")+".Provider";case M:var p=m.render;return m=m.displayName,m||(m=p.displayName||p.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case G:return p=m.displayName||null,p!==null?p:R(m.type)||"Memo";case Y:p=m._payload,m=m._init;try{return R(m(p))}catch{}}return null}function X(m){var p=m.type;switch(m.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return m=p.render,m=m.displayName||m.name||"",p.displayName||(m!==""?"ForwardRef("+m+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(p);case 8:return p===U?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function ne(m){switch(typeof m){case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function te(m){var p=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function oe(m){var p=te(m)?"checked":"value",_=Object.getOwnPropertyDescriptor(m.constructor.prototype,p),W=""+m[p];if(!m.hasOwnProperty(p)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var ae=_.get,me=_.set;return Object.defineProperty(m,p,{configurable:!0,get:function(){return ae.call(this)},set:function(Re){W=""+Re,me.call(this,Re)}}),Object.defineProperty(m,p,{enumerable:_.enumerable}),{getValue:function(){return W},setValue:function(Re){W=""+Re},stopTracking:function(){m._valueTracker=null,delete m[p]}}}}function ce(m){m._valueTracker||(m._valueTracker=oe(m))}function re(m){if(!m)return!1;var p=m._valueTracker;if(!p)return!0;var _=p.getValue(),W="";return m&&(W=te(m)?m.checked?"true":"false":m.value),m=W,m!==_?(p.setValue(m),!0):!1}function de(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}function Ie(m,p){var _=p.checked;return D({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_??m._wrapperState.initialChecked})}function le(m,p){var _=p.defaultValue==null?"":p.defaultValue,W=p.checked!=null?p.checked:p.defaultChecked;_=ne(p.value!=null?p.value:_),m._wrapperState={initialChecked:W,initialValue:_,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function Z(m,p){p=p.checked,p!=null&&N(m,"checked",p,!1)}function ve(m,p){Z(m,p);var _=ne(p.value),W=p.type;if(_!=null)W==="number"?(_===0&&m.value===""||m.value!=_)&&(m.value=""+_):m.value!==""+_&&(m.value=""+_);else if(W==="submit"||W==="reset"){m.removeAttribute("value");return}p.hasOwnProperty("value")?Be(m,p.type,_):p.hasOwnProperty("defaultValue")&&Be(m,p.type,ne(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(m.defaultChecked=!!p.defaultChecked)}function Ue(m,p,_){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var W=p.type;if(!(W!=="submit"&&W!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+m._wrapperState.initialValue,_||p===m.value||(m.value=p),m.defaultValue=p}_=m.name,_!==""&&(m.name=""),m.defaultChecked=!!m._wrapperState.initialChecked,_!==""&&(m.name=_)}function Be(m,p,_){(p!=="number"||de(m.ownerDocument)!==m)&&(_==null?m.defaultValue=""+m._wrapperState.initialValue:m.defaultValue!==""+_&&(m.defaultValue=""+_))}var _e=Array.isArray;function Me(m,p,_,W){if(m=m.options,p){p={};for(var ae=0;ae<_.length;ae++)p["$"+_[ae]]=!0;for(_=0;_<m.length;_++)ae=p.hasOwnProperty("$"+m[_].value),m[_].selected!==ae&&(m[_].selected=ae),ae&&W&&(m[_].defaultSelected=!0)}else{for(_=""+ne(_),p=null,ae=0;ae<m.length;ae++){if(m[ae].value===_){m[ae].selected=!0,W&&(m[ae].defaultSelected=!0);return}p!==null||m[ae].disabled||(p=m[ae])}p!==null&&(p.selected=!0)}}function Ye(m,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return D({},p,{value:void 0,defaultValue:void 0,children:""+m._wrapperState.initialValue})}function ot(m,p){var _=p.value;if(_==null){if(_=p.children,p=p.defaultValue,_!=null){if(p!=null)throw Error(r(92));if(_e(_)){if(1<_.length)throw Error(r(93));_=_[0]}p=_}p==null&&(p=""),_=p}m._wrapperState={initialValue:ne(_)}}function Ke(m,p){var _=ne(p.value),W=ne(p.defaultValue);_!=null&&(_=""+_,_!==m.value&&(m.value=_),p.defaultValue==null&&m.defaultValue!==_&&(m.defaultValue=_)),W!=null&&(m.defaultValue=""+W)}function ct(m){var p=m.textContent;p===m._wrapperState.initialValue&&p!==""&&p!==null&&(m.value=p)}function xt(m){switch(m){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function be(m,p){return m==null||m==="http://www.w3.org/1999/xhtml"?xt(p):m==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":m}var Ce,Te=(function(m){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,_,W,ae){MSApp.execUnsafeLocalFunction(function(){return m(p,_,W,ae)})}:m})(function(m,p){if(m.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in m)m.innerHTML=p;else{for(Ce=Ce||document.createElement("div"),Ce.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=Ce.firstChild;m.firstChild;)m.removeChild(m.firstChild);for(;p.firstChild;)m.appendChild(p.firstChild)}});function ue(m,p){if(p){var _=m.firstChild;if(_&&_===m.lastChild&&_.nodeType===3){_.nodeValue=p;return}}m.textContent=p}var ge={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ve=["Webkit","ms","Moz","O"];Object.keys(ge).forEach(function(m){Ve.forEach(function(p){p=p+m.charAt(0).toUpperCase()+m.substring(1),ge[p]=ge[m]})});function tt(m,p,_){return p==null||typeof p=="boolean"||p===""?"":_||typeof p!="number"||p===0||ge.hasOwnProperty(m)&&ge[m]?(""+p).trim():p+"px"}function Ze(m,p){m=m.style;for(var _ in p)if(p.hasOwnProperty(_)){var W=_.indexOf("--")===0,ae=tt(_,p[_],W);_==="float"&&(_="cssFloat"),W?m.setProperty(_,ae):m[_]=ae}}var ht=D({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ze(m,p){if(p){if(ht[m]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,m));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!="object")throw Error(r(62))}}function Fe(m,p){if(m.indexOf("-")===-1)return typeof p.is=="string";switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Xe=null,ut=null,ft=null;function mt(m){if(m=_d(m)){if(typeof Xe!="function")throw Error(r(280));var p=m.stateNode;p&&(p=Du(p),Xe(m.stateNode,m.type,p))}}function pt(m){ut?ft?ft.push(m):ft=[m]:ut=m}function vt(){if(ut){var m=ut,p=ft;if(ft=ut=null,mt(m),p)for(m=0;m<p.length;m++)mt(p[m])}}function Ot(m,p){return m(p)}function Ae(){}var je=!1;function We(m,p,_){if(je)return m(p,_);je=!0;try{return Ot(m,p,_)}finally{je=!1,(ut!==null||ft!==null)&&(Ae(),vt())}}function De(m,p){var _=m.stateNode;if(_===null)return null;var W=Du(_);if(W===null)return null;_=W[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(W=!W.disabled)||(m=m.type,W=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!W;break e;default:m=!1}if(m)return null;if(_&&typeof _!="function")throw Error(r(231,p,typeof _));return _}var lt=!1;if(o)try{var rt={};Object.defineProperty(rt,"passive",{get:function(){lt=!0}}),window.addEventListener("test",rt,rt),window.removeEventListener("test",rt,rt)}catch{lt=!1}function et(m,p,_,W,ae,me,Re,At,Nt){var Mt=Array.prototype.slice.call(arguments,3);try{p.apply(_,Mt)}catch(cs){this.onError(cs)}}var Qt=!1,Qe=null,he=!1,pe=null,ye={onError:function(m){Qt=!0,Qe=m}};function Ne(m,p,_,W,ae,me,Re,At,Nt){Qt=!1,Qe=null,et.apply(ye,arguments)}function He(m,p,_,W,ae,me,Re,At,Nt){if(Ne.apply(this,arguments),Qt){if(Qt){var Mt=Qe;Qt=!1,Qe=null}else throw Error(r(198));he||(he=!0,pe=Mt)}}function Ge(m){var p=m,_=m;if(m.alternate)for(;p.return;)p=p.return;else{m=p;do p=m,(p.flags&4098)!==0&&(_=p.return),m=p.return;while(m)}return p.tag===3?_:null}function gt(m){if(m.tag===13){var p=m.memoizedState;if(p===null&&(m=m.alternate,m!==null&&(p=m.memoizedState)),p!==null)return p.dehydrated}return null}function kt(m){if(Ge(m)!==m)throw Error(r(188))}function yt(m){var p=m.alternate;if(!p){if(p=Ge(m),p===null)throw Error(r(188));return p!==m?null:m}for(var _=m,W=p;;){var ae=_.return;if(ae===null)break;var me=ae.alternate;if(me===null){if(W=ae.return,W!==null){_=W;continue}break}if(ae.child===me.child){for(me=ae.child;me;){if(me===_)return kt(ae),m;if(me===W)return kt(ae),p;me=me.sibling}throw Error(r(188))}if(_.return!==W.return)_=ae,W=me;else{for(var Re=!1,At=ae.child;At;){if(At===_){Re=!0,_=ae,W=me;break}if(At===W){Re=!0,W=ae,_=me;break}At=At.sibling}if(!Re){for(At=me.child;At;){if(At===_){Re=!0,_=me,W=ae;break}if(At===W){Re=!0,W=me,_=ae;break}At=At.sibling}if(!Re)throw Error(r(189))}}if(_.alternate!==W)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?m:p}function Et(m){return m=yt(m),m!==null?Ft(m):null}function Ft(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){var p=Ft(m);if(p!==null)return p;m=m.sibling}return null}var Yt=s.unstable_scheduleCallback,rs=s.unstable_cancelCallback,As=s.unstable_shouldYield,es=s.unstable_requestPaint,Jt=s.unstable_now,Ps=s.unstable_getCurrentPriorityLevel,Os=s.unstable_ImmediatePriority,lr=s.unstable_UserBlockingPriority,zs=s.unstable_NormalPriority,ba=s.unstable_LowPriority,dn=s.unstable_IdlePriority,Ea=null,Lr=null;function Wr(m){if(Lr&&typeof Lr.onCommitFiberRoot=="function")try{Lr.onCommitFiberRoot(Ea,m,void 0,(m.current.flags&128)===128)}catch{}}var mr=Math.clz32?Math.clz32:Po,Dr=Math.log,vl=Math.LN2;function Po(m){return m>>>=0,m===0?32:31-(Dr(m)/vl|0)|0}var zl=64,fi=4194304;function pi(m){switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return m&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return m}}function Wa(m,p){var _=m.pendingLanes;if(_===0)return 0;var W=0,ae=m.suspendedLanes,me=m.pingedLanes,Re=_&268435455;if(Re!==0){var At=Re&~ae;At!==0?W=pi(At):(me&=Re,me!==0&&(W=pi(me)))}else Re=_&~ae,Re!==0?W=pi(Re):me!==0&&(W=pi(me));if(W===0)return 0;if(p!==0&&p!==W&&(p&ae)===0&&(ae=W&-W,me=p&-p,ae>=me||ae===16&&(me&4194240)!==0))return p;if((W&4)!==0&&(W|=_&16),p=m.entangledLanes,p!==0)for(m=m.entanglements,p&=W;0<p;)_=31-mr(p),ae=1<<_,W|=m[_],p&=~ae;return W}function Yl(m,p){switch(m){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fa(m,p){for(var _=m.suspendedLanes,W=m.pingedLanes,ae=m.expirationTimes,me=m.pendingLanes;0<me;){var Re=31-mr(me),At=1<<Re,Nt=ae[Re];Nt===-1?((At&_)===0||(At&W)!==0)&&(ae[Re]=Yl(At,p)):Nt<=p&&(m.expiredLanes|=At),me&=~At}}function Xl(m){return m=m.pendingLanes&-1073741825,m!==0?m:m&1073741824?1073741824:0}function Nr(){var m=zl;return zl<<=1,(zl&4194240)===0&&(zl=64),m}function mc(m){for(var p=[],_=0;31>_;_++)p.push(m);return p}function bl(m,p,_){m.pendingLanes|=p,p!==536870912&&(m.suspendedLanes=0,m.pingedLanes=0),m=m.eventTimes,p=31-mr(p),m[p]=_}function yu(m,p){var _=m.pendingLanes&~p;m.pendingLanes=p,m.suspendedLanes=0,m.pingedLanes=0,m.expiredLanes&=p,m.mutableReadLanes&=p,m.entangledLanes&=p,p=m.entanglements;var W=m.eventTimes;for(m=m.expirationTimes;0<_;){var ae=31-mr(_),me=1<<ae;p[ae]=0,W[ae]=-1,m[ae]=-1,_&=~me}}function Ga(m,p){var _=m.entangledLanes|=p;for(m=m.entanglements;_;){var W=31-mr(_),ae=1<<W;ae&p|m[W]&p&&(m[W]|=p),_&=~ae}}var or=0;function Jl(m){return m&=-m,1<m?4<m?(m&268435455)!==0?16:536870912:4:1}var Qn,Zl,fc,xi,yl,ke=!1,at=[],dt=null,St=null,Ut=null,It=new Map,Ht=new Map,ts=[],Xt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function hs(m,p){switch(m){case"focusin":case"focusout":dt=null;break;case"dragenter":case"dragleave":St=null;break;case"mouseover":case"mouseout":Ut=null;break;case"pointerover":case"pointerout":It.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ht.delete(p.pointerId)}}function Ns(m,p,_,W,ae,me){return m===null||m.nativeEvent!==me?(m={blockedOn:p,domEventName:_,eventSystemFlags:W,nativeEvent:me,targetContainers:[ae]},p!==null&&(p=_d(p),p!==null&&Zl(p)),m):(m.eventSystemFlags|=W,p=m.targetContainers,ae!==null&&p.indexOf(ae)===-1&&p.push(ae),m)}function ns(m,p,_,W,ae){switch(p){case"focusin":return dt=Ns(dt,m,p,_,W,ae),!0;case"dragenter":return St=Ns(St,m,p,_,W,ae),!0;case"mouseover":return Ut=Ns(Ut,m,p,_,W,ae),!0;case"pointerover":var me=ae.pointerId;return It.set(me,Ns(It.get(me)||null,m,p,_,W,ae)),!0;case"gotpointercapture":return me=ae.pointerId,Ht.set(me,Ns(Ht.get(me)||null,m,p,_,W,ae)),!0}return!1}function ss(m){var p=Go(m.target);if(p!==null){var _=Ge(p);if(_!==null){if(p=_.tag,p===13){if(p=gt(_),p!==null){m.blockedOn=p,yl(m.priority,function(){fc(_)});return}}else if(p===3&&_.stateNode.current.memoizedState.isDehydrated){m.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}m.blockedOn=null}function vs(m){if(m.blockedOn!==null)return!1;for(var p=m.targetContainers;0<p.length;){var _=Ys(m.domEventName,m.eventSystemFlags,p[0],m.nativeEvent);if(_===null){_=m.nativeEvent;var W=new _.constructor(_.type,_);xe=W,_.target.dispatchEvent(W),xe=null}else return p=_d(_),p!==null&&Zl(p),m.blockedOn=_,!1;p.shift()}return!0}function fs(m,p,_){vs(m)&&_.delete(p)}function gr(){ke=!1,dt!==null&&vs(dt)&&(dt=null),St!==null&&vs(St)&&(St=null),Ut!==null&&vs(Ut)&&(Ut=null),It.forEach(fs),Ht.forEach(fs)}function Ka(m,p){m.blockedOn===p&&(m.blockedOn=null,ke||(ke=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,gr)))}function Ur(m){function p(ae){return Ka(ae,m)}if(0<at.length){Ka(at[0],m);for(var _=1;_<at.length;_++){var W=at[_];W.blockedOn===m&&(W.blockedOn=null)}}for(dt!==null&&Ka(dt,m),St!==null&&Ka(St,m),Ut!==null&&Ka(Ut,m),It.forEach(p),Ht.forEach(p),_=0;_<ts.length;_++)W=ts[_],W.blockedOn===m&&(W.blockedOn=null);for(;0<ts.length&&(_=ts[0],_.blockedOn===null);)ss(_),_.blockedOn===null&&ts.shift()}var er=S.ReactCurrentBatchConfig,ea=!0;function sr(m,p,_,W){var ae=or,me=er.transition;er.transition=null;try{or=1,un(m,p,_,W)}finally{or=ae,er.transition=me}}function za(m,p,_,W){var ae=or,me=er.transition;er.transition=null;try{or=4,un(m,p,_,W)}finally{or=ae,er.transition=me}}function un(m,p,_,W){if(ea){var ae=Ys(m,p,_,W);if(ae===null)Tu(m,p,W,gi,_),hs(m,W);else if(ns(ae,m,p,_,W))W.stopPropagation();else if(hs(m,W),p&4&&-1<Xt.indexOf(m)){for(;ae!==null;){var me=_d(ae);if(me!==null&&Qn(me),me=Ys(m,p,_,W),me===null&&Tu(m,p,W,gi,_),me===ae)break;ae=me}ae!==null&&W.stopPropagation()}else Tu(m,p,W,null,_)}}var gi=null;function Ys(m,p,_,W){if(gi=null,m=we(W),m=Go(m),m!==null)if(p=Ge(m),p===null)m=null;else if(_=p.tag,_===13){if(m=gt(p),m!==null)return m;m=null}else if(_===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;m=null}else p!==m&&(m=null);return gi=m,null}function Gr(m){switch(m){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ps()){case Os:return 1;case lr:return 4;case zs:case ba:return 16;case dn:return 536870912;default:return 16}default:return 16}}var An=null,Mn=null,Li=null;function kA(){if(Li)return Li;var m,p=Mn,_=p.length,W,ae="value"in An?An.value:An.textContent,me=ae.length;for(m=0;m<_&&p[m]===ae[m];m++);var Re=_-m;for(W=1;W<=Re&&p[_-W]===ae[me-W];W++);return Li=ae.slice(m,1<W?1-W:void 0)}function tl(m){var p=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&p===13&&(m=13)):m=p,m===10&&(m=13),32<=m||m===13?m:0}function Hn(){return!0}function id(){return!1}function Ta(m){function p(_,W,ae,me,Re){this._reactName=_,this._targetInst=ae,this.type=W,this.nativeEvent=me,this.target=Re,this.currentTarget=null;for(var At in m)m.hasOwnProperty(At)&&(_=m[At],this[At]=_?_(me):me[At]);return this.isDefaultPrevented=(me.defaultPrevented!=null?me.defaultPrevented:me.returnValue===!1)?Hn:id,this.isPropagationStopped=id,this}return D(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=Hn)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=Hn)},persist:function(){},isPersistent:Hn}),p}var Ro={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Oo=Ta(Ro),pc=D({},Ro,{view:0,detail:0}),ju=Ta(pc),xc,ld,jl,Qo=D({},pc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:js,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==jl&&(jl&&m.type==="mousemove"?(xc=m.screenX-jl.screenX,ld=m.screenY-jl.screenY):ld=xc=0,jl=m),xc)},movementY:function(m){return"movementY"in m?m.movementY:ld}}),od=Ta(Qo),BA=D({},Qo,{dataTransfer:0}),Yh=Ta(BA),cd=D({},pc,{relatedTarget:0}),eo=Ta(cd),Nu=D({},Ro,{animationName:0,elapsedTime:0,pseudoElement:0}),Mo=Ta(Nu),wu=D({},Ro,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),se=Ta(wu),Ee=D({},Ro,{data:0}),it=Ta(Ee),bt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$t={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ls(m){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(m):(m=$t[m])?!!p[m]:!1}function js(){return ls}var Ds=D({},pc,{key:function(m){if(m.key){var p=bt[m.key]||m.key;if(p!=="Unidentified")return p}return m.type==="keypress"?(m=tl(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?Tt[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:js,charCode:function(m){return m.type==="keypress"?tl(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?tl(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),Js=Ta(Ds),Xs=D({},Qo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ur=Ta(Xs),ta=D({},pc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:js}),da=Ta(ta),ya=D({},Ro,{propertyName:0,elapsedTime:0,pseudoElement:0}),hn=Ta(ya),Ya=D({},Qo,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),sl=Ta(Ya),vi=[9,13,27,32],Di=o&&"CompositionEvent"in window,Ho=null;o&&"documentMode"in document&&(Ho=document.documentMode);var _u=o&&"TextEvent"in window&&!Ho,dd=o&&(!Di||Ho&&8<Ho&&11>=Ho),gc=" ",ud=!1;function Ad(m,p){switch(m){case"keyup":return vi.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vc(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var ua=!1;function hd(m,p){switch(m){case"compositionend":return vc(p);case"keypress":return p.which!==32?null:(ud=!0,gc);case"textInput":return m=p.data,m===gc&&ud?null:m;default:return null}}function md(m,p){if(ua)return m==="compositionend"||!Di&&Ad(m,p)?(m=kA(),Li=Mn=An=null,ua=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return dd&&p.locale!=="ko"?null:p.data;default:return null}}var fd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pd(m){var p=m&&m.nodeName&&m.nodeName.toLowerCase();return p==="input"?!!fd[m.type]:p==="textarea"}function Sn(m,p,_,W){pt(W),p=IA(p,"onChange"),0<p.length&&(_=new Oo("onChange","change",null,_,W),m.push({event:_,listeners:p}))}var bc=null,to=null;function EA(m){Eu(m,0)}function Cn(m){var p=Bc(m);if(re(p))return m}function xd(m,p){if(m==="change")return p}var Su=!1;if(o){var gd;if(o){var Nl="oninput"in document;if(!Nl){var qo=document.createElement("div");qo.setAttribute("oninput","return;"),Nl=typeof qo.oninput=="function"}gd=Nl}else gd=!1;Su=gd&&(!document.documentMode||9<document.documentMode)}function kn(){bc&&(bc.detachEvent("onpropertychange",mn),to=bc=null)}function mn(m){if(m.propertyName==="value"&&Cn(to)){var p=[];Sn(p,to,m,we(m)),We(EA,p)}}function Vo(m,p,_){m==="focusin"?(kn(),bc=p,to=_,bc.attachEvent("onpropertychange",mn)):m==="focusout"&&kn()}function so(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return Cn(to)}function ro(m,p){if(m==="click")return Cn(p)}function vd(m,p){if(m==="input"||m==="change")return Cn(p)}function ao(m,p){return m===p&&(m!==0||1/m===1/p)||m!==m&&p!==p}var vr=typeof Object.is=="function"?Object.is:ao;function no(m,p){if(vr(m,p))return!0;if(typeof m!="object"||m===null||typeof p!="object"||p===null)return!1;var _=Object.keys(m),W=Object.keys(p);if(_.length!==W.length)return!1;for(W=0;W<_.length;W++){var ae=_[W];if(!u.call(p,ae)||!vr(m[ae],p[ae]))return!1}return!0}function fn(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function bi(m,p){var _=fn(m);m=0;for(var W;_;){if(_.nodeType===3){if(W=m+_.textContent.length,m<=p&&W>=p)return{node:_,offset:p-m};m=W}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=fn(_)}}function yc(m,p){return m&&p?m===p?!0:m&&m.nodeType===3?!1:p&&p.nodeType===3?yc(m,p.parentNode):"contains"in m?m.contains(p):m.compareDocumentPosition?!!(m.compareDocumentPosition(p)&16):!1:!1}function Cu(){for(var m=window,p=de();p instanceof m.HTMLIFrameElement;){try{var _=typeof p.contentWindow.location.href=="string"}catch{_=!1}if(_)m=p.contentWindow;else break;p=de(m.document)}return p}function jc(m){var p=m&&m.nodeName&&m.nodeName.toLowerCase();return p&&(p==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||p==="textarea"||m.contentEditable==="true")}function Nc(m){var p=Cu(),_=m.focusedElem,W=m.selectionRange;if(p!==_&&_&&_.ownerDocument&&yc(_.ownerDocument.documentElement,_)){if(W!==null&&jc(_)){if(p=W.start,m=W.end,m===void 0&&(m=p),"selectionStart"in _)_.selectionStart=p,_.selectionEnd=Math.min(m,_.value.length);else if(m=(p=_.ownerDocument||document)&&p.defaultView||window,m.getSelection){m=m.getSelection();var ae=_.textContent.length,me=Math.min(W.start,ae);W=W.end===void 0?me:Math.min(W.end,ae),!m.extend&&me>W&&(ae=W,W=me,me=ae),ae=bi(_,me);var Re=bi(_,W);ae&&Re&&(m.rangeCount!==1||m.anchorNode!==ae.node||m.anchorOffset!==ae.offset||m.focusNode!==Re.node||m.focusOffset!==Re.offset)&&(p=p.createRange(),p.setStart(ae.node,ae.offset),m.removeAllRanges(),me>W?(m.addRange(p),m.extend(Re.node,Re.offset)):(p.setEnd(Re.node,Re.offset),m.addRange(p)))}}for(p=[],m=_;m=m.parentNode;)m.nodeType===1&&p.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<p.length;_++)m=p[_],m.element.scrollLeft=m.left,m.element.scrollTop=m.top}}var wc=o&&"documentMode"in document&&11>=document.documentMode,yi=null,io=null,wl=null,lo=!1;function oo(m,p,_){var W=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;lo||yi==null||yi!==de(W)||(W=yi,"selectionStart"in W&&jc(W)?W={start:W.selectionStart,end:W.selectionEnd}:(W=(W.ownerDocument&&W.ownerDocument.defaultView||window).getSelection(),W={anchorNode:W.anchorNode,anchorOffset:W.anchorOffset,focusNode:W.focusNode,focusOffset:W.focusOffset}),wl&&no(wl,W)||(wl=W,W=IA(io,"onSelect"),0<W.length&&(p=new Oo("onSelect","select",null,p,_),m.push({event:p,listeners:W}),p.target=yi)))}function $o(m,p){var _={};return _[m.toLowerCase()]=p.toLowerCase(),_["Webkit"+m]="webkit"+p,_["Moz"+m]="moz"+p,_}var sn={animationend:$o("Animation","AnimationEnd"),animationiteration:$o("Animation","AnimationIteration"),animationstart:$o("Animation","AnimationStart"),transitionend:$o("Transition","TransitionEnd")},qn={},Pr={};o&&(Pr=document.createElement("div").style,"AnimationEvent"in window||(delete sn.animationend.animation,delete sn.animationiteration.animation,delete sn.animationstart.animation),"TransitionEvent"in window||delete sn.transitionend.transition);function kr(m){if(qn[m])return qn[m];if(!sn[m])return m;var p=sn[m],_;for(_ in p)if(p.hasOwnProperty(_)&&_ in Pr)return qn[m]=p[_];return m}var Aa=kr("animationend"),ja=kr("animationiteration"),_l=kr("animationstart"),bd=kr("transitionend"),_c=new Map,ku="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sl(m,p){_c.set(m,p),i(p,[m])}for(var yd=0;yd<ku.length;yd++){var Bn=ku[yd],Ui=Bn.toLowerCase(),FA=Bn[0].toUpperCase()+Bn.slice(1);Sl(Ui,"on"+FA)}Sl(Aa,"onAnimationEnd"),Sl(ja,"onAnimationIteration"),Sl(_l,"onAnimationStart"),Sl("dblclick","onDoubleClick"),Sl("focusin","onFocus"),Sl("focusout","onBlur"),Sl(bd,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Wo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Wo));function Bu(m,p,_){var W=m.type||"unknown-event";m.currentTarget=_,He(W,p,void 0,m),m.currentTarget=null}function Eu(m,p){p=(p&4)!==0;for(var _=0;_<m.length;_++){var W=m[_],ae=W.event;W=W.listeners;e:{var me=void 0;if(p)for(var Re=W.length-1;0<=Re;Re--){var At=W[Re],Nt=At.instance,Mt=At.currentTarget;if(At=At.listener,Nt!==me&&ae.isPropagationStopped())break e;Bu(ae,At,Mt),me=Nt}else for(Re=0;Re<W.length;Re++){if(At=W[Re],Nt=At.instance,Mt=At.currentTarget,At=At.listener,Nt!==me&&ae.isPropagationStopped())break e;Bu(ae,At,Mt),me=Nt}}}if(he)throw m=pe,he=!1,pe=null,m}function Rr(m,p){var _=p[$n];_===void 0&&(_=p[$n]=new Set);var W=m+"__bubble";_.has(W)||(Fu(p,m,2,!1),_.add(W))}function TA(m,p,_){var W=0;p&&(W|=4),Fu(_,m,W,p)}var jd="_reactListening"+Math.random().toString(36).slice(2);function Sc(m){if(!m[jd]){m[jd]=!0,a.forEach(function(_){_!=="selectionchange"&&(Kf.has(_)||TA(_,!1,m),TA(_,!0,m))});var p=m.nodeType===9?m:m.ownerDocument;p===null||p[jd]||(p[jd]=!0,TA("selectionchange",!1,p))}}function Fu(m,p,_,W){switch(Gr(p)){case 1:var ae=sr;break;case 4:ae=za;break;default:ae=un}_=ae.bind(null,p,_,m),ae=void 0,!lt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(ae=!0),W?ae!==void 0?m.addEventListener(p,_,{capture:!0,passive:ae}):m.addEventListener(p,_,!0):ae!==void 0?m.addEventListener(p,_,{passive:ae}):m.addEventListener(p,_,!1)}function Tu(m,p,_,W,ae){var me=W;if((p&1)===0&&(p&2)===0&&W!==null)e:for(;;){if(W===null)return;var Re=W.tag;if(Re===3||Re===4){var At=W.stateNode.containerInfo;if(At===ae||At.nodeType===8&&At.parentNode===ae)break;if(Re===4)for(Re=W.return;Re!==null;){var Nt=Re.tag;if((Nt===3||Nt===4)&&(Nt=Re.stateNode.containerInfo,Nt===ae||Nt.nodeType===8&&Nt.parentNode===ae))return;Re=Re.return}for(;At!==null;){if(Re=Go(At),Re===null)return;if(Nt=Re.tag,Nt===5||Nt===6){W=me=Re;continue e}At=At.parentNode}}W=W.return}We(function(){var Mt=me,cs=we(_),us=[];e:{var os=_c.get(m);if(os!==void 0){var Ss=Oo,Bs=m;switch(m){case"keypress":if(tl(_)===0)break e;case"keydown":case"keyup":Ss=Js;break;case"focusin":Bs="focus",Ss=eo;break;case"focusout":Bs="blur",Ss=eo;break;case"beforeblur":case"afterblur":Ss=eo;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ss=od;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ss=Yh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ss=da;break;case Aa:case ja:case _l:Ss=Mo;break;case bd:Ss=hn;break;case"scroll":Ss=ju;break;case"wheel":Ss=sl;break;case"copy":case"cut":case"paste":Ss=se;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ss=ur}var Fs=(p&4)!==0,Ua=!Fs&&m==="scroll",Pt=Fs?os!==null?os+"Capture":null:os;Fs=[];for(var Ct=Mt,Rt;Ct!==null;){Rt=Ct;var ms=Rt.stateNode;if(Rt.tag===5&&ms!==null&&(Rt=ms,Pt!==null&&(ms=De(Ct,Pt),ms!=null&&Fs.push(Iu(Ct,ms,Rt)))),Ua)break;Ct=Ct.return}0<Fs.length&&(os=new Ss(os,Bs,null,_,cs),us.push({event:os,listeners:Fs}))}}if((p&7)===0){e:{if(os=m==="mouseover"||m==="pointerover",Ss=m==="mouseout"||m==="pointerout",os&&_!==xe&&(Bs=_.relatedTarget||_.fromElement)&&(Go(Bs)||Bs[pn]))break e;if((Ss||os)&&(os=cs.window===cs?cs:(os=cs.ownerDocument)?os.defaultView||os.parentWindow:window,Ss?(Bs=_.relatedTarget||_.toElement,Ss=Mt,Bs=Bs?Go(Bs):null,Bs!==null&&(Ua=Ge(Bs),Bs!==Ua||Bs.tag!==5&&Bs.tag!==6)&&(Bs=null)):(Ss=null,Bs=Mt),Ss!==Bs)){if(Fs=od,ms="onMouseLeave",Pt="onMouseEnter",Ct="mouse",(m==="pointerout"||m==="pointerover")&&(Fs=ur,ms="onPointerLeave",Pt="onPointerEnter",Ct="pointer"),Ua=Ss==null?os:Bc(Ss),Rt=Bs==null?os:Bc(Bs),os=new Fs(ms,Ct+"leave",Ss,_,cs),os.target=Ua,os.relatedTarget=Rt,ms=null,Go(cs)===Mt&&(Fs=new Fs(Pt,Ct+"enter",Bs,_,cs),Fs.target=Rt,Fs.relatedTarget=Ua,ms=Fs),Ua=ms,Ss&&Bs)t:{for(Fs=Ss,Pt=Bs,Ct=0,Rt=Fs;Rt;Rt=Cc(Rt))Ct++;for(Rt=0,ms=Pt;ms;ms=Cc(ms))Rt++;for(;0<Ct-Rt;)Fs=Cc(Fs),Ct--;for(;0<Rt-Ct;)Pt=Cc(Pt),Rt--;for(;Ct--;){if(Fs===Pt||Pt!==null&&Fs===Pt.alternate)break t;Fs=Cc(Fs),Pt=Cc(Pt)}Fs=null}else Fs=null;Ss!==null&&zf(us,os,Ss,Fs,!1),Bs!==null&&Ua!==null&&zf(us,Ua,Bs,Fs,!0)}}e:{if(os=Mt?Bc(Mt):window,Ss=os.nodeName&&os.nodeName.toLowerCase(),Ss==="select"||Ss==="input"&&os.type==="file")var Is=xd;else if(pd(os))if(Su)Is=vd;else{Is=so;var Qs=Vo}else(Ss=os.nodeName)&&Ss.toLowerCase()==="input"&&(os.type==="checkbox"||os.type==="radio")&&(Is=ro);if(Is&&(Is=Is(m,Mt))){Sn(us,Is,_,cs);break e}Qs&&Qs(m,os,Mt),m==="focusout"&&(Qs=os._wrapperState)&&Qs.controlled&&os.type==="number"&&Be(os,"number",os.value)}switch(Qs=Mt?Bc(Mt):window,m){case"focusin":(pd(Qs)||Qs.contentEditable==="true")&&(yi=Qs,io=Mt,wl=null);break;case"focusout":wl=io=yi=null;break;case"mousedown":lo=!0;break;case"contextmenu":case"mouseup":case"dragend":lo=!1,oo(us,_,cs);break;case"selectionchange":if(wc)break;case"keydown":case"keyup":oo(us,_,cs)}var Ms;if(Di)e:{switch(m){case"compositionstart":var Ks="onCompositionStart";break e;case"compositionend":Ks="onCompositionEnd";break e;case"compositionupdate":Ks="onCompositionUpdate";break e}Ks=void 0}else ua?Ad(m,_)&&(Ks="onCompositionEnd"):m==="keydown"&&_.keyCode===229&&(Ks="onCompositionStart");Ks&&(dd&&_.locale!=="ko"&&(ua||Ks!=="onCompositionStart"?Ks==="onCompositionEnd"&&ua&&(Ms=kA()):(An=cs,Mn="value"in An?An.value:An.textContent,ua=!0)),Qs=IA(Mt,Ks),0<Qs.length&&(Ks=new it(Ks,m,null,_,cs),us.push({event:Ks,listeners:Qs}),Ms?Ks.data=Ms:(Ms=vc(_),Ms!==null&&(Ks.data=Ms)))),(Ms=_u?hd(m,_):md(m,_))&&(Mt=IA(Mt,"onBeforeInput"),0<Mt.length&&(cs=new it("onBeforeInput","beforeinput",null,_,cs),us.push({event:cs,listeners:Mt}),cs.data=Ms))}Eu(us,p)})}function Iu(m,p,_){return{instance:m,listener:p,currentTarget:_}}function IA(m,p){for(var _=p+"Capture",W=[];m!==null;){var ae=m,me=ae.stateNode;ae.tag===5&&me!==null&&(ae=me,me=De(m,_),me!=null&&W.unshift(Iu(m,me,ae)),me=De(m,p),me!=null&&W.push(Iu(m,me,ae))),m=m.return}return W}function Cc(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5);return m||null}function zf(m,p,_,W,ae){for(var me=p._reactName,Re=[];_!==null&&_!==W;){var At=_,Nt=At.alternate,Mt=At.stateNode;if(Nt!==null&&Nt===W)break;At.tag===5&&Mt!==null&&(At=Mt,ae?(Nt=De(_,me),Nt!=null&&Re.unshift(Iu(_,Nt,At))):ae||(Nt=De(_,me),Nt!=null&&Re.push(Iu(_,Nt,At)))),_=_.return}Re.length!==0&&m.push({event:p,listeners:Re})}var ug=/\r\n?/g,Ag=/\u0000|\uFFFD/g;function Yf(m){return(typeof m=="string"?m:""+m).replace(ug,`
`).replace(Ag,"")}function LA(m,p,_){if(p=Yf(p),Yf(m)!==p&&_)throw Error(r(425))}function Nd(){}var Lu=null,kc=null;function Xh(m,p){return m==="textarea"||m==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Jh=typeof setTimeout=="function"?setTimeout:void 0,Xf=typeof clearTimeout=="function"?clearTimeout:void 0,Jf=typeof Promise=="function"?Promise:void 0,hg=typeof queueMicrotask=="function"?queueMicrotask:typeof Jf<"u"?function(m){return Jf.resolve(null).then(m).catch(mg)}:Jh;function mg(m){setTimeout(function(){throw m})}function Zh(m,p){var _=p,W=0;do{var ae=_.nextSibling;if(m.removeChild(_),ae&&ae.nodeType===8)if(_=ae.data,_==="/$"){if(W===0){m.removeChild(ae),Ur(p);return}W--}else _!=="$"&&_!=="$?"&&_!=="$!"||W++;_=ae}while(_);Ur(p)}function En(m){for(;m!=null;m=m.nextSibling){var p=m.nodeType;if(p===1||p===3)break;if(p===8){if(p=m.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return m}function Pi(m){m=m.previousSibling;for(var p=0;m;){if(m.nodeType===8){var _=m.data;if(_==="$"||_==="$!"||_==="$?"){if(p===0)return m;p--}else _==="/$"&&p++}m=m.previousSibling}return null}var Vn=Math.random().toString(36).slice(2),Cl="__reactFiber$"+Vn,wd="__reactProps$"+Vn,pn="__reactContainer$"+Vn,$n="__reactEvents$"+Vn,fg="__reactListeners$"+Vn,pg="__reactHandles$"+Vn;function Go(m){var p=m[Cl];if(p)return p;for(var _=m.parentNode;_;){if(p=_[pn]||_[Cl]){if(_=p.alternate,p.child!==null||_!==null&&_.child!==null)for(m=Pi(m);m!==null;){if(_=m[Cl])return _;m=Pi(m)}return p}m=_,_=m.parentNode}return null}function _d(m){return m=m[Cl]||m[pn],!m||m.tag!==5&&m.tag!==6&&m.tag!==13&&m.tag!==3?null:m}function Bc(m){if(m.tag===5||m.tag===6)return m.stateNode;throw Error(r(33))}function Du(m){return m[wd]||null}var em=[],co=-1;function rl(m){return{current:m}}function Br(m){0>co||(m.current=em[co],em[co]=null,co--)}function Fr(m,p){co++,em[co]=m.current,m.current=p}var Ko={},rn=rl(Ko),Wn=rl(!1),Ec=Ko;function Sd(m,p){var _=m.type.contextTypes;if(!_)return Ko;var W=m.stateNode;if(W&&W.__reactInternalMemoizedUnmaskedChildContext===p)return W.__reactInternalMemoizedMaskedChildContext;var ae={},me;for(me in _)ae[me]=p[me];return W&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=p,m.__reactInternalMemoizedMaskedChildContext=ae),ae}function Gn(m){return m=m.childContextTypes,m!=null}function DA(){Br(Wn),Br(rn)}function Zf(m,p,_){if(rn.current!==Ko)throw Error(r(168));Fr(rn,p),Fr(Wn,_)}function tm(m,p,_){var W=m.stateNode;if(p=p.childContextTypes,typeof W.getChildContext!="function")return _;W=W.getChildContext();for(var ae in W)if(!(ae in p))throw Error(r(108,X(m)||"Unknown",ae));return D({},_,W)}function Fc(m){return m=(m=m.stateNode)&&m.__reactInternalMemoizedMergedChildContext||Ko,Ec=rn.current,Fr(rn,m),Fr(Wn,Wn.current),!0}function ep(m,p,_){var W=m.stateNode;if(!W)throw Error(r(169));_?(m=tm(m,p,Ec),W.__reactInternalMemoizedMergedChildContext=m,Br(Wn),Br(rn),Fr(rn,m)):Br(Wn),Fr(Wn,_)}var uo=null,Uu=!1,F=!1;function K(m){uo===null?uo=[m]:uo.push(m)}function ie(m){Uu=!0,K(m)}function fe(){if(!F&&uo!==null){F=!0;var m=0,p=or;try{var _=uo;for(or=1;m<_.length;m++){var W=_[m];do W=W(!0);while(W!==null)}uo=null,Uu=!1}catch(ae){throw uo!==null&&(uo=uo.slice(m+1)),Yt(Os,fe),ae}finally{or=p,F=!1}}return null}var Se=[],Pe=0,Oe=null,qe=0,$e=[],st=0,jt=null,Lt=1,Dt="";function Bt(m,p){Se[Pe++]=qe,Se[Pe++]=Oe,Oe=m,qe=p}function Zt(m,p,_){$e[st++]=Lt,$e[st++]=Dt,$e[st++]=jt,jt=m;var W=Lt;m=Dt;var ae=32-mr(W)-1;W&=~(1<<ae),_+=1;var me=32-mr(p)+ae;if(30<me){var Re=ae-ae%5;me=(W&(1<<Re)-1).toString(32),W>>=Re,ae-=Re,Lt=1<<32-mr(p)+ae|_<<ae|W,Dt=me+m}else Lt=1<<me|_<<ae|W,Dt=m}function Vt(m){m.return!==null&&(Bt(m,1),Zt(m,1,0))}function wt(m){for(;m===Oe;)Oe=Se[--Pe],Se[Pe]=null,qe=Se[--Pe],Se[Pe]=null;for(;m===jt;)jt=$e[--st],$e[st]=null,Dt=$e[--st],$e[st]=null,Lt=$e[--st],$e[st]=null}var _t=null,Gt=null,Wt=!1,zt=null;function ws(m,p){var _=Il(5,null,null,0);_.elementType="DELETED",_.stateNode=p,_.return=m,p=m.deletions,p===null?(m.deletions=[_],m.flags|=16):p.push(_)}function gs(m,p){switch(m.tag){case 5:var _=m.type;return p=p.nodeType!==1||_.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(m.stateNode=p,_t=m,Gt=En(p.firstChild),!0):!1;case 6:return p=m.pendingProps===""||p.nodeType!==3?null:p,p!==null?(m.stateNode=p,_t=m,Gt=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(_=jt!==null?{id:Lt,overflow:Dt}:null,m.memoizedState={dehydrated:p,treeContext:_,retryLane:1073741824},_=Il(18,null,null,0),_.stateNode=p,_.return=m,m.child=_,_t=m,Gt=null,!0):!1;default:return!1}}function Us(m){return(m.mode&1)!==0&&(m.flags&128)===0}function bs(m){if(Wt){var p=Gt;if(p){var _=p;if(!gs(m,p)){if(Us(m))throw Error(r(418));p=En(_.nextSibling);var W=_t;p&&gs(m,p)?ws(W,_):(m.flags=m.flags&-4097|2,Wt=!1,_t=m)}}else{if(Us(m))throw Error(r(418));m.flags=m.flags&-4097|2,Wt=!1,_t=m}}}function fr(m){for(m=m.return;m!==null&&m.tag!==5&&m.tag!==3&&m.tag!==13;)m=m.return;_t=m}function pr(m){if(m!==_t)return!1;if(!Wt)return fr(m),Wt=!0,!1;var p;if((p=m.tag!==3)&&!(p=m.tag!==5)&&(p=m.type,p=p!=="head"&&p!=="body"&&!Xh(m.type,m.memoizedProps)),p&&(p=Gt)){if(Us(m))throw Ar(),Error(r(418));for(;p;)ws(m,p),p=En(p.nextSibling)}if(fr(m),m.tag===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,p=0;m;){if(m.nodeType===8){var _=m.data;if(_==="/$"){if(p===0){Gt=En(m.nextSibling);break e}p--}else _!=="$"&&_!=="$!"&&_!=="$?"||p++}m=m.nextSibling}Gt=null}}else Gt=_t?En(m.stateNode.nextSibling):null;return!0}function Ar(){for(var m=Gt;m;)m=En(m.nextSibling)}function tr(){Gt=_t=null,Wt=!1}function Er(m){zt===null?zt=[m]:zt.push(m)}var Tr=S.ReactCurrentBatchConfig;function Ws(m,p,_){if(m=_.ref,m!==null&&typeof m!="function"&&typeof m!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(r(309));var W=_.stateNode}if(!W)throw Error(r(147,m));var ae=W,me=""+m;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===me?p.ref:(p=function(Re){var At=ae.refs;Re===null?delete At[me]:At[me]=Re},p._stringRef=me,p)}if(typeof m!="string")throw Error(r(284));if(!_._owner)throw Error(r(290,m))}return m}function sa(m,p){throw m=Object.prototype.toString.call(p),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":m))}function Fn(m){var p=m._init;return p(m._payload)}function fa(m){function p(Pt,Ct){if(m){var Rt=Pt.deletions;Rt===null?(Pt.deletions=[Ct],Pt.flags|=16):Rt.push(Ct)}}function _(Pt,Ct){if(!m)return null;for(;Ct!==null;)p(Pt,Ct),Ct=Ct.sibling;return null}function W(Pt,Ct){for(Pt=new Map;Ct!==null;)Ct.key!==null?Pt.set(Ct.key,Ct):Pt.set(Ct.index,Ct),Ct=Ct.sibling;return Pt}function ae(Pt,Ct){return Pt=Rd(Pt,Ct),Pt.index=0,Pt.sibling=null,Pt}function me(Pt,Ct,Rt){return Pt.index=Rt,m?(Rt=Pt.alternate,Rt!==null?(Rt=Rt.index,Rt<Ct?(Pt.flags|=2,Ct):Rt):(Pt.flags|=2,Ct)):(Pt.flags|=1048576,Ct)}function Re(Pt){return m&&Pt.alternate===null&&(Pt.flags|=2),Pt}function At(Pt,Ct,Rt,ms){return Ct===null||Ct.tag!==6?(Ct=$g(Rt,Pt.mode,ms),Ct.return=Pt,Ct):(Ct=ae(Ct,Rt),Ct.return=Pt,Ct)}function Nt(Pt,Ct,Rt,ms){var Is=Rt.type;return Is===L?cs(Pt,Ct,Rt.props.children,ms,Rt.key):Ct!==null&&(Ct.elementType===Is||typeof Is=="object"&&Is!==null&&Is.$$typeof===Y&&Fn(Is)===Ct.type)?(ms=ae(Ct,Rt.props),ms.ref=Ws(Pt,Ct,Rt),ms.return=Pt,ms):(ms=bp(Rt.type,Rt.key,Rt.props,null,Pt.mode,ms),ms.ref=Ws(Pt,Ct,Rt),ms.return=Pt,ms)}function Mt(Pt,Ct,Rt,ms){return Ct===null||Ct.tag!==4||Ct.stateNode.containerInfo!==Rt.containerInfo||Ct.stateNode.implementation!==Rt.implementation?(Ct=Wg(Rt,Pt.mode,ms),Ct.return=Pt,Ct):(Ct=ae(Ct,Rt.children||[]),Ct.return=Pt,Ct)}function cs(Pt,Ct,Rt,ms,Is){return Ct===null||Ct.tag!==7?(Ct=Vu(Rt,Pt.mode,ms,Is),Ct.return=Pt,Ct):(Ct=ae(Ct,Rt),Ct.return=Pt,Ct)}function us(Pt,Ct,Rt){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number")return Ct=$g(""+Ct,Pt.mode,Rt),Ct.return=Pt,Ct;if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case B:return Rt=bp(Ct.type,Ct.key,Ct.props,null,Pt.mode,Rt),Rt.ref=Ws(Pt,null,Ct),Rt.return=Pt,Rt;case P:return Ct=Wg(Ct,Pt.mode,Rt),Ct.return=Pt,Ct;case Y:var ms=Ct._init;return us(Pt,ms(Ct._payload),Rt)}if(_e(Ct)||k(Ct))return Ct=Vu(Ct,Pt.mode,Rt,null),Ct.return=Pt,Ct;sa(Pt,Ct)}return null}function os(Pt,Ct,Rt,ms){var Is=Ct!==null?Ct.key:null;if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return Is!==null?null:At(Pt,Ct,""+Rt,ms);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case B:return Rt.key===Is?Nt(Pt,Ct,Rt,ms):null;case P:return Rt.key===Is?Mt(Pt,Ct,Rt,ms):null;case Y:return Is=Rt._init,os(Pt,Ct,Is(Rt._payload),ms)}if(_e(Rt)||k(Rt))return Is!==null?null:cs(Pt,Ct,Rt,ms,null);sa(Pt,Rt)}return null}function Ss(Pt,Ct,Rt,ms,Is){if(typeof ms=="string"&&ms!==""||typeof ms=="number")return Pt=Pt.get(Rt)||null,At(Ct,Pt,""+ms,Is);if(typeof ms=="object"&&ms!==null){switch(ms.$$typeof){case B:return Pt=Pt.get(ms.key===null?Rt:ms.key)||null,Nt(Ct,Pt,ms,Is);case P:return Pt=Pt.get(ms.key===null?Rt:ms.key)||null,Mt(Ct,Pt,ms,Is);case Y:var Qs=ms._init;return Ss(Pt,Ct,Rt,Qs(ms._payload),Is)}if(_e(ms)||k(ms))return Pt=Pt.get(Rt)||null,cs(Ct,Pt,ms,Is,null);sa(Ct,ms)}return null}function Bs(Pt,Ct,Rt,ms){for(var Is=null,Qs=null,Ms=Ct,Ks=Ct=0,bn=null;Ms!==null&&Ks<Rt.length;Ks++){Ms.index>Ks?(bn=Ms,Ms=null):bn=Ms.sibling;var Sr=os(Pt,Ms,Rt[Ks],ms);if(Sr===null){Ms===null&&(Ms=bn);break}m&&Ms&&Sr.alternate===null&&p(Pt,Ms),Ct=me(Sr,Ct,Ks),Qs===null?Is=Sr:Qs.sibling=Sr,Qs=Sr,Ms=bn}if(Ks===Rt.length)return _(Pt,Ms),Wt&&Bt(Pt,Ks),Is;if(Ms===null){for(;Ks<Rt.length;Ks++)Ms=us(Pt,Rt[Ks],ms),Ms!==null&&(Ct=me(Ms,Ct,Ks),Qs===null?Is=Ms:Qs.sibling=Ms,Qs=Ms);return Wt&&Bt(Pt,Ks),Is}for(Ms=W(Pt,Ms);Ks<Rt.length;Ks++)bn=Ss(Ms,Pt,Ks,Rt[Ks],ms),bn!==null&&(m&&bn.alternate!==null&&Ms.delete(bn.key===null?Ks:bn.key),Ct=me(bn,Ct,Ks),Qs===null?Is=bn:Qs.sibling=bn,Qs=bn);return m&&Ms.forEach(function(Od){return p(Pt,Od)}),Wt&&Bt(Pt,Ks),Is}function Fs(Pt,Ct,Rt,ms){var Is=k(Rt);if(typeof Is!="function")throw Error(r(150));if(Rt=Is.call(Rt),Rt==null)throw Error(r(151));for(var Qs=Is=null,Ms=Ct,Ks=Ct=0,bn=null,Sr=Rt.next();Ms!==null&&!Sr.done;Ks++,Sr=Rt.next()){Ms.index>Ks?(bn=Ms,Ms=null):bn=Ms.sibling;var Od=os(Pt,Ms,Sr.value,ms);if(Od===null){Ms===null&&(Ms=bn);break}m&&Ms&&Od.alternate===null&&p(Pt,Ms),Ct=me(Od,Ct,Ks),Qs===null?Is=Od:Qs.sibling=Od,Qs=Od,Ms=bn}if(Sr.done)return _(Pt,Ms),Wt&&Bt(Pt,Ks),Is;if(Ms===null){for(;!Sr.done;Ks++,Sr=Rt.next())Sr=us(Pt,Sr.value,ms),Sr!==null&&(Ct=me(Sr,Ct,Ks),Qs===null?Is=Sr:Qs.sibling=Sr,Qs=Sr);return Wt&&Bt(Pt,Ks),Is}for(Ms=W(Pt,Ms);!Sr.done;Ks++,Sr=Rt.next())Sr=Ss(Ms,Pt,Ks,Sr.value,ms),Sr!==null&&(m&&Sr.alternate!==null&&Ms.delete(Sr.key===null?Ks:Sr.key),Ct=me(Sr,Ct,Ks),Qs===null?Is=Sr:Qs.sibling=Sr,Qs=Sr);return m&&Ms.forEach(function(jE){return p(Pt,jE)}),Wt&&Bt(Pt,Ks),Is}function Ua(Pt,Ct,Rt,ms){if(typeof Rt=="object"&&Rt!==null&&Rt.type===L&&Rt.key===null&&(Rt=Rt.props.children),typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case B:e:{for(var Is=Rt.key,Qs=Ct;Qs!==null;){if(Qs.key===Is){if(Is=Rt.type,Is===L){if(Qs.tag===7){_(Pt,Qs.sibling),Ct=ae(Qs,Rt.props.children),Ct.return=Pt,Pt=Ct;break e}}else if(Qs.elementType===Is||typeof Is=="object"&&Is!==null&&Is.$$typeof===Y&&Fn(Is)===Qs.type){_(Pt,Qs.sibling),Ct=ae(Qs,Rt.props),Ct.ref=Ws(Pt,Qs,Rt),Ct.return=Pt,Pt=Ct;break e}_(Pt,Qs);break}else p(Pt,Qs);Qs=Qs.sibling}Rt.type===L?(Ct=Vu(Rt.props.children,Pt.mode,ms,Rt.key),Ct.return=Pt,Pt=Ct):(ms=bp(Rt.type,Rt.key,Rt.props,null,Pt.mode,ms),ms.ref=Ws(Pt,Ct,Rt),ms.return=Pt,Pt=ms)}return Re(Pt);case P:e:{for(Qs=Rt.key;Ct!==null;){if(Ct.key===Qs)if(Ct.tag===4&&Ct.stateNode.containerInfo===Rt.containerInfo&&Ct.stateNode.implementation===Rt.implementation){_(Pt,Ct.sibling),Ct=ae(Ct,Rt.children||[]),Ct.return=Pt,Pt=Ct;break e}else{_(Pt,Ct);break}else p(Pt,Ct);Ct=Ct.sibling}Ct=Wg(Rt,Pt.mode,ms),Ct.return=Pt,Pt=Ct}return Re(Pt);case Y:return Qs=Rt._init,Ua(Pt,Ct,Qs(Rt._payload),ms)}if(_e(Rt))return Bs(Pt,Ct,Rt,ms);if(k(Rt))return Fs(Pt,Ct,Rt,ms);sa(Pt,Rt)}return typeof Rt=="string"&&Rt!==""||typeof Rt=="number"?(Rt=""+Rt,Ct!==null&&Ct.tag===6?(_(Pt,Ct.sibling),Ct=ae(Ct,Rt),Ct.return=Pt,Pt=Ct):(_(Pt,Ct),Ct=$g(Rt,Pt.mode,ms),Ct.return=Pt,Pt=Ct),Re(Pt)):_(Pt,Ct)}return Ua}var Ia=fa(!0),wr=fa(!1),xn=rl(null),gn=null,ra=null,La=null;function an(){La=ra=gn=null}function Kn(m){var p=xn.current;Br(xn),m._currentValue=p}function Ri(m,p,_){for(;m!==null;){var W=m.alternate;if((m.childLanes&p)!==p?(m.childLanes|=p,W!==null&&(W.childLanes|=p)):W!==null&&(W.childLanes&p)!==p&&(W.childLanes|=p),m===_)break;m=m.return}}function aa(m,p){gn=m,La=ra=null,m=m.dependencies,m!==null&&m.firstContext!==null&&((m.lanes&p)!==0&&(Hi=!0),m.firstContext=null)}function Na(m){var p=m._currentValue;if(La!==m)if(m={context:m,memoizedValue:p,next:null},ra===null){if(gn===null)throw Error(r(308));ra=m,gn.dependencies={lanes:0,firstContext:m}}else ra=ra.next=m;return p}var ji=null;function zo(m){ji===null?ji=[m]:ji.push(m)}function Ao(m,p,_,W){var ae=p.interleaved;return ae===null?(_.next=_,zo(p)):(_.next=ae.next,ae.next=_),p.interleaved=_,_r(m,W)}function _r(m,p){m.lanes|=p;var _=m.alternate;for(_!==null&&(_.lanes|=p),_=m,m=m.return;m!==null;)m.childLanes|=p,_=m.alternate,_!==null&&(_.childLanes|=p),_=m,m=m.return;return _.tag===3?_.stateNode:null}var kl=!1;function UA(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sm(m,p){m=m.updateQueue,p.updateQueue===m&&(p.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects})}function Oi(m,p){return{eventTime:m,lane:p,tag:0,payload:null,callback:null,next:null}}function Qi(m,p,_){var W=m.updateQueue;if(W===null)return null;if(W=W.shared,(br&2)!==0){var ae=W.pending;return ae===null?p.next=p:(p.next=ae.next,ae.next=p),W.pending=p,_r(m,_)}return ae=W.interleaved,ae===null?(p.next=p,zo(W)):(p.next=ae.next,ae.next=p),W.interleaved=p,_r(m,_)}function Tc(m,p,_){if(p=p.updateQueue,p!==null&&(p=p.shared,(_&4194240)!==0)){var W=p.lanes;W&=m.pendingLanes,_|=W,p.lanes=_,Ga(m,_)}}function Mi(m,p){var _=m.updateQueue,W=m.alternate;if(W!==null&&(W=W.updateQueue,_===W)){var ae=null,me=null;if(_=_.firstBaseUpdate,_!==null){do{var Re={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};me===null?ae=me=Re:me=me.next=Re,_=_.next}while(_!==null);me===null?ae=me=p:me=me.next=p}else ae=me=p;_={baseState:W.baseState,firstBaseUpdate:ae,lastBaseUpdate:me,shared:W.shared,effects:W.effects},m.updateQueue=_;return}m=_.lastBaseUpdate,m===null?_.firstBaseUpdate=p:m.next=p,_.lastBaseUpdate=p}function ho(m,p,_,W){var ae=m.updateQueue;kl=!1;var me=ae.firstBaseUpdate,Re=ae.lastBaseUpdate,At=ae.shared.pending;if(At!==null){ae.shared.pending=null;var Nt=At,Mt=Nt.next;Nt.next=null,Re===null?me=Mt:Re.next=Mt,Re=Nt;var cs=m.alternate;cs!==null&&(cs=cs.updateQueue,At=cs.lastBaseUpdate,At!==Re&&(At===null?cs.firstBaseUpdate=Mt:At.next=Mt,cs.lastBaseUpdate=Nt))}if(me!==null){var us=ae.baseState;Re=0,cs=Mt=Nt=null,At=me;do{var os=At.lane,Ss=At.eventTime;if((W&os)===os){cs!==null&&(cs=cs.next={eventTime:Ss,lane:0,tag:At.tag,payload:At.payload,callback:At.callback,next:null});e:{var Bs=m,Fs=At;switch(os=p,Ss=_,Fs.tag){case 1:if(Bs=Fs.payload,typeof Bs=="function"){us=Bs.call(Ss,us,os);break e}us=Bs;break e;case 3:Bs.flags=Bs.flags&-65537|128;case 0:if(Bs=Fs.payload,os=typeof Bs=="function"?Bs.call(Ss,us,os):Bs,os==null)break e;us=D({},us,os);break e;case 2:kl=!0}}At.callback!==null&&At.lane!==0&&(m.flags|=64,os=ae.effects,os===null?ae.effects=[At]:os.push(At))}else Ss={eventTime:Ss,lane:os,tag:At.tag,payload:At.payload,callback:At.callback,next:null},cs===null?(Mt=cs=Ss,Nt=us):cs=cs.next=Ss,Re|=os;if(At=At.next,At===null){if(At=ae.shared.pending,At===null)break;os=At,At=os.next,os.next=null,ae.lastBaseUpdate=os,ae.shared.pending=null}}while(!0);if(cs===null&&(Nt=us),ae.baseState=Nt,ae.firstBaseUpdate=Mt,ae.lastBaseUpdate=cs,p=ae.shared.interleaved,p!==null){ae=p;do Re|=ae.lane,ae=ae.next;while(ae!==p)}else me===null&&(ae.shared.lanes=0);Qu|=Re,m.lanes=Re,m.memoizedState=us}}function Ic(m,p,_){if(m=p.effects,p.effects=null,m!==null)for(p=0;p<m.length;p++){var W=m[p],ae=W.callback;if(ae!==null){if(W.callback=null,W=_,typeof ae!="function")throw Error(r(191,ae));ae.call(W)}}}var Cd={},Ni=rl(Cd),kd=rl(Cd),Yo=rl(Cd);function mo(m){if(m===Cd)throw Error(r(174));return m}function Bd(m,p){switch(Fr(Yo,p),Fr(kd,m),Fr(Ni,Cd),m=p.nodeType,m){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:be(null,"");break;default:m=m===8?p.parentNode:p,p=m.namespaceURI||null,m=m.tagName,p=be(p,m)}Br(Ni),Fr(Ni,p)}function Bl(){Br(Ni),Br(kd),Br(Yo)}function tp(m){mo(Yo.current);var p=mo(Ni.current),_=be(p,m.type);p!==_&&(Fr(kd,m),Fr(Ni,_))}function rm(m){kd.current===m&&(Br(Ni),Br(kd))}var Kr=rl(0);function al(m){for(var p=m;p!==null;){if(p.tag===13){var _=p.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||_.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===m)break;for(;p.sibling===null;){if(p.return===null||p.return===m)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var am=[];function nm(){for(var m=0;m<am.length;m++)am[m]._workInProgressVersionPrimary=null;am.length=0}var PA=S.ReactCurrentDispatcher,RA=S.ReactCurrentBatchConfig,El=0,Xr=null,wa=null,pa=null,Ed=!1,fo=!1,Fd=0,xg=0;function Da(){throw Error(r(321))}function OA(m,p){if(p===null)return!1;for(var _=0;_<p.length&&_<m.length;_++)if(!vr(m[_],p[_]))return!1;return!0}function Pu(m,p,_,W,ae,me){if(El=me,Xr=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,PA.current=m===null||m.memoizedState===null?KB:zB,m=_(W,ae),fo){me=0;do{if(fo=!1,Fd=0,25<=me)throw Error(r(301));me+=1,pa=wa=null,p.updateQueue=null,PA.current=YB,m=_(W,ae)}while(fo)}if(PA.current=ip,p=wa!==null&&wa.next!==null,El=0,pa=wa=Xr=null,Ed=!1,p)throw Error(r(300));return m}function Fl(){var m=Fd!==0;return Fd=0,m}function nl(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pa===null?Xr.memoizedState=pa=m:pa=pa.next=m,pa}function wi(){if(wa===null){var m=Xr.alternate;m=m!==null?m.memoizedState:null}else m=wa.next;var p=pa===null?Xr.memoizedState:pa.next;if(p!==null)pa=p,wa=m;else{if(m===null)throw Error(r(310));wa=m,m={memoizedState:wa.memoizedState,baseState:wa.baseState,baseQueue:wa.baseQueue,queue:wa.queue,next:null},pa===null?Xr.memoizedState=pa=m:pa=pa.next=m}return pa}function Ru(m,p){return typeof p=="function"?p(m):p}function QA(m){var p=wi(),_=p.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=m;var W=wa,ae=W.baseQueue,me=_.pending;if(me!==null){if(ae!==null){var Re=ae.next;ae.next=me.next,me.next=Re}W.baseQueue=ae=me,_.pending=null}if(ae!==null){me=ae.next,W=W.baseState;var At=Re=null,Nt=null,Mt=me;do{var cs=Mt.lane;if((El&cs)===cs)Nt!==null&&(Nt=Nt.next={lane:0,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null}),W=Mt.hasEagerState?Mt.eagerState:m(W,Mt.action);else{var us={lane:cs,action:Mt.action,hasEagerState:Mt.hasEagerState,eagerState:Mt.eagerState,next:null};Nt===null?(At=Nt=us,Re=W):Nt=Nt.next=us,Xr.lanes|=cs,Qu|=cs}Mt=Mt.next}while(Mt!==null&&Mt!==me);Nt===null?Re=W:Nt.next=At,vr(W,p.memoizedState)||(Hi=!0),p.memoizedState=W,p.baseState=Re,p.baseQueue=Nt,_.lastRenderedState=W}if(m=_.interleaved,m!==null){ae=m;do me=ae.lane,Xr.lanes|=me,Qu|=me,ae=ae.next;while(ae!==m)}else ae===null&&(_.lanes=0);return[p.memoizedState,_.dispatch]}function Xo(m){var p=wi(),_=p.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=m;var W=_.dispatch,ae=_.pending,me=p.memoizedState;if(ae!==null){_.pending=null;var Re=ae=ae.next;do me=m(me,Re.action),Re=Re.next;while(Re!==ae);vr(me,p.memoizedState)||(Hi=!0),p.memoizedState=me,p.baseQueue===null&&(p.baseState=me),_.lastRenderedState=me}return[me,W]}function sp(){}function im(m,p){var _=Xr,W=wi(),ae=p(),me=!vr(W.memoizedState,ae);if(me&&(W.memoizedState=ae,Hi=!0),W=W.queue,qA(ap.bind(null,_,W,m),[m]),W.getSnapshot!==p||me||pa!==null&&pa.memoizedState.tag&1){if(_.flags|=2048,_i(9,lm.bind(null,_,W,ae,p),void 0,null),vn===null)throw Error(r(349));(El&30)!==0||rp(_,p,ae)}return ae}function rp(m,p,_){m.flags|=16384,m={getSnapshot:p,value:_},p=Xr.updateQueue,p===null?(p={lastEffect:null,stores:null},Xr.updateQueue=p,p.stores=[m]):(_=p.stores,_===null?p.stores=[m]:_.push(m))}function lm(m,p,_,W){p.value=_,p.getSnapshot=W,Td(p)&&MA(m)}function ap(m,p,_){return _(function(){Td(p)&&MA(m)})}function Td(m){var p=m.getSnapshot;m=m.value;try{var _=p();return!vr(m,_)}catch{return!0}}function MA(m){var p=_r(m,1);p!==null&&bo(p,m,1,-1)}function Ou(m){var p=nl();return typeof m=="function"&&(m=m()),p.memoizedState=p.baseState=m,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ru,lastRenderedState:m},p.queue=m,m=m.dispatch=GB.bind(null,Xr,m),[p.memoizedState,m]}function _i(m,p,_,W){return m={tag:m,create:p,destroy:_,deps:W,next:null},p=Xr.updateQueue,p===null?(p={lastEffect:null,stores:null},Xr.updateQueue=p,p.lastEffect=m.next=m):(_=p.lastEffect,_===null?p.lastEffect=m.next=m:(W=_.next,_.next=m,m.next=W,p.lastEffect=m)),m}function po(){return wi().memoizedState}function il(m,p,_,W){var ae=nl();Xr.flags|=m,ae.memoizedState=_i(1|p,_,void 0,W===void 0?null:W)}function Lc(m,p,_,W){var ae=wi();W=W===void 0?null:W;var me=void 0;if(wa!==null){var Re=wa.memoizedState;if(me=Re.destroy,W!==null&&OA(W,Re.deps)){ae.memoizedState=_i(p,_,me,W);return}}Xr.flags|=m,ae.memoizedState=_i(1|p,_,me,W)}function HA(m,p){return il(8390656,8,m,p)}function qA(m,p){return Lc(2048,8,m,p)}function np(m,p){return Lc(4,2,m,p)}function VA(m,p){return Lc(4,4,m,p)}function $A(m,p){if(typeof p=="function")return m=m(),p(m),function(){p(null)};if(p!=null)return m=m(),p.current=m,function(){p.current=null}}function Xj(m,p,_){return _=_!=null?_.concat([m]):null,Lc(4,4,$A.bind(null,p,m),_)}function gg(){}function Jj(m,p){var _=wi();p=p===void 0?null:p;var W=_.memoizedState;return W!==null&&p!==null&&OA(p,W[1])?W[0]:(_.memoizedState=[m,p],m)}function Zj(m,p){var _=wi();p=p===void 0?null:p;var W=_.memoizedState;return W!==null&&p!==null&&OA(p,W[1])?W[0]:(m=m(),_.memoizedState=[m,p],m)}function e1(m,p,_){return(El&21)===0?(m.baseState&&(m.baseState=!1,Hi=!0),m.memoizedState=_):(vr(_,p)||(_=Nr(),Xr.lanes|=_,Qu|=_,m.baseState=!0),p)}function $B(m,p){var _=or;or=_!==0&&4>_?_:4,m(!0);var W=RA.transition;RA.transition={};try{m(!1),p()}finally{or=_,RA.transition=W}}function t1(){return wi().memoizedState}function WB(m,p,_){var W=Ud(m);if(_={lane:W,action:_,hasEagerState:!1,eagerState:null,next:null},s1(m))r1(p,_);else if(_=Ao(m,p,_,W),_!==null){var ae=Ci();bo(_,m,W,ae),a1(_,p,W)}}function GB(m,p,_){var W=Ud(m),ae={lane:W,action:_,hasEagerState:!1,eagerState:null,next:null};if(s1(m))r1(p,ae);else{var me=m.alternate;if(m.lanes===0&&(me===null||me.lanes===0)&&(me=p.lastRenderedReducer,me!==null))try{var Re=p.lastRenderedState,At=me(Re,_);if(ae.hasEagerState=!0,ae.eagerState=At,vr(At,Re)){var Nt=p.interleaved;Nt===null?(ae.next=ae,zo(p)):(ae.next=Nt.next,Nt.next=ae),p.interleaved=ae;return}}catch{}finally{}_=Ao(m,p,ae,W),_!==null&&(ae=Ci(),bo(_,m,W,ae),a1(_,p,W))}}function s1(m){var p=m.alternate;return m===Xr||p!==null&&p===Xr}function r1(m,p){fo=Ed=!0;var _=m.pending;_===null?p.next=p:(p.next=_.next,_.next=p),m.pending=p}function a1(m,p,_){if((_&4194240)!==0){var W=p.lanes;W&=m.pendingLanes,_|=W,p.lanes=_,Ga(m,_)}}var ip={readContext:Na,useCallback:Da,useContext:Da,useEffect:Da,useImperativeHandle:Da,useInsertionEffect:Da,useLayoutEffect:Da,useMemo:Da,useReducer:Da,useRef:Da,useState:Da,useDebugValue:Da,useDeferredValue:Da,useTransition:Da,useMutableSource:Da,useSyncExternalStore:Da,useId:Da,unstable_isNewReconciler:!1},KB={readContext:Na,useCallback:function(m,p){return nl().memoizedState=[m,p===void 0?null:p],m},useContext:Na,useEffect:HA,useImperativeHandle:function(m,p,_){return _=_!=null?_.concat([m]):null,il(4194308,4,$A.bind(null,p,m),_)},useLayoutEffect:function(m,p){return il(4194308,4,m,p)},useInsertionEffect:function(m,p){return il(4,2,m,p)},useMemo:function(m,p){var _=nl();return p=p===void 0?null:p,m=m(),_.memoizedState=[m,p],m},useReducer:function(m,p,_){var W=nl();return p=_!==void 0?_(p):p,W.memoizedState=W.baseState=p,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:p},W.queue=m,m=m.dispatch=WB.bind(null,Xr,m),[W.memoizedState,m]},useRef:function(m){var p=nl();return m={current:m},p.memoizedState=m},useState:Ou,useDebugValue:gg,useDeferredValue:function(m){return nl().memoizedState=m},useTransition:function(){var m=Ou(!1),p=m[0];return m=$B.bind(null,m[1]),nl().memoizedState=m,[p,m]},useMutableSource:function(){},useSyncExternalStore:function(m,p,_){var W=Xr,ae=nl();if(Wt){if(_===void 0)throw Error(r(407));_=_()}else{if(_=p(),vn===null)throw Error(r(349));(El&30)!==0||rp(W,p,_)}ae.memoizedState=_;var me={value:_,getSnapshot:p};return ae.queue=me,HA(ap.bind(null,W,me,m),[m]),W.flags|=2048,_i(9,lm.bind(null,W,me,_,p),void 0,null),_},useId:function(){var m=nl(),p=vn.identifierPrefix;if(Wt){var _=Dt,W=Lt;_=(W&~(1<<32-mr(W)-1)).toString(32)+_,p=":"+p+"R"+_,_=Fd++,0<_&&(p+="H"+_.toString(32)),p+=":"}else _=xg++,p=":"+p+"r"+_.toString(32)+":";return m.memoizedState=p},unstable_isNewReconciler:!1},zB={readContext:Na,useCallback:Jj,useContext:Na,useEffect:qA,useImperativeHandle:Xj,useInsertionEffect:np,useLayoutEffect:VA,useMemo:Zj,useReducer:QA,useRef:po,useState:function(){return QA(Ru)},useDebugValue:gg,useDeferredValue:function(m){var p=wi();return e1(p,wa.memoizedState,m)},useTransition:function(){var m=QA(Ru)[0],p=wi().memoizedState;return[m,p]},useMutableSource:sp,useSyncExternalStore:im,useId:t1,unstable_isNewReconciler:!1},YB={readContext:Na,useCallback:Jj,useContext:Na,useEffect:qA,useImperativeHandle:Xj,useInsertionEffect:np,useLayoutEffect:VA,useMemo:Zj,useReducer:Xo,useRef:po,useState:function(){return Xo(Ru)},useDebugValue:gg,useDeferredValue:function(m){var p=wi();return wa===null?p.memoizedState=m:e1(p,wa.memoizedState,m)},useTransition:function(){var m=Xo(Ru)[0],p=wi().memoizedState;return[m,p]},useMutableSource:sp,useSyncExternalStore:im,useId:t1,unstable_isNewReconciler:!1};function xo(m,p){if(m&&m.defaultProps){p=D({},p),m=m.defaultProps;for(var _ in m)p[_]===void 0&&(p[_]=m[_]);return p}return p}function vg(m,p,_,W){p=m.memoizedState,_=_(W,p),_=_==null?p:D({},p,_),m.memoizedState=_,m.lanes===0&&(m.updateQueue.baseState=_)}var lp={isMounted:function(m){return(m=m._reactInternals)?Ge(m)===m:!1},enqueueSetState:function(m,p,_){m=m._reactInternals;var W=Ci(),ae=Ud(m),me=Oi(W,ae);me.payload=p,_!=null&&(me.callback=_),p=Qi(m,me,ae),p!==null&&(bo(p,m,ae,W),Tc(p,m,ae))},enqueueReplaceState:function(m,p,_){m=m._reactInternals;var W=Ci(),ae=Ud(m),me=Oi(W,ae);me.tag=1,me.payload=p,_!=null&&(me.callback=_),p=Qi(m,me,ae),p!==null&&(bo(p,m,ae,W),Tc(p,m,ae))},enqueueForceUpdate:function(m,p){m=m._reactInternals;var _=Ci(),W=Ud(m),ae=Oi(_,W);ae.tag=2,p!=null&&(ae.callback=p),p=Qi(m,ae,W),p!==null&&(bo(p,m,W,_),Tc(p,m,W))}};function n1(m,p,_,W,ae,me,Re){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(W,me,Re):p.prototype&&p.prototype.isPureReactComponent?!no(_,W)||!no(ae,me):!0}function i1(m,p,_){var W=!1,ae=Ko,me=p.contextType;return typeof me=="object"&&me!==null?me=Na(me):(ae=Gn(p)?Ec:rn.current,W=p.contextTypes,me=(W=W!=null)?Sd(m,ae):Ko),p=new p(_,me),m.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=lp,m.stateNode=p,p._reactInternals=m,W&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=ae,m.__reactInternalMemoizedMaskedChildContext=me),p}function l1(m,p,_,W){m=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(_,W),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(_,W),p.state!==m&&lp.enqueueReplaceState(p,p.state,null)}function bg(m,p,_,W){var ae=m.stateNode;ae.props=_,ae.state=m.memoizedState,ae.refs={},UA(m);var me=p.contextType;typeof me=="object"&&me!==null?ae.context=Na(me):(me=Gn(p)?Ec:rn.current,ae.context=Sd(m,me)),ae.state=m.memoizedState,me=p.getDerivedStateFromProps,typeof me=="function"&&(vg(m,p,me,_),ae.state=m.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof ae.getSnapshotBeforeUpdate=="function"||typeof ae.UNSAFE_componentWillMount!="function"&&typeof ae.componentWillMount!="function"||(p=ae.state,typeof ae.componentWillMount=="function"&&ae.componentWillMount(),typeof ae.UNSAFE_componentWillMount=="function"&&ae.UNSAFE_componentWillMount(),p!==ae.state&&lp.enqueueReplaceState(ae,ae.state,null),ho(m,_,ae,W),ae.state=m.memoizedState),typeof ae.componentDidMount=="function"&&(m.flags|=4194308)}function WA(m,p){try{var _="",W=p;do _+=O(W),W=W.return;while(W);var ae=_}catch(me){ae=`
Error generating stack: `+me.message+`
`+me.stack}return{value:m,source:p,stack:ae,digest:null}}function yg(m,p,_){return{value:m,source:null,stack:_??null,digest:p??null}}function jg(m,p){try{console.error(p.value)}catch(_){setTimeout(function(){throw _})}}var XB=typeof WeakMap=="function"?WeakMap:Map;function o1(m,p,_){_=Oi(-1,_),_.tag=3,_.payload={element:null};var W=p.value;return _.callback=function(){mp||(mp=!0,Pg=W),jg(m,p)},_}function c1(m,p,_){_=Oi(-1,_),_.tag=3;var W=m.type.getDerivedStateFromError;if(typeof W=="function"){var ae=p.value;_.payload=function(){return W(ae)},_.callback=function(){jg(m,p)}}var me=m.stateNode;return me!==null&&typeof me.componentDidCatch=="function"&&(_.callback=function(){jg(m,p),typeof W!="function"&&(Ld===null?Ld=new Set([this]):Ld.add(this));var Re=p.stack;this.componentDidCatch(p.value,{componentStack:Re!==null?Re:""})}),_}function d1(m,p,_){var W=m.pingCache;if(W===null){W=m.pingCache=new XB;var ae=new Set;W.set(p,ae)}else ae=W.get(p),ae===void 0&&(ae=new Set,W.set(p,ae));ae.has(_)||(ae.add(_),m=uE.bind(null,m,p,_),p.then(m,m))}function u1(m){do{var p;if((p=m.tag===13)&&(p=m.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return m;m=m.return}while(m!==null);return null}function A1(m,p,_,W,ae){return(m.mode&1)===0?(m===p?m.flags|=65536:(m.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(p=Oi(-1,1),p.tag=2,Qi(_,p,1))),_.lanes|=1),m):(m.flags|=65536,m.lanes=ae,m)}var JB=S.ReactCurrentOwner,Hi=!1;function Si(m,p,_,W){p.child=m===null?wr(p,null,_,W):Ia(p,m.child,_,W)}function h1(m,p,_,W,ae){_=_.render;var me=p.ref;return aa(p,ae),W=Pu(m,p,_,W,me,ae),_=Fl(),m!==null&&!Hi?(p.updateQueue=m.updateQueue,p.flags&=-2053,m.lanes&=~ae,Dc(m,p,ae)):(Wt&&_&&Vt(p),p.flags|=1,Si(m,p,W,ae),p.child)}function m1(m,p,_,W,ae){if(m===null){var me=_.type;return typeof me=="function"&&!Vg(me)&&me.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(p.tag=15,p.type=me,f1(m,p,me,W,ae)):(m=bp(_.type,null,W,p,p.mode,ae),m.ref=p.ref,m.return=p,p.child=m)}if(me=m.child,(m.lanes&ae)===0){var Re=me.memoizedProps;if(_=_.compare,_=_!==null?_:no,_(Re,W)&&m.ref===p.ref)return Dc(m,p,ae)}return p.flags|=1,m=Rd(me,W),m.ref=p.ref,m.return=p,p.child=m}function f1(m,p,_,W,ae){if(m!==null){var me=m.memoizedProps;if(no(me,W)&&m.ref===p.ref)if(Hi=!1,p.pendingProps=W=me,(m.lanes&ae)!==0)(m.flags&131072)!==0&&(Hi=!0);else return p.lanes=m.lanes,Dc(m,p,ae)}return Ng(m,p,_,W,ae)}function p1(m,p,_){var W=p.pendingProps,ae=W.children,me=m!==null?m.memoizedState:null;if(W.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fr(KA,ll),ll|=_;else{if((_&1073741824)===0)return m=me!==null?me.baseLanes|_:_,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:m,cachePool:null,transitions:null},p.updateQueue=null,Fr(KA,ll),ll|=m,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},W=me!==null?me.baseLanes:_,Fr(KA,ll),ll|=W}else me!==null?(W=me.baseLanes|_,p.memoizedState=null):W=_,Fr(KA,ll),ll|=W;return Si(m,p,ae,_),p.child}function x1(m,p){var _=p.ref;(m===null&&_!==null||m!==null&&m.ref!==_)&&(p.flags|=512,p.flags|=2097152)}function Ng(m,p,_,W,ae){var me=Gn(_)?Ec:rn.current;return me=Sd(p,me),aa(p,ae),_=Pu(m,p,_,W,me,ae),W=Fl(),m!==null&&!Hi?(p.updateQueue=m.updateQueue,p.flags&=-2053,m.lanes&=~ae,Dc(m,p,ae)):(Wt&&W&&Vt(p),p.flags|=1,Si(m,p,_,ae),p.child)}function g1(m,p,_,W,ae){if(Gn(_)){var me=!0;Fc(p)}else me=!1;if(aa(p,ae),p.stateNode===null)cp(m,p),i1(p,_,W),bg(p,_,W,ae),W=!0;else if(m===null){var Re=p.stateNode,At=p.memoizedProps;Re.props=At;var Nt=Re.context,Mt=_.contextType;typeof Mt=="object"&&Mt!==null?Mt=Na(Mt):(Mt=Gn(_)?Ec:rn.current,Mt=Sd(p,Mt));var cs=_.getDerivedStateFromProps,us=typeof cs=="function"||typeof Re.getSnapshotBeforeUpdate=="function";us||typeof Re.UNSAFE_componentWillReceiveProps!="function"&&typeof Re.componentWillReceiveProps!="function"||(At!==W||Nt!==Mt)&&l1(p,Re,W,Mt),kl=!1;var os=p.memoizedState;Re.state=os,ho(p,W,Re,ae),Nt=p.memoizedState,At!==W||os!==Nt||Wn.current||kl?(typeof cs=="function"&&(vg(p,_,cs,W),Nt=p.memoizedState),(At=kl||n1(p,_,At,W,os,Nt,Mt))?(us||typeof Re.UNSAFE_componentWillMount!="function"&&typeof Re.componentWillMount!="function"||(typeof Re.componentWillMount=="function"&&Re.componentWillMount(),typeof Re.UNSAFE_componentWillMount=="function"&&Re.UNSAFE_componentWillMount()),typeof Re.componentDidMount=="function"&&(p.flags|=4194308)):(typeof Re.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=W,p.memoizedState=Nt),Re.props=W,Re.state=Nt,Re.context=Mt,W=At):(typeof Re.componentDidMount=="function"&&(p.flags|=4194308),W=!1)}else{Re=p.stateNode,sm(m,p),At=p.memoizedProps,Mt=p.type===p.elementType?At:xo(p.type,At),Re.props=Mt,us=p.pendingProps,os=Re.context,Nt=_.contextType,typeof Nt=="object"&&Nt!==null?Nt=Na(Nt):(Nt=Gn(_)?Ec:rn.current,Nt=Sd(p,Nt));var Ss=_.getDerivedStateFromProps;(cs=typeof Ss=="function"||typeof Re.getSnapshotBeforeUpdate=="function")||typeof Re.UNSAFE_componentWillReceiveProps!="function"&&typeof Re.componentWillReceiveProps!="function"||(At!==us||os!==Nt)&&l1(p,Re,W,Nt),kl=!1,os=p.memoizedState,Re.state=os,ho(p,W,Re,ae);var Bs=p.memoizedState;At!==us||os!==Bs||Wn.current||kl?(typeof Ss=="function"&&(vg(p,_,Ss,W),Bs=p.memoizedState),(Mt=kl||n1(p,_,Mt,W,os,Bs,Nt)||!1)?(cs||typeof Re.UNSAFE_componentWillUpdate!="function"&&typeof Re.componentWillUpdate!="function"||(typeof Re.componentWillUpdate=="function"&&Re.componentWillUpdate(W,Bs,Nt),typeof Re.UNSAFE_componentWillUpdate=="function"&&Re.UNSAFE_componentWillUpdate(W,Bs,Nt)),typeof Re.componentDidUpdate=="function"&&(p.flags|=4),typeof Re.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof Re.componentDidUpdate!="function"||At===m.memoizedProps&&os===m.memoizedState||(p.flags|=4),typeof Re.getSnapshotBeforeUpdate!="function"||At===m.memoizedProps&&os===m.memoizedState||(p.flags|=1024),p.memoizedProps=W,p.memoizedState=Bs),Re.props=W,Re.state=Bs,Re.context=Nt,W=Mt):(typeof Re.componentDidUpdate!="function"||At===m.memoizedProps&&os===m.memoizedState||(p.flags|=4),typeof Re.getSnapshotBeforeUpdate!="function"||At===m.memoizedProps&&os===m.memoizedState||(p.flags|=1024),W=!1)}return wg(m,p,_,W,me,ae)}function wg(m,p,_,W,ae,me){x1(m,p);var Re=(p.flags&128)!==0;if(!W&&!Re)return ae&&ep(p,_,!1),Dc(m,p,me);W=p.stateNode,JB.current=p;var At=Re&&typeof _.getDerivedStateFromError!="function"?null:W.render();return p.flags|=1,m!==null&&Re?(p.child=Ia(p,m.child,null,me),p.child=Ia(p,null,At,me)):Si(m,p,At,me),p.memoizedState=W.state,ae&&ep(p,_,!0),p.child}function v1(m){var p=m.stateNode;p.pendingContext?Zf(m,p.pendingContext,p.pendingContext!==p.context):p.context&&Zf(m,p.context,!1),Bd(m,p.containerInfo)}function b1(m,p,_,W,ae){return tr(),Er(ae),p.flags|=256,Si(m,p,_,W),p.child}var _g={dehydrated:null,treeContext:null,retryLane:0};function Sg(m){return{baseLanes:m,cachePool:null,transitions:null}}function y1(m,p,_){var W=p.pendingProps,ae=Kr.current,me=!1,Re=(p.flags&128)!==0,At;if((At=Re)||(At=m!==null&&m.memoizedState===null?!1:(ae&2)!==0),At?(me=!0,p.flags&=-129):(m===null||m.memoizedState!==null)&&(ae|=1),Fr(Kr,ae&1),m===null)return bs(p),m=p.memoizedState,m!==null&&(m=m.dehydrated,m!==null)?((p.mode&1)===0?p.lanes=1:m.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(Re=W.children,m=W.fallback,me?(W=p.mode,me=p.child,Re={mode:"hidden",children:Re},(W&1)===0&&me!==null?(me.childLanes=0,me.pendingProps=Re):me=yp(Re,W,0,null),m=Vu(m,W,_,null),me.return=p,m.return=p,me.sibling=m,p.child=me,p.child.memoizedState=Sg(_),p.memoizedState=_g,m):Cg(p,Re));if(ae=m.memoizedState,ae!==null&&(At=ae.dehydrated,At!==null))return ZB(m,p,Re,W,At,ae,_);if(me){me=W.fallback,Re=p.mode,ae=m.child,At=ae.sibling;var Nt={mode:"hidden",children:W.children};return(Re&1)===0&&p.child!==ae?(W=p.child,W.childLanes=0,W.pendingProps=Nt,p.deletions=null):(W=Rd(ae,Nt),W.subtreeFlags=ae.subtreeFlags&14680064),At!==null?me=Rd(At,me):(me=Vu(me,Re,_,null),me.flags|=2),me.return=p,W.return=p,W.sibling=me,p.child=W,W=me,me=p.child,Re=m.child.memoizedState,Re=Re===null?Sg(_):{baseLanes:Re.baseLanes|_,cachePool:null,transitions:Re.transitions},me.memoizedState=Re,me.childLanes=m.childLanes&~_,p.memoizedState=_g,W}return me=m.child,m=me.sibling,W=Rd(me,{mode:"visible",children:W.children}),(p.mode&1)===0&&(W.lanes=_),W.return=p,W.sibling=null,m!==null&&(_=p.deletions,_===null?(p.deletions=[m],p.flags|=16):_.push(m)),p.child=W,p.memoizedState=null,W}function Cg(m,p){return p=yp({mode:"visible",children:p},m.mode,0,null),p.return=m,m.child=p}function op(m,p,_,W){return W!==null&&Er(W),Ia(p,m.child,null,_),m=Cg(p,p.pendingProps.children),m.flags|=2,p.memoizedState=null,m}function ZB(m,p,_,W,ae,me,Re){if(_)return p.flags&256?(p.flags&=-257,W=yg(Error(r(422))),op(m,p,Re,W)):p.memoizedState!==null?(p.child=m.child,p.flags|=128,null):(me=W.fallback,ae=p.mode,W=yp({mode:"visible",children:W.children},ae,0,null),me=Vu(me,ae,Re,null),me.flags|=2,W.return=p,me.return=p,W.sibling=me,p.child=W,(p.mode&1)!==0&&Ia(p,m.child,null,Re),p.child.memoizedState=Sg(Re),p.memoizedState=_g,me);if((p.mode&1)===0)return op(m,p,Re,null);if(ae.data==="$!"){if(W=ae.nextSibling&&ae.nextSibling.dataset,W)var At=W.dgst;return W=At,me=Error(r(419)),W=yg(me,W,void 0),op(m,p,Re,W)}if(At=(Re&m.childLanes)!==0,Hi||At){if(W=vn,W!==null){switch(Re&-Re){case 4:ae=2;break;case 16:ae=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ae=32;break;case 536870912:ae=268435456;break;default:ae=0}ae=(ae&(W.suspendedLanes|Re))!==0?0:ae,ae!==0&&ae!==me.retryLane&&(me.retryLane=ae,_r(m,ae),bo(W,m,ae,-1))}return qg(),W=yg(Error(r(421))),op(m,p,Re,W)}return ae.data==="$?"?(p.flags|=128,p.child=m.child,p=AE.bind(null,m),ae._reactRetry=p,null):(m=me.treeContext,Gt=En(ae.nextSibling),_t=p,Wt=!0,zt=null,m!==null&&($e[st++]=Lt,$e[st++]=Dt,$e[st++]=jt,Lt=m.id,Dt=m.overflow,jt=p),p=Cg(p,W.children),p.flags|=4096,p)}function j1(m,p,_){m.lanes|=p;var W=m.alternate;W!==null&&(W.lanes|=p),Ri(m.return,p,_)}function kg(m,p,_,W,ae){var me=m.memoizedState;me===null?m.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:W,tail:_,tailMode:ae}:(me.isBackwards=p,me.rendering=null,me.renderingStartTime=0,me.last=W,me.tail=_,me.tailMode=ae)}function N1(m,p,_){var W=p.pendingProps,ae=W.revealOrder,me=W.tail;if(Si(m,p,W.children,_),W=Kr.current,(W&2)!==0)W=W&1|2,p.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=p.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&j1(m,_,p);else if(m.tag===19)j1(m,_,p);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===p)break e;for(;m.sibling===null;){if(m.return===null||m.return===p)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}W&=1}if(Fr(Kr,W),(p.mode&1)===0)p.memoizedState=null;else switch(ae){case"forwards":for(_=p.child,ae=null;_!==null;)m=_.alternate,m!==null&&al(m)===null&&(ae=_),_=_.sibling;_=ae,_===null?(ae=p.child,p.child=null):(ae=_.sibling,_.sibling=null),kg(p,!1,ae,_,me);break;case"backwards":for(_=null,ae=p.child,p.child=null;ae!==null;){if(m=ae.alternate,m!==null&&al(m)===null){p.child=ae;break}m=ae.sibling,ae.sibling=_,_=ae,ae=m}kg(p,!0,_,null,me);break;case"together":kg(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function cp(m,p){(p.mode&1)===0&&m!==null&&(m.alternate=null,p.alternate=null,p.flags|=2)}function Dc(m,p,_){if(m!==null&&(p.dependencies=m.dependencies),Qu|=p.lanes,(_&p.childLanes)===0)return null;if(m!==null&&p.child!==m.child)throw Error(r(153));if(p.child!==null){for(m=p.child,_=Rd(m,m.pendingProps),p.child=_,_.return=p;m.sibling!==null;)m=m.sibling,_=_.sibling=Rd(m,m.pendingProps),_.return=p;_.sibling=null}return p.child}function eE(m,p,_){switch(p.tag){case 3:v1(p),tr();break;case 5:tp(p);break;case 1:Gn(p.type)&&Fc(p);break;case 4:Bd(p,p.stateNode.containerInfo);break;case 10:var W=p.type._context,ae=p.memoizedProps.value;Fr(xn,W._currentValue),W._currentValue=ae;break;case 13:if(W=p.memoizedState,W!==null)return W.dehydrated!==null?(Fr(Kr,Kr.current&1),p.flags|=128,null):(_&p.child.childLanes)!==0?y1(m,p,_):(Fr(Kr,Kr.current&1),m=Dc(m,p,_),m!==null?m.sibling:null);Fr(Kr,Kr.current&1);break;case 19:if(W=(_&p.childLanes)!==0,(m.flags&128)!==0){if(W)return N1(m,p,_);p.flags|=128}if(ae=p.memoizedState,ae!==null&&(ae.rendering=null,ae.tail=null,ae.lastEffect=null),Fr(Kr,Kr.current),W)break;return null;case 22:case 23:return p.lanes=0,p1(m,p,_)}return Dc(m,p,_)}var w1,Bg,_1,S1;w1=function(m,p){for(var _=p.child;_!==null;){if(_.tag===5||_.tag===6)m.appendChild(_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===p)break;for(;_.sibling===null;){if(_.return===null||_.return===p)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},Bg=function(){},_1=function(m,p,_,W){var ae=m.memoizedProps;if(ae!==W){m=p.stateNode,mo(Ni.current);var me=null;switch(_){case"input":ae=Ie(m,ae),W=Ie(m,W),me=[];break;case"select":ae=D({},ae,{value:void 0}),W=D({},W,{value:void 0}),me=[];break;case"textarea":ae=Ye(m,ae),W=Ye(m,W),me=[];break;default:typeof ae.onClick!="function"&&typeof W.onClick=="function"&&(m.onclick=Nd)}ze(_,W);var Re;_=null;for(Mt in ae)if(!W.hasOwnProperty(Mt)&&ae.hasOwnProperty(Mt)&&ae[Mt]!=null)if(Mt==="style"){var At=ae[Mt];for(Re in At)At.hasOwnProperty(Re)&&(_||(_={}),_[Re]="")}else Mt!=="dangerouslySetInnerHTML"&&Mt!=="children"&&Mt!=="suppressContentEditableWarning"&&Mt!=="suppressHydrationWarning"&&Mt!=="autoFocus"&&(n.hasOwnProperty(Mt)?me||(me=[]):(me=me||[]).push(Mt,null));for(Mt in W){var Nt=W[Mt];if(At=ae!=null?ae[Mt]:void 0,W.hasOwnProperty(Mt)&&Nt!==At&&(Nt!=null||At!=null))if(Mt==="style")if(At){for(Re in At)!At.hasOwnProperty(Re)||Nt&&Nt.hasOwnProperty(Re)||(_||(_={}),_[Re]="");for(Re in Nt)Nt.hasOwnProperty(Re)&&At[Re]!==Nt[Re]&&(_||(_={}),_[Re]=Nt[Re])}else _||(me||(me=[]),me.push(Mt,_)),_=Nt;else Mt==="dangerouslySetInnerHTML"?(Nt=Nt?Nt.__html:void 0,At=At?At.__html:void 0,Nt!=null&&At!==Nt&&(me=me||[]).push(Mt,Nt)):Mt==="children"?typeof Nt!="string"&&typeof Nt!="number"||(me=me||[]).push(Mt,""+Nt):Mt!=="suppressContentEditableWarning"&&Mt!=="suppressHydrationWarning"&&(n.hasOwnProperty(Mt)?(Nt!=null&&Mt==="onScroll"&&Rr("scroll",m),me||At===Nt||(me=[])):(me=me||[]).push(Mt,Nt))}_&&(me=me||[]).push("style",_);var Mt=me;(p.updateQueue=Mt)&&(p.flags|=4)}},S1=function(m,p,_,W){_!==W&&(p.flags|=4)};function om(m,p){if(!Wt)switch(m.tailMode){case"hidden":p=m.tail;for(var _=null;p!==null;)p.alternate!==null&&(_=p),p=p.sibling;_===null?m.tail=null:_.sibling=null;break;case"collapsed":_=m.tail;for(var W=null;_!==null;)_.alternate!==null&&(W=_),_=_.sibling;W===null?p||m.tail===null?m.tail=null:m.tail.sibling=null:W.sibling=null}}function zn(m){var p=m.alternate!==null&&m.alternate.child===m.child,_=0,W=0;if(p)for(var ae=m.child;ae!==null;)_|=ae.lanes|ae.childLanes,W|=ae.subtreeFlags&14680064,W|=ae.flags&14680064,ae.return=m,ae=ae.sibling;else for(ae=m.child;ae!==null;)_|=ae.lanes|ae.childLanes,W|=ae.subtreeFlags,W|=ae.flags,ae.return=m,ae=ae.sibling;return m.subtreeFlags|=W,m.childLanes=_,p}function tE(m,p,_){var W=p.pendingProps;switch(wt(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(p),null;case 1:return Gn(p.type)&&DA(),zn(p),null;case 3:return W=p.stateNode,Bl(),Br(Wn),Br(rn),nm(),W.pendingContext&&(W.context=W.pendingContext,W.pendingContext=null),(m===null||m.child===null)&&(pr(p)?p.flags|=4:m===null||m.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,zt!==null&&(Qg(zt),zt=null))),Bg(m,p),zn(p),null;case 5:rm(p);var ae=mo(Yo.current);if(_=p.type,m!==null&&p.stateNode!=null)_1(m,p,_,W,ae),m.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!W){if(p.stateNode===null)throw Error(r(166));return zn(p),null}if(m=mo(Ni.current),pr(p)){W=p.stateNode,_=p.type;var me=p.memoizedProps;switch(W[Cl]=p,W[wd]=me,m=(p.mode&1)!==0,_){case"dialog":Rr("cancel",W),Rr("close",W);break;case"iframe":case"object":case"embed":Rr("load",W);break;case"video":case"audio":for(ae=0;ae<Wo.length;ae++)Rr(Wo[ae],W);break;case"source":Rr("error",W);break;case"img":case"image":case"link":Rr("error",W),Rr("load",W);break;case"details":Rr("toggle",W);break;case"input":le(W,me),Rr("invalid",W);break;case"select":W._wrapperState={wasMultiple:!!me.multiple},Rr("invalid",W);break;case"textarea":ot(W,me),Rr("invalid",W)}ze(_,me),ae=null;for(var Re in me)if(me.hasOwnProperty(Re)){var At=me[Re];Re==="children"?typeof At=="string"?W.textContent!==At&&(me.suppressHydrationWarning!==!0&&LA(W.textContent,At,m),ae=["children",At]):typeof At=="number"&&W.textContent!==""+At&&(me.suppressHydrationWarning!==!0&&LA(W.textContent,At,m),ae=["children",""+At]):n.hasOwnProperty(Re)&&At!=null&&Re==="onScroll"&&Rr("scroll",W)}switch(_){case"input":ce(W),Ue(W,me,!0);break;case"textarea":ce(W),ct(W);break;case"select":case"option":break;default:typeof me.onClick=="function"&&(W.onclick=Nd)}W=ae,p.updateQueue=W,W!==null&&(p.flags|=4)}else{Re=ae.nodeType===9?ae:ae.ownerDocument,m==="http://www.w3.org/1999/xhtml"&&(m=xt(_)),m==="http://www.w3.org/1999/xhtml"?_==="script"?(m=Re.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild)):typeof W.is=="string"?m=Re.createElement(_,{is:W.is}):(m=Re.createElement(_),_==="select"&&(Re=m,W.multiple?Re.multiple=!0:W.size&&(Re.size=W.size))):m=Re.createElementNS(m,_),m[Cl]=p,m[wd]=W,w1(m,p,!1,!1),p.stateNode=m;e:{switch(Re=Fe(_,W),_){case"dialog":Rr("cancel",m),Rr("close",m),ae=W;break;case"iframe":case"object":case"embed":Rr("load",m),ae=W;break;case"video":case"audio":for(ae=0;ae<Wo.length;ae++)Rr(Wo[ae],m);ae=W;break;case"source":Rr("error",m),ae=W;break;case"img":case"image":case"link":Rr("error",m),Rr("load",m),ae=W;break;case"details":Rr("toggle",m),ae=W;break;case"input":le(m,W),ae=Ie(m,W),Rr("invalid",m);break;case"option":ae=W;break;case"select":m._wrapperState={wasMultiple:!!W.multiple},ae=D({},W,{value:void 0}),Rr("invalid",m);break;case"textarea":ot(m,W),ae=Ye(m,W),Rr("invalid",m);break;default:ae=W}ze(_,ae),At=ae;for(me in At)if(At.hasOwnProperty(me)){var Nt=At[me];me==="style"?Ze(m,Nt):me==="dangerouslySetInnerHTML"?(Nt=Nt?Nt.__html:void 0,Nt!=null&&Te(m,Nt)):me==="children"?typeof Nt=="string"?(_!=="textarea"||Nt!=="")&&ue(m,Nt):typeof Nt=="number"&&ue(m,""+Nt):me!=="suppressContentEditableWarning"&&me!=="suppressHydrationWarning"&&me!=="autoFocus"&&(n.hasOwnProperty(me)?Nt!=null&&me==="onScroll"&&Rr("scroll",m):Nt!=null&&N(m,me,Nt,Re))}switch(_){case"input":ce(m),Ue(m,W,!1);break;case"textarea":ce(m),ct(m);break;case"option":W.value!=null&&m.setAttribute("value",""+ne(W.value));break;case"select":m.multiple=!!W.multiple,me=W.value,me!=null?Me(m,!!W.multiple,me,!1):W.defaultValue!=null&&Me(m,!!W.multiple,W.defaultValue,!0);break;default:typeof ae.onClick=="function"&&(m.onclick=Nd)}switch(_){case"button":case"input":case"select":case"textarea":W=!!W.autoFocus;break e;case"img":W=!0;break e;default:W=!1}}W&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return zn(p),null;case 6:if(m&&p.stateNode!=null)S1(m,p,m.memoizedProps,W);else{if(typeof W!="string"&&p.stateNode===null)throw Error(r(166));if(_=mo(Yo.current),mo(Ni.current),pr(p)){if(W=p.stateNode,_=p.memoizedProps,W[Cl]=p,(me=W.nodeValue!==_)&&(m=_t,m!==null))switch(m.tag){case 3:LA(W.nodeValue,_,(m.mode&1)!==0);break;case 5:m.memoizedProps.suppressHydrationWarning!==!0&&LA(W.nodeValue,_,(m.mode&1)!==0)}me&&(p.flags|=4)}else W=(_.nodeType===9?_:_.ownerDocument).createTextNode(W),W[Cl]=p,p.stateNode=W}return zn(p),null;case 13:if(Br(Kr),W=p.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(Wt&&Gt!==null&&(p.mode&1)!==0&&(p.flags&128)===0)Ar(),tr(),p.flags|=98560,me=!1;else if(me=pr(p),W!==null&&W.dehydrated!==null){if(m===null){if(!me)throw Error(r(318));if(me=p.memoizedState,me=me!==null?me.dehydrated:null,!me)throw Error(r(317));me[Cl]=p}else tr(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;zn(p),me=!1}else zt!==null&&(Qg(zt),zt=null),me=!0;if(!me)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=_,p):(W=W!==null,W!==(m!==null&&m.memoizedState!==null)&&W&&(p.child.flags|=8192,(p.mode&1)!==0&&(m===null||(Kr.current&1)!==0?nn===0&&(nn=3):qg())),p.updateQueue!==null&&(p.flags|=4),zn(p),null);case 4:return Bl(),Bg(m,p),m===null&&Sc(p.stateNode.containerInfo),zn(p),null;case 10:return Kn(p.type._context),zn(p),null;case 17:return Gn(p.type)&&DA(),zn(p),null;case 19:if(Br(Kr),me=p.memoizedState,me===null)return zn(p),null;if(W=(p.flags&128)!==0,Re=me.rendering,Re===null)if(W)om(me,!1);else{if(nn!==0||m!==null&&(m.flags&128)!==0)for(m=p.child;m!==null;){if(Re=al(m),Re!==null){for(p.flags|=128,om(me,!1),W=Re.updateQueue,W!==null&&(p.updateQueue=W,p.flags|=4),p.subtreeFlags=0,W=_,_=p.child;_!==null;)me=_,m=W,me.flags&=14680066,Re=me.alternate,Re===null?(me.childLanes=0,me.lanes=m,me.child=null,me.subtreeFlags=0,me.memoizedProps=null,me.memoizedState=null,me.updateQueue=null,me.dependencies=null,me.stateNode=null):(me.childLanes=Re.childLanes,me.lanes=Re.lanes,me.child=Re.child,me.subtreeFlags=0,me.deletions=null,me.memoizedProps=Re.memoizedProps,me.memoizedState=Re.memoizedState,me.updateQueue=Re.updateQueue,me.type=Re.type,m=Re.dependencies,me.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),_=_.sibling;return Fr(Kr,Kr.current&1|2),p.child}m=m.sibling}me.tail!==null&&Jt()>zA&&(p.flags|=128,W=!0,om(me,!1),p.lanes=4194304)}else{if(!W)if(m=al(Re),m!==null){if(p.flags|=128,W=!0,_=m.updateQueue,_!==null&&(p.updateQueue=_,p.flags|=4),om(me,!0),me.tail===null&&me.tailMode==="hidden"&&!Re.alternate&&!Wt)return zn(p),null}else 2*Jt()-me.renderingStartTime>zA&&_!==1073741824&&(p.flags|=128,W=!0,om(me,!1),p.lanes=4194304);me.isBackwards?(Re.sibling=p.child,p.child=Re):(_=me.last,_!==null?_.sibling=Re:p.child=Re,me.last=Re)}return me.tail!==null?(p=me.tail,me.rendering=p,me.tail=p.sibling,me.renderingStartTime=Jt(),p.sibling=null,_=Kr.current,Fr(Kr,W?_&1|2:_&1),p):(zn(p),null);case 22:case 23:return Hg(),W=p.memoizedState!==null,m!==null&&m.memoizedState!==null!==W&&(p.flags|=8192),W&&(p.mode&1)!==0?(ll&1073741824)!==0&&(zn(p),p.subtreeFlags&6&&(p.flags|=8192)):zn(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function sE(m,p){switch(wt(p),p.tag){case 1:return Gn(p.type)&&DA(),m=p.flags,m&65536?(p.flags=m&-65537|128,p):null;case 3:return Bl(),Br(Wn),Br(rn),nm(),m=p.flags,(m&65536)!==0&&(m&128)===0?(p.flags=m&-65537|128,p):null;case 5:return rm(p),null;case 13:if(Br(Kr),m=p.memoizedState,m!==null&&m.dehydrated!==null){if(p.alternate===null)throw Error(r(340));tr()}return m=p.flags,m&65536?(p.flags=m&-65537|128,p):null;case 19:return Br(Kr),null;case 4:return Bl(),null;case 10:return Kn(p.type._context),null;case 22:case 23:return Hg(),null;case 24:return null;default:return null}}var dp=!1,Yn=!1,rE=typeof WeakSet=="function"?WeakSet:Set,ks=null;function GA(m,p){var _=m.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(W){_a(m,p,W)}else _.current=null}function Eg(m,p,_){try{_()}catch(W){_a(m,p,W)}}var C1=!1;function aE(m,p){if(Lu=ea,m=Cu(),jc(m)){if("selectionStart"in m)var _={start:m.selectionStart,end:m.selectionEnd};else e:{_=(_=m.ownerDocument)&&_.defaultView||window;var W=_.getSelection&&_.getSelection();if(W&&W.rangeCount!==0){_=W.anchorNode;var ae=W.anchorOffset,me=W.focusNode;W=W.focusOffset;try{_.nodeType,me.nodeType}catch{_=null;break e}var Re=0,At=-1,Nt=-1,Mt=0,cs=0,us=m,os=null;t:for(;;){for(var Ss;us!==_||ae!==0&&us.nodeType!==3||(At=Re+ae),us!==me||W!==0&&us.nodeType!==3||(Nt=Re+W),us.nodeType===3&&(Re+=us.nodeValue.length),(Ss=us.firstChild)!==null;)os=us,us=Ss;for(;;){if(us===m)break t;if(os===_&&++Mt===ae&&(At=Re),os===me&&++cs===W&&(Nt=Re),(Ss=us.nextSibling)!==null)break;us=os,os=us.parentNode}us=Ss}_=At===-1||Nt===-1?null:{start:At,end:Nt}}else _=null}_=_||{start:0,end:0}}else _=null;for(kc={focusedElem:m,selectionRange:_},ea=!1,ks=p;ks!==null;)if(p=ks,m=p.child,(p.subtreeFlags&1028)!==0&&m!==null)m.return=p,ks=m;else for(;ks!==null;){p=ks;try{var Bs=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(Bs!==null){var Fs=Bs.memoizedProps,Ua=Bs.memoizedState,Pt=p.stateNode,Ct=Pt.getSnapshotBeforeUpdate(p.elementType===p.type?Fs:xo(p.type,Fs),Ua);Pt.__reactInternalSnapshotBeforeUpdate=Ct}break;case 3:var Rt=p.stateNode.containerInfo;Rt.nodeType===1?Rt.textContent="":Rt.nodeType===9&&Rt.documentElement&&Rt.removeChild(Rt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ms){_a(p,p.return,ms)}if(m=p.sibling,m!==null){m.return=p.return,ks=m;break}ks=p.return}return Bs=C1,C1=!1,Bs}function cm(m,p,_){var W=p.updateQueue;if(W=W!==null?W.lastEffect:null,W!==null){var ae=W=W.next;do{if((ae.tag&m)===m){var me=ae.destroy;ae.destroy=void 0,me!==void 0&&Eg(p,_,me)}ae=ae.next}while(ae!==W)}}function up(m,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&m)===m){var W=_.create;_.destroy=W()}_=_.next}while(_!==p)}}function Fg(m){var p=m.ref;if(p!==null){var _=m.stateNode;switch(m.tag){case 5:m=_;break;default:m=_}typeof p=="function"?p(m):p.current=m}}function k1(m){var p=m.alternate;p!==null&&(m.alternate=null,k1(p)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(p=m.stateNode,p!==null&&(delete p[Cl],delete p[wd],delete p[$n],delete p[fg],delete p[pg])),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function B1(m){return m.tag===5||m.tag===3||m.tag===4}function E1(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||B1(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function Tg(m,p,_){var W=m.tag;if(W===5||W===6)m=m.stateNode,p?_.nodeType===8?_.parentNode.insertBefore(m,p):_.insertBefore(m,p):(_.nodeType===8?(p=_.parentNode,p.insertBefore(m,_)):(p=_,p.appendChild(m)),_=_._reactRootContainer,_!=null||p.onclick!==null||(p.onclick=Nd));else if(W!==4&&(m=m.child,m!==null))for(Tg(m,p,_),m=m.sibling;m!==null;)Tg(m,p,_),m=m.sibling}function Ig(m,p,_){var W=m.tag;if(W===5||W===6)m=m.stateNode,p?_.insertBefore(m,p):_.appendChild(m);else if(W!==4&&(m=m.child,m!==null))for(Ig(m,p,_),m=m.sibling;m!==null;)Ig(m,p,_),m=m.sibling}var Tn=null,go=!1;function Id(m,p,_){for(_=_.child;_!==null;)F1(m,p,_),_=_.sibling}function F1(m,p,_){if(Lr&&typeof Lr.onCommitFiberUnmount=="function")try{Lr.onCommitFiberUnmount(Ea,_)}catch{}switch(_.tag){case 5:Yn||GA(_,p);case 6:var W=Tn,ae=go;Tn=null,Id(m,p,_),Tn=W,go=ae,Tn!==null&&(go?(m=Tn,_=_.stateNode,m.nodeType===8?m.parentNode.removeChild(_):m.removeChild(_)):Tn.removeChild(_.stateNode));break;case 18:Tn!==null&&(go?(m=Tn,_=_.stateNode,m.nodeType===8?Zh(m.parentNode,_):m.nodeType===1&&Zh(m,_),Ur(m)):Zh(Tn,_.stateNode));break;case 4:W=Tn,ae=go,Tn=_.stateNode.containerInfo,go=!0,Id(m,p,_),Tn=W,go=ae;break;case 0:case 11:case 14:case 15:if(!Yn&&(W=_.updateQueue,W!==null&&(W=W.lastEffect,W!==null))){ae=W=W.next;do{var me=ae,Re=me.destroy;me=me.tag,Re!==void 0&&((me&2)!==0||(me&4)!==0)&&Eg(_,p,Re),ae=ae.next}while(ae!==W)}Id(m,p,_);break;case 1:if(!Yn&&(GA(_,p),W=_.stateNode,typeof W.componentWillUnmount=="function"))try{W.props=_.memoizedProps,W.state=_.memoizedState,W.componentWillUnmount()}catch(At){_a(_,p,At)}Id(m,p,_);break;case 21:Id(m,p,_);break;case 22:_.mode&1?(Yn=(W=Yn)||_.memoizedState!==null,Id(m,p,_),Yn=W):Id(m,p,_);break;default:Id(m,p,_)}}function T1(m){var p=m.updateQueue;if(p!==null){m.updateQueue=null;var _=m.stateNode;_===null&&(_=m.stateNode=new rE),p.forEach(function(W){var ae=hE.bind(null,m,W);_.has(W)||(_.add(W),W.then(ae,ae))})}}function vo(m,p){var _=p.deletions;if(_!==null)for(var W=0;W<_.length;W++){var ae=_[W];try{var me=m,Re=p,At=Re;e:for(;At!==null;){switch(At.tag){case 5:Tn=At.stateNode,go=!1;break e;case 3:Tn=At.stateNode.containerInfo,go=!0;break e;case 4:Tn=At.stateNode.containerInfo,go=!0;break e}At=At.return}if(Tn===null)throw Error(r(160));F1(me,Re,ae),Tn=null,go=!1;var Nt=ae.alternate;Nt!==null&&(Nt.return=null),ae.return=null}catch(Mt){_a(ae,p,Mt)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)I1(p,m),p=p.sibling}function I1(m,p){var _=m.alternate,W=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:if(vo(p,m),Jo(m),W&4){try{cm(3,m,m.return),up(3,m)}catch(Fs){_a(m,m.return,Fs)}try{cm(5,m,m.return)}catch(Fs){_a(m,m.return,Fs)}}break;case 1:vo(p,m),Jo(m),W&512&&_!==null&&GA(_,_.return);break;case 5:if(vo(p,m),Jo(m),W&512&&_!==null&&GA(_,_.return),m.flags&32){var ae=m.stateNode;try{ue(ae,"")}catch(Fs){_a(m,m.return,Fs)}}if(W&4&&(ae=m.stateNode,ae!=null)){var me=m.memoizedProps,Re=_!==null?_.memoizedProps:me,At=m.type,Nt=m.updateQueue;if(m.updateQueue=null,Nt!==null)try{At==="input"&&me.type==="radio"&&me.name!=null&&Z(ae,me),Fe(At,Re);var Mt=Fe(At,me);for(Re=0;Re<Nt.length;Re+=2){var cs=Nt[Re],us=Nt[Re+1];cs==="style"?Ze(ae,us):cs==="dangerouslySetInnerHTML"?Te(ae,us):cs==="children"?ue(ae,us):N(ae,cs,us,Mt)}switch(At){case"input":ve(ae,me);break;case"textarea":Ke(ae,me);break;case"select":var os=ae._wrapperState.wasMultiple;ae._wrapperState.wasMultiple=!!me.multiple;var Ss=me.value;Ss!=null?Me(ae,!!me.multiple,Ss,!1):os!==!!me.multiple&&(me.defaultValue!=null?Me(ae,!!me.multiple,me.defaultValue,!0):Me(ae,!!me.multiple,me.multiple?[]:"",!1))}ae[wd]=me}catch(Fs){_a(m,m.return,Fs)}}break;case 6:if(vo(p,m),Jo(m),W&4){if(m.stateNode===null)throw Error(r(162));ae=m.stateNode,me=m.memoizedProps;try{ae.nodeValue=me}catch(Fs){_a(m,m.return,Fs)}}break;case 3:if(vo(p,m),Jo(m),W&4&&_!==null&&_.memoizedState.isDehydrated)try{Ur(p.containerInfo)}catch(Fs){_a(m,m.return,Fs)}break;case 4:vo(p,m),Jo(m);break;case 13:vo(p,m),Jo(m),ae=m.child,ae.flags&8192&&(me=ae.memoizedState!==null,ae.stateNode.isHidden=me,!me||ae.alternate!==null&&ae.alternate.memoizedState!==null||(Ug=Jt())),W&4&&T1(m);break;case 22:if(cs=_!==null&&_.memoizedState!==null,m.mode&1?(Yn=(Mt=Yn)||cs,vo(p,m),Yn=Mt):vo(p,m),Jo(m),W&8192){if(Mt=m.memoizedState!==null,(m.stateNode.isHidden=Mt)&&!cs&&(m.mode&1)!==0)for(ks=m,cs=m.child;cs!==null;){for(us=ks=cs;ks!==null;){switch(os=ks,Ss=os.child,os.tag){case 0:case 11:case 14:case 15:cm(4,os,os.return);break;case 1:GA(os,os.return);var Bs=os.stateNode;if(typeof Bs.componentWillUnmount=="function"){W=os,_=os.return;try{p=W,Bs.props=p.memoizedProps,Bs.state=p.memoizedState,Bs.componentWillUnmount()}catch(Fs){_a(W,_,Fs)}}break;case 5:GA(os,os.return);break;case 22:if(os.memoizedState!==null){U1(us);continue}}Ss!==null?(Ss.return=os,ks=Ss):U1(us)}cs=cs.sibling}e:for(cs=null,us=m;;){if(us.tag===5){if(cs===null){cs=us;try{ae=us.stateNode,Mt?(me=ae.style,typeof me.setProperty=="function"?me.setProperty("display","none","important"):me.display="none"):(At=us.stateNode,Nt=us.memoizedProps.style,Re=Nt!=null&&Nt.hasOwnProperty("display")?Nt.display:null,At.style.display=tt("display",Re))}catch(Fs){_a(m,m.return,Fs)}}}else if(us.tag===6){if(cs===null)try{us.stateNode.nodeValue=Mt?"":us.memoizedProps}catch(Fs){_a(m,m.return,Fs)}}else if((us.tag!==22&&us.tag!==23||us.memoizedState===null||us===m)&&us.child!==null){us.child.return=us,us=us.child;continue}if(us===m)break e;for(;us.sibling===null;){if(us.return===null||us.return===m)break e;cs===us&&(cs=null),us=us.return}cs===us&&(cs=null),us.sibling.return=us.return,us=us.sibling}}break;case 19:vo(p,m),Jo(m),W&4&&T1(m);break;case 21:break;default:vo(p,m),Jo(m)}}function Jo(m){var p=m.flags;if(p&2){try{e:{for(var _=m.return;_!==null;){if(B1(_)){var W=_;break e}_=_.return}throw Error(r(160))}switch(W.tag){case 5:var ae=W.stateNode;W.flags&32&&(ue(ae,""),W.flags&=-33);var me=E1(m);Ig(m,me,ae);break;case 3:case 4:var Re=W.stateNode.containerInfo,At=E1(m);Tg(m,At,Re);break;default:throw Error(r(161))}}catch(Nt){_a(m,m.return,Nt)}m.flags&=-3}p&4096&&(m.flags&=-4097)}function nE(m,p,_){ks=m,L1(m)}function L1(m,p,_){for(var W=(m.mode&1)!==0;ks!==null;){var ae=ks,me=ae.child;if(ae.tag===22&&W){var Re=ae.memoizedState!==null||dp;if(!Re){var At=ae.alternate,Nt=At!==null&&At.memoizedState!==null||Yn;At=dp;var Mt=Yn;if(dp=Re,(Yn=Nt)&&!Mt)for(ks=ae;ks!==null;)Re=ks,Nt=Re.child,Re.tag===22&&Re.memoizedState!==null?P1(ae):Nt!==null?(Nt.return=Re,ks=Nt):P1(ae);for(;me!==null;)ks=me,L1(me),me=me.sibling;ks=ae,dp=At,Yn=Mt}D1(m)}else(ae.subtreeFlags&8772)!==0&&me!==null?(me.return=ae,ks=me):D1(m)}}function D1(m){for(;ks!==null;){var p=ks;if((p.flags&8772)!==0){var _=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Yn||up(5,p);break;case 1:var W=p.stateNode;if(p.flags&4&&!Yn)if(_===null)W.componentDidMount();else{var ae=p.elementType===p.type?_.memoizedProps:xo(p.type,_.memoizedProps);W.componentDidUpdate(ae,_.memoizedState,W.__reactInternalSnapshotBeforeUpdate)}var me=p.updateQueue;me!==null&&Ic(p,me,W);break;case 3:var Re=p.updateQueue;if(Re!==null){if(_=null,p.child!==null)switch(p.child.tag){case 5:_=p.child.stateNode;break;case 1:_=p.child.stateNode}Ic(p,Re,_)}break;case 5:var At=p.stateNode;if(_===null&&p.flags&4){_=At;var Nt=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Nt.autoFocus&&_.focus();break;case"img":Nt.src&&(_.src=Nt.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var Mt=p.alternate;if(Mt!==null){var cs=Mt.memoizedState;if(cs!==null){var us=cs.dehydrated;us!==null&&Ur(us)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Yn||p.flags&512&&Fg(p)}catch(os){_a(p,p.return,os)}}if(p===m){ks=null;break}if(_=p.sibling,_!==null){_.return=p.return,ks=_;break}ks=p.return}}function U1(m){for(;ks!==null;){var p=ks;if(p===m){ks=null;break}var _=p.sibling;if(_!==null){_.return=p.return,ks=_;break}ks=p.return}}function P1(m){for(;ks!==null;){var p=ks;try{switch(p.tag){case 0:case 11:case 15:var _=p.return;try{up(4,p)}catch(Nt){_a(p,_,Nt)}break;case 1:var W=p.stateNode;if(typeof W.componentDidMount=="function"){var ae=p.return;try{W.componentDidMount()}catch(Nt){_a(p,ae,Nt)}}var me=p.return;try{Fg(p)}catch(Nt){_a(p,me,Nt)}break;case 5:var Re=p.return;try{Fg(p)}catch(Nt){_a(p,Re,Nt)}}}catch(Nt){_a(p,p.return,Nt)}if(p===m){ks=null;break}var At=p.sibling;if(At!==null){At.return=p.return,ks=At;break}ks=p.return}}var iE=Math.ceil,Ap=S.ReactCurrentDispatcher,Lg=S.ReactCurrentOwner,Tl=S.ReactCurrentBatchConfig,br=0,vn=null,Xa=null,In=0,ll=0,KA=rl(0),nn=0,dm=null,Qu=0,hp=0,Dg=0,um=null,qi=null,Ug=0,zA=1/0,Uc=null,mp=!1,Pg=null,Ld=null,fp=!1,Dd=null,pp=0,Am=0,Rg=null,xp=-1,gp=0;function Ci(){return(br&6)!==0?Jt():xp!==-1?xp:xp=Jt()}function Ud(m){return(m.mode&1)===0?1:(br&2)!==0&&In!==0?In&-In:Tr.transition!==null?(gp===0&&(gp=Nr()),gp):(m=or,m!==0||(m=window.event,m=m===void 0?16:Gr(m.type)),m)}function bo(m,p,_,W){if(50<Am)throw Am=0,Rg=null,Error(r(185));bl(m,_,W),((br&2)===0||m!==vn)&&(m===vn&&((br&2)===0&&(hp|=_),nn===4&&Pd(m,In)),Vi(m,W),_===1&&br===0&&(p.mode&1)===0&&(zA=Jt()+500,Uu&&fe()))}function Vi(m,p){var _=m.callbackNode;Fa(m,p);var W=Wa(m,m===vn?In:0);if(W===0)_!==null&&rs(_),m.callbackNode=null,m.callbackPriority=0;else if(p=W&-W,m.callbackPriority!==p){if(_!=null&&rs(_),p===1)m.tag===0?ie(O1.bind(null,m)):K(O1.bind(null,m)),hg(function(){(br&6)===0&&fe()}),_=null;else{switch(Jl(W)){case 1:_=Os;break;case 4:_=lr;break;case 16:_=zs;break;case 536870912:_=dn;break;default:_=zs}_=G1(_,R1.bind(null,m))}m.callbackPriority=p,m.callbackNode=_}}function R1(m,p){if(xp=-1,gp=0,(br&6)!==0)throw Error(r(327));var _=m.callbackNode;if(YA()&&m.callbackNode!==_)return null;var W=Wa(m,m===vn?In:0);if(W===0)return null;if((W&30)!==0||(W&m.expiredLanes)!==0||p)p=vp(m,W);else{p=W;var ae=br;br|=2;var me=M1();(vn!==m||In!==p)&&(Uc=null,zA=Jt()+500,Hu(m,p));do try{cE();break}catch(At){Q1(m,At)}while(!0);an(),Ap.current=me,br=ae,Xa!==null?p=0:(vn=null,In=0,p=nn)}if(p!==0){if(p===2&&(ae=Xl(m),ae!==0&&(W=ae,p=Og(m,ae))),p===1)throw _=dm,Hu(m,0),Pd(m,W),Vi(m,Jt()),_;if(p===6)Pd(m,W);else{if(ae=m.current.alternate,(W&30)===0&&!lE(ae)&&(p=vp(m,W),p===2&&(me=Xl(m),me!==0&&(W=me,p=Og(m,me))),p===1))throw _=dm,Hu(m,0),Pd(m,W),Vi(m,Jt()),_;switch(m.finishedWork=ae,m.finishedLanes=W,p){case 0:case 1:throw Error(r(345));case 2:qu(m,qi,Uc);break;case 3:if(Pd(m,W),(W&130023424)===W&&(p=Ug+500-Jt(),10<p)){if(Wa(m,0)!==0)break;if(ae=m.suspendedLanes,(ae&W)!==W){Ci(),m.pingedLanes|=m.suspendedLanes&ae;break}m.timeoutHandle=Jh(qu.bind(null,m,qi,Uc),p);break}qu(m,qi,Uc);break;case 4:if(Pd(m,W),(W&4194240)===W)break;for(p=m.eventTimes,ae=-1;0<W;){var Re=31-mr(W);me=1<<Re,Re=p[Re],Re>ae&&(ae=Re),W&=~me}if(W=ae,W=Jt()-W,W=(120>W?120:480>W?480:1080>W?1080:1920>W?1920:3e3>W?3e3:4320>W?4320:1960*iE(W/1960))-W,10<W){m.timeoutHandle=Jh(qu.bind(null,m,qi,Uc),W);break}qu(m,qi,Uc);break;case 5:qu(m,qi,Uc);break;default:throw Error(r(329))}}}return Vi(m,Jt()),m.callbackNode===_?R1.bind(null,m):null}function Og(m,p){var _=um;return m.current.memoizedState.isDehydrated&&(Hu(m,p).flags|=256),m=vp(m,p),m!==2&&(p=qi,qi=_,p!==null&&Qg(p)),m}function Qg(m){qi===null?qi=m:qi.push.apply(qi,m)}function lE(m){for(var p=m;;){if(p.flags&16384){var _=p.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var W=0;W<_.length;W++){var ae=_[W],me=ae.getSnapshot;ae=ae.value;try{if(!vr(me(),ae))return!1}catch{return!1}}}if(_=p.child,p.subtreeFlags&16384&&_!==null)_.return=p,p=_;else{if(p===m)break;for(;p.sibling===null;){if(p.return===null||p.return===m)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Pd(m,p){for(p&=~Dg,p&=~hp,m.suspendedLanes|=p,m.pingedLanes&=~p,m=m.expirationTimes;0<p;){var _=31-mr(p),W=1<<_;m[_]=-1,p&=~W}}function O1(m){if((br&6)!==0)throw Error(r(327));YA();var p=Wa(m,0);if((p&1)===0)return Vi(m,Jt()),null;var _=vp(m,p);if(m.tag!==0&&_===2){var W=Xl(m);W!==0&&(p=W,_=Og(m,W))}if(_===1)throw _=dm,Hu(m,0),Pd(m,p),Vi(m,Jt()),_;if(_===6)throw Error(r(345));return m.finishedWork=m.current.alternate,m.finishedLanes=p,qu(m,qi,Uc),Vi(m,Jt()),null}function Mg(m,p){var _=br;br|=1;try{return m(p)}finally{br=_,br===0&&(zA=Jt()+500,Uu&&fe())}}function Mu(m){Dd!==null&&Dd.tag===0&&(br&6)===0&&YA();var p=br;br|=1;var _=Tl.transition,W=or;try{if(Tl.transition=null,or=1,m)return m()}finally{or=W,Tl.transition=_,br=p,(br&6)===0&&fe()}}function Hg(){ll=KA.current,Br(KA)}function Hu(m,p){m.finishedWork=null,m.finishedLanes=0;var _=m.timeoutHandle;if(_!==-1&&(m.timeoutHandle=-1,Xf(_)),Xa!==null)for(_=Xa.return;_!==null;){var W=_;switch(wt(W),W.tag){case 1:W=W.type.childContextTypes,W!=null&&DA();break;case 3:Bl(),Br(Wn),Br(rn),nm();break;case 5:rm(W);break;case 4:Bl();break;case 13:Br(Kr);break;case 19:Br(Kr);break;case 10:Kn(W.type._context);break;case 22:case 23:Hg()}_=_.return}if(vn=m,Xa=m=Rd(m.current,null),In=ll=p,nn=0,dm=null,Dg=hp=Qu=0,qi=um=null,ji!==null){for(p=0;p<ji.length;p++)if(_=ji[p],W=_.interleaved,W!==null){_.interleaved=null;var ae=W.next,me=_.pending;if(me!==null){var Re=me.next;me.next=ae,W.next=Re}_.pending=W}ji=null}return m}function Q1(m,p){do{var _=Xa;try{if(an(),PA.current=ip,Ed){for(var W=Xr.memoizedState;W!==null;){var ae=W.queue;ae!==null&&(ae.pending=null),W=W.next}Ed=!1}if(El=0,pa=wa=Xr=null,fo=!1,Fd=0,Lg.current=null,_===null||_.return===null){nn=1,dm=p,Xa=null;break}e:{var me=m,Re=_.return,At=_,Nt=p;if(p=In,At.flags|=32768,Nt!==null&&typeof Nt=="object"&&typeof Nt.then=="function"){var Mt=Nt,cs=At,us=cs.tag;if((cs.mode&1)===0&&(us===0||us===11||us===15)){var os=cs.alternate;os?(cs.updateQueue=os.updateQueue,cs.memoizedState=os.memoizedState,cs.lanes=os.lanes):(cs.updateQueue=null,cs.memoizedState=null)}var Ss=u1(Re);if(Ss!==null){Ss.flags&=-257,A1(Ss,Re,At,me,p),Ss.mode&1&&d1(me,Mt,p),p=Ss,Nt=Mt;var Bs=p.updateQueue;if(Bs===null){var Fs=new Set;Fs.add(Nt),p.updateQueue=Fs}else Bs.add(Nt);break e}else{if((p&1)===0){d1(me,Mt,p),qg();break e}Nt=Error(r(426))}}else if(Wt&&At.mode&1){var Ua=u1(Re);if(Ua!==null){(Ua.flags&65536)===0&&(Ua.flags|=256),A1(Ua,Re,At,me,p),Er(WA(Nt,At));break e}}me=Nt=WA(Nt,At),nn!==4&&(nn=2),um===null?um=[me]:um.push(me),me=Re;do{switch(me.tag){case 3:me.flags|=65536,p&=-p,me.lanes|=p;var Pt=o1(me,Nt,p);Mi(me,Pt);break e;case 1:At=Nt;var Ct=me.type,Rt=me.stateNode;if((me.flags&128)===0&&(typeof Ct.getDerivedStateFromError=="function"||Rt!==null&&typeof Rt.componentDidCatch=="function"&&(Ld===null||!Ld.has(Rt)))){me.flags|=65536,p&=-p,me.lanes|=p;var ms=c1(me,At,p);Mi(me,ms);break e}}me=me.return}while(me!==null)}q1(_)}catch(Is){p=Is,Xa===_&&_!==null&&(Xa=_=_.return);continue}break}while(!0)}function M1(){var m=Ap.current;return Ap.current=ip,m===null?ip:m}function qg(){(nn===0||nn===3||nn===2)&&(nn=4),vn===null||(Qu&268435455)===0&&(hp&268435455)===0||Pd(vn,In)}function vp(m,p){var _=br;br|=2;var W=M1();(vn!==m||In!==p)&&(Uc=null,Hu(m,p));do try{oE();break}catch(ae){Q1(m,ae)}while(!0);if(an(),br=_,Ap.current=W,Xa!==null)throw Error(r(261));return vn=null,In=0,nn}function oE(){for(;Xa!==null;)H1(Xa)}function cE(){for(;Xa!==null&&!As();)H1(Xa)}function H1(m){var p=W1(m.alternate,m,ll);m.memoizedProps=m.pendingProps,p===null?q1(m):Xa=p,Lg.current=null}function q1(m){var p=m;do{var _=p.alternate;if(m=p.return,(p.flags&32768)===0){if(_=tE(_,p,ll),_!==null){Xa=_;return}}else{if(_=sE(_,p),_!==null){_.flags&=32767,Xa=_;return}if(m!==null)m.flags|=32768,m.subtreeFlags=0,m.deletions=null;else{nn=6,Xa=null;return}}if(p=p.sibling,p!==null){Xa=p;return}Xa=p=m}while(p!==null);nn===0&&(nn=5)}function qu(m,p,_){var W=or,ae=Tl.transition;try{Tl.transition=null,or=1,dE(m,p,_,W)}finally{Tl.transition=ae,or=W}return null}function dE(m,p,_,W){do YA();while(Dd!==null);if((br&6)!==0)throw Error(r(327));_=m.finishedWork;var ae=m.finishedLanes;if(_===null)return null;if(m.finishedWork=null,m.finishedLanes=0,_===m.current)throw Error(r(177));m.callbackNode=null,m.callbackPriority=0;var me=_.lanes|_.childLanes;if(yu(m,me),m===vn&&(Xa=vn=null,In=0),(_.subtreeFlags&2064)===0&&(_.flags&2064)===0||fp||(fp=!0,G1(zs,function(){return YA(),null})),me=(_.flags&15990)!==0,(_.subtreeFlags&15990)!==0||me){me=Tl.transition,Tl.transition=null;var Re=or;or=1;var At=br;br|=4,Lg.current=null,aE(m,_),I1(_,m),Nc(kc),ea=!!Lu,kc=Lu=null,m.current=_,nE(_),es(),br=At,or=Re,Tl.transition=me}else m.current=_;if(fp&&(fp=!1,Dd=m,pp=ae),me=m.pendingLanes,me===0&&(Ld=null),Wr(_.stateNode),Vi(m,Jt()),p!==null)for(W=m.onRecoverableError,_=0;_<p.length;_++)ae=p[_],W(ae.value,{componentStack:ae.stack,digest:ae.digest});if(mp)throw mp=!1,m=Pg,Pg=null,m;return(pp&1)!==0&&m.tag!==0&&YA(),me=m.pendingLanes,(me&1)!==0?m===Rg?Am++:(Am=0,Rg=m):Am=0,fe(),null}function YA(){if(Dd!==null){var m=Jl(pp),p=Tl.transition,_=or;try{if(Tl.transition=null,or=16>m?16:m,Dd===null)var W=!1;else{if(m=Dd,Dd=null,pp=0,(br&6)!==0)throw Error(r(331));var ae=br;for(br|=4,ks=m.current;ks!==null;){var me=ks,Re=me.child;if((ks.flags&16)!==0){var At=me.deletions;if(At!==null){for(var Nt=0;Nt<At.length;Nt++){var Mt=At[Nt];for(ks=Mt;ks!==null;){var cs=ks;switch(cs.tag){case 0:case 11:case 15:cm(8,cs,me)}var us=cs.child;if(us!==null)us.return=cs,ks=us;else for(;ks!==null;){cs=ks;var os=cs.sibling,Ss=cs.return;if(k1(cs),cs===Mt){ks=null;break}if(os!==null){os.return=Ss,ks=os;break}ks=Ss}}}var Bs=me.alternate;if(Bs!==null){var Fs=Bs.child;if(Fs!==null){Bs.child=null;do{var Ua=Fs.sibling;Fs.sibling=null,Fs=Ua}while(Fs!==null)}}ks=me}}if((me.subtreeFlags&2064)!==0&&Re!==null)Re.return=me,ks=Re;else e:for(;ks!==null;){if(me=ks,(me.flags&2048)!==0)switch(me.tag){case 0:case 11:case 15:cm(9,me,me.return)}var Pt=me.sibling;if(Pt!==null){Pt.return=me.return,ks=Pt;break e}ks=me.return}}var Ct=m.current;for(ks=Ct;ks!==null;){Re=ks;var Rt=Re.child;if((Re.subtreeFlags&2064)!==0&&Rt!==null)Rt.return=Re,ks=Rt;else e:for(Re=Ct;ks!==null;){if(At=ks,(At.flags&2048)!==0)try{switch(At.tag){case 0:case 11:case 15:up(9,At)}}catch(Is){_a(At,At.return,Is)}if(At===Re){ks=null;break e}var ms=At.sibling;if(ms!==null){ms.return=At.return,ks=ms;break e}ks=At.return}}if(br=ae,fe(),Lr&&typeof Lr.onPostCommitFiberRoot=="function")try{Lr.onPostCommitFiberRoot(Ea,m)}catch{}W=!0}return W}finally{or=_,Tl.transition=p}}return!1}function V1(m,p,_){p=WA(_,p),p=o1(m,p,1),m=Qi(m,p,1),p=Ci(),m!==null&&(bl(m,1,p),Vi(m,p))}function _a(m,p,_){if(m.tag===3)V1(m,m,_);else for(;p!==null;){if(p.tag===3){V1(p,m,_);break}else if(p.tag===1){var W=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof W.componentDidCatch=="function"&&(Ld===null||!Ld.has(W))){m=WA(_,m),m=c1(p,m,1),p=Qi(p,m,1),m=Ci(),p!==null&&(bl(p,1,m),Vi(p,m));break}}p=p.return}}function uE(m,p,_){var W=m.pingCache;W!==null&&W.delete(p),p=Ci(),m.pingedLanes|=m.suspendedLanes&_,vn===m&&(In&_)===_&&(nn===4||nn===3&&(In&130023424)===In&&500>Jt()-Ug?Hu(m,0):Dg|=_),Vi(m,p)}function $1(m,p){p===0&&((m.mode&1)===0?p=1:(p=fi,fi<<=1,(fi&130023424)===0&&(fi=4194304)));var _=Ci();m=_r(m,p),m!==null&&(bl(m,p,_),Vi(m,_))}function AE(m){var p=m.memoizedState,_=0;p!==null&&(_=p.retryLane),$1(m,_)}function hE(m,p){var _=0;switch(m.tag){case 13:var W=m.stateNode,ae=m.memoizedState;ae!==null&&(_=ae.retryLane);break;case 19:W=m.stateNode;break;default:throw Error(r(314))}W!==null&&W.delete(p),$1(m,_)}var W1;W1=function(m,p,_){if(m!==null)if(m.memoizedProps!==p.pendingProps||Wn.current)Hi=!0;else{if((m.lanes&_)===0&&(p.flags&128)===0)return Hi=!1,eE(m,p,_);Hi=(m.flags&131072)!==0}else Hi=!1,Wt&&(p.flags&1048576)!==0&&Zt(p,qe,p.index);switch(p.lanes=0,p.tag){case 2:var W=p.type;cp(m,p),m=p.pendingProps;var ae=Sd(p,rn.current);aa(p,_),ae=Pu(null,p,W,m,ae,_);var me=Fl();return p.flags|=1,typeof ae=="object"&&ae!==null&&typeof ae.render=="function"&&ae.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Gn(W)?(me=!0,Fc(p)):me=!1,p.memoizedState=ae.state!==null&&ae.state!==void 0?ae.state:null,UA(p),ae.updater=lp,p.stateNode=ae,ae._reactInternals=p,bg(p,W,m,_),p=wg(null,p,W,!0,me,_)):(p.tag=0,Wt&&me&&Vt(p),Si(null,p,ae,_),p=p.child),p;case 16:W=p.elementType;e:{switch(cp(m,p),m=p.pendingProps,ae=W._init,W=ae(W._payload),p.type=W,ae=p.tag=fE(W),m=xo(W,m),ae){case 0:p=Ng(null,p,W,m,_);break e;case 1:p=g1(null,p,W,m,_);break e;case 11:p=h1(null,p,W,m,_);break e;case 14:p=m1(null,p,W,xo(W.type,m),_);break e}throw Error(r(306,W,""))}return p;case 0:return W=p.type,ae=p.pendingProps,ae=p.elementType===W?ae:xo(W,ae),Ng(m,p,W,ae,_);case 1:return W=p.type,ae=p.pendingProps,ae=p.elementType===W?ae:xo(W,ae),g1(m,p,W,ae,_);case 3:e:{if(v1(p),m===null)throw Error(r(387));W=p.pendingProps,me=p.memoizedState,ae=me.element,sm(m,p),ho(p,W,null,_);var Re=p.memoizedState;if(W=Re.element,me.isDehydrated)if(me={element:W,isDehydrated:!1,cache:Re.cache,pendingSuspenseBoundaries:Re.pendingSuspenseBoundaries,transitions:Re.transitions},p.updateQueue.baseState=me,p.memoizedState=me,p.flags&256){ae=WA(Error(r(423)),p),p=b1(m,p,W,_,ae);break e}else if(W!==ae){ae=WA(Error(r(424)),p),p=b1(m,p,W,_,ae);break e}else for(Gt=En(p.stateNode.containerInfo.firstChild),_t=p,Wt=!0,zt=null,_=wr(p,null,W,_),p.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(tr(),W===ae){p=Dc(m,p,_);break e}Si(m,p,W,_)}p=p.child}return p;case 5:return tp(p),m===null&&bs(p),W=p.type,ae=p.pendingProps,me=m!==null?m.memoizedProps:null,Re=ae.children,Xh(W,ae)?Re=null:me!==null&&Xh(W,me)&&(p.flags|=32),x1(m,p),Si(m,p,Re,_),p.child;case 6:return m===null&&bs(p),null;case 13:return y1(m,p,_);case 4:return Bd(p,p.stateNode.containerInfo),W=p.pendingProps,m===null?p.child=Ia(p,null,W,_):Si(m,p,W,_),p.child;case 11:return W=p.type,ae=p.pendingProps,ae=p.elementType===W?ae:xo(W,ae),h1(m,p,W,ae,_);case 7:return Si(m,p,p.pendingProps,_),p.child;case 8:return Si(m,p,p.pendingProps.children,_),p.child;case 12:return Si(m,p,p.pendingProps.children,_),p.child;case 10:e:{if(W=p.type._context,ae=p.pendingProps,me=p.memoizedProps,Re=ae.value,Fr(xn,W._currentValue),W._currentValue=Re,me!==null)if(vr(me.value,Re)){if(me.children===ae.children&&!Wn.current){p=Dc(m,p,_);break e}}else for(me=p.child,me!==null&&(me.return=p);me!==null;){var At=me.dependencies;if(At!==null){Re=me.child;for(var Nt=At.firstContext;Nt!==null;){if(Nt.context===W){if(me.tag===1){Nt=Oi(-1,_&-_),Nt.tag=2;var Mt=me.updateQueue;if(Mt!==null){Mt=Mt.shared;var cs=Mt.pending;cs===null?Nt.next=Nt:(Nt.next=cs.next,cs.next=Nt),Mt.pending=Nt}}me.lanes|=_,Nt=me.alternate,Nt!==null&&(Nt.lanes|=_),Ri(me.return,_,p),At.lanes|=_;break}Nt=Nt.next}}else if(me.tag===10)Re=me.type===p.type?null:me.child;else if(me.tag===18){if(Re=me.return,Re===null)throw Error(r(341));Re.lanes|=_,At=Re.alternate,At!==null&&(At.lanes|=_),Ri(Re,_,p),Re=me.sibling}else Re=me.child;if(Re!==null)Re.return=me;else for(Re=me;Re!==null;){if(Re===p){Re=null;break}if(me=Re.sibling,me!==null){me.return=Re.return,Re=me;break}Re=Re.return}me=Re}Si(m,p,ae.children,_),p=p.child}return p;case 9:return ae=p.type,W=p.pendingProps.children,aa(p,_),ae=Na(ae),W=W(ae),p.flags|=1,Si(m,p,W,_),p.child;case 14:return W=p.type,ae=xo(W,p.pendingProps),ae=xo(W.type,ae),m1(m,p,W,ae,_);case 15:return f1(m,p,p.type,p.pendingProps,_);case 17:return W=p.type,ae=p.pendingProps,ae=p.elementType===W?ae:xo(W,ae),cp(m,p),p.tag=1,Gn(W)?(m=!0,Fc(p)):m=!1,aa(p,_),i1(p,W,ae),bg(p,W,ae,_),wg(null,p,W,!0,m,_);case 19:return N1(m,p,_);case 22:return p1(m,p,_)}throw Error(r(156,p.tag))};function G1(m,p){return Yt(m,p)}function mE(m,p,_,W){this.tag=m,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=W,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Il(m,p,_,W){return new mE(m,p,_,W)}function Vg(m){return m=m.prototype,!(!m||!m.isReactComponent)}function fE(m){if(typeof m=="function")return Vg(m)?1:0;if(m!=null){if(m=m.$$typeof,m===M)return 11;if(m===G)return 14}return 2}function Rd(m,p){var _=m.alternate;return _===null?(_=Il(m.tag,p,m.key,m.mode),_.elementType=m.elementType,_.type=m.type,_.stateNode=m.stateNode,_.alternate=m,m.alternate=_):(_.pendingProps=p,_.type=m.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=m.flags&14680064,_.childLanes=m.childLanes,_.lanes=m.lanes,_.child=m.child,_.memoizedProps=m.memoizedProps,_.memoizedState=m.memoizedState,_.updateQueue=m.updateQueue,p=m.dependencies,_.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},_.sibling=m.sibling,_.index=m.index,_.ref=m.ref,_}function bp(m,p,_,W,ae,me){var Re=2;if(W=m,typeof m=="function")Vg(m)&&(Re=1);else if(typeof m=="string")Re=5;else e:switch(m){case L:return Vu(_.children,ae,me,p);case U:Re=8,ae|=8;break;case H:return m=Il(12,_,p,ae|2),m.elementType=H,m.lanes=me,m;case z:return m=Il(13,_,p,ae),m.elementType=z,m.lanes=me,m;case I:return m=Il(19,_,p,ae),m.elementType=I,m.lanes=me,m;case J:return yp(_,ae,me,p);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case q:Re=10;break e;case V:Re=9;break e;case M:Re=11;break e;case G:Re=14;break e;case Y:Re=16,W=null;break e}throw Error(r(130,m==null?m:typeof m,""))}return p=Il(Re,_,p,ae),p.elementType=m,p.type=W,p.lanes=me,p}function Vu(m,p,_,W){return m=Il(7,m,W,p),m.lanes=_,m}function yp(m,p,_,W){return m=Il(22,m,W,p),m.elementType=J,m.lanes=_,m.stateNode={isHidden:!1},m}function $g(m,p,_){return m=Il(6,m,null,p),m.lanes=_,m}function Wg(m,p,_){return p=Il(4,m.children!==null?m.children:[],m.key,p),p.lanes=_,p.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},p}function pE(m,p,_,W,ae){this.tag=p,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mc(0),this.expirationTimes=mc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mc(0),this.identifierPrefix=W,this.onRecoverableError=ae,this.mutableSourceEagerHydrationData=null}function Gg(m,p,_,W,ae,me,Re,At,Nt){return m=new pE(m,p,_,At,Nt),p===1?(p=1,me===!0&&(p|=8)):p=0,me=Il(3,null,null,p),m.current=me,me.stateNode=m,me.memoizedState={element:W,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},UA(me),m}function xE(m,p,_){var W=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:W==null?null:""+W,children:m,containerInfo:p,implementation:_}}function K1(m){if(!m)return Ko;m=m._reactInternals;e:{if(Ge(m)!==m||m.tag!==1)throw Error(r(170));var p=m;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Gn(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(m.tag===1){var _=m.type;if(Gn(_))return tm(m,_,p)}return p}function z1(m,p,_,W,ae,me,Re,At,Nt){return m=Gg(_,W,!0,m,ae,me,Re,At,Nt),m.context=K1(null),_=m.current,W=Ci(),ae=Ud(_),me=Oi(W,ae),me.callback=p??null,Qi(_,me,ae),m.current.lanes=ae,bl(m,ae,W),Vi(m,W),m}function jp(m,p,_,W){var ae=p.current,me=Ci(),Re=Ud(ae);return _=K1(_),p.context===null?p.context=_:p.pendingContext=_,p=Oi(me,Re),p.payload={element:m},W=W===void 0?null:W,W!==null&&(p.callback=W),m=Qi(ae,p,Re),m!==null&&(bo(m,ae,Re,me),Tc(m,ae,Re)),Re}function Np(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 5:return m.child.stateNode;default:return m.child.stateNode}}function Y1(m,p){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var _=m.retryLane;m.retryLane=_!==0&&_<p?_:p}}function Kg(m,p){Y1(m,p),(m=m.alternate)&&Y1(m,p)}function gE(){return null}var X1=typeof reportError=="function"?reportError:function(m){console.error(m)};function zg(m){this._internalRoot=m}wp.prototype.render=zg.prototype.render=function(m){var p=this._internalRoot;if(p===null)throw Error(r(409));jp(m,p,null,null)},wp.prototype.unmount=zg.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var p=m.containerInfo;Mu(function(){jp(null,m,null,null)}),p[pn]=null}};function wp(m){this._internalRoot=m}wp.prototype.unstable_scheduleHydration=function(m){if(m){var p=xi();m={blockedOn:null,target:m,priority:p};for(var _=0;_<ts.length&&p!==0&&p<ts[_].priority;_++);ts.splice(_,0,m),_===0&&ss(m)}};function Yg(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function _p(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11&&(m.nodeType!==8||m.nodeValue!==" react-mount-point-unstable "))}function J1(){}function vE(m,p,_,W,ae){if(ae){if(typeof W=="function"){var me=W;W=function(){var Mt=Np(Re);me.call(Mt)}}var Re=z1(p,W,m,0,null,!1,!1,"",J1);return m._reactRootContainer=Re,m[pn]=Re.current,Sc(m.nodeType===8?m.parentNode:m),Mu(),Re}for(;ae=m.lastChild;)m.removeChild(ae);if(typeof W=="function"){var At=W;W=function(){var Mt=Np(Nt);At.call(Mt)}}var Nt=Gg(m,0,!1,null,null,!1,!1,"",J1);return m._reactRootContainer=Nt,m[pn]=Nt.current,Sc(m.nodeType===8?m.parentNode:m),Mu(function(){jp(p,Nt,_,W)}),Nt}function Sp(m,p,_,W,ae){var me=_._reactRootContainer;if(me){var Re=me;if(typeof ae=="function"){var At=ae;ae=function(){var Nt=Np(Re);At.call(Nt)}}jp(p,Re,m,ae)}else Re=vE(_,p,m,ae,W);return Np(Re)}Qn=function(m){switch(m.tag){case 3:var p=m.stateNode;if(p.current.memoizedState.isDehydrated){var _=pi(p.pendingLanes);_!==0&&(Ga(p,_|1),Vi(p,Jt()),(br&6)===0&&(zA=Jt()+500,fe()))}break;case 13:Mu(function(){var W=_r(m,1);if(W!==null){var ae=Ci();bo(W,m,1,ae)}}),Kg(m,1)}},Zl=function(m){if(m.tag===13){var p=_r(m,134217728);if(p!==null){var _=Ci();bo(p,m,134217728,_)}Kg(m,134217728)}},fc=function(m){if(m.tag===13){var p=Ud(m),_=_r(m,p);if(_!==null){var W=Ci();bo(_,m,p,W)}Kg(m,p)}},xi=function(){return or},yl=function(m,p){var _=or;try{return or=m,p()}finally{or=_}},Xe=function(m,p,_){switch(p){case"input":if(ve(m,_),p=_.name,_.type==="radio"&&p!=null){for(_=m;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<_.length;p++){var W=_[p];if(W!==m&&W.form===m.form){var ae=Du(W);if(!ae)throw Error(r(90));re(W),ve(W,ae)}}}break;case"textarea":Ke(m,_);break;case"select":p=_.value,p!=null&&Me(m,!!_.multiple,p,!1)}},Ot=Mg,Ae=Mu;var bE={usingClientEntryPoint:!1,Events:[_d,Bc,Du,pt,vt,Mg]},hm={findFiberByHostInstance:Go,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yE={bundleType:hm.bundleType,version:hm.version,rendererPackageName:hm.rendererPackageName,rendererConfig:hm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:S.ReactCurrentDispatcher,findHostInstanceByFiber:function(m){return m=Et(m),m===null?null:m.stateNode},findFiberByHostInstance:hm.findFiberByHostInstance||gE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cp.isDisabled&&Cp.supportsFiber)try{Ea=Cp.inject(yE),Lr=Cp}catch{}}return $i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bE,$i.createPortal=function(m,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yg(p))throw Error(r(200));return xE(m,p,null,_)},$i.createRoot=function(m,p){if(!Yg(m))throw Error(r(299));var _=!1,W="",ae=X1;return p!=null&&(p.unstable_strictMode===!0&&(_=!0),p.identifierPrefix!==void 0&&(W=p.identifierPrefix),p.onRecoverableError!==void 0&&(ae=p.onRecoverableError)),p=Gg(m,1,!1,null,null,_,!1,W,ae),m[pn]=p.current,Sc(m.nodeType===8?m.parentNode:m),new zg(p)},$i.findDOMNode=function(m){if(m==null)return null;if(m.nodeType===1)return m;var p=m._reactInternals;if(p===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=Et(p),m=m===null?null:m.stateNode,m},$i.flushSync=function(m){return Mu(m)},$i.hydrate=function(m,p,_){if(!_p(p))throw Error(r(200));return Sp(null,m,p,!0,_)},$i.hydrateRoot=function(m,p,_){if(!Yg(m))throw Error(r(405));var W=_!=null&&_.hydratedSources||null,ae=!1,me="",Re=X1;if(_!=null&&(_.unstable_strictMode===!0&&(ae=!0),_.identifierPrefix!==void 0&&(me=_.identifierPrefix),_.onRecoverableError!==void 0&&(Re=_.onRecoverableError)),p=z1(p,null,m,1,_??null,ae,!1,me,Re),m[pn]=p.current,Sc(m),W)for(m=0;m<W.length;m++)_=W[m],ae=_._getVersion,ae=ae(_._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[_,ae]:p.mutableSourceEagerHydrationData.push(_,ae);return new wp(p)},$i.render=function(m,p,_){if(!_p(p))throw Error(r(200));return Sp(null,m,p,!1,_)},$i.unmountComponentAtNode=function(m){if(!_p(m))throw Error(r(40));return m._reactRootContainer?(Mu(function(){Sp(null,null,m,!1,function(){m._reactRootContainer=null,m[pn]=null})}),!0):!1},$i.unstable_batchedUpdates=Mg,$i.unstable_renderSubtreeIntoContainer=function(m,p,_,W){if(!_p(_))throw Error(r(200));if(m==null||m._reactInternals===void 0)throw Error(r(38));return Sp(m,p,_,!1,W)},$i.version="18.3.1-next-f1338f8080-20240426",$i}var iN;function $S(){if(iN)return ev.exports;iN=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),ev.exports=TE(),ev.exports}var lN;function IE(){if(lN)return kp;lN=1;var t=$S();return kp.createRoot=t.createRoot,kp.hydrateRoot=t.hydrateRoot,kp}var LE=IE();const DE=Iy(LE);$S();/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rf(){return rf=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},rf.apply(this,arguments)}var Yd;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Yd||(Yd={}));const oN="popstate";function UE(t){t===void 0&&(t={});function s(a,n){let{pathname:i,search:l,hash:o}=a.location;return vb("",{pathname:i,search:l,hash:o},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:Px(n)}return RE(s,r,null,t)}function va(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Ly(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function PE(){return Math.random().toString(36).substr(2,8)}function cN(t,s){return{usr:t.state,key:t.key,idx:s}}function vb(t,s,r,a){return r===void 0&&(r=null),rf({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?Oh(s):s,{state:r,key:s&&s.key||a||PE()})}function Px(t){let{pathname:s="/",search:r="",hash:a=""}=t;return r&&r!=="?"&&(s+=r.charAt(0)==="?"?r:"?"+r),a&&a!=="#"&&(s+=a.charAt(0)==="#"?a:"#"+a),s}function Oh(t){let s={};if(t){let r=t.indexOf("#");r>=0&&(s.hash=t.substr(r),t=t.substr(0,r));let a=t.indexOf("?");a>=0&&(s.search=t.substr(a),t=t.substr(0,a)),t&&(s.pathname=t)}return s}function RE(t,s,r,a){a===void 0&&(a={});let{window:n=document.defaultView,v5Compat:i=!1}=a,l=n.history,o=Yd.Pop,u=null,d=c();d==null&&(d=0,l.replaceState(rf({},l.state,{idx:d}),""));function c(){return(l.state||{idx:null}).idx}function h(){o=Yd.Pop;let b=c(),y=b==null?null:b-d;d=b,u&&u({action:o,location:v.location,delta:y})}function A(b,y){o=Yd.Push;let j=vb(v.location,b,y);d=c()+1;let N=cN(j,d),S=v.createHref(j);try{l.pushState(N,"",S)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;n.location.assign(S)}i&&u&&u({action:o,location:v.location,delta:1})}function f(b,y){o=Yd.Replace;let j=vb(v.location,b,y);d=c();let N=cN(j,d),S=v.createHref(j);l.replaceState(N,"",S),i&&u&&u({action:o,location:v.location,delta:0})}function g(b){let y=n.location.origin!=="null"?n.location.origin:n.location.href,j=typeof b=="string"?b:Px(b);return j=j.replace(/ $/,"%20"),va(y,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,y)}let v={get action(){return o},get location(){return t(n,l)},listen(b){if(u)throw new Error("A history only accepts one active listener");return n.addEventListener(oN,h),u=b,()=>{n.removeEventListener(oN,h),u=null}},createHref(b){return s(n,b)},createURL:g,encodeLocation(b){let y=g(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:A,replace:f,go(b){return l.go(b)}};return v}var dN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(dN||(dN={}));function OE(t,s,r){return r===void 0&&(r="/"),QE(t,s,r)}function QE(t,s,r,a){let n=typeof s=="string"?Oh(s):s,i=Eh(n.pathname||"/",r);if(i==null)return null;let l=WS(t);ME(l);let o=null;for(let u=0;o==null&&u<l.length;++u){let d=JE(i);o=YE(l[u],d)}return o}function WS(t,s,r,a){s===void 0&&(s=[]),r===void 0&&(r=[]),a===void 0&&(a="");let n=(i,l,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};u.relativePath.startsWith("/")&&(va(u.relativePath.startsWith(a),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(a.length));let d=nu([a,u.relativePath]),c=r.concat(u);i.children&&i.children.length>0&&(va(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),WS(i.children,s,c,d)),!(i.path==null&&!i.index)&&s.push({path:d,score:KE(d,i.index),routesMeta:c})};return t.forEach((i,l)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))n(i,l);else for(let u of GS(i.path))n(i,l,u)}),s}function GS(t){let s=t.split("/");if(s.length===0)return[];let[r,...a]=s,n=r.endsWith("?"),i=r.replace(/\?$/,"");if(a.length===0)return n?[i,""]:[i];let l=GS(a.join("/")),o=[];return o.push(...l.map(u=>u===""?i:[i,u].join("/"))),n&&o.push(...l),o.map(u=>t.startsWith("/")&&u===""?"/":u)}function ME(t){t.sort((s,r)=>s.score!==r.score?r.score-s.score:zE(s.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}const HE=/^:[\w-]+$/,qE=3,VE=2,$E=1,WE=10,GE=-2,uN=t=>t==="*";function KE(t,s){let r=t.split("/"),a=r.length;return r.some(uN)&&(a+=GE),s&&(a+=VE),r.filter(n=>!uN(n)).reduce((n,i)=>n+(HE.test(i)?qE:i===""?$E:WE),a)}function zE(t,s){return t.length===s.length&&t.slice(0,-1).every((a,n)=>a===s[n])?t[t.length-1]-s[s.length-1]:0}function YE(t,s,r){let{routesMeta:a}=t,n={},i="/",l=[];for(let o=0;o<a.length;++o){let u=a[o],d=o===a.length-1,c=i==="/"?s:s.slice(i.length)||"/",h=bb({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},c),A=u.route;if(!h)return null;Object.assign(n,h.params),l.push({params:n,pathname:nu([i,h.pathname]),pathnameBase:rF(nu([i,h.pathnameBase])),route:A}),h.pathnameBase!=="/"&&(i=nu([i,h.pathnameBase]))}return l}function bb(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,a]=XE(t.path,t.caseSensitive,t.end),n=s.match(r);if(!n)return null;let i=n[0],l=i.replace(/(.)\/+$/,"$1"),o=n.slice(1);return{params:a.reduce((d,c,h)=>{let{paramName:A,isOptional:f}=c;if(A==="*"){let v=o[h]||"";l=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=o[h];return f&&!g?d[A]=void 0:d[A]=(g||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:l,pattern:t}}function XE(t,s,r){s===void 0&&(s=!1),r===void 0&&(r=!0),Ly(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let a=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,o,u)=>(a.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(a.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,s?void 0:"i"),a]}function JE(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Ly(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function Eh(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,a=t.charAt(r);return a&&a!=="/"?null:t.slice(r)||"/"}const ZE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,eF=t=>ZE.test(t);function tF(t,s){s===void 0&&(s="/");let{pathname:r,search:a="",hash:n=""}=typeof t=="string"?Oh(t):t,i;if(r)if(eF(r))i=r;else{if(r.includes("//")){let l=r;r=r.replace(/\/\/+/g,"/"),Ly(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+r))}r.startsWith("/")?i=AN(r.substring(1),"/"):i=AN(r,s)}else i=s;return{pathname:i,search:aF(a),hash:nF(n)}}function AN(t,s){let r=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function rv(t,s,r,a){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function sF(t){return t.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function Dy(t,s){let r=sF(t);return s?r.map((a,n)=>n===r.length-1?a.pathname:a.pathnameBase):r.map(a=>a.pathnameBase)}function Uy(t,s,r,a){a===void 0&&(a=!1);let n;typeof t=="string"?n=Oh(t):(n=rf({},t),va(!n.pathname||!n.pathname.includes("?"),rv("?","pathname","search",n)),va(!n.pathname||!n.pathname.includes("#"),rv("#","pathname","hash",n)),va(!n.search||!n.search.includes("#"),rv("#","search","hash",n)));let i=t===""||n.pathname==="",l=i?"/":n.pathname,o;if(l==null)o=r;else{let h=s.length-1;if(!a&&l.startsWith("..")){let A=l.split("/");for(;A[0]==="..";)A.shift(),h-=1;n.pathname=A.join("/")}o=h>=0?s[h]:"/"}let u=tF(n,o),d=l&&l!=="/"&&l.endsWith("/"),c=(i||l===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||c)&&(u.pathname+="/"),u}const nu=t=>t.join("/").replace(/\/\/+/g,"/"),rF=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),aF=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,nF=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function iF(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const KS=["post","put","patch","delete"];new Set(KS);const lF=["get",...KS];new Set(lF);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function af(){return af=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},af.apply(this,arguments)}const j0=x.createContext(null),zS=x.createContext(null),ed=x.createContext(null),N0=x.createContext(null),td=x.createContext({outlet:null,matches:[],isDataRoute:!1}),YS=x.createContext(null);function oF(t,s){let{relative:r}=s===void 0?{}:s;Qh()||va(!1);let{basename:a,navigator:n}=x.useContext(ed),{hash:i,pathname:l,search:o}=w0(t,{relative:r}),u=l;return a!=="/"&&(u=l==="/"?a:nu([a,l])),n.createHref({pathname:u,search:o,hash:i})}function Qh(){return x.useContext(N0)!=null}function ma(){return Qh()||va(!1),x.useContext(N0).location}function XS(t){x.useContext(ed).static||x.useLayoutEffect(t)}function ys(){let{isDataRoute:t}=x.useContext(td);return t?yF():cF()}function cF(){Qh()||va(!1);let t=x.useContext(j0),{basename:s,future:r,navigator:a}=x.useContext(ed),{matches:n}=x.useContext(td),{pathname:i}=ma(),l=JSON.stringify(Dy(n,r.v7_relativeSplatPath)),o=x.useRef(!1);return XS(()=>{o.current=!0}),x.useCallback(function(d,c){if(c===void 0&&(c={}),!o.current)return;if(typeof d=="number"){a.go(d);return}let h=Uy(d,JSON.parse(l),i,c.relative==="path");t==null&&s!=="/"&&(h.pathname=h.pathname==="/"?s:nu([s,h.pathname])),(c.replace?a.replace:a.push)(h,c.state,c)},[s,a,l,i,t])}function Ls(){let{matches:t}=x.useContext(td),s=t[t.length-1];return s?s.params:{}}function w0(t,s){let{relative:r}=s===void 0?{}:s,{future:a}=x.useContext(ed),{matches:n}=x.useContext(td),{pathname:i}=ma(),l=JSON.stringify(Dy(n,a.v7_relativeSplatPath));return x.useMemo(()=>Uy(t,JSON.parse(l),i,r==="path"),[t,l,i,r])}function dF(t,s){return uF(t,s)}function uF(t,s,r,a){Qh()||va(!1);let{navigator:n}=x.useContext(ed),{matches:i}=x.useContext(td),l=i[i.length-1],o=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let d=ma(),c;if(s){var h;let b=typeof s=="string"?Oh(s):s;u==="/"||(h=b.pathname)!=null&&h.startsWith(u)||va(!1),c=b}else c=d;let A=c.pathname||"/",f=A;if(u!=="/"){let b=u.replace(/^\//,"").split("/");f="/"+A.replace(/^\//,"").split("/").slice(b.length).join("/")}let g=OE(t,{pathname:f}),v=pF(g&&g.map(b=>Object.assign({},b,{params:Object.assign({},o,b.params),pathname:nu([u,n.encodeLocation?n.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?u:nu([u,n.encodeLocation?n.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),i,r,a);return s&&v?x.createElement(N0.Provider,{value:{location:af({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Yd.Pop}},v):v}function AF(){let t=bF(),s=iF(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},s),r?x.createElement("pre",{style:n},r):null,null)}const hF=x.createElement(AF,null);class mF extends x.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,r){return r.location!==s.location||r.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:r.error,location:r.location,revalidation:s.revalidation||r.revalidation}}componentDidCatch(s,r){console.error("React Router caught the following error during render",s,r)}render(){return this.state.error!==void 0?x.createElement(td.Provider,{value:this.props.routeContext},x.createElement(YS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function fF(t){let{routeContext:s,match:r,children:a}=t,n=x.useContext(j0);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(td.Provider,{value:s},a)}function pF(t,s,r,a){var n;if(s===void 0&&(s=[]),r===void 0&&(r=null),a===void 0&&(a=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=a)!=null&&i.v7_partialHydration&&s.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let l=t,o=(n=r)==null?void 0:n.errors;if(o!=null){let c=l.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);c>=0||va(!1),l=l.slice(0,Math.min(l.length,c+1))}let u=!1,d=-1;if(r&&a&&a.v7_partialHydration)for(let c=0;c<l.length;c++){let h=l[c];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=c),h.route.id){let{loaderData:A,errors:f}=r,g=h.route.loader&&A[h.route.id]===void 0&&(!f||f[h.route.id]===void 0);if(h.route.lazy||g){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((c,h,A)=>{let f,g=!1,v=null,b=null;r&&(f=o&&h.route.id?o[h.route.id]:void 0,v=h.route.errorElement||hF,u&&(d<0&&A===0?(jF("route-fallback"),g=!0,b=null):d===A&&(g=!0,b=h.route.hydrateFallbackElement||null)));let y=s.concat(l.slice(0,A+1)),j=()=>{let N;return f?N=v:g?N=b:h.route.Component?N=x.createElement(h.route.Component,null):h.route.element?N=h.route.element:N=c,x.createElement(fF,{match:h,routeContext:{outlet:c,matches:y,isDataRoute:r!=null},children:N})};return r&&(h.route.ErrorBoundary||h.route.errorElement||A===0)?x.createElement(mF,{location:r.location,revalidation:r.revalidation,component:v,error:f,children:j(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):j()},null)}var JS=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(JS||{}),ZS=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(ZS||{});function xF(t){let s=x.useContext(j0);return s||va(!1),s}function gF(t){let s=x.useContext(zS);return s||va(!1),s}function vF(t){let s=x.useContext(td);return s||va(!1),s}function eC(t){let s=vF(),r=s.matches[s.matches.length-1];return r.route.id||va(!1),r.route.id}function bF(){var t;let s=x.useContext(YS),r=gF(),a=eC();return s!==void 0?s:(t=r.errors)==null?void 0:t[a]}function yF(){let{router:t}=xF(JS.UseNavigateStable),s=eC(ZS.UseNavigateStable),r=x.useRef(!1);return XS(()=>{r.current=!0}),x.useCallback(function(n,i){i===void 0&&(i={}),r.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,af({fromRouteId:s},i)))},[t,s])}const hN={};function jF(t,s,r){hN[t]||(hN[t]=!0)}function NF(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Hc(t){let{to:s,replace:r,state:a,relative:n}=t;Qh()||va(!1);let{future:i,static:l}=x.useContext(ed),{matches:o}=x.useContext(td),{pathname:u}=ma(),d=ys(),c=Uy(s,Dy(o,i.v7_relativeSplatPath),u,n==="path"),h=JSON.stringify(c);return x.useEffect(()=>d(JSON.parse(h),{replace:r,state:a,relative:n}),[d,h,n,r,a]),null}function Je(t){va(!1)}function wF(t){let{basename:s="/",children:r=null,location:a,navigationType:n=Yd.Pop,navigator:i,static:l=!1,future:o}=t;Qh()&&va(!1);let u=s.replace(/^\/*/,"/"),d=x.useMemo(()=>({basename:u,navigator:i,static:l,future:af({v7_relativeSplatPath:!1},o)}),[u,o,i,l]);typeof a=="string"&&(a=Oh(a));let{pathname:c="/",search:h="",hash:A="",state:f=null,key:g="default"}=a,v=x.useMemo(()=>{let b=Eh(c,u);return b==null?null:{location:{pathname:b,search:h,hash:A,state:f,key:g},navigationType:n}},[u,c,h,A,f,g,n]);return v==null?null:x.createElement(ed.Provider,{value:d},x.createElement(N0.Provider,{children:r,value:v}))}function Ji(t){let{children:s,location:r}=t;return dF(yb(s),r)}new Promise(()=>{});function yb(t,s){s===void 0&&(s=[]);let r=[];return x.Children.forEach(t,(a,n)=>{if(!x.isValidElement(a))return;let i=[...s,n];if(a.type===x.Fragment){r.push.apply(r,yb(a.props.children,i));return}a.type!==Je&&va(!1),!a.props.index||!a.props.children||va(!1);let l={id:a.props.id||i.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(l.children=yb(a.props.children,i)),r.push(l)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rx(){return Rx=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Rx.apply(this,arguments)}function tC(t,s){if(t==null)return{};var r={},a=Object.keys(t),n,i;for(i=0;i<a.length;i++)n=a[i],!(s.indexOf(n)>=0)&&(r[n]=t[n]);return r}function _F(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function SF(t,s){return t.button===0&&(!s||s==="_self")&&!_F(t)}function jb(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((s,r)=>{let a=t[r];return s.concat(Array.isArray(a)?a.map(n=>[r,n]):[[r,a]])},[]))}function CF(t,s){let r=jb(t);return s&&s.forEach((a,n)=>{r.has(n)||s.getAll(n).forEach(i=>{r.append(n,i)})}),r}const kF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],BF=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],EF="6";try{window.__reactRouterVersion=EF}catch{}const FF=x.createContext({isTransitioning:!1}),TF="startTransition",mN=BE[TF];function IF(t){let{basename:s,children:r,future:a,window:n}=t,i=x.useRef();i.current==null&&(i.current=UE({window:n,v5Compat:!0}));let l=i.current,[o,u]=x.useState({action:l.action,location:l.location}),{v7_startTransition:d}=a||{},c=x.useCallback(h=>{d&&mN?mN(()=>u(h)):u(h)},[u,d]);return x.useLayoutEffect(()=>l.listen(c),[l,c]),x.useEffect(()=>NF(a),[a]),x.createElement(wF,{basename:s,children:r,location:o.location,navigationType:o.action,navigator:l,future:a})}const LF=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",DF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Le=x.forwardRef(function(s,r){let{onClick:a,relative:n,reloadDocument:i,replace:l,state:o,target:u,to:d,preventScrollReset:c,viewTransition:h}=s,A=tC(s,kF),{basename:f}=x.useContext(ed),g,v=!1;if(typeof d=="string"&&DF.test(d)&&(g=d,LF))try{let N=new URL(window.location.href),S=d.startsWith("//")?new URL(N.protocol+d):new URL(d),B=Eh(S.pathname,f);S.origin===N.origin&&B!=null?d=B+S.search+S.hash:v=!0}catch{}let b=oF(d,{relative:n}),y=PF(d,{replace:l,state:o,target:u,preventScrollReset:c,relative:n,viewTransition:h});function j(N){a&&a(N),N.defaultPrevented||y(N)}return x.createElement("a",Rx({},A,{href:g||b,onClick:v||i?a:j,ref:r,target:u}))}),fN=x.forwardRef(function(s,r){let{"aria-current":a="page",caseSensitive:n=!1,className:i="",end:l=!1,style:o,to:u,viewTransition:d,children:c}=s,h=tC(s,BF),A=w0(u,{relative:h.relative}),f=ma(),g=x.useContext(zS),{navigator:v,basename:b}=x.useContext(ed),y=g!=null&&RF(A)&&d===!0,j=v.encodeLocation?v.encodeLocation(A).pathname:A.pathname,N=f.pathname,S=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;n||(N=N.toLowerCase(),S=S?S.toLowerCase():null,j=j.toLowerCase()),S&&b&&(S=Eh(S,b)||S);const B=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let P=N===j||!l&&N.startsWith(j)&&N.charAt(B)==="/",L=S!=null&&(S===j||!l&&S.startsWith(j)&&S.charAt(j.length)==="/"),U={isActive:P,isPending:L,isTransitioning:y},H=P?a:void 0,q;typeof i=="function"?q=i(U):q=[i,P?"active":null,L?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let V=typeof o=="function"?o(U):o;return x.createElement(Le,Rx({},h,{"aria-current":H,className:q,ref:r,style:V,to:u,viewTransition:d}),typeof c=="function"?c(U):c)});var Nb;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Nb||(Nb={}));var pN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(pN||(pN={}));function UF(t){let s=x.useContext(j0);return s||va(!1),s}function PF(t,s){let{target:r,replace:a,state:n,preventScrollReset:i,relative:l,viewTransition:o}=s===void 0?{}:s,u=ys(),d=ma(),c=w0(t,{relative:l});return x.useCallback(h=>{if(SF(h,r)){h.preventDefault();let A=a!==void 0?a:Px(d)===Px(c);u(t,{replace:A,state:n,preventScrollReset:i,relative:l,viewTransition:o})}},[d,u,c,a,n,r,t,i,l,o])}function Ef(t){let s=x.useRef(jb(t)),r=x.useRef(!1),a=ma(),n=x.useMemo(()=>CF(a.search,r.current?null:s.current),[a.search]),i=ys(),l=x.useCallback((o,u)=>{const d=jb(typeof o=="function"?o(n):o);r.current=!0,i("?"+d,u)},[i,n]);return[n,l]}function RF(t,s){s===void 0&&(s={});let r=x.useContext(FF);r==null&&va(!1);let{basename:a}=UF(Nb.useViewTransitionState),n=w0(t,{relative:s.relative});if(!r.isTransitioning)return!1;let i=Eh(r.currentLocation.pathname,a)||r.currentLocation.pathname,l=Eh(r.nextLocation.pathname,a)||r.nextLocation.pathname;return bb(n.pathname,l)!=null||bb(n.pathname,i)!=null}function sC(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(r=sC(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Xd(){for(var t,s,r=0,a="",n=arguments.length;r<n;r++)(t=arguments[r])&&(s=sC(t))&&(a&&(a+=" "),a+=s);return a}const nf=t=>typeof t=="number"&&!isNaN(t),aA=t=>typeof t=="string",ml=t=>typeof t=="function",jx=t=>aA(t)||ml(t)?t:null,wb=t=>x.isValidElement(t)||aA(t)||ml(t)||nf(t);function OF(t,s,r){r===void 0&&(r=300);const{scrollHeight:a,style:n}=t;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition=`all ${r}ms`,requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(s,r)})})}function _0(t){let{enter:s,exit:r,appendPosition:a=!1,collapse:n=!0,collapseDuration:i=300}=t;return function(l){let{children:o,position:u,preventExitTransition:d,done:c,nodeRef:h,isIn:A,playToast:f}=l;const g=a?`${s}--${u}`:s,v=a?`${r}--${u}`:r,b=x.useRef(0);return x.useLayoutEffect(()=>{const y=h.current,j=g.split(" "),N=S=>{S.target===h.current&&(f(),y.removeEventListener("animationend",N),y.removeEventListener("animationcancel",N),b.current===0&&S.type!=="animationcancel"&&y.classList.remove(...j))};y.classList.add(...j),y.addEventListener("animationend",N),y.addEventListener("animationcancel",N)},[]),x.useEffect(()=>{const y=h.current,j=()=>{y.removeEventListener("animationend",j),n?OF(y,c,i):c()};A||(d?j():(b.current=1,y.className+=` ${v}`,y.addEventListener("animationend",j)))},[A]),Ts.createElement(Ts.Fragment,null,o)}}function xN(t,s){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:s}:{}}const Fi=new Map;let lf=[];const _b=new Set,QF=t=>_b.forEach(s=>s(t)),rC=()=>Fi.size>0;function aC(t,s){var r;if(s)return!((r=Fi.get(s))==null||!r.isToastActive(t));let a=!1;return Fi.forEach(n=>{n.isToastActive(t)&&(a=!0)}),a}function nC(t,s){wb(t)&&(rC()||lf.push({content:t,options:s}),Fi.forEach(r=>{r.buildToast(t,s)}))}function gN(t,s){Fi.forEach(r=>{s!=null&&s!=null&&s.containerId?(s==null?void 0:s.containerId)===r.id&&r.toggle(t,s==null?void 0:s.id):r.toggle(t,s==null?void 0:s.id)})}function MF(t){const{subscribe:s,getSnapshot:r,setProps:a}=x.useRef((function(i){const l=i.containerId||1;return{subscribe(o){const u=(function(c,h,A){let f=1,g=0,v=[],b=[],y=[],j=h;const N=new Map,S=new Set,B=()=>{y=Array.from(N.values()),S.forEach(U=>U())},P=U=>{b=U==null?[]:b.filter(H=>H!==U),B()},L=U=>{const{toastId:H,onOpen:q,updateId:V,children:M}=U.props,z=V==null;U.staleId&&N.delete(U.staleId),N.set(H,U),b=[...b,U.props.toastId].filter(I=>I!==U.staleId),B(),A(xN(U,z?"added":"updated")),z&&ml(q)&&q(x.isValidElement(M)&&M.props)};return{id:c,props:j,observe:U=>(S.add(U),()=>S.delete(U)),toggle:(U,H)=>{N.forEach(q=>{H!=null&&H!==q.props.toastId||ml(q.toggle)&&q.toggle(U)})},removeToast:P,toasts:N,clearQueue:()=>{g-=v.length,v=[]},buildToast:(U,H)=>{if((C=>{let{containerId:E,toastId:w,updateId:O}=C;const R=E?E!==c:c!==1,X=N.has(w)&&O==null;return R||X})(H))return;const{toastId:q,updateId:V,data:M,staleId:z,delay:I}=H,G=()=>{P(q)},Y=V==null;Y&&g++;const J={...j,style:j.toastStyle,key:f++,...Object.fromEntries(Object.entries(H).filter(C=>{let[E,w]=C;return w!=null})),toastId:q,updateId:V,data:M,closeToast:G,isIn:!1,className:jx(H.className||j.toastClassName),bodyClassName:jx(H.bodyClassName||j.bodyClassName),progressClassName:jx(H.progressClassName||j.progressClassName),autoClose:!H.isLoading&&(T=H.autoClose,k=j.autoClose,T===!1||nf(T)&&T>0?T:k),deleteToast(){const C=N.get(q),{onClose:E,children:w}=C.props;ml(E)&&E(x.isValidElement(w)&&w.props),A(xN(C,"removed")),N.delete(q),g--,g<0&&(g=0),v.length>0?L(v.shift()):B()}};var T,k;J.closeButton=j.closeButton,H.closeButton===!1||wb(H.closeButton)?J.closeButton=H.closeButton:H.closeButton===!0&&(J.closeButton=!wb(j.closeButton)||j.closeButton);let D=U;x.isValidElement(U)&&!aA(U.type)?D=x.cloneElement(U,{closeToast:G,toastProps:J,data:M}):ml(U)&&(D=U({closeToast:G,toastProps:J,data:M}));const Q={content:D,props:J,staleId:z};j.limit&&j.limit>0&&g>j.limit&&Y?v.push(Q):nf(I)?setTimeout(()=>{L(Q)},I):L(Q)},setProps(U){j=U},setToggle:(U,H)=>{N.get(U).toggle=H},isToastActive:U=>b.some(H=>H===U),getSnapshot:()=>y}})(l,i,QF);Fi.set(l,u);const d=u.observe(o);return lf.forEach(c=>nC(c.content,c.options)),lf=[],()=>{d(),Fi.delete(l)}},setProps(o){var u;(u=Fi.get(l))==null||u.setProps(o)},getSnapshot(){var o;return(o=Fi.get(l))==null?void 0:o.getSnapshot()}}})(t)).current;a(t);const n=x.useSyncExternalStore(s,r,r);return{getToastToRender:function(i){if(!n)return[];const l=new Map;return t.newestOnTop&&n.reverse(),n.forEach(o=>{const{position:u}=o.props;l.has(u)||l.set(u,[]),l.get(u).push(o)}),Array.from(l,o=>i(o[0],o[1]))},isToastActive:aC,count:n==null?void 0:n.length}}function HF(t){const[s,r]=x.useState(!1),[a,n]=x.useState(!1),i=x.useRef(null),l=x.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:o,pauseOnHover:u,closeToast:d,onClick:c,closeOnClick:h}=t;var A,f;function g(){r(!0)}function v(){r(!1)}function b(N){const S=i.current;l.canDrag&&S&&(l.didMove=!0,s&&v(),l.delta=t.draggableDirection==="x"?N.clientX-l.start:N.clientY-l.start,l.start!==N.clientX&&(l.canCloseOnClick=!1),S.style.transform=`translate3d(${t.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`},0)`,S.style.opacity=""+(1-Math.abs(l.delta/l.removalDistance)))}function y(){document.removeEventListener("pointermove",b),document.removeEventListener("pointerup",y);const N=i.current;if(l.canDrag&&l.didMove&&N){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance)return n(!0),t.closeToast(),void t.collapseAll();N.style.transition="transform 0.2s, opacity 0.2s",N.style.removeProperty("transform"),N.style.removeProperty("opacity")}}(f=Fi.get((A={id:t.toastId,containerId:t.containerId,fn:r}).containerId||1))==null||f.setToggle(A.id,A.fn),x.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||v(),window.addEventListener("focus",g),window.addEventListener("blur",v),()=>{window.removeEventListener("focus",g),window.removeEventListener("blur",v)}},[t.pauseOnFocusLoss]);const j={onPointerDown:function(N){if(t.draggable===!0||t.draggable===N.pointerType){l.didMove=!1,document.addEventListener("pointermove",b),document.addEventListener("pointerup",y);const S=i.current;l.canCloseOnClick=!0,l.canDrag=!0,S.style.transition="none",t.draggableDirection==="x"?(l.start=N.clientX,l.removalDistance=S.offsetWidth*(t.draggablePercent/100)):(l.start=N.clientY,l.removalDistance=S.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(N){const{top:S,bottom:B,left:P,right:L}=i.current.getBoundingClientRect();N.nativeEvent.type!=="touchend"&&t.pauseOnHover&&N.clientX>=P&&N.clientX<=L&&N.clientY>=S&&N.clientY<=B?v():g()}};return o&&u&&(j.onMouseEnter=v,t.stacked||(j.onMouseLeave=g)),h&&(j.onClick=N=>{c&&c(N),l.canCloseOnClick&&d()}),{playToast:g,pauseToast:v,isRunning:s,preventExitTransition:a,toastRef:i,eventHandlers:j}}function qF(t){let{delay:s,isRunning:r,closeToast:a,type:n="default",hide:i,className:l,style:o,controlledProgress:u,progress:d,rtl:c,isIn:h,theme:A}=t;const f=i||u&&d===0,g={...o,animationDuration:`${s}ms`,animationPlayState:r?"running":"paused"};u&&(g.transform=`scaleX(${d})`);const v=Xd("Toastify__progress-bar",u?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${A}`,`Toastify__progress-bar--${n}`,{"Toastify__progress-bar--rtl":c}),b=ml(l)?l({rtl:c,type:n,defaultClassName:v}):Xd(v,l),y={[u&&d>=1?"onTransitionEnd":"onAnimationEnd"]:u&&d<1?null:()=>{h&&a()}};return Ts.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},Ts.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${A} Toastify__progress-bar--${n}`}),Ts.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:b,style:g,...y}))}let VF=1;const iC=()=>""+VF++;function $F(t){return t&&(aA(t.toastId)||nf(t.toastId))?t.toastId:iC()}function Om(t,s){return nC(t,s),s.toastId}function Ox(t,s){return{...s,type:s&&s.type||t,toastId:$F(s)}}function Bp(t){return(s,r)=>Om(s,Ox(t,r))}function nt(t,s){return Om(t,Ox("default",s))}nt.loading=(t,s)=>Om(t,Ox("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...s})),nt.promise=function(t,s,r){let a,{pending:n,error:i,success:l}=s;n&&(a=aA(n)?nt.loading(n,r):nt.loading(n.render,{...r,...n}));const o={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(c,h,A)=>{if(h==null)return void nt.dismiss(a);const f={type:c,...o,...r,data:A},g=aA(h)?{render:h}:h;return a?nt.update(a,{...f,...g}):nt(g.render,{...f,...g}),A},d=ml(t)?t():t;return d.then(c=>u("success",l,c)).catch(c=>u("error",i,c)),d},nt.success=Bp("success"),nt.info=Bp("info"),nt.error=Bp("error"),nt.warning=Bp("warning"),nt.warn=nt.warning,nt.dark=(t,s)=>Om(t,Ox("default",{theme:"dark",...s})),nt.dismiss=function(t){(function(s){var r;if(rC()){if(s==null||aA(r=s)||nf(r))Fi.forEach(a=>{a.removeToast(s)});else if(s&&("containerId"in s||"id"in s)){const a=Fi.get(s.containerId);a?a.removeToast(s.id):Fi.forEach(n=>{n.removeToast(s.id)})}}else lf=lf.filter(a=>s!=null&&a.options.toastId!==s)})(t)},nt.clearWaitingQueue=function(t){t===void 0&&(t={}),Fi.forEach(s=>{!s.props.limit||t.containerId&&s.id!==t.containerId||s.clearQueue()})},nt.isActive=aC,nt.update=function(t,s){s===void 0&&(s={});const r=((a,n)=>{var i;let{containerId:l}=n;return(i=Fi.get(l||1))==null?void 0:i.toasts.get(a)})(t,s);if(r){const{props:a,content:n}=r,i={delay:100,...a,...s,toastId:s.toastId||t,updateId:iC()};i.toastId!==t&&(i.staleId=t);const l=i.render||n;delete i.render,Om(l,i)}},nt.done=t=>{nt.update(t,{progress:1})},nt.onChange=function(t){return _b.add(t),()=>{_b.delete(t)}},nt.play=t=>gN(!0,t),nt.pause=t=>gN(!1,t);const WF=typeof window<"u"?x.useLayoutEffect:x.useEffect,Ep=t=>{let{theme:s,type:r,isLoading:a,...n}=t;return Ts.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:s==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...n})},av={info:function(t){return Ts.createElement(Ep,{...t},Ts.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return Ts.createElement(Ep,{...t},Ts.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return Ts.createElement(Ep,{...t},Ts.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return Ts.createElement(Ep,{...t},Ts.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return Ts.createElement("div",{className:"Toastify__spinner"})}},GF=t=>{const{isRunning:s,preventExitTransition:r,toastRef:a,eventHandlers:n,playToast:i}=HF(t),{closeButton:l,children:o,autoClose:u,onClick:d,type:c,hideProgressBar:h,closeToast:A,transition:f,position:g,className:v,style:b,bodyClassName:y,bodyStyle:j,progressClassName:N,progressStyle:S,updateId:B,role:P,progress:L,rtl:U,toastId:H,deleteToast:q,isIn:V,isLoading:M,closeOnClick:z,theme:I}=t,G=Xd("Toastify__toast",`Toastify__toast-theme--${I}`,`Toastify__toast--${c}`,{"Toastify__toast--rtl":U},{"Toastify__toast--close-on-click":z}),Y=ml(v)?v({rtl:U,position:g,type:c,defaultClassName:G}):Xd(G,v),J=(function(Q){let{theme:C,type:E,isLoading:w,icon:O}=Q,R=null;const X={theme:C,type:E};return O===!1||(ml(O)?R=O({...X,isLoading:w}):x.isValidElement(O)?R=x.cloneElement(O,X):w?R=av.spinner():(ne=>ne in av)(E)&&(R=av[E](X))),R})(t),T=!!L||!u,k={closeToast:A,type:c,theme:I};let D=null;return l===!1||(D=ml(l)?l(k):x.isValidElement(l)?x.cloneElement(l,k):(function(Q){let{closeToast:C,theme:E,ariaLabel:w="close"}=Q;return Ts.createElement("button",{className:`Toastify__close-button Toastify__close-button--${E}`,type:"button",onClick:O=>{O.stopPropagation(),C(O)},"aria-label":w},Ts.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Ts.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))})(k)),Ts.createElement(f,{isIn:V,done:q,position:g,preventExitTransition:r,nodeRef:a,playToast:i},Ts.createElement("div",{id:H,onClick:d,"data-in":V,className:Y,...n,style:b,ref:a},Ts.createElement("div",{...V&&{role:P},className:ml(y)?y({type:c}):Xd("Toastify__toast-body",y),style:j},J!=null&&Ts.createElement("div",{className:Xd("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!M})},J),Ts.createElement("div",null,o)),D,Ts.createElement(qF,{...B&&!T?{key:`pb-${B}`}:{},rtl:U,theme:I,delay:u,isRunning:s,isIn:V,closeToast:A,hide:h,type:c,style:S,className:N,controlledProgress:T,progress:L||0})))},S0=function(t,s){return s===void 0&&(s=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:s}},KF=_0(S0("bounce",!0));_0(S0("slide",!0));_0(S0("zoom"));_0(S0("flip"));const zF={position:"top-right",transition:KF,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function YF(t){let s={...zF,...t};const r=t.stacked,[a,n]=x.useState(!0),i=x.useRef(null),{getToastToRender:l,isToastActive:o,count:u}=MF(s),{className:d,style:c,rtl:h,containerId:A}=s;function f(v){const b=Xd("Toastify__toast-container",`Toastify__toast-container--${v}`,{"Toastify__toast-container--rtl":h});return ml(d)?d({position:v,rtl:h,defaultClassName:b}):Xd(b,jx(d))}function g(){r&&(n(!0),nt.play())}return WF(()=>{if(r){var v;const b=i.current.querySelectorAll('[data-in="true"]'),y=12,j=(v=s.position)==null?void 0:v.includes("top");let N=0,S=0;Array.from(b).reverse().forEach((B,P)=>{const L=B;L.classList.add("Toastify__toast--stacked"),P>0&&(L.dataset.collapsed=`${a}`),L.dataset.pos||(L.dataset.pos=j?"top":"bot");const U=N*(a?.2:1)+(a?0:y*P);L.style.setProperty("--y",`${j?U:-1*U}px`),L.style.setProperty("--g",`${y}`),L.style.setProperty("--s",""+(1-(a?S:0))),N+=L.offsetHeight,S+=.025})}},[a,u,r]),Ts.createElement("div",{ref:i,className:"Toastify",id:A,onMouseEnter:()=>{r&&(n(!1),nt.pause())},onMouseLeave:g},l((v,b)=>{const y=b.length?{...c}:{...c,pointerEvents:"none"};return Ts.createElement("div",{className:f(v),style:y,key:`container-${v}`},b.map(j=>{let{content:N,props:S}=j;return Ts.createElement(GF,{...S,stacked:r,collapseAll:g,isIn:o(S.toastId,S.containerId),style:S.style,key:`toast-${S.key}`},N)}))}))}function lC(t,s){return function(){return t.apply(s,arguments)}}const{toString:XF}=Object.prototype,{getPrototypeOf:Py}=Object,{iterator:C0,toStringTag:oC}=Symbol,k0=(t=>s=>{const r=XF.call(s);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),To=t=>(t=t.toLowerCase(),s=>k0(s)===t),B0=t=>s=>typeof s===t,{isArray:Mh}=Array,Fh=B0("undefined");function Ff(t){return t!==null&&!Fh(t)&&t.constructor!==null&&!Fh(t.constructor)&&Ki(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const cC=To("ArrayBuffer");function JF(t){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(t):s=t&&t.buffer&&cC(t.buffer),s}const ZF=B0("string"),Ki=B0("function"),dC=B0("number"),Tf=t=>t!==null&&typeof t=="object",e3=t=>t===!0||t===!1,Nx=t=>{if(k0(t)!=="object")return!1;const s=Py(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(oC in t)&&!(C0 in t)},t3=t=>{if(!Tf(t)||Ff(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},s3=To("Date"),r3=To("File"),a3=To("Blob"),n3=To("FileList"),i3=t=>Tf(t)&&Ki(t.pipe),l3=t=>{let s;return t&&(typeof FormData=="function"&&t instanceof FormData||Ki(t.append)&&((s=k0(t))==="formdata"||s==="object"&&Ki(t.toString)&&t.toString()==="[object FormData]"))},o3=To("URLSearchParams"),[c3,d3,u3,A3]=["ReadableStream","Request","Response","Headers"].map(To),h3=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function If(t,s,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let a,n;if(typeof t!="object"&&(t=[t]),Mh(t))for(a=0,n=t.length;a<n;a++)s.call(null,t[a],a,t);else{if(Ff(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),l=i.length;let o;for(a=0;a<l;a++)o=i[a],s.call(null,t[o],o,t)}}function uC(t,s){if(Ff(t))return null;s=s.toLowerCase();const r=Object.keys(t);let a=r.length,n;for(;a-- >0;)if(n=r[a],s===n.toLowerCase())return n;return null}const Zu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,AC=t=>!Fh(t)&&t!==Zu;function Sb(){const{caseless:t,skipUndefined:s}=AC(this)&&this||{},r={},a=(n,i)=>{const l=t&&uC(r,i)||i;Nx(r[l])&&Nx(n)?r[l]=Sb(r[l],n):Nx(n)?r[l]=Sb({},n):Mh(n)?r[l]=n.slice():(!s||!Fh(n))&&(r[l]=n)};for(let n=0,i=arguments.length;n<i;n++)arguments[n]&&If(arguments[n],a);return r}const m3=(t,s,r,{allOwnKeys:a}={})=>(If(s,(n,i)=>{r&&Ki(n)?t[i]=lC(n,r):t[i]=n},{allOwnKeys:a}),t),f3=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),p3=(t,s,r,a)=>{t.prototype=Object.create(s.prototype,a),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:s.prototype}),r&&Object.assign(t.prototype,r)},x3=(t,s,r,a)=>{let n,i,l;const o={};if(s=s||{},t==null)return s;do{for(n=Object.getOwnPropertyNames(t),i=n.length;i-- >0;)l=n[i],(!a||a(l,t,s))&&!o[l]&&(s[l]=t[l],o[l]=!0);t=r!==!1&&Py(t)}while(t&&(!r||r(t,s))&&t!==Object.prototype);return s},g3=(t,s,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=s.length;const a=t.indexOf(s,r);return a!==-1&&a===r},v3=t=>{if(!t)return null;if(Mh(t))return t;let s=t.length;if(!dC(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=t[s];return r},b3=(t=>s=>t&&s instanceof t)(typeof Uint8Array<"u"&&Py(Uint8Array)),y3=(t,s)=>{const a=(t&&t[C0]).call(t);let n;for(;(n=a.next())&&!n.done;){const i=n.value;s.call(t,i[0],i[1])}},j3=(t,s)=>{let r;const a=[];for(;(r=t.exec(s))!==null;)a.push(r);return a},N3=To("HTMLFormElement"),w3=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,a,n){return a.toUpperCase()+n}),vN=(({hasOwnProperty:t})=>(s,r)=>t.call(s,r))(Object.prototype),_3=To("RegExp"),hC=(t,s)=>{const r=Object.getOwnPropertyDescriptors(t),a={};If(r,(n,i)=>{let l;(l=s(n,i,t))!==!1&&(a[i]=l||n)}),Object.defineProperties(t,a)},S3=t=>{hC(t,(s,r)=>{if(Ki(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const a=t[r];if(Ki(a)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},C3=(t,s)=>{const r={},a=n=>{n.forEach(i=>{r[i]=!0})};return Mh(t)?a(t):a(String(t).split(s)),r},k3=()=>{},B3=(t,s)=>t!=null&&Number.isFinite(t=+t)?t:s;function E3(t){return!!(t&&Ki(t.append)&&t[oC]==="FormData"&&t[C0])}const F3=t=>{const s=new Array(10),r=(a,n)=>{if(Tf(a)){if(s.indexOf(a)>=0)return;if(Ff(a))return a;if(!("toJSON"in a)){s[n]=a;const i=Mh(a)?[]:{};return If(a,(l,o)=>{const u=r(l,n+1);!Fh(u)&&(i[o]=u)}),s[n]=void 0,i}}return a};return r(t,0)},T3=To("AsyncFunction"),I3=t=>t&&(Tf(t)||Ki(t))&&Ki(t.then)&&Ki(t.catch),mC=((t,s)=>t?setImmediate:s?((r,a)=>(Zu.addEventListener("message",({source:n,data:i})=>{n===Zu&&i===r&&a.length&&a.shift()()},!1),n=>{a.push(n),Zu.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ki(Zu.postMessage)),L3=typeof queueMicrotask<"u"?queueMicrotask.bind(Zu):typeof process<"u"&&process.nextTick||mC,D3=t=>t!=null&&Ki(t[C0]),qt={isArray:Mh,isArrayBuffer:cC,isBuffer:Ff,isFormData:l3,isArrayBufferView:JF,isString:ZF,isNumber:dC,isBoolean:e3,isObject:Tf,isPlainObject:Nx,isEmptyObject:t3,isReadableStream:c3,isRequest:d3,isResponse:u3,isHeaders:A3,isUndefined:Fh,isDate:s3,isFile:r3,isBlob:a3,isRegExp:_3,isFunction:Ki,isStream:i3,isURLSearchParams:o3,isTypedArray:b3,isFileList:n3,forEach:If,merge:Sb,extend:m3,trim:h3,stripBOM:f3,inherits:p3,toFlatObject:x3,kindOf:k0,kindOfTest:To,endsWith:g3,toArray:v3,forEachEntry:y3,matchAll:j3,isHTMLForm:N3,hasOwnProperty:vN,hasOwnProp:vN,reduceDescriptors:hC,freezeMethods:S3,toObjectSet:C3,toCamelCase:w3,noop:k3,toFiniteNumber:B3,findKey:uC,global:Zu,isContextDefined:AC,isSpecCompliantForm:E3,toJSONObject:F3,isAsyncFn:T3,isThenable:I3,setImmediate:mC,asap:L3,isIterable:D3};function rr(t,s,r,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}qt.inherits(rr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:qt.toJSONObject(this.config),code:this.code,status:this.status}}});const fC=rr.prototype,pC={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{pC[t]={value:t}});Object.defineProperties(rr,pC);Object.defineProperty(fC,"isAxiosError",{value:!0});rr.from=(t,s,r,a,n,i)=>{const l=Object.create(fC);qt.toFlatObject(t,l,function(c){return c!==Error.prototype},d=>d!=="isAxiosError");const o=t&&t.message?t.message:"Error",u=s==null&&t?t.code:s;return rr.call(l,o,u,r,a,n),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",i&&Object.assign(l,i),l};const U3=null;function Cb(t){return qt.isPlainObject(t)||qt.isArray(t)}function xC(t){return qt.endsWith(t,"[]")?t.slice(0,-2):t}function bN(t,s,r){return t?t.concat(s).map(function(n,i){return n=xC(n),!r&&i?"["+n+"]":n}).join(r?".":""):s}function P3(t){return qt.isArray(t)&&!t.some(Cb)}const R3=qt.toFlatObject(qt,{},null,function(s){return/^is[A-Z]/.test(s)});function E0(t,s,r){if(!qt.isObject(t))throw new TypeError("target must be an object");s=s||new FormData,r=qt.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,b){return!qt.isUndefined(b[v])});const a=r.metaTokens,n=r.visitor||c,i=r.dots,l=r.indexes,u=(r.Blob||typeof Blob<"u"&&Blob)&&qt.isSpecCompliantForm(s);if(!qt.isFunction(n))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(qt.isDate(g))return g.toISOString();if(qt.isBoolean(g))return g.toString();if(!u&&qt.isBlob(g))throw new rr("Blob is not supported. Use a Buffer instead.");return qt.isArrayBuffer(g)||qt.isTypedArray(g)?u&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,v,b){let y=g;if(g&&!b&&typeof g=="object"){if(qt.endsWith(v,"{}"))v=a?v:v.slice(0,-2),g=JSON.stringify(g);else if(qt.isArray(g)&&P3(g)||(qt.isFileList(g)||qt.endsWith(v,"[]"))&&(y=qt.toArray(g)))return v=xC(v),y.forEach(function(N,S){!(qt.isUndefined(N)||N===null)&&s.append(l===!0?bN([v],S,i):l===null?v:v+"[]",d(N))}),!1}return Cb(g)?!0:(s.append(bN(b,v,i),d(g)),!1)}const h=[],A=Object.assign(R3,{defaultVisitor:c,convertValue:d,isVisitable:Cb});function f(g,v){if(!qt.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+v.join("."));h.push(g),qt.forEach(g,function(y,j){(!(qt.isUndefined(y)||y===null)&&n.call(s,y,qt.isString(j)?j.trim():j,v,A))===!0&&f(y,v?v.concat(j):[j])}),h.pop()}}if(!qt.isObject(t))throw new TypeError("data must be an object");return f(t),s}function yN(t){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(a){return s[a]})}function Ry(t,s){this._pairs=[],t&&E0(t,this,s)}const gC=Ry.prototype;gC.append=function(s,r){this._pairs.push([s,r])};gC.toString=function(s){const r=s?function(a){return s.call(this,a,yN)}:yN;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function O3(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function vC(t,s,r){if(!s)return t;const a=r&&r.encode||O3;qt.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let i;if(n?i=n(s,r):i=qt.isURLSearchParams(s)?s.toString():new Ry(s,r).toString(a),i){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class jN{constructor(){this.handlers=[]}use(s,r,a){return this.handlers.push({fulfilled:s,rejected:r,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){qt.forEach(this.handlers,function(a){a!==null&&s(a)})}}const bC={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Q3=typeof URLSearchParams<"u"?URLSearchParams:Ry,M3=typeof FormData<"u"?FormData:null,H3=typeof Blob<"u"?Blob:null,q3={isBrowser:!0,classes:{URLSearchParams:Q3,FormData:M3,Blob:H3},protocols:["http","https","file","blob","url","data"]},Oy=typeof window<"u"&&typeof document<"u",kb=typeof navigator=="object"&&navigator||void 0,V3=Oy&&(!kb||["ReactNative","NativeScript","NS"].indexOf(kb.product)<0),$3=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",W3=Oy&&window.location.href||"http://localhost",G3=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Oy,hasStandardBrowserEnv:V3,hasStandardBrowserWebWorkerEnv:$3,navigator:kb,origin:W3},Symbol.toStringTag,{value:"Module"})),oi={...G3,...q3};function K3(t,s){return E0(t,new oi.classes.URLSearchParams,{visitor:function(r,a,n,i){return oi.isNode&&qt.isBuffer(r)?(this.append(a,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...s})}function z3(t){return qt.matchAll(/\w+|\[(\w*)]/g,t).map(s=>s[0]==="[]"?"":s[1]||s[0])}function Y3(t){const s={},r=Object.keys(t);let a;const n=r.length;let i;for(a=0;a<n;a++)i=r[a],s[i]=t[i];return s}function yC(t){function s(r,a,n,i){let l=r[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),u=i>=r.length;return l=!l&&qt.isArray(n)?n.length:l,u?(qt.hasOwnProp(n,l)?n[l]=[n[l],a]:n[l]=a,!o):((!n[l]||!qt.isObject(n[l]))&&(n[l]=[]),s(r,a,n[l],i)&&qt.isArray(n[l])&&(n[l]=Y3(n[l])),!o)}if(qt.isFormData(t)&&qt.isFunction(t.entries)){const r={};return qt.forEachEntry(t,(a,n)=>{s(z3(a),n,r,0)}),r}return null}function X3(t,s,r){if(qt.isString(t))try{return(s||JSON.parse)(t),qt.trim(t)}catch(a){if(a.name!=="SyntaxError")throw a}return(r||JSON.stringify)(t)}const Lf={transitional:bC,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const a=r.getContentType()||"",n=a.indexOf("application/json")>-1,i=qt.isObject(s);if(i&&qt.isHTMLForm(s)&&(s=new FormData(s)),qt.isFormData(s))return n?JSON.stringify(yC(s)):s;if(qt.isArrayBuffer(s)||qt.isBuffer(s)||qt.isStream(s)||qt.isFile(s)||qt.isBlob(s)||qt.isReadableStream(s))return s;if(qt.isArrayBufferView(s))return s.buffer;if(qt.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let o;if(i){if(a.indexOf("application/x-www-form-urlencoded")>-1)return K3(s,this.formSerializer).toString();if((o=qt.isFileList(s))||a.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return E0(o?{"files[]":s}:s,u&&new u,this.formSerializer)}}return i||n?(r.setContentType("application/json",!1),X3(s)):s}],transformResponse:[function(s){const r=this.transitional||Lf.transitional,a=r&&r.forcedJSONParsing,n=this.responseType==="json";if(qt.isResponse(s)||qt.isReadableStream(s))return s;if(s&&qt.isString(s)&&(a&&!this.responseType||n)){const l=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(s,this.parseReviver)}catch(o){if(l)throw o.name==="SyntaxError"?rr.from(o,rr.ERR_BAD_RESPONSE,this,null,this.response):o}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:oi.classes.FormData,Blob:oi.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};qt.forEach(["delete","get","head","post","put","patch"],t=>{Lf.headers[t]={}});const J3=qt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Z3=t=>{const s={};let r,a,n;return t&&t.split(`
`).forEach(function(l){n=l.indexOf(":"),r=l.substring(0,n).trim().toLowerCase(),a=l.substring(n+1).trim(),!(!r||s[r]&&J3[r])&&(r==="set-cookie"?s[r]?s[r].push(a):s[r]=[a]:s[r]=s[r]?s[r]+", "+a:a)}),s},NN=Symbol("internals");function fm(t){return t&&String(t).trim().toLowerCase()}function wx(t){return t===!1||t==null?t:qt.isArray(t)?t.map(wx):String(t)}function eT(t){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=r.exec(t);)s[a[1]]=a[2];return s}const tT=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function nv(t,s,r,a,n){if(qt.isFunction(a))return a.call(this,s,r);if(n&&(s=r),!!qt.isString(s)){if(qt.isString(a))return s.indexOf(a)!==-1;if(qt.isRegExp(a))return a.test(s)}}function sT(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,a)=>r.toUpperCase()+a)}function rT(t,s){const r=qt.toCamelCase(" "+s);["get","set","has"].forEach(a=>{Object.defineProperty(t,a+r,{value:function(n,i,l){return this[a].call(this,s,n,i,l)},configurable:!0})})}let zi=class{constructor(s){s&&this.set(s)}set(s,r,a){const n=this;function i(o,u,d){const c=fm(u);if(!c)throw new Error("header name must be a non-empty string");const h=qt.findKey(n,c);(!h||n[h]===void 0||d===!0||d===void 0&&n[h]!==!1)&&(n[h||u]=wx(o))}const l=(o,u)=>qt.forEach(o,(d,c)=>i(d,c,u));if(qt.isPlainObject(s)||s instanceof this.constructor)l(s,r);else if(qt.isString(s)&&(s=s.trim())&&!tT(s))l(Z3(s),r);else if(qt.isObject(s)&&qt.isIterable(s)){let o={},u,d;for(const c of s){if(!qt.isArray(c))throw TypeError("Object iterator must return a key-value pair");o[d=c[0]]=(u=o[d])?qt.isArray(u)?[...u,c[1]]:[u,c[1]]:c[1]}l(o,r)}else s!=null&&i(r,s,a);return this}get(s,r){if(s=fm(s),s){const a=qt.findKey(this,s);if(a){const n=this[a];if(!r)return n;if(r===!0)return eT(n);if(qt.isFunction(r))return r.call(this,n,a);if(qt.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=fm(s),s){const a=qt.findKey(this,s);return!!(a&&this[a]!==void 0&&(!r||nv(this,this[a],a,r)))}return!1}delete(s,r){const a=this;let n=!1;function i(l){if(l=fm(l),l){const o=qt.findKey(a,l);o&&(!r||nv(a,a[o],o,r))&&(delete a[o],n=!0)}}return qt.isArray(s)?s.forEach(i):i(s),n}clear(s){const r=Object.keys(this);let a=r.length,n=!1;for(;a--;){const i=r[a];(!s||nv(this,this[i],i,s,!0))&&(delete this[i],n=!0)}return n}normalize(s){const r=this,a={};return qt.forEach(this,(n,i)=>{const l=qt.findKey(a,i);if(l){r[l]=wx(n),delete r[i];return}const o=s?sT(i):String(i).trim();o!==i&&delete r[i],r[o]=wx(n),a[o]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return qt.forEach(this,(a,n)=>{a!=null&&a!==!1&&(r[n]=s&&qt.isArray(a)?a.join(", "):a)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const a=new this(s);return r.forEach(n=>a.set(n)),a}static accessor(s){const a=(this[NN]=this[NN]={accessors:{}}).accessors,n=this.prototype;function i(l){const o=fm(l);a[o]||(rT(n,l),a[o]=!0)}return qt.isArray(s)?s.forEach(i):i(s),this}};zi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);qt.reduceDescriptors(zi.prototype,({value:t},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>t,set(a){this[r]=a}}});qt.freezeMethods(zi);function iv(t,s){const r=this||Lf,a=s||r,n=zi.from(a.headers);let i=a.data;return qt.forEach(t,function(o){i=o.call(r,i,n.normalize(),s?s.status:void 0)}),n.normalize(),i}function jC(t){return!!(t&&t.__CANCEL__)}function Hh(t,s,r){rr.call(this,t??"canceled",rr.ERR_CANCELED,s,r),this.name="CanceledError"}qt.inherits(Hh,rr,{__CANCEL__:!0});function NC(t,s,r){const a=r.config.validateStatus;!r.status||!a||a(r.status)?t(r):s(new rr("Request failed with status code "+r.status,[rr.ERR_BAD_REQUEST,rr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function aT(t){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return s&&s[1]||""}function nT(t,s){t=t||10;const r=new Array(t),a=new Array(t);let n=0,i=0,l;return s=s!==void 0?s:1e3,function(u){const d=Date.now(),c=a[i];l||(l=d),r[n]=u,a[n]=d;let h=i,A=0;for(;h!==n;)A+=r[h++],h=h%t;if(n=(n+1)%t,n===i&&(i=(i+1)%t),d-l<s)return;const f=c&&d-c;return f?Math.round(A*1e3/f):void 0}}function iT(t,s){let r=0,a=1e3/s,n,i;const l=(d,c=Date.now())=>{r=c,n=null,i&&(clearTimeout(i),i=null),t(...d)};return[(...d)=>{const c=Date.now(),h=c-r;h>=a?l(d,c):(n=d,i||(i=setTimeout(()=>{i=null,l(n)},a-h)))},()=>n&&l(n)]}const Qx=(t,s,r=3)=>{let a=0;const n=nT(50,250);return iT(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,u=l-a,d=n(u),c=l<=o;a=l;const h={loaded:l,total:o,progress:o?l/o:void 0,bytes:u,rate:d||void 0,estimated:d&&o&&c?(o-l)/d:void 0,event:i,lengthComputable:o!=null,[s?"download":"upload"]:!0};t(h)},r)},wN=(t,s)=>{const r=t!=null;return[a=>s[0]({lengthComputable:r,total:t,loaded:a}),s[1]]},_N=t=>(...s)=>qt.asap(()=>t(...s)),lT=oi.hasStandardBrowserEnv?((t,s)=>r=>(r=new URL(r,oi.origin),t.protocol===r.protocol&&t.host===r.host&&(s||t.port===r.port)))(new URL(oi.origin),oi.navigator&&/(msie|trident)/i.test(oi.navigator.userAgent)):()=>!0,oT=oi.hasStandardBrowserEnv?{write(t,s,r,a,n,i,l){if(typeof document>"u")return;const o=[`${t}=${encodeURIComponent(s)}`];qt.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),qt.isString(a)&&o.push(`path=${a}`),qt.isString(n)&&o.push(`domain=${n}`),i===!0&&o.push("secure"),qt.isString(l)&&o.push(`SameSite=${l}`),document.cookie=o.join("; ")},read(t){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function cT(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function dT(t,s){return s?t.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):t}function wC(t,s,r){let a=!cT(s);return t&&(a||r==!1)?dT(t,s):s}const SN=t=>t instanceof zi?{...t}:t;function hA(t,s){s=s||{};const r={};function a(d,c,h,A){return qt.isPlainObject(d)&&qt.isPlainObject(c)?qt.merge.call({caseless:A},d,c):qt.isPlainObject(c)?qt.merge({},c):qt.isArray(c)?c.slice():c}function n(d,c,h,A){if(qt.isUndefined(c)){if(!qt.isUndefined(d))return a(void 0,d,h,A)}else return a(d,c,h,A)}function i(d,c){if(!qt.isUndefined(c))return a(void 0,c)}function l(d,c){if(qt.isUndefined(c)){if(!qt.isUndefined(d))return a(void 0,d)}else return a(void 0,c)}function o(d,c,h){if(h in s)return a(d,c);if(h in t)return a(void 0,d)}const u={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(d,c,h)=>n(SN(d),SN(c),h,!0)};return qt.forEach(Object.keys({...t,...s}),function(c){const h=u[c]||n,A=h(t[c],s[c],c);qt.isUndefined(A)&&h!==o||(r[c]=A)}),r}const _C=t=>{const s=hA({},t);let{data:r,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:i,headers:l,auth:o}=s;if(s.headers=l=zi.from(l),s.url=vC(wC(s.baseURL,s.url,s.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),qt.isFormData(r)){if(oi.hasStandardBrowserEnv||oi.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(qt.isFunction(r.getHeaders)){const u=r.getHeaders(),d=["content-type","content-length"];Object.entries(u).forEach(([c,h])=>{d.includes(c.toLowerCase())&&l.set(c,h)})}}if(oi.hasStandardBrowserEnv&&(a&&qt.isFunction(a)&&(a=a(s)),a||a!==!1&&lT(s.url))){const u=n&&i&&oT.read(i);u&&l.set(n,u)}return s},uT=typeof XMLHttpRequest<"u",AT=uT&&function(t){return new Promise(function(r,a){const n=_C(t);let i=n.data;const l=zi.from(n.headers).normalize();let{responseType:o,onUploadProgress:u,onDownloadProgress:d}=n,c,h,A,f,g;function v(){f&&f(),g&&g(),n.cancelToken&&n.cancelToken.unsubscribe(c),n.signal&&n.signal.removeEventListener("abort",c)}let b=new XMLHttpRequest;b.open(n.method.toUpperCase(),n.url,!0),b.timeout=n.timeout;function y(){if(!b)return;const N=zi.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),B={data:!o||o==="text"||o==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:N,config:t,request:b};NC(function(L){r(L),v()},function(L){a(L),v()},B),b=null}"onloadend"in b?b.onloadend=y:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(y)},b.onabort=function(){b&&(a(new rr("Request aborted",rr.ECONNABORTED,t,b)),b=null)},b.onerror=function(S){const B=S&&S.message?S.message:"Network Error",P=new rr(B,rr.ERR_NETWORK,t,b);P.event=S||null,a(P),b=null},b.ontimeout=function(){let S=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const B=n.transitional||bC;n.timeoutErrorMessage&&(S=n.timeoutErrorMessage),a(new rr(S,B.clarifyTimeoutError?rr.ETIMEDOUT:rr.ECONNABORTED,t,b)),b=null},i===void 0&&l.setContentType(null),"setRequestHeader"in b&&qt.forEach(l.toJSON(),function(S,B){b.setRequestHeader(B,S)}),qt.isUndefined(n.withCredentials)||(b.withCredentials=!!n.withCredentials),o&&o!=="json"&&(b.responseType=n.responseType),d&&([A,g]=Qx(d,!0),b.addEventListener("progress",A)),u&&b.upload&&([h,f]=Qx(u),b.upload.addEventListener("progress",h),b.upload.addEventListener("loadend",f)),(n.cancelToken||n.signal)&&(c=N=>{b&&(a(!N||N.type?new Hh(null,t,b):N),b.abort(),b=null)},n.cancelToken&&n.cancelToken.subscribe(c),n.signal&&(n.signal.aborted?c():n.signal.addEventListener("abort",c)));const j=aT(n.url);if(j&&oi.protocols.indexOf(j)===-1){a(new rr("Unsupported protocol "+j+":",rr.ERR_BAD_REQUEST,t));return}b.send(i||null)})},hT=(t,s)=>{const{length:r}=t=t?t.filter(Boolean):[];if(s||r){let a=new AbortController,n;const i=function(d){if(!n){n=!0,o();const c=d instanceof Error?d:this.reason;a.abort(c instanceof rr?c:new Hh(c instanceof Error?c.message:c))}};let l=s&&setTimeout(()=>{l=null,i(new rr(`timeout ${s} of ms exceeded`,rr.ETIMEDOUT))},s);const o=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),t=null)};t.forEach(d=>d.addEventListener("abort",i));const{signal:u}=a;return u.unsubscribe=()=>qt.asap(o),u}},mT=function*(t,s){let r=t.byteLength;if(r<s){yield t;return}let a=0,n;for(;a<r;)n=a+s,yield t.slice(a,n),a=n},fT=async function*(t,s){for await(const r of pT(t))yield*mT(r,s)},pT=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const s=t.getReader();try{for(;;){const{done:r,value:a}=await s.read();if(r)break;yield a}}finally{await s.cancel()}},CN=(t,s,r,a)=>{const n=fT(t,s);let i=0,l,o=u=>{l||(l=!0,a&&a(u))};return new ReadableStream({async pull(u){try{const{done:d,value:c}=await n.next();if(d){o(),u.close();return}let h=c.byteLength;if(r){let A=i+=h;r(A)}u.enqueue(new Uint8Array(c))}catch(d){throw o(d),d}},cancel(u){return o(u),n.return()}},{highWaterMark:2})},kN=64*1024,{isFunction:Fp}=qt,xT=(({Request:t,Response:s})=>({Request:t,Response:s}))(qt.global),{ReadableStream:BN,TextEncoder:EN}=qt.global,FN=(t,...s)=>{try{return!!t(...s)}catch{return!1}},gT=t=>{t=qt.merge.call({skipUndefined:!0},xT,t);const{fetch:s,Request:r,Response:a}=t,n=s?Fp(s):typeof fetch=="function",i=Fp(r),l=Fp(a);if(!n)return!1;const o=n&&Fp(BN),u=n&&(typeof EN=="function"?(g=>v=>g.encode(v))(new EN):async g=>new Uint8Array(await new r(g).arrayBuffer())),d=i&&o&&FN(()=>{let g=!1;const v=new r(oi.origin,{body:new BN,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!v}),c=l&&o&&FN(()=>qt.isReadableStream(new a("").body)),h={stream:c&&(g=>g.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!h[g]&&(h[g]=(v,b)=>{let y=v&&v[g];if(y)return y.call(v);throw new rr(`Response type '${g}' is not supported`,rr.ERR_NOT_SUPPORT,b)})});const A=async g=>{if(g==null)return 0;if(qt.isBlob(g))return g.size;if(qt.isSpecCompliantForm(g))return(await new r(oi.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(qt.isArrayBufferView(g)||qt.isArrayBuffer(g))return g.byteLength;if(qt.isURLSearchParams(g)&&(g=g+""),qt.isString(g))return(await u(g)).byteLength},f=async(g,v)=>{const b=qt.toFiniteNumber(g.getContentLength());return b??A(v)};return async g=>{let{url:v,method:b,data:y,signal:j,cancelToken:N,timeout:S,onDownloadProgress:B,onUploadProgress:P,responseType:L,headers:U,withCredentials:H="same-origin",fetchOptions:q}=_C(g),V=s||fetch;L=L?(L+"").toLowerCase():"text";let M=hT([j,N&&N.toAbortSignal()],S),z=null;const I=M&&M.unsubscribe&&(()=>{M.unsubscribe()});let G;try{if(P&&d&&b!=="get"&&b!=="head"&&(G=await f(U,y))!==0){let Q=new r(v,{method:"POST",body:y,duplex:"half"}),C;if(qt.isFormData(y)&&(C=Q.headers.get("content-type"))&&U.setContentType(C),Q.body){const[E,w]=wN(G,Qx(_N(P)));y=CN(Q.body,kN,E,w)}}qt.isString(H)||(H=H?"include":"omit");const Y=i&&"credentials"in r.prototype,J={...q,signal:M,method:b.toUpperCase(),headers:U.normalize().toJSON(),body:y,duplex:"half",credentials:Y?H:void 0};z=i&&new r(v,J);let T=await(i?V(z,q):V(v,J));const k=c&&(L==="stream"||L==="response");if(c&&(B||k&&I)){const Q={};["status","statusText","headers"].forEach(O=>{Q[O]=T[O]});const C=qt.toFiniteNumber(T.headers.get("content-length")),[E,w]=B&&wN(C,Qx(_N(B),!0))||[];T=new a(CN(T.body,kN,E,()=>{w&&w(),I&&I()}),Q)}L=L||"text";let D=await h[qt.findKey(h,L)||"text"](T,g);return!k&&I&&I(),await new Promise((Q,C)=>{NC(Q,C,{data:D,headers:zi.from(T.headers),status:T.status,statusText:T.statusText,config:g,request:z})})}catch(Y){throw I&&I(),Y&&Y.name==="TypeError"&&/Load failed|fetch/i.test(Y.message)?Object.assign(new rr("Network Error",rr.ERR_NETWORK,g,z),{cause:Y.cause||Y}):rr.from(Y,Y&&Y.code,g,z)}}},vT=new Map,SC=t=>{let s=t&&t.env||{};const{fetch:r,Request:a,Response:n}=s,i=[a,n,r];let l=i.length,o=l,u,d,c=vT;for(;o--;)u=i[o],d=c.get(u),d===void 0&&c.set(u,d=o?new Map:gT(s)),c=d;return d};SC();const Qy={http:U3,xhr:AT,fetch:{get:SC}};qt.forEach(Qy,(t,s)=>{if(t){try{Object.defineProperty(t,"name",{value:s})}catch{}Object.defineProperty(t,"adapterName",{value:s})}});const TN=t=>`- ${t}`,bT=t=>qt.isFunction(t)||t===null||t===!1;function yT(t,s){t=qt.isArray(t)?t:[t];const{length:r}=t;let a,n;const i={};for(let l=0;l<r;l++){a=t[l];let o;if(n=a,!bT(a)&&(n=Qy[(o=String(a)).toLowerCase()],n===void 0))throw new rr(`Unknown adapter '${o}'`);if(n&&(qt.isFunction(n)||(n=n.get(s))))break;i[o||"#"+l]=n}if(!n){const l=Object.entries(i).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=r?l.length>1?`since :
`+l.map(TN).join(`
`):" "+TN(l[0]):"as no adapter specified";throw new rr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n}const CC={getAdapter:yT,adapters:Qy};function lv(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Hh(null,t)}function IN(t){return lv(t),t.headers=zi.from(t.headers),t.data=iv.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),CC.getAdapter(t.adapter||Lf.adapter,t)(t).then(function(a){return lv(t),a.data=iv.call(t,t.transformResponse,a),a.headers=zi.from(a.headers),a},function(a){return jC(a)||(lv(t),a&&a.response&&(a.response.data=iv.call(t,t.transformResponse,a.response),a.response.headers=zi.from(a.response.headers))),Promise.reject(a)})}const kC="1.13.2",F0={};["object","boolean","number","function","string","symbol"].forEach((t,s)=>{F0[t]=function(a){return typeof a===t||"a"+(s<1?"n ":" ")+t}});const LN={};F0.transitional=function(s,r,a){function n(i,l){return"[Axios v"+kC+"] Transitional option '"+i+"'"+l+(a?". "+a:"")}return(i,l,o)=>{if(s===!1)throw new rr(n(l," has been removed"+(r?" in "+r:"")),rr.ERR_DEPRECATED);return r&&!LN[l]&&(LN[l]=!0,console.warn(n(l," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(i,l,o):!0}};F0.spelling=function(s){return(r,a)=>(console.warn(`${a} is likely a misspelling of ${s}`),!0)};function jT(t,s,r){if(typeof t!="object")throw new rr("options must be an object",rr.ERR_BAD_OPTION_VALUE);const a=Object.keys(t);let n=a.length;for(;n-- >0;){const i=a[n],l=s[i];if(l){const o=t[i],u=o===void 0||l(o,i,t);if(u!==!0)throw new rr("option "+i+" must be "+u,rr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new rr("Unknown option "+i,rr.ERR_BAD_OPTION)}}const _x={assertOptions:jT,validators:F0},Zo=_x.validators;let nA=class{constructor(s){this.defaults=s||{},this.interceptors={request:new jN,response:new jN}}async request(s,r){try{return await this._request(s,r)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const i=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?i&&!String(a.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+i):a.stack=i}catch{}}throw a}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=hA(this.defaults,r);const{transitional:a,paramsSerializer:n,headers:i}=r;a!==void 0&&_x.assertOptions(a,{silentJSONParsing:Zo.transitional(Zo.boolean),forcedJSONParsing:Zo.transitional(Zo.boolean),clarifyTimeoutError:Zo.transitional(Zo.boolean)},!1),n!=null&&(qt.isFunction(n)?r.paramsSerializer={serialize:n}:_x.assertOptions(n,{encode:Zo.function,serialize:Zo.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),_x.assertOptions(r,{baseUrl:Zo.spelling("baseURL"),withXsrfToken:Zo.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let l=i&&qt.merge(i.common,i[r.method]);i&&qt.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),r.headers=zi.concat(l,i);const o=[];let u=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(r)===!1||(u=u&&v.synchronous,o.unshift(v.fulfilled,v.rejected))});const d=[];this.interceptors.response.forEach(function(v){d.push(v.fulfilled,v.rejected)});let c,h=0,A;if(!u){const g=[IN.bind(this),void 0];for(g.unshift(...o),g.push(...d),A=g.length,c=Promise.resolve(r);h<A;)c=c.then(g[h++],g[h++]);return c}A=o.length;let f=r;for(;h<A;){const g=o[h++],v=o[h++];try{f=g(f)}catch(b){v.call(this,b);break}}try{c=IN.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,A=d.length;h<A;)c=c.then(d[h++],d[h++]);return c}getUri(s){s=hA(this.defaults,s);const r=wC(s.baseURL,s.url,s.allowAbsoluteUrls);return vC(r,s.params,s.paramsSerializer)}};qt.forEach(["delete","get","head","options"],function(s){nA.prototype[s]=function(r,a){return this.request(hA(a||{},{method:s,url:r,data:(a||{}).data}))}});qt.forEach(["post","put","patch"],function(s){function r(a){return function(i,l,o){return this.request(hA(o||{},{method:s,headers:a?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}nA.prototype[s]=r(),nA.prototype[s+"Form"]=r(!0)});let NT=class BC{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const a=this;this.promise.then(n=>{if(!a._listeners)return;let i=a._listeners.length;for(;i-- >0;)a._listeners[i](n);a._listeners=null}),this.promise.then=n=>{let i;const l=new Promise(o=>{a.subscribe(o),i=o}).then(n);return l.cancel=function(){a.unsubscribe(i)},l},s(function(i,l,o){a.reason||(a.reason=new Hh(i,l,o),r(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=a=>{s.abort(a)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new BC(function(n){s=n}),cancel:s}}};function wT(t){return function(r){return t.apply(null,r)}}function _T(t){return qt.isObject(t)&&t.isAxiosError===!0}const Bb={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Bb).forEach(([t,s])=>{Bb[s]=t});function EC(t){const s=new nA(t),r=lC(nA.prototype.request,s);return qt.extend(r,nA.prototype,s,{allOwnKeys:!0}),qt.extend(r,s,null,{allOwnKeys:!0}),r.create=function(n){return EC(hA(t,n))},r}const Va=EC(Lf);Va.Axios=nA;Va.CanceledError=Hh;Va.CancelToken=NT;Va.isCancel=jC;Va.VERSION=kC;Va.toFormData=E0;Va.AxiosError=rr;Va.Cancel=Va.CanceledError;Va.all=function(s){return Promise.all(s)};Va.spread=wT;Va.isAxiosError=_T;Va.mergeConfig=hA;Va.AxiosHeaders=zi;Va.formToJSON=t=>yC(qt.isHTMLForm(t)?new FormData(t):t);Va.getAdapter=CC.getAdapter;Va.HttpStatusCode=Bb;Va.default=Va;const{Axios:gee,AxiosError:vee,CanceledError:bee,isCancel:yee,CancelToken:jee,VERSION:Nee,all:wee,Cancel:_ee,isAxiosError:See,spread:Cee,toFormData:kee,AxiosHeaders:Bee,HttpStatusCode:Eee,formToJSON:Fee,getAdapter:Tee,mergeConfig:Iee}=Va;function ST(){const t=self.crypto||window.crypto;if(t!=null&&t.randomUUID)return t.randomUUID();const s=new Uint8Array(16);((t==null?void 0:t.getRandomValues)||(n=>n))(s),s[6]=s[6]&15|64,s[8]=s[8]&63|128;const a=Array.from(s,n=>n.toString(16).padStart(2,"0")).join("");return`${a.slice(0,8)}-${a.slice(8,12)}-${a.slice(12,16)}-${a.slice(16,20)}-${a.slice(20)}`}const CT="omnisuite_offline",kT=1,oc="queue";function T0(){return new Promise((t,s)=>{const r=indexedDB.open(CT,kT);r.onupgradeneeded=a=>{const n=r.result;if(!n.objectStoreNames.contains(oc)){const i=n.createObjectStore(oc,{keyPath:"id"});i.createIndex("status","status",{unique:!1}),i.createIndex("createdAt","createdAt",{unique:!1})}},r.onsuccess=()=>t(r.result),r.onerror=()=>s(r.error)})}async function FC(t){const s=await T0();return new Promise((r,a)=>{const n=s.transaction(oc,"readwrite");n.objectStore(oc).put(t),n.oncomplete=()=>r(t),n.onerror=()=>a(n.error)})}async function BT(){const t=await T0();return new Promise((s,r)=>{const l=t.transaction(oc,"readonly").objectStore(oc).index("status").getAll("pending");l.onsuccess=()=>s(l.result||[]),l.onerror=()=>r(l.error)})}async function DN(t,s,r){const a=await T0();return new Promise((n,i)=>{const l=a.transaction(oc,"readwrite"),o=l.objectStore(oc),u=o.get(t);u.onsuccess=()=>{const d=u.result;if(!d)return n(null);d.status=s,d.response=r||null,o.put(d)},l.oncomplete=()=>n(!0),l.onerror=()=>i(l.error)})}async function My(){const t=await T0();return new Promise((s,r)=>{const i=t.transaction(oc,"readonly").objectStore(oc).getAll();i.onsuccess=()=>s(i.result||[]),i.onerror=()=>r(i.error)})}const ET=5;let Sx=[],xl={pending:0,failed:0,completed:0,items:[]},ov=!1,UN=null;function Df(t,s){xl=(s==null?void 0:s.snapshot)||xl;for(const r of Sx)try{r({event:t,payload:s,snapshot:xl})}catch{}}async function Th(){const t=await My(),s=t.filter(n=>n.status==="pending").length,r=t.filter(n=>n.status==="failed").length,a=t.filter(n=>n.status==="completed").length;xl={pending:s,failed:r,completed:a,items:t},Df("update",{snapshot:xl})}function FT(t){return Sx.push(t),t({event:"init",payload:{},snapshot:xl}),()=>{Sx=Sx.filter(s=>s!==t)}}function TC(){return xl}async function TT({method:t,url:s,data:r,headers:a}){const n=ST(),i={id:n,method:t,url:s,data:r,headers:{...a||{},"x-idempotency-key":n,"x-transaction-id":n},status:"pending",retries:0,createdAt:Date.now()};return await FC(i),await Th(),Df("queued",{id:n,item:i,snapshot:xl}),navigator.onLine&&Cm(),{id:n,queued:!0,offline:!navigator.onLine}}async function Hy(t){try{const s=await ee.request({method:t.method,url:t.url,data:t.data,headers:t.headers});return await DN(t.id,"completed",(s==null?void 0:s.data)||null),await Th(),!0}catch{if(t.retries+=1,t.retries>=ET)return await DN(t.id,"failed",null),await Th(),!1;const s=Math.min(3e4,1e3*2**t.retries);return await new Promise(r=>setTimeout(r,s)),Hy(t)}}async function Cm(){if(ov)return;ov=!0;const t=await BT();for(const s of t)await Hy(s);await Th(),Df("synced",{snapshot:xl}),ov=!1}function IT(){window.addEventListener("online",()=>{DT(),Cm()}),navigator.onLine&&Cm(),UN||(UN=setInterval(()=>{navigator.onLine&&Cm()},3e4)),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&navigator.onLine&&Cm()})}async function LT(t){const r=(xl.items||await My()).find(a=>a.id===t);return r?(r.retries=0,r.status="pending",await FC(r),await Th(),Df("retry",{id:t,snapshot:xl}),Hy(r)):!1}async function DT(){const s=(xl.items||await My()).filter(r=>r.status==="failed");for(const r of s)await LT(r.id);await Th(),Df("retryAll",{snapshot:xl})}const ee=Va.create({headers:{"Content-Type":"application/json"},transformRequest:[(t,s)=>t&&typeof t=="object"&&!(t instanceof FormData)?JSON.stringify(t):t]}),UT="";let Qc=UT;Qc&&(/^https?:\/\//i.test(Qc)||(Qc=Qc.startsWith("/")?Qc:`/${Qc}`));const PT=typeof window<"u"&&window.location?String(window.location.hostname||""):"";Qc||/^serianamart\.omnisuite-erp\.com$/i.test(PT)&&(Qc="https://serianaserver.omnisuite-erp.com/api");ee.defaults.baseURL=Qc||"/api";IT();ee.interceptors.request.use(async t=>{const s=String(t.method||"get").toLowerCase();if(["post","put","patch","delete"].includes(s)&&!navigator.onLine){const r=await TT({method:s,url:t.url,data:t.data,headers:t.headers});return Promise.reject({isOfflineQueued:!0,queued:r,config:t,snapshot:TC()})}return t},t=>Promise.reject(t));ee.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&t.url!=="/register"&&(t.headers.Authorization=`Bearer ${s}`),t},t=>Promise.reject(t));ee.interceptors.response.use(t=>t&&typeof t=="object"?t:{data:t,status:200,statusText:"OK",headers:{},config:(t==null?void 0:t.config)||{}},t=>{var s,r,a,n;return t&&t.isOfflineQueued?Promise.resolve({data:{queued:!0,offline:!0,id:(s=t.queued)==null?void 0:s.id,snapshot:t.snapshot},status:202,statusText:"Accepted (queued)",headers:{},config:t.config}):(((r=t.response)==null?void 0:r.status)===401&&((n=(a=t.config)==null?void 0:a.headers)!=null&&n.Authorization)&&(localStorage.clear(),window.location.href="/login"),Promise.reject({message:t.message,response:t.response,config:t.config,isAxiosError:!0}))});function PN(t){t?ee.defaults.headers.common.Authorization=`Bearer ${t}`:delete ee.defaults.headers.common.Authorization}function RT({companyId:t,branchId:s}){t&&(ee.defaults.headers.common["x-company-id"]=String(t)),s&&(ee.defaults.headers.common["x-branch-id"]=String(s))}function OT(t){const s=t&&typeof t.id<"u"?Number(t.id):t&&typeof t.sub<"u"?Number(t.sub):null;s&&Number.isFinite(s)?ee.defaults.headers.common["x-user-id"]=String(s):delete ee.defaults.headers.common["x-user-id"]}const IC=x.createContext(null),cv="omnisuite.auth";function QT({children:t}){const[s,r]=x.useState(null),[a,n]=x.useState({sub:0,id:0,username:"dev",email:"dev@local",permissions:["*"],companyIds:[1],branchIds:[1]}),[i,l]=x.useState({companyId:1,branchId:1}),[o,u]=x.useState(!1),[d,c]=x.useState({patterns:[],modules:[]});x.useEffect(()=>{const N=localStorage.getItem(cv);if(N)try{const S=JSON.parse(N);S!=null&&S.token&&(r(S.token),n(S.user||null),l(S.scope||{companyId:1,branchId:1}))}catch{}u(!0)},[]),x.useLayoutEffect(()=>{PN(s)},[s]),x.useLayoutEffect(()=>{RT(i)},[i]),x.useLayoutEffect(()=>{OT(a||null)},[a]),x.useEffect(()=>{localStorage.setItem(cv,JSON.stringify({token:s,user:a,scope:i}))},[s,a,i]);async function h({username:N,password:S}){const B=await ee.post("/login",{username:N,password:S});return r(B.data.token),n(B.data.user),await v(B.data.user),B.data}x.useEffect(()=>{s&&a&&v(a)},[s,a]);async function A(){try{if(typeof window<"u"&&"serviceWorker"in navigator){const S=await(await navigator.serviceWorker.ready).pushManager.getSubscription();if(S&&S.endpoint){try{await ee.delete("/push/unsubscribe",{data:{subscription:S.toJSON()}})}catch{}try{await S.unsubscribe()}catch{}}}}catch{}r(null),n(null),l({companyId:1,branchId:1}),PN(null);try{localStorage.removeItem(cv)}catch{}c({patterns:[],modules:[]})}function f(N){const S="^"+String(N||"").replace(/:[^/]+/g,"[^/]+")+"$";return new RegExp(S)}function g(N=[],S=[]){const B={};for(const q of N)B[q.id]=q;const P={};for(const q of N)q!=null&&q.path&&(P[q.path]={path:q.path,module:q.module||"",can_view:1,can_create:0,can_edit:0,can_delete:0});for(const q of S){const V=B[q.page_id];!V||!V.path||(P[V.path]={path:V.path,module:V.module||"",can_view:Number(q.can_view)?1:0,can_create:Number(q.can_create)?1:0,can_edit:Number(q.can_edit)?1:0,can_delete:Number(q.can_delete)?1:0})}const L=Object.values(P).map(q=>({pattern:q.path,module:q.module,can_view:q.can_view,can_create:q.can_create,can_edit:q.can_edit,can_delete:q.can_delete,regex:f(q.path)})),U=[],H=new Set;for(const q of L)q.can_view&&q.module&&!H.has(q.module)&&(H.add(q.module),U.push(q.module));c({patterns:L,modules:U})}async function v(N){var B,P;const S=Number(N==null?void 0:N.sub)||Number(N==null?void 0:N.id)||Number(a==null?void 0:a.sub)||Number(a==null?void 0:a.id);if(!Number.isFinite(S)||S<=0){c({patterns:[],modules:[]});return}try{const L=await ee.get(`/admin/users/${S}/permissions-context`),U=Array.isArray((B=L.data)==null?void 0:B.pages)?L.data.pages:[],H=Array.isArray((P=L.data)==null?void 0:P.permissions)?L.data.permissions:[];g(U,H)}catch{c({patterns:[],modules:[]})}}function b(N,S="view"){if(!Array.isArray(d.patterns)||d.patterns.length===0)return!0;const B=String(N||""),P=/\/edit$/.test(B),L=/(\/new|\/create)$/.test(B);let U=d.patterns.find(H=>H.pattern===B)||d.patterns.find(H=>H.regex.test(B));if(P){const H=B.replace(/\/edit$/,""),q=d.patterns.find(V=>V.pattern===H)||d.patterns.find(V=>V.regex.test(H));return q?!!(q.can_view||q.can_edit):U?!!(U.can_edit||U.can_view):!0}if(L){const H=B.replace(/\/(new|create)$/,""),q=d.patterns.find(V=>V.pattern===H)||d.patterns.find(V=>V.regex.test(H));return q?!!(q.can_create||q.can_view):U?!!(U.can_create||U.can_view):!0}return U?S==="create"?!!U.can_create:S==="edit"?!!U.can_edit:S==="delete"?!!U.can_delete:!!U.can_view:!0}function y(N){return!Array.isArray(d.modules)||d.modules.length===0?!0:d.modules.includes(String(N||""))}const j=x.useMemo(()=>({token:s,user:a,scope:i,initialized:o,setScope:l,login:h,logout:A,hasAccess:b,hasModuleAccess:y}),[s,a,i,o,d]);return e.jsx(IC.Provider,{value:j,children:t})}function ca(){const t=x.useContext(IC);return t||{token:null,user:null,scope:{companyId:1,branchId:1},initialized:!0,setScope:()=>{},login:async()=>({}),logout:()=>{},hasAccess:()=>!0,hasModuleAccess:()=>!0}}const LC=x.createContext(null),RN="omnisuite.theme";function MT({children:t}){const[s,r]=x.useState("light");x.useEffect(()=>{const i=localStorage.getItem(RN);if(i==="light"||i==="dark"){r(i);return}const l=typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches;r(l?"light":"dark")},[]),x.useEffect(()=>{s==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),localStorage.setItem(RN,s)},[s]);function a(){r(i=>i==="dark"?"light":"dark")}const n=x.useMemo(()=>({theme:s,setTheme:r,toggleTheme:a}),[s]);return e.jsx(LC.Provider,{value:n,children:t})}function DC(){const t=x.useContext(LC);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t}function ON({children:t}){const{token:s,initialized:r,user:a,scope:n,setScope:i,hasAccess:l}=ca(),o=ma();if(!r)return null;if(!s)return e.jsx(Hc,{to:"/login",replace:!0});const u=Array.isArray(a==null?void 0:a.branchIds)?a.branchIds.map(Number).filter(g=>Number.isFinite(g)):[],d=Number(n==null?void 0:n.branchId);if(u.length<=1){const g=u[0];if(Number.isFinite(g)&&d!==g){const v=Array.isArray(a==null?void 0:a.companyIds)?a.companyIds.map(Number).filter(y=>Number.isFinite(y)):[],b=v.length===1?v[0]:(n==null?void 0:n.companyId)||1;i(y=>({...y,companyId:b,branchId:g}))}if(o.pathname==="/select-branch")return e.jsx(Hc,{to:"/",replace:!0})}else{if(o.pathname==="/select-branch")return t;if(!u.includes(d))return e.jsx(Hc,{to:"/select-branch",replace:!0})}const c=o.pathname;if(c==="/"||c==="/dashboard")return t;const h=/(\/new|\/create)$/.test(c),A=/\/edit$/.test(c);return l(c,h?"create":A?"edit":"view")?t:e.jsx(Hc,{to:"/",replace:!0})}const qy="/assets/OMNISUITE_LOGO_CLEAR-E0tTLZi8.png",Vy="/assets/BACKGROUND-DBCOBMBw.jpg";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qT=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,r,a)=>a?a.toUpperCase():r.toLowerCase()),QN=t=>{const s=qT(t);return s.charAt(0).toUpperCase()+s.slice(1)},UC=(...t)=>t.filter((s,r,a)=>!!s&&s.trim()!==""&&a.indexOf(s)===r).join(" ").trim(),VT=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $T={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=x.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:i,iconNode:l,...o},u)=>x.createElement("svg",{ref:u,...$T,width:s,height:s,stroke:t,strokeWidth:a?Number(r)*24/Number(s):r,className:UC("lucide",n),...!i&&!VT(o)&&{"aria-hidden":"true"},...o},[...l.map(([d,c])=>x.createElement(d,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=(t,s)=>{const r=x.forwardRef(({className:a,...n},i)=>x.createElement(WT,{ref:i,iconNode:s,className:UC(`lucide-${HT(QN(t))}`,`lucide-${t}`,a),...n}));return r.displayName=QN(t),r};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],KT=Zr("arrow-down",GT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Uf=Zr("arrow-left",zT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],XT=Zr("bell",YT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],ZT=Zr("check",JT);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],tI=Zr("circle-alert",eI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],rI=Zr("circle-check-big",sI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Yc=Zr("download",aI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],$y=Zr("eye-off",nI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],I0=Zr("eye",iI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Wy=Zr("file-text",lI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],MN=Zr("folder-tree",oI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],dI=Zr("funnel",cI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],AI=Zr("mail",uI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Jd=Zr("package",hI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],xu=Zr("plus",mI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],qh=Zr("printer",fI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],xI=Zr("rotate-ccw",pI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],HN=Zr("ruler",gI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Vh=Zr("save",vI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],L0=Zr("search",bI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],eA=Zr("square-pen",yI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Hl=Zr("trash-2",jI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],wI=Zr("trash",NI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Eb=Zr("triangle-alert",_I);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]],CI=Zr("warehouse",SI);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],PC=Zr("x",kI);function BI(){const t=ys(),{login:s,setScope:r}=ca(),[a,n]=x.useState(""),[i,l]=x.useState(""),[o,u]=x.useState(null),[d,c]=x.useState(!1),[h,A]=x.useState(!1);async function f(g){var v,b,y,j,N;g.preventDefault(),u(null),c(!0);try{const S=await s({username:a,password:i}),B=Array.isArray((v=S==null?void 0:S.user)==null?void 0:v.branchIds)?S.user.branchIds.map(Number).filter(L=>Number.isFinite(L)):[],P=Array.isArray((b=S==null?void 0:S.user)==null?void 0:b.companyIds)?S.user.companyIds.map(Number).filter(L=>Number.isFinite(L)):[];if(B.length===1){const L=B[0];let U=P.length===1?P[0]:null;if(!U)try{const H=await ee.get("/admin/branches"),V=(Array.isArray((y=H.data)==null?void 0:y.items)?H.data.items:[]).find(M=>Number(M.id)===Number(L));V&&(U=Number(V.company_id))}catch{U=P[0]||1}r(H=>({...H,companyId:U||H.companyId||1,branchId:L})),t("/",{replace:!0})}else t("/select-branch",{replace:!0})}catch(S){const B=((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||(S==null?void 0:S.message)||"Login failed";u(B),nt.error(B)}finally{c(!1)}}return e.jsx("div",{className:"min-h-screen grid place-items-center bg-gradient-to-br from-brand-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",style:{backgroundImage:`url(${Vy})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-[400px]",children:e.jsxs("div",{className:"card shadow-erp-lg p-8",style:{backgroundColor:"rgba(255,255,255,0.7)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-8 ml-7",children:e.jsxs("div",{children:[e.jsx("div",{className:"items-center ml-9 mt-3 mb-4",children:e.jsx("img",{src:qy,alt:"OmniSuite",className:"h-14 w-auto"})}),e.jsx("div",{className:"items-center text-xl font-bold text-slate-600 dark:text-slate-400 mb-0 mt-4",children:"Enterprise Resource Planning"})]})}),o?e.jsx("div",{className:"mb-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:o}):null,e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",value:a,onChange:g=>n(g.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:h?"text":"password",className:"input pr-10",value:i,onChange:g=>l(g.target.value),required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center text-slate-500",onClick:()=>A(g=>!g),"aria-label":h?"Hide password":"Show password",children:h?e.jsx($y,{size:18}):e.jsx(I0,{size:18})})]})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full mt-6",disabled:d,children:d?"Signing in":"Sign in"}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(Le,{to:"/forgot-password",className:"text-sm text-brand-700 hover:underline",children:"Forgot password?"})})]})]})})})}function EI(){const t=ys(),[s,r]=x.useState(""),[a,n]=x.useState(""),[i,l]=x.useState(!1),[o,u]=x.useState(null);async function d(c){var h,A;c.preventDefault(),u(null),l(!0);try{await ee.post("/forgot-password/request-otp",{username:s,email:a}),nt.success("OTP sent to your registered email"),t("/reset-password",{replace:!0})}catch(f){const g=((A=(h=f==null?void 0:f.response)==null?void 0:h.data)==null?void 0:A.message)||(f==null?void 0:f.message)||"Failed to request OTP";u(g),nt.error(g)}finally{l(!1)}}return e.jsx("div",{className:"min-h-screen grid place-items-center bg-gradient-to-br from-brand-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",style:{backgroundImage:`url(${Vy})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-[420px]",children:e.jsxs("div",{className:"card shadow-erp-lg p-8",style:{backgroundColor:"rgba(255,255,255,0.7)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-6 ml-7",children:e.jsxs("div",{children:[e.jsx("div",{className:"items-center ml-9 mt-3 mb-3",children:e.jsx("img",{src:qy,alt:"OmniSuite",className:"h-14 w-auto"})}),e.jsx("div",{className:"items-center text-xl font-bold text-slate-600 dark:text-slate-400 mb-0 mt-2",children:"Password Reset"})]})}),o?e.jsx("div",{className:"mb-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:o}):null,e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",value:s,onChange:c=>r(c.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",className:"input",value:a,onChange:c=>n(c.target.value),required:!0})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full mt-4",disabled:i,children:i?"Sending OTP":"Send OTP"}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(Le,{to:"/login",className:"text-sm text-brand-700 hover:underline",children:"Back to login"})})]})]})})})}function FI(){const t=ys(),[s,r]=x.useState(""),[a,n]=x.useState(""),[i,l]=x.useState(""),[o,u]=x.useState(!1),[d,c]=x.useState(null),[h,A]=x.useState(!1);async function f(g){var v,b;g.preventDefault(),c(null),u(!0);try{await ee.post("/forgot-password/reset",{username:s,otp:a,new_password:i}),nt.success("Password reset successfully"),t("/login",{replace:!0})}catch(y){const j=((b=(v=y==null?void 0:y.response)==null?void 0:v.data)==null?void 0:b.message)||(y==null?void 0:y.message)||"Failed to reset password";c(j),nt.error(j)}finally{u(!1)}}return e.jsx("div",{className:"min-h-screen grid place-items-center bg-gradient-to-br from-brand-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 p-6",style:{backgroundImage:`url(${Vy})`,backgroundSize:"cover",backgroundPosition:"center"},children:e.jsx("div",{className:"w-full max-w-[420px]",children:e.jsxs("div",{className:"card shadow-erp-lg p-8",style:{backgroundColor:"rgba(255,255,255,0.7)"},children:[e.jsx("div",{className:"flex items-center gap-4 mb-6 ml-7",children:e.jsxs("div",{children:[e.jsx("div",{className:"items-center ml-9 mt-3 mb-3",children:e.jsx("img",{src:qy,alt:"OmniSuite",className:"h-14 w-auto"})}),e.jsx("div",{className:"items-center text-xl font-bold text-slate-600 dark:text-slate-400 mb-0 mt-2",children:"Enter OTP and New Password"})]})}),d?e.jsx("div",{className:"mb-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:d}):null,e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username"}),e.jsx("input",{type:"text",className:"input",value:s,onChange:g=>r(g.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"OTP Code"}),e.jsx("input",{type:"text",className:"input",value:a,onChange:g=>n(g.target.value),inputMode:"numeric",pattern:"\\\\d{6}",placeholder:"6-digit code",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:h?"text":"password",className:"input pr-10",value:i,onChange:g=>l(g.target.value),required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center text-slate-500",onClick:()=>A(g=>!g),"aria-label":h?"Hide password":"Show password",children:h?e.jsx($y,{size:18}):e.jsx(I0,{size:18})})]})]}),e.jsx("button",{type:"submit",className:"btn-primary w-full mt-4",disabled:o,children:o?"Resetting":"Reset Password"}),e.jsx("div",{className:"mt-3 text-right",children:e.jsx(Le,{to:"/login",className:"text-sm text-brand-700 hover:underline",children:"Back to login"})})]})]})})})}var dv={exports:{}},uv={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qN;function TI(){if(qN)return uv;qN=1;var t=Rh();function s(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var r=typeof Object.is=="function"?Object.is:s,a=t.useSyncExternalStore,n=t.useRef,i=t.useEffect,l=t.useMemo,o=t.useDebugValue;return uv.useSyncExternalStoreWithSelector=function(u,d,c,h,A){var f=n(null);if(f.current===null){var g={hasValue:!1,value:null};f.current=g}else g=f.current;f=l(function(){function b(B){if(!y){if(y=!0,j=B,B=h(B),A!==void 0&&g.hasValue){var P=g.value;if(A(P,B))return N=P}return N=B}if(P=N,r(j,B))return P;var L=h(B);return A!==void 0&&A(P,L)?(j=B,P):(j=B,N=L)}var y=!1,j,N,S=c===void 0?null:c;return[function(){return b(d())},S===null?void 0:function(){return b(S())}]},[d,c,h,A]);var v=a(u,f[0],f[1]);return i(function(){g.hasValue=!0,g.value=v},[v]),o(v),v},uv}var VN;function II(){return VN||(VN=1,dv.exports=TI()),dv.exports}var LI=II();function DI(t){t()}function UI(){let t=null,s=null;return{clear(){t=null,s=null},notify(){DI(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=t;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const n=s={callback:r,next:null,prev:s};return n.prev?n.prev.next=n:t=n,function(){!a||t===null||(a=!1,n.next?n.next.prev=n.prev:s=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var $N={notify(){},get:()=>[]};function PI(t,s){let r,a=$N,n=0,i=!1;function l(v){c();const b=a.subscribe(v);let y=!1;return()=>{y||(y=!0,b(),h())}}function o(){a.notify()}function u(){g.onStateChange&&g.onStateChange()}function d(){return i}function c(){n++,r||(r=t.subscribe(u),a=UI())}function h(){n--,r&&n===0&&(r(),r=void 0,a.clear(),a=$N)}function A(){i||(i=!0,c())}function f(){i&&(i=!1,h())}const g={addNestedSub:l,notifyNestedSubs:o,handleChangeWrapper:u,isSubscribed:d,trySubscribe:A,tryUnsubscribe:f,getListeners:()=>a};return g}var RI=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",OI=RI(),QI=()=>typeof navigator<"u"&&navigator.product==="ReactNative",MI=QI(),HI=()=>OI||MI?x.useLayoutEffect:x.useEffect,qI=HI(),Av=Symbol.for("react-redux-context"),hv=typeof globalThis<"u"?globalThis:{};function VI(){if(!x.createContext)return{};const t=hv[Av]??(hv[Av]=new Map);let s=t.get(x.createContext);return s||(s=x.createContext(null),t.set(x.createContext,s)),s}var ou=VI();function $I(t){const{children:s,context:r,serverState:a,store:n}=t,i=x.useMemo(()=>{const u=PI(n);return{store:n,subscription:u,getServerState:a?()=>a:void 0}},[n,a]),l=x.useMemo(()=>n.getState(),[n]);qI(()=>{const{subscription:u}=i;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),l!==n.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[i,l]);const o=r||ou;return x.createElement(o.Provider,{value:i},s)}var WI=$I;function Gy(t=ou){return function(){return x.useContext(t)}}var RC=Gy();function OC(t=ou){const s=t===ou?RC:Gy(t),r=()=>{const{store:a}=s();return a};return Object.assign(r,{withTypes:()=>r}),r}var GI=OC();function KI(t=ou){const s=t===ou?GI:OC(t),r=()=>s().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var Ky=KI(),zI=(t,s)=>t===s;function YI(t=ou){const s=t===ou?RC:Gy(t),r=(a,n={})=>{const{equalityFn:i=zI}=typeof n=="function"?{equalityFn:n}:n,l=s(),{store:o,subscription:u,getServerState:d}=l;x.useRef(!0);const c=x.useCallback({[a.name](A){return a(A)}}[a.name],[a]),h=LI.useSyncExternalStoreWithSelector(u.addNestedSub,o.getState,d||o.getState,c,i);return x.useDebugValue(h),h};return Object.assign(r,{withTypes:()=>r}),r}var Vc=YI();function Dn(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var XI=typeof Symbol=="function"&&Symbol.observable||"@@observable",WN=XI,mv=()=>Math.random().toString(36).substring(7).split("").join("."),JI={INIT:`@@redux/INIT${mv()}`,REPLACE:`@@redux/REPLACE${mv()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${mv()}`},Mx=JI;function zy(t){if(typeof t!="object"||t===null)return!1;let s=t;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(t)===s||Object.getPrototypeOf(t)===null}function QC(t,s,r){if(typeof t!="function")throw new Error(Dn(2));if(typeof s=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Dn(0));if(typeof s=="function"&&typeof r>"u"&&(r=s,s=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Dn(1));return r(QC)(t,s)}let a=t,n=s,i=new Map,l=i,o=0,u=!1;function d(){l===i&&(l=new Map,i.forEach((b,y)=>{l.set(y,b)}))}function c(){if(u)throw new Error(Dn(3));return n}function h(b){if(typeof b!="function")throw new Error(Dn(4));if(u)throw new Error(Dn(5));let y=!0;d();const j=o++;return l.set(j,b),function(){if(y){if(u)throw new Error(Dn(6));y=!1,d(),l.delete(j),i=null}}}function A(b){if(!zy(b))throw new Error(Dn(7));if(typeof b.type>"u")throw new Error(Dn(8));if(typeof b.type!="string")throw new Error(Dn(17));if(u)throw new Error(Dn(9));try{u=!0,n=a(n,b)}finally{u=!1}return(i=l).forEach(j=>{j()}),b}function f(b){if(typeof b!="function")throw new Error(Dn(10));a=b,A({type:Mx.REPLACE})}function g(){const b=h;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Dn(11));function j(){const S=y;S.next&&S.next(c())}return j(),{unsubscribe:b(j)}},[WN](){return this}}}return A({type:Mx.INIT}),{dispatch:A,subscribe:h,getState:c,replaceReducer:f,[WN]:g}}function ZI(t){Object.keys(t).forEach(s=>{const r=t[s];if(typeof r(void 0,{type:Mx.INIT})>"u")throw new Error(Dn(12));if(typeof r(void 0,{type:Mx.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Dn(13))})}function e6(t){const s=Object.keys(t),r={};for(let i=0;i<s.length;i++){const l=s[i];typeof t[l]=="function"&&(r[l]=t[l])}const a=Object.keys(r);let n;try{ZI(r)}catch(i){n=i}return function(l={},o){if(n)throw n;let u=!1;const d={};for(let c=0;c<a.length;c++){const h=a[c],A=r[h],f=l[h],g=A(f,o);if(typeof g>"u")throw o&&o.type,new Error(Dn(14));d[h]=g,u=u||g!==f}return u=u||a.length!==Object.keys(l).length,u?d:l}}function Hx(...t){return t.length===0?s=>s:t.length===1?t[0]:t.reduce((s,r)=>(...a)=>s(r(...a)))}function t6(...t){return s=>(r,a)=>{const n=s(r,a);let i=()=>{throw new Error(Dn(15))};const l={getState:n.getState,dispatch:(u,...d)=>i(u,...d)},o=t.map(u=>u(l));return i=Hx(...o)(n.dispatch),{...n,dispatch:i}}}function s6(t){return zy(t)&&"type"in t&&typeof t.type=="string"}var MC=Symbol.for("immer-nothing"),GN=Symbol.for("immer-draftable"),Ii=Symbol.for("immer-state");function So(t,...s){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var fl=Object,Ih=fl.getPrototypeOf,qx="constructor",D0="prototype",Fb="configurable",Vx="enumerable",Cx="writable",of="value",Xc=t=>!!t&&!!t[Ii];function Fo(t){var s;return t?HC(t)||P0(t)||!!t[GN]||!!((s=t[qx])!=null&&s[GN])||R0(t)||O0(t):!1}var r6=fl[D0][qx].toString(),KN=new WeakMap;function HC(t){if(!t||!Yy(t))return!1;const s=Ih(t);if(s===null||s===fl[D0])return!0;const r=fl.hasOwnProperty.call(s,qx)&&s[qx];if(r===Object)return!0;if(!uh(r))return!1;let a=KN.get(r);return a===void 0&&(a=Function.toString.call(r),KN.set(r,a)),a===r6}function U0(t,s,r=!0){Pf(t)===0?(r?Reflect.ownKeys(t):fl.keys(t)).forEach(n=>{s(n,t[n],t)}):t.forEach((a,n)=>s(n,a,t))}function Pf(t){const s=t[Ii];return s?s.type_:P0(t)?1:R0(t)?2:O0(t)?3:0}var zN=(t,s,r=Pf(t))=>r===2?t.has(s):fl[D0].hasOwnProperty.call(t,s),Tb=(t,s,r=Pf(t))=>r===2?t.get(s):t[s],$x=(t,s,r,a=Pf(t))=>{a===2?t.set(s,r):a===3?t.add(r):t[s]=r};function a6(t,s){return t===s?t!==0||1/t===1/s:t!==t&&s!==s}var P0=Array.isArray,R0=t=>t instanceof Map,O0=t=>t instanceof Set,Yy=t=>typeof t=="object",uh=t=>typeof t=="function",fv=t=>typeof t=="boolean";function n6(t){const s=+t;return Number.isInteger(s)&&String(s)===t}var Mc=t=>t.copy_||t.base_,Xy=t=>t.modified_?t.copy_:t.base_;function Ib(t,s){if(R0(t))return new Map(t);if(O0(t))return new Set(t);if(P0(t))return Array[D0].slice.call(t);const r=HC(t);if(s===!0||s==="class_only"&&!r){const a=fl.getOwnPropertyDescriptors(t);delete a[Ii];let n=Reflect.ownKeys(a);for(let i=0;i<n.length;i++){const l=n[i],o=a[l];o[Cx]===!1&&(o[Cx]=!0,o[Fb]=!0),(o.get||o.set)&&(a[l]={[Fb]:!0,[Cx]:!0,[Vx]:o[Vx],[of]:t[l]})}return fl.create(Ih(t),a)}else{const a=Ih(t);if(a!==null&&r)return{...t};const n=fl.create(a);return fl.assign(n,t)}}function Jy(t,s=!1){return Q0(t)||Xc(t)||!Fo(t)||(Pf(t)>1&&fl.defineProperties(t,{set:Tp,add:Tp,clear:Tp,delete:Tp}),fl.freeze(t),s&&U0(t,(r,a)=>{Jy(a,!0)},!1)),t}function i6(){So(2)}var Tp={[of]:i6};function Q0(t){return t===null||!Yy(t)?!0:fl.isFrozen(t)}var Wx="MapSet",Lb="Patches",YN="ArrayMethods",qC={};function mA(t){const s=qC[t];return s||So(0,t),s}var XN=t=>!!qC[t],cf,VC=()=>cf,l6=(t,s)=>({drafts_:[],parent_:t,immer_:s,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:XN(Wx)?mA(Wx):void 0,arrayMethodsPlugin_:XN(YN)?mA(YN):void 0});function JN(t,s){s&&(t.patchPlugin_=mA(Lb),t.patches_=[],t.inversePatches_=[],t.patchListener_=s)}function Db(t){Ub(t),t.drafts_.forEach(o6),t.drafts_=null}function Ub(t){t===cf&&(cf=t.parent_)}var ZN=t=>cf=l6(cf,t);function o6(t){const s=t[Ii];s.type_===0||s.type_===1?s.revoke_():s.revoked_=!0}function ew(t,s){s.unfinalizedDrafts_=s.drafts_.length;const r=s.drafts_[0];if(t!==void 0&&t!==r){r[Ii].modified_&&(Db(s),So(4)),Fo(t)&&(t=tw(s,t));const{patchPlugin_:n}=s;n&&n.generateReplacementPatches_(r[Ii].base_,t,s)}else t=tw(s,r);return c6(s,t,!0),Db(s),s.patches_&&s.patchListener_(s.patches_,s.inversePatches_),t!==MC?t:void 0}function tw(t,s){if(Q0(s))return s;const r=s[Ii];if(!r)return Gx(s,t.handledSet_,t);if(!M0(r,t))return s;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:a}=r;if(a)for(;a.length>0;)a.pop()(t);GC(r,t)}return r.copy_}function c6(t,s,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Jy(s,r)}function $C(t){t.finalized_=!0,t.scope_.unfinalizedDrafts_--}var M0=(t,s)=>t.scope_===s,d6=[];function WC(t,s,r,a){const n=Mc(t),i=t.type_;if(a!==void 0&&Tb(n,a,i)===s){$x(n,a,r,i);return}if(!t.draftLocations_){const o=t.draftLocations_=new Map;U0(n,(u,d)=>{if(Xc(d)){const c=o.get(d)||[];c.push(u),o.set(d,c)}})}const l=t.draftLocations_.get(s)??d6;for(const o of l)$x(n,o,r,i)}function u6(t,s,r){t.callbacks_.push(function(n){var o;const i=s;if(!i||!M0(i,n))return;(o=n.mapSetPlugin_)==null||o.fixSetContents(i);const l=Xy(i);WC(t,i.draft_??i,l,r),GC(i,n)})}function GC(t,s){var a;if(t.modified_&&!t.finalized_&&(t.type_===3||t.type_===1&&t.allIndicesReassigned_||(((a=t.assigned_)==null?void 0:a.size)??0)>0)){const{patchPlugin_:n}=s;if(n){const i=n.getPath(t);i&&n.generatePatches_(t,i,s)}$C(t)}}function A6(t,s,r){const{scope_:a}=t;if(Xc(r)){const n=r[Ii];M0(n,a)&&n.callbacks_.push(function(){kx(t);const l=Xy(n);WC(t,r,l,s)})}else Fo(r)&&t.callbacks_.push(function(){const i=Mc(t);t.type_===3?i.has(r)&&Gx(r,a.handledSet_,a):Tb(i,s,t.type_)===r&&a.drafts_.length>1&&(t.assigned_.get(s)??!1)===!0&&t.copy_&&Gx(Tb(t.copy_,s,t.type_),a.handledSet_,a)})}function Gx(t,s,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Xc(t)||s.has(t)||!Fo(t)||Q0(t)||(s.add(t),U0(t,(a,n)=>{if(Xc(n)){const i=n[Ii];if(M0(i,r)){const l=Xy(i);$x(t,a,l,t.type_),$C(i)}}else Fo(n)&&Gx(n,s,r)})),t}function h6(t,s){const r=P0(t),a={type_:r?1:0,scope_:s?s.scope_:VC(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:s,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let n=a,i=Kx;r&&(n=[a],i=df);const{revoke:l,proxy:o}=Proxy.revocable(n,i);return a.draft_=o,a.revoke_=l,[o,a]}var Kx={get(t,s){if(s===Ii)return t;let r=t.scope_.arrayMethodsPlugin_;const a=t.type_===1&&typeof s=="string";if(a&&r!=null&&r.isArrayOperationMethod(s))return r.createMethodInterceptor(t,s);const n=Mc(t);if(!zN(n,s,t.type_))return m6(t,n,s);const i=n[s];if(t.finalized_||!Fo(i)||a&&t.operationMethod&&(r!=null&&r.isMutatingArrayMethod(t.operationMethod))&&n6(s))return i;if(i===pv(t.base_,s)){kx(t);const l=t.type_===1?+s:s,o=Rb(t.scope_,i,t,l);return t.copy_[l]=o}return i},has(t,s){return s in Mc(t)},ownKeys(t){return Reflect.ownKeys(Mc(t))},set(t,s,r){const a=KC(Mc(t),s);if(a!=null&&a.set)return a.set.call(t.draft_,r),!0;if(!t.modified_){const n=pv(Mc(t),s),i=n==null?void 0:n[Ii];if(i&&i.base_===r)return t.copy_[s]=r,t.assigned_.set(s,!1),!0;if(a6(r,n)&&(r!==void 0||zN(t.base_,s,t.type_)))return!0;kx(t),Pb(t)}return t.copy_[s]===r&&(r!==void 0||s in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[s])||(t.copy_[s]=r,t.assigned_.set(s,!0),A6(t,s,r)),!0},deleteProperty(t,s){return kx(t),pv(t.base_,s)!==void 0||s in t.base_?(t.assigned_.set(s,!1),Pb(t)):t.assigned_.delete(s),t.copy_&&delete t.copy_[s],!0},getOwnPropertyDescriptor(t,s){const r=Mc(t),a=Reflect.getOwnPropertyDescriptor(r,s);return a&&{[Cx]:!0,[Fb]:t.type_!==1||s!=="length",[Vx]:a[Vx],[of]:r[s]}},defineProperty(){So(11)},getPrototypeOf(t){return Ih(t.base_)},setPrototypeOf(){So(12)}},df={};for(let t in Kx){let s=Kx[t];df[t]=function(){const r=arguments;return r[0]=r[0][0],s.apply(this,r)}}df.deleteProperty=function(t,s){return df.set.call(this,t,s,void 0)};df.set=function(t,s,r){return Kx.set.call(this,t[0],s,r,t[0])};function pv(t,s){const r=t[Ii];return(r?Mc(r):t)[s]}function m6(t,s,r){var n;const a=KC(s,r);return a?of in a?a[of]:(n=a.get)==null?void 0:n.call(t.draft_):void 0}function KC(t,s){if(!(s in t))return;let r=Ih(t);for(;r;){const a=Object.getOwnPropertyDescriptor(r,s);if(a)return a;r=Ih(r)}}function Pb(t){t.modified_||(t.modified_=!0,t.parent_&&Pb(t.parent_))}function kx(t){t.copy_||(t.assigned_=new Map,t.copy_=Ib(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var f6=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(s,r,a)=>{if(uh(s)&&!uh(r)){const i=r;r=s;const l=this;return function(u=i,...d){return l.produce(u,c=>r.call(this,c,...d))}}uh(r)||So(6),a!==void 0&&!uh(a)&&So(7);let n;if(Fo(s)){const i=ZN(this),l=Rb(i,s,void 0);let o=!0;try{n=r(l),o=!1}finally{o?Db(i):Ub(i)}return JN(i,a),ew(n,i)}else if(!s||!Yy(s)){if(n=r(s),n===void 0&&(n=s),n===MC&&(n=void 0),this.autoFreeze_&&Jy(n,!0),a){const i=[],l=[];mA(Lb).generateReplacementPatches_(s,n,{patches_:i,inversePatches_:l}),a(i,l)}return n}else So(1,s)},this.produceWithPatches=(s,r)=>{if(uh(s))return(l,...o)=>this.produceWithPatches(l,u=>s(u,...o));let a,n;return[this.produce(s,r,(l,o)=>{a=l,n=o}),a,n]},fv(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),fv(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),fv(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Fo(t)||So(8),Xc(t)&&(t=p6(t));const s=ZN(this),r=Rb(s,t,void 0);return r[Ii].isManual_=!0,Ub(s),r}finishDraft(t,s){const r=t&&t[Ii];(!r||!r.isManual_)&&So(9);const{scope_:a}=r;return JN(a,s),ew(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,s){let r;for(r=s.length-1;r>=0;r--){const n=s[r];if(n.path.length===0&&n.op==="replace"){t=n.value;break}}r>-1&&(s=s.slice(r+1));const a=mA(Lb).applyPatches_;return Xc(t)?a(t,s):this.produce(t,n=>a(n,s))}};function Rb(t,s,r,a){const[n,i]=R0(s)?mA(Wx).proxyMap_(s,r):O0(s)?mA(Wx).proxySet_(s,r):h6(s,r);return((r==null?void 0:r.scope_)??VC()).drafts_.push(n),i.callbacks_=(r==null?void 0:r.callbacks_)??[],i.key_=a,r&&a!==void 0?u6(r,i,a):i.callbacks_.push(function(u){var c;(c=u.mapSetPlugin_)==null||c.fixSetContents(i);const{patchPlugin_:d}=u;i.modified_&&d&&d.generatePatches_(i,[],u)}),n}function p6(t){return Xc(t)||So(10,t),zC(t)}function zC(t){if(!Fo(t)||Q0(t))return t;const s=t[Ii];let r,a=!0;if(s){if(!s.modified_)return s.base_;s.finalized_=!0,r=Ib(t,s.scope_.immer_.useStrictShallowCopy_),a=s.scope_.immer_.shouldUseStrictIteration()}else r=Ib(t,!0);return U0(r,(n,i)=>{$x(r,n,zC(i))},a),s&&(s.finalized_=!1),r}var x6=new f6,YC=x6.produce;function XC(t){return({dispatch:r,getState:a})=>n=>i=>typeof i=="function"?i(r,a,t):n(i)}var g6=XC(),v6=XC,b6=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Hx:Hx.apply(null,arguments)},y6=t=>t&&typeof t.match=="function";function Qm(t,s){function r(...a){if(s){let n=s(...a);if(!n)throw new Error($c(0));return{type:t,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:t,payload:a[0]}}return r.toString=()=>`${t}`,r.type=t,r.match=a=>s6(a)&&a.type===t,r}var JC=class km extends Array{constructor(...s){super(...s),Object.setPrototypeOf(this,km.prototype)}static get[Symbol.species](){return km}concat(...s){return super.concat.apply(this,s)}prepend(...s){return s.length===1&&Array.isArray(s[0])?new km(...s[0].concat(this)):new km(...s.concat(this))}};function sw(t){return Fo(t)?YC(t,()=>{}):t}function Ip(t,s,r){return t.has(s)?t.get(s):t.set(s,r(s)).get(s)}function j6(t){return typeof t=="boolean"}var N6=()=>function(s){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:n=!0,actionCreatorCheck:i=!0}=s??{};let l=new JC;return r&&(j6(r)?l.push(g6):l.push(v6(r.extraArgument))),l},w6="RTK_autoBatch",rw=t=>s=>{setTimeout(s,t)},_6=(t={type:"raf"})=>s=>(...r)=>{const a=s(...r);let n=!0,i=!1,l=!1;const o=new Set,u=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:rw(10):t.type==="callback"?t.queueNotification:rw(t.timeout),d=()=>{l=!1,i&&(i=!1,o.forEach(c=>c()))};return Object.assign({},a,{subscribe(c){const h=()=>n&&c(),A=a.subscribe(h);return o.add(c),()=>{A(),o.delete(c)}},dispatch(c){var h;try{return n=!((h=c==null?void 0:c.meta)!=null&&h[w6]),i=!n,i&&(l||(l=!0,u(d))),a.dispatch(c)}finally{n=!0}}})},S6=t=>function(r){const{autoBatch:a=!0}=r??{};let n=new JC(t);return a&&n.push(_6(typeof a=="object"?a:void 0)),n};function C6(t){const s=N6(),{reducer:r=void 0,middleware:a,devTools:n=!0,preloadedState:i=void 0,enhancers:l=void 0}=t||{};let o;if(typeof r=="function")o=r;else if(zy(r))o=e6(r);else throw new Error($c(1));let u;typeof a=="function"?u=a(s):u=s();let d=Hx;n&&(d=b6({trace:!1,...typeof n=="object"&&n}));const c=t6(...u),h=S6(c);let A=typeof l=="function"?l(h):h();const f=d(...A);return QC(o,i,f)}function ZC(t){const s={},r=[];let a;const n={addCase(i,l){const o=typeof i=="string"?i:i.type;if(!o)throw new Error($c(28));if(o in s)throw new Error($c(29));return s[o]=l,n},addAsyncThunk(i,l){return l.pending&&(s[i.pending.type]=l.pending),l.rejected&&(s[i.rejected.type]=l.rejected),l.fulfilled&&(s[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),n},addMatcher(i,l){return r.push({matcher:i,reducer:l}),n},addDefaultCase(i){return a=i,n}};return t(n),[s,r,a]}function k6(t){return typeof t=="function"}function B6(t,s){let[r,a,n]=ZC(s),i;if(k6(t))i=()=>sw(t());else{const o=sw(t);i=()=>o}function l(o=i(),u){let d=[r[u.type],...a.filter(({matcher:c})=>c(u)).map(({reducer:c})=>c)];return d.filter(c=>!!c).length===0&&(d=[n]),d.reduce((c,h)=>{if(h)if(Xc(c)){const f=h(c,u);return f===void 0?c:f}else{if(Fo(c))return YC(c,A=>h(A,u));{const A=h(c,u);if(A===void 0){if(c===null)return c;throw Error("A case reducer on a non-draftable value must not return undefined")}return A}}return c},o)}return l.getInitialState=i,l}var E6=(t,s)=>y6(t)?t.match(s):t(s);function F6(...t){return s=>t.some(r=>E6(r,s))}var T6="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",I6=(t=21)=>{let s="",r=t;for(;r--;)s+=T6[Math.random()*64|0];return s},L6=["name","message","stack","code"],xv=class{constructor(t,s){Xg(this,"_type");this.payload=t,this.meta=s}},aw=class{constructor(t,s){Xg(this,"_type");this.payload=t,this.meta=s}},D6=t=>{if(typeof t=="object"&&t!==null){const s={};for(const r of L6)typeof t[r]=="string"&&(s[r]=t[r]);return s}return{message:String(t)}},nw="External signal was aborted",Zy=(()=>{function t(s,r,a){const n=Qm(s+"/fulfilled",(u,d,c,h)=>({payload:u,meta:{...h||{},arg:c,requestId:d,requestStatus:"fulfilled"}})),i=Qm(s+"/pending",(u,d,c)=>({payload:void 0,meta:{...c||{},arg:d,requestId:u,requestStatus:"pending"}})),l=Qm(s+"/rejected",(u,d,c,h,A)=>({payload:h,error:(a&&a.serializeError||D6)(u||"Rejected"),meta:{...A||{},arg:c,requestId:d,rejectedWithValue:!!h,requestStatus:"rejected",aborted:(u==null?void 0:u.name)==="AbortError",condition:(u==null?void 0:u.name)==="ConditionError"}}));function o(u,{signal:d}={}){return(c,h,A)=>{const f=a!=null&&a.idGenerator?a.idGenerator(u):I6(),g=new AbortController;let v,b;function y(N){b=N,g.abort()}d&&(d.aborted?y(nw):d.addEventListener("abort",()=>y(nw),{once:!0}));const j=(async function(){var B,P;let N;try{let L=(B=a==null?void 0:a.condition)==null?void 0:B.call(a,u,{getState:h,extra:A});if(P6(L)&&(L=await L),L===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const U=new Promise((H,q)=>{v=()=>{q({name:"AbortError",message:b||"Aborted"})},g.signal.addEventListener("abort",v,{once:!0})});c(i(f,u,(P=a==null?void 0:a.getPendingMeta)==null?void 0:P.call(a,{requestId:f,arg:u},{getState:h,extra:A}))),N=await Promise.race([U,Promise.resolve(r(u,{dispatch:c,getState:h,extra:A,requestId:f,signal:g.signal,abort:y,rejectWithValue:(H,q)=>new xv(H,q),fulfillWithValue:(H,q)=>new aw(H,q)})).then(H=>{if(H instanceof xv)throw H;return H instanceof aw?n(H.payload,f,u,H.meta):n(H,f,u)})])}catch(L){N=L instanceof xv?l(null,f,u,L.payload,L.meta):l(L,f,u)}finally{v&&g.signal.removeEventListener("abort",v)}return a&&!a.dispatchConditionRejection&&l.match(N)&&N.meta.condition||c(N),N})();return Object.assign(j,{abort:y,requestId:f,arg:u,unwrap(){return j.then(U6)}})}}return Object.assign(o,{pending:i,rejected:l,fulfilled:n,settled:F6(l,n),typePrefix:s})}return t.withTypes=()=>t,t})();function U6(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function P6(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var R6=Symbol.for("rtk-slice-createasyncthunk");function O6(t,s){return`${t}/${s}`}function Q6({creators:t}={}){var r;const s=(r=t==null?void 0:t.asyncThunk)==null?void 0:r[R6];return function(n){const{name:i,reducerPath:l=i}=n;if(!i)throw new Error($c(11));const o=(typeof n.reducers=="function"?n.reducers(q6()):n.reducers)||{},u=Object.keys(o),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},c={addCase(S,B){const P=typeof S=="string"?S:S.type;if(!P)throw new Error($c(12));if(P in d.sliceCaseReducersByType)throw new Error($c(13));return d.sliceCaseReducersByType[P]=B,c},addMatcher(S,B){return d.sliceMatchers.push({matcher:S,reducer:B}),c},exposeAction(S,B){return d.actionCreators[S]=B,c},exposeCaseReducer(S,B){return d.sliceCaseReducersByName[S]=B,c}};u.forEach(S=>{const B=o[S],P={reducerName:S,type:O6(i,S),createNotation:typeof n.reducers=="function"};$6(B)?G6(P,B,c,s):V6(P,B,c)});function h(){const[S={},B=[],P=void 0]=typeof n.extraReducers=="function"?ZC(n.extraReducers):[n.extraReducers],L={...S,...d.sliceCaseReducersByType};return B6(n.initialState,U=>{for(let H in L)U.addCase(H,L[H]);for(let H of d.sliceMatchers)U.addMatcher(H.matcher,H.reducer);for(let H of B)U.addMatcher(H.matcher,H.reducer);P&&U.addDefaultCase(P)})}const A=S=>S,f=new Map,g=new WeakMap;let v;function b(S,B){return v||(v=h()),v(S,B)}function y(){return v||(v=h()),v.getInitialState()}function j(S,B=!1){function P(U){let H=U[S];return typeof H>"u"&&B&&(H=Ip(g,P,y)),H}function L(U=A){const H=Ip(f,B,()=>new WeakMap);return Ip(H,U,()=>{const q={};for(const[V,M]of Object.entries(n.selectors??{}))q[V]=M6(M,U,()=>Ip(g,U,y),B);return q})}return{reducerPath:S,getSelectors:L,get selectors(){return L(P)},selectSlice:P}}const N={name:i,reducer:b,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:y,...j(l),injectInto(S,{reducerPath:B,...P}={}){const L=B??l;return S.inject({reducerPath:L,reducer:b},P),{...N,...j(L,!0)}}};return N}}function M6(t,s,r,a){function n(i,...l){let o=s(i);return typeof o>"u"&&a&&(o=r()),t(o,...l)}return n.unwrapped=t,n}var H6=Q6();function q6(){function t(s,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:s,...r}}return t.withTypes=()=>t,{reducer(s){return Object.assign({[s.name](...r){return s(...r)}}[s.name],{_reducerDefinitionType:"reducer"})},preparedReducer(s,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:s,reducer:r}},asyncThunk:t}}function V6({type:t,reducerName:s,createNotation:r},a,n){let i,l;if("reducer"in a){if(r&&!W6(a))throw new Error($c(17));i=a.reducer,l=a.prepare}else i=a;n.addCase(t,i).exposeCaseReducer(s,i).exposeAction(s,l?Qm(t,l):Qm(t))}function $6(t){return t._reducerDefinitionType==="asyncThunk"}function W6(t){return t._reducerDefinitionType==="reducerWithPrepare"}function G6({type:t,reducerName:s},r,a,n){if(!n)throw new Error($c(18));const{payloadCreator:i,fulfilled:l,pending:o,rejected:u,settled:d,options:c}=r,h=n(t,i,c);a.exposeAction(s,h),l&&a.addCase(h.fulfilled,l),o&&a.addCase(h.pending,o),u&&a.addCase(h.rejected,u),d&&a.addMatcher(h.settled,d),a.exposeCaseReducer(s,{fulfilled:l||Lp,pending:o||Lp,rejected:u||Lp,settled:d||Lp})}function Lp(){}function $c(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Mm=Zy("inventoryRef/fetchUoms",async()=>{var s;const t=await ee.get("/inventory/uoms");return Array.isArray((s=t.data)==null?void 0:s.items)?t.data.items:[]}),Hm=Zy("inventoryRef/fetchCategories",async()=>{var s;const t=await ee.get("/inventory/item-categories");return Array.isArray((s=t.data)==null?void 0:s.items)?t.data.items:[]}),tA=Zy("inventoryRef/fetchItemTypes",async()=>{var s;const t=await ee.get("/inventory/item-types");return Array.isArray((s=t.data)==null?void 0:s.items)?t.data.items:[]}),K6={uoms:[],categories:[],itemTypes:[],status:{uoms:"idle",categories:"idle",itemTypes:"idle"},error:{uoms:null,categories:null,itemTypes:null},lastFetched:{uoms:null,categories:null,itemTypes:null}},z6=H6({name:"inventoryRef",initialState:K6,reducers:{},extraReducers:t=>{t.addCase(Mm.pending,s=>{s.status.uoms="loading",s.error.uoms=null}).addCase(Mm.fulfilled,(s,r)=>{s.status.uoms="succeeded",s.uoms=r.payload,s.lastFetched.uoms=Date.now()}).addCase(Mm.rejected,(s,r)=>{var a;s.status.uoms="failed",s.error.uoms=((a=r.error)==null?void 0:a.message)||"Failed to load UOMs"}).addCase(Hm.pending,s=>{s.status.categories="loading",s.error.categories=null}).addCase(Hm.fulfilled,(s,r)=>{s.status.categories="succeeded",s.categories=r.payload,s.lastFetched.categories=Date.now()}).addCase(Hm.rejected,(s,r)=>{var a;s.status.categories="failed",s.error.categories=((a=r.error)==null?void 0:a.message)||"Failed to load categories"}).addCase(tA.pending,s=>{s.status.itemTypes="loading",s.error.itemTypes=null}).addCase(tA.fulfilled,(s,r)=>{s.status.itemTypes="succeeded",s.itemTypes=r.payload,s.lastFetched.itemTypes=Date.now()}).addCase(tA.rejected,(s,r)=>{var a;s.status.itemTypes="failed",s.error.itemTypes=((a=r.error)==null?void 0:a.message)||"Failed to load item types"})}}),Y6=z6.reducer,X6=C6({reducer:{inventoryRef:Y6}});function J6(){const t=ys(),{user:s,scope:r,setScope:a}=ca(),[n,i]=x.useState([]),[l,o]=x.useState(""),[u,d]=x.useState(!1),[c,h]=x.useState(""),A=x.useMemo(()=>Array.isArray(s==null?void 0:s.branchIds)?s.branchIds.map(Number):[],[s==null?void 0:s.branchIds]);x.useEffect(()=>{let g=!0;async function v(){var b,y,j;d(!0),h("");try{const N=await ee.get("/admin/branches"),B=(Array.isArray((b=N.data)==null?void 0:b.items)?N.data.items:[]).filter(P=>A.includes(Number(P.id)));if(g&&(i(B),B.length===1)){const P=B[0];a(L=>({...L,companyId:Number(P.company_id),branchId:Number(P.id)})),t("/",{replace:!0});return}}catch(N){h(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Error loading branches")}finally{g&&d(!1)}}return v(),()=>{g=!1}},[]);async function f(){const g=Number(l);if(!g)return;const v=n.find(b=>Number(b.id)===g);v&&(a(b=>({...b,companyId:Number(v.company_id),branchId:Number(v.id),branchConfirmedId:n.length===1?Number(v.id):b==null?void 0:b.branchConfirmedId})),t("/",{replace:!0}))}return n.length===1?null:e.jsx("div",{className:"min-h-screen grid place-items-center bg-slate-50 dark:bg-slate-900 p-6",children:e.jsxs("div",{className:"w-full max-w-md card p-6 shadow-erp-lg",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 text-center",children:"Select Working Branch"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 text-center mt-1",children:"Choose one of your assigned branches to continue."}),c?e.jsx("div",{className:"mt-4 rounded-lg border border-status-error/30 bg-red-50 dark:bg-red-900/20 px-4 py-3 text-status-error text-sm",children:c}):null,e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"label",children:"Branch"}),e.jsxs("select",{className:"input w-full",value:l,onChange:g=>o(g.target.value),disabled:u||n.length===0,children:[e.jsx("option",{value:"",children:"Select a branch"}),n.map(g=>e.jsxs("option",{value:g.id,children:[g.name," (",g.company_name,")"]},g.id))]})]}),e.jsx("button",{className:"btn-primary w-full mt-6",onClick:f,disabled:u||!l,children:u?"Loading":"Continue"})]})})}var Qd={},XA={},Md={},iw;function e5(){if(iw)return Md;iw=1;var t=Md&&Md.__awaiter||function(n,i,l,o){function u(d){return d instanceof l?d:new l(function(c){c(d)})}return new(l||(l=Promise))(function(d,c){function h(g){try{f(o.next(g))}catch(v){c(v)}}function A(g){try{f(o.throw(g))}catch(v){c(v)}}function f(g){g.done?d(g.value):u(g.value).then(h,A)}f((o=o.apply(n,i||[])).next())})};Object.defineProperty(Md,"__esModule",{value:!0}),Md.PushNotification=void 0;const s=3e3;class r{constructor(i){this.title=i.title,this.subtitle=i.subtitle,this.message=i.message,this.theme=i.theme,this.id=Math.random(),this.styling=i.styling,this.closeButton=i.closeButton,this.onClick=i.onClick}}Md.PushNotification=r;let a=class{constructor(){this.Storage=[],this.Listener=()=>this.Storage,this.popAndPush=i=>{let l=0;for(;l<this.Storage.length;)this.Storage[l].id===i?this.Storage.splice(l,1):++l;this.Listener(this.Storage)},this.setTimer=(i,l)=>{setTimeout(()=>this.popAndPush(i),l)},this.addListener=i=>{this.Listener=i},this.addNativeNotification=i=>t(this,void 0,void 0,function*(){const{title:l,subtitle:o,message:u,duration:d,icon:c,vibrate:h,silent:A,onClick:f}=i;if((Notification.permission==="default"||Notification.permission==="denied")&&(yield Notification.requestPermission()),Notification.permission==="granted"){const g=new Notification(l,{body:u,data:o,icon:c,vibrate:h,silent:A});g.onclick=f||null,setTimeout(g.close.bind(g),d||s)}}),this.addWebNotification=i=>{const{title:l,subtitle:o,message:u,theme:d,duration:c,backgroundBottom:h,backgroundTop:A,colorBottom:f,colorTop:g,closeButton:v,onClick:b}=i,y={backgroundTop:A,backgroundBottom:h,colorTop:g,colorBottom:f},j=new r({title:l,subtitle:o,message:u,theme:d,styling:y,closeButton:v,onClick:b});this.Storage.push(j),this.setTimer(j.id,c||s),this.Listener(this.Storage)},this.addNotification=i=>t(this,void 0,void 0,function*(){const{native:l}=i;return l?this.addNativeNotification(i):this.addWebNotification(i)})}};return Md.default=new a,Md}var JA={},lw;function Z6(){if(lw)return JA;lw=1;var t=JA&&JA.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(JA,"__esModule",{value:!0});const s=t(Rh()),r=a=>{const{title:n,subtitle:i,message:l,theme:o,id:u,closeNotification:d,styling:c,closeButton:h,onClick:A}=a;let f={},g={};return c&&(f.backgroundColor=c.backgroundTop,f.color=c.colorTop,g.backgroundColor=c.backgroundBottom,g.color=c.colorBottom),s.default.createElement("div",{className:`rpn-notification-card ${o}`,onClick:A},s.default.createElement("div",{className:`rpn-notification-card-top ${o}`,style:Object.keys(f).length?f:void 0},s.default.createElement("span",null,n),s.default.createElement("span",{className:`rpn-notification-card-close ${o}`,onClick:()=>d(u)},h||"close")),s.default.createElement("div",{className:`rpn-notification-card-bottom ${o}`,style:Object.keys(g).length?g:void 0},s.default.createElement("span",{className:"subtitle"},i),s.default.createElement("span",{className:"message"},l)))};return JA.default=r,JA}var ow;function eL(){if(ow)return XA;ow=1;var t=XA&&XA.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(XA,"__esModule",{value:!0});const s=t(Rh()),r=t(e5()),a=t(Z6());let n=class extends s.default.Component{constructor(){super(...arguments),this.state={value:[]}}componentDidMount(){r.default.addListener(l=>this.setState({value:l}))}render(){const{position:l}=this.props,o=`rpn-notification-holder ${l||"top-middle"} supertest`;return s.default.createElement("div",{className:o},this.state.value.map((u,d)=>s.default.createElement(a.default,{key:d,closeNotification:r.default.popAndPush,onClick:u.onClick,id:u.id,theme:u.theme,title:u.title,subtitle:u.subtitle,closeButton:u.closeButton,message:u.message,styling:u.styling})))}};return XA.default=n,XA}var cw;function tL(){if(cw)return Qd;cw=1;var t=Qd&&Qd.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Qd,"__esModule",{value:!0}),Qd.Notifications=void 0;const s=t(eL());Qd.Notifications=s.default;const a=t(e5()).default.addNotification;return Qd.default=a,Qd}var t5=tL();const gv=Iy(t5);function sL(){const{theme:t,toggleTheme:s}=DC(),r=t==="dark";return e.jsx("button",{type:"button",className:"relative inline-flex h-6 w-11 items-center rounded-full border transition-colors focus:outline-none focus:ring-2 focus:ring-brand/40 focus:ring-offset-2 focus:ring-offset-transparent "+(r?"bg-brand/25 border-white/10 dark:border-white/10":"bg-slate-200 border-slate-300"),role:"switch","aria-checked":r,"aria-label":"Toggle dark mode",onClick:s,children:e.jsx("span",{className:"inline-block h-5 w-5 transform rounded-full shadow transition-transform "+(r?"translate-x-5 bg-brand":"translate-x-1 bg-white")})})}function rL(){const{user:t}=ca();return e.jsxs("div",{className:"hidden rounded-2xl border border-slate-200/70 dark:border-white/10 bg-white/70 dark:bg-slate-900/40 backdrop-blur-xl shadow-sm p-5",children:[e.jsx("div",{className:"font-extrabold text-lg mb-1",children:"Dashboard"}),e.jsxs("div",{className:"text-slate-500 dark:text-slate-400 mb-3",children:["Welcome, ",t==null?void 0:t.email,". This is the ERP starter shell."]}),e.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm leading-relaxed",children:"Start by enabling permissions in MySQL and then calling module endpoints from the UI."})]})}function aL(){const{user:t,token:s,hasAccess:r}=ca(),a=ys(),[n,i]=x.useState([]),[l,o]=x.useState([]),[u,d]=x.useState(null),[c,h]=x.useState(!1),[A,f]=x.useState(null),[g,v]=x.useState(null),[b,y]=x.useState(""),[j,N]=x.useState(!1),[S,B]=x.useState(!1),[P,L]=x.useState(null);x.useEffect(()=>{let w=!1;return ee.get("/workflows/approvals/pending").then(O=>{var R;w||i(Array.isArray((R=O.data)==null?void 0:R.items)?O.data.items:[])}).catch(()=>{w||i([])}),ee.get("/workflows/notifications").then(O=>{var R;w||o(Array.isArray((R=O.data)==null?void 0:R.items)?O.data.items:[])}).catch(()=>{w||o([])}),ee.get("/pos/analytics/overview").then(O=>{w||d(O.data||null)}).catch(()=>{w||d(null)}),()=>{w=!0}},[s]);const U=w=>String(w||"").trim().toUpperCase().replace(/\s+/g,"_"),H=w=>{const O=U(w);if(O==="MATERIAL_REQUISITION")return"Material Requisition";if(O==="RETURN_TO_STORES")return"Return to Stores";if(O.startsWith("PURCHASE_ORDER:")){const R=O.split(":")[1];return R==="LOCAL"?"Purchase Order - Local":R==="IMPORT"?"Purchase Order - Import":"Purchase Order"}return O==="GOODS_RECEIPT"||O==="GRN"||O==="GOODS_RECEIPT_NOTE"?"GRN":O==="GOODS_RECEIPT:LOCAL"||O==="GRN:LOCAL"||O==="GOODS_RECEIPT_NOTE:LOCAL"?"GRN Local":O==="GOODS_RECEIPT:IMPORT"||O==="GRN:IMPORT"||O==="GOODS_RECEIPT_NOTE:IMPORT"?"GRN Import":String(w||"Document")},q=w=>{const O=U(w.document_type);if(O==="PURCHASE_ORDER"){const R=U(w.po_type);return R?`${O}:${R}`:O}if(O==="GOODS_RECEIPT"||O==="GRN"||O==="GOODS_RECEIPT_NOTE"){const R=String(w.doc_ref||""),X=R.startsWith("GL-")?"LOCAL":R.startsWith("GI-")?"IMPORT":"";return X?`${O}:${X}`:O}return O},V=x.useMemo(()=>{const w=new Map;for(const O of n){const R=String(O.workflow_instance_id||`${U(O.document_type)}-${O.document_id}`);w.has(R)||w.set(R,O)}return Array.from(w.values())},[n]),M=x.useMemo(()=>{const w=Number((t==null?void 0:t.sub)||(t==null?void 0:t.id));return V.filter(O=>{const X=[Number(O.approver_user_id),Number(O.assigned_user_id),Number(O.target_user_id),Number(O.approver_id),Number(O.user_id)].find(ne=>Number.isFinite(ne)&&ne>0)??null;return!Number.isFinite(w)||w<=0?!0:X==null||X===w})},[V,t==null?void 0:t.sub,t==null?void 0:t.id]),z=x.useMemo(()=>{const w={};for(const O of M){const R=q(O);w[R]||(w[R]=[]),w[R].push(O)}return w},[M]),I=x.useMemo(()=>{const w=Object.keys(z),O=["MATERIAL_REQUISITION","RETURN_TO_STORES","STOCK_ADJUSTMENT"],R=O.filter(ne=>w.includes(ne)),X=w.filter(ne=>!O.includes(ne)).sort();return[...R,...X]},[z]),G=w=>{const O=H(q(w)),R=w.doc_ref?String(w.doc_ref):`#${w.document_id}`;return`${O} ${R}`},Y=[{title:"Sales Orders",description:"Manage customer orders and track fulfillment",path:"/sales/sales-orders",icon:""},{title:"Invoices",description:"Generate and manage sales invoices",path:"/sales/invoices",icon:""},{title:"Service Confirmation",description:"Confirm delivered services from suppliers",path:"/service-management/service-confirmation",icon:""},{title:"Service Bills",description:"Prepare and issue service bills",path:"/service-management/service-bills",icon:""}].filter(w=>r(w.path,"view")),J=async w=>{var O;h(!0),f(w),N(!0),v(null),y("");try{const X=((O=(await ee.get(`/workflows/approvals/instance/${w}`)).data)==null?void 0:O.item)||null;if(v(X),X&&!X.is_last_step&&Array.isArray(X.next_step_approvers)){const ne=X.next_step_approvers[0];L(ne?ne.id:null)}else L(null)}catch{v(null)}finally{N(!1)}},T=()=>{h(!1),f(null),v(null),y(""),N(!1),B(!1),L(null)},k=async w=>{var O,R;if(A){if(!b&&(w==="REJECT"||w==="RETURN")){alert("Please provide a comment for rejection/return");return}if(w==="APPROVE"&&g&&!g.is_last_step&&!P){alert("Please select the next approver");return}B(!0);try{await ee.post(`/workflows/${A}/action`,{action:w,comments:b,target_user_id:g&&!g.is_last_step?P:null}),i(X=>X.filter(ne=>ne.workflow_instance_id!==A)),T()}catch(X){alert(((R=(O=X==null?void 0:X.response)==null?void 0:O.data)==null?void 0:R.message)||"Action failed")}finally{B(!1)}}};function D(w){return`${Number(w||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}const Q=[{label:"Today Sales",value:D((u==null?void 0:u.todaySales)||0),path:"/sales",color:"from-ticker-green to-ticker-green"},{label:"Total Customers",value:String((u==null?void 0:u.totalCustomers)??0),path:"/sales/customers",color:"from-ticker-blue to-ticker-blue"},{label:"Average Order",value:D((u==null?void 0:u.averageOrder)||0),path:"/sales/reports",color:"from-ticker-purple to-ticker-purple"},{label:"Monthly Revenue",value:D((u==null?void 0:u.monthlyRevenue)||0),path:"/finance/reports",color:"from-ticker-orange to-ticker-orange"}],C=[{label:"New Sale",icon:"",path:"/pos/sales/new",color:"text-green-600 bg-green-50"},{label:"Inventory",icon:"",path:"/inventory",color:"text-blue-600 bg-blue-50"},{label:"Customers",icon:"",path:"/sales/customers",color:"text-purple-600 bg-purple-50"},{label:"Reports",icon:"",path:"/reports",color:"text-orange-600 bg-orange-50"},{label:"Settings",icon:"",path:"/administration/settings",color:"text-slate-600 bg-slate-50"},{label:"Help",icon:"",path:"/help",color:"text-red-600 bg-red-50"}],E=x.useMemo(()=>{const w=Number((t==null?void 0:t.sub)||(t==null?void 0:t.id));return l.filter(R=>{const ne=String((R==null?void 0:R.message)||"").toLowerCase().includes("approved"),oe=[Number(R.user_id),Number(R.target_user_id),Number(R.recipient_id),Number(R.assigned_user_id),Number(R.request_user_id)].find(re=>Number.isFinite(re)&&re>0)??null,ce=Number.isFinite(w)&&w>0?oe==null||oe===w:!0;return ne&&ce})},[l,t==null?void 0:t.sub,t==null?void 0:t.id]);return e.jsxs("div",{className:"min-h-screen bg-slate-50/50 p-6 md:p-8 font-sans text-slate-900",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8 fullbleed-sm",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-r from-brand-900 to-brand-800 p-8 shadow-erp text-white",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Welcome back, ",(t==null?void 0:t.name)||(t==null?void 0:t.username)||"User","! "]}),e.jsx("p",{className:"mt-2 text-brand-100 text-lg max-w-2xl",children:"Here's an overview of your business performance and pending tasks today."})]}),e.jsx("div",{className:"absolute right-0 top-0 h-full w-1/3 bg-white/5 skew-x-12 transform translate-x-20"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:Q.map((w,O)=>e.jsxs("div",{onClick:()=>a(w.path),className:`relative overflow-hidden rounded-xl p-6 shadow-erp-sm hover:shadow-erp-md transition-all duration-200 cursor-pointer group bg-gradient-to-r ${w.color} text-white`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-white/80 uppercase tracking-wider",children:w.label}),e.jsx("p",{className:"mt-2 text-3xl font-bold text-white",children:w.value})]}),e.jsx("div",{className:"p-3 rounded-lg bg-white/20 text-white",children:e.jsx("span",{className:"text-2xl",children:w.icon})})]}),e.jsx("div",{className:"absolute bottom-0 right-0 p-4 opacity-10 group-hover:scale-110 transition-transform duration-300",children:e.jsx("span",{className:"text-6xl text-white/20",children:w.icon})})]},O))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100 h-full",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-amber-500",children:""})," Quick Actions"]}),e.jsx("div",{className:"space-y-3",children:C.map((w,O)=>e.jsxs("button",{onClick:()=>a(w.path),className:"w-full flex items-center gap-4 p-3 rounded-lg hover:bg-slate-50 transition-colors border border-transparent hover:border-slate-200 text-left group",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-xl ${w.color}`,children:w.icon}),e.jsx("span",{className:"font-medium text-slate-700 group-hover:text-brand-700",children:w.label})]},O))})]}),Y.length>0&&e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-500",children:""})," Featured"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Y.map((w,O)=>e.jsx("div",{onClick:()=>a(w.path),className:"bg-white dark:bg-slate-800 p-4 rounded-xl shadow-sm hover:shadow-md hover:border-brand-300 dark:hover:border-brand-700 border border-slate-100 dark:border-slate-700 transition-all duration-200 cursor-pointer group",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-brand-50 dark:bg-slate-700 flex items-center justify-center text-lg group-hover:bg-brand-100 dark:group-hover:bg-slate-600 transition-colors",children:w.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-100 group-hover:text-brand-700 dark:group-hover:text-brand-400 transition-colors",children:w.title}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:w.description})]})]})},O))})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-500",children:""})," Pending Approvals"]}),e.jsxs("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs font-bold rounded-full",children:[M.length," Pending"]})]}),V.length>0?e.jsx("div",{className:"space-y-4",children:I.map(w=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-bold text-slate-700",children:H(w)}),e.jsx("span",{className:"px-2 py-0.5 bg-slate-100 text-slate-700 text-xs font-bold rounded-full",children:z[w].length})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:z[w].map(O=>e.jsxs("div",{className:"py-3 flex items-center justify-between hover:bg-slate-50 rounded-lg px-2 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-sm font-bold text-slate-600",children:O.initiator?O.initiator.charAt(0):"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:G(O)}),e.jsxs("p",{className:"text-xs text-slate-500",children:[O.submitted_at?new Date(O.submitted_at).toLocaleString():"Just now"," "," ",O.workflow_name||"Approval Required"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>J(O.workflow_instance_id),className:"px-3 py-1 text-xs font-medium text-green-700 bg-green-50 hover:bg-green-100 rounded-md transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>a(`/administration/workflows/approvals/${O.workflow_instance_id}`),className:"px-3 py-1 text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-md transition-colors",children:"View"})]})]},O.workflow_instance_id))})]},w))}):e.jsx("div",{className:"text-center py-8 text-slate-500 text-sm bg-slate-50/50 rounded-lg border border-dashed border-slate-200",children:"No pending approvals found. You're all caught up! "})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-brand-500",children:""})," Notifications"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg border border-slate-200 p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Approved Documents"}),e.jsxs("div",{className:"text-xs text-slate-500",children:[E.length," Approved"]})]}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a("/administration/workflows/approved"),children:"View Details"})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-bold text-slate-800",children:"Pending Documents"}),e.jsxs("div",{className:"text-xs text-slate-500",children:[M.length," Pending"]})]}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a("/administration/workflows/approvals"),children:"View Details"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-erp p-6 border border-slate-100",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"text-purple-500",children:""})," System Status"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-600",children:"Server Uptime"}),e.jsx("span",{className:"text-green-600 font-medium",children:"99.9%"})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"99.9%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-slate-600",children:"Database Load"}),e.jsx("span",{className:"text-brand-600 font-medium",children:"34%"})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2",children:e.jsx("div",{className:"bg-brand-500 h-2 rounded-full",style:{width:"34%"}})})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-100",children:[e.jsx("p",{className:"text-xs text-slate-400 uppercase tracking-wider font-bold mb-2",children:"Recent Login"}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-700",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Windows PC  Chrome"}),e.jsx("span",{className:"text-slate-400 ml-auto",children:"10:42 AM"})]})]})]})]})]})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Approval"}),e.jsx("button",{onClick:T,className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsx("div",{className:"p-4 space-y-3",children:j?e.jsx("div",{className:"text-sm",children:"Loading..."}):g?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document:"," ",e.jsxs("span",{className:"font-semibold",children:[g.document_type," #",g.document_id]})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Current Step:"," ",e.jsx("span",{className:"font-semibold",children:g.step_name})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Amount:"," ",e.jsx("span",{className:"font-semibold",children:g.amount!=null?Number(g.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Comments"}),e.jsx("textarea",{className:"input w-full h-24",placeholder:"Enter comments...",value:b,onChange:w=>y(w.target.value)})]}),!g.is_last_step&&Array.isArray(g.next_step_approvers)&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Forward To"}),e.jsxs("select",{className:"input w-full",value:P||"",onChange:w=>L(Number(w.target.value)),children:[e.jsx("option",{value:"",children:"Select user"}),g.next_step_approvers.map(w=>e.jsx("option",{value:w.id,children:w.username},w.id))]})]})]}):e.jsx("div",{className:"text-sm text-red-600",children:"Failed to load approval"})}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:T,children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700 disabled:opacity-50",onClick:()=>k("APPROVE"),disabled:S,children:g&&g.is_last_step?"Final Approve":"Forward"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 disabled:opacity-50",onClick:()=>k("RETURN"),disabled:S,children:"Return"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",onClick:()=>k("REJECT"),disabled:S,children:"Reject"})]})]})})]})}const Gl=({title:t,description:s,stats:r=[],quickActions:a=[],sections:n=[]})=>{const i=ys(),{hasAccess:l}=ca(),o=(c,h)=>{c&&i(c)},u=["from-green-500 to-green-600","from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-orange-500 to-orange-600","from-pink-500 to-pink-600","from-teal-500 to-teal-600","from-red-500 to-red-600","from-amber-500 to-amber-600"],d=Ts.useMemo(()=>{const c=[...u];for(let A=c.length-1;A>0;A--){const f=Math.floor(Math.random()*(A+1));[c[A],c[f]]=[c[f],c[A]]}const h=[];for(let A=0;A<r.length;A++)h.push(c[A%c.length]);return h},[r.length]);return e.jsxs("div",{className:"p-6 space-y-8 animate-fade-in fullbleed-sm",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-brand-900 dark:text-white tracking-tight mb-2",children:t}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg max-w-3xl",children:s})]}),r.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-xl font-semibold text-brand-800 dark:text-brand-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:""})," Business Overview"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:r.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).map((c,h)=>e.jsxs("div",{className:`p-6 rounded-xl shadow-erp-sm hover:shadow-erp-md transition-all duration-200 cursor-pointer group bg-gradient-to-r ${c.color||d[h]} text-white`,onClick:()=>o(c.path),children:[e.jsx("div",{className:"flex justify-end mb-2",children:c.change&&e.jsx("span",{className:"text-xs font-bold px-2 py-1 rounded-full bg-white/20 text-white",children:c.change})}),e.jsx("div",{className:"text-2xl font-bold text-white mb-1",children:c.value}),e.jsx("div",{className:"text-sm text-white/80 font-medium",children:c.label})]},h))})]}),a.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).length>0&&e.jsxs("div",{className:"mb-10",children:[e.jsxs("h2",{className:"text-xl font-semibold text-brand-800 dark:text-brand-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:""})," Quick Actions"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:a.filter(c=>!(c!=null&&c.path)||l(c.path,"view")).map((c,h)=>e.jsxs("button",{className:"flex flex-col items-center justify-center p-4 bg-white dark:bg-slate-800 rounded-xl shadow-sm hover:shadow-md hover:bg-brand-50 dark:hover:bg-slate-700 transition-all duration-200 group text-center h-full border border-slate-100 dark:border-slate-700",onClick:()=>o(c.path),children:[e.jsx("span",{className:"text-2xl mb-2 group-hover:-translate-y-1 transition-transform duration-200 block",children:c.icon}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300 group-hover:text-brand-700 dark:group-hover:text-brand-300",children:c.label})]},h))})]}),e.jsx("div",{className:"space-y-10",children:n.map((c,h)=>{const A=c.title||c.category,f=c.items||c.features||[];return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5 border-b border-slate-200 dark:border-slate-700 pb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:A}),c.badge&&e.jsx("span",{className:"bg-brand-100 text-brand-700 dark:bg-brand-900/40 dark:text-brand-300 text-xs font-bold px-2.5 py-0.5 rounded-full uppercase tracking-wider",children:c.badge})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:f.filter(g=>!(g!=null&&g.hidden)&&(!(g!=null&&g.path)||l(g.path,"view"))).map((g,v)=>{const b=g.title||g.name;return e.jsx("div",{className:"bg-white dark:bg-slate-800 p-5 rounded-xl shadow-sm hover:shadow-md hover:border-brand-300 dark:hover:border-brand-700 border border-transparent transition-all duration-200 cursor-pointer group relative overflow-hidden",onClick:()=>o(g.path),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-brand-50 dark:bg-slate-700 flex items-center justify-center text-xl group-hover:bg-brand-100 dark:group-hover:bg-slate-600 transition-colors",children:g.icon||""}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-800 dark:text-slate-100 group-hover:text-brand-700 dark:group-hover:text-brand-400 transition-colors mb-1",children:b}),g.description&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 line-clamp-2",children:g.description})]})]})},v)})})]},h)})})]})};function nL(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(""),[l,o]=x.useState("");x.useEffect(()=>{u()},[]);const u=async()=>{var c,h,A,f;try{a(!0),i("");const g=await ee.get("/admin/roles"),v=Array.isArray((h=(c=g.data)==null?void 0:c.data)==null?void 0:h.items)?g.data.data.items:[];s(v)}catch(g){i(((f=(A=g==null?void 0:g.response)==null?void 0:A.data)==null?void 0:f.message)||"Error fetching roles"),console.error("Error fetching roles:",g)}finally{a(!1)}},d=t.filter(c=>String(c.name||"").toLowerCase().includes(l.toLowerCase())||String(c.code||"").toLowerCase().includes(l.toLowerCase()));return r?e.jsx("div",{className:"text-center py-8",children:"Loading roles..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Role Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure roles and assign permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/administration/roles/new",className:"btn-success",children:"+ New Role"})]})]}),n&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:n})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search roles...",className:"input max-w-md",value:l,onChange:c=>o(c.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Role Code"}),e.jsx("th",{children:"Role Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("code",{className:"px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded text-sm",children:c.code})}),e.jsx("td",{className:"font-medium text-slate-900 dark:text-slate-100",children:c.name}),e.jsx("td",{children:c.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-slate-600 dark:text-slate-400",children:new Date(c.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:`/administration/roles/${c.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 text-sm font-medium",children:"Edit"})})})]},c.id))})]})}),d.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No roles found matching your search."})})]})})]})}function dw(){const{id:t}=Ls(),s=ys(),r=!!t,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({code:"",name:"",isActive:!0}),[d,c]=x.useState([]),[h,A]=x.useState(new Set),[f,g]=x.useState({}),[v,b]=x.useState("");x.useEffect(()=>{const U=setInterval(()=>{y()},2e4);return()=>clearInterval(U)},[]),x.useEffect(()=>{y(),r&&j()},[t]);async function y(){var U,H;try{const V=((H=(U=(await ee.get("/admin/pages")).data)==null?void 0:U.data)==null?void 0:H.items)||[];c(V);const M={},z=G=>String(G||"").split("-").map(Y=>Y[0]?Y[0].toUpperCase()+Y.slice(1):"").join(" "),I=G=>G==="new"||G==="create"?"create":G&&G.startsWith(":")?"edit":"view";for(const G of V){const Y=G.module||"General",T=String(G.path||"").split("/").filter(Boolean);let k=T.slice(),D="view";if(T.length>0){const w=T[T.length-1],O=I(w);D=O,O!=="view"&&(k=T.slice(0,T.length-1))}const Q=/\bDelete\b/i.test(String(G.name||""))?"delete":null;Q&&(D=Q);let C="";k.length>=2?C=z(k[k.length-1]):C=String(G.name||"").replace(/\s*(List|Form|Edit|Delete)\s*$/i,"")||z(T[1]||"");const E=k.join("/");M[Y]||(M[Y]={}),M[Y][E]||(M[Y][E]={label:C,actions:{}}),M[Y][E].actions[D]=G}g(M)}catch(q){console.error("Error fetching pages:",q)}}async function j(){var U,H,q,V;try{n(!0),l("");const M=await ee.get(`/admin/roles/${t}`);if((H=(U=M.data)==null?void 0:U.data)!=null&&H.item){const z=M.data.data.item;u({code:z.code,name:z.name,isActive:!!z.is_active}),Array.isArray(z.pages)&&A(new Set(z.pages.map(Number)))}}catch(M){l(((V=(q=M==null?void 0:M.response)==null?void 0:q.data)==null?void 0:V.message)||"Error fetching role")}finally{n(!1)}}const N=U=>{A(H=>{const q=new Set(H);return q.has(U)?q.delete(U):q.add(U),q})},S=async U=>{var H,q;U.preventDefault(),n(!0),l("");try{let V=o.code;(!V||!r)&&(V=o.name.toUpperCase().trim().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,""));const M={code:V,name:o.name,is_active:o.isActive,pages:Array.from(h)};r?await ee.put(`/admin/roles/${t}`,M):await ee.post("/admin/roles",M),s("/administration/roles")}catch(V){l(((q=(H=V==null?void 0:V.response)==null?void 0:H.data)==null?void 0:q.message)||"Error saving role")}finally{n(!1)}},B=(U,H)=>{A(q=>{const V=new Set(q);return H?V.add(U.id):V.delete(U.id),V})},P=(U,H)=>{const q=[];for(const[,V]of U)for(const[,M]of Object.entries(V.actions))q.push(M);A(V=>{const M=new Set(V);for(const z of q)H?M.add(z.id):M.delete(z.id);return M})},L=(U,H,q)=>{const V=[];for(const[,M]of U){const z=M.actions[H];z&&V.push(z)}A(M=>{const z=new Set(M);for(const I of V)q?z.add(I.id):z.delete(I.id);return z})};return e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/roles",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Roles"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Role":"New Role"}),e.jsx("p",{className:"text-sm mt-1",children:"Define role details and select accessible pages"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Le,{to:"/administration/roles",className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:a,children:a?"Saving...":"Save Role"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Role Information"})}),e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role Name *"}),e.jsx("input",{type:"text",className:"input",value:o.name,onChange:U=>u({...o,name:U.target.value}),placeholder:"e.g., Sales Manager",required:!0})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-8",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:o.isActive,onChange:U=>u({...o,isActive:U.target.checked})}),e.jsx("span",{className:"text-sm font-medium",children:"Active"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-100 dark:text-slate-100",children:"Page Access"}),e.jsx("p",{className:"text-sm mt-1",children:"Select which pages users with this role can access"}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{type:"button",className:"btn btn-secondary mr-3",onClick:y,disabled:a,children:"Refresh Pages"})})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"space-y-8",children:Object.entries(f).map(([U,H])=>{const q=Object.entries(H),V=q.every(([,M])=>Object.values(M.actions).every(z=>h.has(z.id)));return e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100 flex justify-between items-center",children:[e.jsx("span",{children:U}),e.jsxs("div",{className:"flex items-center gap-4 text-sm font-normal",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:V,onChange:M=>P(q,M.target.checked)}),"Select All"]}),(()=>{const M=q.map(([,I])=>I.actions.view).filter(Boolean),z=M.length>0&&M.every(I=>h.has(I.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:M.length===0,checked:z,onChange:I=>L(q,"view",I.target.checked)}),"View"]})})(),(()=>{const M=q.map(([,I])=>I.actions.create).filter(Boolean),z=M.length>0&&M.every(I=>h.has(I.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:M.length===0,checked:z,onChange:I=>L(q,"create",I.target.checked)}),"Add"]})})(),(()=>{const M=q.map(([,I])=>I.actions.edit).filter(Boolean),z=M.length>0&&M.every(I=>h.has(I.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:M.length===0,checked:z,onChange:I=>L(q,"edit",I.target.checked)}),"Edit"]})})(),(()=>{const M=q.map(([,I])=>I.actions.delete).filter(Boolean),z=M.length>0&&M.every(I=>h.has(I.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",disabled:M.length===0,checked:z,onChange:I=>L(q,"delete",I.target.checked)}),"Delete"]})})()]})]}),e.jsx("div",{className:"p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:q.map(([M,z])=>{const I=z.actions.view,G=z.actions.create,Y=z.actions.edit,J=z.actions.delete;return e.jsxs("div",{className:"flex flex-col gap-2 p-3 rounded-lg border border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:z.label}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[I&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:h.has(I.id),onChange:T=>B(I,T.target.checked)}),"View"]}),G&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:h.has(G.id),onChange:T=>B(G,T.target.checked)}),"Create"]}),Y&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:h.has(Y.id),onChange:T=>B(Y,T.target.checked)}),"Edit"]}),J&&e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:h.has(J.id),onChange:T=>B(J,T.target.checked)}),"Delete"]})]})]},M)})})]},U)})})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-100 dark:text-slate-100",children:"All Pages (Individual)"}),e.jsx("p",{className:"text-sm mt-1",children:"New pages appear automatically"})]}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("input",{className:"input",placeholder:"Search by module, name, or path",value:v,onChange:U=>b(U.target.value)})}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-sm text-slate-600",children:[Array.isArray(d)?d.length:0," pages"]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Module"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Page"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Path"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Select"})]})}),e.jsx("tbody",{className:"bg-white",children:d.filter(U=>{const H=String(v||"").trim().toLowerCase();return H?String(U.module||"").toLowerCase().includes(H)||String(U.name||"").toLowerCase().includes(H)||String(U.path||"").toLowerCase().includes(H):!0}).sort((U,H)=>{const q=String(U.module||""),V=String(H.module||"");return q===V?String(U.name||"").localeCompare(String(H.name||"")):q.localeCompare(V)}).map(U=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:U.module||"-"}),e.jsx("td",{className:"p-2",children:U.name||"-"}),e.jsx("td",{className:"p-2",children:U.path||"-"}),e.jsx("td",{className:"p-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:h.has(U.id),onChange:H=>N(U.id,H.target.checked)}),e.jsx("span",{className:"text-xs",children:"Allow"})]})})]},U.id))})]})})]})]})]})})}function iL(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState("all"),[c,h]=x.useState("all"),A={total:t.length,active:t.filter(v=>v.is_active).length,inactive:t.filter(v=>!v.is_active).length};x.useEffect(()=>{f()},[]);const f=async()=>{var v,b,y,j;try{a(!0),i("");const N=await ee.get("/admin/users"),S=Array.isArray((b=(v=N.data)==null?void 0:v.data)==null?void 0:b.items)?N.data.data.items:[];s(S)}catch(N){i(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Error fetching users"),console.error("Error fetching users:",N)}finally{a(!1)}},g=t.filter(v=>{const b=String(v.full_name||"").toLowerCase().includes(l.toLowerCase())||String(v.username||"").toLowerCase().includes(l.toLowerCase())||String(v.email||"").toLowerCase().includes(l.toLowerCase()),y=u==="all"||u==="active"&&v.is_active||u==="inactive"&&!v.is_active,j=c==="all"||v.user_type&&v.user_type.toLowerCase()===c.toLowerCase();return b&&y&&j});return e.jsxs("div",{className:"user-container",children:[e.jsxs("div",{className:"user-header",children:[e.jsx("h1",{children:" User Management System"}),e.jsxs("div",{className:"user-header-actions",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/administration/users/new",className:"btn btn-primary",style:{textDecoration:"none",color:"white",padding:"10px 20px",borderRadius:"6px",background:"#28a745"},children:" Create New User"}),e.jsx("button",{className:"btn btn-secondary",onClick:f,style:{padding:"10px 20px",border:"none",borderRadius:"6px",cursor:"pointer",background:"#6c757d",color:"white"},children:" Refresh"})]})]}),e.jsx("div",{className:"user-search-section",children:e.jsxs("div",{className:"user-search-box",children:[e.jsxs("div",{className:"user-form-group",children:[e.jsx("label",{children:"Search by Name/Email"}),e.jsx("input",{type:"text",className:"user-form-control",placeholder:"Enter name or email...",value:l,onChange:v=>o(v.target.value)})]}),e.jsxs("div",{className:"user-form-group",children:[e.jsx("label",{children:"Status"}),e.jsxs("select",{className:"user-form-control",value:u,onChange:v=>d(v.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"user-table-container",children:[e.jsxs("div",{className:"user-stats",children:[e.jsxs("div",{className:"user-stat-card",children:[e.jsx("h3",{children:"Total Users"}),e.jsx("div",{className:"stat-value",children:A.total})]}),e.jsxs("div",{className:"user-stat-card",children:[e.jsx("h3",{children:"Active Users"}),e.jsx("div",{className:"stat-value",children:A.active})]}),e.jsxs("div",{className:"user-stat-card",children:[e.jsx("h3",{children:"Inactive Users"}),e.jsx("div",{className:"stat-value",children:A.inactive})]})]}),r?e.jsx("div",{className:"text-center py-8",children:"Loading users..."}):n?e.jsx("div",{className:"text-center py-8 text-red-500",children:n}):e.jsxs("table",{className:"user-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Branch"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-4",children:"No users found"})}):g.map(v=>{const b=(v.full_name||v.username||"?").substring(0,2).toUpperCase();return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"user-info",children:[e.jsx("div",{className:"user-avatar",children:v.profile_picture_url?e.jsx("img",{src:v.profile_picture_url,alt:v.username,style:{width:"100%",height:"100%",objectFit:"cover"}}):b}),e.jsx("div",{className:"user-details",children:e.jsx("span",{className:"user-name",children:v.full_name||"N/A"})})]})}),e.jsx("td",{children:v.username}),e.jsx("td",{children:v.email}),e.jsx("td",{children:v.user_type||"Internal"}),e.jsx("td",{children:v.company_name||"N/A"}),e.jsx("td",{children:v.branch_name||"N/A"}),e.jsx("td",{children:v.is_active?e.jsx("span",{className:"user-status-badge user-status-active",children:"Active"}):e.jsx("span",{className:"user-status-badge user-status-inactive",children:"Inactive"})}),e.jsx("td",{children:v.created_at?new Date(v.created_at).toLocaleDateString():"N/A"}),e.jsx("td",{children:e.jsx("div",{className:"user-action-buttons",children:e.jsx(Le,{to:`/administration/users/${v.id}`,className:"btn",style:{background:"#007bff",color:"white",padding:"6px 12px",borderRadius:"4px",fontSize:"12px",textDecoration:"none"},children:" Edit"})})})]},v.id)})})]})]})]})}function uw(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState({companyId:"",branchIds:[],username:"",email:"",fullName:"",password:"",isActive:!0,profilePictureUrl:"",isEmployee:!1,userType:"Internal",validFrom:"",validTo:"",roleId:""}),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState([]),[y,j]=x.useState(!1);x.useEffect(()=>{N(),r&&S()},[s]);async function N(){var V,M,z;try{const[I,G,Y]=await Promise.all([ee.get("/admin/companies"),ee.get("/admin/branches"),ee.get("/admin/roles").catch(()=>({data:{items:[]}}))]);A(I.data&&I.data.data&&I.data.data.items||((V=I.data)==null?void 0:V.items)||[]),g(G.data&&G.data.data&&G.data.data.items||((M=G.data)==null?void 0:M.items)||[]),b(Y.data&&Y.data.data&&Y.data.data.items||((z=Y.data)==null?void 0:z.items)||[])}catch(I){console.error("Error fetching dependencies:",I)}}async function S(){var V,M,z,I,G,Y;try{n(!0),u("");const J=await ee.get(`/admin/users/${s}`);if((M=(V=J.data)==null?void 0:V.data)!=null&&M.item){const T=J.data.data.item;c({companyId:T.company_id||"",branchIds:T.branch_id?[String(T.branch_id)]:[],username:T.username||"",email:T.email||"",fullName:T.full_name||"",isActive:!!T.is_active,password:"",profilePictureUrl:T.profile_picture_url||"",isEmployee:!!T.is_employee,userType:T.user_type||"Internal",validFrom:T.valid_from?T.valid_from.split("T")[0]:"",validTo:T.valid_to?T.valid_to.split("T")[0]:"",roleId:T.role_id||""});try{const k=await ee.get(`/admin/users/${s}/branches`),D=Array.isArray((I=(z=k.data)==null?void 0:z.data)==null?void 0:I.items)?k.data.data.items:[];c(Q=>({...Q,branchIds:D.map(C=>String(C.id))}))}catch{}}}catch(J){u(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Error fetching user")}finally{n(!1)}}function B(V,M){c(z=>({...z,[V]:M}))}async function P(V){const M=V.target.files[0];if(!M)return;const z=new FormData;z.append("file",M);try{l(!0);const I=await ee.post("/upload",z,{headers:{"Content-Type":"multipart/form-data"}});B("profilePictureUrl",I.data.url)}catch(I){console.error("Upload failed",I),u("Failed to upload profile picture")}finally{l(!1)}}function L(V){if(!V)return!0;const M=8,z=/[A-Z]/.test(V),I=/[0-9]/.test(V),G=/[!@#$%^&*(),.?":{}|<>]/.test(V);return V.length<M?"Password must be at least 8 characters long.":z?I?G?!0:"Password must contain at least one special character.":"Password must contain at least one number.":"Password must contain at least one uppercase letter."}async function U(V){var M,z,I;if(V.preventDefault(),n(!0),u(""),!r||d.password){const G=L(d.password);if(G!==!0){u(G),n(!1);return}}try{const G={company_id:d.companyId,branch_id:(M=d.branchIds)!=null&&M[0]?Number(d.branchIds[0]):void 0,branch_ids:d.branchIds.map(Y=>Number(Y)),username:d.username,email:d.email,full_name:d.fullName,is_active:d.isActive,profile_picture_url:d.profilePictureUrl,is_employee:d.isEmployee,user_type:d.userType,valid_from:d.validFrom||null,valid_to:d.validTo||null,role_id:d.roleId||null};if(!G.branch_id){u("Select at least one branch"),n(!1);return}d.password&&(G.password_hash=d.password),r?await ee.put(`/admin/users/${s}`,G):await ee.post("/admin/users",G),t("/administration/users")}catch(G){u(((I=(z=G==null?void 0:G.response)==null?void 0:z.data)==null?void 0:I.message)||"Error saving user")}finally{n(!1)}}const H=d.companyId?f.filter(V=>String(V.company_id)===String(d.companyId)):[],q=d.companyId?v.filter(V=>String(V.company_id)===String(d.companyId)):[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/users",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Users"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit User":"New User"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage system users"})]}),e.jsx("form",{onSubmit:U,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[o&&e.jsx("div",{className:"alert alert-error mb-4",children:o}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company *"}),e.jsxs("select",{className:"input",value:d.companyId,onChange:V=>{B("companyId",V.target.value),B("branchIds",[]),B("roleId","")},required:!0,children:[e.jsx("option",{value:"",children:"-- Select Company --"}),h.map(V=>e.jsxs("option",{value:V.id,children:[V.name," (",V.code,")"]},V.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branches *"}),e.jsxs("div",{className:"space-y-2 border rounded-md p-2 max-h-48 overflow-auto",children:[H.map(V=>{const M=d.branchIds.includes(String(V.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-brand rounded focus:ring-brand",checked:M,onChange:z=>{const I=z.target.checked;c(G=>{const Y=new Set(G.branchIds);return I?Y.add(String(V.id)):Y.delete(String(V.id)),{...G,branchIds:Array.from(Y)}})},disabled:!d.companyId}),e.jsxs("span",{className:"text-sm",children:[V.name," (",V.code,")"]})]},V.id)}),H.length===0?e.jsx("div",{className:"text-xs text-slate-500",children:"Select a company to see branches"}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username *"}),e.jsx("input",{className:"input",value:d.username,onChange:V=>B("username",V.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email *"}),e.jsx("input",{className:"input",type:"email",value:d.email,onChange:V=>B("email",V.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Name *"}),e.jsx("input",{className:"input",value:d.fullName,onChange:V=>B("fullName",V.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),e.jsxs("select",{className:"input",value:d.roleId,onChange:V=>B("roleId",V.target.value),disabled:!d.companyId,children:[e.jsx("option",{value:"",children:"-- Select Role --"}),q.map(V=>e.jsx("option",{value:V.id,children:V.name},V.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Profile Picture"}),e.jsxs("div",{className:"flex items-center gap-4",children:[d.profilePictureUrl&&e.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden border border-slate-200",children:e.jsx("img",{src:d.profilePictureUrl,alt:"Profile",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",className:"file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-brand-50 file:text-brand-700 hover:file:bg-brand-100 text-sm text-slate-500",onChange:P,accept:"image/*",disabled:i}),i&&e.jsx("span",{className:"text-xs text-brand ml-2",children:"Uploading..."})]})]}),e.jsx("input",{type:"hidden",value:d.profilePictureUrl})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"User Type"}),e.jsxs("select",{className:"input",value:d.userType,onChange:V=>B("userType",V.target.value),children:[e.jsx("option",{value:"Internal",children:"Internal"}),e.jsx("option",{value:"External",children:"External"}),e.jsx("option",{value:"Vendor",children:"Vendor"}),e.jsx("option",{value:"Customer",children:"Customer"}),e.jsx("option",{value:"Contractor",children:"Contractor"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.isEmployee,onChange:V=>B("isEmployee",V.target.checked),className:"w-4 h-4 text-brand rounded focus:ring-brand"}),e.jsx("span",{className:"text-sm font-medium",children:"Is Employee"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d.isActive,onChange:V=>B("isActive",V.target.checked),className:"w-4 h-4 text-brand rounded focus:ring-brand"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Status"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Valid From"}),e.jsx("input",{type:"date",className:"input",value:d.validFrom,onChange:V=>B("validFrom",V.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Valid To"}),e.jsx("input",{type:"date",className:"input",value:d.validTo,onChange:V=>B("validTo",V.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 border-t pt-4 mt-2",children:[e.jsx("label",{className:"label",children:r?"New Password (leave blank to keep current)":"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"input pr-10",type:y?"text":"password",value:d.password,onChange:V=>B("password",V.target.value),required:!r,placeholder:r?"Enter new password...":"Enter password..."}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-2 flex items-center text-slate-500",onClick:()=>j(V=>!V),"aria-label":y?"Hide password":"Show password",children:y?e.jsx($y,{size:18}):e.jsx(I0,{size:18})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Must be at least 8 characters, include 1 uppercase, 1 number, and 1 special character."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(Le,{to:"/administration/users",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update User":"Create User"})]})]})})})]})}const lL=()=>{const[t,s]=x.useState([]),[r,a]=x.useState(!0),n=ys();x.useEffect(()=>{i()},[]);const i=async()=>{try{const o=await ee.get("/workflows");s(o.data.items||[])}catch(o){console.error("Failed to fetch workflows",o)}finally{a(!1)}},l=async o=>{if(window.confirm("Are you sure you want to delete this workflow?"))try{await ee.delete(`/workflows/${o}`),i()}catch(u){console.error("Failed to delete workflow",u)}};return r?e.jsx("div",{className:"p-8 text-center",children:"Loading workflows..."}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Workflow Definitions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsxs("button",{onClick:()=>n("/administration/workflows/new"),className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition",children:[e.jsx(xu,{size:20}),"Create Workflow"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Module"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doc Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-gray-500",children:"No workflows defined yet."})}):t.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.workflow_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.workflow_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.module_key}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.document_type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${o.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.is_active?"Active":"Inactive"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>n(`/administration/workflows/${o.id}`),className:"text-blue-600 hover:text-blue-900 mr-4",children:e.jsx(eA,{size:18})}),e.jsx("button",{onClick:()=>l(o.id),className:"text-red-600 hover:text-red-900",children:e.jsx(Hl,{size:18})})]})]},o.id))})]})})]})};function oL(t){return String(t||"").split("-").map(s=>s[0]?s[0].toUpperCase()+s.slice(1):"").join(" ")}function Aw(t,s){return`${t}_${s}`.toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,"")}function Dp(t){return String(t||"").toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,"")}const hw=()=>{const{id:t}=Ls(),s=ys(),r=!!t,[a,n]=x.useState(!1),[i,l]=x.useState([]),[o,u]=x.useState([]),[d,c]=x.useState(""),[h,A]=x.useState({workflow_code:"",workflow_name:"",module_key:"",document_type:"",document_route:"",is_active:!0,steps:[]});x.useEffect(()=>{b();const L=setInterval(b,2e4);return r&&y(),()=>clearInterval(L)},[t]);const[f,g]=x.useState({}),v=async(L,U)=>{var q;const H=String(U||"").trim();if(H.length<2){g(V=>({...V,[L]:[]}));return}try{const V=await ee.get("/admin/users",{params:{q:H,active:1}}),M=Array.isArray((q=V.data)==null?void 0:q.items)?V.data.items:[];g(z=>({...z,[L]:M}))}catch{g(M=>({...M,[L]:[]}))}},b=async()=>{var L;try{const H=((L=(await ee.get("/admin/pages")).data)==null?void 0:L.items)||[],q={},V=z=>z==="new"||z==="create"?"create":z&&z.startsWith(":")?"edit":"view";for(const z of H){const I=z.module||"General",G=String(z.path||""),Y=G.split("/").filter(Boolean);if(!Y.length||/administration/i.test(I)||/business intelligence/i.test(I)||/reports/i.test(G)||/dashboard/i.test(G)||/permissions/i.test(G))continue;let J=Y.slice(),T="view";if(Y.length>0){const Q=Y[Y.length-1],C=V(Q);T=C,C!=="view"&&(J=Y.slice(0,Y.length-1))}const k=J.join("/"),D=String(z.name||"").replace(/\s*(List|Form|Edit|Delete)\s*$/i,"")||oL(J[J.length-1]||Y[1]||"");q[I]||(q[I]={}),q[I][k]||(q[I][k]={module:I,label:D,actions:{view:null,create:null,edit:null}}),(T==="create"||T==="edit"||T==="view")&&(q[I][k].actions[T]=z)}const M=[];for(const[z,I]of Object.entries(q))for(const[G,Y]of Object.entries(I))(Y.actions.create||Y.actions.edit)&&M.push({module:z,label:Y.label,value:`${z}|${Y.label}`,code:Aw(z,Y.label),route:`/${G}`});M.sort((z,I)=>z.module===I.module?z.label.localeCompare(I.label):z.module.localeCompare(I.module)),u(M)}catch(U){console.error("Failed to fetch transaction document types",U),u([])}};x.useEffect(()=>{if(!h.module_key||!h.document_type||o.length===0)return;const L=o.find(U=>Dp(U.module)===Dp(h.module_key)&&U.label===h.document_type)||o.find(U=>U.code===Aw(Dp(h.module_key),h.document_type));c(L?L.code:"")},[o,h.module_key,h.document_type]);const y=async()=>{n(!0);try{const U=(await ee.get(`/workflows/${t}`)).data.item,H=Array.isArray(U.steps)?U.steps.map(q=>({...q,approver_user_ids:Array.isArray(q.approvers)&&q.approvers.length?q.approvers.map(V=>V.id):q.approver_user_id?[q.approver_user_id]:[]})):[];A({...U,is_active:!!U.is_active,steps:H})}catch(L){console.error("Failed to fetch workflow",L),alert("Error loading workflow")}finally{n(!1)}},j=L=>{const{name:U,value:H,type:q,checked:V}=L.target;A(M=>({...M,[U]:q==="checkbox"?V:H}))},N=(L,U,H)=>{const q=[...h.steps];q[L]={...q[L],[U]:H},A(V=>({...V,steps:q}))},S=()=>{A(L=>({...L,steps:[...L.steps,{step_order:L.steps.length+1,step_name:"",approver_user_ids:[],approval_limit:null,is_mandatory:!0}]}))},B=L=>{const H=h.steps.filter((q,V)=>V!==L).map((q,V)=>({...q,step_order:V+1}));A(q=>({...q,steps:H}))},P=async L=>{var U,H;L.preventDefault(),n(!0);try{for(const V of h.steps)if(!(Array.isArray(V.approver_user_ids)?V.approver_user_ids:V.approver_user_id?[V.approver_user_id]:[]).length){alert(`Please select an approver for step ${V.step_order}`),n(!1);return}const q={...h,steps:h.steps.map(V=>{const M=Array.isArray(V.approver_user_ids)?V.approver_user_ids:V.approver_user_id?[V.approver_user_id]:[];return{...V,approver_user_ids:M.map(z=>Number(z)),approval_limit:V.approval_limit?parseFloat(V.approval_limit):null}})};if(!r){const V=String(q.workflow_code||"");/^WF-[0-9]{6}$/.test(V)||delete q.workflow_code}r?await ee.put(`/workflows/${t}`,q):await ee.post("/workflows",q),s("/administration/workflows")}catch(q){console.error("Failed to save workflow",q),alert(((H=(U=q.response)==null?void 0:U.data)==null?void 0:H.message)||"Error saving workflow")}finally{n(!1)}};return a&&r&&!h.workflow_code?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s("/administration/workflows"),className:"text-gray-500 hover:text-gray-700",children:e.jsx(Uf,{size:24})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:r?"Edit Workflow":"Create Workflow"})]}),e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Workflow Name"}),e.jsx("input",{type:"text",name:"workflow_name",required:!0,value:h.workflow_name,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Workflow Code"}),e.jsx("input",{type:"text",name:"workflow_code",required:!0,value:h.workflow_code,readOnly:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 bg-gray-100 text-gray-500 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Module Key"}),e.jsxs("select",{name:"module_key",required:!0,value:h.module_key,onChange:j,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[e.jsx("option",{value:"",children:"Select Module"}),o.length===0?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"PURCHASE",children:"Purchase"}),e.jsx("option",{value:"SALES",children:"Sales"}),e.jsx("option",{value:"HR",children:"HR"}),e.jsx("option",{value:"FINANCE",children:"Finance"}),e.jsx("option",{value:"INVENTORY",children:"Inventory"})]}):Array.from(new Set(o.map(L=>L.module))).map(L=>e.jsx("option",{value:String(L).toUpperCase().replace(/[^A-Z0-9]+/g,"_").replace(/^_+|_+$/g,""),children:L},L))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Document Type"}),e.jsxs("select",{name:"document_type",required:!0,value:d,onChange:L=>{const U=L.target.value;c(U);const H=o.find(q=>q.code===U)||(()=>{const q=String(U).split("|");return q.length===2?{module:q[0],label:q[1],route:`/${q[0].toLowerCase()}/${q[1].toLowerCase().replace(/[^a-z0-9]+/g,"-")}`}:null})();H&&A(q=>({...q,module_key:Dp(H.module),document_type:H.label||"",document_route:H.route||""}))},className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2",children:[e.jsx("option",{value:"",children:"Select Document Type"}),o.length===0?e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"SALES|Sales Order",children:"Sales Order"}),e.jsx("option",{value:"PURCHASE|Purchase Order",children:"Purchase Order"}),e.jsx("option",{value:"SALES|Invoice",children:"Invoice"}),e.jsx("option",{value:"INVENTORY|Work Order",children:"Work Order"})]}):o.map(L=>e.jsx("option",{value:L.code,children:L.label},L.code))]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{type:"button",onClick:b,className:"btn btn-sm btn-secondary",children:"Refresh Types"})})]}),e.jsxs("div",{className:"flex items-center mt-6",children:[e.jsx("input",{type:"checkbox",name:"is_active",checked:h.is_active,onChange:j,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Is Active"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Approval Steps"}),e.jsxs("button",{type:"button",onClick:S,className:"flex items-center gap-1 text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200",children:[e.jsx(xu,{size:16})," Add Step"]})]}),e.jsxs("div",{className:"space-y-4",children:[h.steps.map((L,U)=>e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-end p-4 bg-gray-50 rounded border border-gray-200",children:[e.jsxs("div",{className:"w-full md:w-16",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Order"}),e.jsx("div",{className:"mt-1 font-semibold text-center",children:L.step_order})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Step Name"}),e.jsx("input",{type:"text",value:L.step_name,onChange:H=>N(U,"step_name",H.target.value),placeholder:"e.g. Manager Approval",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm"})]}),e.jsxs("div",{className:"flex-1 w-full",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Approvers (Users)"}),e.jsx("input",{type:"text",placeholder:"Type to search users (min 2 chars)",onChange:H=>v(U,H.target.value||""),className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm"}),e.jsx("select",{className:"hidden"}),e.jsx("div",{className:"mt-1 grid grid-cols-1 md:grid-cols-2 gap-2",children:(f[U]||[]).map(H=>{const q=Number(H.id),V=Array.isArray(L.approver_user_ids)?L.approver_user_ids.map(M=>Number(M)).includes(q):!1;return e.jsxs("label",{className:"flex items-center gap-2 border rounded p-2 text-sm cursor-pointer hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",value:q,checked:V,onChange:M=>{const z=Number(M.target.value),I=Array.isArray(L.approver_user_ids)?L.approver_user_ids.map(Y=>Number(Y)):[],G=M.target.checked?Array.from(new Set([...I,z])):I.filter(Y=>Y!==z);N(U,"approver_user_ids",G)}}),e.jsx("span",{children:H.username||H.full_name||H.email||`User #${q}`})]},q)})}),Array.isArray(L.approver_user_ids)&&L.approver_user_ids.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:L.approver_user_ids.map(H=>{const q=Number(H),V=(f[U]||[]).find(z=>Number(z.id)===q)||(Array.isArray(L.approvers)?L.approvers.find(z=>Number(z.id)===q):null),M=V&&(V.username||V.full_name||V.email)||`User #${q}`;return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-50 text-blue-700 text-xs",children:M},`sel-${q}`)})})]}),e.jsxs("div",{className:"w-full md:w-32",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"Limit ($)"}),e.jsx("input",{type:"number",value:L.approval_limit||"",onChange:H=>N(U,"approval_limit",H.target.value),placeholder:"No Limit",className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 text-sm"})]}),e.jsx("button",{type:"button",onClick:()=>B(U),className:"text-red-500 hover:text-red-700 p-2",children:e.jsx(Hl,{size:18})})]},U)),h.steps.length===0&&e.jsx("p",{className:"text-gray-500 text-sm italic text-center py-4",children:'No steps defined. Click "Add Step" to begin.'})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:()=>s("/administration/workflows"),className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:a,className:"flex items-center gap-2 px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Vh,{size:18}),a?"Saving...":"Save Workflow"]})]})]})]})};function cL(){const[t,s]=x.useState([]),[r,a]=x.useState(!0);return x.useEffect(()=>{ee.get("/workflows/approvals/pending").then(n=>s(n.data.items)).catch(n=>console.error(n)).finally(()=>a(!1))},[]),r?e.jsx("div",{className:"p-6",children:"Loading approvals..."}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"My Pending Approvals"}),e.jsx(Le,{to:"/",className:"btn btn-secondary",children:"Return to Home"})]}),t.length===0?e.jsx("div",{className:"text-slate-500",children:"No pending approvals found."}):e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 font-medium border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Document"}),e.jsx("th",{className:"p-4",children:"Type"}),e.jsx("th",{className:"p-4",children:"Amount"}),e.jsx("th",{className:"p-4",children:"Step"}),e.jsx("th",{className:"p-4",children:"Submitted By"}),e.jsx("th",{className:"p-4",children:"Date"}),e.jsx("th",{className:"p-4",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:t.map(n=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsxs("td",{className:"p-4 font-medium text-slate-900 dark:text-slate-100",children:[String(n.document_type||"").replace(/_/g," ").toLowerCase().replace(/\b\w/g,i=>i.toUpperCase())," #",n.document_id]}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:n.document_type}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:n.amount!=null?Number(n.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"badge bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",children:n.step_name})}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:n.initiator||"Unknown"}),e.jsx("td",{className:"p-4 text-slate-600 dark:text-slate-400",children:new Date(n.submitted_at).toLocaleDateString()}),e.jsx("td",{className:"p-4",children:e.jsx(Le,{to:`/administration/workflows/approvals/${n.workflow_instance_id}`,className:"btn btn-sm btn-primary",children:"Review"})})]},n.workflow_instance_id))})]})})]})}function dL(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),n=ys();x.useEffect(()=>{ee.get("/workflows/notifications").then(o=>{var u;return s(Array.isArray((u=o.data)==null?void 0:u.items)?o.data.items:[])}).catch(()=>s([])).finally(()=>a(!1))},[]);const i=x.useMemo(()=>t.filter(o=>String((o==null?void 0:o.message)||"").toLowerCase().includes("approved")),[t]);function l(o){const d=String(o||"").match(/approvals\/(\d+)/);return d?Number(d[1]):null}return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Approved Documents"}),e.jsx(Le,{to:"/",className:"btn btn-secondary",children:"Return to Home"})]}),r?e.jsx("div",{className:"p-6",children:"Loading approved documents..."}):i.length===0?e.jsx("div",{className:"text-slate-500",children:"No approved documents found."}):e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900/50 text-slate-500 font-medium border-b border-slate-200 dark:border-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Message"}),e.jsx("th",{className:"p-4",children:"Approved On"}),e.jsx("th",{className:"p-4",children:"Action"})]})}),e.jsx("tbody",{children:i.map(o=>{const u=l(o.link);return e.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:o.message}),e.jsx("div",{className:"text-xs text-slate-500",children:o.reference||""})]}),e.jsx("td",{className:"p-4",children:o.date||"Just now"}),e.jsx("td",{className:"p-4",children:u?e.jsx("button",{className:"text-brand hover:text-brand-600 text-sm font-medium",onClick:()=>n(`/administration/workflows/approvals/${u}`),children:"View"}):e.jsx("span",{className:"text-slate-400 text-sm",children:"No link"})})]},o.id)})})]})})]})}function uL(){const{instanceId:t}=Ls(),s=ys(),[r,a]=x.useState(null),[n,i]=x.useState(!0),[l,o]=x.useState(""),[u,d]=x.useState(!1),[c,h]=x.useState(null),[A,f]=x.useState([]),[g,v]=x.useState(!1),[b,y]=x.useState(null);x.useEffect(()=>{ee.get(`/workflows/approvals/instance/${t}`).then(N=>a(N.data.item)).catch(N=>{console.error(N),nt.error("Failed to load workflow details")}).finally(()=>i(!1))},[t]),x.useEffect(()=>{if(!r)return;if(!r.is_last_step&&Array.isArray(r.next_step_approvers)){const S=r.next_step_approvers[0];y(S?S.id:null)}else y(null);const N=String(r.document_type||"").toUpperCase();N==="MATERIAL_REQUISITION"?(v(!0),ee.get(`/inventory/material-requisitions/${r.document_id}`).then(S=>{var B,P;h(((B=S.data)==null?void 0:B.item)||null),f(Array.isArray((P=S.data)==null?void 0:P.details)?S.data.details:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):N==="STOCK_ADJUSTMENT"?(v(!0),ee.get(`/inventory/stock-adjustments/${r.document_id}`).then(S=>{var B,P;h(((B=S.data)==null?void 0:B.item)||null),f(Array.isArray((P=S.data)==null?void 0:P.details)?S.data.details:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):N==="PURCHASE_ORDER"||N==="PURCHASE ORDER"?(v(!0),ee.get(`/purchase/orders/${r.document_id}`).then(S=>{var B,P,L;h(((B=S.data)==null?void 0:B.item)||null),f(Array.isArray((L=(P=S.data)==null?void 0:P.item)==null?void 0:L.details)?S.data.item.details:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):N==="GOODS_RECEIPT"||N==="GRN"||N==="GOODS RECEIPT NOTE"?(v(!0),ee.get(`/inventory/grn/${r.document_id}`).then(S=>{var B,P,L;h(((B=S.data)==null?void 0:B.item)||null),f(Array.isArray((L=(P=S.data)==null?void 0:P.item)==null?void 0:L.details)?S.data.item.details:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):N==="PAYMENT_VOUCHER"||N==="PAYMENT VOUCHER"||N==="PV"?(v(!0),ee.get(`/finance/vouchers/${r.document_id}`).then(S=>{var B,P;h(((B=S.data)==null?void 0:B.voucher)||null),f(Array.isArray((P=S.data)==null?void 0:P.lines)?S.data.lines:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):N==="RECEIPT_VOUCHER"||N==="RECEIPT VOUCHER"||N==="RV"?(v(!0),ee.get(`/finance/vouchers/${r.document_id}`).then(S=>{var B,P;h(((B=S.data)==null?void 0:B.voucher)||null),f(Array.isArray((P=S.data)==null?void 0:P.lines)?S.data.lines:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):N==="SALES_ORDER"||N==="SALES ORDER"?(v(!0),ee.get(`/sales/orders/${r.document_id}`).then(S=>{var B,P;h(((B=S.data)==null?void 0:B.item)||null),f(Array.isArray((P=S.data)==null?void 0:P.details)?S.data.details:[])}).catch(()=>{h(null),f([])}).finally(()=>v(!1))):(h(null),f([]),v(!1))},[r]);const j=async N=>{var S,B;if(!l&&(N==="REJECT"||N==="RETURN")){nt.warning("Please provide a comment for rejection/return");return}if(N==="APPROVE"&&!r.is_last_step&&!b){nt.warning("Please select the next approver");return}d(!0);try{await ee.post(`/workflows/${t}/action`,{action:N,comments:l,target_user_id:r.is_last_step?null:b}),nt.success(`Document ${N.toLowerCase()}ed successfully`),s("/administration/workflows/approvals")}catch(P){console.error(P),nt.error(((B=(S=P.response)==null?void 0:S.data)==null?void 0:B.message)||"Action failed")}finally{d(!1)}};return n?e.jsx("div",{className:"p-6",children:"Loading details..."}):r?e.jsxs("div",{className:"p-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:["Review:"," ",String(r.document_type||"").replace(/_/g," ").toLowerCase().replace(/\b\w/g,N=>N.toUpperCase())," ","#",r.document_id]}),e.jsx("button",{onClick:()=>s(-1),className:"btn btn-outline",children:"Back"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:"Document Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Document Type"}),e.jsx("div",{className:"font-medium",children:r.document_type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"ID"}),e.jsxs("div",{className:"font-medium",children:["#",r.document_id]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Amount"}),e.jsx("div",{className:"font-medium",children:r.amount!=null?Number(r.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}):"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Submitted At"}),e.jsx("div",{className:"font-medium",children:new Date(r.created_at).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-slate-500 block",children:"Current Status"}),e.jsx("span",{className:`badge ${r.status==="PENDING"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:r.status})]})]}),String(r.document_type||"").toUpperCase()==="MATERIAL_REQUISITION"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requisition No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.requisition_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requisition Date"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.requisition_date)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.warehouse_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Department"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.department_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requested By"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.requested_by)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty Requested"}),e.jsx("th",{children:"UOM"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.item_code||N.item_id}),e.jsx("td",{children:N.item_name||"-"}),e.jsx("td",{children:Number(N.qty_requested||0)}),e.jsx("td",{children:N.uom||"-"})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]}),(c==null?void 0:c.remarks)&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 rounded text-sm",children:[e.jsx("div",{className:"text-slate-500",children:"Remarks"}),e.jsx("div",{className:"text-slate-700 dark:text-slate-300",children:c.remarks})]})]}):String(r.document_type||"").toUpperCase()==="STOCK_ADJUSTMENT"||String(r.document_type||"").toUpperCase()==="STOCK ADJUSTMENT"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Adjustment No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.adjustment_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.adjustment_date?new Date(c.adjustment_date).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.adjustment_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),(c==null?void 0:c.warehouse_name)&&e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-medium",children:c.warehouse_name})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Adjusted Stock"}),e.jsx("th",{children:"Difference"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.item_code||N.item_id}),e.jsx("td",{children:N.item_name||"-"}),e.jsx("td",{children:Number(N.current_stock||0)}),e.jsx("td",{children:Number(N.adjusted_stock||0)}),e.jsxs("td",{className:Number(N.qty)<0?"text-red-500":"text-green-500",children:[Number(N.qty)>0?"+":"",Number(N.qty)]})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]}),(c==null?void 0:c.reason)&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 rounded text-sm",children:[e.jsx("div",{className:"text-slate-500",children:"Reason"}),e.jsx("div",{className:"text-slate-700 dark:text-slate-300",children:c.reason})]})]}):String(r.document_type||"").toUpperCase()==="PURCHASE_ORDER"||String(r.document_type||"").toUpperCase()==="PURCHASE ORDER"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"PO No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.po_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"PO Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.po_date?new Date(c.po_date).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Order Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.po_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.supplier_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_amount)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Line Total"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.item_code||N.item_id}),e.jsx("td",{children:N.item_name||"-"}),e.jsx("td",{children:Number(N.qty||0)}),e.jsx("td",{children:Number(N.unit_price||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(N.line_total||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]})]}):String(r.document_type||"").toUpperCase()==="GOODS_RECEIPT"||String(r.document_type||"").toUpperCase()==="GRN"||String(r.document_type||"").toUpperCase()==="GOODS RECEIPT NOTE"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"GRN No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.grn_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"GRN Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.grn_date?String(c.grn_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.supplier_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.warehouse_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Invoice No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.invoice_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Invoice Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.invoice_date?String(c.invoice_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Invoice Amount"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.invoice_amount)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty Received"}),e.jsx("th",{children:"Qty Accepted"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Line Amount"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.item_code||N.item_id}),e.jsx("td",{children:N.item_name||"-"}),e.jsx("td",{children:Number(N.qty_received||0)}),e.jsx("td",{children:Number(N.qty_accepted||0)}),e.jsx("td",{children:N.uom||"-"}),e.jsx("td",{children:Number(N.unit_price||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(N.line_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]})]}):String(r.document_type||"").toUpperCase()==="PAYMENT_VOUCHER"||String(r.document_type||"").toUpperCase()==="PAYMENT VOUCHER"||String(r.document_type||"").toUpperCase()==="PV"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.voucher_date?String(c.voucher_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_type_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Debit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_debit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Credit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_credit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Lines (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsxs("td",{children:[N.account_code," - ",N.account_name]}),e.jsx("td",{children:N.description||"-"}),e.jsx("td",{className:"text-right",children:Number(N.debit||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{className:"text-right",children:Number(N.credit||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No lines found"})]})]}):String(r.document_type||"").toUpperCase()==="RECEIPT_VOUCHER"||String(r.document_type||"").toUpperCase()==="RECEIPT VOUCHER"||String(r.document_type||"").toUpperCase()==="RV"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.voucher_date?String(c.voucher_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Voucher Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.voucher_type_name)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Debit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_debit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Credit"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_credit)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Lines (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsxs("td",{children:[N.account_code," - ",N.account_name]}),e.jsx("td",{children:N.description||"-"}),e.jsx("td",{className:"text-right",children:Number(N.debit||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{className:"text-right",children:Number(N.credit||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No lines found"})]})]}):String(r.document_type||"").toUpperCase()==="SALES_ORDER"||String(r.document_type||"").toUpperCase()==="SALES ORDER"?e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Order No"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.order_no)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Order Date"}),e.jsx("div",{className:"font-medium",children:c!=null&&c.order_date?new Date(c.order_date).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Customer ID"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.customer_id)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Price Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.price_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Payment Type"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.payment_type)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Status"}),e.jsx("div",{className:"font-medium",children:(c==null?void 0:c.status)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"font-medium",children:Number((c==null?void 0:c.total_amount)||0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Items (",A.length,")"]}),g?e.jsx("div",{className:"text-sm text-slate-500",children:"Loading..."}):A.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item ID"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Tax Amount"}),e.jsx("th",{children:"Line Total"})]})}),e.jsx("tbody",{children:A.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.item_id}),e.jsx("td",{children:Number(N.quantity||0)}),e.jsx("td",{children:Number(N.unit_price||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(N.tax_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:Number(N.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})})]},N.id))})]})}):e.jsx("div",{className:"text-sm text-slate-500",children:"No items found"})]}),(c==null?void 0:c.remarks)&&e.jsxs("div",{className:"p-3 bg-slate-50 dark:bg-slate-900/50 rounded text-sm",children:[e.jsx("div",{className:"text-slate-500",children:"Remarks"}),e.jsx("div",{className:"text-slate-700 dark:text-slate-300",children:c.remarks})]})]}):e.jsxs("div",{className:"mt-6 p-4 bg-slate-50 dark:bg-slate-900/50 rounded border border-slate-100 dark:border-slate-800 text-center text-slate-500",children:[e.jsx("p",{children:"Document Preview Not Available"}),e.jsx("p",{className:"text-xs mt-1",children:`(${r.document_type} preview not implemented)`})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:"Approval History"}),e.jsx("div",{className:"space-y-4",children:r.logs&&r.logs.length>0?r.logs.map((N,S)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"mt-1 w-2 h-2 rounded-full bg-slate-300 flex-shrink-0"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-medium",children:[N.actor_name||"Unknown"," ",e.jsx("span",{className:"text-slate-500",children:"performed"})," ",N.action]}),e.jsx("div",{className:"text-xs text-slate-500",children:new Date(N.created_at).toLocaleString()}),N.comments&&e.jsxs("div",{className:"mt-1 text-sm bg-slate-50 dark:bg-slate-900/50 p-2 rounded text-slate-600 dark:text-slate-400",children:['"',N.comments,'"']})]})]},S)):e.jsx("div",{className:"text-slate-500 italic",children:"No history yet."})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-erp border border-slate-200 dark:border-slate-700 p-6 sticky top-24",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Actions"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Current Step"}),e.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded border border-blue-100 dark:border-blue-800",children:r.step_name})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Comments"}),e.jsx("textarea",{className:"input w-full h-24",placeholder:"Enter comments...",value:l,onChange:N=>o(N.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[!r.is_last_step&&Array.isArray(r.next_step_approvers)&&e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Forward To"}),e.jsxs("select",{className:"input w-full",value:b||"",onChange:N=>y(Number(N.target.value)),children:[e.jsx("option",{value:"",children:"Select user"}),r.next_step_approvers.map(N=>e.jsx("option",{value:N.id,children:N.username},N.id))]})]}),e.jsx("button",{onClick:()=>j("APPROVE"),disabled:u||r.is_last_step&&r.approval_limit!==null&&r.amount>r.approval_limit,className:"btn btn-primary w-full justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:r.is_last_step?"Final Approve":"Forward to Next Stage"}),r.is_last_step&&r.approval_limit!==null&&r.amount>r.approval_limit&&e.jsxs("p",{className:"text-red-500 text-xs text-center",children:["Amount exceeds your approval limit of"," ",Number(r.approval_limit||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("button",{onClick:()=>j("RETURN"),disabled:u,className:"btn btn-warning w-full justify-center",children:"Return for Revision"}),e.jsx("button",{onClick:()=>j("REJECT"),disabled:u,className:"btn btn-danger w-full justify-center",children:"Reject"}),(function(){const N=String(r.document_type||"").toUpperCase();return(N==="PV"||N==="PAYMENT_VOUCHER"||N==="PAYMENT VOUCHER"||N==="RV"||N==="RECEIPT_VOUCHER"||N==="RECEIPT VOUCHER")&&(c==null?void 0:c.status)==="APPROVED"})()&&e.jsx("button",{onClick:async()=>{var S,B,P,L;const N=window.prompt("Reason for reversal (optional):")||"";try{await ee.post(`/finance/vouchers/${r.document_id}/reverse`,{reason:N}),nt.success("Voucher reversed");const U=await ee.get(`/finance/vouchers/${r.document_id}`);h(((S=U.data)==null?void 0:S.voucher)||null),f(Array.isArray((B=U.data)==null?void 0:B.lines)?U.data.lines:[])}catch(U){nt.error(((L=(P=U==null?void 0:U.response)==null?void 0:P.data)==null?void 0:L.message)||"Failed to reverse voucher")}},disabled:u,className:"btn btn-outline w-full justify-center",children:"Reverse Voucher"})]})]})})]})]}):e.jsx("div",{className:"p-6",children:"Workflow not found"})}function AL(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState("");x.useEffect(()=>{l()},[]);async function l(){var o,u,d;try{a(!0);const c=await ee.get("/admin/exceptional-permissions");s(Array.isArray((o=c.data)==null?void 0:o.items)?c.data.items:[]),i("")}catch(c){i(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load exceptional permissions")}finally{a(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Exceptional Permissions"}),e.jsx("p",{className:"text-sm mt-1",children:"Grant temporary allow/deny permissions to specific users"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/administration/users",className:"btn btn-secondary",children:"Return to Users"}),e.jsx(Le,{to:"/administration/exceptional-permissions/new",className:"btn-success",children:"+ New Exceptional Permission"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[n&&e.jsx("div",{className:"alert alert-error mb-3",children:e.jsx("span",{children:n})}),r?e.jsx("div",{className:"text-center py-4",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Permission"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Effect"}),e.jsx("th",{children:"Validity"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Approver"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"text-center py-4 text-slate-500",children:"No exceptional permissions found."})}):t.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.username||"Unknown User"}),e.jsx("td",{children:o.permission_code}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-neutral",children:o.exception_type||"TEMPORARY"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${o.effect==="ALLOW"?"badge-success":"badge-error"}`,children:o.effect})}),e.jsxs("td",{className:"text-xs",children:[e.jsxs("div",{children:["From:"," ",o.effective_from?new Date(o.effective_from).toLocaleDateString():"N/A"]}),e.jsxs("div",{children:["To:"," ",o.effective_to?new Date(o.effective_to).toLocaleDateString():"N/A"]})]}),e.jsx("td",{className:"max-w-xs truncate",title:o.reason,children:o.reason}),e.jsx("td",{className:"text-sm",children:o.approver_name||"System"}),e.jsx("td",{children:o.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Le,{to:`/administration/exceptional-permissions/${o.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},o.id))})]})})]})})]})}function mw(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState([]);x.useEffect(()=>{d()},[]);async function d(){var b;try{const y=await ee.get("/admin/users"),j=y.data&&y.data.data&&y.data.data.items||((b=y.data)==null?void 0:b.items)||[];u(j)}catch(y){console.error("Failed to fetch users",y)}}const[c,h]=x.useState({username:"",permissionCode:"",effect:"ALLOW",reason:"",is_active:!0,effective_from:"",effective_to:"",exception_type:"TEMPORARY"}),A=["Clearing Bill Cancellation","Direct Purchase Cancellation","Discount in Sales Invoice","Discount in Sales Order","Discount in Sales Quotation","GRN Cancellation","Price Editable in Sales Invoice","Price Editable in Sales Order","Price Editable in Sales Quotation","Import Bill cancellation","Leave Requet Approval -Stage","Local Bill cancellation","POS DELIVERY CANCEL","POS DISCOUNT","Sales Invoice cancellation"];x.useEffect(()=>{r&&f()},[s]);async function f(){var b,y,j;try{n(!0),l("");const N=await ee.get(`/admin/exceptional-permissions/${s}`);if((b=N.data)!=null&&b.item){const S=N.data.item;S.effective_from&&(S.effective_from=S.effective_from.split("T")[0]),S.effective_to&&(S.effective_to=S.effective_to.split("T")[0]),!S.username&&S.user_name&&(S.username=S.user_name),!S.permissionCode&&S.permission_code&&(S.permissionCode=S.permission_code),h(S)}}catch(N){l(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Error fetching permission")}finally{n(!1)}}function g(b,y){h(j=>({...j,[b]:y}))}async function v(b){var y,j;b.preventDefault(),n(!0),l("");try{r?await ee.put(`/admin/exceptional-permissions/${s}`,c):await ee.post("/admin/exceptional-permissions",c),t("/administration/users")}catch(N){l(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Error saving permission")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/exceptional-permissions",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Exceptional Permissions"}),e.jsx(Le,{to:"/administration/users",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block ml-4",children:" Back to Users"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Exceptional Permission":"New Exceptional Permission"}),e.jsx("p",{className:"text-sm mt-1",children:"Temporary user-specific overrides"})]}),e.jsx("form",{onSubmit:v,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Username *"}),e.jsxs("select",{className:"input",value:c.username,onChange:b=>g("username",b.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select User --"}),o.map(b=>e.jsx("option",{value:b.username,children:b.username},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Permission *"}),e.jsxs("select",{className:"input",value:c.permissionCode,onChange:b=>g("permissionCode",b.target.value),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Permission --"}),A.map(b=>e.jsx("option",{value:b,children:b},b))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effect"}),e.jsxs("select",{className:"input",value:c.effect,onChange:b=>g("effect",b.target.value),children:[e.jsx("option",{value:"ALLOW",children:"Allow"}),e.jsx("option",{value:"DENY",children:"Deny"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exception Type"}),e.jsxs("select",{className:"input",value:c.exception_type,onChange:b=>g("exception_type",b.target.value),children:[e.jsx("option",{value:"TEMPORARY",children:"Temporary"}),e.jsx("option",{value:"PERMANENT",children:"Permanent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective From"}),e.jsx("input",{type:"date",className:"input",value:c.effective_from,onChange:b=>g("effective_from",b.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective To"}),e.jsx("input",{type:"date",className:"input",value:c.effective_to,onChange:b=>g("effective_to",b.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Reason"}),e.jsx("input",{className:"input",value:c.reason,onChange:b=>g("reason",b.target.value),placeholder:"Reason for this exception"})]}),e.jsxs("div",{className:"flex items-center mt-8",children:[e.jsx("input",{type:"checkbox",id:"is_active",className:"w-5 h-5 text-brand rounded focus:ring-brand-500 border-gray-300",checked:c.is_active,onChange:b=>g("is_active",b.target.checked)}),e.jsx("label",{htmlFor:"is_active",className:"ml-2 block text-sm text-slate-900 dark:text-white",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/administration/exceptional-permissions",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update":"Create"})]})]})})})]})}function hL(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(null);x.useEffect(()=>{l()},[]);const l=async()=>{try{a(!0);const o=await ee.get("/admin/companies");s(o.data.items||[])}catch(o){i(o.message||"Failed to fetch companies")}finally{a(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Company Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage companies"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/administration/companies/new",className:"btn-success",children:"+ New Company"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:r?e.jsx("div",{className:"text-center py-4",children:"Loading..."}):n?e.jsx("div",{className:"text-red-500 py-4",children:n}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colspan:"4",className:"text-center py-4 text-gray-500",children:"No companies found"})}):t.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.code}),e.jsx("td",{children:o.name}),e.jsx("td",{children:o.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Le,{to:`/administration/companies/${o.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},o.id))})]})})})})]})}function fw(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({code:"",name:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",telephone:"",email:"",website:"",tax_id:"",registration_no:"",fiscal_year_start_month:1,timezone:"",currency_id:""}),[d,c]=x.useState([]),[h,A]=x.useState(null),[f,g]=x.useState(""),[v,b]=x.useState(!1),[y,j]=x.useState("");x.useEffect(()=>{S(),r&&N()},[s]),x.useEffect(()=>()=>{f&&URL.revokeObjectURL(f)},[f]);async function N(){var q,V,M,z;try{n(!0),l("");const I=await ee.get(`/admin/companies/${s}`);if((q=I.data)!=null&&q.item){const G=I.data.item;u({code:G.code||"",name:G.name||"",isActive:G.is_active===1||G.is_active===!0,address:G.address||"",city:G.city||"",state:G.state||"",postal_code:G.postal_code||"",country:G.country||"",telephone:G.telephone||"",email:G.email||"",website:G.website||"",tax_id:G.tax_id||"",registration_no:G.registration_no||"",fiscal_year_start_month:G.fiscal_year_start_month||1,timezone:G.timezone||"",currency_id:G.currency_id||""});try{const Y=new Date().getTime(),J=await ee.get(`/admin/companies/${s}/logo?t=${Y}`,{responseType:"blob"});if(J.data&&J.data.size>0){const T=URL.createObjectURL(J.data);g(T),console.log("Logo loaded on fetch")}}catch(Y){console.log("No logo found for company:",(V=Y==null?void 0:Y.response)==null?void 0:V.status)}}}catch(I){l(((z=(M=I==null?void 0:I.response)==null?void 0:M.data)==null?void 0:z.message)||"Error fetching company")}finally{n(!1)}}async function S(){var q;try{const V=await ee.get("/finance/currencies"),M=Array.isArray((q=V.data)==null?void 0:q.items)?V.data.items:[];c(M)}catch{}}async function B(q){var V,M,z,I,G;try{const Y=new Date().getTime();console.log("Fetching logo for company:",q,"timestamp:",Y);const J=await ee.get(`/admin/companies/${q}/logo?t=${Y}`,{responseType:"blob"});if(console.log("Logo response:",J.status,"size:",(V=J.data)==null?void 0:V.size),J.data&&J.data.size>0){const T=URL.createObjectURL(J.data);g(T),console.log("Logo loaded successfully from server:",T)}else console.warn("Logo response is empty",J.data),j("Logo uploaded but could not be retrieved")}catch(Y){console.error("Failed to load logo from server:",{status:(M=Y==null?void 0:Y.response)==null?void 0:M.status,statusText:(z=Y==null?void 0:Y.response)==null?void 0:z.statusText,message:Y==null?void 0:Y.message,data:(I=Y==null?void 0:Y.response)==null?void 0:I.data}),((G=Y==null?void 0:Y.response)==null?void 0:G.status)!==404&&j("Failed to load uploaded logo")}}function P(q){var z;const V=(z=q.target.files)==null?void 0:z[0];if(j(""),!V)return;if(!String(V.type).startsWith("image/")){j("Only image files are allowed");return}if(V.size>2*1024*1024){j("Image size must be less than 2MB");return}A(V);const M=URL.createObjectURL(V);g(M)}async function L(){var q,V;if(!r){j("Save company first before uploading logo");return}if(!h){j("Choose an image file to upload");return}b(!0),j("");try{console.log("Uploading logo file:",h.name,h.size);const M=new FormData;M.append("logo",h);const z=await ee.post(`/admin/companies/${s}/logo`,M,{headers:{"Content-Type":"multipart/form-data"}});console.log("Upload response:",z.data),A(null),await B(s)}catch(M){console.error("Upload error:",M),j(((V=(q=M==null?void 0:M.response)==null?void 0:q.data)==null?void 0:V.message)||"Failed to upload logo")}finally{b(!1)}}function U(q,V){u(M=>({...M,[q]:V}))}async function H(q){var V,M,z;q.preventDefault(),n(!0),l("");try{const I={name:o.name,code:o.code,is_active:o.isActive?1:0,address:o.address||void 0,city:o.city||void 0,state:o.state||void 0,postal_code:o.postal_code||void 0,country:o.country||void 0,telephone:o.telephone||void 0,email:o.email||void 0,website:o.website||void 0,tax_id:o.tax_id||void 0,registration_no:o.registration_no||void 0,fiscal_year_start_month:o.fiscal_year_start_month!==void 0&&o.fiscal_year_start_month!==null?Number(o.fiscal_year_start_month):void 0,timezone:o.timezone||void 0,currency_id:o.currency_id!==""&&o.currency_id!==null?Number(o.currency_id):void 0};let G=s;if(r?await ee.put(`/admin/companies/${s}`,I):(G=(V=(await ee.post("/admin/companies",I)).data)==null?void 0:V.id,G&&await ee.put(`/admin/companies/${G}`,I)),h&&G)try{console.log("Submitting logo with company:",G);const Y=new FormData;Y.append("logo",h);const J=await ee.post(`/admin/companies/${G}/logo`,Y,{headers:{"Content-Type":"multipart/form-data"}});console.log("Logo upload response:",J.data),A(null),await B(G)}catch(Y){console.error("Logo upload during submit failed:",Y)}t("/administration/companies")}catch(I){l(((z=(M=I==null?void 0:I.response)==null?void 0:M.data)==null?void 0:z.message)||"Error saving company")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/companies",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Companies"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Company":"New Company"}),e.jsx("p",{className:"text-sm mt-1",children:"Company profile"})]}),e.jsx("form",{onSubmit:H,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:o.code,onChange:q=>U("code",q.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:o.name,onChange:q=>U("name",q.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.isActive?"1":"0",onChange:q=>U("isActive",q.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("input",{className:"input",value:o.address,onChange:q=>U("address",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:o.city,onChange:q=>U("city",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:o.state,onChange:q=>U("state",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Postal Code"}),e.jsx("input",{className:"input",value:o.postal_code,onChange:q=>U("postal_code",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input",value:o.country,onChange:q=>U("country",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Telephone"}),e.jsx("input",{className:"input",value:o.telephone,onChange:q=>U("telephone",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:o.email,onChange:q=>U("email",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Website"}),e.jsx("input",{className:"input",value:o.website,onChange:q=>U("website",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax ID"}),e.jsx("input",{className:"input",value:o.tax_id,onChange:q=>U("tax_id",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Registration No."}),e.jsx("input",{className:"input",value:o.registration_no,onChange:q=>U("registration_no",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year Start Month"}),e.jsx("input",{className:"input",type:"number",min:"1",max:"12",value:o.fiscal_year_start_month,onChange:q=>U("fiscal_year_start_month",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Timezone"}),e.jsx("input",{className:"input",value:o.timezone,onChange:q=>U("timezone",q.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:o.currency_id,onChange:q=>U("currency_id",q.target.value),children:[e.jsx("option",{value:"",children:"Select Currency"}),d.map(q=>e.jsx("option",{value:q.id,children:(q.code||q.currency_code)+" - "+(q.name||q.currency_name)},q.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Company Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-20 h-20 border border-gray-200 rounded-lg flex items-center justify-center bg-white dark:bg-slate-800",children:f?e.jsx("img",{src:f,alt:"Logo Preview",className:"w-full h-full object-contain"}):e.jsx("span",{className:"text-sm text-slate-500",children:"No logo"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:P,className:"input"}),e.jsx("div",{className:"mt-2",children:h&&e.jsx("button",{type:"button",onClick:L,className:"btn-success",disabled:v,children:v?"Uploading...":"Upload Logo"})}),y&&e.jsx("div",{className:"text-red-600 text-xs mt-2",children:y})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/administration/companies",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update":"Create"})]})]})})})]})}function mL({branches:t,companies:s,onUpdate:r}){const[a,n]=x.useState([]),[i,l]=x.useState(!0),[o,u]=x.useState(""),[d,c]=x.useState(!1),[h,A]=x.useState(null),[f,g]=x.useState({companyId:"",branchIds:[]}),[v,b]=x.useState(!1);x.useEffect(()=>{y()},[]);const y=async()=>{try{l(!0);const P=await ee.get("/admin/users");n(P.data.items||[])}catch(P){console.error("Failed to fetch users",P)}finally{l(!1)}},j=async P=>{var U;A(P);const L={companyId:P.company_id||"",branchIds:P.branch_id?[String(P.branch_id)]:[]};try{const H=await ee.get(`/admin/users/${P.id}/branches`),q=Array.isArray((U=H.data)==null?void 0:U.items)?H.data.items.map(V=>String(V.id)):[];g({...L,branchIds:q})}catch{g(L)}c(!0)},N=async P=>{if(P.preventDefault(),!!h){b(!0);try{await ee.put(`/admin/users/${h.id}/branches`,{company_id:f.companyId,branch_ids:f.branchIds.map(L=>Number(L))}),await y(),r&&r(),c(!1),A(null)}catch(L){alert("Failed to update user branch: "+L.message)}finally{b(!1)}}},S=f.companyId?t.filter(P=>String(P.company_id)===String(f.companyId)):[],B=a.filter(P=>{const L=o.toLowerCase();return P.username.toLowerCase().includes(L)||P.email.toLowerCase().includes(L)||P.full_name&&P.full_name.toLowerCase().includes(L)});return e.jsxs("div",{children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",className:"search-input",placeholder:" Search users...",value:o,onChange:P=>u(P.target.value)}),e.jsx("button",{className:"btn btn-secondary",onClick:y,children:" Refresh Users"})]}),e.jsx("div",{className:"table-container",children:i?e.jsx("div",{className:"p-8 text-center",children:"Loading users..."}):e.jsxs("table",{className:"branch-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Current Company"}),e.jsx("th",{children:"Current Branch"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-4",children:"No users found"})}):B.map(P=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:P.username}),e.jsx("div",{className:"text-sm text-gray-500",children:P.email})]}),e.jsx("td",{children:P.company_name||"Unassigned"}),e.jsx("td",{children:P.branch_name||"Unassigned"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>j(P),children:"Assign Branch"})})]},P.id))})]})}),d&&e.jsx("div",{className:"branch-modal-overlay",children:e.jsxs("div",{className:"branch-modal",style:{maxWidth:"500px"},children:[e.jsxs("div",{className:"branch-modal-header",children:[e.jsxs("h2",{children:["Assign Branch to ",h==null?void 0:h.username]}),e.jsx("button",{className:"branch-close-btn",onClick:()=>c(!1),children:""})]}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"branch-modal-body",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Company"}),e.jsxs("select",{className:"search-input w-full",value:f.companyId,onChange:P=>g({...f,companyId:P.target.value,branchId:""}),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Company --"}),s.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Branches"}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-auto border rounded-md p-2",children:[S.map(P=>{const L=f.branchIds.includes(String(P.id));return e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4",checked:L,onChange:U=>{const H=U.target.checked;g(q=>{const V=new Set(q.branchIds);return H?V.add(String(P.id)):V.delete(String(P.id)),{...q,branchIds:Array.from(V)}})},disabled:!f.companyId}),e.jsx("span",{className:"text-sm",children:P.name})]},P.id)}),f.companyId?null:e.jsx("div",{className:"text-xs text-gray-500",children:"Select a company to view branches"})]})]})]}),e.jsxs("div",{className:"branch-modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>c(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-success",disabled:v,children:v?"Saving...":"Save Assignment"})]})]})]})})]})}function fL(){const[t,s]=x.useState("branches"),[r,a]=x.useState([]),[n,i]=x.useState([]),[l,o]=x.useState(!0),[u,d]=x.useState(null),[c,h]=x.useState(!1),[A,f]=x.useState(null),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState({companyId:"",name:"",code:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",location:"",telephone:"",email:"",remarks:""}),S={totalBranches:r.length,activeBranches:r.filter(q=>q.is_active).length,assignments:0};x.useEffect(()=>{B()},[]);const B=async()=>{try{o(!0);const[q,V]=await Promise.all([ee.get("/admin/branches"),ee.get("/admin/companies")]);a(q.data.items||[]),i(V.data.items||[])}catch(q){d(q.message||"Failed to fetch data")}finally{o(!1)}},P=async()=>{try{const q=await ee.get("/admin/branches");a(q.data.items||[])}catch(q){console.error("Failed to refresh branches",q)}},L=(q=null)=>{f(q),N(q?{companyId:q.company_id,name:q.name,code:q.code,isActive:q.is_active,address:q.address||"",city:q.city||"",state:q.state||"",postal_code:q.postal_code||"",country:q.country||"",location:q.location||"",telephone:q.telephone||"",email:q.email||"",remarks:q.remarks||""}:{companyId:"",name:"",code:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",location:"",telephone:"",email:"",remarks:""}),y(""),h(!0)},U=()=>{h(!1),f(null),y("")},H=async q=>{var V,M;q.preventDefault(),v(!0),y("");try{A?await ee.put(`/admin/branches/${A.id}`,{company_id:j.companyId,name:j.name,code:j.code,is_active:j.isActive,address:j.address||null,city:j.city||null,state:j.state||null,postal_code:j.postal_code||null,country:j.country||null,location:j.location||null,telephone:j.telephone||null,email:j.email||null,remarks:j.remarks||null}):await ee.post("/admin/branches",{company_id:j.companyId,name:j.name,code:j.code,is_active:j.isActive,address:j.address||null,city:j.city||null,state:j.state||null,postal_code:j.postal_code||null,country:j.country||null,location:j.location||null,telephone:j.telephone||null,email:j.email||null,remarks:j.remarks||null}),await P(),U()}catch(z){y(((M=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:M.message)||z.message||"Failed to save branch")}finally{v(!1)}};return e.jsxs("div",{className:"branch-setup-container",children:[e.jsxs("div",{className:"branch-header",children:[e.jsx("div",{children:e.jsx("h1",{children:" Branch Management System"})}),e.jsxs("div",{className:"header-actions",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>window.location.reload(),children:" Refresh"})]})]}),e.jsxs("div",{className:"branch-content",children:[e.jsxs("div",{className:"branch-stats",children:[e.jsxs("div",{className:"branch-stat-card",children:[e.jsx("h3",{children:"Total Branches"}),e.jsx("div",{className:"value",children:S.totalBranches})]}),e.jsxs("div",{className:"branch-stat-card",children:[e.jsx("h3",{children:"Active Branches"}),e.jsx("div",{className:"value",children:S.activeBranches})]}),e.jsxs("div",{className:"branch-stat-card",children:[e.jsx("h3",{children:"Assignments"}),e.jsx("div",{className:"value",children:S.assignments})]})]}),e.jsxs("div",{className:"branch-tabs",children:[e.jsx("button",{className:`branch-tab ${t==="users"?"active":""}`,onClick:()=>s("users"),children:" User Branch Assignment"}),e.jsx("button",{className:`branch-tab ${t==="branches"?"active":""}`,onClick:()=>s("branches"),children:" Branch Management"}),e.jsx("button",{className:`branch-tab ${t==="history"?"active":""}`,onClick:()=>s("history"),children:" Assignment History"})]}),e.jsxs("div",{className:`tab-content ${t==="branches"?"active":""}`,children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("input",{type:"text",className:"search-input",placeholder:" Search branches..."}),e.jsx("button",{className:"btn btn-success",onClick:()=>L(null),children:" Add New Branch"})]}),e.jsx("div",{className:"table-container",children:l?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):u?e.jsx("div",{className:"p-8 text-center text-red-500",children:u}):e.jsxs("table",{className:"branch-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-4 text-gray-500",children:"No branches found"})}):r.map(q=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:q.code}),e.jsx("td",{children:q.name}),e.jsx("td",{children:q.company_name||"N/A"}),e.jsx("td",{children:q.is_active?e.jsx("span",{className:"branch-badge branch-badge-success",children:"Active"}):e.jsx("span",{className:"branch-badge branch-badge-danger",children:"Inactive"})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>L(q),children:"Edit"})})]},q.id))})]})})]}),e.jsx("div",{className:`tab-content ${t==="users"?"active":""}`,children:e.jsx(mL,{branches:r,companies:n,onUpdate:B})}),e.jsx("div",{className:`tab-content ${t==="history"?"active":""}`,children:e.jsx("div",{className:"p-8 text-center text-gray-500",children:e.jsx("p",{children:"History log coming soon."})})})]}),c&&e.jsx("div",{className:"branch-modal-overlay",children:e.jsxs("div",{className:"branch-modal",children:[e.jsxs("div",{className:"branch-modal-header",children:[e.jsx("h2",{children:A?"Edit Branch":"New Branch"}),e.jsx("button",{className:"branch-close-btn",onClick:U,children:""})]}),e.jsxs("form",{onSubmit:H,children:[e.jsxs("div",{className:"branch-modal-body",children:[b&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:b}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Company *"}),e.jsxs("select",{className:"search-input w-full",value:j.companyId,onChange:q=>N({...j,companyId:q.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Company --"}),n.map(q=>e.jsxs("option",{value:q.id,children:[q.name," (",q.code,")"]},q.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Code *"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.code,onChange:q=>N({...j,code:q.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Name *"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.name,onChange:q=>N({...j,name:q.target.value}),required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Status"}),e.jsxs("select",{className:"search-input w-full",value:j.isActive?"1":"0",onChange:q=>N({...j,isActive:q.target.value==="1"}),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Address"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.address,onChange:q=>N({...j,address:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Location"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.location,onChange:q=>N({...j,location:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"City"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.city,onChange:q=>N({...j,city:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"State"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.state,onChange:q=>N({...j,state:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Postal Code"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.postal_code,onChange:q=>N({...j,postal_code:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Country"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.country,onChange:q=>N({...j,country:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Telephone"}),e.jsx("input",{type:"text",className:"search-input w-full",value:j.telephone,onChange:q=>N({...j,telephone:q.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),e.jsx("input",{type:"email",className:"search-input w-full",value:j.email,onChange:q=>N({...j,email:q.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Remarks"}),e.jsx("textarea",{className:"search-input w-full",rows:"3",value:j.remarks,onChange:q=>N({...j,remarks:q.target.value})})]})]})]}),e.jsxs("div",{className:"branch-modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:U,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-success",disabled:g,children:g?"Saving...":"Save Branch"})]})]})]})})]})}function pw(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({company_id:1,code:"",name:"",isActive:!0,address:"",city:"",state:"",postal_code:"",country:"",location:"",telephone:"",email:"",remarks:""});x.useEffect(()=>{r&&d()},[s]);async function d(){var A,f,g;try{n(!0),l("");const v=await ee.get(`/admin/branches/${s}`);if((A=v.data)!=null&&A.item){const b=v.data.item;u({company_id:b.company_id,code:b.code,name:b.name,isActive:b.is_active,address:b.address||"",city:b.city||"",state:b.state||"",postal_code:b.postal_code||"",country:b.country||"",location:b.location||"",telephone:b.telephone||"",email:b.email||"",remarks:b.remarks||""})}}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error fetching branch")}finally{n(!1)}}function c(A,f){u(g=>({...g,[A]:f}))}async function h(A){var f,g;A.preventDefault(),n(!0),l("");try{const v={company_id:o.company_id,name:o.name,code:o.code,is_active:o.isActive,address:o.address||null,city:o.city||null,state:o.state||null,postal_code:o.postal_code||null,country:o.country||null,location:o.location||null,telephone:o.telephone||null,email:o.email||null,remarks:o.remarks||null};r?await ee.put(`/admin/branches/${s}`,v):await ee.post("/admin/branches",v),t("/administration/branches")}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error saving branch")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6 [&::-webkit-scrollbar]:hidden",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/branches",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Branches"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:r?"Edit Branch":"New Branch"}),e.jsx("p",{className:"text-sm mt-1",children:"Branch profile"})]}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company ID"}),e.jsx("input",{className:"input",type:"number",value:o.company_id,onChange:A=>c("company_id",parseInt(A.target.value)||1),disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:o.code,onChange:A=>c("code",A.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:o.name,onChange:A=>c("name",A.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.isActive?"1":"0",onChange:A=>c("isActive",A.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("input",{className:"input",value:o.address,onChange:A=>c("address",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("input",{className:"input",value:o.location,onChange:A=>c("location",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:o.city,onChange:A=>c("city",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:o.state,onChange:A=>c("state",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Postal Code"}),e.jsx("input",{className:"input",value:o.postal_code,onChange:A=>c("postal_code",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input",value:o.country,onChange:A=>c("country",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Telephone"}),e.jsx("input",{className:"input",value:o.telephone,onChange:A=>c("telephone",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:o.email,onChange:A=>c("email",A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:o.remarks,onChange:A=>c("remarks",A.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/administration/branches",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":r?"Update":"Create"})]})]})})})]})}function pL(){const t=[{title:"User Login Activity",description:"Track user logins by date, user, and IP",path:"/administration/reports/user-login-activity",action:"Open Report"},{title:"System Log Book",description:"Application events and audit activity",path:"/administration/reports/system-log-book",action:"Open Report"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Administration"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Administration Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"System monitoring and audit reporting"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(s=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]}),e.jsx("div",{className:"mt-4",children:e.jsx(Le,{to:s.path,className:"btn-success",children:s.action})})]},s.path))})})})]})}function xL(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState(!1),[c,h]=x.useState({startedAt:"",uptimeSeconds:0,uptimeHuman:"",database:{threadsConnected:0,threadsRunning:0,maxConnections:0,loadPercent:0},recentLogins:[]});async function A(){var f,g,v;try{o(!0);const b=await ee.get("/admin/reports/system-log-book",{params:{from:t||null,to:r||null}});i(((f=b.data)==null?void 0:f.items)||[])}catch(b){nt.error(((v=(g=b==null?void 0:b.response)==null?void 0:g.data)==null?void 0:v.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{A()},[]),x.useEffect(()=>{let f=!1,g=null;async function v(){var b,y,j,N;try{d(!0);const S=await ee.get("/admin/system-status");if(f)return;const B=S.data||{};h({startedAt:String(B.startedAt||""),uptimeSeconds:Number(B.uptimeSeconds||0),uptimeHuman:String(B.uptimeHuman||""),database:{threadsConnected:Number(((b=B==null?void 0:B.database)==null?void 0:b.threadsConnected)||0),threadsRunning:Number(((y=B==null?void 0:B.database)==null?void 0:y.threadsRunning)||0),maxConnections:Number(((j=B==null?void 0:B.database)==null?void 0:j.maxConnections)||0),loadPercent:Number(((N=B==null?void 0:B.database)==null?void 0:N.loadPercent)||0)},recentLogins:Array.isArray(B.recentLogins)?B.recentLogins:[]})}catch{}finally{d(!1)}}return v(),g=setInterval(v,15e3),()=>{f=!0,g&&clearInterval(g)}},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"System Log Book"}),e.jsx("p",{className:"text-sm mt-1",children:"Application events and user activity across modules"})]}),e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"System Status"}),e.jsxs("div",{className:"text-xs text-slate-500",children:["Started ",c.startedAt?new Date(c.startedAt).toLocaleString():"-"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm",children:"Server Uptime"}),e.jsx("div",{className:"text-xl font-bold text-brand-700",children:u?"":c.uptimeHuman||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Database Load"}),e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:u?"":`${Number(c.database.loadPercent||0)}%`}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Connected: ",c.database.threadsConnected," / Max: ",c.database.maxConnections]})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Threads Running"}),e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:u?"":Number(c.database.threadsRunning||0)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Recent Login"}),e.jsxs("div",{className:"text-sm mt-1 space-y-1",children:[u&&e.jsx("div",{children:"Loading"}),!u&&(c.recentLogins.slice(0,5).map(f=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium",children:f.username||"-"}),e.jsx("span",{className:"text-xs text-slate-500",children:f.login_time?new Date(f.login_time).toLocaleString():"-"})]},f.id))||e.jsx("div",{className:"text-xs text-slate-500",children:"No recent logins"}))]})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:f=>s(f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:f=>a(f.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:A,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Module"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Message"})]})}),e.jsx("tbody",{children:n.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:f.event_time?new Date(f.event_time).toLocaleString():"-"}),e.jsx("td",{children:f.user_name||"-"}),e.jsx("td",{children:f.module_name||"-"}),e.jsx("td",{children:f.action||"-"}),e.jsx("td",{className:"font-medium",children:f.ref_no||"-"}),e.jsx("td",{children:f.message||"-"})]},f.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function gL(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState(""),[l,o]=x.useState([]),[u,d]=x.useState(!1);async function c(){var h,A,f;try{d(!0);const g=await ee.get("/admin/reports/user-login-activity",{params:{from:t||null,to:r||null,q:n||null}});o(((h=g.data)==null?void 0:h.items)||[])}catch(g){nt.error(((f=(A=g==null?void 0:g.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load report")}finally{d(!1)}}return x.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"User Login Activity"}),e.jsx("p",{className:"text-sm mt-1",children:"User login events across companies and branches"})]}),e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input",type:"text",placeholder:"Username, name, email, or IP",value:n,onChange:h=>i(h.target.value)})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:c,disabled:u,children:u?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a(""),i("")},disabled:u,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Full Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Roles"}),e.jsx("th",{children:"Company"}),e.jsx("th",{children:"Branch"}),e.jsx("th",{children:"IP Address"}),e.jsx("th",{children:"User Agent"})]})}),e.jsx("tbody",{children:l.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.login_time?new Date(h.login_time).toLocaleString():"-"}),e.jsx("td",{children:h.username||"-"}),e.jsx("td",{children:h.full_name||"-"}),e.jsx("td",{children:h.email||"-"}),e.jsx("td",{children:h.roles||"-"}),e.jsx("td",{children:h.company_name||"-"}),e.jsx("td",{children:h.branch_name||"-"}),e.jsx("td",{children:h.ip_address||"-"}),e.jsx("td",{className:"max-w-xs truncate",title:h.user_agent||"",children:h.user_agent||"-"})]},h.id))})]})}),l.length===0&&!u?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function vL(){const t=ys(),[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(""),[o,u]=x.useState("");x.useEffect(()=>{d()},[]);async function d(){var h,A,f;try{n(!0),l("");const g=await ee.get("/admin/user-assignments"),v=g.data&&g.data.data&&g.data.data.items||((h=g.data)==null?void 0:h.items)||[];r(v)}catch(g){l(((f=(A=g==null?void 0:g.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load assignments")}finally{n(!1)}}const c=s.filter(h=>{const A=o.trim().toLowerCase();return A?String(h.username||"").toLowerCase().includes(A)||String(h.email||"").toLowerCase().includes(A)||String(h.role_name||"").toLowerCase().includes(A):!0});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"User Permissions"}),e.jsx("p",{className:"text-sm mt-1",children:"Review users with customized page-level permissions and manage assignments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>t("/administration/user-permissions"),children:"Assign Rights"})]})]}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("input",{type:"text",placeholder:"Search by user, email, role...",className:"input max-w-md",value:o,onChange:h=>u(h.target.value)}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"btn btn-outline",onClick:d,children:"Refresh"})})]}),a?e.jsx("div",{className:"py-12 text-center",children:e.jsx("div",{className:"loading loading-spinner loading-lg"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Customized Pages"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[c.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.username}),e.jsx("td",{children:h.email}),e.jsx("td",{children:h.role_name?e.jsx("span",{className:"badge",children:h.role_name}):e.jsx("span",{className:"text-xs text-slate-500",children:"None"})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:Number(h.custom_count||0)})}),e.jsx("td",{children:e.jsx("button",{onClick:()=>t("/administration/user-permissions",{state:{selectedUser:h.id}}),className:"btn btn-sm btn-ghost text-brand hover:bg-brand/10",children:"Edit Permissions"})})]},h.id)),c.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-10",children:e.jsx("div",{className:"text-slate-500",children:"No permission assignments found."})})})]})]})})]})})]})}function bL(){var J;const t=ma(),[s,r]=x.useState([]),[a,n]=x.useState([]),[i,l]=x.useState(((J=t.state)==null?void 0:J.selectedUser)||""),[o,u]=x.useState(null),[d,c]=x.useState([]),[h,A]=x.useState({}),[f,g]=x.useState(!1),[v,b]=x.useState(!1),[y,j]=x.useState({type:"",text:""});x.useEffect(()=>{N(),S()},[]),x.useEffect(()=>{i?B(i):(u(null),c([]),A({}))},[i]);async function N(){var T;try{const k=await ee.get("/admin/users"),D=k.data&&k.data.data&&k.data.data.items||((T=k.data)==null?void 0:T.items)||[];n(D)}catch(k){console.error(k);try{await ee.post("/admin/error-logs",{module:"Administration",action:"FetchUsersForPermissions",error_code:(k==null?void 0:k.code)||null,message:(k==null?void 0:k.message)||"Failed to load users",details:{path:"/admin/users"}})}catch{}}}async function S(){var T;try{const k=await ee.get("/admin/pages"),D=k.data&&k.data.data&&k.data.data.items||((T=k.data)==null?void 0:T.items)||[];r(D)}catch{}}async function B(T){var k,D,Q;g(!0),u(null),c([]),A({}),j({type:"",text:""});try{const C=await ee.get(`/admin/users/${T}/permissions-context`),E=C.data&&C.data.data&&C.data.data.role||((k=C.data)==null?void 0:k.role),w=C.data&&C.data.data&&C.data.data.pages||((D=C.data)==null?void 0:D.pages)||[];u(E||null),c(w);const O={};(C.data&&C.data.data&&C.data.data.permissions||((Q=C.data)==null?void 0:Q.permissions)||[]).forEach(X=>{O[X.page_id]={canView:!!X.can_view,canCreate:!!X.can_create,canEdit:!!X.can_edit,canDelete:!!X.can_delete}}),A(O)}catch(C){console.error(C),j({type:"error",text:"Error loading permissions context"});try{await ee.post("/admin/error-logs",{module:"Administration",action:"FetchUserPermissionsContext",error_code:(C==null?void 0:C.code)||null,message:(C==null?void 0:C.message)||"Failed to load permissions context",details:{userId:T}})}catch{}}finally{g(!1)}}const P=(T,k)=>{A(D=>{const Q=D[T]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1};return{...D,[T]:{...Q,[k]:!Q[k]}}})},L=async()=>{if(i){b(!0),j({type:"",text:""});try{const T=Object.entries(h).map(([k,D])=>({page_id:Number(k),can_view:D.canView,can_create:D.canCreate,can_edit:D.canEdit,can_delete:D.canDelete}));await ee.post(`/admin/users/${i}/permissions`,{permissions:T}),j({type:"success",text:"Permissions saved successfully!"})}catch(T){console.error(T),j({type:"error",text:"Error saving permissions."});try{await ee.post("/admin/error-logs",{module:"Administration",action:"SaveUserPermissions",error_code:(T==null?void 0:T.code)||null,message:(T==null?void 0:T.message)||"Failed to save permissions",details:{userId:i,payloadSize:payload.length}})}catch{}}finally{b(!1)}}},U=d.reduce((T,k)=>(T[k.module]||(T[k.module]=[]),T[k.module].push(k),T),{}),H=s.reduce((T,k)=>(T[k.module]||(T[k.module]=[]),T[k.module].push(k),T),{}),q=new Set(d.map(T=>T.id)),V=s.filter(T=>!q.has(T.id)),M=Object.fromEntries(Object.entries(H).map(([T,k])=>{const D=k.filter(E=>E.path),C=D.filter(E=>!/\/(new|create)\b/.test(String(E.path||""))&&!/:id\b/.test(String(E.path||"")))[0]||D[0]||null;return[T,C]})),z=Object.fromEntries(Object.entries(H).map(([T,k])=>{const D=k.filter(Q=>{const C=String(Q.path||"");return!(!C||/\/(new|create)\b/.test(C)||/:id\b/.test(C))});return[T,D]})),I=["/sales/sales-orders","/sales/invoices","/service-management/service-confirmation","/service-management/service-bills"],G=d.filter(T=>I.includes(T.path)),Y=(T,k)=>{A(D=>({...D,[T]:{canView:k,canCreate:k,canEdit:k,canDelete:k}}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/permissions",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Permissions"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"User Permission Assignment"}),e.jsx("p",{className:"text-sm mt-1",children:"Select a user to configure their specific access rights based on their assigned role."})]}),i&&d.length>0&&e.jsx("button",{onClick:L,disabled:v,className:"btn btn-primary",children:v?"Saving...":"Save Changes"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Select User"}),e.jsxs("select",{className:"input",value:i,onChange:T=>l(T.target.value),children:[e.jsx("option",{value:"",children:"-- Select User --"}),a.map(T=>e.jsxs("option",{value:T.id,children:[T.username," (",T.email,")"]},T.id))]})]}),i&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assigned Role"}),e.jsx("div",{className:"p-2 border rounded bg-slate-50 dark:bg-slate-800",children:o?e.jsx("span",{className:"font-semibold text-brand",children:o.name}):e.jsx("span",{className:"text-slate-400 italic",children:"No Role Assigned"})}),o&&e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Role defines which pages are visible. Configure CRUD rights below."})]})]})})}),y.text&&e.jsx("div",{className:`alert ${y.type==="success"?"alert-success":"alert-error"}`,children:y.text}),f&&e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"loading loading-spinner loading-lg"})}),!f&&i&&d.length===0&&e.jsx("div",{className:"card bg-base-200",children:e.jsx("div",{className:"card-body text-center text-slate-500",children:o?"This role has no pages assigned. You can grant access from Additional Pages below.":"Assign a role to this user first to configure permissions, or grant access from Additional Pages below."})}),!f&&i&&d.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Permissions"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-8",children:[Object.keys(M).length>0&&e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100",children:"Dashboard Access"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 dark:bg-slate-800/50 text-left",children:[e.jsx("th",{className:"p-3 w-1/3",children:"Module"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Can View"})]})}),e.jsx("tbody",{children:Object.entries(M).sort(([T],[k])=>T.localeCompare(k)).map(([T,k])=>{if(!k)return null;const D=h[k.id]||{canView:!1};return e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium",children:T}),e.jsxs("div",{className:"text-xs text-slate-500",children:[k.name,"  ",k.path]})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:D.canView,onChange:()=>P(k.id,"canView")})})]},`module-${T}`)})})]})})]}),Object.keys(z).length>0&&e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100",children:"Module Dashboards (Home Cards)"}),e.jsx("div",{className:"space-y-6 p-4",children:Object.entries(z).sort(([T],[k])=>T.localeCompare(k)).map(([T,k])=>{const D=k.every(Q=>(h[Q.id]||{}).canView);return e.jsxs("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100 flex items-center justify-between",children:[e.jsx("div",{children:T}),e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("span",{children:"View all"}),e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:D,onChange:Q=>{const C=Q.target.checked;A(E=>{const w={...E};for(const O of k){const R=w[O.id]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1};w[O.id]={...R,canView:C}}return w})}})]})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(Q=>{const C=h[Q.id]||{canView:!1};return e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Q.name}),e.jsx("div",{className:"text-xs text-slate-500",children:Q.path})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs",children:"View"}),e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:C.canView,onChange:()=>P(Q.id,"canView")})]})]},`dash-page-${Q.id}`)})})})]},`dash-${T}`)})})]}),G.length>0&&e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100",children:"Homepage Featured"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 dark:bg-slate-800/50 text-left",children:[e.jsx("th",{className:"p-3 w-1/3",children:"Page"}),e.jsx("th",{className:"p-3 text-center w-24",children:"View"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Create"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Edit"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Delete"}),e.jsx("th",{className:"p-3 text-center w-24",children:"All"})]})}),e.jsx("tbody",{children:G.map(T=>{const k=h[T.id]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1},D=k.canView&&k.canCreate&&k.canEdit&&k.canDelete;return e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium",children:T.name}),e.jsx("div",{className:"text-xs text-slate-500",children:T.code})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:k.canView,onChange:()=>P(T.id,"canView")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:k.canCreate,onChange:()=>P(T.id,"canCreate")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:k.canEdit,onChange:()=>P(T.id,"canEdit")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:k.canDelete,onChange:()=>P(T.id,"canDelete")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:D,onChange:Q=>Y(T.id,Q.target.checked)})})]},T.id)})})]})})]}),Object.entries(U).map(([T,k])=>e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100",children:T}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 dark:bg-slate-800/50 text-left",children:[e.jsx("th",{className:"p-3 w-1/3",children:"Page"}),e.jsx("th",{className:"p-3 text-center w-24",children:"View"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Create"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Edit"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Delete"}),e.jsx("th",{className:"p-3 text-center w-24",children:"All"})]})}),e.jsx("tbody",{children:k.map(D=>{const Q=h[D.id]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1},C=Q.canView&&Q.canCreate&&Q.canEdit&&Q.canDelete;return e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium",children:D.name}),e.jsx("div",{className:"text-xs text-slate-500",children:D.code})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canView,onChange:()=>P(D.id,"canView")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canCreate,onChange:()=>P(D.id,"canCreate")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canEdit,onChange:()=>P(D.id,"canEdit")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canDelete,onChange:()=>P(D.id,"canDelete")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:C,onChange:E=>Y(D.id,E.target.checked)})})]},D.id)})})]})})]},T)),V.length>0&&e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 px-4 py-2 border-b border-slate-200 dark:border-slate-700 font-semibold text-slate-900 dark:text-slate-100",children:"Additional Pages (Grant access beyond role)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50/50 dark:bg-slate-800/50 text-left",children:[e.jsx("th",{className:"p-3 w-1/3",children:"Page"}),e.jsx("th",{className:"p-3 text-center w-24",children:"View"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Create"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Edit"}),e.jsx("th",{className:"p-3 text-center w-24",children:"Delete"}),e.jsx("th",{className:"p-3 text-center w-24",children:"All"})]})}),e.jsx("tbody",{children:Object.entries(H).map(([T,k])=>k.filter(D=>!q.has(D.id)).map(D=>{const Q=h[D.id]||{canView:!1,canCreate:!1,canEdit:!1,canDelete:!1},C=Q.canView&&Q.canCreate&&Q.canEdit&&Q.canDelete;return e.jsxs("tr",{className:"border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium",children:D.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:[T,"  ",D.code]})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canView,onChange:()=>P(D.id,"canView")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canCreate,onChange:()=>P(D.id,"canCreate")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canEdit,onChange:()=>P(D.id,"canEdit")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:Q.canDelete,onChange:()=>P(D.id,"canDelete")})}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("input",{type:"checkbox",className:"checkbox checkbox-sm",checked:C,onChange:E=>Y(D.id,E.target.checked)})})]},`extra-${D.id}`)}))})]})})]})]})}),e.jsx("div",{className:"card-footer bg-slate-50 dark:bg-slate-800 p-4 rounded-b-lg flex justify-end",children:e.jsx("button",{onClick:L,disabled:v,className:"btn btn-primary",children:v?"Saving...":"Save Changes"})})]})]})}function yL(){const[t,s]=x.useState(()=>{try{const v=localStorage.getItem("push_enabled");return v===null?!0:String(v)==="1"}catch{return!0}}),[r,a]=x.useState(()=>{try{if(typeof window<"u"&&"Notification"in window)return String(window.Notification.permission||"default")}catch{}return"default"}),[n,i]=x.useState({name:"",address:"",city:"",state:"",postalCode:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:"",logoVersion:0}),[l,o]=x.useState(""),[u,d]=x.useState(""),c=x.useRef(null);function h(v){try{const b=c.current;b&&b!==v&&URL.revokeObjectURL(b)}catch{}c.current=v||null,d(String(v||""))}x.useEffect(()=>{try{typeof window<"u"&&"Notification"in window&&a(String(window.Notification.permission||"default"))}catch{}},[]),x.useEffect(()=>{try{localStorage.setItem("push_enabled",t?"1":"0")}catch{}},[t]);async function A(){try{if(typeof window>"u"||!("Notification"in window))return;const v=await window.Notification.requestPermission();a(String(v||"default")),nt[v==="granted"?"success":"info"](v==="granted"?"Notifications enabled":"Notifications permission denied or dismissed")}catch{}}async function f(){var v;try{let b=function(L){const U="=".repeat((4-L.length%4)%4),H=(L+U).replace(/-/g,"+").replace(/_/g,"/"),q=window.atob(H),V=new Uint8Array(q.length);for(let M=0;M<q.length;++M)V[M]=q.charCodeAt(M);return V};if(typeof window>"u"||!("serviceWorker"in navigator)||!("PushManager"in window)||!("Notification"in window))return;if(window.Notification.permission!=="granted"){nt.info("Grant notification permission first");return}const y=await navigator.serviceWorker.ready,j=await ee.get("/push/public-key"),N=String(((v=j.data)==null?void 0:v.publicKey)||"");if(!N){nt.error("Missing VAPID public key");return}const S=b(N),B=await y.pushManager.getSubscription();if(B&&B.endpoint){await ee.post("/push/subscribe",{subscription:B.toJSON()}),nt.success("Push subscription saved");return}const P=await y.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:S});await ee.post("/push/subscribe",{subscription:P.toJSON()}),nt.success("Subscribed to push notifications")}catch{nt.error("Failed to subscribe")}}async function g(){try{if(typeof window>"u"||!("serviceWorker"in navigator))return;const b=await(await navigator.serviceWorker.ready).pushManager.getSubscription();if(b&&b.endpoint){try{await ee.delete("/push/unsubscribe",{data:{subscription:b.toJSON()}})}catch{}try{await b.unsubscribe()}catch{}nt.success("Unsubscribed")}else nt.info("No active subscription")}catch{nt.error("Failed to unsubscribe")}}return x.useEffect(()=>{let v=!0;async function b(){var y,j,N;try{const B=(j=(y=(await ee.get("/admin/me")).data)==null?void 0:y.scope)==null?void 0:j.companyId;if(!B)return;const L=((N=(await ee.get(`/admin/companies/${B}`)).data)==null?void 0:N.item)||{};let U=L.has_logo===1||L.has_logo===!0?`/api/admin/companies/${B}/logo`:"";if(!v)return;i({name:L.name||"",address:L.address||"",city:L.city||"",state:L.state||"",postalCode:L.postal_code||"",country:L.country||"",phone:L.telephone||"",email:L.email||"",website:L.website||"",taxId:L.tax_id||"",registrationNo:L.registration_no||"",logoUrl:U,logoVersion:Date.now()})}catch{}}return b(),()=>{v=!1}},[]),x.useEffect(()=>{function v(b){const y=(b==null?void 0:b.detail)||{};i(j=>({...j,...y,logoVersion:y.logoVersion||Date.now()}));try{y.logoDataUrl&&o(String(y.logoDataUrl)),y.logoObjectUrl&&h(String(y.logoObjectUrl))}catch{}}return window.addEventListener("company_info_updated",v),()=>window.removeEventListener("company_info_updated",v)},[]),x.useEffect(()=>{let v=!0;async function b(){try{const y=String(n.logoUrl||"").trim();if(!y){o(""),h("");return}const j=n.logoVersion||Date.now(),N=`${y}${y.includes("?")?"&":"?"}v=${encodeURIComponent(String(j))}`,S=await fetch(N,{credentials:"include"});if(!S.ok){o(""),h("");return}const B=await S.blob();if(!v)return;const P=URL.createObjectURL(B);h(P),o("")}catch{o(""),h("")}}return b(),()=>{v=!1}},[n.logoUrl,n.logoVersion]),x.useEffect(()=>()=>{try{const v=c.current;v&&URL.revokeObjectURL(v)}catch{}},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Push Notifications"}),e.jsxs("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:["Permission: ",r]})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("span",{className:"text-sm",children:"Enabled"}),e.jsx("input",{type:"checkbox",className:"toggle",checked:t,onChange:v=>s(v.target.checked)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:A,children:"Request Permission"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:f,disabled:!t,children:"Subscribe Now"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:g,children:"Unsubscribe"})]}),e.jsx("div",{className:"text-xs text-slate-500",children:"When enabled, the app registers for push after login and delivers background alerts."})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Administration Settings"}),e.jsx("p",{className:"text-sm mt-1",children:"Notifications and document setup"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:"/administration",className:"btn btn-secondary",children:"Return to Menu"})})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Document Templates"}),e.jsx("div",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Manage print and PDF templates for Sales Order, Invoice, and more."}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsx(Le,{to:"/administration/settings/templates?type=sales-order",className:"btn-outline",children:"Sales Order"}),e.jsx(Le,{to:"/administration/settings/templates?type=invoice",className:"btn-outline",children:"Invoice"}),e.jsx(Le,{to:"/administration/settings/templates?type=delivery-note",className:"btn-outline",children:"Delivery Note"}),e.jsx(Le,{to:"/administration/settings/templates?type=payment-voucher",className:"btn-outline",children:"Payment Voucher"}),e.jsx(Le,{to:"/administration/settings/templates?type=salary-slip",className:"btn-outline",children:"Salary Slip"}),e.jsx(Le,{to:"/administration/settings/templates?type=receipt-voucher",className:"btn-outline",children:"Receipt Voucher"}),e.jsx(Le,{to:"/administration/settings/templates?type=quotation",className:"btn-outline",children:"Quotation"})]})]})})]})}function s5({open:t,onClose:s,html:r,downloading:a=!1,onDownload:n}){const i=x.useRef(null);return x.useEffect(()=>{if(t)try{const l=i.current;l&&l.contentWindow&&l.contentWindow.focus()}catch{}},[t,r]),t?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow max-w-5xl w-full",children:[e.jsxs("div",{className:"px-5 py-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Print Preview"}),e.jsx("button",{className:"btn-outline",onClick:s,children:""})]}),e.jsx("div",{className:"p-0",children:e.jsx("iframe",{ref:i,title:"preview",srcDoc:String(r||""),className:"w-full h-[70vh]"})}),e.jsxs("div",{className:"px-5 py-4 border-t flex justify-end gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:()=>{try{const l=i.current;l&&l.contentWindow&&l.contentWindow.print()}catch{}},children:"Print"}),e.jsx("button",{className:"btn-success",disabled:a,onClick:n,children:a?"Downloading...":"Download PDF"})]})]})}):null}const vv=[{value:"sales-order",label:"Sales Order"},{value:"invoice",label:"Invoice"},{value:"quotation",label:"Quotation"},{value:"delivery-note",label:"Delivery Note"},{value:"salary-slip",label:"Salary Slip"},{value:"payment-voucher",label:"Payment Voucher"},{value:"receipt-voucher",label:"Receipt Voucher"}];function jL(){const[t]=Ef(),s=x.useMemo(()=>{const I=String(t.get("type")||"").trim(),G=vv.find(Y=>Y.value===I);return G?G.value:vv[0].value},[t]),[r,a]=x.useState(s),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState(null),[A,f]=x.useState({name:"",html_content:"",is_default:!1,header_logo_url:"",header_name:"",header_address:"",header_address2:"",header_phone:"",header_email:"",header_website:""}),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState(""),[S,B]=x.useState(!1);x.useEffect(()=>{P()},[r]);async function P(){var I,G,Y;try{o(!0),d("");const J=await ee.get(`/templates/${r}`),T=Array.isArray((I=J.data)==null?void 0:I.items)?J.data.items:[];i(T)}catch(J){d(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to load templates")}finally{o(!1)}}function L(){h(null),f({name:"",html_content:"",is_default:!1,header_logo_url:"",header_name:"",header_address:"",header_address2:"",header_phone:"",header_email:"",header_website:""})}function U(I){h(I),f({name:String(I.name||""),html_content:"",is_default:Number(I.is_default)===1,header_logo_url:"",header_name:"",header_address:"",header_address2:"",header_phone:"",header_email:"",header_website:""}),ee.get(`/templates/item/${I.id}`).then(G=>{var J;const Y=((J=G.data)==null?void 0:J.item)||{};f(T=>({...T,html_content:String(Y.html_content||""),header_logo_url:String(Y.header_logo_url||""),header_name:String(Y.header_name||""),header_address:String(Y.header_address||""),header_address2:String(Y.header_address2||""),header_phone:String(Y.header_phone||""),header_email:String(Y.header_email||""),header_website:String(Y.header_website||"")}))}).catch(()=>{})}async function H(){var I,G;try{const Y=String(A.name||"").trim(),J=String(A.html_content||"").trim();if(!Y||!J){nt.info("Enter name and HTML content");return}if(c)await ee.put(`/templates/${c.id}`,{name:Y,html_content:J,is_default:A.is_default?1:0,header_logo_url:A.header_logo_url||"",header_name:A.header_name||"",header_address:A.header_address||"",header_address2:A.header_address2||"",header_phone:A.header_phone||"",header_email:A.header_email||"",header_website:A.header_website||""}),nt.success("Template updated");else{const T=await ee.post("/templates",{name:Y,document_type:r,html_content:J,is_default:A.is_default?1:0,header_logo_url:A.header_logo_url||"",header_name:A.header_name||"",header_address:A.header_address||"",header_address2:A.header_address2||"",header_phone:A.header_phone||"",header_email:A.header_email||"",header_website:A.header_website||""});nt.success("Template created")}await P(),L()}catch(Y){nt.error(((G=(I=Y==null?void 0:Y.response)==null?void 0:I.data)==null?void 0:G.message)||"Failed to save")}}async function q(I){var G,Y;try{await ee.put(`/templates/${I.id}`,{name:I.name,html_content:I.html_content||"",is_default:1}),nt.success("Default set"),await P()}catch(J){nt.error(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to set default")}}async function V(I){var G,Y;try{await ee.delete(`/templates/${I.id}`),nt.success("Template deleted"),await P()}catch(J){nt.error(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to delete")}}async function M(I){var G,Y;try{const J=Number(j),T=!Number.isFinite(J)||J<=0?await ee.post(`/documents/${r}/preview`,{format:"html"}):await ee.post(`/documents/${r}/${J}/render`,{format:"html"});y(String(T.data||"")),v(!0)}catch(J){nt.error(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to render")}}async function z(){var I,G;try{B(!0);const Y=Number(j),J=!Number.isFinite(Y)||Y<=0?`/documents/${r}/preview?format=pdf`:`/documents/${r}/${Y}/render?format=pdf`,k=(await ee.post(J,{},{responseType:"blob"})).data,D=URL.createObjectURL(k),Q=document.createElement("a");Q.href=D,Q.download=`${r}-${Number.isFinite(Y)&&Y>0?Y:"preview"}.pdf`,Q.click(),URL.revokeObjectURL(D)}catch(Y){nt.error(((G=(I=Y==null?void 0:Y.response)==null?void 0:I.data)==null?void 0:G.message)||"Failed to download")}finally{B(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/administration/settings",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300 mb-2 inline-block",children:" Back to Settings"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Document Templates"}),e.jsx("p",{className:"text-sm mt-1",children:"Create, edit, preview, and set default templates"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("label",{className:"label",children:"Document Type"}),e.jsx("select",{className:"input w-64",value:r,onChange:I=>a(I.target.value),children:vv.map(I=>e.jsx("option",{value:I.value,children:I.label},I.value))}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.jsx("input",{type:"number",className:"input w-40",placeholder:"Sample ID",value:j,onChange:I=>N(I.target.value)}),e.jsx("button",{className:"btn-outline",disabled:l,onClick:()=>P(),children:"Refresh"}),e.jsx("button",{className:"btn-success",onClick:L,children:"+ New Template"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[u?e.jsx("div",{className:"text-sm text-red-600 mb-3",children:u}):null,e.jsx("div",{className:"overflow-auto border rounded",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"text-black",children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-black",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-black",children:"Default"}),e.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-black",children:"Actions"})]})}),e.jsxs("tbody",{children:[n.map(I=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"px-3 py-2 text-sm",children:I.name}),e.jsx("td",{className:"px-3 py-2 text-sm",children:Number(I.is_default)===1?"Yes":"No"}),e.jsx("td",{className:"px-3 py-2",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:()=>U(I),children:"Edit"}),e.jsx("button",{className:"btn-outline",onClick:()=>M(),children:"Preview"}),Number(I.is_default)!==1?e.jsx("button",{className:"btn-primary",onClick:()=>q(I),children:"Set Default"}):null,Number(I.is_default)!==1?e.jsx("button",{className:"btn-danger",onClick:()=>V(I),children:"Delete"}):null]})})]},I.id)),n.length?null:e.jsx("tr",{children:e.jsx("td",{className:"px-3 py-3 text-sm text-slate-500",colSpan:3,children:"No templates for this type"})})]})]})})]}),e.jsx("div",{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name"}),e.jsx("input",{className:"input",value:A.name,onChange:I=>f(G=>({...G,name:I.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Header Company Name"}),e.jsx("input",{className:"input",value:A.header_name,onChange:I=>f(G=>({...G,header_name:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Header Phone"}),e.jsx("input",{className:"input",value:A.header_phone,onChange:I=>f(G=>({...G,header_phone:I.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Header Address"}),e.jsx("input",{className:"input",value:A.header_address,onChange:I=>f(G=>({...G,header_address:I.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Header Address 2"}),e.jsx("input",{className:"input",value:A.header_address2,onChange:I=>f(G=>({...G,header_address2:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Header Email"}),e.jsx("input",{className:"input",value:A.header_email,onChange:I=>f(G=>({...G,header_email:I.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Header Website"}),e.jsx("input",{className:"input",value:A.header_website,onChange:I=>f(G=>({...G,header_website:I.target.value}))})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Header Logo URL"}),e.jsx("input",{className:"input",placeholder:"/api/admin/companies/{id}/logo",value:A.header_logo_url,onChange:I=>f(G=>({...G,header_logo_url:I.target.value}))}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:"Omit to use the company logo automatically"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"HTML Content"}),e.jsx("textarea",{className:"input min-h-[280px]",value:A.html_content,onChange:I=>f(G=>({...G,html_content:I.target.value}))}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Use placeholders like ","{{company.name}}"," and loops like"," ","{{#each sales_order.items}}"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{id:"default",type:"checkbox",className:"w-4 h-4",checked:A.is_default,onChange:I=>f(G=>({...G,is_default:I.target.checked}))}),e.jsx("label",{htmlFor:"default",className:"label",children:"Set as default"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-primary",onClick:H,children:"Save"}),e.jsx("button",{className:"btn-outline",onClick:L,children:"Reset"}),e.jsx("button",{className:"btn-secondary",onClick:()=>{const I=NL(r);f(G=>({...G,html_content:I}))},children:"Use Sample Layout"})]})]})})]})]})}),e.jsx(s5,{open:g,onClose:()=>v(!1),html:b,downloading:S,onDownload:z})]})}function NL(t){const s=`
<style>
  :root {
    --brand: #0E3646;
    --brand-50: #f0f7fa;
    --brand-700: #215876;
    --text: #1f2937;
    --muted: #6b7280;
    --border: #e5e7eb;
  }
  body { font-family: Arial, sans-serif; color: var(--text); }
  .doc {
    width: 19cm; margin: 0 auto; padding: 12px;
    border: 1px solid var(--border); border-radius: 6px;
  }
  .header {
    display: grid; grid-template-columns: 100px 1fr; gap: 12px;
    align-items: center; margin-bottom: 8px;
  }
  .logo { height: 80px; object-fit: contain; }
  .company {
    font-size: 12px; line-height: 1.3; text-align: right;
  }
  .company .name { font-weight: 700; font-size: 16px; color: var(--brand); }
  .meta { color: var(--muted); }
  .titlebar { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 8px; margin: 6px 0 10px 0; }
  .line { border-top: 2px solid var(--text); height: 0; }
  .title { font-weight: 700; color: var(--brand); text-align: center; }
  .info {
    display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 8px 0 12px 0;
  }
  .info .card {
    border: 1px solid var(--border); border-radius: 6px; padding: 8px;
  }
  .kv { font-size: 12px; line-height: 1.5; }
  .kv .row { display: grid; grid-template-columns: 130px 1fr; gap: 6px; }
  .kv .label { font-weight: 600; color: #000; }
  table { width: 100%; border-collapse: collapse; font-size: 12px; }
  thead th {
    background: var(--brand-50); color: var(--brand);
    border: 1px solid var(--border); padding: 6px; text-align: left;
  }
  tbody td { border: 1px solid var(--border); padding: 6px; }
  td.num { text-align: right; }
  .totals {
    display: grid; grid-template-columns: 1fr 220px; gap: 12px; margin-top: 10px;
  }
  .totals .box { border: 1px solid var(--border); border-radius: 6px; padding: 8px; }
  .footer {
    margin-top: 18px; font-size: 11px; border-top: 1px solid var(--border); padding-top: 8px;
    display: grid; grid-template-columns: 1fr 1fr; gap: 16px;
  }
  .sign { height: 40px; border-bottom: 1px solid var(--border); }
</style>`;return t==="sales-order"?`
${s}
<div class="doc">
  <div class="header">
    <img class="logo" src="{{company.logo}}" alt="Logo"/>
    <div class="company">
      <div class="name">{{company.name}}</div>
      <div>{{company.address}}</div>
      <div>{{company.address2}}</div>
      <div class="meta">{{company.phone}}  {{company.email}}  {{company.website}}</div>
    </div>
  </div>
  <div class="titlebar">
    <div class="line"></div>
    <div class="title">* Sales Order *</div>
    <div class="line"></div>
  </div>
  <div class="info">
    <div class="card">
      <div class="kv">
        <div class="row"><div class="label">Customer Name:</div><div class="value">{{customer.name}}</div></div>
        <div class="row"><div class="label">Address:</div><div class="value">{{customer.address}}</div></div>
        <div class="row"><div class="label">City:</div><div class="value">{{customer.city}}</div></div>
        <div class="row"><div class="label">State:</div><div class="value">{{customer.state}}</div></div>
        <div class="row"><div class="label">Country:</div><div class="value">{{customer.country}}</div></div>
      </div>
    </div>
    <div class="card">
      <div class="kv">
        <div class="row"><div class="label">Order No.:</div><div class="value">{{sales_order.number}}</div></div>
        <div class="row"><div class="label">Order Date:</div><div class="value">{{sales_order.date}}</div></div>
      </div>
    </div>
  </div>
  <table>
    <thead>
      <tr><th>#</th><th>Code</th><th>Description</th><th>Qty</th><th>UOM</th><th>Price</th><th>Disc%</th><th>Tax</th><th>Amount</th></tr>
    </thead>
    <tbody>
      {{#each sales_order.items}}
      <tr>
        <td>{{@index}}</td><td>{{code}}</td><td>{{name}}</td><td class="num">{{quantity}}</td><td>{{uom}}</td><td class="num">{{price}}</td><td class="num">{{discount}}</td><td class="num">{{tax}}</td><td class="num">{{amount}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  <div class="totals">
    <div></div>
    <div class="box">
      <div>Sub Total: {{sales_order.sub_total}}</div>
      <div>Tax: {{sales_order.tax_amount}}</div>
      <div><strong>Total: {{sales_order.total}}</strong></div>
    </div>
  </div>
  <div class="footer">
    <div>
      <div>Prepared By</div>
      <div class="sign"></div>
      <div class="meta">{{prepared_by}}</div>
    </div>
    <div>
      <div>Remarks</div>
      <div class="meta">{{sales_order.remarks}}</div>
    </div>
  </div>
</div>
`:t==="invoice"?`
${s}
<div class="doc">
  <div class="header">
    <img class="logo" src="{{company.logo}}" alt="Logo"/>
    <div class="company">
      <div class="name">{{company.name}}</div>
      <div>{{company.address}}</div>
      <div>{{company.address2}}</div>
      <div class="meta">{{company.phone}}  {{company.email}}  {{company.website}}</div>
    </div>
  </div>
  <div class="titlebar">
    <div class="line"></div>
    <div class="title">* Sales Invoice *</div>
    <div class="line"></div>
  </div>
  <div class="info">
    <div class="card">
      <div class="kv">
        <div class="row"><div class="label">Customer Name:</div><div class="value">{{customer.name}}</div></div>
        <div class="row"><div class="label">Address:</div><div class="value">{{customer.address}}</div></div>
        <div class="row"><div class="label">City:</div><div class="value">{{customer.city}}</div></div>
        <div class="row"><div class="label">State:</div><div class="value">{{customer.state}}</div></div>
        <div class="row"><div class="label">Country:</div><div class="value">{{customer.country}}</div></div>
      </div>
    </div>
    <div class="card">
      <div class="kv">
        <div class="row"><div class="label">Invoice No.:</div><div class="value">{{invoice.number}}</div></div>
        <div class="row"><div class="label">Invoice Date:</div><div class="value">{{invoice.date}}</div></div>
        <div class="row"><div class="label">Payment Term:</div><div class="value">{{invoice.payment_term}}</div></div>
      </div>
    </div>
  </div>
  <table>
    <thead>
      <tr><th>#</th><th>Code</th><th>Description</th><th>Qty</th><th>UOM</th><th>Price</th><th>Disc%</th><th>Amount</th></tr>
    </thead>
    <tbody>
      {{#each invoice.items}}
      <tr>
        <td>{{@index}}</td><td>{{code}}</td><td>{{name}}</td><td class="num">{{quantity}}</td><td>{{uom}}</td><td class="num">{{price}}</td><td class="num">{{discount}}</td><td class="num">{{amount}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  <div class="totals">
    <div></div>
    <div class="box">
      <div>Net Total: {{invoice.net_total}}</div>
      <div><strong>Total: {{invoice.total}}</strong></div>
    </div>
  </div>
  <div class="footer">
    <div>
      <div>Prepared By</div>
      <div class="sign"></div>
      <div class="meta">{{prepared_by}}</div>
    </div>
    <div>
      <div>Remarks</div>
      <div class="meta">{{invoice.remarks}}</div>
    </div>
  </div>
</div>
`:t==="delivery-note"?`
${s}
<div class="doc">
  <div class="header">
    <img class="logo" src="{{company.logo}}" alt="Logo"/>
    <div class="company">
      <div class="name">{{company.name}}</div>
      <div>{{company.address}}</div>
      <div>{{company.address2}}</div>
      <div class="meta">{{company.phone}}  {{company.email}}  {{company.website}}</div>
    </div>
  </div>
  <div class="title">Delivery Note</div>
  <div class="info">
    <div class="card">
      <div><strong>Customer</strong></div>
      <div>{{customer.name}}</div>
      <div class="meta">{{customer.address}}</div>
    </div>
    <div class="card">
      <div><strong>Delivery Info</strong></div>
      <div>Number: {{delivery_note.number}}</div>
      <div>Date: {{delivery_note.date}}</div>
    </div>
  </div>
  <table>
    <thead>
      <tr><th>#</th><th>Code</th><th>Description</th><th>Qty</th><th>UOM</th></tr>
    </thead>
    <tbody>
      {{#each delivery_note.items}}
      <tr>
        <td>{{@index}}</td><td>{{code}}</td><td>{{name}}</td><td class="num">{{quantity}}</td><td>{{uom}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  <div class="footer">
    <div>
      <div>Received By</div>
      <div class="sign"></div>
    </div>
    <div>
      <div>Signature</div>
      <div class="sign"></div>
    </div>
  </div>
</div>
`:t==="payment-voucher"?`
${s}
<div class="doc">
  <div class="header">
    <img class="logo" src="{{company.logo}}" alt="Logo"/>
    <div class="company">
      <div class="name">{{company.name}}</div>
      <div>{{company.address}}</div>
      <div>{{company.address2}}</div>
      <div class="meta">{{company.phone}}  {{company.email}}  {{company.website}}</div>
    </div>
  </div>
  <div class="titlebar">
    <div class="line"></div>
    <div class="title">* Cash Payment Voucher *</div>
    <div class="line"></div>
  </div>
  <div class="info">
    <div class="card">
      <div><strong>Voucher Info</strong></div>
      <div>Number: {{payment_voucher.number}}</div>
      <div>Date: {{payment_voucher.date}}</div>
      <div class="meta">Type: {{payment_voucher.type_code}}  {{payment_voucher.type_name}}</div>
    </div>
    <div class="card">
      <div><strong>Narration</strong></div>
      <div class="meta">{{payment_voucher.narration}}</div>
    </div>
  </div>
  <table>
    <thead>
      <tr><th>#</th><th>Account Code</th><th>Account Name</th><th>Description</th><th>Debit</th><th>Credit</th><th>Ref</th></tr>
    </thead>
    <tbody>
      {{#each payment_voucher.items}}
      <tr>
        <td>{{@index}}</td><td>{{account_code}}</td><td>{{account_name}}</td><td>{{description}}</td><td class="num">{{debit}}</td><td class="num">{{credit}}</td><td>{{reference_no}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  <div class="totals">
    <div></div>
    <div class="box">
      <div>Total Debit: {{payment_voucher.total_debit}}</div>
      <div><strong>Total Credit: {{payment_voucher.total_credit}}</strong></div>
    </div>
  </div>
  <div class="footer">
    <div>
      <div>Prepared By</div>
      <div class="sign"></div>
    </div>
    <div>
      <div>Receiver Signature</div>
      <div class="sign"></div>
    </div>
  </div>
</div>
`:t==="quotation"?`
${s}
<div class="doc">
  <div class="header">
    <img class="logo" src="{{company.logo}}" alt="Logo"/>
    <div class="company">
      <div class="name">{{company.name}}</div>
      <div>{{company.address}}</div>
      <div>{{company.address2}}</div>
      <div class="meta">{{company.phone}}  {{company.email}}  {{company.website}}</div>
    </div>
  </div>
  <div class="titlebar">
    <div class="line"></div>
    <div class="title">* Quotation *</div>
    <div class="line"></div>
  </div>
  <div class="info">
    <div class="card">
      <div class="kv">
        <div class="row"><div class="label">Customer Name:</div><div class="value">{{customer.name}}</div></div>
        <div class="row"><div class="label">Address:</div><div class="value">{{customer.address}}</div></div>
        <div class="row"><div class="label">City:</div><div class="value">{{customer.city}}</div></div>
        <div class="row"><div class="label">State:</div><div class="value">{{customer.state}}</div></div>
        <div class="row"><div class="label">Country:</div><div class="value">{{customer.country}}</div></div>
      </div>
    </div>
    <div class="card">
      <div class="kv">
        <div class="row"><div class="label">Quotation No.:</div><div class="value">{{quotation.number}}</div></div>
        <div class="row"><div class="label">Quotation Date:</div><div class="value">{{quotation.date}}</div></div>
      </div>
    </div>
  </div>
  <table>
    <thead>
      <tr><th>#</th><th>Code</th><th>Description</th><th>Qty</th><th>UOM</th><th>Price</th><th>Disc%</th><th>Tax</th><th>Amount</th></tr>
    </thead>
    <tbody>
      {{#each quotation.items}}
      <tr>
        <td>{{@index}}</td><td>{{code}}</td><td>{{name}}</td><td class="num">{{quantity}}</td><td>{{uom}}</td><td class="num">{{price}}</td><td class="num">{{discount}}</td><td class="num">{{tax}}</td><td class="num">{{amount}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  <div class="totals">
    <div></div>
    <div class="box">
      <div>Sub Total: {{quotation.sub_total}}</div>
      <div>Tax: {{quotation.tax_amount}}</div>
      <div><strong>Total: {{quotation.total}}</strong></div>
    </div>
  </div>
  <div class="footer">
    <div>
      <div>Prepared By</div>
      <div class="sign"></div>
      <div class="meta">{{prepared_by}}</div>
    </div>
    <div>
      <div>Remarks</div>
      <div class="meta">{{quotation.remarks}}</div>
    </div>
  </div>
</div>
`:t==="receipt-voucher"?`
${s}
<div class="doc">
  <div class="header">
    <img class="logo" src="{{company.logo}}" alt="Logo"/>
    <div class="company">
      <div class="name">{{company.name}}</div>
      <div>{{company.address}}</div>
      <div>{{company.address2}}</div>
      <div class="meta">{{company.phone}}  {{company.email}}  {{company.website}}</div>
    </div>
  </div>
  <div class="titlebar">
    <div class="line"></div>
    <div class="title">* Receipt Voucher *</div>
    <div class="line"></div>
  </div>
  <div class="info">
    <div class="card">
      <div><strong>Voucher Info</strong></div>
      <div>Number: {{receipt_voucher.number}}</div>
      <div>Date: {{receipt_voucher.date}}</div>
      <div class="meta">Type: {{receipt_voucher.type_code}}  {{receipt_voucher.type_name}}</div>
    </div>
    <div class="card">
      <div><strong>Narration</strong></div>
      <div class="meta">{{receipt_voucher.narration}}</div>
    </div>
  </div>
  <table>
    <thead>
      <tr><th>#</th><th>Account Code</th><th>Account Name</th><th>Description</th><th>Debit</th><th>Credit</th><th>Ref</th></tr>
    </thead>
    <tbody>
      {{#each receipt_voucher.items}}
      <tr>
        <td>{{@index}}</td><td>{{account_code}}</td><td>{{account_name}}</td><td>{{description}}</td><td class="num">{{debit}}</td><td class="num">{{credit}}</td><td>{{reference_no}}</td>
      </tr>
      {{/each}}
    </tbody>
  </table>
  <div class="totals">
    <div></div>
    <div class="box">
      <div>Total Debit: {{receipt_voucher.total_debit}}</div>
      <div><strong>Total Credit: {{receipt_voucher.total_credit}}</strong></div>
    </div>
  </div>
  <div class="footer">
    <div>
      <div>Prepared By</div>
      <div class="sign"></div>
    </div>
    <div>
      <div>Receiver Signature</div>
      <div class="sign"></div>
    </div>
  </div>
</div>
`:"<div>Define your template here</div>"}function wL(){const[t,s]=Ts.useState([{value:"120",label:"Total Users",change:" 5 this month",changeType:"positive",path:"/administration/users"},{value:"15",label:"Active Sessions",change:"Current",changeType:"neutral",path:"/administration/reports"},{value:"5",label:"Pending Workflows",change:"Requires approval",changeType:"neutral",path:"/administration/workflows"}]),r=[{label:"Settings",path:"/administration/settings",icon:""}];Ts.useEffect(()=>{let n=!0;async function i(){var l,o,u,d,c,h,A,f,g;try{const v=await ee.get("/bi/dashboards"),b=Number(((u=(o=(l=v==null?void 0:v.data)==null?void 0:l.summary)==null?void 0:o.administration)==null?void 0:u.users)||0),y=Number(((h=(c=(d=v==null?void 0:v.data)==null?void 0:d.summary)==null?void 0:c.administration)==null?void 0:h.active_sessions)||0),j=Number(((g=(f=(A=v==null?void 0:v.data)==null?void 0:A.summary)==null?void 0:f.administration)==null?void 0:g.pending_workflows)||0);n&&s(N=>{const S=[...N];return S[0]={...S[0],value:String(b)},S[1]={...S[1],value:String(y)},S[2]={...S[2],value:String(j)},S})}catch{}}return i(),()=>{n=!1}},[]);const a=[{title:"System Configuration",badge:"Core",items:[{title:"Company Setup",description:"Manage company information and settings",path:"/administration/companies",icon:"",hidden:!1,actions:[{label:"Manage",path:"/administration/companies",type:"primary"}]},{title:"Branch Setup",description:"Configure and manage company branches",path:"/administration/branches",icon:"",actions:[{label:"View List",path:"/administration/branches",type:"outline"},{label:"Add Branch",path:"/administration/branches/new",type:"primary"}]},{title:"Settings",description:"Push notifications and document templates",path:"/administration/settings",icon:"",actions:[{label:"Open",path:"/administration/settings",type:"primary"}]}]},{title:"User Management",badge:"Access Control",items:[{title:"Role Setup",description:"Configure roles and assign permissions to roles",path:"/administration/roles",icon:"",actions:[{label:"View Roles",path:"/administration/roles",type:"outline"},{label:"New Role",path:"/administration/roles/new",type:"primary"}]},{title:"User Management",description:"Create and manage user accounts with detailed permissions",path:"/administration/users",icon:"",actions:[{label:"View Users",path:"/administration/users",type:"outline"},{label:"Add User",path:"/administration/users/new",type:"primary"}]},{title:"Permissions",description:"Overview of system permissions, roles, and assignments",path:"/administration/permissions",icon:"",actions:[{label:"Dashboard",path:"/administration/permissions",type:"outline"},{label:"Assign Rights",path:"/administration/user-permissions",type:"primary"}]},{title:"Exceptional Permissions",description:"Grant special permissions to users temporarily",path:"/administration/exceptional-permissions",icon:"",actions:[{label:"View Permissions",path:"/administration/exceptional-permissions",type:"outline"},{label:"Grant",path:"/administration/exceptional-permissions/new",type:"primary"}]}]},{title:"Process & Reporting",items:[{title:"Workflow Configuration",description:"Define and configure approval workflows for documents",path:"/administration/workflows",icon:"",actions:[{label:"Configure",path:"/administration/workflows",type:"primary"}]},{title:"Reports",description:"View user activity, audit logs, and system reports",path:"/administration/reports",icon:"",actions:[{label:"View Logs",path:"/administration/reports",type:"primary"},{label:"System Log Book",path:"/administration/reports/system-log-book",type:"outline"},{label:"User Login Activity",path:"/administration/reports/user-login-activity",type:"outline"}]}]}];return e.jsx(Gl,{title:"Administration",description:"System configuration and user management",stats:t,quickActions:r,sections:a})}function _L(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(wL,{})}),e.jsx(Je,{path:"/roles",element:e.jsx(nL,{})}),e.jsx(Je,{path:"/roles/new",element:e.jsx(dw,{})}),e.jsx(Je,{path:"/roles/:id",element:e.jsx(dw,{})}),e.jsx(Je,{path:"/users",element:e.jsx(iL,{})}),e.jsx(Je,{path:"/users/new",element:e.jsx(uw,{})}),e.jsx(Je,{path:"/users/:id",element:e.jsx(uw,{})}),e.jsx(Je,{path:"/workflows",element:e.jsx(lL,{})}),e.jsx(Je,{path:"/workflows/new",element:e.jsx(hw,{})}),e.jsx(Je,{path:"/workflows/:id",element:e.jsx(hw,{})}),e.jsx(Je,{path:"/workflows/approvals",element:e.jsx(cL,{})}),e.jsx(Je,{path:"/workflows/approved",element:e.jsx(dL,{})}),e.jsx(Je,{path:"/workflows/approvals/:instanceId",element:e.jsx(uL,{})}),e.jsx(Je,{path:"/exceptional-permissions",element:e.jsx(AL,{})}),e.jsx(Je,{path:"/exceptional-permissions/new",element:e.jsx(mw,{})}),e.jsx(Je,{path:"/exceptional-permissions/:id",element:e.jsx(mw,{})}),e.jsx(Je,{path:"/companies",element:e.jsx(hL,{})}),e.jsx(Je,{path:"/companies/new",element:e.jsx(fw,{})}),e.jsx(Je,{path:"/companies/:id",element:e.jsx(fw,{})}),e.jsx(Je,{path:"/branches",element:e.jsx(fL,{})}),e.jsx(Je,{path:"/branches/new",element:e.jsx(pw,{})}),e.jsx(Je,{path:"/branches/:id",element:e.jsx(pw,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(pL,{})}),e.jsx(Je,{path:"/reports/system-log-book",element:e.jsx(xL,{})}),e.jsx(Je,{path:"/reports/user-login-activity",element:e.jsx(gL,{})}),e.jsx(Je,{path:"/permissions",element:e.jsx(vL,{})}),e.jsx(Je,{path:"/user-permissions",element:e.jsx(bL,{})}),e.jsx(Je,{path:"/settings",element:e.jsx(yL,{})}),e.jsx(Je,{path:"/settings/templates",element:e.jsx(jL,{})})]})}const SL="modulepreload",CL=function(t){return"/"+t},xw={},Ob=function(s,r,a){let n=Promise.resolve();if(r&&r.length>0){let l=function(d){return Promise.all(d.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=l(r.map(d=>{if(d=CL(d),d in xw)return;xw[d]=!0;const c=d.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const A=document.createElement("link");if(A.rel=c?"stylesheet":SL,c||(A.as="script"),A.crossOrigin="",A.href=d,u&&A.setAttribute("nonce",u),document.head.appendChild(A),c)return new Promise((f,g)=>{A.addEventListener("load",f),A.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return n.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return s().catch(i)})};function Hr(t){"@babel/helpers - typeof";return Hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Hr(t)}var ci=Uint8Array,pl=Uint16Array,ej=Int32Array,H0=new ci([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),q0=new ci([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Qb=new ci([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),r5=function(t,s){for(var r=new pl(31),a=0;a<31;++a)r[a]=s+=1<<t[a-1];for(var n=new ej(r[30]),a=1;a<30;++a)for(var i=r[a];i<r[a+1];++i)n[i]=i-r[a]<<5|a;return{b:r,r:n}},a5=r5(H0,2),n5=a5.b,Mb=a5.r;n5[28]=258,Mb[258]=28;var i5=r5(q0,0),kL=i5.b,gw=i5.r,Hb=new pl(32768);for(var ia=0;ia<32768;++ia){var Hd=(ia&43690)>>1|(ia&21845)<<1;Hd=(Hd&52428)>>2|(Hd&13107)<<2,Hd=(Hd&61680)>>4|(Hd&3855)<<4,Hb[ia]=((Hd&65280)>>8|(Hd&255)<<8)>>1}var lc=(function(t,s,r){for(var a=t.length,n=0,i=new pl(s);n<a;++n)t[n]&&++i[t[n]-1];var l=new pl(s);for(n=1;n<s;++n)l[n]=l[n-1]+i[n-1]<<1;var o;if(r){o=new pl(1<<s);var u=15-s;for(n=0;n<a;++n)if(t[n])for(var d=n<<4|t[n],c=s-t[n],h=l[t[n]-1]++<<c,A=h|(1<<c)-1;h<=A;++h)o[Hb[h]>>u]=d}else for(o=new pl(a),n=0;n<a;++n)t[n]&&(o[n]=Hb[l[t[n]-1]++]>>15-t[n]);return o}),cu=new ci(288);for(var ia=0;ia<144;++ia)cu[ia]=8;for(var ia=144;ia<256;++ia)cu[ia]=9;for(var ia=256;ia<280;++ia)cu[ia]=7;for(var ia=280;ia<288;++ia)cu[ia]=8;var uf=new ci(32);for(var ia=0;ia<32;++ia)uf[ia]=5;var BL=lc(cu,9,0),EL=lc(cu,9,1),FL=lc(uf,5,0),TL=lc(uf,5,1),bv=function(t){for(var s=t[0],r=1;r<t.length;++r)t[r]>s&&(s=t[r]);return s},yo=function(t,s,r){var a=s/8|0;return(t[a]|t[a+1]<<8)>>(s&7)&r},yv=function(t,s){var r=s/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(s&7)},tj=function(t){return(t+7)/8|0},l5=function(t,s,r){return(r==null||r>t.length)&&(r=t.length),new ci(t.subarray(s,r))},IL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_o=function(t,s,r){var a=new Error(s||IL[t]);if(a.code=t,Error.captureStackTrace&&Error.captureStackTrace(a,_o),!r)throw a;return a},LL=function(t,s,r,a){var n=t.length,i=0;if(!n||s.f&&!s.l)return r||new ci(0);var l=!r,o=l||s.i!=2,u=s.i;l&&(r=new ci(n*3));var d=function(ce){var re=r.length;if(ce>re){var de=new ci(Math.max(re*2,ce));de.set(r),r=de}},c=s.f||0,h=s.p||0,A=s.b||0,f=s.l,g=s.d,v=s.m,b=s.n,y=n*8;do{if(!f){c=yo(t,h,1);var j=yo(t,h+1,3);if(h+=3,j)if(j==1)f=EL,g=TL,v=9,b=5;else if(j==2){var P=yo(t,h,31)+257,L=yo(t,h+10,15)+4,U=P+yo(t,h+5,31)+1;h+=14;for(var H=new ci(U),q=new ci(19),V=0;V<L;++V)q[Qb[V]]=yo(t,h+V*3,7);h+=L*3;for(var M=bv(q),z=(1<<M)-1,I=lc(q,M,1),V=0;V<U;){var G=I[yo(t,h,z)];h+=G&15;var N=G>>4;if(N<16)H[V++]=N;else{var Y=0,J=0;for(N==16?(J=3+yo(t,h,3),h+=2,Y=H[V-1]):N==17?(J=3+yo(t,h,7),h+=3):N==18&&(J=11+yo(t,h,127),h+=7);J--;)H[V++]=Y}}var T=H.subarray(0,P),k=H.subarray(P);v=bv(T),b=bv(k),f=lc(T,v,1),g=lc(k,b,1)}else _o(1);else{var N=tj(h)+4,S=t[N-4]|t[N-3]<<8,B=N+S;if(B>n){u&&_o(0);break}o&&d(A+S),r.set(t.subarray(N,B),A),s.b=A+=S,s.p=h=B*8,s.f=c;continue}if(h>y){u&&_o(0);break}}o&&d(A+131072);for(var D=(1<<v)-1,Q=(1<<b)-1,C=h;;C=h){var Y=f[yv(t,h)&D],E=Y>>4;if(h+=Y&15,h>y){u&&_o(0);break}if(Y||_o(2),E<256)r[A++]=E;else if(E==256){C=h,f=null;break}else{var w=E-254;if(E>264){var V=E-257,O=H0[V];w=yo(t,h,(1<<O)-1)+n5[V],h+=O}var R=g[yv(t,h)&Q],X=R>>4;R||_o(3),h+=R&15;var k=kL[X];if(X>3){var O=q0[X];k+=yv(t,h)&(1<<O)-1,h+=O}if(h>y){u&&_o(0);break}o&&d(A+131072);var ne=A+w;if(A<k){var te=i-k,oe=Math.min(k,ne);for(te+A<0&&_o(3);A<oe;++A)r[A]=a[te+A]}for(;A<ne;++A)r[A]=r[A-k]}}s.l=f,s.p=C,s.b=A,s.f=c,f&&(c=1,s.m=v,s.d=g,s.n=b)}while(!c);return A!=r.length&&l?l5(r,0,A):r.subarray(0,A)},Pc=function(t,s,r){r<<=s&7;var a=s/8|0;t[a]|=r,t[a+1]|=r>>8},pm=function(t,s,r){r<<=s&7;var a=s/8|0;t[a]|=r,t[a+1]|=r>>8,t[a+2]|=r>>16},jv=function(t,s){for(var r=[],a=0;a<t.length;++a)t[a]&&r.push({s:a,f:t[a]});var n=r.length,i=r.slice();if(!n)return{t:c5,l:0};if(n==1){var l=new ci(r[0].s+1);return l[r[0].s]=1,{t:l,l:1}}r.sort(function(B,P){return B.f-P.f}),r.push({s:-1,f:25001});var o=r[0],u=r[1],d=0,c=1,h=2;for(r[0]={s:-1,f:o.f+u.f,l:o,r:u};c!=n-1;)o=r[r[d].f<r[h].f?d++:h++],u=r[d!=c&&r[d].f<r[h].f?d++:h++],r[c++]={s:-1,f:o.f+u.f,l:o,r:u};for(var A=i[0].s,a=1;a<n;++a)i[a].s>A&&(A=i[a].s);var f=new pl(A+1),g=qb(r[c-1],f,0);if(g>s){var a=0,v=0,b=g-s,y=1<<b;for(i.sort(function(P,L){return f[L.s]-f[P.s]||P.f-L.f});a<n;++a){var j=i[a].s;if(f[j]>s)v+=y-(1<<g-f[j]),f[j]=s;else break}for(v>>=b;v>0;){var N=i[a].s;f[N]<s?v-=1<<s-f[N]++-1:++a}for(;a>=0&&v;--a){var S=i[a].s;f[S]==s&&(--f[S],++v)}g=s}return{t:new ci(f),l:g}},qb=function(t,s,r){return t.s==-1?Math.max(qb(t.l,s,r+1),qb(t.r,s,r+1)):s[t.s]=r},vw=function(t){for(var s=t.length;s&&!t[--s];);for(var r=new pl(++s),a=0,n=t[0],i=1,l=function(u){r[a++]=u},o=1;o<=s;++o)if(t[o]==n&&o!=s)++i;else{if(!n&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(n),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(n);i=1,n=t[o]}return{c:r.subarray(0,a),n:s}},xm=function(t,s){for(var r=0,a=0;a<s.length;++a)r+=t[a]*s[a];return r},o5=function(t,s,r){var a=r.length,n=tj(s+2);t[n]=a&255,t[n+1]=a>>8,t[n+2]=t[n]^255,t[n+3]=t[n+1]^255;for(var i=0;i<a;++i)t[n+i+4]=r[i];return(n+4+a)*8},bw=function(t,s,r,a,n,i,l,o,u,d,c){Pc(s,c++,r),++n[256];for(var h=jv(n,15),A=h.t,f=h.l,g=jv(i,15),v=g.t,b=g.l,y=vw(A),j=y.c,N=y.n,S=vw(v),B=S.c,P=S.n,L=new pl(19),U=0;U<j.length;++U)++L[j[U]&31];for(var U=0;U<B.length;++U)++L[B[U]&31];for(var H=jv(L,7),q=H.t,V=H.l,M=19;M>4&&!q[Qb[M-1]];--M);var z=d+5<<3,I=xm(n,cu)+xm(i,uf)+l,G=xm(n,A)+xm(i,v)+l+14+3*M+xm(L,q)+2*L[16]+3*L[17]+7*L[18];if(u>=0&&z<=I&&z<=G)return o5(s,c,t.subarray(u,u+d));var Y,J,T,k;if(Pc(s,c,1+(G<I)),c+=2,G<I){Y=lc(A,f,0),J=A,T=lc(v,b,0),k=v;var D=lc(q,V,0);Pc(s,c,N-257),Pc(s,c+5,P-1),Pc(s,c+10,M-4),c+=14;for(var U=0;U<M;++U)Pc(s,c+3*U,q[Qb[U]]);c+=3*M;for(var Q=[j,B],C=0;C<2;++C)for(var E=Q[C],U=0;U<E.length;++U){var w=E[U]&31;Pc(s,c,D[w]),c+=q[w],w>15&&(Pc(s,c,E[U]>>5&127),c+=E[U]>>12)}}else Y=BL,J=cu,T=FL,k=uf;for(var U=0;U<o;++U){var O=a[U];if(O>255){var w=O>>18&31;pm(s,c,Y[w+257]),c+=J[w+257],w>7&&(Pc(s,c,O>>23&31),c+=H0[w]);var R=O&31;pm(s,c,T[R]),c+=k[R],R>3&&(pm(s,c,O>>5&8191),c+=q0[R])}else pm(s,c,Y[O]),c+=J[O]}return pm(s,c,Y[256]),c+J[256]},DL=new ej([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),c5=new ci(0),UL=function(t,s,r,a,n,i){var l=i.z||t.length,o=new ci(a+l+5*(1+Math.ceil(l/7e3))+n),u=o.subarray(a,o.length-n),d=i.l,c=(i.r||0)&7;if(s){c&&(u[0]=i.r>>3);for(var h=DL[s-1],A=h>>13,f=h&8191,g=(1<<r)-1,v=i.p||new pl(32768),b=i.h||new pl(g+1),y=Math.ceil(r/3),j=2*y,N=function(Ie){return(t[Ie]^t[Ie+1]<<y^t[Ie+2]<<j)&g},S=new ej(25e3),B=new pl(288),P=new pl(32),L=0,U=0,H=i.i||0,q=0,V=i.w||0,M=0;H+2<l;++H){var z=N(H),I=H&32767,G=b[z];if(v[I]=G,b[z]=I,V<=H){var Y=l-H;if((L>7e3||q>24576)&&(Y>423||!d)){c=bw(t,u,0,S,B,P,U,q,M,H-M,c),q=L=U=0,M=H;for(var J=0;J<286;++J)B[J]=0;for(var J=0;J<30;++J)P[J]=0}var T=2,k=0,D=f,Q=I-G&32767;if(Y>2&&z==N(H-Q))for(var C=Math.min(A,Y)-1,E=Math.min(32767,H),w=Math.min(258,Y);Q<=E&&--D&&I!=G;){if(t[H+T]==t[H+T-Q]){for(var O=0;O<w&&t[H+O]==t[H+O-Q];++O);if(O>T){if(T=O,k=Q,O>C)break;for(var R=Math.min(Q,O-2),X=0,J=0;J<R;++J){var ne=H-Q+J&32767,te=v[ne],oe=ne-te&32767;oe>X&&(X=oe,G=ne)}}}I=G,G=v[I],Q+=I-G&32767}if(k){S[q++]=268435456|Mb[T]<<18|gw[k];var ce=Mb[T]&31,re=gw[k]&31;U+=H0[ce]+q0[re],++B[257+ce],++P[re],V=H+T,++L}else S[q++]=t[H],++B[t[H]]}}for(H=Math.max(H,V);H<l;++H)S[q++]=t[H],++B[t[H]];c=bw(t,u,d,S,B,P,U,q,M,H-M,c),d||(i.r=c&7|u[c/8|0]<<3,c-=7,i.h=b,i.p=v,i.i=H,i.w=V)}else{for(var H=i.w||0;H<l+d;H+=65535){var de=H+65535;de>=l&&(u[c/8|0]=d,de=l),c=o5(u,c+1,t.subarray(H,de))}i.i=l}return l5(o,0,a+tj(c)+n)},d5=function(){var t=1,s=0;return{p:function(r){for(var a=t,n=s,i=r.length|0,l=0;l!=i;){for(var o=Math.min(l+2655,i);l<o;++l)n+=a+=r[l];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}t=a,s=n},d:function(){return t%=65521,s%=65521,(t&255)<<24|(t&65280)<<8|(s&255)<<8|s>>8}}},PL=function(t,s,r,a,n){if(!n&&(n={l:1},s.dictionary)){var i=s.dictionary.subarray(-32768),l=new ci(i.length+t.length);l.set(i),l.set(t,i.length),t=l,n.w=i.length}return UL(t,s.level==null?6:s.level,s.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+s.mem,r,a,n)},u5=function(t,s,r){for(;r;++s)t[s]=r,r>>>=8},RL=function(t,s){var r=s.level,a=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=a<<6|(s.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,s.dictionary){var n=d5();n.p(s.dictionary),u5(t,2,n.d())}},OL=function(t,s){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&_o(6,"invalid zlib data"),(t[1]>>5&1)==1&&_o(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function Vb(t,s){s||(s={});var r=d5();r.p(t);var a=PL(t,s,s.dictionary?6:2,4);return RL(a,s),u5(a,a.length-4,r.d()),a}function QL(t,s){return LL(t.subarray(OL(t),-4),{i:2},s,s)}var ML=typeof TextDecoder<"u"&&new TextDecoder,HL=0;try{ML.decode(c5,{stream:!0}),HL=1}catch{}var Vs=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function Nv(){Vs.console&&typeof Vs.console.log=="function"&&Vs.console.log.apply(Vs.console,arguments)}var Yr={log:Nv,warn:function(t){Vs.console&&(typeof Vs.console.warn=="function"?Vs.console.warn.apply(Vs.console,arguments):Nv.call(null,arguments))},error:function(t){Vs.console&&(typeof Vs.console.error=="function"?Vs.console.error.apply(Vs.console,arguments):Nv(t))}};function wv(t,s,r){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){Ku(a.response,s,r)},a.onerror=function(){Yr.error("could not download file")},a.send()}function yw(t){var s=new XMLHttpRequest;s.open("HEAD",t,!1);try{s.send()}catch{}return s.status>=200&&s.status<=299}function Up(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(s)}}var qm,$b,Ku=Vs.saveAs||((typeof window>"u"?"undefined":Hr(window))!=="object"||window!==Vs?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,s,r){var a=Vs.URL||Vs.webkitURL,n=document.createElement("a");s=s||t.name||"download",n.download=s,n.rel="noopener",typeof t=="string"?(n.href=t,n.origin!==location.origin?yw(n.href)?wv(t,s,r):Up(n,n.target="_blank"):Up(n)):(n.href=a.createObjectURL(t),setTimeout((function(){a.revokeObjectURL(n.href)}),4e4),setTimeout((function(){Up(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,s,r){if(s=s||t.name||"download",typeof t=="string")if(yw(t))wv(t,s,r);else{var a=document.createElement("a");a.href=t,a.target="_blank",setTimeout((function(){Up(a)}))}else navigator.msSaveOrOpenBlob((function(n,i){return i===void 0?i={autoBom:!1}:Hr(i)!=="object"&&(Yr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n})(t,r),s)}:function(t,s,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof t=="string")return wv(t,s,r);var n=t.type==="application/octet-stream",i=/constructor/i.test(Vs.HTMLElement)||Vs.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||n&&i)&&(typeof FileReader>"u"?"undefined":Hr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var c=o.result;c=l?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=c:location=c,a=null},o.readAsDataURL(t)}else{var u=Vs.URL||Vs.webkitURL,d=u.createObjectURL(t);a?a.location=d:location.href=d,a=null,setTimeout((function(){u.revokeObjectURL(d)}),4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function A5(t){var s;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,i=r[a].process,l=n.exec(t);l&&(s=i(l),this.r=s[0],this.g=s[1],this.b=s[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),u=this.g.toString(16),d=this.b.toString(16);return o.length==1&&(o="0"+o),u.length==1&&(u="0"+u),d.length==1&&(d="0"+d),"#"+o+u+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function _v(t,s){var r=t[0],a=t[1],n=t[2],i=t[3];r=Xn(r,a,n,i,s[0],7,-680876936),i=Xn(i,r,a,n,s[1],12,-389564586),n=Xn(n,i,r,a,s[2],17,606105819),a=Xn(a,n,i,r,s[3],22,-1044525330),r=Xn(r,a,n,i,s[4],7,-176418897),i=Xn(i,r,a,n,s[5],12,1200080426),n=Xn(n,i,r,a,s[6],17,-1473231341),a=Xn(a,n,i,r,s[7],22,-45705983),r=Xn(r,a,n,i,s[8],7,1770035416),i=Xn(i,r,a,n,s[9],12,-1958414417),n=Xn(n,i,r,a,s[10],17,-42063),a=Xn(a,n,i,r,s[11],22,-1990404162),r=Xn(r,a,n,i,s[12],7,1804603682),i=Xn(i,r,a,n,s[13],12,-40341101),n=Xn(n,i,r,a,s[14],17,-1502002290),r=Jn(r,a=Xn(a,n,i,r,s[15],22,1236535329),n,i,s[1],5,-165796510),i=Jn(i,r,a,n,s[6],9,-1069501632),n=Jn(n,i,r,a,s[11],14,643717713),a=Jn(a,n,i,r,s[0],20,-373897302),r=Jn(r,a,n,i,s[5],5,-701558691),i=Jn(i,r,a,n,s[10],9,38016083),n=Jn(n,i,r,a,s[15],14,-660478335),a=Jn(a,n,i,r,s[4],20,-405537848),r=Jn(r,a,n,i,s[9],5,568446438),i=Jn(i,r,a,n,s[14],9,-1019803690),n=Jn(n,i,r,a,s[3],14,-187363961),a=Jn(a,n,i,r,s[8],20,1163531501),r=Jn(r,a,n,i,s[13],5,-1444681467),i=Jn(i,r,a,n,s[2],9,-51403784),n=Jn(n,i,r,a,s[7],14,1735328473),r=Zn(r,a=Jn(a,n,i,r,s[12],20,-1926607734),n,i,s[5],4,-378558),i=Zn(i,r,a,n,s[8],11,-2022574463),n=Zn(n,i,r,a,s[11],16,1839030562),a=Zn(a,n,i,r,s[14],23,-35309556),r=Zn(r,a,n,i,s[1],4,-1530992060),i=Zn(i,r,a,n,s[4],11,1272893353),n=Zn(n,i,r,a,s[7],16,-155497632),a=Zn(a,n,i,r,s[10],23,-1094730640),r=Zn(r,a,n,i,s[13],4,681279174),i=Zn(i,r,a,n,s[0],11,-358537222),n=Zn(n,i,r,a,s[3],16,-722521979),a=Zn(a,n,i,r,s[6],23,76029189),r=Zn(r,a,n,i,s[9],4,-640364487),i=Zn(i,r,a,n,s[12],11,-421815835),n=Zn(n,i,r,a,s[15],16,530742520),r=ei(r,a=Zn(a,n,i,r,s[2],23,-995338651),n,i,s[0],6,-198630844),i=ei(i,r,a,n,s[7],10,1126891415),n=ei(n,i,r,a,s[14],15,-1416354905),a=ei(a,n,i,r,s[5],21,-57434055),r=ei(r,a,n,i,s[12],6,1700485571),i=ei(i,r,a,n,s[3],10,-1894986606),n=ei(n,i,r,a,s[10],15,-1051523),a=ei(a,n,i,r,s[1],21,-2054922799),r=ei(r,a,n,i,s[8],6,1873313359),i=ei(i,r,a,n,s[15],10,-30611744),n=ei(n,i,r,a,s[6],15,-1560198380),a=ei(a,n,i,r,s[13],21,1309151649),r=ei(r,a,n,i,s[4],6,-145523070),i=ei(i,r,a,n,s[11],10,-1120210379),n=ei(n,i,r,a,s[2],15,718787259),a=ei(a,n,i,r,s[9],21,-343485551),t[0]=Zd(r,t[0]),t[1]=Zd(a,t[1]),t[2]=Zd(n,t[2]),t[3]=Zd(i,t[3])}function V0(t,s,r,a,n,i){return s=Zd(Zd(s,t),Zd(a,i)),Zd(s<<n|s>>>32-n,r)}function Xn(t,s,r,a,n,i,l){return V0(s&r|~s&a,t,s,n,i,l)}function Jn(t,s,r,a,n,i,l){return V0(s&a|r&~a,t,s,n,i,l)}function Zn(t,s,r,a,n,i,l){return V0(s^r^a,t,s,n,i,l)}function ei(t,s,r,a,n,i,l){return V0(r^(s|~a),t,s,n,i,l)}function h5(t){var s,r=t.length,a=[1732584193,-271733879,-1732584194,271733878];for(s=64;s<=t.length;s+=64)_v(a,qL(t.substring(s-64,s)));t=t.substring(s-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(s=0;s<t.length;s++)n[s>>2]|=t.charCodeAt(s)<<(s%4<<3);if(n[s>>2]|=128<<(s%4<<3),s>55)for(_v(a,n),s=0;s<16;s++)n[s]=0;return n[14]=8*r,_v(a,n),a}function qL(t){var s,r=[];for(s=0;s<64;s+=4)r[s>>2]=t.charCodeAt(s)+(t.charCodeAt(s+1)<<8)+(t.charCodeAt(s+2)<<16)+(t.charCodeAt(s+3)<<24);return r}qm=Vs.atob.bind(Vs),$b=Vs.btoa.bind(Vs);var jw="0123456789abcdef".split("");function VL(t){for(var s="",r=0;r<4;r++)s+=jw[t>>8*r+4&15]+jw[t>>8*r&15];return s}function $L(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function Wb(t){return h5(t).map($L).join("")}var WL=(function(t){for(var s=0;s<t.length;s++)t[s]=VL(t[s]);return t.join("")})(h5("hello"))!="5d41402abc4b2a76b9719d911017c592";function Zd(t,s){if(WL){var r=(65535&t)+(65535&s);return(t>>16)+(s>>16)+(r>>16)<<16|65535&r}return t+s&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gb(t,s){var r,a,n,i;if(t!==r){for(var l=(n=t,i=1+(256/t.length>>0),new Array(i+1).join(n)),o=[],u=0;u<256;u++)o[u]=u;var d=0;for(u=0;u<256;u++){var c=o[u];d=(d+c+l.charCodeAt(u))%256,o[u]=o[d],o[d]=c}r=t,a=o}else o=a;var h=s.length,A=0,f=0,g="";for(u=0;u<h;u++)f=(f+(c=o[A=(A+1)%256]))%256,o[A]=o[f],o[f]=c,l=o[(o[A]+o[f])%256],g+=String.fromCharCode(s.charCodeAt(u)^l);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var Nw={print:4,modify:8,copy:16,"annot-forms":32};function Ah(t,s,r,a){this.v=1,this.r=2;var n=192;t.forEach((function(o){if(Nw.perm!==void 0)throw new Error("Invalid permission: "+o);n+=Nw[o]})),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(s+this.padding).substr(0,32),l=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,l),this.P=-(1+(255^n)),this.encryptionKey=Wb(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=Gb(this.encryptionKey,this.padding)}function hh(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var s="",r=t.length,a=0;a<r;a++){var n=t.charCodeAt(a);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?s+="#"+("0"+n.toString(16)).slice(-2):s+=t[a]}return s}function ww(t){if(Hr(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var s={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");s.hasOwnProperty(r)||(s[r]={});var i=Math.random().toString(35);return s[r][i]=[a,!!n],i},this.unsubscribe=function(r){for(var a in s)if(s[a][r])return delete s[a][r],Object.keys(s[a]).length===0&&delete s[a],!0;return!1},this.publish=function(r){if(s.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var i in s[r]){var l=s[r][i];try{l[0].apply(t,a)}catch(o){Vs.console&&Yr.error("jsPDF PubSub Error",o.message,o)}l[1]&&n.push(i)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return s}}function zx(t){if(!(this instanceof zx))return new zx(t);var s="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&s.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function m5(t,s){this.gState=t,this.matrix=s,this.id="",this.objectNumber=-1}function Yu(t,s,r,a,n){if(!(this instanceof Yu))return new Yu(t,s,r,a,n);this.type=t==="axial"?2:3,this.coords=s,this.colors=r,m5.call(this,a,n)}function xh(t,s,r,a,n){if(!(this instanceof xh))return new xh(t,s,r,a,n);this.boundingBox=t,this.xStep=s,this.yStep=r,this.stream="",this.cloneIndex=0,m5.call(this,a,n)}function ds(t){var s,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],i=arguments[3],l=[],o=1,u=16,d="S",c=null;Hr(t=t||{})==="object"&&(r=t.orientation,a=t.unit||a,n=t.format||n,i=t.compress||t.compressPdf||i,(c=t.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),o=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(s=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),d=t.defaultPathOperation||"S"),l=t.filters||(i===!0?["FlateEncode"]:l),a=a||"mm",r=(""+(r||"P")).toLowerCase();var h=t.putOnlyUsedFonts||!1,A={},f={internal:{},__private__:{}};f.__private__.PubSub=ww;var g="1.3",v=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(se){g=se};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return b};var y=f.__private__.getPageFormat=function(se){return b[se]};n=n||"a4";var j={COMPAT:"compat",ADVANCED:"advanced"},N=j.COMPAT;function S(){this.saveGraphicsState(),Z(new De(ge,0,0,-ge,0,Mo()*ge).toString()+" cm"),this.setFontSize(this.getFontSize()/ge),d="n",N=j.ADVANCED}function B(){this.restoreGraphicsState(),d="S",N=j.COMPAT}var P=f.__private__.combineFontStyleAndFontWeight=function(se,Ee){if(se=="bold"&&Ee=="normal"||se=="bold"&&Ee==400||se=="normal"&&Ee=="italic"||se=="bold"&&Ee=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ee&&(se=Ee==400||Ee==="normal"?se==="italic"?"italic":"normal":Ee!=700&&Ee!=="bold"||se!=="normal"?(Ee==700?"bold":Ee)+""+se:"bold"),se};f.advancedAPI=function(se){var Ee=N===j.COMPAT;return Ee&&S.call(this),typeof se!="function"||(se(this),Ee&&B.call(this)),this},f.compatAPI=function(se){var Ee=N===j.ADVANCED;return Ee&&B.call(this),typeof se!="function"||(se(this),Ee&&S.call(this)),this},f.isAdvancedAPI=function(){return N===j.ADVANCED};var L,U=function(se){if(N!==j.ADVANCED)throw new Error(se+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},H=f.roundToPrecision=f.__private__.roundToPrecision=function(se,Ee){var it=s||Ee;if(isNaN(se)||isNaN(it))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return se.toFixed(it).replace(/0+$/,"")};L=f.hpf=f.__private__.hpf=typeof u=="number"?function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.hpf");return H(se,u)}:u==="smart"?function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.hpf");return H(se,se>-1&&se<1?16:5)}:function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.hpf");return H(se,16)};var q=f.f2=f.__private__.f2=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.f2");return H(se,2)},V=f.__private__.f3=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.f3");return H(se,3)},M=f.scale=f.__private__.scale=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.scale");return N===j.COMPAT?se*ge:N===j.ADVANCED?se:void 0},z=function(se){return N===j.COMPAT?Mo()-se:N===j.ADVANCED?se:void 0},I=function(se){return M(z(se))};f.__private__.setPrecision=f.setPrecision=function(se){typeof parseInt(se,10)=="number"&&(s=parseInt(se,10))};var G,Y="00000000000000000000000000000000",J=f.__private__.getFileId=function(){return Y},T=f.__private__.setFileId=function(se){return Y=se!==void 0&&/^[a-fA-F0-9]{32}$/.test(se)?se.toUpperCase():Y.split("").map((function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))})).join(""),c!==null&&(dt=new Ah(c.userPermissions,c.userPassword,c.ownerPassword,Y)),Y};f.setFileId=function(se){return T(se),this},f.getFileId=function(){return J()};var k=f.__private__.convertDateToPDFDate=function(se){var Ee=se.getTimezoneOffset(),it=Ee<0?"+":"-",bt=Math.floor(Math.abs(Ee/60)),Tt=Math.abs(Ee%60),$t=[it,w(bt),"'",w(Tt),"'"].join("");return["D:",se.getFullYear(),w(se.getMonth()+1),w(se.getDate()),w(se.getHours()),w(se.getMinutes()),w(se.getSeconds()),$t].join("")},D=f.__private__.convertPDFDateToDate=function(se){var Ee=parseInt(se.substr(2,4),10),it=parseInt(se.substr(6,2),10)-1,bt=parseInt(se.substr(8,2),10),Tt=parseInt(se.substr(10,2),10),$t=parseInt(se.substr(12,2),10),ls=parseInt(se.substr(14,2),10);return new Date(Ee,it,bt,Tt,$t,ls,0)},Q=f.__private__.setCreationDate=function(se){var Ee;if(se===void 0&&(se=new Date),se instanceof Date)Ee=k(se);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(se))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ee=se}return G=Ee},C=f.__private__.getCreationDate=function(se){var Ee=G;return se==="jsDate"&&(Ee=D(G)),Ee};f.setCreationDate=function(se){return Q(se),this},f.getCreationDate=function(se){return C(se)};var E,w=f.__private__.padd2=function(se){return("0"+parseInt(se)).slice(-2)},O=f.__private__.padd2Hex=function(se){return("00"+(se=se.toString())).substr(se.length)},R=0,X=[],ne=[],te=0,oe=[],ce=[],re=!1,de=ne,Ie=function(){R=0,te=0,ne=[],X=[],oe=[],ye=Qe(),Ne=Qe()};f.__private__.setCustomOutputDestination=function(se){re=!0,de=se};var le=function(se){re||(de=se)};f.__private__.resetCustomOutputDestination=function(){re=!1,de=ne};var Z=f.__private__.out=function(se){return se=se.toString(),te+=se.length+1,de.push(se),de},ve=f.__private__.write=function(se){return Z(arguments.length===1?se.toString():Array.prototype.join.call(arguments," "))},Ue=f.__private__.getArrayBuffer=function(se){for(var Ee=se.length,it=new ArrayBuffer(Ee),bt=new Uint8Array(it);Ee--;)bt[Ee]=se.charCodeAt(Ee);return it},Be=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return Be};var _e=t.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(se){return _e=N===j.ADVANCED?se/ge:se,this};var Me,Ye=f.__private__.getFontSize=f.getFontSize=function(){return N===j.COMPAT?_e:_e*ge},ot=t.R2L||!1;f.__private__.setR2L=f.setR2L=function(se){return ot=se,this},f.__private__.getR2L=f.getR2L=function(){return ot};var Ke,ct=f.__private__.setZoomMode=function(se){var Ee=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(se))Me=se;else if(isNaN(se)){if(Ee.indexOf(se)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+se+'" is not recognized.');Me=se}else Me=parseInt(se,10)};f.__private__.getZoomMode=function(){return Me};var xt,be=f.__private__.setPageMode=function(se){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(se)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+se+'" is not recognized.');Ke=se};f.__private__.getPageMode=function(){return Ke};var Ce=f.__private__.setLayoutMode=function(se){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(se)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+se+'" is not recognized.');xt=se};f.__private__.getLayoutMode=function(){return xt},f.__private__.setDisplayMode=f.setDisplayMode=function(se,Ee,it){return ct(se),Ce(Ee),be(it),this};var Te={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(se){if(Object.keys(Te).indexOf(se)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Te[se]},f.__private__.getDocumentProperties=function(){return Te},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(se){for(var Ee in Te)Te.hasOwnProperty(Ee)&&se[Ee]&&(Te[Ee]=se[Ee]);return this},f.__private__.setDocumentProperty=function(se,Ee){if(Object.keys(Te).indexOf(se)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Te[se]=Ee};var ue,ge,Ve,tt,Ze,ht={},ze={},Fe=[],xe={},we={},Xe={},ut={},ft=null,mt=0,pt=[],vt=new ww(f),Ot=t.hotfixes||[],Ae={},je={},We=[],De=function se(Ee,it,bt,Tt,$t,ls){if(!(this instanceof se))return new se(Ee,it,bt,Tt,$t,ls);isNaN(Ee)&&(Ee=1),isNaN(it)&&(it=0),isNaN(bt)&&(bt=0),isNaN(Tt)&&(Tt=1),isNaN($t)&&($t=0),isNaN(ls)&&(ls=0),this._matrix=[Ee,it,bt,Tt,$t,ls]};Object.defineProperty(De.prototype,"sx",{get:function(){return this._matrix[0]},set:function(se){this._matrix[0]=se}}),Object.defineProperty(De.prototype,"shy",{get:function(){return this._matrix[1]},set:function(se){this._matrix[1]=se}}),Object.defineProperty(De.prototype,"shx",{get:function(){return this._matrix[2]},set:function(se){this._matrix[2]=se}}),Object.defineProperty(De.prototype,"sy",{get:function(){return this._matrix[3]},set:function(se){this._matrix[3]=se}}),Object.defineProperty(De.prototype,"tx",{get:function(){return this._matrix[4]},set:function(se){this._matrix[4]=se}}),Object.defineProperty(De.prototype,"ty",{get:function(){return this._matrix[5]},set:function(se){this._matrix[5]=se}}),Object.defineProperty(De.prototype,"a",{get:function(){return this._matrix[0]},set:function(se){this._matrix[0]=se}}),Object.defineProperty(De.prototype,"b",{get:function(){return this._matrix[1]},set:function(se){this._matrix[1]=se}}),Object.defineProperty(De.prototype,"c",{get:function(){return this._matrix[2]},set:function(se){this._matrix[2]=se}}),Object.defineProperty(De.prototype,"d",{get:function(){return this._matrix[3]},set:function(se){this._matrix[3]=se}}),Object.defineProperty(De.prototype,"e",{get:function(){return this._matrix[4]},set:function(se){this._matrix[4]=se}}),Object.defineProperty(De.prototype,"f",{get:function(){return this._matrix[5]},set:function(se){this._matrix[5]=se}}),Object.defineProperty(De.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(De.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(De.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(De.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),De.prototype.join=function(se){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(se)},De.prototype.multiply=function(se){var Ee=se.sx*this.sx+se.shy*this.shx,it=se.sx*this.shy+se.shy*this.sy,bt=se.shx*this.sx+se.sy*this.shx,Tt=se.shx*this.shy+se.sy*this.sy,$t=se.tx*this.sx+se.ty*this.shx+this.tx,ls=se.tx*this.shy+se.ty*this.sy+this.ty;return new De(Ee,it,bt,Tt,$t,ls)},De.prototype.decompose=function(){var se=this.sx,Ee=this.shy,it=this.shx,bt=this.sy,Tt=this.tx,$t=this.ty,ls=Math.sqrt(se*se+Ee*Ee),js=(se/=ls)*it+(Ee/=ls)*bt;it-=se*js,bt-=Ee*js;var Ds=Math.sqrt(it*it+bt*bt);return js/=Ds,se*(bt/=Ds)<Ee*(it/=Ds)&&(se=-se,Ee=-Ee,js=-js,ls=-ls),{scale:new De(ls,0,0,Ds,0,0),translate:new De(1,0,0,1,Tt,$t),rotate:new De(se,Ee,-Ee,se,0,0),skew:new De(1,0,js,1,0,0)}},De.prototype.toString=function(se){return this.join(" ")},De.prototype.inversed=function(){var se=this.sx,Ee=this.shy,it=this.shx,bt=this.sy,Tt=this.tx,$t=this.ty,ls=1/(se*bt-Ee*it),js=bt*ls,Ds=-Ee*ls,Js=-it*ls,Xs=se*ls;return new De(js,Ds,Js,Xs,-js*Tt-Js*$t,-Ds*Tt-Xs*$t)},De.prototype.applyToPoint=function(se){var Ee=se.x*this.sx+se.y*this.shx+this.tx,it=se.x*this.shy+se.y*this.sy+this.ty;return new jl(Ee,it)},De.prototype.applyToRectangle=function(se){var Ee=this.applyToPoint(se),it=this.applyToPoint(new jl(se.x+se.w,se.y+se.h));return new Qo(Ee.x,Ee.y,it.x-Ee.x,it.y-Ee.y)},De.prototype.clone=function(){var se=this.sx,Ee=this.shy,it=this.shx,bt=this.sy,Tt=this.tx,$t=this.ty;return new De(se,Ee,it,bt,Tt,$t)},f.Matrix=De;var lt=f.matrixMult=function(se,Ee){return Ee.multiply(se)},rt=new De(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=rt;var et=function(se,Ee){if(!we[se]){var it=(Ee instanceof Yu?"Sh":"P")+(Object.keys(xe).length+1).toString(10);Ee.id=it,we[se]=it,xe[it]=Ee,vt.publish("addPattern",Ee)}};f.ShadingPattern=Yu,f.TilingPattern=xh,f.addShadingPattern=function(se,Ee){return U("addShadingPattern()"),et(se,Ee),this},f.beginTilingPattern=function(se){U("beginTilingPattern()"),BA(se.boundingBox[0],se.boundingBox[1],se.boundingBox[2]-se.boundingBox[0],se.boundingBox[3]-se.boundingBox[1],se.matrix)},f.endTilingPattern=function(se,Ee){U("endTilingPattern()"),Ee.stream=ce[E].join(`
`),et(se,Ee),vt.publish("endTilingPattern",Ee),We.pop().restore()};var Qt=f.__private__.newObject=function(){var se=Qe();return he(se,!0),se},Qe=f.__private__.newObjectDeferred=function(){return R++,X[R]=function(){return te},R},he=function(se,Ee){return Ee=typeof Ee=="boolean"&&Ee,X[se]=te,Ee&&Z(se+" 0 obj"),se},pe=f.__private__.newAdditionalObject=function(){var se={objId:Qe(),content:""};return oe.push(se),se},ye=Qe(),Ne=Qe(),He=f.__private__.decodeColorString=function(se){var Ee=se.split(" ");if(Ee.length!==2||Ee[1]!=="g"&&Ee[1]!=="G")Ee.length===5&&(Ee[4]==="k"||Ee[4]==="K")&&(Ee=[(1-Ee[0])*(1-Ee[3]),(1-Ee[1])*(1-Ee[3]),(1-Ee[2])*(1-Ee[3]),"r"]);else{var it=parseFloat(Ee[0]);Ee=[it,it,it,"r"]}for(var bt="#",Tt=0;Tt<3;Tt++)bt+=("0"+Math.floor(255*parseFloat(Ee[Tt])).toString(16)).slice(-2);return bt},Ge=f.__private__.encodeColorString=function(se){var Ee;typeof se=="string"&&(se={ch1:se});var it=se.ch1,bt=se.ch2,Tt=se.ch3,$t=se.ch4,ls=se.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof it=="string"&&it.charAt(0)!=="#"){var js=new A5(it);if(js.ok)it=js.toHex();else if(!/^\d*\.?\d*$/.test(it))throw new Error('Invalid color "'+it+'" passed to jsPDF.encodeColorString.')}if(typeof it=="string"&&/^#[0-9A-Fa-f]{3}$/.test(it)&&(it="#"+it[1]+it[1]+it[2]+it[2]+it[3]+it[3]),typeof it=="string"&&/^#[0-9A-Fa-f]{6}$/.test(it)){var Ds=parseInt(it.substr(1),16);it=Ds>>16&255,bt=Ds>>8&255,Tt=255&Ds}if(bt===void 0||$t===void 0&&it===bt&&bt===Tt)if(typeof it=="string")Ee=it+" "+ls[0];else switch(se.precision){case 2:Ee=q(it/255)+" "+ls[0];break;case 3:default:Ee=V(it/255)+" "+ls[0]}else if($t===void 0||Hr($t)==="object"){if($t&&!isNaN($t.a)&&$t.a===0)return Ee=["1.","1.","1.",ls[1]].join(" ");if(typeof it=="string")Ee=[it,bt,Tt,ls[1]].join(" ");else switch(se.precision){case 2:Ee=[q(it/255),q(bt/255),q(Tt/255),ls[1]].join(" ");break;default:case 3:Ee=[V(it/255),V(bt/255),V(Tt/255),ls[1]].join(" ")}}else if(typeof it=="string")Ee=[it,bt,Tt,$t,ls[2]].join(" ");else switch(se.precision){case 2:Ee=[q(it),q(bt),q(Tt),q($t),ls[2]].join(" ");break;case 3:default:Ee=[V(it),V(bt),V(Tt),V($t),ls[2]].join(" ")}return Ee},gt=f.__private__.getFilters=function(){return l},kt=f.__private__.putStream=function(se){var Ee=(se=se||{}).data||"",it=se.filters||gt(),bt=se.alreadyAppliedFilters||[],Tt=se.addLength1||!1,$t=Ee.length,ls=se.objectId,js=function(hn){return hn};if(c!==null&&ls===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(js=dt.encryptor(ls,0));var Ds={};it===!0&&(it=["FlateEncode"]);var Js=se.additionalKeyValues||[],Xs=(Ds=ds.API.processDataByFilters!==void 0?ds.API.processDataByFilters(Ee,it):{data:Ee,reverseChain:[]}).reverseChain+(Array.isArray(bt)?bt.join(" "):bt.toString());if(Ds.data.length!==0&&(Js.push({key:"Length",value:Ds.data.length}),Tt===!0&&Js.push({key:"Length1",value:$t})),Xs.length!=0)if(Xs.split("/").length-1==1)Js.push({key:"Filter",value:Xs});else{Js.push({key:"Filter",value:"["+Xs+"]"});for(var ur=0;ur<Js.length;ur+=1)if(Js[ur].key==="DecodeParms"){for(var ta=[],da=0;da<Ds.reverseChain.split("/").length-1;da+=1)ta.push("null");ta.push(Js[ur].value),Js[ur].value="["+ta.join(" ")+"]"}}Z("<<");for(var ya=0;ya<Js.length;ya++)Z("/"+Js[ya].key+" "+Js[ya].value);Z(">>"),Ds.data.length!==0&&(Z("stream"),Z(js(Ds.data)),Z("endstream"))},yt=f.__private__.putPage=function(se){var Ee=se.number,it=se.data,bt=se.objId,Tt=se.contentsObjId;he(bt,!0),Z("<</Type /Page"),Z("/Parent "+se.rootDictionaryObjId+" 0 R"),Z("/Resources "+se.resourceDictionaryObjId+" 0 R"),Z("/MediaBox ["+parseFloat(L(se.mediaBox.bottomLeftX))+" "+parseFloat(L(se.mediaBox.bottomLeftY))+" "+L(se.mediaBox.topRightX)+" "+L(se.mediaBox.topRightY)+"]"),se.cropBox!==null&&Z("/CropBox ["+L(se.cropBox.bottomLeftX)+" "+L(se.cropBox.bottomLeftY)+" "+L(se.cropBox.topRightX)+" "+L(se.cropBox.topRightY)+"]"),se.bleedBox!==null&&Z("/BleedBox ["+L(se.bleedBox.bottomLeftX)+" "+L(se.bleedBox.bottomLeftY)+" "+L(se.bleedBox.topRightX)+" "+L(se.bleedBox.topRightY)+"]"),se.trimBox!==null&&Z("/TrimBox ["+L(se.trimBox.bottomLeftX)+" "+L(se.trimBox.bottomLeftY)+" "+L(se.trimBox.topRightX)+" "+L(se.trimBox.topRightY)+"]"),se.artBox!==null&&Z("/ArtBox ["+L(se.artBox.bottomLeftX)+" "+L(se.artBox.bottomLeftY)+" "+L(se.artBox.topRightX)+" "+L(se.artBox.topRightY)+"]"),typeof se.userUnit=="number"&&se.userUnit!==1&&Z("/UserUnit "+se.userUnit),vt.publish("putPage",{objId:bt,pageContext:pt[Ee],pageNumber:Ee,page:it}),Z("/Contents "+Tt+" 0 R"),Z(">>"),Z("endobj");var $t=it.join(`
`);return N===j.ADVANCED&&($t+=`
Q`),he(Tt,!0),kt({data:$t,filters:gt(),objectId:Tt}),Z("endobj"),bt},Et=f.__private__.putPages=function(){var se,Ee,it=[];for(se=1;se<=mt;se++)pt[se].objId=Qe(),pt[se].contentsObjId=Qe();for(se=1;se<=mt;se++)it.push(yt({number:se,data:ce[se],objId:pt[se].objId,contentsObjId:pt[se].contentsObjId,mediaBox:pt[se].mediaBox,cropBox:pt[se].cropBox,bleedBox:pt[se].bleedBox,trimBox:pt[se].trimBox,artBox:pt[se].artBox,userUnit:pt[se].userUnit,rootDictionaryObjId:ye,resourceDictionaryObjId:Ne}));he(ye,!0),Z("<</Type /Pages");var bt="/Kids [";for(Ee=0;Ee<mt;Ee++)bt+=it[Ee]+" 0 R ";Z(bt+"]"),Z("/Count "+mt),Z(">>"),Z("endobj"),vt.publish("postPutPages")},Ft=function(se){vt.publish("putFont",{font:se,out:Z,newObject:Qt,putStream:kt}),se.isAlreadyPutted!==!0&&(se.objectNumber=Qt(),Z("<<"),Z("/Type /Font"),Z("/BaseFont /"+hh(se.postScriptName)),Z("/Subtype /Type1"),typeof se.encoding=="string"&&Z("/Encoding /"+se.encoding),Z("/FirstChar 32"),Z("/LastChar 255"),Z(">>"),Z("endobj"))},Yt=function(){for(var se in ht)ht.hasOwnProperty(se)&&(h===!1||h===!0&&A.hasOwnProperty(se))&&Ft(ht[se])},rs=function(se){se.objectNumber=Qt();var Ee=[];Ee.push({key:"Type",value:"/XObject"}),Ee.push({key:"Subtype",value:"/Form"}),Ee.push({key:"BBox",value:"["+[L(se.x),L(se.y),L(se.x+se.width),L(se.y+se.height)].join(" ")+"]"}),Ee.push({key:"Matrix",value:"["+se.matrix.toString()+"]"});var it=se.pages[1].join(`
`);kt({data:it,additionalKeyValues:Ee,objectId:se.objectNumber}),Z("endobj")},As=function(){for(var se in Ae)Ae.hasOwnProperty(se)&&rs(Ae[se])},es=function(se,Ee){var it,bt=[],Tt=1/(Ee-1);for(it=0;it<1;it+=Tt)bt.push(it);if(bt.push(1),se[0].offset!=0){var $t={offset:0,color:se[0].color};se.unshift($t)}if(se[se.length-1].offset!=1){var ls={offset:1,color:se[se.length-1].color};se.push(ls)}for(var js="",Ds=0,Js=0;Js<bt.length;Js++){for(it=bt[Js];it>se[Ds+1].offset;)Ds++;var Xs=se[Ds].offset,ur=(it-Xs)/(se[Ds+1].offset-Xs),ta=se[Ds].color,da=se[Ds+1].color;js+=O(Math.round((1-ur)*ta[0]+ur*da[0]).toString(16))+O(Math.round((1-ur)*ta[1]+ur*da[1]).toString(16))+O(Math.round((1-ur)*ta[2]+ur*da[2]).toString(16))}return js.trim()},Jt=function(se,Ee){Ee||(Ee=21);var it=Qt(),bt=es(se.colors,Ee),Tt=[];Tt.push({key:"FunctionType",value:"0"}),Tt.push({key:"Domain",value:"[0.0 1.0]"}),Tt.push({key:"Size",value:"["+Ee+"]"}),Tt.push({key:"BitsPerSample",value:"8"}),Tt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Tt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),kt({data:bt,additionalKeyValues:Tt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:it}),Z("endobj"),se.objectNumber=Qt(),Z("<< /ShadingType "+se.type),Z("/ColorSpace /DeviceRGB");var $t="/Coords ["+L(parseFloat(se.coords[0]))+" "+L(parseFloat(se.coords[1]))+" ";se.type===2?$t+=L(parseFloat(se.coords[2]))+" "+L(parseFloat(se.coords[3])):$t+=L(parseFloat(se.coords[2]))+" "+L(parseFloat(se.coords[3]))+" "+L(parseFloat(se.coords[4]))+" "+L(parseFloat(se.coords[5])),Z($t+="]"),se.matrix&&Z("/Matrix ["+se.matrix.toString()+"]"),Z("/Function "+it+" 0 R"),Z("/Extend [true true]"),Z(">>"),Z("endobj")},Ps=function(se,Ee){var it=Qe(),bt=Qt();Ee.push({resourcesOid:it,objectOid:bt}),se.objectNumber=bt;var Tt=[];Tt.push({key:"Type",value:"/Pattern"}),Tt.push({key:"PatternType",value:"1"}),Tt.push({key:"PaintType",value:"1"}),Tt.push({key:"TilingType",value:"1"}),Tt.push({key:"BBox",value:"["+se.boundingBox.map(L).join(" ")+"]"}),Tt.push({key:"XStep",value:L(se.xStep)}),Tt.push({key:"YStep",value:L(se.yStep)}),Tt.push({key:"Resources",value:it+" 0 R"}),se.matrix&&Tt.push({key:"Matrix",value:"["+se.matrix.toString()+"]"}),kt({data:se.stream,additionalKeyValues:Tt,objectId:se.objectNumber}),Z("endobj")},Os=function(se){var Ee;for(Ee in xe)xe.hasOwnProperty(Ee)&&(xe[Ee]instanceof Yu?Jt(xe[Ee]):xe[Ee]instanceof xh&&Ps(xe[Ee],se))},lr=function(se){for(var Ee in se.objectNumber=Qt(),Z("<<"),se)switch(Ee){case"opacity":Z("/ca "+q(se[Ee]));break;case"stroke-opacity":Z("/CA "+q(se[Ee]))}Z(">>"),Z("endobj")},zs=function(){var se;for(se in Xe)Xe.hasOwnProperty(se)&&lr(Xe[se])},ba=function(){for(var se in Z("/XObject <<"),Ae)Ae.hasOwnProperty(se)&&Ae[se].objectNumber>=0&&Z("/"+se+" "+Ae[se].objectNumber+" 0 R");vt.publish("putXobjectDict"),Z(">>")},dn=function(){dt.oid=Qt(),Z("<<"),Z("/Filter /Standard"),Z("/V "+dt.v),Z("/R "+dt.r),Z("/U <"+dt.toHexString(dt.U)+">"),Z("/O <"+dt.toHexString(dt.O)+">"),Z("/P "+dt.P),Z(">>"),Z("endobj")},Ea=function(){for(var se in Z("/Font <<"),ht)ht.hasOwnProperty(se)&&(h===!1||h===!0&&A.hasOwnProperty(se))&&Z("/"+se+" "+ht[se].objectNumber+" 0 R");Z(">>")},Lr=function(){if(Object.keys(xe).length>0){for(var se in Z("/Shading <<"),xe)xe.hasOwnProperty(se)&&xe[se]instanceof Yu&&xe[se].objectNumber>=0&&Z("/"+se+" "+xe[se].objectNumber+" 0 R");vt.publish("putShadingPatternDict"),Z(">>")}},Wr=function(se){if(Object.keys(xe).length>0){for(var Ee in Z("/Pattern <<"),xe)xe.hasOwnProperty(Ee)&&xe[Ee]instanceof f.TilingPattern&&xe[Ee].objectNumber>=0&&xe[Ee].objectNumber<se&&Z("/"+Ee+" "+xe[Ee].objectNumber+" 0 R");vt.publish("putTilingPatternDict"),Z(">>")}},mr=function(){if(Object.keys(Xe).length>0){var se;for(se in Z("/ExtGState <<"),Xe)Xe.hasOwnProperty(se)&&Xe[se].objectNumber>=0&&Z("/"+se+" "+Xe[se].objectNumber+" 0 R");vt.publish("putGStateDict"),Z(">>")}},Dr=function(se){he(se.resourcesOid,!0),Z("<<"),Z("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ea(),Lr(),Wr(se.objectOid),mr(),ba(),Z(">>"),Z("endobj")},vl=function(){var se=[];Yt(),zs(),As(),Os(se),vt.publish("putResources"),se.forEach(Dr),Dr({resourcesOid:Ne,objectOid:Number.MAX_SAFE_INTEGER}),vt.publish("postPutResources")},Po=function(){vt.publish("putAdditionalObjects");for(var se=0;se<oe.length;se++){var Ee=oe[se];he(Ee.objId,!0),Z(Ee.content),Z("endobj")}vt.publish("postPutAdditionalObjects")},zl=function(se){ze[se.fontName]=ze[se.fontName]||{},ze[se.fontName][se.fontStyle]=se.id},fi=function(se,Ee,it,bt,Tt){var $t={id:"F"+(Object.keys(ht).length+1).toString(10),postScriptName:se,fontName:Ee,fontStyle:it,encoding:bt,isStandardFont:Tt||!1,metadata:{}};return vt.publish("addFont",{font:$t,instance:this}),ht[$t.id]=$t,zl($t),$t.id},pi=function(se){for(var Ee=0,it=Be.length;Ee<it;Ee++){var bt=fi.call(this,se[Ee][0],se[Ee][1],se[Ee][2],Be[Ee][3],!0);h===!1&&(A[bt]=!0);var Tt=se[Ee][0].split("-");zl({id:bt,fontName:Tt[0],fontStyle:Tt[1]||""})}vt.publish("addFonts",{fonts:ht,dictionary:ze})},Wa=function(se){return se.foo=function(){try{return se.apply(this,arguments)}catch(bt){var Ee=bt.stack||"";~Ee.indexOf(" at ")&&(Ee=Ee.split(" at ")[1]);var it="Error in function "+Ee.split(`
`)[0].split("<")[0]+": "+bt.message;if(!Vs.console)throw new Error(it);Vs.console.error(it,bt),Vs.alert&&alert(it)}},se.foo.bar=se,se.foo},Yl=function(se,Ee){var it,bt,Tt,$t,ls,js,Ds,Js,Xs;if(Tt=(Ee=Ee||{}).sourceEncoding||"Unicode",ls=Ee.outputEncoding,(Ee.autoencode||ls)&&ht[ue].metadata&&ht[ue].metadata[Tt]&&ht[ue].metadata[Tt].encoding&&($t=ht[ue].metadata[Tt].encoding,!ls&&ht[ue].encoding&&(ls=ht[ue].encoding),!ls&&$t.codePages&&(ls=$t.codePages[0]),typeof ls=="string"&&(ls=$t[ls]),ls)){for(Ds=!1,js=[],it=0,bt=se.length;it<bt;it++)(Js=ls[se.charCodeAt(it)])?js.push(String.fromCharCode(Js)):js.push(se[it]),js[it].charCodeAt(0)>>8&&(Ds=!0);se=js.join("")}for(it=se.length;Ds===void 0&&it!==0;)se.charCodeAt(it-1)>>8&&(Ds=!0),it--;if(!Ds)return se;for(js=Ee.noBOM?[]:[254,255],it=0,bt=se.length;it<bt;it++){if((Xs=(Js=se.charCodeAt(it))>>8)>>8)throw new Error("Character at position "+it+" of string '"+se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");js.push(Xs),js.push(Js-(Xs<<8))}return String.fromCharCode.apply(void 0,js)},Fa=f.__private__.pdfEscape=f.pdfEscape=function(se,Ee){return Yl(se,Ee).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xl=f.__private__.beginPage=function(se){ce[++mt]=[],pt[mt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(se[0]),topRightY:Number(se[1])}},bl(mt),le(ce[E])},Nr=function(se,Ee){var it,bt,Tt;switch(r=Ee||r,typeof se=="string"&&(it=y(se.toLowerCase()),Array.isArray(it)&&(bt=it[0],Tt=it[1])),Array.isArray(se)&&(bt=se[0]*ge,Tt=se[1]*ge),isNaN(bt)&&(bt=n[0],Tt=n[1]),(bt>14400||Tt>14400)&&(Yr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),bt=Math.min(14400,bt),Tt=Math.min(14400,Tt)),n=[bt,Tt],r.substr(0,1)){case"l":Tt>bt&&(n=[Tt,bt]);break;case"p":bt>Tt&&(n=[Tt,bt])}Xl(n),gi(za),Z(Hn),ju!==0&&Z(ju+" J"),xc!==0&&Z(xc+" j"),vt.publish("addPage",{pageNumber:mt})},mc=function(se){se>0&&se<=mt&&(ce.splice(se,1),pt.splice(se,1),mt--,E>mt&&(E=mt),this.setPage(E))},bl=function(se){se>0&&se<=mt&&(E=se)},yu=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return ce.length-1},Ga=function(se,Ee,it){var bt,Tt=void 0;return it=it||{},se=se!==void 0?se:ht[ue].fontName,Ee=Ee!==void 0?Ee:ht[ue].fontStyle,bt=se.toLowerCase(),ze[bt]!==void 0&&ze[bt][Ee]!==void 0?Tt=ze[bt][Ee]:ze[se]!==void 0&&ze[se][Ee]!==void 0?Tt=ze[se][Ee]:it.disableWarning===!1&&Yr.warn("Unable to look up font label for font '"+se+"', '"+Ee+"'. Refer to getFontList() for available fonts."),Tt||it.noFallback||(Tt=ze.times[Ee])==null&&(Tt=ze.times.normal),Tt},or=f.__private__.putInfo=function(){var se=Qt(),Ee=function(bt){return bt};for(var it in c!==null&&(Ee=dt.encryptor(se,0)),Z("<<"),Z("/Producer ("+Fa(Ee("jsPDF "+ds.version))+")"),Te)Te.hasOwnProperty(it)&&Te[it]&&Z("/"+it.substr(0,1).toUpperCase()+it.substr(1)+" ("+Fa(Ee(Te[it]))+")");Z("/CreationDate ("+Fa(Ee(G))+")"),Z(">>"),Z("endobj")},Jl=f.__private__.putCatalog=function(se){var Ee=(se=se||{}).rootDictionaryObjId||ye;switch(Qt(),Z("<<"),Z("/Type /Catalog"),Z("/Pages "+Ee+" 0 R"),Me||(Me="fullwidth"),Me){case"fullwidth":Z("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Z("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Z("/OpenAction [3 0 R /Fit]");break;case"original":Z("/OpenAction [3 0 R /XYZ null null 1]");break;default:var it=""+Me;it.substr(it.length-1)==="%"&&(Me=parseInt(Me)/100),typeof Me=="number"&&Z("/OpenAction [3 0 R /XYZ null null "+q(Me)+"]")}switch(xt||(xt="continuous"),xt){case"continuous":Z("/PageLayout /OneColumn");break;case"single":Z("/PageLayout /SinglePage");break;case"two":case"twoleft":Z("/PageLayout /TwoColumnLeft");break;case"tworight":Z("/PageLayout /TwoColumnRight")}Ke&&Z("/PageMode /"+Ke),vt.publish("putCatalog"),Z(">>"),Z("endobj")},Qn=f.__private__.putTrailer=function(){Z("trailer"),Z("<<"),Z("/Size "+(R+1)),Z("/Root "+R+" 0 R"),Z("/Info "+(R-1)+" 0 R"),c!==null&&Z("/Encrypt "+dt.oid+" 0 R"),Z("/ID [ <"+Y+"> <"+Y+"> ]"),Z(">>")},Zl=f.__private__.putHeader=function(){Z("%PDF-"+g),Z("%")},fc=f.__private__.putXRef=function(){var se="0000000000";Z("xref"),Z("0 "+(R+1)),Z("0000000000 65535 f ");for(var Ee=1;Ee<=R;Ee++)typeof X[Ee]=="function"?Z((se+X[Ee]()).slice(-10)+" 00000 n "):X[Ee]!==void 0?Z((se+X[Ee]).slice(-10)+" 00000 n "):Z("0000000000 00000 n ")},xi=f.__private__.buildDocument=function(){Ie(),le(ne),vt.publish("buildDocument"),Zl(),Et(),Po(),vl(),c!==null&&dn(),or(),Jl();var se=te;return fc(),Qn(),Z("startxref"),Z(""+se),Z("%%EOF"),le(ce[E]),ne.join(`
`)},yl=f.__private__.getBlob=function(se){return new Blob([Ue(se)],{type:"application/pdf"})},ke=f.output=f.__private__.output=Wa((function(se,Ee){switch(typeof(Ee=Ee||{})=="string"?Ee={filename:Ee}:Ee.filename=Ee.filename||"generated.pdf",se){case void 0:return xi();case"save":f.save(Ee.filename);break;case"arraybuffer":return Ue(xi());case"blob":return yl(xi());case"bloburi":case"bloburl":if(Vs.URL!==void 0&&typeof Vs.URL.createObjectURL=="function")return Vs.URL&&Vs.URL.createObjectURL(yl(xi()))||void 0;Yr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var it="",bt=xi();try{it=$b(bt)}catch{it=$b(unescape(encodeURIComponent(bt)))}return"data:application/pdf;filename="+Ee.filename+";base64,"+it;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Vs)==="[object Window]"){var Tt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",$t=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ee.pdfObjectUrl&&(Tt=Ee.pdfObjectUrl,$t="");var ls='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Tt+'"'+$t+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ee)+");<\/script></body></html>",js=Vs.open();return js!==null&&js.document.write(ls),js}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Vs)==="[object Window]"){var Ds='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ee.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ee.filename+'" width="500px" height="400px" /></body></html>',Js=Vs.open();if(Js!==null){Js.document.write(Ds);var Xs=this;Js.document.documentElement.querySelector("#pdfViewer").onload=function(){Js.document.title=Ee.filename,Js.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Xs.output("bloburl"))}}return Js}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Vs)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ur='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ee)+'"></iframe></body></html>',ta=Vs.open();if(ta!==null&&(ta.document.write(ur),ta.document.title=Ee.filename),ta||typeof safari>"u")return ta;break;case"datauri":case"dataurl":return Vs.document.location.href=this.output("datauristring",Ee);default:return null}})),at=function(se){return Array.isArray(Ot)===!0&&Ot.indexOf(se)>-1};switch(a){case"pt":ge=1;break;case"mm":ge=72/25.4;break;case"cm":ge=72/2.54;break;case"in":ge=72;break;case"px":ge=at("px_scaling")==1?.75:96/72;break;case"pc":case"em":ge=12;break;case"ex":ge=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);ge=a}var dt=null;Q(),T();var St=function(se){return c!==null?dt.encryptor(se,0):function(Ee){return Ee}},Ut=f.__private__.getPageInfo=f.getPageInfo=function(se){if(isNaN(se)||se%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:pt[se].objId,pageNumber:se,pageContext:pt[se]}},It=f.__private__.getPageInfoByObjId=function(se){if(isNaN(se)||se%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ee in pt)if(pt[Ee].objId===se)break;return Ut(Ee)},Ht=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:pt[E].objId,pageNumber:E,pageContext:pt[E]}};f.addPage=function(){return Nr.apply(this,arguments),this},f.setPage=function(){return bl.apply(this,arguments),le.call(this,ce[E]),this},f.insertPage=function(se){return this.addPage(),this.movePage(E,se),this},f.movePage=function(se,Ee){var it,bt;if(se>Ee){it=ce[se],bt=pt[se];for(var Tt=se;Tt>Ee;Tt--)ce[Tt]=ce[Tt-1],pt[Tt]=pt[Tt-1];ce[Ee]=it,pt[Ee]=bt,this.setPage(Ee)}else if(se<Ee){it=ce[se],bt=pt[se];for(var $t=se;$t<Ee;$t++)ce[$t]=ce[$t+1],pt[$t]=pt[$t+1];ce[Ee]=it,pt[Ee]=bt,this.setPage(Ee)}return this},f.deletePage=function(){return mc.apply(this,arguments),this},f.__private__.text=f.text=function(se,Ee,it,bt,Tt){var $t,ls,js,Ds,Js,Xs,ur,ta,da,ya=(bt=bt||{}).scope||this;if(typeof se=="number"&&typeof Ee=="number"&&(typeof it=="string"||Array.isArray(it))){var hn=it;it=Ee,Ee=se,se=hn}if(arguments[3]instanceof De?(U("The transform parameter of text() with a Matrix value"),da=Tt):(js=arguments[4],Ds=arguments[5],Hr(ur=arguments[3])==="object"&&ur!==null||(typeof js=="string"&&(Ds=js,js=null),typeof ur=="string"&&(Ds=ur,ur=null),typeof ur=="number"&&(js=ur,ur=null),bt={flags:ur,angle:js,align:Ds})),isNaN(Ee)||isNaN(it)||se==null)throw new Error("Invalid arguments passed to jsPDF.text");if(se.length===0)return ya;var Ya="",sl=!1,vi=typeof bt.lineHeightFactor=="number"?bt.lineHeightFactor:sr,Di=ya.internal.scaleFactor;function Ho(Pr){return Pr=Pr.split("	").join(Array(bt.TabLen||9).join(" ")),Fa(Pr,ur)}function _u(Pr){for(var kr,Aa=Pr.concat(),ja=[],_l=Aa.length;_l--;)typeof(kr=Aa.shift())=="string"?ja.push(kr):Array.isArray(Pr)&&(kr.length===1||kr[1]===void 0&&kr[2]===void 0)?ja.push(kr[0]):ja.push([kr[0],kr[1],kr[2]]);return ja}function dd(Pr,kr){var Aa;if(typeof Pr=="string")Aa=kr(Pr)[0];else if(Array.isArray(Pr)){for(var ja,_l,bd=Pr.concat(),_c=[],ku=bd.length;ku--;)typeof(ja=bd.shift())=="string"?_c.push(kr(ja)[0]):Array.isArray(ja)&&typeof ja[0]=="string"&&(_l=kr(ja[0],ja[1],ja[2]),_c.push([_l[0],_l[1],_l[2]]));Aa=_c}return Aa}var gc=!1,ud=!0;if(typeof se=="string")gc=!0;else if(Array.isArray(se)){var Ad=se.concat();ls=[];for(var vc,ua=Ad.length;ua--;)(typeof(vc=Ad.shift())!="string"||Array.isArray(vc)&&typeof vc[0]!="string")&&(ud=!1);gc=ud}if(gc===!1)throw new Error('Type of text must be string or Array. "'+se+'" is not recognized.');typeof se=="string"&&(se=se.match(/[\r?\n]/)?se.split(/\r\n|\r|\n/g):[se]);var hd=_e/ya.internal.scaleFactor,md=hd*(vi-1);switch(bt.baseline){case"bottom":it-=md;break;case"top":it+=hd-md;break;case"hanging":it+=hd-2*md;break;case"middle":it+=hd/2-md}if((Xs=bt.maxWidth||0)>0&&(typeof se=="string"?se=ya.splitTextToSize(se,Xs):Object.prototype.toString.call(se)==="[object Array]"&&(se=se.reduce((function(Pr,kr){return Pr.concat(ya.splitTextToSize(kr,Xs))}),[]))),$t={text:se,x:Ee,y:it,options:bt,mutex:{pdfEscape:Fa,activeFontKey:ue,fonts:ht,activeFontSize:_e}},vt.publish("preProcessText",$t),se=$t.text,js=(bt=$t.options).angle,!(da instanceof De)&&js&&typeof js=="number"){js*=Math.PI/180,bt.rotationDirection===0&&(js=-js),N===j.ADVANCED&&(js=-js);var fd=Math.cos(js),pd=Math.sin(js);da=new De(fd,pd,-pd,fd,0,0)}else js&&js instanceof De&&(da=js);N!==j.ADVANCED||da||(da=rt),(Js=bt.charSpace||Oo)!==void 0&&(Ya+=L(M(Js))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ta=bt.horizontalScale)!==void 0&&(Ya+=L(100*ta)+` Tz
`),bt.lang;var Sn=-1,bc=bt.renderingMode!==void 0?bt.renderingMode:bt.stroke,to=ya.internal.getCurrentPageInfo().pageContext;switch(bc){case 0:case!1:case"fill":Sn=0;break;case 1:case!0:case"stroke":Sn=1;break;case 2:case"fillThenStroke":Sn=2;break;case 3:case"invisible":Sn=3;break;case 4:case"fillAndAddForClipping":Sn=4;break;case 5:case"strokeAndAddPathForClipping":Sn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Sn=6;break;case 7:case"addToPathForClipping":Sn=7}var EA=to.usedRenderingMode!==void 0?to.usedRenderingMode:-1;Sn!==-1?Ya+=Sn+` Tr
`:EA!==-1&&(Ya+=`0 Tr
`),Sn!==-1&&(to.usedRenderingMode=Sn),Ds=bt.align||"left";var Cn,xd=_e*vi,Su=ya.internal.pageSize.getWidth(),gd=ht[ue];Js=bt.charSpace||Oo,Xs=bt.maxWidth||0,ur=Object.assign({autoencode:!0,noBOM:!0},bt.flags);var Nl=[],qo=function(Pr){return ya.getStringUnitWidth(Pr,{font:gd,charSpace:Js,fontSize:_e,doKerning:!1})*_e/Di};if(Object.prototype.toString.call(se)==="[object Array]"){var kn;ls=_u(se),Ds!=="left"&&(Cn=ls.map(qo));var mn,Vo=0;if(Ds==="right"){Ee-=Cn[0],se=[],ua=ls.length;for(var so=0;so<ua;so++)so===0?(mn=Mn(Ee),kn=Li(it)):(mn=M(Vo-Cn[so]),kn=-xd),se.push([ls[so],mn,kn]),Vo=Cn[so]}else if(Ds==="center"){Ee-=Cn[0]/2,se=[],ua=ls.length;for(var ro=0;ro<ua;ro++)ro===0?(mn=Mn(Ee),kn=Li(it)):(mn=M((Vo-Cn[ro])/2),kn=-xd),se.push([ls[ro],mn,kn]),Vo=Cn[ro]}else if(Ds==="left"){se=[],ua=ls.length;for(var vd=0;vd<ua;vd++)se.push(ls[vd])}else if(Ds==="justify"&&gd.encoding==="Identity-H"){se=[],ua=ls.length,Xs=Xs!==0?Xs:Su;for(var ao=0,vr=0;vr<ua;vr++)if(kn=vr===0?Li(it):-xd,mn=vr===0?Mn(Ee):ao,vr<ua-1){var no=M((Xs-Cn[vr])/(ls[vr].split(" ").length-1)),fn=ls[vr].split(" ");se.push([fn[0]+" ",mn,kn]),ao=0;for(var bi=1;bi<fn.length;bi++){var yc=(qo(fn[bi-1]+" "+fn[bi])-qo(fn[bi]))*Di+no;bi==fn.length-1?se.push([fn[bi],yc,0]):se.push([fn[bi]+" ",yc,0]),ao-=yc}}else se.push([ls[vr],mn,kn]);se.push(["",ao,0])}else{if(Ds!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(se=[],ua=ls.length,Xs=Xs!==0?Xs:Su,vr=0;vr<ua;vr++)kn=vr===0?Li(it):-xd,mn=vr===0?Mn(Ee):0,vr<ua-1?Nl.push(L(M((Xs-Cn[vr])/(ls[vr].split(" ").length-1)))):Nl.push(0),se.push([ls[vr],mn,kn])}}var Cu=typeof bt.R2L=="boolean"?bt.R2L:ot;Cu===!0&&(se=dd(se,(function(Pr,kr,Aa){return[Pr.split("").reverse().join(""),kr,Aa]}))),$t={text:se,x:Ee,y:it,options:bt,mutex:{pdfEscape:Fa,activeFontKey:ue,fonts:ht,activeFontSize:_e}},vt.publish("postProcessText",$t),se=$t.text,sl=$t.mutex.isHex||!1;var jc=ht[ue].encoding;jc!=="WinAnsiEncoding"&&jc!=="StandardEncoding"||(se=dd(se,(function(Pr,kr,Aa){return[Ho(Pr),kr,Aa]}))),ls=_u(se),se=[];for(var Nc,wc,yi,io=0,wl=1,lo=Array.isArray(ls[0])?wl:io,oo="",$o=function(Pr,kr,Aa){var ja="";return Aa instanceof De?(Aa=typeof bt.angle=="number"?lt(Aa,new De(1,0,0,1,Pr,kr)):lt(new De(1,0,0,1,Pr,kr),Aa),N===j.ADVANCED&&(Aa=lt(new De(1,0,0,-1,0,0),Aa)),ja=Aa.join(" ")+` Tm
`):ja=L(Pr)+" "+L(kr)+` Td
`,ja},sn=0;sn<ls.length;sn++){switch(oo="",lo){case wl:yi=(sl?"<":"(")+ls[sn][0]+(sl?">":")"),Nc=parseFloat(ls[sn][1]),wc=parseFloat(ls[sn][2]);break;case io:yi=(sl?"<":"(")+ls[sn]+(sl?">":")"),Nc=Mn(Ee),wc=Li(it)}Nl!==void 0&&Nl[sn]!==void 0&&(oo=Nl[sn]+` Tw
`),sn===0?se.push(oo+$o(Nc,wc,da)+yi):lo===io?se.push(oo+yi):lo===wl&&se.push(oo+$o(Nc,wc,da)+yi)}se=lo===io?se.join(` Tj
T* `):se.join(` Tj
`),se+=` Tj
`;var qn=`BT
/`;return qn+=ue+" "+_e+` Tf
`,qn+=L(_e*vi)+` TL
`,qn+=Ta+`
`,qn+=Ya,qn+=se,Z(qn+="ET"),A[ue]=!0,ya};var ts=f.__private__.clip=f.clip=function(se){return Z(se==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return ts("evenodd")},f.__private__.discardPath=f.discardPath=function(){return Z("n"),this};var Xt=f.__private__.isValidStyle=function(se){var Ee=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(se)!==-1&&(Ee=!0),Ee};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(se){return Xt(se)&&(d=se),this};var hs=f.__private__.getStyle=f.getStyle=function(se){var Ee=d;switch(se){case"D":case"S":Ee="S";break;case"F":Ee="f";break;case"FD":case"DF":Ee="B";break;case"f":case"f*":case"B":case"B*":Ee=se}return Ee},Ns=f.close=function(){return Z("h"),this};f.stroke=function(){return Z("S"),this},f.fill=function(se){return ns("f",se),this},f.fillEvenOdd=function(se){return ns("f*",se),this},f.fillStroke=function(se){return ns("B",se),this},f.fillStrokeEvenOdd=function(se){return ns("B*",se),this};var ns=function(se,Ee){Hr(Ee)==="object"?fs(Ee,se):Z(se)},ss=function(se){se===null||N===j.ADVANCED&&se===void 0||(se=hs(se),Z(se))};function vs(se,Ee,it,bt,Tt){var $t=new xh(Ee||this.boundingBox,it||this.xStep,bt||this.yStep,this.gState,Tt||this.matrix);$t.stream=this.stream;var ls=se+"$$"+this.cloneIndex+++"$$";return et(ls,$t),$t}var fs=function(se,Ee){var it=we[se.key],bt=xe[it];if(bt instanceof Yu)Z("q"),Z(gr(Ee)),bt.gState&&f.setGState(bt.gState),Z(se.matrix.toString()+" cm"),Z("/"+it+" sh"),Z("Q");else if(bt instanceof xh){var Tt=new De(1,0,0,-1,0,Mo());se.matrix&&(Tt=Tt.multiply(se.matrix||rt),it=vs.call(bt,se.key,se.boundingBox,se.xStep,se.yStep,Tt).id),Z("q"),Z("/Pattern cs"),Z("/"+it+" scn"),bt.gState&&f.setGState(bt.gState),Z(Ee),Z("Q")}},gr=function(se){switch(se){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Ka=f.moveTo=function(se,Ee){return Z(L(M(se))+" "+L(I(Ee))+" m"),this},Ur=f.lineTo=function(se,Ee){return Z(L(M(se))+" "+L(I(Ee))+" l"),this},er=f.curveTo=function(se,Ee,it,bt,Tt,$t){return Z([L(M(se)),L(I(Ee)),L(M(it)),L(I(bt)),L(M(Tt)),L(I($t)),"c"].join(" ")),this};f.__private__.line=f.line=function(se,Ee,it,bt,Tt){if(isNaN(se)||isNaN(Ee)||isNaN(it)||isNaN(bt)||!Xt(Tt))throw new Error("Invalid arguments passed to jsPDF.line");return N===j.COMPAT?this.lines([[it-se,bt-Ee]],se,Ee,[1,1],Tt||"S"):this.lines([[it-se,bt-Ee]],se,Ee,[1,1]).stroke()},f.__private__.lines=f.lines=function(se,Ee,it,bt,Tt,$t){var ls,js,Ds,Js,Xs,ur,ta,da,ya,hn,Ya,sl;if(typeof se=="number"&&(sl=it,it=Ee,Ee=se,se=sl),bt=bt||[1,1],$t=$t||!1,isNaN(Ee)||isNaN(it)||!Array.isArray(se)||!Array.isArray(bt)||!Xt(Tt)||typeof $t!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ka(Ee,it),ls=bt[0],js=bt[1],Js=se.length,hn=Ee,Ya=it,Ds=0;Ds<Js;Ds++)(Xs=se[Ds]).length===2?(hn=Xs[0]*ls+hn,Ya=Xs[1]*js+Ya,Ur(hn,Ya)):(ur=Xs[0]*ls+hn,ta=Xs[1]*js+Ya,da=Xs[2]*ls+hn,ya=Xs[3]*js+Ya,hn=Xs[4]*ls+hn,Ya=Xs[5]*js+Ya,er(ur,ta,da,ya,hn,Ya));return $t&&Ns(),ss(Tt),this},f.path=function(se){for(var Ee=0;Ee<se.length;Ee++){var it=se[Ee],bt=it.c;switch(it.op){case"m":Ka(bt[0],bt[1]);break;case"l":Ur(bt[0],bt[1]);break;case"c":er.apply(this,bt);break;case"h":Ns()}}return this},f.__private__.rect=f.rect=function(se,Ee,it,bt,Tt){if(isNaN(se)||isNaN(Ee)||isNaN(it)||isNaN(bt)||!Xt(Tt))throw new Error("Invalid arguments passed to jsPDF.rect");return N===j.COMPAT&&(bt=-bt),Z([L(M(se)),L(I(Ee)),L(M(it)),L(M(bt)),"re"].join(" ")),ss(Tt),this},f.__private__.triangle=f.triangle=function(se,Ee,it,bt,Tt,$t,ls){if(isNaN(se)||isNaN(Ee)||isNaN(it)||isNaN(bt)||isNaN(Tt)||isNaN($t)||!Xt(ls))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[it-se,bt-Ee],[Tt-it,$t-bt],[se-Tt,Ee-$t]],se,Ee,[1,1],ls,!0),this},f.__private__.roundedRect=f.roundedRect=function(se,Ee,it,bt,Tt,$t,ls){if(isNaN(se)||isNaN(Ee)||isNaN(it)||isNaN(bt)||isNaN(Tt)||isNaN($t)||!Xt(ls))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var js=4/3*(Math.SQRT2-1);return Tt=Math.min(Tt,.5*it),$t=Math.min($t,.5*bt),this.lines([[it-2*Tt,0],[Tt*js,0,Tt,$t-$t*js,Tt,$t],[0,bt-2*$t],[0,$t*js,-Tt*js,$t,-Tt,$t],[2*Tt-it,0],[-Tt*js,0,-Tt,-$t*js,-Tt,-$t],[0,2*$t-bt],[0,-$t*js,Tt*js,-$t,Tt,-$t]],se+Tt,Ee,[1,1],ls,!0),this},f.__private__.ellipse=f.ellipse=function(se,Ee,it,bt,Tt){if(isNaN(se)||isNaN(Ee)||isNaN(it)||isNaN(bt)||!Xt(Tt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var $t=4/3*(Math.SQRT2-1)*it,ls=4/3*(Math.SQRT2-1)*bt;return Ka(se+it,Ee),er(se+it,Ee-ls,se+$t,Ee-bt,se,Ee-bt),er(se-$t,Ee-bt,se-it,Ee-ls,se-it,Ee),er(se-it,Ee+ls,se-$t,Ee+bt,se,Ee+bt),er(se+$t,Ee+bt,se+it,Ee+ls,se+it,Ee),ss(Tt),this},f.__private__.circle=f.circle=function(se,Ee,it,bt){if(isNaN(se)||isNaN(Ee)||isNaN(it)||!Xt(bt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(se,Ee,it,it,bt)},f.setFont=function(se,Ee,it){return it&&(Ee=P(Ee,it)),ue=Ga(se,Ee,{disableWarning:!1}),this};var ea=f.__private__.getFont=f.getFont=function(){return ht[Ga.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var se,Ee,it={};for(se in ze)if(ze.hasOwnProperty(se))for(Ee in it[se]=[],ze[se])ze[se].hasOwnProperty(Ee)&&it[se].push(Ee);return it},f.addFont=function(se,Ee,it,bt,Tt){var $t=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&$t.indexOf(arguments[3])!==-1?Tt=arguments[3]:arguments[3]&&$t.indexOf(arguments[3])==-1&&(it=P(it,bt)),Tt=Tt||"Identity-H",fi.call(this,se,Ee,it,Tt)};var sr,za=t.lineWidth||.200025,un=f.__private__.getLineWidth=f.getLineWidth=function(){return za},gi=f.__private__.setLineWidth=f.setLineWidth=function(se){return za=se,Z(L(M(se))+" w"),this};f.__private__.setLineDash=ds.API.setLineDash=ds.API.setLineDashPattern=function(se,Ee){if(se=se||[],Ee=Ee||0,isNaN(Ee)||!Array.isArray(se))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return se=se.map((function(it){return L(M(it))})).join(" "),Ee=L(M(Ee)),Z("["+se+"] "+Ee+" d"),this};var Ys=f.__private__.getLineHeight=f.getLineHeight=function(){return _e*sr};f.__private__.getLineHeight=f.getLineHeight=function(){return _e*sr};var Gr=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(se){return typeof(se=se||1.15)=="number"&&(sr=se),this},An=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return sr};Gr(t.lineHeight);var Mn=f.__private__.getHorizontalCoordinate=function(se){return M(se)},Li=f.__private__.getVerticalCoordinate=function(se){return N===j.ADVANCED?se:pt[E].mediaBox.topRightY-pt[E].mediaBox.bottomLeftY-M(se)},kA=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(se){return L(Mn(se))},tl=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(se){return L(Li(se))},Hn=t.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return He(Hn)},f.__private__.setStrokeColor=f.setDrawColor=function(se,Ee,it,bt){return Hn=Ge({ch1:se,ch2:Ee,ch3:it,ch4:bt,pdfColorType:"draw",precision:2}),Z(Hn),this};var id=t.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return He(id)},f.__private__.setFillColor=f.setFillColor=function(se,Ee,it,bt){return id=Ge({ch1:se,ch2:Ee,ch3:it,ch4:bt,pdfColorType:"fill",precision:2}),Z(id),this};var Ta=t.textColor||"0 g",Ro=f.__private__.getTextColor=f.getTextColor=function(){return He(Ta)};f.__private__.setTextColor=f.setTextColor=function(se,Ee,it,bt){return Ta=Ge({ch1:se,ch2:Ee,ch3:it,ch4:bt,pdfColorType:"text",precision:3}),this};var Oo=t.charSpace,pc=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(Oo||0)};f.__private__.setCharSpace=f.setCharSpace=function(se){if(isNaN(se))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Oo=se,this};var ju=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(se){var Ee=f.CapJoinStyles[se];if(Ee===void 0)throw new Error("Line cap style of '"+se+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ju=Ee,Z(Ee+" J"),this};var xc=0;f.__private__.setLineJoin=f.setLineJoin=function(se){var Ee=f.CapJoinStyles[se];if(Ee===void 0)throw new Error("Line join style of '"+se+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xc=Ee,Z(Ee+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(se){if(se=se||0,isNaN(se))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Z(L(M(se))+" M"),this},f.GState=zx,f.setGState=function(se){(se=typeof se=="string"?Xe[ut[se]]:ld(null,se)).equals(ft)||(Z("/"+se.id+" gs"),ft=se)};var ld=function(se,Ee){if(!se||!ut[se]){var it=!1;for(var bt in Xe)if(Xe.hasOwnProperty(bt)&&Xe[bt].equals(Ee)){it=!0;break}if(it)Ee=Xe[bt];else{var Tt="GS"+(Object.keys(Xe).length+1).toString(10);Xe[Tt]=Ee,Ee.id=Tt}return se&&(ut[se]=Ee.id),vt.publish("addGState",Ee),Ee}};f.addGState=function(se,Ee){return ld(se,Ee),this},f.saveGraphicsState=function(){return Z("q"),Fe.push({key:ue,size:_e,color:Ta}),this},f.restoreGraphicsState=function(){Z("Q");var se=Fe.pop();return ue=se.key,_e=se.size,Ta=se.color,ft=null,this},f.setCurrentTransformationMatrix=function(se){return Z(se.toString()+" cm"),this},f.comment=function(se){return Z("#"+se),this};var jl=function(se,Ee){var it=se||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return it},set:function($t){isNaN($t)||(it=parseFloat($t))}});var bt=Ee||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return bt},set:function($t){isNaN($t)||(bt=parseFloat($t))}});var Tt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Tt},set:function($t){Tt=$t.toString()}}),this},Qo=function(se,Ee,it,bt){jl.call(this,se,Ee),this.type="rect";var Tt=it||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Tt},set:function(ls){isNaN(ls)||(Tt=parseFloat(ls))}});var $t=bt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return $t},set:function(ls){isNaN(ls)||($t=parseFloat(ls))}}),this},od=function(){this.page=mt,this.currentPage=E,this.pages=ce.slice(0),this.pagesContext=pt.slice(0),this.x=Ve,this.y=tt,this.matrix=Ze,this.width=eo(E),this.height=Mo(E),this.outputDestination=de,this.id="",this.objectNumber=-1};od.prototype.restore=function(){mt=this.page,E=this.currentPage,pt=this.pagesContext,ce=this.pages,Ve=this.x,tt=this.y,Ze=this.matrix,Nu(E,this.width),wu(E,this.height),de=this.outputDestination};var BA=function(se,Ee,it,bt,Tt){We.push(new od),mt=E=0,ce=[],Ve=se,tt=Ee,Ze=Tt,Xl([it,bt])},Yh=function(se){if(je[se])We.pop().restore();else{var Ee=new od,it="Xo"+(Object.keys(Ae).length+1).toString(10);Ee.id=it,je[se]=it,Ae[it]=Ee,vt.publish("addFormObject",Ee),We.pop().restore()}};for(var cd in f.beginFormObject=function(se,Ee,it,bt,Tt){return BA(se,Ee,it,bt,Tt),this},f.endFormObject=function(se){return Yh(se),this},f.doFormObject=function(se,Ee){var it=Ae[je[se]];return Z("q"),Z(Ee.toString()+" cm"),Z("/"+it.id+" Do"),Z("Q"),this},f.getFormObject=function(se){var Ee=Ae[je[se]];return{x:Ee.x,y:Ee.y,width:Ee.width,height:Ee.height,matrix:Ee.matrix}},f.save=function(se,Ee){return se=se||"generated.pdf",(Ee=Ee||{}).returnPromise=Ee.returnPromise||!1,Ee.returnPromise===!1?(Ku(yl(xi()),se),typeof Ku.unload=="function"&&Vs.setTimeout&&setTimeout(Ku.unload,911),this):new Promise((function(it,bt){try{var Tt=Ku(yl(xi()),se);typeof Ku.unload=="function"&&Vs.setTimeout&&setTimeout(Ku.unload,911),it(Tt)}catch($t){bt($t.message)}}))},ds.API)ds.API.hasOwnProperty(cd)&&(cd==="events"&&ds.API.events.length?(function(se,Ee){var it,bt,Tt;for(Tt=Ee.length-1;Tt!==-1;Tt--)it=Ee[Tt][0],bt=Ee[Tt][1],se.subscribe.apply(se,[it].concat(typeof bt=="function"?[bt]:bt))})(vt,ds.API.events):f[cd]=ds.API[cd]);var eo=f.getPageWidth=function(se){return(pt[se=se||E].mediaBox.topRightX-pt[se].mediaBox.bottomLeftX)/ge},Nu=f.setPageWidth=function(se,Ee){pt[se].mediaBox.topRightX=Ee*ge+pt[se].mediaBox.bottomLeftX},Mo=f.getPageHeight=function(se){return(pt[se=se||E].mediaBox.topRightY-pt[se].mediaBox.bottomLeftY)/ge},wu=f.setPageHeight=function(se,Ee){pt[se].mediaBox.topRightY=Ee*ge+pt[se].mediaBox.bottomLeftY};return f.internal={pdfEscape:Fa,getStyle:hs,getFont:ea,getFontSize:Ye,getCharSpace:pc,getTextColor:Ro,getLineHeight:Ys,getLineHeightFactor:An,getLineWidth:un,write:ve,getHorizontalCoordinate:Mn,getVerticalCoordinate:Li,getCoordinateString:kA,getVerticalCoordinateString:tl,collections:{},newObject:Qt,newAdditionalObject:pe,newObjectDeferred:Qe,newObjectDeferredBegin:he,getFilters:gt,putStream:kt,events:vt,scaleFactor:ge,pageSize:{getWidth:function(){return eo(E)},setWidth:function(se){Nu(E,se)},getHeight:function(){return Mo(E)},setHeight:function(se){wu(E,se)}},encryptionOptions:c,encryption:dt,getEncryptor:St,output:ke,getNumberOfPages:yu,pages:ce,out:Z,f2:q,f3:V,getPageInfo:Ut,getPageInfoByObjId:It,getCurrentPageInfo:Ht,getPDFVersion:v,Point:jl,Rectangle:Qo,Matrix:De,hasHotfix:at},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return eo(E)},set:function(se){Nu(E,se)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return Mo(E)},set:function(se){wu(E,se)},enumerable:!0,configurable:!0}),pi.call(f,Be),ue="F1",Nr(n,r),vt.publish("initialized"),f}Ah.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},Ah.prototype.toHexString=function(t){return t.split("").map((function(s){return("0"+(255&s.charCodeAt(0)).toString(16)).slice(-2)})).join("")},Ah.prototype.hexToBytes=function(t){for(var s=[],r=0;r<t.length;r+=2)s.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return s.join("")},Ah.prototype.processOwnerPassword=function(t,s){return Gb(Wb(s).substr(0,5),t)},Ah.prototype.encryptor=function(t,s){var r=Wb(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&s,s>>8&255)).substr(0,10);return function(a){return Gb(r,a)}},zx.prototype.equals=function(t){var s,r="id,objectNumber,equals";if(!t||Hr(t)!==Hr(this))return!1;var a=0;for(s in this)if(!(r.indexOf(s)>=0)){if(this.hasOwnProperty(s)&&!t.hasOwnProperty(s)||this[s]!==t[s])return!1;a++}for(s in t)t.hasOwnProperty(s)&&r.indexOf(s)<0&&a--;return a===0},ds.API={events:[]},ds.version="2.5.2";var Sa=ds.API,sj=1,yA=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ZA=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zs=function(t){return t.toFixed(2)},qd=function(t){return t.toFixed(5)};Sa.__acroform__={};var Zi=function(t,s){t.prototype=Object.create(s.prototype),t.prototype.constructor=t},_w=function(t){return t*sj},sc=function(t){var s=new p5,r=Es.internal.getHeight(t)||0,a=Es.internal.getWidth(t)||0;return s.BBox=[0,0,Number(Zs(a)),Number(Zs(r))],s},GL=Sa.__acroform__.setBit=function(t,s){if(t=t||0,s=s||0,isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<s},KL=Sa.__acroform__.clearBit=function(t,s){if(t=t||0,s=s||0,isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<s)},zL=Sa.__acroform__.getBit=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<s)==0?0:1},Qa=Sa.__acroform__.getBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return zL(t,s-1)},Ma=Sa.__acroform__.setBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return GL(t,s-1)},Ha=Sa.__acroform__.clearBitForPdf=function(t,s){if(isNaN(t)||isNaN(s))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return KL(t,s-1)},YL=Sa.__acroform__.calculateCoordinates=function(t,s){var r=s.internal.getHorizontalCoordinate,a=s.internal.getVerticalCoordinate,n=t[0],i=t[1],l=t[2],o=t[3],u={};return u.lowerLeft_X=r(n)||0,u.lowerLeft_Y=a(i+o)||0,u.upperRight_X=r(n+l)||0,u.upperRight_Y=a(i)||0,[Number(Zs(u.lowerLeft_X)),Number(Zs(u.lowerLeft_Y)),Number(Zs(u.upperRight_X)),Number(Zs(u.upperRight_Y))]},XL=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var s=[],r=t._V||t.DV,a=Kb(t,r),n=t.scope.internal.getFont(t.fontName,t.fontStyle).id;s.push("/Tx BMC"),s.push("q"),s.push("BT"),s.push(t.scope.__private__.encodeColorString(t.color)),s.push("/"+n+" "+Zs(a.fontSize)+" Tf"),s.push("1 0 0 1 0 0 Tm"),s.push(a.text),s.push("ET"),s.push("Q"),s.push("EMC");var i=sc(t);return i.scope=t.scope,i.stream=s.join(`
`),i}},Kb=function(t,s){var r=t.fontSize===0?t.maxFontSize:t.fontSize,a={text:"",fontSize:""},n=(s=(s=s.substr(0,1)=="("?s.substr(1):s).substr(s.length-1)==")"?s.substr(0,s.length-1):s).split(" ");n=t.multiline?n.map((function(V){return V.split(`
`)})):n.map((function(V){return[V]}));var i=r,l=Es.internal.getHeight(t)||0;l=l<0?-l:l;var o=Es.internal.getWidth(t)||0;o=o<0?-o:o;var u=function(V,M,z){if(V+1<n.length){var I=M+" "+n[V+1][0];return Pp(I,t,z).width<=o-4}return!1};i++;e:for(;i>0;){s="",i--;var d,c,h=Pp("3",t,i).height,A=t.multiline?l-i:(l-h)/2,f=A+=2,g=0,v=0,b=0;if(i<=0){s=`(...) Tj
`,s+="% Width of Text: "+Pp(s,t,i=12).width+", FieldWidth:"+o+`
`;break}for(var y="",j=0,N=0;N<n.length;N++)if(n.hasOwnProperty(N)){var S=!1;if(n[N].length!==1&&b!==n[N].length-1){if((h+2)*(j+2)+2>l)continue e;y+=n[N][b],S=!0,v=N,N--}else{y=(y+=n[N][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var B=parseInt(N),P=u(B,y,i),L=N>=n.length-1;if(P&&!L){y+=" ",b=0;continue}if(P||L){if(L)v=B;else if(t.multiline&&(h+2)*(j+2)+2>l)continue e}else{if(!t.multiline||(h+2)*(j+2)+2>l)continue e;v=B}}for(var U="",H=g;H<=v;H++){var q=n[H];if(t.multiline){if(H===v){U+=q[b]+" ",b=(b+1)%q.length;continue}if(H===g){U+=q[q.length-1]+" ";continue}}U+=q[0]+" "}switch(U=U.substr(U.length-1)==" "?U.substr(0,U.length-1):U,c=Pp(U,t,i).width,t.textAlign){case"right":d=o-c-2;break;case"center":d=(o-c)/2;break;case"left":default:d=2}s+=Zs(d)+" "+Zs(f)+` Td
`,s+="("+yA(U)+`) Tj
`,s+=-Zs(d)+` 0 Td
`,f=-(i+2),c=0,g=S?v:v+1,j++,y=""}break}return a.text=s,a.fontSize=i,a},Pp=function(t,s,r){var a=s.scope.internal.getFont(s.fontName,s.fontStyle),n=s.scope.getStringUnitWidth(t,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:s.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},JL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ZL=function(t,s){var r={type:"reference",object:t};s.internal.getPageInfo(t.page).pageContext.annotations.find((function(a){return a.type===r.type&&a.object===r.object}))===void 0&&s.internal.getPageInfo(t.page).pageContext.annotations.push(r)},eD=function(t,s){for(var r in t)if(t.hasOwnProperty(r)){var a=r,n=t[r];s.internal.newObjectDeferredBegin(n.objId,!0),Hr(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete t[a]}},tD=function(t,s){if(s.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Io.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(JL)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");sj=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new x5,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",(function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)})),t.internal.events.subscribe("buildDocument",(function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var i=a[n];i.objId=void 0,i.hasAnnotation&&ZL(i,r)}})(t)})),t.internal.events.subscribe("putCatalog",(function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)})),t.internal.events.subscribe("postPutPages",(function(r){(function(a,n){var i=!a;for(var l in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(l)){var o=a[l],u=[],d=o.Rect;if(o.Rect&&(o.Rect=YL(o.Rect,n)),n.internal.newObjectDeferredBegin(o.objId,!0),o.DA=Es.createDefaultAppearanceStream(o),Hr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(u=o.getKeyValueListForStream()),o.Rect=d,o.hasAppearanceStream&&!o.appearanceStreamContent){var c=XL(o);u.push({key:"AP",value:"<</N "+c+">>"}),n.internal.acroformPlugin.xForms.push(c)}if(o.appearanceStreamContent){var h="";for(var A in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(A)){var f=o.appearanceStreamContent[A];if(h+="/"+A+" ",h+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var l in f)if(f.hasOwnProperty(l)){var g=f[l];typeof g=="function"&&(g=g.call(n,o)),h+="/"+l+" "+g+" ",n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(n,o)),h+="/"+l+" "+g,n.internal.acroformPlugin.xForms.indexOf(g)>=0||n.internal.acroformPlugin.xForms.push(g);h+=">>"}u.push({key:"AP",value:`<<
`+h+">>"})}n.internal.putStream({additionalKeyValues:u,objectId:o.objId}),n.internal.out("endobj")}i&&eD(n.internal.acroformPlugin.xForms,n)})(r,t)})),t.internal.acroformPlugin.isInitialized=!0}},f5=Sa.__acroform__.arrayToPdfArray=function(t,s,r){var a=function(l){return l};if(Array.isArray(t)){for(var n="[",i=0;i<t.length;i++)switch(i!==0&&(n+=" "),Hr(t[i])){case"boolean":case"number":case"object":n+=t[i].toString();break;case"string":t[i].substr(0,1)!=="/"?(s!==void 0&&r&&(a=r.internal.getEncryptor(s)),n+="("+yA(a(t[i].toString()))+")"):n+=t[i].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Sv=function(t,s,r){var a=function(n){return n};return s!==void 0&&r&&(a=r.internal.getEncryptor(s)),(t=t||"").toString(),t="("+yA(a(t))+")"},nc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};nc.prototype.toString=function(){return this.objId+" 0 R"},nc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},nc.prototype.getKeyValueListForStream=function(){var t=[],s=Object.getOwnPropertyNames(this).filter((function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"}));for(var r in s)if(Object.getOwnPropertyDescriptor(this,s[r]).configurable===!1){var a=s[r],n=this[a];n&&(Array.isArray(n)?t.push({key:a,value:f5(n,this.objId,this.scope)}):n instanceof nc?(n.scope=this.scope,t.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&t.push({key:a,value:n}))}return t};var p5=function(){nc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,s=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Zi(p5,nc);var x5=function(){nc.call(this);var t,s=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return s.length>0?s:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return s}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+yA(r(t))+")"}},set:function(r){t=r}})};Zi(x5,nc);var Io=function t(){nc.call(this);var s=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return s},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');s=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Qa(s,3)},set:function(y){y?this.F=Ma(s,3):this.F=Ha(s,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(y){a=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(y){a[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(y){a[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(y){a[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(y){a[3]=y}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Yx)return;i="FieldObject"+t.FieldNum++}var y=function(j){return j};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+yA(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/sj:d},set:function(y){d=y}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Yx||this instanceof iA))return Sv(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=y}});var A=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(A)return this instanceof Nn?A:Sv(A,this.objId,this.scope)},set:function(y){y=y.toString(),A=this instanceof Nn?y:y.substr(0,1)==="("?ZA(y.substr(1,y.length-2)):ZA(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Nn?ZA(A.substr(1,A.length-1)):A},set:function(y){y=y.toString(),A=this instanceof Nn?"/"+y:y}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof Nn?f:Sv(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=this instanceof Nn?y:y.substr(0,1)==="("?ZA(y.substr(1,y.length-2)):ZA(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Nn?ZA(f.substr(1,f.length-1)):f},set:function(y){y=y.toString(),f=this instanceof Nn?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(y){y=!!y,v=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(y){g=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,1)},set:function(y){y?this.Ff=Ma(this.Ff,1):this.Ff=Ha(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,2)},set:function(y){y?this.Ff=Ma(this.Ff,2):this.Ff=Ha(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,3)},set:function(y){y?this.Ff=Ma(this.Ff,3):this.Ff=Ha(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};Zi(Io,nc);var yh=function(){Io.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var s=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return f5(s,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=(function(i,l,o){o||(o=1);for(var u,d=[];u=l.exec(i);)d.push(u[o]);return d})(a,/\((.*?)\)/g)),s=n}}),this.getOptions=function(){return s},this.setOptions=function(r){s=r,this.sort&&s.sort()},this.addOption=function(r){r=(r=r||"").toString(),s.push(r),this.sort&&s.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();s.indexOf(r)!==-1&&(s.splice(s.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,18)},set:function(r){r?this.Ff=Ma(this.Ff,18):this.Ff=Ha(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ma(this.Ff,19):this.Ff=Ha(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,20)},set:function(r){r?(this.Ff=Ma(this.Ff,20),s.sort()):this.Ff=Ha(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,22)},set:function(r){r?this.Ff=Ma(this.Ff,22):this.Ff=Ha(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,23)},set:function(r){r?this.Ff=Ma(this.Ff,23):this.Ff=Ha(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,27)},set:function(r){r?this.Ff=Ma(this.Ff,27):this.Ff=Ha(this.Ff,27)}}),this.hasAppearanceStream=!1};Zi(yh,Io);var jh=function(){yh.call(this),this.fontName="helvetica",this.combo=!1};Zi(jh,yh);var Nh=function(){jh.call(this),this.combo=!0};Zi(Nh,jh);var Bx=function(){Nh.call(this),this.edit=!0};Zi(Bx,Nh);var Nn=function(){Io.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,15)},set:function(r){r?this.Ff=Ma(this.Ff,15):this.Ff=Ha(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,16)},set:function(r){r?this.Ff=Ma(this.Ff,16):this.Ff=Ha(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,17)},set:function(r){r?this.Ff=Ma(this.Ff,17):this.Ff=Ha(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,26)},set:function(r){r?this.Ff=Ma(this.Ff,26):this.Ff=Ha(this.Ff,26)}});var t,s={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(s).length!==0){var a,n=[];for(a in n.push("<<"),s)n.push("/"+a+" ("+yA(r(s[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){Hr(r)==="object"&&(s=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return s.CA||""},set:function(r){typeof r=="string"&&(s.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Zi(Nn,Io);var Ex=function(){Nn.call(this),this.pushButton=!0};Zi(Ex,Nn);var wh=function(){Nn.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(s){t=s!==void 0?s:[]}})};Zi(wh,Nn);var Yx=function(){var t,s;Io.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return s},set:function(n){s=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(o){return o};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var i,l=[];for(i in l.push("<<"),a)l.push("/"+i+" ("+yA(n(a[i]))+")");return l.push(">>"),l.join(`
`)},set:function(n){Hr(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Es.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Zi(Yx,Io),wh.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var s in this.Kids)if(this.Kids.hasOwnProperty(s)){var r=this.Kids[s];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},wh.prototype.createOption=function(t){var s=new Yx;return s.Parent=this,s.optionName=t,this.Kids.push(s),sD.call(this.scope,s),s};var Fx=function(){Nn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Es.CheckBox.createAppearanceStream()};Zi(Fx,Nn);var iA=function(){Io.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,13)},set:function(s){s?this.Ff=Ma(this.Ff,13):this.Ff=Ha(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,21)},set:function(s){s?this.Ff=Ma(this.Ff,21):this.Ff=Ha(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,23)},set:function(s){s?this.Ff=Ma(this.Ff,23):this.Ff=Ha(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,24)},set:function(s){s?this.Ff=Ma(this.Ff,24):this.Ff=Ha(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,25)},set:function(s){s?this.Ff=Ma(this.Ff,25):this.Ff=Ha(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,26)},set:function(s){s?this.Ff=Ma(this.Ff,26):this.Ff=Ha(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(s){t=s}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(s){Number.isInteger(s)&&(t=s)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Zi(iA,Io);var Tx=function(){iA.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Qa(this.Ff,14)},set:function(t){t?this.Ff=Ma(this.Ff,14):this.Ff=Ha(this.Ff,14)}}),this.password=!0};Zi(Tx,iA);var Es={CheckBox:{createAppearanceStream:function(){return{N:{On:Es.CheckBox.YesNormal},D:{On:Es.CheckBox.YesPushDown,Off:Es.CheckBox.OffPushDown}}},YesPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=Kb(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+Zs(Es.internal.getWidth(t))+" "+Zs(Es.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Zs(i.fontSize)+" Tf "+n),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),s.stream=r.join(`
`),s},YesNormal:function(t){var s=sc(t);s.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,a=t.scope.__private__.encodeColorString(t.color),n=[],i=Es.internal.getHeight(t),l=Es.internal.getWidth(t),o=Kb(t,t.caption);return n.push("1 g"),n.push("0 0 "+Zs(l)+" "+Zs(i)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Zs(l-1)+" "+Zs(i-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Zs(o.fontSize)+" Tf "+a),n.push(o.text),n.push("ET"),n.push("Q"),s.stream=n.join(`
`),s},OffPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zs(Es.internal.getWidth(t))+" "+Zs(Es.internal.getHeight(t))+" re"),r.push("f"),s.stream=r.join(`
`),s}},RadioButton:{Circle:{createAppearanceStream:function(t){var s={D:{Off:Es.RadioButton.Circle.OffPushDown},N:{}};return s.N[t]=Es.RadioButton.Circle.YesNormal,s.D[t]=Es.RadioButton.Circle.YesPushDown,s},getCA:function(){return"l"},YesNormal:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Es.internal.getWidth(t)<=Es.internal.getHeight(t)?Es.internal.getWidth(t)/4:Es.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Es.internal.Bezier_C,i=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+qd(Es.internal.getWidth(t)/2)+" "+qd(Es.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),s.stream=r.join(`
`),s},YesPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Es.internal.getWidth(t)<=Es.internal.getHeight(t)?Es.internal.getWidth(t)/4:Es.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*Es.internal.Bezier_C).toFixed(5)),l=Number((a*Es.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+qd(Es.internal.getWidth(t)/2)+" "+qd(Es.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+qd(Es.internal.getWidth(t)/2)+" "+qd(Es.internal.getHeight(t)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+l+" "+l+" "+a+" 0 "+a+" c"),r.push("-"+l+" "+a+" -"+a+" "+l+" -"+a+" 0 c"),r.push("-"+a+" -"+l+" -"+l+" -"+a+" 0 -"+a+" c"),r.push(l+" -"+a+" "+a+" -"+l+" "+a+" 0 c"),r.push("f"),r.push("Q"),s.stream=r.join(`
`),s},OffPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Es.internal.getWidth(t)<=Es.internal.getHeight(t)?Es.internal.getWidth(t)/4:Es.internal.getHeight(t)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),i=Number((n*Es.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+qd(Es.internal.getWidth(t)/2)+" "+qd(Es.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),s.stream=r.join(`
`),s}},Cross:{createAppearanceStream:function(t){var s={D:{Off:Es.RadioButton.Cross.OffPushDown},N:{}};return s.N[t]=Es.RadioButton.Cross.YesNormal,s.D[t]=Es.RadioButton.Cross.YesPushDown,s},getCA:function(){return"8"},YesNormal:function(t){var s=sc(t);s.scope=t.scope;var r=[],a=Es.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+Zs(Es.internal.getWidth(t)-2)+" "+Zs(Es.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(Zs(a.x1.x)+" "+Zs(a.x1.y)+" m"),r.push(Zs(a.x2.x)+" "+Zs(a.x2.y)+" l"),r.push(Zs(a.x4.x)+" "+Zs(a.x4.y)+" m"),r.push(Zs(a.x3.x)+" "+Zs(a.x3.y)+" l"),r.push("s"),r.push("Q"),s.stream=r.join(`
`),s},YesPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=Es.internal.calculateCross(t),a=[];return a.push("0.749023 g"),a.push("0 0 "+Zs(Es.internal.getWidth(t))+" "+Zs(Es.internal.getHeight(t))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Zs(Es.internal.getWidth(t)-2)+" "+Zs(Es.internal.getHeight(t)-2)+" re"),a.push("W"),a.push("n"),a.push(Zs(r.x1.x)+" "+Zs(r.x1.y)+" m"),a.push(Zs(r.x2.x)+" "+Zs(r.x2.y)+" l"),a.push(Zs(r.x4.x)+" "+Zs(r.x4.y)+" m"),a.push(Zs(r.x3.x)+" "+Zs(r.x3.y)+" l"),a.push("s"),a.push("Q"),s.stream=a.join(`
`),s},OffPushDown:function(t){var s=sc(t);s.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zs(Es.internal.getWidth(t))+" "+Zs(Es.internal.getHeight(t))+" re"),r.push("f"),s.stream=r.join(`
`),s}}},createDefaultAppearanceStream:function(t){var s=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+s+" "+t.fontSize+" Tf "+r}};Es.internal={Bezier_C:.551915024494,calculateCross:function(t){var s=Es.internal.getWidth(t),r=Es.internal.getHeight(t),a=Math.min(s,r);return{x1:{x:(s-a)/2,y:(r-a)/2+a},x2:{x:(s-a)/2+a,y:(r-a)/2},x3:{x:(s-a)/2,y:(r-a)/2},x4:{x:(s-a)/2+a,y:(r-a)/2+a}}}},Es.internal.getWidth=function(t){var s=0;return Hr(t)==="object"&&(s=_w(t.Rect[2])),s},Es.internal.getHeight=function(t){var s=0;return Hr(t)==="object"&&(s=_w(t.Rect[3])),s};var sD=Sa.addField=function(t){if(tD(this,t),!(t instanceof Io))throw new Error("Invalid argument passed to jsPDF.addField.");var s;return(s=t).scope.internal.acroformPlugin.printedOut&&(s.scope.internal.acroformPlugin.printedOut=!1,s.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),s.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(s),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};Sa.AcroFormChoiceField=yh,Sa.AcroFormListBox=jh,Sa.AcroFormComboBox=Nh,Sa.AcroFormEditBox=Bx,Sa.AcroFormButton=Nn,Sa.AcroFormPushButton=Ex,Sa.AcroFormRadioButton=wh,Sa.AcroFormCheckBox=Fx,Sa.AcroFormTextField=iA,Sa.AcroFormPasswordField=Tx,Sa.AcroFormAppearance=Es,Sa.AcroForm={ChoiceField:yh,ListBox:jh,ComboBox:Nh,EditBox:Bx,Button:Nn,PushButton:Ex,RadioButton:wh,CheckBox:Fx,TextField:iA,PasswordField:Tx,Appearance:Es},ds.AcroForm={ChoiceField:yh,ListBox:jh,ComboBox:Nh,EditBox:Bx,Button:Nn,PushButton:Ex,RadioButton:wh,CheckBox:Fx,TextField:iA,PasswordField:Tx,Appearance:Es};ds.AcroForm;function g5(t){return t.reduce((function(s,r,a){return s[r]=a,s}),{})}(function(t){t.__addimage__={};var s="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=t.__addimage__.getImageFileTypeByImageData=function(V,M){var z,I,G,Y,J,T=s;if((M=M||s)==="RGBA"||V.data!==void 0&&V.data instanceof Uint8ClampedArray&&"height"in V&&"width"in V)return"RGBA";if(P(V))for(J in r)for(G=r[J],z=0;z<G.length;z+=1){for(Y=!0,I=0;I<G[z].length;I+=1)if(G[z][I]!==void 0&&G[z][I]!==V[I]){Y=!1;break}if(Y===!0){T=J;break}}else for(J in r)for(G=r[J],z=0;z<G.length;z+=1){for(Y=!0,I=0;I<G[z].length;I+=1)if(G[z][I]!==void 0&&G[z][I]!==V.charCodeAt(I)){Y=!1;break}if(Y===!0){T=J;break}}return T===s&&M!==s&&(T=M),T},n=function V(M){for(var z=this.internal.write,I=this.internal.putStream,G=(0,this.internal.getFilters)();G.indexOf("FlateEncode")!==-1;)G.splice(G.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var Y=[];if(Y.push({key:"Type",value:"/XObject"}),Y.push({key:"Subtype",value:"/Image"}),Y.push({key:"Width",value:M.width}),Y.push({key:"Height",value:M.height}),M.colorSpace===b.INDEXED?Y.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(Y.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===b.DEVICE_CMYK&&Y.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Y.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&Y.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)){for(var J="",T=0,k=M.transparency.length;T<k;T++)J+=M.transparency[T]+" "+M.transparency[T]+" ";Y.push({key:"Mask",value:"["+J+"]"})}M.sMask!==void 0&&Y.push({key:"SMask",value:M.objectId+1+" 0 R"});var D=M.filter!==void 0?["/"+M.filter]:void 0;if(I({data:M.data,additionalKeyValues:Y,alreadyAppliedFilters:D,objectId:M.objectId}),z("endobj"),"sMask"in M&&M.sMask!==void 0){var Q="/Predictor "+M.predictor+" /Colors 1 /BitsPerComponent "+M.bitsPerComponent+" /Columns "+M.width,C={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:M.bitsPerComponent,decodeParameters:Q,data:M.sMask};"filter"in M&&(C.filter=M.filter),V.call(this,C)}if(M.colorSpace===b.INDEXED){var E=this.internal.newObject();I({data:U(new Uint8Array(M.palette)),objectId:E}),z("endobj")}},i=function(){var V=this.internal.collections.addImage_images;for(var M in V)n.call(this,V[M])},l=function(){var V,M=this.internal.collections.addImage_images,z=this.internal.write;for(var I in M)z("/I"+(V=M[I]).index,V.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var V=this.internal.collections.addImage_images;return o.call(this),V},d=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(V){return typeof t["process"+V.toUpperCase()]=="function"},h=function(V){return Hr(V)==="object"&&V.nodeType===1},A=function(V,M){if(V.nodeName==="IMG"&&V.hasAttribute("src")){var z=""+V.getAttribute("src");if(z.indexOf("data:image/")===0)return qm(unescape(z).split("base64,").pop());var I=t.loadFile(z,!0);if(I!==void 0)return I}if(V.nodeName==="CANVAS"){if(V.width===0||V.height===0)throw new Error("Given canvas must have data. Canvas width: "+V.width+", height: "+V.height);var G;switch(M){case"PNG":G="image/png";break;case"WEBP":G="image/webp";break;case"JPEG":case"JPG":default:G="image/jpeg"}return qm(V.toDataURL(G,1).split("base64,").pop())}},f=function(V){var M=this.internal.collections.addImage_images;if(M){for(var z in M)if(V===M[z].alias)return M[z]}},g=function(V,M,z){return V||M||(V=-96,M=-96),V<0&&(V=-1*z.width*72/V/this.internal.scaleFactor),M<0&&(M=-1*z.height*72/M/this.internal.scaleFactor),V===0&&(V=M*z.width/z.height),M===0&&(M=V*z.height/z.width),[V,M]},v=function(V,M,z,I,G,Y){var J=g.call(this,z,I,G),T=this.internal.getCoordinateString,k=this.internal.getVerticalCoordinateString,D=u.call(this);if(z=J[0],I=J[1],D[G.index]=G,Y){Y*=Math.PI/180;var Q=Math.cos(Y),C=Math.sin(Y),E=function(O){return O.toFixed(4)},w=[E(Q),E(C),E(-1*C),E(Q),0,0,"cm"]}this.internal.write("q"),Y?(this.internal.write([1,"0","0",1,T(V),k(M+I),"cm"].join(" ")),this.internal.write(w.join(" ")),this.internal.write([T(z),"0","0",T(I),"0","0","cm"].join(" "))):this.internal.write([T(z),"0","0",T(I),T(V),k(M+I),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+G.index+" Do"),this.internal.write("Q")},b=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},j=t.__addimage__.sHashCode=function(V){var M,z,I=0;if(typeof V=="string")for(z=V.length,M=0;M<z;M++)I=(I<<5)-I+V.charCodeAt(M),I|=0;else if(P(V))for(z=V.byteLength/2,M=0;M<z;M++)I=(I<<5)-I+V[M],I|=0;return I},N=t.__addimage__.validateStringAsBase64=function(V){(V=V||"").toString().trim();var M=!0;return V.length===0&&(M=!1),V.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(V.substr(0,V.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(V.substr(-2))===!1&&(M=!1),M},S=t.__addimage__.extractImageFromDataUrl=function(V){var M=(V=V||"").split("base64,"),z=null;if(M.length===2){var I=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(M[0]);Array.isArray(I)&&(z={mimeType:I[1],charset:I[2],data:M[1]})}return z},B=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(V){return B()&&V instanceof ArrayBuffer};var P=t.__addimage__.isArrayBufferView=function(V){return B()&&typeof Uint32Array<"u"&&(V instanceof Int8Array||V instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&V instanceof Uint8ClampedArray||V instanceof Int16Array||V instanceof Uint16Array||V instanceof Int32Array||V instanceof Uint32Array||V instanceof Float32Array||V instanceof Float64Array)},L=t.__addimage__.binaryStringToUint8Array=function(V){for(var M=V.length,z=new Uint8Array(M),I=0;I<M;I++)z[I]=V.charCodeAt(I);return z},U=t.__addimage__.arrayBufferToBinaryString=function(V){for(var M="",z=P(V)?V:new Uint8Array(V),I=0;I<z.length;I+=8192)M+=String.fromCharCode.apply(null,z.subarray(I,I+8192));return M};t.addImage=function(){var V,M,z,I,G,Y,J,T,k;if(typeof arguments[1]=="number"?(M=s,z=arguments[1],I=arguments[2],G=arguments[3],Y=arguments[4],J=arguments[5],T=arguments[6],k=arguments[7]):(M=arguments[1],z=arguments[2],I=arguments[3],G=arguments[4],Y=arguments[5],J=arguments[6],T=arguments[7],k=arguments[8]),Hr(V=arguments[0])==="object"&&!h(V)&&"imageData"in V){var D=V;V=D.imageData,M=D.format||M||s,z=D.x||z||0,I=D.y||I||0,G=D.w||D.width||G,Y=D.h||D.height||Y,J=D.alias||J,T=D.compression||T,k=D.rotation||D.angle||k}var Q=this.internal.getFilters();if(T===void 0&&Q.indexOf("FlateEncode")!==-1&&(T="SLOW"),isNaN(z)||isNaN(I))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var C=H.call(this,V,M,J,T);return v.call(this,z,I,G,Y,C,k),this};var H=function(V,M,z,I){var G,Y,J;if(typeof V=="string"&&a(V)===s){V=unescape(V);var T=q(V,!1);(T!==""||(T=t.loadFile(V,!0))!==void 0)&&(V=T)}if(h(V)&&(V=A(V,M)),M=a(V,M),!c(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((J=z)==null||J.length===0)&&(z=(function(k){return typeof k=="string"||P(k)?j(k):P(k.data)?j(k.data):null})(V)),(G=f.call(this,z))||(B()&&(V instanceof Uint8Array||M==="RGBA"||(Y=V,V=L(V))),G=this["process"+M.toUpperCase()](V,d.call(this),z,(function(k){return k&&typeof k=="string"&&(k=k.toUpperCase()),k in t.image_compression?k:y.NONE})(I),Y)),!G)throw new Error("An unknown error occurred whilst processing the image.");return G},q=t.__addimage__.convertBase64ToBinaryString=function(V,M){var z;M=typeof M!="boolean"||M;var I,G="";if(typeof V=="string"){I=(z=S(V))!==null?z.data:V;try{G=qm(I)}catch(Y){if(M)throw N(I)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Y.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};t.getImageProperties=function(V){var M,z,I="";if(h(V)&&(V=A(V)),typeof V=="string"&&a(V)===s&&((I=q(V,!1))===""&&(I=t.loadFile(V)||""),V=I),z=a(V),!c(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(!B()||V instanceof Uint8Array||(V=L(V)),!(M=this["process"+z.toUpperCase()](V)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=z,M}})(ds.API),(function(t){var s=function(r){if(r!==void 0&&r!="")return!0};ds.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var a,n,i,l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,c=!1,h=0;h<d.length&&!c;h++)switch((a=d[h]).type){case"link":(s(a.options.url)||s(a.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var A=0;A<d.length;A++){a=d[A];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(v.objId),j=a.title||"Note";i="<</Type /Annot /Subtype /Text "+(n="/Rect ["+l(a.bounds.x)+" "+o(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y)+"] ")+"/Contents ("+f(y(a.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+u.objId+" 0 R",i+=" /T ("+f(y(j))+") >>",v.content=i;var N=v.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+l(a.bounds.x+30)+" "+o(a.bounds.y+a.bounds.h)+" "+l(a.bounds.x+a.bounds.w+30)+" "+o(a.bounds.y)+"] ")+" /Parent "+N,a.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(v.objId,"0 R",b.objId,"0 R");break;case"freetext":n="/Rect ["+l(a.bounds.x)+" "+o(a.bounds.y)+" "+l(a.bounds.x+a.bounds.w)+" "+o(a.bounds.y+a.bounds.h)+"] ";var S=a.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+f(g(a.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(a.options.name){var B=this.annotations._nameMap[a.options.name];a.options.pageNumber=B.page,a.options.top=B.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",i="",a.options.url)i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(a.options.url))+") >>";else if(a.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,i+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var P=o(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),i+=" /XYZ "+a.options.left+" "+P+" "+a.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},t.link=function(r,a,n,i,l){var o=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:u(r),y:d(a),w:u(r+n),h:d(a+i)},options:l,type:"link"})},t.textWithLink=function(r,a,n,i){var l,o,u=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var c=this.splitTextToSize(r,o).length;l=Math.ceil(d*c)}else o=u,l=d;return this.text(r,a,n,i),n+=.2*d,i.align==="center"&&(a-=u/2),i.align==="right"&&(a-=u),this.link(a,n-d,o,l,i),u},t.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}})(ds.API),(function(t){var s={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];t.__arabicParser__={};var i=t.__arabicParser__.isInArabicSubstitutionA=function(v){return s[v.charCodeAt(0)]!==void 0},l=t.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},o=t.__arabicParser__.isArabicEndLetter=function(v){return l(v)&&i(v)&&s[v.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(v){return l(v)&&n.indexOf(v.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return l(v)&&i(v)&&s[v.charCodeAt(0)].length>=1};var d=t.__arabicParser__.arabicLetterHasFinalForm=function(v){return l(v)&&i(v)&&s[v.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(v){return l(v)&&i(v)&&s[v.charCodeAt(0)].length>=3};var c=t.__arabicParser__.arabicLetterHasMedialForm=function(v){return l(v)&&i(v)&&s[v.charCodeAt(0)].length==4},h=t.__arabicParser__.resolveLigatures=function(v){var b=0,y=r,j="",N=0;for(b=0;b<v.length;b+=1)y[v.charCodeAt(b)]!==void 0?(N++,typeof(y=y[v.charCodeAt(b)])=="number"&&(j+=String.fromCharCode(y),y=r,N=0),b===v.length-1&&(y=r,j+=v.charAt(b-(N-1)),b-=N-1,N=0)):(y=r,j+=v.charAt(b-N),b-=N,N=0);return j};t.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&a[v.charCodeAt(0)]!==void 0};var A=t.__arabicParser__.getCorrectForm=function(v,b,y){return l(v)?i(v)===!1?-1:!d(v)||!l(b)&&!l(y)||!l(y)&&o(b)||o(v)&&!l(b)||o(v)&&u(b)||o(v)&&o(b)?0:c(v)&&l(b)&&!o(b)&&l(y)&&d(y)?3:o(v)||!l(y)?1:2:-1},f=function(v){var b=0,y=0,j=0,N="",S="",B="",P=(v=v||"").split("\\s+"),L=[];for(b=0;b<P.length;b+=1){for(L.push(""),y=0;y<P[b].length;y+=1)N=P[b][y],S=P[b][y-1],B=P[b][y+1],l(N)?(j=A(N,S,B),L[b]+=j!==-1?String.fromCharCode(s[N.charCodeAt(0)][j]):N):L[b]+=N;L[b]=h(L[b])}return L.join(" ")},g=t.__arabicParser__.processArabic=t.processArabic=function(){var v,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var j=0;for(y=[],j=0;j<b.length;j+=1)Array.isArray(b[j])?y.push([f(b[j][0]),b[j][1],b[j][2]]):y.push([f(b[j])]);v=y}else v=f(b);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};t.events.push(["preProcessText",g])})(ds.API),ds.API.autoPrint=function(t){var s;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",(function(){s=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){this.internal.out("/OpenAction "+s+" 0 R")}))}return this},(function(t){var s=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(o){l=o}}),Object.defineProperty(this,"parentNode",{})};s.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},s.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new s,this.canvas.pdf=this}])})(ds.API),(function(t){var s={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},s),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(v){c=v}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var A=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return A},set:function(v){A=v}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(v){g=v}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,d){a.call(this);var c=(d=d||{}).fontSize||this.getFontSize(),h=d.font||this.getFont(),A=d.scaleFactor||this.internal.scaleFactor,f=0,g=0,v=0,b=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var y=d.maxWidth;y>0?typeof u=="string"?u=this.splitTextToSize(u,y):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce((function(N,S){return N.concat(b.splitTextToSize(S,y))}),[])):u=Array.isArray(u)?u:[u];for(var j=0;j<u.length;j++)f<(v=this.getStringUnitWidth(u[j],{font:h})*c)&&(f=v);return f!==0&&(g=u.length),{w:f/=A,h:Math.max((g*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/A,0)}},t.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||s;return this.internal.__cell__.lastCell=new i(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=t.cell=function(){var u;u=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var d=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,h=this.internal.__cell__.margins||s,A=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===u.lineNumber?(u.x=(d.x||0)+(d.width||0),u.y=d.y||0):d.y+d.height+u.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=h.top,f&&A&&(this.printHeaderRow(u.lineNumber,!0),u.y+=A[0].height)):u.y=d.y+d.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-c,u.y+c,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+c,{align:"center",baseline:"top",maxWidth:u.width-c-c}):this.text(u.text,u.x+c,u.y+c,{align:"left",baseline:"top",maxWidth:u.width-c-c})),this.internal.__cell__.lastCell=u,this};t.table=function(u,d,c,h,A){if(a.call(this),!c)throw new Error("No data for PDF table.");var f,g,v,b,y=[],j=[],N=[],S={},B={},P=[],L=[],U=(A=A||{}).autoSize||!1,H=A.printHeaders!==!1,q=A.css&&A.css["font-size"]!==void 0?16*A.css["font-size"]:A.fontSize||12,V=A.margins||Object.assign({width:this.getPageWidth()},s),M=typeof A.padding=="number"?A.padding:3,z=A.headerBackgroundColor||"#c8c8c8",I=A.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=H,this.internal.__cell__.margins=V,this.internal.__cell__.table_font_size=q,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=z,this.internal.__cell__.headerTextColor=I,this.setFontSize(q),h==null)j=y=Object.keys(c[0]),N=y.map((function(){return"left"}));else if(Array.isArray(h)&&Hr(h[0])==="object")for(y=h.map((function(D){return D.name})),j=h.map((function(D){return D.prompt||D.name||""})),N=h.map((function(D){return D.align||"left"})),f=0;f<h.length;f+=1)B[h[f].name]=h[f].width*(19.049976/25.4);else Array.isArray(h)&&typeof h[0]=="string"&&(j=y=h,N=y.map((function(){return"left"})));if(U||Array.isArray(h)&&typeof h[0]=="string")for(f=0;f<y.length;f+=1){for(S[b=y[f]]=c.map((function(D){return D[b]})),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(j[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=S[b],this.setFont(void 0,"normal"),v=0;v<g.length;v+=1)P.push(this.getTextDimensions(g[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);B[b]=Math.max.apply(null,P)+M+M,P=[]}if(H){var G={};for(f=0;f<y.length;f+=1)G[y[f]]={},G[y[f]].text=j[f],G[y[f]].align=N[f];var Y=o.call(this,G,B);L=y.map((function(D){return new i(u,d,B[D],Y,G[D].text,void 0,G[D].align)})),this.setTableHeaderRow(L),this.printHeaderRow(1,!1)}var J=h.reduce((function(D,Q){return D[Q.name]=Q.align,D}),{});for(f=0;f<c.length;f+=1){"rowStart"in A&&A.rowStart instanceof Function&&A.rowStart({row:f,data:c[f]},this);var T=o.call(this,c[f],B);for(v=0;v<y.length;v+=1){var k=c[f][y[v]];"cellStart"in A&&A.cellStart instanceof Function&&A.cellStart({row:f,col:v,data:k},this),l.call(this,new i(u,d,B[y[v]],T,k,f+2,J[y[v]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=d,this};var o=function(u,d){var c=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,A=this.internal.scaleFactor;return Object.keys(u).map((function(f){var g=u[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,d[f]-c-c)}),this).map((function(f){return this.getLineHeightFactor()*f.length*h/A+c+c}),this).reduce((function(f,g){return Math.max(f,g)}),0)};t.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,d){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var A=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){c=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(c.y=this.internal.__cell__.margins.top||0,A.push(c)),c.lineNumber=u;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,c),this.setTextColor(g)}A.length>0&&this.setTableHeaderRow(A),this.setFont(void 0,"normal"),r=!1}})(ds.API);var v5={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},b5=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],zb=g5(b5),y5=[100,200,300,400,500,600,700,800,900],rD=g5(y5);function Yb(t){var s=t.family.replace(/"|'/g,"").toLowerCase(),r=(function(i){return v5[i=i||"normal"]?i:"normal"})(t.style),a=(function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}})(t.weight),n=(function(i){return typeof zb[i=i||"normal"]=="number"?i:"normal"})(t.stretch);return{family:s,style:r,weight:a,stretch:n,src:t.src||[],ref:t.ref||{name:s,style:[n,r,a].join(" ")}}}function Sw(t,s,r,a){var n;for(n=r;n>=0&&n<s.length;n+=a)if(t[s[n]])return t[s[n]];for(n=r;n>=0&&n<s.length;n-=a)if(t[s[n]])return t[s[n]]}var aD={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Cw={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function kw(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function nD(t,s,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},aD,r.genericFontFamilies||{}),i=null,l=null,o=0;o<s.length;++o)if(n[(i=Yb(s[o])).family]&&(i.family=n[i.family]),t.hasOwnProperty(i.family)){l=t[i.family];break}if(!(l=l||t[a]))throw new Error("Could not find a font-family for the rule '"+kw(i)+"' and default family '"+a+"'.");if(l=(function(u,d){if(d[u])return d[u];var c=zb[u],h=c<=zb.normal?-1:1,A=Sw(d,b5,c,h);if(!A)throw new Error("Could not find a matching font-stretch value for "+u);return A})(i.stretch,l),l=(function(u,d){if(d[u])return d[u];for(var c=v5[u],h=0;h<c.length;++h)if(d[c[h]])return d[c[h]];throw new Error("Could not find a matching font-style for "+u)})(i.style,l),!(l=(function(u,d){if(d[u])return d[u];if(u===400&&d[500])return d[500];if(u===500&&d[400])return d[400];var c=rD[u],h=Sw(d,y5,c,u<400?-1:1);if(!h)throw new Error("Could not find a matching font-weight for value "+u);return h})(i.weight,l)))throw new Error("Failed to resolve a font for the rule '"+kw(i)+"'.");return l}function Bw(t){return t.trimLeft()}function iD(t,s){for(var r=0;r<t.length;){if(t.charAt(r)===s)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function lD(t){var s=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return s===null?null:[s[0],t.substring(s[0].length)]}var Rp,Ew,Fw,Cv=["times"];(function(t){var s,r,a,n,i,l,o,u,d,c=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new u,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new l,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new l,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new h(this),s=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,l=this.internal.Point,o=this.internal.Rectangle,u=this.internal.Matrix,d=new c}]);var h=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var E=C;Object.defineProperty(this,"pdf",{get:function(){return E}});var w=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return w},set:function(le){w=!!le}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(le){O=!!le}});var R=0;Object.defineProperty(this,"posX",{get:function(){return R},set:function(le){isNaN(le)||(R=le)}});var X=0;Object.defineProperty(this,"posY",{get:function(){return X},set:function(le){isNaN(le)||(X=le)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(le){var Z;typeof le=="number"?Z=[le,le,le,le]:((Z=new Array(4))[0]=le[0],Z[1]=le.length>=2?le[1]:Z[0],Z[2]=le.length>=3?le[2]:Z[0],Z[3]=le.length>=4?le[3]:Z[1]),d.margin=Z}});var ne=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ne},set:function(le){ne=le}});var te=0;Object.defineProperty(this,"lastBreak",{get:function(){return te},set:function(le){te=le}});var oe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return oe},set:function(le){oe=le}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(le){le instanceof c&&(d=le)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(le){d.path=le}});var ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return ce},set:function(le){ce=le}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(le){var Z;Z=A(le),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(le){var Z=A(le);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(le){["butt","round","square"].indexOf(le)!==-1&&(this.ctx.lineCap=le,this.pdf.setLineCap(le))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(le){isNaN(le)||(this.ctx.lineWidth=le,this.pdf.setLineWidth(le))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(le){["bevel","round","miter"].indexOf(le)!==-1&&(this.ctx.lineJoin=le,this.pdf.setLineJoin(le))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(le){isNaN(le)||(this.ctx.miterLimit=le,this.pdf.setMiterLimit(le))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(le){this.ctx.textBaseline=le}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(le){["right","end","center","left","start"].indexOf(le)!==-1&&(this.ctx.textAlign=le)}});var re=null;function de(le,Z){if(re===null){var ve=(function(Ue){var Be=[];return Object.keys(Ue).forEach((function(_e){Ue[_e].forEach((function(Me){var Ye=null;switch(Me){case"bold":Ye={family:_e,weight:"bold"};break;case"italic":Ye={family:_e,style:"italic"};break;case"bolditalic":Ye={family:_e,weight:"bold",style:"italic"};break;case"":case"normal":Ye={family:_e}}Ye!==null&&(Ye.ref={name:_e,style:Me},Be.push(Ye))}))})),Be})(le.getFontList());re=(function(Ue){for(var Be={},_e=0;_e<Ue.length;++_e){var Me=Yb(Ue[_e]),Ye=Me.family,ot=Me.stretch,Ke=Me.style,ct=Me.weight;Be[Ye]=Be[Ye]||{},Be[Ye][ot]=Be[Ye][ot]||{},Be[Ye][ot][Ke]=Be[Ye][ot][Ke]||{},Be[Ye][ot][Ke][ct]=Me}return Be})(ve.concat(Z))}return re}var Ie=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ie},set:function(le){re=null,Ie=le}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(le){var Z;if(this.ctx.font=le,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(le))!==null){var ve=Z[1],Ue=(Z[2],Z[3]),Be=Z[4],_e=(Z[5],Z[6]),Me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor(Me==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:Me==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var Ye=(function(Te){var ue,ge,Ve=[],tt=Te.trim();if(tt==="")return Cv;if(tt in Cw)return[Cw[tt]];for(;tt!=="";){switch(ge=null,ue=(tt=Bw(tt)).charAt(0)){case'"':case"'":ge=iD(tt.substring(1),ue);break;default:ge=lD(tt)}if(ge===null||(Ve.push(ge[0]),(tt=Bw(ge[1]))!==""&&tt.charAt(0)!==","))return Cv;tt=tt.replace(/^,/,"")}return Ve})(_e);if(this.fontFaces){var ot=nD(de(this.pdf,this.fontFaces),Ye.map((function(Te){return{family:Te,stretch:"normal",weight:Ue,style:ve}})));this.pdf.setFont(ot.ref.name,ot.ref.style)}else{var Ke="";(Ue==="bold"||parseInt(Ue,10)>=700||ve==="bold")&&(Ke="bold"),ve==="italic"&&(Ke+="italic"),Ke.length===0&&(Ke="normal");for(var ct="",xt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},be=0;be<Ye.length;be++){if(this.pdf.internal.getFont(Ye[be],Ke,{noFallback:!0,disableWarning:!0})!==void 0){ct=Ye[be];break}if(Ke==="bolditalic"&&this.pdf.internal.getFont(Ye[be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ct=Ye[be],Ke="bold";else if(this.pdf.internal.getFont(Ye[be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ct=Ye[be],Ke="normal";break}}if(ct===""){for(var Ce=0;Ce<Ye.length;Ce++)if(xt[Ye[Ce]]){ct=xt[Ye[Ce]];break}}ct=ct===""?"Times":ct,this.pdf.setFont(ct,Ke)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(le){this.ctx.globalCompositeOperation=le}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(le){this.ctx.globalAlpha=le}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(le){this.ctx.lineDashOffset=le,Q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(le){this.ctx.lineDash=le,Q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(le){this.ctx.ignoreClearRect=!!le}})};h.prototype.setLineDash=function(C){this.lineDash=C},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){S.call(this,"fill",!1)},h.prototype.stroke=function(){S.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(C,E){if(isNaN(C)||isNaN(E))throw Yr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var w=this.ctx.transform.applyToPoint(new l(C,E));this.path.push({type:"mt",x:w.x,y:w.y}),this.ctx.lastPoint=new l(C,E)},h.prototype.closePath=function(){var C=new l(0,0),E=0;for(E=this.path.length-1;E!==-1;E--)if(this.path[E].type==="begin"&&Hr(this.path[E+1])==="object"&&typeof this.path[E+1].x=="number"){C=new l(this.path[E+1].x,this.path[E+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(C.x,C.y)},h.prototype.lineTo=function(C,E){if(isNaN(C)||isNaN(E))throw Yr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var w=this.ctx.transform.applyToPoint(new l(C,E));this.path.push({type:"lt",x:w.x,y:w.y}),this.ctx.lastPoint=new l(w.x,w.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},h.prototype.quadraticCurveTo=function(C,E,w,O){if(isNaN(w)||isNaN(O)||isNaN(C)||isNaN(E))throw Yr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var R=this.ctx.transform.applyToPoint(new l(w,O)),X=this.ctx.transform.applyToPoint(new l(C,E));this.path.push({type:"qct",x1:X.x,y1:X.y,x:R.x,y:R.y}),this.ctx.lastPoint=new l(R.x,R.y)},h.prototype.bezierCurveTo=function(C,E,w,O,R,X){if(isNaN(R)||isNaN(X)||isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O))throw Yr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ne=this.ctx.transform.applyToPoint(new l(R,X)),te=this.ctx.transform.applyToPoint(new l(C,E)),oe=this.ctx.transform.applyToPoint(new l(w,O));this.path.push({type:"bct",x1:te.x,y1:te.y,x2:oe.x,y2:oe.y,x:ne.x,y:ne.y}),this.ctx.lastPoint=new l(ne.x,ne.y)},h.prototype.arc=function(C,E,w,O,R,X){if(isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O)||isNaN(R))throw Yr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(X=!!X,!this.ctx.transform.isIdentity){var ne=this.ctx.transform.applyToPoint(new l(C,E));C=ne.x,E=ne.y;var te=this.ctx.transform.applyToPoint(new l(0,w)),oe=this.ctx.transform.applyToPoint(new l(0,0));w=Math.sqrt(Math.pow(te.x-oe.x,2)+Math.pow(te.y-oe.y,2))}Math.abs(R-O)>=2*Math.PI&&(O=0,R=2*Math.PI),this.path.push({type:"arc",x:C,y:E,radius:w,startAngle:O,endAngle:R,counterclockwise:X})},h.prototype.arcTo=function(C,E,w,O,R){throw new Error("arcTo not implemented.")},h.prototype.rect=function(C,E,w,O){if(isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O))throw Yr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,E),this.lineTo(C+w,E),this.lineTo(C+w,E+O),this.lineTo(C,E+O),this.lineTo(C,E),this.lineTo(C+w,E),this.lineTo(C,E)},h.prototype.fillRect=function(C,E,w,O){if(isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O))throw Yr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var R={};this.lineCap!=="butt"&&(R.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(R.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,E,w,O),this.fill(),R.hasOwnProperty("lineCap")&&(this.lineCap=R.lineCap),R.hasOwnProperty("lineJoin")&&(this.lineJoin=R.lineJoin)}},h.prototype.strokeRect=function(C,E,w,O){if(isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O))throw Yr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(C,E,w,O),this.stroke())},h.prototype.clearRect=function(C,E,w,O){if(isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O))throw Yr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,E,w,O))},h.prototype.save=function(C){C=typeof C!="boolean"||C;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,w=0;w<this.pdf.internal.getNumberOfPages();w++)this.pdf.setPage(w+1),this.pdf.internal.out("q");if(this.pdf.setPage(E),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},h.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,w=0;w<this.pdf.internal.getNumberOfPages();w++)this.pdf.setPage(w+1),this.pdf.internal.out("Q");this.pdf.setPage(E),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var A=function(C){var E,w,O,R;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))E=0,w=0,O=0,R=0;else{var X=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(X!==null)E=parseInt(X[1]),w=parseInt(X[2]),O=parseInt(X[3]),R=1;else if((X=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)E=parseInt(X[1]),w=parseInt(X[2]),O=parseInt(X[3]),R=parseFloat(X[4]);else{if(R=1,typeof C=="string"&&C.charAt(0)!=="#"){var ne=new A5(C);C=ne.ok?ne.toHex():"#000000"}C.length===4?(E=C.substring(1,2),E+=E,w=C.substring(2,3),w+=w,O=C.substring(3,4),O+=O):(E=C.substring(1,3),w=C.substring(3,5),O=C.substring(5,7)),E=parseInt(E,16),w=parseInt(w,16),O=parseInt(O,16)}}return{r:E,g:w,b:O,a:R,style:C}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(C,E,w,O){if(isNaN(E)||isNaN(w)||typeof C!="string")throw Yr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!f.call(this)){var R=T(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;M.call(this,{text:C,x:E,y:w,scale:X,angle:R,align:this.textAlign,maxWidth:O})}},h.prototype.strokeText=function(C,E,w,O){if(isNaN(E)||isNaN(w)||typeof C!="string")throw Yr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){O=isNaN(O)?void 0:O;var R=T(this.ctx.transform.rotation),X=this.ctx.transform.scaleX;M.call(this,{text:C,x:E,y:w,scale:X,renderingMode:"stroke",angle:R,align:this.textAlign,maxWidth:O})}},h.prototype.measureText=function(C){if(typeof C!="string")throw Yr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var E=this.pdf,w=this.pdf.internal.scaleFactor,O=E.internal.getFontSize(),R=E.getStringUnitWidth(C)*O/E.internal.scaleFactor,X=function(ne){var te=(ne=ne||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return te}}),this};return new X({width:R*=Math.round(96*w/72*1e4)/1e4})},h.prototype.scale=function(C,E){if(isNaN(C)||isNaN(E))throw Yr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var w=new u(C,0,0,E,0,0);this.ctx.transform=this.ctx.transform.multiply(w)},h.prototype.rotate=function(C){if(isNaN(C))throw Yr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var E=new u(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(E)},h.prototype.translate=function(C,E){if(isNaN(C)||isNaN(E))throw Yr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var w=new u(1,0,0,1,C,E);this.ctx.transform=this.ctx.transform.multiply(w)},h.prototype.transform=function(C,E,w,O,R,X){if(isNaN(C)||isNaN(E)||isNaN(w)||isNaN(O)||isNaN(R)||isNaN(X))throw Yr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ne=new u(C,E,w,O,R,X);this.ctx.transform=this.ctx.transform.multiply(ne)},h.prototype.setTransform=function(C,E,w,O,R,X){C=isNaN(C)?1:C,E=isNaN(E)?0:E,w=isNaN(w)?0:w,O=isNaN(O)?1:O,R=isNaN(R)?0:R,X=isNaN(X)?0:X,this.ctx.transform=new u(C,E,w,O,R,X)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(C,E,w,O,R,X,ne,te,oe){var ce=this.pdf.getImageProperties(C),re=1,de=1,Ie=1,le=1;O!==void 0&&te!==void 0&&(Ie=te/O,le=oe/R,re=ce.width/O*te/O,de=ce.height/R*oe/R),X===void 0&&(X=E,ne=w,E=0,w=0),O!==void 0&&te===void 0&&(te=O,oe=R),O===void 0&&te===void 0&&(te=ce.width,oe=ce.height);for(var Z,ve=this.ctx.transform.decompose(),Ue=T(ve.rotate.shx),Be=new u,_e=(Be=(Be=(Be=Be.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale)).applyToRectangle(new o(X-E*Ie,ne-w*le,O*re,R*de)),Me=b.call(this,_e),Ye=[],ot=0;ot<Me.length;ot+=1)Ye.indexOf(Me[ot])===-1&&Ye.push(Me[ot]);if(N(Ye),this.autoPaging)for(var Ke=Ye[0],ct=Ye[Ye.length-1],xt=Ke;xt<ct+1;xt++){this.pdf.setPage(xt);var be=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ce=xt===1?this.posY+this.margin[0]:this.margin[0],Te=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ue=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ge=xt===1?0:Te+(xt-2)*ue;if(this.ctx.clip_path.length!==0){var Ve=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(Z,this.posX+this.margin[3],-ge+Ce+this.ctx.prevPageLastElemOffset),B.call(this,"fill",!0),this.path=Ve}var tt=JSON.parse(JSON.stringify(_e));tt=j([tt],this.posX+this.margin[3],-ge+Ce+this.ctx.prevPageLastElemOffset)[0];var Ze=(xt>Ke||xt<ct)&&v.call(this);Ze&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],be,ue,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",tt.x,tt.y,tt.w,tt.h,null,null,Ue),Ze&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(C,"JPEG",_e.x,_e.y,_e.w,_e.h,null,null,Ue)};var b=function(C,E,w){var O=[];E=E||this.pdf.internal.pageSize.width,w=w||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var R=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":O.push(Math.floor((C.y+R)/w)+1);break;case"arc":O.push(Math.floor((C.y+R-C.radius)/w)+1),O.push(Math.floor((C.y+R+C.radius)/w)+1);break;case"qct":var X=k(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);O.push(Math.floor((X.y+R)/w)+1),O.push(Math.floor((X.y+X.h+R)/w)+1);break;case"bct":var ne=D(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);O.push(Math.floor((ne.y+R)/w)+1),O.push(Math.floor((ne.y+ne.h+R)/w)+1);break;case"rect":O.push(Math.floor((C.y+R)/w)+1),O.push(Math.floor((C.y+C.h+R)/w)+1)}for(var te=0;te<O.length;te+=1)for(;this.pdf.internal.getNumberOfPages()<O[te];)y.call(this);return O},y=function(){var C=this.fillStyle,E=this.strokeStyle,w=this.font,O=this.lineCap,R=this.lineWidth,X=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=E,this.font=w,this.lineCap=O,this.lineWidth=R,this.lineJoin=X},j=function(C,E,w){for(var O=0;O<C.length;O++)switch(C[O].type){case"bct":C[O].x2+=E,C[O].y2+=w;case"qct":C[O].x1+=E,C[O].y1+=w;case"mt":case"lt":case"arc":default:C[O].x+=E,C[O].y+=w}return C},N=function(C){return C.sort((function(E,w){return E-w}))},S=function(C,E){for(var w,O,R=this.fillStyle,X=this.strokeStyle,ne=this.lineCap,te=this.lineWidth,oe=Math.abs(te*this.ctx.transform.scaleX),ce=this.lineJoin,re=JSON.parse(JSON.stringify(this.path)),de=JSON.parse(JSON.stringify(this.path)),Ie=[],le=0;le<de.length;le++)if(de[le].x!==void 0)for(var Z=b.call(this,de[le]),ve=0;ve<Z.length;ve+=1)Ie.indexOf(Z[ve])===-1&&Ie.push(Z[ve]);for(var Ue=0;Ue<Ie.length;Ue++)for(;this.pdf.internal.getNumberOfPages()<Ie[Ue];)y.call(this);if(N(Ie),this.autoPaging)for(var Be=Ie[0],_e=Ie[Ie.length-1],Me=Be;Me<_e+1;Me++){this.pdf.setPage(Me),this.fillStyle=R,this.strokeStyle=X,this.lineCap=ne,this.lineWidth=oe,this.lineJoin=ce;var Ye=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ot=Me===1?this.posY+this.margin[0]:this.margin[0],Ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],xt=Me===1?0:Ke+(Me-2)*ct;if(this.ctx.clip_path.length!==0){var be=this.path;w=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(w,this.posX+this.margin[3],-xt+ot+this.ctx.prevPageLastElemOffset),B.call(this,C,!0),this.path=be}if(O=JSON.parse(JSON.stringify(re)),this.path=j(O,this.posX+this.margin[3],-xt+ot+this.ctx.prevPageLastElemOffset),E===!1||Me===0){var Ce=(Me>Be||Me<_e)&&v.call(this);Ce&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ye,ct,null).clip().discardPath()),B.call(this,C,E),Ce&&this.pdf.restoreGraphicsState()}this.lineWidth=te}else this.lineWidth=oe,B.call(this,C,E),this.lineWidth=te;this.path=re},B=function(C,E){if((C!=="stroke"||E||!g.call(this))&&(C==="stroke"||E||!f.call(this))){for(var w,O,R=[],X=this.path,ne=0;ne<X.length;ne++){var te=X[ne];switch(te.type){case"begin":R.push({begin:!0});break;case"close":R.push({close:!0});break;case"mt":R.push({start:te,deltas:[],abs:[]});break;case"lt":var oe=R.length;if(X[ne-1]&&!isNaN(X[ne-1].x)&&(w=[te.x-X[ne-1].x,te.y-X[ne-1].y],oe>0)){for(;oe>=0;oe--)if(R[oe-1].close!==!0&&R[oe-1].begin!==!0){R[oe-1].deltas.push(w),R[oe-1].abs.push(te);break}}break;case"bct":w=[te.x1-X[ne-1].x,te.y1-X[ne-1].y,te.x2-X[ne-1].x,te.y2-X[ne-1].y,te.x-X[ne-1].x,te.y-X[ne-1].y],R[R.length-1].deltas.push(w);break;case"qct":var ce=X[ne-1].x+2/3*(te.x1-X[ne-1].x),re=X[ne-1].y+2/3*(te.y1-X[ne-1].y),de=te.x+2/3*(te.x1-te.x),Ie=te.y+2/3*(te.y1-te.y),le=te.x,Z=te.y;w=[ce-X[ne-1].x,re-X[ne-1].y,de-X[ne-1].x,Ie-X[ne-1].y,le-X[ne-1].x,Z-X[ne-1].y],R[R.length-1].deltas.push(w);break;case"arc":R.push({deltas:[],abs:[],arc:!0}),Array.isArray(R[R.length-1].abs)&&R[R.length-1].abs.push(te)}}O=E?null:C==="stroke"?"stroke":"fill";for(var ve=!1,Ue=0;Ue<R.length;Ue++)if(R[Ue].arc)for(var Be=R[Ue].abs,_e=0;_e<Be.length;_e++){var Me=Be[_e];Me.type==="arc"?U.call(this,Me.x,Me.y,Me.radius,Me.startAngle,Me.endAngle,Me.counterclockwise,void 0,E,!ve):z.call(this,Me.x,Me.y),ve=!0}else if(R[Ue].close===!0)this.pdf.internal.out("h"),ve=!1;else if(R[Ue].begin!==!0){var Ye=R[Ue].start.x,ot=R[Ue].start.y;I.call(this,R[Ue].deltas,Ye,ot),ve=!0}O&&H.call(this,O),E&&q.call(this)}},P=function(C){var E=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,w=E*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-w;case"top":return C+E-w;case"hanging":return C+E-2*w;case"middle":return C+E/2-w;case"ideographic":return C;case"alphabetic":default:return C}},L=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(E,w){this.colorStops.push([E,w])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var U=function(C,E,w,O,R,X,ne,te,oe){for(var ce=Y.call(this,w,O,R,X),re=0;re<ce.length;re++){var de=ce[re];re===0&&(oe?V.call(this,de.x1+C,de.y1+E):z.call(this,de.x1+C,de.y1+E)),G.call(this,C,E,de.x2,de.y2,de.x3,de.y3,de.x4,de.y4)}te?q.call(this):H.call(this,ne)},H=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},q=function(){this.pdf.clip(),this.pdf.discardPath()},V=function(C,E){this.pdf.internal.out(r(C)+" "+a(E)+" m")},M=function(C){var E;switch(C.align){case"right":case"end":E="right";break;case"center":E="center";break;case"left":case"start":default:E="left"}var w=this.pdf.getTextDimensions(C.text),O=P.call(this,C.y),R=L.call(this,O)-w.h,X=this.ctx.transform.applyToPoint(new l(C.x,O)),ne=this.ctx.transform.decompose(),te=new u;te=(te=(te=te.multiply(ne.translate)).multiply(ne.skew)).multiply(ne.scale);for(var oe,ce,re,de=this.ctx.transform.applyToRectangle(new o(C.x,O,w.w,w.h)),Ie=te.applyToRectangle(new o(C.x,R,w.w,w.h)),le=b.call(this,Ie),Z=[],ve=0;ve<le.length;ve+=1)Z.indexOf(le[ve])===-1&&Z.push(le[ve]);if(N(Z),this.autoPaging)for(var Ue=Z[0],Be=Z[Z.length-1],_e=Ue;_e<Be+1;_e++){this.pdf.setPage(_e);var Me=_e===1?this.posY+this.margin[0]:this.margin[0],Ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ot=this.pdf.internal.pageSize.height-this.margin[2],Ke=ot-this.margin[0],ct=this.pdf.internal.pageSize.width-this.margin[1],xt=ct-this.margin[3],be=_e===1?0:Ye+(_e-2)*Ke;if(this.ctx.clip_path.length!==0){var Ce=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(oe,this.posX+this.margin[3],-1*be+Me),B.call(this,"fill",!0),this.path=Ce}var Te=j([JSON.parse(JSON.stringify(Ie))],this.posX+this.margin[3],-be+Me+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*C.scale),re=this.lineWidth,this.lineWidth=re*C.scale);var ue=this.autoPaging!=="text";if(ue||Te.y+Te.h<=ot){if(ue||Te.y>=Me&&Te.x<=ct){var ge=ue?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||ct-Te.x)[0],Ve=j([JSON.parse(JSON.stringify(de))],this.posX+this.margin[3],-be+Me+this.ctx.prevPageLastElemOffset)[0],tt=ue&&(_e>Ue||_e<Be)&&v.call(this);tt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xt,Ke,null).clip().discardPath()),this.pdf.text(ge,Ve.x,Ve.y,{angle:C.angle,align:E,renderingMode:C.renderingMode}),tt&&this.pdf.restoreGraphicsState()}}else Te.y<ot&&(this.ctx.prevPageLastElemOffset+=ot-Te.y);C.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=re)}else C.scale>=.01&&(ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ce*C.scale),re=this.lineWidth,this.lineWidth=re*C.scale),this.pdf.text(C.text,X.x+this.posX,X.y+this.posY,{angle:C.angle,align:E,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(ce),this.lineWidth=re)},z=function(C,E,w,O){w=w||0,O=O||0,this.pdf.internal.out(r(C+w)+" "+a(E+O)+" l")},I=function(C,E,w){return this.pdf.lines(C,E,w,null,null)},G=function(C,E,w,O,R,X,ne,te){this.pdf.internal.out([s(n(w+C)),s(i(O+E)),s(n(R+C)),s(i(X+E)),s(n(ne+C)),s(i(te+E)),"c"].join(" "))},Y=function(C,E,w,O){for(var R=2*Math.PI,X=Math.PI/2;E>w;)E-=R;var ne=Math.abs(w-E);ne<R&&O&&(ne=R-ne);for(var te=[],oe=O?-1:1,ce=E;ne>1e-5;){var re=ce+oe*Math.min(ne,X);te.push(J.call(this,C,ce,re)),ne-=Math.abs(re-ce),ce=re}return te},J=function(C,E,w){var O=(w-E)/2,R=C*Math.cos(O),X=C*Math.sin(O),ne=R,te=-X,oe=ne*ne+te*te,ce=oe+ne*R+te*X,re=4/3*(Math.sqrt(2*oe*ce)-ce)/(ne*X-te*R),de=ne-re*te,Ie=te+re*ne,le=de,Z=-Ie,ve=O+E,Ue=Math.cos(ve),Be=Math.sin(ve);return{x1:C*Math.cos(E),y1:C*Math.sin(E),x2:de*Ue-Ie*Be,y2:de*Be+Ie*Ue,x3:le*Ue-Z*Be,y3:le*Be+Z*Ue,x4:C*Math.cos(w),y4:C*Math.sin(w)}},T=function(C){return 180*C/Math.PI},k=function(C,E,w,O,R,X){var ne=C+.5*(w-C),te=E+.5*(O-E),oe=R+.5*(w-R),ce=X+.5*(O-X),re=Math.min(C,R,ne,oe),de=Math.max(C,R,ne,oe),Ie=Math.min(E,X,te,ce),le=Math.max(E,X,te,ce);return new o(re,Ie,de-re,le-Ie)},D=function(C,E,w,O,R,X,ne,te){var oe,ce,re,de,Ie,le,Z,ve,Ue,Be,_e,Me,Ye,ot,Ke=w-C,ct=O-E,xt=R-w,be=X-O,Ce=ne-R,Te=te-X;for(ce=0;ce<41;ce++)Ue=(Z=(re=C+(oe=ce/40)*Ke)+oe*((Ie=w+oe*xt)-re))+oe*(Ie+oe*(R+oe*Ce-Ie)-Z),Be=(ve=(de=E+oe*ct)+oe*((le=O+oe*be)-de))+oe*(le+oe*(X+oe*Te-le)-ve),ce==0?(_e=Ue,Me=Be,Ye=Ue,ot=Be):(_e=Math.min(_e,Ue),Me=Math.min(Me,Be),Ye=Math.max(Ye,Ue),ot=Math.max(ot,Be));return new o(Math.round(_e),Math.round(Me),Math.round(Ye-_e),Math.round(ot-Me))},Q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,E,w=(C=this.ctx.lineDash,E=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:E}));this.prevLineDash!==w&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=w)}}})(ds.API),(function(t){var s=function(i){var l,o,u,d,c,h,A,f,g,v;for(o=[],u=0,d=(i+=l="\0\0\0\0".slice(i.length%4||4)).length;d>u;u+=4)(c=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(h=(c=((c=((c=((c=(c-(v=c%85))/85)-(g=c%85))/85)-(f=c%85))/85)-(A=c%85))/85)%85,o.push(h+33,A+33,f+33,g+33,v+33)):o.push(122);return(function(b,y){for(var j=y;j>0;j--)b.pop()})(o,l.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var l,o,u,d,c,h=String,A="length",f=255,g="charCodeAt",v="slice",b="replace";for(i[v](-2),i=i[v](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],d=0,c=(i+=l="uuuuu"[v](i[A]%5||5))[A];c>d;d+=5)o=52200625*(i[g](d)-33)+614125*(i[g](d+1)-33)+7225*(i[g](d+2)-33)+85*(i[g](d+3)-33)+(i[g](d+4)-33),u.push(f&o>>24,f&o>>16,f&o>>8,f&o);return(function(y,j){for(var N=j;N>0;N--)y.pop()})(u,l[A]),h.fromCharCode.apply(h,u)},a=function(i){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),l.test(i)===!1)return"";for(var o="",u=0;u<i.length;u+=2)o+=String.fromCharCode("0x"+(i[u]+i[u+1]));return o},n=function(i){for(var l=new Uint8Array(i.length),o=i.length;o--;)l[o]=i.charCodeAt(o);return i=(l=Vb(l)).reduce((function(u,d){return u+String.fromCharCode(d)}),"")};t.processDataByFilters=function(i,l){var o=0,u=i||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),o=0;o<l.length;o+=1)switch(l[o]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=s(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map((function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)})).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=n(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[o]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}})(ds.API),(function(t){t.loadFile=function(s,r,a){return(function(n,i,l){i=i!==!1,l=typeof l=="function"?l:function(){};var o=void 0;try{o=(function(u,d,c){var h=new XMLHttpRequest,A=0,f=function(g){var v=g.length,b=[],y=String.fromCharCode;for(A=0;A<v;A+=1)b.push(y(255&g.charCodeAt(A)));return b.join("")};if(h.open("GET",u,!d),h.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(h.onload=function(){h.status===200?c(f(this.responseText)):c(void 0)}),h.send(null),d&&h.status===200)return f(h.responseText)})(n,i,l)}catch{}return o})(s,r,a)},t.loadImageFile=t.loadFile})(ds.API),(function(t){function s(){return(Vs.html2canvas?Promise.resolve(Vs.html2canvas):Ob(()=>Promise.resolve().then(()=>zO),void 0)).catch((function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))})).then((function(l){return l.default?l.default:l}))}function r(){return(Vs.DOMPurify?Promise.resolve(Vs.DOMPurify):Ob(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch((function(l){return Promise.reject(new Error("Could not load dompurify: "+l))})).then((function(l){return l.default?l.default:l}))}var a=function(l){var o=Hr(l);return o==="undefined"?"undefined":o==="string"||l instanceof String?"string":o==="number"||l instanceof Number?"number":o==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":o==="object"?"object":"unknown"},n=function(l,o){var u=document.createElement(l);for(var d in o.className&&(u.className=o.className),o.innerHTML&&o.dompurify&&(u.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)u.style[d]=o.style[d];return u},i=function l(o){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return d=(d=d.setProgress(1,l,1,[l])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(l,o){return l.__proto__=o||i.prototype,l},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(l,o){return this.then((function(){switch(o=o||(function(u){switch(a(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(l)){case"string":return this.then(r).then((function(u){return this.set({src:n("div",{innerHTML:l,dompurify:u})})}));case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}}))},i.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then((function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=(function u(d,c){for(var h=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),A=d.firstChild;A;A=A.nextSibling)c!==!0&&A.nodeType===1&&A.nodeName==="SCRIPT"||h.appendChild(u(A,c));return d.nodeType===1&&(d.nodeName==="CANVAS"?(h.width=d.width,h.height=d.height,h.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(h.value=d.value),h.addEventListener("load",(function(){h.scrollTop=d.scrollTop,h.scrollLeft=d.scrollLeft}),!0)),h})(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"}))},i.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(s).then((function(o){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,o(this.prop.container,u)})).then((function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},i.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(s).then((function(o){var u=this.opt.jsPDF,d=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var A=0;A<d.length;++A){var f=d[A],g=f.src.find((function(v){return v.format==="truetype"}));g&&u.addFont(g.url,f.ref.name,f.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),o(this.prop.container,h)})).then((function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)}))},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then((function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l}))},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then((function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF}))},i.prototype.output=function(l,o,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,o):this.outputPdf(l,o)},i.prototype.outputPdf=function(l,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){return this.prop.pdf.output(l,o)}))},i.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then((function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}}))},i.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then((function(){this.prop.pdf.save(this.opt.filename)}))},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then((function(){this.prop.callback(this.prop.pdf)}))},i.prototype.set=function(l){if(a(l)!=="object")return this;var o=Object.keys(l||{}).map((function(u){if(u in i.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}}),this);return this.then((function(){return this.thenList(o)}))},i.prototype.get=function(l,o){return this.then((function(){var u=l in i.template.prop?this.prop[l]:this.opt[l];return o?o(u):u}))},i.prototype.setMargin=function(l){return this.then((function(){switch(a(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l})).then(this.setPageSize)},i.prototype.setPageSize=function(l){function o(u,d){return Math.floor(u*d/72*96)}return this.then((function(){(l=l||ds.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:o(l.inner.width,l.k),height:o(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l}))},i.prototype.setProgress=function(l,o,u,d){return l!=null&&(this.progress.val=l),o!=null&&(this.progress.state=o),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(l,o,u,d){return this.setProgress(l?this.progress.val+l:null,o||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},i.prototype.then=function(l,o){var u=this;return this.thenCore(l,o,(function(d,c){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,(function(h){return u.updateProgress(null,d),h})).then(d,c).then((function(h){return u.updateProgress(1),h}))}))},i.prototype.thenCore=function(l,o,u){u=u||Promise.prototype.then,l&&(l=l.bind(this)),o&&(o=o.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),c=u.call(d,l,o);return i.convert(c,this.__proto__)},i.prototype.thenExternal=function(l,o){return Promise.prototype.then.call(this,l,o)},i.prototype.thenList=function(l){var o=this;return l.forEach((function(u){o=o.thenCore(u)})),o},i.prototype.catch=function(l){l&&(l=l.bind(this));var o=Promise.prototype.catch.call(this,l);return i.convert(o,this)},i.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},i.prototype.error=function(l){return this.then((function(){throw new Error(l)}))},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,ds.getPageSize=function(l,o,u){if(Hr(l)==="object"){var d=l;l=d.orientation,o=d.unit||o,u=d.format||u}o=o||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var c,h=(""+u).toLowerCase(),A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+o}var f,g=0,v=0;if(A.hasOwnProperty(h))g=A[h][1]/c,v=A[h][0]/c;else try{g=u[1],v=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",v>g&&(f=v,v=g,g=f);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>v&&(f=v,v=g,g=f)}return{width:v,height:g,unit:o,k:c,orientation:l}},t.html=function(l,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Yb):null;var u=new i(o);return o.worker?u:u.from(l).doCallback()}})(ds.API),ds.API.addJS=function(t){return Fw=t,this.internal.events.subscribe("postPutResources",(function(){Rp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Rp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Ew=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Fw+")"),this.internal.out(">>"),this.internal.out("endobj")})),this.internal.events.subscribe("putCatalog",(function(){Rp!==void 0&&Ew!==void 0&&this.internal.out("/Names <</JavaScript "+Rp+" 0 R>>")})),this},(function(t){var s;t.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),i=0;i<n.length;i++){var l=n[i],o=a.exec(l);if(o!=null){var u=o[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,c=[];for(i=0;i<d;i++){var h=r.internal.newObject();c.push(h);var A=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+A.objId+" 0 R /XYZ null null null]>> endobj")}var f=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<c.length;i++)r.internal.write("(page_"+(i+1)+")"+c[i]+" 0 R");r.internal.write(" ] >>","endobj"),s=r.internal.newObject(),r.internal.write("<< /Dests "+f+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+s+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,i){var l={title:n,options:i,children:[]};return a==null&&(a=this.root),a.children.push(l),l},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<a.children.length;i++){var l=a.children[i];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(a)),i>0&&this.line("/Prev "+this.makeRef(a.children[i-1])),i<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[i+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var o=this.count=this.count_r({count:0},l);if(o>0&&this.line("/Count "+o),l.options&&l.options.pageNumber){var u=r.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var d=0;d<a.children.length;d++)this.renderItems(a.children[d])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var i=0;i<n.children.length;i++)a.count++,this.count_r(a,n.children[i]);return a.count}}])})(ds.API),(function(t){var s=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,a,n,i,l,o){var u,d=this.decode.DCT_DECODE,c=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=l||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(u=(function(h){for(var A,f=256*h.charCodeAt(4)+h.charCodeAt(5),g=h.length,v={width:0,height:0,numcomponents:1},b=4;b<g;b+=2){if(b+=f,s.indexOf(h.charCodeAt(b+1))!==-1){A=256*h.charCodeAt(b+5)+h.charCodeAt(b+6),v={width:256*h.charCodeAt(b+7)+h.charCodeAt(b+8),height:A,numcomponents:h.charCodeAt(b+9)};break}f=256*h.charCodeAt(b+2)+h.charCodeAt(b+3)}return v})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}c={data:r,width:u.width,height:u.height,colorSpace:o,bitsPerComponent:8,filter:d,index:a,alias:n}}return c}})(ds.API);var eh,Op,Tw,Iw,Lw,oD=(function(){var t,s,r;function a(i){var l,o,u,d,c,h,A,f,g,v,b,y,j,N;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},h=null;;){switch(l=this.readUInt32(),g=(function(){var S,B;for(B=[],S=0;S<4;++S)B.push(String.fromCharCode(this.data[this.pos++]));return B}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(l);break;case"fcTL":h&&this.animation.frames.push(h),this.pos+=4,h={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),d=this.readUInt16()||100,h.delay=1e3*c/d,h.disposeOp=this.data[this.pos++],h.blendOp=this.data[this.pos++],h.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,l-=4),i=(h!=null?h.data:void 0)||this.imgData,y=0;0<=l?y<l:y>l;0<=l?++y:--y)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(l),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((v=u-this.transparency.indexed.length)>0)for(j=0;0<=v?j<v:j>v;0<=v?++j:--j)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(l)[0];break;case 2:this.transparency.rgb=this.read(l)}break;case"tEXt":A=(b=this.read(l)).indexOf(0),f=String.fromCharCode.apply(String,b.slice(0,A)),this.text[f]=String.fromCharCode.apply(String,b.slice(A+1));break;case"IEND":return h&&this.animation.frames.push(h),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(N=this.colorType)===4||N===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=l}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(i){var l,o;for(o=[],l=0;0<=i?l<i:l>i;0<=i?++l:--l)o.push(this.data[this.pos++]);return o},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(i){var l=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*l),u=0,d=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function c(h,A,f,g){var v,b,y,j,N,S,B,P,L,U,H,q,V,M,z,I,G,Y,J,T,k,D=Math.ceil((d.width-h)/f),Q=Math.ceil((d.height-A)/g),C=d.width==D&&d.height==Q;for(M=l*D,q=C?o:new Uint8Array(M*Q),S=i.length,V=0,b=0;V<Q&&u<S;){switch(i[u++]){case 0:for(j=G=0;G<M;j=G+=1)q[b++]=i[u++];break;case 1:for(j=Y=0;Y<M;j=Y+=1)v=i[u++],N=j<l?0:q[b-l],q[b++]=(v+N)%256;break;case 2:for(j=J=0;J<M;j=J+=1)v=i[u++],y=(j-j%l)/l,z=V&&q[(V-1)*M+y*l+j%l],q[b++]=(z+v)%256;break;case 3:for(j=T=0;T<M;j=T+=1)v=i[u++],y=(j-j%l)/l,N=j<l?0:q[b-l],z=V&&q[(V-1)*M+y*l+j%l],q[b++]=(v+Math.floor((N+z)/2))%256;break;case 4:for(j=k=0;k<M;j=k+=1)v=i[u++],y=(j-j%l)/l,N=j<l?0:q[b-l],V===0?z=I=0:(z=q[(V-1)*M+y*l+j%l],I=y&&q[(V-1)*M+(y-1)*l+j%l]),B=N+z-I,P=Math.abs(B-N),U=Math.abs(B-z),H=Math.abs(B-I),L=P<=U&&P<=H?N:U<=H?z:I,q[b++]=(v+L)%256;break;default:throw new Error("Invalid filter algorithm: "+i[u-1])}if(!C){var E=((A+V*g)*d.width+h)*l,w=V*M;for(j=0;j<D;j+=1){for(var O=0;O<l;O+=1)o[E++]=q[w++];E+=(f-1)*l}}V++}}return i=QL(i),d.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),o},a.prototype.decodePalette=function(){var i,l,o,u,d,c,h,A,f;for(o=this.palette,c=this.transparency.indexed||[],d=new Uint8Array((c.length||0)+o.length),u=0,i=0,l=h=0,A=o.length;h<A;l=h+=3)d[u++]=o[l],d[u++]=o[l+1],d[u++]=o[l+2],d[u++]=(f=c[i++])!=null?f:255;return d},a.prototype.copyToImageData=function(i,l){var o,u,d,c,h,A,f,g,v,b,y;if(u=this.colors,v=null,o=this.hasAlphaChannel,this.palette.length&&(v=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),u=4,o=!0),g=(d=i.data||i).length,h=v||l,c=A=0,u===1)for(;c<g;)f=v?4*l[c/4]:A,b=h[f++],d[c++]=b,d[c++]=b,d[c++]=b,d[c++]=o?h[f++]:255,A=f;else for(;c<g;)f=v?4*l[c/4]:A,d[c++]=h[f++],d[c++]=h[f++],d[c++]=h[f++],d[c++]=o?h[f++]:255,A=f},a.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var n=function(){if(Object.prototype.toString.call(Vs)==="[object Window]"){try{s=Vs.document.createElement("canvas"),r=s.getContext("2d")}catch{return!1}return!0}return!1};return n(),t=function(i){var l;if(n()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(l=new Image).src=s.toDataURL(),l;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(i){var l,o,u,d,c,h,A,f;if(this.animation){for(f=[],o=c=0,h=(A=this.animation.frames).length;c<h;o=++c)l=A[o],u=i.createImageData(l.width,l.height),d=this.decodePixels(new Uint8Array(l.data)),this.copyToImageData(u,d),l.imageData=u,f.push(l.image=t(u));return f}},a.prototype.renderFrame=function(i,l){var o,u,d;return o=(u=this.animation.frames)[l],d=u[l-1],l===0&&i.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?i.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&i.putImageData(d.imageData,d.xOffset,d.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},a.prototype.animate=function(i){var l,o,u,d,c,h,A=this;return o=0,h=this.animation,d=h.numFrames,u=h.frames,c=h.numPlays,(l=function(){var f,g;if(f=o++%d,g=u[f],A.renderFrame(i,f),d>1&&o/d<c)return A.animation._timeout=setTimeout(l,g.delay)})()},a.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},a.prototype.render=function(i){var l,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,l=i.getContext("2d"),this.animation?(this.decodeFrames(l),this.animate(l)):(o=l.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),l.putImageData(o,0,0))},a})();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function cD(t){var s=0;if(t[s++]!==71||t[s++]!==73||t[s++]!==70||t[s++]!==56||(t[s++]+1&253)!=56||t[s++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[s++]|t[s++]<<8,a=t[s++]|t[s++]<<8,n=t[s++],i=n>>7,l=1<<(7&n)+1;t[s++],t[s++];var o=null,u=null;i&&(o=s,u=l,s+=3*l);var d=!0,c=[],h=0,A=null,f=0,g=null;for(this.width=r,this.height=a;d&&s<t.length;)switch(t[s++]){case 33:switch(t[s++]){case 255:if(t[s]!==11||t[s+1]==78&&t[s+2]==69&&t[s+3]==84&&t[s+4]==83&&t[s+5]==67&&t[s+6]==65&&t[s+7]==80&&t[s+8]==69&&t[s+9]==50&&t[s+10]==46&&t[s+11]==48&&t[s+12]==3&&t[s+13]==1&&t[s+16]==0)s+=14,g=t[s++]|t[s++]<<8,s++;else for(s+=12;;){if(!((V=t[s++])>=0))throw Error("Invalid block size");if(V===0)break;s+=V}break;case 249:if(t[s++]!==4||t[s+4]!==0)throw new Error("Invalid graphics extension block.");var v=t[s++];h=t[s++]|t[s++]<<8,A=t[s++],(1&v)==0&&(A=null),f=v>>2&7,s++;break;case 254:for(;;){if(!((V=t[s++])>=0))throw Error("Invalid block size");if(V===0)break;s+=V}break;default:throw new Error("Unknown graphic control label: 0x"+t[s-1].toString(16))}break;case 44:var b=t[s++]|t[s++]<<8,y=t[s++]|t[s++]<<8,j=t[s++]|t[s++]<<8,N=t[s++]|t[s++]<<8,S=t[s++],B=S>>6&1,P=1<<(7&S)+1,L=o,U=u,H=!1;S>>7&&(H=!0,L=s,U=P,s+=3*P);var q=s;for(s++;;){var V;if(!((V=t[s++])>=0))throw Error("Invalid block size");if(V===0)break;s+=V}c.push({x:b,y,width:j,height:N,has_local_palette:H,palette_offset:L,palette_size:U,data_offset:q,data_length:s-q,transparent_index:A,interlaced:!!B,delay:h,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+t[s-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(M){if(M<0||M>=c.length)throw new Error("Frame index out of range.");return c[M]},this.decodeAndBlitFrameBGRA=function(M,z){var I=this.frameInfo(M),G=I.width*I.height,Y=new Uint8Array(G);Dw(t,I.data_offset,Y,G);var J=I.palette_offset,T=I.transparent_index;T===null&&(T=256);var k=I.width,D=r-k,Q=k,C=4*(I.y*r+I.x),E=4*((I.y+I.height)*r+I.x),w=C,O=4*D;I.interlaced===!0&&(O+=4*r*7);for(var R=8,X=0,ne=Y.length;X<ne;++X){var te=Y[X];if(Q===0&&(Q=k,(w+=O)>=E&&(O=4*D+4*r*(R-1),w=C+(k+D)*(R<<1),R>>=1)),te===T)w+=4;else{var oe=t[J+3*te],ce=t[J+3*te+1],re=t[J+3*te+2];z[w++]=re,z[w++]=ce,z[w++]=oe,z[w++]=255}--Q}},this.decodeAndBlitFrameRGBA=function(M,z){var I=this.frameInfo(M),G=I.width*I.height,Y=new Uint8Array(G);Dw(t,I.data_offset,Y,G);var J=I.palette_offset,T=I.transparent_index;T===null&&(T=256);var k=I.width,D=r-k,Q=k,C=4*(I.y*r+I.x),E=4*((I.y+I.height)*r+I.x),w=C,O=4*D;I.interlaced===!0&&(O+=4*r*7);for(var R=8,X=0,ne=Y.length;X<ne;++X){var te=Y[X];if(Q===0&&(Q=k,(w+=O)>=E&&(O=4*D+4*r*(R-1),w=C+(k+D)*(R<<1),R>>=1)),te===T)w+=4;else{var oe=t[J+3*te],ce=t[J+3*te+1],re=t[J+3*te+2];z[w++]=oe,z[w++]=ce,z[w++]=re,z[w++]=255}--Q}}}function Dw(t,s,r,a){for(var n=t[s++],i=1<<n,l=i+1,o=l+1,u=n+1,d=(1<<u)-1,c=0,h=0,A=0,f=t[s++],g=new Int32Array(4096),v=null;;){for(;c<16&&f!==0;)h|=t[s++]<<c,c+=8,f===1?f=t[s++]:--f;if(c<u)break;var b=h&d;if(h>>=u,c-=u,b!==i){if(b===l)break;for(var y=b<o?b:v,j=0,N=y;N>i;)N=g[N]>>8,++j;var S=N;if(A+j+(y!==b?1:0)>a)return void Yr.log("Warning, gif stream longer than expected.");r[A++]=S;var B=A+=j;for(y!==b&&(r[A++]=S),N=y;j--;)N=g[N],r[--B]=255&N,N>>=8;v!==null&&o<4096&&(g[o++]=v<<8|S,o>=d+1&&u<12&&(++u,d=d<<1|1)),v=b}else o=l+1,d=(1<<(u=n+1))-1,v=null}return A!==a&&Yr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function kv(t){var s,r,a,n,i,l=Math.floor,o=new Array(64),u=new Array(64),d=new Array(64),c=new Array(64),h=new Array(65535),A=new Array(65535),f=new Array(64),g=new Array(64),v=[],b=0,y=7,j=new Array(64),N=new Array(64),S=new Array(64),B=new Array(256),P=new Array(2048),L=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],U=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],V=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],G=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Y(C,E){for(var w=0,O=0,R=new Array,X=1;X<=16;X++){for(var ne=1;ne<=C[X];ne++)R[E[O]]=[],R[E[O]][0]=w,R[E[O]][1]=X,O++,w++;w*=2}return R}function J(C){for(var E=C[0],w=C[1]-1;w>=0;)E&1<<w&&(b|=1<<y),w--,--y<0&&(b==255?(T(255),T(0)):T(b),y=7,b=0)}function T(C){v.push(C)}function k(C){T(C>>8&255),T(255&C)}function D(C,E,w,O,R){for(var X,ne=R[0],te=R[240],oe=(function(Be,_e){var Me,Ye,ot,Ke,ct,xt,be,Ce,Te,ue,ge=0;for(Te=0;Te<8;++Te){Me=Be[ge],Ye=Be[ge+1],ot=Be[ge+2],Ke=Be[ge+3],ct=Be[ge+4],xt=Be[ge+5],be=Be[ge+6];var Ve=Me+(Ce=Be[ge+7]),tt=Me-Ce,Ze=Ye+be,ht=Ye-be,ze=ot+xt,Fe=ot-xt,xe=Ke+ct,we=Ke-ct,Xe=Ve+xe,ut=Ve-xe,ft=Ze+ze,mt=Ze-ze;Be[ge]=Xe+ft,Be[ge+4]=Xe-ft;var pt=.707106781*(mt+ut);Be[ge+2]=ut+pt,Be[ge+6]=ut-pt;var vt=.382683433*((Xe=we+Fe)-(mt=ht+tt)),Ot=.5411961*Xe+vt,Ae=1.306562965*mt+vt,je=.707106781*(ft=Fe+ht),We=tt+je,De=tt-je;Be[ge+5]=De+Ot,Be[ge+3]=De-Ot,Be[ge+1]=We+Ae,Be[ge+7]=We-Ae,ge+=8}for(ge=0,Te=0;Te<8;++Te){Me=Be[ge],Ye=Be[ge+8],ot=Be[ge+16],Ke=Be[ge+24],ct=Be[ge+32],xt=Be[ge+40],be=Be[ge+48];var lt=Me+(Ce=Be[ge+56]),rt=Me-Ce,et=Ye+be,Qt=Ye-be,Qe=ot+xt,he=ot-xt,pe=Ke+ct,ye=Ke-ct,Ne=lt+pe,He=lt-pe,Ge=et+Qe,gt=et-Qe;Be[ge]=Ne+Ge,Be[ge+32]=Ne-Ge;var kt=.707106781*(gt+He);Be[ge+16]=He+kt,Be[ge+48]=He-kt;var yt=.382683433*((Ne=ye+he)-(gt=Qt+rt)),Et=.5411961*Ne+yt,Ft=1.306562965*gt+yt,Yt=.707106781*(Ge=he+Qt),rs=rt+Yt,As=rt-Yt;Be[ge+40]=As+Et,Be[ge+24]=As-Et,Be[ge+8]=rs+Ft,Be[ge+56]=rs-Ft,ge++}for(Te=0;Te<64;++Te)ue=Be[Te]*_e[Te],f[Te]=ue>0?ue+.5|0:ue-.5|0;return f})(C,E),ce=0;ce<64;++ce)g[L[ce]]=oe[ce];var re=g[0]-w;w=g[0],re==0?J(O[0]):(J(O[A[X=32767+re]]),J(h[X]));for(var de=63;de>0&&g[de]==0;)de--;if(de==0)return J(ne),w;for(var Ie,le=1;le<=de;){for(var Z=le;g[le]==0&&le<=de;)++le;var ve=le-Z;if(ve>=16){Ie=ve>>4;for(var Ue=1;Ue<=Ie;++Ue)J(te);ve&=15}X=32767+g[le],J(R[(ve<<4)+A[X]]),J(h[X]),le++}return de!=63&&J(ne),w}function Q(C){C=Math.min(Math.max(C,1),100),i!=C&&((function(E){for(var w=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var R=l((w[O]*E+50)/100);R=Math.min(Math.max(R,1),255),o[L[O]]=R}for(var X=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ne=0;ne<64;ne++){var te=l((X[ne]*E+50)/100);te=Math.min(Math.max(te,1),255),u[L[ne]]=te}for(var oe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ce=0,re=0;re<8;re++)for(var de=0;de<8;de++)d[ce]=1/(o[L[ce]]*oe[re]*oe[de]*8),c[ce]=1/(u[L[ce]]*oe[re]*oe[de]*8),ce++})(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),i=C)}this.encode=function(C,E){E&&Q(E),v=new Array,b=0,y=7,k(65496),k(65504),k(16),T(74),T(70),T(73),T(70),T(0),T(1),T(1),T(0),k(1),k(1),T(0),T(0),(function(){k(65499),k(132),T(0);for(var Ye=0;Ye<64;Ye++)T(o[Ye]);T(1);for(var ot=0;ot<64;ot++)T(u[ot])})(),(function(Ye,ot){k(65472),k(17),T(8),k(ot),k(Ye),T(3),T(1),T(17),T(0),T(2),T(17),T(1),T(3),T(17),T(1)})(C.width,C.height),(function(){k(65476),k(418),T(0);for(var Ye=0;Ye<16;Ye++)T(U[Ye+1]);for(var ot=0;ot<=11;ot++)T(H[ot]);T(16);for(var Ke=0;Ke<16;Ke++)T(q[Ke+1]);for(var ct=0;ct<=161;ct++)T(V[ct]);T(1);for(var xt=0;xt<16;xt++)T(M[xt+1]);for(var be=0;be<=11;be++)T(z[be]);T(17);for(var Ce=0;Ce<16;Ce++)T(I[Ce+1]);for(var Te=0;Te<=161;Te++)T(G[Te])})(),k(65498),k(12),T(3),T(1),T(0),T(2),T(17),T(3),T(17),T(0),T(63),T(0);var w=0,O=0,R=0;b=0,y=7,this.encode.displayName="_encode_";for(var X,ne,te,oe,ce,re,de,Ie,le,Z=C.data,ve=C.width,Ue=C.height,Be=4*ve,_e=0;_e<Ue;){for(X=0;X<Be;){for(ce=Be*_e+X,de=-1,Ie=0,le=0;le<64;le++)re=ce+(Ie=le>>3)*Be+(de=4*(7&le)),_e+Ie>=Ue&&(re-=Be*(_e+1+Ie-Ue)),X+de>=Be&&(re-=X+de-Be+4),ne=Z[re++],te=Z[re++],oe=Z[re++],j[le]=(P[ne]+P[te+256>>0]+P[oe+512>>0]>>16)-128,N[le]=(P[ne+768>>0]+P[te+1024>>0]+P[oe+1280>>0]>>16)-128,S[le]=(P[ne+1280>>0]+P[te+1536>>0]+P[oe+1792>>0]>>16)-128;w=D(j,d,w,s,a),O=D(N,c,O,r,n),R=D(S,c,R,r,n),X+=32}_e+=8}if(y>=0){var Me=[];Me[1]=y+1,Me[0]=(1<<y+1)-1,J(Me)}return k(65497),new Uint8Array(v)},t=t||50,(function(){for(var C=String.fromCharCode,E=0;E<256;E++)B[E]=C(E)})(),s=Y(U,H),r=Y(M,z),a=Y(q,V),n=Y(I,G),(function(){for(var C=1,E=2,w=1;w<=15;w++){for(var O=C;O<E;O++)A[32767+O]=w,h[32767+O]=[],h[32767+O][1]=w,h[32767+O][0]=O;for(var R=-(E-1);R<=-C;R++)A[32767+R]=w,h[32767+R]=[],h[32767+R][1]=w,h[32767+R][0]=E-1+R;C<<=1,E<<=1}})(),(function(){for(var C=0;C<256;C++)P[C]=19595*C,P[C+256>>0]=38470*C,P[C+512>>0]=7471*C+32768,P[C+768>>0]=-11059*C,P[C+1024>>0]=-21709*C,P[C+1280>>0]=32768*C+8421375,P[C+1536>>0]=-27439*C,P[C+1792>>0]=-5329*C})(),Q(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function jo(t,s){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!s,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Uw(t){function s(U){if(!U)throw Error("assert :P")}function r(U,H,q){for(var V=0;4>V;V++)if(U[H+V]!=q.charCodeAt(V))return!0;return!1}function a(U,H,q,V,M){for(var z=0;z<M;z++)U[H+z]=q[V+z]}function n(U,H,q,V){for(var M=0;M<V;M++)U[H+M]=q}function i(U){return new Int32Array(U)}function l(U,H){for(var q=[],V=0;V<U;V++)q.push(new H);return q}function o(U,H){var q=[];return(function V(M,z,I){for(var G=I[z],Y=0;Y<G&&(M.push(I.length>z+1?[]:new H),!(I.length<z+1));Y++)V(M[Y],z+1,I)})(q,0,U),q}var u=function(){var U=this;function H(F,K){for(var ie=1<<K-1>>>0;F&ie;)ie>>>=1;return ie?(F&ie-1)+ie:F}function q(F,K,ie,fe,Se){s(!(fe%ie));do F[K+(fe-=ie)]=Se;while(0<fe)}function V(F,K,ie,fe,Se){if(s(2328>=Se),512>=Se)var Pe=i(512);else if((Pe=i(Se))==null)return 0;return(function(Oe,qe,$e,st,jt,Lt){var Dt,Bt,Zt=qe,Vt=1<<$e,wt=i(16),_t=i(16);for(s(jt!=0),s(st!=null),s(Oe!=null),s(0<$e),Bt=0;Bt<jt;++Bt){if(15<st[Bt])return 0;++wt[st[Bt]]}if(wt[0]==jt)return 0;for(_t[1]=0,Dt=1;15>Dt;++Dt){if(wt[Dt]>1<<Dt)return 0;_t[Dt+1]=_t[Dt]+wt[Dt]}for(Bt=0;Bt<jt;++Bt)Dt=st[Bt],0<st[Bt]&&(Lt[_t[Dt]++]=Bt);if(_t[15]==1)return(st=new M).g=0,st.value=Lt[0],q(Oe,Zt,1,Vt,st),Vt;var Gt,Wt=-1,zt=Vt-1,ws=0,gs=1,Us=1,bs=1<<$e;for(Bt=0,Dt=1,jt=2;Dt<=$e;++Dt,jt<<=1){if(gs+=Us<<=1,0>(Us-=wt[Dt]))return 0;for(;0<wt[Dt];--wt[Dt])(st=new M).g=Dt,st.value=Lt[Bt++],q(Oe,Zt+ws,jt,bs,st),ws=H(ws,Dt)}for(Dt=$e+1,jt=2;15>=Dt;++Dt,jt<<=1){if(gs+=Us<<=1,0>(Us-=wt[Dt]))return 0;for(;0<wt[Dt];--wt[Dt]){if(st=new M,(ws&zt)!=Wt){for(Zt+=bs,Gt=1<<(Wt=Dt)-$e;15>Wt&&!(0>=(Gt-=wt[Wt]));)++Wt,Gt<<=1;Vt+=bs=1<<(Gt=Wt-$e),Oe[qe+(Wt=ws&zt)].g=Gt+$e,Oe[qe+Wt].value=Zt-qe-Wt}st.g=Dt-$e,st.value=Lt[Bt++],q(Oe,Zt+(ws>>$e),jt,bs,st),ws=H(ws,Dt)}}return gs!=2*_t[15]-1?0:Vt})(F,K,ie,fe,Se,Pe)}function M(){this.value=this.g=0}function z(){this.value=this.g=0}function I(){this.G=l(5,M),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(ua,z)}function G(F,K,ie,fe){s(F!=null),s(K!=null),s(2147483648>fe),F.Ca=254,F.I=0,F.b=-8,F.Ka=0,F.oa=K,F.pa=ie,F.Jd=K,F.Yc=ie+fe,F.Zc=4<=fe?ie+fe-4+1:ie,X(F)}function Y(F,K){for(var ie=0;0<K--;)ie|=te(F,128)<<K;return ie}function J(F,K){var ie=Y(F,K);return ne(F)?-ie:ie}function T(F,K,ie,fe){var Se,Pe=0;for(s(F!=null),s(K!=null),s(4294967288>fe),F.Sb=fe,F.Ra=0,F.u=0,F.h=0,4<fe&&(fe=4),Se=0;Se<fe;++Se)Pe+=K[ie+Se]<<8*Se;F.Ra=Pe,F.bb=fe,F.oa=K,F.pa=ie}function k(F){for(;8<=F.u&&F.bb<F.Sb;)F.Ra>>>=8,F.Ra+=F.oa[F.pa+F.bb]<<fd-8>>>0,++F.bb,F.u-=8;w(F)&&(F.h=1,F.u=0)}function D(F,K){if(s(0<=K),!F.h&&K<=md){var ie=E(F)&hd[K];return F.u+=K,k(F),ie}return F.h=1,F.u=0}function Q(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function C(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function E(F){return F.Ra>>>(F.u&fd-1)>>>0}function w(F){return s(F.bb<=F.Sb),F.h||F.bb==F.Sb&&F.u>fd}function O(F,K){F.u=K,F.h=w(F)}function R(F){F.u>=pd&&(s(F.u>=pd),k(F))}function X(F){s(F!=null&&F.oa!=null),F.pa<F.Zc?(F.I=(F.oa[F.pa++]|F.I<<8)>>>0,F.b+=8):(s(F!=null&&F.oa!=null),F.pa<F.Yc?(F.b+=8,F.I=F.oa[F.pa++]|F.I<<8):F.Ka?F.b=0:(F.I<<=8,F.b+=8,F.Ka=1))}function ne(F){return Y(F,1)}function te(F,K){var ie=F.Ca;0>F.b&&X(F);var fe=F.b,Se=ie*K>>>8,Pe=(F.I>>>fe>Se)+0;for(Pe?(ie-=Se,F.I-=Se+1<<fe>>>0):ie=Se+1,fe=ie,Se=0;256<=fe;)Se+=8,fe>>=8;return fe=7^Se+Sn[fe],F.b-=fe,F.Ca=(ie<<fe)-1,Pe}function oe(F,K,ie){F[K+0]=ie>>24&255,F[K+1]=ie>>16&255,F[K+2]=ie>>8&255,F[K+3]=ie>>0&255}function ce(F,K){return F[K+0]<<0|F[K+1]<<8}function re(F,K){return ce(F,K)|F[K+2]<<16}function de(F,K){return ce(F,K)|ce(F,K+2)<<16}function Ie(F,K){var ie=1<<K;return s(F!=null),s(0<K),F.X=i(ie),F.X==null?0:(F.Mb=32-K,F.Xa=K,1)}function le(F,K){s(F!=null),s(K!=null),s(F.Xa==K.Xa),a(K.X,0,F.X,0,1<<K.Xa)}function Z(){this.X=[],this.Xa=this.Mb=0}function ve(F,K,ie,fe){s(ie!=null),s(fe!=null);var Se=ie[0],Pe=fe[0];return Se==0&&(Se=(F*Pe+K/2)/K),Pe==0&&(Pe=(K*Se+F/2)/F),0>=Se||0>=Pe?0:(ie[0]=Se,fe[0]=Pe,1)}function Ue(F,K){return F+(1<<K)-1>>>K}function Be(F,K){return((4278255360&F)+(4278255360&K)>>>0&4278255360)+((16711935&F)+(16711935&K)>>>0&16711935)>>>0}function _e(F,K){U[K]=function(ie,fe,Se,Pe,Oe,qe,$e){var st;for(st=0;st<Oe;++st){var jt=U[F](qe[$e+st-1],Se,Pe+st);qe[$e+st]=Be(ie[fe+st],jt)}}}function Me(){this.ud=this.hd=this.jd=0}function Ye(F,K){return((4278124286&(F^K))>>>1)+(F&K)>>>0}function ot(F){return 0<=F&&256>F?F:0>F?0:255<F?255:void 0}function Ke(F,K){return ot(F+(F-K+.5>>1))}function ct(F,K,ie){return Math.abs(K-ie)-Math.abs(F-ie)}function xt(F,K,ie,fe,Se,Pe,Oe){for(fe=Pe[Oe-1],ie=0;ie<Se;++ie)Pe[Oe+ie]=fe=Be(F[K+ie],fe)}function be(F,K,ie,fe,Se){var Pe;for(Pe=0;Pe<ie;++Pe){var Oe=F[K+Pe],qe=Oe>>8&255,$e=16711935&($e=($e=16711935&Oe)+((qe<<16)+qe));fe[Se+Pe]=(4278255360&Oe)+$e>>>0}}function Ce(F,K){K.jd=F>>0&255,K.hd=F>>8&255,K.ud=F>>16&255}function Te(F,K,ie,fe,Se,Pe){var Oe;for(Oe=0;Oe<fe;++Oe){var qe=K[ie+Oe],$e=qe>>>8,st=qe,jt=255&(jt=(jt=qe>>>16)+((F.jd<<24>>24)*($e<<24>>24)>>>5));st=255&(st=(st=st+((F.hd<<24>>24)*($e<<24>>24)>>>5))+((F.ud<<24>>24)*(jt<<24>>24)>>>5)),Se[Pe+Oe]=(4278255360&qe)+(jt<<16)+st}}function ue(F,K,ie,fe,Se){U[K]=function(Pe,Oe,qe,$e,st,jt,Lt,Dt,Bt){for($e=Lt;$e<Dt;++$e)for(Lt=0;Lt<Bt;++Lt)st[jt++]=Se(qe[fe(Pe[Oe++])])},U[F]=function(Pe,Oe,qe,$e,st,jt,Lt){var Dt=8>>Pe.b,Bt=Pe.Ea,Zt=Pe.K[0],Vt=Pe.w;if(8>Dt)for(Pe=(1<<Pe.b)-1,Vt=(1<<Dt)-1;Oe<qe;++Oe){var wt,_t=0;for(wt=0;wt<Bt;++wt)wt&Pe||(_t=fe($e[st++])),jt[Lt++]=Se(Zt[_t&Vt]),_t>>=Dt}else U["VP8LMapColor"+ie]($e,st,Zt,Vt,jt,Lt,Oe,qe,Bt)}}function ge(F,K,ie,fe,Se){for(ie=K+ie;K<ie;){var Pe=F[K++];fe[Se++]=Pe>>16&255,fe[Se++]=Pe>>8&255,fe[Se++]=Pe>>0&255}}function Ve(F,K,ie,fe,Se){for(ie=K+ie;K<ie;){var Pe=F[K++];fe[Se++]=Pe>>16&255,fe[Se++]=Pe>>8&255,fe[Se++]=Pe>>0&255,fe[Se++]=Pe>>24&255}}function tt(F,K,ie,fe,Se){for(ie=K+ie;K<ie;){var Pe=(Oe=F[K++])>>16&240|Oe>>12&15,Oe=Oe>>0&240|Oe>>28&15;fe[Se++]=Pe,fe[Se++]=Oe}}function Ze(F,K,ie,fe,Se){for(ie=K+ie;K<ie;){var Pe=(Oe=F[K++])>>16&248|Oe>>13&7,Oe=Oe>>5&224|Oe>>3&31;fe[Se++]=Pe,fe[Se++]=Oe}}function ht(F,K,ie,fe,Se){for(ie=K+ie;K<ie;){var Pe=F[K++];fe[Se++]=Pe>>0&255,fe[Se++]=Pe>>8&255,fe[Se++]=Pe>>16&255}}function ze(F,K,ie,fe,Se,Pe){if(Pe==0)for(ie=K+ie;K<ie;)oe(fe,((Pe=F[K++])[0]>>24|Pe[1]>>8&65280|Pe[2]<<8&16711680|Pe[3]<<24)>>>0),Se+=32;else a(fe,Se,F,K,ie)}function Fe(F,K){U[K][0]=U[F+"0"],U[K][1]=U[F+"1"],U[K][2]=U[F+"2"],U[K][3]=U[F+"3"],U[K][4]=U[F+"4"],U[K][5]=U[F+"5"],U[K][6]=U[F+"6"],U[K][7]=U[F+"7"],U[K][8]=U[F+"8"],U[K][9]=U[F+"9"],U[K][10]=U[F+"10"],U[K][11]=U[F+"11"],U[K][12]=U[F+"12"],U[K][13]=U[F+"13"],U[K][14]=U[F+"0"],U[K][15]=U[F+"0"]}function xe(F){return F==jd||F==Sc||F==Fu||F==Tu}function we(){this.eb=[],this.size=this.A=this.fb=0}function Xe(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ut(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new we,this.f.kb=new Xe,this.sd=null}function ft(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function pt(F){return alert("todo:WebPSamplerProcessPlane"),F.T}function vt(F,K){var ie=F.T,fe=K.ba.f.RGBA,Se=fe.eb,Pe=fe.fb+F.ka*fe.A,Oe=$n[K.ba.S],qe=F.y,$e=F.O,st=F.f,jt=F.N,Lt=F.ea,Dt=F.W,Bt=K.cc,Zt=K.dc,Vt=K.Mc,wt=K.Nc,_t=F.ka,Gt=F.ka+F.T,Wt=F.U,zt=Wt+1>>1;for(_t==0?Oe(qe,$e,null,null,st,jt,Lt,Dt,st,jt,Lt,Dt,Se,Pe,null,null,Wt):(Oe(K.ec,K.fc,qe,$e,Bt,Zt,Vt,wt,st,jt,Lt,Dt,Se,Pe-fe.A,Se,Pe,Wt),++ie);_t+2<Gt;_t+=2)Bt=st,Zt=jt,Vt=Lt,wt=Dt,jt+=F.Rc,Dt+=F.Rc,Pe+=2*fe.A,Oe(qe,($e+=2*F.fa)-F.fa,qe,$e,Bt,Zt,Vt,wt,st,jt,Lt,Dt,Se,Pe-fe.A,Se,Pe,Wt);return $e+=F.fa,F.j+Gt<F.o?(a(K.ec,K.fc,qe,$e,Wt),a(K.cc,K.dc,st,jt,zt),a(K.Mc,K.Nc,Lt,Dt,zt),ie--):1&Gt||Oe(qe,$e,null,null,st,jt,Lt,Dt,st,jt,Lt,Dt,Se,Pe+fe.A,null,null,Wt),ie}function Ot(F,K,ie){var fe=F.F,Se=[F.J];if(fe!=null){var Pe=F.U,Oe=K.ba.S,qe=Oe==Eu||Oe==Fu;K=K.ba.f.RGBA;var $e=[0],st=F.ka;$e[0]=F.T,F.Kb&&(st==0?--$e[0]:(--st,Se[0]-=F.width),F.j+F.ka+F.T==F.o&&($e[0]=F.o-F.j-st));var jt=K.eb;st=K.fb+st*K.A,F=kr(fe,Se[0],F.width,Pe,$e,jt,st+(qe?0:3),K.A),s(ie==$e),F&&xe(Oe)&&qn(jt,st,qe,Pe,$e,K.A)}return 0}function Ae(F){var K=F.ma,ie=K.ba.S,fe=11>ie,Se=ie==Wo||ie==Bu||ie==Eu||ie==Rr||ie==12||xe(ie);if(K.memory=null,K.Ib=null,K.Jb=null,K.Nd=null,!ud(K.Oa,F,Se?11:12))return 0;if(Se&&xe(ie)&&ls(),F.da)alert("todo:use_scaling");else{if(fe){if(K.Ib=pt,F.Kb){if(ie=F.U+1>>1,K.memory=i(F.U+2*ie),K.memory==null)return 0;K.ec=K.memory,K.fc=0,K.cc=K.ec,K.dc=K.fc+F.U,K.Mc=K.cc,K.Nc=K.dc+ie,K.Ib=vt,ls()}}else alert("todo:EmitYUV");Se&&(K.Jb=Ot,fe&&Tt())}if(fe&&!rn){for(F=0;256>F;++F)Wn[F]=89858*(F-128)+rl>>co,Gn[F]=-22014*(F-128)+rl,Sd[F]=-45773*(F-128),Ec[F]=113618*(F-128)+rl>>co;for(F=Br;F<Fr;++F)K=76283*(F-16)+rl>>co,DA[F-Br]=vi(K,255),Zf[F-Br]=vi(K+8>>4,15);rn=1}return 1}function je(F){var K=F.ma,ie=F.U,fe=F.T;return s(!(1&F.ka)),0>=ie||0>=fe?0:(ie=K.Ib(F,K),K.Jb!=null&&K.Jb(F,K,ie),K.Dc+=ie,1)}function We(F){F.ma.memory=null}function De(F,K,ie,fe){return D(F,8)!=47?0:(K[0]=D(F,14)+1,ie[0]=D(F,14)+1,fe[0]=D(F,1),D(F,3)!=0?0:!F.h)}function lt(F,K){if(4>F)return F+1;var ie=F-2>>1;return(2+(1&F)<<ie)+D(K,ie)+1}function rt(F,K){return 120<K?K-120:1<=(ie=((ie=Ag[K-1])>>4)*F+(8-(15&ie)))?ie:1;var ie}function et(F,K,ie){var fe=E(ie),Se=F[K+=255&fe].g-8;return 0<Se&&(O(ie,ie.u+8),fe=E(ie),K+=F[K].value,K+=fe&(1<<Se)-1),O(ie,ie.u+F[K].g),F[K].value}function Qt(F,K,ie){return ie.g+=F.g,ie.value+=F.value<<K>>>0,s(8>=ie.g),F.g}function Qe(F,K,ie){var fe=F.xc;return s((K=fe==0?0:F.vc[F.md*(ie>>fe)+(K>>fe)])<F.Wb),F.Ya[K]}function he(F,K,ie,fe){var Se=F.ab,Pe=F.c*K,Oe=F.C;K=Oe+K;var qe=ie,$e=fe;for(fe=F.Ta,ie=F.Ua;0<Se--;){var st=F.gc[Se],jt=Oe,Lt=K,Dt=qe,Bt=$e,Zt=($e=fe,qe=ie,st.Ea);switch(s(jt<Lt),s(Lt<=st.nc),st.hc){case 2:EA(Dt,Bt,(Lt-jt)*Zt,$e,qe);break;case 0:var Vt=jt,wt=Lt,_t=$e,Gt=qe,Wt=(bs=st).Ea;Vt==0&&(bc(Dt,Bt,null,null,1,_t,Gt),xt(Dt,Bt+1,0,0,Wt-1,_t,Gt+1),Bt+=Wt,Gt+=Wt,++Vt);for(var zt=1<<bs.b,ws=zt-1,gs=Ue(Wt,bs.b),Us=bs.K,bs=bs.w+(Vt>>bs.b)*gs;Vt<wt;){var fr=Us,pr=bs,Ar=1;for(to(Dt,Bt,_t,Gt-Wt,1,_t,Gt);Ar<Wt;){var tr=(Ar&~ws)+zt;tr>Wt&&(tr=Wt),(0,Nl[fr[pr++]>>8&15])(Dt,Bt+ +Ar,_t,Gt+Ar-Wt,tr-Ar,_t,Gt+Ar),Ar=tr}Bt+=Wt,Gt+=Wt,++Vt&ws||(bs+=gs)}Lt!=st.nc&&a($e,qe-Zt,$e,qe+(Lt-jt-1)*Zt,Zt);break;case 1:for(Zt=Dt,wt=Bt,Wt=(Dt=st.Ea)-(Gt=Dt&~(_t=(Bt=1<<st.b)-1)),Vt=Ue(Dt,st.b),zt=st.K,st=st.w+(jt>>st.b)*Vt;jt<Lt;){for(ws=zt,gs=st,Us=new Me,bs=wt+Gt,fr=wt+Dt;wt<bs;)Ce(ws[gs++],Us),qo(Us,Zt,wt,Bt,$e,qe),wt+=Bt,qe+=Bt;wt<fr&&(Ce(ws[gs++],Us),qo(Us,Zt,wt,Wt,$e,qe),wt+=Wt,qe+=Wt),++jt&_t||(st+=Vt)}break;case 3:if(Dt==$e&&Bt==qe&&0<st.b){for(wt=$e,Dt=Zt=qe+(Lt-jt)*Zt-(Gt=(Lt-jt)*Ue(st.Ea,st.b)),Bt=$e,_t=qe,Vt=[],Gt=(Wt=Gt)-1;0<=Gt;--Gt)Vt[Gt]=Bt[_t+Gt];for(Gt=Wt-1;0<=Gt;--Gt)wt[Dt+Gt]=Vt[Gt];Cn(st,jt,Lt,$e,Zt,$e,qe)}else Cn(st,jt,Lt,Dt,Bt,$e,qe)}qe=fe,$e=ie}$e!=ie&&a(fe,ie,qe,$e,Pe)}function pe(F,K){var ie=F.V,fe=F.Ba+F.c*F.C,Se=K-F.C;if(s(K<=F.l.o),s(16>=Se),0<Se){var Pe=F.l,Oe=F.Ta,qe=F.Ua,$e=Pe.width;if(he(F,Se,ie,fe),Se=qe=[qe],s((ie=F.C)<(fe=K)),s(Pe.v<Pe.va),fe>Pe.o&&(fe=Pe.o),ie<Pe.j){var st=Pe.j-ie;ie=Pe.j,Se[0]+=st*$e}if(ie>=fe?ie=0:(Se[0]+=4*Pe.v,Pe.ka=ie-Pe.j,Pe.U=Pe.va-Pe.v,Pe.T=fe-ie,ie=1),ie){if(qe=qe[0],11>(ie=F.ca).S){var jt=ie.f.RGBA,Lt=(fe=ie.S,Se=Pe.U,Pe=Pe.T,st=jt.eb,jt.A),Dt=Pe;for(jt=jt.fb+F.Ma*jt.A;0<Dt--;){var Bt=Oe,Zt=qe,Vt=Se,wt=st,_t=jt;switch(fe){case FA:kn(Bt,Zt,Vt,wt,_t);break;case Wo:mn(Bt,Zt,Vt,wt,_t);break;case jd:mn(Bt,Zt,Vt,wt,_t),qn(wt,_t,0,Vt,1,0);break;case Kf:ro(Bt,Zt,Vt,wt,_t);break;case Bu:ze(Bt,Zt,Vt,wt,_t,1);break;case Sc:ze(Bt,Zt,Vt,wt,_t,1),qn(wt,_t,0,Vt,1,0);break;case Eu:ze(Bt,Zt,Vt,wt,_t,0);break;case Fu:ze(Bt,Zt,Vt,wt,_t,0),qn(wt,_t,1,Vt,1,0);break;case Rr:Vo(Bt,Zt,Vt,wt,_t);break;case Tu:Vo(Bt,Zt,Vt,wt,_t),Pr(wt,_t,Vt,1,0);break;case TA:so(Bt,Zt,Vt,wt,_t);break;default:s(0)}qe+=$e,jt+=Lt}F.Ma+=Pe}else alert("todo:EmitRescaledRowsYUVA");s(F.Ma<=ie.height)}}F.C=K,s(F.C<=F.i)}function ye(F){var K;if(0<F.ua)return 0;for(K=0;K<F.Wb;++K){var ie=F.Ya[K].G,fe=F.Ya[K].H;if(0<ie[1][fe[1]+0].g||0<ie[2][fe[2]+0].g||0<ie[3][fe[3]+0].g)return 0}return 1}function Ne(F,K,ie,fe,Se,Pe){if(F.Z!=0){var Oe=F.qd,qe=F.rd;for(s(pn[F.Z]!=null);K<ie;++K)pn[F.Z](Oe,qe,fe,Se,fe,Se,Pe),Oe=fe,qe=Se,Se+=Pe;F.qd=Oe,F.rd=qe}}function He(F,K){var ie=F.l.ma,fe=ie.Z==0||ie.Z==1?F.l.j:F.C;if(fe=F.C<fe?fe:F.C,s(K<=F.l.o),K>fe){var Se=F.l.width,Pe=ie.ca,Oe=ie.tb+Se*fe,qe=F.V,$e=F.Ba+F.c*fe,st=F.gc;s(F.ab==1),s(st[0].hc==3),Su(st[0],fe,K,qe,$e,Pe,Oe),Ne(ie,fe,K,Pe,Oe,Se)}F.C=F.Ma=K}function Ge(F,K,ie,fe,Se,Pe,Oe){var qe=F.$/fe,$e=F.$%fe,st=F.m,jt=F.s,Lt=ie+F.$,Dt=Lt;Se=ie+fe*Se;var Bt=ie+fe*Pe,Zt=280+jt.ua,Vt=F.Pb?qe:16777216,wt=0<jt.ua?jt.Wa:null,_t=jt.wc,Gt=Lt<Bt?Qe(jt,$e,qe):null;s(F.C<Pe),s(Bt<=Se);var Wt=!1;e:for(;;){for(;Wt||Lt<Bt;){var zt=0;if(qe>=Vt){var ws=Lt-ie;s((Vt=F).Pb),Vt.wd=Vt.m,Vt.xd=ws,0<Vt.s.ua&&le(Vt.s.Wa,Vt.s.vb),Vt=qe+LA}if($e&_t||(Gt=Qe(jt,$e,qe)),s(Gt!=null),Gt.Qb&&(K[Lt]=Gt.qb,Wt=!0),!Wt)if(R(st),Gt.jc){zt=st,ws=K;var gs=Lt,Us=Gt.pd[E(zt)&ua-1];s(Gt.jc),256>Us.g?(O(zt,zt.u+Us.g),ws[gs]=Us.value,zt=0):(O(zt,zt.u+Us.g-256),s(256<=Us.value),zt=Us.value),zt==0&&(Wt=!0)}else zt=et(Gt.G[0],Gt.H[0],st);if(st.h)break;if(Wt||256>zt){if(!Wt)if(Gt.nd)K[Lt]=(Gt.qb|zt<<8)>>>0;else{if(R(st),Wt=et(Gt.G[1],Gt.H[1],st),R(st),ws=et(Gt.G[2],Gt.H[2],st),gs=et(Gt.G[3],Gt.H[3],st),st.h)break;K[Lt]=(gs<<24|Wt<<16|zt<<8|ws)>>>0}if(Wt=!1,++Lt,++$e>=fe&&($e=0,++qe,Oe!=null&&qe<=Pe&&!(qe%16)&&Oe(F,qe),wt!=null))for(;Dt<Lt;)zt=K[Dt++],wt.X[(506832829*zt&4294967295)>>>wt.Mb]=zt}else if(280>zt){if(zt=lt(zt-256,st),ws=et(Gt.G[4],Gt.H[4],st),R(st),ws=rt(fe,ws=lt(ws,st)),st.h)break;if(Lt-ie<ws||Se-Lt<zt)break e;for(gs=0;gs<zt;++gs)K[Lt+gs]=K[Lt+gs-ws];for(Lt+=zt,$e+=zt;$e>=fe;)$e-=fe,++qe,Oe!=null&&qe<=Pe&&!(qe%16)&&Oe(F,qe);if(s(Lt<=Se),$e&_t&&(Gt=Qe(jt,$e,qe)),wt!=null)for(;Dt<Lt;)zt=K[Dt++],wt.X[(506832829*zt&4294967295)>>>wt.Mb]=zt}else{if(!(zt<Zt))break e;for(Wt=zt-280,s(wt!=null);Dt<Lt;)zt=K[Dt++],wt.X[(506832829*zt&4294967295)>>>wt.Mb]=zt;zt=Lt,s(!(Wt>>>(ws=wt).Xa)),K[zt]=ws.X[Wt],Wt=!0}Wt||s(st.h==w(st))}if(F.Pb&&st.h&&Lt<Se)s(F.m.h),F.a=5,F.m=F.wd,F.$=F.xd,0<F.s.ua&&le(F.s.vb,F.s.Wa);else{if(st.h)break e;Oe!=null&&Oe(F,qe>Pe?Pe:qe),F.a=0,F.$=Lt-ie}return 1}return F.a=3,0}function gt(F){s(F!=null),F.vc=null,F.yc=null,F.Ya=null;var K=F.Wa;K!=null&&(K.X=null),F.vb=null,s(F!=null)}function kt(){var F=new Yh;return F==null?null:(F.a=0,F.xb=wd,Fe("Predictor","VP8LPredictors"),Fe("Predictor","VP8LPredictors_C"),Fe("PredictorAdd","VP8LPredictorsAdd"),Fe("PredictorAdd","VP8LPredictorsAdd_C"),EA=be,qo=Te,kn=ge,mn=Ve,Vo=tt,so=Ze,ro=ht,U.VP8LMapColor32b=xd,U.VP8LMapColor8b=gd,F)}function yt(F,K,ie,fe,Se){var Pe=1,Oe=[F],qe=[K],$e=fe.m,st=fe.s,jt=null,Lt=0;e:for(;;){if(ie)for(;Pe&&D($e,1);){var Dt=Oe,Bt=qe,Zt=fe,Vt=1,wt=Zt.m,_t=Zt.gc[Zt.ab],Gt=D(wt,2);if(Zt.Oc&1<<Gt)Pe=0;else{switch(Zt.Oc|=1<<Gt,_t.hc=Gt,_t.Ea=Dt[0],_t.nc=Bt[0],_t.K=[null],++Zt.ab,s(4>=Zt.ab),Gt){case 0:case 1:_t.b=D(wt,3)+2,Vt=yt(Ue(_t.Ea,_t.b),Ue(_t.nc,_t.b),0,Zt,_t.K),_t.K=_t.K[0];break;case 3:var Wt,zt=D(wt,8)+1,ws=16<zt?0:4<zt?1:2<zt?2:3;if(Dt[0]=Ue(_t.Ea,ws),_t.b=ws,Wt=Vt=yt(zt,1,0,Zt,_t.K)){var gs,Us=zt,bs=_t,fr=1<<(8>>bs.b),pr=i(fr);if(pr==null)Wt=0;else{var Ar=bs.K[0],tr=bs.w;for(pr[0]=bs.K[0][0],gs=1;gs<1*Us;++gs)pr[gs]=Be(Ar[tr+gs],pr[gs-1]);for(;gs<4*fr;++gs)pr[gs]=0;bs.K[0]=null,bs.K[0]=pr,Wt=1}}Vt=Wt;break;case 2:break;default:s(0)}Pe=Vt}}if(Oe=Oe[0],qe=qe[0],Pe&&D($e,1)&&!(Pe=1<=(Lt=D($e,4))&&11>=Lt)){fe.a=3;break e}var Er;if(Er=Pe)t:{var Tr,Ws,sa,Fn=fe,fa=Oe,Ia=qe,wr=Lt,xn=ie,gn=Fn.m,ra=Fn.s,La=[null],an=1,Kn=0,Ri=Yf[wr];s:for(;;){if(xn&&D(gn,1)){var aa=D(gn,3)+2,Na=Ue(fa,aa),ji=Ue(Ia,aa),zo=Na*ji;if(!yt(Na,ji,0,Fn,La))break s;for(La=La[0],ra.xc=aa,Tr=0;Tr<zo;++Tr){var Ao=La[Tr]>>8&65535;La[Tr]=Ao,Ao>=an&&(an=Ao+1)}}if(gn.h)break s;for(Ws=0;5>Ws;++Ws){var _r=Cc[Ws];!Ws&&0<wr&&(_r+=1<<wr),Kn<_r&&(Kn=_r)}var kl=l(an*Ri,M),UA=an,sm=l(UA,I);if(sm==null)var Oi=null;else s(65536>=UA),Oi=sm;var Qi=i(Kn);if(Oi==null||Qi==null||kl==null){Fn.a=1;break s}var Tc=kl;for(Tr=sa=0;Tr<an;++Tr){var Mi=Oi[Tr],ho=Mi.G,Ic=Mi.H,Cd=0,Ni=1,kd=0;for(Ws=0;5>Ws;++Ws){_r=Cc[Ws],ho[Ws]=Tc,Ic[Ws]=sa,!Ws&&0<wr&&(_r+=1<<wr);a:{var Yo,mo=_r,Bd=Fn,Bl=Qi,tp=Tc,rm=sa,Kr=0,al=Bd.m,am=D(al,1);if(n(Bl,0,0,mo),am){var nm=D(al,1)+1,PA=D(al,1),RA=D(al,PA==0?1:8);Bl[RA]=1,nm==2&&(Bl[RA=D(al,8)]=1);var El=1}else{var Xr=i(19),wa=D(al,4)+4;if(19<wa){Bd.a=3;var pa=0;break a}for(Yo=0;Yo<wa;++Yo)Xr[ug[Yo]]=D(al,3);var Ed=void 0,fo=void 0,Fd=Bd,xg=Xr,Da=mo,OA=Bl,Pu=0,Fl=Fd.m,nl=8,wi=l(128,M);r:for(;V(wi,0,7,xg,19);){if(D(Fl,1)){var Ru=2+2*D(Fl,3);if((Ed=2+D(Fl,Ru))>Da)break r}else Ed=Da;for(fo=0;fo<Da&&Ed--;){R(Fl);var QA=wi[0+(127&E(Fl))];O(Fl,Fl.u+QA.g);var Xo=QA.value;if(16>Xo)OA[fo++]=Xo,Xo!=0&&(nl=Xo);else{var sp=Xo==16,im=Xo-16,rp=IA[im],lm=D(Fl,Iu[im])+rp;if(fo+lm>Da)break r;for(var ap=sp?nl:0;0<lm--;)OA[fo++]=ap}}Pu=1;break r}Pu||(Fd.a=3),El=Pu}(El=El&&!al.h)&&(Kr=V(tp,rm,8,Bl,mo)),El&&Kr!=0?pa=Kr:(Bd.a=3,pa=0)}if(pa==0)break s;if(Ni&&zf[Ws]==1&&(Ni=Tc[sa].g==0),Cd+=Tc[sa].g,sa+=pa,3>=Ws){var Td,MA=Qi[0];for(Td=1;Td<_r;++Td)Qi[Td]>MA&&(MA=Qi[Td]);kd+=MA}}if(Mi.nd=Ni,Mi.Qb=0,Ni&&(Mi.qb=(ho[3][Ic[3]+0].value<<24|ho[1][Ic[1]+0].value<<16|ho[2][Ic[2]+0].value)>>>0,Cd==0&&256>ho[0][Ic[0]+0].value&&(Mi.Qb=1,Mi.qb+=ho[0][Ic[0]+0].value<<8)),Mi.jc=!Mi.Qb&&6>kd,Mi.jc){var Ou,_i=Mi;for(Ou=0;Ou<ua;++Ou){var po=Ou,il=_i.pd[po],Lc=_i.G[0][_i.H[0]+po];256<=Lc.value?(il.g=Lc.g+256,il.value=Lc.value):(il.g=0,il.value=0,po>>=Qt(Lc,8,il),po>>=Qt(_i.G[1][_i.H[1]+po],16,il),po>>=Qt(_i.G[2][_i.H[2]+po],0,il),Qt(_i.G[3][_i.H[3]+po],24,il))}}}ra.vc=La,ra.Wb=an,ra.Ya=Oi,ra.yc=kl,Er=1;break t}Er=0}if(!(Pe=Er)){fe.a=3;break e}if(0<Lt){if(st.ua=1<<Lt,!Ie(st.Wa,Lt)){fe.a=1,Pe=0;break e}}else st.ua=0;var HA=fe,qA=Oe,np=qe,VA=HA.s,$A=VA.xc;if(HA.c=qA,HA.i=np,VA.md=Ue(qA,$A),VA.wc=$A==0?-1:(1<<$A)-1,ie){fe.xb=Cl;break e}if((jt=i(Oe*qe))==null){fe.a=1,Pe=0;break e}Pe=(Pe=Ge(fe,jt,0,Oe,qe,qe,null))&&!$e.h;break e}return Pe?(Se!=null?Se[0]=jt:(s(jt==null),s(ie)),fe.$=0,ie||gt(st)):gt(st),Pe}function Et(F,K){var ie=F.c*F.i,fe=ie+K+16*K;return s(F.c<=K),F.V=i(fe),F.V==null?(F.Ta=null,F.Ua=0,F.a=1,0):(F.Ta=F.V,F.Ua=F.Ba+ie+K,1)}function Ft(F,K){var ie=F.C,fe=K-ie,Se=F.V,Pe=F.Ba+F.c*ie;for(s(K<=F.l.o);0<fe;){var Oe=16<fe?16:fe,qe=F.l.ma,$e=F.l.width,st=$e*Oe,jt=qe.ca,Lt=qe.tb+$e*ie,Dt=F.Ta,Bt=F.Ua;he(F,Oe,Se,Pe),Aa(Dt,Bt,jt,Lt,st),Ne(qe,ie,ie+Oe,jt,Lt,$e),fe-=Oe,Se+=Oe*F.c,ie+=Oe}s(ie==K),F.C=F.Ma=K}function Yt(){this.ub=this.yd=this.td=this.Rb=0}function rs(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function As(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function es(){this.Yb=(function(){var F=[];return(function K(ie,fe,Se){for(var Pe=Se[fe],Oe=0;Oe<Pe&&(ie.push(Se.length>fe+1?[]:0),!(Se.length<fe+1));Oe++)K(ie[Oe],fe+1,Se)})(F,0,[3,11]),F})()}function Jt(){this.jb=i(3),this.Wc=o([4,8],es),this.Xc=o([4,17],es)}function Ps(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Os(){this.ld=this.La=this.dd=this.tc=0}function lr(){this.Na=this.la=0}function zs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ba(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function dn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Os),this.Y=0,this.ya=Array(new ba),this.aa=0,this.l=new Wr}function Ea(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Lr(){this.cb=this.a=0,this.sc="",this.m=new Q,this.Od=new Yt,this.Kc=new rs,this.ed=new Ps,this.Qa=new As,this.Ic=this.$c=this.Aa=0,this.D=new dn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,Q),this.ia=0,this.pb=l(4,zs),this.Pa=new Jt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ea),this.Hd=0,this.rb=Array(new lr),this.sb=0,this.wa=Array(new Os),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ba),this.L=this.aa=0,this.gd=o([4,2],Os),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Wr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function mr(){var F=new Lr;return F!=null&&(F.a=0,F.sc="OK",F.cb=0,F.Xb=0,kc||(kc=zl)),F}function Dr(F,K,ie){return F.a==0&&(F.a=K,F.sc=ie,F.cb=0),0}function vl(F,K,ie){return 3<=ie&&F[K+0]==157&&F[K+1]==1&&F[K+2]==42}function Po(F,K){if(F==null)return 0;if(F.a=0,F.sc="OK",K==null)return Dr(F,2,"null VP8Io passed to VP8GetHeaders()");var ie=K.data,fe=K.w,Se=K.ha;if(4>Se)return Dr(F,7,"Truncated header.");var Pe=ie[fe+0]|ie[fe+1]<<8|ie[fe+2]<<16,Oe=F.Od;if(Oe.Rb=!(1&Pe),Oe.td=Pe>>1&7,Oe.yd=Pe>>4&1,Oe.ub=Pe>>5,3<Oe.td)return Dr(F,3,"Incorrect keyframe parameters.");if(!Oe.yd)return Dr(F,4,"Frame not displayable.");fe+=3,Se-=3;var qe=F.Kc;if(Oe.Rb){if(7>Se)return Dr(F,7,"cannot parse picture header");if(!vl(ie,fe,Se))return Dr(F,3,"Bad code word");qe.c=16383&(ie[fe+4]<<8|ie[fe+3]),qe.Td=ie[fe+4]>>6,qe.i=16383&(ie[fe+6]<<8|ie[fe+5]),qe.Ud=ie[fe+6]>>6,fe+=7,Se-=7,F.za=qe.c+15>>4,F.Ub=qe.i+15>>4,K.width=qe.c,K.height=qe.i,K.Da=0,K.j=0,K.v=0,K.va=K.width,K.o=K.height,K.da=0,K.ib=K.width,K.hb=K.height,K.U=K.width,K.T=K.height,n((Pe=F.Pa).jb,0,255,Pe.jb.length),s((Pe=F.Qa)!=null),Pe.Cb=0,Pe.Bb=0,Pe.Fb=1,n(Pe.Zb,0,0,Pe.Zb.length),n(Pe.Lb,0,0,Pe.Lb)}if(Oe.ub>Se)return Dr(F,7,"bad partition length");G(Pe=F.m,ie,fe,Oe.ub),fe+=Oe.ub,Se-=Oe.ub,Oe.Rb&&(qe.Ld=ne(Pe),qe.Kd=ne(Pe)),qe=F.Qa;var $e,st=F.Pa;if(s(Pe!=null),s(qe!=null),qe.Cb=ne(Pe),qe.Cb){if(qe.Bb=ne(Pe),ne(Pe)){for(qe.Fb=ne(Pe),$e=0;4>$e;++$e)qe.Zb[$e]=ne(Pe)?J(Pe,7):0;for($e=0;4>$e;++$e)qe.Lb[$e]=ne(Pe)?J(Pe,6):0}if(qe.Bb)for($e=0;3>$e;++$e)st.jb[$e]=ne(Pe)?Y(Pe,8):255}else qe.Bb=0;if(Pe.Ka)return Dr(F,3,"cannot parse segment header");if((qe=F.ed).zd=ne(Pe),qe.Tb=Y(Pe,6),qe.wb=Y(Pe,3),qe.Pc=ne(Pe),qe.Pc&&ne(Pe)){for(st=0;4>st;++st)ne(Pe)&&(qe.vd[st]=J(Pe,6));for(st=0;4>st;++st)ne(Pe)&&(qe.od[st]=J(Pe,6))}if(F.L=qe.Tb==0?0:qe.zd?1:2,Pe.Ka)return Dr(F,3,"cannot parse filter header");var jt=Se;if(Se=$e=fe,fe=$e+jt,qe=jt,F.Xb=(1<<Y(F.m,2))-1,jt<3*(st=F.Xb))ie=7;else{for($e+=3*st,qe-=3*st,jt=0;jt<st;++jt){var Lt=ie[Se+0]|ie[Se+1]<<8|ie[Se+2]<<16;Lt>qe&&(Lt=qe),G(F.Jc[+jt],ie,$e,Lt),$e+=Lt,qe-=Lt,Se+=3}G(F.Jc[+st],ie,$e,qe),ie=$e<fe?0:5}if(ie!=0)return Dr(F,ie,"cannot parse partitions");for(ie=Y($e=F.m,7),Se=ne($e)?J($e,4):0,fe=ne($e)?J($e,4):0,qe=ne($e)?J($e,4):0,st=ne($e)?J($e,4):0,$e=ne($e)?J($e,4):0,jt=F.Qa,Lt=0;4>Lt;++Lt){if(jt.Cb){var Dt=jt.Zb[Lt];jt.Fb||(Dt+=ie)}else{if(0<Lt){F.pb[Lt]=F.pb[0];continue}Dt=ie}var Bt=F.pb[Lt];Bt.Sc[0]=Nd[vi(Dt+Se,127)],Bt.Sc[1]=Lu[vi(Dt+0,127)],Bt.Eb[0]=2*Nd[vi(Dt+fe,127)],Bt.Eb[1]=101581*Lu[vi(Dt+qe,127)]>>16,8>Bt.Eb[1]&&(Bt.Eb[1]=8),Bt.Qc[0]=Nd[vi(Dt+st,117)],Bt.Qc[1]=Lu[vi(Dt+$e,127)],Bt.lc=Dt+$e}if(!Oe.Rb)return Dr(F,4,"Not a key frame.");for(ne(Pe),Oe=F.Pa,ie=0;4>ie;++ie){for(Se=0;8>Se;++Se)for(fe=0;3>fe;++fe)for(qe=0;11>qe;++qe)st=te(Pe,mg[ie][Se][fe][qe])?Y(Pe,8):Jf[ie][Se][fe][qe],Oe.Wc[ie][Se].Yb[fe][qe]=st;for(Se=0;17>Se;++Se)Oe.Xc[ie][Se]=Oe.Wc[ie][Zh[Se]]}return F.kc=ne(Pe),F.kc&&(F.Bd=Y(Pe,8)),F.cb=1}function zl(F,K,ie,fe,Se,Pe,Oe){var qe=K[Se].Yb[ie];for(ie=0;16>Se;++Se){if(!te(F,qe[ie+0]))return Se;for(;!te(F,qe[ie+1]);)if(qe=K[++Se].Yb[0],ie=0,Se==16)return 16;var $e=K[Se+1].Yb;if(te(F,qe[ie+2])){var st=F,jt=0;if(te(st,(Dt=qe)[(Lt=ie)+3]))if(te(st,Dt[Lt+6])){for(qe=0,Lt=2*(jt=te(st,Dt[Lt+8]))+(Dt=te(st,Dt[Lt+9+jt])),jt=0,Dt=Xh[Lt];Dt[qe];++qe)jt+=jt+te(st,Dt[qe]);jt+=3+(8<<Lt)}else te(st,Dt[Lt+7])?(jt=7+2*te(st,165),jt+=te(st,145)):jt=5+te(st,159);else jt=te(st,Dt[Lt+4])?3+te(st,Dt[Lt+5]):2;qe=$e[2]}else jt=1,qe=$e[1];$e=Oe+Jh[Se],0>(st=F).b&&X(st);var Lt,Dt=st.b,Bt=(Lt=st.Ca>>1)-(st.I>>Dt)>>31;--st.b,st.Ca+=Bt,st.Ca|=1,st.I-=(Lt+1&Bt)<<Dt,Pe[$e]=((jt^Bt)-Bt)*fe[(0<Se)+0]}return 16}function fi(F){var K=F.rb[F.sb-1];K.la=0,K.Na=0,n(F.zc,0,0,F.zc.length),F.ja=0}function pi(F,K){if(F==null)return 0;if(K==null)return Dr(F,2,"NULL VP8Io parameter in VP8Decode().");if(!F.cb&&!Po(F,K))return 0;if(s(F.cb),K.ac==null||K.ac(K)){K.ob&&(F.L=0);var ie=Fc[F.L];if(F.L==2?(F.yb=0,F.zb=0):(F.yb=K.v-ie>>4,F.zb=K.j-ie>>4,0>F.yb&&(F.yb=0),0>F.zb&&(F.zb=0)),F.Va=K.o+15+ie>>4,F.Hb=K.va+15+ie>>4,F.Hb>F.za&&(F.Hb=F.za),F.Va>F.Ub&&(F.Va=F.Ub),0<F.L){var fe=F.ed;for(ie=0;4>ie;++ie){var Se;if(F.Qa.Cb){var Pe=F.Qa.Lb[ie];F.Qa.Fb||(Pe+=fe.Tb)}else Pe=fe.Tb;for(Se=0;1>=Se;++Se){var Oe=F.gd[ie][Se],qe=Pe;if(fe.Pc&&(qe+=fe.vd[0],Se&&(qe+=fe.od[0])),0<(qe=0>qe?0:63<qe?63:qe)){var $e=qe;0<fe.wb&&($e=4<fe.wb?$e>>2:$e>>1)>9-fe.wb&&($e=9-fe.wb),1>$e&&($e=1),Oe.dd=$e,Oe.tc=2*qe+$e,Oe.ld=40<=qe?2:15<=qe?1:0}else Oe.tc=0;Oe.La=Se}}}ie=0}else Dr(F,6,"Frame setup failed"),ie=F.a;if(ie=ie==0){if(ie){F.$c=0,0<F.Aa||(F.Ic=uo);e:{ie=F.Ic,fe=4*($e=F.za);var st=32*$e,jt=$e+1,Lt=0<F.L?$e*(0<F.Aa?2:1):0,Dt=(F.Aa==2?2:1)*$e;if((Oe=fe+832+(Se=3*(16*ie+Fc[F.L])/2*st)+(Pe=F.Fa!=null&&0<F.Fa.length?F.Kc.c*F.Kc.i:0))!=Oe)ie=0;else{if(Oe>F.Vb){if(F.Vb=0,F.Ec=i(Oe),F.Fc=0,F.Ec==null){ie=Dr(F,1,"no memory during frame initialization.");break e}F.Vb=Oe}Oe=F.Ec,qe=F.Fc,F.Ac=Oe,F.Bc=qe,qe+=fe,F.Gd=l(st,Ea),F.Hd=0,F.rb=l(jt+1,lr),F.sb=1,F.wa=Lt?l(Lt,Os):null,F.Y=0,F.D.Nb=0,F.D.wa=F.wa,F.D.Y=F.Y,0<F.Aa&&(F.D.Y+=$e),s(!0),F.oc=Oe,F.pc=qe,qe+=832,F.ya=l(Dt,ba),F.aa=0,F.D.ya=F.ya,F.D.aa=F.aa,F.Aa==2&&(F.D.aa+=$e),F.R=16*$e,F.B=8*$e,$e=(st=Fc[F.L])*F.R,st=st/2*F.B,F.sa=Oe,F.ta=qe+$e,F.qa=F.sa,F.ra=F.ta+16*ie*F.R+st,F.Ha=F.qa,F.Ia=F.ra+8*ie*F.B+st,F.$c=0,qe+=Se,F.mb=Pe?Oe:null,F.nb=Pe?qe:null,s(qe+Pe<=F.Fc+F.Vb),fi(F),n(F.Ac,F.Bc,0,fe),ie=1}}if(ie){if(K.ka=0,K.y=F.sa,K.O=F.ta,K.f=F.qa,K.N=F.ra,K.ea=F.Ha,K.Vd=F.Ia,K.fa=F.R,K.Rc=F.B,K.F=null,K.J=0,!ku){for(ie=-255;255>=ie;++ie)ja[255+ie]=0>ie?-ie:ie;for(ie=-1020;1020>=ie;++ie)_l[1020+ie]=-128>ie?-128:127<ie?127:ie;for(ie=-112;112>=ie;++ie)bd[112+ie]=-16>ie?-16:15<ie?15:ie;for(ie=-255;510>=ie;++ie)_c[255+ie]=0>ie?0:255<ie?255:ie;ku=1}vd=or,ao=mc,no=bl,fn=yu,bi=Ga,vr=Nr,yc=id,Cu=Ta,jc=pc,Nc=ju,wc=Ro,yi=Oo,io=xc,wl=ld,lo=An,oo=Mn,$o=Li,sn=kA,Pi[0]=Xt,Pi[1]=Qn,Pi[2]=Ht,Pi[3]=ts,Pi[4]=hs,Pi[5]=ns,Pi[6]=Ns,Pi[7]=ss,Pi[8]=fs,Pi[9]=vs,En[0]=at,En[1]=fc,En[2]=xi,En[3]=yl,En[4]=dt,En[5]=St,En[6]=Ut,Vn[0]=er,Vn[1]=Zl,Vn[2]=gr,Vn[3]=Ka,Vn[4]=sr,Vn[5]=ea,Vn[6]=za,ie=1}else ie=0}ie&&(ie=(function(Bt,Zt){for(Bt.M=0;Bt.M<Bt.Va;++Bt.M){var Vt,wt=Bt.Jc[Bt.M&Bt.Xb],_t=Bt.m,Gt=Bt;for(Vt=0;Vt<Gt.za;++Vt){var Wt=_t,zt=Gt,ws=zt.Ac,gs=zt.Bc+4*Vt,Us=zt.zc,bs=zt.ya[zt.aa+Vt];if(zt.Qa.Bb?bs.$b=te(Wt,zt.Pa.jb[0])?2+te(Wt,zt.Pa.jb[2]):te(Wt,zt.Pa.jb[1]):bs.$b=0,zt.kc&&(bs.Ad=te(Wt,zt.Bd)),bs.Za=!te(Wt,145)+0,bs.Za){var fr=bs.Ob,pr=0;for(zt=0;4>zt;++zt){var Ar,tr=Us[0+zt];for(Ar=0;4>Ar;++Ar){tr=hg[ws[gs+Ar]][tr];for(var Er=Xf[te(Wt,tr[0])];0<Er;)Er=Xf[2*Er+te(Wt,tr[Er])];tr=-Er,ws[gs+Ar]=tr}a(fr,pr,ws,gs,4),pr+=4,Us[0+zt]=tr}}else tr=te(Wt,156)?te(Wt,128)?1:3:te(Wt,163)?2:0,bs.Ob[0]=tr,n(ws,gs,tr,4),n(Us,0,tr,4);bs.Dd=te(Wt,142)?te(Wt,114)?te(Wt,183)?1:3:2:0}if(Gt.m.Ka)return Dr(Bt,7,"Premature end-of-partition0 encountered.");for(;Bt.ja<Bt.za;++Bt.ja){if(Gt=wt,Wt=(_t=Bt).rb[_t.sb-1],ws=_t.rb[_t.sb+_t.ja],Vt=_t.ya[_t.aa+_t.ja],gs=_t.kc?Vt.Ad:0)Wt.la=ws.la=0,Vt.Za||(Wt.Na=ws.Na=0),Vt.Hc=0,Vt.Gc=0,Vt.ia=0;else{var Tr,Ws;if(Wt=ws,ws=Gt,gs=_t.Pa.Xc,Us=_t.ya[_t.aa+_t.ja],bs=_t.pb[Us.$b],zt=Us.ad,fr=0,pr=_t.rb[_t.sb-1],tr=Ar=0,n(zt,fr,0,384),Us.Za)var sa=0,Fn=gs[3];else{Er=i(16);var fa=Wt.Na+pr.Na;if(fa=kc(ws,gs[1],fa,bs.Eb,0,Er,0),Wt.Na=pr.Na=(0<fa)+0,1<fa)vd(Er,0,zt,fr);else{var Ia=Er[0]+3>>3;for(Er=0;256>Er;Er+=16)zt[fr+Er]=Ia}sa=1,Fn=gs[0]}var wr=15&Wt.la,xn=15&pr.la;for(Er=0;4>Er;++Er){var gn=1&xn;for(Ia=Ws=0;4>Ia;++Ia)wr=wr>>1|(gn=(fa=kc(ws,Fn,fa=gn+(1&wr),bs.Sc,sa,zt,fr))>sa)<<7,Ws=Ws<<2|(3<fa?3:1<fa?2:zt[fr+0]!=0),fr+=16;wr>>=4,xn=xn>>1|gn<<7,Ar=(Ar<<8|Ws)>>>0}for(Fn=wr,sa=xn>>4,Tr=0;4>Tr;Tr+=2){for(Ws=0,wr=Wt.la>>4+Tr,xn=pr.la>>4+Tr,Er=0;2>Er;++Er){for(gn=1&xn,Ia=0;2>Ia;++Ia)fa=gn+(1&wr),wr=wr>>1|(gn=0<(fa=kc(ws,gs[2],fa,bs.Qc,0,zt,fr)))<<3,Ws=Ws<<2|(3<fa?3:1<fa?2:zt[fr+0]!=0),fr+=16;wr>>=2,xn=xn>>1|gn<<5}tr|=Ws<<4*Tr,Fn|=wr<<4<<Tr,sa|=(240&xn)<<Tr}Wt.la=Fn,pr.la=sa,Us.Hc=Ar,Us.Gc=tr,Us.ia=43690&tr?0:bs.ia,gs=!(Ar|tr)}if(0<_t.L&&(_t.wa[_t.Y+_t.ja]=_t.gd[Vt.$b][Vt.Za],_t.wa[_t.Y+_t.ja].La|=!gs),Gt.Ka)return Dr(Bt,7,"Premature end-of-file encountered.")}if(fi(Bt),_t=Zt,Gt=1,Vt=(wt=Bt).D,Wt=0<wt.L&&wt.M>=wt.zb&&wt.M<=wt.Va,wt.Aa==0)e:{if(Vt.M=wt.M,Vt.uc=Wt,dd(wt,Vt),Gt=1,Vt=(Ws=wt.D).Nb,Wt=(tr=Fc[wt.L])*wt.R,ws=tr/2*wt.B,Er=16*Vt*wt.R,Ia=8*Vt*wt.B,gs=wt.sa,Us=wt.ta-Wt+Er,bs=wt.qa,zt=wt.ra-ws+Ia,fr=wt.Ha,pr=wt.Ia-ws+Ia,xn=(wr=Ws.M)==0,Ar=wr>=wt.Va-1,wt.Aa==2&&dd(wt,Ws),Ws.uc)for(gn=(fa=wt).D.M,s(fa.D.uc),Ws=fa.yb;Ws<fa.Hb;++Ws){sa=Ws,Fn=gn;var ra=(La=(_r=fa).D).Nb;Tr=_r.R;var La=La.wa[La.Y+sa],an=_r.sa,Kn=_r.ta+16*ra*Tr+16*sa,Ri=La.dd,aa=La.tc;if(aa!=0)if(s(3<=aa),_r.L==1)0<sa&&oo(an,Kn,Tr,aa+4),La.La&&sn(an,Kn,Tr,aa),0<Fn&&lo(an,Kn,Tr,aa+4),La.La&&$o(an,Kn,Tr,aa);else{var Na=_r.B,ji=_r.qa,zo=_r.ra+8*ra*Na+8*sa,Ao=_r.Ha,_r=_r.Ia+8*ra*Na+8*sa;ra=La.ld,0<sa&&(Cu(an,Kn,Tr,aa+4,Ri,ra),Nc(ji,zo,Ao,_r,Na,aa+4,Ri,ra)),La.La&&(yi(an,Kn,Tr,aa,Ri,ra),wl(ji,zo,Ao,_r,Na,aa,Ri,ra)),0<Fn&&(yc(an,Kn,Tr,aa+4,Ri,ra),jc(ji,zo,Ao,_r,Na,aa+4,Ri,ra)),La.La&&(wc(an,Kn,Tr,aa,Ri,ra),io(ji,zo,Ao,_r,Na,aa,Ri,ra))}}if(wt.ia&&alert("todo:DitherRow"),_t.put!=null){if(Ws=16*wr,wr=16*(wr+1),xn?(_t.y=wt.sa,_t.O=wt.ta+Er,_t.f=wt.qa,_t.N=wt.ra+Ia,_t.ea=wt.Ha,_t.W=wt.Ia+Ia):(Ws-=tr,_t.y=gs,_t.O=Us,_t.f=bs,_t.N=zt,_t.ea=fr,_t.W=pr),Ar||(wr-=tr),wr>_t.o&&(wr=_t.o),_t.F=null,_t.J=null,wt.Fa!=null&&0<wt.Fa.length&&Ws<wr&&(_t.J=wu(wt,_t,Ws,wr-Ws),_t.F=wt.mb,_t.F==null&&_t.F.length==0)){Gt=Dr(wt,3,"Could not decode alpha data.");break e}Ws<_t.j&&(tr=_t.j-Ws,Ws=_t.j,s(!(1&tr)),_t.O+=wt.R*tr,_t.N+=wt.B*(tr>>1),_t.W+=wt.B*(tr>>1),_t.F!=null&&(_t.J+=_t.width*tr)),Ws<wr&&(_t.O+=_t.v,_t.N+=_t.v>>1,_t.W+=_t.v>>1,_t.F!=null&&(_t.J+=_t.v),_t.ka=Ws-_t.j,_t.U=_t.va-_t.v,_t.T=wr-Ws,Gt=_t.put(_t))}Vt+1!=wt.Ic||Ar||(a(wt.sa,wt.ta-Wt,gs,Us+16*wt.R,Wt),a(wt.qa,wt.ra-ws,bs,zt+8*wt.B,ws),a(wt.Ha,wt.Ia-ws,fr,pr+8*wt.B,ws))}if(!Gt)return Dr(Bt,6,"Output aborted.")}return 1})(F,K)),K.bc!=null&&K.bc(K),ie&=1}return ie?(F.cb=0,ie):0}function Wa(F,K,ie,fe,Se){Se=F[K+ie+32*fe]+(Se>>3),F[K+ie+32*fe]=-256&Se?0>Se?0:255:Se}function Yl(F,K,ie,fe,Se,Pe){Wa(F,K,0,ie,fe+Se),Wa(F,K,1,ie,fe+Pe),Wa(F,K,2,ie,fe-Pe),Wa(F,K,3,ie,fe-Se)}function Fa(F){return(20091*F>>16)+F}function Xl(F,K,ie,fe){var Se,Pe=0,Oe=i(16);for(Se=0;4>Se;++Se){var qe=F[K+0]+F[K+8],$e=F[K+0]-F[K+8],st=(35468*F[K+4]>>16)-Fa(F[K+12]),jt=Fa(F[K+4])+(35468*F[K+12]>>16);Oe[Pe+0]=qe+jt,Oe[Pe+1]=$e+st,Oe[Pe+2]=$e-st,Oe[Pe+3]=qe-jt,Pe+=4,K++}for(Se=Pe=0;4>Se;++Se)qe=(F=Oe[Pe+0]+4)+Oe[Pe+8],$e=F-Oe[Pe+8],st=(35468*Oe[Pe+4]>>16)-Fa(Oe[Pe+12]),Wa(ie,fe,0,0,qe+(jt=Fa(Oe[Pe+4])+(35468*Oe[Pe+12]>>16))),Wa(ie,fe,1,0,$e+st),Wa(ie,fe,2,0,$e-st),Wa(ie,fe,3,0,qe-jt),Pe++,fe+=32}function Nr(F,K,ie,fe){var Se=F[K+0]+4,Pe=35468*F[K+4]>>16,Oe=Fa(F[K+4]),qe=35468*F[K+1]>>16;Yl(ie,fe,0,Se+Oe,F=Fa(F[K+1]),qe),Yl(ie,fe,1,Se+Pe,F,qe),Yl(ie,fe,2,Se-Pe,F,qe),Yl(ie,fe,3,Se-Oe,F,qe)}function mc(F,K,ie,fe,Se){Xl(F,K,ie,fe),Se&&Xl(F,K+16,ie,fe+4)}function bl(F,K,ie,fe){ao(F,K+0,ie,fe,1),ao(F,K+32,ie,fe+128,1)}function yu(F,K,ie,fe){var Se;for(F=F[K+0]+4,Se=0;4>Se;++Se)for(K=0;4>K;++K)Wa(ie,fe,K,Se,F)}function Ga(F,K,ie,fe){F[K+0]&&fn(F,K+0,ie,fe),F[K+16]&&fn(F,K+16,ie,fe+4),F[K+32]&&fn(F,K+32,ie,fe+128),F[K+48]&&fn(F,K+48,ie,fe+128+4)}function or(F,K,ie,fe){var Se,Pe=i(16);for(Se=0;4>Se;++Se){var Oe=F[K+0+Se]+F[K+12+Se],qe=F[K+4+Se]+F[K+8+Se],$e=F[K+4+Se]-F[K+8+Se],st=F[K+0+Se]-F[K+12+Se];Pe[0+Se]=Oe+qe,Pe[8+Se]=Oe-qe,Pe[4+Se]=st+$e,Pe[12+Se]=st-$e}for(Se=0;4>Se;++Se)Oe=(F=Pe[0+4*Se]+3)+Pe[3+4*Se],qe=Pe[1+4*Se]+Pe[2+4*Se],$e=Pe[1+4*Se]-Pe[2+4*Se],st=F-Pe[3+4*Se],ie[fe+0]=Oe+qe>>3,ie[fe+16]=st+$e>>3,ie[fe+32]=Oe-qe>>3,ie[fe+48]=st-$e>>3,fe+=64}function Jl(F,K,ie){var fe,Se=K-32,Pe=Bn,Oe=255-F[Se-1];for(fe=0;fe<ie;++fe){var qe,$e=Pe,st=Oe+F[K-1];for(qe=0;qe<ie;++qe)F[K+qe]=$e[st+F[Se+qe]];K+=32}}function Qn(F,K){Jl(F,K,4)}function Zl(F,K){Jl(F,K,8)}function fc(F,K){Jl(F,K,16)}function xi(F,K){var ie;for(ie=0;16>ie;++ie)a(F,K+32*ie,F,K-32,16)}function yl(F,K){var ie;for(ie=16;0<ie;--ie)n(F,K,F[K-1],16),K+=32}function ke(F,K,ie){var fe;for(fe=0;16>fe;++fe)n(K,ie+32*fe,F,16)}function at(F,K){var ie,fe=16;for(ie=0;16>ie;++ie)fe+=F[K-1+32*ie]+F[K+ie-32];ke(fe>>5,F,K)}function dt(F,K){var ie,fe=8;for(ie=0;16>ie;++ie)fe+=F[K-1+32*ie];ke(fe>>4,F,K)}function St(F,K){var ie,fe=8;for(ie=0;16>ie;++ie)fe+=F[K+ie-32];ke(fe>>4,F,K)}function Ut(F,K){ke(128,F,K)}function It(F,K,ie){return F+2*K+ie+2>>2}function Ht(F,K){var ie,fe=K-32;for(fe=new Uint8Array([It(F[fe-1],F[fe+0],F[fe+1]),It(F[fe+0],F[fe+1],F[fe+2]),It(F[fe+1],F[fe+2],F[fe+3]),It(F[fe+2],F[fe+3],F[fe+4])]),ie=0;4>ie;++ie)a(F,K+32*ie,fe,0,fe.length)}function ts(F,K){var ie=F[K-1],fe=F[K-1+32],Se=F[K-1+64],Pe=F[K-1+96];oe(F,K+0,16843009*It(F[K-1-32],ie,fe)),oe(F,K+32,16843009*It(ie,fe,Se)),oe(F,K+64,16843009*It(fe,Se,Pe)),oe(F,K+96,16843009*It(Se,Pe,Pe))}function Xt(F,K){var ie,fe=4;for(ie=0;4>ie;++ie)fe+=F[K+ie-32]+F[K-1+32*ie];for(fe>>=3,ie=0;4>ie;++ie)n(F,K+32*ie,fe,4)}function hs(F,K){var ie=F[K-1+0],fe=F[K-1+32],Se=F[K-1+64],Pe=F[K-1-32],Oe=F[K+0-32],qe=F[K+1-32],$e=F[K+2-32],st=F[K+3-32];F[K+0+96]=It(fe,Se,F[K-1+96]),F[K+1+96]=F[K+0+64]=It(ie,fe,Se),F[K+2+96]=F[K+1+64]=F[K+0+32]=It(Pe,ie,fe),F[K+3+96]=F[K+2+64]=F[K+1+32]=F[K+0+0]=It(Oe,Pe,ie),F[K+3+64]=F[K+2+32]=F[K+1+0]=It(qe,Oe,Pe),F[K+3+32]=F[K+2+0]=It($e,qe,Oe),F[K+3+0]=It(st,$e,qe)}function Ns(F,K){var ie=F[K+1-32],fe=F[K+2-32],Se=F[K+3-32],Pe=F[K+4-32],Oe=F[K+5-32],qe=F[K+6-32],$e=F[K+7-32];F[K+0+0]=It(F[K+0-32],ie,fe),F[K+1+0]=F[K+0+32]=It(ie,fe,Se),F[K+2+0]=F[K+1+32]=F[K+0+64]=It(fe,Se,Pe),F[K+3+0]=F[K+2+32]=F[K+1+64]=F[K+0+96]=It(Se,Pe,Oe),F[K+3+32]=F[K+2+64]=F[K+1+96]=It(Pe,Oe,qe),F[K+3+64]=F[K+2+96]=It(Oe,qe,$e),F[K+3+96]=It(qe,$e,$e)}function ns(F,K){var ie=F[K-1+0],fe=F[K-1+32],Se=F[K-1+64],Pe=F[K-1-32],Oe=F[K+0-32],qe=F[K+1-32],$e=F[K+2-32],st=F[K+3-32];F[K+0+0]=F[K+1+64]=Pe+Oe+1>>1,F[K+1+0]=F[K+2+64]=Oe+qe+1>>1,F[K+2+0]=F[K+3+64]=qe+$e+1>>1,F[K+3+0]=$e+st+1>>1,F[K+0+96]=It(Se,fe,ie),F[K+0+64]=It(fe,ie,Pe),F[K+0+32]=F[K+1+96]=It(ie,Pe,Oe),F[K+1+32]=F[K+2+96]=It(Pe,Oe,qe),F[K+2+32]=F[K+3+96]=It(Oe,qe,$e),F[K+3+32]=It(qe,$e,st)}function ss(F,K){var ie=F[K+0-32],fe=F[K+1-32],Se=F[K+2-32],Pe=F[K+3-32],Oe=F[K+4-32],qe=F[K+5-32],$e=F[K+6-32],st=F[K+7-32];F[K+0+0]=ie+fe+1>>1,F[K+1+0]=F[K+0+64]=fe+Se+1>>1,F[K+2+0]=F[K+1+64]=Se+Pe+1>>1,F[K+3+0]=F[K+2+64]=Pe+Oe+1>>1,F[K+0+32]=It(ie,fe,Se),F[K+1+32]=F[K+0+96]=It(fe,Se,Pe),F[K+2+32]=F[K+1+96]=It(Se,Pe,Oe),F[K+3+32]=F[K+2+96]=It(Pe,Oe,qe),F[K+3+64]=It(Oe,qe,$e),F[K+3+96]=It(qe,$e,st)}function vs(F,K){var ie=F[K-1+0],fe=F[K-1+32],Se=F[K-1+64],Pe=F[K-1+96];F[K+0+0]=ie+fe+1>>1,F[K+2+0]=F[K+0+32]=fe+Se+1>>1,F[K+2+32]=F[K+0+64]=Se+Pe+1>>1,F[K+1+0]=It(ie,fe,Se),F[K+3+0]=F[K+1+32]=It(fe,Se,Pe),F[K+3+32]=F[K+1+64]=It(Se,Pe,Pe),F[K+3+64]=F[K+2+64]=F[K+0+96]=F[K+1+96]=F[K+2+96]=F[K+3+96]=Pe}function fs(F,K){var ie=F[K-1+0],fe=F[K-1+32],Se=F[K-1+64],Pe=F[K-1+96],Oe=F[K-1-32],qe=F[K+0-32],$e=F[K+1-32],st=F[K+2-32];F[K+0+0]=F[K+2+32]=ie+Oe+1>>1,F[K+0+32]=F[K+2+64]=fe+ie+1>>1,F[K+0+64]=F[K+2+96]=Se+fe+1>>1,F[K+0+96]=Pe+Se+1>>1,F[K+3+0]=It(qe,$e,st),F[K+2+0]=It(Oe,qe,$e),F[K+1+0]=F[K+3+32]=It(ie,Oe,qe),F[K+1+32]=F[K+3+64]=It(fe,ie,Oe),F[K+1+64]=F[K+3+96]=It(Se,fe,ie),F[K+1+96]=It(Pe,Se,fe)}function gr(F,K){var ie;for(ie=0;8>ie;++ie)a(F,K+32*ie,F,K-32,8)}function Ka(F,K){var ie;for(ie=0;8>ie;++ie)n(F,K,F[K-1],8),K+=32}function Ur(F,K,ie){var fe;for(fe=0;8>fe;++fe)n(K,ie+32*fe,F,8)}function er(F,K){var ie,fe=8;for(ie=0;8>ie;++ie)fe+=F[K+ie-32]+F[K-1+32*ie];Ur(fe>>4,F,K)}function ea(F,K){var ie,fe=4;for(ie=0;8>ie;++ie)fe+=F[K+ie-32];Ur(fe>>3,F,K)}function sr(F,K){var ie,fe=4;for(ie=0;8>ie;++ie)fe+=F[K-1+32*ie];Ur(fe>>3,F,K)}function za(F,K){Ur(128,F,K)}function un(F,K,ie){var fe=F[K-ie],Se=F[K+0],Pe=3*(Se-fe)+Sl[1020+F[K-2*ie]-F[K+ie]],Oe=yd[112+(Pe+4>>3)];F[K-ie]=Bn[255+fe+yd[112+(Pe+3>>3)]],F[K+0]=Bn[255+Se-Oe]}function gi(F,K,ie,fe){var Se=F[K+0],Pe=F[K+ie];return Ui[255+F[K-2*ie]-F[K-ie]]>fe||Ui[255+Pe-Se]>fe}function Ys(F,K,ie,fe){return 4*Ui[255+F[K-ie]-F[K+0]]+Ui[255+F[K-2*ie]-F[K+ie]]<=fe}function Gr(F,K,ie,fe,Se){var Pe=F[K-3*ie],Oe=F[K-2*ie],qe=F[K-ie],$e=F[K+0],st=F[K+ie],jt=F[K+2*ie],Lt=F[K+3*ie];return 4*Ui[255+qe-$e]+Ui[255+Oe-st]>fe?0:Ui[255+F[K-4*ie]-Pe]<=Se&&Ui[255+Pe-Oe]<=Se&&Ui[255+Oe-qe]<=Se&&Ui[255+Lt-jt]<=Se&&Ui[255+jt-st]<=Se&&Ui[255+st-$e]<=Se}function An(F,K,ie,fe){var Se=2*fe+1;for(fe=0;16>fe;++fe)Ys(F,K+fe,ie,Se)&&un(F,K+fe,ie)}function Mn(F,K,ie,fe){var Se=2*fe+1;for(fe=0;16>fe;++fe)Ys(F,K+fe*ie,1,Se)&&un(F,K+fe*ie,1)}function Li(F,K,ie,fe){var Se;for(Se=3;0<Se;--Se)An(F,K+=4*ie,ie,fe)}function kA(F,K,ie,fe){var Se;for(Se=3;0<Se;--Se)Mn(F,K+=4,ie,fe)}function tl(F,K,ie,fe,Se,Pe,Oe,qe){for(Pe=2*Pe+1;0<Se--;){if(Gr(F,K,ie,Pe,Oe))if(gi(F,K,ie,qe))un(F,K,ie);else{var $e=F,st=K,jt=ie,Lt=$e[st-2*jt],Dt=$e[st-jt],Bt=$e[st+0],Zt=$e[st+jt],Vt=$e[st+2*jt],wt=27*(Gt=Sl[1020+3*(Bt-Dt)+Sl[1020+Lt-Zt]])+63>>7,_t=18*Gt+63>>7,Gt=9*Gt+63>>7;$e[st-3*jt]=Bn[255+$e[st-3*jt]+Gt],$e[st-2*jt]=Bn[255+Lt+_t],$e[st-jt]=Bn[255+Dt+wt],$e[st+0]=Bn[255+Bt-wt],$e[st+jt]=Bn[255+Zt-_t],$e[st+2*jt]=Bn[255+Vt-Gt]}K+=fe}}function Hn(F,K,ie,fe,Se,Pe,Oe,qe){for(Pe=2*Pe+1;0<Se--;){if(Gr(F,K,ie,Pe,Oe))if(gi(F,K,ie,qe))un(F,K,ie);else{var $e=F,st=K,jt=ie,Lt=$e[st-jt],Dt=$e[st+0],Bt=$e[st+jt],Zt=yd[112+((Vt=3*(Dt-Lt))+4>>3)],Vt=yd[112+(Vt+3>>3)],wt=Zt+1>>1;$e[st-2*jt]=Bn[255+$e[st-2*jt]+wt],$e[st-jt]=Bn[255+Lt+Vt],$e[st+0]=Bn[255+Dt-Zt],$e[st+jt]=Bn[255+Bt-wt]}K+=fe}}function id(F,K,ie,fe,Se,Pe){tl(F,K,ie,1,16,fe,Se,Pe)}function Ta(F,K,ie,fe,Se,Pe){tl(F,K,1,ie,16,fe,Se,Pe)}function Ro(F,K,ie,fe,Se,Pe){var Oe;for(Oe=3;0<Oe;--Oe)Hn(F,K+=4*ie,ie,1,16,fe,Se,Pe)}function Oo(F,K,ie,fe,Se,Pe){var Oe;for(Oe=3;0<Oe;--Oe)Hn(F,K+=4,1,ie,16,fe,Se,Pe)}function pc(F,K,ie,fe,Se,Pe,Oe,qe){tl(F,K,Se,1,8,Pe,Oe,qe),tl(ie,fe,Se,1,8,Pe,Oe,qe)}function ju(F,K,ie,fe,Se,Pe,Oe,qe){tl(F,K,1,Se,8,Pe,Oe,qe),tl(ie,fe,1,Se,8,Pe,Oe,qe)}function xc(F,K,ie,fe,Se,Pe,Oe,qe){Hn(F,K+4*Se,Se,1,8,Pe,Oe,qe),Hn(ie,fe+4*Se,Se,1,8,Pe,Oe,qe)}function ld(F,K,ie,fe,Se,Pe,Oe,qe){Hn(F,K+4,1,Se,8,Pe,Oe,qe),Hn(ie,fe+4,1,Se,8,Pe,Oe,qe)}function jl(){this.ba=new ut,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Qo(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function od(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function BA(){this.ua=0,this.Wa=new Z,this.vb=new Z,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new I,this.yc=new M}function Yh(){this.xb=this.a=0,this.l=new Wr,this.ca=new ut,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new C,this.Pb=0,this.wd=new C,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new BA,this.ab=0,this.gc=l(4,od),this.Oc=0}function cd(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Wr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function eo(F,K,ie,fe,Se,Pe,Oe){for(F=F==null?0:F[K+0],K=0;K<Oe;++K)Se[Pe+K]=F+ie[fe+K]&255,F=Se[Pe+K]}function Nu(F,K,ie,fe,Se,Pe,Oe){var qe;if(F==null)eo(null,null,ie,fe,Se,Pe,Oe);else for(qe=0;qe<Oe;++qe)Se[Pe+qe]=F[K+qe]+ie[fe+qe]&255}function Mo(F,K,ie,fe,Se,Pe,Oe){if(F==null)eo(null,null,ie,fe,Se,Pe,Oe);else{var qe,$e=F[K+0],st=$e,jt=$e;for(qe=0;qe<Oe;++qe)st=jt+($e=F[K+qe])-st,jt=ie[fe+qe]+(-256&st?0>st?0:255:st)&255,st=$e,Se[Pe+qe]=jt}}function wu(F,K,ie,fe){var Se=K.width,Pe=K.o;if(s(F!=null&&K!=null),0>ie||0>=fe||ie+fe>Pe)return null;if(!F.Cc){if(F.ga==null){var Oe;if(F.ga=new cd,(Oe=F.ga==null)||(Oe=K.width*K.o,s(F.Gb.length==0),F.Gb=i(Oe),F.Uc=0,F.Gb==null?Oe=0:(F.mb=F.Gb,F.nb=F.Uc,F.rc=null,Oe=1),Oe=!Oe),!Oe){Oe=F.ga;var qe=F.Fa,$e=F.P,st=F.qc,jt=F.mb,Lt=F.nb,Dt=$e+1,Bt=st-1,Zt=Oe.l;if(s(qe!=null&&jt!=null&&K!=null),pn[0]=null,pn[1]=eo,pn[2]=Nu,pn[3]=Mo,Oe.ca=jt,Oe.tb=Lt,Oe.c=K.width,Oe.i=K.height,s(0<Oe.c&&0<Oe.i),1>=st)K=0;else if(Oe.$a=qe[$e+0]>>0&3,Oe.Z=qe[$e+0]>>2&3,Oe.Lc=qe[$e+0]>>4&3,$e=qe[$e+0]>>6&3,0>Oe.$a||1<Oe.$a||4<=Oe.Z||1<Oe.Lc||$e)K=0;else if(Zt.put=je,Zt.ac=Ae,Zt.bc=We,Zt.ma=Oe,Zt.width=K.width,Zt.height=K.height,Zt.Da=K.Da,Zt.v=K.v,Zt.va=K.va,Zt.j=K.j,Zt.o=K.o,Oe.$a)e:{s(Oe.$a==1),K=kt();t:for(;;){if(K==null){K=0;break e}if(s(Oe!=null),Oe.mc=K,K.c=Oe.c,K.i=Oe.i,K.l=Oe.l,K.l.ma=Oe,K.l.width=Oe.c,K.l.height=Oe.i,K.a=0,T(K.m,qe,Dt,Bt),!yt(Oe.c,Oe.i,1,K,null)||(K.ab==1&&K.gc[0].hc==3&&ye(K.s)?(Oe.ic=1,qe=K.c*K.i,K.Ta=null,K.Ua=0,K.V=i(qe),K.Ba=0,K.V==null?(K.a=1,K=0):K=1):(Oe.ic=0,K=Et(K,Oe.c)),!K))break t;K=1;break e}Oe.mc=null,K=0}else K=Bt>=Oe.c*Oe.i;Oe=!K}if(Oe)return null;F.ga.Lc!=1?F.Ga=0:fe=Pe-ie}s(F.ga!=null),s(ie+fe<=Pe);e:{if(K=(qe=F.ga).c,Pe=qe.l.o,qe.$a==0){if(Dt=F.rc,Bt=F.Vc,Zt=F.Fa,$e=F.P+1+ie*K,st=F.mb,jt=F.nb+ie*K,s($e<=F.P+F.qc),qe.Z!=0)for(s(pn[qe.Z]!=null),Oe=0;Oe<fe;++Oe)pn[qe.Z](Dt,Bt,Zt,$e,st,jt,K),Dt=st,Bt=jt,jt+=K,$e+=K;else for(Oe=0;Oe<fe;++Oe)a(st,jt,Zt,$e,K),Dt=st,Bt=jt,jt+=K,$e+=K;F.rc=Dt,F.Vc=Bt}else{if(s(qe.mc!=null),K=ie+fe,s((Oe=qe.mc)!=null),s(K<=Oe.i),Oe.C>=K)K=1;else if(qe.ic||Tt(),qe.ic){qe=Oe.V,Dt=Oe.Ba,Bt=Oe.c;var Vt=Oe.i,wt=(Zt=1,$e=Oe.$/Bt,st=Oe.$%Bt,jt=Oe.m,Lt=Oe.s,Oe.$),_t=Bt*Vt,Gt=Bt*K,Wt=Lt.wc,zt=wt<Gt?Qe(Lt,st,$e):null;s(wt<=_t),s(K<=Vt),s(ye(Lt));t:for(;;){for(;!jt.h&&wt<Gt;){if(st&Wt||(zt=Qe(Lt,st,$e)),s(zt!=null),R(jt),256>(Vt=et(zt.G[0],zt.H[0],jt)))qe[Dt+wt]=Vt,++wt,++st>=Bt&&(st=0,++$e<=K&&!($e%16)&&He(Oe,$e));else{if(!(280>Vt)){Zt=0;break t}Vt=lt(Vt-256,jt);var ws,gs=et(zt.G[4],zt.H[4],jt);if(R(jt),!(wt>=(gs=rt(Bt,gs=lt(gs,jt)))&&_t-wt>=Vt)){Zt=0;break t}for(ws=0;ws<Vt;++ws)qe[Dt+wt+ws]=qe[Dt+wt+ws-gs];for(wt+=Vt,st+=Vt;st>=Bt;)st-=Bt,++$e<=K&&!($e%16)&&He(Oe,$e);wt<Gt&&st&Wt&&(zt=Qe(Lt,st,$e))}s(jt.h==w(jt))}He(Oe,$e>K?K:$e);break t}!Zt||jt.h&&wt<_t?(Zt=0,Oe.a=jt.h?5:3):Oe.$=wt,K=Zt}else K=Ge(Oe,Oe.V,Oe.Ba,Oe.c,Oe.i,K,Ft);if(!K){fe=0;break e}}ie+fe>=Pe&&(F.Cc=1),fe=1}if(!fe)return null;if(F.Cc&&((fe=F.ga)!=null&&(fe.mc=null),F.ga=null,0<F.Ga))return alert("todo:WebPDequantizeLevels"),null}return F.nb+ie*Se}function se(F,K,ie,fe,Se,Pe){for(;0<Se--;){var Oe,qe=F,$e=K+(ie?1:0),st=F,jt=K+(ie?0:3);for(Oe=0;Oe<fe;++Oe){var Lt=st[jt+4*Oe];Lt!=255&&(Lt*=32897,qe[$e+4*Oe+0]=qe[$e+4*Oe+0]*Lt>>23,qe[$e+4*Oe+1]=qe[$e+4*Oe+1]*Lt>>23,qe[$e+4*Oe+2]=qe[$e+4*Oe+2]*Lt>>23)}K+=Pe}}function Ee(F,K,ie,fe,Se){for(;0<fe--;){var Pe;for(Pe=0;Pe<ie;++Pe){var Oe=F[K+2*Pe+0],qe=15&(st=F[K+2*Pe+1]),$e=4369*qe,st=(240&st|st>>4)*$e>>16;F[K+2*Pe+0]=(240&Oe|Oe>>4)*$e>>16&240|(15&Oe|Oe<<4)*$e>>16>>4&15,F[K+2*Pe+1]=240&st|qe}K+=Se}}function it(F,K,ie,fe,Se,Pe,Oe,qe){var $e,st,jt=255;for(st=0;st<Se;++st){for($e=0;$e<fe;++$e){var Lt=F[K+$e];Pe[Oe+4*$e]=Lt,jt&=Lt}K+=ie,Oe+=qe}return jt!=255}function bt(F,K,ie,fe,Se){var Pe;for(Pe=0;Pe<Se;++Pe)ie[fe+Pe]=F[K+Pe]>>8}function Tt(){qn=se,Pr=Ee,kr=it,Aa=bt}function $t(F,K,ie){U[F]=function(fe,Se,Pe,Oe,qe,$e,st,jt,Lt,Dt,Bt,Zt,Vt,wt,_t,Gt,Wt){var zt,ws=Wt-1>>1,gs=qe[$e+0]|st[jt+0]<<16,Us=Lt[Dt+0]|Bt[Zt+0]<<16;s(fe!=null);var bs=3*gs+Us+131074>>2;for(K(fe[Se+0],255&bs,bs>>16,Vt,wt),Pe!=null&&(bs=3*Us+gs+131074>>2,K(Pe[Oe+0],255&bs,bs>>16,_t,Gt)),zt=1;zt<=ws;++zt){var fr=qe[$e+zt]|st[jt+zt]<<16,pr=Lt[Dt+zt]|Bt[Zt+zt]<<16,Ar=gs+fr+Us+pr+524296,tr=Ar+2*(fr+Us)>>3;bs=tr+gs>>1,gs=(Ar=Ar+2*(gs+pr)>>3)+fr>>1,K(fe[Se+2*zt-1],255&bs,bs>>16,Vt,wt+(2*zt-1)*ie),K(fe[Se+2*zt-0],255&gs,gs>>16,Vt,wt+(2*zt-0)*ie),Pe!=null&&(bs=Ar+Us>>1,gs=tr+pr>>1,K(Pe[Oe+2*zt-1],255&bs,bs>>16,_t,Gt+(2*zt-1)*ie),K(Pe[Oe+2*zt+0],255&gs,gs>>16,_t,Gt+(2*zt+0)*ie)),gs=fr,Us=pr}1&Wt||(bs=3*gs+Us+131074>>2,K(fe[Se+Wt-1],255&bs,bs>>16,Vt,wt+(Wt-1)*ie),Pe!=null&&(bs=3*Us+gs+131074>>2,K(Pe[Oe+Wt-1],255&bs,bs>>16,_t,Gt+(Wt-1)*ie)))}}function ls(){$n[FA]=fg,$n[Wo]=Go,$n[Kf]=pg,$n[Bu]=_d,$n[Eu]=Bc,$n[Rr]=Du,$n[TA]=em,$n[jd]=Go,$n[Sc]=_d,$n[Fu]=Bc,$n[Tu]=Du}function js(F){return F&-16384?0>F?0:255:F>>Ko}function Ds(F,K){return js((19077*F>>8)+(26149*K>>8)-14234)}function Js(F,K,ie){return js((19077*F>>8)-(6419*K>>8)-(13320*ie>>8)+8708)}function Xs(F,K){return js((19077*F>>8)+(33050*K>>8)-17685)}function ur(F,K,ie,fe,Se){fe[Se+0]=Ds(F,ie),fe[Se+1]=Js(F,K,ie),fe[Se+2]=Xs(F,K)}function ta(F,K,ie,fe,Se){fe[Se+0]=Xs(F,K),fe[Se+1]=Js(F,K,ie),fe[Se+2]=Ds(F,ie)}function da(F,K,ie,fe,Se){var Pe=Js(F,K,ie);K=Pe<<3&224|Xs(F,K)>>3,fe[Se+0]=248&Ds(F,ie)|Pe>>5,fe[Se+1]=K}function ya(F,K,ie,fe,Se){var Pe=240&Xs(F,K)|15;fe[Se+0]=240&Ds(F,ie)|Js(F,K,ie)>>4,fe[Se+1]=Pe}function hn(F,K,ie,fe,Se){fe[Se+0]=255,ur(F,K,ie,fe,Se+1)}function Ya(F,K,ie,fe,Se){ta(F,K,ie,fe,Se),fe[Se+3]=255}function sl(F,K,ie,fe,Se){ur(F,K,ie,fe,Se),fe[Se+3]=255}function vi(F,K){return 0>F?0:F>K?K:F}function Di(F,K,ie){U[F]=function(fe,Se,Pe,Oe,qe,$e,st,jt,Lt){for(var Dt=jt+(-2&Lt)*ie;jt!=Dt;)K(fe[Se+0],Pe[Oe+0],qe[$e+0],st,jt),K(fe[Se+1],Pe[Oe+0],qe[$e+0],st,jt+ie),Se+=2,++Oe,++$e,jt+=2*ie;1&Lt&&K(fe[Se+0],Pe[Oe+0],qe[$e+0],st,jt)}}function Ho(F,K,ie){return ie==0?F==0?K==0?6:5:K==0?4:0:ie}function _u(F,K,ie,fe,Se){switch(F>>>30){case 3:ao(K,ie,fe,Se,0);break;case 2:vr(K,ie,fe,Se);break;case 1:fn(K,ie,fe,Se)}}function dd(F,K){var ie,fe,Se=K.M,Pe=K.Nb,Oe=F.oc,qe=F.pc+40,$e=F.oc,st=F.pc+584,jt=F.oc,Lt=F.pc+600;for(ie=0;16>ie;++ie)Oe[qe+32*ie-1]=129;for(ie=0;8>ie;++ie)$e[st+32*ie-1]=129,jt[Lt+32*ie-1]=129;for(0<Se?Oe[qe-1-32]=$e[st-1-32]=jt[Lt-1-32]=129:(n(Oe,qe-32-1,127,21),n($e,st-32-1,127,9),n(jt,Lt-32-1,127,9)),fe=0;fe<F.za;++fe){var Dt=K.ya[K.aa+fe];if(0<fe){for(ie=-1;16>ie;++ie)a(Oe,qe+32*ie-4,Oe,qe+32*ie+12,4);for(ie=-1;8>ie;++ie)a($e,st+32*ie-4,$e,st+32*ie+4,4),a(jt,Lt+32*ie-4,jt,Lt+32*ie+4,4)}var Bt=F.Gd,Zt=F.Hd+fe,Vt=Dt.ad,wt=Dt.Hc;if(0<Se&&(a(Oe,qe-32,Bt[Zt].y,0,16),a($e,st-32,Bt[Zt].f,0,8),a(jt,Lt-32,Bt[Zt].ea,0,8)),Dt.Za){var _t=Oe,Gt=qe-32+16;for(0<Se&&(fe>=F.za-1?n(_t,Gt,Bt[Zt].y[15],4):a(_t,Gt,Bt[Zt+1].y,0,4)),ie=0;4>ie;ie++)_t[Gt+128+ie]=_t[Gt+256+ie]=_t[Gt+384+ie]=_t[Gt+0+ie];for(ie=0;16>ie;++ie,wt<<=2)_t=Oe,Gt=qe+tm[ie],Pi[Dt.Ob[ie]](_t,Gt),_u(wt,Vt,16*+ie,_t,Gt)}else if(_t=Ho(fe,Se,Dt.Ob[0]),En[_t](Oe,qe),wt!=0)for(ie=0;16>ie;++ie,wt<<=2)_u(wt,Vt,16*+ie,Oe,qe+tm[ie]);for(ie=Dt.Gc,_t=Ho(fe,Se,Dt.Dd),Vn[_t]($e,st),Vn[_t](jt,Lt),wt=Vt,_t=$e,Gt=st,255&(Dt=ie>>0)&&(170&Dt?no(wt,256,_t,Gt):bi(wt,256,_t,Gt)),Dt=jt,wt=Lt,255&(ie>>=8)&&(170&ie?no(Vt,320,Dt,wt):bi(Vt,320,Dt,wt)),Se<F.Ub-1&&(a(Bt[Zt].y,0,Oe,qe+480,16),a(Bt[Zt].f,0,$e,st+224,8),a(Bt[Zt].ea,0,jt,Lt+224,8)),ie=8*Pe*F.B,Bt=F.sa,Zt=F.ta+16*fe+16*Pe*F.R,Vt=F.qa,Dt=F.ra+8*fe+ie,wt=F.Ha,_t=F.Ia+8*fe+ie,ie=0;16>ie;++ie)a(Bt,Zt+ie*F.R,Oe,qe+32*ie,16);for(ie=0;8>ie;++ie)a(Vt,Dt+ie*F.B,$e,st+32*ie,8),a(wt,_t+ie*F.B,jt,Lt+32*ie,8)}}function gc(F,K,ie,fe,Se,Pe,Oe,qe,$e){var st=[0],jt=[0],Lt=0,Dt=$e!=null?$e.kd:0,Bt=$e??new Qo;if(F==null||12>ie)return 7;Bt.data=F,Bt.w=K,Bt.ha=ie,K=[K],ie=[ie],Bt.gb=[Bt.gb];e:{var Zt=K,Vt=ie,wt=Bt.gb;if(s(F!=null),s(Vt!=null),s(wt!=null),wt[0]=0,12<=Vt[0]&&!r(F,Zt[0],"RIFF")){if(r(F,Zt[0]+8,"WEBP")){wt=3;break e}var _t=de(F,Zt[0]+4);if(12>_t||4294967286<_t){wt=3;break e}if(Dt&&_t>Vt[0]-8){wt=7;break e}wt[0]=_t,Zt[0]+=12,Vt[0]-=12}wt=0}if(wt!=0)return wt;for(_t=0<Bt.gb[0],ie=ie[0];;){e:{var Gt=F;Vt=K,wt=ie;var Wt=st,zt=jt,ws=Zt=[0];if((bs=Lt=[Lt])[0]=0,8>wt[0])wt=7;else{if(!r(Gt,Vt[0],"VP8X")){if(de(Gt,Vt[0]+4)!=10){wt=3;break e}if(18>wt[0]){wt=7;break e}var gs=de(Gt,Vt[0]+8),Us=1+re(Gt,Vt[0]+12);if(2147483648<=Us*(Gt=1+re(Gt,Vt[0]+15))){wt=3;break e}ws!=null&&(ws[0]=gs),Wt!=null&&(Wt[0]=Us),zt!=null&&(zt[0]=Gt),Vt[0]+=18,wt[0]-=18,bs[0]=1}wt=0}}if(Lt=Lt[0],Zt=Zt[0],wt!=0)return wt;if(Vt=!!(2&Zt),!_t&&Lt)return 3;if(Pe!=null&&(Pe[0]=!!(16&Zt)),Oe!=null&&(Oe[0]=Vt),qe!=null&&(qe[0]=0),Oe=st[0],Zt=jt[0],Lt&&Vt&&$e==null){wt=0;break}if(4>ie){wt=7;break}if(_t&&Lt||!_t&&!Lt&&!r(F,K[0],"ALPH")){ie=[ie],Bt.na=[Bt.na],Bt.P=[Bt.P],Bt.Sa=[Bt.Sa];e:{gs=F,wt=K,_t=ie;var bs=Bt.gb;Wt=Bt.na,zt=Bt.P,ws=Bt.Sa,Us=22,s(gs!=null),s(_t!=null),Gt=wt[0];var fr=_t[0];for(s(Wt!=null),s(ws!=null),Wt[0]=null,zt[0]=null,ws[0]=0;;){if(wt[0]=Gt,_t[0]=fr,8>fr){wt=7;break e}var pr=de(gs,Gt+4);if(4294967286<pr){wt=3;break e}var Ar=8+pr+1&-2;if(Us+=Ar,0<bs&&Us>bs){wt=3;break e}if(!r(gs,Gt,"VP8 ")||!r(gs,Gt,"VP8L")){wt=0;break e}if(fr[0]<Ar){wt=7;break e}r(gs,Gt,"ALPH")||(Wt[0]=gs,zt[0]=Gt+8,ws[0]=pr),Gt+=Ar,fr-=Ar}}if(ie=ie[0],Bt.na=Bt.na[0],Bt.P=Bt.P[0],Bt.Sa=Bt.Sa[0],wt!=0)break}ie=[ie],Bt.Ja=[Bt.Ja],Bt.xa=[Bt.xa];e:if(bs=F,wt=K,_t=ie,Wt=Bt.gb[0],zt=Bt.Ja,ws=Bt.xa,gs=wt[0],Gt=!r(bs,gs,"VP8 "),Us=!r(bs,gs,"VP8L"),s(bs!=null),s(_t!=null),s(zt!=null),s(ws!=null),8>_t[0])wt=7;else{if(Gt||Us){if(bs=de(bs,gs+4),12<=Wt&&bs>Wt-12){wt=3;break e}if(Dt&&bs>_t[0]-8){wt=7;break e}zt[0]=bs,wt[0]+=8,_t[0]-=8,ws[0]=Us}else ws[0]=5<=_t[0]&&bs[gs+0]==47&&!(bs[gs+4]>>5),zt[0]=_t[0];wt=0}if(ie=ie[0],Bt.Ja=Bt.Ja[0],Bt.xa=Bt.xa[0],K=K[0],wt!=0)break;if(4294967286<Bt.Ja)return 3;if(qe==null||Vt||(qe[0]=Bt.xa?2:1),Oe=[Oe],Zt=[Zt],Bt.xa){if(5>ie){wt=7;break}qe=Oe,Dt=Zt,Vt=Pe,F==null||5>ie?F=0:5<=ie&&F[K+0]==47&&!(F[K+4]>>5)?(_t=[0],bs=[0],Wt=[0],T(zt=new C,F,K,ie),De(zt,_t,bs,Wt)?(qe!=null&&(qe[0]=_t[0]),Dt!=null&&(Dt[0]=bs[0]),Vt!=null&&(Vt[0]=Wt[0]),F=1):F=0):F=0}else{if(10>ie){wt=7;break}qe=Zt,F==null||10>ie||!vl(F,K+3,ie-3)?F=0:(Dt=F[K+0]|F[K+1]<<8|F[K+2]<<16,Vt=16383&(F[K+7]<<8|F[K+6]),F=16383&(F[K+9]<<8|F[K+8]),1&Dt||3<(Dt>>1&7)||!(Dt>>4&1)||Dt>>5>=Bt.Ja||!Vt||!F?F=0:(Oe&&(Oe[0]=Vt),qe&&(qe[0]=F),F=1))}if(!F||(Oe=Oe[0],Zt=Zt[0],Lt&&(st[0]!=Oe||jt[0]!=Zt)))return 3;$e!=null&&($e[0]=Bt,$e.offset=K-$e.w,s(4294967286>K-$e.w),s($e.offset==$e.ha-ie));break}return wt==0||wt==7&&Lt&&$e==null?(Pe!=null&&(Pe[0]|=Bt.na!=null&&0<Bt.na.length),fe!=null&&(fe[0]=Oe),Se!=null&&(Se[0]=Zt),0):wt}function ud(F,K,ie){var fe=K.width,Se=K.height,Pe=0,Oe=0,qe=fe,$e=Se;if(K.Da=F!=null&&0<F.Da,K.Da&&(qe=F.cd,$e=F.bd,Pe=F.v,Oe=F.j,11>ie||(Pe&=-2,Oe&=-2),0>Pe||0>Oe||0>=qe||0>=$e||Pe+qe>fe||Oe+$e>Se))return 0;if(K.v=Pe,K.j=Oe,K.va=Pe+qe,K.o=Oe+$e,K.U=qe,K.T=$e,K.da=F!=null&&0<F.da,K.da){if(!ve(qe,$e,ie=[F.ib],Pe=[F.hb]))return 0;K.ib=ie[0],K.hb=Pe[0]}return K.ob=F!=null&&F.ob,K.Kb=F==null||!F.Sd,K.da&&(K.ob=K.ib<3*fe/4&&K.hb<3*Se/4,K.Kb=0),1}function Ad(F){if(F==null)return 2;if(11>F.S){var K=F.f.RGBA;K.fb+=(F.height-1)*K.A,K.A=-K.A}else K=F.f.kb,F=F.height,K.O+=(F-1)*K.fa,K.fa=-K.fa,K.N+=(F-1>>1)*K.Ab,K.Ab=-K.Ab,K.W+=(F-1>>1)*K.Db,K.Db=-K.Db,K.F!=null&&(K.J+=(F-1)*K.lb,K.lb=-K.lb);return 0}function vc(F,K,ie,fe){if(fe==null||0>=F||0>=K)return 2;if(ie!=null){if(ie.Da){var Se=ie.cd,Pe=ie.bd,Oe=-2&ie.v,qe=-2&ie.j;if(0>Oe||0>qe||0>=Se||0>=Pe||Oe+Se>F||qe+Pe>K)return 2;F=Se,K=Pe}if(ie.da){if(!ve(F,K,Se=[ie.ib],Pe=[ie.hb]))return 2;F=Se[0],K=Pe[0]}}fe.width=F,fe.height=K;e:{var $e=fe.width,st=fe.height;if(F=fe.S,0>=$e||0>=st||!(F>=FA&&13>F))F=2;else{if(0>=fe.Rd&&fe.sd==null){Oe=Pe=Se=K=0;var jt=(qe=$e*Uu[F])*st;if(11>F||(Pe=(st+1)/2*(K=($e+1)/2),F==12&&(Oe=(Se=$e)*st)),(st=i(jt+2*Pe+Oe))==null){F=1;break e}fe.sd=st,11>F?(($e=fe.f.RGBA).eb=st,$e.fb=0,$e.A=qe,$e.size=jt):(($e=fe.f.kb).y=st,$e.O=0,$e.fa=qe,$e.Fd=jt,$e.f=st,$e.N=0+jt,$e.Ab=K,$e.Cd=Pe,$e.ea=st,$e.W=0+jt+Pe,$e.Db=K,$e.Ed=Pe,F==12&&($e.F=st,$e.J=0+jt+2*Pe),$e.Tc=Oe,$e.lb=Se)}if(K=1,Se=fe.S,Pe=fe.width,Oe=fe.height,Se>=FA&&13>Se)if(11>Se)F=fe.f.RGBA,K&=(qe=Math.abs(F.A))*(Oe-1)+Pe<=F.size,K&=qe>=Pe*Uu[Se],K&=F.eb!=null;else{F=fe.f.kb,qe=(Pe+1)/2,jt=(Oe+1)/2,$e=Math.abs(F.fa),st=Math.abs(F.Ab);var Lt=Math.abs(F.Db),Dt=Math.abs(F.lb),Bt=Dt*(Oe-1)+Pe;K&=$e*(Oe-1)+Pe<=F.Fd,K&=st*(jt-1)+qe<=F.Cd,K=(K&=Lt*(jt-1)+qe<=F.Ed)&$e>=Pe&st>=qe&Lt>=qe,K&=F.y!=null,K&=F.f!=null,K&=F.ea!=null,Se==12&&(K&=Dt>=Pe,K&=Bt<=F.Tc,K&=F.F!=null)}else K=0;F=K?0:2}}return F!=0||ie!=null&&ie.fd&&(F=Ad(fe)),F}var ua=64,hd=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],md=24,fd=32,pd=8,Sn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),U.Predictor0=function(){return 4278190080},U.Predictor1=function(F){return F},U.Predictor2=function(F,K,ie){return K[ie+0]},U.Predictor3=function(F,K,ie){return K[ie+1]},U.Predictor4=function(F,K,ie){return K[ie-1]},U.Predictor5=function(F,K,ie){return Ye(Ye(F,K[ie+1]),K[ie+0])},U.Predictor6=function(F,K,ie){return Ye(F,K[ie-1])},U.Predictor7=function(F,K,ie){return Ye(F,K[ie+0])},U.Predictor8=function(F,K,ie){return Ye(K[ie-1],K[ie+0])},U.Predictor9=function(F,K,ie){return Ye(K[ie+0],K[ie+1])},U.Predictor10=function(F,K,ie){return Ye(Ye(F,K[ie-1]),Ye(K[ie+0],K[ie+1]))},U.Predictor11=function(F,K,ie){var fe=K[ie+0];return 0>=ct(fe>>24&255,F>>24&255,(K=K[ie-1])>>24&255)+ct(fe>>16&255,F>>16&255,K>>16&255)+ct(fe>>8&255,F>>8&255,K>>8&255)+ct(255&fe,255&F,255&K)?fe:F},U.Predictor12=function(F,K,ie){var fe=K[ie+0];return(ot((F>>24&255)+(fe>>24&255)-((K=K[ie-1])>>24&255))<<24|ot((F>>16&255)+(fe>>16&255)-(K>>16&255))<<16|ot((F>>8&255)+(fe>>8&255)-(K>>8&255))<<8|ot((255&F)+(255&fe)-(255&K)))>>>0},U.Predictor13=function(F,K,ie){var fe=K[ie-1];return(Ke((F=Ye(F,K[ie+0]))>>24&255,fe>>24&255)<<24|Ke(F>>16&255,fe>>16&255)<<16|Ke(F>>8&255,fe>>8&255)<<8|Ke(F>>0&255,fe>>0&255))>>>0};var bc=U.PredictorAdd0;U.PredictorAdd1=xt,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var to=U.PredictorAdd2;ue("ColorIndexInverseTransform","MapARGB","32b",(function(F){return F>>8&255}),(function(F){return F})),ue("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",(function(F){return F}),(function(F){return F>>8&255}));var EA,Cn=U.ColorIndexInverseTransform,xd=U.MapARGB,Su=U.VP8LColorIndexInverseTransformAlpha,gd=U.MapAlpha,Nl=U.VP8LPredictorsAdd=[];Nl.length=16,(U.VP8LPredictors=[]).length=16,(U.VP8LPredictorsAdd_C=[]).length=16,(U.VP8LPredictors_C=[]).length=16;var qo,kn,mn,Vo,so,ro,vd,ao,vr,no,fn,bi,yc,Cu,jc,Nc,wc,yi,io,wl,lo,oo,$o,sn,qn,Pr,kr,Aa,ja=i(511),_l=i(2041),bd=i(225),_c=i(767),ku=0,Sl=_l,yd=bd,Bn=_c,Ui=ja,FA=0,Wo=1,Kf=2,Bu=3,Eu=4,Rr=5,TA=6,jd=7,Sc=8,Fu=9,Tu=10,Iu=[2,3,7],IA=[3,3,11],Cc=[280,256,256,256,40],zf=[0,1,1,1,0],ug=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Ag=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Yf=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],LA=8,Nd=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Lu=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],kc=null,Xh=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Jh=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Xf=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Jf=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],hg=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],mg=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Zh=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],En=[],Pi=[],Vn=[],Cl=1,wd=2,pn=[],$n=[];$t("UpsampleRgbLinePair",ur,3),$t("UpsampleBgrLinePair",ta,3),$t("UpsampleRgbaLinePair",sl,4),$t("UpsampleBgraLinePair",Ya,4),$t("UpsampleArgbLinePair",hn,4),$t("UpsampleRgba4444LinePair",ya,2),$t("UpsampleRgb565LinePair",da,2);var fg=U.UpsampleRgbLinePair,pg=U.UpsampleBgrLinePair,Go=U.UpsampleRgbaLinePair,_d=U.UpsampleBgraLinePair,Bc=U.UpsampleArgbLinePair,Du=U.UpsampleRgba4444LinePair,em=U.UpsampleRgb565LinePair,co=16,rl=1<<co-1,Br=-227,Fr=482,Ko=6,rn=0,Wn=i(256),Ec=i(256),Sd=i(256),Gn=i(256),DA=i(Fr-Br),Zf=i(Fr-Br);Di("YuvToRgbRow",ur,3),Di("YuvToBgrRow",ta,3),Di("YuvToRgbaRow",sl,4),Di("YuvToBgraRow",Ya,4),Di("YuvToArgbRow",hn,4),Di("YuvToRgba4444Row",ya,2),Di("YuvToRgb565Row",da,2);var tm=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Fc=[0,2,8],ep=[8,7,6,4,4,2,2,2,1,1,1,1],uo=1;this.WebPDecodeRGBA=function(F,K,ie,fe,Se){var Pe=Wo,Oe=new jl,qe=new ut;Oe.ba=qe,qe.S=Pe,qe.width=[qe.width],qe.height=[qe.height];var $e=qe.width,st=qe.height,jt=new ft;if(jt==null||F==null)var Lt=2;else s(jt!=null),Lt=gc(F,K,ie,jt.width,jt.height,jt.Pd,jt.Qd,jt.format,null);if(Lt!=0?$e=0:($e!=null&&($e[0]=jt.width[0]),st!=null&&(st[0]=jt.height[0]),$e=1),$e){qe.width=qe.width[0],qe.height=qe.height[0],fe!=null&&(fe[0]=qe.width),Se!=null&&(Se[0]=qe.height);e:{if(fe=new Wr,(Se=new Qo).data=F,Se.w=K,Se.ha=ie,Se.kd=1,K=[0],s(Se!=null),((F=gc(Se.data,Se.w,Se.ha,null,null,null,K,null,Se))==0||F==7)&&K[0]&&(F=4),(K=F)==0){if(s(Oe!=null),fe.data=Se.data,fe.w=Se.w+Se.offset,fe.ha=Se.ha-Se.offset,fe.put=je,fe.ac=Ae,fe.bc=We,fe.ma=Oe,Se.xa){if((F=kt())==null){Oe=1;break e}if((function(Dt,Bt){var Zt=[0],Vt=[0],wt=[0];t:for(;;){if(Dt==null)return 0;if(Bt==null)return Dt.a=2,0;if(Dt.l=Bt,Dt.a=0,T(Dt.m,Bt.data,Bt.w,Bt.ha),!De(Dt.m,Zt,Vt,wt)){Dt.a=3;break t}if(Dt.xb=wd,Bt.width=Zt[0],Bt.height=Vt[0],!yt(Zt[0],Vt[0],1,Dt,null))break t;return 1}return s(Dt.a!=0),0})(F,fe)){if(fe=(K=vc(fe.width,fe.height,Oe.Oa,Oe.ba))==0){t:{fe=F;s:for(;;){if(fe==null){fe=0;break t}if(s(fe.s.yc!=null),s(fe.s.Ya!=null),s(0<fe.s.Wb),s((ie=fe.l)!=null),s((Se=ie.ma)!=null),fe.xb!=0){if(fe.ca=Se.ba,fe.tb=Se.tb,s(fe.ca!=null),!ud(Se.Oa,ie,Bu)){fe.a=2;break s}if(!Et(fe,ie.width)||ie.da)break s;if((ie.da||xe(fe.ca.S))&&Tt(),11>fe.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),fe.ca.f.kb.F!=null&&Tt()),fe.Pb&&0<fe.s.ua&&fe.s.vb.X==null&&!Ie(fe.s.vb,fe.s.Wa.Xa)){fe.a=1;break s}fe.xb=0}if(!Ge(fe,fe.V,fe.Ba,fe.c,fe.i,ie.o,pe))break s;Se.Dc=fe.Ma,fe=1;break t}s(fe.a!=0),fe=0}fe=!fe}fe&&(K=F.a)}else K=F.a}else{if((F=new mr)==null){Oe=1;break e}if(F.Fa=Se.na,F.P=Se.P,F.qc=Se.Sa,Po(F,fe)){if((K=vc(fe.width,fe.height,Oe.Oa,Oe.ba))==0){if(F.Aa=0,ie=Oe.Oa,s((Se=F)!=null),ie!=null){if(0<($e=0>($e=ie.Md)?0:100<$e?255:255*$e/100)){for(st=jt=0;4>st;++st)12>(Lt=Se.pb[st]).lc&&(Lt.ia=$e*ep[0>Lt.lc?0:Lt.lc]>>3),jt|=Lt.ia;jt&&(alert("todo:VP8InitRandom"),Se.ia=1)}Se.Ga=ie.Id,100<Se.Ga?Se.Ga=100:0>Se.Ga&&(Se.Ga=0)}pi(F,fe)||(K=F.a)}}else K=F.a}K==0&&Oe.Oa!=null&&Oe.Oa.fd&&(K=Ad(Oe.ba))}Oe=K}Pe=Oe!=0?null:11>Pe?qe.f.RGBA.eb:qe.f.kb.y}else Pe=null;return Pe};var Uu=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(U,H){for(var q="",V=0;V<4;V++)q+=String.fromCharCode(U[H++]);return q}function c(U,H){return(U[H+0]<<0|U[H+1]<<8|U[H+2]<<16)>>>0}function h(U,H){return(U[H+0]<<0|U[H+1]<<8|U[H+2]<<16|U[H+3]<<24)>>>0}new u;var A=[0],f=[0],g=[],v=new u,b=t,y=(function(U,H){var q={},V=0,M=!1,z=0,I=0;if(q.frames=[],!(function(E,w,O,R){for(var X=0;X<R;X++)if(E[w+X]!=O.charCodeAt(X))return!0;return!1})(U,H,"RIFF",4)){var G,Y;for(h(U,H+=4),H+=8;H<U.length;){var J=d(U,H),T=h(U,H+=4);H+=4;var k=T+(1&T);switch(J){case"VP8 ":case"VP8L":q.frames[V]===void 0&&(q.frames[V]={}),(C=q.frames[V]).src_off=M?I:H-8,C.src_size=z+T+8,V++,M&&(M=!1,z=0,I=0);break;case"VP8X":(C=q.header={}).feature_flags=U[H];var D=H+4;C.canvas_width=1+c(U,D),D+=3,C.canvas_height=1+c(U,D),D+=3;break;case"ALPH":M=!0,z=k+8,I=H-8;break;case"ANIM":(C=q.header).bgcolor=h(U,H),D=H+4,C.loop_count=(G=U)[(Y=D)+0]<<0|G[Y+1]<<8,D+=2;break;case"ANMF":var Q,C;(C=q.frames[V]={}).offset_x=2*c(U,H),H+=3,C.offset_y=2*c(U,H),H+=3,C.width=1+c(U,H),H+=3,C.height=1+c(U,H),H+=3,C.duration=c(U,H),H+=3,Q=U[H++],C.dispose=1&Q,C.blend=Q>>1&1}J!="ANMF"&&(H+=k)}return q}})(b,0);y.response=b,y.rgbaoutput=!0,y.dataurl=!1;var j=y.header?y.header:null,N=y.frames?y.frames:null;if(j){j.loop_counter=j.loop_count,A=[j.canvas_height],f=[j.canvas_width];for(var S=0;S<N.length&&N[S].blend!=0;S++);}var B=N[0],P=v.WebPDecodeRGBA(b,B.src_off,B.src_size,f,A);B.rgba=P,B.imgwidth=f[0],B.imgheight=A[0];for(var L=0;L<f[0]*A[0]*4;L++)g[L]=P[L];return this.width=f,this.height=A,this.data=g,this}(function(t){var s=function(){return typeof Vb=="function"},r=function(A,f,g,v){var b=4,y=l;switch(v){case t.image_compression.FAST:b=1,y=i;break;case t.image_compression.MEDIUM:b=6,y=o;break;case t.image_compression.SLOW:b=9,y=u}A=a(A,f,g,y);var j=Vb(A,{level:b});return t.__addimage__.arrayBufferToBinaryString(j)},a=function(A,f,g,v){for(var b,y,j,N=A.length/f,S=new Uint8Array(A.length+N),B=c(),P=0;P<N;P+=1){if(j=P*f,b=A.subarray(j,j+f),v)S.set(v(b,g,y),j+P);else{for(var L,U=B.length,H=[];L<U;L+=1)H[L]=B[L](b,g,y);var q=h(H.concat());S.set(H[q],j+P)}y=b}return S},n=function(A){var f=Array.apply([],A);return f.unshift(0),f},i=function(A,f){var g,v=[],b=A.length;v[0]=1;for(var y=0;y<b;y+=1)g=A[y-f]||0,v[y+1]=A[y]-g+256&255;return v},l=function(A,f,g){var v,b=[],y=A.length;b[0]=2;for(var j=0;j<y;j+=1)v=g&&g[j]||0,b[j+1]=A[j]-v+256&255;return b},o=function(A,f,g){var v,b,y=[],j=A.length;y[0]=3;for(var N=0;N<j;N+=1)v=A[N-f]||0,b=g&&g[N]||0,y[N+1]=A[N]+256-(v+b>>>1)&255;return y},u=function(A,f,g){var v,b,y,j,N=[],S=A.length;N[0]=4;for(var B=0;B<S;B+=1)v=A[B-f]||0,b=g&&g[B]||0,y=g&&g[B-f]||0,j=d(v,b,y),N[B+1]=A[B]-j+256&255;return N},d=function(A,f,g){if(A===f&&f===g)return A;var v=Math.abs(f-g),b=Math.abs(A-g),y=Math.abs(A+f-g-g);return v<=b&&v<=y?A:b<=y?f:g},c=function(){return[n,i,l,o,u]},h=function(A){var f=A.map((function(g){return g.reduce((function(v,b){return v+Math.abs(b)}),0)}));return f.indexOf(Math.min.apply(null,f))};t.processPNG=function(A,f,g,v){var b,y,j,N,S,B,P,L,U,H,q,V,M,z,I,G=this.decode.FLATE_DECODE,Y="";if(this.__addimage__.isArrayBuffer(A)&&(A=new Uint8Array(A)),this.__addimage__.isArrayBufferView(A)){if(A=(j=new oD(A)).imgData,y=j.bits,b=j.colorSpace,S=j.colors,[4,6].indexOf(j.colorType)!==-1){if(j.bits===8){U=(L=j.pixelBitlength==32?new Uint32Array(j.decodePixels().buffer):j.pixelBitlength==16?new Uint16Array(j.decodePixels().buffer):new Uint8Array(j.decodePixels().buffer)).length,q=new Uint8Array(U*j.colors),H=new Uint8Array(U);var J,T=j.pixelBitlength-j.bits;for(z=0,I=0;z<U;z++){for(M=L[z],J=0;J<T;)q[I++]=M>>>J&255,J+=j.bits;H[z]=M>>>J&255}}if(j.bits===16){U=(L=new Uint32Array(j.decodePixels().buffer)).length,q=new Uint8Array(U*(32/j.pixelBitlength)*j.colors),H=new Uint8Array(U*(32/j.pixelBitlength)),V=j.colors>1,z=0,I=0;for(var k=0;z<U;)M=L[z++],q[I++]=M>>>0&255,V&&(q[I++]=M>>>16&255,M=L[z++],q[I++]=M>>>0&255),H[k++]=M>>>16&255;y=8}v!==t.image_compression.NONE&&s()?(A=r(q,j.width*j.colors,j.colors,v),P=r(H,j.width,1,v)):(A=q,P=H,G=void 0)}if(j.colorType===3&&(b=this.color_spaces.INDEXED,B=j.palette,j.transparency.indexed)){var D=j.transparency.indexed,Q=0;for(z=0,U=D.length;z<U;++z)Q+=D[z];if((Q/=255)===U-1&&D.indexOf(0)!==-1)N=[D.indexOf(0)];else if(Q!==U){for(L=j.decodePixels(),H=new Uint8Array(L.length),z=0,U=L.length;z<U;z++)H[z]=D[L[z]];P=r(H,j.width,1)}}var C=(function(E){var w;switch(E){case t.image_compression.FAST:w=11;break;case t.image_compression.MEDIUM:w=13;break;case t.image_compression.SLOW:w=14;break;default:w=12}return w})(v);return G===this.decode.FLATE_DECODE&&(Y="/Predictor "+C+" "),Y+="/Colors "+S+" /BitsPerComponent "+y+" /Columns "+j.width,(this.__addimage__.isArrayBuffer(A)||this.__addimage__.isArrayBufferView(A))&&(A=this.__addimage__.arrayBufferToBinaryString(A)),(P&&this.__addimage__.isArrayBuffer(P)||this.__addimage__.isArrayBufferView(P))&&(P=this.__addimage__.arrayBufferToBinaryString(P)),{alias:g,data:A,index:f,filter:G,decodeParameters:Y,transparency:N,palette:B,sMask:P,predictor:C,width:j.width,height:j.height,bitsPerComponent:y,colorSpace:b}}}})(ds.API),(function(t){t.processGIF89A=function(s,r,a,n){var i=new cD(s),l=i.width,o=i.height,u=[];i.decodeAndBlitFrameRGBA(0,u);var d={data:u,width:l,height:o},c=new kv(100).encode(d,100);return t.processJPEG.call(this,c,r,a,n)},t.processGIF87A=t.processGIF89A})(ds.API),jo.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var s=0;s<t;s++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[s]={red:n,green:a,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},jo.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,s=this.width*this.height*4;this.data=new Uint8Array(s),this[t]()}catch(r){Yr.log("bit decode error:"+r)}},jo.prototype.bit1=function(){var t,s=Math.ceil(this.width/8),r=s%4;for(t=this.height-1;t>=0;t--){for(var a=this.bottom_up?t:this.height-1-t,n=0;n<s;n++)for(var i=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var u=this.palette[i>>7-o&1];this.data[l+4*o]=u.blue,this.data[l+4*o+1]=u.green,this.data[l+4*o+2]=u.red,this.data[l+4*o+3]=255}r!==0&&(this.pos+=4-r)}},jo.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),s=t%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<t;n++){var i=this.datav.getUint8(this.pos++,!0),l=a*this.width*4+2*n*4,o=i>>4,u=15&i,d=this.palette[o];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*n+1>=this.width)break;d=this.palette[u],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}s!==0&&(this.pos+=4-s)}},jo.prototype.bit8=function(){for(var t=this.width%4,s=this.height-1;s>=0;s--){for(var r=this.bottom_up?s:this.height-1-s,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*a;if(n<this.palette.length){var l=this.palette[n];this.data[i]=l.red,this.data[i+1]=l.green,this.data[i+2]=l.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}t!==0&&(this.pos+=4-t)}},jo.prototype.bit15=function(){for(var t=this.width%3,s=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&s)/s*255|0,o=(i>>5&s)/s*255|0,u=(i>>10&s)/s*255|0,d=i>>15?255:0,c=a*this.width*4+4*n;this.data[c]=u,this.data[c+1]=o,this.data[c+2]=l,this.data[c+3]=d}this.pos+=t}},jo.prototype.bit16=function(){for(var t=this.width%3,s=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(l&s)/s*255|0,u=(l>>5&r)/r*255|0,d=(l>>11)/s*255|0,c=n*this.width*4+4*i;this.data[c]=d,this.data[c+1]=u,this.data[c+2]=o,this.data[c+3]=255}this.pos+=t}},jo.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=s*this.width*4+4*r;this.data[l]=i,this.data[l+1]=n,this.data[l+2]=a,this.data[l+3]=255}this.pos+=this.width%4}},jo.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var s=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),o=s*this.width*4+4*r;this.data[o]=i,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=l}},jo.prototype.getData=function(){return this.data},(function(t){t.processBMP=function(s,r,a,n){var i=new jo(s,!1),l=i.width,o=i.height,u={data:i.getData(),width:l,height:o},d=new kv(100).encode(u,100);return t.processJPEG.call(this,d,r,a,n)}})(ds.API),Uw.prototype.getData=function(){return this.data},(function(t){t.processWEBP=function(s,r,a,n){var i=new Uw(s),l=i.width,o=i.height,u={data:i.getData(),width:l,height:o},d=new kv(100).encode(u,100);return t.processJPEG.call(this,d,r,a,n)}})(ds.API),ds.API.processRGBA=function(t,s,r){for(var a=t.data,n=a.length,i=new Uint8Array(n/4*3),l=new Uint8Array(n/4),o=0,u=0,d=0;d<n;d+=4){var c=a[d],h=a[d+1],A=a[d+2],f=a[d+3];i[o++]=c,i[o++]=h,i[o++]=A,l[u++]=f}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:g,index:s,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ds.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")})),this.internal.languageSettings.isSubscribed=!0)),this},eh=ds.API,Op=eh.getCharWidthsArray=function(t,s){var r,a,n=(s=s||{}).font||this.internal.getFont(),i=s.fontSize||this.internal.getFontSize(),l=s.charSpace||this.internal.getCharSpace(),o=s.widths?s.widths:n.metadata.Unicode.widths,u=o.fof?o.fof:1,d=s.kerning?s.kerning:n.metadata.Unicode.kerning,c=d.fof?d.fof:1,h=s.doKerning!==!1,A=0,f=t.length,g=0,v=o[0]||u,b=[];for(r=0;r<f;r++)a=t.charCodeAt(r),typeof n.metadata.widthOfString=="function"?b.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+l*(1e3/i)||0)/1e3):(A=h&&Hr(d[a])==="object"&&!isNaN(parseInt(d[a][g],10))?d[a][g]/c:0,b.push((o[a]||v)/u+A)),g=a;return b},Tw=eh.getStringUnitWidth=function(t,s){var r=(s=s||{}).fontSize||this.internal.getFontSize(),a=s.font||this.internal.getFont(),n=s.charSpace||this.internal.getCharSpace();return eh.processArabic&&(t=eh.processArabic(t)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(t,r,n)/r:Op.apply(this,arguments).reduce((function(i,l){return i+l}),0)},Iw=function(t,s,r,a){for(var n=[],i=0,l=t.length,o=0;i!==l&&o+s[i]<r;)o+=s[i],i++;n.push(t.slice(0,i));var u=i;for(o=0;i!==l;)o+s[i]>a&&(n.push(t.slice(u,i)),o=0,u=i),o+=s[i],i++;return u!==i&&n.push(t.slice(u,i)),n},Lw=function(t,s,r){r||(r={});var a,n,i,l,o,u,d,c=[],h=[c],A=r.textIndent||0,f=0,g=0,v=t.split(" "),b=Op.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?v[0].length+2:r.lineIndent||0){var y=Array(u).join(" "),j=[];v.map((function(S){(S=S.split(/\s*\n/)).length>1?j=j.concat(S.map((function(B,P){return(P&&B.length?`
`:"")+B}))):j.push(S[0])})),v=j,u=Tw.apply(this,[y,r])}for(i=0,l=v.length;i<l;i++){var N=0;if(a=v[i],u&&a[0]==`
`&&(a=a.substr(1),N=1),A+f+(g=(n=Op.apply(this,[a,r])).reduce((function(S,B){return S+B}),0))>s||N){if(g>s){for(o=Iw.apply(this,[a,n,s-(A+f),s]),c.push(o.shift()),c=[o.pop()];o.length;)h.push([o.shift()]);g=n.slice(a.length-(c[0]?c[0].length:0)).reduce((function(S,B){return S+B}),0)}else c=[a];h.push(c),A=g+u,f=b}else c.push(a),A+=f+g,f=b}return d=u?function(S,B){return(B?y:"")+S.join(" ")}:function(S){return S.join(" ")},h.map(d)},eh.splitTextToSize=function(t,s,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var h=this.internal.getFont(c.fontName,c.fontStyle);return h.metadata.Unicode?{widths:h.metadata.Unicode.widths||{0:1},kerning:h.metadata.Unicode.kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(t)?t:String(t).split(/\r?\n/);var l=1*this.internal.scaleFactor*s/n;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,i.lineIndent=r.lineIndent;var o,u,d=[];for(o=0,u=a.length;o<u;o++)d=d.concat(Lw.apply(this,[a[o],l,i]));return d},(function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var s="klmnopqrstuvwxyz",r={},a={},n=0;n<s.length;n++)r[s[n]]="0123456789abcdef"[n],a["0123456789abcdef"[n]]=s[n];var i=function(h){return"0x"+parseInt(h,10).toString(16)},l=t.__fontmetrics__.compress=function(h){var A,f,g,v,b=["{"];for(var y in h){if(A=h[y],isNaN(parseInt(y,10))?f="'"+y+"'":(y=parseInt(y,10),f=(f=i(y).slice(2)).slice(0,-1)+a[f.slice(-1)]),typeof A=="number")A<0?(g=i(A).slice(3),v="-"):(g=i(A).slice(2),v=""),g=v+g.slice(0,-1)+a[g.slice(-1)];else{if(Hr(A)!=="object")throw new Error("Don't know what to do with value type "+Hr(A)+".");g=l(A)}b.push(f+g)}return b.push("}"),b.join("")},o=t.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var A,f,g,v,b={},y=1,j=b,N=[],S="",B="",P=h.length-1,L=1;L<P;L+=1)(v=h[L])=="'"?A?(g=A.join(""),A=void 0):A=[]:A?A.push(v):v=="{"?(N.push([j,g]),j={},g=void 0):v=="}"?((f=N.pop())[0][f[1]]=j,g=void 0,j=f[0]):v=="-"?y=-1:g===void 0?r.hasOwnProperty(v)?(S+=r[v],g=parseInt(S,16)*y,y=1,S=""):S+=v:r.hasOwnProperty(v)?(B+=r[v],j[g]=parseInt(B,16)*y,y=1,g=void 0,B=""):B+=v;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},c={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(h){var A=h.font,f=c.Unicode[A.postScriptName];f&&(A.metadata.Unicode={},A.metadata.Unicode.widths=f.widths,A.metadata.Unicode.kerning=f.kerning);var g=d.Unicode[A.postScriptName];g&&(A.metadata.Unicode.encoding=g,A.encoding=g.codePages[0])}])})(ds.API),(function(t){var s=function(r){for(var a=r.length,n=new Uint8Array(a),i=0;i<a;i++)n[i]=r.charCodeAt(i);return n};t.API.events.push(["addFont",function(r){var a=void 0,n=r.font,i=r.instance;if(!n.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=i.existsFileInVFS(n.postScriptName)===!1?i.loadFile(n.postScriptName):i.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(l,o){o=/^\x00\x01\x00\x00/.test(o)?s(o):s(qm(o)),l.metadata=t.API.TTFFont.open(o),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(n,a)}}])})(ds),(function(t){function s(){return(Vs.canvg?Promise.resolve(Vs.canvg):Ob(()=>import("./index.es-C0OSVEjr.js"),[])).catch((function(r){return Promise.reject(new Error("Could not load canvg: "+r))})).then((function(r){return r.default?r.default:r}))}ds.API.addSvgAsImage=function(r,a,n,i,l,o,u,d){if(isNaN(a)||isNaN(n))throw Yr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(l))throw Yr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=i,c.height=l;var h=c.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,c.width,c.height);var A={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return s().then((function(g){return g.fromString(h,r,A)}),(function(){return Promise.reject(new Error("Could not load canvg."))})).then((function(g){return g.render(A)})).then((function(){f.addImage(c.toDataURL("image/jpeg",1),a,n,i,l,u,d)}))}})(),ds.API.putTotalPages=function(t){var s,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(s=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(s=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(s,r);return this},ds.API.viewerPreferences=function(t,s){var r;t=t||{},s=s||!1;var a,n,i,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(l),u=[],d=0,c=0,h=0;function A(g,v){var b,y=!1;for(b=0;b<g.length;b+=1)g[b]===v&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||s===!0){var f=o.length;for(h=0;h<f;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(Hr(t)==="object"){for(n in t)if(i=t[n],A(o,n)&&i!==void 0){if(r[n].type==="boolean"&&typeof i=="boolean")r[n].value=i;else if(r[n].type==="name"&&A(r[n].valueSet,i))r[n].value=i;else if(r[n].type==="integer"&&Number.isInteger(i))r[n].value=i;else if(r[n].type==="array"){for(d=0;d<i.length;d+=1)if(a=!0,i[d].length===1&&typeof i[d][0]=="number")u.push(String(i[d]-1));else if(i[d].length>1){for(c=0;c<i[d].length;c+=1)typeof i[d][c]!="number"&&(a=!1);a===!0&&u.push([i[d][0]-1,i[d][1]-1].join(" "))}r[n].value="["+u.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",(function(){var g,v=[];for(g in r)r[g].explicitSet===!0&&(r[g].type==="name"?v.push("/"+g+" /"+r[g].value):v.push("/"+g+" "+r[g].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)})),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(t){var s=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(a)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+l.length+o.length+n.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(n+i+l+o+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",s)),this}})(ds.API),(function(t){var s=t.API,r=s.pdfEscape16=function(i,l){for(var o,u=l.metadata.Unicode.widths,d=["","0","00","000","0000"],c=[""],h=0,A=i.length;h<A;++h){if(o=l.metadata.characterToGlyph(i.charCodeAt(h)),l.metadata.glyIdsUsed.push(o),l.metadata.toUnicode[o]=i.charCodeAt(h),u.indexOf(o)==-1&&(u.push(o),u.push([parseInt(l.metadata.widthOfGlyph(o),10)])),o=="0")return c.join("");o=o.toString(16),c.push(d[4-o.length],o)}return c.join("")},a=function(i){var l,o,u,d,c,h,A;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],h=0,A=(o=Object.keys(i).sort((function(f,g){return f-g}))).length;h<A;h++)l=o[h],u.length>=100&&(c+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),i[l]!==void 0&&i[l]!==null&&typeof i[l].toString=="function"&&(d=("0000"+i[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),u.push("<"+l+"><"+d+">"));return u.length&&(c+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};s.events.push(["putFont",function(i){(function(l){var o=l.font,u=l.out,d=l.newObject,c=l.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,A=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),f="",g=0;g<A.length;g++)f+=String.fromCharCode(A[g]);var v=d();c({data:f,addLength1:!0,objectId:v}),u("endobj");var b=d();c({data:a(o.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var y=d();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+hh(o.fontName)),u("/FontFile2 "+v+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/Flags "+o.metadata.flags),u("/StemV "+o.metadata.stemV),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u(">>"),u("endobj");var j=d();u("<<"),u("/Type /Font"),u("/BaseFont /"+hh(o.fontName)),u("/FontDescriptor "+y+" 0 R"),u("/W "+t.API.PDFObject.convert(h)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+o.encoding+")"),u(">>"),u(">>"),u("endobj"),o.objectNumber=d(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+b+" 0 R"),u("/BaseFont /"+hh(o.fontName)),u("/Encoding /"+o.encoding),u("/DescendantFonts ["+j+" 0 R]"),u(">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]),s.events.push(["putFont",function(i){(function(l){var o=l.font,u=l.out,d=l.newObject,c=l.putStream;if(o.metadata instanceof t.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,A="",f=0;f<h.length;f++)A+=String.fromCharCode(h[f]);var g=d();c({data:A,addLength1:!0,objectId:g}),u("endobj");var v=d();c({data:a(o.metadata.toUnicode),addLength1:!0,objectId:v}),u("endobj");var b=d();u("<<"),u("/Descent "+o.metadata.decender),u("/CapHeight "+o.metadata.capHeight),u("/StemV "+o.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+g+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(o.metadata.bbox)),u("/FontName /"+hh(o.fontName)),u("/ItalicAngle "+o.metadata.italicAngle),u("/Ascent "+o.metadata.ascender),u(">>"),u("endobj"),o.objectNumber=d();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+hh(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),u("endobj"),o.isAlreadyPutted=!0}})(i)}]);var n=function(i){var l,o=i.text||"",u=i.x,d=i.y,c=i.options||{},h=i.mutex||{},A=h.pdfEscape,f=h.activeFontKey,g=h.fonts,v=f,b="",y=0,j="",N=g[v].encoding;if(g[v].encoding!=="Identity-H")return{text:o,x:u,y:d,options:c,mutex:h};for(j=o,v=f,Array.isArray(o)&&(j=o[0]),y=0;y<j.length;y+=1)g[v].metadata.hasOwnProperty("cmap")&&(l=g[v].metadata.cmap.unicode.codeMap[j[y].charCodeAt(0)]),l||j[y].charCodeAt(0)<256&&g[v].metadata.hasOwnProperty("Unicode")?b+=j[y]:b+="";var S="";return parseInt(v.slice(1))<14||N==="WinAnsiEncoding"?S=A(b,v).split("").map((function(B){return B.charCodeAt(0).toString(16)})).join(""):N==="Identity-H"&&(S=r(b,g[v])),h.isHex=!0,{text:S,x:u,y:d,options:c,mutex:h}};s.events.push(["postProcessText",function(i){var l=i.text||"",o=[],u={text:l,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?o.push([n(Object.assign({},u,{text:l[d][0]})).text,l[d][1],l[d][2]]):o.push(n(Object.assign({},u,{text:l[d]})).text);i.text=o}else i.text=n(Object.assign({},u,{text:l})).text}])})(ds),(function(t){var s=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return s.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,a){return s.call(this),this.internal.vFS[r]=a,this},t.getFileFromVFS=function(r){return s.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(ds.API),(function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(a){var n,i,l,o,u,d,c,h=s,A=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),j=!1,N=0;this.__bidiEngine__={};var S=function(V){var M=V.charCodeAt(),z=M>>8,I=v[z];return I!==void 0?h[256*I+(255&M)]:z===252||z===253?"AL":y.test(z)?"L":z===8?"R":"N"},B=function(V){for(var M,z=0;z<V.length;z++){if((M=S(V.charAt(z)))==="L")return!1;if(M==="R")return!0}return!1},P=function(V,M,z,I){var G,Y,J,T,k=M[I];switch(k){case"L":case"R":j=!1;break;case"N":case"AN":break;case"EN":j&&(k="AN");break;case"AL":j=!0,k="R";break;case"WS":k="N";break;case"CS":I<1||I+1>=M.length||(G=z[I-1])!=="EN"&&G!=="AN"||(Y=M[I+1])!=="EN"&&Y!=="AN"?k="N":j&&(Y="AN"),k=Y===G?Y:"N";break;case"ES":k=(G=I>0?z[I-1]:"B")==="EN"&&I+1<M.length&&M[I+1]==="EN"?"EN":"N";break;case"ET":if(I>0&&z[I-1]==="EN"){k="EN";break}if(j){k="N";break}for(J=I+1,T=M.length;J<T&&M[J]==="ET";)J++;k=J<T&&M[J]==="EN"?"EN":"N";break;case"NSM":if(l&&!o){for(T=M.length,J=I+1;J<T&&M[J]==="NSM";)J++;if(J<T){var D=V[I],Q=D>=1425&&D<=2303||D===64286;if(G=M[J],Q&&(G==="R"||G==="AL")){k="R";break}}}k=I<1||(G=M[I-1])==="B"?"N":z[I-1];break;case"B":j=!1,n=!0,k=N;break;case"S":i=!0,k="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":j=!1;break;case"BN":k="N"}return k},L=function(V,M,z){var I=V.split("");return z&&U(I,z,{hiLevel:N}),I.reverse(),M&&M.reverse(),I.join("")},U=function(V,M,z){var I,G,Y,J,T,k=-1,D=V.length,Q=0,C=[],E=N?f:A,w=[];for(j=!1,n=!1,i=!1,G=0;G<D;G++)w[G]=S(V[G]);for(Y=0;Y<D;Y++){if(T=Q,C[Y]=P(V,w,C,Y),I=240&(Q=E[T][g[C[Y]]]),Q&=15,M[Y]=J=E[Q][5],I>0)if(I===16){for(G=k;G<Y;G++)M[G]=1;k=-1}else k=-1;if(E[Q][6])k===-1&&(k=Y);else if(k>-1){for(G=k;G<Y;G++)M[G]=J;k=-1}w[Y]==="B"&&(M[Y]=0),z.hiLevel|=J}i&&(function(O,R,X){for(var ne=0;ne<X;ne++)if(O[ne]==="S"){R[ne]=N;for(var te=ne-1;te>=0&&O[te]==="WS";te--)R[te]=N}})(w,M,D)},H=function(V,M,z,I,G){if(!(G.hiLevel<V)){if(V===1&&N===1&&!n)return M.reverse(),void(z&&z.reverse());for(var Y,J,T,k,D=M.length,Q=0;Q<D;){if(I[Q]>=V){for(T=Q+1;T<D&&I[T]>=V;)T++;for(k=Q,J=T-1;k<J;k++,J--)Y=M[k],M[k]=M[J],M[J]=Y,z&&(Y=z[k],z[k]=z[J],z[J]=Y);Q=T}Q++}}},q=function(V,M,z){var I=V.split(""),G={hiLevel:N};return z||(z=[]),U(I,z,G),(function(Y,J,T){if(T.hiLevel!==0&&c)for(var k,D=0;D<Y.length;D++)J[D]===1&&(k=b.indexOf(Y[D]))>=0&&(Y[D]=b[k+1])})(I,z,G),H(2,I,M,z,G),H(1,I,M,z,G),I.join("")};return this.__bidiEngine__.doBidiReorder=function(V,M,z){if((function(G,Y){if(Y)for(var J=0;J<G.length;J++)Y[J]=J;o===void 0&&(o=B(G)),d===void 0&&(d=B(G))})(V,M),l||!u||d)if(l&&u&&o^d)N=o?1:0,V=L(V,M,z);else if(!l&&u&&d)N=o?1:0,V=q(V,M,z),V=L(V,M);else if(!l||o||u||d){if(l&&!u&&o^d)V=L(V,M),o?(N=0,V=q(V,M,z)):(N=1,V=q(V,M,z),V=L(V,M));else if(l&&o&&!u&&d)N=1,V=q(V,M,z),V=L(V,M);else if(!l&&!u&&o^d){var I=c;o?(N=1,V=q(V,M,z),N=0,c=!1,V=q(V,M,z),c=I):(N=0,V=q(V,M,z),V=L(V,M),N=1,c=!1,V=q(V,M,z),c=I,V=L(V,M))}}else N=0,V=q(V,M,z);else N=o?1:0,V=q(V,M,z);return V},this.__bidiEngine__.setOptions=function(V){V&&(l=V.isInputVisual,u=V.isOutputVisual,o=V.isInputRtl,d=V.isOutputRtl,c=V.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var s=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(a){var n=a.text,i=(a.x,a.y,a.options||{}),l=(a.mutex,i.lang,[]);if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(n)==="[object Array]"){var o=0;for(l=[],o=0;o<n.length;o+=1)Object.prototype.toString.call(n[o])==="[object Array]"?l.push([r.doBidiReorder(n[o][0]),n[o][1],n[o][2]]):l.push([r.doBidiReorder(n[o])]);a.text=l}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])})(ds),ds.API.TTFFont=(function(){function t(s){var r;if(this.rawData=s,r=this.contents=new du(s),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new wD(this),this.registerTTF()}return t.open=function(s){return new t(s)},t.prototype.parse=function(){return this.directory=new dD(this.contents),this.head=new AD(this),this.name=new xD(this),this.cmap=new j5(this),this.toUnicode={},this.hhea=new hD(this),this.maxp=new gD(this),this.hmtx=new vD(this),this.post=new fD(this),this.os2=new mD(this),this.loca=new ND(this),this.glyf=new bD(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var s,r,a,n,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,o,u,d;for(d=[],l=0,o=(u=this.bbox).length;l<o;l++)s=u[l],d.push(Math.round(s*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),(32768&(r=n>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(s){var r;return((r=this.cmap.unicode)!=null?r.codeMap[s]:void 0)||0},t.prototype.widthOfGlyph=function(s){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(s).advance*r},t.prototype.widthOfString=function(s,r,a){var n,i,l,o;for(l=0,i=0,o=(s=""+s).length;0<=o?i<o:i>o;i=0<=o?++i:--i)n=s.charCodeAt(i),l+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return l*(r/1e3)},t.prototype.lineHeight=function(s,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*s},t})();var Lo,du=(function(){function t(s){this.data=s??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(s){return this.data[this.pos++]=s},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(s){return this.writeByte(s>>>24&255),this.writeByte(s>>16&255),this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt32=function(){var s;return(s=this.readUInt32())>=2147483648?s-4294967296:s},t.prototype.writeInt32=function(s){return s<0&&(s+=4294967296),this.writeUInt32(s)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(s){return this.writeByte(s>>8&255),this.writeByte(255&s)},t.prototype.readInt16=function(){var s;return(s=this.readUInt16())>=32768?s-65536:s},t.prototype.writeInt16=function(s){return s<0&&(s+=65536),this.writeUInt16(s)},t.prototype.readString=function(s){var r,a;for(a=[],r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},t.prototype.writeString=function(s){var r,a,n;for(n=[],r=0,a=s.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(s.charCodeAt(r)));return n},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(s){return this.writeInt16(s)},t.prototype.readLongLong=function(){var s,r,a,n,i,l,o,u;return s=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),i=this.readByte(),l=this.readByte(),o=this.readByte(),u=this.readByte(),128&s?-1*(72057594037927940*(255^s)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^i)+65536*(255^l)+256*(255^o)+(255^u)+1):72057594037927940*s+281474976710656*r+1099511627776*a+4294967296*n+16777216*i+65536*l+256*o+u},t.prototype.writeLongLong=function(s){var r,a;return r=Math.floor(s/4294967296),a=4294967295&s,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(s){return this.writeInt32(s)},t.prototype.read=function(s){var r,a;for(r=[],a=0;0<=s?a<s:a>s;a=0<=s?++a:--a)r.push(this.readByte());return r},t.prototype.write=function(s){var r,a,n,i;for(i=[],a=0,n=s.length;a<n;a++)r=s[a],i.push(this.writeByte(r));return i},t})(),dD=(function(){var t;function s(r){var a,n,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,i=this.tableCount;0<=i?n<i:n>i;n=0<=i?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return s.prototype.encode=function(r){var a,n,i,l,o,u,d,c,h,A,f,g,v;for(v in f=Object.keys(r).length,u=Math.log(2),h=16*Math.floor(Math.log(f)/u),l=Math.floor(h/u),c=16*f-h,(n=new du).writeInt(this.scalarType),n.writeShort(f),n.writeShort(h),n.writeShort(l),n.writeShort(c),i=16*f,d=n.pos+i,o=null,g=[],r)for(A=r[v],n.writeString(v),n.writeInt(t(A)),n.writeInt(d),n.writeInt(A.length),g=g.concat(A),v==="head"&&(o=d),d+=A.length;d%4;)g.push(0),d++;return n.write(g),a=2981146554-t(n.data),n.pos=o+8,n.writeUInt32(a),n.data},t=function(r){var a,n,i,l;for(r=N5.call(r);r.length%4;)r.push(0);for(i=new du(r),n=0,a=0,l=r.length;a<l;a=a+=4)n+=i.readUInt32();return 4294967295&n},s})(),uD={}.hasOwnProperty,cc=function(t,s){for(var r in s)uD.call(s,r)&&(t[r]=s[r]);function a(){this.constructor=t}return a.prototype=s.prototype,t.prototype=new a,t.__super__=s.prototype,t};Lo=(function(){function t(s){var r;this.file=s,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t})();var AD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="head",s.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},s.prototype.encode=function(r){var a;return(a=new du).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},s})(),Pw=(function(){function t(s,r){var a,n,i,l,o,u,d,c,h,A,f,g,v,b,y,j,N;switch(this.platformID=s.readUInt16(),this.encodingID=s.readShort(),this.offset=r+s.readInt(),h=s.pos,s.pos=this.offset,this.format=s.readUInt16(),this.length=s.readUInt16(),this.language=s.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=s.readByte();break;case 4:for(f=s.readUInt16(),A=f/2,s.pos+=6,i=(function(){var S,B;for(B=[],u=S=0;0<=A?S<A:S>A;u=0<=A?++S:--S)B.push(s.readUInt16());return B})(),s.pos+=2,v=(function(){var S,B;for(B=[],u=S=0;0<=A?S<A:S>A;u=0<=A?++S:--S)B.push(s.readUInt16());return B})(),d=(function(){var S,B;for(B=[],u=S=0;0<=A?S<A:S>A;u=0<=A?++S:--S)B.push(s.readUInt16());return B})(),c=(function(){var S,B;for(B=[],u=S=0;0<=A?S<A:S>A;u=0<=A?++S:--S)B.push(s.readUInt16());return B})(),n=(this.length-s.pos+this.offset)/2,o=(function(){var S,B;for(B=[],u=S=0;0<=n?S<n:S>n;u=0<=n?++S:--S)B.push(s.readUInt16());return B})(),u=y=0,N=i.length;y<N;u=++y)for(b=i[u],a=j=g=v[u];g<=b?j<=b:j>=b;a=g<=b?++j:--j)c[u]===0?l=a+d[u]:(l=o[c[u]/2+(a-g)-(A-u)]||0)!==0&&(l+=d[u]),this.codeMap[a]=65535&l}s.pos=h}return t.encode=function(s,r){var a,n,i,l,o,u,d,c,h,A,f,g,v,b,y,j,N,S,B,P,L,U,H,q,V,M,z,I,G,Y,J,T,k,D,Q,C,E,w,O,R,X,ne,te,oe,ce,re;switch(I=new du,l=Object.keys(s).sort((function(de,Ie){return de-Ie})),r){case"macroman":for(v=0,b=(function(){var de=[];for(g=0;g<256;++g)de.push(0);return de})(),j={0:0},i={},G=0,k=l.length;G<k;G++)j[te=s[n=l[G]]]==null&&(j[te]=++v),i[n]={old:s[n],new:j[s[n]]},b[n]=j[s[n]];return I.writeUInt16(1),I.writeUInt16(0),I.writeUInt32(12),I.writeUInt16(0),I.writeUInt16(262),I.writeUInt16(0),I.write(b),{charMap:i,subtable:I.data,maxGlyphID:v+1};case"unicode":for(M=[],h=[],N=0,j={},a={},y=d=null,Y=0,D=l.length;Y<D;Y++)j[B=s[n=l[Y]]]==null&&(j[B]=++N),a[n]={old:B,new:j[B]},o=j[B]-n,y!=null&&o===d||(y&&h.push(y),M.push(n),d=o),y=n;for(y&&h.push(y),h.push(65535),M.push(65535),q=2*(H=M.length),U=2*Math.pow(Math.log(H)/Math.LN2,2),A=Math.log(U/2)/Math.LN2,L=2*H-U,u=[],P=[],f=[],g=J=0,Q=M.length;J<Q;g=++J){if(V=M[g],c=h[g],V===65535){u.push(0),P.push(0);break}if(V-(z=a[V].new)>=32768)for(u.push(0),P.push(2*(f.length+H-g)),n=T=V;V<=c?T<=c:T>=c;n=V<=c?++T:--T)f.push(a[n].new);else u.push(z-V),P.push(0)}for(I.writeUInt16(3),I.writeUInt16(1),I.writeUInt32(12),I.writeUInt16(4),I.writeUInt16(16+8*H+2*f.length),I.writeUInt16(0),I.writeUInt16(q),I.writeUInt16(U),I.writeUInt16(A),I.writeUInt16(L),X=0,C=h.length;X<C;X++)n=h[X],I.writeUInt16(n);for(I.writeUInt16(0),ne=0,E=M.length;ne<E;ne++)n=M[ne],I.writeUInt16(n);for(oe=0,w=u.length;oe<w;oe++)o=u[oe],I.writeUInt16(o);for(ce=0,O=P.length;ce<O;ce++)S=P[ce],I.writeUInt16(S);for(re=0,R=f.length;re<R;re++)v=f[re],I.writeUInt16(v);return{charMap:a,subtable:I.data,maxGlyphID:N+1}}},t})(),j5=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="cmap",s.prototype.parse=function(r){var a,n,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)a=new Pw(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},s.encode=function(r,a){var n,i;return a==null&&(a="macroman"),n=Pw.encode(r,a),(i=new du).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},s})(),hD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="hhea",s.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},s})(),mD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="OS/2",s.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=(function(){var a,n;for(n=[],a=0;a<10;++a)n.push(r.readByte());return n})(),this.charRange=(function(){var a,n;for(n=[],a=0;a<4;++a)n.push(r.readInt());return n})(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=(function(){var a,n;for(n=[],a=0;a<2;a=++a)n.push(r.readInt());return n})(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},s})(),fD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="post",s.prototype.parse=function(r){var a,n,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var l;for(n=r.readUInt16(),this.glyphNameIndex=[],l=0;0<=n?l<n:l>n;l=0<=n?++l:--l)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)a=r.readByte(),i.push(this.names.push(r.readString(a)));return i;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var o,u,d;for(d=[],l=o=0,u=this.file.maxp.numGlyphs;0<=u?o<u:o>u;l=0<=u?++o:--o)d.push(r.readUInt32());return d}).call(this)}},s})(),pD=function(t,s){this.raw=t,this.length=t.length,this.platformID=s.platformID,this.encodingID=s.encodingID,this.languageID=s.languageID},xD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="name",s.prototype.parse=function(r){var a,n,i,l,o,u,d,c,h,A,f;for(r.pos=this.offset,r.readShort(),a=r.readShort(),u=r.readShort(),n=[],l=0;0<=a?l<a:l>a;l=0<=a?++l:--l)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+u+r.readShort()});for(d={},l=h=0,A=n.length;h<A;l=++h)i=n[l],r.pos=i.offset,c=r.readString(i.length),o=new pD(c,i),d[f=i.nameID]==null&&(d[f]=[]),d[i.nameID].push(o);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},s})(),gD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="maxp",s.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},s})(),vD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="hmtx",s.prototype.parse=function(r){var a,n,i,l,o,u,d;for(r.pos=this.offset,this.metrics=[],a=0,u=this.file.hhea.numberOfMetrics;0<=u?a<u:a>u;a=0<=u?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,h;for(h=[],a=c=0;0<=i?c<i:c>i;a=0<=i?++c:--c)h.push(r.readInt16());return h})(),this.widths=(function(){var c,h,A,f;for(f=[],c=0,h=(A=this.metrics).length;c<h;c++)l=A[c],f.push(l.advance);return f}).call(this),n=this.widths[this.widths.length-1],d=[],a=o=0;0<=i?o<i:o>i;a=0<=i?++o:--o)d.push(this.widths.push(n));return d},s.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},s})(),N5=[].slice,bD=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="glyf",s.prototype.parse=function(){return this.cache={}},s.prototype.glyphFor=function(r){var a,n,i,l,o,u,d,c,h,A;return r in this.cache?this.cache[r]:(l=this.file.loca,a=this.file.contents,n=l.indexOf(r),(i=l.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+n,o=(u=new du(a.read(i))).readShort(),c=u.readShort(),A=u.readShort(),d=u.readShort(),h=u.readShort(),this.cache[r]=o===-1?new jD(u,c,A,d,h):new yD(u,o,c,A,d,h),this.cache[r]))},s.prototype.encode=function(r,a,n){var i,l,o,u,d;for(o=[],l=[],u=0,d=a.length;u<d;u++)i=r[a[u]],l.push(o.length),i&&(o=o.concat(i.encode(n)));return l.push(o.length),{table:o,offsets:l}},s})(),yD=(function(){function t(s,r,a,n,i,l){this.raw=s,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=i,this.yMax=l,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t})(),jD=(function(){function t(s,r,a,n,i){var l,o;for(this.raw=s,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;o=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&o;)l.pos+=1&o?4:2,128&o?l.pos+=8:64&o?l.pos+=4:8&o&&(l.pos+=2)}return t.prototype.encode=function(){var s,r,a;for(r=new du(N5.call(this.raw.data)),s=0,a=this.glyphIDs.length;s<a;++s)r.pos=this.glyphOffsets[s];return r.data},t})(),ND=(function(t){function s(){return s.__super__.constructor.apply(this,arguments)}return cc(s,Lo),s.prototype.tag="loca",s.prototype.parse=function(r){var a,n;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var i,l;for(l=[],n=0,i=this.length;n<i;n+=2)l.push(2*r.readUInt16());return l}).call(this):(function(){var i,l;for(l=[],n=0,i=this.length;n<i;n+=4)l.push(r.readUInt32());return l}).call(this)},s.prototype.indexOf=function(r){return this.offsets[r]},s.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},s.prototype.encode=function(r,a){for(var n=new Uint32Array(this.offsets.length),i=0,l=0,o=0;o<n.length;++o)if(n[o]=i,l<a.length&&a[l]==o){++l,n[o]=i;var u=this.offsets[o],d=this.offsets[o+1]-u;d>0&&(i+=d)}for(var c=new Array(4*n.length),h=0;h<n.length;++h)c[4*h+3]=255&n[h],c[4*h+2]=(65280&n[h])>>8,c[4*h+1]=(16711680&n[h])>>16,c[4*h]=(4278190080&n[h])>>24;return c},s})(),wD=(function(){function t(s){this.font=s,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var s,r,a,n,i;for(r in n=this.font.cmap.tables[0].codeMap,s={},i=this.subset)a=i[r],s[r]=n[a];return s},t.prototype.glyphsFor=function(s){var r,a,n,i,l,o,u;for(n={},l=0,o=s.length;l<o;l++)n[i=s[l]]=this.font.glyf.glyphFor(i);for(i in r=[],n)(a=n[i])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(i in u=this.glyphsFor(r))a=u[i],n[i]=a;return n},t.prototype.encode=function(s,r){var a,n,i,l,o,u,d,c,h,A,f,g,v,b,y;for(n in a=j5.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(s),f={0:0},y=a.charMap)f[(u=y[n]).old]=u.new;for(g in A=a.maxGlyphID,l)g in f||(f[g]=A++);return c=(function(j){var N,S;for(N in S={},j)S[j[N]]=N;return S})(f),h=Object.keys(c).sort((function(j,N){return j-N})),v=(function(){var j,N,S;for(S=[],j=0,N=h.length;j<N;j++)o=h[j],S.push(c[o]);return S})(),i=this.font.glyf.encode(l,v,f),d=this.font.loca.encode(i.offsets,v),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},t})();ds.API.PDFObject=(function(){var t;function s(){}return t=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},s.convert=function(r){var a,n,i,l;if(Array.isArray(r))return"["+(function(){var o,u,d;for(d=[],o=0,u=r.length;o<u;o++)a=r[o],d.push(s.convert(a));return d})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in i=["<<"],r)l=r[n],i.push("/"+n+" "+s.convert(l));return i.push(">>"),i.join(`
`)}return""+r},s})();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Xb=function(t,s){return Xb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},Xb(t,s)};function Do(t,s){if(typeof s!="function"&&s!==null)throw new TypeError("Class extends value "+String(s)+" is not a constructor or null");Xb(t,s);function r(){this.constructor=t}t.prototype=s===null?Object.create(s):(r.prototype=s.prototype,new r)}var Jb=function(){return Jb=Object.assign||function(s){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(s[i]=r[i])}return s},Jb.apply(this,arguments)};function ki(t,s,r,a){function n(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function o(c){try{d(a.next(c))}catch(h){l(h)}}function u(c){try{d(a.throw(c))}catch(h){l(h)}}function d(c){c.done?i(c.value):n(c.value).then(o,u)}d((a=a.apply(t,[])).next())})}function ri(t,s){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,n,i,l;return l={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function o(d){return function(c){return u([d,c])}}function u(d){if(a)throw new TypeError("Generator is already executing.");for(;r;)try{if(a=1,n&&(i=d[0]&2?n.return:d[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,d[1])).done)return i;switch(n=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=s.call(t,r)}catch(c){d=[6,c],n=0}finally{a=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Qp(t,s,r){if(arguments.length===2)for(var a=0,n=s.length,i;a<n;a++)(i||!(a in s))&&(i||(i=Array.prototype.slice.call(s,0,a)),i[a]=s[a]);return t.concat(i||s)}var Jc=(function(){function t(s,r,a,n){this.left=s,this.top=r,this.width=a,this.height=n}return t.prototype.add=function(s,r,a,n){return new t(this.left+s,this.top+r,this.width+a,this.height+n)},t.fromClientRect=function(s,r){return new t(r.left+s.windowBounds.left,r.top+s.windowBounds.top,r.width,r.height)},t.fromDOMRectList=function(s,r){var a=Array.from(r).find(function(n){return n.width!==0});return a?new t(a.left+s.windowBounds.left,a.top+s.windowBounds.top,a.width,a.height):t.EMPTY},t.EMPTY=new t(0,0,0,0),t})(),$0=function(t,s){return Jc.fromClientRect(t,s.getBoundingClientRect())},_D=function(t){var s=t.body,r=t.documentElement;if(!s||!r)throw new Error("Unable to get document size");var a=Math.max(Math.max(s.scrollWidth,r.scrollWidth),Math.max(s.offsetWidth,r.offsetWidth),Math.max(s.clientWidth,r.clientWidth)),n=Math.max(Math.max(s.scrollHeight,r.scrollHeight),Math.max(s.offsetHeight,r.offsetHeight),Math.max(s.clientHeight,r.clientHeight));return new Jc(0,0,a,n)},W0=function(t){for(var s=[],r=0,a=t.length;r<a;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var i=t.charCodeAt(r++);(i&64512)===56320?s.push(((n&1023)<<10)+(i&1023)+65536):(s.push(n),r--)}else s.push(n)}return s},Oa=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var a=[],n=-1,i="";++n<r;){var l=t[n];l<=65535?a.push(l):(l-=65536,a.push((l>>10)+55296,l%1024+56320)),(n+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},Rw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",SD=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Mp=0;Mp<Rw.length;Mp++)SD[Rw.charCodeAt(Mp)]=Mp;var Ow="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Hp=0;Hp<Ow.length;Hp++)Bm[Ow.charCodeAt(Hp)]=Hp;var CD=function(t){var s=t.length*.75,r=t.length,a,n=0,i,l,o,u;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(s):new Array(s),c=Array.isArray(d)?d:new Uint8Array(d);for(a=0;a<r;a+=4)i=Bm[t.charCodeAt(a)],l=Bm[t.charCodeAt(a+1)],o=Bm[t.charCodeAt(a+2)],u=Bm[t.charCodeAt(a+3)],c[n++]=i<<2|l>>4,c[n++]=(l&15)<<4|o>>2,c[n++]=(o&3)<<6|u&63;return d},kD=function(t){for(var s=t.length,r=[],a=0;a<s;a+=2)r.push(t[a+1]<<8|t[a]);return r},BD=function(t){for(var s=t.length,r=[],a=0;a<s;a+=4)r.push(t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a]);return r},lA=5,rj=11,Bv=2,ED=rj-lA,w5=65536>>lA,FD=1<<lA,Ev=FD-1,TD=1024>>lA,ID=w5+TD,LD=ID,DD=32,UD=LD+DD,PD=65536>>rj,RD=1<<ED,OD=RD-1,Qw=function(t,s,r){return t.slice?t.slice(s,r):new Uint16Array(Array.prototype.slice.call(t,s,r))},QD=function(t,s,r){return t.slice?t.slice(s,r):new Uint32Array(Array.prototype.slice.call(t,s,r))},MD=function(t,s){var r=CD(t),a=Array.isArray(r)?BD(r):new Uint32Array(r),n=Array.isArray(r)?kD(r):new Uint16Array(r),i=24,l=Qw(n,i/2,a[4]/2),o=a[5]===2?Qw(n,(i+a[4])/2):QD(a,Math.ceil((i+a[4])/4));return new HD(a[0],a[1],a[2],a[3],l,o)},HD=(function(){function t(s,r,a,n,i,l){this.initialValue=s,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=i,this.data=l}return t.prototype.get=function(s){var r;if(s>=0){if(s<55296||s>56319&&s<=65535)return r=this.index[s>>lA],r=(r<<Bv)+(s&Ev),this.data[r];if(s<=65535)return r=this.index[w5+(s-55296>>lA)],r=(r<<Bv)+(s&Ev),this.data[r];if(s<this.highStart)return r=UD-PD+(s>>rj),r=this.index[r],r+=s>>lA&OD,r=this.index[r],r=(r<<Bv)+(s&Ev),this.data[r];if(s<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t})(),Mw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",qD=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var qp=0;qp<Mw.length;qp++)qD[Mw.charCodeAt(qp)]=qp;var VD="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",Hw=50,$D=1,_5=2,S5=3,WD=4,GD=5,qw=7,C5=8,Vw=9,eu=10,Zb=11,$w=12,ey=13,KD=14,Em=15,ty=16,Vp=17,gm=18,zD=19,Ww=20,sy=21,vm=22,Fv=23,th=24,cl=25,Fm=26,Tm=27,sh=28,YD=29,Xu=30,XD=31,$p=32,Wp=33,ry=34,ay=35,ny=36,Af=37,iy=38,Ix=39,Lx=40,Tv=41,k5=42,JD=43,ZD=[9001,65288],B5="!",hr="",Gp="",ly=MD(VD),Rc=[Xu,ny],oy=[$D,_5,S5,GD],E5=[eu,C5],Gw=[Tm,Fm],eU=oy.concat(E5),Kw=[iy,Ix,Lx,ry,ay],tU=[Em,ey],sU=function(t,s){s===void 0&&(s="strict");var r=[],a=[],n=[];return t.forEach(function(i,l){var o=ly.get(i);if(o>Hw?(n.push(!0),o-=Hw):n.push(!1),["normal","auto","loose"].indexOf(s)!==-1&&[8208,8211,12316,12448].indexOf(i)!==-1)return a.push(l),r.push(ty);if(o===WD||o===Zb){if(l===0)return a.push(l),r.push(Xu);var u=r[l-1];return eU.indexOf(u)===-1?(a.push(a[l-1]),r.push(u)):(a.push(l),r.push(Xu))}if(a.push(l),o===XD)return r.push(s==="strict"?sy:Af);if(o===k5||o===YD)return r.push(Xu);if(o===JD)return i>=131072&&i<=196605||i>=196608&&i<=262141?r.push(Af):r.push(Xu);r.push(o)}),[a,r,n]},Iv=function(t,s,r,a){var n=a[r];if(Array.isArray(t)?t.indexOf(n)!==-1:t===n)for(var i=r;i<=a.length;){i++;var l=a[i];if(l===s)return!0;if(l!==eu)break}if(n===eu)for(var i=r;i>0;){i--;var o=a[i];if(Array.isArray(t)?t.indexOf(o)!==-1:t===o)for(var u=r;u<=a.length;){u++;var l=a[u];if(l===s)return!0;if(l!==eu)break}if(o!==eu)break}return!1},zw=function(t,s){for(var r=t;r>=0;){var a=s[r];if(a===eu)r--;else return a}return 0},rU=function(t,s,r,a,n){if(r[a]===0)return hr;var i=a-1;if(Array.isArray(n)&&n[i]===!0)return hr;var l=i-1,o=i+1,u=s[i],d=l>=0?s[l]:0,c=s[o];if(u===_5&&c===S5)return hr;if(oy.indexOf(u)!==-1)return B5;if(oy.indexOf(c)!==-1||E5.indexOf(c)!==-1)return hr;if(zw(i,s)===C5)return Gp;if(ly.get(t[i])===Zb||(u===$p||u===Wp)&&ly.get(t[o])===Zb||u===qw||c===qw||u===Vw||[eu,ey,Em].indexOf(u)===-1&&c===Vw||[Vp,gm,zD,th,sh].indexOf(c)!==-1||zw(i,s)===vm||Iv(Fv,vm,i,s)||Iv([Vp,gm],sy,i,s)||Iv($w,$w,i,s))return hr;if(u===eu)return Gp;if(u===Fv||c===Fv)return hr;if(c===ty||u===ty)return Gp;if([ey,Em,sy].indexOf(c)!==-1||u===KD||d===ny&&tU.indexOf(u)!==-1||u===sh&&c===ny||c===Ww||Rc.indexOf(c)!==-1&&u===cl||Rc.indexOf(u)!==-1&&c===cl||u===Tm&&[Af,$p,Wp].indexOf(c)!==-1||[Af,$p,Wp].indexOf(u)!==-1&&c===Fm||Rc.indexOf(u)!==-1&&Gw.indexOf(c)!==-1||Gw.indexOf(u)!==-1&&Rc.indexOf(c)!==-1||[Tm,Fm].indexOf(u)!==-1&&(c===cl||[vm,Em].indexOf(c)!==-1&&s[o+1]===cl)||[vm,Em].indexOf(u)!==-1&&c===cl||u===cl&&[cl,sh,th].indexOf(c)!==-1)return hr;if([cl,sh,th,Vp,gm].indexOf(c)!==-1)for(var h=i;h>=0;){var A=s[h];if(A===cl)return hr;if([sh,th].indexOf(A)!==-1)h--;else break}if([Tm,Fm].indexOf(c)!==-1)for(var h=[Vp,gm].indexOf(u)!==-1?l:i;h>=0;){var A=s[h];if(A===cl)return hr;if([sh,th].indexOf(A)!==-1)h--;else break}if(iy===u&&[iy,Ix,ry,ay].indexOf(c)!==-1||[Ix,ry].indexOf(u)!==-1&&[Ix,Lx].indexOf(c)!==-1||[Lx,ay].indexOf(u)!==-1&&c===Lx||Kw.indexOf(u)!==-1&&[Ww,Fm].indexOf(c)!==-1||Kw.indexOf(c)!==-1&&u===Tm||Rc.indexOf(u)!==-1&&Rc.indexOf(c)!==-1||u===th&&Rc.indexOf(c)!==-1||Rc.concat(cl).indexOf(u)!==-1&&c===vm&&ZD.indexOf(t[o])===-1||Rc.concat(cl).indexOf(c)!==-1&&u===gm)return hr;if(u===Tv&&c===Tv){for(var f=r[i],g=1;f>0&&(f--,s[f]===Tv);)g++;if(g%2!==0)return hr}return u===$p&&c===Wp?hr:Gp},aU=function(t,s){s||(s={lineBreak:"normal",wordBreak:"normal"});var r=sU(t,s.lineBreak),a=r[0],n=r[1],i=r[2];(s.wordBreak==="break-all"||s.wordBreak==="break-word")&&(n=n.map(function(o){return[cl,Xu,k5].indexOf(o)!==-1?Af:o}));var l=s.wordBreak==="keep-all"?i.map(function(o,u){return o&&t[u]>=19968&&t[u]<=40959}):void 0;return[a,n,l]},nU=(function(){function t(s,r,a,n){this.codePoints=s,this.required=r===B5,this.start=a,this.end=n}return t.prototype.slice=function(){return Oa.apply(void 0,this.codePoints.slice(this.start,this.end))},t})(),iU=function(t,s){var r=W0(t),a=aU(r,s),n=a[0],i=a[1],l=a[2],o=r.length,u=0,d=0;return{next:function(){if(d>=o)return{done:!0,value:null};for(var c=hr;d<o&&(c=rU(r,i,n,++d,l))===hr;);if(c!==hr||d===o){var h=new nU(r,c,u,d);return u=d,{value:h,done:!1}}return{done:!0,value:null}}}},lU=1,oU=2,Rf=4,Yw=8,Xx=10,Xw=47,Vm=92,cU=9,dU=32,Kp=34,bm=61,uU=35,AU=36,hU=37,zp=39,Yp=40,ym=41,mU=95,Gi=45,fU=33,pU=60,xU=62,gU=64,vU=91,bU=93,yU=61,jU=123,Xp=63,NU=125,Jw=124,wU=126,_U=128,Zw=65533,Lv=42,sA=43,SU=44,CU=58,kU=59,hf=46,BU=0,EU=8,FU=11,TU=14,IU=31,LU=127,ec=-1,F5=48,T5=97,I5=101,DU=102,UU=117,PU=122,L5=65,D5=69,U5=70,RU=85,OU=90,ni=function(t){return t>=F5&&t<=57},QU=function(t){return t>=55296&&t<=57343},rh=function(t){return ni(t)||t>=L5&&t<=U5||t>=T5&&t<=DU},MU=function(t){return t>=T5&&t<=PU},HU=function(t){return t>=L5&&t<=OU},qU=function(t){return MU(t)||HU(t)},VU=function(t){return t>=_U},Jp=function(t){return t===Xx||t===cU||t===dU},Jx=function(t){return qU(t)||VU(t)||t===mU},e2=function(t){return Jx(t)||ni(t)||t===Gi},$U=function(t){return t>=BU&&t<=EU||t===FU||t>=TU&&t<=IU||t===LU},zd=function(t,s){return t!==Vm?!1:s!==Xx},Zp=function(t,s,r){return t===Gi?Jx(s)||zd(s,r):Jx(t)?!0:!!(t===Vm&&zd(t,s))},Dv=function(t,s,r){return t===sA||t===Gi?ni(s)?!0:s===hf&&ni(r):ni(t===hf?s:t)},WU=function(t){var s=0,r=1;(t[s]===sA||t[s]===Gi)&&(t[s]===Gi&&(r=-1),s++);for(var a=[];ni(t[s]);)a.push(t[s++]);var n=a.length?parseInt(Oa.apply(void 0,a),10):0;t[s]===hf&&s++;for(var i=[];ni(t[s]);)i.push(t[s++]);var l=i.length,o=l?parseInt(Oa.apply(void 0,i),10):0;(t[s]===D5||t[s]===I5)&&s++;var u=1;(t[s]===sA||t[s]===Gi)&&(t[s]===Gi&&(u=-1),s++);for(var d=[];ni(t[s]);)d.push(t[s++]);var c=d.length?parseInt(Oa.apply(void 0,d),10):0;return r*(n+o*Math.pow(10,-l))*Math.pow(10,u*c)},GU={type:2},KU={type:3},zU={type:4},YU={type:13},XU={type:8},JU={type:21},ZU={type:9},eP={type:10},tP={type:11},sP={type:12},rP={type:14},ex={type:23},aP={type:1},nP={type:25},iP={type:24},lP={type:26},oP={type:27},cP={type:28},dP={type:29},uP={type:31},cy={type:32},P5=(function(){function t(){this._value=[]}return t.prototype.write=function(s){this._value=this._value.concat(W0(s))},t.prototype.read=function(){for(var s=[],r=this.consumeToken();r!==cy;)s.push(r),r=this.consumeToken();return s},t.prototype.consumeToken=function(){var s=this.consumeCodePoint();switch(s){case Kp:return this.consumeStringToken(Kp);case uU:var r=this.peekCodePoint(0),a=this.peekCodePoint(1),n=this.peekCodePoint(2);if(e2(r)||zd(a,n)){var i=Zp(r,a,n)?oU:lU,l=this.consumeName();return{type:5,value:l,flags:i}}break;case AU:if(this.peekCodePoint(0)===bm)return this.consumeCodePoint(),YU;break;case zp:return this.consumeStringToken(zp);case Yp:return GU;case ym:return KU;case Lv:if(this.peekCodePoint(0)===bm)return this.consumeCodePoint(),rP;break;case sA:if(Dv(s,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(s),this.consumeNumericToken();break;case SU:return zU;case Gi:var o=s,u=this.peekCodePoint(0),d=this.peekCodePoint(1);if(Dv(o,u,d))return this.reconsumeCodePoint(s),this.consumeNumericToken();if(Zp(o,u,d))return this.reconsumeCodePoint(s),this.consumeIdentLikeToken();if(u===Gi&&d===xU)return this.consumeCodePoint(),this.consumeCodePoint(),iP;break;case hf:if(Dv(s,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(s),this.consumeNumericToken();break;case Xw:if(this.peekCodePoint(0)===Lv)for(this.consumeCodePoint();;){var c=this.consumeCodePoint();if(c===Lv&&(c=this.consumeCodePoint(),c===Xw))return this.consumeToken();if(c===ec)return this.consumeToken()}break;case CU:return lP;case kU:return oP;case pU:if(this.peekCodePoint(0)===fU&&this.peekCodePoint(1)===Gi&&this.peekCodePoint(2)===Gi)return this.consumeCodePoint(),this.consumeCodePoint(),nP;break;case gU:var h=this.peekCodePoint(0),A=this.peekCodePoint(1),f=this.peekCodePoint(2);if(Zp(h,A,f)){var l=this.consumeName();return{type:7,value:l}}break;case vU:return cP;case Vm:if(zd(s,this.peekCodePoint(0)))return this.reconsumeCodePoint(s),this.consumeIdentLikeToken();break;case bU:return dP;case yU:if(this.peekCodePoint(0)===bm)return this.consumeCodePoint(),XU;break;case jU:return tP;case NU:return sP;case UU:case RU:var g=this.peekCodePoint(0),v=this.peekCodePoint(1);return g===sA&&(rh(v)||v===Xp)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(s),this.consumeIdentLikeToken();case Jw:if(this.peekCodePoint(0)===bm)return this.consumeCodePoint(),ZU;if(this.peekCodePoint(0)===Jw)return this.consumeCodePoint(),JU;break;case wU:if(this.peekCodePoint(0)===bm)return this.consumeCodePoint(),eP;break;case ec:return cy}return Jp(s)?(this.consumeWhiteSpace(),uP):ni(s)?(this.reconsumeCodePoint(s),this.consumeNumericToken()):Jx(s)?(this.reconsumeCodePoint(s),this.consumeIdentLikeToken()):{type:6,value:Oa(s)}},t.prototype.consumeCodePoint=function(){var s=this._value.shift();return typeof s>"u"?-1:s},t.prototype.reconsumeCodePoint=function(s){this._value.unshift(s)},t.prototype.peekCodePoint=function(s){return s>=this._value.length?-1:this._value[s]},t.prototype.consumeUnicodeRangeToken=function(){for(var s=[],r=this.consumeCodePoint();rh(r)&&s.length<6;)s.push(r),r=this.consumeCodePoint();for(var a=!1;r===Xp&&s.length<6;)s.push(r),r=this.consumeCodePoint(),a=!0;if(a){var n=parseInt(Oa.apply(void 0,s.map(function(u){return u===Xp?F5:u})),16),i=parseInt(Oa.apply(void 0,s.map(function(u){return u===Xp?U5:u})),16);return{type:30,start:n,end:i}}var l=parseInt(Oa.apply(void 0,s),16);if(this.peekCodePoint(0)===Gi&&rh(this.peekCodePoint(1))){this.consumeCodePoint(),r=this.consumeCodePoint();for(var o=[];rh(r)&&o.length<6;)o.push(r),r=this.consumeCodePoint();var i=parseInt(Oa.apply(void 0,o),16);return{type:30,start:l,end:i}}else return{type:30,start:l,end:l}},t.prototype.consumeIdentLikeToken=function(){var s=this.consumeName();return s.toLowerCase()==="url"&&this.peekCodePoint(0)===Yp?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Yp?(this.consumeCodePoint(),{type:19,value:s}):{type:20,value:s}},t.prototype.consumeUrlToken=function(){var s=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===ec)return{type:22,value:""};var r=this.peekCodePoint(0);if(r===zp||r===Kp){var a=this.consumeStringToken(this.consumeCodePoint());return a.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===ec||this.peekCodePoint(0)===ym)?(this.consumeCodePoint(),{type:22,value:a.value}):(this.consumeBadUrlRemnants(),ex)}for(;;){var n=this.consumeCodePoint();if(n===ec||n===ym)return{type:22,value:Oa.apply(void 0,s)};if(Jp(n))return this.consumeWhiteSpace(),this.peekCodePoint(0)===ec||this.peekCodePoint(0)===ym?(this.consumeCodePoint(),{type:22,value:Oa.apply(void 0,s)}):(this.consumeBadUrlRemnants(),ex);if(n===Kp||n===zp||n===Yp||$U(n))return this.consumeBadUrlRemnants(),ex;if(n===Vm)if(zd(n,this.peekCodePoint(0)))s.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),ex;else s.push(n)}},t.prototype.consumeWhiteSpace=function(){for(;Jp(this.peekCodePoint(0));)this.consumeCodePoint()},t.prototype.consumeBadUrlRemnants=function(){for(;;){var s=this.consumeCodePoint();if(s===ym||s===ec)return;zd(s,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},t.prototype.consumeStringSlice=function(s){for(var r=5e4,a="";s>0;){var n=Math.min(r,s);a+=Oa.apply(void 0,this._value.splice(0,n)),s-=n}return this._value.shift(),a},t.prototype.consumeStringToken=function(s){var r="",a=0;do{var n=this._value[a];if(n===ec||n===void 0||n===s)return r+=this.consumeStringSlice(a),{type:0,value:r};if(n===Xx)return this._value.splice(0,a),aP;if(n===Vm){var i=this._value[a+1];i!==ec&&i!==void 0&&(i===Xx?(r+=this.consumeStringSlice(a),a=-1,this._value.shift()):zd(n,i)&&(r+=this.consumeStringSlice(a),r+=Oa(this.consumeEscapedCodePoint()),a=-1))}a++}while(!0)},t.prototype.consumeNumber=function(){var s=[],r=Rf,a=this.peekCodePoint(0);for((a===sA||a===Gi)&&s.push(this.consumeCodePoint());ni(this.peekCodePoint(0));)s.push(this.consumeCodePoint());a=this.peekCodePoint(0);var n=this.peekCodePoint(1);if(a===hf&&ni(n))for(s.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Yw;ni(this.peekCodePoint(0));)s.push(this.consumeCodePoint());a=this.peekCodePoint(0),n=this.peekCodePoint(1);var i=this.peekCodePoint(2);if((a===D5||a===I5)&&((n===sA||n===Gi)&&ni(i)||ni(n)))for(s.push(this.consumeCodePoint(),this.consumeCodePoint()),r=Yw;ni(this.peekCodePoint(0));)s.push(this.consumeCodePoint());return[WU(s),r]},t.prototype.consumeNumericToken=function(){var s=this.consumeNumber(),r=s[0],a=s[1],n=this.peekCodePoint(0),i=this.peekCodePoint(1),l=this.peekCodePoint(2);if(Zp(n,i,l)){var o=this.consumeName();return{type:15,number:r,flags:a,unit:o}}return n===hU?(this.consumeCodePoint(),{type:16,number:r,flags:a}):{type:17,number:r,flags:a}},t.prototype.consumeEscapedCodePoint=function(){var s=this.consumeCodePoint();if(rh(s)){for(var r=Oa(s);rh(this.peekCodePoint(0))&&r.length<6;)r+=Oa(this.consumeCodePoint());Jp(this.peekCodePoint(0))&&this.consumeCodePoint();var a=parseInt(r,16);return a===0||QU(a)||a>1114111?Zw:a}return s===ec?Zw:s},t.prototype.consumeName=function(){for(var s="";;){var r=this.consumeCodePoint();if(e2(r))s+=Oa(r);else if(zd(r,this.peekCodePoint(0)))s+=Oa(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(r),s}},t})(),R5=(function(){function t(s){this._tokens=s}return t.create=function(s){var r=new P5;return r.write(s),new t(r.read())},t.parseValue=function(s){return t.create(s).parseComponentValue()},t.parseValues=function(s){return t.create(s).parseComponentValues()},t.prototype.parseComponentValue=function(){for(var s=this.consumeToken();s.type===31;)s=this.consumeToken();if(s.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(s);var r=this.consumeComponentValue();do s=this.consumeToken();while(s.type===31);if(s.type===32)return r;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},t.prototype.parseComponentValues=function(){for(var s=[];;){var r=this.consumeComponentValue();if(r.type===32)return s;s.push(r),s.push()}},t.prototype.consumeComponentValue=function(){var s=this.consumeToken();switch(s.type){case 11:case 28:case 2:return this.consumeSimpleBlock(s.type);case 19:return this.consumeFunction(s)}return s},t.prototype.consumeSimpleBlock=function(s){for(var r={type:s,values:[]},a=this.consumeToken();;){if(a.type===32||hP(a,s))return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue()),a=this.consumeToken()}},t.prototype.consumeFunction=function(s){for(var r={name:s.value,values:[],type:18};;){var a=this.consumeToken();if(a.type===32||a.type===3)return r;this.reconsumeToken(a),r.values.push(this.consumeComponentValue())}},t.prototype.consumeToken=function(){var s=this._tokens.shift();return typeof s>"u"?cy:s},t.prototype.reconsumeToken=function(s){this._tokens.unshift(s)},t})(),Of=function(t){return t.type===15},$h=function(t){return t.type===17},Vr=function(t){return t.type===20},AP=function(t){return t.type===0},dy=function(t,s){return Vr(t)&&t.value===s},O5=function(t){return t.type!==31},Lh=function(t){return t.type!==31&&t.type!==4},dc=function(t){var s=[],r=[];return t.forEach(function(a){if(a.type===4){if(r.length===0)throw new Error("Error parsing function args, zero tokens for arg");s.push(r),r=[];return}a.type!==31&&r.push(a)}),r.length&&s.push(r),s},hP=function(t,s){return s===11&&t.type===12||s===28&&t.type===29?!0:s===2&&t.type===3},uu=function(t){return t.type===17||t.type===15},tn=function(t){return t.type===16||uu(t)},Q5=function(t){return t.length>1?[t[0],t[1]]:[t[0]]},On={type:17,number:0,flags:Rf},aj={type:16,number:50,flags:Rf},tu={type:16,number:100,flags:Rf},Im=function(t,s,r){var a=t[0],n=t[1];return[Jr(a,s),Jr(typeof n<"u"?n:a,r)]},Jr=function(t,s){if(t.type===16)return t.number/100*s;if(Of(t))switch(t.unit){case"rem":case"em":return 16*t.number;case"px":default:return t.number}return t.number},M5="deg",H5="grad",q5="rad",V5="turn",G0={name:"angle",parse:function(t,s){if(s.type===15)switch(s.unit){case M5:return Math.PI*s.number/180;case H5:return Math.PI/200*s.number;case q5:return s.number;case V5:return Math.PI*2*s.number}throw new Error("Unsupported angle type")}},$5=function(t){return t.type===15&&(t.unit===M5||t.unit===H5||t.unit===q5||t.unit===V5)},W5=function(t){var s=t.filter(Vr).map(function(r){return r.value}).join(" ");switch(s){case"to bottom right":case"to right bottom":case"left top":case"top left":return[On,On];case"to top":case"bottom":return ql(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[On,tu];case"to right":case"left":return ql(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[tu,tu];case"to bottom":case"top":return ql(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[tu,On];case"to left":case"right":return ql(270)}return 0},ql=function(t){return Math.PI*t/180},iu={name:"color",parse:function(t,s){if(s.type===18){var r=mP[s.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported color function "'+s.name+'"');return r(t,s.values)}if(s.type===5){if(s.value.length===3){var a=s.value.substring(0,1),n=s.value.substring(1,2),i=s.value.substring(2,3);return su(parseInt(a+a,16),parseInt(n+n,16),parseInt(i+i,16),1)}if(s.value.length===4){var a=s.value.substring(0,1),n=s.value.substring(1,2),i=s.value.substring(2,3),l=s.value.substring(3,4);return su(parseInt(a+a,16),parseInt(n+n,16),parseInt(i+i,16),parseInt(l+l,16)/255)}if(s.value.length===6){var a=s.value.substring(0,2),n=s.value.substring(2,4),i=s.value.substring(4,6);return su(parseInt(a,16),parseInt(n,16),parseInt(i,16),1)}if(s.value.length===8){var a=s.value.substring(0,2),n=s.value.substring(2,4),i=s.value.substring(4,6),l=s.value.substring(6,8);return su(parseInt(a,16),parseInt(n,16),parseInt(i,16),parseInt(l,16)/255)}}if(s.type===20){var o=Wc[s.value.toUpperCase()];if(typeof o<"u")return o}return Wc.TRANSPARENT}},lu=function(t){return(255&t)===0},yn=function(t){var s=255&t,r=255&t>>8,a=255&t>>16,n=255&t>>24;return s<255?"rgba("+n+","+a+","+r+","+s/255+")":"rgb("+n+","+a+","+r+")"},su=function(t,s,r,a){return(t<<24|s<<16|r<<8|Math.round(a*255)<<0)>>>0},t2=function(t,s){if(t.type===17)return t.number;if(t.type===16){var r=s===3?1:255;return s===3?t.number/100*r:Math.round(t.number/100*r)}return 0},s2=function(t,s){var r=s.filter(Lh);if(r.length===3){var a=r.map(t2),n=a[0],i=a[1],l=a[2];return su(n,i,l,1)}if(r.length===4){var o=r.map(t2),n=o[0],i=o[1],l=o[2],u=o[3];return su(n,i,l,u)}return 0};function Uv(t,s,r){return r<0&&(r+=1),r>=1&&(r-=1),r<1/6?(s-t)*r*6+t:r<1/2?s:r<2/3?(s-t)*6*(2/3-r)+t:t}var r2=function(t,s){var r=s.filter(Lh),a=r[0],n=r[1],i=r[2],l=r[3],o=(a.type===17?ql(a.number):G0.parse(t,a))/(Math.PI*2),u=tn(n)?n.number/100:0,d=tn(i)?i.number/100:0,c=typeof l<"u"&&tn(l)?Jr(l,1):1;if(u===0)return su(d*255,d*255,d*255,1);var h=d<=.5?d*(u+1):d+u-d*u,A=d*2-h,f=Uv(A,h,o+1/3),g=Uv(A,h,o),v=Uv(A,h,o-1/3);return su(f*255,g*255,v*255,c)},mP={hsl:r2,hsla:r2,rgb:s2,rgba:s2},$m=function(t,s){return iu.parse(t,R5.create(s).parseComponentValue())},Wc={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},fP={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,s){return s.map(function(r){if(Vr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},pP={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},K0=function(t,s){var r=iu.parse(t,s[0]),a=s[1];return a&&tn(a)?{color:r,stop:a}:{color:r,stop:null}},a2=function(t,s){var r=t[0],a=t[t.length-1];r.stop===null&&(r.stop=On),a.stop===null&&(a.stop=tu);for(var n=[],i=0,l=0;l<t.length;l++){var o=t[l].stop;if(o!==null){var u=Jr(o,s);u>i?n.push(u):n.push(i),i=u}else n.push(null)}for(var d=null,l=0;l<n.length;l++){var c=n[l];if(c===null)d===null&&(d=l);else if(d!==null){for(var h=l-d,A=n[d-1],f=(c-A)/(h+1),g=1;g<=h;g++)n[d+g-1]=f*g;d=null}}return t.map(function(v,b){var y=v.color;return{color:y,stop:Math.max(Math.min(1,n[b]/s),0)}})},xP=function(t,s,r){var a=s/2,n=r/2,i=Jr(t[0],s)-a,l=n-Jr(t[1],r);return(Math.atan2(l,i)+Math.PI*2)%(Math.PI*2)},gP=function(t,s,r){var a=typeof t=="number"?t:xP(t,s,r),n=Math.abs(s*Math.sin(a))+Math.abs(r*Math.cos(a)),i=s/2,l=r/2,o=n/2,u=Math.sin(a-Math.PI/2)*o,d=Math.cos(a-Math.PI/2)*o;return[n,i-d,i+d,l-u,l+u]},wo=function(t,s){return Math.sqrt(t*t+s*s)},n2=function(t,s,r,a,n){var i=[[0,0],[0,s],[t,0],[t,s]];return i.reduce(function(l,o){var u=o[0],d=o[1],c=wo(r-u,a-d);return(n?c<l.optimumDistance:c>l.optimumDistance)?{optimumCorner:o,optimumDistance:c}:l},{optimumDistance:n?1/0:-1/0,optimumCorner:null}).optimumCorner},vP=function(t,s,r,a,n){var i=0,l=0;switch(t.size){case 0:t.shape===0?i=l=Math.min(Math.abs(s),Math.abs(s-a),Math.abs(r),Math.abs(r-n)):t.shape===1&&(i=Math.min(Math.abs(s),Math.abs(s-a)),l=Math.min(Math.abs(r),Math.abs(r-n)));break;case 2:if(t.shape===0)i=l=Math.min(wo(s,r),wo(s,r-n),wo(s-a,r),wo(s-a,r-n));else if(t.shape===1){var o=Math.min(Math.abs(r),Math.abs(r-n))/Math.min(Math.abs(s),Math.abs(s-a)),u=n2(a,n,s,r,!0),d=u[0],c=u[1];i=wo(d-s,(c-r)/o),l=o*i}break;case 1:t.shape===0?i=l=Math.max(Math.abs(s),Math.abs(s-a),Math.abs(r),Math.abs(r-n)):t.shape===1&&(i=Math.max(Math.abs(s),Math.abs(s-a)),l=Math.max(Math.abs(r),Math.abs(r-n)));break;case 3:if(t.shape===0)i=l=Math.max(wo(s,r),wo(s,r-n),wo(s-a,r),wo(s-a,r-n));else if(t.shape===1){var o=Math.max(Math.abs(r),Math.abs(r-n))/Math.max(Math.abs(s),Math.abs(s-a)),h=n2(a,n,s,r,!1),d=h[0],c=h[1];i=wo(d-s,(c-r)/o),l=o*i}break}return Array.isArray(t.size)&&(i=Jr(t.size[0],a),l=t.size.length===2?Jr(t.size[1],n):i),[i,l]},bP=function(t,s){var r=ql(180),a=[];return dc(s).forEach(function(n,i){if(i===0){var l=n[0];if(l.type===20&&l.value==="to"){r=W5(n);return}else if($5(l)){r=G0.parse(t,l);return}}var o=K0(t,n);a.push(o)}),{angle:r,stops:a,type:1}},tx=function(t,s){var r=ql(180),a=[];return dc(s).forEach(function(n,i){if(i===0){var l=n[0];if(l.type===20&&["top","left","right","bottom"].indexOf(l.value)!==-1){r=W5(n);return}else if($5(l)){r=(G0.parse(t,l)+ql(270))%ql(360);return}}var o=K0(t,n);a.push(o)}),{angle:r,stops:a,type:1}},yP=function(t,s){var r=ql(180),a=[],n=1,i=0,l=3,o=[];return dc(s).forEach(function(u,d){var c=u[0];if(d===0){if(Vr(c)&&c.value==="linear"){n=1;return}else if(Vr(c)&&c.value==="radial"){n=2;return}}if(c.type===18){if(c.name==="from"){var h=iu.parse(t,c.values[0]);a.push({stop:On,color:h})}else if(c.name==="to"){var h=iu.parse(t,c.values[0]);a.push({stop:tu,color:h})}else if(c.name==="color-stop"){var A=c.values.filter(Lh);if(A.length===2){var h=iu.parse(t,A[1]),f=A[0];$h(f)&&a.push({stop:{type:16,number:f.number*100,flags:f.flags},color:h})}}}}),n===1?{angle:(r+ql(180))%ql(360),stops:a,type:n}:{size:l,shape:i,stops:a,position:o,type:n}},G5="closest-side",K5="farthest-side",z5="closest-corner",Y5="farthest-corner",X5="circle",J5="ellipse",Z5="cover",e4="contain",jP=function(t,s){var r=0,a=3,n=[],i=[];return dc(s).forEach(function(l,o){var u=!0;if(o===0){var d=!1;u=l.reduce(function(h,A){if(d)if(Vr(A))switch(A.value){case"center":return i.push(aj),h;case"top":case"left":return i.push(On),h;case"right":case"bottom":return i.push(tu),h}else(tn(A)||uu(A))&&i.push(A);else if(Vr(A))switch(A.value){case X5:return r=0,!1;case J5:return r=1,!1;case"at":return d=!0,!1;case G5:return a=0,!1;case Z5:case K5:return a=1,!1;case e4:case z5:return a=2,!1;case Y5:return a=3,!1}else if(uu(A)||tn(A))return Array.isArray(a)||(a=[]),a.push(A),!1;return h},u)}if(u){var c=K0(t,l);n.push(c)}}),{size:a,shape:r,stops:n,position:i,type:2}},sx=function(t,s){var r=0,a=3,n=[],i=[];return dc(s).forEach(function(l,o){var u=!0;if(o===0?u=l.reduce(function(c,h){if(Vr(h))switch(h.value){case"center":return i.push(aj),!1;case"top":case"left":return i.push(On),!1;case"right":case"bottom":return i.push(tu),!1}else if(tn(h)||uu(h))return i.push(h),!1;return c},u):o===1&&(u=l.reduce(function(c,h){if(Vr(h))switch(h.value){case X5:return r=0,!1;case J5:return r=1,!1;case e4:case G5:return a=0,!1;case K5:return a=1,!1;case z5:return a=2,!1;case Z5:case Y5:return a=3,!1}else if(uu(h)||tn(h))return Array.isArray(a)||(a=[]),a.push(h),!1;return c},u)),u){var d=K0(t,l);n.push(d)}}),{size:a,shape:r,stops:n,position:i,type:2}},NP=function(t){return t.type===1},wP=function(t){return t.type===2},nj={name:"image",parse:function(t,s){if(s.type===22){var r={url:s.value,type:0};return t.cache.addImage(s.value),r}if(s.type===18){var a=t4[s.name];if(typeof a>"u")throw new Error('Attempting to parse an unsupported image function "'+s.name+'"');return a(t,s.values)}throw new Error("Unsupported image type "+s.type)}};function _P(t){return!(t.type===20&&t.value==="none")&&(t.type!==18||!!t4[t.name])}var t4={"linear-gradient":bP,"-moz-linear-gradient":tx,"-ms-linear-gradient":tx,"-o-linear-gradient":tx,"-webkit-linear-gradient":tx,"radial-gradient":jP,"-moz-radial-gradient":sx,"-ms-radial-gradient":sx,"-o-radial-gradient":sx,"-webkit-radial-gradient":sx,"-webkit-gradient":yP},SP={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,s){if(s.length===0)return[];var r=s[0];return r.type===20&&r.value==="none"?[]:s.filter(function(a){return Lh(a)&&_P(a)}).map(function(a){return nj.parse(t,a)})}},CP={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,s){return s.map(function(r){if(Vr(r))switch(r.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},kP={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,s){return dc(s).map(function(r){return r.filter(tn)}).map(Q5)}},BP={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,s){return dc(s).map(function(r){return r.filter(Vr).map(function(a){return a.value}).join(" ")}).map(EP)}},EP=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},_h;(function(t){t.AUTO="auto",t.CONTAIN="contain",t.COVER="cover"})(_h||(_h={}));var FP={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(t,s){return dc(s).map(function(r){return r.filter(TP)})}},TP=function(t){return Vr(t)||tn(t)},z0=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},IP=z0("top"),LP=z0("right"),DP=z0("bottom"),UP=z0("left"),Y0=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(s,r){return Q5(r.filter(tn))}}},PP=Y0("top-left"),RP=Y0("top-right"),OP=Y0("bottom-right"),QP=Y0("bottom-left"),X0=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(s,r){switch(r){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},MP=X0("top"),HP=X0("right"),qP=X0("bottom"),VP=X0("left"),J0=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(s,r){return Of(r)?r.number:0}}},$P=J0("top"),WP=J0("right"),GP=J0("bottom"),KP=J0("left"),zP={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},YP={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,s){switch(s){case"rtl":return 1;case"ltr":default:return 0}}},XP={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,s){return s.filter(Vr).reduce(function(r,a){return r|JP(a.value)},0)}},JP=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},ZP={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},eR={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,s){return s.type===20&&s.value==="normal"?0:s.type===17||s.type===15?s.number:0}},Zx;(function(t){t.NORMAL="normal",t.STRICT="strict"})(Zx||(Zx={}));var tR={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"strict":return Zx.STRICT;case"normal":default:return Zx.NORMAL}}},sR={name:"line-height",initialValue:"normal",prefix:!1,type:4},i2=function(t,s){return Vr(t)&&t.value==="normal"?1.2*s:t.type===17?s*t.number:tn(t)?Jr(t,s):s},rR={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,s){return s.type===20&&s.value==="none"?null:nj.parse(t,s)}},aR={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,s){switch(s){case"inside":return 0;case"outside":default:return 1}}},uy={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Z0=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}},nR=Z0("top"),iR=Z0("right"),lR=Z0("bottom"),oR=Z0("left"),cR={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,s){return s.filter(Vr).map(function(r){switch(r.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},dR={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"break-word":return"break-word";case"normal":default:return"normal"}}},eg=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},uR=eg("top"),AR=eg("right"),hR=eg("bottom"),mR=eg("left"),fR={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,s){switch(s){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},pR={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,s){switch(s){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},xR={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.length===1&&dy(s[0],"none")?[]:dc(s).map(function(r){for(var a={color:Wc.TRANSPARENT,offsetX:On,offsetY:On,blur:On},n=0,i=0;i<r.length;i++){var l=r[i];uu(l)?(n===0?a.offsetX=l:n===1?a.offsetY=l:a.blur=l,n++):a.color=iu.parse(t,l)}return a})}},gR={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},vR={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,s){if(s.type===20&&s.value==="none")return null;if(s.type===18){var r=jR[s.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported transform function "'+s.name+'"');return r(s.values)}return null}},bR=function(t){var s=t.filter(function(r){return r.type===17}).map(function(r){return r.number});return s.length===6?s:null},yR=function(t){var s=t.filter(function(u){return u.type===17}).map(function(u){return u.number}),r=s[0],a=s[1];s[2],s[3];var n=s[4],i=s[5];s[6],s[7],s[8],s[9],s[10],s[11];var l=s[12],o=s[13];return s[14],s[15],s.length===16?[r,a,n,i,l,o]:null},jR={matrix:bR,matrix3d:yR},l2={type:16,number:50,flags:Rf},NR=[l2,l2],wR={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,s){var r=s.filter(tn);return r.length!==2?NR:[r[0],r[1]]}},_R={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,s){switch(s){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Wm;(function(t){t.NORMAL="normal",t.BREAK_ALL="break-all",t.KEEP_ALL="keep-all"})(Wm||(Wm={}));var SR={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"break-all":return Wm.BREAK_ALL;case"keep-all":return Wm.KEEP_ALL;case"normal":default:return Wm.NORMAL}}},CR={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,s){if(s.type===20)return{auto:!0,order:0};if($h(s))return{auto:!1,order:s.number};throw new Error("Invalid z-index number parsed")}},s4={name:"time",parse:function(t,s){if(s.type===15)switch(s.unit.toLowerCase()){case"s":return 1e3*s.number;case"ms":return s.number}throw new Error("Unsupported time type")}},kR={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,s){return $h(s)?s.number:1}},BR={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},ER={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,s){return s.filter(Vr).map(function(r){switch(r.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(r){return r!==0})}},FR={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,s){var r=[],a=[];return s.forEach(function(n){switch(n.type){case 20:case 0:r.push(n.value);break;case 17:r.push(n.number.toString());break;case 4:a.push(r.join(" ")),r.length=0;break}}),r.length&&a.push(r.join(" ")),a.map(function(n){return n.indexOf(" ")===-1?n:"'"+n+"'"})}},TR={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},IR={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,s){if($h(s))return s.number;if(Vr(s))switch(s.value){case"bold":return 700;case"normal":default:return 400}return 400}},LR={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.filter(Vr).map(function(r){return r.value})}},DR={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,s){switch(s){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},ln=function(t,s){return(t&s)!==0},UR={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,s){if(s.length===0)return[];var r=s[0];return r.type===20&&r.value==="none"?[]:s}},PR={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return null;var r=s[0];if(r.type===20&&r.value==="none")return null;for(var a=[],n=s.filter(O5),i=0;i<n.length;i++){var l=n[i],o=n[i+1];if(l.type===20){var u=o&&$h(o)?o.number:1;a.push({counter:l.value,increment:u})}}return a}},RR={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return[];for(var r=[],a=s.filter(O5),n=0;n<a.length;n++){var i=a[n],l=a[n+1];if(Vr(i)&&i.value!=="none"){var o=l&&$h(l)?l.number:0;r.push({counter:i.value,reset:o})}}return r}},OR={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,s){return s.filter(Of).map(function(r){return s4.parse(t,r)})}},QR={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,s){if(s.length===0)return null;var r=s[0];if(r.type===20&&r.value==="none")return null;var a=[],n=s.filter(AP);if(n.length%2!==0)return null;for(var i=0;i<n.length;i+=2){var l=n[i].value,o=n[i+1].value;a.push({open:l,close:o})}return a}},o2=function(t,s,r){if(!t)return"";var a=t[Math.min(s,t.length-1)];return a?r?a.open:a.close:""},MR={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,s){return s.length===1&&dy(s[0],"none")?[]:dc(s).map(function(r){for(var a={color:255,offsetX:On,offsetY:On,blur:On,spread:On,inset:!1},n=0,i=0;i<r.length;i++){var l=r[i];dy(l,"inset")?a.inset=!0:uu(l)?(n===0?a.offsetX=l:n===1?a.offsetY=l:n===2?a.blur=l:a.spread=l,n++):a.color=iu.parse(t,l)}return a})}},HR={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,s){var r=[0,1,2],a=[];return s.filter(Vr).forEach(function(n){switch(n.value){case"stroke":a.push(1);break;case"fill":a.push(0);break;case"markers":a.push(2);break}}),r.forEach(function(n){a.indexOf(n)===-1&&a.push(n)}),a}},qR={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},VR={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,s){return Of(s)?s.number:0}},$R=(function(){function t(s,r){var a,n;this.animationDuration=Cs(s,OR,r.animationDuration),this.backgroundClip=Cs(s,fP,r.backgroundClip),this.backgroundColor=Cs(s,pP,r.backgroundColor),this.backgroundImage=Cs(s,SP,r.backgroundImage),this.backgroundOrigin=Cs(s,CP,r.backgroundOrigin),this.backgroundPosition=Cs(s,kP,r.backgroundPosition),this.backgroundRepeat=Cs(s,BP,r.backgroundRepeat),this.backgroundSize=Cs(s,FP,r.backgroundSize),this.borderTopColor=Cs(s,IP,r.borderTopColor),this.borderRightColor=Cs(s,LP,r.borderRightColor),this.borderBottomColor=Cs(s,DP,r.borderBottomColor),this.borderLeftColor=Cs(s,UP,r.borderLeftColor),this.borderTopLeftRadius=Cs(s,PP,r.borderTopLeftRadius),this.borderTopRightRadius=Cs(s,RP,r.borderTopRightRadius),this.borderBottomRightRadius=Cs(s,OP,r.borderBottomRightRadius),this.borderBottomLeftRadius=Cs(s,QP,r.borderBottomLeftRadius),this.borderTopStyle=Cs(s,MP,r.borderTopStyle),this.borderRightStyle=Cs(s,HP,r.borderRightStyle),this.borderBottomStyle=Cs(s,qP,r.borderBottomStyle),this.borderLeftStyle=Cs(s,VP,r.borderLeftStyle),this.borderTopWidth=Cs(s,$P,r.borderTopWidth),this.borderRightWidth=Cs(s,WP,r.borderRightWidth),this.borderBottomWidth=Cs(s,GP,r.borderBottomWidth),this.borderLeftWidth=Cs(s,KP,r.borderLeftWidth),this.boxShadow=Cs(s,MR,r.boxShadow),this.color=Cs(s,zP,r.color),this.direction=Cs(s,YP,r.direction),this.display=Cs(s,XP,r.display),this.float=Cs(s,ZP,r.cssFloat),this.fontFamily=Cs(s,FR,r.fontFamily),this.fontSize=Cs(s,TR,r.fontSize),this.fontStyle=Cs(s,DR,r.fontStyle),this.fontVariant=Cs(s,LR,r.fontVariant),this.fontWeight=Cs(s,IR,r.fontWeight),this.letterSpacing=Cs(s,eR,r.letterSpacing),this.lineBreak=Cs(s,tR,r.lineBreak),this.lineHeight=Cs(s,sR,r.lineHeight),this.listStyleImage=Cs(s,rR,r.listStyleImage),this.listStylePosition=Cs(s,aR,r.listStylePosition),this.listStyleType=Cs(s,uy,r.listStyleType),this.marginTop=Cs(s,nR,r.marginTop),this.marginRight=Cs(s,iR,r.marginRight),this.marginBottom=Cs(s,lR,r.marginBottom),this.marginLeft=Cs(s,oR,r.marginLeft),this.opacity=Cs(s,kR,r.opacity);var i=Cs(s,cR,r.overflow);this.overflowX=i[0],this.overflowY=i[i.length>1?1:0],this.overflowWrap=Cs(s,dR,r.overflowWrap),this.paddingTop=Cs(s,uR,r.paddingTop),this.paddingRight=Cs(s,AR,r.paddingRight),this.paddingBottom=Cs(s,hR,r.paddingBottom),this.paddingLeft=Cs(s,mR,r.paddingLeft),this.paintOrder=Cs(s,HR,r.paintOrder),this.position=Cs(s,pR,r.position),this.textAlign=Cs(s,fR,r.textAlign),this.textDecorationColor=Cs(s,BR,(a=r.textDecorationColor)!==null&&a!==void 0?a:r.color),this.textDecorationLine=Cs(s,ER,(n=r.textDecorationLine)!==null&&n!==void 0?n:r.textDecoration),this.textShadow=Cs(s,xR,r.textShadow),this.textTransform=Cs(s,gR,r.textTransform),this.transform=Cs(s,vR,r.transform),this.transformOrigin=Cs(s,wR,r.transformOrigin),this.visibility=Cs(s,_R,r.visibility),this.webkitTextStrokeColor=Cs(s,qR,r.webkitTextStrokeColor),this.webkitTextStrokeWidth=Cs(s,VR,r.webkitTextStrokeWidth),this.wordBreak=Cs(s,SR,r.wordBreak),this.zIndex=Cs(s,CR,r.zIndex)}return t.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},t.prototype.isTransparent=function(){return lu(this.backgroundColor)},t.prototype.isTransformed=function(){return this.transform!==null},t.prototype.isPositioned=function(){return this.position!==0},t.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},t.prototype.isFloating=function(){return this.float!==0},t.prototype.isInlineLevel=function(){return ln(this.display,4)||ln(this.display,33554432)||ln(this.display,268435456)||ln(this.display,536870912)||ln(this.display,67108864)||ln(this.display,134217728)},t})(),WR=(function(){function t(s,r){this.content=Cs(s,UR,r.content),this.quotes=Cs(s,QR,r.quotes)}return t})(),c2=(function(){function t(s,r){this.counterIncrement=Cs(s,PR,r.counterIncrement),this.counterReset=Cs(s,RR,r.counterReset)}return t})(),Cs=function(t,s,r){var a=new P5,n=r!==null&&typeof r<"u"?r.toString():s.initialValue;a.write(n);var i=new R5(a.read());switch(s.type){case 2:var l=i.parseComponentValue();return s.parse(t,Vr(l)?l.value:s.initialValue);case 0:return s.parse(t,i.parseComponentValue());case 1:return s.parse(t,i.parseComponentValues());case 4:return i.parseComponentValue();case 3:switch(s.format){case"angle":return G0.parse(t,i.parseComponentValue());case"color":return iu.parse(t,i.parseComponentValue());case"image":return nj.parse(t,i.parseComponentValue());case"length":var o=i.parseComponentValue();return uu(o)?o:On;case"length-percentage":var u=i.parseComponentValue();return tn(u)?u:On;case"time":return s4.parse(t,i.parseComponentValue())}break}},GR="data-html2canvas-debug",KR=function(t){var s=t.getAttribute(GR);switch(s){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},Ay=function(t,s){var r=KR(t);return r===1||s===r},uc=(function(){function t(s,r){if(this.context=s,this.textNodes=[],this.elements=[],this.flags=0,Ay(r,3))debugger;this.styles=new $R(s,window.getComputedStyle(r,null)),fy(r)&&(this.styles.animationDuration.some(function(a){return a>0})&&(r.style.animationDuration="0s"),this.styles.transform!==null&&(r.style.transform="none")),this.bounds=$0(this.context,r),Ay(r,4)&&(this.flags|=16)}return t})(),zR="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",d2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Lm=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var rx=0;rx<d2.length;rx++)Lm[d2.charCodeAt(rx)]=rx;var YR=function(t){var s=t.length*.75,r=t.length,a,n=0,i,l,o,u;t[t.length-1]==="="&&(s--,t[t.length-2]==="="&&s--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(s):new Array(s),c=Array.isArray(d)?d:new Uint8Array(d);for(a=0;a<r;a+=4)i=Lm[t.charCodeAt(a)],l=Lm[t.charCodeAt(a+1)],o=Lm[t.charCodeAt(a+2)],u=Lm[t.charCodeAt(a+3)],c[n++]=i<<2|l>>4,c[n++]=(l&15)<<4|o>>2,c[n++]=(o&3)<<6|u&63;return d},XR=function(t){for(var s=t.length,r=[],a=0;a<s;a+=2)r.push(t[a+1]<<8|t[a]);return r},JR=function(t){for(var s=t.length,r=[],a=0;a<s;a+=4)r.push(t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a]);return r},oA=5,ij=11,Pv=2,ZR=ij-oA,r4=65536>>oA,e8=1<<oA,Rv=e8-1,t8=1024>>oA,s8=r4+t8,r8=s8,a8=32,n8=r8+a8,i8=65536>>ij,l8=1<<ZR,o8=l8-1,u2=function(t,s,r){return t.slice?t.slice(s,r):new Uint16Array(Array.prototype.slice.call(t,s,r))},c8=function(t,s,r){return t.slice?t.slice(s,r):new Uint32Array(Array.prototype.slice.call(t,s,r))},d8=function(t,s){var r=YR(t),a=Array.isArray(r)?JR(r):new Uint32Array(r),n=Array.isArray(r)?XR(r):new Uint16Array(r),i=24,l=u2(n,i/2,a[4]/2),o=a[5]===2?u2(n,(i+a[4])/2):c8(a,Math.ceil((i+a[4])/4));return new u8(a[0],a[1],a[2],a[3],l,o)},u8=(function(){function t(s,r,a,n,i,l){this.initialValue=s,this.errorValue=r,this.highStart=a,this.highValueIndex=n,this.index=i,this.data=l}return t.prototype.get=function(s){var r;if(s>=0){if(s<55296||s>56319&&s<=65535)return r=this.index[s>>oA],r=(r<<Pv)+(s&Rv),this.data[r];if(s<=65535)return r=this.index[r4+(s-55296>>oA)],r=(r<<Pv)+(s&Rv),this.data[r];if(s<this.highStart)return r=n8-i8+(s>>ij),r=this.index[r],r+=s>>oA&o8,r=this.index[r],r=(r<<Pv)+(s&Rv),this.data[r];if(s<=1114111)return this.data[this.highValueIndex]}return this.errorValue},t})(),A2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A8=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var ax=0;ax<A2.length;ax++)A8[A2.charCodeAt(ax)]=ax;var h8=1,Ov=2,Qv=3,h2=4,m2=5,m8=7,f2=8,Mv=9,Hv=10,p2=11,x2=12,g2=13,v2=14,qv=15,f8=function(t){for(var s=[],r=0,a=t.length;r<a;){var n=t.charCodeAt(r++);if(n>=55296&&n<=56319&&r<a){var i=t.charCodeAt(r++);(i&64512)===56320?s.push(((n&1023)<<10)+(i&1023)+65536):(s.push(n),r--)}else s.push(n)}return s},p8=function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var r=t.length;if(!r)return"";for(var a=[],n=-1,i="";++n<r;){var l=t[n];l<=65535?a.push(l):(l-=65536,a.push((l>>10)+55296,l%1024+56320)),(n+1===r||a.length>16384)&&(i+=String.fromCharCode.apply(String,a),a.length=0)}return i},x8=d8(zR),Rl="",Vv="",g8=function(t){return x8.get(t)},v8=function(t,s,r){var a=r-2,n=s[a],i=s[r-1],l=s[r];if(i===Ov&&l===Qv)return Rl;if(i===Ov||i===Qv||i===h2||l===Ov||l===Qv||l===h2)return Vv;if(i===f2&&[f2,Mv,p2,x2].indexOf(l)!==-1||(i===p2||i===Mv)&&(l===Mv||l===Hv)||(i===x2||i===Hv)&&l===Hv||l===g2||l===m2||l===m8||i===h8)return Rl;if(i===g2&&l===v2){for(;n===m2;)n=s[--a];if(n===v2)return Rl}if(i===qv&&l===qv){for(var o=0;n===qv;)o++,n=s[--a];if(o%2===0)return Rl}return Vv},b8=function(t){var s=f8(t),r=s.length,a=0,n=0,i=s.map(g8);return{next:function(){if(a>=r)return{done:!0,value:null};for(var l=Rl;a<r&&(l=v8(s,i,++a))===Rl;);if(l!==Rl||a===r){var o=p8.apply(null,s.slice(n,a));return n=a,{value:o,done:!1}}return{done:!0,value:null}}}},y8=function(t){for(var s=b8(t),r=[],a;!(a=s.next()).done;)a.value&&r.push(a.value.slice());return r},j8=function(t){var s=123;if(t.createRange){var r=t.createRange();if(r.getBoundingClientRect){var a=t.createElement("boundtest");a.style.height=s+"px",a.style.display="block",t.body.appendChild(a),r.selectNode(a);var n=r.getBoundingClientRect(),i=Math.round(n.height);if(t.body.removeChild(a),i===s)return!0}}return!1},N8=function(t){var s=t.createElement("boundtest");s.style.width="50px",s.style.display="block",s.style.fontSize="12px",s.style.letterSpacing="0px",s.style.wordSpacing="0px",t.body.appendChild(s);var r=t.createRange();s.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var a=s.firstChild,n=W0(a.data).map(function(u){return Oa(u)}),i=0,l={},o=n.every(function(u,d){r.setStart(a,i),r.setEnd(a,i+u.length);var c=r.getBoundingClientRect();i+=u.length;var h=c.x>l.x||c.y>l.y;return l=c,d===0?!0:h});return t.body.removeChild(s),o},w8=function(){return typeof new Image().crossOrigin<"u"},_8=function(){return typeof new XMLHttpRequest().responseType=="string"},S8=function(t){var s=new Image,r=t.createElement("canvas"),a=r.getContext("2d");if(!a)return!1;s.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{a.drawImage(s,0,0),r.toDataURL()}catch{return!1}return!0},b2=function(t){return t[0]===0&&t[1]===255&&t[2]===0&&t[3]===255},C8=function(t){var s=t.createElement("canvas"),r=100;s.width=r,s.height=r;var a=s.getContext("2d");if(!a)return Promise.reject(!1);a.fillStyle="rgb(0, 255, 0)",a.fillRect(0,0,r,r);var n=new Image,i=s.toDataURL();n.src=i;var l=hy(r,r,0,0,n);return a.fillStyle="red",a.fillRect(0,0,r,r),y2(l).then(function(o){a.drawImage(o,0,0);var u=a.getImageData(0,0,r,r).data;a.fillStyle="red",a.fillRect(0,0,r,r);var d=t.createElement("div");return d.style.backgroundImage="url("+i+")",d.style.height=r+"px",b2(u)?y2(hy(r,r,0,0,d)):Promise.reject(!1)}).then(function(o){return a.drawImage(o,0,0),b2(a.getImageData(0,0,r,r).data)}).catch(function(){return!1})},hy=function(t,s,r,a,n){var i="http://www.w3.org/2000/svg",l=document.createElementNS(i,"svg"),o=document.createElementNS(i,"foreignObject");return l.setAttributeNS(null,"width",t.toString()),l.setAttributeNS(null,"height",s.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",r.toString()),o.setAttributeNS(null,"y",a.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),l.appendChild(o),o.appendChild(n),l},y2=function(t){return new Promise(function(s,r){var a=new Image;a.onload=function(){return s(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},Un={get SUPPORT_RANGE_BOUNDS(){var t=j8(document);return Object.defineProperty(Un,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t=Un.SUPPORT_RANGE_BOUNDS&&N8(document);return Object.defineProperty(Un,"SUPPORT_WORD_BREAKING",{value:t}),t},get SUPPORT_SVG_DRAWING(){var t=S8(document);return Object.defineProperty(Un,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t=typeof Array.from=="function"&&typeof window.fetch=="function"?C8(document):Promise.resolve(!1);return Object.defineProperty(Un,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=w8();return Object.defineProperty(Un,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t=_8();return Object.defineProperty(Un,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Un,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(Un,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Gm=(function(){function t(s,r){this.text=s,this.bounds=r}return t})(),k8=function(t,s,r,a){var n=F8(s,r),i=[],l=0;return n.forEach(function(o){if(r.textDecorationLine.length||o.trim().length>0)if(Un.SUPPORT_RANGE_BOUNDS){var u=j2(a,l,o.length).getClientRects();if(u.length>1){var d=lj(o),c=0;d.forEach(function(A){i.push(new Gm(A,Jc.fromDOMRectList(t,j2(a,c+l,A.length).getClientRects()))),c+=A.length})}else i.push(new Gm(o,Jc.fromDOMRectList(t,u)))}else{var h=a.splitText(o.length);i.push(new Gm(o,B8(t,a))),a=h}else Un.SUPPORT_RANGE_BOUNDS||(a=a.splitText(o.length));l+=o.length}),i},B8=function(t,s){var r=s.ownerDocument;if(r){var a=r.createElement("html2canvaswrapper");a.appendChild(s.cloneNode(!0));var n=s.parentNode;if(n){n.replaceChild(a,s);var i=$0(t,a);return a.firstChild&&n.replaceChild(a.firstChild,a),i}}return Jc.EMPTY},j2=function(t,s,r){var a=t.ownerDocument;if(!a)throw new Error("Node has no owner document");var n=a.createRange();return n.setStart(t,s),n.setEnd(t,s+r),n},lj=function(t){if(Un.SUPPORT_NATIVE_TEXT_SEGMENTATION){var s=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(s.segment(t)).map(function(r){return r.segment})}return y8(t)},E8=function(t,s){if(Un.SUPPORT_NATIVE_TEXT_SEGMENTATION){var r=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(r.segment(t)).map(function(a){return a.segment})}return I8(t,s)},F8=function(t,s){return s.letterSpacing!==0?lj(t):E8(t,s)},T8=[32,160,4961,65792,65793,4153,4241],I8=function(t,s){for(var r=iU(t,{lineBreak:s.lineBreak,wordBreak:s.overflowWrap==="break-word"?"break-word":s.wordBreak}),a=[],n,i=function(){if(n.value){var l=n.value.slice(),o=W0(l),u="";o.forEach(function(d){T8.indexOf(d)===-1?u+=Oa(d):(u.length&&a.push(u),a.push(Oa(d)),u="")}),u.length&&a.push(u)}};!(n=r.next()).done;)i();return a},L8=(function(){function t(s,r,a){this.text=D8(r.data,a.textTransform),this.textBounds=k8(s,this.text,a,r)}return t})(),D8=function(t,s){switch(s){case 1:return t.toLowerCase();case 3:return t.replace(U8,P8);case 2:return t.toUpperCase();default:return t}},U8=/(^|\s|:|-|\(|\))([a-z])/g,P8=function(t,s,r){return t.length>0?s+r.toUpperCase():t},a4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.src=a.currentSrc||a.src,n.intrinsicWidth=a.naturalWidth,n.intrinsicHeight=a.naturalHeight,n.context.cache.addImage(n.src),n}return s})(uc),n4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.canvas=a,n.intrinsicWidth=a.width,n.intrinsicHeight=a.height,n}return s})(uc),i4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this,i=new XMLSerializer,l=$0(r,a);return a.setAttribute("width",l.width+"px"),a.setAttribute("height",l.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(a)),n.intrinsicWidth=a.width.baseVal.value,n.intrinsicHeight=a.height.baseVal.value,n.context.cache.addImage(n.svg),n}return s})(uc),l4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.value=a.value,n}return s})(uc),my=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.start=a.start,n.reversed=typeof a.reversed=="boolean"&&a.reversed===!0,n}return s})(uc),R8=[{type:15,flags:0,unit:"px",number:3}],O8=[{type:16,flags:0,number:50}],Q8=function(t){return t.width>t.height?new Jc(t.left+(t.width-t.height)/2,t.top,t.height,t.height):t.width<t.height?new Jc(t.left,t.top+(t.height-t.width)/2,t.width,t.width):t},M8=function(t){var s=t.type===H8?new Array(t.value.length+1).join(""):t.value;return s.length===0?t.placeholder||"":s},e0="checkbox",t0="radio",H8="password",N2=707406591,oj=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;switch(n.type=a.type.toLowerCase(),n.checked=a.checked,n.value=M8(a),(n.type===e0||n.type===t0)&&(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=Q8(n.bounds)),n.type){case e0:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=R8;break;case t0:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=O8;break}return n}return s})(uc),o4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this,i=a.options[a.selectedIndex||0];return n.value=i&&i.text||"",n}return s})(uc),c4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.value=a.value,n}return s})(uc),d4=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;n.src=a.src,n.width=parseInt(a.width,10)||0,n.height=parseInt(a.height,10)||0,n.backgroundColor=n.styles.backgroundColor;try{if(a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.documentElement){n.tree=A4(r,a.contentWindow.document.documentElement);var i=a.contentWindow.document.documentElement?$m(r,getComputedStyle(a.contentWindow.document.documentElement).backgroundColor):Wc.TRANSPARENT,l=a.contentWindow.document.body?$m(r,getComputedStyle(a.contentWindow.document.body).backgroundColor):Wc.TRANSPARENT;n.backgroundColor=lu(i)?lu(l)?n.styles.backgroundColor:l:i}}catch{}return n}return s})(uc),q8=["OL","UL","MENU"],Dx=function(t,s,r,a){for(var n=s.firstChild,i=void 0;n;n=i)if(i=n.nextSibling,h4(n)&&n.data.trim().length>0)r.textNodes.push(new L8(t,n,r.styles));else if(gh(n))if(x4(n)&&n.assignedNodes)n.assignedNodes().forEach(function(o){return Dx(t,o,r,a)});else{var l=u4(t,n);l.styles.isVisible()&&(V8(n,l,a)?l.flags|=4:$8(l.styles)&&(l.flags|=2),q8.indexOf(n.tagName)!==-1&&(l.flags|=8),r.elements.push(l),n.slot,n.shadowRoot?Dx(t,n.shadowRoot,l,a):!s0(n)&&!m4(n)&&!r0(n)&&Dx(t,n,l,a))}},u4=function(t,s){return py(s)?new a4(t,s):f4(s)?new n4(t,s):m4(s)?new i4(t,s):W8(s)?new l4(t,s):G8(s)?new my(t,s):K8(s)?new oj(t,s):r0(s)?new o4(t,s):s0(s)?new c4(t,s):p4(s)?new d4(t,s):new uc(t,s)},A4=function(t,s){var r=u4(t,s);return r.flags|=4,Dx(t,s,r,r),r},V8=function(t,s,r){return s.styles.isPositionedWithZIndex()||s.styles.opacity<1||s.styles.isTransformed()||cj(t)&&r.styles.isTransparent()},$8=function(t){return t.isPositioned()||t.isFloating()},h4=function(t){return t.nodeType===Node.TEXT_NODE},gh=function(t){return t.nodeType===Node.ELEMENT_NODE},fy=function(t){return gh(t)&&typeof t.style<"u"&&!Ux(t)},Ux=function(t){return typeof t.className=="object"},W8=function(t){return t.tagName==="LI"},G8=function(t){return t.tagName==="OL"},K8=function(t){return t.tagName==="INPUT"},z8=function(t){return t.tagName==="HTML"},m4=function(t){return t.tagName==="svg"},cj=function(t){return t.tagName==="BODY"},f4=function(t){return t.tagName==="CANVAS"},w2=function(t){return t.tagName==="VIDEO"},py=function(t){return t.tagName==="IMG"},p4=function(t){return t.tagName==="IFRAME"},_2=function(t){return t.tagName==="STYLE"},Y8=function(t){return t.tagName==="SCRIPT"},s0=function(t){return t.tagName==="TEXTAREA"},r0=function(t){return t.tagName==="SELECT"},x4=function(t){return t.tagName==="SLOT"},S2=function(t){return t.tagName.indexOf("-")>0},X8=(function(){function t(){this.counters={}}return t.prototype.getCounterValue=function(s){var r=this.counters[s];return r&&r.length?r[r.length-1]:1},t.prototype.getCounterValues=function(s){var r=this.counters[s];return r||[]},t.prototype.pop=function(s){var r=this;s.forEach(function(a){return r.counters[a].pop()})},t.prototype.parse=function(s){var r=this,a=s.counterIncrement,n=s.counterReset,i=!0;a!==null&&a.forEach(function(o){var u=r.counters[o.counter];u&&o.increment!==0&&(i=!1,u.length||u.push(1),u[Math.max(0,u.length-1)]+=o.increment)});var l=[];return i&&n.forEach(function(o){var u=r.counters[o.counter];l.push(o.counter),u||(u=r.counters[o.counter]=[]),u.push(o.reset)}),l},t})(),C2={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},k2={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},J8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Z8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},ah=function(t,s,r,a,n,i){return t<s||t>r?mf(t,n,i.length>0):a.integers.reduce(function(l,o,u){for(;t>=o;)t-=o,l+=a.values[u];return l},"")+i},g4=function(t,s,r,a){var n="";do r||t--,n=a(t)+n,t/=s;while(t*s>=s);return n},Pa=function(t,s,r,a,n){var i=r-s+1;return(t<0?"-":"")+(g4(Math.abs(t),i,a,function(l){return Oa(Math.floor(l%i)+s)})+n)},$u=function(t,s,r){r===void 0&&(r=". ");var a=s.length;return g4(Math.abs(t),a,!1,function(n){return s[Math.floor(n%a)]})+r},mh=1,Gd=2,Kd=4,Dm=8,Oc=function(t,s,r,a,n,i){if(t<-9999||t>9999)return mf(t,4,n.length>0);var l=Math.abs(t),o=n;if(l===0)return s[0]+o;for(var u=0;l>0&&u<=4;u++){var d=l%10;d===0&&ln(i,mh)&&o!==""?o=s[d]+o:d>1||d===1&&u===0||d===1&&u===1&&ln(i,Gd)||d===1&&u===1&&ln(i,Kd)&&t>100||d===1&&u>1&&ln(i,Dm)?o=s[d]+(u>0?r[u-1]:"")+o:d===1&&u>0&&(o=r[u-1]+o),l=Math.floor(l/10)}return(t<0?a:"")+o},B2="",E2="",F2="",$v="",mf=function(t,s,r){var a=r?". ":"",n=r?"":"",i=r?", ":"",l=r?" ":"";switch(s){case 0:return""+l;case 1:return""+l;case 2:return""+l;case 5:var o=Pa(t,48,57,!0,a);return o.length<4?"0"+o:o;case 4:return $u(t,"",n);case 6:return ah(t,1,3999,C2,3,a).toLowerCase();case 7:return ah(t,1,3999,C2,3,a);case 8:return Pa(t,945,969,!1,a);case 9:return Pa(t,97,122,!1,a);case 10:return Pa(t,65,90,!1,a);case 11:return Pa(t,1632,1641,!0,a);case 12:case 49:return ah(t,1,9999,k2,3,a);case 35:return ah(t,1,9999,k2,3,a).toLowerCase();case 13:return Pa(t,2534,2543,!0,a);case 14:case 30:return Pa(t,6112,6121,!0,a);case 15:return $u(t,"",n);case 16:return $u(t,"",n);case 17:case 48:return Oc(t,"",B2,"",n,Gd|Kd|Dm);case 47:return Oc(t,"",E2,"",n,mh|Gd|Kd|Dm);case 42:return Oc(t,"",B2,"",n,Gd|Kd|Dm);case 41:return Oc(t,"",E2,"",n,mh|Gd|Kd|Dm);case 26:return Oc(t,"","",F2,n,0);case 25:return Oc(t,"","",F2,n,mh|Gd|Kd);case 31:return Oc(t,"","",$v,i,mh|Gd|Kd);case 33:return Oc(t,"","",$v,i,0);case 32:return Oc(t,"","",$v,i,mh|Gd|Kd);case 18:return Pa(t,2406,2415,!0,a);case 20:return ah(t,1,19999,Z8,3,a);case 21:return Pa(t,2790,2799,!0,a);case 22:return Pa(t,2662,2671,!0,a);case 22:return ah(t,1,10999,J8,3,a);case 23:return $u(t,"");case 24:return $u(t,"");case 27:return Pa(t,3302,3311,!0,a);case 28:return $u(t,"",n);case 29:return $u(t,"",n);case 34:return Pa(t,3792,3801,!0,a);case 37:return Pa(t,6160,6169,!0,a);case 38:return Pa(t,4160,4169,!0,a);case 39:return Pa(t,2918,2927,!0,a);case 40:return Pa(t,1776,1785,!0,a);case 43:return Pa(t,3046,3055,!0,a);case 44:return Pa(t,3174,3183,!0,a);case 45:return Pa(t,3664,3673,!0,a);case 46:return Pa(t,3872,3881,!0,a);case 3:default:return Pa(t,48,57,!0,a)}},v4="data-html2canvas-ignore",T2=(function(){function t(s,r,a){if(this.context=s,this.options=a,this.scrolledElements=[],this.referenceElement=r,this.counters=new X8,this.quoteDepth=0,!r.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(r.ownerDocument.documentElement,!1)}return t.prototype.toIFrame=function(s,r){var a=this,n=eO(s,r);if(!n.contentWindow)return Promise.reject("Unable to find iframe window");var i=s.defaultView.pageXOffset,l=s.defaultView.pageYOffset,o=n.contentWindow,u=o.document,d=rO(n).then(function(){return ki(a,void 0,void 0,function(){var c,h;return ri(this,function(A){switch(A.label){case 0:return this.scrolledElements.forEach(lO),o&&(o.scrollTo(r.left,r.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(o.scrollY!==r.top||o.scrollX!==r.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(o.scrollX-r.left,o.scrollY-r.top,0,0))),c=this.options.onclone,h=this.clonedReferenceElement,typeof h>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:u.fonts&&u.fonts.ready?[4,u.fonts.ready]:[3,2];case 1:A.sent(),A.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,sO(u)]:[3,4];case 3:A.sent(),A.label=4;case 4:return typeof c=="function"?[2,Promise.resolve().then(function(){return c(u,h)}).then(function(){return n})]:[2,n]}})})});return u.open(),u.write(nO(document.doctype)+"<html></html>"),iO(this.referenceElement.ownerDocument,i,l),u.replaceChild(u.adoptNode(this.documentElement),u.documentElement),u.close(),d},t.prototype.createElementClone=function(s){if(Ay(s,2))debugger;if(f4(s))return this.createCanvasClone(s);if(w2(s))return this.createVideoClone(s);if(_2(s))return this.createStyleClone(s);var r=s.cloneNode(!1);return py(r)&&(py(s)&&s.currentSrc&&s.currentSrc!==s.src&&(r.src=s.currentSrc,r.srcset=""),r.loading==="lazy"&&(r.loading="eager")),S2(r)?this.createCustomElementClone(r):r},t.prototype.createCustomElementClone=function(s){var r=document.createElement("html2canvascustomelement");return Wv(s.style,r),r},t.prototype.createStyleClone=function(s){try{var r=s.sheet;if(r&&r.cssRules){var a=[].slice.call(r.cssRules,0).reduce(function(i,l){return l&&typeof l.cssText=="string"?i+l.cssText:i},""),n=s.cloneNode(!1);return n.textContent=a,n}}catch(i){if(this.context.logger.error("Unable to access cssRules property",i),i.name!=="SecurityError")throw i}return s.cloneNode(!1)},t.prototype.createCanvasClone=function(s){var r;if(this.options.inlineImages&&s.ownerDocument){var a=s.ownerDocument.createElement("img");try{return a.src=s.toDataURL(),a}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",s)}}var n=s.cloneNode(!1);try{n.width=s.width,n.height=s.height;var i=s.getContext("2d"),l=n.getContext("2d");if(l)if(!this.options.allowTaint&&i)l.putImageData(i.getImageData(0,0,s.width,s.height),0,0);else{var o=(r=s.getContext("webgl2"))!==null&&r!==void 0?r:s.getContext("webgl");if(o){var u=o.getContextAttributes();(u==null?void 0:u.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",s)}l.drawImage(s,0,0)}return n}catch{this.context.logger.info("Unable to clone canvas as it is tainted",s)}return n},t.prototype.createVideoClone=function(s){var r=s.ownerDocument.createElement("canvas");r.width=s.offsetWidth,r.height=s.offsetHeight;var a=r.getContext("2d");try{return a&&(a.drawImage(s,0,0,r.width,r.height),this.options.allowTaint||a.getImageData(0,0,r.width,r.height)),r}catch{this.context.logger.info("Unable to clone video as it is tainted",s)}var n=s.ownerDocument.createElement("canvas");return n.width=s.offsetWidth,n.height=s.offsetHeight,n},t.prototype.appendChildNode=function(s,r,a){(!gh(r)||!Y8(r)&&!r.hasAttribute(v4)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(r)))&&(!this.options.copyStyles||!gh(r)||!_2(r))&&s.appendChild(this.cloneNode(r,a))},t.prototype.cloneChildNodes=function(s,r,a){for(var n=this,i=s.shadowRoot?s.shadowRoot.firstChild:s.firstChild;i;i=i.nextSibling)if(gh(i)&&x4(i)&&typeof i.assignedNodes=="function"){var l=i.assignedNodes();l.length&&l.forEach(function(o){return n.appendChildNode(r,o,a)})}else this.appendChildNode(r,i,a)},t.prototype.cloneNode=function(s,r){if(h4(s))return document.createTextNode(s.data);if(!s.ownerDocument)return s.cloneNode(!1);var a=s.ownerDocument.defaultView;if(a&&gh(s)&&(fy(s)||Ux(s))){var n=this.createElementClone(s);n.style.transitionProperty="none";var i=a.getComputedStyle(s),l=a.getComputedStyle(s,":before"),o=a.getComputedStyle(s,":after");this.referenceElement===s&&fy(n)&&(this.clonedReferenceElement=n),cj(n)&&dO(n);var u=this.counters.parse(new c2(this.context,i)),d=this.resolvePseudoContent(s,n,l,Km.BEFORE);S2(s)&&(r=!0),w2(s)||this.cloneChildNodes(s,n,r),d&&n.insertBefore(d,n.firstChild);var c=this.resolvePseudoContent(s,n,o,Km.AFTER);return c&&n.appendChild(c),this.counters.pop(u),(i&&(this.options.copyStyles||Ux(s))&&!p4(s)||r)&&Wv(i,n),(s.scrollTop!==0||s.scrollLeft!==0)&&this.scrolledElements.push([n,s.scrollLeft,s.scrollTop]),(s0(s)||r0(s))&&(s0(n)||r0(n))&&(n.value=s.value),n}return s.cloneNode(!1)},t.prototype.resolvePseudoContent=function(s,r,a,n){var i=this;if(a){var l=a.content,o=r.ownerDocument;if(!(!o||!l||l==="none"||l==="-moz-alt-content"||a.display==="none")){this.counters.parse(new c2(this.context,a));var u=new WR(this.context,a),d=o.createElement("html2canvaspseudoelement");Wv(a,d),u.content.forEach(function(h){if(h.type===0)d.appendChild(o.createTextNode(h.value));else if(h.type===22){var A=o.createElement("img");A.src=h.value,A.style.opacity="1",d.appendChild(A)}else if(h.type===18){if(h.name==="attr"){var f=h.values.filter(Vr);f.length&&d.appendChild(o.createTextNode(s.getAttribute(f[0].value)||""))}else if(h.name==="counter"){var g=h.values.filter(Lh),v=g[0],b=g[1];if(v&&Vr(v)){var y=i.counters.getCounterValue(v.value),j=b&&Vr(b)?uy.parse(i.context,b.value):3;d.appendChild(o.createTextNode(mf(y,j,!1)))}}else if(h.name==="counters"){var N=h.values.filter(Lh),v=N[0],S=N[1],b=N[2];if(v&&Vr(v)){var B=i.counters.getCounterValues(v.value),P=b&&Vr(b)?uy.parse(i.context,b.value):3,L=S&&S.type===0?S.value:"",U=B.map(function(V){return mf(V,P,!1)}).join(L);d.appendChild(o.createTextNode(U))}}}else if(h.type===20)switch(h.value){case"open-quote":d.appendChild(o.createTextNode(o2(u.quotes,i.quoteDepth++,!0)));break;case"close-quote":d.appendChild(o.createTextNode(o2(u.quotes,--i.quoteDepth,!1)));break;default:d.appendChild(o.createTextNode(h.value))}}),d.className=xy+" "+gy;var c=n===Km.BEFORE?" "+xy:" "+gy;return Ux(r)?r.className.baseValue+=c:r.className+=c,d}}},t.destroy=function(s){return s.parentNode?(s.parentNode.removeChild(s),!0):!1},t})(),Km;(function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"})(Km||(Km={}));var eO=function(t,s){var r=t.createElement("iframe");return r.className="html2canvas-container",r.style.visibility="hidden",r.style.position="fixed",r.style.left="-10000px",r.style.top="0px",r.style.border="0",r.width=s.width.toString(),r.height=s.height.toString(),r.scrolling="no",r.setAttribute(v4,"true"),t.body.appendChild(r),r},tO=function(t){return new Promise(function(s){if(t.complete){s();return}if(!t.src){s();return}t.onload=s,t.onerror=s})},sO=function(t){return Promise.all([].slice.call(t.images,0).map(tO))},rO=function(t){return new Promise(function(s,r){var a=t.contentWindow;if(!a)return r("No window assigned for iframe");var n=a.document;a.onload=t.onload=function(){a.onload=t.onload=null;var i=setInterval(function(){n.body.childNodes.length>0&&n.readyState==="complete"&&(clearInterval(i),s(t))},50)}})},aO=["all","d","content"],Wv=function(t,s){for(var r=t.length-1;r>=0;r--){var a=t.item(r);aO.indexOf(a)===-1&&s.style.setProperty(a,t.getPropertyValue(a))}return s},nO=function(t){var s="";return t&&(s+="<!DOCTYPE ",t.name&&(s+=t.name),t.internalSubset&&(s+=t.internalSubset),t.publicId&&(s+='"'+t.publicId+'"'),t.systemId&&(s+='"'+t.systemId+'"'),s+=">"),s},iO=function(t,s,r){t&&t.defaultView&&(s!==t.defaultView.pageXOffset||r!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(s,r)},lO=function(t){var s=t[0],r=t[1],a=t[2];s.scrollLeft=r,s.scrollTop=a},oO=":before",cO=":after",xy="___html2canvas___pseudoelement_before",gy="___html2canvas___pseudoelement_after",I2=`{
    content: "" !important;
    display: none !important;
}`,dO=function(t){uO(t,"."+xy+oO+I2+`
         .`+gy+cO+I2)},uO=function(t,s){var r=t.ownerDocument;if(r){var a=r.createElement("style");a.textContent=s,t.appendChild(a)}},b4=(function(){function t(){}return t.getOrigin=function(s){var r=t._link;return r?(r.href=s,r.href=r.href,r.protocol+r.hostname+r.port):"about:blank"},t.isSameOrigin=function(s){return t.getOrigin(s)===t._origin},t.setContext=function(s){t._link=s.document.createElement("a"),t._origin=t.getOrigin(s.location.href)},t._origin="about:blank",t})(),AO=(function(){function t(s,r){this.context=s,this._options=r,this._cache={}}return t.prototype.addImage=function(s){var r=Promise.resolve();return this.has(s)||(Kv(s)||pO(s))&&(this._cache[s]=this.loadImage(s)).catch(function(){}),r},t.prototype.match=function(s){return this._cache[s]},t.prototype.loadImage=function(s){return ki(this,void 0,void 0,function(){var r,a,n,i,l=this;return ri(this,function(o){switch(o.label){case 0:return r=b4.isSameOrigin(s),a=!Gv(s)&&this._options.useCORS===!0&&Un.SUPPORT_CORS_IMAGES&&!r,n=!Gv(s)&&!r&&!Kv(s)&&typeof this._options.proxy=="string"&&Un.SUPPORT_CORS_XHR&&!a,!r&&this._options.allowTaint===!1&&!Gv(s)&&!Kv(s)&&!n&&!a?[2]:(i=s,n?[4,this.proxy(i)]:[3,2]);case 1:i=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+s.substring(0,256)),[4,new Promise(function(u,d){var c=new Image;c.onload=function(){return u(c)},c.onerror=d,(xO(i)||a)&&(c.crossOrigin="anonymous"),c.src=i,c.complete===!0&&setTimeout(function(){return u(c)},500),l._options.imageTimeout>0&&setTimeout(function(){return d("Timed out ("+l._options.imageTimeout+"ms) loading image")},l._options.imageTimeout)})];case 3:return[2,o.sent()]}})})},t.prototype.has=function(s){return typeof this._cache[s]<"u"},t.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},t.prototype.proxy=function(s){var r=this,a=this._options.proxy;if(!a)throw new Error("No proxy defined");var n=s.substring(0,256);return new Promise(function(i,l){var o=Un.SUPPORT_RESPONSE_TYPE?"blob":"text",u=new XMLHttpRequest;u.onload=function(){if(u.status===200)if(o==="text")i(u.response);else{var h=new FileReader;h.addEventListener("load",function(){return i(h.result)},!1),h.addEventListener("error",function(A){return l(A)},!1),h.readAsDataURL(u.response)}else l("Failed to proxy resource "+n+" with status code "+u.status)},u.onerror=l;var d=a.indexOf("?")>-1?"&":"?";if(u.open("GET",""+a+d+"url="+encodeURIComponent(s)+"&responseType="+o),o!=="text"&&u instanceof XMLHttpRequest&&(u.responseType=o),r._options.imageTimeout){var c=r._options.imageTimeout;u.timeout=c,u.ontimeout=function(){return l("Timed out ("+c+"ms) proxying "+n)}}u.send()})},t})(),hO=/^data:image\/svg\+xml/i,mO=/^data:image\/.*;base64,/i,fO=/^data:image\/.*/i,pO=function(t){return Un.SUPPORT_SVG_DRAWING||!gO(t)},Gv=function(t){return fO.test(t)},xO=function(t){return mO.test(t)},Kv=function(t){return t.substr(0,4)==="blob"},gO=function(t){return t.substr(-3).toLowerCase()==="svg"||hO.test(t)},_s=(function(){function t(s,r){this.type=0,this.x=s,this.y=r}return t.prototype.add=function(s,r){return new t(this.x+s,this.y+r)},t})(),nh=function(t,s,r){return new _s(t.x+(s.x-t.x)*r,t.y+(s.y-t.y)*r)},nx=(function(){function t(s,r,a,n){this.type=1,this.start=s,this.startControl=r,this.endControl=a,this.end=n}return t.prototype.subdivide=function(s,r){var a=nh(this.start,this.startControl,s),n=nh(this.startControl,this.endControl,s),i=nh(this.endControl,this.end,s),l=nh(a,n,s),o=nh(n,i,s),u=nh(l,o,s);return r?new t(this.start,a,l,u):new t(u,o,i,this.end)},t.prototype.add=function(s,r){return new t(this.start.add(s,r),this.startControl.add(s,r),this.endControl.add(s,r),this.end.add(s,r))},t.prototype.reverse=function(){return new t(this.end,this.endControl,this.startControl,this.start)},t})(),Ml=function(t){return t.type===1},vO=(function(){function t(s){var r=s.styles,a=s.bounds,n=Im(r.borderTopLeftRadius,a.width,a.height),i=n[0],l=n[1],o=Im(r.borderTopRightRadius,a.width,a.height),u=o[0],d=o[1],c=Im(r.borderBottomRightRadius,a.width,a.height),h=c[0],A=c[1],f=Im(r.borderBottomLeftRadius,a.width,a.height),g=f[0],v=f[1],b=[];b.push((i+u)/a.width),b.push((g+h)/a.width),b.push((l+v)/a.height),b.push((d+A)/a.height);var y=Math.max.apply(Math,b);y>1&&(i/=y,l/=y,u/=y,d/=y,h/=y,A/=y,g/=y,v/=y);var j=a.width-u,N=a.height-A,S=a.width-h,B=a.height-v,P=r.borderTopWidth,L=r.borderRightWidth,U=r.borderBottomWidth,H=r.borderLeftWidth,q=Jr(r.paddingTop,s.bounds.width),V=Jr(r.paddingRight,s.bounds.width),M=Jr(r.paddingBottom,s.bounds.width),z=Jr(r.paddingLeft,s.bounds.width);this.topLeftBorderDoubleOuterBox=i>0||l>0?ha(a.left+H/3,a.top+P/3,i-H/3,l-P/3,Ir.TOP_LEFT):new _s(a.left+H/3,a.top+P/3),this.topRightBorderDoubleOuterBox=i>0||l>0?ha(a.left+j,a.top+P/3,u-L/3,d-P/3,Ir.TOP_RIGHT):new _s(a.left+a.width-L/3,a.top+P/3),this.bottomRightBorderDoubleOuterBox=h>0||A>0?ha(a.left+S,a.top+N,h-L/3,A-U/3,Ir.BOTTOM_RIGHT):new _s(a.left+a.width-L/3,a.top+a.height-U/3),this.bottomLeftBorderDoubleOuterBox=g>0||v>0?ha(a.left+H/3,a.top+B,g-H/3,v-U/3,Ir.BOTTOM_LEFT):new _s(a.left+H/3,a.top+a.height-U/3),this.topLeftBorderDoubleInnerBox=i>0||l>0?ha(a.left+H*2/3,a.top+P*2/3,i-H*2/3,l-P*2/3,Ir.TOP_LEFT):new _s(a.left+H*2/3,a.top+P*2/3),this.topRightBorderDoubleInnerBox=i>0||l>0?ha(a.left+j,a.top+P*2/3,u-L*2/3,d-P*2/3,Ir.TOP_RIGHT):new _s(a.left+a.width-L*2/3,a.top+P*2/3),this.bottomRightBorderDoubleInnerBox=h>0||A>0?ha(a.left+S,a.top+N,h-L*2/3,A-U*2/3,Ir.BOTTOM_RIGHT):new _s(a.left+a.width-L*2/3,a.top+a.height-U*2/3),this.bottomLeftBorderDoubleInnerBox=g>0||v>0?ha(a.left+H*2/3,a.top+B,g-H*2/3,v-U*2/3,Ir.BOTTOM_LEFT):new _s(a.left+H*2/3,a.top+a.height-U*2/3),this.topLeftBorderStroke=i>0||l>0?ha(a.left+H/2,a.top+P/2,i-H/2,l-P/2,Ir.TOP_LEFT):new _s(a.left+H/2,a.top+P/2),this.topRightBorderStroke=i>0||l>0?ha(a.left+j,a.top+P/2,u-L/2,d-P/2,Ir.TOP_RIGHT):new _s(a.left+a.width-L/2,a.top+P/2),this.bottomRightBorderStroke=h>0||A>0?ha(a.left+S,a.top+N,h-L/2,A-U/2,Ir.BOTTOM_RIGHT):new _s(a.left+a.width-L/2,a.top+a.height-U/2),this.bottomLeftBorderStroke=g>0||v>0?ha(a.left+H/2,a.top+B,g-H/2,v-U/2,Ir.BOTTOM_LEFT):new _s(a.left+H/2,a.top+a.height-U/2),this.topLeftBorderBox=i>0||l>0?ha(a.left,a.top,i,l,Ir.TOP_LEFT):new _s(a.left,a.top),this.topRightBorderBox=u>0||d>0?ha(a.left+j,a.top,u,d,Ir.TOP_RIGHT):new _s(a.left+a.width,a.top),this.bottomRightBorderBox=h>0||A>0?ha(a.left+S,a.top+N,h,A,Ir.BOTTOM_RIGHT):new _s(a.left+a.width,a.top+a.height),this.bottomLeftBorderBox=g>0||v>0?ha(a.left,a.top+B,g,v,Ir.BOTTOM_LEFT):new _s(a.left,a.top+a.height),this.topLeftPaddingBox=i>0||l>0?ha(a.left+H,a.top+P,Math.max(0,i-H),Math.max(0,l-P),Ir.TOP_LEFT):new _s(a.left+H,a.top+P),this.topRightPaddingBox=u>0||d>0?ha(a.left+Math.min(j,a.width-L),a.top+P,j>a.width+L?0:Math.max(0,u-L),Math.max(0,d-P),Ir.TOP_RIGHT):new _s(a.left+a.width-L,a.top+P),this.bottomRightPaddingBox=h>0||A>0?ha(a.left+Math.min(S,a.width-H),a.top+Math.min(N,a.height-U),Math.max(0,h-L),Math.max(0,A-U),Ir.BOTTOM_RIGHT):new _s(a.left+a.width-L,a.top+a.height-U),this.bottomLeftPaddingBox=g>0||v>0?ha(a.left+H,a.top+Math.min(B,a.height-U),Math.max(0,g-H),Math.max(0,v-U),Ir.BOTTOM_LEFT):new _s(a.left+H,a.top+a.height-U),this.topLeftContentBox=i>0||l>0?ha(a.left+H+z,a.top+P+q,Math.max(0,i-(H+z)),Math.max(0,l-(P+q)),Ir.TOP_LEFT):new _s(a.left+H+z,a.top+P+q),this.topRightContentBox=u>0||d>0?ha(a.left+Math.min(j,a.width+H+z),a.top+P+q,j>a.width+H+z?0:u-H+z,d-(P+q),Ir.TOP_RIGHT):new _s(a.left+a.width-(L+V),a.top+P+q),this.bottomRightContentBox=h>0||A>0?ha(a.left+Math.min(S,a.width-(H+z)),a.top+Math.min(N,a.height+P+q),Math.max(0,h-(L+V)),A-(U+M),Ir.BOTTOM_RIGHT):new _s(a.left+a.width-(L+V),a.top+a.height-(U+M)),this.bottomLeftContentBox=g>0||v>0?ha(a.left+H+z,a.top+B,Math.max(0,g-(H+z)),v-(U+M),Ir.BOTTOM_LEFT):new _s(a.left+H+z,a.top+a.height-(U+M))}return t})(),Ir;(function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",t[t.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Ir||(Ir={}));var ha=function(t,s,r,a,n){var i=4*((Math.sqrt(2)-1)/3),l=r*i,o=a*i,u=t+r,d=s+a;switch(n){case Ir.TOP_LEFT:return new nx(new _s(t,d),new _s(t,d-o),new _s(u-l,s),new _s(u,s));case Ir.TOP_RIGHT:return new nx(new _s(t,s),new _s(t+l,s),new _s(u,d-o),new _s(u,d));case Ir.BOTTOM_RIGHT:return new nx(new _s(u,s),new _s(u,s+o),new _s(t+l,d),new _s(t,d));case Ir.BOTTOM_LEFT:default:return new nx(new _s(u,d),new _s(u-l,d),new _s(t,s+o),new _s(t,s))}},a0=function(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]},bO=function(t){return[t.topLeftContentBox,t.topRightContentBox,t.bottomRightContentBox,t.bottomLeftContentBox]},n0=function(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]},yO=(function(){function t(s,r,a){this.offsetX=s,this.offsetY=r,this.matrix=a,this.type=0,this.target=6}return t})(),ix=(function(){function t(s,r){this.path=s,this.target=r,this.type=1}return t})(),jO=(function(){function t(s){this.opacity=s,this.type=2,this.target=6}return t})(),NO=function(t){return t.type===0},y4=function(t){return t.type===1},wO=function(t){return t.type===2},L2=function(t,s){return t.length===s.length?t.some(function(r,a){return r===s[a]}):!1},_O=function(t,s,r,a,n){return t.map(function(i,l){switch(l){case 0:return i.add(s,r);case 1:return i.add(s+a,r);case 2:return i.add(s+a,r+n);case 3:return i.add(s,r+n)}return i})},j4=(function(){function t(s){this.element=s,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return t})(),N4=(function(){function t(s,r){if(this.container=s,this.parent=r,this.effects=[],this.curves=new vO(this.container),this.container.styles.opacity<1&&this.effects.push(new jO(this.container.styles.opacity)),this.container.styles.transform!==null){var a=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform;this.effects.push(new yO(a,n,i))}if(this.container.styles.overflowX!==0){var l=a0(this.curves),o=n0(this.curves);L2(l,o)?this.effects.push(new ix(l,6)):(this.effects.push(new ix(l,2)),this.effects.push(new ix(o,4)))}}return t.prototype.getEffects=function(s){for(var r=[2,3].indexOf(this.container.styles.position)===-1,a=this.parent,n=this.effects.slice(0);a;){var i=a.effects.filter(function(u){return!y4(u)});if(r||a.container.styles.position!==0||!a.parent){if(n.unshift.apply(n,i),r=[2,3].indexOf(a.container.styles.position)===-1,a.container.styles.overflowX!==0){var l=a0(a.curves),o=n0(a.curves);L2(l,o)||n.unshift(new ix(o,6))}}else n.unshift.apply(n,i);a=a.parent}return n.filter(function(u){return ln(u.target,s)})},t})(),vy=function(t,s,r,a){t.container.elements.forEach(function(n){var i=ln(n.flags,4),l=ln(n.flags,2),o=new N4(n,t);ln(n.styles.display,2048)&&a.push(o);var u=ln(n.flags,8)?[]:a;if(i||l){var d=i||n.styles.isPositioned()?r:s,c=new j4(o);if(n.styles.isPositioned()||n.styles.opacity<1||n.styles.isTransformed()){var h=n.styles.zIndex.order;if(h<0){var A=0;d.negativeZIndex.some(function(g,v){return h>g.element.container.styles.zIndex.order?(A=v,!1):A>0}),d.negativeZIndex.splice(A,0,c)}else if(h>0){var f=0;d.positiveZIndex.some(function(g,v){return h>=g.element.container.styles.zIndex.order?(f=v+1,!1):f>0}),d.positiveZIndex.splice(f,0,c)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else n.styles.isFloating()?d.nonPositionedFloats.push(c):d.nonPositionedInlineLevel.push(c);vy(o,c,i?c:r,u)}else n.styles.isInlineLevel()?s.inlineLevel.push(o):s.nonInlineLevel.push(o),vy(o,s,r,u);ln(n.flags,8)&&w4(n,u)})},w4=function(t,s){for(var r=t instanceof my?t.start:1,a=t instanceof my?t.reversed:!1,n=0;n<s.length;n++){var i=s[n];i.container instanceof l4&&typeof i.container.value=="number"&&i.container.value!==0&&(r=i.container.value),i.listValue=mf(r,i.container.styles.listStyleType,!0),r+=a?-1:1}},SO=function(t){var s=new N4(t,null),r=new j4(s),a=[];return vy(s,r,r,a),w4(s.container,a),r},D2=function(t,s){switch(s){case 0:return Vl(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return Vl(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return Vl(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);case 3:default:return Vl(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}},CO=function(t,s){switch(s){case 0:return Vl(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return Vl(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return Vl(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);case 3:default:return Vl(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}},kO=function(t,s){switch(s){case 0:return Vl(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return Vl(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return Vl(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);case 3:default:return Vl(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}},BO=function(t,s){switch(s){case 0:return lx(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return lx(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return lx(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);case 3:default:return lx(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}},lx=function(t,s){var r=[];return Ml(t)?r.push(t.subdivide(.5,!1)):r.push(t),Ml(s)?r.push(s.subdivide(.5,!0)):r.push(s),r},Vl=function(t,s,r,a){var n=[];return Ml(t)?n.push(t.subdivide(.5,!1)):n.push(t),Ml(r)?n.push(r.subdivide(.5,!0)):n.push(r),Ml(a)?n.push(a.subdivide(.5,!0).reverse()):n.push(a),Ml(s)?n.push(s.subdivide(.5,!1).reverse()):n.push(s),n},_4=function(t){var s=t.bounds,r=t.styles;return s.add(r.borderLeftWidth,r.borderTopWidth,-(r.borderRightWidth+r.borderLeftWidth),-(r.borderTopWidth+r.borderBottomWidth))},i0=function(t){var s=t.styles,r=t.bounds,a=Jr(s.paddingLeft,r.width),n=Jr(s.paddingRight,r.width),i=Jr(s.paddingTop,r.width),l=Jr(s.paddingBottom,r.width);return r.add(a+s.borderLeftWidth,i+s.borderTopWidth,-(s.borderRightWidth+s.borderLeftWidth+a+n),-(s.borderTopWidth+s.borderBottomWidth+i+l))},EO=function(t,s){return t===0?s.bounds:t===2?i0(s):_4(s)},FO=function(t,s){return t===0?s.bounds:t===2?i0(s):_4(s)},zv=function(t,s,r){var a=EO(fh(t.styles.backgroundOrigin,s),t),n=FO(fh(t.styles.backgroundClip,s),t),i=TO(fh(t.styles.backgroundSize,s),r,a),l=i[0],o=i[1],u=Im(fh(t.styles.backgroundPosition,s),a.width-l,a.height-o),d=IO(fh(t.styles.backgroundRepeat,s),u,i,a,n),c=Math.round(a.left+u[0]),h=Math.round(a.top+u[1]);return[d,c,h,l,o]},ih=function(t){return Vr(t)&&t.value===_h.AUTO},ox=function(t){return typeof t=="number"},TO=function(t,s,r){var a=s[0],n=s[1],i=s[2],l=t[0],o=t[1];if(!l)return[0,0];if(tn(l)&&o&&tn(o))return[Jr(l,r.width),Jr(o,r.height)];var u=ox(i);if(Vr(l)&&(l.value===_h.CONTAIN||l.value===_h.COVER)){if(ox(i)){var d=r.width/r.height;return d<i!=(l.value===_h.COVER)?[r.width,r.width/i]:[r.height*i,r.height]}return[r.width,r.height]}var c=ox(a),h=ox(n),A=c||h;if(ih(l)&&(!o||ih(o))){if(c&&h)return[a,n];if(!u&&!A)return[r.width,r.height];if(A&&u){var f=c?a:n*i,g=h?n:a/i;return[f,g]}var v=c?a:r.width,b=h?n:r.height;return[v,b]}if(u){var y=0,j=0;return tn(l)?y=Jr(l,r.width):tn(o)&&(j=Jr(o,r.height)),ih(l)?y=j*i:(!o||ih(o))&&(j=y/i),[y,j]}var N=null,S=null;if(tn(l)?N=Jr(l,r.width):o&&tn(o)&&(S=Jr(o,r.height)),N!==null&&(!o||ih(o))&&(S=c&&h?N/a*n:r.height),S!==null&&ih(l)&&(N=c&&h?S/n*a:r.width),N!==null&&S!==null)return[N,S];throw new Error("Unable to calculate background-size for element")},fh=function(t,s){var r=t[s];return typeof r>"u"?t[0]:r},IO=function(t,s,r,a,n){var i=s[0],l=s[1],o=r[0],u=r[1];switch(t){case 2:return[new _s(Math.round(a.left),Math.round(a.top+l)),new _s(Math.round(a.left+a.width),Math.round(a.top+l)),new _s(Math.round(a.left+a.width),Math.round(u+a.top+l)),new _s(Math.round(a.left),Math.round(u+a.top+l))];case 3:return[new _s(Math.round(a.left+i),Math.round(a.top)),new _s(Math.round(a.left+i+o),Math.round(a.top)),new _s(Math.round(a.left+i+o),Math.round(a.height+a.top)),new _s(Math.round(a.left+i),Math.round(a.height+a.top))];case 1:return[new _s(Math.round(a.left+i),Math.round(a.top+l)),new _s(Math.round(a.left+i+o),Math.round(a.top+l)),new _s(Math.round(a.left+i+o),Math.round(a.top+l+u)),new _s(Math.round(a.left+i),Math.round(a.top+l+u))];default:return[new _s(Math.round(n.left),Math.round(n.top)),new _s(Math.round(n.left+n.width),Math.round(n.top)),new _s(Math.round(n.left+n.width),Math.round(n.height+n.top)),new _s(Math.round(n.left),Math.round(n.height+n.top))]}},LO="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",U2="Hidden Text",DO=(function(){function t(s){this._data={},this._document=s}return t.prototype.parseMetrics=function(s,r){var a=this._document.createElement("div"),n=this._document.createElement("img"),i=this._document.createElement("span"),l=this._document.body;a.style.visibility="hidden",a.style.fontFamily=s,a.style.fontSize=r,a.style.margin="0",a.style.padding="0",a.style.whiteSpace="nowrap",l.appendChild(a),n.src=LO,n.width=1,n.height=1,n.style.margin="0",n.style.padding="0",n.style.verticalAlign="baseline",i.style.fontFamily=s,i.style.fontSize=r,i.style.margin="0",i.style.padding="0",i.appendChild(this._document.createTextNode(U2)),a.appendChild(i),a.appendChild(n);var o=n.offsetTop-i.offsetTop+2;a.removeChild(i),a.appendChild(this._document.createTextNode(U2)),a.style.lineHeight="normal",n.style.verticalAlign="super";var u=n.offsetTop-a.offsetTop+2;return l.removeChild(a),{baseline:o,middle:u}},t.prototype.getMetrics=function(s,r){var a=s+" "+r;return typeof this._data[a]>"u"&&(this._data[a]=this.parseMetrics(s,r)),this._data[a]},t})(),S4=(function(){function t(s,r){this.context=s,this.options=r}return t})(),UO=1e4,PO=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n._activeEffects=[],n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),a.canvas||(n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px"),n.fontMetrics=new DO(document),n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.ctx.textBaseline="bottom",n._activeEffects=[],n.context.logger.debug("Canvas renderer initialized ("+a.width+"x"+a.height+") with scale "+a.scale),n}return s.prototype.applyEffects=function(r){for(var a=this;this._activeEffects.length;)this.popEffect();r.forEach(function(n){return a.applyEffect(n)})},s.prototype.applyEffect=function(r){this.ctx.save(),wO(r)&&(this.ctx.globalAlpha=r.opacity),NO(r)&&(this.ctx.translate(r.offsetX,r.offsetY),this.ctx.transform(r.matrix[0],r.matrix[1],r.matrix[2],r.matrix[3],r.matrix[4],r.matrix[5]),this.ctx.translate(-r.offsetX,-r.offsetY)),y4(r)&&(this.path(r.path),this.ctx.clip()),this._activeEffects.push(r)},s.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},s.prototype.renderStack=function(r){return ki(this,void 0,void 0,function(){var a;return ri(this,function(n){switch(n.label){case 0:return a=r.element.container.styles,a.isVisible()?[4,this.renderStackContent(r)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[2]}})})},s.prototype.renderNode=function(r){return ki(this,void 0,void 0,function(){return ri(this,function(a){switch(a.label){case 0:if(ln(r.container.flags,16))debugger;return r.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(r)]:[3,3];case 1:return a.sent(),[4,this.renderNodeContent(r)];case 2:a.sent(),a.label=3;case 3:return[2]}})})},s.prototype.renderTextWithLetterSpacing=function(r,a,n){var i=this;if(a===0)this.ctx.fillText(r.text,r.bounds.left,r.bounds.top+n);else{var l=lj(r.text);l.reduce(function(o,u){return i.ctx.fillText(u,o,r.bounds.top+n),o+i.ctx.measureText(u).width},r.bounds.left)}},s.prototype.createFontStyle=function(r){var a=r.fontVariant.filter(function(l){return l==="normal"||l==="small-caps"}).join(""),n=HO(r.fontFamily).join(", "),i=Of(r.fontSize)?""+r.fontSize.number+r.fontSize.unit:r.fontSize.number+"px";return[[r.fontStyle,a,r.fontWeight,i,n].join(" "),n,i]},s.prototype.renderTextNode=function(r,a){return ki(this,void 0,void 0,function(){var n,i,l,o,u,d,c,h,A=this;return ri(this,function(f){return n=this.createFontStyle(a),i=n[0],l=n[1],o=n[2],this.ctx.font=i,this.ctx.direction=a.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",u=this.fontMetrics.getMetrics(l,o),d=u.baseline,c=u.middle,h=a.paintOrder,r.textBounds.forEach(function(g){h.forEach(function(v){switch(v){case 0:A.ctx.fillStyle=yn(a.color),A.renderTextWithLetterSpacing(g,a.letterSpacing,d);var b=a.textShadow;b.length&&g.text.trim().length&&(b.slice(0).reverse().forEach(function(y){A.ctx.shadowColor=yn(y.color),A.ctx.shadowOffsetX=y.offsetX.number*A.options.scale,A.ctx.shadowOffsetY=y.offsetY.number*A.options.scale,A.ctx.shadowBlur=y.blur.number,A.renderTextWithLetterSpacing(g,a.letterSpacing,d)}),A.ctx.shadowColor="",A.ctx.shadowOffsetX=0,A.ctx.shadowOffsetY=0,A.ctx.shadowBlur=0),a.textDecorationLine.length&&(A.ctx.fillStyle=yn(a.textDecorationColor||a.color),a.textDecorationLine.forEach(function(y){switch(y){case 1:A.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top+d),g.bounds.width,1);break;case 2:A.ctx.fillRect(g.bounds.left,Math.round(g.bounds.top),g.bounds.width,1);break;case 3:A.ctx.fillRect(g.bounds.left,Math.ceil(g.bounds.top+c),g.bounds.width,1);break}}));break;case 1:a.webkitTextStrokeWidth&&g.text.trim().length&&(A.ctx.strokeStyle=yn(a.webkitTextStrokeColor),A.ctx.lineWidth=a.webkitTextStrokeWidth,A.ctx.lineJoin=window.chrome?"miter":"round",A.ctx.strokeText(g.text,g.bounds.left,g.bounds.top+d)),A.ctx.strokeStyle="",A.ctx.lineWidth=0,A.ctx.lineJoin="miter";break}})}),[2]})})},s.prototype.renderReplacedElement=function(r,a,n){if(n&&r.intrinsicWidth>0&&r.intrinsicHeight>0){var i=i0(r),l=n0(a);this.path(l),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,r.intrinsicWidth,r.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore()}},s.prototype.renderNodeContent=function(r){return ki(this,void 0,void 0,function(){var a,n,i,l,o,u,j,j,d,c,h,A,S,f,g,B,v,b,y,j,N,S,B;return ri(this,function(P){switch(P.label){case 0:this.applyEffects(r.getEffects(4)),a=r.container,n=r.curves,i=a.styles,l=0,o=a.textNodes,P.label=1;case 1:return l<o.length?(u=o[l],[4,this.renderTextNode(u,i)]):[3,4];case 2:P.sent(),P.label=3;case 3:return l++,[3,1];case 4:if(!(a instanceof a4))return[3,8];P.label=5;case 5:return P.trys.push([5,7,,8]),[4,this.context.cache.match(a.src)];case 6:return j=P.sent(),this.renderReplacedElement(a,n,j),[3,8];case 7:return P.sent(),this.context.logger.error("Error loading image "+a.src),[3,8];case 8:if(a instanceof n4&&this.renderReplacedElement(a,n,a.canvas),!(a instanceof i4))return[3,12];P.label=9;case 9:return P.trys.push([9,11,,12]),[4,this.context.cache.match(a.svg)];case 10:return j=P.sent(),this.renderReplacedElement(a,n,j),[3,12];case 11:return P.sent(),this.context.logger.error("Error loading svg "+a.svg.substring(0,255)),[3,12];case 12:return a instanceof d4&&a.tree?(d=new s(this.context,{scale:this.options.scale,backgroundColor:a.backgroundColor,x:0,y:0,width:a.width,height:a.height}),[4,d.render(a.tree)]):[3,14];case 13:c=P.sent(),a.width&&a.height&&this.ctx.drawImage(c,0,0,a.width,a.height,a.bounds.left,a.bounds.top,a.bounds.width,a.bounds.height),P.label=14;case 14:if(a instanceof oj&&(h=Math.min(a.bounds.width,a.bounds.height),a.type===e0?a.checked&&(this.ctx.save(),this.path([new _s(a.bounds.left+h*.39363,a.bounds.top+h*.79),new _s(a.bounds.left+h*.16,a.bounds.top+h*.5549),new _s(a.bounds.left+h*.27347,a.bounds.top+h*.44071),new _s(a.bounds.left+h*.39694,a.bounds.top+h*.5649),new _s(a.bounds.left+h*.72983,a.bounds.top+h*.23),new _s(a.bounds.left+h*.84,a.bounds.top+h*.34085),new _s(a.bounds.left+h*.39363,a.bounds.top+h*.79)]),this.ctx.fillStyle=yn(N2),this.ctx.fill(),this.ctx.restore()):a.type===t0&&a.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(a.bounds.left+h/2,a.bounds.top+h/2,h/4,0,Math.PI*2,!0),this.ctx.fillStyle=yn(N2),this.ctx.fill(),this.ctx.restore())),RO(a)&&a.value.length){switch(A=this.createFontStyle(i),S=A[0],f=A[1],g=this.fontMetrics.getMetrics(S,f).baseline,this.ctx.font=S,this.ctx.fillStyle=yn(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=QO(a.styles.textAlign),B=i0(a),v=0,a.styles.textAlign){case 1:v+=B.width/2;break;case 2:v+=B.width;break}b=B.add(v,0,0,-B.height/2+1),this.ctx.save(),this.path([new _s(B.left,B.top),new _s(B.left+B.width,B.top),new _s(B.left+B.width,B.top+B.height),new _s(B.left,B.top+B.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Gm(a.value,b),i.letterSpacing,g),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!ln(a.styles.display,2048))return[3,20];if(a.styles.listStyleImage===null)return[3,19];if(y=a.styles.listStyleImage,y.type!==0)return[3,18];j=void 0,N=y.url,P.label=15;case 15:return P.trys.push([15,17,,18]),[4,this.context.cache.match(N)];case 16:return j=P.sent(),this.ctx.drawImage(j,a.bounds.left-(j.width+10),a.bounds.top),[3,18];case 17:return P.sent(),this.context.logger.error("Error loading list-style-image "+N),[3,18];case 18:return[3,20];case 19:r.listValue&&a.styles.listStyleType!==-1&&(S=this.createFontStyle(i)[0],this.ctx.font=S,this.ctx.fillStyle=yn(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",B=new Jc(a.bounds.left,a.bounds.top+Jr(a.styles.paddingTop,a.bounds.width),a.bounds.width,i2(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Gm(r.listValue,B),i.letterSpacing,i2(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),P.label=20;case 20:return[2]}})})},s.prototype.renderStackContent=function(r){return ki(this,void 0,void 0,function(){var a,n,y,i,l,y,o,u,y,d,c,y,h,A,y,f,g,y,v,b,y;return ri(this,function(j){switch(j.label){case 0:if(ln(r.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(r.element)];case 1:j.sent(),a=0,n=r.negativeZIndex,j.label=2;case 2:return a<n.length?(y=n[a],[4,this.renderStack(y)]):[3,5];case 3:j.sent(),j.label=4;case 4:return a++,[3,2];case 5:return[4,this.renderNodeContent(r.element)];case 6:j.sent(),i=0,l=r.nonInlineLevel,j.label=7;case 7:return i<l.length?(y=l[i],[4,this.renderNode(y)]):[3,10];case 8:j.sent(),j.label=9;case 9:return i++,[3,7];case 10:o=0,u=r.nonPositionedFloats,j.label=11;case 11:return o<u.length?(y=u[o],[4,this.renderStack(y)]):[3,14];case 12:j.sent(),j.label=13;case 13:return o++,[3,11];case 14:d=0,c=r.nonPositionedInlineLevel,j.label=15;case 15:return d<c.length?(y=c[d],[4,this.renderStack(y)]):[3,18];case 16:j.sent(),j.label=17;case 17:return d++,[3,15];case 18:h=0,A=r.inlineLevel,j.label=19;case 19:return h<A.length?(y=A[h],[4,this.renderNode(y)]):[3,22];case 20:j.sent(),j.label=21;case 21:return h++,[3,19];case 22:f=0,g=r.zeroOrAutoZIndexOrTransformedOrOpacity,j.label=23;case 23:return f<g.length?(y=g[f],[4,this.renderStack(y)]):[3,26];case 24:j.sent(),j.label=25;case 25:return f++,[3,23];case 26:v=0,b=r.positiveZIndex,j.label=27;case 27:return v<b.length?(y=b[v],[4,this.renderStack(y)]):[3,30];case 28:j.sent(),j.label=29;case 29:return v++,[3,27];case 30:return[2]}})})},s.prototype.mask=function(r){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(r.slice(0).reverse()),this.ctx.closePath()},s.prototype.path=function(r){this.ctx.beginPath(),this.formatPath(r),this.ctx.closePath()},s.prototype.formatPath=function(r){var a=this;r.forEach(function(n,i){var l=Ml(n)?n.start:n;i===0?a.ctx.moveTo(l.x,l.y):a.ctx.lineTo(l.x,l.y),Ml(n)&&a.ctx.bezierCurveTo(n.startControl.x,n.startControl.y,n.endControl.x,n.endControl.y,n.end.x,n.end.y)})},s.prototype.renderRepeat=function(r,a,n,i){this.path(r),this.ctx.fillStyle=a,this.ctx.translate(n,i),this.ctx.fill(),this.ctx.translate(-n,-i)},s.prototype.resizeImage=function(r,a,n){var i;if(r.width===a&&r.height===n)return r;var l=(i=this.canvas.ownerDocument)!==null&&i!==void 0?i:document,o=l.createElement("canvas");o.width=Math.max(1,a),o.height=Math.max(1,n);var u=o.getContext("2d");return u.drawImage(r,0,0,r.width,r.height,0,0,a,n),o},s.prototype.renderBackgroundImage=function(r){return ki(this,void 0,void 0,function(){var a,n,i,l,o,u;return ri(this,function(d){switch(d.label){case 0:a=r.styles.backgroundImage.length-1,n=function(c){var h,A,f,q,Y,J,z,I,U,g,q,Y,J,z,I,v,b,y,j,N,S,B,P,L,U,H,q,V,M,z,I,G,Y,J,T,k,D,Q,C,E,w,O;return ri(this,function(R){switch(R.label){case 0:if(c.type!==0)return[3,5];h=void 0,A=c.url,R.label=1;case 1:return R.trys.push([1,3,,4]),[4,i.context.cache.match(A)];case 2:return h=R.sent(),[3,4];case 3:return R.sent(),i.context.logger.error("Error loading background-image "+A),[3,4];case 4:return h&&(f=zv(r,a,[h.width,h.height,h.width/h.height]),q=f[0],Y=f[1],J=f[2],z=f[3],I=f[4],U=i.ctx.createPattern(i.resizeImage(h,z,I),"repeat"),i.renderRepeat(q,U,Y,J)),[3,6];case 5:NP(c)?(g=zv(r,a,[null,null,null]),q=g[0],Y=g[1],J=g[2],z=g[3],I=g[4],v=gP(c.angle,z,I),b=v[0],y=v[1],j=v[2],N=v[3],S=v[4],B=document.createElement("canvas"),B.width=z,B.height=I,P=B.getContext("2d"),L=P.createLinearGradient(y,N,j,S),a2(c.stops,b).forEach(function(X){return L.addColorStop(X.stop,yn(X.color))}),P.fillStyle=L,P.fillRect(0,0,z,I),z>0&&I>0&&(U=i.ctx.createPattern(B,"repeat"),i.renderRepeat(q,U,Y,J))):wP(c)&&(H=zv(r,a,[null,null,null]),q=H[0],V=H[1],M=H[2],z=H[3],I=H[4],G=c.position.length===0?[aj]:c.position,Y=Jr(G[0],z),J=Jr(G[G.length-1],I),T=vP(c,Y,J,z,I),k=T[0],D=T[1],k>0&&D>0&&(Q=i.ctx.createRadialGradient(V+Y,M+J,0,V+Y,M+J,k),a2(c.stops,k*2).forEach(function(X){return Q.addColorStop(X.stop,yn(X.color))}),i.path(q),i.ctx.fillStyle=Q,k!==D?(C=r.bounds.left+.5*r.bounds.width,E=r.bounds.top+.5*r.bounds.height,w=D/k,O=1/w,i.ctx.save(),i.ctx.translate(C,E),i.ctx.transform(1,0,0,w,0,0),i.ctx.translate(-C,-E),i.ctx.fillRect(V,O*(M-E)+E,z,I*O),i.ctx.restore()):i.ctx.fill())),R.label=6;case 6:return a--,[2]}})},i=this,l=0,o=r.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return l<o.length?(u=o[l],[5,n(u)]):[3,4];case 2:d.sent(),d.label=3;case 3:return l++,[3,1];case 4:return[2]}})})},s.prototype.renderSolidBorder=function(r,a,n){return ki(this,void 0,void 0,function(){return ri(this,function(i){return this.path(D2(n,a)),this.ctx.fillStyle=yn(r),this.ctx.fill(),[2]})})},s.prototype.renderDoubleBorder=function(r,a,n,i){return ki(this,void 0,void 0,function(){var l,o;return ri(this,function(u){switch(u.label){case 0:return a<3?[4,this.renderSolidBorder(r,n,i)]:[3,2];case 1:return u.sent(),[2];case 2:return l=CO(i,n),this.path(l),this.ctx.fillStyle=yn(r),this.ctx.fill(),o=kO(i,n),this.path(o),this.ctx.fill(),[2]}})})},s.prototype.renderNodeBackgroundAndBorders=function(r){return ki(this,void 0,void 0,function(){var a,n,i,l,o,u,d,c,h=this;return ri(this,function(A){switch(A.label){case 0:return this.applyEffects(r.getEffects(2)),a=r.container.styles,n=!lu(a.backgroundColor)||a.backgroundImage.length,i=[{style:a.borderTopStyle,color:a.borderTopColor,width:a.borderTopWidth},{style:a.borderRightStyle,color:a.borderRightColor,width:a.borderRightWidth},{style:a.borderBottomStyle,color:a.borderBottomColor,width:a.borderBottomWidth},{style:a.borderLeftStyle,color:a.borderLeftColor,width:a.borderLeftWidth}],l=OO(fh(a.backgroundClip,0),r.curves),n||a.boxShadow.length?(this.ctx.save(),this.path(l),this.ctx.clip(),lu(a.backgroundColor)||(this.ctx.fillStyle=yn(a.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(r.container)]):[3,2];case 1:A.sent(),this.ctx.restore(),a.boxShadow.slice(0).reverse().forEach(function(f){h.ctx.save();var g=a0(r.curves),v=f.inset?0:UO,b=_O(g,-v+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(h.path(g),h.ctx.clip(),h.mask(b)):(h.mask(g),h.ctx.clip(),h.path(b)),h.ctx.shadowOffsetX=f.offsetX.number+v,h.ctx.shadowOffsetY=f.offsetY.number,h.ctx.shadowColor=yn(f.color),h.ctx.shadowBlur=f.blur.number,h.ctx.fillStyle=f.inset?yn(f.color):"rgba(0,0,0,1)",h.ctx.fill(),h.ctx.restore()}),A.label=2;case 2:o=0,u=0,d=i,A.label=3;case 3:return u<d.length?(c=d[u],c.style!==0&&!lu(c.color)&&c.width>0?c.style!==2?[3,5]:[4,this.renderDashedDottedBorder(c.color,c.width,o,r.curves,2)]:[3,11]):[3,13];case 4:return A.sent(),[3,11];case 5:return c.style!==3?[3,7]:[4,this.renderDashedDottedBorder(c.color,c.width,o,r.curves,3)];case 6:return A.sent(),[3,11];case 7:return c.style!==4?[3,9]:[4,this.renderDoubleBorder(c.color,c.width,o,r.curves)];case 8:return A.sent(),[3,11];case 9:return[4,this.renderSolidBorder(c.color,o,r.curves)];case 10:A.sent(),A.label=11;case 11:o++,A.label=12;case 12:return u++,[3,3];case 13:return[2]}})})},s.prototype.renderDashedDottedBorder=function(r,a,n,i,l){return ki(this,void 0,void 0,function(){var o,u,d,c,h,A,f,g,v,b,y,j,N,S,B,P,B,P;return ri(this,function(L){return this.ctx.save(),o=BO(i,n),u=D2(i,n),l===2&&(this.path(u),this.ctx.clip()),Ml(u[0])?(d=u[0].start.x,c=u[0].start.y):(d=u[0].x,c=u[0].y),Ml(u[1])?(h=u[1].end.x,A=u[1].end.y):(h=u[1].x,A=u[1].y),n===0||n===2?f=Math.abs(d-h):f=Math.abs(c-A),this.ctx.beginPath(),l===3?this.formatPath(o):this.formatPath(u.slice(0,2)),g=a<3?a*3:a*2,v=a<3?a*2:a,l===3&&(g=a,v=a),b=!0,f<=g*2?b=!1:f<=g*2+v?(y=f/(2*g+v),g*=y,v*=y):(j=Math.floor((f+v)/(g+v)),N=(f-j*g)/(j-1),S=(f-(j+1)*g)/j,v=S<=0||Math.abs(v-N)<Math.abs(v-S)?N:S),b&&(l===3?this.ctx.setLineDash([0,g+v]):this.ctx.setLineDash([g,v])),l===3?(this.ctx.lineCap="round",this.ctx.lineWidth=a):this.ctx.lineWidth=a*2+1.1,this.ctx.strokeStyle=yn(r),this.ctx.stroke(),this.ctx.setLineDash([]),l===2&&(Ml(u[0])&&(B=u[3],P=u[0],this.ctx.beginPath(),this.formatPath([new _s(B.end.x,B.end.y),new _s(P.start.x,P.start.y)]),this.ctx.stroke()),Ml(u[1])&&(B=u[1],P=u[2],this.ctx.beginPath(),this.formatPath([new _s(B.end.x,B.end.y),new _s(P.start.x,P.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},s.prototype.render=function(r){return ki(this,void 0,void 0,function(){var a;return ri(this,function(n){switch(n.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=yn(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),a=SO(r),[4,this.renderStack(a)];case 1:return n.sent(),this.applyEffects([]),[2,this.canvas]}})})},s})(S4),RO=function(t){return t instanceof c4||t instanceof o4?!0:t instanceof oj&&t.type!==t0&&t.type!==e0},OO=function(t,s){switch(t){case 0:return a0(s);case 2:return bO(s);case 1:default:return n0(s)}},QO=function(t){switch(t){case 1:return"center";case 2:return"right";case 0:default:return"left"}},MO=["-apple-system","system-ui"],HO=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(s){return MO.indexOf(s)===-1}):t},qO=(function(t){Do(s,t);function s(r,a){var n=t.call(this,r,a)||this;return n.canvas=a.canvas?a.canvas:document.createElement("canvas"),n.ctx=n.canvas.getContext("2d"),n.options=a,n.canvas.width=Math.floor(a.width*a.scale),n.canvas.height=Math.floor(a.height*a.scale),n.canvas.style.width=a.width+"px",n.canvas.style.height=a.height+"px",n.ctx.scale(n.options.scale,n.options.scale),n.ctx.translate(-a.x,-a.y),n.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+a.width+"x"+a.height+" at "+a.x+","+a.y+") with scale "+a.scale),n}return s.prototype.render=function(r){return ki(this,void 0,void 0,function(){var a,n;return ri(this,function(i){switch(i.label){case 0:return a=hy(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,r),[4,VO(a)];case 1:return n=i.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=yn(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(n,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},s})(S4),VO=function(t){return new Promise(function(s,r){var a=new Image;a.onload=function(){s(a)},a.onerror=r,a.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(t))})},$O=(function(){function t(s){var r=s.id,a=s.enabled;this.id=r,this.enabled=a,this.start=Date.now()}return t.prototype.debug=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,Qp([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.prototype.getTime=function(){return Date.now()-this.start},t.prototype.info=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,Qp([this.id,this.getTime()+"ms"],s))},t.prototype.warn=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,Qp([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.prototype.error=function(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,Qp([this.id,this.getTime()+"ms"],s)):this.info.apply(this,s))},t.instances={},t})(),WO=(function(){function t(s,r){var a;this.windowBounds=r,this.instanceName="#"+t.instanceCount++,this.logger=new $O({id:this.instanceName,enabled:s.logging}),this.cache=(a=s.cache)!==null&&a!==void 0?a:new AO(this,s)}return t.instanceCount=1,t})(),Ai=function(t,s){return s===void 0&&(s={}),GO(t,s)};typeof window<"u"&&b4.setContext(window);var GO=function(t,s){return ki(void 0,void 0,void 0,function(){var r,a,n,i,l,o,u,d,c,h,A,f,g,v,b,y,j,N,S,B,L,P,L,U,H,q,V,M,z,I,G,Y,J,T,k,D,Q,C,E,w;return ri(this,function(O){switch(O.label){case 0:if(!t||typeof t!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(r=t.ownerDocument,!r)throw new Error("Element is not attached to a Document");if(a=r.defaultView,!a)throw new Error("Document is not attached to a Window");return n={allowTaint:(U=s.allowTaint)!==null&&U!==void 0?U:!1,imageTimeout:(H=s.imageTimeout)!==null&&H!==void 0?H:15e3,proxy:s.proxy,useCORS:(q=s.useCORS)!==null&&q!==void 0?q:!1},i=Jb({logging:(V=s.logging)!==null&&V!==void 0?V:!0,cache:s.cache},n),l={windowWidth:(M=s.windowWidth)!==null&&M!==void 0?M:a.innerWidth,windowHeight:(z=s.windowHeight)!==null&&z!==void 0?z:a.innerHeight,scrollX:(I=s.scrollX)!==null&&I!==void 0?I:a.pageXOffset,scrollY:(G=s.scrollY)!==null&&G!==void 0?G:a.pageYOffset},o=new Jc(l.scrollX,l.scrollY,l.windowWidth,l.windowHeight),u=new WO(i,o),d=(Y=s.foreignObjectRendering)!==null&&Y!==void 0?Y:!1,c={allowTaint:(J=s.allowTaint)!==null&&J!==void 0?J:!1,onclone:s.onclone,ignoreElements:s.ignoreElements,inlineImages:d,copyStyles:d},u.logger.debug("Starting document clone with size "+o.width+"x"+o.height+" scrolled to "+-o.left+","+-o.top),h=new T2(u,t,c),A=h.clonedReferenceElement,A?[4,h.toIFrame(r,o)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=O.sent(),g=cj(A)||z8(A)?_D(A.ownerDocument):$0(u,A),v=g.width,b=g.height,y=g.left,j=g.top,N=KO(u,A,s.backgroundColor),S={canvas:s.canvas,backgroundColor:N,scale:(k=(T=s.scale)!==null&&T!==void 0?T:a.devicePixelRatio)!==null&&k!==void 0?k:1,x:((D=s.x)!==null&&D!==void 0?D:0)+y,y:((Q=s.y)!==null&&Q!==void 0?Q:0)+j,width:(C=s.width)!==null&&C!==void 0?C:Math.ceil(v),height:(E=s.height)!==null&&E!==void 0?E:Math.ceil(b)},d?(u.logger.debug("Document cloned, using foreign object rendering"),L=new qO(u,S),[4,L.render(A)]):[3,3];case 2:return B=O.sent(),[3,5];case 3:return u.logger.debug("Document cloned, element located at "+y+","+j+" with size "+v+"x"+b+" using computed rendering"),u.logger.debug("Starting DOM parsing"),P=A4(u,A),N===P.styles.backgroundColor&&(P.styles.backgroundColor=Wc.TRANSPARENT),u.logger.debug("Starting renderer for element at "+S.x+","+S.y+" with size "+S.width+"x"+S.height),L=new PO(u,S),[4,L.render(P)];case 4:B=O.sent(),O.label=5;case 5:return(!((w=s.removeContainer)!==null&&w!==void 0)||w)&&(T2.destroy(f)||u.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),u.logger.debug("Finished rendering"),[2,B]}})})},KO=function(t,s,r){var a=s.ownerDocument,n=a.documentElement?$m(t,getComputedStyle(a.documentElement).backgroundColor):Wc.TRANSPARENT,i=a.body?$m(t,getComputedStyle(a.body).backgroundColor):Wc.TRANSPARENT,l=typeof r=="string"?$m(t,r):r===null?Wc.TRANSPARENT:4294967295;return s===a.documentElement?lu(n)?lu(i)?l:i:n:l};const zO=Object.freeze(Object.defineProperty({__proto__:null,default:Ai},Symbol.toStringTag,{value:"Module"}));function YO(){const t=ys(),[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(""),[o,u]=x.useState(""),[d,c]=x.useState("ALL"),[h,A]=x.useState({name:"",address:"",city:"",state:"",country:"",postalCode:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""});x.useEffect(()=>{f()},[]);const f=async()=>{var H,q,V;try{n(!0),l("");const M=await ee.get("/sales/quotations"),z=M.data&&M.data.data&&M.data.data.items||((H=M.data)==null?void 0:H.items)||[];r(Array.isArray(z)?z:[])}catch(M){l(((V=(q=M==null?void 0:M.response)==null?void 0:q.data)==null?void 0:V.message)||"Error fetching quotations"),console.error("Error fetching quotations:",M)}finally{n(!1)}};x.useEffect(()=>{let H=!0;async function q(){var V,M,z;try{const G=(M=(V=(await ee.get("/admin/me")).data)==null?void 0:V.scope)==null?void 0:M.companyId;if(!G)return;const J=((z=(await ee.get(`/admin/companies/${G}`)).data)==null?void 0:z.item)||{},T=J.has_logo===1||J.has_logo===!0?`/api/admin/companies/${G}/logo`:"";if(!H)return;A({name:J.name||"Company",address:J.address||"",city:J.city||"",state:J.state||"",country:J.country||"",postalCode:J.postal_code||"",phone:J.telephone||"",email:J.email||"",website:J.website||"",taxId:J.tax_id||"",registrationNo:J.registration_no||"",logoUrl:String(T||"")})}catch{}}return q(),()=>{H=!1}},[]);function g(H){return String(H??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function v(H){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Quotation</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${H||""}</body>
</html>`}async function b(H){var V;const q=Array.from(((V=H==null?void 0:H.querySelectorAll)==null?void 0:V.call(H,"img"))||[]);q.length&&await Promise.all(q.map(M=>new Promise(z=>{if(M.complete)return z();const I=()=>z();M.addEventListener("load",I,{once:!0}),M.addEventListener("error",I,{once:!0})})))}const y=(H,q)=>{const V=String(h.logoUrl||"").trim(),M=V?`<img src="${V}" alt="${g(h.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",z=(Array.isArray(q)?q:[]).map(J=>{const T=Number(J.qty??J.quantity??0),k=Number(J.unit_price??0),D=Number(J.discount_percent??0),Q=Number(J.net_amount??T*k-T*k*D/100);return{item_name:String(J.item_name||""),qty:T.toFixed(2),unit_price:k.toFixed(2),discount:D.toFixed(2),net:Q.toFixed(2)}}),I=z.reduce((J,T)=>J+Number(T.qty)*Number(T.unit_price),0),G=z.reduce((J,T)=>J+Number(T.qty)*Number(T.unit_price)*Number(T.discount)/100,0),Y=I-G;return{company:{name:h.name||"",address:h.address||"",city:h.city||"",state:h.state||"",country:h.country||"",postalCode:h.postalCode||"",phone:h.phone||"",email:h.email||"",website:h.website||"",taxId:h.taxId||"",registrationNo:h.registrationNo||"",logoUrl:V,logoHtml:M},quotation:{quotation_no:String(H.quotation_no||""),quotation_date:H.quotation_date?String(H.quotation_date).slice(0,10):"",valid_until:H.valid_until?String(H.valid_until).slice(0,10):"",payment_type:String(H.payment_type||""),price_type:String(H.price_type||"")},customer:{name:String(H.customer_name||""),address:String(H.address||""),city:String(H.city||""),state:String(H.state||""),country:String(H.country||""),phone:String(H.phone||""),email:String(H.email||"")},items:z,totals:{subtotal:I.toFixed(2),discount:G.toFixed(2),netSubtotal:Y.toFixed(2),total:Number(H.net_amount??H.total_amount??Y).toFixed(2)}}};function j(H){const q=H.company||{},V=H.quotation||{},M=H.customer||{},z=Array.isArray(H.items)?H.items:[],I=H.totals||{};return`
      <style>
        .doc { color: #0f172a; font-size: 12px; }
        .doc-header { display: flex; justify-content: space-between; align-items: center; }
        .doc-title { font-weight: 800; font-size: 18px; color: #296d8f; }
        .company-block { display: flex; gap: 12px; align-items: center; }
        .company-logo { max-height: 80px; object-fit: contain; }
        .company-info div { line-height: 1.4; }
        .meta { text-align: right; font-size: 12px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        table { border-collapse: collapse; width: 100%; font-size: 12px; }
        th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
        th { background: #f8fafc; text-align: left; }
        .totals { display: flex; justify-content: flex-end; margin-top: 12px; }
        .totals table { width: 360px; }
      </style>
      <div class="doc">
        <div class="doc-header">
          <div class="company-block">
            ${q.logoUrl?`<img src="${q.logoUrl}" alt="${g(q.name||"Company")}" class="company-logo" />`:""}
            <div class="company-info">
              <div>${g(q.name||"")}</div>
              <div>${g(q.address||"")}</div>
              <div>${g(q.city||"")}${q.city?",":""} ${g(q.state||"")} ${g(q.country||"")}</div>
              <div>${g(q.phone||"")} ${g(q.email||"")}</div>
              <div>${g(q.website||"")}</div>
              <div>${q.taxId?`Tax ID: ${g(q.taxId)}`:""}</div>
              <div>${q.registrationNo?`Reg No: ${g(q.registrationNo)}`:""}</div>
            </div>
          </div>
          <div class="meta">
            <div class="doc-title">Quotation</div>
            <div>Quotation No: ${g(V.quotation_no||"")}</div>
            <div>Date: ${g(V.quotation_date||"")}</div>
            <div>Valid Until: ${g(V.valid_until||"")}</div>
          </div>
        </div>
        <div class="grid-2" style="margin-top: 6px;">
          <div>
            <div style="font-weight:700;margin-bottom:4px;">Customer</div>
            <div>${g(M.name||"")}</div>
            <div>${g(M.address||"")}</div>
            <div>${g(M.city||"")}${M.city?",":""} ${g(M.state||"")} ${g(M.country||"")}</div>
            <div>${g(M.phone||"")} ${g(M.email||"")}</div>
          </div>
          <div>
            <div style="font-weight:700;margin-bottom:4px;">Payment</div>
            <div>Payment Type: ${g(V.payment_type||"")}</div>
            <div>Price Type: ${g(V.price_type||"")}</div>
          </div>
        </div>
        <table style="margin-top: 8px;">
          <thead>
            <tr>
              <th>Description</th>
              <th style="text-align:right;">Qty</th>
              <th style="text-align:right;">Unit Price</th>
              <th style="text-align:right;">Discount</th>
              <th style="text-align:right;">Net</th>
            </tr>
          </thead>
          <tbody>
            ${z.map(G=>`
                <tr>
                  <td>${g(G.item_name||"")}</td>
                  <td style="text-align:right;">${g(G.qty||"")}</td>
                  <td style="text-align:right;">${g(G.unit_price||"")}</td>
                  <td style="text-align:right;">${g(G.discount||"")}</td>
                  <td style="text-align:right;">${g(G.net||"")}</td>
                </tr>
              `).join("")}
          </tbody>
        </table>
        <div class="totals">
          <table>
            <tbody>
              <tr><td>Subtotal</td><td style="text-align:right;">${g(I.subtotal||"")}</td></tr>
              <tr><td>Discount</td><td style="text-align:right;">${g(I.discount||"")}</td></tr>
              <tr><td>Net Subtotal</td><td style="text-align:right;">${g(I.netSubtotal||"")}</td></tr>
              <tr><td><strong>Total</strong></td><td style="text-align:right;"><strong>${g(I.total||"")}</strong></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    `}async function N(H){var q,V,M;try{const z=await ee.get(`/sales/quotations/${H}`),I=((q=z.data)==null?void 0:q.item)||{},G=Array.isArray((V=z.data)==null?void 0:V.details)?z.data.details:[],Y=y(I,G),J=v(j(Y)),T=document.createElement("iframe");T.style.position="fixed",T.style.right="0",T.style.bottom="0",T.style.width="0",T.style.height="0",T.style.border="0",document.body.appendChild(T);const k=((M=T.contentWindow)==null?void 0:M.document)||T.contentDocument||null;if(!k){document.body.removeChild(T);return}k.open(),k.write(J),k.close();const D=T.contentWindow||window;setTimeout(()=>{D.focus();try{D.print()}catch{}setTimeout(()=>{document.body.removeChild(T)},100)},200)}catch{}}async function S(H){var q,V;try{const M=await ee.get(`/sales/quotations/${H}`),z=((q=M.data)==null?void 0:q.item)||{},I=Array.isArray((V=M.data)==null?void 0:V.details)?M.data.details:[],G=y(z,I),Y=j(G),J=document.createElement("div");J.style.position="fixed",J.style.left="-10000px",J.style.top="0",J.style.width="794px",J.style.background="white",J.style.padding="32px",J.innerHTML=Y,document.body.appendChild(J);try{await b(J);const T=await Ai(J,{scale:2,useCORS:!0}),k=T.toDataURL("image/png"),D=new ds("p","mm","a4"),Q=D.internal.pageSize.getWidth(),C=D.internal.pageSize.getHeight(),E=Q,w=T.height*E/T.width;let O=0;for(;O<w;)D.addImage(k,"PNG",0,-O,E,w),O+=C,O<w&&D.addPage();const R="Quotation_"+(String(z.quotation_no||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";D.save(R)}finally{document.body.removeChild(J)}}catch{}}const B=H=>{const q={DRAFT:"badge badge-warning",SENT:"badge badge-info",ACCEPTED:"badge badge-success",REJECTED:"badge badge-error",EXPIRED:"badge bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"};return e.jsx("span",{className:q[H]||"badge",children:H})},P=s.filter(H=>{const q=String(H.quotation_no||"").toLowerCase().includes(o.toLowerCase())||String(H.customer_name||"").toLowerCase().includes(o.toLowerCase()),V=d==="ALL"||H.status===d;return q&&V});function L(H){const q=String(H||"").trim();if(!q)return"-";const V=new Date(q);return isNaN(V.getTime())?"-":V.toLocaleDateString()}function U(H){const q=Number(H);return isFinite(q)?q.toLocaleString("en-US",{minimumFractionDigits:2}):"0.00"}return a?e.jsx("div",{className:"text-center py-8",children:"Loading quotations..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Quotations"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customer quotations and proposals"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/sales/quotations/new",className:"btn-success",children:"+ New Quotation"})]})]})})}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by quotation number or customer...",className:"input",value:o,onChange:H=>u(H.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:d,onChange:H=>c(H.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SENT",children:"Sent"}),e.jsx("option",{value:"ACCEPTED",children:"Accepted"}),e.jsx("option",{value:"REJECTED",children:"Rejected"}),e.jsx("option",{value:"EXPIRED",children:"Expired"})]})})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading quotations..."})]}):P.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No quotations found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Quotation No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Valid Until"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:P.map(H=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:H.quotation_no}),e.jsx("td",{children:L(H.quotation_date)}),e.jsx("td",{children:H.customer_name}),e.jsx("td",{children:L(H.valid_until)}),e.jsx("td",{className:"font-semibold",children:U(H.total_amount)}),e.jsx("td",{children:B(H.status)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/sales/quotations/${H.id}?mode=view`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),e.jsx("button",{onClick:()=>t(`/sales/quotations/${H.id}?mode=edit`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>N(H.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",children:"Print"}),e.jsx("button",{onClick:()=>S(H.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",children:"PDF"})]})})]},H.id))})]})})]})})]})}const qs="/assets/OMNISUITE_LOGO_FILL-CeKU3wr4.png";function P2(){var ze,Fe;const t=ys(),{id:s}=Ls(),r=!!s,{user:a}=ca(),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState({quotation_no:"",quotation_date:new Date().toISOString().split("T")[0],customer_id:"",valid_days:30,valid_until:"",status:"DRAFT",terms_and_conditions:"",remarks:"",warehouse_id:"",price_type:"RETAIL",payment_type:"CASH",currency_id:4,exchange_rate:1}),[c,h]=x.useState([]),[A,f]=x.useState({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:"",remarks:""}),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState([]),[S,B]=x.useState([]),[P,L]=x.useState([]),[U,H]=x.useState([]),[q,V]=x.useState(""),[M,z]=x.useState(!1),[I,G]=x.useState({}),[Y,J]=x.useState(""),[T,k]=x.useState(""),[D,Q]=x.useState(""),[C,E]=x.useState(""),[w,O]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""}),[R,X]=x.useState(""),ne=x.useRef(null),te=[{value:"DRAFT",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"SENT",label:"Sent",color:"bg-blue-100 text-blue-800"},{value:"ACCEPTED",label:"Accepted",color:"bg-green-100 text-green-800"},{value:"REJECTED",label:"Rejected",color:"bg-red-100 text-red-800"},{value:"EXPIRED",label:"Expired",color:"bg-orange-100 text-orange-800"}],oe=(xe,we)=>{if(!xe||!we)return"";const Xe=new Date(xe);return Xe.setDate(Xe.getDate()+parseInt(we)),Xe.toISOString().split("T")[0]},ce=xe=>{var Ae;const we=parseFloat(xe.qty)||0,Xe=parseFloat(xe.unit_price)||0,ut=parseFloat(xe.discount_percent)||0,ft=we*Xe,mt=ft*ut/100,pt=ft-mt,vt=((Ae=P.find(je=>String(je.value)===String(xe.tax_type)))==null?void 0:Ae.rate)||0,Ot=pt*vt/100;return{sub:ft,discAmt:mt,net:pt,taxAmt:Ot,total:pt+Ot}},re=()=>{const xe=c.reduce((Xe,ut)=>Xe+(ut.net||0),0),we=c.reduce((Xe,ut)=>Xe+(ut.taxAmt||0),0);return{sub:xe,tax:we,total:xe+we}},de=()=>{const xe=c.reduce((mt,pt)=>mt+(pt.net||0),0),we={};c.forEach(mt=>{(I[String(mt.tax_type)]||[]).forEach(vt=>{const Ot=Number(vt.rate_percent)||0,Ae=(mt.net||0)*Ot/100,je=vt.component_name;we[je]||(we[je]={amount:0,rate:Ot,sort_order:vt.sort_order||0}),we[je].amount+=Ae})});const Xe=Object.keys(we).map(mt=>({name:mt,amount:we[mt].amount,rate:we[mt].rate,sort_order:we[mt].sort_order})).sort((mt,pt)=>mt.sort_order-pt.sort_order),ut=Xe.reduce((mt,pt)=>mt+pt.amount,0),ft=xe+ut;return{sub:xe,components:Xe,taxTotal:ut,total:ft}},Ie=()=>{const xe=c.reduce((pt,vt)=>pt+(vt.sub||0),0),we=c.reduce((pt,vt)=>pt+(vt.discAmt||0),0),Xe=c.reduce((pt,vt)=>pt+(vt.net||0),0),ut=de(),ft=ut.taxTotal,mt=Xe+ft;return{grossSub:xe,discountTotal:we,netSub:Xe,components:ut.components,taxTotal:ft,grand:mt}},le=async()=>{const we=Array.from(new Set(c.map(Xe=>String(Xe.tax_type)).filter(Boolean))).filter(Xe=>!(Xe in I));we.length&&await Promise.all(we.map(Xe=>Ke(Xe)))};x.useEffect(()=>{Z(),ve(),Ue(),Be(),_e(),Me(),Ye(),r?xt():(d(xe=>({...xe,valid_until:oe(xe.quotation_date,xe.valid_days)})),ee.get("/sales/quotations/next-no").then(xe=>{var Xe;const we=(Xe=xe.data)==null?void 0:Xe.nextNo;we&&d(ut=>({...ut,quotation_no:we}))}).catch(()=>{d(xe=>({...xe,quotation_no:xe.quotation_no||"QN000001"}))}))},[s]),x.useEffect(()=>{a!=null&&a.username&&X(a.username)},[a]);const Z=async()=>{var xe;try{const we=await ee.get("/sales/customers");v(Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[])}catch(we){console.error("Error fetching customers:",we)}},ve=async()=>{var xe;try{const we=await ee.get("/inventory/items");y(Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[])}catch(we){console.error("Error fetching items:",we)}},Ue=async()=>{var xe;try{const we=await ee.get("/inventory/warehouses");N(Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[])}catch(we){console.error("Error fetching warehouses:",we)}},Be=async()=>{var xe;try{const we=await ee.get("/finance/currencies"),Xe=Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[];B(Xe);const ut=Xe.find(ft=>String(ft.code||ft.currency_code||"").toUpperCase()==="GHS")||Xe.find(ft=>/ghana|cedi/i.test(String(ft.name||ft.currency_name||"")));ut&&d(ft=>({...ft,currency_id:ut.id}))}catch(we){console.error("Error fetching currencies:",we)}},_e=async()=>{var xe;try{const we=await ee.get("/finance/tax-codes"),ut=(Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[]).map(ft=>({value:ft.id,label:ft.name,rate:Number(ft.rate_percent),code:ft.code}));if(L(ut),ut.length>0&&!A.tax_type){const ft=ut.find(mt=>Number(mt.rate)===20&&/vat/i.test(mt.label))||ut.find(mt=>Number(mt.rate)===20)||ut.find(mt=>/vat/i.test(mt.label))||ut[0];f(mt=>({...mt,tax_type:ft==null?void 0:ft.value,tax_rate:ft==null?void 0:ft.rate}))}}catch(we){console.error("Error fetching tax codes:",we)}};x.useEffect(()=>{!P.length||!c.length||h(xe=>xe.map(we=>({...we,...ce(we)})))},[P]);const Me=async()=>{var xe;try{const we=await ee.get("/sales/price-types");H(Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[])}catch(we){console.error("Error fetching price types:",we)}},Ye=async()=>{var xe,we,Xe,ut,ft;try{const mt=(a==null?void 0:a.username)||"";X(mt);const pt=await ee.get("/admin/me"),vt=(we=(xe=pt.data)==null?void 0:xe.scope)==null?void 0:we.companyId,Ot=((ut=(Xe=pt.data)==null?void 0:Xe.user)==null?void 0:ut.username)||"";if(!mt&&Ot&&X(Ot),vt){const je=((ft=(await ee.get(`/admin/companies/${vt}`)).data)==null?void 0:ft.item)||{};O(We=>({...We,name:je.name||We.name||"",address:je.address||We.address||"",phone:je.telephone||We.phone||"",email:je.email||We.email||"",city:je.city||We.city||"",state:je.state||We.state||"",country:je.country||We.country||"",logoUrl:je.has_logo===1||je.has_logo===!0?`/api/admin/companies/${vt}/logo`:qs}))}else O(Ae=>({...Ae,logoUrl:Ae.logoUrl||qs}))}catch{a!=null&&a.username&&X(a.username),O(mt=>({...mt,logoUrl:mt.logoUrl||qs}))}},ot=xe=>{if(!xe||!U.length)return null;const we=U.find(Xe=>String(Xe.name||"").toUpperCase()===String(xe).toUpperCase());return we?we.id:null},Ke=async xe=>{var Xe;const we=String(xe||"");if(we)try{const ut=await ee.get(`/finance/tax-codes/${xe}/components`),ft=Array.isArray((Xe=ut.data)==null?void 0:Xe.items)?ut.data.items:[];G(mt=>({...mt,[we]:ft}))}catch{}},ct=async(xe,we)=>{var Xe;try{const ut=await ee.get("/sales/prices/standard"),ft=Array.isArray((Xe=ut.data)==null?void 0:Xe.items)?ut.data.items:[],mt=ot(u.price_type),pt=ft.filter(vt=>String(vt.product_id)===String(xe)&&(mt?String(vt.price_type_id)===String(mt):!0)).sort((vt,Ot)=>{const Ae=vt.effective_date?new Date(vt.effective_date).getTime():0;return(Ot.effective_date?new Date(Ot.effective_date).getTime():0)-Ae||new Date(Ot.created_at).getTime()-new Date(vt.created_at).getTime()});return pt.length>0?Number(pt[0].selling_price)||we||0:we||0}catch(ut){return console.error("Error fetching standard price:",ut),we||0}},xt=async()=>{var xe,we,Xe,ut;try{i(!0);const ft=await ee.get(`/sales/quotations/${s}`),mt=(xe=ft.data)==null?void 0:xe.item;if(mt){if(d({quotation_no:mt.quotation_no||"",quotation_date:mt.quotation_date||new Date().toISOString().split("T")[0],customer_id:mt.customer_id||"",valid_days:mt.valid_days||30,valid_until:mt.valid_until||"",status:mt.status||"DRAFT",terms_and_conditions:mt.terms_and_conditions||"",remarks:mt.remarks||"",warehouse_id:mt.warehouse_id||"",price_type:mt.price_type||"RETAIL",payment_type:mt.payment_type||"CASH",currency_id:mt.currency_id||4,exchange_rate:mt.exchange_rate||1}),mt.customer_id){const pt=g.find(vt=>String(vt.id)===String(mt.customer_id));pt&&(V(mt.customer_name||pt.customer_name||""),J(mt.customer_address||pt.address||""),k(mt.customer_city||pt.city||""),Q(mt.customer_state||pt.state||""),E(mt.customer_country||pt.country||""))}if((we=ft.data)!=null&&we.details){const pt=ft.data.details.map((vt,Ot)=>{var je;const Ae=ce({qty:vt.qty,unit_price:vt.unit_price,discount_percent:vt.discount_percent,tax_type:vt.tax_type||((je=P==null?void 0:P[0])==null?void 0:je.value)||""});return{...vt,line_id:Ot+1,...Ae}});h(pt)}}}catch(ft){o(((ut=(Xe=ft==null?void 0:ft.response)==null?void 0:Xe.data)==null?void 0:ut.message)||"Error fetching quotation"),console.error("Error fetching quotation:",ft)}finally{i(!1)}},be=async()=>{var we;if(u.customer_id)return Number(u.customer_id);const xe=q.trim();if(!xe)throw new Error("Please enter a customer name");z(!0);try{const Xe=ot(u.price_type),ft=(we=(await ee.post("/sales/customers",{customer_name:xe,price_type_id:Xe,address:Y||null,city:T||null,state:D||null,country:C||null})).data)==null?void 0:we.id;if(!ft)throw new Error("Failed to create customer");return d(mt=>({...mt,customer_id:ft})),Number(ft)}finally{z(!1)}},Ce=xe=>{const{name:we,value:Xe}=xe.target;if(we==="quotation_date"||we==="valid_days"){const ut=we==="quotation_date"?Xe:u.quotation_date,ft=we==="valid_days"?Xe:u.valid_days;d(mt=>({...mt,[we]:Xe,valid_until:oe(ut,ft)}))}else d(ut=>({...ut,[we]:Xe}))},Te=xe=>{var ut;const{name:we,value:Xe}=xe.target;if(we==="item_id"){const ft=b.find(pt=>pt.id===parseInt(Xe)),mt=(ft==null?void 0:ft.selling_price)||0;f(pt=>({...pt,item_id:Xe,item_name:(ft==null?void 0:ft.item_name)||"",unit_price:mt,qty:1})),ct(Xe,mt).then(pt=>f(vt=>({...vt,unit_price:pt}))),Xe&&ee.get(`/finance/item-tax/${Xe}`).then(pt=>{var Ot,Ae,je;const vt=(Ot=pt.data)==null?void 0:Ot.tax;if(vt){const We=vt.id||((Ae=P.find(lt=>lt.code===vt.tax_code))==null?void 0:Ae.value)||null,De=We?(je=P.find(lt=>String(lt.value)===String(We)))==null?void 0:je.rate:null;f(lt=>({...lt,tax_type:We??lt.tax_type,tax_rate:De??vt.tax_rate}))}else f(We=>({...We,tax_rate:void 0}))}).catch(()=>{f(pt=>({...pt,tax_rate:void 0}))})}else{if(we==="tax_type"){const ft=((ut=P.find(mt=>String(mt.value)===String(Xe)))==null?void 0:ut.rate)||0;f(mt=>({...mt,[we]:Xe,tax_rate:ft}));return}f(ft=>({...ft,[we]:Xe}))}},ue=()=>{var we,Xe;if(!A.item_id||!A.qty||!A.unit_price){alert("Please fill all required item fields");return}const xe=ce(A);h([...c,{...A,line_id:Date.now(),...xe}]),f({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:((we=P.find(ut=>Number(ut.rate)===20&&/vat/i.test(ut.label))||P.find(ut=>Number(ut.rate)===20)||P.find(ut=>/vat/i.test(ut.label))||P[0])==null?void 0:we.value)||"",tax_rate:((Xe=P.find(ut=>Number(ut.rate)===20&&/vat/i.test(ut.label))||P.find(ut=>Number(ut.rate)===20)||P.find(ut=>/vat/i.test(ut.label))||P[0])==null?void 0:Xe.rate)||void 0,remarks:""})},ge=xe=>{h(c.filter(we=>we.line_id!==xe))},Ve=()=>{le().finally(()=>window.print())},tt=async()=>{await le();const xe=ne.current;if(!xe)return;const we=xe.style.cssText;xe.style.cssText=we+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const Xe=await Ai(xe,{scale:2,useCORS:!0}),ut=Xe.toDataURL("image/png"),ft=new ds("p","mm","a4"),mt=ft.internal.pageSize.getWidth(),pt=ft.internal.pageSize.getHeight(),vt=mt,Ot=Xe.height*vt/Xe.width;let Ae=0;for(;Ae<Ot;)ft.addImage(ut,"PNG",0,-Ae,vt,Ot),Ae+=pt,Ae<Ot&&ft.addPage();const je="Quotation_"+(u.quotation_no||new Date().toISOString().slice(0,10))+".pdf";ft.save(je)}finally{xe.style.cssText=we}},Ze=xe=>{if(xe==null)return null;if(typeof xe!="object")return xe;if(Array.isArray(xe))return xe.map(Xe=>Xe===void 0?null:Ze(Xe));const we={};return Object.keys(xe).forEach(Xe=>{const ut=xe[Xe];we[Xe]=ut===void 0?null:Ze(ut)}),we},ht=async xe=>{var ut,ft,mt;if(xe.preventDefault(),!u.customer_id&&!q.trim()||c.length===0){alert("Please enter customer name and add at least one item");return}i(!0);const we=Ie();let Xe=u.quotation_no;if(!Xe)try{Xe=((ut=(await ee.get("/sales/quotations/next-no")).data)==null?void 0:ut.nextNo)||"QN000001"}catch{Xe="QN000001"}try{const pt=await be();if(!pt){alert("Failed to get customer ID. Please try again."),i(!1);return}const vt=c.filter(je=>je.item_id&&Number(je.item_id)>0).map(je=>{const We=ce(je),De=je.tax_type!==null&&je.tax_type!==void 0&&je.tax_type!==""?Number(je.tax_type):null,lt=De!==null?P.find(rt=>String(rt.value)===String(De)):null;return{item_id:Number(je.item_id),qty:Number(je.qty)||0,quantity:Number(je.qty)||0,unit_price:Number(je.unit_price)||0,discount_percent:Number(je.discount_percent)||0,tax_type:De,tax_id:De,tax_rate:lt&&Number(lt.rate)||0,tax_amount:Number(We.taxAmt)||0,line_total:Number(We.total)||0,total_amount:Number(We.total)||0,net_amount:Number(We.net)||0}}),Ot={quotation_no:Xe?String(Xe):null,quotation_date:u.quotation_date?String(u.quotation_date):null,customer_id:pt?Number(pt):null,valid_until:u.valid_until?String(u.valid_until):null,status:u.status?String(u.status):"DRAFT",terms_and_conditions:u.terms_and_conditions&&u.terms_and_conditions.trim()?String(u.terms_and_conditions):null,remarks:u.remarks&&u.remarks.trim()?String(u.remarks):null,warehouse_id:u.warehouse_id?Number(u.warehouse_id):null,price_type:u.price_type?String(u.price_type):null,payment_type:u.payment_type?String(u.payment_type):null,customer_name:q?String(q):null,customer_address:Y?String(Y):null,customer_city:T?String(T):null,customer_state:D?String(D):null,customer_country:C?String(C):null,total_amount:we.grand?Number(we.grand):0,items:vt},Ae=Ze(Ot);if(!Ae.customer_id||isNaN(Ae.customer_id)){alert("Invalid customer ID. Please try again."),i(!1);return}Ae.quotation_no=Ae.quotation_no||null,Ae.quotation_date=Ae.quotation_date||null,Ae.valid_until=Ae.valid_until||null,Ae.status=Ae.status||"DRAFT",Ae.remarks=Ae.remarks||null,Ae.terms_and_conditions=Ae.terms_and_conditions||null,Ae.warehouse_id=Ae.warehouse_id||null,Ae.price_type=Ae.price_type||null,Ae.payment_type=Ae.payment_type||null,Ae.customer_name=Ae.customer_name||null,Ae.customer_address=Ae.customer_address||null,Ae.customer_city=Ae.customer_city||null,Ae.customer_state=Ae.customer_state||null,Ae.customer_country=Ae.customer_country||null,Ae.total_amount=Ae.total_amount||0,Ae.items&&Array.isArray(Ae.items)&&(Ae.items=Ae.items.map(je=>({item_id:Number(je.item_id)||null,qty:Number(je.qty)||0,quantity:Number(je.qty)||0,unit_price:Number(je.unit_price)||0,tax_id:je.tax_id!==null&&je.tax_id!==void 0?Number(je.tax_id):null,tax_type:je.tax_type!==null&&je.tax_type!==void 0?Number(je.tax_type):null,tax_rate:Number(je.tax_rate)||0,tax_amount:Number(je.tax_amount)||0,line_total:Number(je.line_total)||0,total_amount:Number(je.total_amount)||0}))),r?await ee.put(`/sales/quotations/${s}`,Ae):await ee.post("/sales/quotations",Ae),console.log("Submitting:",Ot),alert(r?"Quotation updated successfully!":"Quotation created successfully!"),t("/sales/quotations")}catch(pt){console.error("Error saving quotation:",pt);const vt=((mt=(ft=pt.response)==null?void 0:ft.data)==null?void 0:mt.message)||pt.message||"Unknown error";alert(`Error saving quotation: ${vt}`)}finally{i(!1)}};return e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden my-6 print:shadow-none print:my-0 print:w-full print:max-w-none",children:[e.jsx("style",{children:`
        @media print {
          @page { margin: 1cm; }
          body { 
            background: white; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          #root > div > header,
          #root > div > div > aside { display: none !important; }
          .print\\:hidden { display: none !important; }
          .print\\:block { display: block !important; }
          #root > div > div > main { padding: 0 !important; }
          input, select, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            resize: none;
            overflow: visible;
          }
        }
        .quotation-table { 
          border-collapse: collapse; 
          table-layout: fixed; 
          width: 100%; 
          max-width: 100%; 
          border-spacing: 0; 
          box-sizing: border-box;
          margin: 0;
        }
        .quotation-table th, .quotation-table td { 
          border: 1px solid #000000; 
          box-sizing: border-box; 
          word-break: break-word; 
          overflow-wrap: anywhere; 
          white-space: normal; 
          padding: 6px 4px;
          font-size: 10px;
        }
        .quotation-table td {
          overflow: visible;
        }
        .quotation-table thead th { 
          background: #0E3646; 
          color: #ffffff; 
        }
        .quotation-table thead th:last-child,
        .quotation-table tbody td:last-child {
          background: #ffffff;
          color: #000000;
        }
        .quotation-table thead th:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        .quotation-table tbody td:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        @media print {
          .quotation-table {
            width: 100%;
            max-width: 100%;
          }
          .quotation-table thead th:last-child,
          .quotation-table tbody td:last-child {
            background: #ffffff !important;
            color: #000000 !important;
          }
          .quotation-table thead th:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
          .quotation-table tbody td:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
        }
      `}),e.jsx("div",{className:"p-6 border-b text-white print:hidden",style:{backgroundColor:"#0E3646"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:[r?"Edit":"New"," Quotation"]}),e.jsx("p",{className:"text-sm opacity-80",children:r?"Update quotation details":"Create a new sales quotation"})]}),e.jsxs("div",{className:"flex gap-4 print:hidden items-center",children:[e.jsxs("button",{onClick:tt,className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-lg transition-colors text-sm font-medium border border-white/20",title:"Save as PDF",children:[e.jsx(Yc,{className:"w-4 h-4"}),"Download PDF"]}),e.jsx("button",{onClick:Ve,className:"text-white hover:text-gray-200",title:"Print",children:e.jsx(qh,{className:"w-6 h-6"})}),e.jsx(Le,{to:"/sales/quotations",className:"text-white hover:text-gray-200",children:e.jsx(Uf,{className:"w-6 h-6"})})]})]})}),e.jsx("div",{className:"p-6 print:hidden",children:e.jsxs("form",{onSubmit:ht,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quotation #"}),e.jsx("input",{type:"text",name:"quotation_no",value:u.quotation_no,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Auto-generated",readOnly:!r&&!u.quotation_no})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"quotation_date",value:u.quotation_date,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),e.jsx("input",{type:"text",value:q,onChange:xe=>V(xe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Type customer name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("input",{type:"text",value:Y,onChange:xe=>J(xe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:T,onChange:xe=>k(xe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter city"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:D,onChange:xe=>Q(xe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter state"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:C,onChange:xe=>E(xe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Enter country"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:u.warehouse_id,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),j.map(xe=>e.jsx("option",{value:xe.id,children:xe.warehouse_name},xe.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valid Days *"}),e.jsx("input",{type:"number",name:"valid_days",value:u.valid_days,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),e.jsx("input",{type:"date",value:u.valid_until,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{name:"status",value:u.status,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:te.map(xe=>e.jsx("option",{value:xe.value,children:xe.label},xe.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Type"}),e.jsxs("select",{name:"price_type",value:u.price_type,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"RETAIL",children:"Retail"}),e.jsx("option",{value:"WHOLESALE",children:"Wholesale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),e.jsxs("select",{name:"payment_type",value:u.payment_type,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"}),e.jsx("option",{value:"CREDIT",children:"Credit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),e.jsx("select",{name:"currency_id",value:u.currency_id,onChange:Ce,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:S.map(xe=>e.jsxs("option",{value:xe.id,children:[xe.code||xe.currency_code," - ",xe.name||xe.currency_name]},xe.id))})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terms & Conditions"}),e.jsx("textarea",{name:"terms_and_conditions",value:u.terms_and_conditions,onChange:Ce,rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646] print:hidden",placeholder:"Enter terms and conditions..."}),e.jsx("div",{className:"hidden print:block whitespace-pre-wrap text-sm text-gray-800 border-none p-0",children:u.terms_and_conditions||"None"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{name:"remarks",value:u.remarks,onChange:Ce,rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646] print:hidden",placeholder:"Enter remarks..."}),e.jsx("div",{className:"hidden print:block whitespace-pre-wrap text-sm text-gray-800 border-none p-0",children:u.remarks||"None"})]})]}),e.jsxs("div",{className:"border-t pt-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Quotation Items"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200 print:hidden",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 mb-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Item *"}),e.jsxs("select",{name:"item_id",value:A.item_id,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Item"}),b.map(xe=>e.jsxs("option",{value:xe.id,children:[xe.item_code," - ",xe.item_name]},xe.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),e.jsx("input",{type:"number",name:"qty",value:A.qty,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",name:"unit_price",value:A.unit_price,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Disc %"}),e.jsx("input",{type:"number",name:"discount_percent",value:A.discount_percent,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"0",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),e.jsx("select",{name:"tax_type",value:A.tax_type,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:P.map(xe=>e.jsx("option",{value:xe.value,children:xe.label},xe.value))}),A.tax_rate!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Tax rate: ",Number(A.tax_rate).toFixed(2),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:ue,className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#0E3646"},children:[e.jsx(xu,{className:"w-4 h-4"}),"Add Item"]})})]}),c.length>0&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Disc%"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider print:hidden",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:c.map(xe=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900",children:xe.item_name}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:xe.qty}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(xe.unit_price).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(xe.discount_percent||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:xe.net.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:xe.taxAmt.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:xe.total.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 print:hidden",children:e.jsx("button",{type:"button",onClick:()=>ge(xe.line_id),className:"text-red-600 hover:text-red-900 transition-colors",children:e.jsx(Hl,{className:"w-4 h-4"})})})]},xe.line_id))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"4",className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Totals:"}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:re().sub.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:re().tax.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:re().total.toFixed(2)}),e.jsx("td",{className:"print:hidden"})]})})]})}),c.length===0&&e.jsx("div",{className:"text-center py-10 text-gray-500 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:e.jsx("p",{children:"No items added yet. Use the form above to add items to this quotation."})})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6 pt-6 border-t border-gray-200 print:hidden",children:[e.jsx(Le,{to:"/sales/quotations",className:"px-6 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2 text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#0E3646"},disabled:n,children:[e.jsx(Vh,{className:"w-5 h-5"}),n?"Saving...":r?"Update Quotation":"Create Quotation"]})]})]})}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:w.logoUrl||qs,alt:w.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:w.name||"Company"}),w.address&&e.jsx("div",{children:w.address}),(w.city||w.state||w.country)&&e.jsx("div",{children:[w.city,w.state,w.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[w.phone&&e.jsx("span",{children:w.phone}),w.email&&e.jsx("span",{children:w.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Quotation"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",u.quotation_date||""]}),e.jsxs("div",{children:["Quotation #: ",u.quotation_no||""]}),e.jsxs("div",{children:["Customer:"," ",q||u.potential_cust_name||""]}),e.jsxs("div",{children:["Valid until: ",u.valid_until||""]}),e.jsxs("div",{children:["Prepared by: ",R||""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Customer Name"}),e.jsx("div",{className:"flex-1",children:q||((ze=g.find(xe=>String(xe.id)===String(u.customer_id)))==null?void 0:ze.customer_name)||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Address"}),e.jsx("div",{className:"flex-1",children:Y||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"City"}),e.jsx("div",{className:"flex-1",children:T||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"State"}),e.jsx("div",{className:"flex-1",children:D||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Country"}),e.jsx("div",{className:"flex-1",children:C||""})]})]}),e.jsx("div",{className:"text-right"})]}),e.jsx("div",{className:"mb-2",children:e.jsxs("table",{className:"quotation-table text-sm",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:c.map((xe,we)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:xe.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(xe.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(xe.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(xe.total||0).toFixed(2)})]},xe.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().netSub.toFixed(2)}),Ie().components.map(xe=>e.jsxs(Ts.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[xe.name," [",xe.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:xe.amount.toFixed(2)})]},xe.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().grand.toFixed(2)})]})})})]}),e.jsxs("div",{className:"mt-6 text-sm",children:[e.jsx("div",{children:"Terms and conditions :"}),e.jsx("div",{className:"mt-1",children:u.terms_and_conditions||"None"})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]}),e.jsxs("div",{ref:ne,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:w.logoUrl||qs,alt:w.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:w.name||"Company"}),w.address&&e.jsx("div",{children:w.address}),(w.city||w.state||w.country)&&e.jsx("div",{children:[w.city,w.state,w.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[w.phone&&e.jsx("span",{children:w.phone}),w.email&&e.jsx("span",{children:w.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Quotation"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",u.quotation_date||""]}),e.jsxs("div",{children:["Quotation #: ",u.quotation_no||""]}),e.jsxs("div",{children:["Customer: ",q||""]}),e.jsxs("div",{children:["Valid until: ",u.valid_until||""]}),e.jsxs("div",{children:["Prepared by: ",R||""]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Customer Name"}),e.jsx("div",{className:"flex-1",children:q||((Fe=g.find(xe=>String(xe.id)===String(u.customer_id)))==null?void 0:Fe.customer_name)||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Address"}),e.jsx("div",{className:"flex-1",children:Y||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"City"}),e.jsx("div",{className:"flex-1",children:T||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"State"}),e.jsx("div",{className:"flex-1",children:D||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-32",children:"Country"}),e.jsx("div",{className:"flex-1",children:C||""})]})]}),e.jsx("div",{className:"text-right"})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible"},children:e.jsxs("table",{className:"quotation-table text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:c.map(xe=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:xe.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(xe.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(xe.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(xe.total||0).toFixed(2)})]},xe.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ie().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().netSub.toFixed(2)}),Ie().components.map(xe=>e.jsxs(Ts.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[xe.name," [",xe.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:xe.amount.toFixed(2)})]},xe.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ie().grand.toFixed(2)})]})})})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]})]})}function XO(){const t=ys(),[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(""),[o,u]=x.useState(""),[d,c]=x.useState("ALL"),[h,A]=x.useState(!1),[f,g]=x.useState(!1),[v,b]=x.useState(""),[y,j]=x.useState(null),[N,S]=x.useState([]),[B,P]=x.useState(null),[L,U]=x.useState(null),[H,q]=x.useState(null),[V,M]=x.useState(!1),[z,I]=x.useState(null),[G,Y]=x.useState({name:"",address:"",city:"",state:"",country:"",postalCode:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[J,T]=x.useState("");x.useEffect(()=>{let re=!0;async function de(){var Ie,le,Z,ve;try{const Ue=await ee.get("/admin/me"),Be=(le=(Ie=Ue.data)==null?void 0:Ie.scope)==null?void 0:le.companyId,_e=((Z=Ue.data)==null?void 0:Z.user)||{},Me=String(_e.username||"").trim(),Ye=String(_e.full_name||"").trim(),ot=String(_e.name||"").trim(),Ke=String(_e.email||"").trim();if(re&&T(Me||Ye||ot||Ke||""),!Be)return;const be=((ve=(await ee.get(`/admin/companies/${Be}`)).data)==null?void 0:ve.item)||{},Ce=be.has_logo===1||be.has_logo===!0?`/api/admin/companies/${Be}/logo`:"";if(!re)return;Y({name:String(be.name||""),address:String(be.address||""),city:String(be.city||""),state:String(be.state||""),country:String(be.country||""),postalCode:String(be.postal_code||""),phone:String(be.telephone||""),email:String(be.email||""),website:String(be.website||""),taxId:String(be.tax_id||""),registrationNo:String(be.registration_no||""),logoUrl:String(Ce||"")})}catch{}}return de(),()=>{re=!1}},[]);function k(re){return String(re??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function D(re){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sales Order</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${re||""}</body>
</html>`}async function Q(re){var Ie;const de=Array.from(((Ie=re==null?void 0:re.querySelectorAll)==null?void 0:Ie.call(re,"img"))||[]);de.length&&await Promise.all(de.map(le=>new Promise(Z=>{if(le.complete)return Z();const ve=()=>Z();le.addEventListener("load",ve,{once:!0}),le.addEventListener("error",ve,{once:!0})})))}const C=(re,de)=>{const Ie=String(G.logoUrl||"").trim(),le=Ie?`<img src="${Ie}" alt="${k(G.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",Z=(Array.isArray(de)?de:[]).map((ot,Ke)=>{const ct=Number(ot.qty??ot.quantity??0),xt=Number(ot.unit_price??0),be=Number(ot.discount_percent??0),Ce=Number(ot.tax_amount??0),Te=Number(ot.total_amount??ct*xt-ct*xt*be/100+Ce);return{sr:String(Ke+1),code:String(ot.item_code||""),name:String(ot.item_name||""),quantity:ct.toFixed(2),uom:String(ot.uom||ot.uom_code||""),price:xt.toFixed(2),discount:be.toFixed(2),tax:Ce.toFixed(2),amount:Te.toFixed(2)}}),ve=Z.reduce((ot,Ke)=>ot+Number(Ke.price)*Number(Ke.quantity),0),Ue=Z.reduce((ot,Ke)=>ot+Number(Ke.price)*Number(Ke.quantity)*Number(Ke.discount)/100,0),Be=Z.reduce((ot,Ke)=>ot+Number(Ke.tax||0),0),_e=ve-Ue,Me=re.net_amount??re.total_amount??_e+Be,Ye=Number(Me??0);return{company:{name:G.name||"",address:G.address||"",city:G.city||"",state:G.state||"",country:G.country||"",postalCode:G.postalCode||"",phone:G.phone||"",email:G.email||"",website:G.website||"",taxId:G.taxId||"",registrationNo:G.registrationNo||"",logoUrl:Ie,logoHtml:le},sales_order:{number:String(re.order_no||""),date:re.order_date?String(re.order_date).slice(0,10):"",payment_type:String(re.payment_type||""),price_type:String(re.price_type||"")},customer:{name:String(re.customer_name||""),address:String(re.address||""),city:String(re.city||""),state:String(re.state||""),country:String(re.country||""),phone:String(re.phone||""),email:String(re.email||"")},items:Z,totals:{sub_total:ve.toFixed(2),discount:Ue.toFixed(2),tax_amount:Be.toFixed(2),total:Number(Ye||0).toFixed(2)},prepared_by:J||""}};function E(re){const de=re.company||{},Ie=re.sales_order||{},le=re.customer||{},Z=Array.isArray(re.items)?re.items:[],ve=re.totals||{};return`
      <style>
        .doc { color: #0f172a; font-size: 12px; }
        .doc-header { display: flex; justify-content: space-between; align-items: center; }
        .doc-title { font-weight: 800; font-size: 18px; color: #296d8f; }
        .company-block { display: flex; gap: 12px; align-items: center; }
        .company-logo { max-height: 80px; object-fit: contain; }
        .company-info div { line-height: 1.4; }
        .meta { text-align: right; font-size: 12px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        table { border-collapse: collapse; width: 100%; font-size: 12px; }
        th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
        th { background: #f8fafc; text-align: left; }
        .totals { display: flex; justify-content: flex-end; margin-top: 12px; }
        .totals table { width: 360px; }
      </style>
      <div class="doc">
        <div class="doc-header">
          <div class="company-block">
            ${de.logoUrl?`<img src="${de.logoUrl}" alt="${k(de.name||"Company")}" class="company-logo" />`:""}
            <div class="company-info">
              <div>${k(de.name||"")}</div>
              <div>${k(de.address||"")}</div>
              <div>${k(de.city||"")}${de.city?",":""} ${k(de.state||"")} ${k(de.country||"")}</div>
              <div>${k(de.phone||"")} ${k(de.email||"")}</div>
              <div>${k(de.website||"")}</div>
              <div>${de.taxId?`Tax ID: ${k(de.taxId)}`:""}</div>
              <div>${de.registrationNo?`Reg No: ${k(de.registrationNo)}`:""}</div>
            </div>
          </div>
          <div class="meta">
            <div class="doc-title">Sales Order</div>
            <div>Order No: ${k(Ie.number||"")}</div>
            <div>Order Date: ${k(Ie.date||"")}</div>
          </div>
        </div>
        <div class="grid-2" style="margin-top: 6px;">
          <div>
            <div style="font-weight:700;margin-bottom:4px;">Customer</div>
            <div>${k(le.name||"")}</div>
            <div>${k(le.address||"")}</div>
            <div>${k(le.city||"")}${le.city?",":""} ${k(le.state||"")} ${k(le.country||"")}</div>
            <div>${k(le.phone||"")} ${k(le.email||"")}</div>
          </div>
          <div>
            <div style="font-weight:700;margin-bottom:4px;">Payment</div>
            <div>Payment Type: ${k(Ie.payment_type||"")}</div>
            <div>Price Type: ${k(Ie.price_type||"")}</div>
          </div>
        </div>
        <table style="margin-top: 8px;">
          <thead>
            <tr>
              <th>#</th>
              <th>Code</th>
              <th>Description</th>
              <th style="text-align:right;">Qty</th>
              <th>UOM</th>
              <th style="text-align:right;">Unit Price</th>
              <th style="text-align:right;">Disc%</th>
              <th style="text-align:right;">Tax</th>
              <th style="text-align:right;">Amount</th>
            </tr>
          </thead>
          <tbody>
            ${Z.map(Ue=>`
                <tr>
                  <td>${k(Ue.sr||"")}</td>
                  <td>${k(Ue.code||"")}</td>
                  <td>${k(Ue.name||"")}</td>
                  <td style="text-align:right;">${k(Ue.quantity||"")}</td>
                  <td>${k(Ue.uom||"")}</td>
                  <td style="text-align:right;">${k(Ue.price||"")}</td>
                  <td style="text-align:right;">${k(Ue.discount||"")}</td>
                  <td style="text-align:right;">${k(Ue.tax||"")}</td>
                  <td style="text-align:right;">${k(Ue.amount||"")}</td>
                </tr>
              `).join("")}
          </tbody>
        </table>
        <div class="totals">
          <table>
            <tbody>
              <tr><td>Sub Total</td><td style="text-align:right;">${k(ve.sub_total||"")}</td></tr>
              <tr><td>Discount</td><td style="text-align:right;">${k(ve.discount||"")}</td></tr>
              <tr><td>Tax</td><td style="text-align:right;">${k(ve.tax_amount||"")}</td></tr>
              <tr><td><strong>Total</strong></td><td style="text-align:right;"><strong>${k(ve.total||"")}</strong></td></tr>
            </tbody>
          </table>
        </div>
        <div style="margin-top:10px;font-size:12px;">
          <div>Prepared By: ${k(String(re.prepared_by||""))}</div>
        </div>
      </div>
    `}async function w(re){var de,Ie,le;try{const Z=await ee.get(`/sales/orders/${re}`),ve=((de=Z.data)==null?void 0:de.item)||{},Ue=Array.isArray((Ie=Z.data)==null?void 0:Ie.details)?Z.data.details:[],Be=C(ve,Ue),_e=D(E(Be)),Me=document.createElement("iframe");Me.style.position="fixed",Me.style.right="0",Me.style.bottom="0",Me.style.width="0",Me.style.height="0",Me.style.border="0",document.body.appendChild(Me);const Ye=((le=Me.contentWindow)==null?void 0:le.document)||Me.contentDocument||null;if(!Ye){document.body.removeChild(Me);return}Ye.open(),Ye.write(_e),Ye.close();const ot=Me.contentWindow||window;setTimeout(()=>{ot.focus();try{ot.print()}catch{}setTimeout(()=>{document.body.removeChild(Me)},100)},200)}catch{}}async function O(re){var de,Ie;try{const le=await ee.get(`/sales/orders/${re}`),Z=((de=le.data)==null?void 0:de.item)||{},ve=Array.isArray((Ie=le.data)==null?void 0:Ie.details)?le.data.details:[],Ue=C(Z,ve),Be=E(Ue),_e=document.createElement("div");_e.style.position="fixed",_e.style.left="-10000px",_e.style.top="0",_e.style.width="794px",_e.style.background="white",_e.style.padding="32px",_e.innerHTML=Be,document.body.appendChild(_e);try{await Q(_e);const Me=await Ai(_e,{scale:2,useCORS:!0}),Ye=Me.toDataURL("image/png"),ot=new ds("p","mm","a4"),Ke=ot.internal.pageSize.getWidth(),ct=ot.internal.pageSize.getHeight(),xt=Ke,be=Me.height*xt/Me.width;let Ce=0;for(;Ce<be;)ot.addImage(Ye,"PNG",0,-Ce,xt,be),Ce+=ct,Ce<be&&ot.addPage();const Te="SalesOrder_"+(String(Z.order_no||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";ot.save(Te)}finally{document.body.removeChild(_e)}}catch{}}x.useEffect(()=>{R()},[]);const R=async()=>{var re,de,Ie;try{n(!0),l("");const le=await ee.get("/sales/orders");r(Array.isArray((re=le.data)==null?void 0:re.items)?le.data.items:[])}catch(le){l(((Ie=(de=le==null?void 0:le.response)==null?void 0:de.data)==null?void 0:Ie.message)||"Error fetching orders"),console.error("Error fetching orders:",le)}finally{n(!1)}},X=s.filter(re=>{const de=String(re.order_no||"").toLowerCase().includes(o.toLowerCase())||String(re.customer_name||"").toLowerCase().includes(o.toLowerCase()),Ie=d==="ALL"||re.status===d;return de&&Ie}),ne=async re=>{var de,Ie,le;if(I(re),A(!0),b(""),L)await oe();else try{g(!0);const Z=await ee.get("/workflows"),ve=Array.isArray((de=Z.data)==null?void 0:de.items)?Z.data.items:[];U(ve),await te(ve)}catch(Z){b(((le=(Ie=Z==null?void 0:Z.response)==null?void 0:Ie.data)==null?void 0:le.message)||"Failed to load workflows")}finally{g(!1)}},te=async re=>{var Z,ve,Ue;if(!re||!re.length){j(null),P(null),b("");return}const de="/sales/sales-orders",Ie=Be=>String(Be||"").trim().toUpperCase().replace(/\s+/g,"_"),le=re.find(Be=>Number(Be.is_active)===1&&String(Be.document_route)===de)||re.find(Be=>Number(Be.is_active)===1&&Ie(Be.document_type)==="SALES_ORDER")||null;if(j(le||null),P(null),!!le)try{g(!0);const _e=(Z=(await ee.get(`/workflows/${le.id}`)).data)==null?void 0:Z.item,Me=Array.isArray(_e==null?void 0:_e.steps)?_e.steps:[];S(Me);const Ye=Me[0]||null;if(P(Ye?{userId:Ye.approver_user_id,name:Ye.approver_name,stepName:Ye.step_name,stepOrder:Ye.step_order,approvalLimit:Ye.approval_limit}:null),Ye){const ot=(Array.isArray(Ye.approvers)&&Ye.approvers.length?Ye.approvers[0].id:Ye.approver_user_id)||null;q(ot)}else q(null)}catch(Be){b(((Ue=(ve=Be==null?void 0:Be.response)==null?void 0:ve.data)==null?void 0:Ue.message)||"Failed to load workflow details")}finally{g(!1)}},oe=async()=>{var le,Z,ve;if(!L||!L.length){j(null),P(null),b("");return}const re="/sales/sales-orders",de=Ue=>String(Ue||"").trim().toUpperCase().replace(/\s+/g,"_"),Ie=L.find(Ue=>Number(Ue.is_active)===1&&String(Ue.document_route)===re)||L.find(Ue=>Number(Ue.is_active)===1&&de(Ue.document_type)==="SALES_ORDER")||null;if(j(Ie||null),P(null),!!Ie)try{g(!0);const Be=(le=(await ee.get(`/workflows/${Ie.id}`)).data)==null?void 0:le.item,_e=Array.isArray(Be==null?void 0:Be.steps)?Be.steps:[];S(_e);const Me=_e[0]||null;if(P(Me?{userId:Me.approver_user_id,name:Me.approver_name,stepName:Me.step_name,stepOrder:Me.step_order,approvalLimit:Me.approval_limit}:null),Me){const Ye=(Array.isArray(Me.approvers)&&Me.approvers.length?Me.approvers[0].id:Me.approver_user_id)||null;q(Ye)}else q(null)}catch(Ue){b(((ve=(Z=Ue==null?void 0:Ue.response)==null?void 0:Z.data)==null?void 0:ve.message)||"Failed to load workflow details")}finally{g(!1)}};async function ce(){var re,de,Ie;if(z){M(!0),b("");try{const le=z.total_amount===void 0||z.total_amount===null?null:Number(z.total_amount||0),Z=await ee.post(`/sales/orders/${z.id}/submit`,{amount:le,workflow_id:y?y.id:null,target_user_id:H||null}),ve=((re=Z==null?void 0:Z.data)==null?void 0:re.status)||"PENDING_APPROVAL";r(Ue=>Ue.map(Be=>Be.id===z.id?{...Be,status:ve}:Be)),A(!1),I(null)}catch(le){b(((Ie=(de=le==null?void 0:le.response)==null?void 0:de.data)==null?void 0:Ie.message)||"Failed to forward for approval")}finally{M(!1)}}}return a?e.jsx("div",{className:"text-center py-8",children:"Loading orders..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customer orders and track fulfillment"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/sales/sales-orders/new",className:"btn-success",children:"+ New Sales Order"})]})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by order number or customer...",className:"input",value:o,onChange:re=>u(re.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:d,onChange:re=>c(re.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"CONFIRMED",children:"Confirmed"}),e.jsx("option",{value:"PROCESSING",children:"Processing"}),e.jsx("option",{value:"SHIPPED",children:"Shipped"}),e.jsx("option",{value:"DELIVERED",children:"Delivered"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading sales orders..."})]}):X.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No sales orders found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Order No"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:X.map(re=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:re.order_no}),e.jsx("td",{children:new Date(re.order_date).toLocaleDateString()}),e.jsx("td",{children:re.customer_name}),e.jsx("td",{children:re.priority||"-"}),e.jsx("td",{className:"font-semibold",children:re.total_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/sales/sales-orders/${re.id}?mode=view`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),String(re.status||"").toUpperCase()!=="CONFIRMED"&&e.jsx("button",{onClick:()=>t(`/sales/sales-orders/${re.id}?mode=edit`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"}),re.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):re.status==="DRAFT"?e.jsx("button",{type:"button",className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",onClick:()=>ne(re),disabled:V,children:"Forward for Approval"}):null,e.jsx("button",{onClick:()=>w(re.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",children:"Print"}),e.jsx("button",{onClick:()=>O(re.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",children:"PDF"})]})})]},re.id))})]})})]})}),h?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{A(!1),I(null),j(null),P(null),q(null),S([]),b("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:(z==null?void 0:z.order_no)||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:y?`${y.workflow_name} (${y.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:f?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:v?e.jsx("div",{className:"text-sm text-red-600",children:v}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const de=Array.isArray(N)&&N.length>0?N[0]:null,Ie=de?Array.isArray(de.approvers)&&de.approvers.length?de.approvers.map(le=>({id:le.id,name:le.username})):de.approver_user_id?[{id:de.approver_user_id,name:de.approver_name||String(de.approver_user_id)}]:[]:[];return Ie.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:H||"",onChange:le=>q(le.target.value?Number(le.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Ie.map(le=>e.jsx("option",{value:le.id,children:le.name},le.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:B?`Step ${B.stepOrder}  ${B.stepName}${B.approvalLimit!=null?`  Limit: ${Number(B.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:y?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{A(!1),I(null),j(null),P(null),q(null),S([]),b("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:ce,disabled:V||!z||Array.isArray(N)&&N.length>0&&y&&!H,children:V?"Forwarding...":"Forward"})]})]})}):null]})}const el=(t=0)=>{const s=Ky(),r=Vc(l=>l.inventoryRef.uoms),a=Vc(l=>l.inventoryRef.status.uoms),n=Vc(l=>l.inventoryRef.error.uoms);return x.useEffect(()=>{(a==="idle"||t)&&s(Mm())},[s,a,t]),{uoms:r,loading:a==="loading",error:n,refresh:()=>{s(Mm())}}};function sd({open:t,onClose:s,itemId:r,defaultUom:a="",currentUom:n="",conversions:i=null,onApply:l}){const[o,u]=x.useState(!1),[d,c]=x.useState(""),[h,A]=x.useState(Array.isArray(i)?i:[]),[f,g]=x.useState(""),[v,b]=x.useState(n||""),[y,j]=x.useState(a||"");x.useEffect(()=>{c(""),g(""),b(n||""),j(a||"")},[r,n,a,t]),x.useEffect(()=>{if(!t)return;if(Array.isArray(i)){A(i);return}let U=!0;return u(!0),ee.get("/inventory/unit-conversions").then(H=>{var q;U&&A(Array.isArray((q=H.data)==null?void 0:q.items)?H.data.items:[])}).catch(H=>{var q,V;U&&c(((V=(q=H==null?void 0:H.response)==null?void 0:q.data)==null?void 0:V.message)||"Failed to load conversions")}).finally(()=>{U&&u(!1)}),()=>{U=!1}},[t,i]);const N=x.useMemo(()=>{const U=r?Number(r):null,H=Array.isArray(h)?h:[];return U?H.filter(q=>Number(q.item_id)===U):[]},[h,r]),S=x.useMemo(()=>{const U=new Set;for(const H of N)Number(H.is_active)&&U.add(String(H.from_uom));return Array.from(U)},[N]),B=x.useMemo(()=>{const U=new Set;for(const H of N)Number(H.is_active)&&U.add(String(H.to_uom));return Array.from(U)},[N]),P=x.useMemo(()=>{const U=N.find(q=>Number(q.is_active)&&String(q.from_uom)===String(v||"")&&String(q.to_uom)===String(y||"")),H=Number((U==null?void 0:U.conversion_factor)||0);return Number.isFinite(H)&&H>0?H:null},[N,v,y]),L=x.useMemo(()=>{const U=Number(f);return!Number.isFinite(U)||U<=0||!P?null:U*P},[f,P]);return t?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow max-w-xl w-full",children:[e.jsxs("div",{className:"px-5 py-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Unit Conversion"}),e.jsx("button",{className:"btn-outline",onClick:s,children:""})]}),e.jsxs("div",{className:"p-5",children:[d?e.jsx("div",{className:"text-sm text-red-600 mb-3",children:d}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Unit"}),e.jsxs("select",{className:"input",value:v,onChange:U=>b(U.target.value),children:[e.jsx("option",{value:"",children:"Select unit"}),S.map(U=>e.jsx("option",{value:U,children:U},U))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Unit"}),e.jsxs("select",{className:"input",value:y,onChange:U=>j(U.target.value),children:[e.jsx("option",{value:"",children:"Select unit"}),B.map(U=>e.jsx("option",{value:U,children:U},U))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Factor"}),e.jsx("input",{type:"text",className:"input",value:P!=null?String(P):"",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Value to Convert"}),e.jsx("input",{type:"number",step:"0.000001",className:"input",value:f,onChange:U=>g(U.target.value)}),e.jsx("div",{className:"text-xs text-slate-500 mt-1",children:P?`1 ${v||""} = ${P} ${y||""}`:"Select valid From and To units"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"label",children:"Result"}),e.jsx("div",{className:"p-3 border-2 rounded text-center text-lg font-semibold",children:L!=null?`${f||0} ${v||""} = ${L} ${y||""}`:""})]})})]})]}),e.jsxs("div",{className:"px-5 py-4 border-t flex justify-end gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:s,children:"Close"}),e.jsx("button",{className:"btn-success",disabled:!l||!P||!Number.isFinite(Number(f))||Number(f)<=0,onClick:()=>{l&&(l({item_id:r,from_uom:v,to_uom:y,input_qty:f,converted_qty:L}),s&&s())},children:"Apply"})]})]})}):null}function R2(){var ut,ft,mt,pt,vt,Ot;const t=ys(),{id:s}=Ls(),r=!!s,{user:a}=ca(),[n]=Ef(),i=String(n.get("mode")||"").toLowerCase()==="view",[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState("details"),[A,f]=x.useState({order_no:"",order_date:new Date().toISOString().split("T")[0],customer_id:"",quotation_id:"",status:"DRAFT",currency_id:4,exchange_rate:1,sales_person_id:"",warehouse_id:"",price_type:"RETAIL",payment_type:"CASH",payment_terms:"",priority:"MEDIUM",shipping_charges:0,delivery_time:"",internal_notes:"",customer_notes:"",city:"",state:"",country:"",phone:"",remarks:""}),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState([]),[S,B]=x.useState([]),[P,L]=x.useState([]),[U,H]=x.useState([]),[q,V]=x.useState([]),M=x.useRef(null),[z,I]=x.useState({}),[G,Y]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",postalCode:"",country:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[J,T]=x.useState(""),{uoms:k}=el(),D=Ts.useMemo(()=>{const Ae=Array.isArray(k)?k:[],je=Ae.find(We=>String(We.uom_code||"").toUpperCase()==="PCS")||Ae[0];return je&&je.uom_code?je.uom_code:"PCS"},[k]),[Q,C]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),[E,w]=x.useState([]),[O,R]=x.useState(!1),[X,ne]=x.useState(""),[te,oe]=x.useState(!1);x.useEffect(()=>{ee.get("/inventory/unit-conversions").then(Ae=>{var je;w(Array.isArray((je=Ae.data)==null?void 0:je.items)?Ae.data.items:[])}).catch(()=>{w([])})},[]);const[ce,re]=x.useState({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:"",remarks:"",uom:""}),de=[{value:"LOW",label:"Low"},{value:"MEDIUM",label:"Medium"},{value:"HIGH",label:"High"},{value:"URGENT",label:"Urgent"}],Ie=Ae=>{var he;const je=parseFloat(Ae.qty)||0,We=parseFloat(Ae.unit_price)||0,De=parseFloat(Ae.discount_percent)||0,lt=je*We,rt=lt*De/100,et=lt-rt,Qt=((he=q.find(pe=>String(pe.value)===String(Ae.tax_type)))==null?void 0:he.rate)||0,Qe=et*Qt/100;return{sub:lt,discAmt:rt,net:et,taxAmt:Qe,total:et+Qe}},le=()=>{const Ae=g.reduce((We,De)=>We+(De.net||0),0),je=g.reduce((We,De)=>We+(De.taxAmt||0),0);return{sub:Ae,tax:je,total:Ae+je}},Z=Ae=>{if(Ae==null||Ae==="")return null;const je=Number(Ae);if(Number.isFinite(je)&&String(je)===String(Ae))return je;const We=q.find(De=>String(De.code||"")===String(Ae||""));return We?We.value:null},ve=async()=>{var Ae;try{const je=await ee.get("/sales/orders"),We=Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[];let De=0;for(const rt of We){const et=String(rt.order_no||"").match(/^SO-(\d{6})$/);if(et){const Qt=Number(et[1]);Number.isFinite(Qt)&&Qt>De&&(De=Qt)}}const lt=De+1;return`SO-${String(lt).padStart(6,"0")}`}catch{return"SO-000001"}},Ue=async(Ae,je)=>{var We;if(!Ae||!je)return 0;try{const De=await ee.get(`/inventory/stock/available?warehouse_id=${Ae}&item_id=${je}`);return Number(((We=De.data)==null?void 0:We.qty)||0)}catch{return 0}};x.useEffect(()=>{if(_e(),Me(),Te(),Ye(),ot(),Ke(),Be(),r)ue();else{let Ae=!0;return ve().then(je=>{Ae&&f(We=>({...We,order_no:We.order_no||je||"SO-000001"}))}).catch(()=>{Ae&&f(je=>({...je,order_no:je.order_no||"SO-000001"}))}),()=>{Ae=!1}}},[s]),x.useEffect(()=>{a!=null&&a.username&&T(a.username)},[a]);const Be=async()=>{var Ae,je,We,De,lt;try{const rt=(a==null?void 0:a.username)||"";T(rt);const et=await ee.get("/admin/me"),Qt=(je=(Ae=et.data)==null?void 0:Ae.scope)==null?void 0:je.companyId,Qe=((De=(We=et.data)==null?void 0:We.user)==null?void 0:De.username)||"";if(!rt&&Qe&&T(Qe),Qt){const pe=((lt=(await ee.get(`/admin/companies/${Qt}`)).data)==null?void 0:lt.item)||{};Y(ye=>({...ye,name:pe.name||ye.name||"",address:pe.address||ye.address||"",phone:pe.telephone||ye.phone||"",email:pe.email||ye.email||"",city:pe.city||ye.city||"",state:pe.state||ye.state||"",postalCode:pe.postal_code||ye.postalCode||"",country:pe.country||ye.country||"",website:pe.website||ye.website||"",taxId:pe.tax_id||ye.taxId||"",registrationNo:pe.registration_no||ye.registrationNo||"",logoUrl:pe.has_logo===1||pe.has_logo===!0?`/api/admin/companies/${Qt}/logo`:qs}))}else Y(he=>({...he,logoUrl:he.logoUrl||qs}))}catch{a!=null&&a.username&&T(a.username),Y(rt=>({...rt,logoUrl:rt.logoUrl||qs}))}},_e=async()=>{var Ae;try{const je=await ee.get("/sales/customers");y(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[])}catch(je){console.error("Error fetching customers:",je)}},Me=async()=>{var Ae;try{const je=await ee.get("/inventory/items");N(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[])}catch(je){console.error("Error fetching items:",je)}},Ye=async()=>{var Ae;try{const je=await ee.get("/inventory/warehouses");L(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[])}catch(je){console.error("Error fetching warehouses:",je)}},ot=async()=>{var Ae;try{const je=await ee.get("/finance/currencies"),We=Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[];H(We);const De=We.find(lt=>String(lt.code||lt.currency_code||"").toUpperCase()==="GHS")||We.find(lt=>/ghana|cedi/i.test(String(lt.name||lt.currency_name||"")));!r&&De&&f(lt=>({...lt,currency_id:De.id}))}catch(je){console.error("Error fetching currencies:",je)}},Ke=async()=>{var Ae;try{const je=await ee.get("/finance/tax-codes"),De=(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[]).map(lt=>({value:lt.id,label:lt.name,rate:Number(lt.rate_percent),code:lt.code}));V(De),De.length>0&&!ce.tax_type&&re(lt=>({...lt,tax_type:De[0].value}))}catch(je){console.error("Error fetching tax codes:",je)}},ct=async Ae=>{var We;const je=String(Ae||"");if(je)try{const De=await ee.get(`/finance/tax-codes/${Ae}/components`),lt=Array.isArray((We=De.data)==null?void 0:We.items)?De.data.items:[];I(rt=>({...rt,[je]:lt}))}catch{}},xt=async()=>{const je=Array.from(new Set(g.map(We=>String(We.tax_type)).filter(Boolean))).filter(We=>!(We in z));je.length&&await Promise.all(je.map(We=>ct(We)))},be=()=>{const Ae=g.reduce((rt,et)=>rt+(et.net||0),0),je={};g.forEach(rt=>{(z[String(rt.tax_type)]||[]).forEach(Qt=>{const Qe=Number(Qt.rate_percent)||0,he=(rt.net||0)*Qe/100,pe=Qt.component_name;je[pe]||(je[pe]={amount:0,rate:Qe,sort_order:Qt.sort_order||0}),je[pe].amount+=he})});const We=Object.keys(je).map(rt=>({name:rt,amount:je[rt].amount,rate:je[rt].rate,sort_order:je[rt].sort_order})).sort((rt,et)=>rt.sort_order-et.sort_order),De=We.reduce((rt,et)=>rt+et.amount,0),lt=Ae+De;return{sub:Ae,components:We,taxTotal:De,total:lt}},Ce=()=>{const Ae=g.reduce((rt,et)=>rt+(et.sub||0),0),je=g.reduce((rt,et)=>rt+(et.discAmt||0),0),We=g.reduce((rt,et)=>rt+(et.net||0),0),De=be(),lt=We+De.taxTotal;return{grossSub:Ae,discountTotal:je,netSub:We,components:De.components,taxTotal:De.taxTotal,grand:lt}},Te=async()=>{var Ae,je,We;try{const[De,lt]=await Promise.all([ee.get("/sales/quotations"),ee.get("/sales/orders")]),rt=Array.isArray((Ae=De.data)==null?void 0:Ae.items)?De.data.items:[],et=Array.isArray((je=lt.data)==null?void 0:je.items)?lt.data.items:[],Qt=new Set(et.map(he=>he==null?void 0:he.quotation_id).filter(he=>he!=null).map(he=>String(he)));let Qe=rt.filter(he=>!Qt.has(String(he.id)));if(r&&(A!=null&&A.quotation_id)){const he=String(A.quotation_id);if(!Qe.some(ye=>String(ye.id)===he))try{const Ne=(We=(await ee.get(`/sales/quotations/${he}`)).data)==null?void 0:We.item;Ne&&(Qe=[Ne,...Qe])}catch{Qe=[{id:A.quotation_id,quotation_no:he,customer_name:""},...Qe]}}B(Qe)}catch(De){console.error("Error fetching quotations:",De)}},ue=async()=>{var Ae,je,We,De;try{o(!0);const lt=await ee.get(`/sales/orders/${s}`),rt=(Ae=lt.data)==null?void 0:Ae.item;if(rt){if(f(et=>({order_no:rt.order_no||"",order_date:rt.order_date?new Date(rt.order_date).toISOString().split("T")[0]:"",customer_id:rt.customer_id||"",quotation_id:rt.quotation_id||"",status:rt.status||"DRAFT",warehouse_id:rt.warehouse_id||"",price_type:rt.price_type||"RETAIL",payment_type:rt.payment_type||"CASH",currency_id:rt.currency_id??et.currency_id??"",exchange_rate:rt.exchange_rate||1,sales_person_id:rt.sales_person_id||"",payment_terms:rt.payment_terms||"",priority:rt.priority||"MEDIUM",shipping_charges:rt.shipping_charges||0,delivery_time:rt.delivery_time||"",internal_notes:rt.internal_notes||"",customer_notes:rt.customer_notes||"",remarks:rt.remarks||""})),(je=lt.data)!=null&&je.details){let et=lt.data.details.map((Qe,he)=>{var ye;const pe=Ie({qty:Qe.qty??Qe.quantity??0,unit_price:Qe.unit_price??0,discount_percent:Qe.discount_percent??0,tax_type:Qe.tax_id??((ye=q==null?void 0:q[0])==null?void 0:ye.value)??""});return{...Qe,line_id:he+1,...pe}});const Qt=rt.warehouse_id||A.warehouse_id||"";Qt&&(et=await Promise.all(et.map(async he=>({...he,available_qty:await Ue(Qt,he.item_id)})))),v(et)}await Te()}}catch(lt){d(((De=(We=lt==null?void 0:lt.response)==null?void 0:We.data)==null?void 0:De.message)||"Error fetching order"),console.error("Error fetching order:",lt)}finally{o(!1)}},ge=async Ae=>{const je=Ae.target.value;if(f(We=>({...We,quotation_id:je})),!!je)try{o(!0);const We=await ee.get(`/sales/quotations/${je}`),{item:De,details:lt}=We.data;if(De&&f(rt=>({...rt,customer_id:De.customer_id||"",currency_id:De.currency_id||rt.currency_id||"",exchange_rate:De.exchange_rate||rt.exchange_rate||1,remarks:De.remarks||"",payment_terms:De.terms_and_conditions||rt.payment_terms||"",price_type:De.price_type||rt.price_type||"RETAIL",payment_type:De.payment_type||rt.payment_type||"CASH",warehouse_id:De.warehouse_id||rt.warehouse_id||""})),lt&&Array.isArray(lt)){const rt=lt.map((et,Qt)=>{var gt,kt;const Qe=j.find(yt=>yt.id==et.item_id),he=et.qty??et.quantity??0,pe=et.unit_price??0,ye=Z(et.tax_id??((gt=q==null?void 0:q[0])==null?void 0:gt.value)??""),Ne=Ie({qty:he,unit_price:pe,discount_percent:et.discount_percent??0,tax_type:ye}),He=et.tax_amount!==void 0&&et.tax_amount!==null?Number(et.tax_amount):Ne.taxAmt,Ge=et.total_amount!==void 0&&et.total_amount!==null?Number(et.total_amount):Ne.total;return{item_id:et.item_id,item_name:(Qe==null?void 0:Qe.item_name)||et.item_name||"Item "+et.item_id,qty:he,unit_price:pe,discount_percent:et.discount_percent??0,tax_type:ye,tax_rate:et.tax_rate!==void 0&&et.tax_rate!==null?Number(et.tax_rate):(kt=q.find(yt=>String(yt.value)===String(ye)))==null?void 0:kt.rate,remarks:et.remarks||"",line_id:Date.now()+Qt,...Ne,taxAmt:He,total:Ge}});v(rt)}}catch(We){console.error("Error fetching quotation details:",We),alert("Failed to load quotation details")}finally{o(!1)}},Ve=Ae=>{const{name:je,value:We}=Ae.target;if(je==="customer_id"){const De=b.find(lt=>String(lt.id)===String(We));f(lt=>({...lt,customer_id:We,city:(De==null?void 0:De.city)||"",state:(De==null?void 0:De.state)||"",country:(De==null?void 0:De.country)||"",phone:(De==null?void 0:De.phone)||(De==null?void 0:De.customer_phone)||""}));return}f(De=>({...De,[je]:We}))},tt=Ae=>{const{name:je,value:We}=Ae.target;if(je==="item_id"){const De=j.find(lt=>lt.id===parseInt(We));if(re(lt=>({...lt,item_id:We,item_name:(De==null?void 0:De.item_name)||"",unit_price:(De==null?void 0:De.selling_price)||"",qty:1,uom:String((De==null?void 0:De.uom)||"")||D})),We){A.customer_id&&ee.post("/sales/prices/best-price",{product_id:We,customer_id:A.customer_id,quantity:1,date:A.order_date,price_type:typeof A.price_type=="string"?A.price_type:String(A.price_type||""),only_standard:!0}).then(rt=>{rt.data&&rt.data.price!==void 0&&re(et=>({...et,unit_price:rt.data.price}))}).catch(rt=>console.error("Error fetching price:",rt)),ee.get(`/finance/item-tax/${We}`).then(rt=>{var Qt,Qe,he;const et=(Qt=rt.data)==null?void 0:Qt.tax;if(et){const pe=et.id||((Qe=q.find(Ne=>Ne.code===et.tax_code))==null?void 0:Qe.value)||null,ye=pe?(he=q.find(Ne=>String(Ne.value)===String(pe)))==null?void 0:he.rate:null;re(Ne=>({...Ne,tax_type:pe??Ne.tax_type,tax_rate:ye??et.tax_rate}))}else re(pe=>({...pe,tax_rate:void 0}))}).catch(()=>{re(rt=>({...rt,tax_rate:void 0}))});const lt=A.warehouse_id;lt?Ue(lt,Number(We)).then(rt=>re(et=>({...et,available_qty:rt}))):re(rt=>({...rt,available_qty:void 0}))}}else re(De=>({...De,[je]:We}))},Ze=()=>{if(!ce.item_id||!ce.qty||!ce.unit_price){alert("Please fill all required item fields");return}if(A.warehouse_id&&ce.available_qty!==void 0&&Number(ce.qty||0)>Number(ce.available_qty||0)){alert("Quantity exceeds available stock for selected warehouse");return}const Ae=Z(ce.tax_type)??(q.length>0?q[0].value:null),je=Ie({...ce,tax_type:Ae});v([...g,{...ce,tax_type:Ae,line_id:Date.now(),...je,available_qty:ce.available_qty,uom:ce.uom||D}]),re({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:0,tax_type:q.length>0?q[0].value:"",tax_rate:void 0,remarks:"",available_qty:void 0,uom:D})},ht=Ae=>{v(g.filter(je=>je.line_id!==Ae))};x.useEffect(()=>{const Ae=A.warehouse_id;if(!Ae){v(je=>je.map(We=>({...We,available_qty:void 0}))),re(je=>({...je,available_qty:void 0}));return}(async()=>{const je=await Promise.all(g.map(async We=>({...We,available_qty:await Ue(Ae,We.item_id)})));if(v(je),ce.item_id){const We=await Ue(Ae,Number(ce.item_id));re(De=>({...De,available_qty:We}))}})()},[A.warehouse_id]);const ze=async()=>{xt().finally(()=>window.print())},Fe=async()=>{await xt();const Ae=M.current;if(!Ae)return;const je=Ae.style.cssText;Ae.style.cssText=je+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const We=await Ai(Ae,{scale:2,useCORS:!0}),De=We.toDataURL("image/png"),lt=new ds("p","mm","a4"),rt=lt.internal.pageSize.getWidth(),et=lt.internal.pageSize.getHeight(),Qt=rt,Qe=We.height*Qt/We.width;let he=0;for(;he<Qe;)lt.addImage(De,"PNG",0,-he,Qt,Qe),he+=et,he<Qe&&lt.addPage();const pe="SalesOrder_"+(A.order_no||new Date().toISOString().slice(0,10))+".pdf";lt.save(pe)}finally{Ae.style.cssText=je}},xe=async Ae=>{var De,lt;if(Ae.preventDefault(),!A.customer_id||g.length===0){alert("Please select a customer and add at least one item");return}o(!0);const je=le();let We=A.order_no;if(!We){const rt=new Date().toISOString().slice(0,10).replace(/-/g,""),et=Math.floor(Math.random()*1e3).toString().padStart(3,"0");We=`SO-${rt}-${et}`}try{const rt={...A,order_no:We,customer_id:Number(A.customer_id),quotation_id:A.quotation_id?Number(A.quotation_id):null,total_amount:je.total,sub_total:je.sub,tax_amount:je.tax,items:g.map(et=>{const Qt=Z(et.tax_type),Qe=q.find(he=>String(he.value)===String(Qt));return{item_id:et.item_id,quantity:Number(et.qty),unit_price:Number(et.unit_price),discount_percent:Number(et.discount_percent),tax_id:Qt,tax_rate:Qe?Qe.rate:Number(et.tax_rate||0)||0,tax_amount:et.taxAmt,total_amount:et.total,net_amount:et.net,uom:String(et.uom||D)}})};r?await ee.put(`/sales/orders/${s}`,rt):await ee.post("/sales/orders",rt),nt.success(r?"Order updated successfully!":"Order created successfully!"),t("/sales/sales-orders")}catch(rt){console.error("Error saving order:",rt);const et=((lt=(De=rt.response)==null?void 0:De.data)==null?void 0:lt.message)||rt.message||"Unknown error";alert(`Error saving order: ${et}`)}finally{o(!1)}},we=String(A.status||"").toUpperCase()==="CONFIRMED",Xe=i&&we;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden my-6 print:shadow-none print:my-0 print:w-full print:max-w-none",children:[e.jsx("style",{children:`
        @media print {
          @page { margin: 1cm; }
          body { 
            background: white; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          #root > div > header,
          #root > div > div > aside { display: none !important; }
          .print\\:hidden { display: none !important; }
          .print\\:block { display: block !important; }
          #root > div > div > main { padding: 0 !important; }
          input, select, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            resize: none;
            overflow: visible;
          }
        }
        .quotation-table { 
          border-collapse: collapse; 
          table-layout: fixed; 
          width: 100%; 
          max-width: 100%; 
          border-spacing: 0; 
          box-sizing: border-box;
          margin: 0 auto;
        }
        .view-mode input, .view-mode select, .view-mode textarea {
          background-color: #eff6ff !important;
        }
        .quotation-table th, .quotation-table td { 
          border: 1px solid #000000; 
          box-sizing: border-box; 
          word-break: break-word; 
          overflow-wrap: anywhere; 
          white-space: normal; 
          padding: 6px 4px;
          font-size: 10px;
        }
        .quotation-table td {
          overflow: visible;
        }
        .quotation-table thead th { 
          background: #0E3646; 
          color: #ffffff; 
        }
        .quotation-table thead th:last-child,
        .quotation-table tbody td:last-child {
          background: #ffffff;
          color: #000000;
        }
        .quotation-table thead th:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        .quotation-table tbody td:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        @media print {
          .quotation-table {
            width: 100%;
            max-width: 100%;
          }
          .quotation-table thead th:last-child,
          .quotation-table tbody td:last-child {
            background: #ffffff !important;
            color: #000000 !important;
          }
          .quotation-table thead th:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
          .quotation-table tbody td:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
        }
      `}),e.jsx("div",{className:"p-6 border-b text-white print:hidden",style:{backgroundColor:"#0E3646"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:[r?"Edit":"New"," Sales Order"]}),e.jsx("p",{className:"text-sm opacity-80",children:r?"Update order details":"Create a new sales order"})]}),e.jsxs("div",{className:"flex gap-4 print:hidden items-center",children:[r?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:async()=>{var Ae,je;try{const We=await ee.post(`/documents/sales-order/${s}/render`,{format:"html"});ne(String(We.data||"")),R(!0)}catch(We){nt.error(((je=(Ae=We==null?void 0:We.response)==null?void 0:Ae.data)==null?void 0:je.message)||"Failed to render")}},className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-lg transition-colors text-sm font-medium border border-white/20",children:[e.jsx(Wy,{className:"w-4 h-4"}),"Template Preview"]}),e.jsxs("button",{onClick:async()=>{var Ae,je;try{oe(!0);const De=(await ee.post(`/documents/sales-order/${s}/render?format=pdf`,{},{responseType:"blob"})).data,lt=URL.createObjectURL(De),rt=document.createElement("a");rt.href=lt,rt.download=`sales-order-${s}.pdf`,rt.click(),URL.revokeObjectURL(lt)}catch(We){nt.error(((je=(Ae=We==null?void 0:We.response)==null?void 0:Ae.data)==null?void 0:je.message)||"Failed to download")}finally{oe(!1)}},className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-lg transition-colors text-sm font-medium border border-white/20",children:[e.jsx(Yc,{className:"w-4 h-4"}),"Template PDF"]})]}):null,e.jsxs("button",{onClick:Fe,className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-1.5 rounded-lg transition-colors text-sm font-medium border border-white/20",children:[e.jsx(Yc,{className:"w-4 h-4"}),"Download PDF"]}),e.jsx("button",{onClick:ze,className:"text-white hover:text-gray-200",children:e.jsx(qh,{className:"w-6 h-6"})}),e.jsx(Le,{to:"/sales/sales-orders",className:"text-white hover:text-gray-200",children:e.jsx(Uf,{className:"w-6 h-6"})})]})]})}),e.jsx("div",{className:"p-6 print:hidden",children:e.jsxs("form",{onSubmit:xe,children:[e.jsx("div",{className:"flex gap-4 border-b mb-6 print:hidden",children:e.jsx("button",{type:"button",onClick:()=>h("details"),className:`pb-2 px-4 font-medium transition-colors ${c==="details"?"border-b-2 border-[#0E3646] text-[#0E3646]":"text-gray-500 hover:text-gray-700"}`,children:"Order Details"})}),e.jsx("fieldset",{disabled:Xe,className:i?"view-mode":"",children:e.jsxs("div",{className:"block",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order #"}),e.jsx("input",{type:"text",name:"order_no",value:A.order_no,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Auto-generated",readOnly:!r&&!A.order_no})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",name:"order_date",value:A.order_date,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer *"}),e.jsxs("select",{name:"customer_id",value:A.customer_id,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",required:!0,children:[e.jsx("option",{value:"",children:"Select Customer"}),b.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.customer_name},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:A.warehouse_id,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),P.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.warehouse_name},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quotation Ref"}),e.jsxs("select",{name:"quotation_id",value:A.quotation_id,onChange:ge,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Quotation"}),S.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.quotation_no," - ",Ae.customer_name]},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),e.jsx("select",{name:"priority",value:A.priority,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:de.map(Ae=>e.jsx("option",{value:Ae.value,children:Ae.label},Ae.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Type"}),e.jsxs("select",{name:"price_type",value:A.price_type,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"RETAIL",children:"Retail"}),e.jsx("option",{value:"WHOLESALE",children:"Wholesale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),e.jsxs("select",{name:"payment_type",value:A.payment_type,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"}),e.jsx("option",{value:"CREDIT",children:"Credit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency"}),e.jsx("select",{name:"currency_id",value:A.currency_id,onChange:Ve,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:U.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.code||Ae.currency_code," -"," ",Ae.name||Ae.currency_name]},Ae.id))})]})]}),e.jsxs("div",{className:"border-t pt-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Order Items"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200 print:hidden",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-3 mb-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Item *"}),e.jsxs("select",{name:"item_id",value:ce.item_id,onChange:tt,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Item"}),j.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.item_code," - ",Ae.item_name]},Ae.id))]}),(()=>{const Ae=j.find(lt=>String(lt.id)===String(ce.item_id)),je=(Ae==null?void 0:Ae.uom)&&String(Ae.uom)||ce.uom&&String(ce.uom)||(D?String(D):""),We=String(ce.uom||"");return We&&je&&We!==je&&String(ce.item_id||"")?e.jsx("button",{type:"button",className:"mt-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>C({open:!0,itemId:ce.item_id,defaultUom:je,currentUom:We}),children:`number of ${We}`}):null})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"UOM *"}),e.jsx("select",{name:"uom",value:ce.uom||D,onChange:tt,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:(Array.isArray(k)?k:[]).map(Ae=>e.jsx("option",{value:Ae.uom_code,children:Ae.uom_name?`${Ae.uom_name} (${Ae.uom_code})`:Ae.uom_code},Ae.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),e.jsx("input",{type:"number",name:"qty",value:ce.qty,onChange:tt,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"1"})]}),e.jsx("div",{className:"flex items-end",children:(()=>{const Ae=j.find(rt=>String(rt.id)===String(ce.item_id)),je=(Ae==null?void 0:Ae.uom)&&String(Ae.uom)||ce.uom&&String(ce.uom)||(D?String(D):""),We=(Array.isArray(E)?E:[]).filter(rt=>Number(rt.is_active)&&String(rt.to_uom)===je&&Number(rt.item_id)===Number(ce.item_id)).map(rt=>String(rt.from_uom)),De=We[0]||"";return We.length>0&&De&&De!==je?e.jsx("button",{type:"button",className:"ml-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>C({open:!0,itemId:ce.item_id,defaultUom:je,currentUom:De,rowId:null}),children:`number of ${De}`}):null})()}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Available"}),e.jsx("input",{type:"text",value:A.warehouse_id?Number(ce.available_qty||0).toFixed(2):"",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",name:"unit_price",value:ce.unit_price,onChange:tt,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Disc %"}),e.jsx("input",{type:"number",name:"discount_percent",value:ce.discount_percent,onChange:tt,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"0",max:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),e.jsx("select",{name:"tax_type",value:ce.tax_type,onChange:tt,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:q.map(Ae=>e.jsx("option",{value:Ae.value,children:Ae.label},Ae.value))}),ce.tax_rate!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Tax rate: ",Number(ce.tax_rate).toFixed(2),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"button",onClick:Ze,className:"bg-[#0E3646] text-white px-4 py-2 rounded-lg hover:bg-[#092530] flex items-center gap-2 transition-colors text-sm",children:[e.jsx(xu,{className:"w-4 h-4"})," Add Item"]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"UOM"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Convert"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Available"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Disc%"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider print:hidden",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"px-4 py-8 text-center text-gray-500",children:"No items added yet"})}):g.map(Ae=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ae.item_name}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ae.uom||D}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ae.qty}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:(()=>{const je=j.find(et=>String(et.id)===String(Ae.item_id)),We=(je==null?void 0:je.uom)&&String(je.uom)||Ae.uom&&String(Ae.uom)||(D?String(D):""),De=(Array.isArray(E)?E:[]).filter(et=>Number(et.is_active)&&String(et.to_uom)===We&&Number(et.item_id)===Number(Ae.item_id)).map(et=>String(et.from_uom)),lt=De[0]||"";return De.length>0&&lt&&lt!==We?e.jsx("button",{type:"button",className:"px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>C({open:!0,itemId:Ae.item_id,defaultUom:We,currentUom:lt,rowId:Ae.line_id}),children:`number of ${lt}`}):null})()}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:A.warehouse_id?Number(Ae.available_qty||0).toFixed(2):""}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(Ae.unit_price).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:parseFloat(Ae.discount_percent||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ae.net.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Ae.taxAmt.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:Ae.total.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 print:hidden",children:e.jsx("button",{type:"button",onClick:()=>ht(Ae.line_id),className:"text-red-600 hover:text-red-900 transition-colors",children:e.jsx(Hl,{className:"w-4 h-4"})})})]},Ae.line_id))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"5",className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Totals:"}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:le().sub.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:le().tax.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:le().total.toFixed(2)}),e.jsx("td",{className:"print:hidden"})]})})]})})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t print:hidden",children:[e.jsx(Le,{to:"/sales/sales-orders",className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-[#0E3646] text-white rounded-lg hover:bg-[#092530] font-medium transition-colors flex items-center gap-2",children:l?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Vh,{className:"w-4 h-4"}),r?"Update Order":"Create Order"]})})]})]})}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:G.logoUrl||qs,alt:G.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:G.name||"Company"}),G.address&&e.jsx("div",{children:G.address}),(G.city||G.state||G.country)&&e.jsx("div",{children:[G.city,G.state,G.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[G.phone&&e.jsx("span",{children:G.phone}),G.email&&e.jsx("span",{children:G.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Sales Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",A.order_date||""]}),e.jsxs("div",{children:["Order #: ",A.order_no||""]}),e.jsxs("div",{children:["Customer:"," ",((ut=b.find(Ae=>String(Ae.id)===String(A.customer_id)))==null?void 0:ut.customer_name)||""]}),e.jsxs("div",{children:["City: ",A.city||""]}),e.jsxs("div",{children:["State: ",A.state||""]}),e.jsxs("div",{children:["Country: ",A.country||""]}),e.jsxs("div",{children:["Phone: ",A.phone||""]}),e.jsxs("div",{children:["Price Type: ",A.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",A.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((ft=U.find(Ae=>String(Ae.id)===String(A.currency_id)))==null?void 0:ft.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((mt=P.find(Ae=>String(Ae.id)===String(A.warehouse_id)))==null?void 0:mt.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",J||""]})]})]}),e.jsx("div",{className:"mb-2 mx-auto",children:e.jsxs("table",{className:"quotation-table text-sm",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:g.map(Ae=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ae.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.total||0).toFixed(2)})]},Ae.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ce().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ce().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ce().netSub.toFixed(2)}),Ce().components.map(Ae=>e.jsxs(Ts.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[Ae.name," [",Ae.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ae.amount.toFixed(2)})]},Ae.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ce().grand.toFixed(2)})]})})})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]}),e.jsxs("div",{ref:M,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:G.logoUrl||qs,alt:G.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:G.name||"Company"}),G.address&&e.jsx("div",{children:G.address}),(G.city||G.state||G.country)&&e.jsx("div",{children:[G.city,G.state,G.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[G.phone&&e.jsx("span",{children:G.phone}),G.email&&e.jsx("span",{children:G.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Sales Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",A.order_date||""]}),e.jsxs("div",{children:["Order #: ",A.order_no||""]}),e.jsxs("div",{children:["Customer:"," ",((pt=b.find(Ae=>String(Ae.id)===String(A.customer_id)))==null?void 0:pt.customer_name)||""]}),e.jsxs("div",{children:["City: ",A.city||""]}),e.jsxs("div",{children:["State: ",A.state||""]}),e.jsxs("div",{children:["Country: ",A.country||""]}),e.jsxs("div",{children:["Phone: ",A.phone||""]}),e.jsxs("div",{children:["Price Type: ",A.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",A.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((vt=U.find(Ae=>String(Ae.id)===String(A.currency_id)))==null?void 0:vt.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((Ot=P.find(Ae=>String(Ae.id)===String(A.warehouse_id)))==null?void 0:Ot.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",J||""]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"quotation-table text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:g.map(Ae=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ae.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.total||0).toFixed(2)})]},Ae.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Gross Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ce().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ce().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ce().netSub.toFixed(2)}),Ce().components.map(Ae=>e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"px-2 py-1",children:[Ae.name," [",Ae.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ae.amount.toFixed(2)})]},Ae.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Ce().grand.toFixed(2)})]})})})]})]})]}),e.jsx(s5,{open:O,onClose:()=>R(!1),html:X,downloading:te,onDownload:async()=>{var Ae,je;try{oe(!0);const De=(await ee.post(`/documents/sales-order/${s}/render?format=pdf`,{},{responseType:"blob"})).data,lt=URL.createObjectURL(De),rt=document.createElement("a");rt.href=lt,rt.download=`sales-order-${s}.pdf`,rt.click(),URL.revokeObjectURL(lt)}catch(We){nt.error(((je=(Ae=We==null?void 0:We.response)==null?void 0:Ae.data)==null?void 0:je.message)||"Failed to download")}finally{oe(!1)}}}),e.jsx(sd,{open:Q.open,itemId:Q.itemId,defaultUom:Q.defaultUom,currentUom:Q.currentUom,onClose:()=>C({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),onApply:Ae=>{const{converted_qty:je}=Ae||{},We=Number(je||0);Q.rowId!=null?v(De=>De.map(lt=>String(lt.line_id)===String(Q.rowId)?{...lt,qty:We,uom:Q.defaultUom||lt.uom}:lt)):re(De=>({...De,qty:We,uom:Q.defaultUom||De.uom}))}})]})}function JO(){const t=ys(),[s,r]=x.useState([]),[a,n]=x.useState([]),[i,l]=x.useState([]),[o,u]=x.useState(!0),[d,c]=x.useState(""),[h,A]=x.useState(""),[f,g]=x.useState("ALL"),[v,b]=x.useState(null),[y,j]=x.useState({name:"",address:"",city:"",state:"",country:"",postalCode:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""});x.useEffect(()=>{N()},[]);const N=async()=>{var I,G,Y,J,T;try{u(!0),c("");const[k,D,Q]=await Promise.all([ee.get("/sales/invoices"),ee.get("/finance/currencies"),ee.get("/inventory/warehouses")]);r(Array.isArray((I=k.data)==null?void 0:I.items)?k.data.items:[]),n(Array.isArray((G=D.data)==null?void 0:G.items)?D.data.items:[]),l(Array.isArray((Y=Q.data)==null?void 0:Y.items)?Q.data.items:[])}catch(k){c(((T=(J=k==null?void 0:k.response)==null?void 0:J.data)==null?void 0:T.message)||"Error fetching invoices"),console.error("Error fetching invoices:",k)}finally{u(!1)}};x.useEffect(()=>{let I=!0;async function G(){var Y,J,T;try{const D=(J=(Y=(await ee.get("/admin/me")).data)==null?void 0:Y.scope)==null?void 0:J.companyId;if(!D)return void 0;const C=((T=(await ee.get(`/admin/companies/${D}`)).data)==null?void 0:T.item)||{};if(!I)return;j(E=>({...E,name:C.name||E.name||"",address:C.address||E.address||"",city:C.city||E.city||"",state:C.state||E.state||"",country:C.country||E.country||"",postalCode:C.postal_code||E.postalCode||"",phone:C.telephone||E.phone||"",email:C.email||E.email||"",website:C.website||E.website||"",taxId:C.tax_id||E.taxId||"",registrationNo:C.registration_no||E.registrationNo||"",logoUrl:C.has_logo===1||C.has_logo===!0?`/api/admin/companies/${D}/logo`:E.logoUrl||""}))}catch{}}return G(),()=>{I=!1}},[]);function S(I){return String(I??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function B(I){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Invoice</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${I||""}</body>
</html>`}async function P(I){var Y;const G=Array.from(((Y=I==null?void 0:I.querySelectorAll)==null?void 0:Y.call(I,"img"))||[]);G.length&&await Promise.all(G.map(J=>new Promise(T=>{if(J.complete)return T();const k=()=>T();J.addEventListener("load",k,{once:!0}),J.addEventListener("error",k,{once:!0})})))}const L=(I,G)=>{var T;const Y=(Array.isArray(G)?G:[]).map(k=>{const D=Number(k.quantity||k.qty||0),Q=Number(k.unit_price||0),C=Number(k.discount_percent||0),E=Number(k.total_amount||D*Q),w=Number(k.net_amount||E-D*Q*C/100);return{item_name:String(k.item_name||""),qty:D.toFixed(2),unit_price:Q.toFixed(2),total:E.toFixed(2),discount:Number(C||0).toFixed(2),net:w.toFixed(2)}}),J=((T=a.find(k=>String(k.id)===String(I.currency_id)))==null?void 0:T.code)||"";return{company:{name:y.name||"Company",address:y.address||"",city:y.city||"",state:y.state||"",postalCode:y.postalCode||"",country:y.country||"",phone:y.phone||"",email:y.email||"",website:y.website||"",taxId:y.taxId||"",registrationNo:y.registrationNo||"",logoUrl:String(y.logoUrl||"")},invoice:{invoice_no:String(I.invoice_no||""),invoice_date:I.invoice_date?String(I.invoice_date).slice(0,10):"",due_date:String(I.due_date||""),payment_type:String(I.payment_type||""),price_type:String(I.price_type||""),currency:String(J||""),prepared_by:""},customer:{id:String(I.customer_id||""),code:"",name:String(I.customer_name||""),type:"",contactPerson:"",email:"",phone:String(I.phone||""),mobile:"",address:String(I.address||""),city:String(I.city||""),state:String(I.state||""),zone:"",country:String(I.country||""),paymentTerms:"",creditLimit:"0.00"},items:Y,totals:{subtotal:Number(Y.reduce((k,D)=>k+Number(D.total||0),0)).toFixed(2),discount:Number(Y.reduce((k,D)=>k+Number(D.discount||0),0)).toFixed(2),netSubtotal:Number(Y.reduce((k,D)=>k+Number(D.net||0),0)).toFixed(2),tax:"0.00",total:Number(I.net_amount||I.total_amount||0).toFixed(2)}}};function U(I){const G=I.company||{},Y=I.invoice||{},J=I.customer||{},T=Array.isArray(I.items)?I.items:[],k=I.totals||{};return`
      <style>
        .doc { color: #0f172a; font-size: 12px; }
        .doc-header { display: flex; justify-content: space-between; align-items: center; }
        .doc-title { font-weight: 800; font-size: 18px; color: #296d8f; }
        .company-block { display: flex; gap: 12px; align-items: center; }
        .company-logo { max-height: 80px; object-fit: contain; }
        .company-info div { line-height: 1.4; }
        .meta { text-align: right; font-size: 12px; }
        .section-title { font-weight: 700; margin-top: 8px; margin-bottom: 4px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
        table { border-collapse: collapse; width: 100%; font-size: 12px; }
        th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
        th { background: #f8fafc; text-align: left; }
        .totals { display: flex; justify-content: flex-end; margin-top: 12px; }
        .totals table { width: 320px; }
      </style>
      <div class="doc">
        <div class="doc-header">
          <div class="company-block">
            ${G.logoUrl?`<img src="${G.logoUrl}" alt="${S(G.name||"Company")}" class="company-logo" />`:""}
            <div class="company-info">
              <div>${S(G.name||"")}</div>
              <div>${S(G.address||"")}</div>
              <div>${S(G.city||"")}${G.city?",":""} ${S(G.state||"")} ${S(G.country||"")}</div>
              <div>${S(G.phone||"")} ${S(G.email||"")}</div>
              <div>${S(G.website||"")}</div>
              <div>${G.taxId?`Tax ID: ${S(G.taxId)}`:""}</div>
              <div>${G.registrationNo?`Reg No: ${S(G.registrationNo)}`:""}</div>
            </div>
          </div>
          <div class="meta">
            <div class="doc-title">Invoice</div>
            <div>Invoice No: ${S(Y.invoice_no||"")}</div>
            <div>Invoice Date: ${S(Y.invoice_date||"")}</div>
            <div>Due Date: ${S(Y.due_date||"")}</div>
            <div>Status: ${S(String(Y.status||""))}</div>
          </div>
        </div>

        <div class="grid-2" style="margin-top: 6px;">
          <div>
            <div class="section-title">Customer</div>
            <div>${S(J.name||"")}</div>
            <div>${S(J.address||"")}</div>
            <div>${S(J.city||"")}${J.city?",":""} ${S(J.state||"")} ${S(J.country||"")}</div>
            <div>${S(J.phone||"")} ${S(J.email||"")}</div>
          </div>
          <div>
            <div class="section-title">Payment</div>
            <div>Currency: ${S(Y.currency||"")}</div>
            <div>Payment Type: ${S(Y.payment_type||"")}</div>
            <div>Price Type: ${S(Y.price_type||"")}</div>
          </div>
        </div>

        <table style="margin-top: 8px;">
          <thead>
            <tr>
              <th>Description</th>
              <th style="text-align:right;">Qty</th>
              <th style="text-align:right;">Unit Price</th>
              <th style="text-align:right;">Discount</th>
              <th style="text-align:right;">Net</th>
            </tr>
          </thead>
          <tbody>
            ${T.map(D=>`
                <tr>
                  <td>${S(D.item_name||"")}</td>
                  <td style="text-align:right;">${S(D.qty||"")}</td>
                  <td style="text-align:right;">${S(D.unit_price||"")}</td>
                  <td style="text-align:right;">${S(D.discount||"")}</td>
                  <td style="text-align:right;">${S(D.net||"")}</td>
                </tr>
              `).join("")}
          </tbody>
        </table>

        <div class="totals">
          <table>
            <tbody>
              <tr><td>Subtotal</td><td style="text-align:right;">${S(k.subtotal||"")}</td></tr>
              <tr><td>Discount</td><td style="text-align:right;">${S(k.discount||"")}</td></tr>
              <tr><td>Net Subtotal</td><td style="text-align:right;">${S(k.netSubtotal||"")}</td></tr>
              <tr><td>Tax</td><td style="text-align:right;">${S(k.tax||"")}</td></tr>
              <tr><td><strong>Total</strong></td><td style="text-align:right;"><strong>${S(k.total||"")}</strong></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    `}async function H(I){var G,Y,J,T,k;try{const D=await ee.get(`/sales/invoices/${I}`),Q=((G=D.data)==null?void 0:G.item)||{},C=Array.isArray((Y=D.data)==null?void 0:Y.details)?D.data.details:[],E=L(Q,C),w=B(U(E)),O=document.createElement("iframe");O.style.position="fixed",O.style.right="0",O.style.bottom="0",O.style.width="0",O.style.height="0",O.style.border="0",document.body.appendChild(O);const R=((J=O.contentWindow)==null?void 0:J.document)||O.contentDocument||null;if(!R){document.body.removeChild(O);return}R.open(),R.write(w),R.close();const X=O.contentWindow||window;setTimeout(()=>{X.focus();try{X.print()}catch{}setTimeout(()=>{document.body.removeChild(O)},100)},200)}catch(D){nt.error(((k=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:k.message)||"Failed to print invoice")}}async function q(I){var G,Y,J,T;try{const k=await ee.get(`/sales/invoices/${I}`),D=((G=k.data)==null?void 0:G.item)||{},Q=Array.isArray((Y=k.data)==null?void 0:Y.details)?k.data.details:[],C=L(D,Q),E=U(C),w=document.createElement("div");w.style.position="fixed",w.style.left="-10000px",w.style.top="0",w.style.width="794px",w.style.background="white",w.style.padding="32px",w.innerHTML=E,document.body.appendChild(w);try{await P(w);const O=await Ai(w,{scale:2,useCORS:!0}),R=O.toDataURL("image/png"),X=new ds("p","mm","a4"),ne=X.internal.pageSize.getWidth(),te=X.internal.pageSize.getHeight(),oe=ne,ce=O.height*oe/O.width;let re=0;for(;re<ce;)X.addImage(R,"PNG",0,-re,oe,ce),re+=te,re<ce&&X.addPage();const de="Invoice_"+(String(D.invoice_no||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";X.save(de)}finally{document.body.removeChild(w)}}catch(k){nt.error(((T=(J=k==null?void 0:k.response)==null?void 0:J.data)==null?void 0:T.message)||"Failed to download invoice")}}const V=I=>{const G={DRAFT:"badge badge-warning",POSTED:"badge badge-success",CANCELLED:"badge badge-error"};return e.jsx("span",{className:G[I]||"badge",children:I})},M=I=>{const G={UNPAID:"badge badge-error",PARTIALLY_PAID:"badge badge-warning",PAID:"badge badge-success"},Y=String(I||"").trim()||"UNPAID";return e.jsx("span",{className:G[Y]||"badge",children:Y})},z=s.filter(I=>{const G=I.invoice_no.toLowerCase().includes(h.toLowerCase())||I.customer_name.toLowerCase().includes(h.toLowerCase()),Y=f==="ALL"||I.status===f;return G&&Y});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Invoices"}),e.jsx("p",{className:"text-sm mt-1",children:"Generate and manage customer invoices"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/sales/invoices/new",className:"btn-success",children:"+ New Invoice"})]})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by invoice number or customer...",className:"input",value:h,onChange:I=>A(I.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:f,onChange:I=>g(I.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]}),o?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading invoices..."})]}):z.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No invoices found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Net Amount"}),e.jsx("th",{children:"Actions"}),e.jsx("th",{children:"Payment Type"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{className:"text-right",children:"Balance"}),e.jsx("th",{children:"Remarks"})]})}),e.jsx("tbody",{children:z.map(I=>{var G;return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:I.invoice_no}),e.jsx("td",{children:new Date(I.invoice_date).toLocaleDateString()}),e.jsx("td",{children:I.customer_name}),e.jsx("td",{children:M(I.payment_status)}),e.jsx("td",{children:V(I.status)}),e.jsx("td",{className:"font-semibold",children:I.net_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/sales/invoices/${I.id}?mode=view`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),I.status!=="POSTED"&&e.jsx("button",{onClick:()=>t(`/sales/invoices/${I.id}`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>H(I.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",children:"Print"}),e.jsx("button",{onClick:()=>q(I.id),className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",children:"PDF"})]})}),e.jsx("td",{children:I.payment_type||""}),e.jsx("td",{children:I.price_type||""}),e.jsx("td",{children:((G=i.find(Y=>String(Y.id)===String(I.warehouse_id)))==null?void 0:G.warehouse_name)||""}),e.jsx("td",{className:"text-right",children:Number(I.balance_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:I.remarks||""})]},I.id)})})]})})]})})]})}function O2(){var ut,ft,mt,pt,vt,Ot;const t=ys(),{id:s}=Ls(),r=!!s,{user:a}=ca(),{search:n}=ma(),i=new URLSearchParams(n),l=i.get("action"),u=i.get("mode")==="view",d=!u,[c,h]=x.useState(!1),[A,f]=x.useState(""),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState([]),[S,B]=x.useState([]),[P,L]=x.useState([]),[U,H]=x.useState([]),[q,V]=x.useState({invoice_no:"",invoice_date:new Date().toISOString().split("T")[0],customer_id:"",sales_order_id:"",status:"POSTED",warehouse_id:"",price_type:"RETAIL",payment_type:"CASH",currency_id:"",exchange_rate:1,city:"",state:"",country:"",phone:"",remarks:""}),[M,z]=x.useState([]),[I,G]=x.useState({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:"",tax_type:"",tax_rate:void 0,remarks:"",uom:""}),Y=x.useRef(null),[J,T]=x.useState({}),[k,D]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",postalCode:"",country:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[Q,C]=x.useState(""),[E,w]=x.useState([]),{uoms:O}=el(),R=Ts.useMemo(()=>{const Ae=Array.isArray(O)?O:[],je=Ae.find(We=>String(We.uom_code||"").toUpperCase()==="PCS")||Ae[0];return je&&je.uom_code?je.uom_code:"PCS"},[O]),[X,ne]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),[te,oe]=x.useState([]);x.useEffect(()=>{ee.get("/inventory/unit-conversions").then(Ae=>{var je;oe(Array.isArray((je=Ae.data)==null?void 0:je.items)?Ae.data.items:[])}).catch(()=>{oe([])})},[]);const ce=Ae=>!Ae||typeof Ae!="string"?Ae:Ae.startsWith("INV")&&Ae.length===9&&/^\d{6}$/.test(Ae.substring(3))?`INV-${Ae.substring(3)}`:Ae,re=async(Ae,je)=>{var We;if(!Ae||!je)return 0;try{const De=await ee.get(`/inventory/stock/available?warehouse_id=${Ae}&item_id=${je}`);return Number(((We=De.data)==null?void 0:We.qty)||0)}catch{return 0}};x.useEffect(()=>{if(de(),Ie(),le(),Z(),ve(),Ue(),Ke(),r)ct();else{const Ae=xe(q.invoice_date,q.payment_terms);V(je=>({...je,due_date:Ae})),ee.get("/sales/invoices/next-no").then(je=>{var De;const We=(De=je.data)==null?void 0:De.nextNo;We&&V(lt=>({...lt,invoice_no:ce(We)}))}).catch(()=>{V(je=>({...je,invoice_no:je.invoice_no||"INV-000001"}))})}},[r,s]),x.useEffect(()=>{r&&le()},[q.sales_order_id]),x.useEffect(()=>{(async()=>{if(r){if(l==="print"){try{await Me()}catch{}setTimeout(()=>window.print(),200)}else if(l==="pdf"){const je=Y.current;if(!je)return;const We=je.style.cssText;je.style.cssText=We+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const De=await Ai(je,{scale:2,useCORS:!0}),lt=De.toDataURL("image/png"),rt=new ds("p","mm","a4"),et=rt.internal.pageSize.getWidth(),Qt=rt.internal.pageSize.getHeight(),Qe=et,he=De.height*Qe/De.width;let pe=0;for(;pe<he;)rt.addImage(lt,"PNG",0,-pe,Qe,he),pe+=Qt,pe<he&&rt.addPage();const ye="Invoice_"+(q.invoice_no||new Date().toISOString().slice(0,10))+".pdf";rt.save(ye)}finally{je.style.cssText=We}}}})()},[l,r]);const de=async()=>{var Ae;try{const je=await ee.get("/sales/customers");v(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[])}catch(je){console.error("Error fetching customers:",je)}},Ie=async()=>{var Ae,je,We,De;try{const[lt,rt]=await Promise.allSettled([ee.get("/inventory/items"),ee.get("/sales/prices/standard")]),et=lt.status==="fulfilled"&&Array.isArray((je=(Ae=lt.value)==null?void 0:Ae.data)==null?void 0:je.items)?lt.value.data.items:[],Qt=rt.status==="fulfilled"&&Array.isArray((De=(We=rt.value)==null?void 0:We.data)==null?void 0:De.items)?rt.value.data.items:[],Qe=new Map;for(const pe of Qt){const ye=pe.product_id;ye&&(Qe.has(ye)||Qe.set(ye,pe))}const he=et.map(pe=>{const ye=Qe.get(pe.id),Ne=ye&&ye.selling_price!==void 0&&ye.selling_price!==null?Number(ye.selling_price):pe.selling_price;return{...pe,selling_price:Ne}});y(he)}catch(lt){console.error("Error fetching items:",lt),y([])}},le=async()=>{var Ae,je,We;try{const[De,lt]=await Promise.all([ee.get("/sales/orders"),ee.get("/sales/invoices")]),rt=Array.isArray((Ae=De.data)==null?void 0:Ae.items)?De.data.items:[],et=Array.isArray((je=lt.data)==null?void 0:je.items)?lt.data.items:[],Qt=new Set(et.map(he=>he==null?void 0:he.sales_order_id).filter(he=>he!=null).map(he=>String(he)));let Qe=rt.filter(he=>!Qt.has(String(he.id)));if(r&&q.sales_order_id){const he=String(q.sales_order_id);if(!Qe.some(ye=>String(ye.id)===he))try{const Ne=(We=(await ee.get(`/sales/orders/${q.sales_order_id}`)).data)==null?void 0:We.item;Ne&&(Qe=[Ne,...Qe])}catch{}}N(Qe)}catch(De){console.error("Error fetching orders:",De)}},Z=async()=>{var Ae;try{const je=await ee.get("/inventory/warehouses");B(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[])}catch(je){console.error("Error fetching warehouses:",je)}},ve=async()=>{var Ae;try{const je=await ee.get("/finance/currencies"),We=Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[];L(We);const De=We.find(lt=>String(lt.code||lt.currency_code||"").toUpperCase()==="GHS")||We.find(lt=>/ghana|cedi/i.test(String(lt.name||lt.currency_name||"")));V(lt=>({...lt,currency_id:lt.currency_id||(De==null?void 0:De.id)||"",exchange_rate:lt.exchange_rate||1}))}catch(je){console.error("Error fetching currencies:",je)}},Ue=async()=>{var Ae;try{const je=await ee.get("/finance/tax-codes"),De=(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[]).map(lt=>({value:lt.id,label:lt.name,rate:Number(lt.rate_percent)}));H(De),De.length>0&&!I.tax_type&&G(lt=>({...lt,tax_type:De[0].value}))}catch(je){console.error("Error fetching tax codes:",je)}},Be=async()=>{var Ae;if(q.customer_id)try{const je=await ee.get(`/sales/prices/customer?customer_id=${q.customer_id}`);w(Array.isArray((Ae=je.data)==null?void 0:Ae.items)?je.data.items:[])}catch(je){console.error("Error fetching customer prices:",je)}},_e=async Ae=>{var We;const je=String(Ae||"");if(je)try{const De=await ee.get(`/finance/tax-codes/${Ae}/components`),lt=Array.isArray((We=De.data)==null?void 0:We.items)?De.data.items:[];T(rt=>({...rt,[je]:lt}))}catch{}},Me=async()=>{const je=Array.from(new Set(M.map(We=>String(We.tax_type)).filter(Boolean))).filter(We=>!(We in J));je.length&&await Promise.all(je.map(We=>_e(We)))},Ye=()=>{const Ae=M.reduce((rt,et)=>rt+(et.net||0),0),je={};M.forEach(rt=>{(J[String(rt.tax_type)]||[]).forEach(Qt=>{const Qe=Number(Qt.rate_percent)||0,he=(rt.net||0)*Qe/100,pe=Qt.component_name;je[pe]||(je[pe]={amount:0,rate:Qe,sort_order:Qt.sort_order||0}),je[pe].amount+=he})});const We=Object.keys(je).map(rt=>({name:rt,amount:je[rt].amount,rate:je[rt].rate,sort_order:je[rt].sort_order})).sort((rt,et)=>rt.sort_order-et.sort_order),De=We.reduce((rt,et)=>rt+et.amount,0),lt=Ae+De;return{sub:Ae,components:We,taxTotal:De,total:lt}},ot=()=>{const Ae=M.reduce((rt,et)=>rt+(et.sub||0),0),je=M.reduce((rt,et)=>rt+(et.discAmt||0),0),We=M.reduce((rt,et)=>rt+(et.net||0),0),De=Ye(),lt=We+De.taxTotal;return{grossSub:Ae,discountTotal:je,netSub:We,components:De.components,taxTotal:De.taxTotal,grand:lt}},Ke=async()=>{var Ae,je,We,De,lt;try{const rt=(a==null?void 0:a.username)||"";C(rt);const et=await ee.get("/admin/me"),Qt=(je=(Ae=et.data)==null?void 0:Ae.scope)==null?void 0:je.companyId,Qe=((De=(We=et.data)==null?void 0:We.user)==null?void 0:De.username)||"";if(!rt&&Qe&&C(Qe),Qt){const pe=((lt=(await ee.get(`/admin/companies/${Qt}`)).data)==null?void 0:lt.item)||{};D(ye=>({...ye,name:pe.name||ye.name||"",address:pe.address||ye.address||"",phone:pe.telephone||ye.phone||"",email:pe.email||ye.email||"",city:pe.city||ye.city||"",state:pe.state||ye.state||"",postalCode:pe.postal_code||ye.postalCode||"",country:pe.country||ye.country||"",website:pe.website||ye.website||"",taxId:pe.tax_id||ye.taxId||"",registrationNo:pe.registration_no||ye.registrationNo||"",logoUrl:pe.has_logo===1||pe.has_logo===!0?`/api/admin/companies/${Qt}/logo`:qs}))}else D(he=>({...he,logoUrl:he.logoUrl||qs}))}catch{a!=null&&a.username&&C(a.username),D(rt=>({...rt,logoUrl:rt.logoUrl||qs}))}},ct=async()=>{var Ae,je,We,De;try{h(!0);const lt=await ee.get(`/sales/invoices/${s}`),rt=(Ae=lt.data)==null?void 0:Ae.item;if(rt){V({invoice_no:rt.invoice_no||"",invoice_date:Fe(rt.invoice_date||new Date),customer_id:rt.customer_id||"",status:rt.status||"POSTED",due_date:Fe(rt.due_date||""),city:"",state:"",country:"",phone:"",remarks:rt.remarks||"",warehouse_id:rt.warehouse_id||"",price_type:rt.price_type||"RETAIL",payment_type:rt.payment_type||"CASH",currency_id:rt.currency_id||"",exchange_rate:Number(rt.exchange_rate||1),sales_order_id:rt.sales_order_id||""});const et=g.find(Qt=>String(Qt.id)===String(rt.customer_id));et&&V(Qt=>({...Qt,city:et.city||"",state:et.state||"",country:et.country||"",phone:et.phone||et.customer_phone||""}))}if((je=lt.data)!=null&&je.details){let et=lt.data.details.map((Qe,he)=>{var Ft;const pe=Math.round(Number(Qe.quantity||0)*100)/100,ye=Math.round(Number(Qe.unit_price||0)*100)/100,Ne=Math.round(Number(Qe.discount_percent||0)*100)/100,He=Qe.tax_id||"",Ge=Qe.tax_rate!==void 0&&Qe.tax_rate!==null?Number(Qe.tax_rate):((Ft=U.find(Yt=>String(Yt.value)===String(He)))==null?void 0:Ft.rate)||0,gt=ht({qty:pe,unit_price:ye,discount_percent:Ne,tax_type:He}),kt=Qe.net_amount!==void 0&&Qe.net_amount!==null?Math.round(Number(Qe.net_amount)*100)/100:gt.net,yt=Qe.tax_amount!==void 0&&Qe.tax_amount!==null?Math.round(Number(Qe.tax_amount)*100)/100:gt.taxAmt,Et=Qe.total_amount!==void 0&&Qe.total_amount!==null?Math.round(Number(Qe.total_amount)*100)/100:gt.total;return{line_id:he+1,item_id:Qe.item_id,item_name:Qe.item_name||"",remarks:Qe.remarks||"",qty:pe,unit_price:ye,discount_percent:Ne,tax_rate:Ge,tax_type:He,sub:Math.round(Number(pe*ye)*100)/100,discAmt:Math.round(Number(pe*ye*Ne/100)*100)/100,net:kt,taxAmt:yt,total:Et}});const Qt=rt.warehouse_id||q.warehouse_id||"";Qt&&(et=await Promise.all(et.map(async he=>({...he,available_qty:await re(Qt,he.item_id)})))),z(et)}}catch(lt){f(((De=(We=lt==null?void 0:lt.response)==null?void 0:We.data)==null?void 0:De.message)||"Error fetching invoice"),console.error("Error fetching invoice:",lt)}finally{h(!1)}};async function xt(Ae){try{const je=[...M],We=await Promise.all(je.map(async De=>{if(!De.item_id){const rt={...De};return{...rt,...ht(rt)}}try{const rt=await ee.post("/sales/prices/best-price",{product_id:De.item_id,customer_id:q.customer_id,quantity:Number(De.qty||1),date:q.invoice_date,price_type:typeof Ae=="string"?Ae:String(Ae||""),only_standard:!0});if(rt.data&&rt.data.price!==void 0){const et={...De,unit_price:Math.round(Number(rt.data.price||0)*100)/100};return{...et,...ht(et)}}}catch{}const lt={...De};return{...lt,...ht(lt)}}));z(We)}catch{}}function be(Ae,je){let We={...q,[Ae]:je};if(Ae==="customer_id"){const De=g.find(lt=>lt.id==je);We.city=(De==null?void 0:De.city)||"",We.state=(De==null?void 0:De.state)||"",We.country=(De==null?void 0:De.country)||"",We.phone=(De==null?void 0:De.phone)||(De==null?void 0:De.customer_phone)||"",Be()}Ae==="sales_order_id"&&je&&Ce(je),Ae==="price_type"&&xt(je),V(We)}async function Ce(Ae){var je,We;try{const De=await ee.get(`/sales/orders/${Ae}`),lt=(je=De.data)==null?void 0:je.item,rt=Array.isArray((We=De.data)==null?void 0:We.details)?De.data.details:[];if(lt&&V(et=>({...et,customer_id:lt.customer_id||et.customer_id,warehouse_id:lt.warehouse_id||et.warehouse_id||""})),rt.length){let et=rt.map(Qe=>{var Et;const he=Math.round(Number(Qe.qty||0)*100)/100,pe=Math.round(Number(Qe.unit_price||0)*100)/100,ye=Math.round(Number(Qe.discount_percent||0)*100)/100,Ne=Qe.tax_id||"",He=ht({qty:he,unit_price:pe,discount_percent:ye,tax_type:Ne}),Ge=Qe.tax_rate!==void 0&&Qe.tax_rate!==null?Number(Qe.tax_rate):((Et=U.find(Ft=>String(Ft.value)===String(Ne)))==null?void 0:Et.rate)||0,gt=Qe.tax_amount!==void 0&&Qe.tax_amount!==null?Math.round(Number(Qe.tax_amount)*100)/100:He.taxAmt,kt=Qe.total_amount!==void 0&&Qe.total_amount!==null?Math.round(Number(Qe.total_amount)*100)/100:He.total,yt=b.find(Ft=>Ft.id==Qe.item_id);return{line_id:Date.now()+Math.random(),item_id:Qe.item_id,item_name:Qe.item_name||(yt==null?void 0:yt.item_name)||"",qty:he,unit_price:pe,discount_percent:ye,tax_type:Ne,tax_rate:Ge,...He,taxAmt:gt,total:kt}});const Qt=(lt==null?void 0:lt.warehouse_id)||q.warehouse_id||"";Qt&&(et=await Promise.all(et.map(async he=>({...he,available_qty:await re(Qt,he.item_id)})))),z(et)}}catch(De){console.error("Failed to apply order to invoice",De)}}function Te(Ae){const{name:je,value:We}=Ae.target;if(je==="item_id"){const De=b.find(lt=>lt.id===parseInt(We));if(G(lt=>({...lt,item_id:We,item_name:(De==null?void 0:De.item_name)||"",unit_price:"",qty:1,uom:String((De==null?void 0:De.uom)||"")||R})),We){{const rt={product_id:We,quantity:1,date:q.invoice_date,price_type:typeof q.price_type=="string"?q.price_type:String(q.price_type||""),only_standard:!0,...q.customer_id?{customer_id:q.customer_id}:{}};ee.post("/sales/prices/best-price",rt).then(et=>{et.data&&et.data.price!==void 0&&G(Qt=>({...Qt,unit_price:Math.round(Number(et.data.price||0)*100)/100}))}).catch(et=>console.error("Error fetching price:",et))}ee.get(`/finance/item-tax/${We}`).then(rt=>{var Qt,Qe,he;const et=(Qt=rt.data)==null?void 0:Qt.tax;if(et){const pe=et.id||((Qe=U.find(Ne=>Ne.code===et.tax_code))==null?void 0:Qe.value)||null,ye=pe?(he=U.find(Ne=>String(Ne.value)===String(pe)))==null?void 0:he.rate:null;G(Ne=>({...Ne,tax_type:pe??Ne.tax_type,tax_rate:ye??et.tax_rate}))}else G(pe=>({...pe,tax_rate:void 0}))}).catch(()=>{G(rt=>({...rt,tax_rate:void 0}))});const lt=q.warehouse_id;lt?re(lt,Number(We)).then(rt=>G(et=>({...et,available_qty:rt}))):G(rt=>({...rt,available_qty:void 0}))}}else if(je==="unit_price"||je==="qty"||je==="discount_percent"){const De=We===""?"":Math.round(Number(We)*100)/100;G(lt=>({...lt,[je]:De}))}else G(De=>({...De,[je]:We}))}function ue(){if(!I.item_id||!I.qty||!I.unit_price)return;if(q.warehouse_id&&I.available_qty!==void 0&&Number(I.qty||0)>Number(I.available_qty||0)){nt.error("Quantity exceeds available stock for selected warehouse");return}const Ae=ht(I);z(je=>[...je,{...I,line_id:Date.now(),...Ae,available_qty:I.available_qty,uom:I.uom||R}]),G({item_id:"",item_name:"",qty:"",unit_price:"",discount_percent:"",tax_type:U.length>0?U[0].value:"",tax_rate:void 0,remarks:"",available_qty:void 0,uom:R})}async function ge(Ae,je){try{const We={product_id:je,quantity:1,date:q.invoice_date,price_type:typeof q.price_type=="string"?q.price_type:String(q.price_type||""),only_standard:!0,...q.customer_id?{customer_id:q.customer_id}:{}},De=await ee.post("/sales/prices/best-price",We);De.data&&De.data.price!==void 0&&z(lt=>lt.map((rt,et)=>{if(et!==Ae)return rt;const Qt={...rt,unit_price:Math.round(Number(De.data.price||0)*100)/100};return{...Qt,...ht(Qt)}}))}catch(We){console.error("Error fetching price:",We)}}function Ve(Ae,je){je.item_id&&ge(Ae,je.item_id),z(We=>We.map((De,lt)=>{var et;if(lt!==Ae)return De;let rt={...De,...je};if("unit_price"in je&&(rt.unit_price=je.unit_price===""||je.unit_price==null?"":Math.round(Number(je.unit_price)*100)/100),"qty"in je&&(rt.qty=je.qty===""||je.qty==null?"":Math.round(Number(je.qty)*100)/100),"discount_percent"in je&&(rt.discount_percent=je.discount_percent===""||je.discount_percent==null?"":Math.round(Number(je.discount_percent)*100)/100),je.item_id){const Qt=b.find(Qe=>Qe.id==je.item_id);if(rt.item_name=(Qt==null?void 0:Qt.item_name)||rt.item_name||"",rt.uom=rt.uom||String((Qt==null?void 0:Qt.uom)||"")||R,we(je.item_id,Qe=>{rt.tax_rate=Qe==null?void 0:Qe.tax_rate,rt.tax_type=(Qe==null?void 0:Qe.tax_code)||rt.tax_type||"VAT15"}),q.warehouse_id)return re(Number(q.warehouse_id),Number(je.item_id)).then(Qe=>{z(he=>he.map((pe,ye)=>ye===Ae?{...rt,available_qty:Qe,...ht(rt)}:pe))}),rt}if(je.tax_type){const Qt=((et=U.find(Qe=>String(Qe.value)===String(je.tax_type)))==null?void 0:et.rate)||0;rt.tax_rate=Qt}return rt={...rt,...ht(rt)},rt}))}function tt(Ae){const je=b.find(We=>String(We.id)===String(Ae));return je&&je.item_code||""}function Ze(Ae){z(je=>je.filter(We=>We.line_id!==Ae))}function ht(Ae){var pe;const je=Math.round(Number(Ae.qty||0)*100)/100,We=Math.round(Number(Ae.unit_price||0)*100)/100,De=Math.round(Number(Ae.discount_percent||0)*100)/100,lt=Math.round(je*We*100)/100,rt=Math.round(lt*De/100*100)/100,et=Math.round((lt-rt)*100)/100,Qt=((pe=U.find(ye=>String(ye.value)===String(Ae.tax_type)))==null?void 0:pe.rate)||0,Qe=Math.round(et*Qt/100*100)/100,he=Math.round((et+Qe)*100)/100;return{sub:lt,discAmt:rt,net:et,taxAmt:Qe,total:he,line_total:he}}x.useEffect(()=>{const Ae=q.warehouse_id;if(!Ae){z(je=>je.map(We=>({...We,available_qty:void 0}))),G(je=>({...je,available_qty:void 0}));return}(async()=>{const je=await Promise.all(M.map(async We=>({...We,available_qty:await re(Ae,We.item_id)})));if(z(je),I.item_id){const We=await re(Ae,Number(I.item_id));G(De=>({...De,available_qty:We}))}})()},[q.warehouse_id]);function ze(){const Ae=M.reduce((We,De)=>We+Number(De.net||0),0),je=M.reduce((We,De)=>We+Number(De.taxAmt||0),0);return{sub:Ae,tax:je,total:Ae+je}}function Fe(Ae){if(!Ae)return"";if(Ae instanceof Date)return Ae.toISOString().split("T")[0];const je=String(Ae);return je.includes("T")?je.split("T")[0]:je.slice(0,10)}function xe(Ae,je){if(!Ae)return"";const We=new Date(Ae);return We.setDate(We.getDate()+Number(je||0)),We.toISOString().split("T")[0]}function we(Ae,je){ee.get(`/finance/item-tax/${Ae}`).then(We=>{var De;return je(((De=We.data)==null?void 0:De.tax)||null)}).catch(()=>je(null))}async function Xe(Ae){var je,We,De,lt,rt,et,Qt;Ae.preventDefault(),h(!0),f("");try{if(!q.warehouse_id){nt.error("Select Warehouse before saving the invoice"),h(!1);return}const he=I.item_id&&I.qty&&I.unit_price?[...M,{...I,...ht(I)}]:[...M];if(!he.length){nt.error("Add at least one item before saving the invoice"),h(!1);return}const pe=new Date().toISOString().slice(0,10).replace(/-/g,"");let ye=q.invoice_no;if(!ye){const gt=Math.floor(Math.random()*1e3).toString().padStart(3,"0");ye=`INV-${pe}-${gt}`}const Ne=(()=>{const gt=he.reduce((yt,Et)=>yt+Number(Et.net||0),0),kt=he.reduce((yt,Et)=>yt+Number(Et.taxAmt||0),0);return{sub:gt,tax:kt,total:gt+kt}})(),He={...q,invoice_date:Fe(q.invoice_date),invoice_no:ye,customer_id:Number(q.customer_id),due_date:Fe(q.due_date)||null,warehouse_id:q.warehouse_id?Number(q.warehouse_id):null,price_type:q.price_type,payment_type:q.payment_type,currency_id:q.currency_id?Number(q.currency_id):null,exchange_rate:Number(q.exchange_rate||1),total_amount:Math.round(Number(Ne.total||0)*100)/100,tax_amount:Math.round(Number(Ne.tax||0)*100)/100,net_amount:Math.round(Number(Ne.sub||0)*100)/100,...q.sales_order_id?{sales_order_id:Number(q.sales_order_id)}:{},items:he.map(gt=>{var Yt;const kt=gt.tax_type,yt=Number(kt);let Et=Number.isFinite(yt)&&yt>0?yt:null;if(!Et&&kt){const rs=U.find(As=>String(As.label||"").toUpperCase()===String(kt||"").toUpperCase());rs&&(Et=Number(rs.value))}const Ft=((Yt=U.find(rs=>Number(rs.value)===Number(Et)))==null?void 0:Yt.rate)||0;return{item_id:gt.item_id,quantity:Math.round(Number(gt.qty||0)*100)/100,unit_price:Math.round(Number(gt.unit_price||0)*100)/100,discount_percent:Math.round(Number(gt.discount_percent||0)*100)/100,tax_id:Et||null,tax_rate:Ft,tax_amount:Math.round(Number(gt.taxAmt||0)*100)/100,total_amount:Math.round(Number(gt.total||0)*100)/100,net_amount:Math.round(Number(gt.net||0)*100)/100,uom:String(gt.uom||R)}})};let Ge=0;if(r){const gt=await ee.put(`/sales/invoices/${s}`,He);Ge=Number(((je=gt==null?void 0:gt.data)==null?void 0:je.id)||s)}else{const gt=await ee.post("/sales/invoices",He);Ge=Number(((We=gt==null?void 0:gt.data)==null?void 0:We.id)||0)}try{const gt=await ee.post(`/sales/invoices/${Ge}/submit`),kt=((De=gt==null?void 0:gt.data)==null?void 0:De.payment_status)||"UNPAID";nt.success(`Invoice ${ye} saved and submitted (${kt})`),t("/sales/invoices")}catch(gt){const kt=((rt=(lt=gt==null?void 0:gt.response)==null?void 0:lt.data)==null?void 0:rt.message)||"Failed to submit invoice";/already submitted/i.test(kt)?(nt.info(`Invoice ${ye} already submitted`),t("/sales/invoices")):(/no line items/i.test(kt)||/warehouse_id is required/i.test(kt)||/insufficient stock/i.test(kt),nt.error(kt))}}catch(Qe){const he=((Qt=(et=Qe==null?void 0:Qe.response)==null?void 0:et.data)==null?void 0:Qt.message)||"Error saving invoice";f(he),nt.error(he)}finally{h(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("style",{children:`
        @media print {
          @page { margin: 1cm; }
          body { 
            background: white; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          #root > div > header,
          #root > div > div > aside { display: none !important; }
          .print\\:hidden { display: none !important; }
          .print\\:block { display: block !important; }
          #root > div > div > main { padding: 0 !important; }
          input, select, textarea {
            border: none !important;
            background: transparent !important;
            padding: 0 !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            resize: none;
            overflow: visible;
          }
        }
        .quotation-table { 
          border-collapse: collapse; 
          table-layout: fixed; 
          width: 100%; 
          max-width: 100%; 
          border-spacing: 0; 
          box-sizing: border-box;
          margin: 0 auto;
        }
        .quotation-table th, .quotation-table td { 
          border: 1px solid #000000; 
          box-sizing: border-box; 
          word-break: break-word; 
          overflow-wrap: anywhere; 
          white-space: normal; 
          padding: 6px 4px;
          font-size: 10px;
        }
        .quotation-table thead th { 
          background: #0E3646; 
          color: #ffffff; 
        }
        .quotation-table thead th:last-child,
        .quotation-table tbody td:last-child {
          background: #ffffff;
          color: #000000;
        }
        .quotation-table thead th:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        .quotation-table tbody td:last-child {
          border-top: 1px solid #ffffff;
          border-right: 1px solid #ffffff;
          border-bottom: 1px solid #ffffff;
          border-left: 1px solid #000000;
        }
        @media print {
          .quotation-table {
            width: 100%;
            max-width: 100%;
          }
          .quotation-table thead th:last-child,
          .quotation-table tbody td:last-child {
            background: #ffffff !important;
            color: #000000 !important;
          }
          .quotation-table thead th:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
          .quotation-table tbody td:last-child {
            border-top: 1px solid #ffffff !important;
            border-right: 1px solid #ffffff !important;
            border-bottom: 1px solid #ffffff !important;
            border-left: 1px solid #000000 !important;
          }
        }
      `}),e.jsx("div",{className:"card print:hidden",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Invoice":"New Invoice"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage sales invoices"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("button",{type:"button",onClick:async()=>{try{await Me()}catch{}window.print()},className:"btn-secondary",title:"Print",children:[e.jsx(qh,{className:"w-4 h-4 inline mr-1"}),"Print"]}),e.jsxs("button",{type:"button",onClick:async()=>{const Ae=Y.current;if(!Ae)return;const je=Ae.style.cssText;Ae.style.cssText=je+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const We=await Ai(Ae,{scale:2,useCORS:!0}),De=We.toDataURL("image/png"),lt=new ds("p","mm","a4"),rt=lt.internal.pageSize.getWidth(),et=lt.internal.pageSize.getHeight(),Qt=rt,Qe=We.height*Qt/We.width;let he=0;for(;he<Qe;)lt.addImage(De,"PNG",0,-he,Qt,Qe),he+=et,he<Qe&&lt.addPage();const pe="Invoice_"+(q.invoice_no||new Date().toISOString().slice(0,10))+".pdf";lt.save(pe)}finally{Ae.style.cssText=je}},className:"btn-secondary",title:"Download PDF",children:[e.jsx(Yc,{className:"w-4 h-4 inline mr-1"}),"Download PDF"]}),e.jsx(Le,{to:"/sales/invoices",className:"btn-success",children:"Back"})]})]})})}),e.jsx("form",{onSubmit:Xe,className:"print:hidden",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice #"}),e.jsx("input",{className:"input bg-gray-50",value:q.invoice_no,onChange:Ae=>be("invoice_no",Ae.target.value),placeholder:"Auto-generated",readOnly:!r&&!q.invoice_no,disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice Date *"}),e.jsx("input",{className:"input",type:"date",value:q.invoice_date,onChange:Ae=>be("invoice_date",Ae.target.value),required:!0,disabled:u})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer *"}),e.jsxs("select",{className:"input",value:q.customer_id,onChange:Ae=>be("customer_id",Ae.target.value),required:!0,disabled:u,children:[e.jsx("option",{value:"",children:"Select Customer"}),g.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.customer_name},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:q.warehouse_id,onChange:Ae=>be("warehouse_id",Ae.target.value),required:!0,disabled:u,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),S.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.warehouse_code," - ",Ae.warehouse_name]},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sales Order"}),e.jsxs("select",{className:"input",value:q.sales_order_id,onChange:Ae=>be("sales_order_id",Ae.target.value),disabled:u,children:[e.jsx("option",{value:"",children:"Select Sales Order (Optional)"}),j.map(Ae=>e.jsx("option",{value:Ae.id,children:Ae.order_no},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsxs("select",{className:"input",value:q.price_type,onChange:Ae=>be("price_type",Ae.target.value),disabled:u,children:[e.jsx("option",{value:"RETAIL",children:"Retail"}),e.jsx("option",{value:"WHOLESALE",children:"Wholesale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Type"}),e.jsxs("select",{className:"input",value:q.payment_type,onChange:Ae=>be("payment_type",Ae.target.value),disabled:u,children:[e.jsx("option",{value:"CASH",children:"Cash"}),e.jsx("option",{value:"CHEQUE",children:"Cheque"}),e.jsx("option",{value:"CREDIT",children:"Credit"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:q.currency_id,onChange:Ae=>be("currency_id",Ae.target.value),disabled:u,children:[e.jsx("option",{value:"",children:"Select Currency"}),P.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.code," - ",Ae.name]},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input bg-gray-50",value:q.city,onChange:Ae=>be("city",Ae.target.value),placeholder:"Auto",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input bg-gray-50",value:q.state,onChange:Ae=>be("state",Ae.target.value),placeholder:"Auto",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input bg-gray-50",value:q.country,onChange:Ae=>be("country",Ae.target.value),placeholder:"Auto",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{className:"input bg-gray-50",value:q.phone,onChange:Ae=>be("phone",Ae.target.value),placeholder:"Auto",readOnly:!0})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold",children:"Invoice Items"})}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-7 gap-3 mb-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Item *"}),e.jsxs("select",{name:"item_id",value:I.item_id,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select Item"}),b.map(Ae=>e.jsxs("option",{value:Ae.id,children:[Ae.item_code," - ",Ae.item_name]},Ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"UOM *"}),e.jsx("select",{name:"uom",value:I.uom||R,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:(Array.isArray(O)?O:[]).map(Ae=>e.jsx("option",{value:Ae.uom_code,children:Ae.uom_name?`${Ae.uom_name} (${Ae.uom_code})`:Ae.uom_code},Ae.id))}),(()=>{const Ae=b.find(lt=>String(lt.id)===String(I.item_id)),je=(Ae==null?void 0:Ae.uom)&&String(Ae.uom)||I.uom&&String(I.uom)||(R?String(R):""),We=String(I.uom||"");return We&&je&&We!==je&&String(I.item_id||"")?e.jsx("button",{type:"button",className:"mt-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>ne({open:!0,itemId:I.item_id,defaultUom:je,currentUom:We}),children:`number of ${We}`}):null})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Qty *"}),e.jsx("input",{type:"number",name:"qty",value:I.qty===""?"":I.qty,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"1",step:"1"})]}),e.jsx("div",{className:"flex items-end",children:(()=>{const Ae=b.find(rt=>String(rt.id)===String(I.item_id)),je=(Ae==null?void 0:Ae.uom)&&String(Ae.uom)||I.uom&&String(I.uom)||(R?String(R):""),We=(Array.isArray(te)?te:[]).filter(rt=>Number(rt.is_active)&&String(rt.to_uom)===je&&Number(rt.item_id)===Number(I.item_id)).map(rt=>String(rt.from_uom)),De=We[0]||"";return We.length>0&&De&&De!==je?e.jsx("button",{type:"button",className:"ml-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>ne({open:!0,itemId:I.item_id,defaultUom:je,currentUom:De,rowId:null}),children:`number of ${De}`}):null})()}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Available"}),e.jsx("input",{type:"text",value:q.warehouse_id?Number(I.available_qty||0).toFixed(2):"",className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg bg-gray-50",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Price *"}),e.jsx("input",{type:"number",name:"unit_price",value:I.unit_price===""?"":I.unit_price,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",step:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Disc %"}),e.jsx("input",{type:"number",name:"discount_percent",value:I.discount_percent===""?"":I.discount_percent,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",min:"0",max:"100",step:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tax"}),e.jsx("select",{name:"tax_type",value:I.tax_type,onChange:Te,className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#0E3646]",children:U.map(Ae=>e.jsx("option",{value:Ae.value,children:Ae.label},Ae.value))}),I.tax_rate!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Tax rate: ",Number(I.tax_rate).toFixed(2),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:!u&&e.jsxs("button",{type:"button",onClick:ue,className:"bg-[#0E3646] text-white px-4 py-2 rounded-lg hover:bg-[#092530] flex items-center gap-2 transition-colors text-sm",children:[e.jsx(xu,{className:"w-4 h-4"})," Add Item"]})})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"UOM"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Convert"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Available"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Price"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Disc%"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Net"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Remarks"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:M.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"px-4 py-8 text-center text-gray-500",children:"No items added yet"})}):M.map((Ae,je)=>{var We;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsxs("select",{className:"input w-full",value:Ae.item_id,onChange:De=>Ve(je,{item_id:Number(De.target.value)}),children:[e.jsx("option",{value:"",children:"Select Item"}),b.map(De=>e.jsxs("option",{value:De.id,children:[De.item_code," - ",De.item_name]},De.id))]}):Ae.item_name}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:tt(Ae.item_id)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("select",{className:"input w-full",value:Ae.uom||R,onChange:De=>Ve(je,{uom:De.target.value}),children:(Array.isArray(O)?O:[]).map(De=>e.jsx("option",{value:De.uom_code,children:De.uom_name?`${De.uom_name} (${De.uom_code})`:De.uom_code},De.id))}):Ae.uom||R}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"number",min:"0",step:"1",value:Ae.qty===""?"":Ae.qty,onChange:De=>Ve(je,{qty:De.target.value===""?"":Number(De.target.value)})}):Ae.qty}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:(()=>{const De=b.find(Qe=>String(Qe.id)===String(Ae.item_id)),lt=(De==null?void 0:De.uom)&&String(De.uom)||Ae.uom&&String(Ae.uom)||(R?String(R):""),rt=(Array.isArray(te)?te:[]).filter(Qe=>Number(Qe.is_active)&&String(Qe.to_uom)===lt&&Number(Qe.item_id)===Number(Ae.item_id)).map(Qe=>String(Qe.from_uom)),et=rt[0]||"";return rt.length>0&&et&&et!==lt?e.jsx("button",{type:"button",className:"px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>ne({open:!0,itemId:Ae.item_id,defaultUom:lt,currentUom:et,rowId:Ae.line_id}),children:`number of ${et}`}):null})()}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:q.warehouse_id?Number(Ae.available_qty||0).toFixed(2):""}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"number",step:"1",value:Ae.unit_price===""?"":Ae.unit_price,onChange:De=>Ve(je,{unit_price:De.target.value===""?"":Number(De.target.value)})}):parseFloat(Ae.unit_price).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"number",min:"0",max:"100",step:"1",value:Ae.discount_percent===""?"":Ae.discount_percent||0,onChange:De=>Ve(je,{discount_percent:De.target.value===""?"":Number(De.target.value)})}):parseFloat(Ae.discount_percent||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("select",{className:"input w-full",value:Ae.tax_type,onChange:De=>Ve(je,{tax_type:De.target.value}),children:U.map(De=>e.jsx("option",{value:De.value,children:De.label},De.value))}):((We=U.find(De=>String(De.value)===String(Ae.tax_type)))==null?void 0:We.label)||""}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Number(Ae.net||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:Number(Ae.taxAmt||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:Number(Ae.total||0).toFixed(2)}),e.jsx("td",{className:"px-4 py-3 text-gray-900",children:d?e.jsx("input",{className:"input w-full",type:"text",value:Ae.remarks||"",onChange:De=>Ve(je,{remarks:De.target.value})}):Ae.remarks||""}),e.jsx("td",{className:"px-4 py-3",children:d&&e.jsx("button",{type:"button",onClick:()=>Ze(Ae.line_id),className:"text-red-600 hover:text-red-900 transition-colors",children:"Discard"})})]},Ae.line_id)})}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:"7",className:"px-4 py-3 text-right font-semibold text-gray-700",children:"Totals:"}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:ze().sub.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:ze().tax.toFixed(2)}),e.jsx("td",{className:"px-4 py-3 font-bold text-gray-900",children:ze().total.toFixed(2)}),e.jsx("td",{})]})})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:ot().grossSub.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Total Discount:"}),e.jsx("span",{children:ot().discountTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{children:"Total Tax:"}),e.jsx("span",{children:ot().taxTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-slate-900",children:[e.jsx("span",{children:"Grand Total:"}),e.jsx("span",{children:ot().grand.toFixed(2)})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks / Notes"}),e.jsx("textarea",{className:"input",rows:3,value:q.remarks,onChange:Ae=>be("remarks",Ae.target.value),placeholder:"Additional notes or terms...",disabled:u})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/sales/invoices",className:"btn-success",children:"Cancel"}),!u&&e.jsx("button",{className:"btn-success",type:"submit",disabled:c,children:c?"Saving...":"Save Invoice"})]})]})})}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:k.logoUrl||qs,alt:k.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:k.name||"Company"}),k.address&&e.jsx("div",{children:k.address}),(k.city||k.state||k.country)&&e.jsx("div",{children:[k.city,k.state,k.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[k.phone&&e.jsx("span",{children:k.phone}),k.email&&e.jsx("span",{children:k.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Invoice"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",q.invoice_date||""]}),e.jsxs("div",{children:["Invoice #: ",q.invoice_no||""]}),e.jsxs("div",{children:["Customer:"," ",((ut=g.find(Ae=>String(Ae.id)===String(q.customer_id)))==null?void 0:ut.customer_name)||""]}),e.jsxs("div",{children:["City: ",q.city||""]}),e.jsxs("div",{children:["State: ",q.state||""]}),e.jsxs("div",{children:["Country: ",q.country||""]}),e.jsxs("div",{children:["Phone: ",q.phone||""]}),e.jsxs("div",{children:["Price Type: ",q.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",q.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((ft=P.find(Ae=>String(Ae.id)===String(q.currency_id)))==null?void 0:ft.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((mt=S.find(Ae=>String(Ae.id)===String(q.warehouse_id)))==null?void 0:mt.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",Q||""]})]})]}),e.jsx("div",{className:"mb-2 mx-auto",children:e.jsxs("table",{className:"quotation-table text-sm",children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:M.map(Ae=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ae.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.total||0).toFixed(2)})]},Ae.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:ot().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:ot().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:ot().netSub.toFixed(2)}),ot().components.map(Ae=>e.jsxs(Ts.Fragment,{children:[e.jsxs("div",{className:"px-2 py-1",children:[Ae.name," [",Ae.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ae.amount.toFixed(2)})]},Ae.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:ot().grand.toFixed(2)})]})})})]}),e.jsx("div",{className:"mt-6 text-center text-sm",children:"THANK YOU FOR YOUR BUSINESS!"})]}),e.jsxs("div",{ref:Y,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:k.logoUrl||qs,alt:k.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:k.name||"Company"}),k.address&&e.jsx("div",{children:k.address}),(k.city||k.state||k.country)&&e.jsx("div",{children:[k.city,k.state,k.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[k.phone&&e.jsx("span",{children:k.phone}),k.email&&e.jsx("span",{children:k.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Invoice"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",q.invoice_date||""]}),e.jsxs("div",{children:["Invoice #: ",q.invoice_no||""]}),e.jsxs("div",{children:["Customer:"," ",((pt=g.find(Ae=>String(Ae.id)===String(q.customer_id)))==null?void 0:pt.customer_name)||""]}),e.jsxs("div",{children:["City: ",q.city||""]}),e.jsxs("div",{children:["State: ",q.state||""]}),e.jsxs("div",{children:["Country: ",q.country||""]}),e.jsxs("div",{children:["Phone: ",q.phone||""]}),e.jsxs("div",{children:["Price Type: ",q.price_type||""]}),e.jsxs("div",{children:["Payment Type: ",q.payment_type||""]}),e.jsxs("div",{children:["Currency:"," ",((vt=P.find(Ae=>String(Ae.id)===String(q.currency_id)))==null?void 0:vt.code)||""]}),e.jsxs("div",{children:["Warehouse:"," ",((Ot=S.find(Ae=>String(Ae.id)===String(q.warehouse_id)))==null?void 0:Ot.warehouse_name)||""]}),e.jsxs("div",{children:["Prepared by: ",Q||""]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"quotation-table text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"35%"}}),e.jsx("col",{style:{width:"15%"}}),e.jsx("col",{style:{width:"25%"}}),e.jsx("col",{style:{width:"25%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:M.map(Ae=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Ae.item_name}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Ae.total||0).toFixed(2)})]},Ae.line_id))})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:ot().grossSub.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:ot().discountTotal.toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:ot().netSub.toFixed(2)}),ot().components.map(Ae=>e.jsxs("div",{className:"contents",children:[e.jsxs("div",{className:"px-2 py-1",children:[Ae.name," [",Ae.rate,"%]"]}),e.jsx("div",{className:"px-2 py-1 text-right",children:Ae.amount.toFixed(2)})]},Ae.name)),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:ot().grand.toFixed(2)})]})})})]})]}),e.jsx(sd,{open:X.open,itemId:X.itemId,defaultUom:X.defaultUom,currentUom:X.currentUom,onClose:()=>ne({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),onApply:Ae=>{const{converted_qty:je}=Ae||{},We=Number(je||0);X.rowId!=null?z(De=>De.map(lt=>String(lt.line_id)===String(X.rowId)?{...lt,qty:We,uom:X.defaultUom||lt.uom}:lt)):G(De=>({...De,qty:We,uom:X.defaultUom||De.uom}))}})]})}function zr(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function ZO(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Delivery Note</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; color: #0f172a; background: #fff; }
      .dn { font-size: 12px; }
      .dn table { border-collapse: collapse; width: 100%; }
      .dn th, .dn td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      .dn th { background: #f8fafc; text-align: left; }
      .dn .right { text-align: right; }
      .dn .center { text-align: center; }
      .dn-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 8px; }
      .dn-logo { min-width: 120px; max-width: 200px; }
      .dn-company { text-align: right; font-size: 11px; line-height: 1.35; }
      .dn-company .name { font-weight: 800; font-size: 14px; }
      .dn-titlebar { display: flex; align-items: center; gap: 10px; color: #0f172a; margin: 4px 0 10px; }
      .dn-titlebar .line { flex: 1; height: 1px; background: #0f172a; }
      .dn-titlebar .title { font-weight: 700; }
      .dn-details { width: 100%; margin-bottom: 10px; border: 1px solid #cbd5e1; }
      .dn-details td { border-color: #cbd5e1; }
      .dn-details .label { width: 32%; color: #475569; }
      .dn-details .label-wide { width: 40%; color: #475569; }
      .dn-cust { padding: 8px; }
      .dn-cust .row { display: flex; gap: 6px; margin: 2px 0; }
      .dn-cust .label { color: #475569; min-width: 110px; }
      .dn-cust .value { flex: 1; }
      .dn-items thead th { font-weight: 600; }
      .dn-footer a { color: inherit; text-decoration: underline; }
      .dn-sign { margin-top: 14px; }
      .dn-sign .line { border-bottom: 1px solid #0f172a; display: inline-block; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}function Q2(t){var i;const s=t.company||{},r=t.delivery||{},a=t.customer||{},n=Array.isArray(t.items)?t.items:[];return String(((i=t.totals)==null?void 0:i.total)||""),`
  <div class="dn">
  <div class="dn-header">
    <div class="dn-logo">${s.logoHtml||""}</div>
    <div class="dn-company">
      <div class="name">${zr(s.name||"")}</div>
      <div>${zr(s.address||"")}</div>
      <div>${zr([s.city,s.state,s.country].filter(Boolean).join(", "))} ${zr(s.postalCode||"")}</div>
      <div>Telephone: ${zr(s.phone||"")}</div>
      <div>Email: ${zr(s.email||"")}</div>
      <div>${zr(s.website||"")}</div>
      <div>TIN: ${zr(s.taxId||"")} &nbsp; Reg: ${zr(s.registrationNo||"")}</div>
    </div>
  </div>
  <div class="dn-titlebar">
    <div class="line"></div>
    <div class="title">* Delivery Note *</div>
    <div class="line"></div>
  </div>
  <table class="dn-details">
    <tr>
      <td style="width:50%;vertical-align:top;border-right:1px solid #cbd5e1;">
        <div class="dn-cust">
          <div class="row"><div class="label">Customer Name</div><div class="value">: ${zr(a.name||"")}</div></div>
          <div class="row"><div class="label">Address</div><div class="value">: ${zr(a.address||"")}</div></div>
          <div class="row"><div class="label">City</div><div class="value">: ${zr(a.city||"")}</div></div>
          <div class="row"><div class="label">State</div><div class="value">: ${zr(a.state||"")}</div></div>
          <div class="row"><div class="label">Country</div><div class="value">: ${zr(a.country||"")}</div></div>
        </div>
      </td>
      <td style="width:50%;vertical-align:top;">
        <table style="width:100%;">
          <tr><td class="label-wide">Delivery No</td><td>:</td><td>${zr(r.delivery_no||"")}</td></tr>
          <tr><td class="label-wide">Delivery Date</td><td>:</td><td>${zr(r.delivery_date||"")}</td></tr>
          <tr><td class="label-wide">Order No</td><td>:</td><td>${zr(r.order_no||"")}</td></tr>
          <tr><td class="label-wide">Order Date</td><td>:</td><td>${zr(r.order_date||"")}</td></tr>
          <tr><td class="label-wide">Del Method</td><td>:</td><td>${zr(r.delivery_method||"")}</td></tr>
          <tr><td class="label-wide">Our Ref</td><td>:</td><td>${zr(r.our_ref||"")}</td></tr>
        </table>
      </td>
    </tr>
  </table>
  <table class="dn-items">
    <thead>
      <tr>
        <th style="width:6%;">Sr No.</th>
        <th style="width:16%;">Product Code</th>
        <th>Product Description</th>
        <th class="right" style="width:18%;">Quantity Unit</th>
      </tr>
    </thead>
    <tbody>
      ${n.map((l,o)=>`
        <tr>
          <td class="center">${String(o+1)}</td>
          <td>${zr(l.item_code||"")}</td>
          <td>${zr(l.item_name||"")}</td>
          <td class="right">${zr(l.qty_display||l.qty||"")}</td>
        </tr>
      `).join("")}
      <tr>
        <td colspan="3" class="right"><strong>Total Quantity</strong></td>
        <td class="right"><strong>${zr(n.reduce((l,o)=>l+Number(o.qty||0),0).toFixed(2))}</strong></td>
      </tr>
    </tbody>
  </table>
  <div class="dn-footer" style="margin-top:10px;">
    <table style="width:100%;">
      <tr><td style="width:20%;">Item Count</td><td>:</td><td>${String(n.length)}</td></tr>
      <tr><td>Vehicle No</td><td>:</td><td>${zr(r.vehicle_no||"")}</td></tr>
      <tr><td>DRIVER NAME AND SIGN</td><td>:</td><td></td></tr>
      <tr><td>WAY BILL NO & CARRIER</td><td>:</td><td>${zr(r.waybill_no||"")}</td></tr>
      <tr><td>GOODS ISSUED BY (SIGN)</td><td>:</td><td></td></tr>
    </table>
  </div>
  <div class="dn-sign">
    <div style="text-align:right;">
      <span class="line">All above goods received in good order and condition</span>
    </div>
    <div style="height:40px;"></div>
    <div style="text-align:right;">
      <span class="line">Signature with Company's Rubber Stamp</span>
    </div>
  </div>
  </div>
  `}async function eQ(t){const s=Array.from(t.querySelectorAll("img"));s.length&&await Promise.all(s.map(r=>new Promise(a=>{if(r.complete)return a();const n=()=>a();r.addEventListener("load",n,{once:!0}),r.addEventListener("error",n,{once:!0})})))}function tQ(){const t=ys(),[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(""),[o,u]=x.useState(""),[d,c]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",postalCode:"",website:"",taxId:"",registrationNo:"",logoUrl:""});x.useEffect(()=>{h()},[]),x.useEffect(()=>{let S=!0;async function B(){var P,L,U;try{const q=(L=(P=(await ee.get("/admin/me")).data)==null?void 0:P.scope)==null?void 0:L.companyId;if(!q){if(!S)return;c(z=>({...z,logoUrl:z.logoUrl||qs}));return}const M=((U=(await ee.get(`/admin/companies/${q}`)).data)==null?void 0:U.item)||{};if(!S)return;c(z=>({...z,name:M.name||z.name||"",address:M.address||z.address||"",phone:M.telephone||z.phone||"",email:M.email||z.email||"",city:M.city||z.city||"",state:M.state||z.state||"",country:M.country||z.country||"",postalCode:M.postal_code||z.postalCode||"",website:M.website||z.website||"",taxId:M.tax_id||z.taxId||"",registrationNo:M.registration_no||z.registrationNo||"",logoUrl:M.has_logo===1||M.has_logo===!0?`/api/admin/companies/${q}/logo`:z.logoUrl||qs}))}catch{if(!S)return;c(H=>({...H,logoUrl:H.logoUrl||qs}))}}return B(),()=>{S=!1}},[]);const h=async()=>{var S,B,P;try{n(!0),l("");const L=await ee.get("/sales/deliveries");r(Array.isArray((S=L.data)==null?void 0:S.items)?L.data.items:[])}catch(L){l(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Error fetching deliveries"),console.error("Error fetching deliveries:",L)}finally{n(!1)}},A=s.filter(S=>{const B=o.trim().toLowerCase();return!B||String(S.delivery_no).toLowerCase().includes(B)||String(S.customer_name).toLowerCase().includes(B)});async function f(S){var V,M;await v();const B=await ee.get(`/sales/deliveries/${S}`),P=((V=B.data)==null?void 0:V.item)||{},L=Array.isArray((M=B.data)==null?void 0:M.details)?B.data.details:[],U=await b(P)||await g(P.customer_id)||null,H=y(P,L,U),q=Q2(H);return ZO(q)}async function g(S){var B;try{const P=Number(S),L=await ee.get("/sales/customers"),U=Array.isArray((B=L.data)==null?void 0:B.items)?L.data.items:[];if(Number.isFinite(P)){const H=U.find(q=>Number(q.id)===P)||null;if(H)return H}return null}catch{return null}}async function v(){var S,B,P;try{if(!(!String(d.name||"").trim()||!String(d.address||"").trim()||!String(d.phone||"").trim()||!String(d.email||"").trim()))return;const H=(B=(S=(await ee.get("/admin/me")).data)==null?void 0:S.scope)==null?void 0:B.companyId;if(!H)return;const V=((P=(await ee.get(`/admin/companies/${H}`)).data)==null?void 0:P.item)||{};c(M=>({...M,name:V.name||M.name||"",address:V.address||M.address||"",phone:V.telephone||M.phone||"",email:V.email||M.email||"",city:V.city||M.city||"",state:V.state||M.state||"",country:V.country||M.country||"",postalCode:V.postal_code||M.postalCode||"",website:V.website||M.website||"",taxId:V.tax_id||M.taxId||"",registrationNo:V.registration_no||M.registrationNo||"",logoUrl:V.has_logo===1||V.has_logo===!0?`/api/admin/companies/${H}/logo`:M.logoUrl||qs}))}catch{}}async function b(S){var B;try{const P=await ee.get("/sales/customers"),L=Array.isArray((B=P.data)==null?void 0:B.items)?P.data.items:[],U=Number(S.customer_id);if(Number.isFinite(U)){const q=L.find(V=>Number(V.id)===U)||null;if(q)return q}const H=String(S.customer_name||"").trim().toLowerCase();if(H){const q=L.find(V=>String(V.customer_name||"").trim().toLowerCase()===H)||null;if(q)return q}return null}catch{return null}}const y=(S,B,P)=>{const L=String(d.logoUrl||"").trim(),U=L?`<img src="${L}" alt="${zr(d.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",H=(Array.isArray(B)?B:[]).map((M,z)=>{const I=Number(M.quantity||M.qty||0),G=Number(M.unit_price||0),Y=I*G;return{sr_no:z+1,item_code:String(M.item_code||M.item_id||""),item_name:String(M.item_name||M.item_code||M.item_id||""),qty:I.toFixed(2),qty_display:[I.toFixed(2),String(M.uom||"").trim()].filter(Boolean).join(" "),unit_price:G.toFixed(2),total:Y.toFixed(2)}}),q=H.reduce((M,z)=>M+Number(z.total||0),0),V=H.reduce((M,z)=>M+Number(z.qty||0),0);return{company:{name:d.name||"Company",address:d.address||"",city:d.city||"",state:d.state||"",country:d.country||"",postalCode:d.postalCode||"",phone:d.phone||"",email:d.email||"",website:d.website||"",taxId:d.taxId||"",registrationNo:d.registrationNo||"",logoUrl:L,logoHtml:U},delivery:{delivery_no:String(S.delivery_no||""),delivery_date:S.delivery_date?String(S.delivery_date).slice(0,10):"",order_no:String(S.order_no||""),order_date:S.order_date?String(S.order_date).slice(0,10):"",delivery_method:String(S.delivery_method||""),our_ref:String(S.our_ref||""),vehicle_no:String(S.vehicle_no||""),waybill_no:String(S.waybill_no||"")},customer:{id:String((P&&P.id)??S.customer_id??""),code:String((P&&P.customer_code)??S.customer_code??""),name:String((P&&P.customer_name)??S.customer_name??""),type:String((P&&P.customer_type)??S.customer_type??""),contactPerson:String((P&&P.contact_person)??S.contact_person??""),email:String((P&&P.email)??S.email??""),phone:String((P&&P.phone)??S.phone??""),mobile:String((P&&P.mobile)??S.mobile??""),address:String((P&&P.address)??S.address??""),city:String((P&&P.city)??S.city??""),state:String((P&&P.state)??S.state??""),zone:String((P&&P.zone)??S.zone??""),country:String((P&&P.country)??S.country??""),paymentTerms:String((P&&P.payment_terms)??S.payment_terms??""),creditLimit:Number((P&&P.credit_limit)??S.credit_limit??0).toFixed(2),priceTypeName:String((P&&P.price_type_name)??""),currencyId:String((P&&P.currency_id)??"")},items:H,totals:{total:q.toFixed(2),total_qty:V.toFixed(2)}}};async function j(S){var B,P,L;try{l("");const U=await f(S),H=document.createElement("iframe");H.style.position="fixed",H.style.right="0",H.style.bottom="0",H.style.width="0",H.style.height="0",H.style.border="0",document.body.appendChild(H);const q=((B=H.contentWindow)==null?void 0:B.document)||H.contentDocument||null;if(!q){document.body.removeChild(H);return}q.open(),q.write(U),q.close();const V=H.contentWindow||window;setTimeout(()=>{V.focus();try{V.print()}catch{}setTimeout(()=>{document.body.removeChild(H)},100)},200)}catch(U){l(((L=(P=U==null?void 0:U.response)==null?void 0:P.data)==null?void 0:L.message)||"Failed to print delivery"),console.error(U)}}async function N(S){var B,P,L,U;try{l("");const H=await ee.get(`/sales/deliveries/${S}`),q=((B=H.data)==null?void 0:B.item)||{},V=Array.isArray((P=H.data)==null?void 0:P.details)?H.data.details:[],M=await b(q)||await g(q.customer_id)||null,z=y(q,V,M),I=Q2(z),G=document.createElement("div");G.style.position="fixed",G.style.left="-10000px",G.style.top="0",G.style.width="794px",G.style.background="white",G.style.padding="32px",G.innerHTML=I,document.body.appendChild(G);try{await eQ(G);const Y=await Ai(G,{scale:2,useCORS:!0}),J=Y.toDataURL("image/png"),T=new ds("p","mm","a4"),k=T.internal.pageSize.getWidth(),D=T.internal.pageSize.getHeight(),Q=k,C=Y.height*Q/Y.width;let E=0;for(;E<C;)T.addImage(J,"PNG",0,-E,Q,C),E+=D,E<C&&T.addPage();const w=String(q.delivery_no||"DN").replaceAll(" ","_");T.save(`delivery-${w}.pdf`)}finally{document.body.removeChild(G)}}catch(H){l(((U=(L=H==null?void 0:H.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to download delivery"),console.error(H)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Delivery Notes"}),e.jsx("p",{className:"text-sm mt-1",children:"Track deliveries issued for sales orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/sales/delivery/new",className:"btn-success",children:"+ New Delivery"})]})]})})}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"flex gap-4 mb-6",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"input",placeholder:"Search delivery no or customer...",value:o,onChange:S=>u(S.target.value)})})}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading deliveries..."})]}):A.length===0?e.jsx("div",{className:"text-center py-12",children:"No deliveries found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Delivery No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:A.map(S=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:S.delivery_no}),e.jsx("td",{children:new Date(S.delivery_date).toLocaleDateString()}),e.jsx("td",{children:S.customer_name}),e.jsx("td",{children:S.status}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-brand hover:text-brand-600 font-medium text-sm",onClick:()=>t(`/sales/delivery/${S.id}`),children:"View"}),e.jsxs("button",{type:"button",className:"ml-2 btn-primary text-xs px-3 py-1.5 gap-1",onClick:()=>j(S.id),children:[e.jsx(Wy,{className:"w-4 h-4"}),"Print"]}),e.jsxs("button",{type:"button",className:"ml-1 btn-outline text-xs px-3 py-1.5 gap-1",onClick:()=>N(S.id),children:[e.jsx(Yc,{className:"w-4 h-4"}),"Download"]}),String(S.status||"").toUpperCase()!=="DELIVERED"&&e.jsx("button",{className:"text-blue-600 hover:text-blue-700 font-medium text-sm",onClick:()=>t(`/sales/delivery/${S.id}`),children:"Edit"})]})})]},S.id))})]})})]})})]})}function M2(){const t=ys(),{id:s}=Ls(),r=!!s,{scope:a}=ca(),[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState(null),[c,h]=x.useState(null),[A,f]=x.useState([]),[g,v]=x.useState({delivery_no:"",delivery_date:new Date().toISOString().split("T")[0],customer_id:"",sales_order_id:"",invoice_id:"",status:"DRAFT",remarks:"",items:[]}),[b,y]=x.useState(""),[j,N]=x.useState([]),[S,B]=x.useState([]),[P,L]=x.useState([]);x.useEffect(()=>{U(),H(),q(),M(),r?z(s):(async()=>{try{const J=await V();v(T=>({...T,delivery_no:J}))}catch{v(J=>({...J,delivery_no:"DN-000001"}))}})()},[s]);async function U(){try{const J=await ee.get("/sales/customers");N(J.data.items||[])}catch(J){console.error("Failed to load customers",J)}}async function H(){var J,T;try{const[k,D]=await Promise.all([ee.get("/sales/invoices"),ee.get("/sales/deliveries")]),Q=Array.isArray((J=k.data)==null?void 0:J.items)?k.data.items:[],C=Array.isArray((T=D.data)==null?void 0:T.items)?D.data.items:[],E=new Set(C.map(R=>R==null?void 0:R.invoice_id).filter(R=>R!=null).map(R=>String(R))),w=new Set(C.map(R=>R==null?void 0:R.sales_order_id).filter(R=>R!=null).map(R=>String(R)));let O=Q;E.size>0?O=O.filter(R=>!E.has(String(R.id))):O=O.filter(R=>!w.has(String(R.sales_order_id))),B(O)}catch(k){console.error("Failed to load invoices",k)}}async function q(){var J;try{const T=await ee.get("/inventory/items");L(Array.isArray((J=T.data)==null?void 0:J.items)?T.data.items:[])}catch(T){console.error("Failed to load items",T)}}async function V(){var J;try{return((J=(await ee.get("/sales/deliveries/next-no")).data)==null?void 0:J.nextNo)||""||"DN-000001"}catch(T){return console.error("Failed to fetch deliveries for next no",T),"DN-000001"}}const M=async()=>{var J;try{const T=await ee.get("/finance/tax-codes"),D=(Array.isArray((J=T.data)==null?void 0:J.items)?T.data.items:[]).map(Q=>({value:Q.id,label:Q.name,rate:Number(Q.rate_percent)}));f(D)}catch(T){console.error("Error fetching tax codes:",T)}};async function z(J){var T,k;try{i(!0);const D=await ee.get(`/sales/deliveries/${J}`),Q=((T=D.data)==null?void 0:T.item)||{},C=Array.isArray((k=D.data)==null?void 0:k.details)?D.data.details:[];v(E=>({...E,delivery_no:Q.delivery_no||E.delivery_no,delivery_date:(Q.delivery_date?String(Q.delivery_date).slice(0,10):E.delivery_date)||E.delivery_date,customer_id:Q.customer_id||"",sales_order_id:Q.sales_order_id||"",invoice_id:Q.invoice_id||"",status:Q.status||E.status,remarks:Q.remarks||"",items:C.map(w=>({item_id:w.item_id,item_name:w.item_name||"",quantity:Number(w.quantity||0),ordered_qty:Number(w.quantity||0),tax_type:w.tax_id||"",uom:w.uom||"PCS",unit_price:Number(w.unit_price||0)}))})),i(!1)}catch{d("Failed to load delivery"),i(!1)}}async function I(J){if(J)try{i(!0);const T=S.find(k=>String(k.id)===String(J));if(T){T.sales_order_id||console.warn("This invoice is not linked to a sales order.");let k=null,D=[];if(T.sales_order_id){const C=await ee.get(`/sales/orders/${T.sales_order_id}`);k=C.data.item,D=C.data.details}const Q=D.length>0?D:[];v(C=>({...C,customer_id:T.customer_id,sales_order_id:T.sales_order_id||"",invoice_id:T.id||"",items:Q.map(E=>{var w;return{item_id:E.item_id,item_name:E.item_name||((w=P.find(O=>String(O.id)===String(E.item_id)))==null?void 0:w.item_name)||"",quantity:E.quantity,ordered_qty:E.quantity,tax_type:E.tax_id||(A.length>0?A[0].value:""),uom:E.uom||"PCS",unit_price:Number(E.unit_price||0)}})})),y(k?k.order_no:""),h(`Loaded from Invoice ${T.invoice_no}`)}}catch(T){console.error(T),alert("Error loading invoice details")}finally{i(!1)}}async function G(J){if(J.preventDefault(),!g.customer_id){alert("Please select a customer");return}try{o(!0);const T={...g,company_id:a==null?void 0:a.companyId,branch_id:a==null?void 0:a.branchId,invoice_id:g.invoice_id||void 0,items:g.items.map(k=>{const D=A.find(Q=>Q.value==k.tax_type);return{item_id:k.item_id,quantity:Number(k.quantity),tax_id:k.tax_type,tax_rate:D?D.rate:0,tax_amount:0}})};r?await ee.put(`/sales/deliveries/${s}`,T):await ee.post("/sales/deliveries",T),h("Delivery saved successfully"),setTimeout(()=>t("/sales/delivery"),1500)}catch(T){d("Failed to save delivery"),console.error(T)}finally{o(!1)}}function Y(J){r&&s?(async()=>{try{await ee.put(`/sales/deliveries/${s}/status`,{status:J}),v(T=>({...T,status:J})),h(`Status updated to ${J}`)}catch(T){d("Failed to update status"),console.error(T)}})():v(T=>({...T,status:J}))}return n&&!g.customer_id?e.jsx("div",{className:"p-8",children:"Loading..."}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>t(-1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(Uf,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-2xl font-bold",children:r?"Edit Delivery":"New Delivery"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>Y("DELIVERED"),disabled:!r||l||String(g.status||"").toUpperCase()==="DELIVERED",className:"btn-success flex items-center gap-2",children:[e.jsx(rI,{className:"w-4 h-4"}),"Auto Delivery"]}),e.jsxs("button",{onClick:G,disabled:l,className:"btn-primary flex items-center gap-2",children:[e.jsx(Vh,{className:"w-4 h-4"}),"Save Delivery"]})]})]}),u&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded mb-6",children:u}),c&&e.jsx("div",{className:"bg-green-50 text-green-600 p-4 rounded mb-6",children:c}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Delivery Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery No"}),e.jsx("input",{type:"text",value:g.delivery_no,onChange:J=>v({...g,delivery_no:J.target.value}),className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:g.delivery_date,onChange:J=>v({...g,delivery_date:J.target.value}),className:"w-full border rounded p-2"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Customer"}),e.jsxs("select",{id:"customer",value:g.customer_id,onChange:J=>v({...g,customer_id:J.target.value}),className:"w-full border rounded p-2",children:[e.jsx("option",{value:"",children:"Select Customer"}),j.map(J=>e.jsx("option",{value:J.id,children:J.customer_name},J.id))]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Load Items"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded border col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Invoice"}),e.jsxs("select",{className:"w-full border rounded p-2",onChange:J=>I(J.target.value),defaultValue:"",children:[e.jsx("option",{value:"",disabled:!0,children:"Select an Invoice..."}),S.map(J=>e.jsxs("option",{value:J.id,children:[J.invoice_no," -"," ",new Date(J.invoice_date).toLocaleDateString()," (",J.total_amount,")"]},J.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecting an invoice will populate customer and order details."})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded border col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sales Order Number"}),e.jsx("input",{type:"text",placeholder:"Sales Order No",value:b,readOnly:!0,className:"w-full border rounded p-2 bg-gray-100 text-gray-500 cursor-not-allowed"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Item"}),e.jsx("th",{className:"p-3 w-28",children:"Ordered"}),e.jsx("th",{className:"p-3 w-28",children:"To Deliver"}),e.jsx("th",{className:"p-3 w-20",children:"UOM"}),e.jsx("th",{className:"p-3 w-28",children:"Unit Price"}),e.jsx("th",{className:"p-3 w-40",children:"Tax"}),e.jsx("th",{className:"p-3 w-12",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:g.items.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-500",children:"No items loaded. Search for an order or invoice."})}):g.items.map((J,T)=>{var k;return e.jsxs("tr",{children:[e.jsx("td",{className:"p-3",children:J.item_name||((k=P.find(D=>String(D.id)===String(J.item_id)))==null?void 0:k.item_name)||""}),e.jsx("td",{className:"p-3",children:J.ordered_qty}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:J.quantity,onChange:D=>{const Q=[...g.items];Q[T].quantity=parseFloat(D.target.value)||0,v({...g,items:Q})},className:"w-full border rounded p-1"})}),e.jsx("td",{className:"p-3",children:J.uom||"PCS"}),e.jsx("td",{className:"p-3",children:Number(J.unit_price||0).toFixed(2)}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:J.tax_type||"",onChange:D=>{const Q=[...g.items];Q[T].tax_type=D.target.value,v({...g,items:Q})},className:"w-full border rounded p-1",children:[e.jsx("option",{value:"",children:"None"}),A.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))]})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>{const D=g.items.filter((Q,C)=>C!==T);v({...g,items:D})},className:"text-red-500 hover:text-red-700",children:""})})]},T)})})]})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Shipping Info"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{value:g.remarks,onChange:J=>v({...g,remarks:J.target.value}),rows:"4",className:"w-full border rounded p-2"})]})})]})})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var l0={};l0.version="0.18.5";var C4=1252,sQ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dj={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},uj=function(t){sQ.indexOf(t)!=-1&&(C4=dj[0]=t)};function rQ(){uj(1252)}var Co=function(t){uj(t)};function Aj(){Co(1200),rQ()}function H2(t){for(var s=[],r=0,a=t.length;r<a;++r)s[r]=t.charCodeAt(r);return s}function aQ(t){for(var s=[],r=0;r<t.length>>1;++r)s[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return s.join("")}function k4(t){for(var s=[],r=0;r<t.length>>1;++r)s[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return s.join("")}var Um=function(t){var s=t.charCodeAt(0),r=t.charCodeAt(1);return s==255&&r==254?aQ(t.slice(2)):s==254&&r==255?k4(t.slice(2)):s==65279?t.slice(1):t},cx=function(s){return String.fromCharCode(s)},q2=function(s){return String.fromCharCode(s)},ff,ru="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function pf(t){for(var s="",r=0,a=0,n=0,i=0,l=0,o=0,u=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,a=t.charCodeAt(d++),l=(r&3)<<4|a>>4,n=t.charCodeAt(d++),o=(a&15)<<2|n>>6,u=n&63,isNaN(a)?o=u=64:isNaN(n)&&(u=64),s+=ru.charAt(i)+ru.charAt(l)+ru.charAt(o)+ru.charAt(u);return s}function gl(t){var s="",r=0,a=0,n=0,i=0,l=0,o=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=ru.indexOf(t.charAt(d++)),l=ru.indexOf(t.charAt(d++)),r=i<<2|l>>4,s+=String.fromCharCode(r),o=ru.indexOf(t.charAt(d++)),a=(l&15)<<4|o>>2,o!==64&&(s+=String.fromCharCode(a)),u=ru.indexOf(t.charAt(d++)),n=(o&3)<<6|u,u!==64&&(s+=String.fromCharCode(n));return s}var ir=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),rd=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(s,r){return r?new Buffer(s,r):new Buffer(s)}:Buffer.from.bind(Buffer)}return function(){}})();function Au(t){return ir?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function V2(t){return ir?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Al=function(s){return ir?rd(s,"binary"):s.split("").map(function(r){return r.charCodeAt(0)&255})};function tg(t){if(typeof ArrayBuffer>"u")return Al(t);for(var s=new ArrayBuffer(t.length),r=new Uint8Array(s),a=0;a!=t.length;++a)r[a]=t.charCodeAt(a)&255;return s}function gu(t){if(Array.isArray(t))return t.map(function(a){return String.fromCharCode(a)}).join("");for(var s=[],r=0;r<t.length;++r)s[r]=String.fromCharCode(t[r]);return s.join("")}function nQ(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function hj(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return hj(new Uint8Array(t));for(var s=new Array(t.length),r=0;r<t.length;++r)s[r]=t[r];return s}var wn=ir?function(t){return Buffer.concat(t.map(function(s){return Buffer.isBuffer(s)?s:rd(s)}))}:function(t){if(typeof Uint8Array<"u"){var s=0,r=0;for(s=0;s<t.length;++s)r+=t[s].length;var a=new Uint8Array(r),n=0;for(s=0,r=0;s<t.length;r+=n,++s)if(n=t[s].length,t[s]instanceof Uint8Array)a.set(t[s],r);else{if(typeof t[s]=="string")throw"wtf";a.set(new Uint8Array(t[s]),r)}return a}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function iQ(t){for(var s=[],r=0,a=t.length+250,n=Au(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)n[r++]=l;else if(l<2048)n[r++]=192|l>>6&31,n[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var o=t.charCodeAt(++i)&1023;n[r++]=240|l>>8&7,n[r++]=128|l>>2&63,n[r++]=128|o>>6&15|(l&3)<<4,n[r++]=128|o&63}else n[r++]=224|l>>12&15,n[r++]=128|l>>6&63,n[r++]=128|l&63;r>a&&(s.push(n.slice(0,r)),r=0,n=Au(65535),a=65530)}return s.push(n.slice(0,r)),wn(s)}var Ti=/\u0000/g,Pm=/[\u0001-\u0006]/g;function Sh(t){for(var s="",r=t.length-1;r>=0;)s+=t.charAt(r--);return s}function ko(t,s){var r=""+t;return r.length>=s?r:Ca("0",s-r.length)+r}function mj(t,s){var r=""+t;return r.length>=s?r:Ca(" ",s-r.length)+r}function o0(t,s){var r=""+t;return r.length>=s?r:r+Ca(" ",s-r.length)}function lQ(t,s){var r=""+Math.round(t);return r.length>=s?r:Ca("0",s-r.length)+r}function oQ(t,s){var r=""+t;return r.length>=s?r:Ca("0",s-r.length)+r}var $2=Math.pow(2,32);function lh(t,s){if(t>$2||t<-$2)return lQ(t,s);var r=Math.round(t);return oQ(r,s)}function c0(t,s){return s=s||0,t.length>=7+s&&(t.charCodeAt(s)|32)===103&&(t.charCodeAt(s+1)|32)===101&&(t.charCodeAt(s+2)|32)===110&&(t.charCodeAt(s+3)|32)===101&&(t.charCodeAt(s+4)|32)===114&&(t.charCodeAt(s+5)|32)===97&&(t.charCodeAt(s+6)|32)===108}var W2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function cQ(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Hs={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},G2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},dQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function d0(t,s,r){for(var a=t<0?-1:1,n=t*a,i=0,l=1,o=0,u=1,d=0,c=0,h=Math.floor(n);d<s&&(h=Math.floor(n),o=h*l+i,c=h*d+u,!(n-h<5e-8));)n=1/(n-h),i=l,l=o,u=d,d=c;if(c>s&&(d>s?(c=u,o=i):(c=d,o=l)),!r)return[0,a*o,c];var A=Math.floor(a*o/c);return[A,a*o-A*c,c]}function rA(t,s,r){if(t>2958465||t<0)return null;var a=t|0,n=Math.floor(86400*(t-a)),i=0,l=[],o={D:a,T:n,u:86400*(t-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),s&&s.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++n==86400&&(o.T=n=0,++a,++o.D)),a===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),l=[u.getFullYear(),u.getMonth()+1,u.getDate()],i=u.getDay(),a<60&&(i=(i+6)%7),r&&(i=pQ(u,l))}return o.y=l[0],o.m=l[1],o.d=l[2],o.S=n%60,n=Math.floor(n/60),o.M=n%60,n=Math.floor(n/60),o.H=n,o.q=i,o}var B4=new Date(1899,11,31,0,0,0),uQ=B4.getTime(),AQ=new Date(1900,2,1,0,0,0);function E4(t,s){var r=t.getTime();return s?r-=1461*24*60*60*1e3:t>=AQ&&(r+=1440*60*1e3),(r-(uQ+(t.getTimezoneOffset()-B4.getTimezoneOffset())*6e4))/(1440*60*1e3)}function fj(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hQ(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function mQ(t){var s=t<0?12:11,r=fj(t.toFixed(12));return r.length<=s||(r=t.toPrecision(10),r.length<=s)?r:t.toExponential(5)}function fQ(t){var s=fj(t.toFixed(11));return s.length>(t<0?12:11)||s==="0"||s==="-0"?t.toPrecision(6):s}function xf(t){var s=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return s>=-4&&s<=-1?r=t.toPrecision(10+s):Math.abs(s)<=9?r=mQ(t):s===10?r=t.toFixed(10).substr(0,12):r=fQ(t),fj(hQ(r.toUpperCase()))}function fA(t,s){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):xf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Wl(14,E4(t,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+t)}function pQ(t,s){s[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function xQ(t,s,r,a){var n="",i=0,l=0,o=r.y,u,d=0;switch(t){case 98:o=r.y+543;case 121:switch(s.length){case 1:case 2:u=o%100,d=2;break;default:u=o%1e4,d=4;break}break;case 109:switch(s.length){case 1:case 2:u=r.m,d=s.length;break;case 3:return Yv[r.m-1][1];case 5:return Yv[r.m-1][0];default:return Yv[r.m-1][2]}break;case 100:switch(s.length){case 1:case 2:u=r.d,d=s.length;break;case 3:return W2[r.q][0];default:return W2[r.q][1]}break;case 104:switch(s.length){case 1:case 2:u=1+(r.H+11)%12,d=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:u=r.H,d=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:u=r.M,d=s.length;break;default:throw"bad minute format: "+s}break;case 115:if(s!="s"&&s!="ss"&&s!=".0"&&s!=".00"&&s!=".000")throw"bad second format: "+s;return r.u===0&&(s=="s"||s=="ss")?ko(r.S,s.length):(a>=2?l=a===3?1e3:100:l=a===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),s==="s"?i===0?"0":""+i/l:(n=ko(i,2+a),s==="ss"?n.substr(0,2):"."+n.substr(2,s.length-1)));case 90:switch(s){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+s}d=s.length===3?1:2;break;case 101:u=o,d=1;break}var c=d>0?ko(u,d):"";return c}function au(t){var s=3;if(t.length<=s)return t;for(var r=t.length%s,a=t.substr(0,r);r!=t.length;r+=s)a+=(a.length>0?",":"")+t.substr(r,s);return a}var F4=/%/g;function gQ(t,s,r){var a=s.replace(F4,""),n=s.length-a.length;return Gc(t,a,r*Math.pow(10,2*n))+Ca("%",n)}function vQ(t,s,r){for(var a=s.length-1;s.charCodeAt(a-1)===44;)--a;return Gc(t,s.substr(0,a),r/Math.pow(10,3*(s.length-a)))}function T4(t,s){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+T4(t,-s);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(s)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(s/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var l=Math.floor(Math.log(s)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,d,c){return u+d+c.substr(0,(n+i)%n)+"."+c.substr(i)+"E"})}else r=s.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var I4=/# (\?+)( ?)\/( ?)(\d+)/;function bQ(t,s,r){var a=parseInt(t[4],10),n=Math.round(s*a),i=Math.floor(n/a),l=n-i*a,o=a;return r+(i===0?"":""+i)+" "+(l===0?Ca(" ",t[1].length+1+t[4].length):mj(l,t[1].length)+t[2]+"/"+t[3]+ko(o,t[4].length))}function yQ(t,s,r){return r+(s===0?"":""+s)+Ca(" ",t[1].length+2+t[4].length)}var L4=/^#*0*\.([0#]+)/,D4=/\).*[0#]/,U4=/\(###\) ###\\?-####/;function Bi(t){for(var s="",r,a=0;a!=t.length;++a)switch(r=t.charCodeAt(a)){case 35:break;case 63:s+=" ";break;case 48:s+="0";break;default:s+=String.fromCharCode(r)}return s}function K2(t,s){var r=Math.pow(10,s);return""+Math.round(t*r)/r}function z2(t,s){var r=t-Math.floor(t),a=Math.pow(10,s);return s<(""+Math.round(r*a)).length?0:Math.round(r*a)}function jQ(t,s){return s<(""+Math.round((t-Math.floor(t))*Math.pow(10,s))).length?1:0}function NQ(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Dl(t,s,r){if(t.charCodeAt(0)===40&&!s.match(D4)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Dl("n",a,r):"("+Dl("n",a,-r)+")"}if(s.charCodeAt(s.length-1)===44)return vQ(t,s,r);if(s.indexOf("%")!==-1)return gQ(t,s,r);if(s.indexOf("E")!==-1)return T4(s,r);if(s.charCodeAt(0)===36)return"$"+Dl(t,s.substr(s.charAt(1)==" "?2:1),r);var n,i,l,o,u=Math.abs(r),d=r<0?"-":"";if(s.match(/^00+$/))return d+lh(u,s.length);if(s.match(/^[#?]+$/))return n=lh(r,0),n==="0"&&(n=""),n.length>s.length?n:Bi(s.substr(0,s.length-n.length))+n;if(i=s.match(I4))return bQ(i,u,d);if(s.match(/^#+0+$/))return d+lh(u,s.length-s.indexOf("0"));if(i=s.match(L4))return n=K2(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Bi(i[1])).replace(/\.$/,"."+Bi(i[1])).replace(/\.(\d*)$/,function(g,v){return"."+v+Ca("0",Bi(i[1]).length-v.length)}),s.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),i=s.match(/^(0*)\.(#*)$/))return d+K2(u,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=s.match(/^#{1,3},##0(\.?)$/))return d+au(lh(u,0));if(i=s.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Dl(t,s,-r):au(""+(Math.floor(r)+jQ(r,i[1].length)))+"."+ko(z2(r,i[1].length),i[1].length);if(i=s.match(/^#,#*,#0/))return Dl(t,s.replace(/^#,#*,/,""),r);if(i=s.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Sh(Dl(t,s.replace(/[\\-]/g,""),r)),l=0,Sh(Sh(s.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<n.length?n.charAt(l++):g==="0"?"0":""}));if(s.match(U4))return n=Dl(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var c="";if(i=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=d0(u,Math.pow(10,l)-1,!1),n=""+d,c=Gc("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),n+=c+i[2]+"/"+i[3],c=o0(o[2],l),c.length<i[4].length&&(c=Bi(i[4].substr(i[4].length-c.length))+c),n+=c,n;if(i=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=d0(u,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?mj(o[1],l)+i[2]+"/"+i[3]+o0(o[2],l):Ca(" ",2*l+1+i[2].length+i[3].length));if(i=s.match(/^[#0?]+$/))return n=lh(r,0),s.length<=n.length?n:Bi(s.substr(0,s.length-n.length))+n;if(i=s.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var h=s.indexOf(".")-l,A=s.length-n.length-h;return Bi(s.substr(0,h)+n+s.substr(s.length-A))}if(i=s.match(/^00,000\.([#0]*0)$/))return l=z2(r,i[1].length),r<0?"-"+Dl(t,s,-r):au(NQ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ko(0,3-g.length):"")+g})+"."+ko(l,i[1].length);switch(s){case"###,##0.00":return Dl(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=au(lh(u,0));return f!=="0"?d+f:"";case"###,###.00":return Dl(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Dl(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+s+"|")}function wQ(t,s,r){for(var a=s.length-1;s.charCodeAt(a-1)===44;)--a;return Gc(t,s.substr(0,a),r/Math.pow(10,3*(s.length-a)))}function _Q(t,s,r){var a=s.replace(F4,""),n=s.length-a.length;return Gc(t,a,r*Math.pow(10,2*n))+Ca("%",n)}function P4(t,s){var r,a=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(s==0)return"0.0E+0";if(s<0)return"-"+P4(t,-s);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(s)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(s/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var l=Math.floor(Math.log(s)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,u,d,c){return u+d+c.substr(0,(n+i)%n)+"."+c.substr(i)+"E"})}else r=s.toExponential(a);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function rc(t,s,r){if(t.charCodeAt(0)===40&&!s.match(D4)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rc("n",a,r):"("+rc("n",a,-r)+")"}if(s.charCodeAt(s.length-1)===44)return wQ(t,s,r);if(s.indexOf("%")!==-1)return _Q(t,s,r);if(s.indexOf("E")!==-1)return P4(s,r);if(s.charCodeAt(0)===36)return"$"+rc(t,s.substr(s.charAt(1)==" "?2:1),r);var n,i,l,o,u=Math.abs(r),d=r<0?"-":"";if(s.match(/^00+$/))return d+ko(u,s.length);if(s.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>s.length?n:Bi(s.substr(0,s.length-n.length))+n;if(i=s.match(I4))return yQ(i,u,d);if(s.match(/^#+0+$/))return d+ko(u,s.length-s.indexOf("0"));if(i=s.match(L4))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Bi(i[1])).replace(/\.$/,"."+Bi(i[1])),n=n.replace(/\.(\d*)$/,function(g,v){return"."+v+Ca("0",Bi(i[1]).length-v.length)}),s.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),i=s.match(/^(0*)\.(#*)$/))return d+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=s.match(/^#{1,3},##0(\.?)$/))return d+au(""+u);if(i=s.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rc(t,s,-r):au(""+r)+"."+Ca("0",i[1].length);if(i=s.match(/^#,#*,#0/))return rc(t,s.replace(/^#,#*,/,""),r);if(i=s.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Sh(rc(t,s.replace(/[\\-]/g,""),r)),l=0,Sh(Sh(s.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<n.length?n.charAt(l++):g==="0"?"0":""}));if(s.match(U4))return n=rc(t,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var c="";if(i=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),o=d0(u,Math.pow(10,l)-1,!1),n=""+d,c=Gc("n",i[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),n+=c+i[2]+"/"+i[3],c=o0(o[2],l),c.length<i[4].length&&(c=Bi(i[4].substr(i[4].length-c.length))+c),n+=c,n;if(i=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),o=d0(u,Math.pow(10,l)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?mj(o[1],l)+i[2]+"/"+i[3]+o0(o[2],l):Ca(" ",2*l+1+i[2].length+i[3].length));if(i=s.match(/^[#0?]+$/))return n=""+r,s.length<=n.length?n:Bi(s.substr(0,s.length-n.length))+n;if(i=s.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=n.indexOf(".");var h=s.indexOf(".")-l,A=s.length-n.length-h;return Bi(s.substr(0,h)+n+s.substr(s.length-A))}if(i=s.match(/^00,000\.([#0]*0)$/))return r<0?"-"+rc(t,s,-r):au(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ko(0,3-g.length):"")+g})+"."+ko(0,i[1].length);switch(s){case"###,###":case"##,###":case"#,###":var f=au(""+u);return f!=="0"?d+f:"";default:if(s.match(/\.[0#?]*$/))return rc(t,s.slice(0,s.lastIndexOf(".")),r)+Bi(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}function Gc(t,s,r){return(r|0)===r?rc(t,s,r):Dl(t,s,r)}function SQ(t){for(var s=[],r=!1,a=0,n=0;a<t.length;++a)switch(t.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:s[s.length]=t.substr(n,a-n),n=a+1}if(s[s.length]=t.substr(n),r===!0)throw new Error("Format |"+t+"| unterminated string ");return s}var R4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wh(t){for(var s=0,r="",a="";s<t.length;)switch(r=t.charAt(s)){case"G":c0(t,s)&&(s+=6),s++;break;case'"':for(;t.charCodeAt(++s)!==34&&s<t.length;);++s;break;case"\\":s+=2;break;case"_":s+=2;break;case"@":++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(s,3).toUpperCase()==="A/P"||t.substr(s,5).toUpperCase()==="AM/PM"||t.substr(s,5).toUpperCase()==="/")return!0;++s;break;case"[":for(a=r;t.charAt(s++)!=="]"&&s<t.length;)a+=t.charAt(s);if(a.match(R4))return!0;break;case".":case"0":case"#":for(;s<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++s))>-1||r=="\\"&&t.charAt(s+1)=="-"&&"0#".indexOf(t.charAt(s+2))>-1););break;case"?":for(;t.charAt(++s)===r;);break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;);break;case" ":++s;break;default:++s;break}return!1}function CQ(t,s,r,a){for(var n=[],i="",l=0,o="",u="t",d,c,h,A="H";l<t.length;)switch(o=t.charAt(l)){case"G":if(!c0(t,l))throw new Error("unrecognized character "+o+" in "+t);n[n.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(h=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++l;break;case"\\":var f=t.charAt(++l),g=f==="("||f===")"?f:"t";n[n.length]={t:g,v:f},++l;break;case"_":n[n.length]={t:"t",v:" "},l+=2;break;case"@":n[n.length]={t:"T",v:s},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=rA(s,r,t.charAt(l+1)==="2"),d==null))return"";n[n.length]={t:"X",v:t.substr(l,2)},u=o,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0||d==null&&(d=rA(s,r),d==null))return"";for(i=o;++l<t.length&&t.charAt(l).toLowerCase()===o;)i+=o;o==="m"&&u.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=A),n[n.length]={t:o,v:i},u=o;break;case"A":case"a":case"":var v={t:o,v:o};if(d==null&&(d=rA(s,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(v.v=d.H>=12?"P":"A"),v.t="T",A="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(v.v=d.H>=12?"PM":"AM"),v.t="T",l+=5,A="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(v.v=d.H>=12?"":""),v.t="T",l+=5,A="h"):(v.t="t",++l),d==null&&v.t==="T")return"";n[n.length]=v,u=o;break;case"[":for(i=o;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(R4)){if(d==null&&(d=rA(s,r),d==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},u=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wh(t)||(n[n.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=o;++l<t.length&&(o=t.charAt(l))==="0";)i+=o;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++l<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(l))>-1;)i+=o;n[n.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++l)===o;)i+=o;n[n.length]={t:o,v:i},u=o;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":n[n.length]={t:a===1?"t":o,v:o},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:o,v:o},++l;break;case"$":n[n.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);n[n.length]={t:"t",v:o},++l;break}var b=0,y=0,j;for(l=n.length-1,u="t";l>=0;--l)switch(n[l].t){case"h":case"H":n[l].t=A,u="h",b<1&&(b=1);break;case"s":(j=n[l].v.match(/\.0+$/))&&(y=Math.max(y,j[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":u=n[l].t;break;case"m":u==="s"&&(n[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&n[l].v.match(/[Hh]/)&&(b=1),b<2&&n[l].v.match(/[Mm]/)&&(b=2),b<3&&n[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var N="",S;for(l=0;l<n.length;++l)switch(n[l].t){case"t":case"T":case" ":case"D":break;case"X":n[l].v="",n[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[l].v=xQ(n[l].t.charCodeAt(0),n[l].v,d,y),n[l].t="t";break;case"n":case"?":for(S=l+1;n[S]!=null&&((o=n[S].t)==="?"||o==="D"||(o===" "||o==="t")&&n[S+1]!=null&&(n[S+1].t==="?"||n[S+1].t==="t"&&n[S+1].v==="/")||n[l].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(n[S].v==="/"||n[S].v===" "&&n[S+1]!=null&&n[S+1].t=="?"));)n[l].v+=n[S].v,n[S]={v:"",t:";"},++S;N+=n[l].v,l=S-1;break;case"G":n[l].t="t",n[l].v=fA(s,r);break}var B="",P,L;if(N.length>0){N.charCodeAt(0)==40?(P=s<0&&N.charCodeAt(0)===45?-s:s,L=Gc("n",N,P)):(P=s<0&&a>1?-s:s,L=Gc("n",N,P),P<0&&n[0]&&n[0].t=="t"&&(L=L.substr(1),n[0].v="-"+n[0].v)),S=L.length-1;var U=n.length;for(l=0;l<n.length;++l)if(n[l]!=null&&n[l].t!="t"&&n[l].v.indexOf(".")>-1){U=l;break}var H=n.length;if(U===n.length&&L.indexOf("E")===-1){for(l=n.length-1;l>=0;--l)n[l]==null||"n?".indexOf(n[l].t)===-1||(S>=n[l].v.length-1?(S-=n[l].v.length,n[l].v=L.substr(S+1,n[l].v.length)):S<0?n[l].v="":(n[l].v=L.substr(0,S+1),S=-1),n[l].t="t",H=l);S>=0&&H<n.length&&(n[H].v=L.substr(0,S+1)+n[H].v)}else if(U!==n.length&&L.indexOf("E")===-1){for(S=L.indexOf(".")-1,l=U;l>=0;--l)if(!(n[l]==null||"n?".indexOf(n[l].t)===-1)){for(c=n[l].v.indexOf(".")>-1&&l===U?n[l].v.indexOf(".")-1:n[l].v.length-1,B=n[l].v.substr(c+1);c>=0;--c)S>=0&&(n[l].v.charAt(c)==="0"||n[l].v.charAt(c)==="#")&&(B=L.charAt(S--)+B);n[l].v=B,n[l].t="t",H=l}for(S>=0&&H<n.length&&(n[H].v=L.substr(0,S+1)+n[H].v),S=L.indexOf(".")+1,l=U;l<n.length;++l)if(!(n[l]==null||"n?(".indexOf(n[l].t)===-1&&l!==U)){for(c=n[l].v.indexOf(".")>-1&&l===U?n[l].v.indexOf(".")+1:0,B=n[l].v.substr(0,c);c<n[l].v.length;++c)S<L.length&&(B+=L.charAt(S++));n[l].v=B,n[l].t="t",H=l}}}for(l=0;l<n.length;++l)n[l]!=null&&"n?".indexOf(n[l].t)>-1&&(P=a>1&&s<0&&l>0&&n[l-1].v==="-"?-s:s,n[l].v=Gc(n[l].t,n[l].v,P),n[l].t="t");var q="";for(l=0;l!==n.length;++l)n[l]!=null&&(q+=n[l].v);return q}var Y2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function X2(t,s){if(s==null)return!1;var r=parseFloat(s[2]);switch(s[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function kQ(t,s){var r=SQ(t),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof s!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=s>0?r[0]:s<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Y2),o=r[1].match(Y2);return X2(s,l)?[a,r[0]]:X2(s,o)?[a,r[1]]:[a,r[l!=null&&o!=null?2:1]]}return[a,i]}function Wl(t,s,r){r==null&&(r={});var a="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?a=r.dateNF:a=t;break;case"number":t==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Hs)[t],a==null&&(a=r.table&&r.table[G2[t]]||Hs[G2[t]]),a==null&&(a=dQ[t]||"General");break}if(c0(a,0))return fA(s,r);s instanceof Date&&(s=E4(s,r.date1904));var n=kQ(a,s);if(c0(n[1]))return fA(s,r);if(s===!0)s="TRUE";else if(s===!1)s="FALSE";else if(s===""||s==null)return"";return CQ(n[1],s,r,n[0])}function Kc(t,s){if(typeof s!="number"){s=+s||-1;for(var r=0;r<392;++r){if(Hs[r]==null){s<0&&(s=r);continue}if(Hs[r]==t){s=r;break}}s<0&&(s=391)}return Hs[s]=t,s}function sg(t){for(var s=0;s!=392;++s)t[s]!==void 0&&Kc(t[s],s)}function Gh(){Hs=cQ()}var BQ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},O4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function EQ(t){var s=typeof t=="number"?Hs[t]:t;return s=s.replace(O4,"(\\d+)"),new RegExp("^"+s+"$")}function FQ(t,s,r){var a=-1,n=-1,i=-1,l=-1,o=-1,u=-1;(s.match(O4)||[]).forEach(function(h,A){var f=parseInt(r[A+1],10);switch(h.toLowerCase().charAt(0)){case"y":a=f;break;case"d":i=f;break;case"h":l=f;break;case"s":u=f;break;case"m":l>=0?o=f:n=f;break}}),u>=0&&o==-1&&n>=0&&(o=n,n=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var c=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return l==-1&&o==-1&&u==-1?d:a==-1&&n==-1&&i==-1?c:d+"T"+c}var TQ=(function(){var t={};t.version="1.2.0";function s(){for(var L=0,U=new Array(256),H=0;H!=256;++H)L=H,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,L=L&1?-306674912^L>>>1:L>>>1,U[H]=L;return typeof Int32Array<"u"?new Int32Array(U):U}var r=s();function a(L){var U=0,H=0,q=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(q=0;q!=256;++q)V[q]=L[q];for(q=0;q!=256;++q)for(H=L[q],U=256+q;U<4096;U+=256)H=V[U]=H>>>8^L[H&255];var M=[];for(q=1;q!=16;++q)M[q-1]=typeof Int32Array<"u"?V.subarray(q*256,q*256+256):V.slice(q*256,q*256+256);return M}var n=a(r),i=n[0],l=n[1],o=n[2],u=n[3],d=n[4],c=n[5],h=n[6],A=n[7],f=n[8],g=n[9],v=n[10],b=n[11],y=n[12],j=n[13],N=n[14];function S(L,U){for(var H=U^-1,q=0,V=L.length;q<V;)H=H>>>8^r[(H^L.charCodeAt(q++))&255];return~H}function B(L,U){for(var H=U^-1,q=L.length-15,V=0;V<q;)H=N[L[V++]^H&255]^j[L[V++]^H>>8&255]^y[L[V++]^H>>16&255]^b[L[V++]^H>>>24]^v[L[V++]]^g[L[V++]]^f[L[V++]]^A[L[V++]]^h[L[V++]]^c[L[V++]]^d[L[V++]]^u[L[V++]]^o[L[V++]]^l[L[V++]]^i[L[V++]]^r[L[V++]];for(q+=15;V<q;)H=H>>>8^r[(H^L[V++])&255];return~H}function P(L,U){for(var H=U^-1,q=0,V=L.length,M=0,z=0;q<V;)M=L.charCodeAt(q++),M<128?H=H>>>8^r[(H^M)&255]:M<2048?(H=H>>>8^r[(H^(192|M>>6&31))&255],H=H>>>8^r[(H^(128|M&63))&255]):M>=55296&&M<57344?(M=(M&1023)+64,z=L.charCodeAt(q++)&1023,H=H>>>8^r[(H^(240|M>>8&7))&255],H=H>>>8^r[(H^(128|M>>2&63))&255],H=H>>>8^r[(H^(128|z>>6&15|(M&3)<<4))&255],H=H>>>8^r[(H^(128|z&63))&255]):(H=H>>>8^r[(H^(224|M>>12&15))&255],H=H>>>8^r[(H^(128|M>>6&63))&255],H=H>>>8^r[(H^(128|M&63))&255]);return~H}return t.table=r,t.bstr=S,t.buf=B,t.str=P,t})(),Rs=(function(){var s={};s.version="1.2.1";function r(he,pe){for(var ye=he.split("/"),Ne=pe.split("/"),He=0,Ge=0,gt=Math.min(ye.length,Ne.length);He<gt;++He){if(Ge=ye[He].length-Ne[He].length)return Ge;if(ye[He]!=Ne[He])return ye[He]<Ne[He]?-1:1}return ye.length-Ne.length}function a(he){if(he.charAt(he.length-1)=="/")return he.slice(0,-1).indexOf("/")===-1?he:a(he.slice(0,-1));var pe=he.lastIndexOf("/");return pe===-1?he:he.slice(0,pe+1)}function n(he){if(he.charAt(he.length-1)=="/")return n(he.slice(0,-1));var pe=he.lastIndexOf("/");return pe===-1?he:he.slice(pe+1)}function i(he,pe){typeof pe=="string"&&(pe=new Date(pe));var ye=pe.getHours();ye=ye<<6|pe.getMinutes(),ye=ye<<5|pe.getSeconds()>>>1,he.write_shift(2,ye);var Ne=pe.getFullYear()-1980;Ne=Ne<<4|pe.getMonth()+1,Ne=Ne<<5|pe.getDate(),he.write_shift(2,Ne)}function l(he){var pe=he.read_shift(2)&65535,ye=he.read_shift(2)&65535,Ne=new Date,He=ye&31;ye>>>=5;var Ge=ye&15;ye>>>=4,Ne.setMilliseconds(0),Ne.setFullYear(ye+1980),Ne.setMonth(Ge-1),Ne.setDate(He);var gt=pe&31;pe>>>=5;var kt=pe&63;return pe>>>=6,Ne.setHours(pe),Ne.setMinutes(kt),Ne.setSeconds(gt<<1),Ne}function o(he){Pn(he,0);for(var pe={},ye=0;he.l<=he.length-4;){var Ne=he.read_shift(2),He=he.read_shift(2),Ge=he.l+He,gt={};switch(Ne){case 21589:ye=he.read_shift(1),ye&1&&(gt.mtime=he.read_shift(4)),He>5&&(ye&2&&(gt.atime=he.read_shift(4)),ye&4&&(gt.ctime=he.read_shift(4))),gt.mtime&&(gt.mt=new Date(gt.mtime*1e3));break}he.l=Ge,pe[Ne]=gt}return pe}var u;function d(){return u||(u={})}function c(he,pe){if(he[0]==80&&he[1]==75)return Xe(he,pe);if((he[0]|32)==109&&(he[1]|32)==105)return We(he,pe);if(he.length<512)throw new Error("CFB file size "+he.length+" < 512");var ye=3,Ne=512,He=0,Ge=0,gt=0,kt=0,yt=0,Et=[],Ft=he.slice(0,512);Pn(Ft,0);var Yt=h(Ft);switch(ye=Yt[0],ye){case 3:Ne=512;break;case 4:Ne=4096;break;case 0:if(Yt[1]==0)return Xe(he,pe);default:throw new Error("Major Version: Expected 3 or 4 saw "+ye)}Ne!==512&&(Ft=he.slice(0,Ne),Pn(Ft,28));var rs=he.slice(0,Ne);A(Ft,ye);var As=Ft.read_shift(4,"i");if(ye===3&&As!==0)throw new Error("# Directory Sectors: Expected 0 saw "+As);Ft.l+=4,gt=Ft.read_shift(4,"i"),Ft.l+=4,Ft.chk("00100000","Mini Stream Cutoff Size: "),kt=Ft.read_shift(4,"i"),He=Ft.read_shift(4,"i"),yt=Ft.read_shift(4,"i"),Ge=Ft.read_shift(4,"i");for(var es=-1,Jt=0;Jt<109&&(es=Ft.read_shift(4,"i"),!(es<0));++Jt)Et[Jt]=es;var Ps=f(he,Ne);b(yt,Ge,Ps,Ne,Et);var Os=j(Ps,gt,Et,Ne);Os[gt].name="!Directory",He>0&&kt!==z&&(Os[kt].name="!MiniFAT"),Os[Et[0]].name="!FAT",Os.fat_addrs=Et,Os.ssz=Ne;var lr={},zs=[],ba=[],dn=[];N(gt,Os,Ps,zs,He,lr,ba,kt),g(ba,dn,zs),zs.shift();var Ea={FileIndex:ba,FullPaths:dn};return pe&&pe.raw&&(Ea.raw={header:rs,sectors:Ps}),Ea}function h(he){if(he[he.l]==80&&he[he.l+1]==75)return[0,0];he.chk(I,"Header Signature: "),he.l+=16;var pe=he.read_shift(2,"u");return[he.read_shift(2,"u"),pe]}function A(he,pe){var ye=9;switch(he.l+=2,ye=he.read_shift(2)){case 9:if(pe!=3)throw new Error("Sector Shift: Expected 9 saw "+ye);break;case 12:if(pe!=4)throw new Error("Sector Shift: Expected 12 saw "+ye);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ye)}he.chk("0600","Mini Sector Shift: "),he.chk("000000000000","Reserved: ")}function f(he,pe){for(var ye=Math.ceil(he.length/pe)-1,Ne=[],He=1;He<ye;++He)Ne[He-1]=he.slice(He*pe,(He+1)*pe);return Ne[ye-1]=he.slice(ye*pe),Ne}function g(he,pe,ye){for(var Ne=0,He=0,Ge=0,gt=0,kt=0,yt=ye.length,Et=[],Ft=[];Ne<yt;++Ne)Et[Ne]=Ft[Ne]=Ne,pe[Ne]=ye[Ne];for(;kt<Ft.length;++kt)Ne=Ft[kt],He=he[Ne].L,Ge=he[Ne].R,gt=he[Ne].C,Et[Ne]===Ne&&(He!==-1&&Et[He]!==He&&(Et[Ne]=Et[He]),Ge!==-1&&Et[Ge]!==Ge&&(Et[Ne]=Et[Ge])),gt!==-1&&(Et[gt]=Ne),He!==-1&&Ne!=Et[Ne]&&(Et[He]=Et[Ne],Ft.lastIndexOf(He)<kt&&Ft.push(He)),Ge!==-1&&Ne!=Et[Ne]&&(Et[Ge]=Et[Ne],Ft.lastIndexOf(Ge)<kt&&Ft.push(Ge));for(Ne=1;Ne<yt;++Ne)Et[Ne]===Ne&&(Ge!==-1&&Et[Ge]!==Ge?Et[Ne]=Et[Ge]:He!==-1&&Et[He]!==He&&(Et[Ne]=Et[He]));for(Ne=1;Ne<yt;++Ne)if(he[Ne].type!==0){if(kt=Ne,kt!=Et[kt])do kt=Et[kt],pe[Ne]=pe[kt]+"/"+pe[Ne];while(kt!==0&&Et[kt]!==-1&&kt!=Et[kt]);Et[Ne]=-1}for(pe[0]+="/",Ne=1;Ne<yt;++Ne)he[Ne].type!==2&&(pe[Ne]+="/")}function v(he,pe,ye){for(var Ne=he.start,He=he.size,Ge=[],gt=Ne;ye&&He>0&&gt>=0;)Ge.push(pe.slice(gt*M,gt*M+M)),He-=M,gt=Ju(ye,gt*4);return Ge.length===0?Kt(0):wn(Ge).slice(0,he.size)}function b(he,pe,ye,Ne,He){var Ge=z;if(he===z){if(pe!==0)throw new Error("DIFAT chain shorter than expected")}else if(he!==-1){var gt=ye[he],kt=(Ne>>>2)-1;if(!gt)return;for(var yt=0;yt<kt&&(Ge=Ju(gt,yt*4))!==z;++yt)He.push(Ge);b(Ju(gt,Ne-4),pe-1,ye,Ne,He)}}function y(he,pe,ye,Ne,He){var Ge=[],gt=[];He||(He=[]);var kt=Ne-1,yt=0,Et=0;for(yt=pe;yt>=0;){He[yt]=!0,Ge[Ge.length]=yt,gt.push(he[yt]);var Ft=ye[Math.floor(yt*4/Ne)];if(Et=yt*4&kt,Ne<4+Et)throw new Error("FAT boundary crossed: "+yt+" 4 "+Ne);if(!he[Ft])break;yt=Ju(he[Ft],Et)}return{nodes:Ge,data:c_([gt])}}function j(he,pe,ye,Ne){var He=he.length,Ge=[],gt=[],kt=[],yt=[],Et=Ne-1,Ft=0,Yt=0,rs=0,As=0;for(Ft=0;Ft<He;++Ft)if(kt=[],rs=Ft+pe,rs>=He&&(rs-=He),!gt[rs]){yt=[];var es=[];for(Yt=rs;Yt>=0;){es[Yt]=!0,gt[Yt]=!0,kt[kt.length]=Yt,yt.push(he[Yt]);var Jt=ye[Math.floor(Yt*4/Ne)];if(As=Yt*4&Et,Ne<4+As)throw new Error("FAT boundary crossed: "+Yt+" 4 "+Ne);if(!he[Jt]||(Yt=Ju(he[Jt],As),es[Yt]))break}Ge[rs]={nodes:kt,data:c_([yt])}}return Ge}function N(he,pe,ye,Ne,He,Ge,gt,kt){for(var yt=0,Et=Ne.length?2:0,Ft=pe[he].data,Yt=0,rs=0,As;Yt<Ft.length;Yt+=128){var es=Ft.slice(Yt,Yt+128);Pn(es,64),rs=es.read_shift(2),As=jj(es,0,rs-Et),Ne.push(As);var Jt={name:As,type:es.read_shift(1),color:es.read_shift(1),L:es.read_shift(4,"i"),R:es.read_shift(4,"i"),C:es.read_shift(4,"i"),clsid:es.read_shift(16),state:es.read_shift(4,"i"),start:0,size:0},Ps=es.read_shift(2)+es.read_shift(2)+es.read_shift(2)+es.read_shift(2);Ps!==0&&(Jt.ct=S(es,es.l-8));var Os=es.read_shift(2)+es.read_shift(2)+es.read_shift(2)+es.read_shift(2);Os!==0&&(Jt.mt=S(es,es.l-8)),Jt.start=es.read_shift(4,"i"),Jt.size=es.read_shift(4,"i"),Jt.size<0&&Jt.start<0&&(Jt.size=Jt.type=0,Jt.start=z,Jt.name=""),Jt.type===5?(yt=Jt.start,He>0&&yt!==z&&(pe[yt].name="!StreamData")):Jt.size>=4096?(Jt.storage="fat",pe[Jt.start]===void 0&&(pe[Jt.start]=y(ye,Jt.start,pe.fat_addrs,pe.ssz)),pe[Jt.start].name=Jt.name,Jt.content=pe[Jt.start].data.slice(0,Jt.size)):(Jt.storage="minifat",Jt.size<0?Jt.size=0:yt!==z&&Jt.start!==z&&pe[yt]&&(Jt.content=v(Jt,pe[yt].data,(pe[kt]||{}).data))),Jt.content&&Pn(Jt.content,0),Ge[As]=Jt,gt.push(Jt)}}function S(he,pe){return new Date((ul(he,pe+4)/1e7*Math.pow(2,32)+ul(he,pe)/1e7-11644473600)*1e3)}function B(he,pe){return d(),c(u.readFileSync(he),pe)}function P(he,pe){var ye=pe&&pe.type;switch(ye||ir&&Buffer.isBuffer(he)&&(ye="buffer"),ye||"base64"){case"file":return B(he,pe);case"base64":return c(Al(gl(he)),pe);case"binary":return c(Al(he),pe)}return c(he,pe)}function L(he,pe){var ye=pe||{},Ne=ye.root||"Root Entry";if(he.FullPaths||(he.FullPaths=[]),he.FileIndex||(he.FileIndex=[]),he.FullPaths.length!==he.FileIndex.length)throw new Error("inconsistent CFB structure");he.FullPaths.length===0&&(he.FullPaths[0]=Ne+"/",he.FileIndex[0]={name:Ne,type:5}),ye.CLSID&&(he.FileIndex[0].clsid=ye.CLSID),U(he)}function U(he){var pe="Sh33tJ5";if(!Rs.find(he,"/"+pe)){var ye=Kt(4);ye[0]=55,ye[1]=ye[3]=50,ye[2]=54,he.FileIndex.push({name:pe,type:2,content:ye,size:4,L:69,R:69,C:69}),he.FullPaths.push(he.FullPaths[0]+pe),H(he)}}function H(he,pe){L(he);for(var ye=!1,Ne=!1,He=he.FullPaths.length-1;He>=0;--He){var Ge=he.FileIndex[He];switch(Ge.type){case 0:Ne?ye=!0:(he.FileIndex.pop(),he.FullPaths.pop());break;case 1:case 2:case 5:Ne=!0,isNaN(Ge.R*Ge.L*Ge.C)&&(ye=!0),Ge.R>-1&&Ge.L>-1&&Ge.R==Ge.L&&(ye=!0);break;default:ye=!0;break}}if(!(!ye&&!pe)){var gt=new Date(1987,1,19),kt=0,yt=Object.create?Object.create(null):{},Et=[];for(He=0;He<he.FullPaths.length;++He)yt[he.FullPaths[He]]=!0,he.FileIndex[He].type!==0&&Et.push([he.FullPaths[He],he.FileIndex[He]]);for(He=0;He<Et.length;++He){var Ft=a(Et[He][0]);Ne=yt[Ft],Ne||(Et.push([Ft,{name:n(Ft).replace("/",""),type:1,clsid:Y,ct:gt,mt:gt,content:null}]),yt[Ft]=!0)}for(Et.sort(function(As,es){return r(As[0],es[0])}),he.FullPaths=[],he.FileIndex=[],He=0;He<Et.length;++He)he.FullPaths[He]=Et[He][0],he.FileIndex[He]=Et[He][1];for(He=0;He<Et.length;++He){var Yt=he.FileIndex[He],rs=he.FullPaths[He];if(Yt.name=n(rs).replace("/",""),Yt.L=Yt.R=Yt.C=-(Yt.color=1),Yt.size=Yt.content?Yt.content.length:0,Yt.start=0,Yt.clsid=Yt.clsid||Y,He===0)Yt.C=Et.length>1?1:-1,Yt.size=0,Yt.type=5;else if(rs.slice(-1)=="/"){for(kt=He+1;kt<Et.length&&a(he.FullPaths[kt])!=rs;++kt);for(Yt.C=kt>=Et.length?-1:kt,kt=He+1;kt<Et.length&&a(he.FullPaths[kt])!=a(rs);++kt);Yt.R=kt>=Et.length?-1:kt,Yt.type=1}else a(he.FullPaths[He+1]||"")==a(rs)&&(Yt.R=He+1),Yt.type=2}}}function q(he,pe){var ye=pe||{};if(ye.fileType=="mad")return De(he,ye);switch(H(he),ye.fileType){case"zip":return ft(he,ye)}var Ne=(function(As){for(var es=0,Jt=0,Ps=0;Ps<As.FileIndex.length;++Ps){var Os=As.FileIndex[Ps];if(Os.content){var lr=Os.content.length;lr>0&&(lr<4096?es+=lr+63>>6:Jt+=lr+511>>9)}}for(var zs=As.FullPaths.length+3>>2,ba=es+7>>3,dn=es+127>>7,Ea=ba+Jt+zs+dn,Lr=Ea+127>>7,Wr=Lr<=109?0:Math.ceil((Lr-109)/127);Ea+Lr+Wr+127>>7>Lr;)Wr=++Lr<=109?0:Math.ceil((Lr-109)/127);var mr=[1,Wr,Lr,dn,zs,Jt,es,0];return As.FileIndex[0].size=es<<6,mr[7]=(As.FileIndex[0].start=mr[0]+mr[1]+mr[2]+mr[3]+mr[4]+mr[5])+(mr[6]+7>>3),mr})(he),He=Kt(Ne[7]<<9),Ge=0,gt=0;{for(Ge=0;Ge<8;++Ge)He.write_shift(1,G[Ge]);for(Ge=0;Ge<8;++Ge)He.write_shift(2,0);for(He.write_shift(2,62),He.write_shift(2,3),He.write_shift(2,65534),He.write_shift(2,9),He.write_shift(2,6),Ge=0;Ge<3;++Ge)He.write_shift(2,0);for(He.write_shift(4,0),He.write_shift(4,Ne[2]),He.write_shift(4,Ne[0]+Ne[1]+Ne[2]+Ne[3]-1),He.write_shift(4,0),He.write_shift(4,4096),He.write_shift(4,Ne[3]?Ne[0]+Ne[1]+Ne[2]-1:z),He.write_shift(4,Ne[3]),He.write_shift(-4,Ne[1]?Ne[0]-1:z),He.write_shift(4,Ne[1]),Ge=0;Ge<109;++Ge)He.write_shift(-4,Ge<Ne[2]?Ne[1]+Ge:-1)}if(Ne[1])for(gt=0;gt<Ne[1];++gt){for(;Ge<236+gt*127;++Ge)He.write_shift(-4,Ge<Ne[2]?Ne[1]+Ge:-1);He.write_shift(-4,gt===Ne[1]-1?z:gt+1)}var kt=function(As){for(gt+=As;Ge<gt-1;++Ge)He.write_shift(-4,Ge+1);As&&(++Ge,He.write_shift(-4,z))};for(gt=Ge=0,gt+=Ne[1];Ge<gt;++Ge)He.write_shift(-4,J.DIFSECT);for(gt+=Ne[2];Ge<gt;++Ge)He.write_shift(-4,J.FATSECT);kt(Ne[3]),kt(Ne[4]);for(var yt=0,Et=0,Ft=he.FileIndex[0];yt<he.FileIndex.length;++yt)Ft=he.FileIndex[yt],Ft.content&&(Et=Ft.content.length,!(Et<4096)&&(Ft.start=gt,kt(Et+511>>9)));for(kt(Ne[6]+7>>3);He.l&511;)He.write_shift(-4,J.ENDOFCHAIN);for(gt=Ge=0,yt=0;yt<he.FileIndex.length;++yt)Ft=he.FileIndex[yt],Ft.content&&(Et=Ft.content.length,!(!Et||Et>=4096)&&(Ft.start=gt,kt(Et+63>>6)));for(;He.l&511;)He.write_shift(-4,J.ENDOFCHAIN);for(Ge=0;Ge<Ne[4]<<2;++Ge){var Yt=he.FullPaths[Ge];if(!Yt||Yt.length===0){for(yt=0;yt<17;++yt)He.write_shift(4,0);for(yt=0;yt<3;++yt)He.write_shift(4,-1);for(yt=0;yt<12;++yt)He.write_shift(4,0);continue}Ft=he.FileIndex[Ge],Ge===0&&(Ft.start=Ft.size?Ft.start-1:z);var rs=Ge===0&&ye.root||Ft.name;if(Et=2*(rs.length+1),He.write_shift(64,rs,"utf16le"),He.write_shift(2,Et),He.write_shift(1,Ft.type),He.write_shift(1,Ft.color),He.write_shift(-4,Ft.L),He.write_shift(-4,Ft.R),He.write_shift(-4,Ft.C),Ft.clsid)He.write_shift(16,Ft.clsid,"hex");else for(yt=0;yt<4;++yt)He.write_shift(4,0);He.write_shift(4,Ft.state||0),He.write_shift(4,0),He.write_shift(4,0),He.write_shift(4,0),He.write_shift(4,0),He.write_shift(4,Ft.start),He.write_shift(4,Ft.size),He.write_shift(4,0)}for(Ge=1;Ge<he.FileIndex.length;++Ge)if(Ft=he.FileIndex[Ge],Ft.size>=4096)if(He.l=Ft.start+1<<9,ir&&Buffer.isBuffer(Ft.content))Ft.content.copy(He,He.l,0,Ft.size),He.l+=Ft.size+511&-512;else{for(yt=0;yt<Ft.size;++yt)He.write_shift(1,Ft.content[yt]);for(;yt&511;++yt)He.write_shift(1,0)}for(Ge=1;Ge<he.FileIndex.length;++Ge)if(Ft=he.FileIndex[Ge],Ft.size>0&&Ft.size<4096)if(ir&&Buffer.isBuffer(Ft.content))Ft.content.copy(He,He.l,0,Ft.size),He.l+=Ft.size+63&-64;else{for(yt=0;yt<Ft.size;++yt)He.write_shift(1,Ft.content[yt]);for(;yt&63;++yt)He.write_shift(1,0)}if(ir)He.l=He.length;else for(;He.l<He.length;)He.write_shift(1,0);return He}function V(he,pe){var ye=he.FullPaths.map(function(yt){return yt.toUpperCase()}),Ne=ye.map(function(yt){var Et=yt.split("/");return Et[Et.length-(yt.slice(-1)=="/"?2:1)]}),He=!1;pe.charCodeAt(0)===47?(He=!0,pe=ye[0].slice(0,-1)+pe):He=pe.indexOf("/")!==-1;var Ge=pe.toUpperCase(),gt=He===!0?ye.indexOf(Ge):Ne.indexOf(Ge);if(gt!==-1)return he.FileIndex[gt];var kt=!Ge.match(Pm);for(Ge=Ge.replace(Ti,""),kt&&(Ge=Ge.replace(Pm,"!")),gt=0;gt<ye.length;++gt)if((kt?ye[gt].replace(Pm,"!"):ye[gt]).replace(Ti,"")==Ge||(kt?Ne[gt].replace(Pm,"!"):Ne[gt]).replace(Ti,"")==Ge)return he.FileIndex[gt];return null}var M=64,z=-2,I="d0cf11e0a1b11ae1",G=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",J={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:I,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(he,pe,ye){d();var Ne=q(he,ye);u.writeFileSync(pe,Ne)}function k(he){for(var pe=new Array(he.length),ye=0;ye<he.length;++ye)pe[ye]=String.fromCharCode(he[ye]);return pe.join("")}function D(he,pe){var ye=q(he,pe);switch(pe&&pe.type||"buffer"){case"file":return d(),u.writeFileSync(pe.filename,ye),ye;case"binary":return typeof ye=="string"?ye:k(ye);case"base64":return pf(typeof ye=="string"?ye:k(ye));case"buffer":if(ir)return Buffer.isBuffer(ye)?ye:rd(ye);case"array":return typeof ye=="string"?Al(ye):ye}return ye}var Q;function C(he){try{var pe=he.InflateRaw,ye=new pe;if(ye._processChunk(new Uint8Array([3,0]),ye._finishFlushFlag),ye.bytesRead)Q=he;else throw new Error("zlib does not expose bytesRead")}catch(Ne){console.error("cannot use native zlib: "+(Ne.message||Ne))}}function E(he,pe){if(!Q)return xe(he,pe);var ye=Q.InflateRaw,Ne=new ye,He=Ne._processChunk(he.slice(he.l),Ne._finishFlushFlag);return he.l+=Ne.bytesRead,He}function w(he){return Q?Q.deflateRawSync(he):ue(he)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],R=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ne(he){var pe=(he<<1|he<<11)&139536|(he<<5|he<<15)&558144;return(pe>>16|pe>>8|pe)&255}for(var te=typeof Uint8Array<"u",oe=te?new Uint8Array(256):[],ce=0;ce<256;++ce)oe[ce]=ne(ce);function re(he,pe){var ye=oe[he&255];return pe<=8?ye>>>8-pe:(ye=ye<<8|oe[he>>8&255],pe<=16?ye>>>16-pe:(ye=ye<<8|oe[he>>16&255],ye>>>24-pe))}function de(he,pe){var ye=pe&7,Ne=pe>>>3;return(he[Ne]|(ye<=6?0:he[Ne+1]<<8))>>>ye&3}function Ie(he,pe){var ye=pe&7,Ne=pe>>>3;return(he[Ne]|(ye<=5?0:he[Ne+1]<<8))>>>ye&7}function le(he,pe){var ye=pe&7,Ne=pe>>>3;return(he[Ne]|(ye<=4?0:he[Ne+1]<<8))>>>ye&15}function Z(he,pe){var ye=pe&7,Ne=pe>>>3;return(he[Ne]|(ye<=3?0:he[Ne+1]<<8))>>>ye&31}function ve(he,pe){var ye=pe&7,Ne=pe>>>3;return(he[Ne]|(ye<=1?0:he[Ne+1]<<8))>>>ye&127}function Ue(he,pe,ye){var Ne=pe&7,He=pe>>>3,Ge=(1<<ye)-1,gt=he[He]>>>Ne;return ye<8-Ne||(gt|=he[He+1]<<8-Ne,ye<16-Ne)||(gt|=he[He+2]<<16-Ne,ye<24-Ne)||(gt|=he[He+3]<<24-Ne),gt&Ge}function Be(he,pe,ye){var Ne=pe&7,He=pe>>>3;return Ne<=5?he[He]|=(ye&7)<<Ne:(he[He]|=ye<<Ne&255,he[He+1]=(ye&7)>>8-Ne),pe+3}function _e(he,pe,ye){var Ne=pe&7,He=pe>>>3;return ye=(ye&1)<<Ne,he[He]|=ye,pe+1}function Me(he,pe,ye){var Ne=pe&7,He=pe>>>3;return ye<<=Ne,he[He]|=ye&255,ye>>>=8,he[He+1]=ye,pe+8}function Ye(he,pe,ye){var Ne=pe&7,He=pe>>>3;return ye<<=Ne,he[He]|=ye&255,ye>>>=8,he[He+1]=ye&255,he[He+2]=ye>>>8,pe+16}function ot(he,pe){var ye=he.length,Ne=2*ye>pe?2*ye:pe+5,He=0;if(ye>=pe)return he;if(ir){var Ge=V2(Ne);if(he.copy)he.copy(Ge);else for(;He<he.length;++He)Ge[He]=he[He];return Ge}else if(te){var gt=new Uint8Array(Ne);if(gt.set)gt.set(he);else for(;He<ye;++He)gt[He]=he[He];return gt}return he.length=Ne,he}function Ke(he){for(var pe=new Array(he),ye=0;ye<he;++ye)pe[ye]=0;return pe}function ct(he,pe,ye){var Ne=1,He=0,Ge=0,gt=0,kt=0,yt=he.length,Et=te?new Uint16Array(32):Ke(32);for(Ge=0;Ge<32;++Ge)Et[Ge]=0;for(Ge=yt;Ge<ye;++Ge)he[Ge]=0;yt=he.length;var Ft=te?new Uint16Array(yt):Ke(yt);for(Ge=0;Ge<yt;++Ge)Et[He=he[Ge]]++,Ne<He&&(Ne=He),Ft[Ge]=0;for(Et[0]=0,Ge=1;Ge<=Ne;++Ge)Et[Ge+16]=kt=kt+Et[Ge-1]<<1;for(Ge=0;Ge<yt;++Ge)kt=he[Ge],kt!=0&&(Ft[Ge]=Et[kt+16]++);var Yt=0;for(Ge=0;Ge<yt;++Ge)if(Yt=he[Ge],Yt!=0)for(kt=re(Ft[Ge],Ne)>>Ne-Yt,gt=(1<<Ne+4-Yt)-1;gt>=0;--gt)pe[kt|gt<<Yt]=Yt&15|Ge<<4;return Ne}var xt=te?new Uint16Array(512):Ke(512),be=te?new Uint16Array(32):Ke(32);if(!te){for(var Ce=0;Ce<512;++Ce)xt[Ce]=0;for(Ce=0;Ce<32;++Ce)be[Ce]=0}(function(){for(var he=[],pe=0;pe<32;pe++)he.push(5);ct(he,be,32);var ye=[];for(pe=0;pe<=143;pe++)ye.push(8);for(;pe<=255;pe++)ye.push(9);for(;pe<=279;pe++)ye.push(7);for(;pe<=287;pe++)ye.push(8);ct(ye,xt,288)})();var Te=(function(){for(var pe=te?new Uint8Array(32768):[],ye=0,Ne=0;ye<X.length-1;++ye)for(;Ne<X[ye+1];++Ne)pe[Ne]=ye;for(;Ne<32768;++Ne)pe[Ne]=29;var He=te?new Uint8Array(259):[];for(ye=0,Ne=0;ye<R.length-1;++ye)for(;Ne<R[ye+1];++Ne)He[Ne]=ye;function Ge(kt,yt){for(var Et=0;Et<kt.length;){var Ft=Math.min(65535,kt.length-Et),Yt=Et+Ft==kt.length;for(yt.write_shift(1,+Yt),yt.write_shift(2,Ft),yt.write_shift(2,~Ft&65535);Ft-- >0;)yt[yt.l++]=kt[Et++]}return yt.l}function gt(kt,yt){for(var Et=0,Ft=0,Yt=te?new Uint16Array(32768):[];Ft<kt.length;){var rs=Math.min(65535,kt.length-Ft);if(rs<10){for(Et=Be(yt,Et,+(Ft+rs==kt.length)),Et&7&&(Et+=8-(Et&7)),yt.l=Et/8|0,yt.write_shift(2,rs),yt.write_shift(2,~rs&65535);rs-- >0;)yt[yt.l++]=kt[Ft++];Et=yt.l*8;continue}Et=Be(yt,Et,+(Ft+rs==kt.length)+2);for(var As=0;rs-- >0;){var es=kt[Ft];As=(As<<5^es)&32767;var Jt=-1,Ps=0;if((Jt=Yt[As])&&(Jt|=Ft&-32768,Jt>Ft&&(Jt-=32768),Jt<Ft))for(;kt[Jt+Ps]==kt[Ft+Ps]&&Ps<250;)++Ps;if(Ps>2){es=He[Ps],es<=22?Et=Me(yt,Et,oe[es+1]>>1)-1:(Me(yt,Et,3),Et+=5,Me(yt,Et,oe[es-23]>>5),Et+=3);var Os=es<8?0:es-4>>2;Os>0&&(Ye(yt,Et,Ps-R[es]),Et+=Os),es=pe[Ft-Jt],Et=Me(yt,Et,oe[es]>>3),Et-=3;var lr=es<4?0:es-2>>1;lr>0&&(Ye(yt,Et,Ft-Jt-X[es]),Et+=lr);for(var zs=0;zs<Ps;++zs)Yt[As]=Ft&32767,As=(As<<5^kt[Ft])&32767,++Ft;rs-=Ps-1}else es<=143?es=es+48:Et=_e(yt,Et,1),Et=Me(yt,Et,oe[es]),Yt[As]=Ft&32767,++Ft}Et=Me(yt,Et,0)-1}return yt.l=(Et+7)/8|0,yt.l}return function(yt,Et){return yt.length<8?Ge(yt,Et):gt(yt,Et)}})();function ue(he){var pe=Kt(50+Math.floor(he.length*1.1)),ye=Te(he,pe);return pe.slice(0,ye)}var ge=te?new Uint16Array(32768):Ke(32768),Ve=te?new Uint16Array(32768):Ke(32768),tt=te?new Uint16Array(128):Ke(128),Ze=1,ht=1;function ze(he,pe){var ye=Z(he,pe)+257;pe+=5;var Ne=Z(he,pe)+1;pe+=5;var He=le(he,pe)+4;pe+=4;for(var Ge=0,gt=te?new Uint8Array(19):Ke(19),kt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],yt=1,Et=te?new Uint8Array(8):Ke(8),Ft=te?new Uint8Array(8):Ke(8),Yt=gt.length,rs=0;rs<He;++rs)gt[O[rs]]=Ge=Ie(he,pe),yt<Ge&&(yt=Ge),Et[Ge]++,pe+=3;var As=0;for(Et[0]=0,rs=1;rs<=yt;++rs)Ft[rs]=As=As+Et[rs-1]<<1;for(rs=0;rs<Yt;++rs)(As=gt[rs])!=0&&(kt[rs]=Ft[As]++);var es=0;for(rs=0;rs<Yt;++rs)if(es=gt[rs],es!=0){As=oe[kt[rs]]>>8-es;for(var Jt=(1<<7-es)-1;Jt>=0;--Jt)tt[As|Jt<<es]=es&7|rs<<3}var Ps=[];for(yt=1;Ps.length<ye+Ne;)switch(As=tt[ve(he,pe)],pe+=As&7,As>>>=3){case 16:for(Ge=3+de(he,pe),pe+=2,As=Ps[Ps.length-1];Ge-- >0;)Ps.push(As);break;case 17:for(Ge=3+Ie(he,pe),pe+=3;Ge-- >0;)Ps.push(0);break;case 18:for(Ge=11+ve(he,pe),pe+=7;Ge-- >0;)Ps.push(0);break;default:Ps.push(As),yt<As&&(yt=As);break}var Os=Ps.slice(0,ye),lr=Ps.slice(ye);for(rs=ye;rs<286;++rs)Os[rs]=0;for(rs=Ne;rs<30;++rs)lr[rs]=0;return Ze=ct(Os,ge,286),ht=ct(lr,Ve,30),pe}function Fe(he,pe){if(he[0]==3&&!(he[1]&3))return[Au(pe),2];for(var ye=0,Ne=0,He=V2(pe||1<<18),Ge=0,gt=He.length>>>0,kt=0,yt=0;(Ne&1)==0;){if(Ne=Ie(he,ye),ye+=3,Ne>>>1)Ne>>1==1?(kt=9,yt=5):(ye=ze(he,ye),kt=Ze,yt=ht);else{ye&7&&(ye+=8-(ye&7));var Et=he[ye>>>3]|he[(ye>>>3)+1]<<8;if(ye+=32,Et>0)for(!pe&&gt<Ge+Et&&(He=ot(He,Ge+Et),gt=He.length);Et-- >0;)He[Ge++]=he[ye>>>3],ye+=8;continue}for(;;){!pe&&gt<Ge+32767&&(He=ot(He,Ge+32767),gt=He.length);var Ft=Ue(he,ye,kt),Yt=Ne>>>1==1?xt[Ft]:ge[Ft];if(ye+=Yt&15,Yt>>>=4,(Yt>>>8&255)===0)He[Ge++]=Yt;else{if(Yt==256)break;Yt-=257;var rs=Yt<8?0:Yt-4>>2;rs>5&&(rs=0);var As=Ge+R[Yt];rs>0&&(As+=Ue(he,ye,rs),ye+=rs),Ft=Ue(he,ye,yt),Yt=Ne>>>1==1?be[Ft]:Ve[Ft],ye+=Yt&15,Yt>>>=4;var es=Yt<4?0:Yt-2>>1,Jt=X[Yt];for(es>0&&(Jt+=Ue(he,ye,es),ye+=es),!pe&&gt<As&&(He=ot(He,As+100),gt=He.length);Ge<As;)He[Ge]=He[Ge-Jt],++Ge}}}return pe?[He,ye+7>>>3]:[He.slice(0,Ge),ye+7>>>3]}function xe(he,pe){var ye=he.slice(he.l||0),Ne=Fe(ye,pe);return he.l+=Ne[1],Ne[0]}function we(he,pe){if(he)typeof console<"u"&&console.error(pe);else throw new Error(pe)}function Xe(he,pe){var ye=he;Pn(ye,0);var Ne=[],He=[],Ge={FileIndex:Ne,FullPaths:He};L(Ge,{root:pe.root});for(var gt=ye.length-4;(ye[gt]!=80||ye[gt+1]!=75||ye[gt+2]!=5||ye[gt+3]!=6)&&gt>=0;)--gt;ye.l=gt+4,ye.l+=4;var kt=ye.read_shift(2);ye.l+=6;var yt=ye.read_shift(4);for(ye.l=yt,gt=0;gt<kt;++gt){ye.l+=20;var Et=ye.read_shift(4),Ft=ye.read_shift(4),Yt=ye.read_shift(2),rs=ye.read_shift(2),As=ye.read_shift(2);ye.l+=8;var es=ye.read_shift(4),Jt=o(ye.slice(ye.l+Yt,ye.l+Yt+rs));ye.l+=Yt+rs+As;var Ps=ye.l;ye.l=es+4,ut(ye,Et,Ft,Ge,Jt),ye.l=Ps}return Ge}function ut(he,pe,ye,Ne,He){he.l+=2;var Ge=he.read_shift(2),gt=he.read_shift(2),kt=l(he);if(Ge&8257)throw new Error("Unsupported ZIP encryption");for(var yt=he.read_shift(4),Et=he.read_shift(4),Ft=he.read_shift(4),Yt=he.read_shift(2),rs=he.read_shift(2),As="",es=0;es<Yt;++es)As+=String.fromCharCode(he[he.l++]);if(rs){var Jt=o(he.slice(he.l,he.l+rs));(Jt[21589]||{}).mt&&(kt=Jt[21589].mt),((He||{})[21589]||{}).mt&&(kt=He[21589].mt)}he.l+=rs;var Ps=he.slice(he.l,he.l+Et);switch(gt){case 8:Ps=E(he,Ft);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+gt)}var Os=!1;Ge&8&&(yt=he.read_shift(4),yt==134695760&&(yt=he.read_shift(4),Os=!0),Et=he.read_shift(4),Ft=he.read_shift(4)),Et!=pe&&we(Os,"Bad compressed size: "+pe+" != "+Et),Ft!=ye&&we(Os,"Bad uncompressed size: "+ye+" != "+Ft),rt(Ne,As,Ps,{unsafe:!0,mt:kt})}function ft(he,pe){var ye=pe||{},Ne=[],He=[],Ge=Kt(1),gt=ye.compression?8:0,kt=0,yt=0,Et=0,Ft=0,Yt=0,rs=he.FullPaths[0],As=rs,es=he.FileIndex[0],Jt=[],Ps=0;for(yt=1;yt<he.FullPaths.length;++yt)if(As=he.FullPaths[yt].slice(rs.length),es=he.FileIndex[yt],!(!es.size||!es.content||As=="Sh33tJ5")){var Os=Ft,lr=Kt(As.length);for(Et=0;Et<As.length;++Et)lr.write_shift(1,As.charCodeAt(Et)&127);lr=lr.slice(0,lr.l),Jt[Yt]=TQ.buf(es.content,0);var zs=es.content;gt==8&&(zs=w(zs)),Ge=Kt(30),Ge.write_shift(4,67324752),Ge.write_shift(2,20),Ge.write_shift(2,kt),Ge.write_shift(2,gt),es.mt?i(Ge,es.mt):Ge.write_shift(4,0),Ge.write_shift(-4,Jt[Yt]),Ge.write_shift(4,zs.length),Ge.write_shift(4,es.content.length),Ge.write_shift(2,lr.length),Ge.write_shift(2,0),Ft+=Ge.length,Ne.push(Ge),Ft+=lr.length,Ne.push(lr),Ft+=zs.length,Ne.push(zs),Ge=Kt(46),Ge.write_shift(4,33639248),Ge.write_shift(2,0),Ge.write_shift(2,20),Ge.write_shift(2,kt),Ge.write_shift(2,gt),Ge.write_shift(4,0),Ge.write_shift(-4,Jt[Yt]),Ge.write_shift(4,zs.length),Ge.write_shift(4,es.content.length),Ge.write_shift(2,lr.length),Ge.write_shift(2,0),Ge.write_shift(2,0),Ge.write_shift(2,0),Ge.write_shift(2,0),Ge.write_shift(4,0),Ge.write_shift(4,Os),Ps+=Ge.l,He.push(Ge),Ps+=lr.length,He.push(lr),++Yt}return Ge=Kt(22),Ge.write_shift(4,101010256),Ge.write_shift(2,0),Ge.write_shift(2,0),Ge.write_shift(2,Yt),Ge.write_shift(2,Yt),Ge.write_shift(4,Ps),Ge.write_shift(4,Ft),Ge.write_shift(2,0),wn([wn(Ne),wn(He),Ge])}var mt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function pt(he,pe){if(he.ctype)return he.ctype;var ye=he.name||"",Ne=ye.match(/\.([^\.]+)$/);return Ne&&mt[Ne[1]]||pe&&(Ne=(ye=pe).match(/[\.\\]([^\.\\])+$/),Ne&&mt[Ne[1]])?mt[Ne[1]]:"application/octet-stream"}function vt(he){for(var pe=pf(he),ye=[],Ne=0;Ne<pe.length;Ne+=76)ye.push(pe.slice(Ne,Ne+76));return ye.join(`\r
`)+`\r
`}function Ot(he){var pe=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Et){var Ft=Et.charCodeAt(0).toString(16).toUpperCase();return"="+(Ft.length==1?"0"+Ft:Ft)});pe=pe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),pe.charAt(0)==`
`&&(pe="=0D"+pe.slice(1)),pe=pe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ye=[],Ne=pe.split(`\r
`),He=0;He<Ne.length;++He){var Ge=Ne[He];if(Ge.length==0){ye.push("");continue}for(var gt=0;gt<Ge.length;){var kt=76,yt=Ge.slice(gt,gt+kt);yt.charAt(kt-1)=="="?kt--:yt.charAt(kt-2)=="="?kt-=2:yt.charAt(kt-3)=="="&&(kt-=3),yt=Ge.slice(gt,gt+kt),gt+=kt,gt<Ge.length&&(yt+="="),ye.push(yt)}}return ye.join(`\r
`)}function Ae(he){for(var pe=[],ye=0;ye<he.length;++ye){for(var Ne=he[ye];ye<=he.length&&Ne.charAt(Ne.length-1)=="=";)Ne=Ne.slice(0,Ne.length-1)+he[++ye];pe.push(Ne)}for(var He=0;He<pe.length;++He)pe[He]=pe[He].replace(/[=][0-9A-Fa-f]{2}/g,function(Ge){return String.fromCharCode(parseInt(Ge.slice(1),16))});return Al(pe.join(`\r
`))}function je(he,pe,ye){for(var Ne="",He="",Ge="",gt,kt=0;kt<10;++kt){var yt=pe[kt];if(!yt||yt.match(/^\s*$/))break;var Et=yt.match(/^(.*?):\s*([^\s].*)$/);if(Et)switch(Et[1].toLowerCase()){case"content-location":Ne=Et[2].trim();break;case"content-type":Ge=Et[2].trim();break;case"content-transfer-encoding":He=Et[2].trim();break}}switch(++kt,He.toLowerCase()){case"base64":gt=Al(gl(pe.slice(kt).join("")));break;case"quoted-printable":gt=Ae(pe.slice(kt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+He)}var Ft=rt(he,Ne.slice(ye.length),gt,{unsafe:!0});Ge&&(Ft.ctype=Ge)}function We(he,pe){if(k(he.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ye=pe&&pe.root||"",Ne=(ir&&Buffer.isBuffer(he)?he.toString("binary"):k(he)).split(`\r
`),He=0,Ge="";for(He=0;He<Ne.length;++He)if(Ge=Ne[He],!!/^Content-Location:/i.test(Ge)&&(Ge=Ge.slice(Ge.indexOf("file")),ye||(ye=Ge.slice(0,Ge.lastIndexOf("/")+1)),Ge.slice(0,ye.length)!=ye))for(;ye.length>0&&(ye=ye.slice(0,ye.length-1),ye=ye.slice(0,ye.lastIndexOf("/")+1),Ge.slice(0,ye.length)!=ye););var gt=(Ne[1]||"").match(/boundary="(.*?)"/);if(!gt)throw new Error("MAD cannot find boundary");var kt="--"+(gt[1]||""),yt=[],Et=[],Ft={FileIndex:yt,FullPaths:Et};L(Ft);var Yt,rs=0;for(He=0;He<Ne.length;++He){var As=Ne[He];As!==kt&&As!==kt+"--"||(rs++&&je(Ft,Ne.slice(Yt,He),ye),Yt=He)}return Ft}function De(he,pe){var ye=pe||{},Ne=ye.boundary||"SheetJS";Ne="------="+Ne;for(var He=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Ne.slice(2)+'"',"","",""],Ge=he.FullPaths[0],gt=Ge,kt=he.FileIndex[0],yt=1;yt<he.FullPaths.length;++yt)if(gt=he.FullPaths[yt].slice(Ge.length),kt=he.FileIndex[yt],!(!kt.size||!kt.content||gt=="Sh33tJ5")){gt=gt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ps){return"_x"+Ps.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ps){return"_u"+Ps.charCodeAt(0).toString(16)+"_"});for(var Et=kt.content,Ft=ir&&Buffer.isBuffer(Et)?Et.toString("binary"):k(Et),Yt=0,rs=Math.min(1024,Ft.length),As=0,es=0;es<=rs;++es)(As=Ft.charCodeAt(es))>=32&&As<128&&++Yt;var Jt=Yt>=rs*4/5;He.push(Ne),He.push("Content-Location: "+(ye.root||"file:///C:/SheetJS/")+gt),He.push("Content-Transfer-Encoding: "+(Jt?"quoted-printable":"base64")),He.push("Content-Type: "+pt(kt,gt)),He.push(""),He.push(Jt?Ot(Ft):vt(Ft))}return He.push(Ne+`--\r
`),He.join(`\r
`)}function lt(he){var pe={};return L(pe,he),pe}function rt(he,pe,ye,Ne){var He=Ne&&Ne.unsafe;He||L(he);var Ge=!He&&Rs.find(he,pe);if(!Ge){var gt=he.FullPaths[0];pe.slice(0,gt.length)==gt?gt=pe:(gt.slice(-1)!="/"&&(gt+="/"),gt=(gt+pe).replace("//","/")),Ge={name:n(pe),type:2},he.FileIndex.push(Ge),he.FullPaths.push(gt),He||Rs.utils.cfb_gc(he)}return Ge.content=ye,Ge.size=ye?ye.length:0,Ne&&(Ne.CLSID&&(Ge.clsid=Ne.CLSID),Ne.mt&&(Ge.mt=Ne.mt),Ne.ct&&(Ge.ct=Ne.ct)),Ge}function et(he,pe){L(he);var ye=Rs.find(he,pe);if(ye){for(var Ne=0;Ne<he.FileIndex.length;++Ne)if(he.FileIndex[Ne]==ye)return he.FileIndex.splice(Ne,1),he.FullPaths.splice(Ne,1),!0}return!1}function Qt(he,pe,ye){L(he);var Ne=Rs.find(he,pe);if(Ne){for(var He=0;He<he.FileIndex.length;++He)if(he.FileIndex[He]==Ne)return he.FileIndex[He].name=n(ye),he.FullPaths[He]=ye,!0}return!1}function Qe(he){H(he,!0)}return s.find=V,s.read=P,s.parse=c,s.write=D,s.writeFile=T,s.utils={cfb_new:lt,cfb_add:rt,cfb_del:et,cfb_mov:Qt,cfb_gc:Qe,ReadShift:zm,CheckField:lk,prep_blob:Pn,bconcat:wn,use_zlib:C,_deflateRaw:ue,_inflateRaw:xe,consts:J},s})();function IQ(t){return typeof t=="string"?tg(t):Array.isArray(t)?nQ(t):t}function Qf(t,s,r){if(typeof Deno<"u"){if(r&&typeof s=="string")switch(r){case"utf8":s=new TextEncoder(r).encode(s);break;case"binary":s=tg(s);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,s)}var a=r=="utf8"?ic(s):s;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,t);if(typeof Blob<"u"){var n=new Blob([IQ(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(s)&&(s=gu(s)),o.write(s),o.close(),s}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function LQ(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var s=File(t);s.open("r"),s.encoding="binary";var r=s.read();return s.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+t)}function Ba(t){for(var s=Object.keys(t),r=[],a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(t,s[a])&&r.push(s[a]);return r}function J2(t,s){for(var r=[],a=Ba(t),n=0;n!==a.length;++n)r[t[a[n]][s]]==null&&(r[t[a[n]][s]]=a[n]);return r}function rg(t){for(var s=[],r=Ba(t),a=0;a!==r.length;++a)s[t[r[a]]]=r[a];return s}function ag(t){for(var s=[],r=Ba(t),a=0;a!==r.length;++a)s[t[r[a]]]=parseInt(r[a],10);return s}function DQ(t){for(var s=[],r=Ba(t),a=0;a!==r.length;++a)s[t[r[a]]]==null&&(s[t[r[a]]]=[]),s[t[r[a]]].push(r[a]);return s}var u0=new Date(1899,11,30,0,0,0);function cn(t,s){var r=t.getTime(),a=u0.getTime()+(t.getTimezoneOffset()-u0.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var Q4=new Date,UQ=u0.getTime()+(Q4.getTimezoneOffset()-u0.getTimezoneOffset())*6e4,Z2=Q4.getTimezoneOffset();function ng(t){var s=new Date;return s.setTime(t*24*60*60*1e3+UQ),s.getTimezoneOffset()!==Z2&&s.setTime(s.getTime()+(s.getTimezoneOffset()-Z2)*6e4),s}function PQ(t){var s=0,r=0,a=!1,n=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}s+=r*parseInt(n[i],10)}return s}var e_=new Date("2017-02-19T19:06:09.000Z"),M4=isNaN(e_.getFullYear())?new Date("2/19/17"):e_,RQ=M4.getFullYear()==2017;function la(t,s){var r=new Date(t);if(RQ)return s>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):s<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(M4.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return t.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function pA(t,s){if(ir&&Buffer.isBuffer(t)){if(s){if(t[0]==255&&t[1]==254)return ic(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ic(k4(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(s){if(t[0]==255&&t[1]==254)return ic(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ic(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=t.length;++n)a.push(String.fromCharCode(t[n]));return a.join("")}function oa(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var s={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=oa(t[r]));return s}function Ca(t,s){for(var r="";r.length<s;)r+=t;return r}function Bo(t){var s=Number(t);if(!isNaN(s))return isFinite(s)?s:NaN;if(!/\d/.test(t))return s;var r=1,a=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(s=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(s=Number(a)))?s/r:s}var OQ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Dh(t){var s=new Date(t),r=new Date(NaN),a=s.getYear(),n=s.getMonth(),i=s.getDate();if(isNaN(i))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&OQ.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?s:t.match(/[^-0-9:,\/\\]/)?r:s}var QQ=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(t||typeof a=="string")return r.split(a);for(var i=r.split(a),l=[i[0]],o=1;o<i.length;++o)l.push(n),l.push(i[o]);return l}})();function H4(t){return t?t.content&&t.type?pA(t.content,!0):t.data?Um(t.data):t.asNodeBuffer&&ir?Um(t.asNodeBuffer().toString("binary")):t.asBinary?Um(t.asBinary()):t._data&&t._data.getContent?Um(pA(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function q4(t){if(!t)return null;if(t.data)return H2(t.data);if(t.asNodeBuffer&&ir)return t.asNodeBuffer();if(t._data&&t._data.getContent){var s=t._data.getContent();return typeof s=="string"?H2(s):Array.prototype.slice.call(s)}return t.content&&t.type?t.content:null}function MQ(t){return t&&t.name.slice(-4)===".bin"?q4(t):H4(t)}function Ol(t,s){for(var r=t.FullPaths||Ba(t.files),a=s.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==l||n==l)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function pj(t,s){var r=Ol(t,s);if(r==null)throw new Error("Cannot find file "+s+" in zip");return r}function Za(t,s,r){if(!r)return MQ(pj(t,s));if(!s)return null;try{return Za(t,s)}catch{return null}}function hl(t,s,r){if(!r)return H4(pj(t,s));if(!s)return null;try{return hl(t,s)}catch{return null}}function HQ(t,s,r){return q4(pj(t,s))}function t_(t){for(var s=t.FullPaths||Ba(t.files),r=[],a=0;a<s.length;++a)s[a].slice(-1)!="/"&&r.push(s[a].replace(/^Root Entry[\/]/,""));return r.sort()}function nr(t,s,r){if(t.FullPaths){if(typeof r=="string"){var a;return ir?a=rd(r):a=iQ(r),Rs.utils.cfb_add(t,s,a)}Rs.utils.cfb_add(t,s,r)}else t.file(s,r)}function xj(){return Rs.utils.cfb_new()}function V4(t,s){switch(s.type){case"base64":return Rs.read(t,{type:"base64"});case"binary":return Rs.read(t,{type:"binary"});case"buffer":case"array":return Rs.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+s.type)}function Rm(t,s){if(t.charAt(0)=="/")return t.slice(1);var r=s.split("/");s.slice(-1)!="/"&&r.pop();for(var a=t.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var $a=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qQ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,s_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VQ=/<[^>]*>/g,mi=$a.match(s_)?s_:VQ,$Q=/<\w*:/,WQ=/<(\/?)\w+:/;function Gs(t,s,r){for(var a={},n=0,i=0;n!==t.length&&!((i=t.charCodeAt(n))===32||i===10||i===13);++n);if(s||(a[0]=t.slice(0,n)),n===t.length)return a;var l=t.match(qQ),o=0,u="",d=0,c="",h="",A=1;if(l)for(d=0;d!=l.length;++d){for(h=l[d],i=0;i!=h.length&&h.charCodeAt(i)!==61;++i);for(c=h.slice(0,i).trim();h.charCodeAt(i+1)==32;)++i;for(A=(n=h.charCodeAt(i+1))==34||n==39?1:0,u=h.slice(i+1+A,h.length-A),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),a[c]=u,a[c.toLowerCase()]=u;else{var f=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(a[f]&&c.slice(o-3,o)=="ext")continue;a[f]=u,a[f.toLowerCase()]=u}}return a}function Ac(t){return t.replace(WQ,"<$1")}var $4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gj=rg($4),yr=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,s=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(t,function(o,u){return $4[o]||String.fromCharCode(parseInt(u,o.indexOf("x")>-1?16:10))||o}).replace(s,function(o,u){return String.fromCharCode(parseInt(u,16))});var l=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,l)+r(n.slice(l+3))}})(),vj=/[&<>'"]/g,GQ=/[\u0000-\u0008\u000b-\u001f]/g;function qr(t){var s=t+"";return s.replace(vj,function(r){return gj[r]}).replace(GQ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function r_(t){return qr(t).replace(/ /g,"_x0020_")}var W4=/[\u0000-\u001f]/g;function bj(t){var s=t+"";return s.replace(vj,function(r){return gj[r]}).replace(/\n/g,"<br/>").replace(W4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function KQ(t){var s=t+"";return s.replace(vj,function(r){return gj[r]}).replace(W4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var a_=(function(){var t=/&#(\d+);/g;function s(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(t,s)}})();function zQ(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function na(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Xv(t){for(var s="",r=0,a=0,n=0,i=0,l=0,o=0;r<t.length;){if(a=t.charCodeAt(r++),a<128){s+=String.fromCharCode(a);continue}if(n=t.charCodeAt(r++),a>191&&a<224){l=(a&31)<<6,l|=n&63,s+=String.fromCharCode(l);continue}if(i=t.charCodeAt(r++),a<240){s+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}l=t.charCodeAt(r++),o=((a&7)<<18|(n&63)<<12|(i&63)<<6|l&63)-65536,s+=String.fromCharCode(55296+(o>>>10&1023)),s+=String.fromCharCode(56320+(o&1023))}return s}function n_(t){var s=Au(2*t.length),r,a,n=1,i=0,l=0,o;for(a=0;a<t.length;a+=n)n=1,(o=t.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(a+1)&63),n=2):o<240?(r=(o&15)*4096+(t.charCodeAt(a+1)&63)*64+(t.charCodeAt(a+2)&63),n=3):(n=4,r=(o&7)*262144+(t.charCodeAt(a+1)&63)*4096+(t.charCodeAt(a+2)&63)*64+(t.charCodeAt(a+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(s[i++]=l&255,s[i++]=l>>>8,l=0),s[i++]=r%256,s[i++]=r>>>8;return s.slice(0,i).toString("ucs2")}function i_(t){return rd(t,"binary").toString("utf8")}var dx="foo bar baz",$r=ir&&(i_(dx)==Xv(dx)&&i_||n_(dx)==Xv(dx)&&n_)||Xv,ic=ir?function(t){return rd(t,"utf8").toString("binary")}:function(t){for(var s=[],r=0,a=0,n=0;r<t.length;)switch(a=t.charCodeAt(r++),!0){case a<128:s.push(String.fromCharCode(a));break;case a<2048:s.push(String.fromCharCode(192+(a>>6))),s.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=t.charCodeAt(r++)-56320+(a<<10),s.push(String.fromCharCode(240+(n>>18&7))),s.push(String.fromCharCode(144+(n>>12&63))),s.push(String.fromCharCode(128+(n>>6&63))),s.push(String.fromCharCode(128+(n&63)));break;default:s.push(String.fromCharCode(224+(a>>12))),s.push(String.fromCharCode(128+(a>>6&63))),s.push(String.fromCharCode(128+(a&63)))}return s.join("")},gf=(function(){var t={};return function(r,a){var n=r+"|"+(a||"");return t[n]?t[n]:t[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),G4=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(s){return[new RegExp("&"+s[0]+";","ig"),s[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)a=a.replace(t[n][0],t[n][1]);return a}})(),YQ=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),XQ=/<\/?(?:vt:)?variant>/g,JQ=/<(?:vt:)([^>]*)>([\s\S]*)</;function l_(t,s){var r=Gs(t),a=t.match(YQ(r.baseType))||[],n=[];if(a.length!=r.size){if(s.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var l=i.replace(XQ,"").match(JQ);l&&n.push({v:$r(l[2]),t:l[1]})}),n}var K4=/(^\s|\s$|\n)/;function Rn(t,s){return"<"+t+(s.match(K4)?' xml:space="preserve"':"")+">"+s+"</"+t+">"}function vf(t){return Ba(t).map(function(s){return" "+s+'="'+t[s]+'"'}).join("")}function ps(t,s,r){return"<"+t+(r!=null?vf(r):"")+(s!=null?(s.match(K4)?' xml:space="preserve"':"")+">"+s+"</"+t:"/")+">"}function by(t,s){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(s)throw r}return""}function ZQ(t,s){switch(typeof t){case"string":var r=ps("vt:lpwstr",qr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ps((t|0)==t?"vt:i4":"vt:r8",qr(String(t)));case"boolean":return ps("vt:bool",t?"true":"false")}if(t instanceof Date)return ps("vt:filetime",by(t));throw new Error("Unable to serialize "+t)}function yj(t){if(ir&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return $r(gu(hj(t)));throw new Error("Bad input format: expected Buffer or string")}var bf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,on={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},jA=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function eM(t,s){for(var r=1-2*(t[s+7]>>>7),a=((t[s+7]&127)<<4)+(t[s+6]>>>4&15),n=t[s+6]&15,i=5;i>=0;--i)n=n*256+t[s+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function tM(t,s,r){var a=(s<0||1/s==-1/0?1:0)<<7,n=0,i=0,l=a?-s:s;isFinite(l)?l==0?n=i=0:(n=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(s)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(n&15)<<4|i&15,t[r+7]=n>>4|a}var o_=function(t){for(var s=[],r=10240,a=0;a<t[0].length;++a)if(t[0][a])for(var n=0,i=t[0][a].length;n<i;n+=r)s.push.apply(s,t[0][a].slice(n,n+r));return s},c_=ir?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(s){return Buffer.isBuffer(s)?s:rd(s)})):o_(t)}:o_,d_=function(t,s,r){for(var a=[],n=s;n<r;n+=2)a.push(String.fromCharCode(qc(t,n)));return a.join("").replace(Ti,"")},jj=ir?function(t,s,r){return Buffer.isBuffer(t)?t.toString("utf16le",s,r).replace(Ti,""):d_(t,s,r)}:d_,u_=function(t,s,r){for(var a=[],n=s;n<s+r;++n)a.push(("0"+t[n].toString(16)).slice(-2));return a.join("")},z4=ir?function(t,s,r){return Buffer.isBuffer(t)?t.toString("hex",s,s+r):u_(t,s,r)}:u_,A_=function(t,s,r){for(var a=[],n=s;n<r;n++)a.push(String.fromCharCode(ph(t,n)));return a.join("")},Mf=ir?function(s,r,a){return Buffer.isBuffer(s)?s.toString("utf8",r,a):A_(s,r,a)}:A_,Y4=function(t,s){var r=ul(t,s);return r>0?Mf(t,s+4,s+4+r-1):""},X4=Y4,J4=function(t,s){var r=ul(t,s);return r>0?Mf(t,s+4,s+4+r-1):""},Z4=J4,ek=function(t,s){var r=2*ul(t,s);return r>0?Mf(t,s+4,s+4+r-1):""},tk=ek,sk=function(s,r){var a=ul(s,r);return a>0?jj(s,r+4,r+4+a):""},rk=sk,ak=function(t,s){var r=ul(t,s);return r>0?Mf(t,s+4,s+4+r):""},nk=ak,ik=function(t,s){return eM(t,s)},A0=ik,Nj=function(s){return Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array};ir&&(X4=function(s,r){if(!Buffer.isBuffer(s))return Y4(s,r);var a=s.readUInt32LE(r);return a>0?s.toString("utf8",r+4,r+4+a-1):""},Z4=function(s,r){if(!Buffer.isBuffer(s))return J4(s,r);var a=s.readUInt32LE(r);return a>0?s.toString("utf8",r+4,r+4+a-1):""},tk=function(s,r){if(!Buffer.isBuffer(s))return ek(s,r);var a=2*s.readUInt32LE(r);return s.toString("utf16le",r+4,r+4+a-1)},rk=function(s,r){if(!Buffer.isBuffer(s))return sk(s,r);var a=s.readUInt32LE(r);return s.toString("utf16le",r+4,r+4+a)},nk=function(s,r){if(!Buffer.isBuffer(s))return ak(s,r);var a=s.readUInt32LE(r);return s.toString("utf8",r+4,r+4+a)},A0=function(s,r){return Buffer.isBuffer(s)?s.readDoubleLE(r):ik(s,r)},Nj=function(s){return Buffer.isBuffer(s)||Array.isArray(s)||typeof Uint8Array<"u"&&s instanceof Uint8Array});var ph=function(t,s){return t[s]},qc=function(t,s){return t[s+1]*256+t[s]},sM=function(t,s){var r=t[s+1]*256+t[s];return r<32768?r:(65535-r+1)*-1},ul=function(t,s){return t[s+3]*(1<<24)+(t[s+2]<<16)+(t[s+1]<<8)+t[s]},Ju=function(t,s){return t[s+3]<<24|t[s+2]<<16|t[s+1]<<8|t[s]},rM=function(t,s){return t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3]};function zm(t,s){var r="",a,n,i=[],l,o,u,d;switch(s){case"dbcs":if(d=this.l,ir&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(qc(this,d)),d+=2;t*=2;break;case"utf8":r=Mf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=jj(this,this.l,this.l+t);break;case"wstr":return zm.call(this,t,"dbcs");case"lpstr-ansi":r=X4(this,this.l),t=4+ul(this,this.l);break;case"lpstr-cp":r=Z4(this,this.l),t=4+ul(this,this.l);break;case"lpwstr":r=tk(this,this.l),t=4+2*ul(this,this.l);break;case"lpp4":t=4+ul(this,this.l),r=rk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ul(this,this.l),r=nk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=ph(this,this.l+t++))!==0;)i.push(cx(l));r=i.join("");break;case"_wstr":for(t=0,r="";(l=qc(this,this.l+t))!==0;)i.push(cx(l)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return l=ph(this,d),this.l=d+1,o=zm.call(this,t-u,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cx(qc(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(d)!==-1)return l=ph(this,d),this.l=d+1,o=zm.call(this,t-u,l?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(cx(ph(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return a=ph(this,this.l),this.l++,a;case 2:return a=(s==="i"?sM:qc)(this,this.l),this.l+=2,a;case 4:case-4:return s==="i"||(this[this.l+3]&128)===0?(a=(t>0?Ju:rM)(this,this.l),this.l+=4,a):(n=ul(this,this.l),this.l+=4,n);case 8:case-8:if(s==="f")return t==8?n=A0(this,this.l):n=A0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:r=z4(this,this.l,t);break}}return this.l+=t,r}var aM=function(t,s,r){t[r]=s&255,t[r+1]=s>>>8&255,t[r+2]=s>>>16&255,t[r+3]=s>>>24&255},nM=function(t,s,r){t[r]=s&255,t[r+1]=s>>8&255,t[r+2]=s>>16&255,t[r+3]=s>>24&255},iM=function(t,s,r){t[r]=s&255,t[r+1]=s>>>8&255};function lM(t,s,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=s.length;++n)iM(this,s.charCodeAt(n),this.l+2*n);a=2*s.length}else if(r==="sbcs"){for(s=s.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=s.length;++n)this[this.l+n]=s.charCodeAt(n)&255;a=s.length}else if(r==="hex"){for(;n<t;++n)this[this.l++]=parseInt(s.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(n=0;n<Math.min(s.length,t);++n){var l=s.charCodeAt(n);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:a=1,this[this.l]=s&255;break;case 2:a=2,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255;break;case 3:a=3,this[this.l]=s&255,s>>>=8,this[this.l+1]=s&255,s>>>=8,this[this.l+2]=s&255;break;case 4:a=4,aM(this,s,this.l);break;case 8:if(a=8,r==="f"){tM(this,s,this.l);break}case 16:break;case-4:a=4,nM(this,s,this.l);break}return this.l+=a,this}function lk(t,s){var r=z4(this,this.l,t.length>>1);if(r!==t)throw new Error(s+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Pn(t,s){t.l=s,t.read_shift=zm,t.chk=lk,t.write_shift=lM}function hi(t,s){t.l+=s}function Kt(t){var s=Au(t);return Pn(s,0),s}function ad(t,s,r){if(t){var a,n,i;Pn(t,t.l||0);for(var l=t.length,o=0,u=0;t.l<l;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var d=Sf[o]||Sf[65535];for(a=t.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=t.read_shift(1))&127)<<7*n;u=t.l+i;var c=d.f&&d.f(t,i,r);if(t.l=u,s(c,d,o))return}}}function Yi(){var t=[],s=ir?256:2048,r=function(d){var c=Kt(d);return Pn(c,0),c},a=r(s),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&t.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(n(),a=r(Math.max(d+1,s)))},l=function(){return n(),wn(t)},o=function(d){n(),a=d,a.l==null&&(a.l=a.length),i(s)};return{next:i,push:o,end:l,_bufs:t}}function as(t,s,r,a){var n=+s,i;if(!isNaN(n)){a||(a=Sf[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var l=t.next(i);n<=127?l.write_shift(1,n):(l.write_shift(1,(n&127)+128),l.write_shift(1,n>>7));for(var o=0;o!=4;++o)if(a>=128)l.write_shift(1,(a&127)+128),a>>=7;else{l.write_shift(1,a);break}a>0&&Nj(r)&&t.push(r)}}function Ym(t,s,r){var a=oa(t);if(s.s?(a.cRel&&(a.c+=s.s.c),a.rRel&&(a.r+=s.s.r)):(a.cRel&&(a.c+=s.c),a.rRel&&(a.r+=s.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function h_(t,s,r){var a=oa(t);return a.s=Ym(a.s,s.s,r),a.e=Ym(a.e,s.s,r),a}function Xm(t,s){if(t.cRel&&t.c<0)for(t=oa(t);t.c<0;)t.c+=s>8?16384:256;if(t.rRel&&t.r<0)for(t=oa(t);t.r<0;)t.r+=s>8?1048576:s>5?65536:16384;var r=$s(t);return!t.cRel&&t.cRel!=null&&(r=dM(r)),!t.rRel&&t.rRel!=null&&(r=oM(r)),r}function Jv(t,s){return t.s.r==0&&!t.s.rRel&&t.e.r==(s.biff>=12?1048575:s.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+xa(t.s.c)+":"+(t.e.cRel?"":"$")+xa(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(s.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+qa(t.s.r)+":"+(t.e.rRel?"":"$")+qa(t.e.r):Xm(t.s,s.biff)+":"+Xm(t.e,s.biff)}function wj(t){return parseInt(cM(t),10)-1}function qa(t){return""+(t+1)}function oM(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function cM(t){return t.replace(/\$(\d+)$/,"$1")}function _j(t){for(var s=uM(t),r=0,a=0;a!==s.length;++a)r=26*r+s.charCodeAt(a)-64;return r-1}function xa(t){if(t<0)throw new Error("invalid column "+t);var s="";for(++t;t;t=Math.floor((t-1)/26))s=String.fromCharCode((t-1)%26+65)+s;return s}function dM(t){return t.replace(/^([A-Z])/,"$$$1")}function uM(t){return t.replace(/^\$([A-Z])/,"$1")}function AM(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ga(t){for(var s=0,r=0,a=0;a<t.length;++a){var n=t.charCodeAt(a);n>=48&&n<=57?s=10*s+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:s-1}}function $s(t){for(var s=t.c+1,r="";s;s=(s-1)/26|0)r=String.fromCharCode((s-1)%26+65)+r;return r+(t.r+1)}function Xi(t){var s=t.indexOf(":");return s==-1?{s:ga(t),e:ga(t)}:{s:ga(t.slice(0,s)),e:ga(t.slice(s+1))}}function ar(t,s){return typeof s>"u"||typeof s=="number"?ar(t.s,t.e):(typeof t!="string"&&(t=$s(t)),typeof s!="string"&&(s=$s(s)),t==s?t:t+":"+s)}function jr(t){var s={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=t.length;for(r=0;a<i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(s.s.c=--r,r=0;a<i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(s.s.r=--r,a===i||n!=10)return s.e.c=s.s.c,s.e.r=s.s.r,s;for(++a,r=0;a!=i&&!((n=t.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(s.e.c=--r,r=0;a!=i&&!((n=t.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return s.e.r=--r,s}function m_(t,s){var r=t.t=="d"&&s instanceof Date;if(t.z!=null)try{return t.w=Wl(t.z,r?cn(s):s)}catch{}try{return t.w=Wl((t.XF||{}).numFmtId||(r?14:0),r?cn(s):s)}catch{return""+s}}function Zc(t,s,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?nd[t.v]||t.v:s==null?m_(t,t.v):m_(t,s))}function vu(t,s){var r=s&&s.sheet?s.sheet:"Sheet1",a={};return a[r]=t,{SheetNames:[r],Sheets:a}}function ok(t,s,r){var a=r||{},n=t?Array.isArray(t):a.dense,i=t||(n?[]:{}),l=0,o=0;if(i&&a.origin!=null){if(typeof a.origin=="number")l=a.origin;else{var u=typeof a.origin=="string"?ga(a.origin):a.origin;l=u.r,o=u.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var c=jr(i["!ref"]);d.s.c=c.s.c,d.s.r=c.s.r,d.e.c=Math.max(d.e.c,c.e.c),d.e.r=Math.max(d.e.r,c.e.r),l==-1&&(d.e.r=l=c.e.r+1)}for(var h=0;h!=s.length;++h)if(s[h]){if(!Array.isArray(s[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var A=0;A!=s[h].length;++A)if(!(typeof s[h][A]>"u")){var f={v:s[h][A]},g=l+h,v=o+A;if(d.s.r>g&&(d.s.r=g),d.s.c>v&&(d.s.c=v),d.e.r<g&&(d.e.r=g),d.e.c<v&&(d.e.c=v),s[h][A]&&typeof s[h][A]=="object"&&!Array.isArray(s[h][A])&&!(s[h][A]instanceof Date))f=s[h][A];else if(Array.isArray(f.v)&&(f.f=s[h][A][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(a.nullError)f.t="e",f.v=0;else if(a.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=a.dateNF||Hs[14],a.cellDates?(f.t="d",f.w=Wl(f.z,cn(f.v))):(f.t="n",f.v=cn(f.v),f.w=Wl(f.z,f.v))):f.t="s";if(n)i[g]||(i[g]=[]),i[g][v]&&i[g][v].z&&(f.z=i[g][v].z),i[g][v]=f;else{var b=$s({c:v,r:g});i[b]&&i[b].z&&(f.z=i[b].z),i[b]=f}}}return d.s.c<1e7&&(i["!ref"]=ar(d)),i}function Kh(t,s){return ok(null,t,s)}function hM(t){return t.read_shift(4,"i")}function Eo(t,s){return s||(s=Kt(4)),s.write_shift(4,t),s}function ui(t){var s=t.read_shift(4);return s===0?"":t.read_shift(s,"dbcs")}function _n(t,s){var r=!1;return s==null&&(r=!0,s=Kt(4+2*t.length)),s.write_shift(4,t.length),t.length>0&&s.write_shift(0,t,"dbcs"),r?s.slice(0,s.l):s}function mM(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function fM(t,s){return s||(s=Kt(4)),s.write_shift(2,0),s.write_shift(2,0),s}function Sj(t,s){var r=t.l,a=t.read_shift(1),n=ui(t),i=[],l={t:n,h:n};if((a&1)!==0){for(var o=t.read_shift(4),u=0;u!=o;++u)i.push(mM(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=r+s,l}function pM(t,s){var r=!1;return s==null&&(r=!0,s=Kt(15+4*t.t.length)),s.write_shift(1,0),_n(t.t,s),r?s.slice(0,s.l):s}var xM=Sj;function gM(t,s){var r=!1;return s==null&&(r=!0,s=Kt(23+4*t.t.length)),s.write_shift(1,1),_n(t.t,s),s.write_shift(4,1),fM({},s),r?s.slice(0,s.l):s}function Kl(t){var s=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:s,iStyleRef:r}}function NA(t,s){return s==null&&(s=Kt(8)),s.write_shift(-4,t.c),s.write_shift(3,t.iStyleRef||t.s),s.write_shift(1,0),s}function wA(t){var s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:s}}function _A(t,s){return s==null&&(s=Kt(4)),s.write_shift(3,t.iStyleRef||t.s),s.write_shift(1,0),s}var vM=ui,ck=_n;function Cj(t){var s=t.read_shift(4);return s===0||s===4294967295?"":t.read_shift(s,"dbcs")}function h0(t,s){var r=!1;return s==null&&(r=!0,s=Kt(127)),s.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&s.write_shift(0,t,"dbcs"),r?s.slice(0,s.l):s}var bM=ui,yy=Cj,kj=h0;function Bj(t){var s=t.slice(t.l,t.l+4),r=s[0]&1,a=s[0]&2;t.l+=4;var n=a===0?A0([0,0,0,0,s[0]&252,s[1],s[2],s[3]],0):Ju(s,0)>>2;return r?n/100:n}function dk(t,s){s==null&&(s=Kt(4));var r=0,a=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)s.write_shift(-4,((r?n:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function uk(t){var s={s:{},e:{}};return s.s.r=t.read_shift(4),s.e.r=t.read_shift(4),s.s.c=t.read_shift(4),s.e.c=t.read_shift(4),s}function yM(t,s){return s||(s=Kt(16)),s.write_shift(4,t.s.r),s.write_shift(4,t.e.r),s.write_shift(4,t.s.c),s.write_shift(4,t.e.c),s}var SA=uk,zh=yM;function di(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function xA(t,s){return(s||Kt(8)).write_shift(8,t,"f")}function jM(t){var s={},r=t.read_shift(1),a=r>>>1,n=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(1);switch(t.l++,a){case 0:s.auto=1;break;case 1:s.index=n;var d=cA[n];d&&(s.rgb=jf(d));break;case 2:s.rgb=jf([l,o,u]);break;case 3:s.theme=n;break}return i!=0&&(s.tint=i>0?i/32767:i/32768),s}function m0(t,s){if(s||(s=Kt(8)),!t||t.auto)return s.write_shift(4,0),s.write_shift(4,0),s;t.index!=null?(s.write_shift(1,2),s.write_shift(1,t.index)):t.theme!=null?(s.write_shift(1,6),s.write_shift(1,t.theme)):(s.write_shift(1,5),s.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),s.write_shift(2,r),!t.rgb||t.theme!=null)s.write_shift(2,0),s.write_shift(1,0),s.write_shift(1,0);else{var a=t.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),s.write_shift(1,parseInt(a.slice(0,2),16)),s.write_shift(1,parseInt(a.slice(2,4),16)),s.write_shift(1,parseInt(a.slice(4,6),16)),s.write_shift(1,255)}return s}function NM(t){var s=t.read_shift(1);t.l++;var r={fBold:s&1,fItalic:s&2,fUnderline:s&4,fStrikeout:s&8,fOutline:s&16,fShadow:s&32,fCondense:s&64,fExtend:s&128};return r}function wM(t,s){s||(s=Kt(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return s.write_shift(1,r),s.write_shift(1,0),s}function Ak(t,s){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=t.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return t.l-=4,t.read_shift(0,s==1?"lpstr":"lpwstr")}function _M(t){return Ak(t,1)}function SM(t){return Ak(t,2)}var Ej=2,Wi=3,ux=11,f_=12,f0=19,Ax=64,CM=65,kM=71,BM=4108,EM=4126,jn=80,hk=81,FM=[jn,hk],jy={1:{n:"CodePage",t:Ej},2:{n:"Category",t:jn},3:{n:"PresentationFormat",t:jn},4:{n:"ByteCount",t:Wi},5:{n:"LineCount",t:Wi},6:{n:"ParagraphCount",t:Wi},7:{n:"SlideCount",t:Wi},8:{n:"NoteCount",t:Wi},9:{n:"HiddenCount",t:Wi},10:{n:"MultimediaClipCount",t:Wi},11:{n:"ScaleCrop",t:ux},12:{n:"HeadingPairs",t:BM},13:{n:"TitlesOfParts",t:EM},14:{n:"Manager",t:jn},15:{n:"Company",t:jn},16:{n:"LinksUpToDate",t:ux},17:{n:"CharacterCount",t:Wi},19:{n:"SharedDoc",t:ux},22:{n:"HyperlinksChanged",t:ux},23:{n:"AppVersion",t:Wi,p:"version"},24:{n:"DigSig",t:CM},26:{n:"ContentType",t:jn},27:{n:"ContentStatus",t:jn},28:{n:"Language",t:jn},29:{n:"Version",t:jn},255:{},2147483648:{n:"Locale",t:f0},2147483651:{n:"Behavior",t:f0},1919054434:{}},Ny={1:{n:"CodePage",t:Ej},2:{n:"Title",t:jn},3:{n:"Subject",t:jn},4:{n:"Author",t:jn},5:{n:"Keywords",t:jn},6:{n:"Comments",t:jn},7:{n:"Template",t:jn},8:{n:"LastAuthor",t:jn},9:{n:"RevNumber",t:jn},10:{n:"EditTime",t:Ax},11:{n:"LastPrinted",t:Ax},12:{n:"CreatedDate",t:Ax},13:{n:"ModifiedDate",t:Ax},14:{n:"PageCount",t:Wi},15:{n:"WordCount",t:Wi},16:{n:"CharCount",t:Wi},17:{n:"Thumbnail",t:kM},18:{n:"Application",t:jn},19:{n:"DocSecurity",t:Wi},255:{},2147483648:{n:"Locale",t:f0},2147483651:{n:"Behavior",t:f0},1919054434:{}},p_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},TM=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IM(t){return t.map(function(s){return[s>>16&255,s>>8&255,s&255]})}var LM=IM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),cA=oa(LM),nd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},wy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},hx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fj(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function DM(t){var s=Fj();if(!t||!t.match)return s;var r={};if((t.match(mi)||[]).forEach(function(a){var n=Gs(a);switch(n[0].replace($Q,"<")){case"<?xml":break;case"<Types":s.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":s[wy[n.ContentType]]!==void 0&&s[wy[n.ContentType]].push(n.PartName);break}}),s.xmlns!==on.CT)throw new Error("Unknown Namespace: "+s.xmlns);return s.calcchain=s.calcchains.length>0?s.calcchains[0]:"",s.sst=s.strs.length>0?s.strs[0]:"",s.style=s.styles.length>0?s.styles[0]:"",s.defaults=r,delete s.calcchains,s}function fk(t,s){var r=DQ(wy),a=[],n;a[a.length]=$a,a[a.length]=ps("Types",null,{xmlns:on.CT,"xmlns:xsd":on.xsd,"xmlns:xsi":on.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return ps("Default",null,{Extension:u[0],ContentType:u[1]})}));var i=function(u){t[u]&&t[u].length>0&&(n=t[u][0],a[a.length]=ps("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:hx[u][s.bookType]||hx[u].xlsx}))},l=function(u){(t[u]||[]).forEach(function(d){a[a.length]=ps("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:hx[u][s.bookType]||hx[u].xlsx})})},o=function(u){(t[u]||[]).forEach(function(d){a[a.length]=ps("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[u][0]})})};return i("workbooks"),l("sheets"),l("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),l("metadata"),o("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var dr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function yf(t){var s=t.lastIndexOf("/");return t.slice(0,s+1)+"_rels/"+t.slice(s+1)+".rels"}function Jm(t,s){var r={"!id":{}};if(!t)return r;s.charAt(0)!=="/"&&(s="/"+s);var a={};return(t.match(mi)||[]).forEach(function(n){var i=Gs(n);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Rm(i.Target,s);r[o]=l,a[i.Id]=l}}),r["!id"]=a,r}function Ch(t){var s=[$a,ps("Relationships",null,{xmlns:on.RELS})];return Ba(t["!id"]).forEach(function(r){s[s.length]=ps("Relationship",null,t["!id"][r])}),s.length>2&&(s[s.length]="</Relationships>",s[1]=s[1].replace("/>",">")),s.join("")}function Mr(t,s,r,a,n,i){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),s<0)for(s=t["!idx"];t["!id"]["rId"+s];++s);if(t["!idx"]=s+1,n.Id="rId"+s,n.Type=a,n.Target=r,[dr.HLINK,dr.XPATH,dr.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+s);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,s}var UM="application/vnd.oasis.opendocument.spreadsheet";function PM(t,s){for(var r=yj(t),a,n;a=bf.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=Gs(a[0],!1),n.path=="/"&&n.type!==UM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(s&&s.WTF)throw a}}function RM(t){var s=[$a];s.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),s.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)s.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return s.push("</manifest:manifest>"),s.join("")}function x_(t,s,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+s+`"/>
`,`  </rdf:Description>
`].join("")}function OM(t,s){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+s+`"/>
`,`  </rdf:Description>
`].join("")}function QM(t){var s=[$a];s.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)s.push(x_(t[r][0],t[r][1])),s.push(OM("",t[r][0]));return s.push(x_("","Document","pkg")),s.push("</rdf:RDF>"),s.join("")}function pk(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+l0.version+"</meta:generator></office:meta></office:document-meta>"}var $l=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MM=(function(){for(var t=new Array($l.length),s=0;s<$l.length;++s){var r=$l[s],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[s]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return t})();function xk(t){var s={};t=$r(t);for(var r=0;r<$l.length;++r){var a=$l[r],n=t.match(MM[r]);n!=null&&n.length>0&&(s[a[1]]=yr(n[1])),a[2]==="date"&&s[a[1]]&&(s[a[1]]=la(s[a[1]]))}return s}function Zv(t,s,r,a,n){n[t]!=null||s==null||s===""||(n[t]=s,s=qr(s),a[a.length]=r?ps(t,s,r):Rn(t,s))}function gk(t,s){var r=s||{},a=[$a,ps("cp:coreProperties",null,{"xmlns:cp":on.CORE_PROPS,"xmlns:dc":on.dc,"xmlns:dcterms":on.dcterms,"xmlns:dcmitype":on.dcmitype,"xmlns:xsi":on.xsi})],n={};if(!t&&!r.Props)return a.join("");t&&(t.CreatedDate!=null&&Zv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:by(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),t.ModifiedDate!=null&&Zv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:by(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=$l.length;++i){var l=$l[i],o=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Zv(l[0],o,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var dA=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vk=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function bk(t,s,r,a){var n=[];if(typeof t=="string")n=l_(t,a);else for(var i=0;i<t.length;++i)n=n.concat(t[i].map(function(c){return{v:c}}));var l=typeof s=="string"?l_(s,a).map(function(c){return c.v}):s,o=0,u=0;if(l.length>0)for(var d=0;d!==n.length;d+=2){switch(u=+n[d+1].v,n[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=l.slice(o,o+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=l.slice(o,o+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=l.slice(o,o+u);break}o+=u}}function HM(t,s,r){var a={};return s||(s={}),t=$r(t),dA.forEach(function(n){var i=(t.match(gf(n[0]))||[])[1];switch(n[2]){case"string":i&&(s[n[1]]=yr(i));break;case"bool":s[n[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));l&&l.length>0&&(a[n[1]]=l[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&bk(a.HeadingPairs,a.TitlesOfParts,s,r),s}function yk(t){var s=[],r=ps;return t||(t={}),t.Application="SheetJS",s[s.length]=$a,s[s.length]=ps("Properties",null,{xmlns:on.EXT_PROPS,"xmlns:vt":on.vt}),dA.forEach(function(a){if(t[a[1]]!==void 0){var n;switch(a[2]){case"string":n=qr(String(t[a[1]]));break;case"bool":n=t[a[1]]?"true":"false";break}n!==void 0&&(s[s.length]=r(a[0],n))}}),s[s.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),s[s.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(a){return"<vt:lpstr>"+qr(a)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var qM=/<[^>]+>[^<]*/g;function VM(t,s){var r={},a="",n=t.match(qM);if(n)for(var i=0;i!=n.length;++i){var l=n[i],o=Gs(l);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=yr(o.name);break;case"</property>":a=null;break;default:if(l.indexOf("<vt:")===0){var u=l.split(">"),d=u[0].slice(4),c=u[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=yr(c);break;case"bool":r[a]=na(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(c,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(c);break;case"filetime":case"date":r[a]=la(c);break;case"cy":case"error":r[a]=yr(c);break;default:if(d.slice(-1)=="/")break;s.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,u)}}else if(l.slice(0,2)!=="</"){if(s.WTF)throw new Error(l)}}}return r}function jk(t){var s=[$a,ps("Properties",null,{xmlns:on.CUST_PROPS,"xmlns:vt":on.vt})];if(!t)return s.join("");var r=1;return Ba(t).forEach(function(n){++r,s[s.length]=ps("property",ZQ(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:qr(n)})}),s.length>2&&(s[s.length]="</Properties>",s[1]=s[1].replace("/>",">")),s.join("")}var _y={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},eb;function $M(t,s,r){eb||(eb=rg(_y)),s=eb[s]||s,t[s]=r}function WM(t,s){var r=[];return Ba(_y).map(function(a){for(var n=0;n<$l.length;++n)if($l[n][1]==a)return $l[n];for(n=0;n<dA.length;++n)if(dA[n][1]==a)return dA[n];throw a}).forEach(function(a){if(t[a[1]]!=null){var n=s&&s.Props&&s.Props[a[1]]!=null?s.Props[a[1]]:t[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Rn(_y[a[1]]||a[1],n))}}),ps("DocumentProperties",r.join(""),{xmlns:dl.o})}function GM(t,s){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return t&&Ba(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var l=0;l<$l.length;++l)if(i==$l[l][1])return;for(l=0;l<dA.length;++l)if(i==dA[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var o=t[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o=String(o),n.push(ps(r_(i),o,{"dt:dt":u}))}}),s&&Ba(s).forEach(function(i){if(Object.prototype.hasOwnProperty.call(s,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var l=s[i],o="string";typeof l=="number"?(o="float",l=String(l)):l===!0||l===!1?(o="boolean",l=l?"1":"0"):l instanceof Date?(o="dateTime.tz",l=l.toISOString()):l=String(l),n.push(ps(r_(i),l,{"dt:dt":o}))}}),"<"+a+' xmlns="'+dl.o+'">'+n.join("")+"</"+a+">"}function Tj(t){var s=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+s/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function KM(t){var s=typeof t=="string"?new Date(Date.parse(t)):t,r=s.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var l=Kt(8);return l.write_shift(4,a),l.write_shift(4,n),l}function Nk(t,s,r){var a=t.l,n=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-a&3;)++t.l;return n}function wk(t,s,r){var a=t.read_shift(0,"lpwstr");return a}function _k(t,s,r){return s===31?wk(t):Nk(t,s,r)}function Sy(t,s,r){return _k(t,s,r===!1?0:4)}function zM(t,s){if(!s)throw new Error("VtUnalignedString must have positive length");return _k(t,s,0)}function YM(t){for(var s=t.read_shift(4),r=[],a=0;a!=s;++a){var n=t.l;r[a]=t.read_shift(0,"lpwstr").replace(Ti,""),t.l-n&2&&(t.l+=2)}return r}function XM(t){for(var s=t.read_shift(4),r=[],a=0;a!=s;++a)r[a]=t.read_shift(0,"lpstr-cp").replace(Ti,"");return r}function JM(t){var s=t.l,r=p0(t,hk);t[t.l]==0&&t[t.l+1]==0&&t.l-s&2&&(t.l+=2);var a=p0(t,Wi);return[r,a]}function ZM(t){for(var s=t.read_shift(4),r=[],a=0;a<s/2;++a)r.push(JM(t));return r}function g_(t,s){for(var r=t.read_shift(4),a={},n=0;n!=r;++n){var i=t.read_shift(4),l=t.read_shift(4);a[i]=t.read_shift(l,s===1200?"utf16le":"utf8").replace(Ti,"").replace(Pm,"!"),s===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),a}function Sk(t){var s=t.read_shift(4),r=t.slice(t.l,t.l+s);return t.l+=s,(s&3)>0&&(t.l+=4-(s&3)&3),r}function e7(t){var s={};return s.Size=t.read_shift(4),t.l+=s.Size+3-(s.Size-1)%4,s}function p0(t,s,r){var a=t.read_shift(2),n,i=r||{};if(t.l+=2,s!==f_&&a!==s&&FM.indexOf(s)===-1&&!((s&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+s+" saw "+a);switch(s===f_?a:s){case 2:return n=t.read_shift(2,"i"),i.raw||(t.l+=2),n;case 3:return n=t.read_shift(4,"i"),n;case 11:return t.read_shift(4)!==0;case 19:return n=t.read_shift(4),n;case 30:return Nk(t,a,4).replace(Ti,"");case 31:return wk(t);case 64:return Tj(t);case 65:return Sk(t);case 71:return e7(t);case 80:return Sy(t,a,!i.raw).replace(Ti,"");case 81:return zM(t,a).replace(Ti,"");case 4108:return ZM(t);case 4126:case 4127:return a==4127?YM(t):XM(t);default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+a)}}function v_(t,s){var r=Kt(4),a=Kt(4);switch(r.write_shift(4,t==80?31:t),t){case 3:a.write_shift(-4,s);break;case 5:a=Kt(8),a.write_shift(8,s,"f");break;case 11:a.write_shift(4,s?1:0);break;case 64:a=KM(s);break;case 31:case 80:for(a=Kt(4+2*(s.length+1)+(s.length%2?0:2)),a.write_shift(4,s.length+1),a.write_shift(0,s,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+s)}return wn([r,a])}function b_(t,s){var r=t.l,a=t.read_shift(4),n=t.read_shift(4),i=[],l=0,o=0,u=-1,d={};for(l=0;l!=n;++l){var c=t.read_shift(4),h=t.read_shift(4);i[l]=[c,h+r]}i.sort(function(j,N){return j[1]-N[1]});var A={};for(l=0;l!=n;++l){if(t.l!==i[l][1]){var f=!0;if(l>0&&s)switch(s[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,f=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],f=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],f=!1);break}if((!s||l==0)&&t.l<=i[l][1]&&(f=!1,t.l=i[l][1]),f)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(s){var g=s[i[l][0]];if(A[g.n]=p0(t,g.t,{raw:!0}),g.p==="version"&&(A[g.n]=String(A[g.n]>>16)+"."+("0000"+String(A[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(A[g.n]){case 0:A[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Co(o=A[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+A[g.n])}}else if(i[l][0]===1){if(o=A.CodePage=p0(t,Ej),Co(o),u!==-1){var v=t.l;t.l=i[u][1],d=g_(t,o),t.l=v}}else if(i[l][0]===0){if(o===0){u=l,t.l=i[l+1][1];continue}d=g_(t,o)}else{var b=d[i[l][0]],y;switch(t[t.l]){case 65:t.l+=4,y=Sk(t);break;case 30:t.l+=4,y=Sy(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,y=Sy(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,y=t.read_shift(4,"i");break;case 19:t.l+=4,y=t.read_shift(4);break;case 5:t.l+=4,y=t.read_shift(8,"f");break;case 11:t.l+=4,y=Ra(t,4);break;case 64:t.l+=4,y=la(Tj(t));break;default:throw new Error("unparsed value: "+t[t.l])}A[b]=y}}return t.l=r+a,A}var Ck=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function t7(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function y_(t,s,r){var a=Kt(8),n=[],i=[],l=8,o=0,u=Kt(8),d=Kt(8);if(u.write_shift(4,2),u.write_shift(4,1200),d.write_shift(4,1),i.push(u),n.push(d),l+=8+u.length,!s){d=Kt(8),d.write_shift(4,0),n.unshift(d);var c=[Kt(4)];for(c[0].write_shift(4,t.length),o=0;o<t.length;++o){var h=t[o][0];for(u=Kt(8+2*(h.length+1)+(h.length%2?0:2)),u.write_shift(4,o+2),u.write_shift(4,h.length+1),u.write_shift(0,h,"dbcs");u.l!=u.length;)u.write_shift(1,0);c.push(u)}u=wn(c),i.unshift(u),l+=8+u.length}for(o=0;o<t.length;++o)if(!(s&&!s[t[o][0]])&&!(Ck.indexOf(t[o][0])>-1||vk.indexOf(t[o][0])>-1)&&t[o][1]!=null){var A=t[o][1],f=0;if(s){f=+s[t[o][0]];var g=r[f];if(g.p=="version"&&typeof A=="string"){var v=A.split(".");A=(+v[0]<<16)+(+v[1]||0)}u=v_(g.t,A)}else{var b=t7(A);b==-1&&(b=31,A=String(A)),u=v_(b,A)}i.push(u),d=Kt(8),d.write_shift(4,s?f:2+o),n.push(d),l+=8+u.length}var y=8*(i.length+1);for(o=0;o<i.length;++o)n[o].write_shift(4,y),y+=i[o].length;return a.write_shift(4,l),a.write_shift(4,i.length),wn([a].concat(n).concat(i))}function j_(t,s,r){var a=t.content;if(!a)return{};Pn(a,0);var n,i,l,o,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),c=a.read_shift(16);if(c!==Rs.utils.consts.HEADER_CLSID&&c!==r)throw new Error("Bad PropertySet CLSID "+c);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),o=a.read_shift(4),n===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);n===2&&(l=a.read_shift(16),u=a.read_shift(4));var h=b_(a,s),A={SystemIdentifier:d};for(var f in h)A[f]=h[f];if(A.FMTID=i,n===1)return A;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var g;try{g=b_(a,null)}catch{}for(f in g)A[f]=g[f];return A.FMTID=[i,l],A}function N_(t,s,r,a,n,i){var l=Kt(n?68:48),o=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Rs.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,n?2:1),l.write_shift(16,s,"hex"),l.write_shift(4,n?68:48);var u=y_(t,r,a);if(o.push(u),n){var d=y_(n,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+u.length),o.push(d)}return wn(o)}function Vd(t,s){return t.read_shift(s),null}function s7(t,s){s||(s=Kt(t));for(var r=0;r<t;++r)s.write_shift(1,0);return s}function r7(t,s,r){for(var a=[],n=t.l+s;t.l<n;)a.push(r(t,n-t.l));if(n!==t.l)throw new Error("Slurp error");return a}function Ra(t,s){return t.read_shift(s)===1}function Ei(t,s){return s||(s=Kt(2)),s.write_shift(2,+!!t),s}function en(t){return t.read_shift(2,"u")}function Ql(t,s){return s||(s=Kt(2)),s.write_shift(2,t),s}function kk(t,s){return r7(t,s,en)}function a7(t){var s=t.read_shift(1),r=t.read_shift(1);return r===1?s:s===1}function Bk(t,s,r){return r||(r=Kt(2)),r.write_shift(1,s=="e"?+t:+!!t),r.write_shift(1,s=="e"?1:0),r}function Hf(t,s,r){var a=t.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var l=a?t.read_shift(a,n):"";return l}function n7(t){var s=t.read_shift(2),r=t.read_shift(1),a=r&4,n=r&8,i=1+(r&1),l=0,o,u={};n&&(l=t.read_shift(2)),a&&(o=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",c=s===0?"":t.read_shift(s,d);return n&&(t.l+=4*l),a&&(t.l+=o),u.t=c,n||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function i7(t){var s=t.t||"",r=Kt(3);r.write_shift(2,s.length),r.write_shift(1,1);var a=Kt(2*s.length);a.write_shift(2*s.length,s,"utf16le");var n=[r,a];return wn(n)}function gA(t,s,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(s,"cpstr");if(r.biff>=12)return t.read_shift(s,"dbcs-cont")}var n=t.read_shift(1);return n===0?a=t.read_shift(s,"sbcs-cont"):a=t.read_shift(s,"dbcs-cont"),a}function qf(t,s,r){var a=t.read_shift(r&&r.biff==2?1:2);return a===0?(t.l++,""):gA(t,a,r)}function CA(t,s,r){if(r.biff>5)return qf(t,s,r);var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Ek(t,s,r){return r||(r=Kt(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function l7(t){var s=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[s,r]}function o7(t){var s=t.read_shift(4),r=t.l,a=!1;s>24&&(t.l+=s-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),t.l=r);var n=t.read_shift((a?s-24:s)>>1,"utf16le").replace(Ti,"");return a&&(t.l+=24),n}function c7(t){for(var s=t.read_shift(2),r="";s-- >0;)r+="../";var a=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=t.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(Ti,"");return r+l}function d7(t,s){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return o7(t);case"0303000000000000c000000000000046":return c7(t);default:throw new Error("Unsupported Moniker "+r)}}function mx(t){var s=t.read_shift(4),r=s>0?t.read_shift(s,"utf16le").replace(Ti,""):"";return r}function w_(t,s){s||(s=Kt(6+t.length*2)),s.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)s.write_shift(2,t.charCodeAt(r));return s.write_shift(2,0),s}function u7(t,s){var r=t.l+s,a=t.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=t.read_shift(2);t.l+=2;var i,l,o,u,d="",c,h;n&16&&(i=mx(t,r-t.l)),n&128&&(l=mx(t,r-t.l)),(n&257)===257&&(o=mx(t,r-t.l)),(n&257)===1&&(u=d7(t,r-t.l)),n&8&&(d=mx(t,r-t.l)),n&32&&(c=t.read_shift(16)),n&64&&(h=Tj(t)),t.l=r;var A=l||o||u||"";A&&d&&(A+="#"+d),A||(A="#"+d),n&2&&A.charAt(0)=="/"&&A.charAt(1)!="/"&&(A="file://"+A);var f={Target:A};return c&&(f.guid=c),h&&(f.time=h),i&&(f.Tooltip=i),f}function A7(t){var s=Kt(512),r=0,a=t.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}s.write_shift(4,2),s.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)s.write_shift(4,l[r]);if(i==28)a=a.slice(1),w_(a,s);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)s.write_shift(1,parseInt(l[r],16));var o=n>-1?a.slice(0,n):a;for(s.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)s.write_shift(2,o.charCodeAt(r));s.write_shift(2,0),i&8&&w_(n>-1?a.slice(n+1):"",s)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)s.write_shift(1,parseInt(l[r],16));for(var u=0;a.slice(u*3,u*3+3)=="../"||a.slice(u*3,u*3+3)=="..\\";)++u;for(s.write_shift(2,u),s.write_shift(4,a.length-3*u+1),r=0;r<a.length-3*u;++r)s.write_shift(1,a.charCodeAt(r+3*u)&255);for(s.write_shift(1,0),s.write_shift(2,65535),s.write_shift(2,57005),r=0;r<6;++r)s.write_shift(4,0)}return s.slice(0,s.l)}function Fk(t){var s=t.read_shift(1),r=t.read_shift(1),a=t.read_shift(1),n=t.read_shift(1);return[s,r,a,n]}function Tk(t,s){var r=Fk(t);return r[3]=0,r}function hc(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{r:s,c:r,ixfe:a}}function vA(t,s,r,a){return a||(a=Kt(6)),a.write_shift(2,t),a.write_shift(2,s),a.write_shift(2,r||0),a}function h7(t){var s=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:s,flags:r}}function m7(t,s,r){return s===0?"":CA(t,s,r)}function f7(t,s,r){var a=r.biff>8?4:2,n=t.read_shift(a),i=t.read_shift(a,"i"),l=t.read_shift(a,"i");return[n,i,l]}function Ik(t){var s=t.read_shift(2),r=Bj(t);return[s,r]}function p7(t,s,r){t.l+=4,s-=4;var a=t.l+s,n=Hf(t,s,r),i=t.read_shift(2);if(a-=t.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return t.l+=i,n}function ig(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2);return{s:{c:a,r:s},e:{c:n,r}}}function Lk(t,s){return s||(s=Kt(8)),s.write_shift(2,t.s.r),s.write_shift(2,t.e.r),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c),s}function Dk(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(1),n=t.read_shift(1);return{s:{c:a,r:s},e:{c:n,r}}}var x7=Dk;function Uk(t){t.l+=4;var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return t.l+=12,[r,s,a]}function g7(t){var s={};return t.l+=4,t.l+=16,s.fSharedNote=t.read_shift(2),t.l+=4,s}function v7(t){var s={};return t.l+=4,t.cf=t.read_shift(2),s}function ti(t){t.l+=2,t.l+=t.read_shift(2)}var b7={0:ti,4:ti,5:ti,6:ti,7:v7,8:ti,9:ti,10:ti,11:ti,12:ti,13:g7,14:ti,15:ti,16:ti,17:ti,18:ti,19:ti,20:ti,21:Uk};function y7(t,s){for(var r=t.l+s,a=[];t.l<r;){var n=t.read_shift(2);t.l-=2;try{a.push(b7[n](t,r-t.l))}catch{return t.l=r,a}}return t.l!=r&&(t.l=r),a}function fx(t,s){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),s-=2,s>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(s>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(s),r}function Ij(t,s,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Kt(n);return i.write_shift(2,a),i.write_shift(2,s),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function j7(t,s){return s===0||t.read_shift(2),1200}function N7(t,s,r){if(r.enc)return t.l+=s,"";var a=t.l,n=CA(t,0,r);return t.read_shift(s+a-t.l),n}function w7(t,s){var r=!s||s.biff==8,a=Kt(r?112:54);for(a.write_shift(s.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function _7(t,s,r){var a=r&&r.biff==8||s==2?t.read_shift(2):(t.l+=s,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function S7(t,s,r){var a=t.read_shift(4),n=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Hf(t,0,r);return l.length===0&&(l="Sheet1"),{pos:a,hs:n,dt:i,name:l}}function C7(t,s){var r=!s||s.biff>=8?2:1,a=Kt(8+r*t.name.length);a.write_shift(4,t.pos),a.write_shift(1,t.hs||0),a.write_shift(1,t.dt),a.write_shift(1,t.name.length),s.biff>=8&&a.write_shift(1,1),a.write_shift(r*t.name.length,t.name,s.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function k7(t,s){for(var r=t.l+s,a=t.read_shift(4),n=t.read_shift(4),i=[],l=0;l!=n&&t.l<r;++l)i.push(n7(t));return i.Count=a,i.Unique=n,i}function B7(t,s){var r=Kt(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var a=[],n=0;n<t.length;++n)a[n]=i7(t[n]);var i=wn([r].concat(a));return i.parts=[r.length].concat(a.map(function(l){return l.length})),i}function E7(t,s){var r={};return r.dsst=t.read_shift(2),t.l+=s-2,r}function F7(t){var s={};s.r=t.read_shift(2),s.c=t.read_shift(2),s.cnt=t.read_shift(2)-s.c;var r=t.read_shift(2);t.l+=4;var a=t.read_shift(1);return t.l+=3,a&7&&(s.level=a&7),a&32&&(s.hidden=!0),a&64&&(s.hpt=r/20),s}function T7(t){var s=h7(t);if(s.type!=2211)throw new Error("Invalid Future Record "+s.type);var r=t.read_shift(4);return r!==0}function I7(t){return t.read_shift(2),t.read_shift(4)}function __(t,s,r){var a=0;r&&r.biff==2||(a=t.read_shift(2));var n=t.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function L7(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),d=t.read_shift(2);return{Pos:[s,r],Dim:[a,n],Flags:i,CurTab:l,FirstTab:o,Selected:u,TabRatio:d}}function D7(){var t=Kt(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function U7(t,s,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=t.read_shift(2);return{RTL:a&64}}function P7(t){var s=Kt(18),r=1718;return t&&t.RTL&&(r|=64),s.write_shift(2,r),s.write_shift(4,0),s.write_shift(4,64),s.write_shift(4,0),s.write_shift(4,0),s}function R7(){}function O7(t,s,r){var a={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return a.name=Hf(t,0,r),a}function Q7(t,s){var r=t.name||"Arial",a=s&&s.biff==5,n=a?15+r.length:16+2*r.length,i=Kt(n);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function M7(t){var s=hc(t);return s.isst=t.read_shift(4),s}function H7(t,s,r,a){var n=Kt(10);return vA(t,s,a,n),n.write_shift(4,r),n}function q7(t,s,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=t.l+s,n=hc(t);r.biff==2&&t.l++;var i=qf(t,a-t.l,r);return n.val=i,n}function V7(t,s,r,a,n){var i=!n||n.biff==8,l=Kt(8+ +i+(1+i)*r.length);return vA(t,s,a,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function $7(t,s,r){var a=t.read_shift(2),n=CA(t,0,r);return[a,n]}function W7(t,s,r,a){var n=r&&r.biff==5;a||(a=Kt(n?3+s.length:5+2*s.length)),a.write_shift(2,t),a.write_shift(n?1:2,s.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*s.length,s,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var G7=CA;function S_(t,s,r){var a=t.l+s,n=r.biff==8||!r.biff?4:2,i=t.read_shift(n),l=t.read_shift(n),o=t.read_shift(2),u=t.read_shift(2);return t.l=a,{s:{r:i,c:o},e:{r:l,c:u}}}function K7(t,s){var r=s.biff==8||!s.biff?4:2,a=Kt(2*r+6);return a.write_shift(r,t.s.r),a.write_shift(r,t.e.r+1),a.write_shift(2,t.s.c),a.write_shift(2,t.e.c+1),a.write_shift(2,0),a}function z7(t){var s=t.read_shift(2),r=t.read_shift(2),a=Ik(t);return{r:s,c:r,ixfe:a[0],rknum:a[1]}}function Y7(t,s){for(var r=t.l+s-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(Ik(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:l,rkrec:i}}function X7(t,s){for(var r=t.l+s-2,a=t.read_shift(2),n=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:l,ixfe:i}}function J7(t,s,r,a){var n={},i=t.read_shift(4),l=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(2);return n.patternType=TM[o>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=l&15,n.dgRight=l>>4&15,n.dgTop=l>>8&15,n.dgBottom=l>>12&15,n.icvLeft=l>>16&127,n.icvRight=l>>23&127,n.grbitDiag=l>>30&3,n.icvTop=o&127,n.icvBottom=o>>7&127,n.icvDiag=o>>14&127,n.dgDiag=o>>21&15,n.icvFore=u&127,n.icvBack=u>>7&127,n.fsxButton=u>>14&1),n}function Z7(t,s,r){var a={};return a.ifnt=t.read_shift(2),a.numFmtId=t.read_shift(2),a.flags=t.read_shift(2),a.fStyle=a.flags>>2&1,s-=6,a.data=J7(t,s,a.fStyle,r),a}function C_(t,s,r,a){var n=r&&r.biff==5;a||(a=Kt(n?16:20)),a.write_shift(2,0),t.style?(a.write_shift(2,t.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,t.numFmtId||0),a.write_shift(2,s<<4));var i=0;return t.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function e9(t){t.l+=4;var s=[t.read_shift(2),t.read_shift(2)];if(s[0]!==0&&s[0]--,s[1]!==0&&s[1]--,s[0]>7||s[1]>7)throw new Error("Bad Gutters: "+s.join("|"));return s}function t9(t){var s=Kt(8);return s.write_shift(4,0),s.write_shift(2,0),s.write_shift(2,0),s}function k_(t,s,r){var a=hc(t);(r.biff==2||s==9)&&++t.l;var n=a7(t);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function s9(t,s,r,a,n,i){var l=Kt(8);return vA(t,s,a,l),Bk(r,i,l),l}function r9(t,s,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=hc(t),n=di(t);return a.val=n,a}function a9(t,s,r,a){var n=Kt(14);return vA(t,s,a,n),xA(r,n),n}var B_=m7;function n9(t,s,r){var a=t.l+s,n=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=gA(t,i),o=[];a>t.l;)o.push(qf(t));return[i,n,l,o]}function E_(t,s,r){var a=t.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=p7(t,s-2,r)),i.body=n||t.read_shift(s-2),typeof n=="string"&&(i.Name=n),i}var i9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function F_(t,s,r){var a=t.l+s,n=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=gA(t,l,r);n&32&&(d=i9[d.charCodeAt(0)]);var c=a-t.l;r&&r.biff==2&&--c;var h=a==t.l||o===0||!(c>0)?[]:y$(t,c,r,o);return{chKey:i,Name:d,itab:u,rgce:h}}function Pk(t,s,r){if(r.biff<8)return l9(t,s,r);for(var a=[],n=t.l+s,i=t.read_shift(r.biff>8?4:2);i--!==0;)a.push(f7(t,r.biff>8?12:6,r));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return a}function l9(t,s,r){t[t.l+1]==3&&t[t.l]++;var a=Hf(t,s,r);return a.charCodeAt(0)==3?a.slice(1):a}function o9(t,s,r){if(r.biff<8){t.l+=s;return}var a=t.read_shift(2),n=t.read_shift(2),i=gA(t,a,r),l=gA(t,n,r);return[i,l]}function c9(t,s,r){var a=Dk(t);t.l++;var n=t.read_shift(1);return s-=8,[j$(t,s,r),n,a]}function T_(t,s,r){var a=x7(t);switch(r.biff){case 2:t.l++,s-=7;break;case 3:case 4:t.l+=2,s-=8;break;default:t.l+=6,s-=12}return[a,v$(t,s,r)]}function d9(t){var s=t.read_shift(4)!==0,r=t.read_shift(4)!==0,a=t.read_shift(4);return[s,r,a]}function u9(t,s,r){if(!(r.biff<8)){var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),o=CA(t,0,r);return r.biff<8&&t.read_shift(1),[{r:a,c:n},o,l,i]}}function A9(t,s,r){return u9(t,s,r)}function h9(t,s){for(var r=[],a=t.read_shift(2);a--;)r.push(ig(t));return r}function m9(t){var s=Kt(2+t.length*8);s.write_shift(2,t.length);for(var r=0;r<t.length;++r)Lk(t[r],s);return s}function f9(t,s,r){if(r&&r.biff<8)return x9(t,s,r);var a=Uk(t),n=y7(t,s-22,a[1]);return{cmo:a,ft:n}}var p9={8:function(t,s){var r=t.l+s;t.l+=10;var a=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var n=t.read_shift(1);return t.l+=n,t.l=r,{fmt:a}}};function x9(t,s,r){t.l+=4;var a=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,s-=36;var l=[];return l.push((p9[a]||hi)(t,s,r)),{cmo:[n,a,i],ft:l}}function g9(t,s,r){var a=t.l,n="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=l7(t,6,r);var o=t.read_shift(2);t.read_shift(2),en(t,2);var u=t.read_shift(2);t.l+=u;for(var d=1;d<t.lens.length-1;++d){if(t.l-a!=t.lens[d])throw new Error("TxO: bad continue record");var c=t[t.l],h=gA(t,t.lens[d+1]-t.lens[d]-1);if(n+=h,n.length>=(c?o:2*o))break}if(n.length!==o&&n.length!==o*2)throw new Error("cchText: "+o+" != "+n.length);return t.l=a+s,{t:n}}catch{return t.l=a+s,{t:n}}}function v9(t,s){var r=ig(t);t.l+=16;var a=u7(t,s-24);return[r,a]}function b9(t){var s=Kt(24),r=ga(t[0]);s.write_shift(2,r.r),s.write_shift(2,r.r),s.write_shift(2,r.c),s.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)s.write_shift(1,parseInt(a[n],16));return wn([s,A7(t[1])])}function y9(t,s){t.read_shift(2);var r=ig(t),a=t.read_shift((s-10)/2,"dbcs-cont");return a=a.replace(Ti,""),[r,a]}function j9(t){var s=t[1].Tooltip,r=Kt(10+2*(s.length+1));r.write_shift(2,2048);var a=ga(t[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<s.length;++n)r.write_shift(2,s.charCodeAt(n));return r.write_shift(2,0),r}function N9(t){var s=[0,0],r;return r=t.read_shift(2),s[0]=p_[r]||r,r=t.read_shift(2),s[1]=p_[r]||r,s}function w9(t){return t||(t=Kt(4)),t.write_shift(2,1),t.write_shift(2,1),t}function _9(t){for(var s=t.read_shift(2),r=[];s-- >0;)r.push(Tk(t));return r}function S9(t){for(var s=t.read_shift(2),r=[];s-- >0;)r.push(Tk(t));return r}function C9(t){t.l+=2;var s={cxfs:0,crc:0};return s.cxfs=t.read_shift(2),s.crc=t.read_shift(4),s}function Rk(t,s,r){if(!r.cellStyles)return hi(t,s);var a=r&&r.biff>=12?4:2,n=t.read_shift(a),i=t.read_shift(a),l=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2);a==2&&(t.l+=2);var d={s:n,e:i,w:l,ixfe:o,flags:u};return(r.biff>=5||!r.biff)&&(d.level=u>>8&7),d}function k9(t,s){var r=Kt(12);r.write_shift(2,s),r.write_shift(2,s),r.write_shift(2,t.width*256),r.write_shift(2,0);var a=0;return t.hidden&&(a|=1),r.write_shift(1,a),a=t.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function B9(t,s){var r={};return s<32||(t.l+=16,r.header=di(t),r.footer=di(t),t.l+=2),r}function E9(t,s,r){var a={area:!1};if(r.biff!=5)return t.l+=s,a;var n=t.read_shift(1);return t.l+=3,n&16&&(a.area=!0),a}function F9(t){for(var s=Kt(2*t),r=0;r<t;++r)s.write_shift(2,r+1);return s}var T9=hc,I9=kk,L9=qf;function D9(t){var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n={fmt:s,env:r,len:a,data:t.slice(t.l,t.l+a)};return t.l+=a,n}function U9(t,s,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=hc(t);++t.l;var n=CA(t,s-7,r);return a.t="str",a.val=n,a}function P9(t){var s=hc(t);++t.l;var r=di(t);return s.t="n",s.val=r,s}function R9(t,s,r){var a=Kt(15);return Gf(a,t,s),a.write_shift(8,r,"f"),a}function O9(t){var s=hc(t);++t.l;var r=t.read_shift(2);return s.t="n",s.val=r,s}function Q9(t,s,r){var a=Kt(9);return Gf(a,t,s),a.write_shift(2,r),a}function M9(t){var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,"sbcs-cont")}function H9(t,s){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=s-13}function q9(t,s,r){var a=t.l+s,n=hc(t),i=t.read_shift(2),l=gA(t,i,r);return t.l=a,n.t="str",n.val=l,n}var V9=[2,3,48,49,131,139,140,245],Cy=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},s=rg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,u){var d=[],c=Au(1);switch(u.type){case"base64":c=Al(gl(o));break;case"binary":c=Al(o);break;case"buffer":case"array":c=o;break}Pn(c,0);var h=c.read_shift(1),A=!!(h&136),f=!1,g=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,A=!0;break;case 49:f=!0,A=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,b=521;h==2&&(v=c.read_shift(2)),c.l+=3,h!=2&&(v=c.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(b=c.read_shift(2));var y=c.read_shift(2),j=u.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(j=t[c[c.l]]),c.l+=1,c.l+=2),g&&(c.l+=36);for(var N=[],S={},B=Math.min(c.length,h==2?521:b-10-(f?264:0)),P=g?32:11;c.l<B&&c[c.l]!=13;)switch(S={},S.name=ff.utils.decode(j,c.slice(c.l,c.l+P)).replace(/[\u0000\r\n].*$/g,""),c.l+=P,S.type=String.fromCharCode(c.read_shift(1)),h!=2&&!g&&(S.offset=c.read_shift(4)),S.len=c.read_shift(1),h==2&&(S.offset=c.read_shift(2)),S.dec=c.read_shift(1),S.name.length&&N.push(S),h!=2&&(c.l+=g?13:14),S.type){case"B":(!f||S.len!=8)&&u.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(c[c.l]!==13&&(c.l=b-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=b;var L=0,U=0;for(d[0]=[],U=0;U!=N.length;++U)d[0][U]=N[U].name;for(;v-- >0;){if(c[c.l]===42){c.l+=y;continue}for(++c.l,d[++L]=[],U=0,U=0;U!=N.length;++U){var H=c.slice(c.l,c.l+N[U].len);c.l+=N[U].len,Pn(H,0);var q=ff.utils.decode(j,H);switch(N[U].type){case"C":q.trim().length&&(d[L][U]=q.replace(/\s+$/,""));break;case"D":q.length===8?d[L][U]=new Date(+q.slice(0,4),+q.slice(4,6)-1,+q.slice(6,8)):d[L][U]=q;break;case"F":d[L][U]=parseFloat(q.trim());break;case"+":case"I":d[L][U]=g?H.read_shift(-4,"i")^2147483648:H.read_shift(4,"i");break;case"L":switch(q.trim().toUpperCase()){case"Y":case"T":d[L][U]=!0;break;case"N":case"F":d[L][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+q+"|")}break;case"M":if(!A)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));d[L][U]="##MEMO##"+(g?parseInt(q.trim(),10):H.read_shift(4));break;case"N":q=q.replace(/\u0000/g,"").trim(),q&&q!="."&&(d[L][U]=+q||0);break;case"@":d[L][U]=new Date(H.read_shift(-8,"f")-621356832e5);break;case"T":d[L][U]=new Date((H.read_shift(4)-2440588)*864e5+H.read_shift(4));break;case"Y":d[L][U]=H.read_shift(4,"i")/1e4+H.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[L][U]=-H.read_shift(-8,"f");break;case"B":if(f&&N[U].len==8){d[L][U]=H.read_shift(8,"f");break}case"G":case"P":H.l+=N[U].len;break;case"0":if(N[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[U].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return u&&u.sheetRows&&(d=d.slice(0,u.sheetRows)),u.DBF=N,d}function a(o,u){var d=u||{};d.dateNF||(d.dateNF="yyyymmdd");var c=Kh(r(o,d),d);return c["!cols"]=d.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete d.DBF,c}function n(o,u){try{return vu(a(o,u),u)}catch(d){if(u&&u.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(o,u){var d=u||{};if(+d.codepage>=0&&Co(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var c=Yi(),h=b0(o,{header:1,raw:!0,cellDates:!0}),A=h[0],f=h.slice(1),g=o["!cols"]||[],v=0,b=0,y=0,j=1;for(v=0;v<A.length;++v){if(((g[v]||{}).DBF||{}).name){A[v]=g[v].DBF.name,++y;continue}if(A[v]!=null){if(++y,typeof A[v]=="number"&&(A[v]=A[v].toString(10)),typeof A[v]!="string")throw new Error("DBF Invalid column name "+A[v]+" |"+typeof A[v]+"|");if(A.indexOf(A[v])!==v){for(b=0;b<1024;++b)if(A.indexOf(A[v]+"_"+b)==-1){A[v]+="_"+b;break}}}}var N=jr(o["!ref"]),S=[],B=[],P=[];for(v=0;v<=N.e.c-N.s.c;++v){var L="",U="",H=0,q=[];for(b=0;b<f.length;++b)f[b][v]!=null&&q.push(f[b][v]);if(q.length==0||A[v]==null){S[v]="?";continue}for(b=0;b<q.length;++b){switch(typeof q[b]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=q[b]instanceof Date?"D":"C";break;default:U="C"}H=Math.max(H,String(q[b]).length),L=L&&L!=U?"C":U}H>250&&(H=250),U=((g[v]||{}).DBF||{}).type,U=="C"&&g[v].DBF.len>H&&(H=g[v].DBF.len),L=="B"&&U=="N"&&(L="N",P[v]=g[v].DBF.dec,H=g[v].DBF.len),B[v]=L=="C"||U=="N"?H:i[L]||0,j+=B[v],S[v]=L}var V=c.next(32);for(V.write_shift(4,318902576),V.write_shift(4,f.length),V.write_shift(2,296+32*y),V.write_shift(2,j),v=0;v<4;++v)V.write_shift(4,0);for(V.write_shift(4,0|(+s[C4]||3)<<8),v=0,b=0;v<A.length;++v)if(A[v]!=null){var M=c.next(32),z=(A[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);M.write_shift(1,z,"sbcs"),M.write_shift(1,S[v]=="?"?"C":S[v],"sbcs"),M.write_shift(4,b),M.write_shift(1,B[v]||i[S[v]]||0),M.write_shift(1,P[v]||0),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(1,0),M.write_shift(4,0),M.write_shift(4,0),b+=B[v]||i[S[v]]||0}var I=c.next(264);for(I.write_shift(4,13),v=0;v<65;++v)I.write_shift(4,0);for(v=0;v<f.length;++v){var G=c.next(j);for(G.write_shift(1,0),b=0;b<A.length;++b)if(A[b]!=null)switch(S[b]){case"L":G.write_shift(1,f[v][b]==null?63:f[v][b]?84:70);break;case"B":G.write_shift(8,f[v][b]||0,"f");break;case"N":var Y="0";for(typeof f[v][b]=="number"&&(Y=f[v][b].toFixed(P[b]||0)),y=0;y<B[b]-Y.length;++y)G.write_shift(1,32);G.write_shift(1,Y,"sbcs");break;case"D":f[v][b]?(G.write_shift(4,("0000"+f[v][b].getFullYear()).slice(-4),"sbcs"),G.write_shift(2,("00"+(f[v][b].getMonth()+1)).slice(-2),"sbcs"),G.write_shift(2,("00"+f[v][b].getDate()).slice(-2),"sbcs")):G.write_shift(8,"00000000","sbcs");break;case"C":var J=String(f[v][b]!=null?f[v][b]:"").slice(0,B[b]);for(G.write_shift(1,J,"sbcs"),y=0;y<B[b]-J.length;++y)G.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:n,to_sheet:a,from_sheet:l}})(),Ok=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},s=new RegExp("\x1BN("+Ba(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(A,f){var g=t[f];return typeof g=="number"?q2(g):g},a=function(A,f,g){var v=f.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return v==59?A:q2(v)};t["|"]=254;function n(A,f){switch(f.type){case"base64":return i(gl(A),f);case"binary":return i(A,f);case"buffer":return i(ir&&Buffer.isBuffer(A)?A.toString("binary"):gu(A),f);case"array":return i(pA(A),f)}throw new Error("Unrecognized type "+f.type)}function i(A,f){var g=A.split(/[\n\r]+/),v=-1,b=-1,y=0,j=0,N=[],S=[],B=null,P={},L=[],U=[],H=[],q=0,V;for(+f.codepage>=0&&Co(+f.codepage);y!==g.length;++y){q=0;var M=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(s,r),z=M.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),I=z[0],G;if(M.length>0)switch(I){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&S.push(M.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,J=!1,T=!1,k=!1,D=-1,Q=-1;for(j=1;j<z.length;++j)switch(z[j].charAt(0)){case"A":break;case"X":b=parseInt(z[j].slice(1))-1,J=!0;break;case"Y":for(v=parseInt(z[j].slice(1))-1,J||(b=0),V=N.length;V<=v;++V)N[V]=[];break;case"K":G=z[j].slice(1),G.charAt(0)==='"'?G=G.slice(1,G.length-1):G==="TRUE"?G=!0:G==="FALSE"?G=!1:isNaN(Bo(G))?isNaN(Dh(G).getDate())||(G=la(G)):(G=Bo(G),B!==null&&Wh(B)&&(G=ng(G))),Y=!0;break;case"E":k=!0;var C=kh(z[j].slice(1),{r:v,c:b});N[v][b]=[N[v][b],C];break;case"S":T=!0,N[v][b]=[N[v][b],"S5S"];break;case"G":break;case"R":D=parseInt(z[j].slice(1))-1;break;case"C":Q=parseInt(z[j].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}if(Y&&(N[v][b]&&N[v][b].length==2?N[v][b][0]=G:N[v][b]=G,B=null),T){if(k)throw new Error("SYLK shared formula cannot have own formula");var E=D>-1&&N[D][Q];if(!E||!E[1])throw new Error("SYLK shared formula cannot find base");N[v][b][1]=rB(E[1],{r:v-D,c:b-Q})}break;case"F":var w=0;for(j=1;j<z.length;++j)switch(z[j].charAt(0)){case"X":b=parseInt(z[j].slice(1))-1,++w;break;case"Y":for(v=parseInt(z[j].slice(1))-1,V=N.length;V<=v;++V)N[V]=[];break;case"M":q=parseInt(z[j].slice(1))/20;break;case"F":break;case"G":break;case"P":B=S[parseInt(z[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(H=z[j].slice(1).split(" "),V=parseInt(H[0],10);V<=parseInt(H[1],10);++V)q=parseInt(H[2],10),U[V-1]=q===0?{hidden:!0}:{wch:q},hu(U[V-1]);break;case"C":b=parseInt(z[j].slice(1))-1,U[b]||(U[b]={});break;case"R":v=parseInt(z[j].slice(1))-1,L[v]||(L[v]={}),q>0?(L[v].hpt=q,L[v].hpx=Ph(q)):q===0&&(L[v].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}w<1&&(B=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+M)}}return L.length>0&&(P["!rows"]=L),U.length>0&&(P["!cols"]=U),f&&f.sheetRows&&(N=N.slice(0,f.sheetRows)),[N,P]}function l(A,f){var g=n(A,f),v=g[0],b=g[1],y=Kh(v,f);return Ba(b).forEach(function(j){y[j]=b[j]}),y}function o(A,f){return vu(l(A,f),f)}function u(A,f,g,v){var b="C;Y"+(g+1)+";X"+(v+1)+";K";switch(A.t){case"n":b+=A.v||0,A.f&&!A.F&&(b+=";E"+Oj(A.f,{r:g,c:v}));break;case"b":b+=A.v?"TRUE":"FALSE";break;case"e":b+=A.w||A.v;break;case"d":b+='"'+(A.w||A.v)+'"';break;case"s":b+='"'+A.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(A,f){f.forEach(function(g,v){var b="F;W"+(v+1)+" "+(v+1)+" ";g.hidden?b+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Nf(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=wf(g.wpx)),typeof g.wch=="number"&&(b+=Math.round(g.wch))),b.charAt(b.length-1)!=" "&&A.push(b)})}function c(A,f){f.forEach(function(g,v){var b="F;";g.hidden?b+="M0;":g.hpt?b+="M"+20*g.hpt+";":g.hpx&&(b+="M"+20*_f(g.hpx)+";"),b.length>2&&A.push(b+"R"+(v+1))})}function h(A,f){var g=["ID;PWXL;N;E"],v=[],b=jr(A["!ref"]),y,j=Array.isArray(A),N=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),A["!cols"]&&d(g,A["!cols"]),A["!rows"]&&c(g,A["!rows"]),g.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var S=b.s.r;S<=b.e.r;++S)for(var B=b.s.c;B<=b.e.c;++B){var P=$s({r:S,c:B});y=j?(A[S]||[])[B]:A[P],!(!y||y.v==null&&(!y.f||y.F))&&v.push(u(y,A,S,B))}return g.join(N)+N+v.join(N)+N+"E"+N}return{to_workbook:o,to_sheet:l,from_sheet:h}})(),Qk=(function(){function t(i,l){switch(l.type){case"base64":return s(gl(i),l);case"binary":return s(i,l);case"buffer":return s(ir&&Buffer.isBuffer(i)?i.toString("binary"):gu(i),l);case"array":return s(pA(i),l)}throw new Error("Unrecognized type "+l.type)}function s(i,l){for(var o=i.split(`
`),u=-1,d=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++u]=[],d=0;continue}if(!(u<0)){var A=o[c].trim().split(","),f=A[0],g=A[1];++c;for(var v=o[c]||"";(v.match(/["]/g)||[]).length&1&&c<o.length-1;)v+=`
`+o[++c];switch(v=v.trim(),+f){case-1:if(v==="BOT"){h[++u]=[],d=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[u][d]=!0:v==="FALSE"?h[u][d]=!1:isNaN(Bo(g))?isNaN(Dh(g).getDate())?h[u][d]=g:h[u][d]=la(g):h[u][d]=Bo(g),++d;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[u][d++]=v!==""?v:null;break}if(v==="EOD")break}}return l&&l.sheetRows&&(h=h.slice(0,l.sheetRows)),h}function r(i,l){return Kh(t(i,l),l)}function a(i,l){return vu(r(i,l),l)}var n=(function(){var i=function(u,d,c,h,A){u.push(d),u.push(c+","+h),u.push('"'+A.replace(/"/g,'""')+'"')},l=function(u,d,c,h){u.push(d+","+c),u.push(d==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(u){var d=[],c=jr(u["!ref"]),h,A=Array.isArray(u);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,c.e.r-c.s.r+1,""),i(d,"TUPLES",0,c.e.c-c.s.c+1,""),i(d,"DATA",0,0,"");for(var f=c.s.r;f<=c.e.r;++f){l(d,-1,0,"BOT");for(var g=c.s.c;g<=c.e.c;++g){var v=$s({r:f,c:g});if(h=A?(u[f]||[])[g]:u[v],!h){l(d,1,0,"");continue}switch(h.t){case"n":var b=h.w;!b&&h.v!=null&&(b=h.v),b==null?h.f&&!h.F?l(d,1,0,"="+h.f):l(d,1,0,""):l(d,0,b,"V");break;case"b":l(d,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Wl(h.z||Hs[14],cn(la(h.v)))),l(d,0,h.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var y=`\r
`,j=d.join(y);return j}})();return{to_workbook:a,to_sheet:r,from_sheet:n}})(),Mk=(function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function s(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,A){for(var f=h.split(`
`),g=-1,v=-1,b=0,y=[];b!==f.length;++b){var j=f[b].trim().split(":");if(j[0]==="cell"){var N=ga(j[1]);if(y.length<=N.r)for(g=y.length;g<=N.r;++g)y[g]||(y[g]=[]);switch(g=N.r,v=N.c,j[2]){case"t":y[g][v]=t(j[3]);break;case"v":y[g][v]=+j[3];break;case"vtf":var S=j[j.length-1];case"vtc":switch(j[3]){case"nl":y[g][v]=!!+j[4];break;default:y[g][v]=+j[4];break}j[2]=="vtf"&&(y[g][v]=[y[g][v],S])}}}return A&&A.sheetRows&&(y=y.slice(0,A.sheetRows)),y}function a(h,A){return Kh(r(h,A),A)}function n(h,A){return vu(a(h,A),A)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function d(h){if(!h||!h["!ref"])return"";for(var A=[],f=[],g,v="",b=Xi(h["!ref"]),y=Array.isArray(h),j=b.s.r;j<=b.e.r;++j)for(var N=b.s.c;N<=b.e.c;++N)if(v=$s({r:j,c:N}),g=y?(h[j]||[])[N]:h[v],!(!g||g.v==null||g.t==="z")){switch(f=["cell",v,"t"],g.t){case"s":case"str":f.push(s(g.v));break;case"n":g.f?(f[2]="vtf",f[3]="n",f[4]=g.v,f[5]=s(g.f)):(f[2]="v",f[3]=g.v);break;case"b":f[2]="vt"+(g.f?"f":"c"),f[3]="nl",f[4]=g.v?"1":"0",f[5]=s(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var S=cn(la(g.v));f[2]="vtc",f[3]="nd",f[4]=""+S,f[5]=g.w||Wl(g.z||Hs[14],S);break;case"e":continue}A.push(f.join(":"))}return A.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),A.push("valueformat:1:text-wiki"),A.join(`
`)}function c(h){return[i,l,o,l,d(h),u].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:c}})(),Uh=(function(){function t(c,h,A,f,g){g.raw?h[A][f]=c:c===""||(c==="TRUE"?h[A][f]=!0:c==="FALSE"?h[A][f]=!1:isNaN(Bo(c))?isNaN(Dh(c).getDate())?h[A][f]=c:h[A][f]=la(c):h[A][f]=Bo(c))}function s(c,h){var A=h||{},f=[];if(!c||c.length===0)return f;for(var g=c.split(/[\r\n]/),v=g.length-1;v>=0&&g[v].length===0;)--v;for(var b=10,y=0,j=0;j<=v;++j)y=g[j].indexOf(" "),y==-1?y=g[j].length:y++,b=Math.max(b,y);for(j=0;j<=v;++j){f[j]=[];var N=0;for(t(g[j].slice(0,b).trim(),f,j,N,A),N=1;N<=(g[j].length-b)/10+1;++N)t(g[j].slice(b+(N-1)*10,b+N*10).trim(),f,j,N,A)}return A.sheetRows&&(f=f.slice(0,A.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(c){for(var h={},A=!1,f=0,g=0;f<c.length;++f)(g=c.charCodeAt(f))==34?A=!A:!A&&g in r&&(h[g]=(h[g]||0)+1);g=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&g.push([h[f],f]);if(!g.length){h=a;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&g.push([h[f],f])}return g.sort(function(v,b){return v[0]-b[0]||a[v[1]]-a[b[1]]}),r[g.pop()[1]]||44}function i(c,h){var A=h||{},f="",g=A.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(f=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(f=c.charAt(4),c=c.slice(6)):f=n(c.slice(0,1024)):A&&A.FS?f=A.FS:f=n(c.slice(0,1024));var b=0,y=0,j=0,N=0,S=0,B=f.charCodeAt(0),P=!1,L=0,U=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var H=A.dateNF!=null?EQ(A.dateNF):null;function q(){var V=c.slice(N,S),M={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)M.t="z";else if(A.raw)M.t="s",M.v=V;else if(V.trim().length===0)M.t="s",M.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(M.t="s",M.v=V.slice(2,-1).replace(/""/g,'"')):nV(V)?(M.t="n",M.f=V.slice(1)):(M.t="s",M.v=V);else if(V=="TRUE")M.t="b",M.v=!0;else if(V=="FALSE")M.t="b",M.v=!1;else if(!isNaN(j=Bo(V)))M.t="n",A.cellText!==!1&&(M.w=V),M.v=j;else if(!isNaN(Dh(V).getDate())||H&&V.match(H)){M.z=A.dateNF||Hs[14];var z=0;H&&V.match(H)&&(V=FQ(V,A.dateNF,V.match(H)||[]),z=1),A.cellDates?(M.t="d",M.v=la(V,z)):(M.t="n",M.v=cn(la(V,z))),A.cellText!==!1&&(M.w=Wl(M.z,M.v instanceof Date?cn(M.v):M.v)),A.cellNF||delete M.z}else M.t="s",M.v=V;if(M.t=="z"||(A.dense?(g[b]||(g[b]=[]),g[b][y]=M):g[$s({c:y,r:b})]=M),N=S+1,U=c.charCodeAt(N),v.e.c<y&&(v.e.c=y),v.e.r<b&&(v.e.r=b),L==B)++y;else if(y=0,++b,A.sheetRows&&A.sheetRows<=b)return!0}e:for(;S<c.length;++S)switch(L=c.charCodeAt(S)){case 34:U===34&&(P=!P);break;case B:case 10:case 13:if(!P&&q())break e;break}return S-N>0&&q(),g["!ref"]=ar(v),g}function l(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?i(c,h):Kh(s(c,h),h)}function o(c,h){var A="",f=h.type=="string"?[0,0,0,0]:Gj(c,h);switch(h.type){case"base64":A=gl(c);break;case"binary":A=c;break;case"buffer":h.codepage==65001?A=c.toString("utf8"):h.codepage&&typeof ff<"u"||(A=ir&&Buffer.isBuffer(c)?c.toString("binary"):gu(c));break;case"array":A=pA(c);break;case"string":A=c;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?A=$r(A.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?A=$r(A):h.type=="binary"&&typeof ff<"u",A.slice(0,19)=="socialcalc:version:"?Mk.to_sheet(h.type=="string"?A:$r(A),h):l(A,h)}function u(c,h){return vu(o(c,h),h)}function d(c){for(var h=[],A=jr(c["!ref"]),f,g=Array.isArray(c),v=A.s.r;v<=A.e.r;++v){for(var b=[],y=A.s.c;y<=A.e.c;++y){var j=$s({r:v,c:y});if(f=g?(c[v]||[])[y]:c[j],!f||f.v==null){b.push("          ");continue}for(var N=(f.w||(Zc(f),f.w)||"").slice(0,10);N.length<10;)N+=" ";b.push(N+(y===0?" ":""))}h.push(b.join(""))}return h.join(`
`)}return{to_workbook:u,to_sheet:o,from_sheet:d}})();function $9(t,s){var r=s||{},a=!!r.WTF;r.WTF=!0;try{var n=Ok.to_workbook(t,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Uh.to_workbook(t,s)}}var uA=(function(){function t(C,E,w){if(C){Pn(C,C.l||0);for(var O=w.Enum||D;C.l<C.length;){var R=C.read_shift(2),X=O[R]||O[65535],ne=C.read_shift(2),te=C.l+ne,oe=X.f&&X.f(C,ne,w);if(C.l=te,E(oe,X,R))return}}}function s(C,E){switch(E.type){case"base64":return r(Al(gl(C)),E);case"binary":return r(Al(C),E);case"buffer":case"array":return r(C,E)}throw"Unsupported type "+E.type}function r(C,E){if(!C)return C;var w=E||{},O=w.dense?[]:{},R="Sheet1",X="",ne=0,te={},oe=[],ce=[],re={s:{r:0,c:0},e:{r:0,c:0}},de=w.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)w.Enum=D,t(C,function(ve,Ue,Be){switch(Be){case 0:w.vers=ve,ve>=4096&&(w.qpro=!0);break;case 6:re=ve;break;case 204:ve&&(X=ve);break;case 222:X=ve;break;case 15:case 51:w.qpro||(ve[1].v=ve[1].v.slice(1));case 13:case 14:case 16:Be==14&&(ve[2]&112)==112&&(ve[2]&15)>1&&(ve[2]&15)<15&&(ve[1].z=w.dateNF||Hs[14],w.cellDates&&(ve[1].t="d",ve[1].v=ng(ve[1].v))),w.qpro&&ve[3]>ne&&(O["!ref"]=ar(re),te[R]=O,oe.push(R),O=w.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ne=ve[3],R=X||"Sheet"+(ne+1),X="");var _e=w.dense?(O[ve[0].r]||[])[ve[0].c]:O[$s(ve[0])];if(_e){_e.t=ve[1].t,_e.v=ve[1].v,ve[1].z!=null&&(_e.z=ve[1].z),ve[1].f!=null&&(_e.f=ve[1].f);break}w.dense?(O[ve[0].r]||(O[ve[0].r]=[]),O[ve[0].r][ve[0].c]=ve[1]):O[$s(ve[0])]=ve[1];break}},w);else if(C[2]==26||C[2]==14)w.Enum=Q,C[2]==14&&(w.qpro=!0,C.l=0),t(C,function(ve,Ue,Be){switch(Be){case 204:R=ve;break;case 22:ve[1].v=ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ve[3]>ne&&(O["!ref"]=ar(re),te[R]=O,oe.push(R),O=w.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ne=ve[3],R="Sheet"+(ne+1)),de>0&&ve[0].r>=de)break;w.dense?(O[ve[0].r]||(O[ve[0].r]=[]),O[ve[0].r][ve[0].c]=ve[1]):O[$s(ve[0])]=ve[1],re.e.c<ve[0].c&&(re.e.c=ve[0].c),re.e.r<ve[0].r&&(re.e.r=ve[0].r);break;case 27:ve[14e3]&&(ce[ve[14e3][0]]=ve[14e3][1]);break;case 1537:ce[ve[0]]=ve[1],ve[0]==ne&&(R=ve[1]);break}},w);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(O["!ref"]=ar(re),te[X||R]=O,oe.push(X||R),!ce.length)return{SheetNames:oe,Sheets:te};for(var Ie={},le=[],Z=0;Z<ce.length;++Z)te[oe[Z]]?(le.push(ce[Z]||oe[Z]),Ie[ce[Z]]=te[ce[Z]]||te[oe[Z]]):(le.push(ce[Z]),Ie[ce[Z]]={"!ref":"A1"});return{SheetNames:le,Sheets:Ie}}function a(C,E){var w=E||{};if(+w.codepage>=0&&Co(+w.codepage),w.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Yi(),R=jr(C["!ref"]),X=Array.isArray(C),ne=[];xs(O,0,i(1030)),xs(O,6,u(R));for(var te=Math.min(R.e.r,8191),oe=R.s.r;oe<=te;++oe)for(var ce=qa(oe),re=R.s.c;re<=R.e.c;++re){oe===R.s.r&&(ne[re]=xa(re));var de=ne[re]+ce,Ie=X?(C[oe]||[])[re]:C[de];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?xs(O,13,f(oe,re,Ie.v)):xs(O,14,v(oe,re,Ie.v));else{var le=Zc(Ie);xs(O,15,h(oe,re,le.slice(0,239)))}}return xs(O,1),O.end()}function n(C,E){var w=E||{};if(+w.codepage>=0&&Co(+w.codepage),w.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Yi();xs(O,0,l(C));for(var R=0,X=0;R<C.SheetNames.length;++R)(C.Sheets[C.SheetNames[R]]||{})["!ref"]&&xs(O,27,k(C.SheetNames[R],X++));var ne=0;for(R=0;R<C.SheetNames.length;++R){var te=C.Sheets[C.SheetNames[R]];if(!(!te||!te["!ref"])){for(var oe=jr(te["!ref"]),ce=Array.isArray(te),re=[],de=Math.min(oe.e.r,8191),Ie=oe.s.r;Ie<=de;++Ie)for(var le=qa(Ie),Z=oe.s.c;Z<=oe.e.c;++Z){Ie===oe.s.r&&(re[Z]=xa(Z));var ve=re[Z]+le,Ue=ce?(te[Ie]||[])[Z]:te[ve];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")xs(O,23,q(Ie,Z,ne,Ue.v));else{var Be=Zc(Ue);xs(O,22,L(Ie,Z,ne,Be.slice(0,239)))}}++ne}}return xs(O,1),O.end()}function i(C){var E=Kt(2);return E.write_shift(2,C),E}function l(C){var E=Kt(26);E.write_shift(2,4096),E.write_shift(2,4),E.write_shift(4,0);for(var w=0,O=0,R=0,X=0;X<C.SheetNames.length;++X){var ne=C.SheetNames[X],te=C.Sheets[ne];if(!(!te||!te["!ref"])){++R;var oe=Xi(te["!ref"]);w<oe.e.r&&(w=oe.e.r),O<oe.e.c&&(O=oe.e.c)}}return w>8191&&(w=8191),E.write_shift(2,w),E.write_shift(1,R),E.write_shift(1,O),E.write_shift(2,0),E.write_shift(2,0),E.write_shift(1,1),E.write_shift(1,2),E.write_shift(4,0),E.write_shift(4,0),E}function o(C,E,w){var O={s:{c:0,r:0},e:{c:0,r:0}};return E==8&&w.qpro?(O.s.c=C.read_shift(1),C.l++,O.s.r=C.read_shift(2),O.e.c=C.read_shift(1),C.l++,O.e.r=C.read_shift(2),O):(O.s.c=C.read_shift(2),O.s.r=C.read_shift(2),E==12&&w.qpro&&(C.l+=2),O.e.c=C.read_shift(2),O.e.r=C.read_shift(2),E==12&&w.qpro&&(C.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function u(C){var E=Kt(8);return E.write_shift(2,C.s.c),E.write_shift(2,C.s.r),E.write_shift(2,C.e.c),E.write_shift(2,C.e.r),E}function d(C,E,w){var O=[{c:0,r:0},{t:"n",v:0},0,0];return w.qpro&&w.vers!=20768?(O[0].c=C.read_shift(1),O[3]=C.read_shift(1),O[0].r=C.read_shift(2),C.l+=2):(O[2]=C.read_shift(1),O[0].c=C.read_shift(2),O[0].r=C.read_shift(2)),O}function c(C,E,w){var O=C.l+E,R=d(C,E,w);if(R[1].t="s",w.vers==20768){C.l++;var X=C.read_shift(1);return R[1].v=C.read_shift(X,"utf8"),R}return w.qpro&&C.l++,R[1].v=C.read_shift(O-C.l,"cstr"),R}function h(C,E,w){var O=Kt(7+w.length);O.write_shift(1,255),O.write_shift(2,E),O.write_shift(2,C),O.write_shift(1,39);for(var R=0;R<O.length;++R){var X=w.charCodeAt(R);O.write_shift(1,X>=128?95:X)}return O.write_shift(1,0),O}function A(C,E,w){var O=d(C,E,w);return O[1].v=C.read_shift(2,"i"),O}function f(C,E,w){var O=Kt(7);return O.write_shift(1,255),O.write_shift(2,E),O.write_shift(2,C),O.write_shift(2,w,"i"),O}function g(C,E,w){var O=d(C,E,w);return O[1].v=C.read_shift(8,"f"),O}function v(C,E,w){var O=Kt(13);return O.write_shift(1,255),O.write_shift(2,E),O.write_shift(2,C),O.write_shift(8,w,"f"),O}function b(C,E,w){var O=C.l+E,R=d(C,E,w);if(R[1].v=C.read_shift(8,"f"),w.qpro)C.l=O;else{var X=C.read_shift(2);S(C.slice(C.l,C.l+X),R),C.l+=X}return R}function y(C,E,w){var O=E&32768;return E&=-32769,E=(O?C:0)+(E>=8192?E-16384:E),(O?"":"$")+(w?xa(E):qa(E))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,E){Pn(C,0);for(var w=[],O=0,R="",X="",ne="",te="";C.l<C.length;){var oe=C[C.l++];switch(oe){case 0:w.push(C.read_shift(8,"f"));break;case 1:X=y(E[0].c,C.read_shift(2),!0),R=y(E[0].r,C.read_shift(2),!1),w.push(X+R);break;case 2:{var ce=y(E[0].c,C.read_shift(2),!0),re=y(E[0].r,C.read_shift(2),!1);X=y(E[0].c,C.read_shift(2),!0),R=y(E[0].r,C.read_shift(2),!1),w.push(ce+re+":"+X+R)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:w.push("("+w.pop()+")");break;case 5:w.push(C.read_shift(2));break;case 6:{for(var de="";oe=C[C.l++];)de+=String.fromCharCode(oe);w.push('"'+de.replace(/"/g,'""')+'"')}break;case 8:w.push("-"+w.pop());break;case 23:w.push("+"+w.pop());break;case 22:w.push("NOT("+w.pop()+")");break;case 20:case 21:te=w.pop(),ne=w.pop(),w.push(["AND","OR"][oe-20]+"("+ne+","+te+")");break;default:if(oe<32&&N[oe])te=w.pop(),ne=w.pop(),w.push(ne+N[oe]+te);else if(j[oe]){if(O=j[oe][1],O==69&&(O=C[C.l++]),O>w.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+w.join("|")+"|");return}var Ie=w.slice(-O);w.length-=O,w.push(j[oe][0]+"("+Ie.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}w.length==1?E[1].f=""+w[0]:console.error("WK1 bad formula parse |"+w.join("|")+"|")}function B(C){var E=[{c:0,r:0},{t:"n",v:0},0];return E[0].r=C.read_shift(2),E[3]=C[C.l++],E[0].c=C[C.l++],E}function P(C,E){var w=B(C);return w[1].t="s",w[1].v=C.read_shift(E-4,"cstr"),w}function L(C,E,w,O){var R=Kt(6+O.length);R.write_shift(2,C),R.write_shift(1,w),R.write_shift(1,E),R.write_shift(1,39);for(var X=0;X<O.length;++X){var ne=O.charCodeAt(X);R.write_shift(1,ne>=128?95:ne)}return R.write_shift(1,0),R}function U(C,E){var w=B(C);w[1].v=C.read_shift(2);var O=w[1].v>>1;if(w[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return w[1].v=O,w}function H(C,E){var w=B(C),O=C.read_shift(4),R=C.read_shift(4),X=C.read_shift(2);if(X==65535)return O===0&&R===3221225472?(w[1].t="e",w[1].v=15):O===0&&R===3489660928?(w[1].t="e",w[1].v=42):w[1].v=0,w;var ne=X&32768;return X=(X&32767)-16446,w[1].v=(1-ne*2)*(R*Math.pow(2,X+32)+O*Math.pow(2,X)),w}function q(C,E,w,O){var R=Kt(14);if(R.write_shift(2,C),R.write_shift(1,w),R.write_shift(1,E),O==0)return R.write_shift(4,0),R.write_shift(4,0),R.write_shift(2,65535),R;var X=0,ne=0,te=0,oe=0;return O<0&&(X=1,O=-O),ne=Math.log2(O)|0,O/=Math.pow(2,ne-31),oe=O>>>0,(oe&2147483648)==0&&(O/=2,++ne,oe=O>>>0),O-=oe,oe|=2147483648,oe>>>=0,O*=Math.pow(2,32),te=O>>>0,R.write_shift(4,te),R.write_shift(4,oe),ne+=16383+(X?32768:0),R.write_shift(2,ne),R}function V(C,E){var w=H(C);return C.l+=E-14,w}function M(C,E){var w=B(C),O=C.read_shift(4);return w[1].v=O>>6,w}function z(C,E){var w=B(C),O=C.read_shift(8,"f");return w[1].v=O,w}function I(C,E){var w=z(C);return C.l+=E-10,w}function G(C,E){return C[C.l+E-1]==0?C.read_shift(E,"cstr"):""}function Y(C,E){var w=C[C.l++];w>E-1&&(w=E-1);for(var O="";O.length<w;)O+=String.fromCharCode(C[C.l++]);return O}function J(C,E,w){if(!(!w.qpro||E<21)){var O=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var R=C.read_shift(E-21,"cstr");return[O,R]}}function T(C,E){for(var w={},O=C.l+E;C.l<O;){var R=C.read_shift(2);if(R==14e3){for(w[R]=[0,""],w[R][0]=C.read_shift(2);C[C.l];)w[R][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return w}function k(C,E){var w=Kt(5+C.length);w.write_shift(2,14e3),w.write_shift(2,E);for(var O=0;O<C.length;++O){var R=C.charCodeAt(O);w[w.l++]=R>127?95:R}return w[w.l++]=0,w}var D={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:A},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:G},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:H},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:T},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:M},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:I},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:G},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:J},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:s}})();function W9(t){var s={},r=t.match(mi),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=Gs(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":s.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;s.cp=dj[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":s.outline=1;break;case"</outline>":break;case"<rFont":s.name=i.val;break;case"<sz":s.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":s.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":s.uval="double";break;case"singleAccounting":s.uval="single-accounting";break;case"doubleAccounting":s.uval="double-accounting";break}case"<u>":case"<u/>":s.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":s.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":s.i=1;break;case"</i>":break;case"<color":i.rgb&&(s.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":s.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":s.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return s}var G9=(function(){var t=gf("t"),s=gf("rPr");function r(i){var l=i.match(t);if(!l)return{t:"s",v:""};var o={t:"s",v:yr(l[1])},u=i.match(s);return u&&(o.s=W9(u[1])),o}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(l){return l.replace(a,"").split(n).map(r).filter(function(o){return o.v})}})(),K9=(function(){var s=/(\r\n|\n)/g;function r(n,i,l){var o=[];n.u&&o.push("text-decoration: underline;"),n.uval&&o.push("text-underline-style:"+n.uval+";"),n.sz&&o.push("font-size:"+n.sz+"pt;"),n.outline&&o.push("text-effect: outline;"),n.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),n.b&&(i.push("<b>"),l.push("</b>")),n.i&&(i.push("<i>"),l.push("</i>")),n.strike&&(i.push("<s>"),l.push("</s>"));var u=n.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(i.push("<"+u+">"),l.push("</"+u+">")),l.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(s,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}})(),z9=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Y9=/<(?:\w+:)?r>/,X9=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Lj(t,s){var r=s?s.cellHTML:!0,a={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=yr($r(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=$r(t),r&&(a.h=bj(a.t))):t.match(Y9)&&(a.r=$r(t),a.t=yr($r((t.replace(X9,"").match(z9)||[]).join("").replace(mi,""))),r&&(a.h=K9(G9(a.r)))),a):{t:""}}var J9=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Z9=/<(?:\w+:)?(?:si|sstItem)>/g,eH=/<\/(?:\w+:)?(?:si|sstItem)>/;function tH(t,s){var r=[],a="";if(!t)return r;var n=t.match(J9);if(n){a=n[2].replace(Z9,"").split(eH);for(var i=0;i!=a.length;++i){var l=Lj(a[i].trim(),s);l!=null&&(r[r.length]=l)}n=Gs(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var sH=/^\s|\s$|[\t\n\r]/;function Hk(t,s){if(!s.bookSST)return"";var r=[$a];r[r.length]=ps("sst",null,{xmlns:jA[0],count:t.Count,uniqueCount:t.Unique});for(var a=0;a!=t.length;++a)if(t[a]!=null){var n=t[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(sH)&&(i+=' xml:space="preserve"'),i+=">"+qr(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function rH(t){return[t.read_shift(4),t.read_shift(4)]}function aH(t,s){var r=[],a=!1;return ad(t,function(i,l,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(l.T,!a||s.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function nH(t,s){return s||(s=Kt(8)),s.write_shift(4,t.Count),s.write_shift(4,t.Unique),s}var iH=pM;function lH(t){var s=Yi();as(s,159,nH(t));for(var r=0;r<t.length;++r)as(s,19,iH(t[r]));return as(s,160),s.end()}function qk(t){for(var s=[],r=t.split(""),a=0;a<r.length;++a)s[a]=r[a].charCodeAt(0);return s}function zc(t,s){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),s>=4&&(t.l+=s-4),r}function oH(t){var s={};return s.id=t.read_shift(0,"lpp4"),s.R=zc(t,4),s.U=zc(t,4),s.W=zc(t,4),s}function cH(t){for(var s=t.read_shift(4),r=t.l+s-4,a={},n=t.read_shift(4),i=[];n-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(a.name=t.read_shift(0,"lpp4"),a.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return a}function dH(t){var s=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)s.push(cH(t));return s}function uH(t){var s=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)s.push(t.read_shift(0,"lpp4"));return s}function AH(t){var s={};return t.read_shift(4),t.l+=4,s.id=t.read_shift(0,"lpp4"),s.name=t.read_shift(0,"lpp4"),s.R=zc(t,4),s.U=zc(t,4),s.W=zc(t,4),s}function hH(t){var s=AH(t);if(s.ename=t.read_shift(0,"8lpp4"),s.blksz=t.read_shift(4),s.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return s}function Vk(t,s){var r=t.l+s,a={};a.Flags=t.read_shift(4)&63,t.l+=4,a.AlgID=t.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=t.read_shift(4),a.KeySize=t.read_shift(4),a.ProviderType=t.read_shift(4),t.l+=8,a.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,a}function $k(t,s){var r={},a=t.l+s;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,a),t.l=a,r}function mH(t){var s=zc(t);switch(s.Minor){case 2:return[s.Minor,fH(t)];case 3:return[s.Minor,pH()];case 4:return[s.Minor,xH(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+s.Minor)}function fH(t){var s=t.read_shift(4);if((s&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),a=Vk(t,r),n=$k(t,t.length-t.l);return{t:"Std",h:a,v:n}}function pH(){throw new Error("File is password-protected: ECMA-376 Extensible")}function xH(t){var s=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),a={};return r.replace(mi,function(i){var l=Gs(i);switch(Ac(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":s.forEach(function(o){a[o]=l[o]});break;case"<dataIntegrity":a.encryptedHmacKey=l.encryptedHmacKey,a.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(l);break;default:throw l[0]}}),a}function gH(t,s){var r={},a=r.EncryptionVersionInfo=zc(t,4);if(s-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=t.read_shift(4),s-=4;var n=t.read_shift(4);return s-=4,r.EncryptionHeader=Vk(t,n),s-=n,r.EncryptionVerifier=$k(t,s),r}function vH(t){var s={},r=s.EncryptionVersionInfo=zc(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return s.Salt=t.read_shift(16),s.EncryptedVerifier=t.read_shift(16),s.EncryptedVerifierHash=t.read_shift(16),s}function Dj(t){var s=0,r,a=qk(t),n=a.length+1,i,l,o,u,d;for(r=Au(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)l=r[i],o=(s&16384)===0?0:1,u=s<<1&32767,d=o|u,s=d^l;return s^52811}var Wk=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],s=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(l){return(l/2|l*128)&255},n=function(l,o){return a(l^o)},i=function(l){for(var o=s[l.length-1],u=104,d=l.length-1;d>=0;--d)for(var c=l[d],h=0;h!=7;++h)c&64&&(o^=r[u]),c*=2,--u;return o};return function(l){for(var o=qk(l),u=i(o),d=o.length,c=Au(16),h=0;h!=16;++h)c[h]=0;var A,f,g;for((d&1)===1&&(A=u>>8,c[d]=n(t[0],A),--d,A=u&255,f=o[o.length-1],c[d]=n(f,A));d>0;)--d,A=u>>8,c[d]=n(o[d],A),--d,A=u&255,c[d]=n(o[d],A);for(d=15,g=15-o.length;g>0;)A=u>>8,c[d]=n(t[g],A),--d,--g,A=u&255,c[d]=n(o[d],A),--d,--g;return c}})(),bH=function(t,s,r,a,n){n||(n=s),a||(a=Wk(t));var i,l;for(i=0;i!=s.length;++i)l=s[i],l^=a[r],l=(l>>5|l<<3)&255,n[i]=l,++r;return[n,r,a]},yH=function(t){var s=0,r=Wk(t);return function(a){var n=bH("",a,s,r);return s=n[1],n[0]}};function jH(t,s,r,a){var n={key:en(t),verificationBytes:en(t)};return r.password&&(n.verifier=Dj(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=yH(r.password)),n}function NH(t,s,r){var a=r||{};return a.Info=t.read_shift(2),t.l-=2,a.Info===1?a.Data=vH(t):a.Data=gH(t,s),a}function wH(t,s,r){var a={Type:r.biff>=8?t.read_shift(2):0};return a.Type?NH(t,s-2,a):jH(t,r.biff>=8?s:s-2,r,a),a}var Gk=(function(){function t(n,i){switch(i.type){case"base64":return s(gl(n),i);case"binary":return s(n,i);case"buffer":return s(ir&&Buffer.isBuffer(n)?n.toString("binary"):gu(n),i);case"array":return s(pA(n),i)}throw new Error("Unrecognized type "+i.type)}function s(n,i){var l=i||{},o=l.dense?[]:{},u=n.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var A=/\\\w+\b/g,f=0,g,v=-1;g=A.exec(c);){switch(g[0]){case"\\cell":var b=c.slice(f,A.lastIndex-g[0].length);if(b[0]==" "&&(b=b.slice(1)),++v,b.length){var y={v:b,t:"s"};Array.isArray(o)?o[h][v]=y:o[$s({r:h,c:v})]=y}break}f=A.lastIndex}v>d.e.c&&(d.e.c=v)}),o["!ref"]=ar(d),o}function r(n,i){return vu(t(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],l=jr(n["!ref"]),o,u=Array.isArray(n),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var c=l.s.c;c<=l.e.c;++c)i.push("\\cellx"+(c+1));for(i.push("\\pard\\intbl"),c=l.s.c;c<=l.e.c;++c){var h=$s({r:d,c});o=u?(n[d]||[])[c]:n[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Zc(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:a}})();function _H(t){var s=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]}function jf(t){for(var s=0,r=1;s!=3;++s)r=r*256+(t[s]>255?255:t[s]<0?0:t[s]);return r.toString(16).toUpperCase().slice(1)}function SH(t){var s=t[0]/255,r=t[1]/255,a=t[2]/255,n=Math.max(s,r,a),i=Math.min(s,r,a),l=n-i;if(l===0)return[0,0,s];var o=0,u=0,d=n+i;switch(u=l/(d>1?2-d:d),n){case s:o=((r-a)/l+6)%6;break;case r:o=(a-s)/l+2;break;case a:o=(s-r)/l+4;break}return[o/6,u,d/2]}function CH(t){var s=t[0],r=t[1],a=t[2],n=r*2*(a<.5?a:1-a),i=a-n/2,l=[i,i,i],o=6*s,u;if(r!==0)switch(o|0){case 0:case 6:u=n*o,l[0]+=n,l[1]+=u;break;case 1:u=n*(2-o),l[0]+=u,l[1]+=n;break;case 2:u=n*(o-2),l[1]+=n,l[2]+=u;break;case 3:u=n*(4-o),l[1]+=u,l[2]+=n;break;case 4:u=n*(o-4),l[2]+=n,l[0]+=u;break;case 5:u=n*(6-o),l[2]+=u,l[0]+=n;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function x0(t,s){if(s===0)return t;var r=SH(_H(t));return s<0?r[2]=r[2]*(1+s):r[2]=1-(1-r[2])*(1-s),jf(CH(r))}var Kk=6,kH=15,BH=1,li=Kk;function Nf(t){return Math.floor((t+Math.round(128/li)/256)*li)}function wf(t){return Math.floor((t-5)/li*100+.5)/100}function g0(t){return Math.round((t*li+5)/li*256)/256}function tb(t){return g0(wf(Nf(t)))}function Uj(t){var s=Math.abs(t-tb(t)),r=li;if(s>.005)for(li=BH;li<kH;++li)Math.abs(t-tb(t))<=s&&(s=Math.abs(t-tb(t)),r=li);li=r}function hu(t){t.width?(t.wpx=Nf(t.width),t.wch=wf(t.wpx),t.MDW=li):t.wpx?(t.wch=wf(t.wpx),t.width=g0(t.wch),t.MDW=li):typeof t.wch=="number"&&(t.width=g0(t.wch),t.wpx=Nf(t.width),t.MDW=li),t.customWidth&&delete t.customWidth}var EH=96,zk=EH;function _f(t){return t*96/zk}function Ph(t){return t*zk/96}var FH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function TH(t,s,r,a){s.Borders=[];var n={},i=!1;(t[0].match(mi)||[]).forEach(function(l){var o=Gs(l);switch(Ac(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},o.diagonalUp&&(n.diagonalUp=na(o.diagonalUp)),o.diagonalDown&&(n.diagonalDown=na(o.diagonalDown)),s.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function IH(t,s,r,a){s.Fills=[];var n={},i=!1;(t[0].match(mi)||[]).forEach(function(l){var o=Gs(l);switch(Ac(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},s.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":s.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":o.patternType&&(n.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),o.indexed&&(n.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(n.bgColor.theme=parseInt(o.theme,10)),o.tint&&(n.bgColor.tint=parseFloat(o.tint)),o.rgb&&(n.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),o.theme&&(n.fgColor.theme=parseInt(o.theme,10)),o.tint&&(n.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(n.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function LH(t,s,r,a){s.Fonts=[];var n={},i=!1;(t[0].match(mi)||[]).forEach(function(l){var o=Gs(l);switch(Ac(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":s.Fonts.push(n),n={};break;case"<name":o.val&&(n.name=$r(o.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=o.val?na(o.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=o.val?na(o.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(o.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=o.val?na(o.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=o.val?na(o.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=o.val?na(o.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=o.val?na(o.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=o.val?na(o.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":o.val&&(n.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(n.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(n.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(n.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=dj[parseInt(o.val,10)];break;case"<color":if(n.color||(n.color={}),o.auto&&(n.color.auto=na(o.auto)),o.rgb)n.color.rgb=o.rgb.slice(-6);else if(o.indexed){n.color.index=parseInt(o.indexed,10);var u=cA[n.color.index];n.color.index==81&&(u=cA[1]),u||(u=cA[1]),n.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else o.theme&&(n.color.theme=parseInt(o.theme,10),o.tint&&(n.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=x0(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function DH(t,s,r){s.NumberFmt=[];for(var a=Ba(Hs),n=0;n<a.length;++n)s.NumberFmt[a[n]]=Hs[a[n]];var i=t[0].match(mi);if(i)for(n=0;n<i.length;++n){var l=Gs(i[n]);switch(Ac(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=yr($r(l.formatCode)),u=parseInt(l.numFmtId,10);if(s.NumberFmt[u]=o,u>0){if(u>392){for(u=392;u>60&&s.NumberFmt[u]!=null;--u);s.NumberFmt[u]=o}Kc(o,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function UH(t){var s=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)t[a]!=null&&(s[s.length]=ps("numFmt",null,{numFmtId:a,formatCode:qr(t[a])}))}),s.length===1?"":(s[s.length]="</numFmts>",s[0]=ps("numFmts",null,{count:s.length-2}).replace("/>",">"),s.join(""))}var px=["numFmtId","fillId","fontId","borderId","xfId"],xx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function PH(t,s,r){s.CellXf=[];var a,n=!1;(t[0].match(mi)||[]).forEach(function(i){var l=Gs(i),o=0;switch(Ac(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=l,delete a[0],o=0;o<px.length;++o)a[px[o]]&&(a[px[o]]=parseInt(a[px[o]],10));for(o=0;o<xx.length;++o)a[xx[o]]&&(a[xx[o]]=na(a[xx[o]]));if(s.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(s.NumberFmt[a.numFmtId]==s.NumberFmt[o]){a.numFmtId=o;break}}s.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};l.vertical&&(u.vertical=l.vertical),l.horizontal&&(u.horizontal=l.horizontal),l.textRotation!=null&&(u.textRotation=l.textRotation),l.indent&&(u.indent=l.indent),l.wrapText&&(u.wrapText=na(l.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function RH(t){var s=[];return s[s.length]=ps("cellXfs",null),t.forEach(function(r){s[s.length]=ps("xf",null,r)}),s[s.length]="</cellXfs>",s.length===2?"":(s[0]=ps("cellXfs",null,{count:s.length-2}).replace("/>",">"),s.join(""))}var OH=(function(){var s=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,u,d){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(s))&&DH(h,c,d),(h=o.match(n))&&LH(h,c,u,d),(h=o.match(a))&&IH(h,c,u,d),(h=o.match(i))&&TH(h,c,u,d),(h=o.match(r))&&PH(h,c,d),c}})();function Yk(t,s){var r=[$a,ps("styleSheet",null,{xmlns:jA[0],"xmlns:vt":on.vt})],a;return t.SSF&&(a=UH(t.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=RH(s.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function QH(t,s){var r=t.read_shift(2),a=ui(t);return[r,a]}function MH(t,s,r){r||(r=Kt(6+4*s.length)),r.write_shift(2,t),_n(s,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function HH(t,s,r){var a={};a.sz=t.read_shift(2)/20;var n=NM(t);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=t.read_shift(2);switch(i===700&&(a.bold=1),t.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(a.underline=l);var o=t.read_shift(1);o>0&&(a.family=o);var u=t.read_shift(1);switch(u>0&&(a.charset=u),t.l++,a.color=jM(t),t.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ui(t),a}function qH(t,s){s||(s=Kt(153)),s.write_shift(2,t.sz*20),wM(t,s),s.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),s.write_shift(2,r),s.write_shift(1,t.underline||0),s.write_shift(1,t.family||0),s.write_shift(1,t.charset||0),s.write_shift(1,0),m0(t.color,s);var a=0;return a=2,s.write_shift(1,a),_n(t.name,s),s.length>s.l?s.slice(0,s.l):s}var VH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],sb,$H=hi;function I_(t,s){s||(s=Kt(84)),sb||(sb=rg(VH));var r=sb[t.patternType];r==null&&(r=40),s.write_shift(4,r);var a=0;if(r!=40)for(m0({auto:1},s),m0({auto:1},s);a<12;++a)s.write_shift(4,0);else{for(;a<4;++a)s.write_shift(4,0);for(;a<12;++a)s.write_shift(4,0)}return s.length>s.l?s.slice(0,s.l):s}function WH(t,s){var r=t.l+s,a=t.read_shift(2),n=t.read_shift(2);return t.l=r,{ixfe:a,numFmtId:n}}function Xk(t,s,r){r||(r=Kt(16)),r.write_shift(2,s||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function jm(t,s){return s||(s=Kt(10)),s.write_shift(1,0),s.write_shift(1,0),s.write_shift(4,0),s.write_shift(4,0),s}var GH=hi;function KH(t,s){return s||(s=Kt(51)),s.write_shift(1,0),jm(null,s),jm(null,s),jm(null,s),jm(null,s),jm(null,s),s.length>s.l?s.slice(0,s.l):s}function zH(t,s){return s||(s=Kt(52)),s.write_shift(4,t.xfId),s.write_shift(2,1),s.write_shift(1,0),s.write_shift(1,0),h0(t.name||"",s),s.length>s.l?s.slice(0,s.l):s}function YH(t,s,r){var a=Kt(2052);return a.write_shift(4,t),h0(s,a),h0(r,a),a.length>a.l?a.slice(0,a.l):a}function XH(t,s,r){var a={};a.NumberFmt=[];for(var n in Hs)a.NumberFmt[n]=Hs[n];a.CellXf=[],a.Fonts=[];var i=[],l=!1;return ad(t,function(u,d,c){switch(c){case 44:a.NumberFmt[u[0]]=u[1],Kc(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&s&&s.themeElements&&s.themeElements.clrScheme&&(u.color.rgb=x0(s.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(c),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(c);else if(d.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function JH(t,s){if(s){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)s[n]!=null&&++r}),r!=0&&(as(t,615,Eo(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)s[n]!=null&&as(t,44,MH(n,s[n]))}),as(t,616))}}function ZH(t){var s=1;as(t,611,Eo(s)),as(t,43,qH({sz:12,color:{theme:1},name:"Calibri",family:2})),as(t,612)}function eq(t){var s=2;as(t,603,Eo(s)),as(t,45,I_({patternType:"none"})),as(t,45,I_({patternType:"gray125"})),as(t,604)}function tq(t){var s=1;as(t,613,Eo(s)),as(t,46,KH()),as(t,614)}function sq(t){var s=1;as(t,626,Eo(s)),as(t,47,Xk({numFmtId:0},65535)),as(t,627)}function rq(t,s){as(t,617,Eo(s.length)),s.forEach(function(r){as(t,47,Xk(r,0))}),as(t,618)}function aq(t){var s=1;as(t,619,Eo(s)),as(t,48,zH({xfId:0,name:"Normal"})),as(t,620)}function nq(t){var s=0;as(t,505,Eo(s)),as(t,506)}function iq(t){var s=0;as(t,508,YH(s,"TableStyleMedium9","PivotStyleMedium4")),as(t,509)}function lq(t,s){var r=Yi();return as(r,278),JH(r,t.SSF),ZH(r),eq(r),tq(r),sq(r),rq(r,s.cellXfs),aq(r),nq(r),iq(r),as(r,279),r.end()}var oq=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function cq(t,s,r){s.themeElements.clrScheme=[];var a={};(t[0].match(mi)||[]).forEach(function(n){var i=Gs(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(s.themeElements.clrScheme[oq.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function dq(){}function uq(){}var Aq=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,hq=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mq=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function fq(t,s,r){s.themeElements={};var a;[["clrScheme",Aq,cq],["fontScheme",hq,dq],["fmtScheme",mq,uq]].forEach(function(n){if(!(a=t.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,s,r)})}var pq=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Jk(t,s){(!t||t.length===0)&&(t=Pj());var r,a={};if(!(r=t.match(pq)))throw new Error("themeElements not found in theme");return fq(r[0],a,s),a.raw=t,a}function Pj(t,s){if(s&&s.themeXLSX)return s.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[$a];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function xq(t,s,r){var a=t.l+s,n=t.read_shift(4);if(n!==124226){if(!r.cellStyles){t.l=a;return}var i=t.slice(t.l);t.l=a;var l;try{l=V4(i,{type:"array"})}catch{return}var o=hl(l,"theme/theme/theme1.xml",!0);if(o)return Jk(o,r)}}function gq(t){return t.read_shift(4)}function vq(t){var s={};switch(s.xclrType=t.read_shift(2),s.nTintShade=t.read_shift(2),s.xclrType){case 0:t.l+=4;break;case 1:s.xclrValue=bq(t,4);break;case 2:s.xclrValue=Fk(t);break;case 3:s.xclrValue=gq(t);break;case 4:t.l+=4;break}return t.l+=8,s}function bq(t,s){return hi(t,s)}function yq(t,s){return hi(t,s)}function jq(t){var s=t.read_shift(2),r=t.read_shift(2)-4,a=[s];switch(s){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=vq(t);break;case 6:a[1]=yq(t,r);break;case 14:case 15:a[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+s+" "+r)}return a}function Nq(t,s){var r=t.l+s;t.l+=2;var a=t.read_shift(2);t.l+=2;for(var n=t.read_shift(2),i=[];n-- >0;)i.push(jq(t,r-t.l));return{ixfe:a,ext:i}}function wq(t,s){s.forEach(function(r){r[0]})}function _q(t,s){return{flags:t.read_shift(4),version:t.read_shift(4),name:ui(t)}}function Sq(t){var s=Kt(12+2*t.name.length);return s.write_shift(4,t.flags),s.write_shift(4,t.version),_n(t.name,s),s.slice(0,s.l)}function Cq(t){for(var s=[],r=t.read_shift(4);r-- >0;)s.push([t.read_shift(4),t.read_shift(4)]);return s}function kq(t){var s=Kt(4+8*t.length);s.write_shift(4,t.length);for(var r=0;r<t.length;++r)s.write_shift(4,t[r][0]),s.write_shift(4,t[r][1]);return s}function Bq(t,s){var r=Kt(8+2*s.length);return r.write_shift(4,t),_n(s,r),r.slice(0,r.l)}function Eq(t){return t.l+=4,t.read_shift(4)!=0}function Fq(t,s){var r=Kt(8);return r.write_shift(4,t),r.write_shift(4,1),r}function Tq(t,s,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],l=!1,o=2;return ad(t,function(u,d,c){switch(c){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(h){o==1?a.Cell.push({type:a.Types[h[0]-1].name,index:h[1]}):o==0&&a.Value.push({type:a.Types[h[0]-1].name,index:h[1]})});break;case 337:o=u?1:0;break;case 338:o=2;break;case 35:i.push(c),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),a}function Iq(){var t=Yi();return as(t,332),as(t,334,Eo(1)),as(t,335,Sq({name:"XLDAPR",version:12e4,flags:3496657072})),as(t,336),as(t,339,Bq(1,"XLDAPR")),as(t,52),as(t,35,Eo(514)),as(t,4096,Eo(0)),as(t,4097,Ql(1)),as(t,36),as(t,53),as(t,340),as(t,337,Fq(1)),as(t,51,kq([[1,0]])),as(t,338),as(t,333),t.end()}function Lq(t,s,r){var a={Types:[],Cell:[],Value:[]};if(!t)return a;var n=!1,i=2,l;return t.replace(mi,function(o){var u=Gs(o);switch(Ac(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==u.name&&(l=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):i==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+u.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return o}),a}function Zk(){var t=[$a];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Dq(t){var s=[];if(!t)return s;var r=1;return(t.match(mi)||[]).forEach(function(a){var n=Gs(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,s.push(n);break}}),s}function Uq(t){var s={};s.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),s.r=$s(r);var a=t.read_shift(1);return a&2&&(s.l="1"),a&8&&(s.a="1"),s}function Pq(t,s,r){var a=[];return ad(t,function(i,l,o){switch(o){case 63:a.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function Rq(t,s,r,a){if(!t)return t;var n=a||{},i=!1;ad(t,function(o,u,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!u.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},n)}function Oq(t,s){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return s["!id"][r].Target}var vh=1024;function eB(t,s){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[ps("xml",null,{"xmlns:v":dl.v,"xmlns:o":dl.o,"xmlns:x":dl.x,"xmlns:mv":dl.mv}).replace(/\/>/,">"),ps("o:shapelayout",ps("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ps("v:shapetype",[ps("v:stroke",null,{joinstyle:"miter"}),ps("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];vh<t*1e3;)vh+=1e3;return s.forEach(function(i){var l=ga(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var u=o.type=="gradient"?ps("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=ps("v:fill",u,o),c={on:"t",obscured:"t"};++vh,n=n.concat(["<v:shape"+vf({id:"_x0000_s"+vh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,ps("v:shadow",null,c),ps("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Rn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Rn("x:AutoFill","False"),Rn("x:Row",String(l.r)),Rn("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function L_(t,s,r,a){var n=Array.isArray(t),i;s.forEach(function(l){var o=ga(l.ref);if(n?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[l.ref],!i){i={t:"z"},n?t[o.r][o.c]=i:t[l.ref]=i;var u=jr(t["!ref"]||"BDWGO1000001:A1");u.s.r>o.r&&(u.s.r=o.r),u.e.r<o.r&&(u.e.r=o.r),u.s.c>o.c&&(u.s.c=o.c),u.e.c<o.c&&(u.e.c=o.c);var d=ar(u);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var c={a:l.author,t:l.t,r:l.r,T:r};l.h&&(c.h=l.h);for(var h=i.c.length-1;h>=0;--h){if(!r&&i.c[h].T)return;r&&!i.c[h].T&&i.c.splice(h,1)}if(r&&a){for(h=0;h<a.length;++h)if(c.a==a[h].id){c.a=a[h].name||c.a;break}}i.c.push(c)})}function Qq(t,s){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var o=l.match(/<(?:\w+:)?comment[^>]*>/);if(o){var u=Gs(o[0]),d={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},c=ga(u.ref);if(!(s.sheetRows&&s.sheetRows<=c.r)){var h=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),A=!!h&&!!h[1]&&Lj(h[1])||{r:"",t:"",h:""};d.r=A.r,A.r=="<t></t>"&&(A.t=A.h=""),d.t=(A.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),s.cellHTML&&(d.h=A.h),a.push(d)}}}}),a}function tB(t){var s=[$a,ps("comments",null,{xmlns:jA[0]})],r=[];return s.push("<authors>"),t.forEach(function(a){a[1].forEach(function(n){var i=qr(n.a);r.indexOf(i)==-1&&(r.push(i),s.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),s.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),s.push("<author>SheetJ5</author>")),s.push("</authors>"),s.push("<commentList>"),t.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(u){u.a&&(n=r.indexOf(qr(u.a))),i.push(u.t||"")}),s.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)s.push(Rn("t",qr(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)l+=`Reply:
    `+i[o]+`
`;s.push(Rn("t",qr(l)))}s.push("</text></comment>")}),s.push("</commentList>"),s.length>2&&(s[s.length]="</comments>",s[1]=s[1].replace("/>",">")),s.join("")}function Mq(t,s){var r=[],a=!1,n={},i=0;return t.replace(mi,function(o,u){var d=Gs(o);switch(Ac(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=u+o.length;break;case"</text>":n.t=t.slice(i,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function Hq(t,s,r){var a=[$a,ps("ThreadedComments",null,{xmlns:on.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var i="";(n[1]||[]).forEach(function(l,o){if(!l.T){delete l.ID;return}l.a&&s.indexOf(l.a)==-1&&s.push(l.a);var u={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=u.id:u.parentId=i,l.ID=u.id,l.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+s.indexOf(l.a)).slice(-12)+"}"),a.push(ps("threadedComment",Rn("text",l.t||""),u))})}),a.push("</ThreadedComments>"),a.join("")}function qq(t,s){var r=[],a=!1;return t.replace(mi,function(i){var l=Gs(i);switch(Ac(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function Vq(t){var s=[$a,ps("personList",null,{xmlns:on.TCMNT,"xmlns:x":jA[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,a){s.push(ps("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),s.push("</personList>"),s.join("")}function $q(t){var s={};s.iauthor=t.read_shift(4);var r=SA(t);return s.rfx=r.s,s.ref=$s(r.s),t.l+=16,s}function Wq(t,s){return s==null&&(s=Kt(36)),s.write_shift(4,t[1].iauthor),zh(t[0],s),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s}var Gq=ui;function Kq(t){return _n(t.slice(0,54))}function zq(t,s){var r=[],a=[],n={},i=!1;return ad(t,function(o,u,d){switch(d){case 632:a.push(o);break;case 635:n=o;break;case 637:n.t=o.t,n.h=o.h,n.r=o.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,s.sheetRows&&n.rfx&&s.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function Yq(t){var s=Yi(),r=[];return as(s,628),as(s,630),t.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),as(s,632,Kq(n.a)))})}),as(s,631),as(s,633),t.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:ga(a[0]),e:ga(a[0])};as(s,635,Wq([i,n])),n.t&&n.t.length>0&&as(s,637,gM(n)),as(s,636),delete n.iauthor})}),as(s,634),as(s,629),s.end()}var Xq="application/vnd.ms-office.vbaProject";function Jq(t){var s=Rs.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Rs.utils.cfb_add(s,n,t.FileIndex[a].content)}}),Rs.write(s)}function Zq(t,s){s.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Rs.utils.cfb_add(t,n,s.FileIndex[a].content)}})}var sB=["xlsb","xlsm","xlam","biff8","xla"];function eV(){return{"!type":"dialog"}}function tV(){return{"!type":"dialog"}}function sV(){return{"!type":"macro"}}function rV(){return{"!type":"macro"}}var kh=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,s={r:0,c:0};function r(a,n,i,l){var o=!1,u=!1;i.length==0?u=!0:i.charAt(0)=="["&&(u=!0,i=i.slice(1,-1)),l.length==0?o=!0:l.charAt(0)=="["&&(o=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,c=l.length>0?parseInt(l,10)|0:0;return o?c+=s.c:--c,u?d+=s.r:--d,n+(o?"":"$")+xa(c)+(u?"":"$")+qa(d)}return function(n,i){return s=i,n.replace(t,r)}})(),Rj=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Oj=(function(){return function(s,r){return s.replace(Rj,function(a,n,i,l,o,u){var d=_j(l)-(i?0:r.c),c=wj(u)-(o?0:r.r),h=c==0?"":o?c+1:"["+c+"]",A=d==0?"":i?d+1:"["+d+"]";return n+"R"+h+"C"+A})}})();function rB(t,s){return t.replace(Rj,function(r,a,n,i,l,o){return a+(n=="$"?n+i:xa(_j(i)+s.c))+(l=="$"?l+o:qa(wj(o)+s.r))})}function aV(t,s,r){var a=Xi(s),n=a.s,i=ga(r),l={r:i.r-n.r,c:i.c-n.c};return rB(t,l)}function nV(t){return t.length!=1}function D_(t){return t.replace(/_xlfn\./g,"")}function Ja(t){t.l+=1}function mu(t,s){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function aB(t,s,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return nB(t);r.biff==12&&(a=4)}var n=t.read_shift(a),i=t.read_shift(a),l=mu(t),o=mu(t);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function nB(t){var s=mu(t),r=mu(t),a=t.read_shift(1),n=t.read_shift(1);return{s:{r:s[0],c:a,cRel:s[1],rRel:s[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function iV(t,s,r){if(r.biff<8)return nB(t);var a=t.read_shift(r.biff==12?4:2),n=t.read_shift(r.biff==12?4:2),i=mu(t),l=mu(t);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function iB(t,s,r){if(r&&r.biff>=2&&r.biff<=5)return lV(t);var a=t.read_shift(r&&r.biff==12?4:2),n=mu(t);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function lV(t){var s=mu(t),r=t.read_shift(1);return{r:s[0],c:r,cRel:s[1],rRel:s[2]}}function oV(t){var s=t.read_shift(2),r=t.read_shift(2);return{r:s,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function cV(t,s,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return dV(t);var n=t.read_shift(a>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;n>524287;)n-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:l,rRel:o}}function dV(t){var s=t.read_shift(2),r=t.read_shift(1),a=(s&32768)>>15,n=(s&16384)>>14;return s&=16383,a==1&&s>=8192&&(s=s-16384),n==1&&r>=128&&(r=r-256),{r:s,c:r,cRel:n,rRel:a}}function uV(t,s,r){var a=(t[t.l++]&96)>>5,n=aB(t,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function AV(t,s,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=aB(t,i,r);return[a,n,l]}function hV(t,s,r){var a=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function mV(t,s,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[a,n]}function fV(t,s,r){var a=(t[t.l++]&96)>>5,n=iV(t,s-1,r);return[a,n]}function pV(t,s,r){var a=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[a]}function U_(t){var s=t[t.l+1]&1,r=1;return t.l+=4,[s,r]}function xV(t,s,r){t.l+=2;for(var a=t.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(t.read_shift(r&&r.biff==2?1:2));return n}function gV(t,s,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function vV(t,s,r){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(r&&r.biff==2?1:2)]}function bV(t){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(2)]}function yV(t,s,r){var a=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[a]}function lB(t){var s=t.read_shift(1),r=t.read_shift(1);return[s,r]}function jV(t){return t.read_shift(2),lB(t)}function NV(t){return t.read_shift(2),lB(t)}function wV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=iB(t,0,r);return[a,n]}function _V(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=cV(t,0,r);return[a,n]}function SV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=iB(t,0,r);return[a,n,i]}function CV(t,s,r){var a=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(r&&r.biff<=3?1:2);return[E$[n],dB[n],a]}function kV(t,s,r){var a=t[t.l++],n=t.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,t.read_shift(1)]:BV(t);return[n,(i[0]===0?dB:B$)[i[1]]]}function BV(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function EV(t,s,r){t.l+=r&&r.biff==2?3:4}function FV(t,s,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var a=t.read_shift(2),n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function TV(t){return t.l++,nd[t.read_shift(1)]}function IV(t){return t.l++,t.read_shift(2)}function LV(t){return t.l++,t.read_shift(1)!==0}function DV(t){return t.l++,di(t)}function UV(t,s,r){return t.l++,Hf(t,s-1,r)}function PV(t,s){var r=[t.read_shift(1)];if(s==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ra(t,1)?"TRUE":"FALSE",s!=12&&(t.l+=7);break;case 37:case 16:r[1]=nd[t[t.l]],t.l+=s==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=di(t);break;case 2:r[1]=CA(t,0,{biff:s>0&&s<8?2:s});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function RV(t,s,r){for(var a=t.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?SA:ig)(t));return n}function OV(t,s,r){var a=0,n=0;r.biff==12?(a=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),a=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,l=[];i!=a&&(l[i]=[]);++i)for(var o=0;o!=n;++o)l[i][o]=PV(t,r.biff);return l}function QV(t,s,r){var a=t.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=t.read_shift(n);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[a,0,i]}function MV(t,s,r){if(r.biff==5)return HV(t);var a=t.read_shift(1)>>>5&3,n=t.read_shift(2),i=t.read_shift(4);return[a,n,i]}function HV(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var a=t.read_shift(2);return t.l+=12,[s,r,a]}function qV(t,s,r){var a=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function VV(t,s,r){var a=t.read_shift(1)>>>5&3,n=t.read_shift(r&&r.biff==2?1:2);return[a,n]}function $V(t,s,r){var a=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[a]}function WV(t,s,r){var a=(t[t.l++]&96)>>5,n=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[a,n]}var GV=hi,KV=hi,zV=hi;function Vf(t,s,r){return t.l+=2,[oV(t)]}function Qj(t){return t.l+=6,[]}var YV=Vf,XV=Qj,JV=Qj,ZV=Vf;function oB(t){return t.l+=2,[en(t),t.read_shift(2)&1]}var e$=Vf,t$=oB,s$=Qj,r$=Vf,a$=Vf,n$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function i$(t){t.l+=2;var s=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(4),n=t.read_shift(2),i=t.read_shift(2),l=n$[r>>2&31];return{ixti:s,coltype:r&3,rt:l,idx:a,c:n,C:i}}function l$(t){return t.l+=2,[t.read_shift(4)]}function o$(t,s,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function c$(t,s,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function d$(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[s,r]}function u$(t){var s=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[s,r]}function A$(t){return t.l+=4,[0,0]}var P_={1:{n:"PtgExp",f:FV},2:{n:"PtgTbl",f:zV},3:{n:"PtgAdd",f:Ja},4:{n:"PtgSub",f:Ja},5:{n:"PtgMul",f:Ja},6:{n:"PtgDiv",f:Ja},7:{n:"PtgPower",f:Ja},8:{n:"PtgConcat",f:Ja},9:{n:"PtgLt",f:Ja},10:{n:"PtgLe",f:Ja},11:{n:"PtgEq",f:Ja},12:{n:"PtgGe",f:Ja},13:{n:"PtgGt",f:Ja},14:{n:"PtgNe",f:Ja},15:{n:"PtgIsect",f:Ja},16:{n:"PtgUnion",f:Ja},17:{n:"PtgRange",f:Ja},18:{n:"PtgUplus",f:Ja},19:{n:"PtgUminus",f:Ja},20:{n:"PtgPercent",f:Ja},21:{n:"PtgParen",f:Ja},22:{n:"PtgMissArg",f:Ja},23:{n:"PtgStr",f:UV},26:{n:"PtgSheet",f:o$},27:{n:"PtgEndSheet",f:c$},28:{n:"PtgErr",f:TV},29:{n:"PtgBool",f:LV},30:{n:"PtgInt",f:IV},31:{n:"PtgNum",f:DV},32:{n:"PtgArray",f:pV},33:{n:"PtgFunc",f:CV},34:{n:"PtgFuncVar",f:kV},35:{n:"PtgName",f:QV},36:{n:"PtgRef",f:wV},37:{n:"PtgArea",f:uV},38:{n:"PtgMemArea",f:qV},39:{n:"PtgMemErr",f:GV},40:{n:"PtgMemNoMem",f:KV},41:{n:"PtgMemFunc",f:VV},42:{n:"PtgRefErr",f:$V},43:{n:"PtgAreaErr",f:hV},44:{n:"PtgRefN",f:_V},45:{n:"PtgAreaN",f:fV},46:{n:"PtgMemAreaN",f:d$},47:{n:"PtgMemNoMemN",f:u$},57:{n:"PtgNameX",f:MV},58:{n:"PtgRef3d",f:SV},59:{n:"PtgArea3d",f:AV},60:{n:"PtgRefErr3d",f:WV},61:{n:"PtgAreaErr3d",f:mV},255:{}},h$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},m$={1:{n:"PtgElfLel",f:oB},2:{n:"PtgElfRw",f:r$},3:{n:"PtgElfCol",f:YV},6:{n:"PtgElfRwV",f:a$},7:{n:"PtgElfColV",f:ZV},10:{n:"PtgElfRadical",f:e$},11:{n:"PtgElfRadicalS",f:s$},13:{n:"PtgElfColS",f:XV},15:{n:"PtgElfColSV",f:JV},16:{n:"PtgElfRadicalLel",f:t$},25:{n:"PtgList",f:i$},29:{n:"PtgSxName",f:l$},255:{}},f$={0:{n:"PtgAttrNoop",f:A$},1:{n:"PtgAttrSemi",f:yV},2:{n:"PtgAttrIf",f:vV},4:{n:"PtgAttrChoose",f:xV},8:{n:"PtgAttrGoto",f:gV},16:{n:"PtgAttrSum",f:EV},32:{n:"PtgAttrBaxcel",f:U_},33:{n:"PtgAttrBaxcel",f:U_},64:{n:"PtgAttrSpace",f:jV},65:{n:"PtgAttrSpaceSemi",f:NV},128:{n:"PtgAttrIfError",f:bV},255:{}};function $f(t,s,r,a){if(a.biff<8)return hi(t,s);for(var n=t.l+s,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=OV(t,0,a),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=RV(t,r[l][1],a),i.push(r[l][2]);break;case"PtgExp":a&&a.biff==12&&(r[l][1][1]=t.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return s=n-t.l,s!==0&&i.push(hi(t,s)),i}function Wf(t,s,r){for(var a=t.l+s,n,i,l=[];a!=t.l;)s=a-t.l,i=t[t.l],n=P_[i]||P_[h$[i]],(i===24||i===25)&&(n=(i===24?m$:f$)[t[t.l+1]]),!n||!n.f?hi(t,s):l.push([n.n,n.f(t,s,r)]);return l}function p$(t){for(var s=[],r=0;r<t.length;++r){for(var a=t[r],n=[],i=0;i<a.length;++i){var l=a[i];if(l)switch(l[0]){case 2:n.push('"'+l[1].replace(/"/g,'""')+'"');break;default:n.push(l[1])}else n.push("")}s.push(n.join(","))}return s.join(";")}var x$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function g$(t,s){if(!t&&!(s&&s.biff<=5&&s.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function cB(t,s,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[s]))return t.SheetNames[s];if(!t.XTI)return"SH33TJSERR6";var a=t.XTI[s];if(r.biff<8)return s>1e4&&(s-=65536),s<0&&(s=-s),s==0?"":t.XTI[s-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(t[a[0]][0]){case 357:return n=a[1]==-1?"#REF":t.SheetNames[a[1]],a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[a[0]][0];case 355:default:return"SH33TJSSRC"+t[a[0]][0]}switch(t[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":t.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+t.SheetNames[a[2]];case 14849:return t[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[a[0]][0][3]?(n=a[1]==-1?"#REF":t[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+t[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function R_(t,s,r){var a=cB(t,s,r);return a=="#REF"?a:g$(a,r)}function ii(t,s,r,a,n){var i=n&&n.biff||8,l={s:{c:0,r:0}},o=[],u,d,c,h=0,A=0,f,g="";if(!t[0]||!t[0][0])return"";for(var v=-1,b="",y=0,j=t[0].length;y<j;++y){var N=t[0][y];switch(N[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=o.pop(),d=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:b=Ca(" ",t[0][v][1][1]);break;case 1:b=Ca("\r",t[0][v][1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}d=d+b,v=-1}o.push(d+x$[N[0]]+u);break;case"PtgIsect":u=o.pop(),d=o.pop(),o.push(d+" "+u);break;case"PtgUnion":u=o.pop(),d=o.pop(),o.push(d+","+u);break;case"PtgRange":u=o.pop(),d=o.pop(),o.push(d+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Ym(N[1][1],l,n),o.push(Xm(c,i));break;case"PtgRefN":c=r?Ym(N[1][1],r,n):N[1][1],o.push(Xm(c,i));break;case"PtgRef3d":h=N[1][1],c=Ym(N[1][2],l,n),g=R_(a,h,n),o.push(g+"!"+Xm(c,i));break;case"PtgFunc":case"PtgFuncVar":var S=N[1][0],B=N[1][1];S||(S=0),S&=127;var P=S==0?[]:o.slice(-S);o.length-=S,B==="User"&&(B=P.shift()),o.push(B+"("+P.join(",")+")");break;case"PtgBool":o.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(N[1]);break;case"PtgNum":o.push(String(N[1]));break;case"PtgStr":o.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(N[1]);break;case"PtgAreaN":f=h_(N[1][1],r?{s:r}:l,n),o.push(Jv(f,n));break;case"PtgArea":f=h_(N[1][1],l,n),o.push(Jv(f,n));break;case"PtgArea3d":h=N[1][1],f=N[1][2],g=R_(a,h,n),o.push(g+"!"+Jv(f,n));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":A=N[1][2];var L=(a.names||[])[A-1]||(a[0]||[])[A],U=L?L.Name:"SH33TJSNAME"+String(A);U&&U.slice(0,6)=="_xlfn."&&!n.xlfn&&(U=U.slice(6)),o.push(U);break;case"PtgNameX":var H=N[1][1];A=N[1][2];var q;if(n.biff<=5)H<0&&(H=-H),a[H]&&(q=a[H][A]);else{var V="";if(((a[H]||[])[0]||[])[0]==14849||(((a[H]||[])[0]||[])[0]==1025?a[H][A]&&a[H][A].itab>0&&(V=a.SheetNames[a[H][A].itab-1]+"!"):V=a.SheetNames[A-1]+"!"),a[H]&&a[H][A])V+=a[H][A].Name;else if(a[0]&&a[0][A])V+=a[0][A].Name;else{var M=(cB(a,H,n)||"").split(";;");M[A-1]?V=M[A-1]:V+="SH33TJSERRX"}o.push(V);break}q||(q={Name:"SH33TJSERRY"}),o.push(q.Name);break;case"PtgParen":var z="(",I=")";if(v>=0){switch(b="",t[0][v][1][0]){case 2:z=Ca(" ",t[0][v][1][1])+z;break;case 3:z=Ca("\r",t[0][v][1][1])+z;break;case 4:I=Ca(" ",t[0][v][1][1])+I;break;case 5:I=Ca("\r",t[0][v][1][1])+I;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(z+o.pop()+I);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:N[1][1],r:N[1][0]};var G={c:r.c,r:r.r};if(a.sharedf[$s(c)]){var Y=a.sharedf[$s(c)];o.push(ii(Y,l,G,a,n))}else{var J=!1;for(u=0;u!=a.arrayf.length;++u)if(d=a.arrayf[u],!(c.c<d[0].s.c||c.c>d[0].e.c)&&!(c.r<d[0].s.r||c.r>d[0].e.r)){o.push(ii(d[1],l,G,a,n)),J=!0;break}J||o.push(N[1])}break;case"PtgArray":o.push("{"+p$(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var T=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&v>=0&&T.indexOf(t[0][y][0])==-1){N=t[0][v];var k=!0;switch(N[1][0]){case 4:k=!1;case 0:b=Ca(" ",N[1][1]);break;case 5:k=!1;case 1:b=Ca("\r",N[1][1]);break;default:if(b="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}o.push((k?b:"")+o.pop()+(k?"":b)),v=-1}}if(o.length>1&&n.WTF)throw new Error("bad formula stack");return o[0]}function v$(t,s,r){var a=t.l+s,n=r.biff==2?1:2,i,l=t.read_shift(n);if(l==65535)return[[],hi(t,s-2)];var o=Wf(t,l,r);return s!==l+n&&(i=$f(t,s-l-n,o,r)),t.l=a,[o,i]}function b$(t,s,r){var a=t.l+s,n=r.biff==2?1:2,i,l=t.read_shift(n);if(l==65535)return[[],hi(t,s-2)];var o=Wf(t,l,r);return s!==l+n&&(i=$f(t,s-l-n,o,r)),t.l=a,[o,i]}function y$(t,s,r,a){var n=t.l+s,i=Wf(t,a,r),l;return n!==t.l&&(l=$f(t,n-t.l,i,r)),[i,l]}function j$(t,s,r){var a=t.l+s,n,i=t.read_shift(2),l=Wf(t,i,r);return i==65535?[[],hi(t,s-2)]:(s!==i+2&&(n=$f(t,a-i-2,l,r)),[l,n])}function N$(t){var s;if(qc(t,t.l+6)!==65535)return[di(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return s=t[t.l+2]===1,t.l+=8,[s,"b"];case 2:return s=t[t.l+2],t.l+=8,[s,"e"];case 3:return t.l+=8,["","s"]}return[]}function w$(t){if(t==null){var s=Kt(8);return s.write_shift(1,3),s.write_shift(1,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,65535),s}else if(typeof t=="number")return xA(t);return xA(0)}function rb(t,s,r){var a=t.l+s,n=hc(t);r.biff==2&&++t.l;var i=N$(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=b$(t,a-t.l,r);return{cell:n,val:i[0],formula:o,shared:l>>3&1,tt:i[1]}}function _$(t,s,r,a,n){var i=vA(s,r,n),l=w$(t.v),o=Kt(6),u=33;o.write_shift(2,u),o.write_shift(4,0);for(var d=Kt(t.bf.length),c=0;c<t.bf.length;++c)d[c]=t.bf[c];var h=wn([i,l,o,d]);return h}function lg(t,s,r){var a=t.read_shift(4),n=Wf(t,a,r),i=t.read_shift(4),l=i>0?$f(t,i,n,r):null;return[n,l]}var S$=lg,og=lg,C$=lg,k$=lg,B$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},dB={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},E$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function O_(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(s,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function F$(t){var s="of:="+t.replace(Rj,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return s.replace(/;/g,"|").replace(/,/g,";")}function ab(t){var s=t.split(":"),r=s[0].split(".")[0];return[r,s[0].split(".")[1]+(s.length>1?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}function T$(t){return t.replace(/\./,"!")}var Zm={},Bh={},ef=typeof Map<"u";function Mj(t,s,r){var a=0,n=t.length;if(r){if(ef?r.has(s):Object.prototype.hasOwnProperty.call(r,s)){for(var i=ef?r.get(s):r[s];a<i.length;++a)if(t[i[a]].t===s)return t.Count++,i[a]}}else for(;a<n;++a)if(t[a].t===s)return t.Count++,a;return t[n]={t:s},t.Count++,t.Unique++,r&&(ef?(r.has(s)||r.set(s,[]),r.get(s).push(n)):(Object.prototype.hasOwnProperty.call(r,s)||(r[s]=[]),r[s].push(n))),n}function cg(t,s){var r={min:t+1,max:t+1},a=-1;return s.MDW&&(li=s.MDW),s.width!=null?r.customWidth=1:s.wpx!=null?a=wf(s.wpx):s.wch!=null&&(a=s.wch),a>-1?(r.width=g0(a),r.customWidth=1):s.width!=null&&(r.width=s.width),s.hidden&&(r.hidden=!0),s.level!=null&&(r.outlineLevel=r.level=s.level),r}function AA(t,s){if(t){var r=[.7,.7,.75,.75,.3,.3];s=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function bu(t,s,r){var a=r.revssf[s.z!=null?s.z:"General"],n=60,i=t.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Kc(s.z,n),r.ssf[n]=s.z,r.revssf[s.z]=a=n;break}}for(n=0;n!=i;++n)if(t[n].numFmtId===a)return n;return t[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function uB(t,s,r,a,n,i){try{a.cellNF&&(t.z=Hs[s])}catch(o){if(a.WTF)throw o}if(!(t.t==="z"&&!a.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=la(t.v)),(!a||a.cellText!==!1)&&t.t!=="z")try{if(Hs[s]==null&&Kc(BQ[s]||"General",s),t.t==="e")t.w=t.w||nd[t.v];else if(s===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=xf(t.v);else if(t.t==="d"){var l=cn(t.v);(l|0)===l?t.w=l.toString(10):t.w=xf(l)}else{if(t.v===void 0)return"";t.w=fA(t.v,Bh)}else t.t==="d"?t.w=Wl(s,cn(t.v),Bh):t.w=Wl(s,t.v,Bh)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=x0(n.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),a.WTF&&(t.s.fgColor.raw_rgb=n.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=x0(n.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),a.WTF&&(t.s.bgColor.raw_rgb=n.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&i.Fills)throw o}}}function I$(t,s,r){if(t&&t["!ref"]){var a=jr(t["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function L$(t,s){var r=jr(s);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ar(r))}var D$=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,U$=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,P$=/<(?:\w:)?hyperlink [^>]*>/mg,R$=/"(\w*:\w*)"/,O$=/<(?:\w:)?col\b[^>]*[\/]?>/g,Q$=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,M$=/<(?:\w:)?pageMargins[^>]*\/>/g,AB=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,H$=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,q$=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function V$(t,s,r,a,n,i,l){if(!t)return t;a||(a={"!id":{}});var o=s.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",c="",h=t.match(U$);h?(d=t.slice(0,h.index),c=t.slice(h.index+h[0].length)):d=c=t;var A=d.match(AB);A?Hj(A[0],o,n,r):(A=d.match(H$))&&W$(A[0],A[1]||"",o,n,r);var f=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var g=d.slice(f,f+50).match(R$);g&&L$(o,g[1])}var v=d.match(q$);v&&v[1]&&nW(v[1],n);var b=[];if(s.cellStyles){var y=d.match(O$);y&&eW(b,y)}h&&oW(h[1],o,s,u,i,l);var j=c.match(Q$);j&&(o["!autofilter"]=sW(j[0]));var N=[],S=c.match(D$);if(S)for(f=0;f!=S.length;++f)N[f]=jr(S[f].slice(S[f].indexOf('"')+1));var B=c.match(P$);B&&X$(o,B,a);var P=c.match(M$);if(P&&(o["!margins"]=J$(Gs(P[0]))),!o["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(o["!ref"]=ar(u)),s.sheetRows>0&&o["!ref"]){var L=jr(o["!ref"]);s.sheetRows<=+L.e.r&&(L.e.r=s.sheetRows-1,L.e.r>u.e.r&&(L.e.r=u.e.r),L.e.r<L.s.r&&(L.s.r=L.e.r),L.e.c>u.e.c&&(L.e.c=u.e.c),L.e.c<L.s.c&&(L.s.c=L.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ar(L))}return b.length>0&&(o["!cols"]=b),N.length>0&&(o["!merges"]=N),o}function $$(t){if(t.length===0)return"";for(var s='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)s+='<mergeCell ref="'+ar(t[r])+'"/>';return s+"</mergeCells>"}function Hj(t,s,r,a){var n=Gs(t);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=yr($r(n.codeName)))}function W$(t,s,r,a,n){Hj(t.slice(0,t.indexOf(">")),r,a,n)}function G$(t,s,r,a,n){var i=!1,l={},o=null;if(a.bookType!=="xlsx"&&s.vbaraw){var u=s.SheetNames[r];try{s.Workbook&&(u=s.Workbook.Sheets[r].CodeName||u)}catch{}i=!0,l.codeName=ic(qr(u))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),o=(o||"")+ps("outlinePr",null,d)}!i&&!o||(n[n.length]=ps("sheetPr",o,l))}var K$=["objects","scenarios","selectLockedCells","selectUnlockedCells"],z$=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Y$(t){var s={sheet:1};return K$.forEach(function(r){t[r]!=null&&t[r]&&(s[r]="1")}),z$.forEach(function(r){t[r]!=null&&!t[r]&&(s[r]="0")}),t.password&&(s.password=Dj(t.password).toString(16).toUpperCase()),ps("sheetProtection",null,s)}function X$(t,s,r){for(var a=Array.isArray(t),n=0;n!=s.length;++n){var i=Gs($r(s[n]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+yr(i.location))):(i.Target="#"+yr(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=jr(i.ref),u=o.s.r;u<=o.e.r;++u)for(var d=o.s.c;d<=o.e.c;++d){var c=$s({c:d,r:u});a?(t[u]||(t[u]=[]),t[u][d]||(t[u][d]={t:"z",v:void 0}),t[u][d].l=i):(t[c]||(t[c]={t:"z",v:void 0}),t[c].l=i)}}}function J$(t){var s={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(s[r]=parseFloat(t[r]))}),s}function Z$(t){return AA(t),ps("pageMargins",null,t)}function eW(t,s){for(var r=!1,a=0;a!=s.length;++a){var n=Gs(s[a],!0);n.hidden&&(n.hidden=na(n.hidden));var i=parseInt(n.min,10)-1,l=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Uj(n.width)),hu(n);i<=l;)t[i++]=oa(n)}}function tW(t,s){for(var r=["<cols>"],a,n=0;n!=s.length;++n)(a=s[n])&&(r[r.length]=ps("col",null,cg(n,a)));return r[r.length]="</cols>",r.join("")}function sW(t){var s={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return s}function rW(t,s,r,a){var n=typeof t.ref=="string"?t.ref:ar(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Xi(n);l.s.r==l.e.r&&(l.e.r=Xi(s["!ref"]).e.r,n=ar(l));for(var o=0;o<i.length;++o){var u=i[o];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),ps("autoFilter",null,{ref:n})}var aW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nW(t,s){s.Views||(s.Views=[{}]),(t.match(aW)||[]).forEach(function(r,a){var n=Gs(r);s.Views[a]||(s.Views[a]={}),+n.zoomScale&&(s.Views[a].zoom=+n.zoomScale),na(n.rightToLeft)&&(s.Views[a].RTL=!0)})}function iW(t,s,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),ps("sheetViews",ps("sheetView",null,n),{})}function lW(t,s,r,a){if(t.c&&r["!comments"].push([s,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",i=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=nd[t.v];break;case"d":a&&a.cellDates?n=la(t.v,-1).toISOString():(t=oa(t),t.t="n",n=""+(t.v=cn(la(t.v)))),typeof t.z>"u"&&(t.z=Hs[14]);break;default:n=t.v;break}var o=Rn("v",qr(n)),u={r:s},d=bu(a.cellXfs,t,a);switch(d!==0&&(u.s=d),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){o=Rn("v",""+Mj(a.Strings,t.v,a.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=i&&(t.t=i,t.v=l),typeof t.f=="string"&&t.f){var c=t.F&&t.F.slice(0,s.length)==s?{t:"array",ref:t.F}:null;o=ps("f",qr(t.f),c)+(t.v!=null?o:"")}return t.l&&r["!links"].push([s,t.l]),t.D&&(u.cm=1),ps("c",o,u)}var oW=(function(){var t=/<(?:\w+:)?c[ \/>]/,s=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=gf("v"),l=gf("f");return function(u,d,c,h,A,f){for(var g=0,v="",b=[],y=[],j=0,N=0,S=0,B="",P,L,U=0,H=0,q,V,M=0,z=0,I=Array.isArray(f.CellXf),G,Y=[],J=[],T=Array.isArray(d),k=[],D={},Q=!1,C=!!c.sheetStubs,E=u.split(s),w=0,O=E.length;w!=O;++w){v=E[w].trim();var R=v.length;if(R!==0){var X=0;e:for(g=0;g<R;++g)switch(v[g]){case">":if(v[g-1]!="/"){++g;break e}if(c&&c.cellStyles){if(L=Gs(v.slice(X,g),!0),U=L.r!=null?parseInt(L.r,10):U+1,H=-1,c.sheetRows&&c.sheetRows<U)continue;D={},Q=!1,L.ht&&(Q=!0,D.hpt=parseFloat(L.ht),D.hpx=Ph(D.hpt)),L.hidden=="1"&&(Q=!0,D.hidden=!0),L.outlineLevel!=null&&(Q=!0,D.level=+L.outlineLevel),Q&&(k[U-1]=D)}break;case"<":X=g;break}if(X>=g)break;if(L=Gs(v.slice(X,g),!0),U=L.r!=null?parseInt(L.r,10):U+1,H=-1,!(c.sheetRows&&c.sheetRows<U)){h.s.r>U-1&&(h.s.r=U-1),h.e.r<U-1&&(h.e.r=U-1),c&&c.cellStyles&&(D={},Q=!1,L.ht&&(Q=!0,D.hpt=parseFloat(L.ht),D.hpx=Ph(D.hpt)),L.hidden=="1"&&(Q=!0,D.hidden=!0),L.outlineLevel!=null&&(Q=!0,D.level=+L.outlineLevel),Q&&(k[U-1]=D)),b=v.slice(g).split(t);for(var ne=0;ne!=b.length&&b[ne].trim().charAt(0)=="<";++ne);for(b=b.slice(ne),g=0;g!=b.length;++g)if(v=b[g].trim(),v.length!==0){if(y=v.match(r),j=g,N=0,S=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,y!=null&&y.length===2){for(j=0,B=y[1],N=0;N!=B.length&&!((S=B.charCodeAt(N)-64)<1||S>26);++N)j=26*j+S;--j,H=j}else++H;for(N=0;N!=v.length&&v.charCodeAt(N)!==62;++N);if(++N,L=Gs(v.slice(0,N),!0),L.r||(L.r=$s({r:U-1,c:H})),B=v.slice(N),P={t:""},(y=B.match(i))!=null&&y[1]!==""&&(P.v=yr(y[1])),c.cellFormula){if((y=B.match(l))!=null&&y[1]!==""){if(P.f=yr($r(y[1])).replace(/\r\n/g,`
`),c.xlfn||(P.f=D_(P.f)),y[0].indexOf('t="array"')>-1)P.F=(B.match(n)||[])[1],P.F.indexOf(":")>-1&&Y.push([jr(P.F),P.F]);else if(y[0].indexOf('t="shared"')>-1){V=Gs(y[0]);var te=yr($r(y[1]));c.xlfn||(te=D_(te)),J[parseInt(V.si,10)]=[V,te,L.r]}}else(y=B.match(/<f[^>]*\/>/))&&(V=Gs(y[0]),J[V.si]&&(P.f=aV(J[V.si][1],J[V.si][2],L.r)));var oe=ga(L.r);for(N=0;N<Y.length;++N)oe.r>=Y[N][0].s.r&&oe.r<=Y[N][0].e.r&&oe.c>=Y[N][0].s.c&&oe.c<=Y[N][0].e.c&&(P.F=Y[N][1])}if(L.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(C)P.t="z";else continue;else P.t=L.t||"n";switch(h.s.c>H&&(h.s.c=H),h.e.c<H&&(h.e.c=H),P.t){case"n":if(P.v==""||P.v==null){if(!C)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!C)continue;P.t="z"}else q=Zm[parseInt(P.v,10)],P.v=q.t,P.r=q.r,c.cellHTML&&(P.h=q.h);break;case"str":P.t="s",P.v=P.v!=null?$r(P.v):"",c.cellHTML&&(P.h=bj(P.v));break;case"inlineStr":y=B.match(a),P.t="s",y!=null&&(q=Lj(y[1]))?(P.v=q.t,c.cellHTML&&(P.h=q.h)):P.v="";break;case"b":P.v=na(P.v);break;case"d":c.cellDates?P.v=la(P.v,1):(P.v=cn(la(P.v,1)),P.t="n");break;case"e":(!c||c.cellText!==!1)&&(P.w=P.v),P.v=mk[P.v];break}if(M=z=0,G=null,I&&L.s!==void 0&&(G=f.CellXf[L.s],G!=null&&(G.numFmtId!=null&&(M=G.numFmtId),c.cellStyles&&G.fillId!=null&&(z=G.fillId))),uB(P,M,z,c,A,f),c.cellDates&&I&&P.t=="n"&&Wh(Hs[M])&&(P.t="d",P.v=ng(P.v)),L.cm&&c.xlmeta){var ce=(c.xlmeta.Cell||[])[+L.cm-1];ce&&ce.type=="XLDAPR"&&(P.D=!0)}if(T){var re=ga(L.r);d[re.r]||(d[re.r]=[]),d[re.r][re.c]=P}else d[L.r]=P}}}}k.length>0&&(d["!rows"]=k)}})();function cW(t,s,r,a){var n=[],i=[],l=jr(t["!ref"]),o="",u,d="",c=[],h=0,A=0,f=t["!rows"],g=Array.isArray(t),v={r:d},b,y=-1;for(A=l.s.c;A<=l.e.c;++A)c[A]=xa(A);for(h=l.s.r;h<=l.e.r;++h){for(i=[],d=qa(h),A=l.s.c;A<=l.e.c;++A){u=c[A]+d;var j=g?(t[h]||[])[A]:t[u];j!==void 0&&(o=lW(j,u,t,s))!=null&&i.push(o)}(i.length>0||f&&f[h])&&(v={r:d},f&&f[h]&&(b=f[h],b.hidden&&(v.hidden=1),y=-1,b.hpx?y=_f(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(v.ht=y,v.customHeight=1),b.level&&(v.outlineLevel=b.level)),n[n.length]=ps("row",i.join(""),v))}if(f)for(;h<f.length;++h)f&&f[h]&&(v={r:h+1},b=f[h],b.hidden&&(v.hidden=1),y=-1,b.hpx?y=_f(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(v.ht=y,v.customHeight=1),b.level&&(v.outlineLevel=b.level),n[n.length]=ps("row","",v));return n.join("")}function hB(t,s,r,a){var n=[$a,ps("worksheet",null,{xmlns:jA[0],"xmlns:r":on.r})],i=r.SheetNames[t],l=0,o="",u=r.Sheets[i];u==null&&(u={});var d=u["!ref"]||"A1",c=jr(d);if(c.e.c>16383||c.e.r>1048575){if(s.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),d=ar(c)}a||(a={}),u["!comments"]=[];var h=[];G$(u,r,t,s,n),n[n.length]=ps("dimension",null,{ref:d}),n[n.length]=iW(u,s,t,r),s.sheetFormat&&(n[n.length]=ps("sheetFormatPr",null,{defaultRowHeight:s.sheetFormat.defaultRowHeight||"16",baseColWidth:s.sheetFormat.baseColWidth||"10",outlineLevelRow:s.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(n[n.length]=tW(u,u["!cols"])),n[l=n.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(o=cW(u,s),o.length>0&&(n[n.length]=o)),n.length>l+1&&(n[n.length]="</sheetData>",n[l]=n[l].replace("/>",">")),u["!protect"]&&(n[n.length]=Y$(u["!protect"])),u["!autofilter"]!=null&&(n[n.length]=rW(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(n[n.length]=$$(u["!merges"]));var A=-1,f,g=-1;return u["!links"].length>0&&(n[n.length]="<hyperlinks>",u["!links"].forEach(function(v){v[1].Target&&(f={ref:v[0]},v[1].Target.charAt(0)!="#"&&(g=Mr(a,-1,qr(v[1].Target).replace(/#.*$/,""),dr.HLINK),f["r:id"]="rId"+g),(A=v[1].Target.indexOf("#"))>-1&&(f.location=qr(v[1].Target.slice(A+1))),v[1].Tooltip&&(f.tooltip=qr(v[1].Tooltip)),n[n.length]=ps("hyperlink",null,f))}),n[n.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(n[n.length]=Z$(u["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&(n[n.length]=Rn("ignoredErrors",ps("ignoredError",null,{numberStoredAsText:1,sqref:d}))),h.length>0&&(g=Mr(a,-1,"../drawings/drawing"+(t+1)+".xml",dr.DRAW),n[n.length]=ps("drawing",null,{"r:id":"rId"+g}),u["!drawing"]=h),u["!comments"].length>0&&(g=Mr(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",dr.VML),n[n.length]=ps("legacyDrawing",null,{"r:id":"rId"+g}),u["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function dW(t,s){var r={},a=t.l+s;r.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function uW(t,s,r){var a=Kt(145),n=(r["!rows"]||[])[t]||{};a.write_shift(4,t),a.write_shift(4,0);var i=320;n.hpx?i=_f(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var l=0;n.level&&(l|=n.level),n.hidden&&(l|=16),(n.hpx||n.hpt)&&(l|=32),a.write_shift(1,l),a.write_shift(1,0);var o=0,u=a.l;a.l+=4;for(var d={r:t,c:0},c=0;c<16;++c)if(!(s.s.c>c+1<<10||s.e.c<c<<10)){for(var h=-1,A=-1,f=c<<10;f<c+1<<10;++f){d.c=f;var g=Array.isArray(r)?(r[d.r]||[])[d.c]:r[$s(d)];g&&(h<0&&(h=f),A=f)}h<0||(++o,a.write_shift(4,h),a.write_shift(4,A))}var v=a.l;return a.l=u,a.write_shift(4,o),a.l=v,a.length>a.l?a.slice(0,a.l):a}function AW(t,s,r,a){var n=uW(a,r,s);(n.length>17||(s["!rows"]||[])[a])&&as(t,0,n)}var hW=SA,mW=zh;function fW(){}function pW(t,s){var r={},a=t[t.l];return++t.l,r.above=!(a&64),r.left=!(a&128),t.l+=18,r.name=vM(t),r}function xW(t,s,r){r==null&&(r=Kt(84+4*t.length));var a=192;s&&(s.above&&(a&=-65),s.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return m0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ck(t,r),r.slice(0,r.l)}function gW(t){var s=Kl(t);return[s]}function vW(t,s,r){return r==null&&(r=Kt(8)),NA(s,r)}function bW(t){var s=wA(t);return[s]}function yW(t,s,r){return r==null&&(r=Kt(4)),_A(s,r)}function jW(t){var s=Kl(t),r=t.read_shift(1);return[s,r,"b"]}function NW(t,s,r){return r==null&&(r=Kt(9)),NA(s,r),r.write_shift(1,t.v?1:0),r}function wW(t){var s=wA(t),r=t.read_shift(1);return[s,r,"b"]}function _W(t,s,r){return r==null&&(r=Kt(5)),_A(s,r),r.write_shift(1,t.v?1:0),r}function SW(t){var s=Kl(t),r=t.read_shift(1);return[s,r,"e"]}function CW(t,s,r){return r==null&&(r=Kt(9)),NA(s,r),r.write_shift(1,t.v),r}function kW(t){var s=wA(t),r=t.read_shift(1);return[s,r,"e"]}function BW(t,s,r){return r==null&&(r=Kt(8)),_A(s,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function EW(t){var s=Kl(t),r=t.read_shift(4);return[s,r,"s"]}function FW(t,s,r){return r==null&&(r=Kt(12)),NA(s,r),r.write_shift(4,s.v),r}function TW(t){var s=wA(t),r=t.read_shift(4);return[s,r,"s"]}function IW(t,s,r){return r==null&&(r=Kt(8)),_A(s,r),r.write_shift(4,s.v),r}function LW(t){var s=Kl(t),r=di(t);return[s,r,"n"]}function DW(t,s,r){return r==null&&(r=Kt(16)),NA(s,r),xA(t.v,r),r}function mB(t){var s=wA(t),r=di(t);return[s,r,"n"]}function UW(t,s,r){return r==null&&(r=Kt(12)),_A(s,r),xA(t.v,r),r}function PW(t){var s=Kl(t),r=Bj(t);return[s,r,"n"]}function RW(t,s,r){return r==null&&(r=Kt(12)),NA(s,r),dk(t.v,r),r}function OW(t){var s=wA(t),r=Bj(t);return[s,r,"n"]}function QW(t,s,r){return r==null&&(r=Kt(8)),_A(s,r),dk(t.v,r),r}function MW(t){var s=Kl(t),r=Sj(t);return[s,r,"is"]}function HW(t){var s=Kl(t),r=ui(t);return[s,r,"str"]}function qW(t,s,r){return r==null&&(r=Kt(12+4*t.v.length)),NA(s,r),_n(t.v,r),r.length>r.l?r.slice(0,r.l):r}function VW(t){var s=wA(t),r=ui(t);return[s,r,"str"]}function $W(t,s,r){return r==null&&(r=Kt(8+4*t.v.length)),_A(s,r),_n(t.v,r),r.length>r.l?r.slice(0,r.l):r}function WW(t,s,r){var a=t.l+s,n=Kl(t);n.r=r["!row"];var i=t.read_shift(1),l=[n,i,"b"];if(r.cellFormula){t.l+=2;var o=og(t,a-t.l,r);l[3]=ii(o,null,n,r.supbooks,r)}else t.l=a;return l}function GW(t,s,r){var a=t.l+s,n=Kl(t);n.r=r["!row"];var i=t.read_shift(1),l=[n,i,"e"];if(r.cellFormula){t.l+=2;var o=og(t,a-t.l,r);l[3]=ii(o,null,n,r.supbooks,r)}else t.l=a;return l}function KW(t,s,r){var a=t.l+s,n=Kl(t);n.r=r["!row"];var i=di(t),l=[n,i,"n"];if(r.cellFormula){t.l+=2;var o=og(t,a-t.l,r);l[3]=ii(o,null,n,r.supbooks,r)}else t.l=a;return l}function zW(t,s,r){var a=t.l+s,n=Kl(t);n.r=r["!row"];var i=ui(t),l=[n,i,"str"];if(r.cellFormula){t.l+=2;var o=og(t,a-t.l,r);l[3]=ii(o,null,n,r.supbooks,r)}else t.l=a;return l}var YW=SA,XW=zh;function JW(t,s){return s==null&&(s=Kt(4)),s.write_shift(4,t),s}function ZW(t,s){var r=t.l+s,a=SA(t),n=Cj(t),i=ui(t),l=ui(t),o=ui(t);t.l=r;var u={rfx:a,relId:n,loc:i,display:o};return l&&(u.Tooltip=l),u}function eG(t,s){var r=Kt(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));zh({s:ga(t[0]),e:ga(t[0])},r),kj("rId"+s,r);var a=t[1].Target.indexOf("#"),n=a==-1?"":t[1].Target.slice(a+1);return _n(n||"",r),_n(t[1].Tooltip||"",r),_n("",r),r.slice(0,r.l)}function tG(){}function sG(t,s,r){var a=t.l+s,n=uk(t),i=t.read_shift(1),l=[n];if(l[2]=i,r.cellFormula){var o=S$(t,a-t.l,r);l[1]=o}else t.l=a;return l}function rG(t,s,r){var a=t.l+s,n=SA(t),i=[n];if(r.cellFormula){var l=k$(t,a-t.l,r);i[1]=l,t.l=a}else t.l=a;return i}function aG(t,s,r){r==null&&(r=Kt(18));var a=cg(t,s);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return s.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),s.level&&(n|=s.level<<8),r.write_shift(2,n),r}var fB=["left","right","top","bottom","header","footer"];function nG(t){var s={};return fB.forEach(function(r){s[r]=di(t)}),s}function iG(t,s){return s==null&&(s=Kt(48)),AA(t),fB.forEach(function(r){xA(t[r],s)}),s}function lG(t){var s=t.read_shift(2);return t.l+=28,{RTL:s&32}}function oG(t,s,r){r==null&&(r=Kt(30));var a=924;return(((s||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function cG(t){var s=Kt(24);return s.write_shift(4,4),s.write_shift(4,1),zh(t,s),s}function dG(t,s){return s==null&&(s=Kt(66)),s.write_shift(2,t.password?Dj(t.password):0),s.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?s.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):s.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),s}function uG(){}function AG(){}function hG(t,s,r,a,n,i,l){if(!t)return t;var o=s||{};a||(a={"!id":{}});var u=o.dense?[]:{},d,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,A=!1,f,g,v,b,y,j,N,S,B,P=[];o.biff=12,o["!row"]=0;var L=0,U=!1,H=[],q={},V=o.supbooks||n.supbooks||[[]];if(V.sharedf=q,V.arrayf=H,V.SheetNames=n.SheetNames||n.Sheets.map(function(T){return T.name}),!o.supbooks&&(o.supbooks=V,n.Names))for(var M=0;M<n.Names.length;++M)V[0][M+1]=n.Names[M];var z=[],I=[],G=!1;Sf[16]={n:"BrtShortReal",f:mB};var Y;if(ad(t,function(k,D,Q){if(!A)switch(Q){case 148:d=k;break;case 0:f=k,o.sheetRows&&o.sheetRows<=f.r&&(A=!0),S=qa(b=f.r),o["!row"]=f.r,(k.hidden||k.hpt||k.level!=null)&&(k.hpt&&(k.hpx=Ph(k.hpt)),I[k.r]=k);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:k[2]},k[2]){case"n":g.v=k[1];break;case"s":N=Zm[k[1]],g.v=N.t,g.r=N.r;break;case"b":g.v=!!k[1];break;case"e":g.v=k[1],o.cellText!==!1&&(g.w=nd[g.v]);break;case"str":g.t="s",g.v=k[1];break;case"is":g.t="s",g.v=k[1].t;break}if((v=l.CellXf[k[0].iStyleRef])&&uB(g,v.numFmtId,null,o,i,l),y=k[0].c==-1?y+1:k[0].c,o.dense?(u[b]||(u[b]=[]),u[b][y]=g):u[xa(y)+S]=g,o.cellFormula){for(U=!1,L=0;L<H.length;++L){var C=H[L];f.r>=C[0].s.r&&f.r<=C[0].e.r&&y>=C[0].s.c&&y<=C[0].e.c&&(g.F=ar(C[0]),U=!0)}!U&&k.length>3&&(g.f=k[3])}if(c.s.r>f.r&&(c.s.r=f.r),c.s.c>y&&(c.s.c=y),c.e.r<f.r&&(c.e.r=f.r),c.e.c<y&&(c.e.c=y),o.cellDates&&v&&g.t=="n"&&Wh(Hs[v.numFmtId])){var E=rA(g.v);E&&(g.t="d",g.v=new Date(E.y,E.m-1,E.d,E.H,E.M,E.S,E.u))}Y&&(Y.type=="XLDAPR"&&(g.D=!0),Y=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;g={t:"z",v:void 0},y=k[0].c==-1?y+1:k[0].c,o.dense?(u[b]||(u[b]=[]),u[b][y]=g):u[xa(y)+S]=g,c.s.r>f.r&&(c.s.r=f.r),c.s.c>y&&(c.s.c=y),c.e.r<f.r&&(c.e.r=f.r),c.e.c<y&&(c.e.c=y),Y&&(Y.type=="XLDAPR"&&(g.D=!0),Y=void 0);break;case 176:P.push(k);break;case 49:Y=((o.xlmeta||{}).Cell||[])[k-1];break;case 494:var w=a["!id"][k.relId];for(w?(k.Target=w.Target,k.loc&&(k.Target+="#"+k.loc),k.Rel=w):k.relId==""&&(k.Target="#"+k.loc),b=k.rfx.s.r;b<=k.rfx.e.r;++b)for(y=k.rfx.s.c;y<=k.rfx.e.c;++y)o.dense?(u[b]||(u[b]=[]),u[b][y]||(u[b][y]={t:"z",v:void 0}),u[b][y].l=k):(j=$s({c:y,r:b}),u[j]||(u[j]={t:"z",v:void 0}),u[j].l=k);break;case 426:if(!o.cellFormula)break;H.push(k),B=o.dense?u[b][y]:u[xa(y)+S],B.f=ii(k[1],c,{r:f.r,c:y},V,o),B.F=ar(k[0]);break;case 427:if(!o.cellFormula)break;q[$s(k[0].s)]=k[1],B=o.dense?u[b][y]:u[xa(y)+S],B.f=ii(k[1],c,{r:f.r,c:y},V,o);break;case 60:if(!o.cellStyles)break;for(;k.e>=k.s;)z[k.e--]={width:k.w/256,hidden:!!(k.flags&1),level:k.level},G||(G=!0,Uj(k.w/256)),hu(z[k.e+1]);break;case 161:u["!autofilter"]={ref:ar(k)};break;case 476:u["!margins"]=k;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),k.name&&(n.Sheets[r].CodeName=k.name),(k.above||k.left)&&(u["!outline"]={above:k.above,left:k.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),k.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!D.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},o),delete o.supbooks,delete o["!row"],!u["!ref"]&&(c.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(u["!ref"]=ar(d||c)),o.sheetRows&&u["!ref"]){var J=jr(u["!ref"]);o.sheetRows<=+J.e.r&&(J.e.r=o.sheetRows-1,J.e.r>c.e.r&&(J.e.r=c.e.r),J.e.r<J.s.r&&(J.s.r=J.e.r),J.e.c>c.e.c&&(J.e.c=c.e.c),J.e.c<J.s.c&&(J.s.c=J.e.c),u["!fullref"]=u["!ref"],u["!ref"]=ar(J))}return P.length>0&&(u["!merges"]=P),z.length>0&&(u["!cols"]=z),I.length>0&&(u["!rows"]=I),u}function mG(t,s,r,a,n,i,l){if(s.v===void 0)return!1;var o="";switch(s.t){case"b":o=s.v?"1":"0";break;case"d":s=oa(s),s.z=s.z||Hs[14],s.v=cn(la(s.v)),s.t="n";break;case"n":case"e":o=""+s.v;break;default:o=s.v;break}var u={r,c:a};switch(u.s=bu(n.cellXfs,s,n),s.l&&i["!links"].push([$s(u),s.l]),s.c&&i["!comments"].push([$s(u),s.c]),s.t){case"s":case"str":return n.bookSST?(o=Mj(n.Strings,s.v,n.revStrings),u.t="s",u.v=o,l?as(t,18,IW(s,u)):as(t,7,FW(s,u))):(u.t="str",l?as(t,17,$W(s,u)):as(t,6,qW(s,u))),!0;case"n":return s.v==(s.v|0)&&s.v>-1e3&&s.v<1e3?l?as(t,13,QW(s,u)):as(t,2,RW(s,u)):l?as(t,16,UW(s,u)):as(t,5,DW(s,u)),!0;case"b":return u.t="b",l?as(t,15,_W(s,u)):as(t,4,NW(s,u)),!0;case"e":return u.t="e",l?as(t,14,BW(s,u)):as(t,3,CW(s,u)),!0}return l?as(t,12,yW(s,u)):as(t,1,vW(s,u)),!0}function fG(t,s,r,a){var n=jr(s["!ref"]||"A1"),i,l="",o=[];as(t,145);var u=Array.isArray(s),d=n.e.r;s["!rows"]&&(d=Math.max(n.e.r,s["!rows"].length-1));for(var c=n.s.r;c<=d;++c){l=qa(c),AW(t,s,n,c);var h=!1;if(c<=n.e.r)for(var A=n.s.c;A<=n.e.c;++A){c===n.s.r&&(o[A]=xa(A)),i=o[A]+l;var f=u?(s[c]||[])[A]:s[i];if(!f){h=!1;continue}h=mG(t,f,c,A,a,s,h)}}as(t,146)}function pG(t,s){!s||!s["!merges"]||(as(t,177,JW(s["!merges"].length)),s["!merges"].forEach(function(r){as(t,176,XW(r))}),as(t,178))}function xG(t,s){!s||!s["!cols"]||(as(t,390),s["!cols"].forEach(function(r,a){r&&as(t,60,aG(a,r))}),as(t,391))}function gG(t,s){!s||!s["!ref"]||(as(t,648),as(t,649,cG(jr(s["!ref"]))),as(t,650))}function vG(t,s,r){s["!links"].forEach(function(a){if(a[1].Target){var n=Mr(r,-1,a[1].Target.replace(/#.*$/,""),dr.HLINK);as(t,494,eG(a,n))}}),delete s["!links"]}function bG(t,s,r,a){if(s["!comments"].length>0){var n=Mr(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",dr.VML);as(t,551,kj("rId"+n)),s["!legacy"]=n}}function yG(t,s,r,a){if(s["!autofilter"]){var n=s["!autofilter"],i=typeof n.ref=="string"?n.ref:ar(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,o=Xi(i);o.s.r==o.e.r&&(o.e.r=Xi(s["!ref"]).e.r,i=ar(o));for(var u=0;u<l.length;++u){var d=l[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}u==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),as(t,161,zh(jr(i))),as(t,162)}}function jG(t,s,r){as(t,133),as(t,137,oG(s,r)),as(t,138),as(t,134)}function NG(t,s){s["!protect"]&&as(t,535,dG(s["!protect"]))}function wG(t,s,r,a){var n=Yi(),i=r.SheetNames[t],l=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var u=jr(l["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(s.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],as(n,129),(r.vbaraw||l["!outline"])&&as(n,147,xW(o,l["!outline"])),as(n,148,mW(u)),jG(n,l,r.Workbook),xG(n,l),fG(n,l,t,s),NG(n,l),yG(n,l,r,t),pG(n,l),vG(n,l,a),l["!margins"]&&as(n,476,iG(l["!margins"])),(!s||s.ignoreEC||s.ignoreEC==null)&&gG(n,l),bG(n,l,t,a),as(n,130),n.end()}function _G(t){var s=[],r=t.match(/^<c:numCache>/),a;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(s[+l[1]]=r?+l[2]:l[2])});var n=yr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[s,n,a]}function SG(t,s,r,a,n,i){var l=i||{"!type":"chart"};if(!t)return i;var o=0,u=0,d="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var A=_G(h);c.s.r=c.s.c=0,c.e.c=o,d=xa(o),A[0].forEach(function(f,g){l[d+qa(g)]={t:"n",v:f,z:A[1]},u=g}),c.e.r<u&&(c.e.r=u),++o}),o>0&&(l["!ref"]=ar(c)),l}function CG(t,s,r,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,o=t.match(AB);return o&&Hj(o[0],i,n,r),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function kG(t,s){t.l+=10;var r=ui(t);return{name:r}}function BG(t,s,r,a,n){if(!t)return t;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ad(t,function(u,d,c){switch(c){case 550:i["!rel"]=u;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),u.name&&(n.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},s),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var qj=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],FG=[],TG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Q_(t,s){for(var r=0;r!=t.length;++r)for(var a=t[r],n=0;n!=s.length;++n){var i=s[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=na(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function M_(t,s){for(var r=0;r!=s.length;++r){var a=s[r];if(t[a[0]]==null)t[a[0]]=a[1];else switch(a[2]){case"bool":typeof t[a[0]]=="string"&&(t[a[0]]=na(t[a[0]]));break;case"int":typeof t[a[0]]=="string"&&(t[a[0]]=parseInt(t[a[0]],10));break}}}function pB(t){M_(t.WBProps,qj),M_(t.CalcPr,TG),Q_(t.WBView,EG),Q_(t.Sheets,FG),Bh.date1904=na(t.WBProps.date1904)}function IG(t){return!t.Workbook||!t.Workbook.WBProps?"false":na(t.Workbook.WBProps.date1904)?"true":"false"}var LG="][*?/\\".split("");function xB(t,s){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return LG.forEach(function(a){if(t.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function DG(t,s,r){t.forEach(function(a,n){xB(a);for(var i=0;i<n;++i)if(a==t[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var l=s&&s[n]&&s[n].CodeName||a;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function UG(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var s=t.Workbook&&t.Workbook.Sheets||[];DG(t.SheetNames,s,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)I$(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var PG=/<\w+:workbook/;function RG(t,s){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},l=0;if(t.replace(mi,function(u,d){var c=Gs(u);switch(Ac(c[0])){case"<?xml":break;case"<workbook":u.match(PG)&&(n="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=c[n];break;case"</workbook>":break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qj.forEach(function(h){if(c[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=na(c[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(c[h[0]],10);break;default:r.WBProps[h[0]]=c[h[0]]}}),c.codeName&&(r.WBProps.CodeName=$r(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=yr($r(c.name)),delete c[0],r.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=$r(c.name),c.comment&&(i.Comment=c.comment),c.localSheetId&&(i.Sheet=+c.localSheetId),na(c.hidden||"0")&&(i.Hidden=!0),l=d+u.length;break;case"</definedName>":i.Ref=yr($r(t.slice(l,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete c[0],r.CalcPr=c;break;case"<calcPr/>":delete c[0],r.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&s.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return u}),jA.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return pB(r),r}function gB(t){var s=[$a];s[s.length]=ps("workbook",null,{xmlns:jA[0],"xmlns:r":on.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(qj.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(a[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(a.codeName=t.Workbook.WBProps.CodeName,delete a.CodeName)),s[s.length]=ps("workbookPr",null,a);var n=t.Workbook&&t.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(s[s.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==t.SheetNames.length&&(i=0),s[s.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',s[s.length]="</bookViews>"}for(s[s.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var l={name:qr(t.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}s[s.length]=ps("sheet",null,l)}return s[s.length]="</sheets>",r&&(s[s.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var u={name:o.Name};o.Comment&&(u.comment=o.Comment),o.Sheet!=null&&(u.localSheetId=""+o.Sheet),o.Hidden&&(u.hidden="1"),o.Ref&&(s[s.length]=ps("definedName",qr(o.Ref),u))}),s[s.length]="</definedNames>"),s.length>2&&(s[s.length]="</workbook>",s[1]=s[1].replace("/>",">")),s.join("")}function OG(t,s){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=yy(t),r.name=ui(t),r}function QG(t,s){return s||(s=Kt(127)),s.write_shift(4,t.Hidden),s.write_shift(4,t.iTabID),kj(t.strRelID,s),_n(t.name.slice(0,31),s),s.length>s.l?s.slice(0,s.l):s}function MG(t,s){var r={},a=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var n=s>8?ui(t):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function HG(t,s){s||(s=Kt(72));var r=0;return t&&t.filterPrivacy&&(r|=8),s.write_shift(4,r),s.write_shift(4,0),ck(t&&t.CodeName||"ThisWorkbook",s),s.slice(0,s.l)}function qG(t,s){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=s-8,r}function VG(t,s,r){var a=t.l+s;t.l+=4,t.l+=1;var n=t.read_shift(4),i=bM(t),l=C$(t,0,r),o=Cj(t);t.l=a;var u={Name:i,Ptg:l};return n<268435455&&(u.Sheet=n),o&&(u.Comment=o),u}function $G(t,s){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;s||(s={}),s.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],Sf[16]={n:"BrtFRTArchID$",f:qG},ad(t,function(u,d,c){switch(c){case 156:l.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(s.SID=u.Sheet),u.Ref=ii(u.Ptg,null,null,l,s),delete s.SID,delete u.Ptg,i.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([c,u]):l[0]=[c,u],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(u),l.XTI=l.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(c),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(c),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!d.T){if(!n||s.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},s),pB(r),r.Names=i,r.supbooks=l,r}function WG(t,s){as(t,143);for(var r=0;r!=s.SheetNames.length;++r){var a=s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[r]&&s.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:s.SheetNames[r]};as(t,156,QG(n))}as(t,144)}function GG(t,s){s||(s=Kt(127));for(var r=0;r!=4;++r)s.write_shift(4,0);return _n("SheetJS",s),_n(l0.version,s),_n(l0.version,s),_n("7262",s),s.length>s.l?s.slice(0,s.l):s}function KG(t,s){s||(s=Kt(29)),s.write_shift(-4,0),s.write_shift(-4,460),s.write_shift(4,28800),s.write_shift(4,17600),s.write_shift(4,500),s.write_shift(4,t),s.write_shift(4,t);var r=120;return s.write_shift(1,r),s.length>s.l?s.slice(0,s.l):s}function zG(t,s){if(!(!s.Workbook||!s.Workbook.Sheets)){for(var r=s.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(as(t,135),as(t,158,KG(n)),as(t,136))}}function YG(t,s){var r=Yi();return as(r,131),as(r,128,GG()),as(r,153,HG(t.Workbook&&t.Workbook.WBProps||null)),zG(r,t),WG(r,t),as(r,132),r.end()}function XG(t,s,r){return s.slice(-4)===".bin"?$G(t,r):RG(t,r)}function JG(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?hG(t,a,r,n,i,l,o):V$(t,a,r,n,i,l,o)}function ZG(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?BG(t,a,r,n,i):CG(t,a,r,n,i)}function eK(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?sV():rV()}function tK(t,s,r,a,n,i,l,o){return s.slice(-4)===".bin"?eV():tV()}function sK(t,s,r,a){return s.slice(-4)===".bin"?XH(t,r,a):OH(t,r,a)}function rK(t,s,r){return Jk(t,r)}function aK(t,s,r){return s.slice(-4)===".bin"?aH(t,r):tH(t,r)}function nK(t,s,r){return s.slice(-4)===".bin"?zq(t,r):Qq(t,r)}function iK(t,s,r){return s.slice(-4)===".bin"?Pq(t):Dq(t)}function lK(t,s,r,a){return r.slice(-4)===".bin"?Rq(t,s,r,a):void 0}function oK(t,s,r){return s.slice(-4)===".bin"?Tq(t,s,r):Lq(t,s,r)}function cK(t,s,r){return(s.slice(-4)===".bin"?YG:gB)(t)}function dK(t,s,r,a,n){return(s.slice(-4)===".bin"?wG:hB)(t,r,a,n)}function uK(t,s,r){return(s.slice(-4)===".bin"?lq:Yk)(t,r)}function AK(t,s,r){return(s.slice(-4)===".bin"?lH:Hk)(t,r)}function hK(t,s,r){return(s.slice(-4)===".bin"?Yq:tB)(t)}function mK(t){return(t.slice(-4)===".bin"?Iq:Zk)()}var vB=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,bB=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function No(t,s){var r=t.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=t.match(vB),i,l,o,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(bB),(l=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(l+1),a[o]=i[2].slice(1,i[2].length-1));return a}function fK(t){var s=t.split(/\s+/),r={};if(s.length===1)return r;var a=t.match(vB),n,i,l,o;if(a)for(o=0;o!=a.length;++o)n=a[o].match(bB),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?l="xmlns"+n[1].slice(6):l=n[1].slice(i+1),r[l]=n[2].slice(1,n[2].length-1));return r}var tf;function pK(t,s){var r=tf[t]||yr(t);return r==="General"?fA(s):Wl(r,s)}function xK(t,s,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=na(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=la(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[yr(s)]=n}function gK(t,s,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||nd[t.v]:s==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=xf(t.v):t.w=fA(t.v):t.w=pK(s||"General",t.v)}catch(i){if(r.WTF)throw i}try{var a=tf[s]||s||"General";if(r.cellNF&&(t.z=a),r.cellDates&&t.t=="n"&&Wh(a)){var n=rA(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function vK(t,s,r){if(r.cellStyles&&s.Interior){var a=s.Interior;a.Pattern&&(a.patternType=FH[a.Pattern]||a.Pattern)}t[s.ID]=s}function bK(t,s,r,a,n,i,l,o,u,d){var c="General",h=a.StyleID,A={};d=d||{};var f=[],g=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&l&&(h=l.StyleID);i[h]!==void 0&&(i[h].nf&&(c=i[h].nf),i[h].Interior&&f.push(i[h].Interior),!!i[h].Parent);)h=i[h].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=na(t);break;case"String":a.t="s",a.r=a_(yr(t)),a.v=t.indexOf("<")>-1?yr(s||t).replace(/<.*?>/g,""):a.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),a.v=(la(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=yr(t):a.v<60&&(a.v=a.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+t),a.t||(a.t="n");break;case"Error":a.t="e",a.v=mk[t],d.cellText!==!1&&(a.w=t);break;default:t==""&&s==""?a.t="z":(a.t="s",a.v=a_(s||t));break}if(gK(a,c,d),d.cellFormula!==!1)if(a.Formula){var v=yr(a.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),a.f=kh(v,n),delete a.Formula,a.ArrayRange=="RC"?a.F=kh("RC:RC",n):a.ArrayRange&&(a.F=kh(a.ArrayRange,n),u.push([jr(a.F),a.F]))}else for(g=0;g<u.length;++g)n.r>=u[g][0].s.r&&n.r<=u[g][0].e.r&&n.c>=u[g][0].s.c&&n.c<=u[g][0].e.c&&(a.F=u[g][1]);d.cellStyles&&(f.forEach(function(b){!A.patternType&&b.patternType&&(A.patternType=b.patternType)}),a.s=A),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function yK(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function nb(t,s){var r=s||{};Gh();var a=Um(yj(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=$r(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var l=oa(r);return l.type="string",Uh.to_workbook(a,l)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){n.indexOf("<"+Ue)>=0&&(i=!0)}),i)return iz(a,r);tf={"General Number":"General","General Date":Hs[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Hs[15],"Short Date":Hs[14],"Long Time":Hs[19],"Medium Time":Hs[18],"Short Time":Hs[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Hs[2],Standard:Hs[4],Percent:Hs[10],Scientific:Hs[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,u=[],d,c={},h=[],A=r.dense?[]:{},f="",g={},v={},b=No('<Data ss:Type="String">'),y=0,j=0,N=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},P={},L="",U=0,H=[],q={},V={},M=0,z=[],I=[],G={},Y=[],J,T=!1,k=[],D=[],Q={},C=0,E=0,w={Sheets:[],WBProps:{date1904:!1}},O={};bf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var R="";o=bf.exec(a);)switch(o[3]=(R=o[3]).toLowerCase()){case"data":if(R=="data"){if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break}if(u[u.length-1][1])break;o[1]==="/"?bK(a.slice(y,o.index),L,b,u[u.length-1][0]=="comment"?G:g,{c:j,r:N},B,Y[j],v,k,r):(L="",b=No(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(I.length>0&&(g.c=I),(!r.sheetRows||r.sheetRows>N)&&g.v!==void 0&&(r.dense?(A[N]||(A[N]=[]),A[N][j]=g):A[xa(j)+qa(N)]=g),g.HRef&&(g.l={Target:yr(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(C=j+(parseInt(g.MergeAcross,10)|0),E=N+(parseInt(g.MergeDown,10)|0),H.push({s:{c:j,r:N},e:{c:C,r:E}})),!r.sheetStubs)g.MergeAcross?j=C+1:++j;else if(g.MergeAcross||g.MergeDown){for(var X=j;X<=C;++X)for(var ne=N;ne<=E;++ne)(X>j||ne>N)&&(r.dense?(A[ne]||(A[ne]=[]),A[ne][X]={t:"z"}):A[xa(X)+qa(ne)]={t:"z"});j=C+1}else++j;else g=fK(o[0]),g.Index&&(j=+g.Index-1),j<S.s.c&&(S.s.c=j),j>S.e.c&&(S.e.c=j),o[0].slice(-2)==="/>"&&++j,I=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(N<S.s.r&&(S.s.r=N),N>S.e.r&&(S.e.r=N),o[0].slice(-2)==="/>"&&(v=No(o[0]),v.Index&&(N=+v.Index-1)),j=0,++N):(v=No(o[0]),v.Index&&(N=+v.Index-1),Q={},(v.AutoFitHeight=="0"||v.Height)&&(Q.hpx=parseInt(v.Height,10),Q.hpt=_f(Q.hpx),D[N]=Q),v.Hidden=="1"&&(Q.hidden=!0,D[N]=Q));break;case"worksheet":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));h.push(f),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(A["!ref"]=ar(S),r.sheetRows&&r.sheetRows<=S.e.r&&(A["!fullref"]=A["!ref"],S.e.r=r.sheetRows-1,A["!ref"]=ar(S))),H.length&&(A["!merges"]=H),Y.length>0&&(A["!cols"]=Y),D.length>0&&(A["!rows"]=D),c[f]=A}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=j=0,u.push([o[3],!1]),d=No(o[0]),f=yr(d.Name),A=r.dense?[]:{},H=[],k=[],D=[],O={name:f,Hidden:0},w.Sheets.push(O);break;case"table":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;u.push([o[3],!1]),Y=[],T=!1}break;case"style":o[1]==="/"?vK(B,P,r):P=No(o[0]);break;case"numberformat":P.nf=yr(No(o[0]).Format||"General"),tf[P.nf]&&(P.nf=tf[P.nf]);for(var te=0;te!=392&&Hs[te]!=P.nf;++te);if(te==392){for(te=57;te!=392;++te)if(Hs[te]==null){Kc(P.nf,te);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(J=No(o[0]),J.Hidden&&(J.hidden=!0,delete J.Hidden),J.Width&&(J.wpx=parseInt(J.Width,10)),!T&&J.wpx>10){T=!0,li=Kk;for(var oe=0;oe<Y.length;++oe)Y[oe]&&hu(Y[oe])}T&&hu(J),Y[J.Index-1||Y.length]=J;for(var ce=0;ce<+J.Span;++ce)Y[Y.length]=oa(J);break;case"namedrange":if(o[1]==="/")break;w.Names||(w.Names=[]);var re=Gs(o[0]),de={Name:re.Name,Ref:kh(re.RefersTo.slice(1),{r:0,c:0})};w.Sheets.length>0&&(de.Sheet=w.Sheets.length-1),w.Names.push(de);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?L+=a.slice(U,o.index):U=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=No(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?$M(q,R,a.slice(M,o.index)):M=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else u.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));yK(G),I.push(G)}else u.push([o[3],!1]),d=No(o[0]),G={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ie=No(o[0]);A["!autofilter"]={ref:kh(Ie.Range).replace(/\$/g,"")},u.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=u.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&u.push([o[3],!0]);break;case"null":break;default:if(u.length==0&&o[3]=="document"||u.length==0&&o[3]=="uof")return W_(a,r);var le=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:le=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:le=!1}break;case"excelworkbook":switch(o[3]){case"date1904":w.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:le=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:le=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(M,o.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else M=o.index+o[0].length;break;case"header":A["!margins"]||AA(A["!margins"]={},"xlml"),isNaN(+Gs(o[0]).Margin)||(A["!margins"].header=+Gs(o[0]).Margin);break;case"footer":A["!margins"]||AA(A["!margins"]={},"xlml"),isNaN(+Gs(o[0]).Margin)||(A["!margins"].footer=+Gs(o[0]).Margin);break;case"pagemargins":var Z=Gs(o[0]);A["!margins"]||AA(A["!margins"]={},"xlml"),isNaN(+Z.Top)||(A["!margins"].top=+Z.Top),isNaN(+Z.Left)||(A["!margins"].left=+Z.Left),isNaN(+Z.Right)||(A["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(A["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":w.Views||(w.Views=[]),w.Views[0]||(w.Views[0]={}),w.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":A["!outline"]||(A["!outline"]={}),A["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:le=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:le=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:le=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:le=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:le=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:le=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:le=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:le=!1}break;case"smarttags":break;default:le=!1;break}if(le||o[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?xK(V,R,z,a.slice(M,o.index)):(z=o,M=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+u.join("|")}var ve={};return!r.bookSheets&&!r.bookProps&&(ve.Sheets=c),ve.SheetNames=h,ve.Workbook=w,ve.SSF=oa(Hs),ve.Props=q,ve.Custprops=V,ve}function ky(t,s){switch($j(s=s||{}),s.type||"base64"){case"base64":return nb(gl(t),s);case"binary":case"buffer":case"file":return nb(t,s);case"array":return nb(gu(t),s)}}function jK(t,s){var r=[];return t.Props&&r.push(WM(t.Props,s)),t.Custprops&&r.push(GM(t.Props,t.Custprops)),r.join("")}function NK(){return""}function wK(t,s){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return s.cellXfs.forEach(function(a,n){var i=[];i.push(ps("NumberFormat",null,{"ss:Format":qr(Hs[a.numFmtId])}));var l={"ss:ID":"s"+(21+n)};r.push(ps("Style",i.join(""),l))}),ps("Styles",r.join(""))}function yB(t){return ps("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Oj(t.Ref,{r:0,c:0})})}function _K(t){if(!((t||{}).Workbook||{}).Names)return"";for(var s=t.Workbook.Names,r=[],a=0;a<s.length;++a){var n=s[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(yB(n)))}return ps("Names",r.join(""))}function SK(t,s,r,a){if(!t||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],l=0;l<n.length;++l){var o=n[l];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(yB(o)))}return i.join("")}function CK(t,s,r,a){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(ps("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(ps("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(ps("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(ps("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(Rn("ProtectContents","True")),t["!protect"].objects&&n.push(Rn("ProtectObjects","True")),t["!protect"].scenarios&&n.push(Rn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(Rn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(Rn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&n.push("<"+l[1]+"/>")})),n.length==0?"":ps("WorksheetOptions",n.join(""),{xmlns:dl.x})}function kK(t){return t.map(function(s){var r=zQ(s.t||""),a=ps("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ps("Comment",a,{"ss:Author":s.a})}).join("")}function BK(t,s,r,a,n,i,l){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+qr(Oj(t.f,l))),t.F&&t.F.slice(0,s.length)==s){var u=ga(t.F.slice(s.length+1));o["ss:ArrayRange"]="RC:R"+(u.r==l.r?"":"["+(u.r-l.r)+"]")+"C"+(u.c==l.c?"":"["+(u.c-l.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=qr(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=qr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],c=0;c!=d.length;++c)d[c].s.c!=l.c||d[c].s.r!=l.r||(d[c].e.c>d[c].s.c&&(o["ss:MergeAcross"]=d[c].e.c-d[c].s.c),d[c].e.r>d[c].s.r&&(o["ss:MergeDown"]=d[c].e.r-d[c].s.r));var h="",A="";switch(t.t){case"z":if(!a.sheetStubs)return"";break;case"n":h="Number",A=String(t.v);break;case"b":h="Boolean",A=t.v?"1":"0";break;case"e":h="Error",A=nd[t.v];break;case"d":h="DateTime",A=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Hs[14]);break;case"s":h="String",A=KQ(t.v||"");break}var f=bu(a.cellXfs,t,a);o["ss:StyleID"]="s"+(21+f),o["ss:Index"]=l.c+1;var g=t.v!=null?A:"",v=t.t=="z"?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(t.c||[]).length>0&&(v+=kK(t.c)),ps("Cell",v,o)}function EK(t,s){var r='<Row ss:Index="'+(t+1)+'"';return s&&(s.hpt&&!s.hpx&&(s.hpx=Ph(s.hpt)),s.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+s.hpx+'"'),s.hidden&&(r+=' ss:Hidden="1"')),r+">"}function FK(t,s,r,a){if(!t["!ref"])return"";var n=jr(t["!ref"]),i=t["!merges"]||[],l=0,o=[];t["!cols"]&&t["!cols"].forEach(function(b,y){hu(b);var j=!!b.width,N=cg(y,b),S={"ss:Index":y+1};j&&(S["ss:Width"]=Nf(N.width)),b.hidden&&(S["ss:Hidden"]="1"),o.push(ps("Column",null,S))});for(var u=Array.isArray(t),d=n.s.r;d<=n.e.r;++d){for(var c=[EK(d,(t["!rows"]||[])[d])],h=n.s.c;h<=n.e.c;++h){var A=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>h)&&!(i[l].s.r>d)&&!(i[l].e.c<h)&&!(i[l].e.r<d)){(i[l].s.c!=h||i[l].s.r!=d)&&(A=!0);break}if(!A){var f={r:d,c:h},g=$s(f),v=u?(t[d]||[])[h]:t[g];c.push(BK(v,g,t,s,r,a,f))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function TK(t,s,r){var a=[],n=r.SheetNames[t],i=r.Sheets[n],l=i?SK(i,s,t,r):"";return l.length>0&&a.push("<Names>"+l+"</Names>"),l=i?FK(i,s,t,r):"",l.length>0&&a.push("<Table>"+l+"</Table>"),a.push(CK(i,s,t,r)),a.join("")}function IK(t,s){s||(s={}),t.SSF||(t.SSF=oa(Hs)),t.SSF&&(Gh(),sg(t.SSF),s.revssf=ag(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF,s.cellXfs=[],bu(s.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(jK(t,s)),r.push(NK()),r.push(""),r.push("");for(var a=0;a<t.SheetNames.length;++a)r.push(ps("Worksheet",TK(a,s,t),{"ss:Name":qr(t.SheetNames[a])}));return r[2]=wK(t,s),r[3]=_K(t),$a+ps("Workbook",r.join(""),{xmlns:dl.ss,"xmlns:o":dl.o,"xmlns:x":dl.x,"xmlns:ss":dl.ss,"xmlns:dt":dl.dt,"xmlns:html":dl.html})}function LK(t){var s={},r=t.content;if(r.l=28,s.AnsiUserType=r.read_shift(0,"lpstr-ansi"),s.AnsiClipboardFormat=_M(r),r.length-r.l<=4)return s;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,s.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(s.UnicodeClipboardFormat=SM(r),a=r.read_shift(4),a==0||a>40))return s;r.l-=4,s.Reserved2=r.read_shift(0,"lpwstr")}var DK=[60,1084,2066,2165,2175];function UK(t,s,r,a,n){var i=a,l=[],o=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(o)}l.push(o),r.l+=i;for(var u=qc(r,r.l),d=By[u],c=0;d!=null&&DK.indexOf(u)>-1;)i=qc(r,r.l+2),c=r.l+4,u==2066?c+=4:(u==2165||u==2175)&&(c+=12),o=r.slice(c,r.l+4+i),l.push(o),r.l+=4+i,d=By[u=qc(r,r.l)];var h=wn(l);Pn(h,0);var A=0;h.lens=[];for(var f=0;f<l.length;++f)h.lens.push(A),A+=l[f].length;if(h.length<a)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+h.length+" < "+a;return s.f(h,h.length,n)}function tc(t,s,r){if(t.t!=="z"&&t.XF){var a=0;try{a=t.z||t.XF.numFmtId||0,s.cellNF&&(t.z=Hs[a])}catch(i){if(s.WTF)throw i}if(!s||s.cellText!==!1)try{t.t==="e"?t.w=t.w||nd[t.v]:a===0||a=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=xf(t.v):t.w=fA(t.v):t.w=Wl(a,t.v,{date1904:!!r,dateNF:s&&s.dateNF})}catch(i){if(s.WTF)throw i}if(s.cellDates&&a&&t.t=="n"&&Wh(Hs[a]||String(a))){var n=rA(t.v);n&&(t.t="d",t.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function gx(t,s,r){return{v:t,ixfe:s,t:r}}function PK(t,s){var r={opts:{}},a={},n=s.dense?[]:{},i={},l={},o=null,u=[],d="",c={},h,A="",f,g,v,b,y={},j=[],N,S,B=[],P=[],L={Sheets:[],WBProps:{date1904:!1},Views:[{}]},U={},H=function(ue){return ue<8?cA[ue]:ue<64&&P[ue-8]||cA[ue]},q=function(ue,ge,Ve){var tt=ge.XF.data;if(!(!tt||!tt.patternType||!Ve||!Ve.cellStyles)){ge.s={},ge.s.patternType=tt.patternType;var Ze;(Ze=jf(H(tt.icvFore)))&&(ge.s.fgColor={rgb:Ze}),(Ze=jf(H(tt.icvBack)))&&(ge.s.bgColor={rgb:Ze})}},V=function(ue,ge,Ve){if(!(Q>1)&&!(Ve.sheetRows&&ue.r>=Ve.sheetRows)){if(Ve.cellStyles&&ge.XF&&ge.XF.data&&q(ue,ge,Ve),delete ge.ixfe,delete ge.XF,h=ue,A=$s(ue),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ue.r<l.s.r&&(l.s.r=ue.r),ue.c<l.s.c&&(l.s.c=ue.c),ue.r+1>l.e.r&&(l.e.r=ue.r+1),ue.c+1>l.e.c&&(l.e.c=ue.c+1),Ve.cellFormula&&ge.f){for(var tt=0;tt<j.length;++tt)if(!(j[tt][0].s.c>ue.c||j[tt][0].s.r>ue.r)&&!(j[tt][0].e.c<ue.c||j[tt][0].e.r<ue.r)){ge.F=ar(j[tt][0]),(j[tt][0].s.c!=ue.c||j[tt][0].s.r!=ue.r)&&delete ge.f,ge.f&&(ge.f=""+ii(j[tt][1],l,ue,k,M));break}}Ve.dense?(n[ue.r]||(n[ue.r]=[]),n[ue.r][ue.c]=ge):n[A]=ge}},M={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!s&&!!s.cellStyles,WTF:!!s&&!!s.wtf};s.password&&(M.password=s.password);var z,I=[],G=[],Y=[],J=[],T=!1,k=[];k.SheetNames=M.snames,k.sharedf=M.sharedf,k.arrayf=M.arrayf,k.names=[],k.XTI=[];var D=0,Q=0,C=0,E=[],w=[],O;M.codepage=1200,Co(1200);for(var R=!1;t.l<t.length-1;){var X=t.l,ne=t.read_shift(2);if(ne===0&&D===10)break;var te=t.l===t.length?0:t.read_shift(2),oe=By[ne];if(oe&&oe.f){if(s.bookSheets&&D===133&&ne!==133)break;if(D=ne,oe.r===2||oe.r==12){var ce=t.read_shift(2);if(te-=2,!M.enc&&ce!==ne&&((ce&255)<<8|ce>>8)!==ne)throw new Error("rt mismatch: "+ce+"!="+ne);oe.r==12&&(t.l+=10,te-=10)}var re={};if(ne===10?re=oe.f(t,te,M):re=UK(ne,oe,t,te,M),Q==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(ne){case 34:r.opts.Date1904=L.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(M.enc||(t.l=0),M.enc=re,!s.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:M.lastuser=re;break;case 66:var de=Number(re);switch(de){case 21010:de=1200;break;case 32768:de=1e4;break;case 32769:de=1252;break}Co(M.codepage=de),R=!0;break;case 317:M.rrtabid=re;break;case 25:M.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:M.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(n["!type"]="dialog"),re.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),re.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:B.push(re);break;case 430:k.push([re]),k[k.length-1].XTI=[];break;case 35:case 547:k[k.length-1].push(re);break;case 24:case 536:O={Name:re.Name,Ref:ii(re.rgce,l,null,k,M)},re.itab>0&&(O.Sheet=re.itab-1),k.names.push(O),k[0]||(k[0]=[],k[0].XTI=[]),k[k.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(w[re.itab-1]={ref:ar(re.rgce[0][0][1][2])});break;case 22:M.ExternCount=re;break;case 23:k.length==0&&(k[0]=[],k[0].XTI=[]),k[k.length-1].XTI=k[k.length-1].XTI.concat(re),k.XTI=k.XTI.concat(re);break;case 2196:if(M.biff<8)break;O!=null&&(O.Comment=re[1]);break;case 18:n["!protect"]=re;break;case 19:re!==0&&M.WTF&&console.error("Password verifier: "+re);break;case 133:i[re.pos]=re,M.snames.push(re.name);break;case 10:{if(--Q)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,n["!ref"]=ar(l),s.sheetRows&&s.sheetRows<=l.e.r){var Ie=l.e.r;l.e.r=s.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=ar(l),l.e.r=Ie}l.e.r++,l.e.c++}I.length>0&&(n["!merges"]=I),G.length>0&&(n["!objects"]=G),Y.length>0&&(n["!cols"]=Y),J.length>0&&(n["!rows"]=J),L.Sheets.push(U)}d===""?c=n:a[d]=n,n=s.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(M.biff===8&&(M.biff={9:2,521:3,1033:4}[ne]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),M.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(M.biff=5,R=!0,Co(M.codepage=28591)),M.biff==8&&re.BIFFVer==0&&re.dt==16&&(M.biff=2),Q++)break;if(n=s.dense?[]:{},M.biff<8&&!R&&(R=!0,Co(M.codepage=s.codepage||1252)),M.biff<5||re.BIFFVer==0&&re.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var le={pos:t.l-te,name:d};i[le.pos]=le,M.snames.push(d)}else d=(i[X]||{name:""}).name;re.dt==32&&(n["!type"]="chart"),re.dt==64&&(n["!type"]="macro"),I=[],G=[],M.arrayf=j=[],Y=[],J=[],T=!1,U={Hidden:(i[X]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(s.dense?(n[re.r]||[])[re.c]:n[$s({c:re.c,r:re.r})])&&++re.c,N={ixfe:re.ixfe,XF:B[re.ixfe]||{},v:re.val,t:"n"},C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:re.c,r:re.r},N,s);break;case 5:case 517:N={ixfe:re.ixfe,XF:B[re.ixfe],v:re.val,t:re.t},C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:re.c,r:re.r},N,s);break;case 638:N={ixfe:re.ixfe,XF:B[re.ixfe],v:re.rknum,t:"n"},C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:re.c,r:re.r},N,s);break;case 189:for(var Z=re.c;Z<=re.C;++Z){var ve=re.rkrec[Z-re.c][0];N={ixfe:ve,XF:B[ve],v:re.rkrec[Z-re.c][1],t:"n"},C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:Z,r:re.r},N,s)}break;case 6:case 518:case 1030:{if(re.val=="String"){o=re;break}if(N=gx(re.val,re.cell.ixfe,re.tt),N.XF=B[N.ixfe],s.cellFormula){var Ue=re.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var Be=Ue[0][0][1][0],_e=Ue[0][0][1][1],Me=$s({r:Be,c:_e});y[Me]?N.f=""+ii(re.formula,l,re.cell,k,M):N.F=((s.dense?(n[Be]||[])[_e]:n[Me])||{}).F}else N.f=""+ii(re.formula,l,re.cell,k,M)}C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V(re.cell,N,s),o=re}break;case 7:case 519:if(o)o.val=re,N=gx(re,o.cell.ixfe,"s"),N.XF=B[N.ixfe],s.cellFormula&&(N.f=""+ii(o.formula,l,o.cell,k,M)),C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V(o.cell,N,s),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(re);var Ye=$s(re[0].s);if(f=s.dense?(n[re[0].s.r]||[])[re[0].s.c]:n[Ye],s.cellFormula&&f){if(!o||!Ye||!f)break;f.f=""+ii(re[1],l,re[0],k,M),f.F=ar(re[0])}}break;case 1212:{if(!s.cellFormula)break;if(A){if(!o)break;y[$s(o.cell)]=re[0],f=s.dense?(n[o.cell.r]||[])[o.cell.c]:n[$s(o.cell)],(f||{}).f=""+ii(re[0],l,h,k,M)}}break;case 253:N=gx(u[re.isst].t,re.ixfe,"s"),u[re.isst].h&&(N.h=u[re.isst].h),N.XF=B[N.ixfe],C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:re.c,r:re.r},N,s);break;case 513:s.sheetStubs&&(N={ixfe:re.ixfe,XF:B[re.ixfe],t:"z"},C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:re.c,r:re.r},N,s));break;case 190:if(s.sheetStubs)for(var ot=re.c;ot<=re.C;++ot){var Ke=re.ixfe[ot-re.c];N={ixfe:Ke,XF:B[Ke],t:"z"},C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:ot,r:re.r},N,s)}break;case 214:case 516:case 4:N=gx(re.val,re.ixfe,"s"),N.XF=B[N.ixfe],C>0&&(N.z=E[N.ixfe>>8&63]),tc(N,s,r.opts.Date1904),V({c:re.c,r:re.r},N,s);break;case 0:case 512:Q===1&&(l=re);break;case 252:u=re;break;case 1054:if(M.biff==4){E[C++]=re[1];for(var ct=0;ct<C+163&&Hs[ct]!=re[1];++ct);ct>=163&&Kc(re[1],C+163)}else Kc(re[1],re[0]);break;case 30:{E[C++]=re;for(var xt=0;xt<C+163&&Hs[xt]!=re;++xt);xt>=163&&Kc(re,C+163)}break;case 229:I=I.concat(re);break;case 93:G[re.cmo[0]]=M.lastobj=re;break;case 438:M.lastobj.TxO=re;break;case 127:M.lastobj.ImData=re;break;case 440:for(b=re[0].s.r;b<=re[0].e.r;++b)for(v=re[0].s.c;v<=re[0].e.c;++v)f=s.dense?(n[b]||[])[v]:n[$s({c:v,r:b})],f&&(f.l=re[1]);break;case 2048:for(b=re[0].s.r;b<=re[0].e.r;++b)for(v=re[0].s.c;v<=re[0].e.c;++v)f=s.dense?(n[b]||[])[v]:n[$s({c:v,r:b})],f&&f.l&&(f.l.Tooltip=re[1]);break;case 28:{if(M.biff<=5&&M.biff>=2)break;f=s.dense?(n[re[0].r]||[])[re[0].c]:n[$s(re[0])];var be=G[re[2]];f||(s.dense?(n[re[0].r]||(n[re[0].r]=[]),f=n[re[0].r][re[0].c]={t:"z"}):f=n[$s(re[0])]={t:"z"},l.e.r=Math.max(l.e.r,re[0].r),l.s.r=Math.min(l.s.r,re[0].r),l.e.c=Math.max(l.e.c,re[0].c),l.s.c=Math.min(l.s.c,re[0].c)),f.c||(f.c=[]),g={a:re[1],t:be.TxO.t},f.c.push(g)}break;case 2173:wq(B[re.ixfe],re.ext);break;case 125:{if(!M.cellStyles)break;for(;re.e>=re.s;)Y[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},T||(T=!0,Uj(re.w/256)),hu(Y[re.e+1])}break;case 520:{var Ce={};re.level!=null&&(J[re.r]=Ce,Ce.level=re.level),re.hidden&&(J[re.r]=Ce,Ce.hidden=!0),re.hpt&&(J[re.r]=Ce,Ce.hpt=re.hpt,Ce.hpx=Ph(re.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||AA(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ne]]=re;break;case 161:n["!margins"]||AA(n["!margins"]={}),n["!margins"].header=re.header,n["!margins"].footer=re.footer;break;case 574:re.RTL&&(L.Views[0].RTL=!0);break;case 146:P=re;break;case 2198:z=re;break;case 140:S=re;break;case 442:d?U.CodeName=re||U.name:L.WBProps.CodeName=re||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+ne.toString(16)),t.l+=te}return r.SheetNames=Ba(i).sort(function(Te,ue){return Number(Te)-Number(ue)}).map(function(Te){return i[Te].name}),s.bookSheets||(r.Sheets=a),!r.SheetNames.length&&c["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=c)):r.Preamble=c,r.Sheets&&w.forEach(function(Te,ue){r.Sheets[r.SheetNames[ue]]["!autofilter"]=Te}),r.Strings=u,r.SSF=oa(Hs),M.enc&&(r.Encryption=M.enc),z&&(r.Themes=z),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),k.names.length>0&&(L.Names=k.names),r.Workbook=L,r}var sf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function RK(t,s,r){var a=Rs.find(t,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=j_(a,jy,sf.DSI);for(var i in n)s[i]=n[i]}catch(d){if(r.WTF)throw d}var l=Rs.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var o=j_(l,Ny,sf.SI);for(var u in o)s[u]==null&&(s[u]=o[u])}catch(d){if(r.WTF)throw d}s.HeadingPairs&&s.TitlesOfParts&&(bk(s.HeadingPairs,s.TitlesOfParts,s,r),delete s.HeadingPairs,delete s.TitlesOfParts)}function OK(t,s){var r=[],a=[],n=[],i=0,l,o=J2(jy,"n"),u=J2(Ny,"n");if(t.Props)for(l=Ba(t.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(u,l[i])?a:n).push([l[i],t.Props[l[i]]]);if(t.Custprops)for(l=Ba(t.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(o,l[i])?r:Object.prototype.hasOwnProperty.call(u,l[i])?a:n).push([l[i],t.Custprops[l[i]]]);var d=[];for(i=0;i<n.length;++i)Ck.indexOf(n[i][0])>-1||vk.indexOf(n[i][0])>-1||n[i][1]!=null&&d.push(n[i]);a.length&&Rs.utils.cfb_add(s,"/SummaryInformation",N_(a,sf.SI,u,Ny)),(r.length||d.length)&&Rs.utils.cfb_add(s,"/DocumentSummaryInformation",N_(r,sf.DSI,o,jy,d.length?d:null,sf.UDI))}function jB(t,s){s||(s={}),$j(s),Aj(),s.codepage&&uj(s.codepage);var r,a;if(t.FullPaths){if(Rs.find(t,"/encryption"))throw new Error("File is password-protected");r=Rs.find(t,"!CompObj"),a=Rs.find(t,"/Workbook")||Rs.find(t,"/Book")}else{switch(s.type){case"base64":t=Al(gl(t));break;case"binary":t=Al(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Pn(t,0),a={content:t}}var n,i;if(r&&LK(r),s.bookProps&&!s.bookSheets)n={};else{var l=ir?"buffer":"array";if(a&&a.content)n=PK(a.content,s);else if((i=Rs.find(t,"PerfectOffice_MAIN"))&&i.content)n=uA.to_workbook(i.content,(s.type=l,s));else if((i=Rs.find(t,"NativeContent_MAIN"))&&i.content)n=uA.to_workbook(i.content,(s.type=l,s));else throw(i=Rs.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");s.bookVBA&&t.FullPaths&&Rs.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=Jq(t))}var o={};return t.FullPaths&&RK(t,o,s),n.Props=n.Custprops=o,s.bookFiles&&(n.cfb=t),n}function QK(t,s){var r=s||{},a=Rs.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Rs.utils.cfb_add(a,n,NB(t,r)),r.biff==8&&(t.Props||t.Custprops)&&OK(t,a),r.biff==8&&t.vbaraw&&Zq(a,Rs.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),a}var Sf={0:{f:dW},1:{f:gW},2:{f:PW},3:{f:SW},4:{f:jW},5:{f:LW},6:{f:HW},7:{f:EW},8:{f:zW},9:{f:KW},10:{f:WW},11:{f:GW},12:{f:bW},13:{f:OW},14:{f:kW},15:{f:wW},16:{f:mB},17:{f:VW},18:{f:TW},19:{f:Sj},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VG},40:{},42:{},43:{f:HH},44:{f:QH},45:{f:$H},46:{f:GH},47:{f:WH},48:{},49:{f:hM},50:{},51:{f:Cq},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Rk},62:{f:MW},63:{f:Uq},64:{f:uG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:pW},148:{f:hW,p:16},151:{f:tG},152:{},153:{f:MG},154:{},155:{},156:{f:OG},157:{},158:{},159:{T:1,f:rH},160:{T:-1},161:{T:1,f:SA},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_q},336:{T:-1},337:{f:Eq,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:yy},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Pk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:sG},427:{f:rG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:ZW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:yy},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Gq},633:{T:1},634:{T:-1},635:{T:1,f:$q},636:{T:-1},637:{f:xM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:kG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},By={6:{f:rb},10:{f:Vd},12:{f:en},13:{f:en},14:{f:Ra},15:{f:Ra},16:{f:di},17:{f:Ra},18:{f:Ra},19:{f:en},20:{f:B_},21:{f:B_},23:{f:Pk},24:{f:F_},25:{f:Ra},26:{},27:{},28:{f:A9},29:{},34:{f:Ra},35:{f:E_},38:{f:di},39:{f:di},40:{f:di},41:{f:di},42:{f:Ra},43:{f:Ra},47:{f:wH},49:{f:O7},51:{f:en},60:{},61:{f:L7},64:{f:Ra},65:{f:R7},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:N7},93:{f:f9},94:{},95:{f:Ra},96:{},97:{},99:{f:Ra},125:{f:Rk},128:{f:e9},129:{f:_7},130:{f:en},131:{f:Ra},132:{f:Ra},133:{f:S7},134:{},140:{f:N9},141:{f:en},144:{},146:{f:S9},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:I9},161:{f:B9},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Y7},190:{f:X7},193:{f:Vd},197:{},198:{},199:{},200:{},201:{},202:{f:Ra},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:Ra},222:{},224:{f:Z7},225:{f:j7},226:{f:Vd},227:{},229:{f:h9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:k7},253:{f:M7},255:{f:E7},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:kk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ra},353:{f:Vd},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n9},431:{f:Ra},432:{},433:{},434:{},437:{},438:{f:g9},439:{f:Ra},440:{f:v9},441:{},442:{f:qf},443:{},444:{f:en},445:{},446:{},448:{f:Vd},449:{f:I7,r:2},450:{f:Vd},512:{f:S_},513:{f:T9},515:{f:r9},516:{f:q7},517:{f:k_},519:{f:L9},520:{f:F7},523:{},545:{f:T_},549:{f:__},566:{},574:{f:U7},638:{f:z7},659:{},1048:{},1054:{f:$7},1084:{},1212:{f:c9},2048:{f:y9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Vd},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:C9,r:12},2173:{f:Nq,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ra,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:o9,r:12},2197:{},2198:{f:xq,r:12},2199:{},2200:{},2201:{},2202:{f:d9,r:12},2203:{f:Vd},2204:{},2205:{},2206:{},2207:{},2211:{f:T7},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:E9},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_9},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:S_},1:{},2:{f:O9},3:{f:P9},4:{f:U9},5:{f:k_},7:{f:M9},8:{},9:{f:fx},11:{},22:{f:en},30:{f:G7},31:{},32:{},33:{f:T_},36:{},37:{f:__},50:{f:H9},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:D9},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:q9},223:{},234:{},354:{},421:{},518:{f:rb},521:{f:fx},536:{f:F_},547:{f:E_},561:{},579:{},1030:{f:rb},1033:{f:fx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xs(t,s,r,a){var n=s;if(!isNaN(n)){var i=a||(r||[]).length||0,l=t.next(4);l.write_shift(2,n),l.write_shift(2,i),i>0&&Nj(r)&&t.push(r)}}function MK(t,s,r,a){var n=(r||[]).length||0;if(n<=8224)return xs(t,s,r,n);var i=s;if(!isNaN(i)){for(var l=r.parts||[],o=0,u=0,d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;var c=t.next(4);for(c.write_shift(2,i),c.write_shift(2,d),t.push(r.slice(u,u+d)),u+=d;u<n;){for(c=t.next(4),c.write_shift(2,60),d=0;d+(l[o]||8224)<=8224;)d+=l[o]||8224,o++;c.write_shift(2,d),t.push(r.slice(u,u+d)),u+=d}}}function Gf(t,s,r){return t||(t=Kt(7)),t.write_shift(2,s),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function HK(t,s,r,a){var n=Kt(9);return Gf(n,t,s),Bk(r,a||"b",n),n}function qK(t,s,r){var a=Kt(8+2*r.length);return Gf(a,t,s),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function VK(t,s,r,a){if(s.v!=null)switch(s.t){case"d":case"n":var n=s.t=="d"?cn(la(s.v)):s.v;n==(n|0)&&n>=0&&n<65536?xs(t,2,Q9(r,a,n)):xs(t,3,R9(r,a,n));return;case"b":case"e":xs(t,5,HK(r,a,s.v,s.t));return;case"s":case"str":xs(t,4,qK(r,a,(s.v||"").slice(0,255)));return}xs(t,1,Gf(null,r,a))}function $K(t,s,r,a){var n=Array.isArray(s),i=jr(s["!ref"]||"A1"),l,o="",u=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=ar(i)}for(var d=i.s.r;d<=i.e.r;++d){o=qa(d);for(var c=i.s.c;c<=i.e.c;++c){d===i.s.r&&(u[c]=xa(c)),l=u[c]+o;var h=n?(s[d]||[])[c]:s[l];h&&VK(t,h,d,c)}}}function WK(t,s){for(var r=s||{},a=Yi(),n=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return xs(a,r.biff==4?1033:r.biff==3?521:9,Ij(t,16,r)),$K(a,t.Sheets[t.SheetNames[n]],n,r),xs(a,10),a.end()}function GK(t,s,r){xs(t,49,Q7({sz:12,name:"Arial"},r))}function KK(t,s,r){s&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)s[n]!=null&&xs(t,1054,W7(n,s[n],r))})}function zK(t,s){var r=Kt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),xs(t,2151,r),r=Kt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Lk(jr(s["!ref"]||"A1"),r),r.write_shift(4,4),xs(t,2152,r)}function YK(t,s){for(var r=0;r<16;++r)xs(t,224,C_({numFmtId:0,style:!0},0,s));s.cellXfs.forEach(function(a){xs(t,224,C_(a,0,s))})}function XK(t,s){for(var r=0;r<s["!links"].length;++r){var a=s["!links"][r];xs(t,440,b9(a)),a[1].Tooltip&&xs(t,2048,j9(a))}delete s["!links"]}function JK(t,s){if(s){var r=0;s.forEach(function(a,n){++r<=256&&a&&xs(t,125,k9(cg(n,a),n))})}}function ZK(t,s,r,a,n){var i=16+bu(n.cellXfs,s,n);if(s.v==null&&!s.bf){xs(t,513,vA(r,a,i));return}if(s.bf)xs(t,6,_$(s,r,a,n,i));else switch(s.t){case"d":case"n":var l=s.t=="d"?cn(la(s.v)):s.v;xs(t,515,a9(r,a,l,i));break;case"b":case"e":xs(t,517,s9(r,a,s.v,i,n,s.t));break;case"s":case"str":if(n.bookSST){var o=Mj(n.Strings,s.v,n.revStrings);xs(t,253,H7(r,a,o,i))}else xs(t,516,V7(r,a,(s.v||"").slice(0,255),i,n));break;default:xs(t,513,vA(r,a,i))}}function ez(t,s,r){var a=Yi(),n=r.SheetNames[t],i=r.Sheets[n]||{},l=(r||{}).Workbook||{},o=(l.Sheets||[])[t]||{},u=Array.isArray(i),d=s.biff==8,c,h="",A=[],f=jr(i["!ref"]||"A1"),g=d?65536:16384;if(f.e.c>255||f.e.r>=g){if(s.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,g-1)}xs(a,2057,Ij(r,16,s)),xs(a,13,Ql(1)),xs(a,12,Ql(100)),xs(a,15,Ei(!0)),xs(a,17,Ei(!1)),xs(a,16,xA(.001)),xs(a,95,Ei(!0)),xs(a,42,Ei(!1)),xs(a,43,Ei(!1)),xs(a,130,Ql(1)),xs(a,128,t9()),xs(a,131,Ei(!1)),xs(a,132,Ei(!1)),d&&JK(a,i["!cols"]),xs(a,512,K7(f,s)),d&&(i["!links"]=[]);for(var v=f.s.r;v<=f.e.r;++v){h=qa(v);for(var b=f.s.c;b<=f.e.c;++b){v===f.s.r&&(A[b]=xa(b)),c=A[b]+h;var y=u?(i[v]||[])[b]:i[c];y&&(ZK(a,y,v,b,s),d&&y.l&&i["!links"].push([c,y.l]))}}var j=o.CodeName||o.name||n;return d&&xs(a,574,P7((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&xs(a,229,m9(i["!merges"])),d&&XK(a,i),xs(a,442,Ek(j)),d&&zK(a,i),xs(a,10),a.end()}function tz(t,s,r){var a=Yi(),n=(t||{}).Workbook||{},i=n.Sheets||[],l=n.WBProps||{},o=r.biff==8,u=r.biff==5;if(xs(a,2057,Ij(t,5,r)),r.bookType=="xla"&&xs(a,135),xs(a,225,o?Ql(1200):null),xs(a,193,s7(2)),u&&xs(a,191),u&&xs(a,192),xs(a,226),xs(a,92,w7("SheetJS",r)),xs(a,66,Ql(o?1200:1252)),o&&xs(a,353,Ql(0)),o&&xs(a,448),xs(a,317,F9(t.SheetNames.length)),o&&t.vbaraw&&xs(a,211),o&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";xs(a,442,Ek(d))}xs(a,156,Ql(17)),xs(a,25,Ei(!1)),xs(a,18,Ei(!1)),xs(a,19,Ql(0)),o&&xs(a,431,Ei(!1)),o&&xs(a,444,Ql(0)),xs(a,61,D7()),xs(a,64,Ei(!1)),xs(a,141,Ql(0)),xs(a,34,Ei(IG(t)=="true")),xs(a,14,Ei(!0)),o&&xs(a,439,Ei(!1)),xs(a,218,Ql(0)),GK(a,t,r),KK(a,t.SSF,r),YK(a,r),o&&xs(a,352,Ei(!1));var c=a.end(),h=Yi();o&&xs(h,140,w9()),o&&r.Strings&&MK(h,252,B7(r.Strings)),xs(h,10);var A=h.end(),f=Yi(),g=0,v=0;for(v=0;v<t.SheetNames.length;++v)g+=(o?12:11)+(o?2:1)*t.SheetNames[v].length;var b=c.length+g+A.length;for(v=0;v<t.SheetNames.length;++v){var y=i[v]||{};xs(f,133,C7({pos:b,hs:y.Hidden||0,dt:0,name:t.SheetNames[v]},r)),b+=s[v].length}var j=f.end();if(g!=j.length)throw new Error("BS8 "+g+" != "+j.length);var N=[];return c.length&&N.push(c),j.length&&N.push(j),A.length&&N.push(A),wn(N)}function sz(t,s){var r=s||{},a=[];t&&!t.SSF&&(t.SSF=oa(Hs)),t&&t.SSF&&(Gh(),sg(t.SSF),r.revssf=ag(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Wj(r),r.cellXfs=[],bu(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)a[a.length]=ez(n,r,t);return a.unshift(tz(t,a,r)),wn(a)}function NB(t,s){for(var r=0;r<=t.SheetNames.length;++r){var a=t.Sheets[t.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Xi(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=s||{};switch(i.biff||2){case 8:case 5:return sz(t,s);case 4:case 3:case 2:return WK(t,s)}throw new Error("invalid type "+i.bookType+" for BIFF")}function H_(t,s){var r=s||{},a=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var n=t.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=n.index,o=i&&i.index||t.length,u=QQ(t.slice(l,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,c=0,h=0,A=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(l=0;l<u.length;++l){var v=u[l].trim(),b=v.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}c=0;continue}if(!(b!="<td"&&b!="<th")){var y=v.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var j=y[o].trim();if(j.match(/<t[dh]/i)){for(var N=j,S=0;N.charAt(0)=="<"&&(S=N.indexOf(">"))>-1;)N=N.slice(S+1);for(var B=0;B<g.length;++B){var P=g[B];P.s.c==c&&P.s.r<d&&d<=P.e.r&&(c=P.e.c+1,B=-1)}var L=Gs(j.slice(0,j.indexOf(">")));A=L.colspan?+L.colspan:1,((h=+L.rowspan)>1||A>1)&&g.push({s:{r:d,c},e:{r:d+(h||1)-1,c:c+A-1}});var U=L.t||L["data-t"]||"";if(!N.length){c+=A;continue}if(N=G4(N),f.s.r>d&&(f.s.r=d),f.e.r<d&&(f.e.r=d),f.s.c>c&&(f.s.c=c),f.e.c<c&&(f.e.c=c),!N.length){c+=A;continue}var H={t:"s",v:N};r.raw||!N.trim().length||U=="s"||(N==="TRUE"?H={t:"b",v:!0}:N==="FALSE"?H={t:"b",v:!1}:isNaN(Bo(N))?isNaN(Dh(N).getDate())||(H={t:"d",v:la(N)},r.cellDates||(H={t:"n",v:cn(H.v)}),H.z=r.dateNF||Hs[14]):H={t:"n",v:Bo(N)}),r.dense?(a[d]||(a[d]=[]),a[d][c]=H):a[$s({r:d,c})]=H,c+=A}}}}return a["!ref"]=ar(f),g.length&&(a["!merges"]=g),a}function rz(t,s,r,a){for(var n=t["!merges"]||[],i=[],l=s.s.c;l<=s.e.c;++l){for(var o=0,u=0,d=0;d<n.length;++d)if(!(n[d].s.r>r||n[d].s.c>l)&&!(n[d].e.r<r||n[d].e.c<l)){if(n[d].s.r<r||n[d].s.c<l){o=-1;break}o=n[d].e.r-n[d].s.r+1,u=n[d].e.c-n[d].s.c+1;break}if(!(o<0)){var c=$s({r,c:l}),h=a.dense?(t[r]||[])[l]:t[c],A=h&&h.v!=null&&(h.h||bj(h.w||(Zc(h),h.w)||""))||"",f={};o>1&&(f.rowspan=o),u>1&&(f.colspan=u),a.editable?A='<span contenteditable="true">'+A+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(A='<a href="'+h.l.Target+'">'+A+"</a>")),f.id=(a.id||"sjs")+"-"+c,i.push(ps("td",A,f))}}var g="<tr>";return g+i.join("")+"</tr>"}var az='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',nz="</body></html>";function iz(t,s){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return vu(H_(r[0],s),s);var a=zj();return r.forEach(function(n,i){Yj(a,H_(n,s),"Sheet"+(i+1))}),a}function lz(t,s,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function wB(t,s){var r=s||{},a=r.header!=null?r.header:az,n=r.footer!=null?r.footer:nz,i=[a],l=Xi(t["!ref"]);r.dense=Array.isArray(t),i.push(lz(t,l,r));for(var o=l.s.r;o<=l.e.r;++o)i.push(rz(t,l,o,r));return i.push("</table>"+n),i.join("")}function _B(t,s,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var l=typeof a.origin=="string"?ga(a.origin):a.origin;n=l.r,i=l.c}var o=s.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:n,c:i}};if(t["!ref"]){var c=Xi(t["!ref"]);d.s.r=Math.min(d.s.r,c.s.r),d.s.c=Math.min(d.s.c,c.s.c),d.e.r=Math.max(d.e.r,c.e.r),d.e.c=Math.max(d.e.c,c.e.c),n==-1&&(d.e.r=n=c.e.r+1)}var h=[],A=0,f=t["!rows"]||(t["!rows"]=[]),g=0,v=0,b=0,y=0,j=0,N=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&v<u;++g){var S=o[g];if(q_(S)){if(a.display)continue;f[v]={hidden:!0}}var B=S.children;for(b=y=0;b<B.length;++b){var P=B[b];if(!(a.display&&q_(P))){var L=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):G4(P.innerHTML),U=P.getAttribute("data-z")||P.getAttribute("z");for(A=0;A<h.length;++A){var H=h[A];H.s.c==y+i&&H.s.r<v+n&&v+n<=H.e.r&&(y=H.e.c+1-i,A=-1)}N=+P.getAttribute("colspan")||1,((j=+P.getAttribute("rowspan")||1)>1||N>1)&&h.push({s:{r:v+n,c:y+i},e:{r:v+n+(j||1)-1,c:y+i+(N||1)-1}});var q={t:"s",v:L},V=P.getAttribute("data-t")||P.getAttribute("t")||"";L!=null&&(L.length==0?q.t=V||"z":a.raw||L.trim().length==0||V=="s"||(L==="TRUE"?q={t:"b",v:!0}:L==="FALSE"?q={t:"b",v:!1}:isNaN(Bo(L))?isNaN(Dh(L).getDate())||(q={t:"d",v:la(L)},a.cellDates||(q={t:"n",v:cn(q.v)}),q.z=a.dateNF||Hs[14]):q={t:"n",v:Bo(L)})),q.z===void 0&&U!=null&&(q.z=U);var M="",z=P.getElementsByTagName("A");if(z&&z.length)for(var I=0;I<z.length&&!(z[I].hasAttribute("href")&&(M=z[I].getAttribute("href"),M.charAt(0)!="#"));++I);M&&M.charAt(0)!="#"&&(q.l={Target:M}),a.dense?(t[v+n]||(t[v+n]=[]),t[v+n][y+i]=q):t[$s({c:y+i,r:v+n})]=q,d.e.c<y+i&&(d.e.c=y+i),y+=N}}++v}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),d.e.r=Math.max(d.e.r,v-1+n),t["!ref"]=ar(d),v>=u&&(t["!fullref"]=ar((d.e.r=o.length-g+v-1+n,d))),t}function SB(t,s){var r=s||{},a=r.dense?[]:{};return _B(a,t,s)}function oz(t,s){return vu(SB(t,s),s)}function q_(t){var s="",r=cz(t);return r&&(s=r(t).getPropertyValue("display")),s||(s=t.style&&t.style.display),s==="none"}function cz(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function dz(t){var s=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=yr(s.replace(/<[^>]*>/g,""));return[r]}var V_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function CB(t,s){var r=s||{},a=yj(t),n=[],i,l,o={name:""},u="",d=0,c,h,A={},f=[],g=r.dense?[]:{},v,b,y={value:""},j="",N=0,S=[],B=-1,P=-1,L={s:{r:1e6,c:1e7},e:{r:0,c:0}},U=0,H={},q=[],V={},M=0,z=0,I=[],G=1,Y=1,J=[],T={Names:[]},k={},D=["",""],Q=[],C={},E="",w=0,O=!1,R=!1,X=0;for(bf.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=bf.exec(a);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(L.e.c>=L.s.c&&L.e.r>=L.s.r?g["!ref"]=ar(L):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=L.e.r&&(g["!fullref"]=g["!ref"],L.e.r=r.sheetRows-1,g["!ref"]=ar(L)),q.length&&(g["!merges"]=q),I.length&&(g["!rows"]=I),c.name=c.||c.name,typeof JSON<"u"&&JSON.stringify(c),f.push(c.name),A[c.name]=g,R=!1):v[0].charAt(v[0].length-2)!=="/"&&(c=Gs(v[0],!1),B=P=-1,L.s.r=L.s.c=1e7,L.e.r=L.e.c=0,g=r.dense?[]:{},q=[],I=[],R=!0);break;case"table-row-group":v[1]==="/"?--U:++U;break;case"table-row":case"":if(v[1]==="/"){B+=G,G=1;break}if(h=Gs(v[0],!1),h.?B=h.-1:B==-1&&(B=0),G=+h["number-rows-repeated"]||1,G<10)for(X=0;X<G;++X)U>0&&(I[B+X]={level:U});P=-1;break;case"covered-table-cell":v[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(g[B]||(g[B]=[]),g[B][P]={t:"z"}):g[$s({r:B,c:P})]={t:"z"}),j="",S=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++P,y=Gs(v[0],!1),Y=parseInt(y["number-columns-repeated"]||"1",10),b={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(b.f=O_(yr(y.formula))),(y.||y["value-type"])=="string"&&(b.t="s",b.v=yr(y["string-value"]||""),r.dense?(g[B]||(g[B]=[]),g[B][P]=b):g[$s({r:B,c:P})]=b),P+=Y-1;else if(v[1]!=="/"){++P,j="",N=0,S=[],Y=1;var ne=G?B+G-1:B;if(P>L.e.c&&(L.e.c=P),P<L.s.c&&(L.s.c=P),B<L.s.r&&(L.s.r=B),ne>L.e.r&&(L.e.r=ne),y=Gs(v[0],!1),Q=[],C={},b={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=yr(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(M=parseInt(y["number-matrix-rows-spanned"],10)||0,z=parseInt(y["number-matrix-columns-spanned"],10)||0,V={s:{r:B,c:P},e:{r:B+M-1,c:P+z-1}},b.F=ar(V),J.push([V,b.F])),y.formula)b.f=O_(y.formula);else for(X=0;X<J.length;++X)B>=J[X][0].s.r&&B<=J[X][0].e.r&&P>=J[X][0].s.c&&P<=J[X][0].e.c&&(b.F=J[X][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(M=parseInt(y["number-rows-spanned"],10)||0,z=parseInt(y["number-columns-spanned"],10)||0,V={s:{r:B,c:P},e:{r:B+M-1,c:P+z-1}},q.push(V)),y["number-columns-repeated"]&&(Y=parseInt(y["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=na(y["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(y.value);break;case"percentage":b.t="n",b.v=parseFloat(y.value);break;case"currency":b.t="n",b.v=parseFloat(y.value);break;case"date":b.t="d",b.v=la(y["date-value"]),r.cellDates||(b.t="n",b.v=cn(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=PQ(y["time-value"])/86400,r.cellDates&&(b.t="d",b.v=ng(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(y.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",y["string-value"]!=null&&(j=yr(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(O=!1,b.t==="s"&&(b.v=j||"",S.length&&(b.R=S),O=N==0),k.Target&&(b.l=k),Q.length>0&&(b.c=Q,Q=[]),j&&r.cellText!==!1&&(b.w=j),O&&(b.t="z",delete b.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=B))for(var te=0;te<G;++te){if(Y=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[B+te]||(g[B+te]=[]),g[B+te][P]=te==0?b:oa(b);--Y>0;)g[B+te][P+Y]=oa(b);else for(g[$s({r:B+te,c:P})]=b;--Y>0;)g[$s({r:B+te,c:P+Y})]=oa(b);L.e.c<=P&&(L.e.c=P)}Y=parseInt(y["number-columns-repeated"]||"1",10),P+=Y-1,Y=0,b={},j="",S=[]}k={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((i=n.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&n.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((i=n.pop())[0]!==v[3])throw"Bad state: "+i;C.t=j,S.length&&(C.R=S),C.a=E,Q.push(C)}else v[0].charAt(v[0].length-2)!=="/"&&n.push([v[3],!1]);E="",w=0,j="",N=0,S=[];break;case"creator":v[1]==="/"?E=a.slice(w,v.index):w=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((i=n.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&n.push([v[3],!1]);j="",N=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(H[o.name]=u,(i=n.pop())[0]!==v[3])throw"Bad state: "+i}else v[0].charAt(v[0].length-2)!=="/"&&(u="",o=Gs(v[0],!1),n.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Gs(v[0],!1),u+=V_[v[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":l=Gs(v[0],!1),u+=V_[v[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(d,v.index);break}else d=v.index+v[0].length;break;case"named-range":l=Gs(v[0],!1),D=ab(l["cell-range-address"]);var oe={Name:l.name,Ref:D[0]+"!"+D[1]};R&&(oe.Sheet=f.length),T.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(v[1]==="/"&&(!y||!y["string-value"])){var ce=dz(a.slice(N,v.index));j=(j.length>0?j+`
`:"")+ce[0]}else Gs(v[0],!1),N=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{D=ab(Gs(v[0])["target-range-address"]),A[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(k=Gs(v[0],!1),!k.href)break;k.Target=yr(k.href),delete k.href,k.Target.charAt(0)=="#"&&k.Target.indexOf(".")>-1?(D=ab(k.Target.slice(1)),k.Target="#"+D[0]+"!"+D[1]):k.Target.match(/^\.\.[\\\/]/)&&(k.Target=k.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var re={Sheets:A,SheetNames:f,Workbook:T};return r.bookSheets&&delete re.Sheets,re}function $_(t,s){s=s||{},Ol(t,"META-INF/manifest.xml")&&PM(Za(t,"META-INF/manifest.xml"),s);var r=hl(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=CB($r(r),s);return Ol(t,"meta.xml")&&(a.Props=xk(Za(t,"meta.xml"))),a}function W_(t,s){return CB(t,s)}var uz=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),s="<office:document-styles "+vf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return $a+s}})(),G_=(function(){var t=function(i){return qr(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},s=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,l,o){var u=[];u.push('      <table:table table:name="'+qr(l.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,c=0,h=Xi(i["!ref"]||"A1"),A=i["!merges"]||[],f=0,g=Array.isArray(i);if(i["!cols"])for(c=0;c<=h.e.c;++c)u.push("        <table:table-column"+(i["!cols"][c]?' table:style-name="co'+i["!cols"][c].ods+'"':"")+`></table:table-column>
`);var v="",b=i["!rows"]||[];for(d=0;d<h.s.r;++d)v=b[d]?' table:style-name="ro'+b[d].ods+'"':"",u.push("        <table:table-row"+v+`></table:table-row>
`);for(;d<=h.e.r;++d){for(v=b[d]?' table:style-name="ro'+b[d].ods+'"':"",u.push("        <table:table-row"+v+`>
`),c=0;c<h.s.c;++c)u.push(s);for(;c<=h.e.c;++c){var y=!1,j={},N="";for(f=0;f!=A.length;++f)if(!(A[f].s.c>c)&&!(A[f].s.r>d)&&!(A[f].e.c<c)&&!(A[f].e.r<d)){(A[f].s.c!=c||A[f].s.r!=d)&&(y=!0),j["table:number-columns-spanned"]=A[f].e.c-A[f].s.c+1,j["table:number-rows-spanned"]=A[f].e.r-A[f].s.r+1;break}if(y){u.push(r);continue}var S=$s({r:d,c}),B=g?(i[d]||[])[c]:i[S];if(B&&B.f&&(j["table:formula"]=qr(F$(B.f)),B.F&&B.F.slice(0,S.length)==S)){var P=Xi(B.F);j["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,j["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!B){u.push(s);continue}switch(B.t){case"b":N=B.v?"TRUE":"FALSE",j["office:value-type"]="boolean",j["office:boolean-value"]=B.v?"true":"false";break;case"n":N=B.w||String(B.v||0),j["office:value-type"]="float",j["office:value"]=B.v||0;break;case"s":case"str":N=B.v==null?"":B.v,j["office:value-type"]="string";break;case"d":N=B.w||la(B.v).toISOString(),j["office:value-type"]="date",j["office:date-value"]=la(B.v).toISOString(),j["table:style-name"]="ce1";break;default:u.push(s);continue}var L=t(N);if(B.l&&B.l.Target){var U=B.l.Target;U=U.charAt(0)=="#"?"#"+T$(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),L=ps("text:a",L,{"xlink:href":U.replace(/&/g,"&amp;")})}u.push("          "+ps("table:table-cell",ps("text:p",L,{}),j)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},n=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var c=0;c<d["!cols"].length;++c)if(d["!cols"][c]){var h=d["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;hu(h),h.ods=o;var A=d["!cols"][c].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+A+`"/>
`),i.push(`  </style:style>
`),++o}}});var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var c=0;c<d["!rows"].length;++c)if(d["!rows"][c]){d["!rows"][c].ods=u;var h=d["!rows"][c].hpx+"px";i.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++u}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,o){var u=[$a],d=vf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=vf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(u.push("<office:document"+d+c+`>
`),u.push(pk().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+d+`>
`),n(u,l),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var h=0;h!=l.SheetNames.length;++h)u.push(a(l.Sheets[l.SheetNames[h]],l,h));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),o.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}})();function kB(t,s){if(s.bookType=="fods")return G_(t,s);var r=xj(),a="",n=[],i=[];return a="mimetype",nr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",nr(r,a,G_(t,s)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",nr(r,a,uz(t,s)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",nr(r,a,$a+pk()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",nr(r,a,QM(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",nr(r,a,RM(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bA(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ey(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):$r(gu(t))}function Az(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Al(ic(t))}function hz(t,s){e:for(var r=0;r<=t.length-s.length;++r){for(var a=0;a<s.length;++a)if(t[r+a]!=s[a])continue e;return!0}return!1}function fu(t){var s=t.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(s),a=0;return t.forEach(function(n){r.set(n,a),a+=n.length}),r}function K_(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function mz(t,s){for(var r=(t[s+15]&127)<<7|t[s+14]>>1,a=t[s+14]&1,n=s+13;n>=s;--n)a=a*256+t[n];return(t[s+15]&128?-a:a)*Math.pow(10,r-6176)}function fz(t,s,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);t[s+15]|=a>>7,t[s+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)t[s+i]=n&255;t[s+15]|=r>=0?0:128}function Cf(t,s){var r=s?s[0]:0,a=t[r]&127;e:if(t[r++]>=128&&(a|=(t[r]&127)<<7,t[r++]<128||(a|=(t[r]&127)<<14,t[r++]<128)||(a|=(t[r]&127)<<21,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(a+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return s&&(s[0]=r),a}function Or(t){var s=new Uint8Array(7);s[0]=t&127;var r=1;e:if(t>127){if(s[r-1]|=128,s[r]=t>>7&127,++r,t<=16383||(s[r-1]|=128,s[r]=t>>14&127,++r,t<=2097151)||(s[r-1]|=128,s[r]=t>>21&127,++r,t<=268435455)||(s[r-1]|=128,s[r]=t/256>>>21&127,++r,t<=34359738367)||(s[r-1]|=128,s[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;s[r-1]|=128,s[r]=t/16777216>>>21&127,++r}return s.slice(0,r)}function ka(t){var s=0,r=t[s]&127;e:if(t[s++]>=128){if(r|=(t[s]&127)<<7,t[s++]<128||(r|=(t[s]&127)<<14,t[s++]<128)||(r|=(t[s]&127)<<21,t[s++]<128))break e;r|=(t[s]&127)<<28}return r}function Cr(t){for(var s=[],r=[0];r[0]<t.length;){var a=r[0],n=Cf(t,r),i=n&7;n=Math.floor(n/8);var l=0,o;if(n==0)break;switch(i){case 0:{for(var u=r[0];t[r[0]++]>=128;);o=t.slice(u,r[0])}break;case 5:l=4,o=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,o=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Cf(t,r),o=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var d={data:o,type:i};s[n]==null?s[n]=[d]:s[n].push(d)}return s}function Ln(t){var s=[];return t.forEach(function(r,a){r.forEach(function(n){n.data&&(s.push(Or(a*8+n.type)),n.type==2&&s.push(Or(n.data.length)),s.push(n.data))})}),fu(s)}function Vj(t,s){return(t==null?void 0:t.map(function(r){return s(r.data)}))||[]}function Ul(t){for(var s,r=[],a=[0];a[0]<t.length;){var n=Cf(t,a),i=Cr(t.slice(a[0],a[0]+n));a[0]+=n;var l={id:ka(i[1][0].data),messages:[]};i[2].forEach(function(o){var u=Cr(o.data),d=ka(u[3][0].data);l.messages.push({meta:u,data:t.slice(a[0],a[0]+d)}),a[0]+=d}),(s=i[3])!=null&&s[0]&&(l.merge=ka(i[3][0].data)>>>0>0),r.push(l)}return r}function oh(t){var s=[];return t.forEach(function(r){var a=[];a[1]=[{data:Or(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Or(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(l){n.push(l.data),l.meta[3]=[{type:0,data:Or(l.data.length)}],a[2].push({data:Ln(l.meta),type:2})});var i=Ln(a);s.push(Or(i.length)),s.push(i),n.forEach(function(l){return s.push(l)})}),fu(s)}function pz(t,s){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],a=Cf(s,r),n=[];r[0]<s.length;){var i=s[r[0]]&3;if(i==0){var l=s[r[0]++]>>2;if(l<60)++l;else{var o=l-59;l=s[r[0]],o>1&&(l|=s[r[0]+1]<<8),o>2&&(l|=s[r[0]+2]<<16),o>3&&(l|=s[r[0]+3]<<24),l>>>=0,l++,r[0]+=o}n.push(s.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var u=0,d=0;if(i==1?(d=(s[r[0]]>>2&7)+4,u=(s[r[0]++]&224)<<3,u|=s[r[0]++]):(d=(s[r[0]++]>>2)+1,i==2?(u=s[r[0]]|s[r[0]+1]<<8,r[0]+=2):(u=(s[r[0]]|s[r[0]+1]<<8|s[r[0]+2]<<16|s[r[0]+3]<<24)>>>0,r[0]+=4)),n=[fu(n)],u==0)throw new Error("Invalid offset 0");if(u>n[0].length)throw new Error("Invalid offset beyond length");if(d>=u)for(n.push(n[0].slice(-u)),d-=u;d>=n[n.length-1].length;)n.push(n[n.length-1]),d-=n[n.length-1].length;n.push(n[0].slice(-u,-u+d))}}var c=fu(n);if(c.length!=a)throw new Error("Unexpected length: ".concat(c.length," != ").concat(a));return c}function Pl(t){for(var s=[],r=0;r<t.length;){var a=t[r++],n=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,s.push(pz(a,t.slice(r,r+n))),r+=n}if(r!==t.length)throw new Error("data is not a valid framed stream!");return fu(s)}function ch(t){for(var s=[],r=0;r<t.length;){var a=Math.min(t.length-r,268435455),n=new Uint8Array(4);s.push(n);var i=Or(a),l=i.length;s.push(i),a<=60?(l++,s.push(new Uint8Array([a-1<<2]))):a<=256?(l+=2,s.push(new Uint8Array([240,a-1&255]))):a<=65536?(l+=3,s.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(l+=4,s.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(l+=5,s.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),s.push(t.slice(r,r+a)),l+=a,n[0]=0,n[1]=l&255,n[2]=l>>8&255,n[3]=l>>16&255,r+=a}return fu(s)}function xz(t,s,r,a){var n=bA(t),i=n.getUint32(4,!0),l=(a>1?12:8)+K_(i&(a>1?3470:398))*4,o=-1,u=-1,d=NaN,c=new Date(2001,0,1);i&512&&(o=n.getUint32(l,!0),l+=4),l+=K_(i&(a>1?12288:4096))*4,i&16&&(u=n.getUint32(l,!0),l+=4),i&32&&(d=n.getFloat64(l,!0),l+=8),i&64&&(c.setTime(c.getTime()+n.getFloat64(l,!0)*1e3),l+=8);var h;switch(t[2]){case 0:break;case 2:h={t:"n",v:d};break;case 3:h={t:"s",v:s[u]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:d>0};break;case 7:h={t:"n",v:d/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(u>-1)h={t:"s",v:s[u]};else if(!isNaN(d))h={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return h}function gz(t,s,r){var a=bA(t),n=a.getUint32(8,!0),i=12,l=-1,o=-1,u=NaN,d=NaN,c=new Date(2001,0,1);n&1&&(u=mz(t,i),i+=16),n&2&&(d=a.getFloat64(i,!0),i+=8),n&4&&(c.setTime(c.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(o=a.getUint32(i,!0),i+=4),n&16&&(l=a.getUint32(i,!0),i+=4);var h;switch(t[1]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:s[o]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:d>0};break;case 7:h={t:"n",v:d/86400};break;case 8:h={t:"e",v:0};break;case 9:if(l>-1)h={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)));break;case 10:h={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(n&31," : ").concat(t.slice(0,4)))}return h}function ib(t,s){var r=new Uint8Array(32),a=bA(r),n=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,fz(r,n,t.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,t.v?1:0,!0),i|=2,n+=8;break;case"s":if(s.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,a.setUint32(n,s.indexOf(t.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(8,i,!0),r.slice(0,n)}function lb(t,s){var r=new Uint8Array(32),a=bA(r),n=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,a.setFloat64(n,t.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,t.v?1:0,!0),i|=32,n+=8;break;case"s":if(s.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,a.setUint32(n,s.indexOf(t.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return a.setUint32(4,i,!0),r.slice(0,n)}function vz(t,s,r){switch(t[0]){case 0:case 1:case 2:case 3:return xz(t,s,r,t[0]);case 5:return gz(t,s,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ai(t){var s=Cr(t);return Cf(s[1][0].data)}function z_(t,s){var r=Cr(s.data),a=ka(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(l){var o=Cr(l.data),u=ka(o[1][0].data)>>>0;switch(a){case 1:i[u]=Ey(o[3][0].data);break;case 8:{var d=t[ai(o[9][0].data)][0],c=Cr(d.data),h=t[ai(c[1][0].data)][0],A=ka(h.meta[1][0].data);if(A!=2001)throw new Error("2000 unexpected reference to ".concat(A));var f=Cr(h.data);i[u]=f[3].map(function(g){return Ey(g.data)}).join("")}break}}),i}function bz(t,s){var r,a,n,i,l,o,u,d,c,h,A,f,g,v,b=Cr(t),y=ka(b[1][0].data)>>>0,j=ka(b[2][0].data)>>>0,N=((a=(r=b[8])==null?void 0:r[0])==null?void 0:a.data)&&ka(b[8][0].data)>0||!1,S,B;if((i=(n=b[7])==null?void 0:n[0])!=null&&i.data&&s!=0)S=(o=(l=b[7])==null?void 0:l[0])==null?void 0:o.data,B=(d=(u=b[6])==null?void 0:u[0])==null?void 0:d.data;else if((h=(c=b[4])==null?void 0:c[0])!=null&&h.data&&s!=1)S=(f=(A=b[4])==null?void 0:A[0])==null?void 0:f.data,B=(v=(g=b[3])==null?void 0:g[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(s," cell storage");for(var P=N?4:1,L=bA(S),U=[],H=0;H<S.length/2;++H){var q=L.getUint16(H*2,!0);q<65535&&U.push([H,q])}if(U.length!=j)throw"Expected ".concat(j," cells, found ").concat(U.length);var V=[];for(H=0;H<U.length-1;++H)V[U[H][0]]=B.subarray(U[H][1]*P,U[H+1][1]*P);return U.length>=1&&(V[U[U.length-1][0]]=B.subarray(U[U.length-1][1]*P)),{R:y,cells:V}}function yz(t,s){var r,a=Cr(s.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?ka(a[7][0].data)>>>0>0?1:0:-1,i=Vj(a[5],function(l){return bz(l,n)});return{nrows:ka(a[4][0].data)>>>0,data:i.reduce(function(l,o){return l[o.R]||(l[o.R]=[]),o.cells.forEach(function(u,d){if(l[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));l[o.R][d]=u}),l},[])}}function jz(t,s,r){var a,n=Cr(s.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(ka(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(ka(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=ar(i);var l=Cr(n[4][0].data),o=z_(t,t[ai(l[4][0].data)][0]),u=(a=l[17])!=null&&a[0]?z_(t,t[ai(l[17][0].data)][0]):[],d=Cr(l[3][0].data),c=0;d[1].forEach(function(h){var A=Cr(h.data),f=t[ai(A[2][0].data)][0],g=ka(f.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var v=yz(t,f);v.data.forEach(function(b,y){b.forEach(function(j,N){var S=$s({r:c+y,c:N}),B=vz(j,o,u);B&&(r[S]=B)})}),c+=v.nrows})}function Nz(t,s){var r=Cr(s.data),a={"!ref":"A1"},n=t[ai(r[2][0].data)],i=ka(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return jz(t,n[0],a),a}function wz(t,s){var r,a=Cr(s.data),n={name:(r=a[1])!=null&&r[0]?Ey(a[1][0].data):"",sheets:[]},i=Vj(a[2],ai);return i.forEach(function(l){t[l].forEach(function(o){var u=ka(o.meta[1][0].data);u==6e3&&n.sheets.push(Nz(t,o))})}),n}function _z(t,s){var r=zj(),a=Cr(s.data),n=Vj(a[1],ai);if(n.forEach(function(i){t[i].forEach(function(l){var o=ka(l.meta[1][0].data);if(o==2){var u=wz(t,l);u.sheets.forEach(function(d,c){Yj(r,d,c==0?u.name:u.name+"_"+c,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ob(t){var s,r,a,n,i={},l=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var d;try{d=Pl(u.content)}catch(h){return console.log("?? "+u.content.length+" "+(h.message||h))}var c;try{c=Ul(d)}catch(h){return console.log("## "+(h.message||h))}c.forEach(function(h){i[h.id]=h.messages,l.push(h.id)})}}),!l.length)throw new Error("File has no messages");var o=((n=(a=(r=(s=i==null?void 0:i[1])==null?void 0:s[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&ka(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||l.forEach(function(u){i[u].forEach(function(d){var c=ka(d.meta[1][0].data)>>>0;if(c==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return _z(i,o)}function Sz(t,s,r){var a,n,i,l;if(!((a=t[6])!=null&&a[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var o=((l=(i=t[8])==null?void 0:i[0])==null?void 0:l.data)&&ka(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var u=0,d=bA(t[7][0].data),c=0,h=[],A=bA(t[4][0].data),f=0,g=[],v=0;v<s.length;++v){if(s[v]==null){d.setUint16(v*2,65535,!0),A.setUint16(v*2,65535);continue}d.setUint16(v*2,c,!0),A.setUint16(v*2,f,!0);var b,y;switch(typeof s[v]){case"string":b=ib({t:"s",v:s[v]},r),y=lb({t:"s",v:s[v]},r);break;case"number":b=ib({t:"n",v:s[v]},r),y=lb({t:"n",v:s[v]},r);break;case"boolean":b=ib({t:"b",v:s[v]},r),y=lb({t:"b",v:s[v]},r);break;default:throw new Error("Unsupported value "+s[v])}h.push(b),c+=b.length,g.push(y),f+=y.length,++u}for(t[2][0].data=Or(u);v<t[7][0].data.length/2;++v)d.setUint16(v*2,65535,!0),A.setUint16(v*2,65535,!0);return t[6][0].data=fu(h),t[3][0].data=fu(g),u}function Cz(t,s){if(!s||!s.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Xi(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(ar(a)));var i=b0(r,{range:a,header:1}),l=["~Sh33tJ5~"];i.forEach(function(E){return E.forEach(function(w){typeof w=="string"&&l.push(w)})});var o={},u=[],d=Rs.read(s.numbers,{type:"base64"});d.FileIndex.map(function(E,w){return[E,d.FullPaths[w]]}).forEach(function(E){var w=E[0],O=E[1];if(w.type==2&&w.name.match(/\.iwa/)){var R=w.content,X=Pl(R),ne=Ul(X);ne.forEach(function(te){u.push(te.id),o[te.id]={deps:[],location:O,type:ka(te.messages[0].meta[1][0].data)}})}}),u.sort(function(E,w){return E-w});var c=u.filter(function(E){return E>1}).map(function(E){return[E,Or(E)]});d.FileIndex.map(function(E,w){return[E,d.FullPaths[w]]}).forEach(function(E){var w=E[0];if(E[1],!!w.name.match(/\.iwa/)){var O=Ul(Pl(w.content));O.forEach(function(R){R.messages.forEach(function(X){c.forEach(function(ne){R.messages.some(function(te){return ka(te.meta[1][0].data)!=11006&&hz(te.data,ne[1])})&&o[ne[0]].deps.push(R.id)})})})}});for(var h=Rs.find(d,o[1].location),A=Ul(Pl(h.content)),f,g=0;g<A.length;++g){var v=A[g];v.id==1&&(f=v)}var b=ai(Cr(f.messages[0].data)[1][0].data);for(h=Rs.find(d,o[b].location),A=Ul(Pl(h.content)),g=0;g<A.length;++g)v=A[g],v.id==b&&(f=v);for(b=ai(Cr(f.messages[0].data)[2][0].data),h=Rs.find(d,o[b].location),A=Ul(Pl(h.content)),g=0;g<A.length;++g)v=A[g],v.id==b&&(f=v);for(b=ai(Cr(f.messages[0].data)[2][0].data),h=Rs.find(d,o[b].location),A=Ul(Pl(h.content)),g=0;g<A.length;++g)v=A[g],v.id==b&&(f=v);var y=Cr(f.messages[0].data);{y[6][0].data=Or(a.e.r+1),y[7][0].data=Or(a.e.c+1);var j=ai(y[46][0].data),N=Rs.find(d,o[j].location),S=Ul(Pl(N.content));{for(var B=0;B<S.length&&S[B].id!=j;++B);if(S[B].id!=j)throw"Bad ColumnRowUIDMapArchive";var P=Cr(S[B].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var L=0;L<=a.e.c;++L){var U=[];U[1]=U[2]=[{type:0,data:Or(L+420690)}],P[1].push({type:2,data:Ln(U)}),P[2].push({type:0,data:Or(L)}),P[3].push({type:0,data:Or(L)})}P[4]=[],P[5]=[],P[6]=[];for(var H=0;H<=a.e.r;++H)U=[],U[1]=U[2]=[{type:0,data:Or(H+726270)}],P[4].push({type:2,data:Ln(U)}),P[5].push({type:0,data:Or(H)}),P[6].push({type:0,data:Or(H)});S[B].messages[0].data=Ln(P)}N.content=ch(oh(S)),N.size=N.content.length,delete y[46];var q=Cr(y[4][0].data);{q[7][0].data=Or(a.e.r+1);var V=Cr(q[1][0].data),M=ai(V[2][0].data);N=Rs.find(d,o[M].location),S=Ul(Pl(N.content));{if(S[0].id!=M)throw"Bad HeaderStorageBucket";var z=Cr(S[0].messages[0].data);for(H=0;H<i.length;++H){var I=Cr(z[2][0].data);I[1][0].data=Or(H),I[4][0].data=Or(i[H].length),z[2][H]={type:z[2][0].type,data:Ln(I)}}S[0].messages[0].data=Ln(z)}N.content=ch(oh(S)),N.size=N.content.length;var G=ai(q[2][0].data);N=Rs.find(d,o[G].location),S=Ul(Pl(N.content));{if(S[0].id!=G)throw"Bad HeaderStorageBucket";for(z=Cr(S[0].messages[0].data),L=0;L<=a.e.c;++L)I=Cr(z[2][0].data),I[1][0].data=Or(L),I[4][0].data=Or(a.e.r+1),z[2][L]={type:z[2][0].type,data:Ln(I)};S[0].messages[0].data=Ln(z)}N.content=ch(oh(S)),N.size=N.content.length;var Y=ai(q[4][0].data);(function(){for(var E=Rs.find(d,o[Y].location),w=Ul(Pl(E.content)),O,R=0;R<w.length;++R){var X=w[R];X.id==Y&&(O=X)}var ne=Cr(O.messages[0].data);{ne[3]=[];var te=[];l.forEach(function(re,de){te[1]=[{type:0,data:Or(de)}],te[2]=[{type:0,data:Or(1)}],te[3]=[{type:2,data:Az(re)}],ne[3].push({type:2,data:Ln(te)})})}O.messages[0].data=Ln(ne);var oe=oh(w),ce=ch(oe);E.content=ce,E.size=E.content.length})();var J=Cr(q[3][0].data);{var T=J[1][0];delete J[2];var k=Cr(T.data);{var D=ai(k[2][0].data);(function(){for(var E=Rs.find(d,o[D].location),w=Ul(Pl(E.content)),O,R=0;R<w.length;++R){var X=w[R];X.id==D&&(O=X)}var ne=Cr(O.messages[0].data);{delete ne[6],delete J[7];var te=new Uint8Array(ne[5][0].data);ne[5]=[];for(var oe=0,ce=0;ce<=a.e.r;++ce){var re=Cr(te);oe+=Sz(re,i[ce],l),re[1][0].data=Or(ce),ne[5].push({data:Ln(re),type:2})}ne[1]=[{type:0,data:Or(a.e.c+1)}],ne[2]=[{type:0,data:Or(a.e.r+1)}],ne[3]=[{type:0,data:Or(oe)}],ne[4]=[{type:0,data:Or(a.e.r+1)}]}O.messages[0].data=Ln(ne);var de=oh(w),Ie=ch(de);E.content=Ie,E.size=E.content.length})()}T.data=Ln(k)}q[3][0].data=Ln(J)}y[4][0].data=Ln(q)}f.messages[0].data=Ln(y);var Q=oh(A),C=ch(Q);return h.content=C,h.size=h.content.length,d}function BB(t){return function(r){for(var a=0;a!=t.length;++a){var n=t[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function $j(t){BB([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Wj(t){BB([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function kz(t){return dr.WS.indexOf(t)>-1?"sheet":t==dr.CS?"chart":t==dr.DS?"dialog":t==dr.MS?"macro":t&&t.length?t:"sheet"}function Bz(t,s){if(!t)return 0;try{t=s.map(function(a){return a.id||(a.id=a.strRelID),[a.name,t["!id"][a.id].Target,kz(t["!id"][a.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Ez(t,s,r,a,n,i,l,o,u,d,c,h){try{i[a]=Jm(hl(t,r,!0),s);var A=Za(t,s),f;switch(o){case"sheet":f=JG(A,s,n,u,i[a],d,c,h);break;case"chart":if(f=ZG(A,s,n,u,i[a],d,c,h),!f||!f["!drawel"])break;var g=Rm(f["!drawel"].Target,s),v=yf(g),b=Oq(hl(t,g,!0),Jm(hl(t,v,!0),g)),y=Rm(b,g),j=yf(y);f=SG(hl(t,y,!0),y,u,Jm(hl(t,j,!0),y),d,f);break;case"macro":f=eK(A,s,n,u,i[a],d,c,h);break;case"dialog":f=tK(A,s,n,u,i[a],d,c,h);break;default:throw new Error("Unrecognized sheet type "+o)}l[a]=f;var N=[];i&&i[a]&&Ba(i[a]).forEach(function(S){var B="";if(i[a][S].Type==dr.CMNT){B=Rm(i[a][S].Target,s);var P=nK(Za(t,B,!0),B,u);if(!P||!P.length)return;L_(f,P,!1)}i[a][S].Type==dr.TCMNT&&(B=Rm(i[a][S].Target,s),N=N.concat(Mq(Za(t,B,!0),u)))}),N&&N.length&&L_(f,N,!0,u.people||[])}catch(S){if(u.WTF)throw S}}function Ll(t){return t.charAt(0)=="/"?t.slice(1):t}function Fz(t,s){if(Gh(),s=s||{},$j(s),Ol(t,"META-INF/manifest.xml")||Ol(t,"objectdata.xml"))return $_(t,s);if(Ol(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ob<"u"){if(t.FileIndex)return ob(t);var r=Rs.utils.cfb_new();return t_(t).forEach(function(I){nr(r,I,HQ(t,I))}),ob(r)}throw new Error("Unsupported NUMBERS file")}if(!Ol(t,"[Content_Types].xml"))throw Ol(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ol(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=t_(t),n=DM(hl(t,"[Content_Types].xml")),i=!1,l,o;if(n.workbooks.length===0&&(o="xl/workbook.xml",Za(t,o,!0)&&n.workbooks.push(o)),n.workbooks.length===0){if(o="xl/workbook.bin",!Za(t,o,!0))throw new Error("Could not find workbook");n.workbooks.push(o),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var u={},d={};if(!s.bookSheets&&!s.bookProps){if(Zm=[],n.sst)try{Zm=aK(Za(t,Ll(n.sst)),n.sst,s)}catch(I){if(s.WTF)throw I}s.cellStyles&&n.themes.length&&(u=rK(hl(t,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],s)),n.style&&(d=sK(Za(t,Ll(n.style)),n.style,u,s))}n.links.map(function(I){try{var G=Jm(hl(t,yf(Ll(I))),I);return lK(Za(t,Ll(I)),G,I,s)}catch{}});var c=XG(Za(t,Ll(n.workbooks[0])),n.workbooks[0],s),h={},A="";n.coreprops.length&&(A=Za(t,Ll(n.coreprops[0]),!0),A&&(h=xk(A)),n.extprops.length!==0&&(A=Za(t,Ll(n.extprops[0]),!0),A&&HM(A,h,s)));var f={};(!s.bookSheets||s.bookProps)&&n.custprops.length!==0&&(A=hl(t,Ll(n.custprops[0]),!0),A&&(f=VM(A,s)));var g={};if((s.bookSheets||s.bookProps)&&(c.Sheets?l=c.Sheets.map(function(G){return G.name}):h.Worksheets&&h.SheetNames.length>0&&(l=h.SheetNames),s.bookProps&&(g.Props=h,g.Custprops=f),s.bookSheets&&typeof l<"u"&&(g.SheetNames=l),s.bookSheets?g.SheetNames:s.bookProps))return g;l={};var v={};s.bookDeps&&n.calcchain&&(v=iK(Za(t,Ll(n.calcchain)),n.calcchain));var b=0,y={},j,N;{var S=c.Sheets;h.Worksheets=S.length,h.SheetNames=[];for(var B=0;B!=S.length;++B)h.SheetNames[B]=S[B].name}var P=i?"bin":"xml",L=n.workbooks[0].lastIndexOf("/"),U=(n.workbooks[0].slice(0,L+1)+"_rels/"+n.workbooks[0].slice(L+1)+".rels").replace(/^\//,"");Ol(t,U)||(U="xl/_rels/workbook."+P+".rels");var H=Jm(hl(t,U,!0),U.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(s.xlmeta=oK(Za(t,Ll(n.metadata[0])),n.metadata[0],s)),(n.people||[]).length>=1&&(s.people=qq(Za(t,Ll(n.people[0])),s)),H&&(H=Bz(H,c.Sheets));var q=Za(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=h.Worksheets;++b){var V="sheet";if(H&&H[b]?(j="xl/"+H[b][1].replace(/[\/]?xl\//,""),Ol(t,j)||(j=H[b][1]),Ol(t,j)||(j=U.replace(/_rels\/.*$/,"")+H[b][1]),V=H[b][2]):(j="xl/worksheets/sheet"+(b+1-q)+"."+P,j=j.replace(/sheet0\./,"sheet.")),N=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),s&&s.sheets!=null)switch(typeof s.sheets){case"number":if(b!=s.sheets)continue e;break;case"string":if(h.SheetNames[b].toLowerCase()!=s.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(s.sheets)){for(var M=!1,z=0;z!=s.sheets.length;++z)typeof s.sheets[z]=="number"&&s.sheets[z]==b&&(M=1),typeof s.sheets[z]=="string"&&s.sheets[z].toLowerCase()==h.SheetNames[b].toLowerCase()&&(M=1);if(!M)continue e}}Ez(t,j,N,h.SheetNames[b],b,y,l,V,s,c,u,d)}return g={Directory:n,Workbook:c,Props:h,Custprops:f,Deps:v,Sheets:l,SheetNames:h.SheetNames,Strings:Zm,Styles:d,Themes:u,SSF:oa(Hs)},s&&s.bookFiles&&(t.files?(g.keys=a,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(I,G){I=I.replace(/^Root Entry[\/]/,""),g.keys.push(I),g.files[I]=t.FileIndex[G]}))),s&&s.bookVBA&&(n.vba.length>0?g.vbaraw=Za(t,Ll(n.vba[0]),!0):n.defaults&&n.defaults.bin===Xq&&(g.vbaraw=Za(t,"xl/vbaProject.bin",!0))),g}function Tz(t,s){var r=s||{},a="Workbook",n=Rs.find(t,a);try{if(a="/!DataSpaces/Version",n=Rs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(oH(n.content),a="/!DataSpaces/DataSpaceMap",n=Rs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=dH(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Rs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=uH(n.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Rs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);hH(n.content)}catch{}if(a="/EncryptionInfo",n=Rs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=mH(n.content);if(a="/EncryptedPackage",n=Rs.find(t,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],n.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function Iz(t,s){return s.bookType=="ods"?kB(t,s):s.bookType=="numbers"?Cz(t,s):s.bookType=="xlsb"?Lz(t,s):Dz(t,s)}function Lz(t,s){vh=1024,t&&!t.SSF&&(t.SSF=oa(Hs)),t&&t.SSF&&(Gh(),sg(t.SSF),s.revssf=ag(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,ef?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var r=s.bookType=="xlsb"?"bin":"xml",a=sB.indexOf(s.bookType)>-1,n=Fj();Wj(s=s||{});var i=xj(),l="",o=0;if(s.cellXfs=[],bu(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",nr(i,l,gk(t.Props,s)),n.coreprops.push(l),Mr(s.rels,2,l,dr.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&u.push(t.SheetNames[d]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,nr(i,l,yk(t.Props)),n.extprops.push(l),Mr(s.rels,3,l,dr.EXT_PROPS),t.Custprops!==t.Props&&Ba(t.Custprops||{}).length>0&&(l="docProps/custom.xml",nr(i,l,jk(t.Custprops)),n.custprops.push(l),Mr(s.rels,4,l,dr.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var c={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],A=(h||{})["!type"]||"sheet";switch(A){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,nr(i,l,dK(o-1,l,s,t,c)),n.sheets.push(l),Mr(s.wbrels,-1,"worksheets/sheet"+o+"."+r,dr.WS[0])}if(h){var f=h["!comments"],g=!1,v="";f&&f.length>0&&(v="xl/comments"+o+"."+r,nr(i,v,hK(f,v)),n.comments.push(v),Mr(c,-1,"../comments"+o+"."+r,dr.CMNT),g=!0),h["!legacy"]&&g&&nr(i,"xl/drawings/vmlDrawing"+o+".vml",eB(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&nr(i,yf(l),Ch(c))}return s.Strings!=null&&s.Strings.length>0&&(l="xl/sharedStrings."+r,nr(i,l,AK(s.Strings,l,s)),n.strs.push(l),Mr(s.wbrels,-1,"sharedStrings."+r,dr.SST)),l="xl/workbook."+r,nr(i,l,cK(t,l)),n.workbooks.push(l),Mr(s.rels,1,l,dr.WB),l="xl/theme/theme1.xml",nr(i,l,Pj(t.Themes,s)),n.themes.push(l),Mr(s.wbrels,-1,"theme/theme1.xml",dr.THEME),l="xl/styles."+r,nr(i,l,uK(t,l,s)),n.styles.push(l),Mr(s.wbrels,-1,"styles."+r,dr.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",nr(i,l,t.vbaraw),n.vba.push(l),Mr(s.wbrels,-1,"vbaProject.bin",dr.VBA)),l="xl/metadata."+r,nr(i,l,mK(l)),n.metadata.push(l),Mr(s.wbrels,-1,"metadata."+r,dr.XLMETA),nr(i,"[Content_Types].xml",fk(n,s)),nr(i,"_rels/.rels",Ch(s.rels)),nr(i,"xl/_rels/workbook."+r+".rels",Ch(s.wbrels)),delete s.revssf,delete s.ssf,i}function Dz(t,s){vh=1024,t&&!t.SSF&&(t.SSF=oa(Hs)),t&&t.SSF&&(Gh(),sg(t.SSF),s.revssf=ag(t.SSF),s.revssf[t.SSF[65535]]=0,s.ssf=t.SSF),s.rels={},s.wbrels={},s.Strings=[],s.Strings.Count=0,s.Strings.Unique=0,ef?s.revStrings=new Map:(s.revStrings={},s.revStrings.foo=[],delete s.revStrings.foo);var r="xml",a=sB.indexOf(s.bookType)>-1,n=Fj();Wj(s=s||{});var i=xj(),l="",o=0;if(s.cellXfs=[],bu(s.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",nr(i,l,gk(t.Props,s)),n.coreprops.push(l),Mr(s.rels,2,l,dr.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&u.push(t.SheetNames[d]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,nr(i,l,yk(t.Props)),n.extprops.push(l),Mr(s.rels,3,l,dr.EXT_PROPS),t.Custprops!==t.Props&&Ba(t.Custprops||{}).length>0&&(l="docProps/custom.xml",nr(i,l,jk(t.Custprops)),n.custprops.push(l),Mr(s.rels,4,l,dr.CUST_PROPS));var c=["SheetJ5"];for(s.tcid=0,o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},A=t.Sheets[t.SheetNames[o-1]],f=(A||{})["!type"]||"sheet";switch(f){case"chart":default:l="xl/worksheets/sheet"+o+"."+r,nr(i,l,hB(o-1,s,t,h)),n.sheets.push(l),Mr(s.wbrels,-1,"worksheets/sheet"+o+"."+r,dr.WS[0])}if(A){var g=A["!comments"],v=!1,b="";if(g&&g.length>0){var y=!1;g.forEach(function(j){j[1].forEach(function(N){N.T==!0&&(y=!0)})}),y&&(b="xl/threadedComments/threadedComment"+o+"."+r,nr(i,b,Hq(g,c,s)),n.threadedcomments.push(b),Mr(h,-1,"../threadedComments/threadedComment"+o+"."+r,dr.TCMNT)),b="xl/comments"+o+"."+r,nr(i,b,tB(g)),n.comments.push(b),Mr(h,-1,"../comments"+o+"."+r,dr.CMNT),v=!0}A["!legacy"]&&v&&nr(i,"xl/drawings/vmlDrawing"+o+".vml",eB(o,A["!comments"])),delete A["!comments"],delete A["!legacy"]}h["!id"].rId1&&nr(i,yf(l),Ch(h))}return s.Strings!=null&&s.Strings.length>0&&(l="xl/sharedStrings."+r,nr(i,l,Hk(s.Strings,s)),n.strs.push(l),Mr(s.wbrels,-1,"sharedStrings."+r,dr.SST)),l="xl/workbook."+r,nr(i,l,gB(t)),n.workbooks.push(l),Mr(s.rels,1,l,dr.WB),l="xl/theme/theme1.xml",nr(i,l,Pj(t.Themes,s)),n.themes.push(l),Mr(s.wbrels,-1,"theme/theme1.xml",dr.THEME),l="xl/styles."+r,nr(i,l,Yk(t,s)),n.styles.push(l),Mr(s.wbrels,-1,"styles."+r,dr.STY),t.vbaraw&&a&&(l="xl/vbaProject.bin",nr(i,l,t.vbaraw),n.vba.push(l),Mr(s.wbrels,-1,"vbaProject.bin",dr.VBA)),l="xl/metadata."+r,nr(i,l,Zk()),n.metadata.push(l),Mr(s.wbrels,-1,"metadata."+r,dr.XLMETA),c.length>1&&(l="xl/persons/person.xml",nr(i,l,Vq(c)),n.people.push(l),Mr(s.wbrels,-1,"persons/person.xml",dr.PEOPLE)),nr(i,"[Content_Types].xml",fk(n,s)),nr(i,"_rels/.rels",Ch(s.rels)),nr(i,"xl/_rels/workbook."+r+".rels",Ch(s.wbrels)),delete s.revssf,delete s.ssf,i}function Gj(t,s){var r="";switch((s||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=gl(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(s&&s.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Uz(t,s){return Rs.find(t,"EncryptedPackage")?Tz(t,s):jB(t,s)}function Pz(t,s){var r,a=t,n=s||{};return n.type||(n.type=ir&&Buffer.isBuffer(t)?"buffer":"base64"),r=V4(a,n),Fz(r,n)}function EB(t,s){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ky(t.slice(r),s);default:break e}return Uh.to_workbook(t,s)}function Rz(t,s){var r="",a=Gj(t,s);switch(s.type){case"base64":r=gl(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=pA(t);break;default:throw new Error("Unrecognized type "+s.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=$r(r)),s.type="binary",EB(r,s)}function Oz(t,s){var r=t;return s.type=="base64"&&(r=gl(r)),r=ff.utils.decode(1200,r.slice(2),"str"),s.type="binary",EB(r,s)}function Qz(t){return t.match(/[^\x00-\x7F]/)?ic(t):t}function cb(t,s,r,a){return a?(r.type="string",Uh.to_workbook(t,r)):Uh.to_workbook(s,r)}function v0(t,s){Aj();var r=s||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return v0(new Uint8Array(t),(r=oa(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=t,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Bh={},r.dateNF&&(Bh.dateNF=r.dateNF),r.type||(r.type=ir&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=ir?"buffer":"binary",a=LQ(t),typeof Uint8Array<"u"&&!ir&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=Qz(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),o=new Uint8Array(l);if(o.foo="bar",!o.foo)return r=oa(r),r.type="array",v0(hj(a),r)}switch((n=Gj(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return Uz(Rs.read(a,r),r);break;case 9:if(n[1]<=8)return jB(a,r);break;case 60:return ky(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return $9(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return Qk.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?Pz(a,r):cb(t,a,r,i);case 239:return n[3]===60?ky(a,r):cb(t,a,r,i);case 255:if(n[1]===254)return Oz(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return uA.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return uA.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Cy.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return Gk.to_workbook(a,r);break;case 10:case 13:case 32:return Rz(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return V9.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Cy.to_workbook(a,r):cb(t,a,r,i)}function FB(t,s){switch(s.type){case"base64":case"binary":break;case"buffer":case"array":s.type="";break;case"file":return Qf(s.file,Rs.write(t,{type:ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");default:throw new Error("Unrecognized type "+s.type)}return Rs.write(t,s)}function Mz(t,s){var r=oa(s||{}),a=Iz(t,r);return Hz(a,r)}function Hz(t,s){var r={},a=ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(s.compression&&(r.compression="DEFLATE"),s.password)r.type=a;else switch(s.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+s.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+s.type)}var n=t.FullPaths?Rs.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!s.compression}):t.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(s.type=="binary"||s.type=="base64")return n;n=new Uint8Array(tg(n))}return s.password&&typeof encrypt_agile<"u"?FB(encrypt_agile(n,s.password),s):s.type==="file"?Qf(s.file,n):s.type=="string"?$r(n):n}function qz(t,s){var r=s||{},a=QK(t,r);return FB(a,r)}function ac(t,s,r){r||(r="");var a=r+t;switch(s.type){case"base64":return pf(ic(a));case"binary":return ic(a);case"string":return t;case"file":return Qf(s.file,a,"utf8");case"buffer":return ir?rd(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ac(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function Vz(t,s){switch(s.type){case"base64":return pf(t);case"binary":return t;case"string":return t;case"file":return Qf(s.file,t,"binary");case"buffer":return ir?rd(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+s.type)}function vx(t,s){switch(s.type){case"string":case"base64":case"binary":for(var r="",a=0;a<t.length;++a)r+=String.fromCharCode(t[a]);return s.type=="base64"?pf(r):s.type=="string"?$r(r):r;case"file":return Qf(s.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+s.type)}}function TB(t,s){Aj(),UG(t);var r=oa(s||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=TB(t,r);return r.type="array",tg(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=t.SheetNames.indexOf(r.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ac(IK(t,r),r);case"slk":case"sylk":return ac(Ok.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"htm":case"html":return ac(wB(t.Sheets[t.SheetNames[n]],r),r);case"txt":return Vz(IB(t.Sheets[t.SheetNames[n]],r),r);case"csv":return ac(Kj(t.Sheets[t.SheetNames[n]],r),r,"\uFEFF");case"dif":return ac(Qk.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"dbf":return vx(Cy.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"prn":return ac(Uh.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"rtf":return ac(Gk.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"eth":return ac(Mk.from_sheet(t.Sheets[t.SheetNames[n]],r),r);case"fods":return ac(kB(t,r),r);case"wk1":return vx(uA.sheet_to_wk1(t.Sheets[t.SheetNames[n]],r),r);case"wk3":return vx(uA.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),vx(NB(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qz(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Mz(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $z(t){if(!t.bookType){var s={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=s[t.bookType]||t.bookType}}function xr(t,s,r){var a={};return a.type="file",a.file=s,$z(a),TB(t,a)}function Wz(t,s,r,a,n,i,l,o){var u=qa(r),d=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,A=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(A,"__rowNum__",{value:r,enumerable:!1})}catch{A.__rowNum__=r}else A.__rowNum__=r;if(!l||t[r])for(var f=s.s.c;f<=s.e.c;++f){var g=l?t[r][f]:t[a[f]+u];if(g===void 0||g.t===void 0){if(d===void 0)continue;i[f]!=null&&(A[i[f]]=d);continue}var v=g.v;switch(g.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[f]!=null){if(v==null)if(g.t=="e"&&v===null)A[i[f]]=null;else if(d!==void 0)A[i[f]]=d;else if(c&&v===null)A[i[f]]=null;else continue;else A[i[f]]=c&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?v:Zc(g,v,o);v!=null&&(h=!1)}}return{row:A,isempty:h}}function b0(t,s){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],l=0,o="",u={s:{r:0,c:0},e:{r:0,c:0}},d=s||{},c=d.range!=null?d.range:t["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof c){case"string":u=jr(c);break;case"number":u=jr(t["!ref"]),u.s.r=c;break;default:u=c}a>0&&(n=0);var h=qa(u.s.r),A=[],f=[],g=0,v=0,b=Array.isArray(t),y=u.s.r,j=0,N={};b&&!t[y]&&(t[y]=[]);var S=d.skipHidden&&t["!cols"]||[],B=d.skipHidden&&t["!rows"]||[];for(j=u.s.c;j<=u.e.c;++j)if(!(S[j]||{}).hidden)switch(A[j]=xa(j),r=b?t[y][j]:t[A[j]+h],a){case 1:i[j]=j-u.s.c;break;case 2:i[j]=A[j];break;case 3:i[j]=d.header[j-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=l=Zc(r,null,d),v=N[l]||0,!v)N[l]=1;else{do o=l+"_"+v++;while(N[o]);N[l]=v,N[o]=1}i[j]=o}for(y=u.s.r+n;y<=u.e.r;++y)if(!(B[y]||{}).hidden){var P=Wz(t,u,y,A,a,i,b,d);(P.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(f[g++]=P.row)}return f.length=g,f}var Y_=/"/g;function Gz(t,s,r,a,n,i,l,o){for(var u=!0,d=[],c="",h=qa(r),A=s.s.c;A<=s.e.c;++A)if(a[A]){var f=o.dense?(t[r]||[])[A]:t[a[A]+h];if(f==null)c="";else if(f.v!=null){u=!1,c=""+(o.rawNumbers&&f.t=="n"?f.v:Zc(f,null,o));for(var g=0,v=0;g!==c.length;++g)if((v=c.charCodeAt(g))===n||v===i||v===34||o.forceQuotes){c='"'+c.replace(Y_,'""')+'"';break}c=="ID"&&(c='"ID"')}else f.f!=null&&!f.F?(u=!1,c="="+f.f,c.indexOf(",")>=0&&(c='"'+c.replace(Y_,'""')+'"')):c="";d.push(c)}return o.blankrows===!1&&u?null:d.join(l)}function Kj(t,s){var r=[],a=s??{};if(t==null||t["!ref"]==null)return"";var n=jr(t["!ref"]),i=a.FS!==void 0?a.FS:",",l=i.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,u=o.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),c="",h=[];a.dense=Array.isArray(t);for(var A=a.skipHidden&&t["!cols"]||[],f=a.skipHidden&&t["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(A[g]||{}).hidden||(h[g]=xa(g));for(var v=0,b=n.s.r;b<=n.e.r;++b)(f[b]||{}).hidden||(c=Gz(t,n,b,h,l,u,i,a),c!=null&&(a.strip&&(c=c.replace(d,"")),(c||a.blankrows!==!1)&&r.push((v++?o:"")+c)));return delete a.dense,r.join("")}function IB(t,s){s||(s={}),s.FS="	",s.RS=`
`;var r=Kj(t,s);return r}function Kz(t){var s="",r,a="";if(t==null||t["!ref"]==null)return[];var n=jr(t["!ref"]),i="",l=[],o,u=[],d=Array.isArray(t);for(o=n.s.c;o<=n.e.c;++o)l[o]=xa(o);for(var c=n.s.r;c<=n.e.r;++c)for(i=qa(c),o=n.s.c;o<=n.e.c;++o)if(s=l[o]+i,r=d?(t[c]||[])[o]:t[s],a="",r!==void 0){if(r.F!=null){if(s=r.F,!r.f)continue;a=r.f,s.indexOf(":")==-1&&(s=s+":"+s)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}u[u.length]=s+"="+a}return u}function LB(t,s,r){var a=r||{},n=+!a.skipHeader,i=t||{},l=0,o=0;if(i&&a.origin!=null)if(typeof a.origin=="number")l=a.origin;else{var u=typeof a.origin=="string"?ga(a.origin):a.origin;l=u.r,o=u.c}var d,c={s:{c:0,r:0},e:{c:o,r:l+s.length-1+n}};if(i["!ref"]){var h=jr(i["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),l==-1&&(l=h.e.r+1,c.e.r=l+s.length-1+n)}else l==-1&&(l=0,c.e.r=s.length-1+n);var A=a.header||[],f=0;s.forEach(function(v,b){Ba(v).forEach(function(y){(f=A.indexOf(y))==-1&&(A[f=A.length]=y);var j=v[y],N="z",S="",B=$s({c:o+f,r:l+b+n});d=kf(i,B),j&&typeof j=="object"&&!(j instanceof Date)?i[B]=j:(typeof j=="number"?N="n":typeof j=="boolean"?N="b":typeof j=="string"?N="s":j instanceof Date?(N="d",a.cellDates||(N="n",j=cn(j)),S=a.dateNF||Hs[14]):j===null&&a.nullError&&(N="e",j=0),d?(d.t=N,d.v=j,delete d.w,delete d.R,S&&(d.z=S)):i[B]=d={t:N,v:j},S&&(d.z=S))})}),c.e.c=Math.max(c.e.c,o+A.length-1);var g=qa(l);if(n)for(f=0;f<A.length;++f)i[xa(f+o)+g]={t:"s",v:A[f]};return i["!ref"]=ar(c),i}function zz(t,s){return LB(null,t,s)}function kf(t,s,r){if(typeof s=="string"){if(Array.isArray(t)){var a=ga(s);return t[a.r]||(t[a.r]=[]),t[a.r][a.c]||(t[a.r][a.c]={t:"z"})}return t[s]||(t[s]={t:"z"})}return typeof s!="number"?kf(t,$s(s)):kf(t,$s({r:s,c:r||0}))}function Yz(t,s){if(typeof s=="number"){if(s>=0&&t.SheetNames.length>s)return s;throw new Error("Cannot find sheet # "+s)}else if(typeof s=="string"){var r=t.SheetNames.indexOf(s);if(r>-1)return r;throw new Error("Cannot find sheet name |"+s+"|")}else throw new Error("Cannot find sheet |"+s+"|")}function zj(){return{SheetNames:[],Sheets:{}}}function Yj(t,s,r,a){var n=1;if(!r)for(;n<=65535&&t.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var l=i&&i[1]||r;for(++n;n<=65535&&t.SheetNames.indexOf(r=l+n)!=-1;++n);}if(xB(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=s,r}function Xz(t,s,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var a=Yz(t,s);switch(t.Workbook.Sheets[a]||(t.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[a].Hidden=r}function Jz(t,s){return t.z=s,t}function DB(t,s,r){return s?(t.l={Target:s},r&&(t.l.Tooltip=r)):delete t.l,t}function Zz(t,s,r){return DB(t,"#"+s,r)}function eY(t,s,r){t.c||(t.c=[]),t.c.push({t:s,a:r||"SheetJS"})}function tY(t,s,r,a){for(var n=typeof s!="string"?s:jr(s),i=typeof s=="string"?s:ar(s),l=n.s.r;l<=n.e.r;++l)for(var o=n.s.c;o<=n.e.c;++o){var u=kf(t,l,o);u.t="n",u.F=i,delete u.v,l==n.s.r&&o==n.s.c&&(u.f=r,a&&(u.D=!0))}return t}var is={encode_col:xa,encode_row:qa,encode_cell:$s,encode_range:ar,decode_col:_j,decode_row:wj,split_cell:AM,decode_cell:ga,decode_range:Xi,format_cell:Zc,sheet_add_aoa:ok,sheet_add_json:LB,sheet_add_dom:_B,aoa_to_sheet:Kh,json_to_sheet:zz,table_to_sheet:SB,table_to_book:oz,sheet_to_csv:Kj,sheet_to_txt:IB,sheet_to_json:b0,sheet_to_html:wB,sheet_to_formulae:Kz,sheet_to_row_object_array:b0,sheet_get_cell:kf,book_new:zj,book_append_sheet:Yj,book_set_sheet_visibility:Xz,cell_set_number_format:Jz,cell_set_hyperlink:DB,cell_set_internal_link:Zz,cell_add_comment:eY,sheet_set_array_formula:tY,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function sY(){const[t,s]=x.useState("standard"),[r,a]=x.useState(!1),[n,i]=x.useState([]),[l,o]=x.useState([]),[u,d]=x.useState([]),[c,h]=x.useState([]),[A,f]=x.useState([]),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState(null),S=Ts.useRef(null),[B,P]=x.useState({product:"",customer:"",category:""}),[L,U]=x.useState({});x.useEffect(()=>{H()},[]),x.useEffect(()=>{q()},[t,B]);const H=async()=>{try{console.log("Loading initial data...");const[Q,C,E,w]=await Promise.all([ee.get("/inventory/items"),ee.get("/sales/customers"),ee.get("/sales/price-types"),ee.get("/finance/currencies")]);console.log("Products loaded:",Q.data),console.log("Customers loaded:",C.data),console.log("Price Types loaded:",E.data),console.log("Currencies loaded:",w.data),o(Q.data.items||[]),d(C.data.items||[]),h(E.data.items||[]),f(w.data.items||[])}catch(Q){console.error("Error loading initial data:",Q)}},q=async()=>{a(!0);try{let Q="",C={};switch(t){case"standard":Q="/sales/prices/standard";break;case"customer":Q="/sales/prices/customer",B.customer&&(C.customer_id=B.customer);break;default:return}console.log(`Fetching tab data from ${Q}`,C);const E=await ee.get(Q,{params:C});console.log("Tab data response:",E.data);const w=Array.isArray(E.data)?E.data:E.data.items||[];i(w)}catch(Q){console.error("Error loading tab data:",Q)}finally{a(!1)}},V=()=>{let Q=[],C="",E=[];t==="standard"?(Q=["Item Code","Cost Price","Selling Price","Margin %","Effective Date (YYYY-MM-DD)","Price Type","UOM","Currency Name"],C="standard_prices_template.xlsx",E=n.map(R=>{const X=l.find(oe=>oe.id===R.product_id),ne=c.find(oe=>oe.id===R.price_type_id),te=A.find(oe=>oe.id===R.currency_id);return[X?X.item_code:"",R.cost_price,R.selling_price,R.margin_percent,R.effective_date?R.effective_date.split("T")[0]:"",ne?ne.name:"",R.uom,te?te.name:""]})):(Q=["Customer Name","Item Code","Standard Price","Customer Price","Discount %","Min Quantity","Effective From (YYYY-MM-DD)","Effective To (YYYY-MM-DD)","Price Type","UOM","Currency Name"],C="customer_prices_template.xlsx",E=n.map(R=>{const X=l.find(ce=>ce.id===R.product_id),ne=u.find(ce=>ce.id===R.customer_id),te=c.find(ce=>ce.id===R.price_type_id),oe=A.find(ce=>ce.id===R.currency_id);return[ne?ne.customer_name:"",X?X.item_code:"",R.standard_price,R.customer_price,R.discount_percent,R.min_quantity,R.effective_from?R.effective_from.split("T")[0]:"",R.effective_to?R.effective_to.split("T")[0]:"",te?te.name:"",R.uom,oe?oe.name:""]}));const w=is.aoa_to_sheet([Q,...E]),O=is.book_new();is.book_append_sheet(O,w,"Prices"),xr(O,C)},M=()=>{S.current.click()},z=async Q=>{const C=Q.target.files[0];if(!C)return;const E=new FileReader;E.onload=async w=>{var O,R;try{const X=new Uint8Array(w.target.result),ne=v0(X,{type:"array"}),te=ne.SheetNames[0],oe=ne.Sheets[te],ce=is.sheet_to_json(oe);if(ce.length===0){alert("File is empty or invalid format");return}const re=t==="standard"?"/sales/prices/bulk/standard":"/sales/prices/bulk/customer";await ee.post(re,{items:ce}),alert("Uploaded successfully"),q()}catch(X){console.error("Upload failed",X),alert("Upload failed: "+(((R=(O=X.response)==null?void 0:O.data)==null?void 0:R.message)||X.message))}},E.readAsArrayBuffer(C),Q.target.value=""},I=(Q,C=null)=>{y(Q),N(C),U(C||{}),v(!0)},G=()=>{v(!1),N(null),U({})},Y=async()=>{var Q,C;try{let E="";const w={...L};switch(["product_id","customer_id","cost_price","selling_price","margin_percent","standard_price","customer_price","discount_percent","min_quantity","max_quantity","unit_price","price_type_id","currency_id"].forEach(X=>{w[X]!==void 0&&w[X]!==null&&w[X]!==""?w[X]=Number(w[X]):["cost_price","selling_price","customer_price","unit_price"].includes(X)?(w[X]===""||w[X]===void 0)&&(w[X]=0):w[X]===""&&(w[X]=null)}),["effective_date","effective_from","effective_to"].forEach(X=>{w[X]===""&&(w[X]=null)}),b){case"standard":E="/sales/prices/standard";break;case"customer":E="/sales/prices/customer";break;default:return}await ee.post(E,w),G(),q()}catch(E){console.error("Error saving data:",E),alert("Failed to save data: "+(((C=(Q=E.response)==null?void 0:Q.data)==null?void 0:C.message)||E.message))}},J=()=>e.jsx("div",{className:"table-container",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Cost Price"}),e.jsx("th",{children:"Selling Price"}),e.jsx("th",{children:"Margin %"}),e.jsx("th",{children:"Effective Date"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map((Q,C)=>{const E=l.find(R=>R.id===Q.product_id),w=c.find(R=>R.id===Q.price_type_id),O=A.find(R=>R.id===Q.currency_id);return e.jsxs("tr",{children:[e.jsx("td",{children:E?`${E.item_name} (${E.item_code})`:Q.product_id}),e.jsx("td",{children:Number(Q.cost_price).toFixed(2)}),e.jsx("td",{children:Number(Q.selling_price).toFixed(2)}),e.jsxs("td",{children:[Number(Q.margin_percent).toFixed(2),"%"]}),e.jsx("td",{children:new Date(Q.effective_date).toLocaleDateString()}),e.jsx("td",{children:w?w.name:"-"}),e.jsx("td",{children:Q.uom||"-"}),e.jsx("td",{children:O?`${O.code} - ${O.name}`:Q.currency_id||"-"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-info",onClick:()=>I("standard",Q),children:"Edit"})})]},C)})})]})}),T=()=>e.jsx("div",{className:"table-container",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Standard Price"}),e.jsx("th",{children:"Customer Price"}),e.jsx("th",{children:"Discount %"}),e.jsx("th",{children:"Min Qty"}),e.jsx("th",{children:"Effective"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:n.map((Q,C)=>{const E=u.find(X=>X.id===Q.customer_id),w=l.find(X=>X.id===Q.product_id),O=c.find(X=>X.id===Q.price_type_id),R=A.find(X=>X.id===Q.currency_id);return e.jsxs("tr",{children:[e.jsx("td",{children:E?E.customer_name:Q.customer_id}),e.jsx("td",{children:w?w.item_name:Q.product_id}),e.jsx("td",{children:Number(Q.standard_price).toFixed(2)}),e.jsx("td",{children:Number(Q.customer_price).toFixed(2)}),e.jsxs("td",{children:[Number(Q.discount_percent).toFixed(2),"%"]}),e.jsx("td",{children:Q.min_quantity}),e.jsx("td",{children:Q.effective_from?new Date(Q.effective_from).toLocaleDateString():"-"}),e.jsx("td",{children:O?O.name:"-"}),e.jsx("td",{children:Q.uom||"-"}),e.jsx("td",{children:R?`${R.code} - ${R.name}`:Q.currency_id||"-"}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-info",onClick:()=>I("customer",Q),children:"Edit"})})]},C)})})]})}),k=Q=>{const C=l.find(E=>E.id==Q);U(C?E=>({...E,product_id:Q,uom:C.uom,cost_price:C.cost_price,currency_id:C.currency_id,price_type_id:C.price_type_id}):E=>({...E,product_id:Q}))},D=()=>{if(b==="standard")return e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Product"}),e.jsxs("select",{value:L.product_id||"",onChange:Q=>k(Q.target.value),children:[e.jsx("option",{value:"",children:"Select Product"}),l.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.item_name," (",Q.item_code,")"]},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price Type"}),e.jsxs("select",{value:L.price_type_id||"",onChange:Q=>U({...L,price_type_id:Q.target.value}),children:[e.jsx("option",{value:"",children:"Select Price Type"}),c.map(Q=>e.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"UOM"}),e.jsx("input",{type:"text",value:L.uom||"",onChange:Q=>U({...L,uom:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Currency"}),e.jsxs("select",{value:L.currency_id||"",onChange:Q=>U({...L,currency_id:Q.target.value}),children:[e.jsx("option",{value:"",children:"Select Currency"}),A.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.code," - ",Q.name]},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Cost Price"}),e.jsx("input",{type:"number",value:L.cost_price||"",onChange:Q=>{const C=Number(Q.target.value||0),E=Number(L.margin_percent||0),w=Number((C+C*E/100).toFixed(2));U({...L,cost_price:Q.target.value,selling_price:w})}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Selling Price"}),e.jsx("input",{type:"number",value:L.selling_price||"",onChange:Q=>{const C=Number(Q.target.value||0),E=Number(L.cost_price||0),w=E>0?Number((C-E)/E*100):0;U({...L,selling_price:Q.target.value,margin_percent:Number(w.toFixed(2))})}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Margin %"}),e.jsx("input",{type:"number",value:L.margin_percent||"",onChange:Q=>{const C=Number(Q.target.value||0),E=Number(L.cost_price||0),w=Number((E+E*C/100).toFixed(2));U({...L,margin_percent:Q.target.value,selling_price:w})}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Effective Date"}),e.jsx("input",{type:"date",value:L.effective_date?L.effective_date.split("T")[0]:"",onChange:Q=>U({...L,effective_date:Q.target.value})})]})]});if(b==="customer")return e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Customer"}),e.jsxs("select",{value:L.customer_id||"",onChange:Q=>U({...L,customer_id:Q.target.value}),children:[e.jsx("option",{value:"",children:"Select Customer"}),u.map(Q=>e.jsx("option",{value:Q.id,children:Q.customer_name},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Product"}),e.jsxs("select",{value:L.product_id||"",onChange:Q=>k(Q.target.value),children:[e.jsx("option",{value:"",children:"Select Product"}),l.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.item_name," (",Q.item_code,")"]},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Price Type"}),e.jsxs("select",{value:L.price_type_id||"",onChange:Q=>U({...L,price_type_id:Q.target.value}),children:[e.jsx("option",{value:"",children:"Select Price Type"}),c.map(Q=>e.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"UOM"}),e.jsx("input",{type:"text",value:L.uom||"",onChange:Q=>U({...L,uom:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Currency"}),e.jsxs("select",{value:L.currency_id||"",onChange:Q=>U({...L,currency_id:Q.target.value}),children:[e.jsx("option",{value:"",children:"Select Currency"}),A.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.code," - ",Q.name]},Q.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Standard Price"}),e.jsx("input",{type:"number",value:L.standard_price||"",onChange:Q=>U({...L,standard_price:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"required",children:"Customer Price"}),e.jsx("input",{type:"number",value:L.customer_price||"",onChange:Q=>U({...L,customer_price:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Discount %"}),e.jsx("input",{type:"number",value:L.discount_percent||"",onChange:Q=>U({...L,discount_percent:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Min Quantity"}),e.jsx("input",{type:"number",value:L.min_quantity||"",onChange:Q=>U({...L,min_quantity:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Effective From"}),e.jsx("input",{type:"date",value:L.effective_from?L.effective_from.split("T")[0]:"",onChange:Q=>U({...L,effective_from:Q.target.value})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Effective To"}),e.jsx("input",{type:"date",value:L.effective_to?L.effective_to.split("T")[0]:"",onChange:Q=>U({...L,effective_to:Q.target.value})})]})]})};return e.jsxs("div",{className:"price-setup-container",children:[e.jsx("input",{type:"file",ref:S,style:{display:"none"},accept:".csv",onChange:z}),e.jsxs("div",{className:"price-setup-header",children:[e.jsxs("h1",{children:[e.jsx("span",{children:""}),"Price Setup"]}),e.jsxs("div",{className:"header-actions",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:" Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:V,children:" Download Template"}),e.jsx("button",{className:"btn btn-secondary",onClick:M,children:" Upload Prices"}),e.jsx("button",{className:"btn btn-secondary",onClick:q,children:" Refresh"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>I(t),children:" New Price"})]})]}),e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:`tab ${t==="standard"?"active":""}`,onClick:()=>s("standard"),children:" Standard Prices"}),e.jsx("button",{className:`tab ${t==="customer"?"active":""}`,onClick:()=>s("customer"),children:" Customer Specific Prices"})]}),t==="standard"&&e.jsxs("div",{className:"tab-content active",children:[e.jsx("div",{className:"filter-section",children:e.jsxs("div",{className:"filter-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Search Product"}),e.jsx("input",{type:"text",placeholder:"Search by code or name"})]}),e.jsx("div",{className:"form-group",children:e.jsx("button",{className:"btn btn-primary",children:" Search"})})]})}),r?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):n.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No standard prices found. Click "New Price" to add one.'}):J()]}),t==="customer"&&e.jsxs("div",{className:"tab-content active",children:[e.jsx("div",{className:"filter-section",children:e.jsx("div",{className:"filter-grid",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Select Customer"}),e.jsxs("select",{value:B.customer,onChange:Q=>P({...B,customer:Q.target.value}),children:[e.jsx("option",{value:"",children:"All Customers"}),u.map(Q=>e.jsx("option",{value:Q.id,children:Q.customer_name},Q.id))]})]})})}),r?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading..."}):n.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No customer prices found. Click "New Price" to add one.'}):T()]})]}),g&&e.jsx("div",{className:"price-modal-overlay",children:e.jsxs("div",{className:"price-modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:[b==="standard"&&" Standard Price Setup",b==="customer"&&" Customer Price Setup"]}),e.jsx("button",{className:"close-btn",onClick:G,children:""})]}),e.jsx("div",{className:"modal-body",children:D()}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-secondary",onClick:G,children:"Cancel"}),e.jsx("button",{className:"btn btn-primary",onClick:Y,children:"Save"})]})]})})]})}const db={scheme_code:"",scheme_name:"",discount_type:"",discount_value:"",effective_from:"",effective_to:"",min_quantity:"",min_purchase_amount:"",max_discount_amount:"",description:"",status:"ACTIVE",itemIds:[]};function rY(){const[t,s]=x.useState([]),[r,a]=x.useState([]),[n,i]=x.useState(!0),[l,o]=x.useState(!1),[u,d]=x.useState(null),[c,h]=x.useState(db),[A,f]=x.useState(""),[g,v]=x.useState(""),[b,y]=x.useState(""),[j,N]=x.useState("");x.useEffect(()=>{S()},[]);async function S(){var I;try{i(!0);const[G,Y]=await Promise.all([ee.get("/sales/discount-schemes"),ee.get("/inventory/items")]);s(Array.isArray((I=G.data)==null?void 0:I.items)?G.data.items:[]),a(Y.data.items||[])}catch(G){console.error(G),nt.error("Failed to load data")}finally{i(!1)}}const B=x.useMemo(()=>t.filter(I=>{const G=A?A==="ACTIVE"?I.is_active:!I.is_active:!0,Y=g?I.discount_type===g:!0,J=b.toLowerCase(),T=!b||I.scheme_code.toLowerCase().includes(J)||I.scheme_name.toLowerCase().includes(J)||I.description&&I.description.toLowerCase().includes(J);return G&&Y&&T}),[t,A,g,b]),P=x.useMemo(()=>{const I=t.length,G=t.filter(D=>D.is_active).length,Y=t.filter(D=>D.discount_type==="PERCENTAGE"),J=Y.length>0?(Y.reduce((D,Q)=>D+Number(Q.discount_value),0)/Y.length).toFixed(1):0,T=new Date,k=t.filter(D=>{const Q=new Date(D.effective_from);return Q.getMonth()===T.getMonth()&&Q.getFullYear()===T.getFullYear()}).length;return{total:I,active:G,avgDiscount:J,thisMonth:k}},[t]),L=async(I=null)=>{if(I){d(I);try{const Y=(await ee.get(`/sales/discount-schemes/${I}`)).data;h({scheme_code:Y.scheme_code,scheme_name:Y.scheme_name,discount_type:Y.discount_type,discount_value:Y.discount_value,effective_from:Y.effective_from?Y.effective_from.split("T")[0]:"",effective_to:Y.effective_to?Y.effective_to.split("T")[0]:"",min_quantity:Y.min_quantity||"",min_purchase_amount:Y.min_purchase_amount||"",max_discount_amount:Y.max_discount_amount||"",description:Y.description||"",status:Y.is_active?"ACTIVE":"INACTIVE",itemIds:Y.items?Y.items.map(J=>J.id):[]})}catch{nt.error("Failed to load details");return}}else d(null),h(db);o(!0)},U=()=>{o(!1),h(db),d(null)},H=I=>{const{name:G,value:Y}=I.target;h(J=>({...J,[G]:Y}))},q=I=>{h(G=>{const Y=G.itemIds||[];return Y.includes(I)?{...G,itemIds:Y.filter(J=>J!==I)}:{...G,itemIds:[...Y,I]}})},V=async I=>{var G,Y;I.preventDefault();try{const J={...c,is_active:c.status==="ACTIVE"?1:0};u?(await ee.put(`/sales/discount-schemes/${u}`,J),nt.success("Discount scheme updated")):(await ee.post("/sales/discount-schemes",J),nt.success("Discount scheme created")),U(),S()}catch(J){console.error(J),nt.error(((Y=(G=J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Operation failed")}},M=async I=>{if(window.confirm("Are you sure you want to delete this scheme?"))try{await ee.delete(`/sales/discount-schemes/${I}`),nt.success("Deleted successfully"),S()}catch{nt.error("Delete failed")}},z=x.useMemo(()=>{if(!j)return r;const I=j.toLowerCase();return r.filter(G=>G.item_code.toLowerCase().includes(I)||G.item_name.toLowerCase().includes(I))},[r,j]);return n&&!t.length?e.jsx("div",{className:"p-8 text-center",children:"Loading..."}):e.jsxs("div",{className:"discount-scheme-container",children:[e.jsx("header",{className:"ds-header",children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{children:" Discount Scheme Management"}),e.jsx("p",{children:"Manage and configure discount schemes for sales operations"})]}),e.jsx(Le,{to:"/sales",className:"ds-btn ds-btn-secondary",children:"Return to Menu"})]})}),e.jsxs("div",{className:"ds-stats-grid",children:[e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"Total Schemes"}),e.jsx("div",{className:"value",children:P.total})]}),e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"Active Schemes"}),e.jsx("div",{className:"value",children:P.active})]}),e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"Avg Discount %"}),e.jsxs("div",{className:"value",children:[P.avgDiscount,"%"]})]}),e.jsxs("div",{className:"ds-stat-card",children:[e.jsx("h3",{children:"This Month"}),e.jsx("div",{className:"value",children:P.thisMonth})]})]}),e.jsxs("div",{className:"ds-card",children:[e.jsxs("div",{className:"ds-action-bar",children:[e.jsx("div",{className:"ds-search-box",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, or description...",value:b,onChange:I=>y(I.target.value)})}),e.jsx("button",{className:"ds-btn ds-btn-primary",onClick:()=>L(),children:" New Discount Scheme"})]}),e.jsxs("div",{className:"ds-filter-section",children:[e.jsxs("select",{value:A,onChange:I=>f(I.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]}),e.jsxs("select",{value:g,onChange:I=>v(I.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"PERCENTAGE",children:"Percentage"}),e.jsx("option",{value:"FIXED",children:"Fixed Amount"})]})]}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{className:"ds-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Scheme Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Value"}),e.jsx("th",{children:"Valid From"}),e.jsx("th",{children:"Valid To"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"ds-empty-state",children:"No discount schemes found"})}):B.map(I=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:I.scheme_code})}),e.jsx("td",{children:I.scheme_name}),e.jsx("td",{children:e.jsx("span",{className:`ds-badge ds-badge-${I.discount_type==="PERCENTAGE"?"percentage":"fixed"}`,children:I.discount_type})}),e.jsx("td",{children:e.jsx("strong",{children:I.discount_type==="PERCENTAGE"?Number(I.discount_value)+"%":"$"+Number(I.discount_value).toFixed(2)})}),e.jsx("td",{children:new Date(I.effective_from).toLocaleDateString()}),e.jsx("td",{children:I.effective_to?new Date(I.effective_to).toLocaleDateString():"No expiry"}),e.jsx("td",{children:e.jsx("span",{className:`ds-badge ds-badge-${I.is_active?"active":"inactive"}`,children:I.is_active?"ACTIVE":"INACTIVE"})}),e.jsx("td",{children:e.jsxs("div",{className:"ds-action-buttons",children:[e.jsx("button",{className:"ds-icon-btn",onClick:()=>L(I.id),title:"Edit",children:""}),e.jsx("button",{className:"ds-icon-btn",onClick:()=>M(I.id),title:"Delete",children:""})]})})]},I.id))})]})})]}),l&&e.jsx("div",{className:"ds-modal-overlay",children:e.jsxs("div",{className:"ds-modal-content",children:[e.jsx("div",{className:"ds-modal-header",children:e.jsx("h2",{children:u?"Edit Discount Scheme":"New Discount Scheme"})}),e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Scheme Code *"}),e.jsx("input",{name:"scheme_code",value:c.scheme_code,onChange:H,required:!0,disabled:!!u})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Scheme Name *"}),e.jsx("input",{name:"scheme_name",value:c.scheme_name,onChange:H,required:!0})]})]}),e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Discount Type *"}),e.jsxs("select",{name:"discount_type",value:c.discount_type,onChange:H,required:!0,children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"PERCENTAGE",children:"Percentage"}),e.jsx("option",{value:"FIXED",children:"Fixed Amount"})]})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Discount Value *"}),e.jsx("input",{type:"number",name:"discount_value",value:c.discount_value,onChange:H,step:"0.01",min:"0",required:!0})]})]}),e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Valid From *"}),e.jsx("input",{type:"date",name:"effective_from",value:c.effective_from,onChange:H,required:!0})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Valid To"}),e.jsx("input",{type:"date",name:"effective_to",value:c.effective_to,onChange:H})]})]}),e.jsxs("div",{className:"ds-form-row",children:[e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Min Quantity"}),e.jsx("input",{type:"number",name:"min_quantity",value:c.min_quantity,onChange:H,step:"0.01",min:"0"})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Min Purchase Amount"}),e.jsx("input",{type:"number",name:"min_purchase_amount",value:c.min_purchase_amount,onChange:H,step:"0.01",min:"0"})]})]}),e.jsx("div",{className:"ds-form-row",children:e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Max Discount Amount"}),e.jsx("input",{type:"number",name:"max_discount_amount",value:c.max_discount_amount,onChange:H,step:"0.01",min:"0"})]})}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{name:"description",value:c.description,onChange:H,rows:"3"})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Status *"}),e.jsxs("select",{name:"status",value:c.status,onChange:H,required:!0,children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]}),e.jsxs("div",{className:"ds-form-group",children:[e.jsx("label",{children:"Linked Items (Search to filter)"}),e.jsx("input",{type:"text",placeholder:"Search items...",value:j,onChange:I=>N(I.target.value),className:"mb-2"}),e.jsxs("div",{className:"ds-item-selection",children:[z.slice(0,100).map(I=>e.jsxs("div",{className:"ds-item-checkbox",children:[e.jsx("input",{type:"checkbox",checked:c.itemIds.includes(I.id),onChange:()=>q(I.id)}),e.jsxs("span",{children:[I.item_code," - ",I.item_name]})]},I.id)),z.length>100&&e.jsx("div",{className:"p-2 text-gray-500 italic",children:"Showing first 100 matches..."})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Selected: ",c.itemIds.length," items"]})]}),e.jsxs("div",{className:"ds-action-buttons",children:[e.jsx("button",{type:"submit",className:"ds-btn ds-btn-success",children:" Save Scheme"}),e.jsx("button",{type:"button",className:"ds-btn ds-btn-secondary",onClick:U,children:" Cancel"})]})]})]})})]})}function aY(){const t=[{id:1,customer:"ABC Corporation",creditLimit:5e4,currency:"GHS"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Customer Credit Limits"}),e.jsx("p",{className:"text-sm mt-1",children:"Credit limit setup (placeholder)"})]}),e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Credit Limit"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.customer}),e.jsx("td",{className:"text-right",children:Number(s.creditLimit).toFixed(2)}),e.jsx("td",{children:s.currency}),e.jsx("td",{children:e.jsx(Le,{to:`/sales/customer-credit/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function nY(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({customer:"",creditLimit:0,currency:"GHS"});x.useEffect(()=>{r&&d()},[s]);async function d(){var A,f,g;try{n(!0),l("");const v=await ee.get(`/sales/customer-credit/${s}`);(A=v.data)!=null&&A.item&&u(v.data.item)}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error fetching customer credit")}finally{n(!1)}}function c(A,f){u(g=>({...g,[A]:f}))}async function h(A){var f,g;A.preventDefault(),n(!0),l("");try{r?await ee.put(`/sales/customer-credit/${s}`,o):await ee.post("/sales/customer-credit",o),t("/sales/customer-credit")}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error saving customer credit")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Credit Limit":"New Credit Limit"})}),e.jsx(Le,{to:"/sales/customer-credit",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer *"}),e.jsx("input",{className:"input",value:o.customer,onChange:A=>c("customer",A.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Credit Limit"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:o.creditLimit,onChange:A=>c("creditLimit",Number(A.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input",value:o.currency,onChange:A=>c("currency",A.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/sales/customer-credit",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function iY(){const t=ys(),s=Ts.useRef(null),[r,a]=x.useState([]),[n,i]=x.useState(!0),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(!1),[A,f]=x.useState(""),[g,v]=x.useState(!1),[b,y]=x.useState(!1),[j,N]=x.useState(!1),[S,B]=x.useState(!1),{hasAccess:P,scope:L}=ca(),[U,H]=x.useState(!1);x.useEffect(()=>{q()},[]);const q=async()=>{var I,G,Y;try{i(!0),o("");const J=await ee.get("/sales/customers",{params:{active:!0}}),T=J.data&&J.data.data&&J.data.data.items||((I=J.data)==null?void 0:I.items)||[];a(Array.isArray(T)?T:[])}catch(J){o(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Error fetching customers"),console.error("Error fetching customers:",J)}finally{i(!1)}},V=async()=>{try{const I=await ee.get("/sales/customers/template",{responseType:"blob"}),G=window.URL.createObjectURL(new Blob([I.data])),Y=document.createElement("a");Y.href=G,Y.setAttribute("download","CustomerTemplate.xlsx"),document.body.appendChild(Y),Y.click(),Y.remove()}catch(I){console.error("Error downloading template",I),alert("Error downloading template")}},M=async I=>{var J,T;const G=I.target.files[0];if(!G)return;const Y=new FormData;Y.append("file",G);try{i(!0),await ee.post("/sales/customers/import",Y,{headers:{"Content-Type":"multipart/form-data"}}),alert("Customers imported successfully!"),q()}catch(k){console.error("Error importing customers",k),alert(((T=(J=k==null?void 0:k.response)==null?void 0:J.data)==null?void 0:T.message)||"Error importing customers")}finally{i(!1),s.current&&(s.current.value="")}},z=r.filter(I=>I&&(String(I.customer_code||"").toLowerCase().includes(u.toLowerCase())||String(I.customer_name||"").toLowerCase().includes(u.toLowerCase())||String(I.email||"").toLowerCase().includes(u.toLowerCase())));return n?e.jsx("div",{className:"text-center py-8",children:"Loading customers..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Customer Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customers and their information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:V,className:"btn btn-secondary",children:"Template"}),e.jsx("button",{onClick:()=>s.current.click(),className:"btn btn-primary",children:"Import"}),e.jsx("input",{type:"file",ref:s,className:"hidden",accept:".xlsx, .xls",onChange:M}),e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/sales/customers/new",className:"btn-success",children:"+ New Customer"})]})]})}),l&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:l})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:"Search customers...",className:"input",value:u,onChange:I=>d(I.target.value)}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:U,onChange:I=>H(I.target.checked)}),e.jsx("span",{children:"Show current branch only"})]}),e.jsx("button",{className:"btn btn-outline",onClick:q,children:"Refresh"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Price Type"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Email/Phone"}),e.jsx("th",{children:"Credit Limit"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:(U?z.filter(I=>String(I.branch_id||"")===String((L==null?void 0:L.branchId)||"")):z).map(I=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:I.customer_code}),e.jsxs("td",{children:[e.jsx("div",{className:"font-bold",children:I.customer_name}),I.address&&e.jsx("div",{className:"text-xs text-slate-500 truncate max-w-[200px]",children:I.address})]}),e.jsx("td",{children:I.customer_type||"-"}),e.jsx("td",{children:I.price_type_name||"-"}),e.jsx("td",{children:I.contact_person||"-"}),e.jsxs("td",{children:[e.jsx("div",{className:"text-sm",children:I.email}),e.jsx("div",{className:"text-xs text-slate-500",children:I.phone})]}),e.jsx("td",{children:I.credit_limit?`${Number(I.credit_limit).toFixed(2)}`:"-"}),e.jsx("td",{children:I.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx("button",{className:"text-brand hover:text-brand-600 text-sm font-medium",onClick:()=>t(`/sales/customers/${I.id}`),children:"Edit"})})]},I.id))})]}),z.length===0&&e.jsx("div",{className:"text-center py-8 text-slate-600",children:"No customers found"})]})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-red-600 text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Bulk Delete Customers"}),e.jsx("button",{onClick:()=>{h(!1),f("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"text-sm text-slate-700",children:"Paste names and/or codes. Raw blobs accepted; codes like C00003 will be detected."}),e.jsx("textarea",{className:"input w-full h-40",placeholder:"Enter customer names/codes/raw data...",value:A,onChange:I=>f(I.target.value)}),e.jsx("div",{className:"text-xs text-slate-600",children:"This action deletes matching customers for the current company."}),e.jsxs("label",{className:"flex items-center gap-2 text-sm mt-2",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:b,onChange:I=>y(I.target.checked)}),e.jsx("span",{children:"Force delete (temporarily disable constraints)"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:j,onChange:I=>N(I.target.checked)}),e.jsx("span",{children:"Cascade delete (remove dependent sales rows)"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:S,onChange:I=>B(I.target.checked)}),e.jsx("span",{children:"Also cleanup finance accounts"})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{h(!1),f("")},disabled:g,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:async()=>{var I,G,Y,J,T,k;if(!A.trim()){alert("Enter names or codes to delete.");return}if(window.confirm("Are you sure you want to delete the provided customers?"))try{v(!0);const D=await ee.post("/sales/customers/bulk-delete",{raw:A,force:b,cascade:j,cleanup_finance:S}),Q=Number(((I=D==null?void 0:D.data)==null?void 0:I.deletedByName)||0),C=Number(((G=D==null?void 0:D.data)==null?void 0:G.deletedByCode)||0),E=Number(((Y=D==null?void 0:D.data)==null?void 0:Y.matched)||0),w=Number(((J=D==null?void 0:D.data)==null?void 0:J.deleted)||Q+C),O=Q||C?`Deleted by name: ${Q}
Deleted by code: ${C}
Total: ${Q+C}`:`Matched: ${E}
Deleted: ${w}`;alert(O),h(!1),f(""),await q()}catch(D){alert(((k=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:k.message)||"Bulk delete failed. Ensure you have delete rights.")}finally{v(!1)}},disabled:g,children:g?"Deleting...":"Delete"})]})]})})]})}function X_(){var N;const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState([]),[d,c]=x.useState([]),[h,A]=x.useState({customer_code:"",customer_name:"",email:"",phone:"",is_active:!0,address:"",city:"",state:"",zone:"",country:"",price_type_id:"",currency_id:""});x.useEffect(()=>{g(),v(),r?b():f()},[s]);async function f(){var S;try{const B=await ee.get("/sales/customers/next-code");(S=B.data)!=null&&S.code&&y("customer_code",B.data.code)}catch(B){console.error("Error fetching next customer code",B)}}async function g(){var S;try{const B=await ee.get("/sales/price-types");u(Array.isArray((S=B.data)==null?void 0:S.items)?B.data.items:[])}catch(B){console.error("Error fetching price types",B)}}async function v(){var S;try{const B=await ee.get("/finance/currencies"),P=Array.isArray((S=B.data)==null?void 0:S.items)?B.data.items:[];c(P);const L=P.find(U=>Number(U.is_base)===1);!r&&L&&y("currency_id",String(L.id))}catch(B){console.error("Error fetching currencies",B)}}async function b(){var S,B,P;try{n(!0),l("");const L=await ee.get(`/sales/customers/${s}`);(S=L.data)!=null&&S.item&&A(L.data.item)}catch(L){l(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Error fetching customer")}finally{n(!1)}}function y(S,B){A(P=>({...P,[S]:B}))}async function j(S){var B,P;S.preventDefault(),n(!0),l("");try{r?await ee.put(`/sales/customers/${s}`,h):await ee.post("/sales/customers",h),t("/sales/customers")}catch(L){l(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Error saving customer")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Customer":"New Customer"})}),e.jsx(Le,{to:"/sales/customers",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:j,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error",children:i}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Code"}),e.jsx("input",{className:"input",value:h.customer_code||"",onChange:S=>y("customer_code",S.target.value),placeholder:"Auto-generated if empty"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Name *"}),e.jsx("input",{className:"input",value:h.customer_name||"",onChange:S=>y("customer_name",S.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Type"}),e.jsxs("select",{className:"input",value:h.customer_type||"Individual",onChange:S=>y("customer_type",S.target.value),children:[e.jsx("option",{value:"Individual",children:"Individual"}),e.jsx("option",{value:"Business",children:"Business"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Person"}),e.jsx("input",{className:"input",value:h.contact_person||"",onChange:S=>y("contact_person",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:h.email||"",onChange:S=>y("email",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{className:"input",value:h.phone||"",onChange:S=>y("phone",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Mobile"}),e.jsx("input",{className:"input",value:h.mobile||"",onChange:S=>y("mobile",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Credit Limit"}),e.jsx("input",{className:"input",type:"number",value:h.credit_limit||"",onChange:S=>y("credit_limit",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsxs("select",{className:"input",value:h.payment_terms||"Net 30",onChange:S=>y("payment_terms",S.target.value),children:[e.jsx("option",{value:"Immediate",children:"Immediate"}),e.jsx("option",{value:"Net 15",children:"Net 15"}),e.jsx("option",{value:"Net 30",children:"Net 30"}),e.jsx("option",{value:"Net 45",children:"Net 45"}),e.jsx("option",{value:"Net 60",children:"Net 60"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:h.is_active?"1":"0",onChange:S=>y("is_active",S.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Address"}),e.jsx("textarea",{className:"input",rows:"3",value:h.address||"",onChange:S=>y("address",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:h.city||"",onChange:S=>y("city",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:h.state||"",onChange:S=>y("state",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Zone"}),e.jsx("input",{className:"input",value:h.zone||"",onChange:S=>y("zone",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Country"}),e.jsx("input",{className:"input",value:h.country||"",onChange:S=>y("country",S.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsxs("select",{className:"input",value:h.price_type_id||"",onChange:S=>y("price_type_id",S.target.value),children:[e.jsx("option",{value:"",children:"-- Select Price Type --"}),o.map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:h.currency_id||"",onChange:S=>y("currency_id",S.target.value),children:[e.jsx("option",{value:"",children:"-- Select Currency --"}),d.map(S=>e.jsx("option",{value:S.id,children:(S.code||S.currency_code)+" - "+(S.name||S.currency_name||"")},S.id))]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(Le,{to:"/sales/customers",className:"btn btn-secondary",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save Customer"})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900 rounded-lg p-6 border border-slate-200 dark:border-slate-700 sticky top-4",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 border-b border-slate-200 dark:border-slate-700 pb-2",children:"Customer Preview"}),!h.customer_code&&!h.customer_name?e.jsxs("div",{className:"text-center py-10 text-slate-400",children:[e.jsx("div",{className:"text-5xl mb-3",children:""}),e.jsx("p",{children:"Fill in the form to preview customer details"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Customer Code"}),e.jsx("div",{className:"font-mono text-brand-600 font-medium",children:h.customer_code||"(Auto-generated)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Customer Name"}),e.jsx("div",{className:"text-lg font-bold",children:h.customer_name}),h.customer_type&&e.jsx("span",{className:"inline-block bg-slate-200 dark:bg-slate-700 text-xs px-2 py-0.5 rounded mt-1",children:h.customer_type})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Contact"}),e.jsx("div",{className:"text-sm",children:h.contact_person||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Phone"}),e.jsx("div",{className:"text-sm",children:h.phone||"-"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Email"}),e.jsx("div",{className:"text-sm break-all text-brand-500",children:h.email||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Credit Limit"}),e.jsx("div",{className:"font-medium text-green-600",children:h.credit_limit?`${Number(h.credit_limit).toLocaleString()}`:"0.00"})]}),h.address&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Address"}),e.jsx("div",{className:"text-sm whitespace-pre-wrap",children:h.address})]}),(h.city||h.state||h.country||h.zone)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Location"}),e.jsxs("div",{className:"text-sm",children:[[h.city,h.state,h.country].filter(Boolean).join(", "),h.zone&&e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Zone: ",h.zone]})]})]}),h.price_type_id&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wider block",children:"Price Type"}),e.jsx("div",{className:"text-sm",children:((N=o.find(S=>String(S.id)===String(h.price_type_id)))==null?void 0:N.name)||h.price_type_id})]})]})]})})]})]})})})]})}function lY(){const[t,s]=x.useState("");return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Bulk Customer Upload"}),e.jsx("p",{className:"text-sm mt-1",children:"Upload customers in bulk (placeholder)"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"CSV File"}),e.jsx("input",{className:"input",type:"file",accept:".csv",onChange:r=>{var a,n;return s(((n=(a=r.target.files)==null?void 0:a[0])==null?void 0:n.name)||"")}}),t?e.jsxs("div",{className:"text-sm mt-2",children:["Selected: ",t]}):null]}),e.jsx("div",{className:"text-sm",children:"Expected columns: customer_code, customer_name, email, phone, address"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>window.alert("Upload processing will be implemented in Sales module backend."),children:"Upload"})]})})]})}function oY(){const t=[{title:"Sales by Customer",description:"Sales totals grouped by customer (placeholder)"},{title:"Invoice Aging",description:"Outstanding invoices aging buckets (placeholder)"},{title:"Discount Analysis",description:"Discount usage summary (placeholder)"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Analytics and reports"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function UB(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState([]);x.useEffect(()=>{let c=!0;return a(!0),i(""),ee.get("/sales/returns").then(h=>{var A;c&&o(Array.isArray((A=h.data)==null?void 0:A.items)?h.data.items:[])}).catch(h=>{var A,f;c&&i(((f=(A=h==null?void 0:h.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load sales returns")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=x.useMemo(()=>{const c=t.toLowerCase();return l.filter(h=>{const A=String(h.return_no||"").toLowerCase(),f=String(h.customer_name||"").toLowerCase(),g=String(h.invoice_id||"").toLowerCase();return A.includes(c)||f.includes(c)||g.includes(c)})},[l,t]),d=x.useMemo(()=>{const c=l.length,h=l.filter(g=>g.status==="PENDING").length,A=l.filter(g=>g.status==="APPROVED").length,f=l.filter(g=>g.status==="DRAFT").length;return{total:c,pending:h,approved:A,draft:f}},[l]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{children:""})," Sales Returns"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Process customer returns and track status"})]}),e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Total Returns"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:d.total})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Draft"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:d.draft})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Pending"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:d.pending})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Approved"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:d.approved})]})]}),e.jsx("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"input pl-10",placeholder:"Search by return no, customer, or invoice",value:t,onChange:c=>s(c.target.value)}),e.jsx(L0,{className:"w-5 h-5 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2"})]})})}),n&&e.jsx("div",{className:"alert alert-error mb-4",children:n}),r?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading sales returns..."})]}):u.length===0?e.jsx("div",{className:"text-center py-12 text-slate-600",children:"No sales returns found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Return No"}),e.jsx("th",{children:"Return Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:u.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:c.return_no}),e.jsx("td",{children:c.return_date?new Date(c.return_date).toLocaleDateString():"-"}),e.jsx("td",{children:c.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(c.total_amount||0).toFixed(2)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c.status==="APPROVED"?"badge-success":c.status==="PENDING"?"badge-warning":c.status==="CANCELLED"?"badge-error":"badge-info"}`,children:c.status||"DRAFT"})})]},c.id))})]})})]})]})})}function cY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/sales/reports/sales-return",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["Date","Return No","Customer","Item","Quantity","Amount"],f=(Array.isArray(n)?n:[]).map(j=>[j.return_date?new Date(j.return_date).toLocaleDateString():"-",j.return_no||"-",j.customer_name||"-",j.item_name||j.item_code||"-",Number(j.qty||0).toFixed(2),Number(j.amount||0).toFixed(2)]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="sales_return.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({date:v.return_date?new Date(v.return_date).toLocaleDateString():"-",return_no:v.return_no||"-",customer:v.customer_name||"-",item:v.item_name||v.item_code||"-",quantity:Number(v.qty||0),amount:Number(v.amount||0)})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"SalesReturn"),xr(g,"sales-return.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Sales Return Report",10,f),f+=8,A.setFontSize(10);const g=["Date","Return No","Customer","Item","Qty","Amount"];A.text(g[0],10,f),A.text(g[1],35,f),A.text(g[2],70,f),A.text(g[3],120,f),A.text(g[4],160,f),A.text(g[5],190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=v.return_date?new Date(v.return_date).toLocaleDateString():"-",y=String(v.return_no||"-"),j=String(v.customer_name||"-"),N=String(v.item_name||v.item_code||"-"),S=Number(v.qty||0).toFixed(2),B=Number(v.amount||0).toFixed(2);A.text(b,10,f),A.text(y,35,f),A.text(j.slice(0,40),70,f),A.text(N.slice(0,35),120,f),A.text(S,160,f),A.text(B,190,f,{align:"right"}),f+=5}),A.save("sales-return.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Return Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Returned items and amounts within period"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Return No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:n.map((A,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:A.return_date?new Date(A.return_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:A.return_no||"-"}),e.jsx("td",{children:A.customer_name||"-"}),e.jsx("td",{children:A.item_name||A.item_code}),e.jsx("td",{className:"text-right",children:Number(A.qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A.amount||0).toLocaleString()})]},A.id||f))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function dY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/sales/reports/sales-register",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["Date","Invoice No","Customer","Items","Amount","Status"],f=(Array.isArray(n)?n:[]).map(j=>[j.invoice_date?new Date(j.invoice_date).toLocaleDateString():"-",j.invoice_no||"-",j.customer_name||"-",Number(j.items_count||0).toString(),Number(j.total_amount||0).toFixed(2),j.status||"-"]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="sales_register.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({date:v.invoice_date?new Date(v.invoice_date).toLocaleDateString():"-",invoice_no:v.invoice_no||"-",customer:v.customer_name||"-",items:Number(v.items_count||0),amount:Number(v.total_amount||0),status:v.status||"-"})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"SalesRegister"),xr(g,"sales-register.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Sales Register",10,f),f+=8,A.setFontSize(10);const g=["Date","Invoice No","Customer","Items","Amount","Status"];A.text(g[0],10,f),A.text(g[1],35,f),A.text(g[2],75,f),A.text(g[3],130,f),A.text(g[4],160,f),A.text(g[5],190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=v.invoice_date?new Date(v.invoice_date).toLocaleDateString():"-",y=String(v.invoice_no||"-"),j=String(v.customer_name||"-"),N=String(Number(v.items_count||0)),S=Number(v.total_amount||0).toFixed(2),B=String(v.status||"-");A.text(b,10,f),A.text(y,35,f),A.text(j.slice(0,45),75,f),A.text(N,130,f),A.text(S,160,f),A.text(B,190,f,{align:"right"}),f+=5}),A.save("sales-register.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Invoices and totals within the period"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Items"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(A=>e.jsxs("tr",{children:[e.jsx("td",{children:A.invoice_date?new Date(A.invoice_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:A.invoice_no||"-"}),e.jsx("td",{children:A.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(A.items_count||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A.total_amount||0).toLocaleString()}),e.jsx("td",{children:A.status||"-"})]},A.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function uY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/sales/reports/delivery-register",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["Date","Delivery No","Customer","Item","Quantity"],f=(Array.isArray(n)?n:[]).map(j=>[j.delivery_date?new Date(j.delivery_date).toLocaleDateString():"-",j.delivery_no||"-",j.customer_name||"-",j.item_name||j.item_code||"-",Number(j.qty||0).toFixed(2)]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="delivery_register.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({date:v.delivery_date?new Date(v.delivery_date).toLocaleDateString():"-",delivery_no:v.delivery_no||"-",customer:v.customer_name||"-",item:v.item_name||v.item_code||"-",quantity:Number(v.qty||0)})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"DeliveryRegister"),xr(g,"delivery-register.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Delivery Register",10,f),f+=8,A.setFontSize(10);const g=["Date","Delivery No","Customer","Item","Qty"];A.text(g[0],10,f),A.text(g[1],40,f),A.text(g[2],80,f),A.text(g[3],130,f),A.text(g[4],190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=v.delivery_date?new Date(v.delivery_date).toLocaleDateString():"-",y=String(v.delivery_no||"-"),j=String(v.customer_name||"-"),N=String(v.item_name||v.item_code||"-"),S=Number(v.qty||0).toFixed(2);A.text(b,10,f),A.text(y,40,f),A.text(j.slice(0,45),80,f),A.text(N.slice(0,40),130,f),A.text(S,190,f,{align:"right"}),f+=5}),A.save("delivery-register.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Delivery Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Deliveries and quantities within the period"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Delivery No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"})]})}),e.jsx("tbody",{children:n.map(A=>e.jsxs("tr",{children:[e.jsx("td",{children:A.delivery_date?new Date(A.delivery_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:A.delivery_no||"-"}),e.jsx("td",{children:A.customer_name||"-"}),e.jsx("td",{children:A.item_name||A.item_code}),e.jsx("td",{className:"text-right",children:Number(A.qty||0).toLocaleString()})]},A.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function AY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),l=x.useMemo(()=>{const h=r.reduce((v,b)=>v+Number(b.opening||0),0),A=r.reduce((v,b)=>v+Number(b.invoiced||0),0),f=r.reduce((v,b)=>v+Number(b.received||0),0),g=r.reduce((v,b)=>v+Number(b.outstanding||0),0);return{opening:h,invoiced:A,received:f,outstanding:g}},[r]);async function o(){var h,A,f;try{i(!0);const g=await ee.get("/sales/reports/debtors-balance",{params:{asOf:t||null}});a(((h=g.data)==null?void 0:h.items)||[])}catch(g){nt.error(((f=(A=g==null?void 0:g.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load report")}finally{i(!1)}}function u(){const h=["Customer","Opening","Invoiced","Received","Outstanding"],A=(Array.isArray(r)?r:[]).map(y=>[y.customer_name||"-",Number(y.opening||0).toFixed(2),Number(y.invoiced||0).toFixed(2),Number(y.received||0).toFixed(2),Number(y.outstanding||0).toFixed(2)]),f=[h.join(","),...A.map(y=>y.join(","))].join(`
`),g=new Blob([f],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(g),b=document.createElement("a");b.href=v,b.download="debtors_balance.csv",b.click(),URL.revokeObjectURL(v)}function d(){const h=(Array.isArray(r)?r:[]).map(g=>({customer:g.customer_name||"-",opening:Number(g.opening||0),invoiced:Number(g.invoiced||0),received:Number(g.received||0),outstanding:Number(g.outstanding||0)})),A=is.json_to_sheet(h),f=is.book_new();is.book_append_sheet(f,A,"DebtorsBalance"),xr(f,"debtors-balance.xlsx")}function c(){const h=new ds("p","mm","a4");let A=15;h.setFontSize(14),h.text("Debtors Balance",10,A),A+=8,h.setFontSize(10);const f=["Customer","Opening","Invoiced","Received","Outstanding"];h.text(f[0],10,A),h.text(f[1],80,A),h.text(f[2],110,A),h.text(f[3],140,A),h.text(f[4],190,A,{align:"right"}),A+=4,h.line(10,A,200,A),A+=5,(Array.isArray(r)?r:[]).forEach(g=>{A>270&&(h.addPage(),A=15);const v=String(g.customer_name||"-"),b=Number(g.opening||0).toFixed(2),y=Number(g.invoiced||0).toFixed(2),j=Number(g.received||0).toFixed(2),N=Number(g.outstanding||0).toFixed(2);h.text(v.slice(0,60),10,A),h.text(b,80,A),h.text(y,110,A),h.text(j,140,A),h.text(N,190,A,{align:"right"}),A+=5}),h.save("debtors-balance.pdf")}return x.useEffect(()=>{o()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Debtors Balance"}),e.jsx("p",{className:"text-sm mt-1",children:"Customer balances as of a date"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:n||r.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:d,disabled:n||r.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:c,disabled:n||r.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:o,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Opening"}),e.jsx("th",{className:"text-right",children:"Invoiced"}),e.jsx("th",{className:"text-right",children:"Received"}),e.jsx("th",{className:"text-right",children:"Outstanding"})]})}),e.jsx("tbody",{children:r.map((h,A)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(h.opening||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.invoiced||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.received||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.outstanding||0).toLocaleString()})]},h.id||A))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"text-right font-medium",children:"Totals"}),e.jsx("td",{className:"text-right font-medium",children:l.opening.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:l.invoiced.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:l.received.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:l.outstanding.toLocaleString()})]})})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function hY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/sales/reports/sales-profitability",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["Date","Invoice No","Customer","Net Sales","Cost","Gross Margin","Margin %"],f=(Array.isArray(n)?n:[]).map(j=>{const N=Number(j.net_sales||0)-Number(j.cost||0),S=Number(j.net_sales||0)?N/Number(j.net_sales||0)*100:0;return[j.invoice_date?new Date(j.invoice_date).toLocaleDateString():"-",j.invoice_no||"-",j.customer_name||"-",Number(j.net_sales||0).toFixed(2),Number(j.cost||0).toFixed(2),Number(N||0).toFixed(2),S.toFixed(2)]}),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="sales_profitability.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>{const b=Number(v.net_sales||0)-Number(v.cost||0),y=Number(v.net_sales||0)?b/Number(v.net_sales||0)*100:0;return{date:v.invoice_date?new Date(v.invoice_date).toLocaleDateString():"-",invoice_no:v.invoice_no||"-",customer:v.customer_name||"-",net_sales:Number(v.net_sales||0),cost:Number(v.cost||0),gross_margin:Number(b||0),margin_pct:Number(y.toFixed(2))}}),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"SalesProfitability"),xr(g,"sales-profitability.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Sales Profitability",10,f),f+=8,A.setFontSize(10);const g=["Date","Invoice No","Customer","Net Sales","Cost","Gross Margin","Margin %"];A.text(g[0],10,f),A.text(g[1],35,f),A.text(g[2],75,f),A.text(g[3],120,f),A.text(g[4],145,f),A.text(g[5],165,f),A.text(g[6],190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=Number(v.net_sales||0)-Number(v.cost||0),y=Number(v.net_sales||0)?b/Number(v.net_sales||0)*100:0,j=v.invoice_date?new Date(v.invoice_date).toLocaleDateString():"-",N=String(v.invoice_no||"-"),S=String(v.customer_name||"-"),B=Number(v.net_sales||0).toFixed(2),P=Number(v.cost||0).toFixed(2),L=Number(b||0).toFixed(2),U=y.toFixed(2);A.text(j,10,f),A.text(N,35,f),A.text(S.slice(0,40),75,f),A.text(B,120,f),A.text(P,145,f),A.text(L,165,f),A.text(U,190,f,{align:"right"}),f+=5}),A.save("sales-profitability.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Profitability"}),e.jsx("p",{className:"text-sm mt-1",children:"Net sales vs cost with margins"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Net Sales"}),e.jsx("th",{className:"text-right",children:"Cost"}),e.jsx("th",{className:"text-right",children:"Gross Margin"}),e.jsx("th",{className:"text-right",children:"Margin %"})]})}),e.jsx("tbody",{children:n.map(A=>{const f=Number(A.net_sales||0)-Number(A.cost||0),g=Number(A.net_sales||0)?f/Number(A.net_sales||0)*100:0;return e.jsxs("tr",{children:[e.jsx("td",{children:A.invoice_date?new Date(A.invoice_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:A.invoice_no||"-"}),e.jsx("td",{children:A.customer_name||"-"}),e.jsx("td",{className:"text-right",children:Number(A.net_sales||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A.cost||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(f||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:g.toFixed(2)})]},A.id)})})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function mY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/sales/reports/sales-tracking",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["Stage","Reference","Customer","Date","Status","Value"],f=(Array.isArray(n)?n:[]).map(j=>[j.stage||"-",j.ref_no||"-",j.customer_name||"-",j.txn_date?new Date(j.txn_date).toLocaleDateString():"-",j.status||"-",Number(j.total_value||0).toFixed(2)]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="sales_tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({stage:v.stage||"-",reference:v.ref_no||"-",customer:v.customer_name||"-",date:v.txn_date?new Date(v.txn_date).toLocaleDateString():"-",status:v.status||"-",value:Number(v.total_value||0)})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"SalesTracking"),xr(g,"sales-tracking.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Sales Tracking",10,f),f+=8,A.setFontSize(10);const g=["Stage","Reference","Customer","Date","Status","Value"];A.text(g[0],10,f),A.text(g[1],45,f),A.text(g[2],90,f),A.text(g[3],130,f),A.text(g[4],160,f),A.text(g[5],190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=String(v.stage||"-"),y=String(v.ref_no||"-"),j=String(v.customer_name||"-"),N=v.txn_date?new Date(v.txn_date).toLocaleDateString():"-",S=String(v.status||"-"),B=Number(v.total_value||0).toFixed(2);A.text(b.slice(0,25),10,f),A.text(y.slice(0,30),45,f),A.text(j.slice(0,35),90,f),A.text(N,130,f),A.text(S,160,f),A.text(B,190,f,{align:"right"}),f+=5}),A.save("sales-tracking.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Sales Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Tracking across quotations, orders, deliveries, invoices"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/sales",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Stage"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map((A,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:A.stage||"-"}),e.jsx("td",{className:"font-medium",children:A.ref_no||"-"}),e.jsx("td",{children:A.customer_name||"-"}),e.jsx("td",{children:A.txn_date?new Date(A.txn_date).toLocaleDateString():"-"}),e.jsx("td",{children:A.status||"-"}),e.jsx("td",{className:"text-right",children:Number(A.total_value||0).toLocaleString()})]},A.id||f))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}const fY=()=>{const[t,s]=Ts.useState([{icon:"",value:"GHS 5.2M",label:"Total Sales (YTD)",change:" 21.5% from last year",changeType:"positive",path:"/sales/reports"},{icon:"",value:"45",label:"Open Orders",change:"5 new today",changeType:"positive",path:"/sales/sales-orders"},{icon:"",value:"12",label:"Pending Deliveries",change:"2 delayed",changeType:"negative",path:"/sales/delivery"}]);Ts.useEffect(()=>{let n=!0;async function i(){var l,o,u,d,c,h,A,f,g;try{const v=await ee.get("/bi/dashboards"),b=Number(((u=(o=(l=v==null?void 0:v.data)==null?void 0:l.summary)==null?void 0:o.sales)==null?void 0:u.total)||0),y=Number(((h=(c=(d=v==null?void 0:v.data)==null?void 0:d.summary)==null?void 0:c.sales)==null?void 0:h.open_orders)||0),j=Number(((g=(f=(A=v==null?void 0:v.data)==null?void 0:A.summary)==null?void 0:f.sales)==null?void 0:g.pending_deliveries)||0);n&&s(N=>{const S=[...N];return S[0]={...S[0],value:`GHS ${Number(b).toLocaleString()}`,label:"Total Sales (Last 30 Days)"},S[1]={...S[1],value:String(y)},S[2]={...S[2],value:String(j)},S})}catch{}}return i(),()=>{n=!1}},[]);const r=[{title:"Sales Transactions",badge:"Operations",items:[{title:"Quotations",path:"/sales/quotations",description:"Create and manage customer quotations",icon:"",actions:[{label:"View",path:"/sales/quotations",type:"outline"},{label:"New",path:"/sales/quotations/new",type:"primary"}]},{title:"Sales Orders",path:"/sales/sales-orders",description:"Process customer orders and track fulfillment",icon:"",actions:[{label:"View",path:"/sales/sales-orders",type:"outline"},{label:"New",path:"/sales/sales-orders/new",type:"primary"}]},{title:"Invoices",path:"/sales/invoices",description:"Generate and manage sales invoices",icon:"",actions:[{label:"View",path:"/sales/invoices",type:"outline"},{label:"New",path:"/sales/invoices/new",type:"primary"}]},{title:"Delivery Notes",path:"/sales/delivery",description:"Track product deliveries to customers",icon:"",actions:[{label:"View",path:"/sales/delivery",type:"outline"},{label:"New",path:"/sales/delivery/new",type:"primary"}]}]},{title:"Pricing & Discounts",badge:"Configuration",items:[{title:"Price Setup",path:"/sales/price-setup",description:"Manage standard and customer pricing",icon:"",actions:[{label:"Manage",path:"/sales/price-setup",type:"primary"}]},{title:"Discount Schemes",path:"/sales/discount-schemes",description:"Configure discount rules and promotions",icon:"",actions:[{label:"Manage",path:"/sales/discount-schemes",type:"primary"}]}]},{title:"Customer Management",items:[{title:"Customer Setup",path:"/sales/customers",description:"Manage customer information",icon:"",actions:[{label:"View",path:"/sales/customers",type:"outline"},{label:"Add",path:"/sales/customers/new",type:"primary"}]}]},{title:"Analytics & Reports",items:[{title:"Sales Reports",path:"/sales/reports",description:"View sales analytics and reports",icon:"",actions:[{label:"View Reports",path:"/sales/reports",type:"primary"}]},{title:"Sales Register",path:"/sales/reports/sales-register",description:"Invoices within the selected period",icon:""},{title:"Delivery Register",path:"/sales/reports/delivery-register",description:"Deliveries made to customers",icon:""},{title:"Sales Return Report",path:"/sales/reports/sales-return",description:"Items returned by customers",icon:""},{title:"Debtors Balance",path:"/sales/reports/debtors-balance",description:"Customer balances and outstanding",icon:""},{title:"Sales Profitability",path:"/sales/reports/sales-profitability",description:"Margins and profitability by invoice",icon:""},{title:"Sales Tracking",path:"/sales/reports/sales-tracking",description:"Track quotations  orders  deliveries  invoices",icon:""}]}],{hasModuleAccess:a}=ca();return a("Sales")?e.jsx(Gl,{title:"Sales Module",description:"Customer orders, quotations, invoicing, and sales analytics",stats:t,sections:r}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-center text-slate-600",children:"You do not have access to the Sales module."})})})})};function pY(){const{hasAccess:t}=ca(),s=()=>e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-center text-slate-600",children:"You do not have permission to view this page."})})})});return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(fY,{})}),e.jsx(Je,{path:"/quotations",element:t("/sales/quotations","view")?e.jsx(YO,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/quotations/new",element:t("/sales/quotations/new","create")?e.jsx(P2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/quotations/:id",element:t("/sales/quotations/:id","edit")?e.jsx(P2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/sales-orders",element:t("/sales/sales-orders","view")?e.jsx(XO,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/sales-orders/new",element:t("/sales/sales-orders/new","create")?e.jsx(R2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/sales-orders/:id",element:t("/sales/sales-orders/:id","edit")?e.jsx(R2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/invoices",element:t("/sales/invoices","view")?e.jsx(JO,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/invoices/new",element:t("/sales/invoices/new","create")?e.jsx(O2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/invoices/:id",element:t("/sales/invoices/:id","edit")?e.jsx(O2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"delivery",element:t("/sales/delivery","view")?e.jsx(tQ,{}):e.jsx(s,{})}),e.jsx(Je,{path:"delivery/new",element:t("/sales/delivery/new","create")?e.jsx(M2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"delivery/:id",element:t("/sales/delivery/:id","edit")?e.jsx(M2,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/price-setup",element:t("/sales/price-setup","view")?e.jsx(sY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/discount-schemes",element:t("/sales/discount-schemes","view")?e.jsx(rY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/customer-credit",element:t("/sales/customer-credit","view")?e.jsx(aY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/customer-credit/:id",element:t("/sales/customer-credit/:id","edit")?e.jsx(nY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/customers",element:t("/sales/customers","view")?e.jsx(iY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/customers/new",element:t("/sales/customers/new","create")?e.jsx(X_,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/customers/:id",element:t("/sales/customers/:id","edit")?e.jsx(X_,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/bulk-upload",element:t("/sales/bulk-upload","view")?e.jsx(lY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports",element:t("/sales/reports","view")?e.jsx(oY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports/sales-return",element:t("/sales/reports/sales-return","view")?e.jsx(cY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports/sales-register",element:t("/sales/reports/sales-register","view")?e.jsx(dY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports/delivery-register",element:t("/sales/reports/delivery-register","view")?e.jsx(uY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports/debtors-balance",element:t("/sales/reports/debtors-balance","view")?e.jsx(AY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports/sales-profitability",element:t("/sales/reports/sales-profitability","view")?e.jsx(hY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/reports/sales-tracking",element:t("/sales/reports/sales-tracking","view")?e.jsx(mY,{}):e.jsx(s,{})}),e.jsx(Je,{path:"/returns",element:t("/sales/returns","view")?e.jsx(UB,{}):e.jsx(s,{})})]})}function xY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState(!1),[c,h]=x.useState(null),[A,f]=x.useState(!1),[g,v]=x.useState(""),[b,y]=x.useState(null),[j,N]=x.useState(null),[S,B]=x.useState([]),[P,L]=x.useState(!1),[U,H]=x.useState(null),[q,V]=x.useState(null);x.useEffect(()=>{let k=!0;return i(!0),o(""),ee.get("/inventory/stock-adjustments").then(D=>{var Q;k&&a(Array.isArray((Q=D.data)==null?void 0:Q.items)?D.data.items:[])}).catch(D=>{var Q,C;k&&o(((C=(Q=D==null?void 0:D.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load stock adjustments")}).finally(()=>{k&&i(!1)}),()=>{k=!1}},[]);const M=k=>({DRAFT:"badge-info",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-success",POSTED:"badge-success",REJECTED:"badge-error",CANCELLED:"badge-error",RETURNED:"badge-error"})[k]||"badge-info",z=x.useMemo(()=>r.filter(k=>String(k.adjustment_no||"").toLowerCase().includes(t.toLowerCase())),[r,t]),I=k=>{if(!k)return"";let D=new Date(k);return isNaN(D.getTime())&&(isNaN(Number(k))||(D=new Date(Number(k)))),isNaN(D.getTime())?String(k):D.toLocaleDateString()},G=async k=>{var D,Q,C;if(h(k),d(!0),v(""),U)await Y();else try{f(!0);const E=await ee.get("/workflows"),w=Array.isArray((D=E.data)==null?void 0:D.items)?E.data.items:[];H(w),await J(w)}catch(E){v(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load workflows")}finally{f(!1)}},Y=async()=>{var C,E,w;if(!U||!U.length){y(null),N(null),v("");return}const k="/inventory/stock-adjustments",D=O=>String(O||"").trim().toUpperCase().replace(/\s+/g,"_"),Q=U.find(O=>Number(O.is_active)===1&&String(O.document_route)===k)||U.find(O=>Number(O.is_active)===1&&D(O.document_type)==="STOCK_ADJUSTMENT")||null;if(y(Q||null),N(null),!!Q)try{f(!0);const R=(C=(await ee.get(`/workflows/${Q.id}`)).data)==null?void 0:C.item,X=Array.isArray(R==null?void 0:R.steps)?R.steps:[];B(X);const ne=X[0]||null;if(N(ne?{userId:ne.approver_user_id,name:ne.approver_name,stepName:ne.step_name,stepOrder:ne.step_order,approvalLimit:ne.approval_limit}:null),ne){const te=(Array.isArray(ne.approvers)&&ne.approvers.length?ne.approvers[0].id:ne.approver_user_id)||null;V(te)}else V(null)}catch(O){v(((w=(E=O==null?void 0:O.response)==null?void 0:E.data)==null?void 0:w.message)||"Failed to load workflow details")}finally{f(!1)}},J=async k=>{var E,w,O;if(!k||!k.length){y(null),N(null),v("");return}const D="/inventory/stock-adjustments",Q=R=>String(R||"").trim().toUpperCase().replace(/\s+/g,"_"),C=k.find(R=>Number(R.is_active)===1&&String(R.document_route)===D)||k.find(R=>Number(R.is_active)===1&&Q(R.document_type)==="STOCK_ADJUSTMENT")||null;if(y(C||null),N(null),!!C)try{f(!0);const X=(E=(await ee.get(`/workflows/${C.id}`)).data)==null?void 0:E.item,ne=Array.isArray(X==null?void 0:X.steps)?X.steps:[];B(ne);const te=ne[0]||null;N(te?{userId:te.approver_user_id,name:te.approver_name,stepName:te.step_name,stepOrder:te.step_order,approvalLimit:te.approval_limit}:null)}catch(R){v(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load workflow details")}finally{f(!1)}},T=async()=>{var k,D,Q;if(c){L(!0),v("");try{const C=await ee.post(`/inventory/stock-adjustments/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:q||null}),E=((k=C==null?void 0:C.data)==null?void 0:k.status)||"PENDING_APPROVAL";a(w=>w.map(O=>O.id===c.id?{...O,status:E}:O)),d(!1),h(null)}catch(C){v(((Q=(D=C==null?void 0:C.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to forward for approval")}finally{L(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Stock Adjustments"}),e.jsx("p",{className:"text-sm mt-1",children:"Adjust stock quantities for corrections and reconciliation"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/stock-adjustments/new",className:"btn-success",children:"+ New Adjustment"})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by adjustment number...",className:"input max-w-md",value:t,onChange:k=>s(k.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Adjustment No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:l})}):null,z.map(k=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:k.adjustment_no}),e.jsx("td",{children:I(k.adjustment_date)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${k.adjustment_type==="INCREASE"?"badge-success":"badge-warning"}`,children:k.adjustment_type})}),e.jsx("td",{children:k.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${M(k.status)} `,children:k.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Le,{to:`/inventory/stock-adjustments/${k.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/stock-adjustments/${k.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),k.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):k.status==="DRAFT"||k.status==="RETURNED"?e.jsx("button",{type:"button",onClick:()=>G(k),className:"text-sm font-medium px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:"Forward"}):null]})})]},k.id))]})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),h(null),y(null),N(null),v("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.adjustment_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[A?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const D=Array.isArray(S)&&S.length>0?S[0]:null,Q=D?Array.isArray(D.approvers)&&D.approvers.length?D.approvers.map(C=>({id:C.id,name:C.username})):D.approver_user_id?[{id:D.approver_user_id,name:D.approver_name||String(D.approver_user_id)}]:[]:[];return Q.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:q||"",onChange:C=>V(C.target.value?Number(C.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Q.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:j?`Step ${j.stepOrder}  ${j.stepName}${j.approvalLimit!=null?`  Limit: ${Number(j.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),h(null),y(null),N(null),v("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:T,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function J_(){const{uoms:t,loading:s}=el(),{id:r}=Ls(),a=ys(),n=!r||r==="new",[i]=Ef(),l=(i.get("mode")||"").toLowerCase(),o=!n&&l==="view",[u,d]=x.useState(!1),[c,h]=x.useState(!1),[A,f]=x.useState(""),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState({adjustmentNo:"",adjustmentDate:new Date().toISOString().split("T")[0],warehouseId:"",adjustmentType:"PHYSICAL_COUNT",referenceDoc:"",reason:"",status:"DRAFT"}),[S,B]=x.useState([]),[P,L]=x.useState([]),[U,H]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),q=x.useMemo(()=>{const T=Array.isArray(t)?t:[],k=T.find(D=>String(D.uom_code||"").toUpperCase()==="PCS")||T[0];return k&&k.uom_code?k.uom_code:"PCS"},[t]);x.useMemo(()=>{const T=new Map;for(const k of Array.isArray(P)?P:[]){if(!Number(k.is_active))continue;const D=`${k.item_id}|${k.from_uom}|${k.to_uom}`,Q=Number(k.conversion_factor||0);Number.isFinite(Q)&&Q>0&&T.set(D,Q)}return T},[P]),x.useEffect(()=>{let T=!0;return Promise.all([ee.get("/inventory/items"),ee.get("/inventory/warehouses"),ee.get("/inventory/unit-conversions")]).then(([k,D,Q])=>{var C,E,w;T&&(v(Array.isArray((C=k.data)==null?void 0:C.items)?k.data.items:[]),y(Array.isArray((E=D.data)==null?void 0:E.items)?D.data.items:[]),L(Array.isArray((w=Q.data)==null?void 0:w.items)?Q.data.items:[]))}).catch(k=>{var D,Q;T&&f(((Q=(D=k==null?void 0:k.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to load lookups")}),()=>{T=!1}},[]),x.useEffect(()=>{n&&ee.get("/inventory/stock-adjustments/next-no").then(T=>{var k;(k=T.data)!=null&&k.next_no&&N(D=>({...D,adjustmentNo:T.data.next_no}))}).catch(()=>{})},[n]),x.useEffect(()=>{if(n){B([{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}]);return}let T=!0;return d(!0),f(""),ee.get(`/inventory/stock-adjustments/${r}`).then(k=>{var C,E;if(!T)return;const D=(C=k.data)==null?void 0:C.item,Q=Array.isArray((E=k.data)==null?void 0:E.details)?k.data.details:[];D&&(N({adjustmentNo:D.adjustment_no||"",adjustmentDate:D.adjustment_date?new Date(D.adjustment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],warehouseId:D.warehouse_id?String(D.warehouse_id):"",adjustmentType:D.adjustment_type||"PHYSICAL_COUNT",referenceDoc:D.reference_doc||"",reason:D.reason||"",status:D.status||"DRAFT"}),B(Q.length?Q.map(w=>({id:w.id||Date.now()+Math.random(),item_id:w.item_id?String(w.item_id):"",itemCode:w.item_code||"",itemName:w.item_name||"",currentStock:Number(w.current_stock)||0,adjustedStock:Number(w.adjusted_stock)||0,uom:"PCS",unitCost:Number(w.unit_cost)||0,remarks:w.remarks||""})):[]))}).catch(k=>{var D,Q;T&&f(((Q=(D=k==null?void 0:k.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to load stock adjustment")}).finally(()=>{T&&d(!1)}),()=>{T=!1}},[r,n]);const V=x.useMemo(()=>S.filter(T=>T.item_id).map(T=>({item_id:Number(T.item_id),current_stock:Number(T.currentStock)||0,adjusted_stock:Number(T.adjustedStock)||0,qty:Number(T.adjustedStock)-Number(T.currentStock),unit_cost:Number(T.unitCost)||0,remarks:T.remarks})),[S]),M=async T=>{var k,D;T.preventDefault(),h(!0),f("");try{const Q={adjustment_no:j.adjustmentNo||void 0,adjustment_date:j.adjustmentDate,warehouse_id:j.warehouseId?Number(j.warehouseId):null,adjustment_type:j.adjustmentType,reference_doc:j.referenceDoc,reason:j.reason,status:j.status,details:V};n?await ee.post("/inventory/stock-adjustments",Q):await ee.put(`/inventory/stock-adjustments/${r}`,Q),a("/inventory/stock-adjustments")}catch(Q){f(((D=(k=Q==null?void 0:Q.response)==null?void 0:k.data)==null?void 0:D.message)||"Failed to save stock adjustment")}finally{h(!1)}},z=()=>{B([...S,{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}])},I=T=>{B(S.filter(k=>k.id!==T))},G=(T,k,D)=>{B(S.map(Q=>{if(Q.id===T){const C={...Q,[k]:D};if(k==="item_id"){const E=g.find(w=>String(w.id)===String(D));C.itemCode=(E==null?void 0:E.item_code)||"",C.itemName=(E==null?void 0:E.item_name)||"",C.unitCost=(E==null?void 0:E.cost_price)||0}return C}return Q}))},Y=T=>{N(k=>({...k,reason:T}))},J=T=>{const k="border-2 rounded-lg p-4 cursor-pointer transition-all text-center hover:shadow-md",D=j.adjustmentType===T?" ring-2 ring-brand-500 bg-brand-50 border-brand-500":" border-slate-200 bg-white";return T==="INCREASE"?`${k} ${D} ${j.adjustmentType===T?"border-green-500 ring-green-500 bg-green-50":"hover:border-green-200"}`:T==="DECREASE"?`${k} ${D} ${j.adjustmentType===T?"border-red-500 ring-red-500 bg-red-50":"hover:border-red-200"}`:`${k} ${D}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:n?"New Stock Adjustment":o?"View Stock Adjustment":"Edit Stock Adjustment"}),e.jsx("p",{className:"text-sm mt-1",children:"Adjust stock quantities for corrections"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:"/inventory/stock-adjustments",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:" Back to List"})})]})}),e.jsx("div",{className:"card-body p-6",children:e.jsxs("form",{onSubmit:M,className:"space-y-8",children:[u&&e.jsx("div",{className:"text-sm",children:"Loading..."}),A&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-md border border-red-200",children:A}),e.jsxs("fieldset",{disabled:o,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Select Adjustment Type"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:J("PHYSICAL_COUNT"),onClick:()=>N({...j,adjustmentType:"PHYSICAL_COUNT"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Physical Count"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Based on actual inventory count"})]}),e.jsxs("div",{className:J("INCREASE"),onClick:()=>N({...j,adjustmentType:"INCREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Increase"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Add stock (found, corrections)"})]}),e.jsxs("div",{className:J("DECREASE"),onClick:()=>N({...j,adjustmentType:"DECREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Decrease"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Reduce stock (damage, theft)"})]}),e.jsxs("div",{className:J("OTHER"),onClick:()=>N({...j,adjustmentType:"OTHER"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Other Adjustment"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Miscellaneous adjustments"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Adjustment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Adjustment No"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:j.adjustmentNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Adjustment Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"input",value:j.adjustmentDate,onChange:T=>N({...j,adjustmentDate:T.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:j.warehouseId,onChange:T=>N({...j,warehouseId:T.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Warehouse --"}),b.map(T=>e.jsx("option",{value:T.id,children:T.warehouse_name},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Adjustment Type"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:j.adjustmentType,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference Document"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., PC-2024-001",value:j.referenceDoc,onChange:T=>N({...j,referenceDoc:T.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${j.status==="DRAFT"?"bg-slate-200 text-slate-700":"bg-green-100 text-green-700"}`,children:j.status})})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Adjustment Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"input",rows:"2",placeholder:"Provide detailed reason for this adjustment...",value:j.reason,onChange:T=>N({...j,reason:T.target.value}),required:!0}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["Physical count variance","Damaged goods","Expired items","Theft/Loss","Found items","System error correction","Other"].map(T=>e.jsx("button",{type:"button",onClick:()=>Y(T),className:`px-3 py-1 rounded-full text-xs border ${j.reason===T?"bg-brand-500 text-white border-brand-500":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50"}`,children:T},T))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:" Adjustment Items"}),e.jsx("button",{type:"button",onClick:z,className:"btn-primary text-sm px-3 py-1 rounded bg-brand-600 text-white hover:bg-brand-700",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700 uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Item"}),e.jsx("th",{className:"p-3 w-24",children:"Current Stock"}),e.jsx("th",{className:"p-3 w-40",children:"Adjusted Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Diff"}),e.jsx("th",{className:"p-3 w-20",children:"UOM"}),e.jsx("th",{className:"p-3 w-24",children:"Unit Cost"}),e.jsx("th",{className:"p-3 w-28",children:"Impact"}),e.jsx("th",{className:"p-3",children:"Remarks"}),e.jsx("th",{className:"p-3 w-16"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200",children:[S.map(T=>{const k=Number(T.adjustedStock)-Number(T.currentStock),D=k*Number(T.unitCost);return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"input text-sm py-1",value:T.item_id,onChange:Q=>G(T.id,"item_id",Q.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),g.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.item_code," - ",Q.item_name]},Q.id))]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1 bg-slate-50",value:T.currentStock,onChange:Q=>G(T.id,"currentStock",Q.target.value)})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",className:"input text-sm py-1 font-bold w-36",value:T.adjustedStock,onChange:Q=>G(T.id,"adjustedStock",Q.target.value)}),(()=>{const Q=g.find(R=>String(R.id)===String(T.item_id)),C=(Q==null?void 0:Q.uom)&&String(Q.uom)||T.uom&&String(T.uom)||(q?String(q):""),E=(Array.isArray(P)?P:[]).filter(R=>Number(R.is_active)&&Number(R.item_id)===Number(T.item_id)&&String(R.to_uom)===C).map(R=>String(R.from_uom)),w=T.uom&&String(T.uom)!==C?String(T.uom):E[0]||"";return E.length>0&&w&&w!==C?e.jsx("button",{type:"button",className:"px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>H({open:!0,itemId:T.item_id,defaultUom:C,currentUom:w,rowId:T.id}),children:`number of ${w}`}):null})()]})}),e.jsx("td",{className:"p-2 font-bold",children:e.jsxs("span",{className:k>0?"text-green-600":k<0?"text-red-600":"text-slate-400",children:[k>0?"+":"",k]})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"input text-sm py-1",value:T.uom,onChange:Q=>G(T.id,"uom",Q.target.value),children:s?e.jsx("option",{children:"Loading..."}):t.map(Q=>e.jsx("option",{value:Q.uom_code,children:Q.uom_code},Q.id))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1",value:T.unitCost,onChange:Q=>G(T.id,"unitCost",Q.target.value)})}),e.jsx("td",{className:"p-2 font-medium",children:D.toFixed(2)}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",placeholder:"Optional",value:T.remarks,onChange:Q=>G(T.id,"remarks",Q.target.value)})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>I(T.id),className:"text-red-500 hover:text-red-700",children:""})})]},T.id)}),S.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"p-8 text-center text-slate-500",children:'No items added. Click "Add Item" to begin.'})})]})]})})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:" Adjustment Impact Summary"}),e.jsxs("div",{className:"flex gap-8 text-sm",children:[e.jsxs("div",{children:["Total Items Adjusted:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.length})]}),e.jsxs("div",{children:["Net Qty Change:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.reduce((T,k)=>T+(Number(k.adjustedStock)-Number(k.currentStock)),0)})]}),e.jsxs("div",{children:["Total Value Impact:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:S.reduce((T,k)=>T+(Number(k.adjustedStock)-Number(k.currentStock))*Number(k.unitCost),0).toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[e.jsx(Le,{to:"/inventory/stock-adjustments",className:"btn-light bg-white border border-slate-300 text-slate-700 hover:bg-slate-50 px-4 py-2 rounded",children:"Cancel"}),o?null:e.jsx("button",{type:"submit",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:c?"Saving...":"Save Adjustment"})]})]})})]}),e.jsx(sd,{open:U.open,onClose:()=>H({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),itemId:U.itemId?Number(U.itemId):null,defaultUom:String(U.defaultUom||""),currentUom:String(U.currentUom||""),conversions:P,onApply:({converted_qty:T})=>{const k=U.rowId;k!=null&&G(k,"adjustedStock",T)}})]})}function gY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let c=!0;return i(!0),o(""),ee.get("/inventory/stock-transfers").then(h=>{var A;c&&a(Array.isArray((A=h.data)==null?void 0:A.items)?h.data.items:[])}).catch(h=>{var A,f;c&&o(((f=(A=h==null?void 0:h.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load stock transfers")}).finally(()=>{c&&i(!1)}),()=>{c=!1}},[]);const u=c=>({DRAFT:"badge-info",IN_TRANSIT:"badge-warning",RECEIVED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=x.useMemo(()=>r.filter(c=>`${c.transfer_no||""} ${c.from_branch||""} ${c.to_branch||""}`.toLowerCase().includes(t.toLowerCase())),[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Stock Transfers"}),e.jsx("p",{className:"text-sm mt-1",children:"Transfer stock between warehouses and branches"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/stock-transfers/new",className:"btn-success",children:"+ New Transfer"})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by transfer number, from or to branch...",className:"input max-w-md",value:t,onChange:c=>s(c.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Transfer No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"From Branch"}),e.jsx("th",{children:"To Branch"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-red-600",children:l})}):null,d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:c.transfer_no}),e.jsx("td",{children:c.transfer_date}),e.jsx("td",{children:c.from_branch}),e.jsx("td",{children:c.to_branch}),e.jsx("td",{children:c.item_count}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/stock-transfers/${c.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/stock-transfers/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))]})]})})]})]})})}function vY(){const{uoms:t,loading:s}=el(),{id:r}=Ls(),a=ys(),n=r==="new",[i,l]=x.useState(!1),[o,u]=x.useState(!1),[d,c]=x.useState(""),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState([]),[y,j]=x.useState([]),[N,S]=x.useState([]),[B,P]=x.useState({transferNo:n?"Auto-generated":"ST-2024-001",transferDate:new Date().toISOString().split("T")[0],transferType:"INTER_WAREHOUSE",deliveryDate:"",driverName:"",vehicleNo:"",fromBranchId:"",toBranchId:"",fromWarehouseId:"",toWarehouseId:"",remarks:"",status:"DRAFT"}),[L,U]=x.useState([{id:1,item_id:"",itemCode:"",itemName:"",qty:0,uom:"PCS",batchNumber:"",remarks:""}]);x.useEffect(()=>{let I=!0;return(async()=>{var Y,J,T,k,D;try{const[Q,C,E]=await Promise.all([ee.get("/inventory/items"),ee.get("/admin/branches"),ee.get("/inventory/warehouses")]);I&&(A(Array.isArray((Y=Q.data)==null?void 0:Y.items)?Q.data.items:[]),g(Array.isArray((J=C.data)==null?void 0:J.items)?C.data.items:[]),b(Array.isArray((T=E.data)==null?void 0:T.items)?E.data.items:[]))}catch(Q){I&&c(((D=(k=Q==null?void 0:Q.response)==null?void 0:k.data)==null?void 0:D.message)||"Failed to load initial data")}})(),()=>{I=!1}},[]),x.useEffect(()=>{if(!n)return;let I=!0;return ee.get("/inventory/stock-transfers/next-no").then(G=>{var J;if(!I)return;const Y=(J=G.data)==null?void 0:J.next_no;Y&&P(T=>({...T,transferNo:Y}))}).catch(()=>{}),()=>{I=!1}},[n]),x.useEffect(()=>{if(n)return;let I=!0;return l(!0),c(""),ee.get(`/inventory/stock-transfers/${r}`).then(G=>{var T,k;if(!I)return;const Y=(T=G.data)==null?void 0:T.item,J=Array.isArray((k=G.data)==null?void 0:k.details)?G.data.details:[];Y&&(P({transferNo:Y.transfer_no||"",transferDate:Y.transfer_date?typeof Y.transfer_date=="string"?Y.transfer_date.split("T")[0]:new Date(Y.transfer_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],transferType:Y.transfer_type||"INTER_WAREHOUSE",deliveryDate:Y.delivery_date?Y.delivery_date.split("T")[0]:"",driverName:Y.driver_name||"",vehicleNo:Y.vehicle_no||"",fromBranchId:Y.from_branch_id?String(Y.from_branch_id):"",toBranchId:Y.to_branch_id?String(Y.to_branch_id):"",remarks:Y.remarks||"",status:Y.status||"DRAFT"}),U(J.length?J.map(D=>({id:D.id||Date.now()+Math.random(),item_id:D.item_id?String(D.item_id):"",itemCode:D.item_code||"",itemName:D.item_name||"",qty:Number(D.qty)||0,uom:D.uom||"PCS",batchNumber:D.batch_number||"",remarks:D.remarks||""})):[{id:1,item_id:"",itemCode:"",itemName:"",qty:0,uom:"PCS",batchNumber:"",remarks:""}]))}).catch(G=>{var Y,J;I&&c(((J=(Y=G==null?void 0:G.response)==null?void 0:Y.data)==null?void 0:J.message)||"Failed to load stock transfer")}).finally(()=>{I&&l(!1)}),()=>{I=!1}},[r,n]),x.useEffect(()=>{if(B.transferType!=="INTER_BRANCH"){j([]);return}const I=Number(B.fromBranchId);if(!I){j([]);return}const G=f.find(J=>String(J.id)===String(I)),Y=G?Number(G.company_id):void 0;ee.get("/inventory/warehouses",{headers:{"x-branch-id":String(I),...Y?{"x-company-id":String(Y)}:{}}}).then(J=>{var k;const T=Array.isArray((k=J.data)==null?void 0:k.items)?J.data.items:[];j(T)}).catch(()=>{j([])})},[B.transferType,B.fromBranchId,f]),x.useEffect(()=>{if(B.transferType!=="INTER_BRANCH"){S([]);return}const I=Number(B.toBranchId);if(!I){S([]);return}const G=f.find(J=>String(J.id)===String(I)),Y=G?Number(G.company_id):void 0;ee.get("/inventory/warehouses",{headers:{"x-branch-id":String(I),...Y?{"x-company-id":String(Y)}:{}}}).then(J=>{var k;const T=Array.isArray((k=J.data)==null?void 0:k.items)?J.data.items:[];S(T)}).catch(()=>{S([])})},[B.transferType,B.toBranchId,f]),x.useEffect(()=>{P(I=>String(I.fromBranchId)?I:{...I,fromWarehouseId:""})},[B.fromBranchId]),x.useEffect(()=>{P(I=>String(I.toBranchId)?I:{...I,toWarehouseId:""})},[B.toBranchId]);const H=x.useMemo(()=>L.filter(I=>I.item_id).map(I=>({item_id:Number(I.item_id),qty:Number(I.qty)||0,batch_number:I.batchNumber,remarks:I.remarks})),[L]),q=async I=>{var G,Y;I.preventDefault(),u(!0),c("");try{const J=B.transferType==="INTER_BRANCH",T=B.transferType==="INTER_WAREHOUSE",k=T?Number(B.fromBranchId)||null:Number(B.fromWarehouseId)||null,D=T?Number(B.toBranchId)||null:Number(B.toWarehouseId)||null;let Q=Number(B.fromBranchId)||null,C=Number(B.toBranchId)||null;if(T){const w=v.find(R=>String(R.id)===String(k)),O=v.find(R=>String(R.id)===String(D));Q=w&&w.branch_id?Number(w.branch_id):Q,C=O&&O.branch_id?Number(O.branch_id):C}const E={transfer_no:n?void 0:B.transferNo,transfer_date:B.transferDate,transfer_type:B.transferType,delivery_date:B.deliveryDate,driver_name:B.driverName||null,vehicle_no:B.vehicleNo||null,from_branch_id:Q,to_branch_id:C,from_warehouse_id:k,to_warehouse_id:D,status:B.status,remarks:B.remarks,details:H};n?await ee.post("/inventory/stock-transfers",E):await ee.put(`/inventory/stock-transfers/${r}`,E),a("/inventory/stock-transfers")}catch(J){c(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to save stock transfer")}finally{u(!1)}},V=()=>{U([...L,{id:Date.now(),item_id:"",itemCode:"",itemName:"",qty:0,uom:"PCS",batchNumber:"",remarks:""}])},M=I=>{U(L.filter(G=>G.id!==I))},z=I=>{if(!I)return"";if(B.transferType==="INTER_WAREHOUSE"){const Y=v.find(J=>String(J.id)===String(I));return Y?Y.warehouse_name:""}const G=f.find(Y=>String(Y.id)===String(I));return G?G.name:""};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:n?"New Stock Transfer":"Edit Stock Transfer"}),e.jsx("p",{className:"text-sm mt-1",children:"Transfer stock between warehouses and branches"})]}),e.jsx(Le,{to:"/inventory/stock-transfers",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[i?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,d?e.jsx("div",{className:"text-sm text-red-600",children:d}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer No"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:B.transferNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer Date *"}),e.jsx("input",{type:"date",className:"input",value:B.transferDate,onChange:I=>P({...B,transferDate:I.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer Type *"}),e.jsxs("select",{className:"input",value:B.transferType,onChange:I=>P({...B,transferType:I.target.value,fromBranchId:"",toBranchId:"",fromWarehouseId:"",toWarehouseId:""}),required:!0,children:[e.jsx("option",{value:"INTER_WAREHOUSE",children:"Inter-Warehouse"}),e.jsx("option",{value:"INTER_BRANCH",children:"Inter-Branch"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:B.status,onChange:I=>P({...B,status:I.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"IN_TRANSIT",children:"IN TRANSIT"}),e.jsx("option",{value:"RECEIVED",children:"RECEIVED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["From"," ",B.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"," ","*"]}),e.jsxs("select",{className:"input",value:B.fromBranchId,onChange:I=>P({...B,fromBranchId:I.target.value}),required:!0,children:[e.jsxs("option",{value:"",children:["Select"," ",B.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"]}),(B.transferType==="INTER_WAREHOUSE"?v:f).map(I=>e.jsx("option",{value:I.id,children:B.transferType==="INTER_WAREHOUSE"?I.warehouse_name:I.name},I.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["To"," ",B.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"," ","*"]}),e.jsxs("select",{className:"input",value:B.toBranchId,onChange:I=>P({...B,toBranchId:I.target.value}),required:!0,children:[e.jsxs("option",{value:"",children:["Select"," ",B.transferType==="INTER_WAREHOUSE"?"Warehouse":"Branch"]}),(B.transferType==="INTER_WAREHOUSE"?v:f).map(I=>e.jsx("option",{value:I.id,children:B.transferType==="INTER_WAREHOUSE"?I.warehouse_name:I.name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"input",value:B.deliveryDate,onChange:I=>P({...B,deliveryDate:I.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Driver Name"}),e.jsx("input",{type:"text",className:"input",value:B.driverName,onChange:I=>P({...B,driverName:I.target.value}),placeholder:"Optional"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vehicle Number"}),e.jsx("input",{type:"text",className:"input",value:B.vehicleNo,onChange:I=>P({...B,vehicleNo:I.target.value}),placeholder:"Optional"})]})]}),B.transferType==="INTER_BRANCH"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Warehouse (in selected From Branch)"}),e.jsxs("select",{className:"input",value:B.fromWarehouseId,onChange:I=>P({...B,fromWarehouseId:I.target.value}),disabled:!B.fromBranchId,required:!0,children:[e.jsx("option",{value:"",children:B.fromBranchId?"Select Warehouse":"Select From Branch first"}),y.map(I=>e.jsx("option",{value:String(I.id),children:I.warehouse_name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Warehouse (in selected To Branch)"}),e.jsxs("select",{className:"input",value:B.toWarehouseId,onChange:I=>P({...B,toWarehouseId:I.target.value}),disabled:!B.toBranchId,required:!0,children:[e.jsx("option",{value:"",children:B.toBranchId?"Select Warehouse":"Select To Branch first"}),N.map(I=>e.jsx("option",{value:String(I.id),children:I.warehouse_name},I.id))]})]})]}):null,e.jsxs("div",{className:"flex items-center justify-center py-6 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Origin"}),e.jsx("div",{className:"font-bold text-lg text-slate-800 dark:text-slate-200",children:z(B.fromBranchId)||"Select Source"}),B.transferType==="INTER_BRANCH"&&B.fromWarehouseId?e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:(y.find(I=>String(I.id)===String(B.fromWarehouseId))||{warehouse_name:""}).warehouse_name}):null]}),e.jsxs("div",{className:"mx-8 flex flex-col items-center text-brand-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})}),e.jsx("span",{className:"text-xs font-medium mt-1",children:B.transferType.replace("_"," ")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wider mb-1",children:"Destination"}),e.jsx("div",{className:"font-bold text-lg text-slate-800 dark:text-slate-200",children:z(B.toBranchId)||"Select Destination"}),B.transferType==="INTER_BRANCH"&&B.toWarehouseId?e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-300",children:(N.find(I=>String(I.id)===String(B.toWarehouseId))||{warehouse_name:""}).warehouse_name}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:B.remarks,onChange:I=>P({...B,remarks:I.target.value}),placeholder:"Enter any additional notes..."})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Items to Transfer"}),e.jsx("button",{type:"button",onClick:V,className:"btn-success text-sm",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-1/4 min-w-[200px]",children:"Item Code"}),e.jsx("th",{className:"w-1/4 min-w-[200px]",children:"Item Name"}),e.jsx("th",{className:"w-32 min-w-[120px]",children:"Qty"}),e.jsx("th",{className:"w-32 min-w-[120px]",children:"UOM"}),e.jsx("th",{className:"w-48 min-w-[180px]",children:"Batch No"}),e.jsx("th",{className:"w-64 min-w-[250px]",children:"Remarks"}),e.jsx("th",{className:"w-16"})]})}),e.jsx("tbody",{children:L.map(I=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:I.item_id,onChange:G=>{const Y=G.target.value,J=h.find(k=>String(k.id)===String(Y)),T=L.map(k=>k.id===I.id?{...k,item_id:Y,itemCode:(J==null?void 0:J.item_code)||"",itemName:(J==null?void 0:J.item_name)||""}:k);U(T)},required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),h.map(G=>e.jsx("option",{value:G.id,children:(G.item_code||G.id)+" - "+(G.item_name||"")},G.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:I.itemName,disabled:!0})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input",value:I.qty,onChange:G=>{const Y=L.map(J=>J.id===I.id?{...J,qty:parseFloat(G.target.value)||0}:J);U(Y)},min:"0",step:"1"})}),e.jsx("td",{children:e.jsx("select",{className:"input",value:I.uom,onChange:G=>{const Y=L.map(J=>J.id===I.id?{...J,uom:G.target.value}:J);U(Y)},children:s?e.jsx("option",{children:"Loading..."}):t.map(G=>e.jsx("option",{value:G.uom_code,children:G.uom_code},G.id))})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:I.batchNumber,onChange:G=>{const Y=L.map(J=>J.id===I.id?{...J,batchNumber:G.target.value}:J);U(Y)},placeholder:"Optional"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:I.remarks,onChange:G=>{const Y=L.map(J=>J.id===I.id?{...J,remarks:G.target.value}:J);U(Y)},placeholder:"Optional"})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>M(I.id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})})]},I.id))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/stock-transfers",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",children:o?"Saving...":"Save Transfer"})]})]})})]})})}function bY(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState([]),[u,d]=x.useState(!1),[c,h]=x.useState(null),[A,f]=x.useState(!1),[g,v]=x.useState(""),[b,y]=x.useState(null),[j,N]=x.useState(null),[S,B]=x.useState([]),[P,L]=x.useState(!1),[U,H]=x.useState(null),[q,V]=x.useState(null);x.useEffect(()=>{let T=!0;return a(!0),i(""),ee.get("/inventory/material-requisitions").then(k=>{var D;T&&o(Array.isArray((D=k.data)==null?void 0:D.items)?k.data.items:[])}).catch(k=>{var D,Q;T&&i(((Q=(D=k==null?void 0:k.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to load material requisitions")}).finally(()=>{T&&a(!1)}),()=>{T=!1}},[]);const M=T=>({DRAFT:"badge-info",PENDING:"badge-warning",PENDING_APPROVAL:"badge-warning",SUBMITTED:"badge-warning",APPROVED:"badge-success",ISSUED:"badge-success",REJECTED:"badge-error"})[T]||"badge-info",z=x.useMemo(()=>l.filter(T=>{const k=String(T.requisition_no||"").toLowerCase(),D=String(T.requested_by||"").toLowerCase(),Q=t.toLowerCase();return k.includes(Q)||D.includes(Q)}),[l,t]),I=async T=>{var k,D,Q,C;if(h(T),d(!0),v(""),U)await G();else try{f(!0);const E=await ee.get("/workflows");H(Array.isArray((k=E.data)==null?void 0:k.items)?E.data.items:[]),await Y(Array.isArray((D=E.data)==null?void 0:D.items)?E.data.items:[])}catch(E){v(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load workflows")}finally{f(!1)}},G=async()=>{var Q,C,E;if(!U||!U.length){y(null),N(null),v("");return}const T="/inventory/material-requisitions",k=w=>String(w||"").trim().toUpperCase().replace(/\s+/g,"_"),D=U.find(w=>Number(w.is_active)===1&&String(w.document_route)===T)||U.find(w=>Number(w.is_active)===1&&k(w.document_type)==="MATERIAL_REQUISITION")||null;if(y(D||null),N(null),!!D&&D)try{f(!0);const O=(Q=(await ee.get(`/workflows/${D.id}`)).data)==null?void 0:Q.item,R=Array.isArray(O==null?void 0:O.steps)?O.steps:[];B(R);const X=R[0]||null;if(N(X?{userId:X.approver_user_id,name:X.approver_name,stepName:X.step_name,stepOrder:X.step_order,approvalLimit:X.approval_limit}:null),X){const ne=(Array.isArray(X.approvers)&&X.approvers.length?X.approvers[0].id:X.approver_user_id)||null;V(ne)}else V(null)}catch(w){v(((E=(C=w==null?void 0:w.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to load workflow details")}finally{f(!1)}},Y=async T=>{var C,E,w;if(!T||!T.length){y(null),N(null),v("");return}const k="/inventory/material-requisitions",D=O=>String(O||"").trim().toUpperCase().replace(/\s+/g,"_"),Q=T.find(O=>Number(O.is_active)===1&&String(O.document_route)===k)||T.find(O=>Number(O.is_active)===1&&D(O.document_type)==="MATERIAL_REQUISITION")||null;if(y(Q||null),N(null),!!Q)try{f(!0);const R=(C=(await ee.get(`/workflows/${Q.id}`)).data)==null?void 0:C.item,X=Array.isArray(R==null?void 0:R.steps)?R.steps:[];B(X);const ne=X[0]||null;N(ne?{userId:ne.approver_user_id,name:ne.approver_name,stepName:ne.step_name,stepOrder:ne.step_order,approvalLimit:ne.approval_limit}:null)}catch(O){v(((w=(E=O==null?void 0:O.response)==null?void 0:E.data)==null?void 0:w.message)||"Failed to load workflow details")}finally{f(!1)}},J=async()=>{var T,k,D;if(c){L(!0),v("");try{const Q=await ee.post(`/inventory/material-requisitions/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:q||null}),C=((T=Q==null?void 0:Q.data)==null?void 0:T.status)||"PENDING_APPROVAL";o(E=>E.map(w=>w.id===c.id?{...w,status:C}:w)),d(!1),h(null)}catch(Q){v(((D=(k=Q==null?void 0:Q.response)==null?void 0:k.data)==null?void 0:D.message)||"Failed to forward for approval")}finally{L(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Material Requisitions"}),e.jsx("p",{className:"text-sm mt-1",children:"Request materials from warehouse inventory"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/material-requisitions/new",className:"btn-success",children:"+ New Requisition"})]})]})}),e.jsxs("div",{className:"card-body",children:[r?e.jsx("div",{className:"text-sm mb-4",children:"Loading..."}):null,n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by requisition number or requested by...",className:"input max-w-md",value:t,onChange:T=>s(T.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Requisition No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Requested By"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:z.map(T=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:T.requisition_no}),e.jsx("td",{children:T.requisition_date}),e.jsx("td",{children:T.requested_by||"-"}),e.jsx("td",{children:T.department_name||"-"}),e.jsx("td",{children:T.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${M(T.status)}`,children:T.status})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/material-requisitions/${T.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/material-requisitions/${T.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"}),T.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",onClick:()=>I(T),className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",disabled:P||T.status==="ISSUED"||T.status==="PENDING_APPROVAL",children:"Forward for Approval"})]})]},T.id))})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),h(null),y(null),N(null),v("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Requisition:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.requisition_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[A?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const k=Array.isArray(S)&&S.length>0?S[0]:null,D=k?Array.isArray(k.approvers)&&k.approvers.length?k.approvers.map(Q=>({id:Q.id,name:Q.username})):k.approver_user_id?[{id:k.approver_user_id,name:k.approver_name||String(k.approver_user_id)}]:[]:[];return D.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:q||"",onChange:Q=>V(Q.target.value?Number(Q.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),D.map(Q=>e.jsx("option",{value:Q.id,children:Q.name},Q.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:j?`Step ${j.stepOrder}  ${j.stepName}${j.approvalLimit!=null?`  Limit: ${Number(j.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),h(null),y(null),N(null),V(null),v("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:J,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function Z_(t){if(!t)return new Date().toISOString().split("T")[0];const s=String(t);return s.includes("T")?s.split("T")[0]:s}function yY(){el();const{id:t}=Ls(),s=ys(),r=t==="new",[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState([]),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState([]),[y,j]=x.useState(!1),[N,S]=x.useState(""),[B,P]=x.useState({requisitionNo:r?"Auto-generated":"",requisitionDate:new Date().toISOString().split("T")[0],warehouseId:"",departmentId:"",requisitionType:"INTERNAL",priority:"MEDIUM",requestedBy:"",remarks:"",status:"DRAFT"}),[L,U]=x.useState([{id:1,item_id:"",itemCode:"",itemName:"",qtyRequested:0,qtyIssued:0,uom:"PCS"}]);x.useEffect(()=>{let Y=!0;return ee.get("/admin/users").then(J=>{var T;Y&&A(Array.isArray((T=J.data)==null?void 0:T.items)?J.data.items:[])}).catch(J=>console.error("Failed to load users",J)),ee.get("/inventory/warehouses").then(J=>{var T;Y&&g(Array.isArray((T=J.data)==null?void 0:T.items)?J.data.items:[])}).catch(J=>console.error("Failed to load warehouses",J)),ee.get("/admin/departments").then(J=>{var T;Y&&b(Array.isArray((T=J.data)==null?void 0:T.items)?J.data.items:[])}).catch(J=>console.error("Failed to load departments",J)),ee.get("/inventory/items").then(J=>{var T;Y&&c(Array.isArray((T=J.data)==null?void 0:T.items)?J.data.items:[])}).catch(J=>{var T,k;Y&&u(((k=(T=J==null?void 0:J.response)==null?void 0:T.data)==null?void 0:k.message)||"Failed to load items")}),()=>{Y=!1}},[]),x.useEffect(()=>{if(r)return;let Y=!0;return n(!0),u(""),ee.get(`/inventory/material-requisitions/${t}`).then(J=>{var D,Q;if(!Y)return;const T=(D=J.data)==null?void 0:D.item,k=Array.isArray((Q=J.data)==null?void 0:Q.details)?J.data.details:[];T&&(P({requisitionNo:T.requisition_no||"",requisitionDate:Z_(T.requisition_date),warehouseId:T.warehouse_id||"",departmentId:T.department_id||"",requisitionType:T.requisition_type||"INTERNAL",priority:T.priority||"MEDIUM",requestedBy:T.requested_by||"",remarks:T.remarks||"",status:T.status||"DRAFT"}),U(k.length?k.map(C=>({id:C.id||Date.now()+Math.random(),item_id:C.item_id?String(C.item_id):"",itemCode:C.item_code||"",itemName:C.item_name||"",qtyRequested:Number(C.qty_requested)||0,qtyIssued:Number(C.qty_issued)||0,uom:C.uom||"PCS"})):[{id:1,item_id:"",itemCode:"",itemName:"",qtyRequested:0,qtyIssued:0,uom:"PCS"}]))}).catch(J=>{var T,k;Y&&u(((k=(T=J==null?void 0:J.response)==null?void 0:T.data)==null?void 0:k.message)||"Failed to load material requisition")}).finally(()=>{Y&&n(!1)}),()=>{Y=!1}},[t,r]);const H=x.useMemo(()=>L.filter(Y=>Y.item_id).map(Y=>({item_id:Number(Y.item_id),qty_requested:Math.max(0,parseInt(Y.qtyRequested,10)||0),qty_issued:Number(Y.qtyIssued)||0})),[L]),q={DRAFT:"bg-gray-500 text-white",PENDING:"bg-yellow-400 text-black",PENDING_APPROVAL:"bg-yellow-400 text-black",SUBMITTED:"bg-yellow-300 text-black",APPROVED:"bg-green-500 text-white",ISSUED:"bg-blue-500 text-white",REJECTED:"bg-red-500 text-white"},V=async(Y,J)=>{var T,k;Y&&Y.preventDefault(),l(!0),u("");try{const D={requisition_no:r?void 0:B.requisitionNo,requisition_date:Z_(B.requisitionDate),warehouse_id:B.warehouseId||null,department_id:B.departmentId||null,requisition_type:B.requisitionType,priority:B.priority,requested_by:B.requestedBy||null,remarks:B.remarks||null,status:J||B.status,details:H};r?await ee.post("/inventory/material-requisitions",D):await ee.put(`/inventory/material-requisitions/${t}`,D),s("/inventory/material-requisitions")}catch(D){u(((k=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:k.message)||"Failed to save material requisition")}finally{l(!1)}},M=()=>{j(!0),S("")},z=Y=>{U([...L,{id:Date.now(),item_id:String(Y.id),itemCode:Y.item_code||"",itemName:Y.item_name||"",qtyRequested:0,qtyIssued:0,uom:Y.uom||"PCS"}]),j(!1)},I=x.useMemo(()=>{if(!N)return d;const Y=N.toLowerCase();return d.filter(J=>J.item_code&&J.item_code.toLowerCase().includes(Y)||J.item_name&&J.item_name.toLowerCase().includes(Y))},[d,N]),G=Y=>{U(L.filter(J=>J.id!==Y))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Material Requisition":"Edit Material Requisition"}),e.jsx("p",{className:"text-sm mt-1",children:"Request materials from warehouse inventory"})]}),e.jsx(Le,{to:"/inventory/material-requisitions",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[a?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,o?e.jsx("div",{className:"text-sm text-red-600",children:o}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition No"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:B.requisitionNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Date *"}),e.jsx("input",{type:"date",className:"input",value:B.requisitionDate,onChange:Y=>P({...B,requisitionDate:Y.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Priority"}),e.jsxs("select",{className:"input",value:B.priority,onChange:Y=>P({...B,priority:Y.target.value}),children:[e.jsx("option",{value:"LOW",children:"Low"}),e.jsx("option",{value:"MEDIUM",children:"Medium"}),e.jsx("option",{value:"HIGH",children:"High"}),e.jsx("option",{value:"CRITICAL",children:"Critical"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"pt-2",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-medium ${q[B.status]||"bg-gray-500 text-white"}`,children:B.status})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Source Warehouse"}),e.jsxs("select",{className:"input",value:B.warehouseId,onChange:Y=>P({...B,warehouseId:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Warehouse"}),f.map(Y=>e.jsx("option",{value:Y.id,children:Y.warehouse_name},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Destination Department"}),e.jsxs("select",{className:"input",value:B.departmentId,onChange:Y=>P({...B,departmentId:Y.target.value}),children:[e.jsx("option",{value:"",children:"Select Department"}),v.map(Y=>e.jsx("option",{value:Y.id,children:Y.name},Y.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Type"}),e.jsxs("select",{className:"input",value:B.requisitionType,onChange:Y=>P({...B,requisitionType:Y.target.value}),children:[e.jsx("option",{value:"INTERNAL",children:"Internal Use"}),e.jsx("option",{value:"PROJECT",children:"Project"}),e.jsx("option",{value:"SALES",children:"Sales Order"}),e.jsx("option",{value:"PRODUCTION",children:"Production"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requested By *"}),e.jsxs("select",{className:"input",value:B.requestedBy,onChange:Y=>P({...B,requestedBy:Y.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select User"}),h.map(Y=>e.jsx("option",{value:Y.username,children:Y.username},Y.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:B.remarks,onChange:Y=>P({...B,remarks:Y.target.value}),placeholder:"Enter any additional notes..."})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Items"}),e.jsx("button",{type:"button",onClick:M,className:"btn-success text-sm",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Qty Requested"}),e.jsx("th",{children:"Qty Issued"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:L.map(Y=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:Y.item_id,onChange:J=>{const T=J.target.value,k=d.find(Q=>String(Q.id)===String(T)),D=L.map(Q=>Q.id===Y.id?{...Q,item_id:T,itemCode:(k==null?void 0:k.item_code)||"",itemName:(k==null?void 0:k.item_name)||""}:Q);U(D)},required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),!d.some(J=>String(J.id)===String(Y.item_id))&&Y.item_id&&e.jsx("option",{value:Y.item_id,children:Y.itemCode||Y.item_id}),d.map(J=>e.jsx("option",{value:J.id,children:J.item_code||J.id},J.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:Y.itemName,disabled:!0})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input",value:Y.qtyRequested,onChange:J=>{const T=L.map(k=>k.id===Y.id?{...k,qtyRequested:Math.max(0,parseInt(J.target.value,10)||0)}:k);U(T)},min:"0",step:"1",inputMode:"numeric",pattern:"[0-9]*"})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input bg-slate-100 dark:bg-slate-700",value:Y.qtyIssued,disabled:!0})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:Y.uom,onChange:J=>{const T=L.map(k=>k.id===Y.id?{...k,uom:J.target.value}:k);U(T)},children:[e.jsx("option",{value:"EA",children:"EA"}),e.jsx("option",{value:"PCS",children:"PCS"}),e.jsx("option",{value:"KG",children:"KG"}),e.jsx("option",{value:"LTR",children:"LTR"}),e.jsx("option",{value:"MTR",children:"MTR"})]})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>G(Y.id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})})]},Y.id))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/material-requisitions",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",onClick:Y=>V(Y,"DRAFT"),className:"btn-success",disabled:i,children:i?"Saving...":" Save Draft"}),e.jsx("button",{type:"button",onClick:Y=>V(Y,"PENDING"),className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition-colors",disabled:i,children:i?"Saving...":" Save as Pending"})]})]})})]}),y&&e.jsx("div",{className:"custom-modal-overlay",onClick:()=>j(!1),children:e.jsxs("div",{className:"custom-modal-content",onClick:Y=>Y.stopPropagation(),children:[e.jsxs("div",{className:"p-4 bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Select Item"}),e.jsx("button",{onClick:()=>j(!1),className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 flex-1 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"label",children:"Search Items"}),e.jsx("input",{type:"text",className:"input",placeholder:"Search by item code or name...",value:N,onChange:Y=>S(Y.target.value),autoFocus:!0})]}),e.jsx("div",{className:"item-list-container flex-1 overflow-y-auto",children:I.length===0?e.jsx("div",{className:"text-center p-4 text-gray-500",children:"No items found"}):I.map(Y=>e.jsxs("div",{className:"item-card cursor-pointer hover:bg-slate-100 mb-2 p-3 border rounded",onClick:()=>z(Y),children:[e.jsx("div",{className:"font-bold text-brand",children:Y.item_code||"N/A"}),e.jsx("div",{className:"text-gray-800",children:Y.item_name||"Unnamed Item"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["UOM: ",Y.uom||"N/A"]})]},Y.id))})]}),e.jsx("div",{className:"p-4 border-t flex justify-end bg-gray-50 rounded-b-lg",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>j(!1),children:"Close"})})]})})]})}function jY(){const[t,s]=x.useState([]),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState(""),[g,v]=x.useState(25),[b,y]=x.useState(1),[j,N]=x.useState({key:"item_code",asc:!0}),S=x.useRef(null);x.useEffect(()=>{let I=!0;return a(!0),i(""),ee.get("/inventory/items").then(G=>{var Y;I&&s(Array.isArray((Y=G.data)==null?void 0:Y.items)?G.data.items:[])}).catch(G=>{var Y,J;I&&i(((J=(Y=G==null?void 0:G.response)==null?void 0:Y.data)==null?void 0:J.message)||"Failed to load items")}).finally(()=>{I&&a(!1)}),()=>{I=!1}},[]);const B=x.useMemo(()=>{const I=t.length,G=t.filter(T=>!!T.is_active).length,Y=I-G,J=t.filter(T=>Number(T.stock_level||0)<=Number(T.reorder_level||-1)&&T.reorder_level!=null).length;return{total:I,active:G,inactive:Y,lowStock:J}},[t]),P=x.useMemo(()=>{const I=l.toLowerCase();return t.filter(G=>u&&String(G.item_type||"")!==u||c&&(c==="Y"?!G.is_active:G.is_active)||A==="Y"&&!G.barcode||A==="N"&&G.barcode?!1:String(G.item_code||"").toLowerCase().includes(I)||String(G.item_name||"").toLowerCase().includes(I)||String(G.barcode||"").toLowerCase().includes(I)).sort((G,Y)=>{const J=G[j.key],T=Y[j.key];if(J==null&&T==null)return 0;if(J==null)return j.asc?-1:1;if(T==null)return j.asc?1:-1;if(typeof J=="number"&&typeof T=="number")return j.asc?J-T:T-J;const k=String(J).toLowerCase(),D=String(T).toLowerCase();return k<D?j.asc?-1:1:k>D?j.asc?1:-1:0})},[t,l,u,c,A,j]),L=Math.max(1,Math.ceil(P.length/g)),U=x.useMemo(()=>{const I=(b-1)*g;return P.slice(I,I+g)},[P,b,g]),H=I=>{N(G=>G.key===I?{key:I,asc:!G.asc}:{key:I,asc:!0})},q=()=>{S.current&&S.current.click()},V=async I=>{const G=I.target.files[0];if(!G)return;const Y=new FileReader;Y.onload=async J=>{var ce,re,de,Ie,le,Z,ve,Ue;const k=J.target.result.split(`
`),D=k[0].split(",").map(Be=>Be.trim()),C=["ITEM_NAME*","ITEM_TYPE*","BASE_UOM*"].filter(Be=>!D.includes(Be));if(C.length>0){nt.error(`Invalid CSV format: Missing required header(s): ${C.join(", ")}`);return}let E=0,w=0;const O=[];a(!0);let R=new Map,X=new Map,ne=new Map,te=new Map,oe=new Map;try{const[Be,_e,Me,Ye,ot]=await Promise.all([ee.get("/inventory/item-categories"),ee.get("/inventory/item-groups"),ee.get("/finance/currencies"),ee.get("/finance/tax-codes"),ee.get("/finance/accounts")]),Ke=Array.isArray((ce=Be==null?void 0:Be.data)==null?void 0:ce.items)?Be.data.items:[],ct=Array.isArray((re=_e==null?void 0:_e.data)==null?void 0:re.items)?_e.data.items:[],xt=Array.isArray((de=Me==null?void 0:Me.data)==null?void 0:de.items)?Me.data.items:[],be=Array.isArray((Ie=Ye==null?void 0:Ye.data)==null?void 0:Ie.items)?Ye.data.items:[],Ce=Array.isArray((le=ot==null?void 0:ot.data)==null?void 0:le.items)?ot.data.items:[];Ke.forEach(Te=>{const ue=Number(Te.id),ge=String(Te.category_code||"").toUpperCase(),Ve=String(Te.category_name||"").toUpperCase();ue>0&&(ge&&R.set(ge,ue),Ve&&R.set(Ve,ue))}),ct.forEach(Te=>{const ue=Number(Te.id),ge=String(Te.group_code||"").toUpperCase(),Ve=String(Te.group_name||"").toUpperCase();ue>0&&(ge&&X.set(ge,ue),Ve&&X.set(Ve,ue))}),xt.forEach(Te=>{const ue=Number(Te.id),ge=String(Te.code||"").toUpperCase(),Ve=String(Te.name||"").toUpperCase();ue>0&&(ge&&ne.set(ge,ue),Ve&&ne.set(Ve,ue))}),be.forEach(Te=>{const ue=Number(Te.id),ge=String(Te.code||"").toUpperCase(),Ve=String(Te.name||"").toUpperCase();ue>0&&(ge&&te.set(ge,ue),Ve&&te.set(Ve,ue))}),Ce.forEach(Te=>{const ue=Number(Te.id),ge=String(Te.code||"").toUpperCase(),Ve=String(Te.name||"").toUpperCase();ue>0&&(ge&&oe.set(ge,ue),Ve&&oe.set(Ve,ue))})}catch{}for(let Be=1;Be<k.length;Be++){const _e=k[Be].trim();if(!_e)continue;const Me=_e.split(",").map(ct=>ct.trim());if(Me.length<D.length)continue;const Ye={};D.forEach((ct,xt)=>{const be=ct.replace("*","");Ye[be]=Me[xt]});let ot=Ye.ITEM_CODE;if(!ot)try{const ct=await ee.get("/inventory/items/next-code");(Z=ct==null?void 0:ct.data)!=null&&Z.nextCode&&(ot=ct.data.nextCode)}catch{}const Ke={item_code:ot,item_name:Ye.ITEM_NAME,item_type:Ye.ITEM_TYPE,category_id:Ye.ITEM_CATEGORY&&R.get(String(Ye.ITEM_CATEGORY).toUpperCase())||Ye.ITEM_CATEGORY_CODE&&R.get(String(Ye.ITEM_CATEGORY_CODE).toUpperCase())||Ye.ITEM_CATEGORY_ID||null,item_group_id:Ye.ITEM_GROUP&&X.get(String(Ye.ITEM_GROUP).toUpperCase())||Ye.ITEM_GROUP_CODE&&X.get(String(Ye.ITEM_GROUP_CODE).toUpperCase())||Ye.ITEM_GROUP_ID||null,uom:Ye.BASE_UOM,barcode:Ye.BARCODE||null,cost_price:Number(Ye.STANDARD_COST)||0,selling_price:Number(Ye.SELLING_PRICE)||0,currency_id:Ye.CURRENCY_CODE&&ne.get(String(Ye.CURRENCY_CODE).toUpperCase())||Ye.CURRENCY_ID||null,description:Ye.DESCRIPTION,is_stockable:Ye.IS_STOCKABLE==="Y",is_sellable:Ye.IS_SELLABLE==="Y",is_purchasable:Ye.IS_PURCHASABLE==="Y",min_stock_level:Number(Ye.MIN_STOCK_LEVEL)||0,max_stock_level:Number(Ye.MAX_STOCK_LEVEL)||0,reorder_level:Number(Ye.REORDER_LEVEL)||0,safety_stock:Number(Ye.SAFETY_STOCK)||0,vat_on_purchase_id:Ye.VAT_PURCHASE_CODE&&te.get(String(Ye.VAT_PURCHASE_CODE).toUpperCase())||Ye.VAT_ON_PURCHASE_ID||null,vat_on_sales_id:Ye.VAT_SALES_CODE&&te.get(String(Ye.VAT_SALES_CODE).toUpperCase())||Ye.VAT_ON_SALES_ID||null,purchase_account_id:Ye.PURCHASE_ACCOUNT_CODE&&oe.get(String(Ye.PURCHASE_ACCOUNT_CODE).toUpperCase())||Ye.PURCHASE_ACCOUNT_ID||null,sales_account_id:Ye.SALES_ACCOUNT_CODE&&oe.get(String(Ye.SALES_ACCOUNT_CODE).toUpperCase())||Ye.SALES_ACCOUNT_ID||null,is_active:Object.prototype.hasOwnProperty.call(Ye,"ACTIVE_STATUS")?Ye.ACTIVE_STATUS==="Y":!0};try{await ee.post("/inventory/items",Ke),E++}catch(ct){w++,O.push(`Row ${Be+1} (${Ke.item_code}): ${((Ue=(ve=ct.response)==null?void 0:ve.data)==null?void 0:Ue.message)||ct.message}`)}}a(!1),I.target.value=null,E>0&&(nt.success(`Successfully imported ${E} items`),ee.get("/inventory/items").then(Be=>{var _e;s(Array.isArray((_e=Be.data)==null?void 0:_e.items)?Be.data.items:[])})),w>0&&(nt.error(`Failed to import ${w} items`),console.error("Import errors:",O),alert(`Import completed with errors:
`+O.slice(0,10).join(`
`)+(O.length>10?`
...`:"")))},Y.readAsText(G)},M=async()=>{var ne,te;let I=[],G=[];try{const[oe,ce]=await Promise.all([ee.get("/finance/tax-codes"),ee.get("/finance/accounts")]);I=(Array.isArray((ne=oe==null?void 0:oe.data)==null?void 0:ne.items)?oe.data.items:[]).map(re=>String(re.code||"").trim()).filter(Boolean),G=(Array.isArray((te=ce==null?void 0:ce.data)==null?void 0:te.items)?ce.data.items:[]).map(re=>String(re.code||"").trim()).filter(Boolean)}catch{}const Y=(oe,ce=0,re="")=>String((oe==null?void 0:oe[ce])||re),J=(oe,ce)=>String((oe==null?void 0:oe.find(re=>String(re).toUpperCase().includes(ce)))||""),T=Y(I,0,"VAT"),k=Y(I,1,T);let D=J(G,"PURCHASE")||Y(G,0,"PURCHASE"),Q=J(G,"SALES")||Y(G,1,Y(G,0,"SALES"));const C=["ITEM_NAME*","ITEM_TYPE*","ITEM_CATEGORY","ITEM_GROUP","BASE_UOM*","BARCODE","STANDARD_COST","SELLING_PRICE","CURRENCY_CODE","VAT_PURCHASE_CODE","VAT_SALES_CODE","PURCHASE_ACCOUNT_CODE","SALES_ACCOUNT_CODE","DESCRIPTION","IS_STOCKABLE","IS_SELLABLE","IS_PURCHASABLE","MIN_STOCK_LEVEL","MAX_STOCK_LEVEL","REORDER_LEVEL","SAFETY_STOCK"],E=[["Raw Material 1","RAW_MATERIAL","","","PCS","","100.00","120.00","GHS",T,k,D,Q,"Sample raw material","Y","Y","Y","10","100","20","5"],["Finished Good 1","FINISHED_GOOD","","","PCS","5060072082361","150.00","180.00","GHS",T,k,D,Q,"Sample finished product","Y","Y","Y","5","50","10","3"]],w=[C.join(","),...E.map(oe=>oe.join(","))].join(`
`),O=new Blob([w],{type:"text/csv;charset=utf-8;"}),R=URL.createObjectURL(O),X=document.createElement("a");X.href=R,X.download="items_bulk_upload_template.csv",document.body.appendChild(X),X.click(),document.body.removeChild(X),setTimeout(()=>URL.revokeObjectURL(R),100)},z=()=>{const G=[["item_code","item_name","item_type","category_name","uom","barcode","stock_level","cost_price","selling_price","is_active"].join(","),...P.map(k=>[k.item_code??"",k.item_name??"",k.item_type??"",k.category_name??"",k.uom??"",k.barcode??"",k.stock_level??"",k.cost_price??"",k.selling_price??"",k.is_active?"Y":"N"].map(D=>{const Q=String(D);return Q.includes(",")||Q.includes('"')||Q.includes(`
`)?`"${Q.replace(/"/g,'""')}"`:Q}).join(","))].join(`
`),Y=new Blob([G],{type:"text/csv;charset=utf-8;"}),J=URL.createObjectURL(Y),T=document.createElement("a");T.href=J,T.download="items_export.csv",document.body.appendChild(T),T.click(),document.body.removeChild(T),setTimeout(()=>URL.revokeObjectURL(J),100)};return x.useEffect(()=>{y(1)},[l,u,c,A,g]),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Items Master"}),e.jsx("p",{className:"text-sm mt-1 text-slate-500 dark:text-slate-400",children:"Configure items, UOM, pricing and barcodes"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap w-full md:w-auto justify-start md:justify-end",children:[e.jsx(Le,{to:"/inventory",className:"btn-secondary",children:"Return to Menu"}),e.jsx("input",{type:"file",ref:S,onChange:V,className:"hidden",accept:".csv"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:q,children:"Bulk Upload"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:M,children:"Download Template"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:z,children:"Export Items"}),e.jsx(Le,{to:"/inventory/items/new",className:"btn-primary",children:"+ New Item"})]})]})}),e.jsxs("div",{className:"card-body",children:[n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mb-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, barcode...",className:"input w-full",value:l,onChange:I=>o(I.target.value)})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:u,onChange:I=>d(I.target.value),children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"RAW_MATERIAL",children:"Raw Material"}),e.jsx("option",{value:"FINISHED_GOOD",children:"Finished Good"}),e.jsx("option",{value:"SEMI_FINISHED",children:"Semi-Finished"}),e.jsx("option",{value:"CONSUMABLE",children:"Consumable"}),e.jsx("option",{value:"SERVICE",children:"Service"})]})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:c,onChange:I=>h(I.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Y",children:"Active"}),e.jsx("option",{value:"N",children:"Inactive"})]})}),e.jsx("div",{children:e.jsxs("select",{className:"input w-full",value:A,onChange:I=>f(I.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"Y",children:"With Barcode"}),e.jsx("option",{value:"N",children:"Without Barcode"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:B.total}),e.jsx("div",{className:"text-sm text-slate-500",children:"Total Items"})]}),e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:B.active}),e.jsx("div",{className:"text-sm text-slate-500",children:"Active Items"})]}),e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:B.lowStock}),e.jsx("div",{className:"text-sm text-slate-500",children:"Low Stock"})]}),e.jsxs("div",{className:"p-3 bg-white rounded border",children:[e.jsx("div",{className:"text-2xl font-bold",children:B.inactive}),e.jsx("div",{className:"text-sm text-slate-500",children:"Inactive Items"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Showing ",Math.min(U.length,P.length)," of"," ",P.length," items"]}),e.jsx("div",{children:e.jsxs("select",{className:"input",value:g,onChange:I=>v(Number(I.target.value)),children:[e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:25,children:"25 per page"}),e.jsx("option",{value:50,children:"50 per page"}),e.jsx("option",{value:100,children:"100 per page"})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{onClick:()=>H("item_code"),children:"Item Code"}),e.jsx("th",{onClick:()=>H("item_name"),children:"Item Name"}),e.jsx("th",{onClick:()=>H("item_type"),children:"Type"}),e.jsx("th",{onClick:()=>H("category_name"),children:"Category"}),e.jsx("th",{onClick:()=>H("uom"),children:"UOM"}),e.jsx("th",{children:"Barcode"}),e.jsx("th",{onClick:()=>H("stock_level"),children:"Stock Level"}),e.jsx("th",{className:"text-right",onClick:()=>H("cost_price"),children:"Std Cost"}),e.jsx("th",{className:"text-right",onClick:()=>H("selling_price"),children:"Sell Price"}),e.jsx("th",{onClick:()=>H("is_active"),children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!r&&!U.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"11",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No items found"})}):null,U.map(I=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:I.item_code}),e.jsx("td",{children:I.item_name}),e.jsx("td",{children:I.item_type_name||I.item_type||"-"}),e.jsx("td",{children:I.category_name||"-"}),e.jsx("td",{children:I.uom}),e.jsx("td",{children:I.barcode||"-"}),e.jsx("td",{children:I.stock_level??"-"}),e.jsx("td",{className:"text-right",children:Number(I.cost_price||0).toFixed(2)}),e.jsx("td",{className:"text-right",children:Number(I.selling_price||0).toFixed(2)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${I.is_active?"badge-success":"badge-error"}`,children:I.is_active?"ACTIVE":"INACTIVE"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/items/${I.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/items/${I.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},I.id))]})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center py-3 border-t gap-4",children:[e.jsxs("div",{className:"text-sm text-slate-600 order-2 md:order-1",children:["Page ",b," of ",L]}),e.jsxs("div",{className:"flex gap-2 items-center order-1 md:order-2",children:[e.jsx("button",{className:"btn-success",disabled:b===1,onClick:()=>y(1),children:""}),e.jsx("button",{className:"btn-success",disabled:b===1,onClick:()=>y(I=>Math.max(1,I-1)),children:""}),e.jsxs("span",{className:"text-sm",children:[(b-1)*g+1,"-",Math.min(b*g,P.length)," of"," ",P.length]}),e.jsx("button",{className:"btn-success",disabled:b===L,onClick:()=>y(I=>Math.min(L,I+1)),children:""}),e.jsx("button",{className:"btn-success",disabled:b===L,onClick:()=>y(L),children:""})]})]})]})]})})}function PB(){const t=Ky(),s=Vc(i=>i.inventoryRef.categories),r=Vc(i=>i.inventoryRef.status.categories),a=Vc(i=>i.inventoryRef.error.categories),n=x.useCallback(()=>{t(Hm())},[t]);return x.useEffect(()=>{(r==="idle"||r==="failed"&&(!Array.isArray(s)||s.length===0))&&t(Hm())},[s,t,r]),{categories:s,loading:r==="loading",error:a,refresh:n}}function RB(){const t=Ky(),s=Vc(i=>i.inventoryRef.itemTypes),r=Vc(i=>{var l;return(l=i.inventoryRef.status)==null?void 0:l.itemTypes}),a=Vc(i=>{var l;return(l=i.inventoryRef.error)==null?void 0:l.itemTypes}),n=x.useCallback(()=>{t(tA())},[t]);return x.useEffect(()=>{const i=Array.isArray(s)&&s.length>0;if(r==null){t(tA());return}if(r==="idle"){t(tA());return}r==="failed"&&!i&&t(tA())},[t,s,r]),{itemTypes:s,loading:r==="loading",error:a,refresh:n}}function NY(){const{uoms:t,loading:s}=el(),{categories:r,loading:a}=PB(),{itemTypes:n,loading:i}=RB();console.log("ItemForm mounting");const{id:l}=Ls(),o=ys(),u=l==="new",[d,c]=x.useState(!1),[h,A]=x.useState(!1),[f,g]=x.useState(!1),[v,b]=x.useState(""),[y,j]=x.useState([]),[N,S]=x.useState([]),[B,P]=x.useState([]),[L,U]=x.useState([]),[H,q]=x.useState({item_code:"",item_name:"",uom:"PCS",barcode:"",cost_price:0,selling_price:0,currency_id:"",image_url:"",is_active:!0,item_type:"",category_id:"",item_group_id:"",description:"",min_stock_level:0,max_stock_level:0,reorder_level:0,safety_stock:0,vat_on_purchase_id:"",vat_on_sales_id:"",purchase_account_id:"",sales_account_id:"",is_stockable:!0,is_sellable:!0,is_purchasable:!0});x.useEffect(()=>{if(Promise.all([ee.get("/inventory/item-groups"),ee.get("/finance/accounts").catch(()=>({data:{items:[]}})),ee.get("/finance/tax-codes").catch(()=>({data:{items:[]}})),ee.get("/finance/currencies").catch(()=>({data:{items:[]}}))]).then(([I,G,Y,J])=>{var T,k,D,Q;j(Array.isArray((T=I.data)==null?void 0:T.items)?I.data.items:[]),S(Array.isArray((k=G.data)==null?void 0:k.items)?G.data.items:[]),P(Array.isArray((D=Y.data)==null?void 0:D.items)?Y.data.items:[]),U(Array.isArray((Q=J.data)==null?void 0:Q.items)?J.data.items:[])}).catch(()=>{}),u){ee.get("/inventory/items/next-code").then(I=>{var G;(G=I.data)!=null&&G.nextCode&&q(Y=>({...Y,item_code:I.data.nextCode}))}).catch(()=>{});return}let z=!0;return c(!0),b(""),ee.get(`/inventory/items/${l}`).then(I=>{var Y;if(!z)return;const G=(Y=I.data)==null?void 0:Y.item;G&&q({item_code:G.item_code||"",item_name:G.item_name||"",uom:G.uom||"PCS",barcode:G.barcode||"",cost_price:Number(G.cost_price||0),selling_price:Number(G.selling_price||0),currency_id:G.currency_id||"",image_url:G.image_url||"",is_active:!!G.is_active,item_type:G.item_type||"",category_id:G.category_id||"",item_group_id:G.item_group_id||"",description:G.description||"",min_stock_level:Number(G.min_stock_level||0),max_stock_level:Number(G.max_stock_level||0),reorder_level:Number(G.reorder_level||0),safety_stock:Number(G.safety_stock||0),vat_on_purchase_id:G.vat_on_purchase_id||"",vat_on_sales_id:G.vat_on_sales_id||"",purchase_account_id:G.purchase_account_id||"",sales_account_id:G.sales_account_id||"",is_stockable:G.is_stockable??!0,is_sellable:G.is_sellable??!0,is_purchasable:G.is_purchasable??!0})}).catch(I=>{var G,Y;z&&b(((Y=(G=I==null?void 0:I.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to load item")}).finally(()=>{z&&c(!1)}),()=>{z=!1}},[l,u]);const V=async z=>{const I=z.target.files[0];if(!I)return;const G=new FormData;G.append("file",I),g(!0);try{const Y=await ee.post("/upload",G);q(J=>({...J,image_url:Y.data.url})),nt.success("Image uploaded successfully")}catch(Y){console.error(Y),nt.error("Failed to upload image")}finally{g(!1)}},M=async z=>{var I,G;z.preventDefault(),A(!0),b("");try{const Y={item_code:H.item_code,item_name:H.item_name,uom:H.uom,barcode:H.barcode||null,cost_price:Number(H.cost_price)||0,selling_price:Number(H.selling_price)||0,currency_id:H.currency_id||null,is_active:!!H.is_active,item_type:H.item_type||null,category_id:H.category_id||null,item_group_id:H.item_group_id||null,description:H.description||null,min_stock_level:Number(H.min_stock_level)||0,max_stock_level:Number(H.max_stock_level)||0,reorder_level:Number(H.reorder_level)||0,safety_stock:Number(H.safety_stock)||0,vat_on_purchase_id:H.vat_on_purchase_id||null,vat_on_sales_id:H.vat_on_sales_id||null,purchase_account_id:H.purchase_account_id||null,sales_account_id:H.sales_account_id||null,is_stockable:!!H.is_stockable,is_sellable:!!H.is_sellable,is_purchasable:!!H.is_purchasable};u?await ee.post("/inventory/items",Y):await ee.put(`/inventory/items/${l}`,Y),o("/inventory/items")}catch(Y){b(((G=(I=Y==null?void 0:Y.response)==null?void 0:I.data)==null?void 0:G.message)||"Failed to save item")}finally{A(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center text-white gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:u?"New Item":"Edit Item"}),e.jsx("p",{className:"text-sm mt-1",children:"Define item attributes, pricing and stock rules"})]}),e.jsx(Le,{to:"/inventory/items",className:"btn-success w-full md:w-auto text-center",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[d?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,v?e.jsx("div",{className:"text-sm text-red-600",children:v}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"md:col-span-2 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Code * (System Generated)"}),e.jsx("input",{type:"text",className:"input bg-gray-100 cursor-not-allowed",value:H.item_code,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Name *"}),e.jsx("input",{type:"text",className:"input",value:H.item_name,onChange:z=>q({...H,item_name:z.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Barcode"}),e.jsx("input",{type:"text",className:"input",value:H.barcode,onChange:z=>q({...H,barcode:z.target.value}),placeholder:"Scan or enter barcode"})]})]})}),e.jsxs("div",{className:"flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg p-4 bg-gray-50",children:[H.image_url?e.jsxs("div",{className:"relative w-full h-40 mb-2",children:[e.jsx("img",{src:H.image_url,alt:"Item",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",className:"absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs",onClick:()=>q({...H,image_url:""}),children:""})]}):e.jsxs("div",{className:"text-gray-400 mb-2 flex flex-col items-center",children:[e.jsx("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{children:"No Image"})]}),e.jsxs("label",{className:`btn-secondary cursor-pointer ${f?"opacity-50 cursor-not-allowed":""}`,children:[f?"Uploading...":"Upload Image",e.jsx("input",{type:"file",className:"hidden",onChange:V,accept:"image/*",disabled:f})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Type *"}),e.jsxs("select",{className:"input",value:H.item_type,onChange:z=>q({...H,item_type:z.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"-- Select Type --"}),i?e.jsx("option",{children:"Loading..."}):(Array.isArray(n)?n:[]).map(z=>z?e.jsx("option",{value:z.type_code,children:z.type_name},z.id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Category"}),e.jsxs("select",{className:"input",value:H.category_id,onChange:z=>q({...H,category_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Category --"}),a?e.jsx("option",{children:"Loading..."}):r.map(z=>z?e.jsx("option",{value:z.id,children:z.category_name},z.id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Base UOM"}),e.jsxs("select",{className:"input",value:H.uom,onChange:z=>q({...H,uom:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select UOM --"}),s?e.jsx("option",{children:"Loading..."}):t.map(z=>e.jsx("option",{value:z.uom_code,children:z.uom_code},z.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item Group"}),e.jsxs("select",{className:"input",value:H.item_group_id,onChange:z=>q({...H,item_group_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Group --"}),y.map(z=>z?e.jsx("option",{value:z.id,children:z.group_name},z.id):null)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:H.is_active?"ACTIVE":"INACTIVE",onChange:z=>q({...H,is_active:z.target.value==="ACTIVE"}),children:[e.jsx("option",{value:"ACTIVE",children:"ACTIVE"}),e.jsx("option",{value:"INACTIVE",children:"INACTIVE"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cost Price"}),e.jsx("input",{type:"number",className:"input",value:H.cost_price,onChange:z=>q({...H,cost_price:z.target.value}),min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Selling Price"}),e.jsx("input",{type:"number",className:"input",value:H.selling_price,onChange:z=>q({...H,selling_price:z.target.value}),min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:H.currency_id,onChange:z=>q({...H,currency_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Currency --"}),L.map(z=>e.jsxs("option",{value:z.id,children:[z.code," - ",z.name]},z.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 border-t pt-4",children:[e.jsx("h3",{className:"col-span-full font-semibold text-gray-700",children:"Financial Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"TAX on Purchase"}),e.jsxs("select",{className:"input",value:H.vat_on_purchase_id,onChange:z=>q({...H,vat_on_purchase_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Tax Code --"}),B.map(z=>e.jsxs("option",{value:z.id,children:[z.code," (",Number(z.rate_percent),"%)"]},z.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"TAX on Sales"}),e.jsxs("select",{className:"input",value:H.vat_on_sales_id,onChange:z=>q({...H,vat_on_sales_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Tax Code --"}),B.map(z=>e.jsxs("option",{value:z.id,children:[z.code," (",Number(z.rate_percent),"%)"]},z.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Account"}),e.jsxs("select",{className:"input",value:H.purchase_account_id,onChange:z=>q({...H,purchase_account_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Account --"}),N.filter(z=>!z.nature||["EXPENSE","COST_OF_SALES"].includes(z.nature)).map(z=>e.jsxs("option",{value:z.id,children:[z.code," - ",z.name]},z.id)),e.jsx("option",{disabled:!0,children:""}),N.map(z=>e.jsxs("option",{value:z.id,children:[z.code," - ",z.name]},`all-${z.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sales Account"}),e.jsxs("select",{className:"input",value:H.sales_account_id,onChange:z=>q({...H,sales_account_id:z.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Account --"}),N.filter(z=>!z.group_name||z.group_name.toUpperCase().includes("INCOME")||z.group_name.toUpperCase().includes("REVENUE")||z.group_name.toUpperCase().includes("SALES")).map(z=>e.jsxs("option",{value:z.id,children:[z.code," - ",z.name]},z.id)),e.jsx("option",{disabled:!0,children:""}),N.map(z=>e.jsxs("option",{value:z.id,children:[z.code," - ",z.name]},`all-${z.id}`))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("textarea",{className:"input",value:H.description,onChange:z=>q({...H,description:z.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Min Stock Level"}),e.jsx("input",{type:"number",className:"input",value:H.min_stock_level,onChange:z=>q({...H,min_stock_level:z.target.value}),min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Max Stock Level"}),e.jsx("input",{type:"number",className:"input",value:H.max_stock_level,onChange:z=>q({...H,max_stock_level:z.target.value}),min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reorder Level"}),e.jsx("input",{type:"number",className:"input",value:H.reorder_level,onChange:z=>q({...H,reorder_level:z.target.value}),min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Safety Stock"}),e.jsx("input",{type:"number",className:"input",value:H.safety_stock,onChange:z=>q({...H,safety_stock:z.target.value}),min:"0"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:H.is_stockable,onChange:z=>q({...H,is_stockable:z.target.checked})}),e.jsx("span",{children:"Is Stockable"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:H.is_sellable,onChange:z=>q({...H,is_sellable:z.target.checked})}),e.jsx("span",{children:"Is Sellable"})]}),e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:H.is_purchasable,onChange:z=>q({...H,is_purchasable:z.target.checked})}),e.jsx("span",{children:"Is Purchasable"})]})]}),e.jsxs("div",{className:"flex flex-col-reverse md:flex-row justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/items",className:"btn-secondary w-full md:w-auto text-center",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary w-full md:w-auto",disabled:h,children:h?"Saving...":"Save Item"})]})]})})]})})}function wY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let d=!0;return i(!0),o(""),ee.get("/inventory/warehouses").then(c=>{var h;d&&a(Array.isArray((h=c.data)==null?void 0:h.items)?c.data.items:[])}).catch(c=>{var h,A;d&&o(((A=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load warehouses")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=x.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.warehouse_code||"").toLowerCase().includes(d)||String(c.warehouse_name||"").toLowerCase().includes(d)||String(c.location||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Warehouse Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure warehouses for stock operations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/warehouses/new",className:"btn-success",children:"+ New Warehouse"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, location...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No warehouses found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.warehouse_code}),e.jsx("td",{children:d.warehouse_name}),e.jsx("td",{children:d.location||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d.is_active?"badge-success":"badge-error"}`,children:d.is_active?"ACTIVE":"INACTIVE"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/warehouses/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/warehouses/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function _Y(){const{id:t}=Ls(),s=ys(),r=t==="new",{scope:a}=ca(),[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState({warehouse_code:"",warehouse_name:"",location:"",is_active:!0}),[A,f]=x.useState([]),[g,v]=x.useState(""),[b,y]=x.useState("");x.useEffect(()=>{let N=!0;return d(""),ee.get("/admin/branches").then(S=>{var L;if(!N)return;const B=Array.isArray((L=S.data)==null?void 0:L.items)?S.data.items:[];f(B);const P=String((a==null?void 0:a.branchId)||"")||(B.length?String(B[0].id):"");v(P)}).catch(()=>{}),()=>{N=!1}},[a==null?void 0:a.branchId]),x.useEffect(()=>{if(r)return;let N=!0;return i(!0),d(""),ee.get(`/inventory/warehouses/${t}`).then(S=>{var P;if(!N)return;const B=(P=S.data)==null?void 0:P.item;B&&(h({warehouse_code:B.warehouse_code||"",warehouse_name:B.warehouse_name||"",location:B.location||"",is_active:!!B.is_active}),B.branch_id&&(v(String(B.branch_id)),y(String(B.branch_id))))}).catch(S=>{var B,P;N&&d(((P=(B=S==null?void 0:S.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to load warehouse")}).finally(()=>{N&&i(!1)}),()=>{N=!1}},[t,r]);const j=async N=>{var S,B;N.preventDefault(),o(!0),d("");try{if(!g)throw new Error("Select a branch for this warehouse");const P=A.find(H=>String(H.id)===String(g)),L=P?Number(P.company_id):void 0,U={warehouse_code:c.warehouse_code,warehouse_name:c.warehouse_name,location:c.location||null,is_active:!!c.is_active};r?await ee.post("/inventory/warehouses",U,{headers:{"x-branch-id":String(g),...L?{"x-company-id":String(L)}:{}}}):(b&&String(b)!==String(g)&&await ee.put(`/inventory/warehouses/${t}/link-branch`,{branch_id:Number(g)},{headers:{...L?{"x-company-id":String(L)}:{}}}),await ee.put(`/inventory/warehouses/${t}`,U,{headers:{"x-branch-id":String(g),...L?{"x-company-id":String(L)}:{}}})),s("/inventory/warehouses")}catch(P){d(((B=(S=P==null?void 0:P.response)==null?void 0:S.data)==null?void 0:B.message)||"Failed to save warehouse")}finally{o(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Warehouse":"Edit Warehouse"}),e.jsx("p",{className:"text-sm mt-1",children:"Maintain warehouse master data"})]}),e.jsx(Le,{to:"/inventory/warehouses",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[n?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,u?e.jsx("div",{className:"text-sm text-red-600",children:u}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branch *"}),e.jsxs("select",{className:"input",value:g,onChange:N=>v(N.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select a branch"}),A.map(N=>e.jsxs("option",{value:String(N.id),children:[N.name," (",N.company_name||`Company #${N.company_id}`,")"]},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse Code *"}),e.jsx("input",{type:"text",className:"input",value:c.warehouse_code,onChange:N=>h({...c,warehouse_code:N.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse Name *"}),e.jsx("input",{type:"text",className:"input",value:c.warehouse_name,onChange:N=>h({...c,warehouse_name:N.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("input",{type:"text",className:"input",value:c.location,onChange:N=>h({...c,location:N.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:c.is_active?"ACTIVE":"INACTIVE",onChange:N=>h({...c,is_active:N.target.value==="ACTIVE"}),children:[e.jsx("option",{value:"ACTIVE",children:"ACTIVE"}),e.jsx("option",{value:"INACTIVE",children:"INACTIVE"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/warehouses",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:l,children:l?"Saving...":"Save Warehouse"})]})]})})]})})}function SY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState(!1),[c,h]=x.useState(!1),[A,f]=x.useState(""),[g,v]=x.useState(null),[b,y]=x.useState(null),[j,N]=x.useState([]),[S,B]=x.useState(null),[P,L]=x.useState(null),[U,H]=x.useState(null),[q,V]=x.useState(null),[M,z]=x.useState(!1),[I,G]=x.useState(!1),[Y,J]=x.useState(""),[T,k]=x.useState(null),[D,Q]=x.useState([]),[C,E]=x.useState("");x.useEffect(()=>{let ce=!0;return i(!0),o(""),ee.get("/inventory/grn",{params:{grn_type:"LOCAL"}}).then(re=>{var de;ce&&a(Array.isArray((de=re.data)==null?void 0:de.items)?re.data.items:[])}).catch(re=>{var de,Ie;ce&&o(((Ie=(de=re==null?void 0:re.response)==null?void 0:de.data)==null?void 0:Ie.message)||"Failed to load GRNs")}).finally(()=>{ce&&i(!1)}),()=>{ce=!1}},[]);const w=x.useMemo(()=>{const ce=t.toLowerCase();return r.filter(re=>String(re.grn_no||"").toLowerCase().includes(ce)||String(re.supplier_name||"").toLowerCase().includes(ce)||String(re.status||"").toLowerCase().includes(ce))},[r,t]),O=ce=>{const re=String(ce||"").toUpperCase();return re!=="PENDING_APPROVAL"&&re!=="APPROVED"&&re!=="CANCELLED"},R=async ce=>{var re,de,Ie,le,Z,ve;L(null),d(!0),f("");try{const Ue=await ee.get(`/inventory/grn/${ce.id}`),Be=((re=Ue==null?void 0:Ue.data)==null?void 0:re.item)||{},_e=Be==null?void 0:Be.invoice_amount,Me=_e===""||_e==null?null:Number(_e||0);L({id:ce.id,grn_no:ce.grn_no,invoice_amount:Me,status:ce.status})}catch(Ue){f(((Ie=(de=Ue==null?void 0:Ue.response)==null?void 0:de.data)==null?void 0:Ie.message)||"Failed to load GRN")}if(g)await X();else try{h(!0);const Ue=await ee.get("/workflows"),Be=Array.isArray((le=Ue.data)==null?void 0:le.items)?Ue.data.items:[];v(Be),await ne(Be)}catch(Ue){f(((ve=(Z=Ue==null?void 0:Ue.response)==null?void 0:Z.data)==null?void 0:ve.message)||"Failed to load workflows")}finally{h(!1)}},X=async()=>{var Ie,le,Z;if(!g||!g.length){y(null),B(null),f("");return}const ce="/inventory/grn-local",re=ve=>String(ve||"").trim().toUpperCase().replace(/\s+/g,"_"),de=g.find(ve=>Number(ve.is_active)===1&&String(ve.document_route)===ce)||g.find(ve=>Number(ve.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(re(ve.document_type)))||null;if(y(de||null),B(null),!!de)try{h(!0);const Ue=(Ie=(await ee.get(`/workflows/${de.id}`)).data)==null?void 0:Ie.item,Be=Array.isArray(Ue==null?void 0:Ue.steps)?Ue.steps:[];N(Be);const _e=Be[0]||null;if(B(_e?{userId:_e.approver_user_id,name:_e.approver_name,stepName:_e.step_name,stepOrder:_e.step_order,approvalLimit:_e.approval_limit}:null),_e){const Me=(Array.isArray(_e.approvers)&&_e.approvers.length?_e.approvers[0].id:_e.approver_user_id)||null;H(Me)}else H(null)}catch(ve){f(((Z=(le=ve==null?void 0:ve.response)==null?void 0:le.data)==null?void 0:Z.message)||"Failed to load workflow details")}finally{h(!1)}},ne=async ce=>{var le,Z,ve;if(!ce||!ce.length){y(null),B(null),f("");return}const re="/inventory/grn-local",de=Ue=>String(Ue||"").trim().toUpperCase().replace(/\s+/g,"_"),Ie=ce.find(Ue=>Number(Ue.is_active)===1&&String(Ue.document_route)===re)||ce.find(Ue=>Number(Ue.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(de(Ue.document_type)))||null;if(y(Ie||null),B(null),!!Ie)try{h(!0);const Be=(le=(await ee.get(`/workflows/${Ie.id}`)).data)==null?void 0:le.item,_e=Array.isArray(Be==null?void 0:Be.steps)?Be.steps:[];N(_e);const Me=_e[0]||null;if(B(Me?{userId:Me.approver_user_id,name:Me.approver_name,stepName:Me.step_name,stepOrder:Me.step_order,approvalLimit:Me.approval_limit}:null),Me){const Ye=(Array.isArray(Me.approvers)&&Me.approvers.length?Me.approvers[0].id:Me.approver_user_id)||null;H(Ye)}else H(null)}catch(Ue){f(((ve=(Z=Ue==null?void 0:Ue.response)==null?void 0:Z.data)==null?void 0:ve.message)||"Failed to load workflow details")}finally{h(!1)}},te=async()=>{var ce,re;if(P){V(P.id),f("");try{await ee.post(`/inventory/grn/${P.id}/submit`,{amount:P.invoice_amount,workflow_id:b?b.id:null,target_user_id:U||null}),a(de=>de.map(Ie=>Ie.id===P.id?{...Ie,status:"PENDING_APPROVAL"}:Ie)),d(!1)}catch(de){f(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to forward for approval")}finally{V(null)}}},oe=async ce=>{var re,de,Ie,le;z(!0),G(!0),J(""),k(null),Q([]),E("");try{const Z=await ee.get(`/inventory/grn/${ce.id}`),ve=((re=Z==null?void 0:Z.data)==null?void 0:re.item)||{},Ue=Array.isArray(ve==null?void 0:ve.details)?ve.details:[];k(ve),Q(Ue);const Be=Number((ve==null?void 0:ve.po_id)||0)||0;if(Be)try{const _e=await ee.get("/purchase/orders"),Ye=(Array.isArray((de=_e==null?void 0:_e.data)==null?void 0:de.items)?_e.data.items:[]).find(ot=>Number(ot.id)===Be);E(Ye?Ye.po_no||String(Ye.id):String(Be))}catch{E(String(Be))}}catch(Z){J(((le=(Ie=Z==null?void 0:Z.response)==null?void 0:Ie.data)==null?void 0:le.message)||"Failed to load GRN details")}finally{G(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Material Receipt (GRN) - Local"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive local purchase deliveries"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/grn-local/new",className:"btn-success",children:"+ New GRN"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by GRN no, supplier, status...",className:"input max-w-md",value:t,onChange:ce=>s(ce.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!w.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No GRNs found"})}):null,w.map(ce=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:ce.grn_no}),e.jsx("td",{children:ce.grn_date?String(ce.grn_date).slice(0,10):"-"}),e.jsx("td",{children:ce.supplier_name||"-"}),e.jsx("td",{children:ce.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:ce.status||"DRAFT"})}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/inventory/grn-local/${ce.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx("button",{type:"button",className:"text-brand hover:text-brand-700 text-sm font-medium",onClick:()=>oe(ce),children:"Details"}),String(ce.status||"").toUpperCase()!=="APPROVED"&&e.jsx(Le,{to:`/inventory/grn-local/${ce.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"})]}),String(ce.status||"").toUpperCase()==="APPROVED"?e.jsx("span",{className:"ml-2 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:()=>R(ce),disabled:q===ce.id||!O(ce.status),children:q===ce.id?"Forwarding...":"Forward for Approval"})]})]},ce.id))]})]})})]})]}),u?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),y(null),B(null),f("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:P==null?void 0:P.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:c?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:A?e.jsx("div",{className:"text-sm text-red-600",children:A}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const re=Array.isArray(j)&&j.length>0?j[0]:null,de=re?Array.isArray(re.approvers)&&re.approvers.length?re.approvers.map(Ie=>({id:Ie.id,name:Ie.username})):re.approver_user_id?[{id:re.approver_user_id,name:re.approver_name||String(re.approver_user_id)}]:[]:[];return de.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:U||"",onChange:Ie=>H(Ie.target.value?Number(Ie.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),de.map(Ie=>e.jsx("option",{value:Ie.id,children:Ie.name},Ie.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),y(null),B(null),f("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:te,disabled:q!=null,children:q!=null?"Forwarding...":"Forward"})]})]})}):null,M?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[900px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"View GRN Details"}),e.jsx("button",{type:"button",onClick:()=>{z(!1),k(null),Q([]),J("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[I?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,Y?e.jsx("div",{className:"text-sm text-red-600",children:Y}):null,T?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"GRN No"}),e.jsx("div",{className:"font-semibold",children:T.grn_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("div",{className:"font-semibold",children:T.grn_date?String(T.grn_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-semibold",children:T.supplier_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-semibold",children:T.warehouse_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),e.jsx("div",{className:"font-semibold",children:T.status||"DRAFT"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Purchase Order"}),e.jsx("div",{className:"font-semibold",children:C||(T.po_id?String(T.po_id):"-")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery No"}),e.jsx("div",{className:"font-semibold",children:T.delivery_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery Date"}),e.jsx("div",{className:"font-semibold",children:T.delivery_date?String(T.delivery_date).slice(0,10):"-"})]})]}):null,e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Remarks"})]})}),e.jsxs("tbody",{children:[D.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No item details"})}),D.map((ce,re)=>{const de=ce.line_amount==null||ce.line_amount===""?Number(ce.qty_accepted||0)*Number(ce.unit_price||0):Number(ce.line_amount||0);return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:ce.item_code||""}),e.jsx("td",{children:ce.item_name||""}),e.jsx("td",{children:ce.qty_ordered??""}),e.jsx("td",{children:ce.qty_received??""}),e.jsx("td",{children:ce.qty_accepted??""}),e.jsx("td",{children:ce.uom||""}),e.jsx("td",{children:Number(ce.unit_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:Number(de||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:ce.batch_serial||ce.batch_number||""}),e.jsx("td",{children:ce.remarks||""})]},re)})]})]})})]}),e.jsx("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{z(!1),k(null),Q([]),J("")},children:"Close"})})]})}):null]})}function Wu(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function CY(){const{id:t}=Ls(),s=ys(),r=ma(),a=t==="new",n=!!t&&t!=="new"&&(r.pathname.includes("/edit")||(()=>{try{const be=new URLSearchParams(r.search||""),Ce=String(be.get("mode")||"").toLowerCase(),Te=String(be.get("edit")||"").toLowerCase();return Ce==="edit"||Te==="1"||Te==="true"}catch{return!1}})()),i=!!t&&t!=="new"&&!n,[l,o]=x.useState(!1),[u,d]=x.useState(!1),[c,h]=x.useState(""),[A,f]=x.useState(!1),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState(null),[S,B]=x.useState(null),[P,L]=x.useState([]),[U,H]=x.useState(!1),[q,V]=x.useState(null),[M,z]=x.useState(null),[I,G]=x.useState([]),[Y,J]=x.useState([]),[T,k]=x.useState([]),[D,Q]=x.useState([]),{uoms:C}=el(),[E,w]=x.useState([]),[O,R]=x.useState([]),[X,ne]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",lineIdx:null}),[te,oe]=x.useState({grn_no:"",grn_date:Wu(new Date),supplier_id:"",warehouse_id:"",po_id:"",invoice_no:"",invoice_date:"",invoice_amount:"",invoice_due_date:"",delivery_number:"",delivery_date:"",status:"DRAFT",remarks:"",details:[]}),ce=String(te.status||"").toUpperCase()==="APPROVED",re=i&&ce,de=x.useRef(a);x.useEffect(()=>{let be=!0;return h(""),Promise.all([ee.get("/inventory/items"),ee.get("/purchase/suppliers"),ee.get("/inventory/warehouses"),ee.get("/purchase/orders",{params:{status:"APPROVED"}}),ee.get("/sales/prices/standard"),ee.get("/inventory/unit-conversions")]).then(([Ce,Te,ue,ge,Ve,tt])=>{var ze,Fe,xe,we,Xe,ut;if(!be)return;G(Array.isArray((ze=Ce.data)==null?void 0:ze.items)?Ce.data.items:[]),J(Array.isArray((Fe=Te.data)==null?void 0:Fe.items)?Te.data.items.filter(ft=>String(ft.supplier_type||"").toUpperCase()==="LOCAL"):[]),k(Array.isArray((xe=ue.data)==null?void 0:xe.items)?ue.data.items:[]);const ht=(Array.isArray((we=ge.data)==null?void 0:we.items)?ge.data.items:[]).filter(ft=>String(ft.po_type||"").toUpperCase()==="LOCAL"&&String(ft.status||"").toUpperCase()==="APPROVED");Q(ht),w(Array.isArray((Xe=Ve.data)==null?void 0:Xe.items)?Ve.data.items:[]),R(Array.isArray((ut=tt.data)==null?void 0:ut.items)?tt.data.items:[]),a&&ee.get("/inventory/grn",{params:{grn_type:"LOCAL"}}).then(ft=>{var vt;const mt=Array.isArray((vt=ft.data)==null?void 0:vt.items)?ft.data.items:[],pt=new Set(mt.map(Ot=>Ot.po_id||Ot.poId).filter(Ot=>Ot!=null).map(Ot=>String(Ot)));Q(Ot=>Ot.filter(Ae=>!pt.has(String(Ae.id))))}).catch(()=>{})}).catch(Ce=>{var Te,ue;be&&h(((ue=(Te=Ce==null?void 0:Ce.response)==null?void 0:Te.data)==null?void 0:ue.message)||"Failed to load lookups")}),()=>{be=!1}},[]);const Ie=x.useMemo(()=>{const be=Array.isArray(C)?C:[],Ce=be.find(Te=>String(Te.uom_code||"").toUpperCase()==="PCS")||be[0];return Ce&&Ce.uom_code?Ce.uom_code:"PCS"},[C]);x.useCallback((be,Ce)=>{const Te=Array.isArray(E)?E:[],ue=String(be||""),ge=Ce?String(Ce):"",Ve=Te.filter(ht=>String(ht.product_id)===ue&&(ge?String(ht.uom||"")===ge:!0)).sort((ht,ze)=>{const Fe=ht.effective_date?new Date(ht.effective_date).getTime():0;return(ze.effective_date?new Date(ze.effective_date).getTime():0)-Fe||new Date(ze.created_at).getTime()-new Date(ht.created_at).getTime()});if(Ve.length>0&&Ve[0].cost_price!=null)return String(Ve[0].cost_price);const tt=Te.filter(ht=>String(ht.product_id)===ue).sort((ht,ze)=>{const Fe=ht.effective_date?new Date(ht.effective_date).getTime():0;return(ze.effective_date?new Date(ze.effective_date).getTime():0)-Fe||new Date(ze.created_at).getTime()-new Date(ht.created_at).getTime()});if(tt.length>0&&tt[0].cost_price!=null)return String(tt[0].cost_price);const Ze=(Array.isArray(I)?I:[]).find(ht=>String(ht.id)===ue);return Ze&&Ze.cost_price!=null?String(Ze.cost_price):""},[E,I]),x.useMemo(()=>{const be=new Map;for(const Ce of Array.isArray(E)?E:[]){const Te=String(Ce.product_id);be.has(Te)||be.set(Te,Ce)}return be},[E]),x.useEffect(()=>{a&&ee.get("/inventory/grn/next-no?type=LOCAL").then(be=>{var Ce;(Ce=be.data)!=null&&Ce.nextNo&&oe(Te=>({...Te,grn_no:be.data.nextNo}))}).catch(console.error)},[a]),x.useEffect(()=>{if(a)return;let be=!0;return o(!0),h(""),ee.get(`/inventory/grn/${t}`).then(Ce=>{var ge;if(!be)return;const Te=(ge=Ce.data)==null?void 0:ge.item,ue=Array.isArray(Te==null?void 0:Te.details)?Te.details:[];Te&&(oe({grn_no:Te.grn_no||"",grn_date:Wu(Te.grn_date),supplier_id:Te.supplier_id?String(Te.supplier_id):"",warehouse_id:Te.warehouse_id?String(Te.warehouse_id):"",po_id:Te.po_id?String(Te.po_id):"",invoice_no:Te.invoice_no||"",invoice_date:Wu(Te.invoice_date),invoice_amount:Te.invoice_amount!=null?String(Te.invoice_amount):"",invoice_due_date:Wu(Te.invoice_due_date),delivery_number:Te.delivery_number||"",delivery_date:Wu(Te.delivery_date),status:Te.status||"DRAFT",remarks:Te.remarks||"",details:ue.map(Ve=>({item_id:Ve.item_id?String(Ve.item_id):"",qty_ordered:Ve.qty_ordered??"",input_qty:Ve.input_qty??Ve.qty_received??"",input_uom:Ve.input_uom||Ve.uom||"",qty_received:Ve.qty_received??"",qty_accepted:Ve.qty_accepted??"",qty_rejected:Ve.qty_rejected??"",uom:Ve.uom||"",unit_price:Ve.unit_price!=null?String(Ve.unit_price):"",amount:Ve.line_amount!=null?String(Ve.line_amount):(()=>{const tt=Ve.unit_price!=null?Number(Ve.unit_price):0,Ze=Ve.qty_accepted!=null?Number(Ve.qty_accepted):Ve.qty_received!=null?Number(Ve.qty_received):Ve.qty_ordered!=null?Number(Ve.qty_ordered):0;return String(Number(Ze||0)*Number(tt||0))})(),batch_serial:Ve.batch_serial||Ve.batch_number||"",mfg_date:Wu(Ve.mfg_date),expiry_date:Wu(Ve.expiry_date),inspection_status:Ve.inspection_status||"PENDING",line_remarks:Ve.remarks||""}))}),de.current=!1,Te.po_id&&ee.get(`/purchase/orders/${Te.po_id}`).then(Ve=>{var Ze;const tt=(Ze=Ve.data)==null?void 0:Ze.item;tt&&Q(ht=>ht.some(Fe=>String(Fe.id)===String(tt.id))?ht:[...ht,tt])}).catch(()=>{}))}).catch(Ce=>{var Te,ue;be&&h(((ue=(Te=Ce==null?void 0:Ce.response)==null?void 0:Te.data)==null?void 0:ue.message)||"Failed to load GRN")}).finally(()=>{be&&o(!1)}),()=>{be=!1}},[t,a]);const le=x.useMemo(()=>{const be=new Map;for(const Ce of I)be.set(String(Ce.id),Ce);return be},[I]),Z=x.useMemo(()=>{const be=new Map;for(const Ce of Array.isArray(O)?O:[]){if(!Number(Ce.is_active))continue;const Te=`${Ce.item_id}|${Ce.from_uom}|${Ce.to_uom}`,ue=Number(Ce.conversion_factor||0);Number.isFinite(ue)&&ue>0&&be.set(Te,ue)}return be},[O]),ve=x.useMemo(()=>{const be=te.supplier_id?String(te.supplier_id):"";return be?D.filter(Ce=>String(Ce.supplier_id)===be):D},[D,te.supplier_id]);x.useEffect(()=>{if(!te.po_id||!a)return;ve.some(Ce=>String(Ce.id)===String(te.po_id))||oe(Ce=>({...Ce,po_id:""}))},[ve,te.po_id]);const Ue=()=>{oe(be=>{var Ce,Te,ue,ge;return{...be,details:[...be.details,{item_id:(Ce=I[0])!=null&&Ce.id?String(I[0].id):"",qty_ordered:"",input_qty:"",input_uom:((Te=I[0])==null?void 0:Te.uom)&&String(I[0].uom)||(Ie?String(Ie):""),qty_received:"",uom:((ue=I[0])==null?void 0:ue.uom)&&String(I[0].uom)||(Ie?String(Ie):""),unit_price:String(((ge=I[0])==null?void 0:ge.cost_price)??"")}]}})},Be=be=>{oe(Ce=>({...Ce,details:Ce.details.filter((Te,ue)=>ue!==be)}))},_e=(be,Ce)=>{oe(Te=>{const ue=Te.details.map((vt,Ot)=>Ot===be?{...vt,...Ce}:vt);let ge=ue[be];Object.prototype.hasOwnProperty.call(Ce,"qty_ordered")&&(ge.qty_received===""||ge.qty_received==null)&&(ge={...ge,qty_received:Ce.qty_ordered},ue[be]=ge);const Ve=Object.prototype.hasOwnProperty.call(Ce,"qty_received_direct")&&Ce.qty_received_direct!=null&&Number.isFinite(Number(Ce.qty_received_direct))?Number(Ce.qty_received_direct):null;if(Object.prototype.hasOwnProperty.call(Ce,"item_id")){const vt=le.get(String(Ce.item_id)),Ot=(vt==null?void 0:vt.uom)&&String(vt.uom)||ge.uom&&String(ge.uom)||(Ie?String(Ie):""),Ae=String((vt==null?void 0:vt.cost_price)??"");ge={...ge,uom:Ot,input_uom:Ot,input_qty:"",qty_received:"",qty_accepted:"",unit_price:Ae},ue[be]=ge}const tt=ge.uom&&String(ge.uom)||(Ie?String(Ie):""),Ze=ge.input_uom&&String(ge.input_uom)?String(ge.input_uom):tt,ht=!(ge.input_qty===""||ge.input_qty==null),ze=ht?Number(ge.input_qty):null,Fe=!ht&&Number.isFinite(Number(ge.qty_received))?Number(ge.qty_received):null;let xe=ze!=null&&Number.isFinite(ze)?ze:Fe;if(Ve!=null&&(xe=Ve),Ve==null&&xe!=null&&Ze&&tt&&Ze!==tt){const vt=`${ge.item_id}|${Ze}|${tt}`,Ot=Z.get(vt);Number.isFinite(Ot)&&Ot>0&&(xe=xe*Ot)}const we=xe!=null&&Number.isFinite(xe)?xe:"",Xe=ge.unit_price===""?0:Number(ge.unit_price||0),ut=ge.qty_accepted===""||ge.qty_accepted==null?null:Number(ge.qty_accepted||0),ft=we===""||we==null?null:Number(we||0),mt=ge.qty_ordered===""||ge.qty_ordered==null?null:Number(ge.qty_ordered||0),pt=ut??null??ft??null??mt??0;return ue[be]={...ge,uom:tt,input_uom:Ze,qty_received:we,qty_accepted:ge.qty_accepted===""||ge.qty_accepted==null?we:ge.qty_accepted,amount:String(Number(pt||0)*Xe)},{...Te,details:ue}})},Me=(be,Ce)=>{const Te=Ce?le.get(String(Ce)):null,ue=(Te==null?void 0:Te.uom)&&String(Te.uom)||(Ie?String(Ie):""),ge=String((Te==null?void 0:Te.cost_price)??"");_e(be,{item_id:Ce,uom:ue,input_uom:ue,input_qty:"",unit_price:ge})};x.useEffect(()=>{if(!te.po_id||!de.current)return;let be=!0;return o(!0),ee.get(`/purchase/orders/${te.po_id}`).then(Ce=>{var ge,Ve,tt;if(!be)return;const Te=(ge=Ce.data)==null?void 0:ge.item,ue=Array.isArray((tt=(Ve=Ce.data)==null?void 0:Ve.item)==null?void 0:tt.details)?Ce.data.item.details:[];Te&&oe(Ze=>({...Ze,supplier_id:Te.supplier_id?String(Te.supplier_id):Ze.supplier_id,warehouse_id:Te.warehouse_id?String(Te.warehouse_id):Ze.warehouse_id,details:ue.map(ht=>{const ze=I.find(xe=>String(xe.id)===String(ht.item_id)),Fe=(ze==null?void 0:ze.uom)&&String(ze.uom)||(Ie?String(Ie):"");return{item_id:ht.item_id?String(ht.item_id):"",qty_ordered:ht.qty??"",input_qty:"",input_uom:Fe,qty_received:ht.qty??"",qty_accepted:"",qty_rejected:"",uom:Fe,unit_price:String((ze==null?void 0:ze.cost_price)??""),amount:"",batch_serial:"",mfg_date:"",expiry_date:"",inspection_status:"PENDING",line_remarks:""}})}))}).catch(Ce=>{var Te,ue;h(((ue=(Te=Ce==null?void 0:Ce.response)==null?void 0:Te.data)==null?void 0:ue.message)||"Failed to load PO details")}).finally(()=>{be&&o(!1)}),()=>{be=!1}},[te.po_id]);const Ye=async be=>{var Ce,Te;be.preventDefault(),d(!0),h("");try{const ue={grn_no:te.grn_no||null,grn_date:te.grn_date,grn_type:"LOCAL",supplier_id:te.supplier_id?Number(te.supplier_id):null,warehouse_id:te.warehouse_id?Number(te.warehouse_id):null,po_id:te.po_id?Number(te.po_id):null,invoice_no:te.invoice_no||null,invoice_date:te.invoice_date||null,invoice_amount:te.invoice_amount===""||te.invoice_amount==null?null:Number(te.invoice_amount),invoice_due_date:te.invoice_due_date||null,delivery_number:te.delivery_number||null,delivery_date:te.delivery_date||null,remarks:te.remarks||null,details:(te.details||[]).map(ge=>({item_id:ge.item_id?Number(ge.item_id):null,qty_ordered:ge.qty_ordered===""?null:Number(ge.qty_ordered),qty_received:ge.qty_received===""?null:Number(ge.qty_received),qty_accepted:ge.qty_accepted===""?null:Number(ge.qty_accepted),input_qty:ge.input_qty===""?null:Number(ge.input_qty),input_uom:ge.input_uom||null,uom:ge.uom||null,unit_price:ge.unit_price===""?null:Number(ge.unit_price),line_amount:ge.amount===""?null:Number(ge.amount),batch_serial:ge.batch_serial||null,mfg_date:ge.mfg_date||null,expiry_date:ge.expiry_date||null,inspection_status:ge.inspection_status||"PENDING",remarks:ge.line_remarks||null}))};if(!ue.grn_date||!ue.supplier_id)throw new Error("GRN date and supplier are required");if(!ue.po_id)throw new Error("Purchase order is required");if(!ue.invoice_no||!ue.invoice_date)throw new Error("Invoice number and date are required");a?await ee.post("/inventory/grn",ue):await ee.put(`/inventory/grn/${t}`,ue),s("/inventory/grn-local")}catch(ue){h(((Te=(Ce=ue==null?void 0:ue.response)==null?void 0:Ce.data)==null?void 0:Te.message)||(ue==null?void 0:ue.message)||"Failed to save GRN")}finally{d(!1)}},ot=async()=>{var be,Ce,Te;if(!a){H(!0),y("");try{const ue=await ee.post(`/inventory/grn/${t}/submit`,{amount:te.invoice_amount===""||te.invoice_amount==null?null:Number(te.invoice_amount||0),workflow_id:j?j.id:null,target_user_id:M||null}),ge=((be=ue==null?void 0:ue.data)==null?void 0:be.status)||"PENDING_APPROVAL";oe(Ve=>({...Ve,status:ge})),f(!1)}catch(ue){y(((Te=(Ce=ue==null?void 0:ue.response)==null?void 0:Ce.data)==null?void 0:Te.message)||"Failed to forward for approval")}finally{H(!1)}}},Ke=async()=>{var be,Ce,Te;if(!a)if(f(!0),y(""),q)await ct();else try{v(!0);const ue=await ee.get("/workflows"),ge=Array.isArray((be=ue.data)==null?void 0:be.items)?ue.data.items:[];V(ge),await xt(ge)}catch(ue){y(((Te=(Ce=ue==null?void 0:ue.response)==null?void 0:Ce.data)==null?void 0:Te.message)||"Failed to load workflows")}finally{v(!1)}},ct=async()=>{var ue,ge,Ve;if(!q||!q.length){N(null),B(null),y("");return}const be="/inventory/grn-local",Ce=tt=>String(tt||"").trim().toUpperCase().replace(/\s+/g,"_"),Te=q.find(tt=>Number(tt.is_active)===1&&String(tt.document_route)===be)||q.find(tt=>Number(tt.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(Ce(tt.document_type)))||null;if(N(Te||null),B(null),!!Te)try{v(!0);const Ze=(ue=(await ee.get(`/workflows/${Te.id}`)).data)==null?void 0:ue.item,ht=Array.isArray(Ze==null?void 0:Ze.steps)?Ze.steps:[];L(ht);const ze=ht[0]||null;if(B(ze?{userId:ze.approver_user_id,name:ze.approver_name,stepName:ze.step_name,stepOrder:ze.step_order,approvalLimit:ze.approval_limit}:null),ze){const Fe=(Array.isArray(ze.approvers)&&ze.approvers.length?ze.approvers[0].id:ze.approver_user_id)||null;z(Fe)}else z(null)}catch(tt){y(((Ve=(ge=tt==null?void 0:tt.response)==null?void 0:ge.data)==null?void 0:Ve.message)||"Failed to load workflow details")}finally{v(!1)}},xt=async be=>{var ge,Ve,tt;if(!be||!be.length){N(null),B(null),y("");return}const Ce="/inventory/grn-local",Te=Ze=>String(Ze||"").trim().toUpperCase().replace(/\s+/g,"_"),ue=be.find(Ze=>Number(Ze.is_active)===1&&String(Ze.document_route)===Ce)||be.find(Ze=>Number(Ze.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(Te(Ze.document_type)))||null;if(N(ue||null),B(null),!!ue)try{v(!0);const ht=(ge=(await ee.get(`/workflows/${ue.id}`)).data)==null?void 0:ge.item,ze=Array.isArray(ht==null?void 0:ht.steps)?ht.steps:[];L(ze);const Fe=ze[0]||null;if(B(Fe?{userId:Fe.approver_user_id,name:Fe.approver_name,stepName:Fe.step_name,stepOrder:Fe.step_order,approvalLimit:Fe.approval_limit}:null),Fe){const xe=(Array.isArray(Fe.approvers)&&Fe.approvers.length?Fe.approvers[0].id:Fe.approver_user_id)||null;z(xe)}else z(null)}catch(Ze){y(((tt=(Ve=Ze==null?void 0:Ze.response)==null?void 0:Ve.data)==null?void 0:tt.message)||"Failed to load workflow details")}finally{v(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:a?"New GRN (Local)":i?"View GRN (Local)":"Edit GRN (Local)"}),e.jsx("p",{className:"text-sm mt-1",children:"Goods receipt note for local purchases"})]}),e.jsx(Le,{to:"/inventory/grn-local",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("form",{onSubmit:Ye,className:"space-y-6",children:e.jsxs("fieldset",{disabled:i,className:i?"disabled-light-blue":"",children:[l?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,c?e.jsx("div",{className:"text-sm text-red-600",children:c}):null,e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN No"}),e.jsx("input",{type:"text",className:"input w-full",value:te.grn_no,onChange:be=>oe({...te,grn_no:be.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN Date *"}),e.jsx("input",{type:"date",className:"input w-full",value:te.grn_date,onChange:be=>oe({...te,grn_date:be.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input w-full",value:te.warehouse_id,onChange:be=>oe({...te,warehouse_id:be.target.value}),children:[e.jsx("option",{value:"",children:"Select warehouse..."}),T.map(be=>e.jsx("option",{value:String(be.id),children:(be.warehouse_code?`${be.warehouse_code} - `:"")+be.warehouse_name},be.id))]})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{className:"input w-full",value:te.supplier_id,onChange:be=>oe({...te,supplier_id:be.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select supplier..."}),Y.map(be=>e.jsx("option",{value:String(be.id),children:be.supplier_name},be.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Order *"}),e.jsxs("select",{className:"input w-full",value:te.po_id,onChange:be=>oe({...te,po_id:be.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select purchase order..."}),ve.map(be=>e.jsx("option",{value:String(be.id),children:be.po_no},be.id))]})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Invoice & Delivery Details"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier's Invoice Number *"}),e.jsx("input",{type:"text",className:"input w-full",value:te.invoice_no,onChange:be=>oe({...te,invoice_no:be.target.value}),placeholder:"Enter number",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice Date *"}),e.jsx("input",{type:"date",className:"input w-full",value:te.invoice_date,onChange:be=>oe({...te,invoice_date:be.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{type:"date",className:"input w-full",value:te.invoice_due_date,onChange:be=>oe({...te,invoice_due_date:be.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Number"}),e.jsx("input",{type:"text",className:"input w-full",value:te.delivery_number,onChange:be=>oe({...te,delivery_number:be.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"input w-full",value:te.delivery_date,onChange:be=>oe({...te,delivery_date:be.target.value})})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:te.remarks,onChange:be=>oe({...te,remarks:be.target.value})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Items"}),e.jsx("button",{type:"button",className:"btn-success",onClick:Ue,children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Input UOM"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Mfg Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Inspection"}),e.jsx("th",{children:"Remarks"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[te.details.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"14",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:'No items. Click "Add Item" to begin.'})}),te.details.map((be,Ce)=>{const Te=be.item_id?le.get(String(be.item_id)):null,ue=Te?`${Te.item_code} - ${Te.item_name}`:"Select item...";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("select",{className:"input min-w-[320px] w-[480px]",value:be.item_id,onChange:ge=>Me(Ce,ge.target.value),children:[e.jsx("option",{value:"",children:"Select item..."}),I.map(ge=>e.jsxs("option",{value:String(ge.id),children:[ge.item_code," - ",ge.item_name]},ge.id))]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:ue})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:be.qty_ordered,onChange:ge=>_e(Ce,{qty_ordered:ge.target.value})})}),e.jsxs("td",{className:"pr-6 pl-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{className:"input w-auto min-w-[160px] flex-none",value:be.input_uom||Ie||"",onChange:ge=>_e(Ce,{input_uom:ge.target.value}),children:[e.jsx("option",{value:"",children:"Select UOM"}),(Array.isArray(C)?C:[]).map(ge=>e.jsx("option",{value:ge.uom_code,children:ge.uom_name?`${ge.uom_name} (${ge.uom_code})`:ge.uom_code},ge.id))]})}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:(()=>{const ge=String(be.input_uom||""),Ve=String(be.uom||Ie||""),tt=`${be.item_id}|${ge}|${Ve}`,Ze=Z.get(tt);return Number(Ze)>0?`Conversion: 1 ${ge} = ${Number(Ze).toFixed(6)} ${Ve}`:ge&&Ve&&ge===Ve?"":e.jsxs(e.Fragment,{children:["No conversion defined for ",ge,"  ",Ve,"."," ",e.jsx(Le,{to:"/inventory/unit-conversions",className:"text-brand font-medium underline",children:"Define conversion"})]})})()})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:be.qty_received,onChange:ge=>_e(Ce,{qty_received_direct:ge.target.value})})}),e.jsx("td",{children:(()=>{const ge=String(be.uom||Ie||""),Ve=(Array.isArray(O)?O:[]).filter(ze=>Number(ze.is_active)&&Number(ze.item_id)===Number(be.item_id)&&String(ze.to_uom)===ge).map(ze=>String(ze.from_uom)),tt=String(be.input_uom||""),Ze=tt&&tt!==ge?tt:Ve[0]||"";return Ve.length>0&&Ze&&Ze!==ge?e.jsx("button",{type:"button",className:"px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors flex-none",onClick:()=>ne({open:!0,itemId:be.item_id,defaultUom:ge,currentUom:Ze,lineIdx:Ce}),children:`number of ${Ze}`}):null})()}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:be.qty_accepted,onChange:ge=>_e(Ce,{qty_accepted:ge.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:be.unit_price,onChange:ge=>_e(Ce,{unit_price:ge.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[160px]",value:be.amount,onChange:ge=>_e(Ce,{amount:ge.target.value}),readOnly:!0})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[160px]",value:be.batch_serial,onChange:ge=>_e(Ce,{batch_serial:ge.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:be.mfg_date,onChange:ge=>_e(Ce,{mfg_date:ge.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:be.expiry_date,onChange:ge=>_e(Ce,{expiry_date:ge.target.value})})}),e.jsx("td",{children:e.jsxs("select",{className:"input min-w-[140px]",value:be.inspection_status||"PENDING",onChange:ge=>_e(Ce,{inspection_status:ge.target.value}),children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"PASSED",children:"Passed"}),e.jsx("option",{value:"FAILED",children:"Failed"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[200px]",value:be.line_remarks,onChange:ge=>_e(Ce,{line_remarks:ge.target.value})})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>Be(Ce),children:"Remove"})})]},Ce)})]})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/grn-local",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||i,children:u?"Saving...":"Save GRN"}),e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:Ke,disabled:u||a||re,children:String(te.status||"").toUpperCase()==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):"Forward for Approval"})]})]})})})]}),A?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{f(!1),N(null),B(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:te.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:j?`${j.workflow_name} (${j.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Ce=Array.isArray(P)&&P.length>0?P[0]:null,Te=Ce?Array.isArray(Ce.approvers)&&Ce.approvers.length?Ce.approvers.map(ue=>({id:ue.id,name:ue.username})):Ce.approver_user_id?[{id:Ce.approver_user_id,name:Ce.approver_name||String(Ce.approver_user_id)}]:[]:[];return Te.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:M||"",onChange:ue=>z(ue.target.value?Number(ue.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Te.map(ue=>e.jsx("option",{value:ue.id,children:ue.name},ue.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:j?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{f(!1),N(null),B(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:ot,disabled:U||a,children:U?"Forwarding...":"Forward"})]})]})}):null,e.jsx(sd,{open:X.open,onClose:()=>ne({open:!1,itemId:null,defaultUom:"",currentUom:"",lineIdx:null}),itemId:X.itemId?Number(X.itemId):null,defaultUom:String(X.defaultUom||""),currentUom:String(X.currentUom||""),conversions:O,onApply:({converted_qty:be})=>{const Ce=X.lineIdx;Ce!=null&&_e(Ce,{qty_received_direct:be})}})]})}function kY(){ys();const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState(null),[c,h]=x.useState(!1),[A,f]=x.useState(!1),[g,v]=x.useState(""),[b,y]=x.useState(null),[j,N]=x.useState(null),[S,B]=x.useState([]),[P,L]=x.useState(!1),[U,H]=x.useState(null),[q,V]=x.useState(null),[M,z]=x.useState(null),[I,G]=x.useState(!1),[Y,J]=x.useState(!1),[T,k]=x.useState(""),[D,Q]=x.useState(null),[C,E]=x.useState([]),[w,O]=x.useState("");x.useEffect(()=>{let de=!0;return i(!0),o(""),ee.get("/inventory/grn",{params:{grn_type:"IMPORT"}}).then(Ie=>{var le;de&&a(Array.isArray((le=Ie.data)==null?void 0:le.items)?Ie.data.items:[])}).catch(Ie=>{var le,Z;de&&o(((Z=(le=Ie==null?void 0:Ie.response)==null?void 0:le.data)==null?void 0:Z.message)||"Failed to load GRNs")}).finally(()=>{de&&i(!1)}),()=>{de=!1}},[]);const R=x.useMemo(()=>{const de=t.toLowerCase();return r.filter(Ie=>String(Ie.grn_no||"").toLowerCase().includes(de)||String(Ie.supplier_name||"").toLowerCase().includes(de)||String(Ie.status||"").toLowerCase().includes(de))},[r,t]),X=de=>{const Ie=String(de||"").toUpperCase();return Ie!=="PENDING_APPROVAL"&&Ie!=="APPROVED"&&Ie!=="CANCELLED"},ne=async de=>{var Ie,le,Z,ve,Ue,Be;z(null),h(!0),v("");try{const _e=await ee.get(`/inventory/grn/${de.id}`),Me=((Ie=_e==null?void 0:_e.data)==null?void 0:Ie.item)||{},Ye=Me==null?void 0:Me.invoice_amount,ot=Ye===""||Ye==null?null:Number(Ye||0);z({id:de.id,grn_no:de.grn_no,invoice_amount:ot,status:de.status})}catch(_e){v(((Z=(le=_e==null?void 0:_e.response)==null?void 0:le.data)==null?void 0:Z.message)||"Failed to load GRN")}if(U)await te();else try{f(!0);const _e=await ee.get("/workflows"),Me=Array.isArray((ve=_e.data)==null?void 0:ve.items)?_e.data.items:[];H(Me),await oe(Me)}catch(_e){v(((Be=(Ue=_e==null?void 0:_e.response)==null?void 0:Ue.data)==null?void 0:Be.message)||"Failed to load workflows")}finally{f(!1)}},te=async()=>{var Z,ve,Ue;if(!U||!U.length){y(null),N(null),v("");return}const de="/inventory/grn-import",Ie=Be=>String(Be||"").trim().toUpperCase().replace(/\s+/g,"_"),le=U.find(Be=>Number(Be.is_active)===1&&String(Be.document_route)===de)||U.find(Be=>Number(Be.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(Ie(Be.document_type)))||null;if(y(le||null),N(null),!!le)try{f(!0);const _e=(Z=(await ee.get(`/workflows/${le.id}`)).data)==null?void 0:Z.item,Me=Array.isArray(_e==null?void 0:_e.steps)?_e.steps:[];B(Me);const Ye=Me[0]||null;if(N(Ye?{userId:Ye.approver_user_id,name:Ye.approver_name,stepName:Ye.step_name,stepOrder:Ye.step_order,approvalLimit:Ye.approval_limit}:null),Ye){const ot=(Array.isArray(Ye.approvers)&&Ye.approvers.length?Ye.approvers[0].id:Ye.approver_user_id)||null;V(ot)}else V(null)}catch(Be){v(((Ue=(ve=Be==null?void 0:Be.response)==null?void 0:ve.data)==null?void 0:Ue.message)||"Failed to load workflow details")}finally{f(!1)}},oe=async de=>{var ve,Ue,Be;if(!de||!de.length){y(null),N(null),v("");return}const Ie="/inventory/grn-import",le=_e=>String(_e||"").trim().toUpperCase().replace(/\s+/g,"_"),Z=de.find(_e=>Number(_e.is_active)===1&&String(_e.document_route)===Ie)||de.find(_e=>Number(_e.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(le(_e.document_type)))||null;if(y(Z||null),N(null),!!Z)try{f(!0);const Me=(ve=(await ee.get(`/workflows/${Z.id}`)).data)==null?void 0:ve.item,Ye=Array.isArray(Me==null?void 0:Me.steps)?Me.steps:[];B(Ye);const ot=Ye[0]||null;if(N(ot?{userId:ot.approver_user_id,name:ot.approver_name,stepName:ot.step_name,stepOrder:ot.step_order,approvalLimit:ot.approval_limit}:null),ot){const Ke=(Array.isArray(ot.approvers)&&ot.approvers.length?ot.approvers[0].id:ot.approver_user_id)||null;V(Ke)}else V(null)}catch(_e){v(((Be=(Ue=_e==null?void 0:_e.response)==null?void 0:Ue.data)==null?void 0:Be.message)||"Failed to load workflow details")}finally{f(!1)}},ce=async()=>{var de,Ie,le;if(M){L(!0),v("");try{const Z=await ee.post(`/inventory/grn/${M.id}/submit`,{amount:M.invoice_amount??null,workflow_id:b?b.id:null,target_user_id:q||null}),ve=((de=Z==null?void 0:Z.data)==null?void 0:de.status)||"PENDING_APPROVAL";a(Ue=>Ue.map(Be=>Be.id===M.id?{...Be,status:ve}:Be)),h(!1),z(null)}catch(Z){v(((le=(Ie=Z==null?void 0:Z.response)==null?void 0:Ie.data)==null?void 0:le.message)||"Failed to forward for approval")}finally{L(!1)}}},re=async de=>{var Ie,le,Z,ve;G(!0),J(!0),k(""),Q(null),E([]),O("");try{const Ue=await ee.get(`/inventory/grn/${de.id}`),Be=((Ie=Ue==null?void 0:Ue.data)==null?void 0:Ie.item)||{},_e=Array.isArray(Be==null?void 0:Be.details)?Be.details:[];Q(Be),E(_e);const Me=Number((Be==null?void 0:Be.po_id)||0)||0;if(Me)try{const Ye=await ee.get("/purchase/orders"),Ke=(Array.isArray((le=Ye==null?void 0:Ye.data)==null?void 0:le.items)?Ye.data.items:[]).find(ct=>Number(ct.id)===Me);O(Ke?Ke.po_no||String(Ke.id):String(Me))}catch{O(String(Me))}}catch(Ue){k(((ve=(Z=Ue==null?void 0:Ue.response)==null?void 0:Z.data)==null?void 0:ve.message)||"Failed to load GRN details")}finally{J(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Material Receipt (GRN) - Import"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive import purchase deliveries"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/grn-import/new",className:"btn-success",children:"+ New GRN"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by GRN no, supplier, status...",className:"input max-w-md",value:t,onChange:de=>s(de.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"GRN No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!R.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No GRNs found"})}):null,R.map(de=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:de.grn_no}),e.jsx("td",{children:de.grn_date?String(de.grn_date).slice(0,10):"-"}),e.jsx("td",{children:de.supplier_name||"-"}),e.jsx("td",{children:de.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:de.status||"DRAFT"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{to:`/inventory/grn-import/${de.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx("button",{type:"button",className:"text-brand hover:text-brand-700 text-sm font-medium",onClick:()=>re(de),children:"Details"}),String(de.status||"").toUpperCase()!=="APPROVED"&&e.jsx(Le,{to:`/inventory/grn-import/${de.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),String(de.status||"").toUpperCase()==="APPROVED"?e.jsx("span",{className:"ml-2 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:()=>ne(de),disabled:u===de.id||!X(de.status),children:u===de.id?"Forwarding...":"Forward for Approval"})]})})]},de.id))]})]})})]})]}),c?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{h(!1),z(null),y(null),N(null),v("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:M==null?void 0:M.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:A?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Ie=Array.isArray(S)&&S.length>0?S[0]:null,le=Ie?Array.isArray(Ie.approvers)&&Ie.approvers.length?Ie.approvers.map(Z=>({id:Z.id,name:Z.username})):Ie.approver_user_id?[{id:Ie.approver_user_id,name:Ie.approver_name||String(Ie.approver_user_id)}]:[]:[];return le.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:q||"",onChange:Z=>V(Z.target.value?Number(Z.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),le.map(Z=>e.jsx("option",{value:Z.id,children:Z.name},Z.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:j?`Step ${j.stepOrder}  ${j.stepName}${j.approvalLimit!=null?`  Limit: ${Number(j.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{h(!1),z(null),y(null),N(null),v("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:ce,disabled:P||!M,children:P?"Forwarding...":"Forward"})]})]})}):null,I?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[900px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"View GRN Details"}),e.jsx("button",{type:"button",onClick:()=>{G(!1),Q(null),E([]),k("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[Y?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,T?e.jsx("div",{className:"text-sm text-red-600",children:T}):null,D?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"GRN No"}),e.jsx("div",{className:"font-semibold",children:D.grn_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("div",{className:"font-semibold",children:D.grn_date?String(D.grn_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-semibold",children:D.supplier_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Warehouse"}),e.jsx("div",{className:"font-semibold",children:D.warehouse_name||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),e.jsx("div",{className:"font-semibold",children:D.status||"DRAFT"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Purchase Order"}),e.jsx("div",{className:"font-semibold",children:w||(D.po_id?String(D.po_id):"-")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery No"}),e.jsx("div",{className:"font-semibold",children:D.delivery_number||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Delivery Date"}),e.jsx("div",{className:"font-semibold",children:D.delivery_date?String(D.delivery_date).slice(0,10):"-"})]})]}):null,e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Remarks"})]})}),e.jsxs("tbody",{children:[C.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No item details"})}),C.map((de,Ie)=>{const le=de.line_amount==null||de.line_amount===""?Number(de.qty_accepted||0)*Number(de.unit_price||0):Number(de.line_amount||0);return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:de.item_code||""}),e.jsx("td",{children:de.item_name||""}),e.jsx("td",{children:de.qty_ordered??""}),e.jsx("td",{children:de.qty_received??""}),e.jsx("td",{children:de.qty_accepted??""}),e.jsx("td",{children:de.uom||""}),e.jsx("td",{children:Number(de.unit_price||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:Number(le||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:de.batch_serial||de.batch_number||""}),e.jsx("td",{children:de.remarks||""})]},Ie)})]})]})})]}),e.jsx("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{G(!1),Q(null),E([]),k("")},children:"Close"})})]})}):null]})}function Gu(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function BY(){const{id:t}=Ls(),s=ys(),r=t==="new",[a]=Ef(),n=(a.get("mode")||"").toLowerCase(),i=!r&&n==="view",[l,o]=x.useState(!1),[u,d]=x.useState(!1),[c,h]=x.useState(""),[A,f]=x.useState(!1),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState(null),[S,B]=x.useState(null),[P,L]=x.useState([]),[U,H]=x.useState(!1),[q,V]=x.useState(null),[M,z]=x.useState(null),[I,G]=x.useState([]),[Y,J]=x.useState([]),[T,k]=x.useState([]),[D,Q]=x.useState([]),[C,E]=x.useState([]),{uoms:w,loading:O}=el(),[R,X]=x.useState([]),[ne,te]=x.useState([]),[oe,ce]=x.useState([]),re=x.useMemo(()=>{const ue=new Map;for(const ge of Array.isArray(oe)?oe:[])ue.set(String(ge.id),ge);return ue},[oe]),[de,Ie]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",lineIdx:null}),le=x.useRef(r),[Z,ve]=x.useState({grn_no:"",grn_date:Gu(new Date),supplier_id:"",warehouse_id:"",po_id:"",port_clearance_id:"",invoice_no:"",invoice_date:"",invoice_amount:"",invoice_due_date:"",delivery_number:"",delivery_date:"",bill_of_lading:"",customs_entry_no:"",shipping_company:"",port_of_entry:"",status:"DRAFT",remarks:"",details:[]}),Ue=x.useMemo(()=>{const ue=String(Z.po_id||""),ge=Array.isArray(C)?C:[];return ue?ge.filter(Ve=>{const tt=re.get(String(Ve.advice_id||Ve.adviceId||""));return tt&&String(tt.po_id||"")===ue}):ge},[C,Z.po_id,re]),Be=x.useMemo(()=>{const ue=Array.isArray(w)?w:[],ge=ue.find(Ve=>String(Ve.uom_code||"").toUpperCase()==="PCS")||ue[0];return ge&&ge.uom_code?ge.uom_code:"PCS"},[w]);x.useCallback((ue,ge)=>{const Ve=Array.isArray(R)?R:[],tt=String(ue||""),Ze=ge?String(ge):"",ht=Ve.filter(Fe=>String(Fe.product_id)===tt&&(Ze?String(Fe.uom||"")===Ze:!0)).sort((Fe,xe)=>{const we=Fe.effective_date?new Date(Fe.effective_date).getTime():0;return(xe.effective_date?new Date(xe.effective_date).getTime():0)-we||new Date(xe.created_at).getTime()-new Date(Fe.created_at).getTime()});if(ht.length>0&&ht[0].cost_price!=null)return String(ht[0].cost_price);const ze=Ve.filter(Fe=>String(Fe.product_id)===tt).sort((Fe,xe)=>{const we=Fe.effective_date?new Date(Fe.effective_date).getTime():0;return(xe.effective_date?new Date(xe.effective_date).getTime():0)-we||new Date(xe.created_at).getTime()-new Date(Fe.created_at).getTime()});return ze.length>0&&ze[0].cost_price!=null?String(ze[0].cost_price):(()=>{const Fe=(Array.isArray(I)?I:[]).find(xe=>String(xe.id)===tt);return Fe&&Fe.cost_price!=null?String(Fe.cost_price):""})()},[R,I]),x.useEffect(()=>{let ue=!0;return h(""),Promise.all([ee.get("/inventory/items"),ee.get("/purchase/suppliers"),ee.get("/inventory/warehouses"),ee.get("/purchase/orders"),ee.get("/purchase/port-clearances"),ee.get("/purchase/shipping-advices"),ee.get("/sales/prices/standard"),ee.get("/inventory/unit-conversions")]).then(([ge,Ve,tt,Ze,ht,ze,Fe,xe])=>{var Ot,Ae,je,We,De,lt,rt,et;if(!ue)return;G(Array.isArray((Ot=ge.data)==null?void 0:Ot.items)?ge.data.items:[]),J(Array.isArray((Ae=Ve.data)==null?void 0:Ae.items)?Ve.data.items:[]),k(Array.isArray((je=tt.data)==null?void 0:je.items)?tt.data.items:[]);const Xe=(Array.isArray((We=Ze.data)==null?void 0:We.items)?Ze.data.items:[]).filter(Qt=>String(Qt.po_type||"").toUpperCase()==="IMPORT"),ut=Array.isArray((De=ht.data)==null?void 0:De.items)?ht.data.items:[],ft=Array.isArray((lt=ze.data)==null?void 0:lt.items)?ze.data.items:[];ce(ft);const mt=ut.filter(Qt=>String(Qt.status||"").toUpperCase()==="CLEARED"),pt=new Set(mt.map(Qt=>{const Qe=Qt.advice_id||Qt.adviceId,he=Qe!=null?ft.find(pe=>String(pe.id)===String(Qe)):null;return he&&he.po_id!=null?String(he.po_id):null}).filter(Qt=>Qt!=null)),vt=Xe.filter(Qt=>pt.has(String(Qt.id)));Q(vt),E(mt),X(Array.isArray((rt=Fe.data)==null?void 0:rt.items)?Fe.data.items:[]),te(Array.isArray((et=xe.data)==null?void 0:et.items)?xe.data.items:[]),r&&ee.get("/inventory/grn",{params:{grn_type:"IMPORT"}}).then(Qt=>{var ye;const Qe=Array.isArray((ye=Qt.data)==null?void 0:ye.items)?Qt.data.items:[],he=new Set(Qe.map(Ne=>Ne.po_id||Ne.poId).filter(Ne=>Ne!=null).map(Ne=>String(Ne))),pe=new Set(Qe.map(Ne=>Ne.port_clearance_id||Ne.port_clearanceId).filter(Ne=>Ne!=null).map(Ne=>String(Ne)));Q(Ne=>Ne.filter(He=>!he.has(String(He.id))).filter(He=>pt.has(String(He.id)))),E(Ne=>Ne.filter(He=>!pe.has(String(He.id))).filter(He=>String(He.status||"").toUpperCase()==="CLEARED"))}).catch(()=>{})}).catch(ge=>{var Ve,tt;ue&&h(((tt=(Ve=ge==null?void 0:ge.response)==null?void 0:Ve.data)==null?void 0:tt.message)||"Failed to load lookups")}),()=>{ue=!1}},[]),x.useEffect(()=>{r&&ee.get("/purchase/grns/next-no?type=IMPORT").then(ue=>{var ge;(ge=ue.data)!=null&&ge.nextNo&&ve(Ve=>({...Ve,grn_no:ue.data.nextNo}))}).catch(console.error)},[r]),x.useEffect(()=>{Z.port_clearance_id&&ee.get(`/purchase/port-clearances/${Z.port_clearance_id}`).then(ue=>{var Ve;const ge=(Ve=ue.data)==null?void 0:Ve.item;ge&&(ve(tt=>({...tt,customs_entry_no:ge.customs_entry_no||tt.customs_entry_no})),ge.advice_id&&ee.get(`/purchase/shipping-advices/${ge.advice_id}`).then(tt=>{var ht;const Ze=(ht=tt.data)==null?void 0:ht.item;Ze&&(ve(ze=>({...ze,po_id:Ze.po_id?String(Ze.po_id):ze.po_id,bill_of_lading:Ze.bill_of_lading||ze.bill_of_lading,shipping_company:Ze.vessel_name||ze.shipping_company})),Ze.po_id&&ee.get(`/purchase/orders/${Ze.po_id}`).then(ze=>{var xe;const Fe=(xe=ze.data)==null?void 0:xe.item;Fe&&ve(we=>({...we,supplier_id:Fe.supplier_id?String(Fe.supplier_id):we.supplier_id,warehouse_id:Fe.warehouse_id?String(Fe.warehouse_id):we.warehouse_id}))}).catch(console.error))}).catch(console.error))}).catch(console.error)},[Z.port_clearance_id]),x.useEffect(()=>{const ue=String(Z.po_id||"");if(!ue)return;const Ve=(Array.isArray(C)?C:[]).filter(tt=>{const Ze=re.get(String(tt.advice_id||tt.adviceId||""));return String(tt.status||"").toUpperCase()==="CLEARED"&&Ze&&String(Ze.po_id||"")===ue});if(Ve.length>0){const tt=[...Ve].sort((Ze,ht)=>{const ze=Ze.clearance_date?new Date(Ze.clearance_date).getTime():0;return(ht.clearance_date?new Date(ht.clearance_date).getTime():0)-ze})[0];ve(Ze=>({...Ze,port_clearance_id:String(tt.id)}))}else ve(tt=>({...tt,port_clearance_id:""}))},[Z.po_id,C,re]),x.useEffect(()=>{if(r)return;let ue=!0;return o(!0),h(""),ee.get(`/inventory/grn/${t}`).then(ge=>{var Ze;if(!ue)return;const Ve=(Ze=ge.data)==null?void 0:Ze.item,tt=Array.isArray(Ve==null?void 0:Ve.details)?Ve.details:[];Ve&&(ve({grn_no:Ve.grn_no||"",grn_date:Gu(Ve.grn_date),supplier_id:Ve.supplier_id?String(Ve.supplier_id):"",warehouse_id:Ve.warehouse_id?String(Ve.warehouse_id):"",po_id:Ve.po_id?String(Ve.po_id):"",port_clearance_id:Ve.port_clearance_id?String(Ve.port_clearance_id):"",invoice_no:Ve.invoice_no||"",invoice_date:Gu(Ve.invoice_date),invoice_amount:Ve.invoice_amount!=null?String(Ve.invoice_amount):"",invoice_due_date:Gu(Ve.invoice_due_date),delivery_number:Ve.delivery_number||"",delivery_date:Gu(Ve.delivery_date),bill_of_lading:Ve.bill_of_lading||"",customs_entry_no:Ve.customs_entry_no||"",shipping_company:Ve.shipping_company||"",port_of_entry:Ve.port_of_entry||"",status:Ve.status||"DRAFT",remarks:Ve.remarks||"",details:tt.map(ht=>({item_id:ht.item_id?String(ht.item_id):"",qty_ordered:ht.qty_ordered??"",input_qty:ht.input_qty??ht.qty_received??"",input_uom:ht.input_uom||ht.uom||"",qty_received:ht.qty_received??"",qty_accepted:ht.qty_accepted??"",qty_rejected:ht.qty_rejected??"",uom:ht.uom||"",unit_price:ht.unit_price!=null?String(ht.unit_price):"",amount:ht.line_amount!=null?String(ht.line_amount):(()=>{const ze=ht.unit_price!=null?Number(ht.unit_price):0,Fe=ht.qty_accepted!=null?Number(ht.qty_accepted):ht.qty_received!=null?Number(ht.qty_received):ht.qty_ordered!=null?Number(ht.qty_ordered):0;return String(Number(Fe||0)*Number(ze||0))})(),batch_serial:ht.batch_serial||ht.batch_number||"",mfg_date:Gu(ht.mfg_date),expiry_date:Gu(ht.expiry_date),inspection_status:ht.inspection_status||"PENDING",line_remarks:ht.remarks||""}))}),le.current=!1,Ve.po_id&&ee.get(`/purchase/orders/${Ve.po_id}`).then(ht=>{var Fe;const ze=(Fe=ht.data)==null?void 0:Fe.item;ze&&Q(xe=>xe.some(Xe=>String(Xe.id)===String(ze.id))?xe:[...xe,ze])}).catch(()=>{}))}).catch(ge=>{var Ve,tt;ue&&h(((tt=(Ve=ge==null?void 0:ge.response)==null?void 0:Ve.data)==null?void 0:tt.message)||"Failed to load GRN")}).finally(()=>{ue&&o(!1)}),()=>{ue=!1}},[t,r]);const _e=x.useMemo(()=>{const ue=new Map;for(const ge of I)ue.set(String(ge.id),ge);return ue},[I]),Me=x.useMemo(()=>{const ue=new Map;for(const ge of Array.isArray(ne)?ne:[]){if(!Number(ge.is_active))continue;const Ve=`${ge.item_id}|${ge.from_uom}|${ge.to_uom}`,tt=Number(ge.conversion_factor||0);Number.isFinite(tt)&&tt>0&&ue.set(Ve,tt)}return ue},[ne]);x.useMemo(()=>{const ue=new Map;for(const ge of Array.isArray(R)?R:[]){const Ve=String(ge.product_id);ue.has(Ve)||ue.set(Ve,ge)}return ue},[R]);const Ye=()=>{ve(ue=>{var ge,Ve,tt,Ze;return{...ue,details:[...ue.details,{item_id:(ge=I[0])!=null&&ge.id?String(I[0].id):"",qty_ordered:"",input_qty:"",input_uom:((Ve=I[0])==null?void 0:Ve.uom)&&String(I[0].uom)||(Be?String(Be):""),qty_received:"",uom:((tt=I[0])==null?void 0:tt.uom)&&String(I[0].uom)||(Be?String(Be):""),unit_price:String(((Ze=I[0])==null?void 0:Ze.cost_price)??"")}]}})},ot=ue=>{ve(ge=>({...ge,details:ge.details.filter((Ve,tt)=>tt!==ue)}))},Ke=(ue,ge)=>{ve(Ve=>{const tt=Ve.details.map((je,We)=>We===ue?{...je,...ge}:je);let Ze=tt[ue];Object.prototype.hasOwnProperty.call(ge,"qty_ordered")&&(Ze.qty_received===""||Ze.qty_received==null)&&(Ze={...Ze,qty_received:ge.qty_ordered},tt[ue]=Ze);const ht=Object.prototype.hasOwnProperty.call(ge,"qty_received_direct")&&ge.qty_received_direct!=null&&Number.isFinite(Number(ge.qty_received_direct))?Number(ge.qty_received_direct):null;if(Object.prototype.hasOwnProperty.call(ge,"item_id")){const je=_e.get(String(ge.item_id)),We=(je==null?void 0:je.uom)&&String(je.uom)||Ze.uom&&String(Ze.uom)||(Be?String(Be):""),De=String((je==null?void 0:je.cost_price)??"");Ze={...Ze,uom:We,input_uom:We,input_qty:"",qty_received:"",qty_accepted:"",unit_price:De},tt[ue]=Ze}const ze=Ze.uom&&String(Ze.uom)||(Be?String(Be):""),Fe=Ze.input_uom&&String(Ze.input_uom)?String(Ze.input_uom):ze,xe=!(Ze.input_qty===""||Ze.input_qty==null),we=xe?Number(Ze.input_qty):null,Xe=!xe&&Number.isFinite(Number(Ze.qty_received))?Number(Ze.qty_received):null;let ut=we!=null&&Number.isFinite(we)?we:Xe;if(ht!=null&&(ut=ht),ht==null&&ut!=null&&Fe&&ze&&Fe!==ze){const je=`${Ze.item_id}|${Fe}|${ze}`,We=Me.get(je);Number.isFinite(We)&&We>0&&(ut=ut*We)}const ft=ut!=null&&Number.isFinite(ut)?ut:"",mt=Ze.unit_price===""?0:Number(Ze.unit_price||0),pt=Ze.qty_accepted===""||Ze.qty_accepted==null?null:Number(Ze.qty_accepted||0),vt=ft===""||ft==null?null:Number(ft||0),Ot=Ze.qty_ordered===""||Ze.qty_ordered==null?null:Number(Ze.qty_ordered||0),Ae=pt??null??vt??null??Ot??0;return tt[ue]={...Ze,uom:ze,input_uom:Fe,qty_received:ft,qty_accepted:Ze.qty_accepted===""||Ze.qty_accepted==null?ft:Ze.qty_accepted,amount:String(Number(Ae||0)*mt)},{...Ve,details:tt}})};x.useEffect(()=>{if(!Z.po_id||!le.current)return;let ue=!0;return o(!0),ee.get(`/purchase/orders/${Z.po_id}`).then(ge=>{var Ze,ht,ze;if(!ue)return;const Ve=(Ze=ge.data)==null?void 0:Ze.item,tt=Array.isArray((ze=(ht=ge.data)==null?void 0:ht.item)==null?void 0:ze.details)?ge.data.item.details:[];Ve&&ve(Fe=>({...Fe,supplier_id:Ve.supplier_id?String(Ve.supplier_id):Fe.supplier_id,details:tt.map(xe=>{const we=I.find(ut=>String(ut.id)===String(xe.item_id)),Xe=(we==null?void 0:we.uom)&&String(we.uom)||(Be?String(Be):"");return{item_id:xe.item_id?String(xe.item_id):"",qty_ordered:xe.qty??"",input_qty:"",input_uom:Xe,qty_received:xe.qty??"",qty_accepted:"",qty_rejected:"",uom:Xe,unit_price:String((we==null?void 0:we.cost_price)??""),amount:"",batch_serial:"",mfg_date:"",expiry_date:"",inspection_status:"PENDING",line_remarks:""}})}))}).catch(ge=>{var Ve,tt;h(((tt=(Ve=ge==null?void 0:ge.response)==null?void 0:Ve.data)==null?void 0:tt.message)||"Failed to load PO details")}).finally(()=>{ue&&o(!1)}),()=>{ue=!1}},[Z.po_id]);const ct=async ue=>{var ge,Ve;ue.preventDefault(),d(!0),h("");try{const tt={grn_no:Z.grn_no||null,grn_date:Z.grn_date,grn_type:"IMPORT",supplier_id:Z.supplier_id?Number(Z.supplier_id):null,warehouse_id:Z.warehouse_id?Number(Z.warehouse_id):null,po_id:Z.po_id?Number(Z.po_id):null,invoice_no:Z.invoice_no||null,invoice_date:Z.invoice_date||null,invoice_amount:Z.invoice_amount===""||Z.invoice_amount==null?null:Number(Z.invoice_amount),invoice_due_date:Z.invoice_due_date||null,delivery_number:Z.delivery_number||null,delivery_date:Z.delivery_date||null,bill_of_lading:Z.bill_of_lading||null,customs_entry_no:Z.customs_entry_no||null,shipping_company:Z.shipping_company||null,port_of_entry:Z.port_of_entry||null,remarks:Z.remarks||null,details:(Z.details||[]).map(Ze=>({item_id:Ze.item_id?Number(Ze.item_id):null,qty_ordered:Ze.qty_ordered===""?null:Number(Ze.qty_ordered),qty_received:Ze.qty_received===""?null:Number(Ze.qty_received),qty_accepted:Ze.qty_accepted===""?null:Number(Ze.qty_accepted),input_qty:Ze.input_qty===""?null:Number(Ze.input_qty),input_uom:Ze.input_uom||null,uom:Ze.uom||null,unit_price:Ze.unit_price===""?null:Number(Ze.unit_price),line_amount:Ze.amount===""?null:Number(Ze.amount),batch_serial:Ze.batch_serial||null,mfg_date:Ze.mfg_date||null,expiry_date:Ze.expiry_date||null,inspection_status:Ze.inspection_status||"PENDING",remarks:Ze.line_remarks||null}))};if(!tt.grn_date||!tt.supplier_id)throw new Error("GRN date and supplier are required");if(!tt.po_id)throw new Error("Purchase order is required");if(!tt.invoice_no||!tt.invoice_date)throw new Error("Invoice number and date are required");r?await ee.post("/inventory/grn",{...tt,port_clearance_id:Z.port_clearance_id?Number(Z.port_clearance_id):null}):await ee.put(`/inventory/grn/${t}`,{...tt,port_clearance_id:Z.port_clearance_id?Number(Z.port_clearance_id):null}),s("/inventory/grn-import")}catch(tt){h(((Ve=(ge=tt==null?void 0:tt.response)==null?void 0:ge.data)==null?void 0:Ve.message)||(tt==null?void 0:tt.message)||"Failed to save GRN")}finally{d(!1)}},xt=async()=>{var ue,ge,Ve;if(!r){H(!0),y("");try{const tt=await ee.post(`/inventory/grn/${t}/submit`,{amount:Z.invoice_amount===""||Z.invoice_amount==null?null:Number(Z.invoice_amount||0),workflow_id:j?j.id:null,target_user_id:M||null}),Ze=((ue=tt==null?void 0:tt.data)==null?void 0:ue.status)||"PENDING_APPROVAL";ve(ht=>({...ht,status:Ze})),f(!1)}catch(tt){y(((Ve=(ge=tt==null?void 0:tt.response)==null?void 0:ge.data)==null?void 0:Ve.message)||"Failed to forward for approval")}finally{H(!1)}}},be=async()=>{var ue,ge,Ve;if(!r)if(f(!0),y(""),q)await Ce();else try{v(!0);const tt=await ee.get("/workflows"),Ze=Array.isArray((ue=tt.data)==null?void 0:ue.items)?tt.data.items:[];V(Ze),await Te(Ze)}catch(tt){y(((Ve=(ge=tt==null?void 0:tt.response)==null?void 0:ge.data)==null?void 0:Ve.message)||"Failed to load workflows")}finally{v(!1)}},Ce=async()=>{var tt,Ze,ht;if(!q||!q.length){N(null),B(null),y("");return}const ue="/inventory/grn-import",ge=ze=>String(ze||"").trim().toUpperCase().replace(/\s+/g,"_"),Ve=q.find(ze=>Number(ze.is_active)===1&&String(ze.document_route)===ue)||q.find(ze=>Number(ze.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(ge(ze.document_type)))||null;if(N(Ve||null),B(null),!!Ve)try{v(!0);const Fe=(tt=(await ee.get(`/workflows/${Ve.id}`)).data)==null?void 0:tt.item,xe=Array.isArray(Fe==null?void 0:Fe.steps)?Fe.steps:[];L(xe);const we=xe[0]||null;if(B(we?{userId:we.approver_user_id,name:we.approver_name,stepName:we.step_name,stepOrder:we.step_order,approvalLimit:we.approval_limit}:null),we){const Xe=(Array.isArray(we.approvers)&&we.approvers.length?we.approvers[0].id:we.approver_user_id)||null;z(Xe)}else z(null)}catch(ze){y(((ht=(Ze=ze==null?void 0:ze.response)==null?void 0:Ze.data)==null?void 0:ht.message)||"Failed to load workflow details")}finally{v(!1)}},Te=async ue=>{var Ze,ht,ze;if(!ue||!ue.length){N(null),B(null),y("");return}const ge="/inventory/grn-import",Ve=Fe=>String(Fe||"").trim().toUpperCase().replace(/\s+/g,"_"),tt=ue.find(Fe=>Number(Fe.is_active)===1&&String(Fe.document_route)===ge)||ue.find(Fe=>Number(Fe.is_active)===1&&["GOODS_RECEIPT","GRN","GOODS_RECEIPT_NOTE"].includes(Ve(Fe.document_type)))||null;if(N(tt||null),B(null),!!tt)try{v(!0);const xe=(Ze=(await ee.get(`/workflows/${tt.id}`)).data)==null?void 0:Ze.item,we=Array.isArray(xe==null?void 0:xe.steps)?xe.steps:[];L(we);const Xe=we[0]||null;if(B(Xe?{userId:Xe.approver_user_id,name:Xe.approver_name,stepName:Xe.step_name,stepOrder:Xe.step_order,approvalLimit:Xe.approval_limit}:null),Xe){const ut=(Array.isArray(Xe.approvers)&&Xe.approvers.length?Xe.approvers[0].id:Xe.approver_user_id)||null;z(ut)}else z(null)}catch(Fe){y(((ze=(ht=Fe==null?void 0:Fe.response)==null?void 0:ht.data)==null?void 0:ze.message)||"Failed to load workflow details")}finally{v(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:r?"New GRN (Import)":i?"View GRN (Import)":"Edit GRN (Import)"}),e.jsx("p",{className:"text-sm mt-1",children:"Goods receipt note for import purchases"})]}),e.jsx(Le,{to:"/inventory/grn-import",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:ct,className:"space-y-6",children:[l?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,c?e.jsx("div",{className:"text-sm text-red-600",children:c}):null,e.jsxs("fieldset",{disabled:i,className:`space-y-6 ${i?"disabled-light-blue":""}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN No"}),e.jsx("input",{type:"text",className:"input",value:Z.grn_no,onChange:ue=>ve({...Z,grn_no:ue.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"GRN Date *"}),e.jsx("input",{type:"date",className:"input",value:Z.grn_date,onChange:ue=>ve({...Z,grn_date:ue.target.value}),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{className:"input",value:Z.supplier_id,onChange:ue=>ve({...Z,supplier_id:ue.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select supplier..."}),Y.map(ue=>e.jsx("option",{value:String(ue.id),children:ue.supplier_name},ue.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port Clearance (Optional)"}),e.jsxs("select",{className:"input",value:Z.port_clearance_id,onChange:ue=>ve({...Z,port_clearance_id:ue.target.value}),children:[e.jsx("option",{value:"",children:"Select port clearance..."}),Ue.map(ue=>e.jsx("option",{value:String(ue.id),children:ue.clearance_no},ue.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:Z.warehouse_id,onChange:ue=>ve({...Z,warehouse_id:ue.target.value}),children:[e.jsx("option",{value:"",children:"Select warehouse..."}),T.map(ue=>e.jsx("option",{value:String(ue.id),children:ue.warehouse_name||ue.name||"Unknown Warehouse"},ue.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Order *"}),e.jsxs("select",{className:"input",value:Z.po_id,onChange:ue=>ve({...Z,po_id:ue.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select purchase order..."}),D.map(ue=>e.jsx("option",{value:String(ue.id),children:ue.po_no},ue.id))]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Supplier Invoice Details"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier's Invoice Number *"}),e.jsx("input",{type:"text",className:"input",value:Z.invoice_no,onChange:ue=>ve({...Z,invoice_no:ue.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Invoice Date *"}),e.jsx("input",{type:"date",className:"input",value:Z.invoice_date,onChange:ue=>ve({...Z,invoice_date:ue.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{type:"date",className:"input",value:Z.invoice_due_date,onChange:ue=>ve({...Z,invoice_due_date:ue.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Number"}),e.jsx("input",{type:"text",className:"input",value:Z.delivery_number,onChange:ue=>ve({...Z,delivery_number:ue.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Date"}),e.jsx("input",{type:"date",className:"input",value:Z.delivery_date,onChange:ue=>ve({...Z,delivery_date:ue.target.value})})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Import Documentation"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bill of Lading *"}),e.jsx("input",{type:"text",className:"input",value:Z.bill_of_lading,onChange:ue=>ve({...Z,bill_of_lading:ue.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customs Entry No *"}),e.jsx("input",{type:"text",className:"input",value:Z.customs_entry_no,onChange:ue=>ve({...Z,customs_entry_no:ue.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shipping Company"}),e.jsx("input",{type:"text",className:"input",value:Z.shipping_company,onChange:ue=>ve({...Z,shipping_company:ue.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Entry"}),e.jsx("input",{type:"text",className:"input",value:Z.port_of_entry,onChange:ue=>ve({...Z,port_of_entry:ue.target.value})})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:Z.remarks,onChange:ue=>ve({...Z,remarks:ue.target.value})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Items"}),e.jsx("button",{type:"button",className:"btn-success",onClick:Ye,children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Ordered Qty"}),e.jsx("th",{children:"Input UOM"}),e.jsx("th",{children:"Received Qty"}),e.jsx("th",{}),e.jsx("th",{children:"Accepted Qty"}),e.jsx("th",{children:"Unit Price"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Batch/Serial"}),e.jsx("th",{children:"Mfg Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Inspection"}),e.jsx("th",{children:"Remarks"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[Z.details.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"14",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:'No items. Click "Add Item" to begin.'})}),Z.details.map((ue,ge)=>{const Ve=ue.item_id?_e.get(String(ue.item_id)):null,tt=Ve?`${Ve.item_code} - ${Ve.item_name}`:"Select item...";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("select",{className:"input min-w-[320px]",value:ue.item_id,onChange:Ze=>Ke(ge,{item_id:Ze.target.value}),children:[e.jsx("option",{value:"",children:"Select item..."}),I.map(Ze=>e.jsx("option",{value:String(Ze.id),children:Ze.item_name},Ze.id))]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:tt})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:ue.qty_ordered,onChange:Ze=>Ke(ge,{qty_ordered:Ze.target.value})})}),e.jsxs("td",{className:"pr-6 pl-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{className:"input w-auto min-w-[160px] flex-none",value:ue.input_uom||Be||"",onChange:Ze=>Ke(ge,{input_uom:Ze.target.value}),children:[e.jsx("option",{value:"",children:"Select UOM"}),O?e.jsx("option",{children:"Loading..."}):Array.isArray(w)&&w.map(Ze=>Ze&&e.jsx("option",{value:Ze.uom_code,children:Ze.uom_code},Ze.id))]})}),e.jsx("div",{className:"text-[11px] text-slate-500 mt-1",children:(()=>{const Ze=String(ue.input_uom||""),ht=String(ue.uom||Be||""),ze=`${ue.item_id}|${Ze}|${ht}`,Fe=Me.get(ze);return Number(Fe)>0?`Conversion: 1 ${Ze} = ${Number(Fe).toFixed(6)} ${ht}`:Ze&&ht&&Ze===ht?"":e.jsxs(e.Fragment,{children:["No conversion defined for ",Ze,"  ",ht,"."," ",e.jsx(Le,{to:"/inventory/unit-conversions",className:"text-brand font-medium underline",children:"Define conversion"})]})})()})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:ue.qty_received,onChange:Ze=>Ke(ge,{qty_received_direct:Ze.target.value})})}),e.jsx("td",{children:(()=>{const Ze=String(ue.uom||Be||""),ht=(Array.isArray(ne)?ne:[]).filter(we=>Number(we.is_active)&&Number(we.item_id)===Number(ue.item_id)&&String(we.to_uom)===Ze).map(we=>String(we.from_uom)),ze=String(ue.input_uom||""),Fe=ze&&ze!==Ze?ze:ht[0]||"";return ht.length>0&&Fe&&Fe!==Ze?e.jsx("button",{type:"button",className:"px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors flex-none",onClick:()=>Ie({open:!0,itemId:ue.item_id,defaultUom:Ze,currentUom:Fe,lineIdx:ge}),children:`number of ${Fe}`}):null})()}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:ue.qty_accepted,onChange:Ze=>Ke(ge,{qty_accepted:Ze.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[140px]",value:ue.unit_price,onChange:Ze=>Ke(ge,{unit_price:Ze.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"1",className:"input min-w-[160px]",value:ue.amount,onChange:Ze=>Ke(ge,{amount:Ze.target.value}),readOnly:!0})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[160px]",value:ue.batch_serial,onChange:Ze=>Ke(ge,{batch_serial:Ze.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:ue.mfg_date,onChange:Ze=>Ke(ge,{mfg_date:Ze.target.value})})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input min-w-[160px]",value:ue.expiry_date,onChange:Ze=>Ke(ge,{expiry_date:Ze.target.value})})}),e.jsx("td",{children:e.jsxs("select",{className:"input min-w-[140px]",value:ue.inspection_status||"PENDING",onChange:Ze=>Ke(ge,{inspection_status:Ze.target.value}),children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"PASSED",children:"Passed"}),e.jsx("option",{value:"FAILED",children:"Failed"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input min-w-[200px]",value:ue.line_remarks,onChange:Ze=>Ke(ge,{line_remarks:Ze.target.value})})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>ot(ge),children:"Remove"})})]},ge)})]})]})})})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/grn-import",className:"btn-success",children:"Cancel"}),i?null:e.jsx("button",{type:"submit",className:"btn-success",disabled:u,children:u?"Saving...":"Save GRN"}),e.jsx("button",{type:"button",className:"btn-success ml-2",onClick:be,disabled:u||r,children:String(Z.status||"").toUpperCase()==="APPROVED"?"Approved":"Forward for Approval"})]})]})})]}),A?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward GRN for Approval"}),e.jsx("button",{type:"button",onClick:()=>{f(!1),N(null),B(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:Z.grn_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:j?`${j.workflow_name} (${j.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const ge=Array.isArray(P)&&P.length>0?P[0]:null,Ve=ge?Array.isArray(ge.approvers)&&ge.approvers.length?ge.approvers.map(tt=>({id:tt.id,name:tt.username})):ge.approver_user_id?[{id:ge.approver_user_id,name:ge.approver_name||String(ge.approver_user_id)}]:[]:[];return Ve.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:M||"",onChange:tt=>z(tt.target.value?Number(tt.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Ve.map(tt=>e.jsx("option",{value:tt.id,children:tt.name},tt.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:j?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{f(!1),N(null),B(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:xt,disabled:U||r,children:U?"Forwarding...":"Forward"})]})]})}):null,e.jsx(sd,{open:de.open,onClose:()=>Ie({open:!1,itemId:null,defaultUom:"",currentUom:"",lineIdx:null}),itemId:de.itemId?Number(de.itemId):null,defaultUom:String(de.defaultUom||""),currentUom:String(de.currentUom||""),conversions:ne,onApply:({converted_qty:ue})=>{const ge=de.lineIdx;ge!=null&&Ke(ge,{qty_received_direct:ue})}})]})}function EY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let d=!0;return i(!0),o(""),ee.get("/inventory/transfer-acceptance").then(c=>{var h;d&&a(Array.isArray((h=c.data)==null?void 0:h.items)?c.data.items:[])}).catch(c=>{var h,A;d&&o(((A=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load transfers")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=x.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.transfer_no||"").toLowerCase().includes(d)||String(c.from_warehouse_name||c.from_warehouse_id||"").toLowerCase().includes(d)||String(c.to_warehouse_name||c.to_warehouse_id||"").toLowerCase().includes(d)||String(c.status||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Transfer Acceptance"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive transferred stock"})]}),e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by transfer no, from warehouse, status...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Transfer No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"From Warehouse"}),e.jsx("th",{children:"To Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No transfers available for acceptance"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.transfer_no}),e.jsx("td",{children:d.transfer_date?String(d.transfer_date).slice(0,10):"-"}),e.jsx("td",{children:d.from_warehouse_name||d.from_warehouse_id||"-"}),e.jsx("td",{children:d.to_warehouse_name||d.to_warehouse_id||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d.status==="IN_TRANSIT"?"badge-warning":"badge-info"}`,children:d.status})}),e.jsx("td",{children:e.jsx(Le,{to:`/inventory/transfer-acceptance/${d.id}`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"Open"})})]},d.id))]})]})})]})]})})}function FY(){const{id:t}=Ls(),s=ys(),[r,a]=x.useState(!1),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState(null),[c,h]=x.useState([]);x.useEffect(()=>{let b=!0;return a(!0),o(""),ee.get(`/inventory/transfer-acceptance/${t}`).then(y=>{var N,S;if(!b)return;d(((N=y.data)==null?void 0:N.item)||null);const j=Array.isArray((S=y.data)==null?void 0:S.details)?y.data.details:[];h(j.map(B=>({...B,received_qty:Number(B.remaining_qty??B.qty??0),variance:0,rejected_now:0,remarks:""})))}).catch(y=>{var j,N;b&&o(((N=(j=y==null?void 0:y.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load transfer")}).finally(()=>{b&&a(!1)}),()=>{b=!1}},[t]);const A=(b,y)=>{const j=parseFloat(y)||0;h(N=>N.map(S=>{if(S.id===b){const B=Number(S.remaining_qty??S.qty??0),P=Number(S.rejected_now||0),L=j+P-B;return{...S,received_qty:j,variance:L}}return S}))},f=(b,y)=>{const j=parseFloat(y)||0;h(N=>N.map(S=>{if(S.id===b){const B=Number(S.remaining_qty??S.qty??0),L=Number(S.received_qty||0)+j-B;return{...S,rejected_now:j,variance:L}}return S}))},g=(b,y)=>{h(j=>j.map(N=>N.id===b?{...N,remarks:y}:N))},v=async()=>{var b,y;i(!0),o("");try{const j={details:c.map(N=>{const S=Math.max(0,Number(N.remaining_qty??0)),B=Math.max(0,Math.min(Number(N.received_qty)||0,S)),P=Math.max(0,Number(N.rejected_now)||0),L=Math.max(0,Math.min(P,Math.max(0,S-B)));return{id:N.id,item_id:N.item_id,qty:Number(N.qty)||0,received_qty:B,accepted_qty:B,rejected_qty:L,acceptance_remarks:N.remarks}})};await ee.put(`/inventory/transfer-acceptance/${t}`,j),s("/inventory/transfer-acceptance")}catch(j){o(((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to accept transfer")}finally{i(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Transfer Acceptance"}),e.jsx("p",{className:"text-sm mt-1",children:"Review items and accept inbound transfer"})]}),e.jsx(Le,{to:"/inventory/transfer-acceptance",className:"btn-success",children:"Back to List"})]})}),e.jsxs("div",{className:"card-body space-y-6",children:[r?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,l?e.jsx("div",{className:"text-sm text-red-600",children:l}):null,u?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Transfer No"}),e.jsx("div",{className:"font-semibold",children:u.transfer_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Date"}),e.jsx("div",{className:"font-semibold",children:u.transfer_date?String(u.transfer_date).slice(0,10):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"From Warehouse"}),e.jsx("div",{className:"font-semibold",children:u.from_warehouse_name||u.from_warehouse_id||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"To Warehouse"}),e.jsx("div",{className:"font-semibold",children:u.to_warehouse_name||u.to_warehouse_id||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Status"}),e.jsx("div",{children:e.jsx("span",{className:`badge ${u.status==="IN_TRANSIT"?"badge-warning":"badge-info"}`,children:u.status})})]})]}):null,e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-100 dark:text-slate-100",children:"Items Verification"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{className:"w-24",children:"Transferred"}),e.jsx("th",{className:"w-24",children:"Remaining"}),e.jsx("th",{className:"w-28",children:"Receive Now"}),e.jsx("th",{className:"w-28",children:"Reject Now"}),e.jsx("th",{className:"w-24",children:"Variance"}),e.jsx("th",{children:"Remarks"})]})}),e.jsxs("tbody",{children:[c.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No items"})}),c.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:b.item_code}),e.jsx("td",{children:b.item_name}),e.jsx("td",{children:b.qty}),e.jsx("td",{children:Number(b.remaining_qty??0)}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input h-8",value:b.received_qty,onChange:y=>A(b.id,y.target.value),min:"0",step:"0.001",max:Math.max(0,Number(b.remaining_qty??0)-Number(b.rejected_now||0)),disabled:(u==null?void 0:u.status)==="RECEIVED"})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input h-8",value:b.rejected_now,onChange:y=>f(b.id,y.target.value),min:"0",step:"0.001",max:Math.max(0,Number(b.remaining_qty??0)-Number(b.received_qty||0)),disabled:(u==null?void 0:u.status)==="RECEIVED"})}),e.jsx("td",{children:e.jsxs("span",{className:`font-semibold ${b.variance<0?"text-red-600":b.variance>0?"text-blue-600":"text-green-600"}`,children:[b.variance>0?"+":"",b.variance]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input h-8",value:b.remarks,onChange:y=>g(b.id,y.target.value),placeholder:"Variance reason...",disabled:(u==null?void 0:u.status)==="RECEIVED"})})]},b.id))]})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/transfer-acceptance",className:"btn-success",children:"Close"}),e.jsx("button",{type:"button",className:"btn-success",onClick:v,disabled:n||!u||u.status==="RECEIVED",children:n?"Accepting...":"Accept Transfer"})]})]})]})})}function TY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let d=!0;return i(!0),o(""),ee.get("/inventory/stock-takes").then(c=>{var h;d&&a(Array.isArray((h=c.data)==null?void 0:h.items)?c.data.items:[])}).catch(c=>{var h,A;d&&o(((A=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load stock takes")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=x.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.stock_take_no||"").toLowerCase().includes(d)||String(c.status||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Daily Stock Take"}),e.jsx("p",{className:"text-sm mt-1",children:"Perform physical stock counts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/stock-take/new",className:"btn-success",children:"+ New Stock Take"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by stock take no or status...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No stock takes found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.stock_take_no}),e.jsx("td",{children:d.stock_take_date?String(d.stock_take_date).slice(0,10):"-"}),e.jsx("td",{children:d.warehouse_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:d.status||"DRAFT"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/stock-take/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/stock-take/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function eS(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function IY(){const{id:t}=Ls(),s=ys(),r=t==="new",[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState([]),[h,A]=x.useState([]),[f,g]=x.useState({stock_take_no:"",stock_take_date:eS(new Date),warehouse_id:"",status:"DRAFT",details:[]});x.useEffect(()=>{let S=!0;return u(""),Promise.all([ee.get("/inventory/items"),ee.get("/inventory/warehouses")]).then(([B,P])=>{var L,U;S&&(c(Array.isArray((L=B.data)==null?void 0:L.items)?B.data.items:[]),A(Array.isArray((U=P.data)==null?void 0:U.items)?P.data.items:[]))}).catch(B=>{var P,L;S&&u(((L=(P=B==null?void 0:B.response)==null?void 0:P.data)==null?void 0:L.message)||"Failed to load lookups")}),()=>{S=!1}},[]),x.useEffect(()=>{if(r)return;let S=!0;return n(!0),u(""),ee.get(`/inventory/stock-takes/${t}`).then(B=>{var U,H;if(!S)return;const P=(U=B.data)==null?void 0:U.item,L=Array.isArray((H=B.data)==null?void 0:H.details)?B.data.details:[];P&&g({stock_take_no:P.stock_take_no||"",stock_take_date:eS(P.stock_take_date),warehouse_id:P.warehouse_id?String(P.warehouse_id):"",status:P.status||"DRAFT",details:L.map(q=>({item_id:q.item_id?String(q.item_id):"",physical_qty:q.physical_qty??""}))})}).catch(B=>{var P,L;S&&u(((L=(P=B==null?void 0:B.response)==null?void 0:P.data)==null?void 0:L.message)||"Failed to load stock take")}).finally(()=>{S&&n(!1)}),()=>{S=!1}},[t,r]);const v=x.useMemo(()=>{const S=new Map;for(const B of d)S.set(String(B.id),B);return S},[d]),b=()=>{g(S=>{var B;return{...S,details:[...S.details,{item_id:(B=d[0])!=null&&B.id?String(d[0].id):"",physical_qty:""}]}})},y=S=>{g(B=>({...B,details:B.details.filter((P,L)=>L!==S)}))},j=(S,B)=>{g(P=>({...P,details:P.details.map((L,U)=>U===S?{...L,...B}:L)}))},N=async S=>{var B,P;S.preventDefault(),l(!0),u("");try{const L={stock_take_no:f.stock_take_no||null,stock_take_date:f.stock_take_date,warehouse_id:f.warehouse_id?Number(f.warehouse_id):null,status:f.status||"DRAFT",details:(f.details||[]).map(U=>({item_id:U.item_id?Number(U.item_id):null,physical_qty:U.physical_qty===""?null:Number(U.physical_qty)}))};if(!L.stock_take_date)throw new Error("Date is required");r?await ee.post("/inventory/stock-takes",L):await ee.put(`/inventory/stock-takes/${t}`,L),s("/inventory/stock-take")}catch(L){u(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||(L==null?void 0:L.message)||"Failed to save stock take")}finally{l(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Stock Take":"Edit Stock Take"}),e.jsx("p",{className:"text-sm mt-1",children:"Record physical stock quantities"})]}),e.jsx(Le,{to:"/inventory/stock-take",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[a?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,o?e.jsx("div",{className:"text-sm text-red-600",children:o}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"No"}),e.jsx("input",{type:"text",className:"input",value:f.stock_take_no,onChange:S=>g({...f,stock_take_no:S.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{type:"date",className:"input",value:f.stock_take_date,onChange:S=>g({...f,stock_take_date:S.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:f.status,onChange:S=>g({...f,status:S.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"COMPLETED",children:"COMPLETED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:f.warehouse_id,onChange:S=>g({...f,warehouse_id:S.target.value}),children:[e.jsx("option",{value:"",children:"All / Not specified"}),h.map(S=>e.jsx("option",{value:String(S.id),children:(S.warehouse_code?`${S.warehouse_code} - `:"")+S.warehouse_name},S.id))]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Count Lines"}),e.jsx("button",{type:"button",className:"btn-success",onClick:b,children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Physical Qty"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[f.details.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:'No lines. Click "Add Item" to begin.'})}),f.details.map((S,B)=>{const P=S.item_id?v.get(String(S.item_id)):null,L=P?`${P.item_code} - ${P.item_name}`:"Select item...";return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsxs("select",{className:"input",value:S.item_id,onChange:U=>j(B,{item_id:U.target.value}),children:[e.jsx("option",{value:"",children:"Select item..."}),d.map(U=>e.jsxs("option",{value:String(U.id),children:[U.item_code," - ",U.item_name]},U.id))]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:L})]}),e.jsx("td",{children:e.jsx("input",{type:"number",step:"0.001",className:"input",value:S.physical_qty,onChange:U=>j(B,{physical_qty:U.target.value})})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>y(B),children:"Remove"})})]},B)})]})]})})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/stock-take",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:i,children:i?"Saving...":"Save"})]})]})})]})})}function LY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState(!1),[c,h]=x.useState(""),[A,f]=x.useState("");x.useEffect(()=>{let b=!0;return o(!0),h(""),d(!0),f(""),ee.get("/inventory/item-groups").then(y=>{var j;b&&a(Array.isArray((j=y.data)==null?void 0:j.items)?y.data.items:[])}).catch(y=>{var j,N;b&&h(((N=(j=y==null?void 0:y.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load item groups")}).finally(()=>{b&&o(!1)}),ee.get("/inventory/item-categories").then(y=>{var j;b&&i(Array.isArray((j=y.data)==null?void 0:j.items)?y.data.items:[])}).catch(y=>{var j,N;b&&f(((N=(j=y==null?void 0:y.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load item categories")}).finally(()=>{b&&d(!1)}),()=>{b=!1}},[]);const g=x.useMemo(()=>{const b=t.toLowerCase();return r.filter(y=>String(y.group_code||"").toLowerCase().includes(b)||String(y.group_name||"").toLowerCase().includes(b)||String(y.parent_group_name||"").toLowerCase().includes(b))},[r,t]),v=x.useMemo(()=>{const b=t.toLowerCase();return n.filter(y=>String(y.category_code||"").toLowerCase().includes(b)||String(y.category_name||"").toLowerCase().includes(b)||String(y.parent_category_name||"").toLowerCase().includes(b))},[n,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Item Groups & Sub Groups"}),e.jsx("p",{className:"text-sm mt-1",children:"Organize items by categories"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/item-groups/new",className:"btn-success",children:"+ New Group"})]})]})}),e.jsxs("div",{className:"card-body",children:[c?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:c}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, or parent...",className:"input max-w-md",value:t,onChange:b=>s(b.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Parent"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!l&&!g.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No item groups found"})}):null,g.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:b.group_code}),e.jsx("td",{children:b.group_name}),e.jsx("td",{children:b.parent_group_name||"-"}),e.jsx("td",{children:b.is_active?"Yes":"No"}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/item-groups/${b.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/item-groups/${b.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},b.id))]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex justify-between items-center text-white",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold dark:text-brand-300",children:"Item Categories"}),e.jsx("p",{className:"text-sm mt-1",children:"Organize items by category"})]})})}),e.jsxs("div",{className:"card-body",children:[A?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:A}):null,e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Parent"}),e.jsx("th",{children:"Active"})]})}),e.jsxs("tbody",{children:[u?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!u&&!v.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No item categories found"})}):null,v.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:b.category_code}),e.jsx("td",{children:b.category_name}),e.jsx("td",{children:b.parent_category_name||"-"}),e.jsx("td",{children:b.is_active?"Yes":"No"})]},b.id))]})]})})]})]})]})}const DY=()=>{const[t,s]=x.useState("groups"),[r,a]=x.useState([]),{uoms:n,refresh:i}=el(),{categories:l,refresh:o}=PB(),{itemTypes:u,refresh:d}=RB(),[c,h]=x.useState(!1),[A,f]=x.useState("create"),[g,v]=x.useState("group"),[b,y]=x.useState(""),[j,N]=x.useState(null),[S,B]=x.useState(!1),[P,L]=x.useState({code:"",name:"",type:"COUNT",parent:"",active:"Y"}),U=[{value:"COUNT",label:"Count"},{value:"WEIGHT",label:"Weight"},{value:"VOLUME",label:"Volume"},{value:"LENGTH",label:"Length"}],H=(Array.isArray(l)?l:[]).map(E=>({...E,category_id:E.category_id??E.id,is_active:E.is_active===1||E.is_active===!0||E.is_active==="Y"?"Y":"N"})),q=(Array.isArray(u)?u:[]).map(E=>({...E,type_id:E.type_id??E.id,is_active:E.is_active===1||E.is_active===!0||E.is_active==="Y"?"Y":"N"}));x.useEffect(()=>{V()},[]);const V=async()=>{var E;try{B(!0);const w=await ee.get("/inventory/item-groups"),R=(Array.isArray((E=w.data)==null?void 0:E.items)?w.data.items:[]).map(X=>({group_id:X.id,group_code:X.group_code,group_name:X.group_name,is_active:X.is_active?"Y":"N"}));a(R)}catch(w){console.error("Failed to fetch item groups",w)}finally{B(!1)}},M=(E,w)=>{const O=w.reduce((R,X)=>{const ne=X.group_code||X.category_code||X.uom_code||X.type_code,te=parseInt(ne.replace(/\D/g,""))||0;return Math.max(R,te)},0);return`${E}${(O+1).toString().padStart(3,"0")}`},z=(E,w,O=null)=>{if(v(E),f(w),w==="create"){const R=E==="group"?"GRP":E==="category"?"CAT":E==="type"?"TYP":"";L({code:R?M(R,E==="group"?r:E==="category"?H:E==="type"?q:n):"",name:"",type:"COUNT",parent:"",active:"Y"})}else w==="edit"&&O&&(L({code:O.group_code||O.category_code||O.uom_code||O.type_code,name:O.group_name||O.category_name||O.uom_name||O.type_name,type:O.uom_type||"COUNT",parent:O.parent_category_id||"",active:O.is_active===1||O.is_active==="Y"?"Y":"N"}),N(O));h(!0)},I=async()=>{var E,w;if(!P.name){alert("Please fill in all required fields");return}try{if(g==="group"){const O={group_code:P.code,group_name:P.name,is_active:P.active==="Y"?1:0};A==="create"?await ee.post("/inventory/item-groups",O):await ee.put(`/inventory/item-groups/${j.group_id}`,O),await V()}else if(g==="category"){const O={category_code:P.code,category_name:P.name,parent_category_id:P.parent||null,is_active:P.active==="Y"?1:0};A==="create"?await ee.post("/inventory/item-categories",O):await ee.put(`/inventory/item-categories/${j.id}`,O),await o()}else if(g==="uom"){const O={uom_code:P.code,uom_name:P.name,uom_type:P.type,is_active:P.active==="Y"?1:0};A==="create"?await ee.post("/inventory/uoms",O):await ee.put(`/inventory/uoms/${j.id}`,O),await i()}else if(g==="type"){const O={type_code:P.code,type_name:P.name,is_active:P.active==="Y"?1:0};A==="create"?await ee.post("/inventory/item-types",O):await ee.put(`/inventory/item-types/${j.type_id}`,O),await d()}h(!1),N(null)}catch(O){alert("Failed to save item: "+(((w=(E=O.response)==null?void 0:E.data)==null?void 0:w.message)||O.message))}},G=async(E,w)=>{var O,R,X,ne,te,oe;if(window.confirm("Are you sure you want to delete this item?")){if(E==="group")alert("Delete is not currently supported for Item Groups.");else if(E==="category")try{await ee.delete(`/inventory/item-categories/${w}`),await o()}catch(ce){alert("Failed to delete category: "+(((R=(O=ce.response)==null?void 0:O.data)==null?void 0:R.message)||ce.message))}else if(E==="uom")try{await ee.delete(`/inventory/uoms/${w}`),await i()}catch(ce){alert("Failed to delete UOM: "+(((ne=(X=ce.response)==null?void 0:X.data)==null?void 0:ne.message)||ce.message))}else if(E==="type")try{await ee.delete(`/inventory/item-types/${w}`),await d()}catch(ce){alert("Failed to delete item type: "+(((oe=(te=ce.response)==null?void 0:te.data)==null?void 0:oe.message)||ce.message))}}},Y=E=>{if(!E)return"Root";const w=H.find(O=>O.category_id===E);return w?w.category_name:"Root"},J=E=>{var w;return((w=U.find(O=>O.value===E))==null?void 0:w.label)||E},T=(E,w)=>E.filter(O=>[O.group_code||"",O.group_name||"",O.category_code||"",O.category_name||"",O.uom_code||"",O.uom_name||"",O.type_code||"",O.type_name||""].some(X=>X.toLowerCase().includes(w.toLowerCase()))),k=T(r,b),D=T(H,b),Q=T(n,b),C=T(q,b);return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Item Setup Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage item groups, categories, and units of measure"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Item Groups"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),e.jsx(Jd,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Categories"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:H.length})]}),e.jsx(MN,{className:"w-10 h-10 text-green-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Item Types"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q.length})]}),e.jsx(Jd,{className:"w-10 h-10 text-amber-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Units of Measure"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]}),e.jsx(HN,{className:"w-10 h-10 text-purple-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px",children:[e.jsx("button",{onClick:()=>s("groups"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="groups"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jd,{className:"w-5 h-5"}),"Item Groups"]})}),e.jsx("button",{onClick:()=>s("categories"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="categories"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(MN,{className:"w-5 h-5"}),"Categories"]})}),e.jsx("button",{onClick:()=>s("types"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="types"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jd,{className:"w-5 h-5"}),"Item Types"]})}),e.jsx("button",{onClick:()=>s("uom"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="uom"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(HN,{className:"w-5 h-5"}),"Units of Measure"]})})]})}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 w-full md:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(L0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:b,onChange:E=>y(E.target.value)})]})}),e.jsxs("button",{onClick:()=>z(t==="groups"?"group":t==="categories"?"category":t==="types"?"type":"uom","create"),className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#0E3646"},children:[e.jsx(xu,{className:"w-5 h-5"}),"Add New"]})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[t==="groups"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Group Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[S&&e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-4",children:"Loading..."})}),!S&&k.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:E.group_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.group_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${E.is_active==="Y"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.is_active==="Y"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z("group","edit",E),className:"text-blue-600 hover:text-blue-900",children:e.jsx(eA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>G("group",E.group_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Hl,{className:"w-5 h-5"})})]})})]},E.group_id))]})]}),t==="categories"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Category Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Parent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:E.category_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.category_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:Y(E.parent_category_id)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${E.is_active==="Y"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.is_active==="Y"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z("category","edit",E),className:"text-blue-600 hover:text-blue-900",children:e.jsx(eA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>G("category",E.category_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Hl,{className:"w-5 h-5"})})]})})]},E.category_id))})]}),t==="types"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Type Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:E.type_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.type_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${E.is_active==="Y"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.is_active==="Y"?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z("type","edit",E),className:"text-blue-600 hover:text-blue-900",children:e.jsx(eA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>G("type",E.type_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Hl,{className:"w-5 h-5"})})]})})]},E.type_id))})]}),t==="uom"&&e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"UOM Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map(E=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:E.uom_code}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:E.uom_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:J(E.uom_type)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${E.is_active==="Y"||E.is_active===1||E.is_active===!0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.is_active==="Y"||E.is_active===1||E.is_active===!0?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>z("uom","edit",E),className:"text-blue-600 hover:text-blue-900",children:e.jsx(eA,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>G("uom",E.uom_id),className:"text-red-600 hover:text-red-900",children:e.jsx(Hl,{className:"w-5 h-5"})})]})})]},E.uom_id))})]})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full",children:[e.jsx("div",{className:"p-6 border-b",style:{backgroundColor:"#0E3646"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-bold text-white",children:[A==="create"?"Add":"Edit"," ",g==="group"?"Group":g==="category"?"Category":g==="type"?"Item Type":"UOM"]}),e.jsx("button",{onClick:()=>h(!1),className:"text-white hover:text-gray-200",children:e.jsx(PC,{className:"w-6 h-6"})})]})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Code *"}),e.jsx("input",{type:"text",value:P.code,onChange:E=>L({...P,code:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",readOnly:g!=="uom"&&A==="create"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:P.name,onChange:E=>L({...P,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter name"})]}),g==="category"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parent Category"}),e.jsxs("select",{value:P.parent,onChange:E=>L({...P,parent:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Root (No Parent)"}),H.filter(E=>E.category_id!==(j==null?void 0:j.category_id)).map(E=>e.jsx("option",{value:E.category_id,children:E.category_name},E.category_id))]})]}),g==="uom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsx("select",{value:P.type,onChange:E=>L({...P,type:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:U.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:P.active,onChange:E=>L({...P,active:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"Y",children:"Active"}),e.jsx("option",{value:"N",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3 rounded-b-lg",children:[e.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:I,className:"px-4 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#0E3646"},children:A==="create"?"Create":"Save Changes"})]})]})})]})};function UY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let d=!0;return i(!0),o(""),ee.get("/inventory/unit-conversions").then(c=>{var h;d&&a(Array.isArray((h=c.data)==null?void 0:h.items)?c.data.items:[])}).catch(c=>{var h,A;d&&o(((A=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load unit conversions")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=x.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.item_code||"").toLowerCase().includes(d)||String(c.item_name||"").toLowerCase().includes(d)||String(c.from_uom||"").toLowerCase().includes(d)||String(c.to_uom||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Unit Conversion"}),e.jsx("p",{className:"text-sm mt-1",children:"Define unit conversions per item"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/unit-conversions/new",className:"btn-success",children:"+ New Conversion"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by item, from/to UOM...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{children:"Factor"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No unit conversions found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"font-medium text-slate-900 dark:text-slate-100",children:[d.item_code," - ",d.item_name]})}),e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.from_uom}),e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.to_uom}),e.jsx("td",{children:d.conversion_factor}),e.jsx("td",{children:d.is_active?"Yes":"No"}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/unit-conversions/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/unit-conversions/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function PY(){const[t,s]=x.useState("conversions"),[r,a]=x.useState(!1),[n,i]=x.useState(""),{uoms:l,loading:o}=el(),[u,d]=x.useState([]),[c,h]=x.useState([]),[A,f]=x.useState(""),[g,v]=x.useState(""),[b,y]=x.useState(""),[j,N]=x.useState(!1),[S,B]=x.useState("create"),[P,L]=x.useState({item_id:"",from_uom:"",to_uom:"",conversion_factor:"1",is_active:!0}),[U,H]=x.useState(""),[q,V]=x.useState(""),[M,z]=x.useState(""),[I,G]=x.useState(""),[Y,J]=x.useState(null);x.useEffect(()=>{let R=!0;return a(!0),i(""),Promise.all([ee.get("/inventory/items"),ee.get("/inventory/unit-conversions")]).then(([X,ne])=>{var te,oe;R&&(d(Array.isArray((te=X.data)==null?void 0:te.items)?X.data.items:[]),h(Array.isArray((oe=ne.data)==null?void 0:oe.items)?ne.data.items:[]))}).catch(X=>{var ne,te;R&&i(((te=(ne=X==null?void 0:X.response)==null?void 0:ne.data)==null?void 0:te.message)||"Failed to load data")}).finally(()=>{R&&a(!1)}),()=>{R=!1}},[]),x.useMemo(()=>{const R=new Map;for(const X of u)R.set(String(X.id),X);return R},[u]);const T=async()=>{var R,X,ne,te;a(!0),i("");try{const[oe,ce]=await Promise.all([ee.get("/inventory/items"),ee.get("/inventory/unit-conversions")]);d(Array.isArray((R=oe.data)==null?void 0:R.items)?oe.data.items:[]),h(Array.isArray((X=ce.data)==null?void 0:X.items)?ce.data.items:[])}catch(oe){i(((te=(ne=oe==null?void 0:oe.response)==null?void 0:ne.data)==null?void 0:te.message)||"Failed to refresh data")}finally{a(!1)}},k=x.useMemo(()=>{const R=A.toLowerCase();return c.filter(X=>{const ne=String(X.item_code||"").toLowerCase().includes(R)||String(X.item_name||"").toLowerCase().includes(R),te=g?String(X.from_uom||"")===g:!0,oe=b===""?!0:b==="Y"?!!X.is_active:!X.is_active;return ne&&te&&oe}).sort((X,ne)=>String(X.item_name||"").localeCompare(String(ne.item_name||"")))},[c,A,g,b]),D=(R,X=null)=>{B(R),R==="create"?L({item_id:"",from_uom:"",to_uom:"",conversion_factor:"1",is_active:!0}):X&&L({item_id:X.item_id?String(X.item_id):"",from_uom:X.from_uom||"",to_uom:X.to_uom||"",conversion_factor:X.conversion_factor!=null?String(X.conversion_factor):"1",is_active:!!X.is_active,id:X.id}),N(!0)},Q=async()=>{var X,ne;const R={item_id:P.item_id?Number(P.item_id):null,from_uom:String(P.from_uom||"").trim(),to_uom:String(P.to_uom||"").trim(),conversion_factor:Number(P.conversion_factor),is_active:P.is_active?1:0};if(!R.item_id)return alert("Item is required");if(!R.from_uom)return alert("From UOM is required");if(!R.to_uom)return alert("To UOM is required");if(!Number.isFinite(R.conversion_factor)||R.conversion_factor<=0)return alert("Conversion factor must be a positive number");try{S==="create"?await ee.post("/inventory/unit-conversions",R):await ee.put(`/inventory/unit-conversions/${P.id}`,R),N(!1),await T()}catch(te){alert(((ne=(X=te==null?void 0:te.response)==null?void 0:X.data)==null?void 0:ne.message)||"Failed to save unit conversion")}},C=async R=>{alert("Delete is not currently supported for Unit Conversions.")},E=x.useMemo(()=>{const R=U?Number(U):null;return R?c.filter(X=>Number(X.item_id)===R):[]},[c,U]),w=x.useMemo(()=>{const R=new Set;for(const X of E)R.add(X.from_uom);return Array.from(R)},[E]),O=x.useMemo(()=>{const R=new Set;for(const X of E)R.add(X.to_uom);return Array.from(R)},[E]);return x.useEffect(()=>{if(!U||!M||!I||!q){J(null);return}const R=E.find(ne=>String(ne.from_uom)===String(M)&&String(ne.to_uom)===String(I));if(!R){J(null);return}const X=Number(q);if(!Number.isFinite(X)){J(null);return}J(X*Number(R.conversion_factor||0))},[U,M,I,q,E]),e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-1",children:"Unit Conversion Management"}),e.jsx("p",{className:"text-gray-600",children:"Define and calculate item unit conversions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Back to Menu"}),e.jsx("button",{className:"btn-success",onClick:T,children:"Refresh"}),e.jsx("button",{className:"btn-success",onClick:()=>D("create"),children:"+ New Conversion"})]})]})}),n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px",children:[e.jsx("button",{onClick:()=>s("conversions"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="conversions"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Unit Conversions"}),e.jsx("button",{onClick:()=>s("uom"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="uom"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Units of Measure"}),e.jsx("button",{onClick:()=>s("calculator"),className:`py-4 px-6 font-medium text-sm border-b-2 transition-colors ${t==="calculator"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:"Quick Calculator"})]})}),e.jsxs("div",{className:"p-4",children:[t==="conversions"&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[e.jsx("input",{className:"input",placeholder:"Search by item name or code",value:A,onChange:R=>f(R.target.value)}),e.jsxs("select",{className:"input",value:g,onChange:R=>v(R.target.value),children:[e.jsx("option",{value:"",children:"All Units"}),Array.from(new Set(c.map(R=>R.from_uom))).map(R=>R?e.jsx("option",{value:R,children:R},R):null)]}),e.jsxs("select",{className:"input",value:b,onChange:R=>y(R.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"Y",children:"Active"}),e.jsx("option",{value:"N",children:"Inactive"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>{},children:"Search"}),e.jsx("button",{className:"btn-outline",onClick:()=>{f(""),v(""),y("")},children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{children:"From UOM"}),e.jsx("th",{children:"To UOM"}),e.jsx("th",{children:"Conversion Factor"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500",children:"Loading..."})}):null,!r&&!k.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500",children:"No conversions found"})}):null,k.map(R=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:R.item_code}),e.jsx("td",{children:R.item_name}),e.jsx("td",{children:R.from_uom}),e.jsx("td",{children:R.to_uom}),e.jsx("td",{children:Number(R.conversion_factor||0).toString()}),e.jsx("td",{children:e.jsx("span",{className:`badge ${R.is_active?"badge-success":"badge-error"}`,children:R.is_active?"ACTIVE":"INACTIVE"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:()=>D("edit",R),children:"Edit"}),e.jsx("button",{className:"btn-outline",onClick:()=>C(R.id),children:"Delete"})]})})]},R.id))]})]})})]}),t==="uom"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"UOM Code"}),e.jsx("th",{children:"UOM Name"}),e.jsx("th",{children:"UOM Type"}),e.jsx("th",{children:"Status"})]})}),e.jsxs("tbody",{children:[o?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500",children:"Loading..."})}):null,!o&&!l.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-8 text-slate-500",children:"No UOMs found"})}):null,l.map(R=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:R.uom_code}),e.jsx("td",{children:R.uom_name}),e.jsx("td",{children:R.uom_type}),e.jsx("td",{children:R.is_active?"Active":"Inactive"})]},R.id))]})]})}),t==="calculator"&&e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Select Item"}),e.jsxs("select",{className:"input",value:U,onChange:R=>{H(R.target.value),z(""),G(""),J(null)},children:[e.jsx("option",{value:"",children:"Choose an item..."}),u.map(R=>e.jsx("option",{value:String(R.id),children:(R.item_code||"")+" - "+(R.item_name||"")},R.id))]})]})}),e.jsxs("div",{className:"bg-slate-50 border rounded p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"label",children:"Value to Convert"}),e.jsx("input",{type:"number",step:"0.000001",className:"input",value:q,onChange:R=>V(R.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Unit"}),e.jsxs("select",{className:"input",value:M,onChange:R=>z(R.target.value),children:[e.jsx("option",{value:"",children:"Select unit"}),w.map(R=>e.jsx("option",{value:R,children:R},R))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Unit"}),e.jsxs("select",{className:"input",value:I,onChange:R=>G(R.target.value),children:[e.jsx("option",{value:"",children:"Select unit"}),O.map(R=>e.jsx("option",{value:R,children:R},R))]})]}),e.jsx("div",{children:e.jsx("button",{className:"btn-success w-full",onClick:()=>{},children:"Calculate"})})]}),e.jsx("div",{className:"mt-4",children:Y!=null?e.jsxs("div",{className:"p-3 border-2 rounded text-center text-lg font-semibold",children:[q||0," ",M||""," = ",Y," ",I||""]}):e.jsx("div",{className:"text-sm text-slate-500",children:"Select item and units to calculate"})})]})]})]})]}),j?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow max-w-xl w-full",children:[e.jsxs("div",{className:"px-5 py-4 border-b flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-semibold",children:S==="create"?"New Conversion":"Edit Conversion"}),e.jsx("button",{className:"btn-outline",onClick:()=>N(!1),children:""})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Item *"}),e.jsxs("select",{className:"input",value:P.item_id,onChange:R=>L({...P,item_id:R.target.value}),children:[e.jsx("option",{value:"",children:"Select item..."}),u.map(R=>e.jsx("option",{value:String(R.id),children:(R.item_code||"")+" - "+(R.item_name||"")},R.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:P.is_active,onChange:R=>L({...P,is_active:R.target.checked})}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From UOM *"}),e.jsxs("select",{className:"input",value:P.from_uom,onChange:R=>L({...P,from_uom:R.target.value}),children:[e.jsx("option",{value:"",children:"Select unit"}),o?e.jsx("option",{children:"Loading..."}):l.map(R=>e.jsx("option",{value:R.uom_code,children:R.uom_code},R.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To UOM *"}),e.jsxs("select",{className:"input",value:P.to_uom,onChange:R=>L({...P,to_uom:R.target.value}),children:[e.jsx("option",{value:"",children:"Select unit"}),o?e.jsx("option",{children:"Loading..."}):l.map(R=>e.jsx("option",{value:R.uom_code,children:R.uom_code},R.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Factor *"}),e.jsx("input",{type:"number",step:"0.000001",className:"input",value:P.conversion_factor,onChange:R=>L({...P,conversion_factor:R.target.value})})]})]})]}),e.jsxs("div",{className:"px-5 py-4 border-t flex justify-end gap-2",children:[e.jsx("button",{className:"btn-outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx("button",{className:"btn-success",onClick:Q,children:"Save"})]})]})}):null]})})}function RY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState(!1),[c,h]=x.useState(null),[A,f]=x.useState(!1),[g,v]=x.useState(""),[b,y]=x.useState(null),[j,N]=x.useState(null),[S,B]=x.useState([]),[P,L]=x.useState(!1),[U,H]=x.useState(null),[q,V]=x.useState(null);x.useEffect(()=>{let k=!0;return i(!0),o(""),ee.get("/inventory/stock-adjustments").then(D=>{var Q;k&&a(Array.isArray((Q=D.data)==null?void 0:Q.items)?D.data.items:[])}).catch(D=>{var Q,C;k&&o(((C=(Q=D==null?void 0:D.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load stock updations")}).finally(()=>{k&&i(!1)}),()=>{k=!1}},[]);const M=k=>({DRAFT:"badge-info",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-success",POSTED:"badge-success",REJECTED:"badge-error",CANCELLED:"badge-error",RETURNED:"badge-error"})[k]||"badge-info",z=x.useMemo(()=>r.filter(k=>String(k.adjustment_no||"").toLowerCase().includes(t.toLowerCase())),[r,t]),I=k=>{if(!k)return"";let D=new Date(k);return isNaN(D.getTime())&&(isNaN(Number(k))||(D=new Date(Number(k)))),isNaN(D.getTime())?String(k):D.toLocaleDateString()},G=async k=>{var D,Q,C;if(h(k),d(!0),v(""),U)await Y();else try{f(!0);const E=await ee.get("/workflows"),w=Array.isArray((D=E.data)==null?void 0:D.items)?E.data.items:[];H(w),await J(w)}catch(E){v(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load workflows")}finally{f(!1)}},Y=async()=>{var C,E,w;if(!U||!U.length){y(null),N(null),v("");return}const k="/inventory/stock-adjustments",D=O=>String(O||"").trim().toUpperCase().replace(/\s+/g,"_"),Q=U.find(O=>Number(O.is_active)===1&&String(O.document_route)===k)||U.find(O=>Number(O.is_active)===1&&D(O.document_type)==="STOCK_ADJUSTMENT")||null;if(y(Q||null),N(null),!!Q)try{f(!0);const R=(C=(await ee.get(`/workflows/${Q.id}`)).data)==null?void 0:C.item,X=Array.isArray(R==null?void 0:R.steps)?R.steps:[];B(X);const ne=X[0]||null;if(N(ne?{userId:ne.approver_user_id,name:ne.approver_name,stepName:ne.step_name,stepOrder:ne.step_order,approvalLimit:ne.approval_limit}:null),ne){const te=(Array.isArray(ne.approvers)&&ne.approvers.length?ne.approvers[0].id:ne.approver_user_id)||null;V(te)}else V(null)}catch(O){v(((w=(E=O==null?void 0:O.response)==null?void 0:E.data)==null?void 0:w.message)||"Failed to load workflow details")}finally{f(!1)}},J=async k=>{var E,w,O;if(!k||!k.length){y(null),N(null),v("");return}const D="/inventory/stock-adjustments",Q=R=>String(R||"").trim().toUpperCase().replace(/\s+/g,"_"),C=k.find(R=>Number(R.is_active)===1&&String(R.document_route)===D)||k.find(R=>Number(R.is_active)===1&&Q(R.document_type)==="STOCK_ADJUSTMENT")||null;if(y(C||null),N(null),!!C)try{f(!0);const X=(E=(await ee.get(`/workflows/${C.id}`)).data)==null?void 0:E.item,ne=Array.isArray(X==null?void 0:X.steps)?X.steps:[];B(ne);const te=ne[0]||null;N(te?{userId:te.approver_user_id,name:te.approver_name,stepName:te.step_name,stepOrder:te.step_order,approvalLimit:te.approval_limit}:null)}catch(R){v(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load workflow details")}finally{f(!1)}},T=async()=>{var k,D,Q;if(c){L(!0),v("");try{const C=await ee.post(`/inventory/stock-adjustments/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:q||null}),E=((k=C==null?void 0:C.data)==null?void 0:k.status)||"PENDING_APPROVAL";a(w=>w.map(O=>O.id===c.id?{...O,status:E}:O)),d(!1),h(null)}catch(C){v(((Q=(D=C==null?void 0:C.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to forward for approval")}finally{L(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Stock Updation"}),e.jsx("p",{className:"text-sm mt-1",children:"Update stock levels (uses Stock Adjustments)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/stock-updation/new",className:"btn-success",children:"+ New Updation"})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by document number...",className:"input max-w-md",value:t,onChange:k=>s(k.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Document No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:l})}):null,z.map(k=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:k.adjustment_no}),e.jsx("td",{children:I(k.adjustment_date)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${k.adjustment_type==="INCREASE"?"badge-success":"badge-warning"}`,children:k.adjustment_type})}),e.jsx("td",{children:k.item_count}),e.jsx("td",{children:e.jsx("span",{className:`badge ${M(k.status)} `,children:k.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Le,{to:`/inventory/stock-updation/${k.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/stock-updation/${k.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),k.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):k.status==="DRAFT"||k.status==="RETURNED"?e.jsx("button",{type:"button",onClick:()=>G(k),className:"text-sm font-medium px-2 py-1 rounded bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:"Forward"}):null]})})]},k.id))]})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),h(null),y(null),N(null),v("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.adjustment_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[A?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const D=Array.isArray(S)&&S.length>0?S[0]:null,Q=D?Array.isArray(D.approvers)&&D.approvers.length?D.approvers.map(C=>({id:C.id,name:C.username})):D.approver_user_id?[{id:D.approver_user_id,name:D.approver_name||String(D.approver_user_id)}]:[]:[];return Q.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:q||"",onChange:C=>V(C.target.value?Number(C.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Q.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:j?`Step ${j.stepOrder}  ${j.stepName}${j.approvalLimit!=null?`  Limit: ${Number(j.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),h(null),y(null),N(null),v("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:T,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function OY(){const{uoms:t,loading:s}=el(),{id:r}=Ls(),a=ys(),n=r==="new",[i]=Ef(),l=(i.get("mode")||"").toLowerCase(),o=!n&&l==="view",[u,d]=x.useState(!1),[c,h]=x.useState(!1),[A,f]=x.useState(""),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState([]),[S,B]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),P=x.useMemo(()=>{const T=Array.isArray(t)?t:[],k=T.find(D=>String(D.uom_code||"").toUpperCase()==="PCS")||T[0];return k&&k.uom_code?k.uom_code:"PCS"},[t]),[L,U]=x.useState({adjustmentNo:"",adjustmentDate:new Date().toISOString().split("T")[0],warehouseId:"",adjustmentType:"PHYSICAL_COUNT",referenceDoc:"",reason:"",status:"DRAFT"}),[H,q]=x.useState([]);x.useEffect(()=>{let T=!0;return Promise.all([ee.get("/inventory/items"),ee.get("/inventory/warehouses"),ee.get("/inventory/unit-conversions")]).then(([k,D,Q])=>{var C,E,w;T&&(v(Array.isArray((C=k.data)==null?void 0:C.items)?k.data.items:[]),y(Array.isArray((E=D.data)==null?void 0:E.items)?D.data.items:[]),N(Array.isArray((w=Q.data)==null?void 0:w.items)?Q.data.items:[]))}).catch(k=>{var D,Q;T&&f(((Q=(D=k==null?void 0:k.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to load lookups")}),()=>{T=!1}},[]),x.useEffect(()=>{if(n){q([{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}]);return}let T=!0;return d(!0),f(""),ee.get(`/inventory/stock-adjustments/${r}`).then(k=>{var C,E;if(!T)return;const D=(C=k.data)==null?void 0:C.item,Q=Array.isArray((E=k.data)==null?void 0:E.details)?k.data.details:[];D&&(U({adjustmentNo:D.adjustment_no||"",adjustmentDate:D.adjustment_date?new Date(D.adjustment_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],warehouseId:D.warehouse_id?String(D.warehouse_id):"",adjustmentType:D.adjustment_type||"PHYSICAL_COUNT",referenceDoc:D.reference_doc||"",reason:D.reason||"",status:D.status||"DRAFT"}),q(Q.length?Q.map(w=>({id:w.id||Date.now()+Math.random(),item_id:w.item_id?String(w.item_id):"",itemCode:w.item_code||"",itemName:w.item_name||"",currentStock:Number(w.current_stock)||0,adjustedStock:Number(w.adjusted_stock)||0,uom:w.uom||"",unitCost:Number(w.unit_cost)||0,remarks:w.remarks||""})):[]))}).catch(k=>{var D,Q;T&&f(((Q=(D=k==null?void 0:k.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to load stock adjustment")}).finally(()=>{T&&d(!1)}),()=>{T=!1}},[r,n]);const V=x.useMemo(()=>H.filter(T=>T.item_id).map(T=>({item_id:Number(T.item_id),current_stock:Number(T.currentStock)||0,adjusted_stock:Number(T.adjustedStock)||0,qty:Number(T.adjustedStock)-Number(T.currentStock),unit_cost:Number(T.unitCost)||0,remarks:T.remarks})),[H]),M=async T=>{var k,D;T.preventDefault(),h(!0),f("");try{const Q={adjustment_no:n?void 0:L.adjustmentNo,adjustment_date:L.adjustmentDate,warehouse_id:L.warehouseId?Number(L.warehouseId):null,adjustment_type:L.adjustmentType,reference_doc:L.referenceDoc,reason:L.reason,status:L.status,details:V};n?await ee.post("/inventory/stock-adjustments",Q):await ee.put(`/inventory/stock-adjustments/${r}`,Q),a("/inventory/stock-updation")}catch(Q){f(((D=(k=Q==null?void 0:Q.response)==null?void 0:k.data)==null?void 0:D.message)||"Failed to save stock updation")}finally{h(!1)}},z=()=>{q([...H,{id:Date.now(),item_id:"",itemCode:"",itemName:"",currentStock:0,adjustedStock:0,uom:"",unitCost:0,remarks:""}])},I=T=>{q(H.filter(k=>k.id!==T))},G=(T,k,D)=>{q(H.map(Q=>{if(Q.id===T){const C={...Q,[k]:D};if(k==="item_id"){const E=g.find(w=>String(w.id)===String(D));C.itemCode=(E==null?void 0:E.item_code)||"",C.itemName=(E==null?void 0:E.item_name)||"",C.unitCost=(E==null?void 0:E.cost_price)||0,C.uom=(E==null?void 0:E.uom)&&String(E.uom)||String(P)}return C}return Q}))},Y=T=>{U(k=>({...k,reason:T}))},J=T=>{const k="border-2 rounded-lg p-4 cursor-pointer transition-all text-center hover:shadow-md",D=L.adjustmentType===T?" ring-2 ring-brand-500 bg-brand-50 border-brand-500":" border-slate-200 bg-white";return T==="INCREASE"?`${k} ${D} ${L.adjustmentType===T?"border-green-500 ring-green-500 bg-green-50":"hover:border-green-200"}`:T==="DECREASE"?`${k} ${D} ${L.adjustmentType===T?"border-red-500 ring-red-500 bg-red-50":"hover:border-red-200"}`:`${k} ${D}`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:n?"New Stock Updation":o?"View Stock Updation":"Edit Stock Updation"}),e.jsx("p",{className:"text-sm mt-1",children:"Update stock levels"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:"/inventory/stock-updation",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:" Back to List"})})]})}),e.jsx("div",{className:"card-body p-6",children:e.jsxs("form",{onSubmit:M,className:"space-y-8",children:[u&&e.jsx("div",{className:"text-sm",children:"Loading..."}),A&&e.jsx("div",{className:"p-4 bg-red-50 text-red-600 rounded-md border border-red-200",children:A}),e.jsxs("fieldset",{disabled:o,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Select Updation Type"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:J("PHYSICAL_COUNT"),onClick:()=>U({...L,adjustmentType:"PHYSICAL_COUNT"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Physical Count"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Based on actual inventory count"})]}),e.jsxs("div",{className:J("INCREASE"),onClick:()=>U({...L,adjustmentType:"INCREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Increase"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Add stock (found, corrections)"})]}),e.jsxs("div",{className:J("DECREASE"),onClick:()=>U({...L,adjustmentType:"DECREASE"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Stock Decrease"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Reduce stock (damage, theft)"})]}),e.jsxs("div",{className:J("OTHER"),onClick:()=>U({...L,adjustmentType:"OTHER"}),children:[e.jsx("div",{className:"text-3xl mb-2",children:""}),e.jsx("div",{className:"font-bold text-slate-700",children:"Other Adjustment"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Miscellaneous adjustments"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 border-b pb-2",children:" Updation Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Document No"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:L.adjustmentNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",className:"input",value:L.adjustmentDate,onChange:T=>U({...L,adjustmentDate:T.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:L.warehouseId,onChange:T=>U({...L,warehouseId:T.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Warehouse --"}),b.map(T=>e.jsx("option",{value:T.id,children:T.warehouse_name},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:L.adjustmentType,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference Document"}),e.jsx("input",{type:"text",className:"input",placeholder:"e.g., PC-2024-001",value:L.referenceDoc,onChange:T=>U({...L,referenceDoc:T.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${L.status==="DRAFT"?"bg-slate-200 text-slate-700":"bg-green-100 text-green-700"}`,children:L.status})})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{className:"input",rows:"2",placeholder:"Provide detailed reason for this stock updation...",value:L.reason,onChange:T=>U({...L,reason:T.target.value}),required:!0}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:["Physical count variance","Damaged goods","Expired items","Theft/Loss","Found items","System error correction","Other"].map(T=>e.jsx("button",{type:"button",onClick:()=>Y(T),className:`px-3 py-1 rounded-full text-xs border ${L.reason===T?"bg-brand-500 text-white border-brand-500":"bg-white text-slate-600 border-slate-300 hover:bg-slate-50"}`,children:T},T))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:" Items"}),e.jsx("button",{type:"button",onClick:z,className:"btn-primary text-sm px-3 py-1 rounded bg-brand-600 text-white hover:bg-brand-700",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700 uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"Item"}),e.jsx("th",{className:"p-3 w-24",children:"Current Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Adjusted Stock"}),e.jsx("th",{className:"p-3 w-24",children:"Diff"}),e.jsx("th",{className:"p-3 w-20",children:"UOM"}),e.jsx("th",{className:"p-3 w-24",children:"Unit Cost"}),e.jsx("th",{className:"p-3 w-28",children:"Impact"}),e.jsx("th",{className:"p-3",children:"Remarks"}),e.jsx("th",{className:"p-3 w-16"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200",children:[H.map(T=>{const k=Number(T.adjustedStock)-Number(T.currentStock),D=k*Number(T.unitCost);return e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"input text-sm py-1",value:T.item_id,onChange:Q=>G(T.id,"item_id",Q.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),g.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.item_code," - ",Q.item_name]},Q.id))]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1 bg-slate-50",value:T.currentStock,onChange:Q=>G(T.id,"currentStock",Q.target.value)})}),e.jsxs("td",{className:"p-2",children:[e.jsx("input",{type:"number",className:"input text-sm py-1 font-bold",value:T.adjustedStock,onChange:Q=>G(T.id,"adjustedStock",Q.target.value)}),(()=>{const Q=g.find(R=>String(R.id)===String(T.item_id)),C=(Q==null?void 0:Q.uom)&&String(Q.uom)||T.uom&&String(T.uom)||(P?String(P):""),E=(Array.isArray(j)?j:[]).filter(R=>Number(R.is_active)&&Number(R.item_id)===Number(T.item_id)&&String(R.to_uom)===C).map(R=>String(R.from_uom)),w=T.uom&&String(T.uom)!==C?String(T.uom):E[0]||"";return E.length>0&&w&&w!==C?e.jsx("button",{type:"button",className:"ml-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>B({open:!0,itemId:T.item_id,defaultUom:C,currentUom:w,rowId:T.id}),children:`number of ${w}`}):null})()]}),e.jsx("td",{className:"p-2 font-bold",children:e.jsxs("span",{className:k>0?"text-green-600":k<0?"text-red-600":"text-slate-400",children:[k>0?"+":"",k]})}),e.jsx("td",{className:"p-2",children:e.jsx("select",{className:"input text-sm py-1",value:T.uom,onChange:Q=>G(T.id,"uom",Q.target.value),children:s?e.jsx("option",{children:"Loading..."}):t.map(Q=>e.jsx("option",{value:Q.uom_code,children:Q.uom_code},Q.id))})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1",value:T.unitCost,onChange:Q=>G(T.id,"unitCost",Q.target.value)})}),e.jsx("td",{className:"p-2 font-medium",children:D.toFixed(2)}),e.jsx("td",{className:"p-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",placeholder:"Optional",value:T.remarks,onChange:Q=>G(T.id,"remarks",Q.target.value)})}),e.jsx("td",{className:"p-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>I(T.id),className:"text-red-500 hover:text-red-700",children:""})})]},T.id)}),H.length===0&&e.jsx("tr",{children:e.jsx("td",{colspan:"9",className:"p-8 text-center text-slate-500",children:'No items added. Click "Add Item" to begin.'})})]})]})})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:" Impact Summary"}),e.jsxs("div",{className:"flex gap-8 text-sm",children:[e.jsxs("div",{children:["Total Items:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:H.length})]}),e.jsxs("div",{children:["Net Qty Change:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:H.reduce((T,k)=>T+(Number(k.adjustedStock)-Number(k.currentStock)),0)})]}),e.jsxs("div",{children:["Total Value Impact:"," ",e.jsx("span",{className:"font-bold text-brand-700",children:H.reduce((T,k)=>T+(Number(k.adjustedStock)-Number(k.currentStock))*Number(k.unitCost),0).toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[e.jsx(Le,{to:"/inventory/stock-updation",className:"btn-light bg-white border border-slate-300 text-slate-700 hover:bg-slate-50 px-4 py-2 rounded",children:"Cancel"}),o?null:e.jsx("button",{type:"submit",className:"btn-success bg-green-600 text-white hover:bg-green-700 px-6 py-2 rounded shadow-sm font-medium",children:c?"Saving...":"Save Updation"})]})]})})]}),e.jsx(sd,{open:S.open,onClose:()=>B({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),itemId:S.itemId?Number(S.itemId):null,defaultUom:String(S.defaultUom||""),currentUom:String(S.currentUom||""),conversions:j,onApply:({converted_qty:T})=>{const k=S.rowId;k!=null&&G(k,"adjustedStock",T)}})]})}function QY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState("ALL");x.useEffect(()=>{let N=!0;return o(!0),Promise.all([ee.get("/inventory/stock-adjustments"),ee.get("/inventory/warehouses")]).then(([S,B])=>{var P,L;N&&(a(Array.isArray((P=S.data)==null?void 0:P.items)?S.data.items:[]),i(Array.isArray((L=B.data)==null?void 0:L.items)?B.data.items:[]))}).catch(S=>{var B,P;N&&d(((P=(B=S==null?void 0:S.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to load stock verifications")}).finally(()=>{N&&o(!1)}),()=>{N=!1}},[]);const A=N=>{const S=n.find(B=>B.id===N);return S?S.name:"Unknown Warehouse"},f=[{value:"DRAFT",label:"Draft",color:"bg-gray-100 text-gray-800"},{value:"IN_PROGRESS",label:"In Progress",color:"bg-blue-100 text-blue-800"},{value:"COMPLETED",label:"Completed",color:"bg-green-100 text-green-800"},{value:"ADJUSTED",label:"Adjusted",color:"bg-purple-100 text-purple-800"}],g=N=>{const S=f.find(B=>B.value===N);if(!S){if(N==="POSTED")return e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Posted"});if(N==="CANCELLED")return e.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Cancelled"})}return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${(S==null?void 0:S.color)||"bg-gray-100 text-gray-800"}`,children:(S==null?void 0:S.label)||N})},v=[{value:"PHYSICAL_COUNT",label:"Physical Count"},{value:"CYCLE_COUNT",label:"Cycle Count"},{value:"SPOT_CHECK",label:"Spot Check"}],b=N=>{var S;return((S=v.find(B=>B.value===N))==null?void 0:S.label)||N},y=x.useMemo(()=>r.filter(N=>{const S=String(N.adjustment_no||"").toLowerCase().includes(t.toLowerCase())||!1,B=c==="ALL"||N.status===c;return S&&B}),[r,t,c]),j={total:r.length,inProgress:r.filter(N=>N.status==="IN_PROGRESS"||N.status==="DRAFT").length,completed:r.filter(N=>N.status==="COMPLETED"||N.status==="POSTED").length,variance:0};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Stock Verification"}),e.jsx("p",{className:"text-gray-600",children:"Manage and track warehouse stock verification activities"})]}),e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Verifications"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:j.total})]}),e.jsx(Wy,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"In Progress"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:j.inProgress})]}),e.jsx(Jd,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:j.completed})]}),e.jsx(ZT,{className:"w-10 h-10 text-green-500"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Variance"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["$",j.variance.toFixed(2)]})]}),e.jsx(tI,{className:"w-10 h-10 text-orange-500"})]})})]}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex-1 w-full md:w-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(L0,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search by verification number...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:t,onChange:N=>s(N.target.value)})]})}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs("select",{className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:c,onChange:N=>h(N.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),f.map(N=>e.jsx("option",{value:N.value,children:N.label},N.value))]}),e.jsxs(Le,{to:"/inventory/stock-verification/new",className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#0E3646"},children:[e.jsx(xu,{className:"w-5 h-5"}),"New Verification"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{style:{backgroundColor:"#0E3646"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Verification #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Warehouse"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Variance"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-white uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"Loading..."})}):y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-6 py-4 text-center text-gray-500",children:"No verifications found"})}):y.map(N=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:N.adjustment_no})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"date",value:(()=>{const S=N.adjustment_date,B=new Date(S);if(!isNaN(B))return B.toISOString().split("T")[0];const P=String(S||"");return P.includes("T")?P.split("T")[0]:P})(),readOnly:!0,className:"text-sm text-gray-900 bg-transparent border-0 p-0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:A(N.warehouse_id)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:b(N.adjustment_type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:g(N.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-600",children:"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/inventory/stock-verification/${N.id}?mode=view`,className:"text-blue-600 hover:text-blue-900",title:"View Details",children:e.jsx(I0,{className:"w-5 h-5"})}),e.jsx(Le,{to:`/inventory/stock-verification/${N.id}?mode=edit`,className:"text-green-600 hover:text-green-900",title:"Edit",children:e.jsx(eA,{className:"w-5 h-5"})})]})})]},N.id))})]})})})]})})}function MY(){const{id:t}=Ls(),s=ys(),r=t==="new",[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState([]),[h,A]=x.useState([]),{uoms:f}=el(),[g,v]=x.useState([]),[b,y]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),j=x.useMemo(()=>{const I=Array.isArray(f)?f:[],G=I.find(Y=>String(Y.uom_code||"").toUpperCase()==="PCS")||I[0];return G&&G.uom_code?G.uom_code:"PCS"},[f]),[N,S]=x.useState({verification_number:"",verification_date:new Date().toISOString().split("T")[0],warehouse_id:"",verification_type:"PHYSICAL_COUNT",start_date:new Date().toISOString().split("T")[0],end_date:"",status:"DRAFT",remarks:""}),[B,P]=x.useState([]),L=[{value:"PHYSICAL_COUNT",label:"Physical Count"},{value:"CYCLE_COUNT",label:"Cycle Count"},{value:"SPOT_CHECK",label:"Spot Check"}],U=[{value:"DRAFT",label:"Draft"},{value:"IN_PROGRESS",label:"In Progress"},{value:"COMPLETED",label:"Completed"},{value:"ADJUSTED",label:"Adjusted"}];x.useEffect(()=>{let I=!0;return(async()=>{var Y,J,T;try{const[k,D,Q]=await Promise.all([ee.get("/inventory/items"),ee.get("/inventory/warehouses"),ee.get("/inventory/unit-conversions")]);I&&(c(Array.isArray((Y=k.data)==null?void 0:Y.items)?k.data.items:[]),A(Array.isArray((J=D.data)==null?void 0:J.items)?D.data.items:[]),v(Array.isArray((T=Q.data)==null?void 0:T.items)?Q.data.items:[]))}catch{I&&u("Failed to load initial data")}})(),()=>{I=!1}},[]),x.useEffect(()=>{if(r)return;let I=!0;return n(!0),ee.get(`/inventory/stock-adjustments/${t}`).then(G=>{var T,k;if(!I)return;const Y=(T=G.data)==null?void 0:T.item,J=Array.isArray((k=G.data)==null?void 0:k.details)?G.data.details:[];Y&&(S({verification_number:Y.adjustment_no,verification_date:Y.adjustment_date?Y.adjustment_date.split("T")[0]:"",warehouse_id:Y.warehouse_id||"",verification_type:Y.adjustment_type||"PHYSICAL_COUNT",start_date:new Date().toISOString().split("T")[0],end_date:"",status:Y.status||"DRAFT",remarks:Y.reason||""}),P(J.map(D=>({id:D.id||Date.now()+Math.random(),item_id:D.item_id,qty:Number(D.qty)||0,uom:""}))))}).catch(G=>{var Y,J;I&&u(((J=(Y=G==null?void 0:G.response)==null?void 0:Y.data)==null?void 0:J.message)||"Failed to load verification")}).finally(()=>{I&&n(!1)}),()=>{I=!1}},[t,r]);const H=I=>{const{name:G,value:Y}=I.target;S(J=>({...J,[G]:Y}))},q=()=>{P([...B,{id:Date.now(),item_id:"",qty:0,uom:"PCS"}])},V=I=>{P(B.filter(G=>G.id!==I))},M=(I,G,Y)=>{P(B.map(J=>{if(J.id===I){const T={...J,[G]:Y};if(G==="item_id"){const k=d.find(D=>String(D.id)===String(Y));k&&(T.uom=k.uom||"")}return T}return J}))},z=async I=>{var G,Y;if(I.preventDefault(),!N.warehouse_id||!N.verification_date){alert("Please fill in all required fields");return}l(!0),u("");try{const J={adjustment_no:r?void 0:N.verification_number,adjustment_date:N.verification_date,warehouse_id:Number(N.warehouse_id),adjustment_type:N.verification_type,start_date:N.start_date||null,end_date:N.end_date||null,status:N.status,reason:N.remarks,details:B.filter(T=>T.item_id).map(T=>({item_id:Number(T.item_id),qty:Number(T.qty)}))};r?await ee.post("/inventory/stock-adjustments",J):await ee.put(`/inventory/stock-adjustments/${t}`,J),s("/inventory/stock-verification")}catch(J){u(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to save verification")}finally{l(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Le,{to:"/inventory/stock-verification",className:"p-2 bg-white rounded-full shadow-sm hover:bg-gray-100 transition-colors",children:e.jsx(Uf,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r?"New Stock Verification":"Edit Stock Verification"}),e.jsx("p",{className:"text-sm text-gray-600",children:r?"Create a new stock verification record":`Editing ${N.verification_number}`})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Le,{to:"/inventory/stock-verification",className:"px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:z,disabled:i,className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#0E3646"},children:[e.jsx(Vh,{className:"w-5 h-5"}),i?"Saving...":"Save Verification"]})]})]}),o&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:o}),a?e.jsx("div",{className:"text-center py-12",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4 pb-2 border-b",children:"Verification Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Number"}),e.jsx("input",{type:"text",name:"verification_number",value:N.verification_number,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Date *"}),e.jsx("input",{type:"date",name:"verification_date",value:N.verification_date,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse *"}),e.jsxs("select",{name:"warehouse_id",value:N.warehouse_id,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),h.map(I=>e.jsx("option",{value:I.id,children:I.warehouse_name},I.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Verification Type *"}),e.jsx("select",{name:"verification_type",value:N.verification_type,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:L.map(I=>e.jsx("option",{value:I.value,children:I.label},I.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"start_date",value:N.start_date,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"end_date",value:N.end_date,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),e.jsx("select",{name:"status",value:N.status,onChange:H,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:U.map(I=>e.jsx("option",{value:I.value,children:I.label},I.value))})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),e.jsx("textarea",{name:"remarks",value:N.remarks,onChange:H,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter any additional remarks..."})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Items"}),e.jsxs("button",{onClick:q,className:"flex items-center gap-2 px-3 py-1.5 text-white text-sm font-medium rounded-md hover:opacity-90 transition-opacity",style:{backgroundColor:"#0E3646"},children:[e.jsx(xu,{className:"w-4 h-4"}),"Add Item"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-48",children:"Variance Qty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"UOM"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-8 text-center text-gray-500",children:'No items added yet. Click "Add Item" to start.'})}):B.map(I=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:I.item_id,onChange:G=>M(I.id,"item_id",G.target.value),className:"w-1/2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select Item"}),d.map(G=>e.jsxs("option",{value:G.id,children:[G.item_code," - ",G.item_name]},G.id))]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",value:I.qty,onChange:G=>M(I.id,"qty",parseFloat(G.target.value)||0),className:`${(()=>{const G=d.find(D=>String(D.id)===String(I.item_id)),Y=(G==null?void 0:G.uom)&&String(G.uom)||I.uom&&String(I.uom)||(j?String(j):""),J=(Array.isArray(g)?g:[]).filter(D=>Number(D.is_active)&&Number(D.item_id)===Number(I.item_id)&&String(D.to_uom)===Y).map(D=>String(D.from_uom)),T=J[0]||"";return J.length>0&&T&&T!==Y?"w-3/4":"w-full"})()} px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent`,step:"1"}),(()=>{const G=d.find(D=>String(D.id)===String(I.item_id)),Y=(G==null?void 0:G.uom)&&String(G.uom)||I.uom&&String(I.uom)||(j?String(j):""),J=(Array.isArray(g)?g:[]).filter(D=>Number(D.is_active)&&Number(D.item_id)===Number(I.item_id)&&String(D.to_uom)===Y).map(D=>String(D.from_uom)),T=J[0]||"";return J.length>0&&T&&T!==Y?e.jsx("button",{type:"button",className:"px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>y({open:!0,itemId:I.item_id,defaultUom:Y,currentUom:T,rowId:I.id}),children:`number of ${T}`}):null})()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",value:I.uom||(()=>{const G=d.find(Y=>String(Y.id)===String(I.item_id));return(G==null?void 0:G.uom)&&String(G.uom)||String(j)})(),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500"})})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>V(I.id),className:"text-red-600 hover:text-red-900 p-2 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(Hl,{className:"w-5 h-5"})})})]},I.id))})]})})]})]})]}),e.jsx(sd,{open:b.open,onClose:()=>y({open:!1,itemId:null,defaultUom:"",currentUom:"",rowId:null}),itemId:b.itemId?Number(b.itemId):null,defaultUom:String(b.defaultUom||""),currentUom:String(b.currentUom||""),conversions:g,onApply:({converted_qty:I})=>{const G=b.rowId;G!=null&&M(G,"qty",I)}})]})}function HY(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState([]),[u,d]=x.useState(!1),[c,h]=x.useState(null),[A,f]=x.useState(!1),[g,v]=x.useState(""),[b,y]=x.useState(null),[j,N]=x.useState(null),[S,B]=x.useState([]),[P,L]=x.useState(!1),[U,H]=x.useState(null),[q,V]=x.useState(null);x.useEffect(()=>{let k=!0;return a(!0),i(""),ee.get("/inventory/return-to-stores").then(D=>{var Q;k&&o(Array.isArray((Q=D.data)==null?void 0:Q.items)?D.data.items:[])}).catch(D=>{var Q,C;k&&i(((C=(Q=D==null?void 0:D.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load return to stores")}).finally(()=>{k&&a(!1)}),()=>{k=!1}},[]);const M=k=>({DRAFT:"bg-slate-100 text-slate-700",PENDING:"bg-yellow-100 text-yellow-800",PENDING_APPROVAL:"bg-yellow-100 text-yellow-800",SUBMITTED:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",POSTED:"bg-blue-100 text-blue-800",REJECTED:"bg-red-100 text-red-800"})[k]||"bg-slate-100 text-slate-700",z=x.useMemo(()=>{const k=l.length,D=l.filter(E=>E.status==="PENDING").length,Q=l.filter(E=>E.status==="APPROVED"||E.status==="POSTED").length,C=l.filter(E=>E.status==="REJECTED").length;return{total:k,pending:D,approved:Q,rejected:C}},[l]),I=x.useMemo(()=>{const k=t.toLowerCase();return l.filter(D=>{const Q=String(D.rts_no||"").toLowerCase(),C=String(D.warehouse_name||"").toLowerCase();return Q.includes(k)||C.includes(k)})},[l,t]),G=async k=>{var D,Q,C;if(h(k),d(!0),v(""),U)await Y();else try{f(!0);const E=await ee.get("/workflows"),w=Array.isArray((D=E.data)==null?void 0:D.items)?E.data.items:[];H(w),await J(w)}catch(E){v(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load workflows")}finally{f(!1)}},Y=async()=>{var C,E,w;if(!U||!U.length){y(null),N(null),v("");return}const k="/inventory/return-to-stores",D=O=>String(O||"").trim().toUpperCase().replace(/\s+/g,"_"),Q=U.find(O=>Number(O.is_active)===1&&String(O.document_route)===k)||U.find(O=>Number(O.is_active)===1&&D(O.document_type)==="RETURN_TO_STORES")||null;if(y(Q||null),N(null),!!Q)try{f(!0);const R=(C=(await ee.get(`/workflows/${Q.id}`)).data)==null?void 0:C.item,X=Array.isArray(R==null?void 0:R.steps)?R.steps:[];B(X);const ne=X[0]||null;if(N(ne?{userId:ne.approver_user_id,name:ne.approver_name,stepName:ne.step_name,stepOrder:ne.step_order,approvalLimit:ne.approval_limit}:null),ne){const te=(Array.isArray(ne.approvers)&&ne.approvers.length?ne.approvers[0].id:ne.approver_user_id)||null;V(te)}else V(null)}catch(O){v(((w=(E=O==null?void 0:O.response)==null?void 0:E.data)==null?void 0:w.message)||"Failed to load workflow details")}finally{f(!1)}},J=async k=>{var E,w,O;if(!k||!k.length){y(null),N(null),v("");return}const D="/inventory/return-to-stores",Q=R=>String(R||"").trim().toUpperCase().replace(/\s+/g,"_"),C=k.find(R=>Number(R.is_active)===1&&String(R.document_route)===D)||k.find(R=>Number(R.is_active)===1&&Q(R.document_type)==="RETURN_TO_STORES")||null;if(y(C||null),N(null),!!C)try{f(!0);const X=(E=(await ee.get(`/workflows/${C.id}`)).data)==null?void 0:E.item,ne=Array.isArray(X==null?void 0:X.steps)?X.steps:[];B(ne);const te=ne[0]||null;N(te?{userId:te.approver_user_id,name:te.approver_name,stepName:te.step_name,stepOrder:te.step_order,approvalLimit:te.approval_limit}:null)}catch(R){v(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load workflow details")}finally{f(!1)}},T=async()=>{var k,D,Q;if(c){L(!0),v("");try{const C=await ee.post(`/inventory/return-to-stores/${c.id}/submit`,{amount:null,workflow_id:b?b.id:null,target_user_id:q||null}),E=((k=C==null?void 0:C.data)==null?void 0:k.status)||"PENDING_APPROVAL";o(w=>w.map(O=>O.id===c.id?{...O,status:E}:O)),d(!1),h(null)}catch(C){v(((Q=(D=C==null?void 0:C.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to forward for approval")}finally{L(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Total Returns"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900 dark:text-white mt-1",children:z.total})]}),e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})})]}),e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400 mt-1",children:z.pending})]}),e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Approved"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1",children:z.approved})]}),e.jsx("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-green-600 dark:text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:"card p-4 flex items-center justify-between bg-white dark:bg-slate-800",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-medium",children:"Rejected"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400 mt-1",children:z.rejected})]}),e.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[e.jsx("span",{children:""})," Return to Stores"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Manage material returns and approvals"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsxs(Le,{to:"/inventory/return-to-stores/new",className:"btn btn-primary bg-[#2E7D9F] hover:bg-[#24637e] text-white px-4 py-2 rounded-lg flex items-center gap-2",children:[e.jsx("span",{children:"+"})," New Return"]})]})]})}),e.jsxs("div",{className:"card-body p-0",children:[r?e.jsxs("div",{className:"p-8 text-center text-slate-500",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-[#2E7D9F] border-t-transparent rounded-full mx-auto mb-4"}),"Loading returns..."]}):null,n?e.jsxs("div",{className:"p-4 m-4 bg-red-50 text-red-600 rounded-lg border border-red-100 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n]}):null,e.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("input",{type:"text",placeholder:"Search by advice number or warehouse...",className:"w-full pl-10 pr-4 py-2 border border-slate-300 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2E7D9F] focus:border-transparent dark:bg-slate-700 dark:text-white",value:t,onChange:k=>s(k.target.value)}),e.jsx("svg",{className:"w-5 h-5 text-slate-400 absolute left-3 top-2.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700/50 text-slate-600 dark:text-slate-300 text-xs uppercase font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Advice No"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Type"}),e.jsx("th",{className:"px-6 py-4",children:"Department"}),e.jsx("th",{className:"px-6 py-4",children:"Warehouse"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Items"}),e.jsx("th",{className:"px-6 py-4",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:[I.map(k=>e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-[#2E7D9F] dark:text-[#5fb8e3]",children:e.jsx(Le,{to:`/inventory/return-to-stores/${k.id}`,children:k.rts_no})}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:k.rts_date}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800",children:k.return_type||"-"})}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:k.department_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-slate-600 dark:text-slate-300",children:k.warehouse_name||"-"}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 text-xs font-bold",children:k.item_count})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${M(k.status)}`,children:k.status})}),e.jsxs("td",{className:"px-6 py-4 text-right",children:[e.jsx(Le,{to:`/inventory/return-to-stores/${k.id}`,className:"text-slate-400 hover:text-[#2E7D9F] transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),k.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",onClick:()=>G(k),className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-[#2E7D9F] text-white hover:bg-[#24637e] transition-colors",disabled:P||k.status==="POSTED"||k.status==="REJECTED"||k.status==="PENDING_APPROVAL"||k.status==="SUBMITTED",children:P?"Forwarding...":"Forward for Approval"})]})]},k.id)),I.length===0&&!r&&e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center text-slate-400",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("svg",{className:"w-12 h-12 text-slate-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{children:"No return records found"})]})})})]})]})})]})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{d(!1),h(null),y(null),N(null),v("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Return Advice:"," ",e.jsx("span",{className:"font-semibold",children:c==null?void 0:c.rts_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[A?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const D=Array.isArray(S)&&S.length>0?S[0]:null,Q=D?Array.isArray(D.approvers)&&D.approvers.length?D.approvers.map(C=>({id:C.id,name:C.username})):D.approver_user_id?[{id:D.approver_user_id,name:D.approver_name||String(D.approver_user_id)}]:[]:[];return Q.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:q||"",onChange:C=>V(C.target.value?Number(C.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Q.map(C=>e.jsx("option",{value:C.id,children:C.name},C.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:j?`Step ${j.stepOrder}  ${j.stepName}${j.approvalLimit!=null?`  Limit: ${Number(j.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{d(!1),h(null),y(null),N(null),v("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:T,disabled:P,children:P?"Forwarding...":"Forward"})]})]})})]})}function tS(){const{id:t}=Ls(),s=ys(),r=!t||t==="new",[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState([]),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState([]),[y,j]=x.useState({rtsNo:r?"Auto-generated":"RT-000000",rtsDate:new Date().toISOString().split("T")[0],warehouseId:"",departmentId:"",returnType:"EXCESS",requisitionId:"",status:"DRAFT",remarks:""}),[N,S]=x.useState([{id:1,item_id:"",itemCode:"",itemName:"",uom:"",qtyReturned:0,reason:"",condition:"GOOD",batchSerial:"",location:"",remarks:""}]),[B,P]=x.useState(null);x.useEffect(()=>{let T=!0;return(async()=>{var D,Q,C,E,w,O;try{const[R,X,ne,te]=await Promise.all([ee.get("/inventory/items"),ee.get("/inventory/warehouses"),ee.get("/admin/departments"),r?ee.get("/inventory/return-to-stores/next-no"):Promise.resolve({data:null})]);T&&(c(Array.isArray((D=R.data)==null?void 0:D.items)?R.data.items:[]),A(Array.isArray((Q=X.data)==null?void 0:Q.items)?X.data.items:[]),g(Array.isArray((C=ne.data)==null?void 0:C.items)?ne.data.items:[]),r&&((E=te==null?void 0:te.data)!=null&&E.next_no)&&j(oe=>({...oe,rtsNo:te.data.next_no})))}catch(R){T&&u(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load initial data")}})(),()=>{T=!1}},[]),x.useEffect(()=>{if(r)return;let T=!0;return n(!0),u(""),ee.get(`/inventory/return-to-stores/${t}`).then(k=>{var C,E;if(!T)return;const D=(C=k.data)==null?void 0:C.item,Q=Array.isArray((E=k.data)==null?void 0:E.details)?k.data.details:[];D&&(j({rtsNo:D.rts_no||"",rtsDate:D.rts_date||new Date().toISOString().split("T")[0],warehouseId:D.warehouse_id?String(D.warehouse_id):"",departmentId:D.department_id?String(D.department_id):"",returnType:D.return_type||"EXCESS",requisitionId:D.requisition_id?String(D.requisition_id):"",status:D.status||"DRAFT",remarks:D.remarks||""}),D.requisition_id&&ee.get(`/inventory/material-requisitions/${D.requisition_id}`).then(w=>{var O;T&&((O=w.data)!=null&&O.item)&&P(w.data.item)}).catch(()=>{}),S(Q.length?Q.map(w=>({id:w.id||Date.now()+Math.random(),item_id:w.item_id?String(w.item_id):"",itemCode:w.item_code||"",itemName:w.item_name||"",uom:w.uom||"PCS",qtyReturned:Number(w.qty_returned)||0,reason:w.reason||"",condition:w.condition||"GOOD",batchSerial:w.batch_serial||"",location:w.location||"",remarks:w.remarks||""})):[]),Q.length===0&&H())}).catch(k=>{var D,Q;T&&u(((Q=(D=k==null?void 0:k.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to load return to stores")}).finally(()=>{T&&n(!1)}),()=>{T=!1}},[t,r]);const L=x.useMemo(()=>N.filter(T=>T.item_id).map(T=>({item_id:Number(T.item_id),qty_returned:Number(T.qtyReturned)||0,reason:T.reason||null,condition:T.condition||null,batch_serial:T.batchSerial||null,location:T.location||null,remarks:T.remarks||null})),[N]),U=x.useMemo(()=>{const T=N.filter(C=>C.item_id).length,k=N.reduce((C,E)=>C+(Number(E.qtyReturned)||0),0),D=N.filter(C=>C.condition==="GOOD").reduce((C,E)=>C+(Number(E.qtyReturned)||0),0),Q=N.filter(C=>C.condition==="DAMAGED").reduce((C,E)=>C+(Number(E.qtyReturned)||0),0);return{totalItems:T,totalQty:k,goodCondition:D,damagedQty:Q}},[N]),H=()=>{S([...N,{id:Date.now(),item_id:"",itemCode:"",itemName:"",uom:"",qtyReturned:0,reason:"",condition:"GOOD",batchSerial:"",location:"",remarks:""}])},q=T=>{S(N.filter(k=>k.id!==T))},V=(T,k)=>{const D=d.find(Q=>String(Q.id)===String(k));S(N.map(Q=>Q.id!==T?Q:{...Q,item_id:k,itemCode:(D==null?void 0:D.item_code)||"",itemName:(D==null?void 0:D.item_name)||"",uom:(D==null?void 0:D.uom)||"PCS"}))},M=(T,k,D)=>{S(N.map(Q=>Q.id!==T?Q:{...Q,[k]:D}))},z=async()=>{var T;try{const k=await ee.get("/inventory/material-requisitions");(T=k.data)!=null&&T.items&&b(k.data.items)}catch(k){console.error(k)}};x.useEffect(()=>{y.returnType==="UNUSED"&&z()},[y.returnType]);const I=T=>{j({...y,requisitionId:T});const k=v.find(D=>String(D.id)===String(T));P(k||null),T&&ee.get(`/inventory/material-requisitions/${T}`).then(D=>{var E,w;const Q=(E=D.data)==null?void 0:E.item,C=Array.isArray((w=D.data)==null?void 0:w.details)?D.data.details:[];if(Q&&j(O=>({...O,returnType:"UNUSED",warehouseId:Q.warehouse_id?String(Q.warehouse_id):O.warehouseId,departmentId:Q.department_id?String(Q.department_id):O.departmentId,requisitionId:String(T),remarks:O.remarks||""})),C.length){const O=C.filter(R=>R.item_id).map(R=>{const X=d.find(ne=>String(ne.id)===String(R.item_id));return{id:R.id||Date.now()+Math.random(),item_id:R.item_id?String(R.item_id):"",itemCode:R.item_code||"",itemName:R.item_name||"",uom:R.uom||(X==null?void 0:X.uom)||"PCS",qtyReturned:Number(R.qty_issued)||0,reason:"UNUSED",condition:"GOOD",batchSerial:"",location:"",remarks:""}});S(O.length?O:N)}}).catch(()=>{})},G=()=>{j({...y,requisitionId:""}),P(null)},Y=async T=>{var k,D;T.preventDefault(),l(!0),u("");try{const Q={rts_no:r?void 0:y.rtsNo,rts_date:y.rtsDate,warehouse_id:y.warehouseId?Number(y.warehouseId):null,department_id:y.departmentId?Number(y.departmentId):null,return_type:y.returnType,requisition_id:y.requisitionId?Number(y.requisitionId):null,status:y.status,remarks:y.remarks||null,details:L};r?await ee.post("/inventory/return-to-stores",Q):await ee.put(`/inventory/return-to-stores/${t}`,Q),s("/inventory/return-to-stores")}catch(Q){u(((D=(k=Q==null?void 0:Q.response)==null?void 0:k.data)==null?void 0:D.message)||"Failed to save return to stores")}finally{l(!1)}},J=[{id:"EXCESS",icon:"",title:"Excess Material"},{id:"UNUSED",icon:"",title:"Unused"},{id:"DAMAGED",icon:"",title:"Damaged"},{id:"WRONG_ITEM",icon:"",title:"Wrong Item"},{id:"QUALITY_ISSUE",icon:"",title:"Quality Issue"}];return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Return to Stores Advice":"Edit Return to Stores Advice"}),e.jsx("p",{className:"text-sm mt-1",children:"Record materials being returned to stores"})]}),e.jsx(Le,{to:"/inventory/return-to-stores",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body p-6",children:e.jsxs("form",{onSubmit:Y,className:"space-y-6",children:[a?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,o?e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded",children:o}):null,e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-500 uppercase mb-3",children:"Return Reason"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:J.map(T=>e.jsxs("div",{onClick:()=>j({...y,returnType:T.id}),className:`cursor-pointer border rounded-lg p-4 text-center transition-all ${y.returnType===T.id?"bg-blue-50 border-blue-500 ring-2 ring-blue-200":"bg-white hover:bg-slate-50 border-slate-200"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:T.icon}),e.jsx("div",{className:"text-sm font-medium",children:T.title})]},T.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-500 uppercase mb-3",children:"Return Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Return Number"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:y.rtsNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Return Date *"}),e.jsx("input",{type:"date",className:"input",value:y.rtsDate,onChange:T=>j({...y,rtsDate:T.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${y.status==="DRAFT"?"bg-slate-100 text-slate-800":y.status==="PENDING"?"bg-yellow-100 text-yellow-800":y.status==="APPROVED"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsxs("select",{className:"input",value:y.departmentId,onChange:T=>j({...y,departmentId:T.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Department --"}),f.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:y.warehouseId,onChange:T=>j({...y,warehouseId:T.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Warehouse --"}),h.map(T=>e.jsx("option",{value:T.id,children:T.warehouse_name},T.id))]})]}),y.returnType==="UNUSED"&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference Requisition"}),e.jsxs("select",{className:"input",value:y.requisitionId,onChange:T=>I(T.target.value),children:[e.jsx("option",{value:"",children:"-- Select Requisition --"}),v.map(T=>e.jsxs("option",{value:T.id,children:[T.requisition_no," - ",T.department_name]},T.id))]})]})]})]}),y.returnType==="UNUSED"&&B&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("h3",{className:"text-blue-600 dark:text-blue-400 font-semibold flex items-center",children:" Requisition Reference"}),e.jsx("button",{type:"button",onClick:G,className:"text-xs bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 px-2 py-1 rounded hover:bg-slate-50",children:"Clear"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Requisition No"}),e.jsx("div",{className:"font-medium",children:B.requisition_no})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Department"}),e.jsx("div",{className:"font-medium",children:B.department_name||"--"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Issued Date"}),e.jsx("div",{className:"font-medium",children:B.requisition_date})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500",children:"Type"}),e.jsx("div",{className:"font-medium",children:B.requisition_type})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:" Return Items"}),e.jsx("button",{type:"button",onClick:H,className:"btn-primary text-sm",children:" Add Item"})]}),e.jsx("div",{className:"overflow-x-auto border rounded-lg",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800 text-slate-500 uppercase font-medium",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 w-10",children:"#"}),e.jsx("th",{className:"px-4 py-3 w-64",children:"Item"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Return Qty"}),e.jsx("th",{className:"px-4 py-3 w-24",children:"UOM"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Condition"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Batch/Serial"}),e.jsx("th",{className:"px-4 py-3 w-32",children:"Location"}),e.jsx("th",{className:"px-4 py-3",children:"Remarks"}),e.jsx("th",{className:"px-4 py-3 w-16"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700 bg-white dark:bg-slate-900",children:N.map((T,k)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-center text-slate-500",children:k+1}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("select",{className:"input text-sm py-1",value:T.item_id,onChange:D=>V(T.id,D.target.value),children:[e.jsx("option",{value:"",children:"Select Item"}),d.map(D=>e.jsxs("option",{value:D.id,children:[D.item_code," - ",D.item_name]},D.id))]})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"number",className:"input text-sm py-1",value:T.qtyReturned,onChange:D=>M(T.id,"qtyReturned",D.target.value),min:"0"})}),e.jsx("td",{className:"px-4 py-2 text-slate-500",children:T.uom}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("select",{className:"input text-sm py-1",value:T.condition,onChange:D=>M(T.id,"condition",D.target.value),children:[e.jsx("option",{value:"GOOD",children:"Good"}),e.jsx("option",{value:"DAMAGED",children:"Damaged"})]})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",value:T.batchSerial,onChange:D=>M(T.id,"batchSerial",D.target.value),placeholder:"Optional"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",value:T.location,onChange:D=>M(T.id,"location",D.target.value),placeholder:"Optional"})}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("input",{type:"text",className:"input text-sm py-1",value:T.remarks,onChange:D=>M(T.id,"remarks",D.target.value),placeholder:"Optional"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>q(T.id),className:"text-red-500 hover:text-red-700",children:""})})]},T.id))})]})})]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-6 mt-6",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Total Items"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:U.totalItems})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Total Quantity"}),e.jsx("div",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:U.totalQty})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Good Condition"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:U.goodCondition})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-slate-500 uppercase mb-1",children:"Damaged"}),e.jsx("div",{className:"text-2xl font-bold text-red-500",children:U.damagedQty})]})]})}),e.jsxs("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("label",{className:"label mb-2",children:"General Remarks"}),e.jsx("textarea",{className:"input h-24",value:y.remarks,onChange:T=>j({...y,remarks:T.target.value}),placeholder:"Enter any additional notes about this return..."})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsx("button",{type:"button",onClick:()=>s("/inventory/return-to-stores"),className:"btn-secondary",children:"Cancel"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{j({...y,status:"DRAFT"}),Y({preventDefault:()=>{}})},disabled:i,className:"btn-success",children:i&&y.status==="DRAFT"?"Saving...":" Save Draft"}),e.jsx("button",{type:"submit",disabled:i,onClick:()=>j({...y,status:"PENDING"}),className:"btn-primary",children:i&&y.status==="PENDING"?"Saving...":" Submit Return"})]})]})]})})]})})}function qY(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState([]);x.useEffect(()=>{let c=!0;return a(!0),i(""),ee.get("/inventory/issue-to-requirement").then(h=>{var A;c&&o(Array.isArray((A=h.data)==null?void 0:A.items)?h.data.items:[])}).catch(h=>{var A,f;c&&i(((f=(A=h==null?void 0:h.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load issues")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=c=>({DRAFT:"badge-info",ISSUED:"badge-warning",POSTED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=x.useMemo(()=>{const c=t.toLowerCase();return l.filter(h=>{const A=String(h.issue_no||"").toLowerCase(),f=String(h.department_name||"").toLowerCase();return A.includes(c)||f.includes(c)})},[l,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Issue to Requirement Area"}),e.jsx("p",{className:"text-sm mt-1",children:"Issue materials to departments / requirement areas"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/inventory/issue-to-requirement/new",className:"btn-success",children:"+ New Issue"})]})]})}),e.jsxs("div",{className:"card-body",children:[r?e.jsx("div",{className:"text-sm mb-4",children:"Loading..."}):null,n?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:n}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by issue number or department...",className:"input max-w-md",value:t,onChange:c=>s(c.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Issue No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:c.issue_no}),e.jsx("td",{children:c.issue_date}),e.jsx("td",{children:c.issue_type||"-"}),e.jsx("td",{children:c.warehouse_name||"-"}),e.jsx("td",{children:c.department_name||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/inventory/issue-to-requirement/${c.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/inventory/issue-to-requirement/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))})]})})]})]})})}function sS(){const{id:t}=Ls(),s=ys(),r=!t||t==="new",a=M=>{if(!M)return"";const z=String(M);return z.includes("T")?z.split("T")[0]:z},[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState([]),[A,f]=x.useState([]),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState({issueNo:r?"Auto-generated":"ISS-000",issueDate:new Date().toISOString().split("T")[0],warehouseId:"",issuedTo:"",departmentId:"",issueType:"GENERAL",requisitionId:"",status:"DRAFT",remarks:""}),[S,B]=x.useState([{id:1,item_id:"",itemCode:"",itemName:"",qtyIssued:0,uom:"",batchNumber:"",serialNumber:""}]),P=M=>{const z=String(M||"").toUpperCase();return z==="PRODUCTION"?"PRODUCTION":z==="MAINTENANCE"?"MAINTENANCE":"GENERAL"},L=async M=>{var z,I,G,Y;if(M)try{const J=await ee.get(`/inventory/material-requisitions/${M}`),T=((z=J.data)==null?void 0:z.item)||null,k=Array.isArray((I=J.data)==null?void 0:I.details)?J.data.details:[];if(T&&N(D=>({...D,requisitionId:String(M),warehouseId:T.warehouse_id?String(T.warehouse_id):D.warehouseId,departmentId:T.department_id?String(T.department_id):D.departmentId,issueType:P(T.requisition_type),issuedTo:T.requested_by||D.issuedTo,remarks:D.remarks||""})),k.length){const D=k.map(Q=>{const C=Number(Q.qty_requested||0)-Number(Q.qty_issued||0);return{id:Q.id||Date.now()+Math.random(),item_id:Q.item_id?String(Q.item_id):"",itemCode:Q.item_code||"",itemName:Q.item_name||"",qtyIssued:C>0?C:Number(Q.qty_requested||0),uom:Q.uom||"",batchNumber:"",serialNumber:""}});B(D)}}catch(J){d(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to populate from requisition")}};x.useEffect(()=>{let M=!0;return(async()=>{var I,G,Y,J,T,k;try{const[D,Q,C,E]=await Promise.all([ee.get("/inventory/items"),ee.get("/inventory/warehouses"),ee.get("/admin/departments"),ee.get("/inventory/material-requisitions")]);M&&(h(Array.isArray((I=D.data)==null?void 0:I.items)?D.data.items:[]),f(Array.isArray((G=Q.data)==null?void 0:G.items)?Q.data.items:[]),v(Array.isArray((Y=C.data)==null?void 0:Y.items)?C.data.items:[]),y(Array.isArray((J=E.data)==null?void 0:J.items)?E.data.items.filter(w=>String(w.status||"").toUpperCase()==="APPROVED"):[]))}catch(D){M&&d(((k=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:k.message)||"Failed to load initial data")}})(),()=>{M=!1}},[]),x.useEffect(()=>{if(r)return;let M=!0;return i(!0),d(""),ee.get(`/inventory/issue-to-requirement/${t}`).then(z=>{var Y,J;if(!M)return;const I=(Y=z.data)==null?void 0:Y.item,G=Array.isArray((J=z.data)==null?void 0:J.details)?z.data.details:[];I&&(N({issueNo:I.issue_no||"",issueDate:a(I.issue_date)||new Date().toISOString().split("T")[0],warehouseId:I.warehouse_id?String(I.warehouse_id):"",issuedTo:I.issued_to||"",departmentId:I.department_id?String(I.department_id):"",issueType:I.issue_type||"GENERAL",requisitionId:I.requisition_id?String(I.requisition_id):"",status:I.status||"DRAFT",remarks:I.remarks||""}),B(G.length?G.map(T=>({id:T.id||Date.now()+Math.random(),item_id:T.item_id?String(T.item_id):"",itemCode:T.item_code||"",itemName:T.item_name||"",qtyIssued:Number(T.qty_issued)||0,uom:T.uom||"",batchNumber:T.batch_number||"",serialNumber:T.serial_number||""})):[{id:1,item_id:"",itemCode:"",itemName:"",qtyIssued:0,uom:"",batchNumber:"",serialNumber:""}]))}).catch(z=>{var I,G;M&&d(((G=(I=z==null?void 0:z.response)==null?void 0:I.data)==null?void 0:G.message)||"Failed to load issue to requirement")}).finally(()=>{M&&i(!1)}),()=>{M=!1}},[t,r]);const U=x.useMemo(()=>S.filter(M=>M.item_id).map(M=>({item_id:Number(M.item_id),qty_issued:Number(M.qtyIssued)||0,uom:M.uom||"",batch_number:M.batchNumber||null,serial_number:M.serialNumber||null})),[S]),H=()=>{B([...S,{id:Date.now(),item_id:"",itemCode:"",itemName:"",qtyIssued:0,uom:"",batchNumber:"",serialNumber:""}])},q=M=>{B(S.filter(z=>z.id!==M))},V=async(M,z)=>{var G,Y;M&&M.preventDefault(),o(!0),d("");const I=z||j.status;try{const J={issue_no:r?void 0:j.issueNo,issue_date:j.issueDate,warehouse_id:j.warehouseId?Number(j.warehouseId):null,issued_to:j.issuedTo||null,department_id:j.departmentId?Number(j.departmentId):null,issue_type:j.issueType,requisition_id:j.requisitionId?Number(j.requisitionId):null,status:I,remarks:j.remarks||null,details:U};r?await ee.post("/inventory/issue-to-requirement",J):await ee.put(`/inventory/issue-to-requirement/${t}`,J),s("/inventory/issue-to-requirement")}catch(J){d(((Y=(G=J==null?void 0:J.response)==null?void 0:G.data)==null?void 0:Y.message)||"Failed to save issue to requirement")}finally{o(!1)}};return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"New Issue to Requirement Area":"Edit Issue to Requirement Area"}),e.jsx("p",{className:"text-sm mt-1",children:"Issue materials to departments / requirement areas"})]}),e.jsx(Le,{to:"/inventory/issue-to-requirement",className:"btn-success",children:"Back to List"})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:V,className:"space-y-6",children:[n?e.jsx("div",{className:"text-sm",children:"Loading..."}):null,u?e.jsx("div",{className:"text-sm text-red-600",children:u}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Issue No"}),e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:j.issueNo,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Issue Date *"}),e.jsx("input",{type:"date",className:"input",value:j.issueDate,onChange:M=>N({...j,issueDate:M.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Issue Type"}),e.jsxs("select",{className:"input",value:j.issueType,onChange:M=>N({...j,issueType:M.target.value}),children:[e.jsx("option",{value:"GENERAL",children:"General"}),e.jsx("option",{value:"PRODUCTION",children:"Production"}),e.jsx("option",{value:"MAINTENANCE",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsxs("select",{className:"input",value:j.departmentId,onChange:M=>N({...j,departmentId:M.target.value}),children:[e.jsx("option",{value:"",children:"Select Department"}),g.map(M=>e.jsx("option",{value:M.id,children:M.name||M.department_name},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:j.warehouseId,onChange:M=>N({...j,warehouseId:M.target.value}),children:[e.jsx("option",{value:"",children:"Select Warehouse"}),A.map(M=>e.jsx("option",{value:M.id,children:M.warehouse_name||M.warehouse_code||M.id},M.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Reference"}),e.jsxs("select",{className:"input",value:j.requisitionId,onChange:async M=>{const z=M.target.value;N({...j,requisitionId:z}),z&&await L(z)},children:[e.jsx("option",{value:"",children:"Select Requisition (Optional)"}),b.map(M=>e.jsx("option",{value:M.id,children:M.requisition_no},M.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:j.status,onChange:M=>N({...j,status:M.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"ISSUED",children:"ISSUED"}),e.jsx("option",{value:"POSTED",children:"POSTED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("input",{type:"text",className:"input",value:j.remarks,onChange:M=>N({...j,remarks:M.target.value}),placeholder:"Enter any additional notes or remarks"})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:"Items"}),e.jsx("button",{type:"button",onClick:H,className:"btn-success text-sm",children:"+ Add Item"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12",children:"#"}),e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Qty Issued"}),e.jsx("th",{children:"UOM"}),e.jsx("th",{children:"Batch No"}),e.jsx("th",{children:"Serial No"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:S.map((M,z)=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-center text-slate-500",children:z+1}),e.jsx("td",{className:"w-1/3",children:e.jsxs("select",{className:"input",value:M.item_id,onChange:I=>{const G=I.target.value,Y=c.find(J=>String(J.id)===String(G));B(S.map(J=>J.id===M.id?{...J,item_id:G,itemCode:(Y==null?void 0:Y.item_code)||"",itemName:(Y==null?void 0:Y.item_name)||"",uom:(Y==null?void 0:Y.uom)||""}:J))},required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),c.map(I=>e.jsx("option",{value:I.id,children:(I.item_code||I.id)+" - "+(I.item_name||"")},I.id))]})}),e.jsx("td",{className:"w-24",children:e.jsx("input",{type:"number",className:"input",value:M.qtyIssued,onChange:I=>{const G=parseFloat(I.target.value);B(S.map(Y=>Y.id===M.id?{...Y,qtyIssued:Number.isFinite(G)?G:0}:Y))},min:"0",step:"0.001"})}),e.jsx("td",{className:"w-24",children:e.jsx("input",{type:"text",className:"input bg-slate-100 dark:bg-slate-700",value:M.uom||"",readOnly:!0})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:M.batchNumber,onChange:I=>B(S.map(G=>G.id===M.id?{...G,batchNumber:I.target.value}:G)),placeholder:"Batch No"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:M.serialNumber,onChange:I=>B(S.map(G=>G.id===M.id?{...G,serialNumber:I.target.value}:G)),placeholder:"Serial No"})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>q(M.id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Remove"})})]},M.id))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsx(Le,{to:"/inventory/issue-to-requirement",className:"px-4 py-2 border border-slate-300 rounded text-slate-700 hover:bg-slate-50 dark:border-slate-600 dark:text-slate-300 dark:hover:bg-slate-800",children:"Cancel"}),e.jsx("button",{type:"button",onClick:M=>V(M,"DRAFT"),className:"px-4 py-2 bg-slate-500 text-white rounded hover:bg-slate-600",disabled:l,children:"Save as Draft"}),e.jsx("button",{type:"button",onClick:M=>V(M,"POSTED"),className:"btn-success",disabled:l,children:l?"Saving...":"Save & Post"})]})]})})]})})}function VY(){const[t,s]=x.useState([]),[r,a]=x.useState([]),[n,i]=x.useState([]),[l,o]=x.useState([]),[u,d]=x.useState(!0),[c,h]=x.useState(""),[A,f]=x.useState(""),[g,v]=x.useState(""),[b,y]=x.useState({item_id:"",warehouse_id:"",min_stock:"",max_stock:"",reorder_qty:"",lead_time:"0",supplier_id:""}),[j,N]=x.useState(null),S=x.useMemo(()=>{let M=0,z=0;return t.forEach(I=>{const G=Number(I.current_stock||0),Y=Number(I.min_stock||0);G<Y?M++:G<Y*1.2&&z++}),{total:t.length,critical:M,low:z,activeWarehouses:new Set(t.map(I=>I.warehouse_id)).size}},[t]);x.useEffect(()=>{B()},[]);const B=async()=>{d(!0);try{const[M,z,I,G]=await Promise.all([ee.get("/inventory/reorder-points"),ee.get("/inventory/items"),ee.get("/inventory/warehouses"),ee.get("/purchase/suppliers")]);s(M.data.items||[]),a(z.data.items||[]),i(I.data.items||[]),o(G.data.items||[])}catch(M){console.error(M),nt.error("Failed to load data")}finally{d(!1)}},P=async()=>{d(!0);try{const M={};c&&(M.warehouseId=c),A&&(M.search=A),g&&(M.status=g);const z=await ee.get("/inventory/reorder-points",{params:M});s(z.data.items||[])}catch(M){console.error(M),nt.error("Failed to apply filters")}finally{d(!1)}},L=async M=>{if(window.confirm("Are you sure you want to delete this reorder point?"))try{await ee.delete(`/inventory/reorder-points/${M}`),nt.success("Reorder point deleted"),B()}catch(z){console.error(z),nt.error("Failed to delete reorder point")}},U=M=>{var z;N(M.id),y({item_id:M.item_id,warehouse_id:M.warehouse_id,min_stock:M.min_stock,max_stock:M.max_stock,reorder_qty:M.reorder_qty,lead_time:M.lead_time,supplier_id:M.supplier_id||""}),(z=document.getElementById("reorderFormCard"))==null||z.scrollIntoView({behavior:"smooth"})},H=()=>{N(null),y({item_id:"",warehouse_id:"",min_stock:"",max_stock:"",reorder_qty:"",lead_time:"0",supplier_id:""})},q=async M=>{var z,I;M.preventDefault();try{await ee.post("/inventory/reorder-points",b),nt.success("Reorder point saved"),H(),B()}catch(G){console.error(G),nt.error(((I=(z=G.response)==null?void 0:z.data)==null?void 0:I.message)||"Failed to save reorder point")}},V=(M,z,I)=>(M=Number(M),z=Number(z),M<z?{className:"bg-red-100 text-red-700 border-red-200",text:"Critical"}:M<z*1.2?{className:"bg-yellow-100 text-yellow-700 border-yellow-200",text:"Low Stock"}:{className:"bg-green-100 text-green-700 border-green-200",text:"Normal"});return e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl",children:""})," Stock Reorder Management System"]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Manage inventory reorder points and maintain optimal stock levels"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-cyan-800",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(Jd,{})," Total Items"]}),e.jsx("div",{className:"text-3xl font-bold text-cyan-900 dark:text-cyan-100",children:S.total})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-red-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(Eb,{className:"text-red-500"})," Critical Stock"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:S.critical})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-yellow-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(KT,{className:"text-yellow-500"})," Low Stock"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:S.low})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-blue-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(CI,{className:"text-blue-500"})," Active Warehouses"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:S.activeWarehouses})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4 pb-2 border-b border-slate-100 dark:border-slate-700",children:"Stock Reorder List"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Warehouse"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",value:c,onChange:M=>h(M.target.value),children:[e.jsx("option",{value:"",children:"All Warehouses"}),n.map(M=>e.jsx("option",{value:M.id,children:M.warehouse_name},M.id))]})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Item Search"})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search by item name...",className:"input input-bordered w-full input-sm pr-8",value:A,onChange:M=>f(M.target.value)}),e.jsx(L0,{className:"absolute right-3 top-2 text-slate-400",size:16})]})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Status"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",value:g,onChange:M=>v(M.target.value),children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"low",children:"Low Stock"}),e.jsx("option",{value:"normal",children:"Normal"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{className:"btn btn-primary btn-sm w-full",onClick:P,disabled:u,children:[e.jsx(dI,{})," Filter"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Levels (Min/Max)"}),e.jsx("th",{children:"Reorder Qty"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:u?e.jsx("tr",{children:e.jsx("td",{colspan:"7",className:"text-center py-4",children:"Loading..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colspan:"7",className:"text-center py-8 text-slate-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Jd,{className:"text-4xl mb-2 opacity-20"}),"No reorder points found"]})})}):t.map(M=>{const z=V(M.current_stock||0,M.min_stock,M.max_stock);return e.jsxs("tr",{className:"hover",children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-bold",children:M.item_code}),e.jsx("div",{className:"text-xs text-slate-500",children:M.item_name})]}),e.jsx("td",{children:M.warehouse_name}),e.jsxs("td",{className:"font-mono",children:[Number(M.current_stock||0)," ",M.uom]}),e.jsxs("td",{className:"text-xs",children:[e.jsxs("div",{children:["Min: ",Number(M.min_stock)]}),e.jsxs("div",{children:["Max: ",Number(M.max_stock)]})]}),e.jsx("td",{children:Number(M.reorder_qty)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${z.className} font-semibold`,children:z.text})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-ghost btn-xs text-blue-600",onClick:()=>U(M),title:"Edit",children:e.jsx(eA,{})}),e.jsx("button",{className:"btn btn-ghost btn-xs text-red-600",onClick:()=>L(M.id),title:"Delete",children:e.jsx(Hl,{})})]})})]},M.id)})})]})})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{id:"reorderFormCard",className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6 sticky top-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4 pb-2 border-b border-slate-100 dark:border-slate-700",children:j?"Edit Reorder Point":"Add Reorder Point"}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold",children:"Item *"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",required:!0,value:b.item_id,onChange:M=>y({...b,item_id:M.target.value}),disabled:!!j,children:[e.jsx("option",{value:"",children:"Select Item"}),r.map(M=>e.jsxs("option",{value:M.id,children:[M.item_code," - ",M.item_name]},M.id))]})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-semibold",children:"Warehouse *"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",required:!0,value:b.warehouse_id,onChange:M=>y({...b,warehouse_id:M.target.value}),disabled:!!j,children:[e.jsx("option",{value:"",children:"Select Warehouse"}),n.map(M=>e.jsx("option",{value:M.id,children:M.warehouse_name},M.id))]})]}),e.jsx("div",{className:"divider text-xs text-slate-400",children:"Stock Levels"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Min Stock *"})}),e.jsx("input",{type:"number",min:"0",step:"1",required:!0,className:"input input-bordered w-full input-sm",value:b.min_stock,onChange:M=>y({...b,min_stock:M.target.value})})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Max Stock *"})}),e.jsx("input",{type:"number",min:"0",step:"1",required:!0,className:"input input-bordered w-full input-sm",value:b.max_stock,onChange:M=>y({...b,max_stock:M.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Reorder Qty *"})}),e.jsx("input",{type:"number",min:"0",step:"1",required:!0,className:"input input-bordered w-full input-sm",value:b.reorder_qty,onChange:M=>y({...b,reorder_qty:M.target.value})})]}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Lead Time (Days)"})}),e.jsx("input",{type:"number",min:"0",step:"1",className:"input input-bordered w-full input-sm",value:b.lead_time,onChange:M=>y({...b,lead_time:M.target.value})})]})]}),e.jsx("div",{className:"divider text-xs text-slate-400",children:"Supplier"}),e.jsxs("div",{className:"form-control w-full",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text",children:"Preferred Supplier"})}),e.jsxs("select",{className:"select select-bordered w-full select-sm",value:b.supplier_id,onChange:M=>y({...b,supplier_id:M.target.value}),children:[e.jsx("option",{value:"",children:"Select Supplier"}),l.map(M=>e.jsx("option",{value:M.id,children:M.supplier_name},M.id))]})]}),e.jsxs("div",{className:"flex gap-2 mt-6 pt-4 border-t border-slate-100 dark:border-slate-700",children:[e.jsxs("button",{type:"submit",className:"btn btn-success btn-sm flex-1",children:[e.jsx(Vh,{})," ",j?"Update":"Save"]}),e.jsxs("button",{type:"button",className:"btn btn-warning btn-sm",onClick:H,children:[j?e.jsx(PC,{}):e.jsx(xI,{})," Reset"]})]})]})]})})]})]})}function $Y(){const[t,s]=x.useState(""),[r,a]=x.useState(30),[n,i]=x.useState([]),[l,o]=x.useState([]),[u,d]=x.useState(!1);async function c(){var A;try{const f=await ee.get("/inventory/warehouses");o(((A=f.data)==null?void 0:A.items)||[])}catch{}}async function h(){var A,f,g;try{d(!0);const v=await ee.get("/inventory/reports/health-monitor",{params:{warehouseId:t||null,thresholdDays:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{d(!1)}}return x.useEffect(()=>{c(),h()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Inventory Health Monitor"}),e.jsx("p",{className:"text-sm mt-1",children:"Coverage days, low stock, and reorder risks"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsxs("select",{className:"input",value:t,onChange:A=>s(A.target.value),children:[e.jsx("option",{value:"",children:"All"}),l.map(A=>e.jsx("option",{value:A.id,children:A.name||A.code},A.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Threshold Days"}),e.jsx("input",{className:"input",type:"number",min:1,value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:h,disabled:u,children:u?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a(30)},disabled:u,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const A=Array.isArray(n)?n:[];if(!A.length)return;const f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"InventoryHealth"),xr(g,"inventory-health-monitor.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const A=Array.isArray(n)?n:[];if(!A.length)return;const f=new ds("p","mm","a4");let g=15;f.setFontSize(14),f.text("Inventory Health Monitor",10,g),g+=8,f.setFontSize(10),f.text("Item",10,g),f.text("Available",95,g),f.text("Reorder",130,g),f.text("Days Cover",160,g),f.text("Status",190,g,{align:"right"}),g+=4,f.line(10,g,200,g),g+=5,A.forEach(v=>{g>270&&(f.addPage(),g=15),f.text(String(v.item_name||v.item_code||"-").slice(0,60),10,g),f.text(String(Number(v.available_qty||0).toLocaleString()),95,g),f.text(String(Number(v.reorder_level||0).toLocaleString()),130,g),f.text(String(Number(v.days_of_cover||0).toLocaleString()),160,g),f.text(String(v.status||"-"),190,g,{align:"right"}),g+=5}),f.save("inventory-health-monitor.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Available"}),e.jsx("th",{className:"text-right",children:"Reorder Level"}),e.jsx("th",{className:"text-right",children:"Days of Cover"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(A=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:A.item_name||A.item_code}),e.jsx("td",{className:"text-right",children:Number(A.available_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A.reorder_level||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A.days_of_cover||0).toLocaleString()}),e.jsx("td",{children:A.status||"-"})]},A.item_id))})]})}),n.length===0&&!u?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function WY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/periodical-stock-summary",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Periodical Stock Summary"}),e.jsx("p",{className:"text-sm mt-1",children:"Opening, receipts, issues, closing per period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"PeriodicalStockSummary"),xr(h,"periodical-stock-summary.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Periodical Stock Summary",10,h),h+=8,c.setFontSize(10),c.text("Item",10,h),c.text("Opening",95,h),c.text("Receipts",130,h),c.text("Issues",160,h),c.text("Closing",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15),c.text(String(A.item_name||A.item_code||"-").slice(0,60),10,h),c.text(String(Number(A.opening_qty||0).toLocaleString()),95,h),c.text(String(Number(A.receipts_qty||0).toLocaleString()),130,h),c.text(String(Number(A.issues_qty||0).toLocaleString()),160,h),c.text(String(Number(A.closing_qty||0).toLocaleString()),190,h,{align:"right"}),h+=5}),c.save("periodical-stock-summary.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Opening"}),e.jsx("th",{className:"text-right",children:"Receipts"}),e.jsx("th",{className:"text-right",children:"Issues"}),e.jsx("th",{className:"text-right",children:"Closing"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.opening_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.receipts_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.issues_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.closing_qty||0).toLocaleString()})]},d.item_id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function GY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/periodical-stock-statement",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Periodical Stock Statement"}),e.jsx("p",{className:"text-sm mt-1",children:"Detailed stock movements within the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"PeriodicalStockStatement"),xr(h,"periodical-stock-statement.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Periodical Stock Statement",10,h),h+=8,c.setFontSize(10),c.text("Date",10,h),c.text("Document",45,h),c.text("Item",95,h),c.text("In",140,h),c.text("Out",165,h),c.text("Balance",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.txn_date?new Date(A.txn_date).toLocaleDateString():"-",g=String(A.doc_no||"-"),v=String(A.item_name||A.item_code||"-").slice(0,40),b=String(Number(A.qty_in||0).toLocaleString()),y=String(Number(A.qty_out||0).toLocaleString()),j=String(Number(A.balance_qty||0).toLocaleString());c.text(f,10,h),c.text(g,45,h),c.text(v,95,h),c.text(b,140,h),c.text(y,165,h),c.text(j,190,h,{align:"right"}),h+=5}),c.save("periodical-stock-statement.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"In"}),e.jsx("th",{className:"text-right",children:"Out"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:n.map((d,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:d.txn_date?new Date(d.txn_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.doc_no||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.qty_in||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.qty_out||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.balance_qty||0).toLocaleString()})]},d.id||c))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function KY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/issue-register",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Issue Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Items issued to departments or projects"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"IssueRegister"),xr(h,"issue-register.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Issue Register",10,h),h+=8,c.setFontSize(10),c.text("Date",10,h),c.text("Issue No",45,h),c.text("Department",85,h),c.text("Item",130,h),c.text("Qty",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.issue_date?new Date(A.issue_date).toLocaleDateString():"-",g=String(A.issue_no||"-"),v=String(A.department_name||"-").slice(0,35),b=String(A.item_name||A.item_code||"-").slice(0,35),y=String(Number(A.qty||0).toLocaleString());c.text(f,10,h),c.text(g,45,h),c.text(v,85,h),c.text(b,130,h),c.text(y,190,h,{align:"right"}),h+=5}),c.save("issue-register.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Issue No"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.issue_date?new Date(d.issue_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.issue_no||"-"}),e.jsx("td",{children:d.department_name||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.qty||0).toLocaleString()})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function zY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/stock-transfer-register",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Stock Transfer Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Transfers between warehouses with quantities"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"StockTransferRegister"),xr(h,"stock-transfer-register.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Stock Transfer Register",10,h),h+=8,c.setFontSize(10),c.text("Date",10,h),c.text("Transfer No",45,h),c.text("From",90,h),c.text("To",125,h),c.text("Item",155,h),c.text("Qty",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.transfer_date?new Date(A.transfer_date).toLocaleDateString():"-",g=String(A.transfer_no||"-"),v=String(A.from_warehouse_name||"-").slice(0,25),b=String(A.to_warehouse_name||"-").slice(0,25),y=String(A.item_name||A.item_code||"-").slice(0,25),j=String(Number(A.qty||0).toLocaleString());c.text(f,10,h),c.text(g,45,h),c.text(v,90,h),c.text(b,125,h),c.text(y,155,h),c.text(j,190,h,{align:"right"}),h+=5}),c.save("stock-transfer-register.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Transfer No"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Quantity"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.transfer_date?new Date(d.transfer_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.transfer_no||"-"}),e.jsx("td",{children:d.from_warehouse_name||"-"}),e.jsx("td",{children:d.to_warehouse_name||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.qty||0).toLocaleString()})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function YY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/stock-verification",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Stock Verification Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Variances identified during stock verification"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"StockVerification"),xr(h,"stock-verification.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Stock Verification Report",10,h),h+=8,c.setFontSize(10),c.text("Date",10,h),c.text("Verify No",30,h),c.text("Warehouse",55,h),c.text("Status",85,h),c.text("Item",110,h),c.text("System",150,h),c.text("Physical",170,h),c.text("Variance",200,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.verify_date?new Date(A.verify_date).toLocaleDateString():"-",g=String(A.verify_no||"-"),v=String(A.warehouse_name||"-").slice(0,14),b=String(A.status||"-").slice(0,10),y=String(A.item_name||A.item_code||"-").slice(0,26),j=String(Number(A.system_qty||0).toLocaleString()),N=String(Number(A.physical_qty||0).toLocaleString()),S=String(Number((A.physical_qty||0)-(A.system_qty||0)).toLocaleString());c.text(f,10,h),c.text(g,30,h),c.text(v,55,h),c.text(b,85,h),c.text(y,110,h),c.text(j,150,h),c.text(N,170,h),c.text(S,200,h,{align:"right"}),h+=5}),c.save("stock-verification.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Verification No"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"System Qty"}),e.jsx("th",{className:"text-right",children:"Physical Qty"}),e.jsx("th",{className:"text-right",children:"Variance"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.verify_date?new Date(d.verify_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.verify_no||"-"}),e.jsx("td",{children:d.warehouse_name||"-"}),e.jsx("td",{children:d.status||"-"}),e.jsx("td",{children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.system_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.physical_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number((d.physical_qty||0)-(d.system_qty||0)).toLocaleString()})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function XY(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await ee.get("/inventory/reports/stock-aging-analysis",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){nt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return x.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Stock Aging Analysis"}),e.jsx("p",{className:"text-sm mt-1",children:"Age buckets for inventory holding"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=is.json_to_sheet(o),d=is.book_new();is.book_append_sheet(d,u,"StockAging"),xr(d,"stock-aging-analysis.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new ds("p","mm","a4");let d=15;u.setFontSize(14),u.text("Stock Aging Analysis",10,d),d+=8,u.setFontSize(10),u.text("Item",10,d),u.text("0-30",95,d),u.text("31-60",120,d),u.text("61-90",145,d),u.text("90+",190,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15),u.text(String(c.item_name||c.item_code||"-").slice(0,70),10,d),u.text(String(Number(c.bucket_0_30||0).toLocaleString()),95,d),u.text(String(Number(c.bucket_31_60||0).toLocaleString()),120,d),u.text(String(Number(c.bucket_61_90||0).toLocaleString()),145,d),u.text(String(Number(c.bucket_90_plus||0).toLocaleString()),190,d,{align:"right"}),d+=5}),u.save("stock-aging-analysis.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"030"}),e.jsx("th",{className:"text-right",children:"3160"}),e.jsx("th",{className:"text-right",children:"6190"}),e.jsx("th",{className:"text-right",children:"90+"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.item_name||o.item_code}),e.jsx("td",{className:"text-right",children:Number(o.bucket_0_30||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.bucket_31_60||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.bucket_61_90||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.bucket_90_plus||0).toLocaleString()})]},o.item_id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function JY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/slow-moving",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Slow Moving Items"}),e.jsx("p",{className:"text-sm mt-1",children:"Items with low turnover in the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"SlowMoving"),xr(h,"slow-moving.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Slow Moving Items",10,h),h+=8,c.setFontSize(10),c.text("Item",10,h),c.text("Issued Qty",130,h),c.text("Turnover",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15),c.text(String(A.item_name||A.item_code||"-").slice(0,80),10,h),c.text(String(Number(A.issued_qty||0).toLocaleString()),130,h),c.text(String(Number(A.turnover||0).toLocaleString()),190,h,{align:"right"}),h+=5}),c.save("slow-moving.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Issued Qty"}),e.jsx("th",{className:"text-right",children:"Turnover"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.issued_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.turnover||0).toLocaleString()})]},d.item_id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function ZY(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/inventory/reports/fast-moving",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Fast Moving Items"}),e.jsx("p",{className:"text-sm mt-1",children:"Items with high turnover in the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"FastMoving"),xr(h,"fast-moving.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Fast Moving Items",10,h),h+=8,c.setFontSize(10),c.text("Item",10,h),c.text("Issued Qty",130,h),c.text("Turnover",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15),c.text(String(A.item_name||A.item_code||"-").slice(0,80),10,h),c.text(String(Number(A.issued_qty||0).toLocaleString()),130,h),c.text(String(Number(A.turnover||0).toLocaleString()),190,h,{align:"right"}),h+=5}),c.save("fast-moving.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Issued Qty"}),e.jsx("th",{className:"text-right",children:"Turnover"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.item_name||d.item_code}),e.jsx("td",{className:"text-right",children:Number(d.issued_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.turnover||0).toLocaleString()})]},d.item_id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function eX(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await ee.get("/inventory/reports/non-moving",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){nt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return x.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/inventory",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Inventory"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Non Moving Items"}),e.jsx("p",{className:"text-sm mt-1",children:"Items with no movement within the period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=is.json_to_sheet(o),d=is.book_new();is.book_append_sheet(d,u,"NonMoving"),xr(d,"non-moving.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new ds("p","mm","a4");let d=15;u.setFontSize(14),u.text("Non Moving Items",10,d),d+=8,u.setFontSize(10),u.text("Item",10,d),u.text("Available",130,d),u.text("Days Since Last",190,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15),u.text(String(c.item_name||c.item_code||"-").slice(0,80),10,d),u.text(String(Number(c.available_qty||0).toLocaleString()),130,d),u.text(String(Number(c.days_since_last||0).toLocaleString()),190,d,{align:"right"}),d+=5}),u.save("non-moving.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{className:"text-right",children:"Available"}),e.jsx("th",{className:"text-right",children:"Days Since Last Movement"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.item_name||o.item_code}),e.jsx("td",{className:"text-right",children:Number(o.available_qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.days_since_last||0).toLocaleString()})]},o.item_id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function tX(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(!1),l=x.useMemo(()=>{const d=t.filter(c=>Number(c.qty||0)<=Number(c.reorder_level||0)).length;return{total:t.length,critical:d}},[t]);async function o(){var d,c,h;a(!0);try{const A=await ee.get("/inventory/alerts/low-stock");s(Array.isArray((d=A.data)==null?void 0:d.items)?A.data.items:[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load alerts")}finally{a(!1)}}x.useEffect(()=>{o()},[]);async function u(){var d,c,h;i(!0);try{const A=await ee.post("/inventory/alerts/low-stock/notify-email");nt.success(((d=A.data)==null?void 0:d.message)||"Email notification sent")}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to send email")}finally{i(!1)}}return e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx(Eb,{className:"text-red-600"})," Low Stock Alerts"]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Items at or below their reorder levels"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/inventory",className:"btn btn-secondary",children:"Return to Menu"}),e.jsxs("button",{className:"btn btn-primary",onClick:u,disabled:n||r||t.length===0,title:"Send email notification",children:[e.jsx(AI,{})," Send Email"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-red-500",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(Jd,{})," Total Items"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:l.total})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-red-600",children:[e.jsxs("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2 flex items-center gap-2",children:[e.jsx(Eb,{className:"text-red-600"})," At/Below Reorder"]}),e.jsx("div",{className:"text-3xl font-bold text-slate-800 dark:text-white",children:l.critical})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border-l-4 border-blue-500",children:[e.jsx("h3",{className:"text-slate-500 text-xs font-bold uppercase mb-2",children:"Actions"}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:"/inventory/stock-reorder",className:"btn btn-info btn-sm",children:"Manage Reorder Points"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white mb-4 pb-2 border-b border-slate-100 dark:border-slate-700",children:"Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item"}),e.jsx("th",{children:"UoM"}),e.jsx("th",{className:"text-right",children:"Available Qty"}),e.jsx("th",{className:"text-right",children:"Reorder Level"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-4",children:"Loading..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500",children:"No low stock items found"})}):t.map(d=>e.jsxs("tr",{className:"hover",children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-bold",children:d.item_code}),e.jsx("div",{className:"text-xs text-slate-500",children:d.item_name})]}),e.jsx("td",{children:d.uom}),e.jsx("td",{className:"text-right",children:Number(d.qty||0)}),e.jsx("td",{className:"text-right",children:Number(d.reorder_level||0)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/inventory/items/${d.id}`,className:"btn btn-ghost btn-xs text-blue-600",title:"View Item",children:"View Item"}),e.jsx(Le,{to:"/inventory/stock-reorder",className:"btn btn-ghost btn-xs text-cyan-600",title:"Manage Reorder",children:"Reorder Settings"})]})})]},d.id))})]})})]})]})}function sX({title:t,description:s}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:t}),s?e.jsx("p",{className:"text-sm mt-1",children:s}):null]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-sm",children:"This page is ready to be implemented."})})]})}function rX(){const[t,s]=Ts.useState([{value:"45",label:"Items Tracked",change:"5 critical",changeType:"negative",path:"/inventory/reports"},{value:"12",label:"Pending Requisitions",change:"3 urgent",changeType:"neutral",path:"/inventory/material-requisitions"},{value:"8",label:"Incoming Transfers",change:"Expected today",changeType:"positive",path:"/inventory/transfer-acceptance"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.inventory)==null?void 0:o.items)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.inventory)==null?void 0:c.pending_requisitions)||0),y=Number(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.inventory)==null?void 0:f.incoming_transfers)||0);a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:String(y)},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Stock Operations",features:[{name:"Material Requisition",path:"/inventory/material-requisitions",description:"Request materials from warehouse",icon:""},{name:"Stock Updation",path:"/inventory/stock-updation",description:"Update stock levels",icon:""},{name:"Stock Verification",path:"/inventory/stock-verification",description:"Verify stock balances",icon:""},{name:"Return to Stores Advice",path:"/inventory/return-to-stores",description:"Return unused materials",icon:""},{name:"Stock Adjustment",path:"/inventory/stock-adjustments",description:"Adjust stock quantities",icon:""},{name:"Issue to Requirement Area",path:"/inventory/issue-to-requirement",description:"Issue materials to departments",icon:""}]},{title:"Stock Movements",features:[{name:"Warehouse Stock Transfer",path:"/inventory/stock-transfers",description:"Transfer stock between warehouses/branches",icon:""},{name:"Transfer Acceptance",path:"/inventory/transfer-acceptance",description:"Receive transferred stock",icon:""},{name:"Stock Reorder",path:"/inventory/stock-reorder",description:"Manage reorder points",icon:""}]},{title:"Stock Count",features:[{name:"Daily Stock Take",path:"/inventory/stock-take",description:"Perform physical stock counts",icon:""}]},{title:"Goods Receipt",features:[{name:"Material Receipt (GRN) - Local",path:"/inventory/grn-local",description:"Receive local purchases",icon:""},{name:"Material Receipt (GRN) - Import",path:"/inventory/grn-import",description:"Receive import purchases",icon:""}]},{title:"Returns",features:[{name:"Sales Return",path:"/inventory/sales-returns",description:"Process customer returns",icon:""}]},{title:"Master Data Setup",features:[{name:"Items Setup",path:"/inventory/items",description:"Configure items with barcodes",icon:""},{name:"Item Groups & Sub Groups",path:"/inventory/item-groups",description:"Organize items by categories",icon:""},{name:"Unit Conversion",path:"/inventory/unit-conversions",description:"Define unit conversions",icon:""},{name:"Warehouse Setup",path:"/inventory/warehouses",description:"Configure warehouses",icon:""}]},{title:"Reports",features:[{name:"Inventory Reports",path:"/inventory/reports",description:"Stock reports and analytics",icon:""},{name:"Health Monitor",path:"/inventory/reports/health-monitor",description:"Low stock and coverage analysis",icon:""},{name:"Periodical Stock Summary",path:"/inventory/reports/periodical-stock-summary",description:"Summary of movements by period",icon:""},{name:"Periodical Stock Statement",path:"/inventory/reports/periodical-stock-statement",description:"Detailed item movements by period",icon:""},{name:"Issue Register",path:"/inventory/reports/issue-register",description:"Issued items to departments/projects",icon:""},{name:"Stock Transfer Register",path:"/inventory/reports/stock-transfer-register",description:"Transfers between warehouses",icon:""},{name:"Stock Verification",path:"/inventory/reports/stock-verification",description:"Verification variances by item",icon:""},{name:"Stock Aging Analysis",path:"/inventory/reports/stock-aging-analysis",description:"Age buckets and holding",icon:""},{name:"Slow Moving Items",path:"/inventory/reports/slow-moving",description:"Low turnover items",icon:""},{name:"Fast Moving Items",path:"/inventory/reports/fast-moving",description:"High turnover items",icon:""},{name:"Non Moving Items",path:"/inventory/reports/non-moving",description:"No movement in period",icon:""}]}];return e.jsx(Gl,{title:"Inventory Management",description:"Stock management, warehouse operations, and inventory control",stats:t,sections:r})}function aX(){return e.jsxs(Ji,{children:[e.jsx(Je,{index:!0,element:e.jsx(rX,{})}),e.jsx(Je,{path:"material-requisitions",element:e.jsx(bY,{})}),e.jsx(Je,{path:"material-requisitions/:id",element:e.jsx(yY,{})}),e.jsx(Je,{path:"stock-updation",element:e.jsx(RY,{})}),e.jsx(Je,{path:"stock-verification",element:e.jsx(QY,{})}),e.jsx(Je,{path:"stock-updation/:id",element:e.jsx(OY,{})}),e.jsx(Je,{path:"stock-verification/:id",element:e.jsx(MY,{})}),e.jsx(Je,{path:"return-to-stores",element:e.jsx(HY,{})}),e.jsx(Je,{path:"return-to-stores/new",element:e.jsx(tS,{})}),e.jsx(Je,{path:"return-to-stores/:id",element:e.jsx(tS,{})}),e.jsx(Je,{path:"stock-adjustments",element:e.jsx(xY,{})}),e.jsx(Je,{path:"stock-adjustments/new",element:e.jsx(J_,{})}),e.jsx(Je,{path:"stock-adjustments/:id",element:e.jsx(J_,{})}),e.jsx(Je,{path:"issue-to-requirement",element:e.jsx(qY,{})}),e.jsx(Je,{path:"issue-to-requirement/new",element:e.jsx(sS,{})}),e.jsx(Je,{path:"issue-to-requirement/:id",element:e.jsx(sS,{})}),e.jsx(Je,{path:"stock-transfers",element:e.jsx(gY,{})}),e.jsx(Je,{path:"stock-transfers/:id",element:e.jsx(vY,{})}),e.jsx(Je,{path:"transfer-acceptance",element:e.jsx(EY,{})}),e.jsx(Je,{path:"transfer-acceptance/:id",element:e.jsx(FY,{})}),e.jsx(Je,{path:"stock-reorder",element:e.jsx(VY,{})}),e.jsx(Je,{path:"alerts/low-stock",element:e.jsx(tX,{})}),e.jsx(Je,{path:"stock-take",element:e.jsx(TY,{})}),e.jsx(Je,{path:"stock-take/:id",element:e.jsx(IY,{})}),e.jsx(Je,{path:"grn-local",element:e.jsx(SY,{})}),e.jsx(Je,{path:"grn-local/:id",element:e.jsx(CY,{})}),e.jsx(Je,{path:"grn-import",element:e.jsx(kY,{})}),e.jsx(Je,{path:"grn-import/:id",element:e.jsx(BY,{})}),e.jsx(Je,{path:"sales-returns",element:e.jsx(UB,{})}),e.jsx(Je,{path:"items",element:e.jsx(jY,{})}),e.jsx(Je,{path:"items/:id",element:e.jsx(NY,{})}),e.jsx(Je,{path:"item-groups",element:e.jsx(LY,{})}),e.jsx(Je,{path:"item-groups/:id",element:e.jsx(DY,{})}),e.jsx(Je,{path:"unit-conversions",element:e.jsx(UY,{})}),e.jsx(Je,{path:"unit-conversions/:id",element:e.jsx(PY,{})}),e.jsx(Je,{path:"warehouses",element:e.jsx(wY,{})}),e.jsx(Je,{path:"warehouses/:id",element:e.jsx(_Y,{})}),e.jsx(Je,{path:"reports",element:e.jsx(sX,{title:"Inventory Reports",description:"Stock reports and analytics"})}),e.jsx(Je,{path:"reports/health-monitor",element:e.jsx($Y,{})}),e.jsx(Je,{path:"reports/periodical-stock-summary",element:e.jsx(WY,{})}),e.jsx(Je,{path:"reports/periodical-stock-statement",element:e.jsx(GY,{})}),e.jsx(Je,{path:"reports/issue-register",element:e.jsx(KY,{})}),e.jsx(Je,{path:"reports/stock-transfer-register",element:e.jsx(zY,{})}),e.jsx(Je,{path:"reports/stock-verification",element:e.jsx(YY,{})}),e.jsx(Je,{path:"reports/stock-aging-analysis",element:e.jsx(XY,{})}),e.jsx(Je,{path:"reports/slow-moving",element:e.jsx(JY,{})}),e.jsx(Je,{path:"reports/fast-moving",element:e.jsx(ZY,{})}),e.jsx(Je,{path:"reports/non-moving",element:e.jsx(eX,{})}),e.jsx(Je,{path:"*",element:e.jsx(Hc,{to:"/inventory",replace:!0})})]})}function nX(){const[t,s]=x.useState(""),[r,a]=x.useState("ALL"),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState("");x.useEffect(()=>{let A=!0;return o(!0),d(""),ee.get("/purchase/rfqs").then(f=>{var g;A&&i(Array.isArray((g=f.data)==null?void 0:g.items)?f.data.items:[])}).catch(f=>{var g,v;A&&d(((v=(g=f==null?void 0:f.response)==null?void 0:g.data)==null?void 0:v.message)||"Failed to load RFQs")}).finally(()=>{A&&o(!1)}),()=>{A=!1}},[]);const c=A=>({DRAFT:"badge-neutral",SENT:"badge-info",EXPIRED:"badge-error",CLOSED:"badge-success"})[A]||"badge-info",h=x.useMemo(()=>n.filter(A=>{const f=String(A.rfq_no||"").toLowerCase().includes(t.toLowerCase())||String(A.delivery_terms||"").toLowerCase().includes(t.toLowerCase()),g=r==="ALL"||A.status===r;return f&&g}),[n,t,r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Request for Quotation (RFQ)"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and send RFQs to suppliers for competitive bidding"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/rfqs/new",className:"btn-success",children:"+ New RFQ"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by RFQ no or delivery terms...",className:"input",value:t,onChange:A=>s(A.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:A=>a(A.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SENT",children:"Sent"}),e.jsx("option",{value:"EXPIRED",children:"Expired"}),e.jsx("option",{value:"CLOSED",children:"Closed"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"RFQ No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Delivery Terms"}),e.jsx("th",{children:"Suppliers"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-red-600",children:u})}):null,h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No RFQs found"})}):h.map(A=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:A.rfq_no}),e.jsx("td",{children:new Date(A.rfq_date).toLocaleDateString()}),e.jsx("td",{children:A.expiry_date?new Date(A.expiry_date).toLocaleDateString():"-"}),e.jsx("td",{children:A.delivery_terms||"-"}),e.jsx("td",{children:A.supplier_count||0}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c(A.status)}`,children:A.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/purchase/rfqs/${A.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/purchase/rfqs/${A.id}/edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"})]})})]},A.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",h.length," of ",n.length," ","RFQs"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]})]})}const OB=6048e5,iX=864e5,rS=Symbol.for("constructDateFrom");function pu(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&rS in t?t[rS](s):t instanceof Date?new t.constructor(s):new Date(s)}function Uo(t,s){return pu(s||t,t)}let lX={};function dg(){return lX}function Bf(t,s){var o,u,d,c;const r=dg(),a=(s==null?void 0:s.weekStartsOn)??((u=(o=s==null?void 0:s.locale)==null?void 0:o.options)==null?void 0:u.weekStartsOn)??r.weekStartsOn??((c=(d=r.locale)==null?void 0:d.options)==null?void 0:c.weekStartsOn)??0,n=Uo(t,s==null?void 0:s.in),i=n.getDay(),l=(i<a?7:0)+i-a;return n.setDate(n.getDate()-l),n.setHours(0,0,0,0),n}function y0(t,s){return Bf(t,{...s,weekStartsOn:1})}function QB(t,s){const r=Uo(t,s==null?void 0:s.in),a=r.getFullYear(),n=pu(r,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const i=y0(n),l=pu(r,0);l.setFullYear(a,0,4),l.setHours(0,0,0,0);const o=y0(l);return r.getTime()>=i.getTime()?a+1:r.getTime()>=o.getTime()?a:a-1}function aS(t){const s=Uo(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function oX(t,...s){const r=pu.bind(null,s.find(a=>typeof a=="object"));return s.map(r)}function nS(t,s){const r=Uo(t,s==null?void 0:s.in);return r.setHours(0,0,0,0),r}function cX(t,s,r){const[a,n]=oX(r==null?void 0:r.in,t,s),i=nS(a),l=nS(n),o=+i-aS(i),u=+l-aS(l);return Math.round((o-u)/iX)}function dX(t,s){const r=QB(t,s),a=pu(t,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),y0(a)}function uX(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function AX(t){return!(!uX(t)&&typeof t!="number"||isNaN(+Uo(t)))}function hX(t,s){const r=Uo(t,s==null?void 0:s.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const mX={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fX=(t,s,r)=>{let a;const n=mX[t];return typeof n=="string"?a=n:s===1?a=n.one:a=n.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a};function ub(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const pX={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xX={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gX={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vX={date:ub({formats:pX,defaultWidth:"full"}),time:ub({formats:xX,defaultWidth:"full"}),dateTime:ub({formats:gX,defaultWidth:"full"})},bX={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yX=(t,s,r,a)=>bX[t];function Nm(t){return(s,r)=>{const a=r!=null&&r.context?String(r.context):"standalone";let n;if(a==="formatting"&&t.formattingValues){const l=t.defaultFormattingWidth||t.defaultWidth,o=r!=null&&r.width?String(r.width):l;n=t.formattingValues[o]||t.formattingValues[l]}else{const l=t.defaultWidth,o=r!=null&&r.width?String(r.width):t.defaultWidth;n=t.values[o]||t.values[l]}const i=t.argumentCallback?t.argumentCallback(s):s;return n[i]}}const jX={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},NX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},wX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},_X={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},SX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},CX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kX=(t,s)=>{const r=Number(t),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},BX={ordinalNumber:kX,era:Nm({values:jX,defaultWidth:"wide"}),quarter:Nm({values:NX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Nm({values:wX,defaultWidth:"wide"}),day:Nm({values:_X,defaultWidth:"wide"}),dayPeriod:Nm({values:SX,defaultWidth:"wide",formattingValues:CX,defaultFormattingWidth:"wide"})};function wm(t){return(s,r={})=>{const a=r.width,n=a&&t.matchPatterns[a]||t.matchPatterns[t.defaultMatchWidth],i=s.match(n);if(!i)return null;const l=i[0],o=a&&t.parsePatterns[a]||t.parsePatterns[t.defaultParseWidth],u=Array.isArray(o)?FX(o,h=>h.test(l)):EX(o,h=>h.test(l));let d;d=t.valueCallback?t.valueCallback(u):u,d=r.valueCallback?r.valueCallback(d):d;const c=s.slice(l.length);return{value:d,rest:c}}}function EX(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function FX(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function TX(t){return(s,r={})=>{const a=s.match(t.matchPattern);if(!a)return null;const n=a[0],i=s.match(t.parsePattern);if(!i)return null;let l=t.valueCallback?t.valueCallback(i[0]):i[0];l=r.valueCallback?r.valueCallback(l):l;const o=s.slice(n.length);return{value:l,rest:o}}}const IX=/^(\d+)(th|st|nd|rd)?/i,LX=/\d+/i,DX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},UX={any:[/^b/i,/^(a|c)/i]},PX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},RX={any:[/1/i,/2/i,/3/i,/4/i]},OX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},QX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},MX={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},HX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},qX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},VX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$X={ordinalNumber:TX({matchPattern:IX,parsePattern:LX,valueCallback:t=>parseInt(t,10)}),era:wm({matchPatterns:DX,defaultMatchWidth:"wide",parsePatterns:UX,defaultParseWidth:"any"}),quarter:wm({matchPatterns:PX,defaultMatchWidth:"wide",parsePatterns:RX,defaultParseWidth:"any",valueCallback:t=>t+1}),month:wm({matchPatterns:OX,defaultMatchWidth:"wide",parsePatterns:QX,defaultParseWidth:"any"}),day:wm({matchPatterns:MX,defaultMatchWidth:"wide",parsePatterns:HX,defaultParseWidth:"any"}),dayPeriod:wm({matchPatterns:qX,defaultMatchWidth:"any",parsePatterns:VX,defaultParseWidth:"any"})},WX={code:"en-US",formatDistance:fX,formatLong:vX,formatRelative:yX,localize:BX,match:$X,options:{weekStartsOn:0,firstWeekContainsDate:1}};function GX(t,s){const r=Uo(t,s==null?void 0:s.in);return cX(r,hX(r))+1}function KX(t,s){const r=Uo(t,s==null?void 0:s.in),a=+y0(r)-+dX(r);return Math.round(a/OB)+1}function MB(t,s){var c,h,A,f;const r=Uo(t,s==null?void 0:s.in),a=r.getFullYear(),n=dg(),i=(s==null?void 0:s.firstWeekContainsDate)??((h=(c=s==null?void 0:s.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((f=(A=n.locale)==null?void 0:A.options)==null?void 0:f.firstWeekContainsDate)??1,l=pu((s==null?void 0:s.in)||t,0);l.setFullYear(a+1,0,i),l.setHours(0,0,0,0);const o=Bf(l,s),u=pu((s==null?void 0:s.in)||t,0);u.setFullYear(a,0,i),u.setHours(0,0,0,0);const d=Bf(u,s);return+r>=+o?a+1:+r>=+d?a:a-1}function zX(t,s){var o,u,d,c;const r=dg(),a=(s==null?void 0:s.firstWeekContainsDate)??((u=(o=s==null?void 0:s.locale)==null?void 0:o.options)==null?void 0:u.firstWeekContainsDate)??r.firstWeekContainsDate??((c=(d=r.locale)==null?void 0:d.options)==null?void 0:c.firstWeekContainsDate)??1,n=MB(t,s),i=pu((s==null?void 0:s.in)||t,0);return i.setFullYear(n,0,a),i.setHours(0,0,0,0),Bf(i,s)}function YX(t,s){const r=Uo(t,s==null?void 0:s.in),a=+Bf(r,s)-+zX(r,s);return Math.round(a/OB)+1}function Qr(t,s){const r=t<0?"-":"",a=Math.abs(t).toString().padStart(s,"0");return r+a}const $d={y(t,s){const r=t.getFullYear(),a=r>0?r:1-r;return Qr(s==="yy"?a%100:a,s.length)},M(t,s){const r=t.getMonth();return s==="M"?String(r+1):Qr(r+1,2)},d(t,s){return Qr(t.getDate(),s.length)},a(t,s){const r=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,s){return Qr(t.getHours()%12||12,s.length)},H(t,s){return Qr(t.getHours(),s.length)},m(t,s){return Qr(t.getMinutes(),s.length)},s(t,s){return Qr(t.getSeconds(),s.length)},S(t,s){const r=s.length,a=t.getMilliseconds(),n=Math.trunc(a*Math.pow(10,r-3));return Qr(n,s.length)}},dh={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},iS={G:function(t,s,r){const a=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});case"GGGG":default:return r.era(a,{width:"wide"})}},y:function(t,s,r){if(s==="yo"){const a=t.getFullYear(),n=a>0?a:1-a;return r.ordinalNumber(n,{unit:"year"})}return $d.y(t,s)},Y:function(t,s,r,a){const n=MB(t,a),i=n>0?n:1-n;if(s==="YY"){const l=i%100;return Qr(l,2)}return s==="Yo"?r.ordinalNumber(i,{unit:"year"}):Qr(i,s.length)},R:function(t,s){const r=QB(t);return Qr(r,s.length)},u:function(t,s){const r=t.getFullYear();return Qr(r,s.length)},Q:function(t,s,r){const a=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(a);case"QQ":return Qr(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(t,s,r){const a=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(a);case"qq":return Qr(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(t,s,r){const a=t.getMonth();switch(s){case"M":case"MM":return $d.M(t,s);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(t,s,r){const a=t.getMonth();switch(s){case"L":return String(a+1);case"LL":return Qr(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(t,s,r,a){const n=YX(t,a);return s==="wo"?r.ordinalNumber(n,{unit:"week"}):Qr(n,s.length)},I:function(t,s,r){const a=KX(t);return s==="Io"?r.ordinalNumber(a,{unit:"week"}):Qr(a,s.length)},d:function(t,s,r){return s==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):$d.d(t,s)},D:function(t,s,r){const a=GX(t);return s==="Do"?r.ordinalNumber(a,{unit:"dayOfYear"}):Qr(a,s.length)},E:function(t,s,r){const a=t.getDay();switch(s){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});case"EEEE":default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(t,s,r,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(s){case"e":return String(i);case"ee":return Qr(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(t,s,r,a){const n=t.getDay(),i=(n-a.weekStartsOn+8)%7||7;switch(s){case"c":return String(i);case"cc":return Qr(i,s.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(t,s,r){const a=t.getDay(),n=a===0?7:a;switch(s){case"i":return String(n);case"ii":return Qr(n,s.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});case"iiii":default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(t,s,r){const n=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,s,r){const a=t.getHours();let n;switch(a===12?n=dh.noon:a===0?n=dh.midnight:n=a/12>=1?"pm":"am",s){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,s,r){const a=t.getHours();let n;switch(a>=17?n=dh.evening:a>=12?n=dh.afternoon:a>=4?n=dh.morning:n=dh.night,s){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,s,r){if(s==="ho"){let a=t.getHours()%12;return a===0&&(a=12),r.ordinalNumber(a,{unit:"hour"})}return $d.h(t,s)},H:function(t,s,r){return s==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):$d.H(t,s)},K:function(t,s,r){const a=t.getHours()%12;return s==="Ko"?r.ordinalNumber(a,{unit:"hour"}):Qr(a,s.length)},k:function(t,s,r){let a=t.getHours();return a===0&&(a=24),s==="ko"?r.ordinalNumber(a,{unit:"hour"}):Qr(a,s.length)},m:function(t,s,r){return s==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):$d.m(t,s)},s:function(t,s,r){return s==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):$d.s(t,s)},S:function(t,s){return $d.S(t,s)},X:function(t,s,r){const a=t.getTimezoneOffset();if(a===0)return"Z";switch(s){case"X":return oS(a);case"XXXX":case"XX":return zu(a);case"XXXXX":case"XXX":default:return zu(a,":")}},x:function(t,s,r){const a=t.getTimezoneOffset();switch(s){case"x":return oS(a);case"xxxx":case"xx":return zu(a);case"xxxxx":case"xxx":default:return zu(a,":")}},O:function(t,s,r){const a=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+lS(a,":");case"OOOO":default:return"GMT"+zu(a,":")}},z:function(t,s,r){const a=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+lS(a,":");case"zzzz":default:return"GMT"+zu(a,":")}},t:function(t,s,r){const a=Math.trunc(+t/1e3);return Qr(a,s.length)},T:function(t,s,r){return Qr(+t,s.length)}};function lS(t,s=""){const r=t>0?"-":"+",a=Math.abs(t),n=Math.trunc(a/60),i=a%60;return i===0?r+String(n):r+String(n)+s+Qr(i,2)}function oS(t,s){return t%60===0?(t>0?"-":"+")+Qr(Math.abs(t)/60,2):zu(t,s)}function zu(t,s=""){const r=t>0?"-":"+",a=Math.abs(t),n=Qr(Math.trunc(a/60),2),i=Qr(a%60,2);return r+n+s+i}const cS=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},HB=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},XX=(t,s)=>{const r=t.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return cS(t,s);let i;switch(a){case"P":i=s.dateTime({width:"short"});break;case"PP":i=s.dateTime({width:"medium"});break;case"PPP":i=s.dateTime({width:"long"});break;case"PPPP":default:i=s.dateTime({width:"full"});break}return i.replace("{{date}}",cS(a,s)).replace("{{time}}",HB(n,s))},JX={p:HB,P:XX},ZX=/^D+$/,eJ=/^Y+$/,tJ=["D","DD","YY","YYYY"];function sJ(t){return ZX.test(t)}function rJ(t){return eJ.test(t)}function aJ(t,s,r){const a=nJ(t,s,r);if(console.warn(a),tJ.includes(t))throw new RangeError(a)}function nJ(t,s,r){const a=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${a} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const iJ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lJ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,oJ=/^'([^]*?)'?$/,cJ=/''/g,dJ=/[a-zA-Z]/;function bh(t,s,r){var c,h,A,f;const a=dg(),n=a.locale??WX,i=a.firstWeekContainsDate??((h=(c=a.locale)==null?void 0:c.options)==null?void 0:h.firstWeekContainsDate)??1,l=a.weekStartsOn??((f=(A=a.locale)==null?void 0:A.options)==null?void 0:f.weekStartsOn)??0,o=Uo(t,r==null?void 0:r.in);if(!AX(o))throw new RangeError("Invalid time value");let u=s.match(lJ).map(g=>{const v=g[0];if(v==="p"||v==="P"){const b=JX[v];return b(g,n.formatLong)}return g}).join("").match(iJ).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const v=g[0];if(v==="'")return{isToken:!1,value:uJ(g)};if(iS[v])return{isToken:!0,value:g};if(v.match(dJ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+v+"`");return{isToken:!1,value:g}});n.localize.preprocessor&&(u=n.localize.preprocessor(o,u));const d={firstWeekContainsDate:i,weekStartsOn:l,locale:n};return u.map(g=>{if(!g.isToken)return g.value;const v=g.value;(rJ(v)||sJ(v))&&aJ(v,s,String(t));const b=iS[v[0]];return b(o,v,n.localize,d)}).join("")}function uJ(t){const s=t.match(oJ);return s?s[1].replace(cJ,"'"):t}function Ab(){const{id:t}=Ls(),s=ys(),r=!!t&&t!=="new",[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState({rfq_no:"",rfq_date:bh(new Date,"yyyy-MM-dd"),expiry_date:"",status:"DRAFT",delivery_terms:"FOB",terms_conditions:`1. Price validity: 30 days from quote date
2. Delivery: As per agreed schedule
3. Payment terms: Net 30 days
4. Quality standards must be met
5. All prices should be quoted in GHS`}),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState([]),[y,j]=x.useState([]),[N,S]=x.useState([]),[B,P]=x.useState(!1),[L,U]=x.useState(""),H=x.useRef(null),[q,V]=x.useState("");x.useEffect(()=>{M()},[]),x.useEffect(()=>{r&&z()},[t,r]),x.useEffect(()=>{r||ee.get("/purchase/rfqs/next-no").then(w=>{var O;(O=w.data)!=null&&O.nextNo&&c(R=>({...R,rfq_no:w.data.nextNo}))}).catch(w=>console.error("Failed to load next RFQ number",w))},[r]);const M=async()=>{try{const[w,O,R]=await Promise.all([ee.get("/purchase/suppliers?active=true"),ee.get("/inventory/items"),ee.get("/inventory/uoms")]);b(w.data.items||[]),j(O.data.items||[]),S(R.data.items||[])}catch(w){console.error("Failed to load dependencies",w)}},z=async()=>{var w,O;n(!0);try{const R=await ee.get(`/purchase/rfqs/${t}`),{item:X,items:ne,suppliers:te}=R.data;c({rfq_no:X.rfq_no,rfq_date:X.rfq_date?bh(new Date(X.rfq_date),"yyyy-MM-dd"):"",expiry_date:X.expiry_date?bh(new Date(X.expiry_date),"yyyy-MM-dd"):"",status:X.status,delivery_terms:X.delivery_terms||"FOB",terms_conditions:X.terms_conditions||""}),A(ne.map(oe=>({...oe,required_date:oe.required_date?bh(new Date(oe.required_date),"yyyy-MM-dd"):""}))),g(te.map(oe=>({id:oe.supplier_id,supplier_name:oe.supplier_name,email:oe.email,phone:oe.phone})))}catch(R){u(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load RFQ")}finally{n(!1)}},I=w=>{const{id:O,value:R}=w.target;c(X=>({...X,[O]:R}))},G=(w,O,R)=>{const X=[...h];X[w]={...X[w],[O]:R},A(X)},Y=(w,O)=>{const R=y.find(X=>X.id===Number(O));if(R){const X=[...h];X[w]={...X[w],item_id:R.id,item_name:R.item_name,uom:R.uom||"PCS"},A(X)}},J=()=>{A([...h,{item_name:"",qty:0,uom:"PCS",required_date:"",specifications:""}])},T=w=>{A(h.filter((O,R)=>R!==w))},k=w=>{const O=f.find(R=>R.id===w.id);g(O?f.filter(R=>R.id!==w.id):[...f,w])},D=x.useMemo(()=>L?v.filter(w=>w.supplier_name.toLowerCase().includes(L.toLowerCase())||w.email&&w.email.toLowerCase().includes(L.toLowerCase())):v,[v,L]),Q=()=>{window.print()},C=async()=>{const w=H.current;if(!w)return;const O=w.style.cssText;w.style.cssText=O+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const R=await Ai(w,{scale:2,useCORS:!0}),X=R.toDataURL("image/png"),ne=new ds("p","mm","a4"),te=ne.internal.pageSize.getWidth(),oe=ne.internal.pageSize.getHeight(),ce=te,re=R.height*ce/R.width;let de=0;for(;de<re;)ne.addImage(X,"PNG",0,-de,ce,re),de+=oe,de<re&&ne.addPage();const Ie="RFQ_"+(d.rfq_no||new Date().toISOString().slice(0,10))+".pdf";ne.save(Ie)}finally{w.style.cssText=O}},E=async(w=null)=>{var R,X;if(!d.rfq_date){alert("RFQ Date is required");return}if(h.length===0){alert("Please add at least one item to the RFQ");return}if(h.filter(ne=>!ne.item_name||!ne.qty||Number(ne.qty)<=0).length>0){alert("All items must have a name and quantity greater than 0");return}l(!0);try{const ne={...d,rfq_no:d.rfq_no||null,status:w||d.status,items:h,supplier_ids:f.map(te=>te.id)};r?await ee.put(`/purchase/rfqs/${t}`,ne):(await ee.post("/purchase/rfqs",ne)).data.id,w&&c(te=>({...te,status:w})),V("RFQ Saved Successfully"),setTimeout(()=>{s("/purchase/rfqs")},1e3)}catch(ne){console.error(ne),alert(((X=(R=ne==null?void 0:ne.response)==null?void 0:R.data)==null?void 0:X.message)||"Failed to save RFQ")}finally{l(!1)}};return a?e.jsx("div",{className:"p-4",children:"Loading..."}):o?e.jsxs("div",{className:"p-4 text-red-600",children:["Error: ",o]}):e.jsxs("div",{className:"max-w-7xl mx-auto p-4 space-y-6",children:[e.jsxs("div",{className:"print:hidden",children:[q&&e.jsx("div",{className:"mb-3 p-3 rounded border border-green-300 bg-green-100 text-green-700",children:q}),e.jsxs("div",{className:"bg-gradient-to-r from-[#0E3646] to-[#1a5570] p-6 rounded-xl text-white shadow-lg",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx("span",{children:""})," Request for Quotation (RFQ)"]}),e.jsx("p",{className:"opacity-90 text-sm mt-1",children:"Create and send RFQs to suppliers for competitive bidding"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx("button",{onClick:()=>P(!0),className:"px-4 py-2 bg-[#17a2b8] text-white rounded hover:bg-cyan-700 transition flex items-center gap-2",children:" Select Suppliers"}),e.jsx("button",{onClick:()=>s("/purchase/rfqs"),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition flex items-center gap-2 ml-auto",children:" View List"}),e.jsxs("div",{className:"flex items-center gap-3 ml-4",children:[e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition text-sm",children:[e.jsx(Yc,{className:"w-4 h-4"}),"Download PDF"]}),e.jsxs("button",{onClick:Q,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition text-sm",children:[e.jsx(qh,{className:"w-4 h-4"}),"Print"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center gap-2 border-b-2 border-[#0E3646] pb-2 mb-4",children:e.jsx("h2",{className:"text-lg font-semibold text-[#0E3646]",children:" RFQ Information"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"RFQ Number"}),e.jsx("input",{type:"text",value:d.rfq_no,readOnly:!0,className:"p-2 border border-gray-300 rounded bg-gray-100 text-gray-600"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646] after:content-['*'] after:text-red-500",children:"RFQ Date"}),e.jsx("input",{type:"date",id:"rfq_date",value:d.rfq_date,onChange:I,className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Expiry Date"}),e.jsx("input",{type:"date",id:"expiry_date",value:d.expiry_date,onChange:I,className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Status"}),e.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold w-fit ${d.status==="SENT"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:d.status})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Delivery Terms"}),e.jsxs("select",{id:"delivery_terms",value:d.delivery_terms,onChange:I,className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",children:[e.jsx("option",{value:"FOB",children:"FOB - Free on Board"}),e.jsx("option",{value:"CIF",children:"CIF - Cost, Insurance & Freight"}),e.jsx("option",{value:"EXW",children:"EXW - Ex Works"}),e.jsx("option",{value:"DDP",children:"DDP - Delivered Duty Paid"})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 lg:col-span-2 flex flex-col gap-1",children:[e.jsx("label",{className:"text-sm font-semibold text-[#0E3646]",children:"Terms & Conditions"}),e.jsx("textarea",{id:"terms_conditions",value:d.terms_conditions,onChange:I,rows:"3",className:"p-2 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",placeholder:"Enter terms and conditions..."})]})]})]}),e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center gap-2 border-b-2 border-[#0E3646] pb-2 mb-4",children:e.jsxs("h2",{className:"text-lg font-semibold text-[#0E3646]",children:[" Selected Suppliers (",f.length,")"]})}),f.length===0?e.jsx("div",{className:"text-center p-8 bg-gray-50 rounded border border-dashed border-gray-300 text-gray-500",children:'No suppliers selected. Click "Select Suppliers" to add.'}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(w=>e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded p-4 relative hover:border-[#0E3646] transition group",children:[e.jsx("button",{onClick:()=>k(w),className:"absolute top-2 right-2 text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition",children:""}),e.jsxs("div",{className:"font-semibold text-[#0E3646]",children:[w.supplier_name,w.supplier_code&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",w.supplier_code,")"]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 space-y-1",children:[w.contact_person&&e.jsxs("div",{className:"flex items-center gap-2",children:[" ",w.contact_person]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",w.email||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",w.phone||"N/A"]})]})]},w.id))})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h2",{className:"text-lg font-semibold text-[#0E3646]",children:" RFQ Items"})}),e.jsx("button",{onClick:J,className:"px-3 py-1 bg-[#0E3646] text-white text-sm rounded hover:bg-[#082330] transition",children:" Add Item"})]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-[#0E3646] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-12",children:"#"}),e.jsx("th",{className:"p-3",children:"Item Name"}),e.jsx("th",{className:"p-3 w-32",children:"Quantity"}),e.jsx("th",{className:"p-3 w-24",children:"UOM"}),e.jsx("th",{className:"p-3 w-40",children:"Required Date"}),e.jsx("th",{className:"p-3 w-64",children:"Specifications"}),e.jsx("th",{className:"p-3 w-20",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"p-8 text-center text-gray-500",children:'No items added. Click "Add Item" to start.'})}):h.map((w,O)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[e.jsx("td",{className:"p-3",children:O+1}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:w.item_id||"",onChange:R=>Y(O,R.target.value),className:"w-full p-1 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"Select Item"}),y.map(R=>e.jsxs("option",{value:R.id,children:[R.item_name," (",R.item_code,")"]},R.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:w.qty,onChange:R=>G(O,"qty",R.target.value),className:"w-full p-1 border border-gray-300 rounded"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:w.uom||"",onChange:R=>G(O,"uom",R.target.value),className:"w-full p-1 border border-gray-300 rounded focus:ring-2 focus:ring-[#0E3646] focus:border-transparent outline-none",children:[e.jsx("option",{value:"",children:"Select UOM"}),N.map(R=>e.jsxs("option",{value:R.uom_code,children:[R.uom_name," (",R.uom_code,")"]},R.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"date",value:w.required_date||"",onChange:R=>G(O,"required_date",R.target.value),className:"w-full p-1 border border-gray-300 rounded"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"text",value:w.specifications||"",onChange:R=>G(O,"specifications",R.target.value),className:"w-full p-1 border border-gray-300 rounded"})}),e.jsx("td",{className:"p-3",children:e.jsx("button",{onClick:()=>T(O),className:"text-red-500 hover:bg-red-50 p-1 rounded transition",children:""})})]},O))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>{window.confirm("Are you sure? Unsaved changes will be lost.")&&(A([]),g([]),c(w=>({...w,terms_conditions:""})))},className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition",children:" Clear"}),e.jsx("button",{onClick:()=>E("DRAFT"),disabled:i,className:"px-4 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition disabled:opacity-50",children:i?"Saving...":" Save as Draft"}),e.jsx("button",{onClick:()=>E("SENT"),disabled:i,className:"px-4 py-2 bg-[#28a745] text-white rounded hover:bg-green-700 transition disabled:opacity-50",children:i?"Sending...":" Send RFQ to Suppliers"})]})]}),B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 bg-[#0E3646] text-white rounded-t-xl flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Select Suppliers"}),e.jsx("button",{onClick:()=>P(!1),className:"text-white hover:bg-white/10 w-8 h-8 rounded flex items-center justify-center text-xl",children:""})]}),e.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:" Search suppliers...",value:L,onChange:w=>U(w.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0E3646] outline-none"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[D.map(w=>{const O=f.some(R=>R.id===w.id);return e.jsx("div",{onClick:()=>k(w),className:`
                        border-2 rounded-lg p-4 cursor-pointer transition
                        ${O?"border-[#0E3646] bg-blue-50":"border-gray-200 hover:border-blue-300"}
                      `,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`
                          w-5 h-5 rounded border flex items-center justify-center mt-1
                          ${O?"bg-[#0E3646] border-[#0E3646]":"border-gray-400 bg-white"}
                        `,children:O&&e.jsx("span",{className:"text-white text-xs",children:""})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-[#0E3646]",children:[w.supplier_name,w.supplier_code&&e.jsxs("span",{className:"text-xs text-gray-500 ml-2 font-normal",children:["(",w.supplier_code,")"]})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1 space-y-1",children:[w.contact_person&&e.jsxs("div",{className:"flex items-center gap-2",children:[" ",w.contact_person]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",w.email||"N/A"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[" ",w.phone||"N/A"]})]})]})]})},w.id)}),D.length===0&&e.jsxs("div",{className:"col-span-full text-center py-8 text-gray-500",children:['No suppliers found matching "',L,'"']})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-200 flex justify-end gap-3 bg-gray-50 rounded-b-xl",children:e.jsx("button",{onClick:()=>P(!1),className:"px-6 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition font-medium",children:"Done"})})]})})]}),e.jsxs("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto bg-white border border-gray-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-[#0E3646]",children:"Request for Quotation"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["RFQ Number: ",d.rfq_no||""]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-700",children:[e.jsxs("div",{children:["Date: ",d.rfq_date||""]}),e.jsxs("div",{children:["Expiry Date: ",d.expiry_date||""]}),e.jsxs("div",{children:["Status: ",d.status]}),e.jsxs("div",{children:["Delivery Terms: ",d.delivery_terms]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Selected Suppliers"}),f.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No suppliers selected."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Supplier"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Email"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Phone"})]})}),e.jsx("tbody",{children:f.map(w=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.supplier_name}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.email||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.phone||""})]},w.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"RFQ Items"}),h.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No items added."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"#"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Item"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-right",children:"Qty"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"UOM"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Required Date"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Specifications"})]})}),e.jsx("tbody",{children:h.map((w,O)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:O+1}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.item_name||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-right",children:w.qty||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.uom||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.required_date||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.specifications||""})]},O))})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Terms and Conditions"}),e.jsx("div",{className:"text-sm whitespace-pre-line",children:d.terms_conditions||"None"})]})]}),e.jsxs("div",{ref:H,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xl font-semibold text-[#0E3646]",children:"Request for Quotation"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["RFQ Number: ",d.rfq_no||""]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-700",children:[e.jsxs("div",{children:["Date: ",d.rfq_date||""]}),e.jsxs("div",{children:["Expiry Date: ",d.expiry_date||""]}),e.jsxs("div",{children:["Status: ",d.status]}),e.jsxs("div",{children:["Delivery Terms: ",d.delivery_terms]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Selected Suppliers"}),f.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No suppliers selected."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Supplier"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Email"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Phone"})]})}),e.jsx("tbody",{children:f.map(w=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.supplier_name}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.email||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.phone||""})]},w.id))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"RFQ Items"}),h.length===0?e.jsx("div",{className:"text-sm text-gray-600",children:"No items added."}):e.jsxs("table",{className:"w-full text-xs border border-gray-400",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"#"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Item"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-right",children:"Qty"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"UOM"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Required Date"}),e.jsx("th",{className:"border border-gray-400 px-2 py-1 text-left",children:"Specifications"})]})}),e.jsx("tbody",{children:h.map((w,O)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:O+1}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.item_name||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1 text-right",children:w.qty||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.uom||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.required_date||""}),e.jsx("td",{className:"border border-gray-400 px-2 py-1",children:w.specifications||""})]},O))})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-[#0E3646] mb-2",children:"Terms and Conditions"}),e.jsx("div",{className:"text-sm whitespace-pre-line",children:d.terms_conditions||"None"})]})]})]})}function AJ(){const[t,s]=x.useState(""),[r,a]=x.useState("ALL"),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState("");x.useEffect(()=>{let A=!0;return o(!0),d(""),ee.get("/purchase/supplier-quotations").then(f=>{var g;A&&i(Array.isArray((g=f.data)==null?void 0:g.items)?f.data.items:[])}).catch(f=>{var g,v;A&&d(((v=(g=f==null?void 0:f.response)==null?void 0:g.data)==null?void 0:v.message)||"Failed to load supplier quotations")}).finally(()=>{A&&o(!1)}),()=>{A=!1}},[]);const c=A=>({DRAFT:"badge-neutral",SUBMITTED:"badge-info",RECEIVED:"badge-info",UNDER_REVIEW:"badge-warning",ACCEPTED:"badge-success",REJECTED:"badge-error"})[A]||"badge-info",h=x.useMemo(()=>n.filter(A=>{const f=String(A.quotation_no||"").toLowerCase().includes(t.toLowerCase())||String(A.supplier_name||"").toLowerCase().includes(t.toLowerCase())||String(A.rfq_no||"").toLowerCase().includes(t.toLowerCase()),g=r==="ALL"||A.status===r;return f&&g}),[n,t,r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Supplier Quotations"}),e.jsx("p",{className:"text-sm mt-1",children:"Receive and manage supplier quotations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/supplier-quotations/new",className:"btn-success",children:"+ New Quotation"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by quotation no, supplier, or RFQ no...",className:"input",value:t,onChange:A=>s(A.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:A=>a(A.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"RECEIVED",children:"Received"}),e.jsx("option",{value:"UNDER_REVIEW",children:"Under Review"}),e.jsx("option",{value:"ACCEPTED",children:"Accepted"}),e.jsx("option",{value:"REJECTED",children:"Rejected"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Quotation No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"RFQ No"}),e.jsx("th",{children:"Valid Until"}),e.jsx("th",{className:"text-right",children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-red-600",children:u})}):null,h.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No quotations found"})}):h.map(A=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:A.quotation_no}),e.jsx("td",{children:new Date(A.quotation_date).toLocaleDateString()}),e.jsx("td",{children:A.supplier_name}),e.jsx("td",{children:A.rfq_no}),e.jsx("td",{children:A.valid_until?new Date(A.valid_until).toLocaleDateString():""}),e.jsx("td",{className:"text-right font-medium",children:A.total_amount.toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c(A.status)}`,children:A.status.replace("_"," ")})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/purchase/supplier-quotations/${A.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/purchase/supplier-quotations/${A.id}/edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"})]})})]},A.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",h.length," of ",n.length," ","quotations"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]})]})}function hb(){const{id:t}=Ls(),s=ys(),r=!!t&&t!=="new",[a,n]=x.useState({quotation_no:"",quotation_date:new Date().toISOString().split("T")[0],supplier_id:"",rfq_id:"",valid_until:"",status:"DRAFT",remarks:"",contact_person:"",email:"",phone:"",currency:"USD",exchange_rate:1,payment_terms:"Net30",delivery_time:"",delivery_terms:"FOB",shipping_cost:0,discount_percent:0}),[i,l]=x.useState([{item_id:"",item_name:"",qty:0,unit_price:0,tax_percent:0,delivery_date:"",line_total:0}]),[o,u]=x.useState([]),[d,c]=x.useState([]),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState(!1),[y,j]=x.useState(!1),[N,S]=x.useState(""),[B,P]=x.useState([]),[L,U]=x.useState(!1),[H,q]=x.useState([]),[V,M]=x.useState([]),[z,I]=x.useState(null);x.useEffect(()=>{let X=!0;async function ne(){var te,oe,ce,re,de,Ie,le;try{const[Z,ve,Ue,Be,_e]=await Promise.all([ee.get("/purchase/suppliers"),ee.get("/inventory/items"),ee.get("/purchase/rfqs"),ee.get("/finance/tax-codes"),ee.get("/finance/currencies")]);if(!X)return;u(Array.isArray((te=Z.data)==null?void 0:te.items)?Z.data.items:[]),A(Array.isArray((oe=ve.data)==null?void 0:oe.items)?ve.data.items:[]),c(Array.isArray((ce=Ue.data)==null?void 0:ce.items)?Ue.data.items:[]),g(Array.isArray((re=Be.data)==null?void 0:re.items)?Be.data.items:[]),M(Array.isArray((de=_e.data)==null?void 0:de.items)?_e.data.items:[])}catch(Z){if(!X)return;S(((le=(Ie=Z==null?void 0:Z.response)==null?void 0:Ie.data)==null?void 0:le.message)||"Failed to load suppliers/items")}}return ne(),()=>{X=!1}},[]),x.useEffect(()=>{if(r)return;let X=!0;return ee.get("/purchase/supplier-quotations/next-no").then(ne=>{var te;X&&(te=ne.data)!=null&&te.nextNo&&n(oe=>({...oe,quotation_no:ne.data.nextNo}))}).catch(ne=>console.error("Failed to load next supplier quotation number",ne)),()=>{X=!1}},[r]),x.useEffect(()=>{if(!r)return;let X=!0;return b(!0),S(""),ee.get(`/purchase/supplier-quotations/${t}`).then(ne=>{var ce,re;if(!X)return;const te=(ce=ne.data)==null?void 0:ce.item,oe=Array.isArray((re=ne.data)==null?void 0:re.details)?ne.data.details:[];te&&(n(de=>{const Ie={...de,quotation_no:te.quotation_no||"",quotation_date:te.quotation_date?String(te.quotation_date).split("T")[0]:new Date().toISOString().split("T")[0],supplier_id:te.supplier_id?String(te.supplier_id):"",rfq_id:te.rfq_id?String(te.rfq_id):"",valid_until:te.valid_until?String(te.valid_until).split("T")[0]:"",status:te.status||"DRAFT",remarks:te.remarks||"",exchange_rate:te.exchange_rate!==void 0&&te.exchange_rate!==null?Number(te.exchange_rate)||de.exchange_rate||1:de.exchange_rate||1},le=`supplierQuoteExtras:${t}`;try{const Z=window.localStorage.getItem(le);if(Z){const ve=JSON.parse(Z);ve&&ve.formData&&Object.assign(Ie,ve.formData)}}catch{}return Ie}),I(te.currency_id||null),l(()=>{let de=oe.length&&oe.map(le=>({item_id:le.item_id?String(le.item_id):"",item_name:le.item_name||"",qty:Number(le.qty)||0,unit_price:Number(le.unit_price)||0,tax_percent:le.tax_percent!==void 0&&le.tax_percent!==null&&Number(le.tax_percent)||0,delivery_date:le.delivery_date?String(le.delivery_date).split("T")[0]:"",line_total:Number(le.line_total)||0}));(!de||!de.length)&&(de=[{item_id:"",item_name:"",qty:0,unit_price:0,tax_percent:0,delivery_date:"",line_total:0}]);const Ie=`supplierQuoteExtras:${t}`;try{const le=window.localStorage.getItem(Ie);if(le){const Z=JSON.parse(le);if(Z&&Array.isArray(Z.items))return de.map((ve,Ue)=>({...ve,...Z.items[Ue]||{}}))}}catch{}return de}))}).catch(ne=>{var te,oe;X&&S(((oe=(te=ne==null?void 0:ne.response)==null?void 0:te.data)==null?void 0:oe.message)||"Failed to load supplier quotation")}).finally(()=>{X&&b(!1)}),()=>{X=!1}},[t,r]);const G=async X=>{var re;const ne=String(X||"").toUpperCase(),te=Array.isArray(V)?V:[];if(!ne||!te.length)return;const oe=te.find(de=>String(de.is_base)==="1"||de.is_base===1||de.is_base===!0)||te.find(de=>String(de.code||de.currency_code||"").toUpperCase()==="GHS")||te.find(de=>/ghana|cedi/i.test(String(de.name||de.currency_name||""))),ce=te.find(de=>String(de.code||de.currency_code||"").toUpperCase()===ne);if(!oe||!ce||oe.id===ce.id){n(de=>({...de,exchange_rate:1}));return}try{const de=a.quotation_date||new Date().toISOString().split("T")[0],Ie=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:ce.id,toCurrencyId:oe.id,to:de}}),Z=(Array.isArray((re=Ie.data)==null?void 0:re.items)?Ie.data.items:[])[0];if(Z&&Z.rate)n(ve=>({...ve,exchange_rate:Number(Z.rate)||ve.exchange_rate||1}));else try{await ee.post("/finance/currency-rates",{fromCurrencyId:ce.id,toCurrencyId:oe.id,rate:1,rateDate:de}),n(ve=>({...ve,exchange_rate:1}))}catch{n(ve=>({...ve,exchange_rate:1}))}}catch{n(de=>({...de,exchange_rate:de.exchange_rate||1}))}};x.useEffect(()=>{if(r&&z&&Array.isArray(V)&&V.length){const X=V.find(ne=>String(ne.id)===String(z));if(X){const ne=String(X.code||X.currency_code||"").toUpperCase();n(te=>({...te,currency:ne||te.currency}))}}},[r,z,V]),x.useEffect(()=>{G(a.currency)},[V,a.currency,a.quotation_date]);const Y=async X=>{var oe,ce,re;const{name:ne,value:te}=X.target;if(n(de=>({...de,[ne]:te})),ne==="rfq_id"&&!te){q([]);return}if(ne==="rfq_id"&&te)try{const de=await ee.get(`/purchase/rfqs/${te}`),Ie=(oe=de.data)==null?void 0:oe.item,le=Array.isArray((ce=de.data)==null?void 0:ce.items)?de.data.items:[],Z=Array.isArray((re=de.data)==null?void 0:re.suppliers)?de.data.suppliers:[];if(q(Z),Ie&&n(ve=>{const Ue={...ve,rfq_id:te,valid_until:Ie.expiry_date||ve.valid_until,delivery_terms:Ie.delivery_terms||ve.delivery_terms,remarks:Ie.remarks||ve.remarks};if(Z.length===1){const Be=Z[0];Ue.supplier_id=String(Be.supplier_id),Ue.contact_person=Be.supplier_name||ve.contact_person,Ue.email=Be.email||ve.email,Ue.phone=Be.phone||ve.phone}else Z.length>1&&(Ue.supplier_id="",Ue.contact_person="",Ue.email="",Ue.phone="");return Ue}),le.length){const ve=le.map(Ue=>({item_id:String(Ue.item_id),item_name:Ue.item_name||"",qty:Number(Ue.qty)||0,unit_price:0,tax_percent:0,delivery_date:Ue.required_date||"",line_total:0}));l(ve)}}catch(de){console.error("Failed to fetch RFQ details",de)}ne==="currency"&&await G(te)},J=(X,ne,te)=>{const oe=[...i];if(oe[X][ne]=te,ne==="item_id"){const ce=h.find(re=>String(re.id)===String(te));ce&&(oe[X].item_name=ce.item_name||ce.name||"")}if(ne==="qty"||ne==="unit_price"||ne==="tax_percent"){const ce=parseFloat(oe[X].qty||0),re=parseFloat(oe[X].unit_price||0);oe[X].line_total=ce*re}l(oe)},T=()=>{l([...i,{item_id:"",item_name:"",qty:0,unit_price:0,tax_percent:0,delivery_date:"",line_total:0}])},k=X=>{i.length>1&&l(i.filter((ne,te)=>te!==X))},D=x.useMemo(()=>i.reduce((X,ne)=>X+(parseFloat(ne.line_total)||0),0),[i]),Q=x.useMemo(()=>i.reduce((X,ne)=>{const te=parseFloat(ne.qty)||0,oe=parseFloat(ne.unit_price)||0,ce=parseFloat(ne.tax_percent)||0,re=te*oe;return X+re*(ce/100)},0),[i]),C=x.useMemo(()=>{const X=parseFloat(a.shipping_cost)||0,ne=parseFloat(a.discount_percent)||0,te=D+Q+X,oe=te*(ne/100);return te-oe},[D,Q,a.shipping_cost,a.discount_percent]);x.useMemo(()=>D,[D]);const E=async X=>{var ne,te,oe;X.preventDefault(),j(!0),S("");try{const re=(Array.isArray(V)?V:[]).find(Z=>String(Z.code||Z.currency_code||"").toUpperCase()===String(a.currency||"").toUpperCase()),de=(re==null?void 0:re.id)||null,Ie={quotation_no:a.quotation_no||void 0,quotation_date:a.quotation_date,supplier_id:Number(a.supplier_id),rfq_id:a.rfq_id?Number(a.rfq_id):null,valid_until:a.valid_until||null,status:a.status,remarks:a.remarks||null,currency_id:de,exchange_rate:Number(a.exchange_rate)||1,details:i.filter(Z=>Z.item_id).map(Z=>({item_id:Number(Z.item_id),qty:Number(Z.qty)||0,unit_price:Number(Z.unit_price)||0,line_total:Number(Z.line_total)||0})),attachments:B.map(Z=>({url:Z.url,filename:Z.filename,note:Z.note||null}))},le={formData:{contact_person:a.contact_person,email:a.email,phone:a.phone,currency:a.currency,payment_terms:a.payment_terms,delivery_time:a.delivery_time,delivery_terms:a.delivery_terms,shipping_cost:a.shipping_cost,discount_percent:a.discount_percent},items:i.map(Z=>({tax_percent:Z.tax_percent,delivery_date:Z.delivery_date}))};if(r){await ee.put(`/purchase/supplier-quotations/${t}`,Ie);const Z=`supplierQuoteExtras:${t}`;window.localStorage.setItem(Z,JSON.stringify(le))}else{const ve=(ne=(await ee.post("/purchase/supplier-quotations",Ie)).data)==null?void 0:ne.id;if(ve){const Ue=`supplierQuoteExtras:${ve}`;window.localStorage.setItem(Ue,JSON.stringify(le))}}s("/purchase/supplier-quotations")}catch(ce){S(((oe=(te=ce==null?void 0:ce.response)==null?void 0:te.data)==null?void 0:oe.message)||"Failed to save supplier quotation")}finally{j(!1)}},w=async X=>{var ne,te,oe,ce;U(!0);try{const re=new FormData;re.append("file",X);const de=await ee.post("/upload",re,{headers:{"Content-Type":"multipart/form-data"}}),Ie=(ne=de.data)==null?void 0:ne.url,le=((te=de.data)==null?void 0:te.filename)||X.name;Ie&&P(Z=>[...Z,{url:Ie,filename:le}])}catch(re){S(((ce=(oe=re==null?void 0:re.response)==null?void 0:oe.data)==null?void 0:ce.message)||"File upload failed")}finally{U(!1)}},O=async X=>{const ne=Array.from(X.target.files||[]);for(const te of ne)await w(te);X.target.value=""},R=X=>{P(ne=>ne.filter((te,oe)=>oe!==X))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[r?"Edit":"New"," Supplier Quotation"]}),e.jsx("p",{className:"text-sm mt-1",children:r?"Update quotation details":"Record a new supplier quotation"})]}),e.jsx(Le,{to:"/purchase/supplier-quotations",className:"btn-success",children:"Back to List"})]}),e.jsxs("form",{onSubmit:E,children:[v?e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-body",children:"Loading..."})}):null,N?e.jsx("div",{className:"card mb-6",children:e.jsx("div",{className:"card-body text-red-600",children:N})}):null,e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Quotation Information"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quotation No *"}),e.jsx("input",{type:"text",name:"quotation_no",className:"input",value:a.quotation_no,onChange:Y,placeholder:"Auto-generated",disabled:r,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quotation Date *"}),e.jsx("input",{type:"date",name:"quotation_date",className:"input",value:a.quotation_date,onChange:Y,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{name:"supplier_id",className:"input",value:a.supplier_id,onChange:Y,disabled:H.length>1,required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),o.map(X=>e.jsx("option",{value:X.id,children:X.supplier_name||X.name||X.supplier_code||`Supplier #${X.id}`},X.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"RFQ No"}),e.jsxs("select",{name:"rfq_id",className:"input",value:a.rfq_id,onChange:Y,children:[e.jsx("option",{value:"",children:"Select RFQ"}),d.map(X=>e.jsxs("option",{value:X.id,children:[X.rfq_no," ",X.status?`- ${X.status}`:""]},X.id))]})]}),H.length>1&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"RFQ Supplier"}),e.jsxs("select",{className:"input",value:a.supplier_id,onChange:X=>{const ne=X.target.value,te=H.find(oe=>String(oe.supplier_id)===String(ne));n(oe=>({...oe,supplier_id:ne,contact_person:(te==null?void 0:te.supplier_name)||oe.contact_person,email:(te==null?void 0:te.email)||oe.email,phone:(te==null?void 0:te.phone)||oe.phone}))},children:[e.jsx("option",{value:"",children:"Select Supplier from RFQ"}),H.map(X=>e.jsx("option",{value:X.supplier_id,children:X.supplier_name},X.supplier_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Valid Until *"}),e.jsx("input",{type:"date",name:"valid_until",className:"input",value:a.valid_until,onChange:Y,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{name:"status",className:"input",value:a.status,onChange:Y,children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"SUBMITTED",children:"SUBMITTED"})]})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{name:"remarks",className:"input",rows:"3",value:a.remarks,onChange:Y,placeholder:"Additional notes..."})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Supplier & Contact"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Person"}),e.jsx("input",{type:"text",name:"contact_person",className:"input",value:a.contact_person,onChange:Y,placeholder:"Enter contact person name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:"input",value:a.email,onChange:Y,placeholder:"email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",className:"input",value:a.phone,onChange:Y,placeholder:"+233-000-000-0000"})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Terms"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{name:"currency",className:"input",value:a.currency,onChange:Y,children:[e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"GHS",children:"GHS - Ghana Cedi"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{type:"number",name:"exchange_rate",className:"input text-right",value:a.exchange_rate,onChange:Y,step:"0.000001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsxs("select",{name:"payment_terms",className:"input",value:a.payment_terms,onChange:Y,children:[e.jsx("option",{value:"Net30",children:"Net 30 days"}),e.jsx("option",{value:"Net60",children:"Net 60 days"}),e.jsx("option",{value:"Advance50",children:"50% Advance"}),e.jsx("option",{value:"COD",children:"Cash on Delivery"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Time"}),e.jsx("input",{type:"text",name:"delivery_time",className:"input",value:a.delivery_time,onChange:Y,placeholder:"e.g., 2-3 weeks"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Delivery Terms"}),e.jsxs("select",{name:"delivery_terms",className:"input",value:a.delivery_terms,onChange:Y,children:[e.jsx("option",{value:"FOB",children:"FOB"}),e.jsx("option",{value:"CIF",children:"CIF"}),e.jsx("option",{value:"EXW",children:"EXW"}),e.jsx("option",{value:"DDP",children:"DDP"})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-WHITE dark:text-slate-100",children:"Quotation Items"}),e.jsx("button",{type:"button",onClick:T,className:"btn-success",children:"+ Add Item"})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"30%"},children:"Item"}),e.jsx("th",{className:"text-right",style:{width:"10%"},children:"Quantity"}),e.jsx("th",{className:"text-right",style:{width:"15%"},children:"Unit Price"}),e.jsx("th",{className:"text-right",style:{width:"15%"},children:"Tax"}),e.jsx("th",{className:"text-right",style:{width:"15%"},children:"Line Total"}),e.jsx("th",{style:{width:"15%"},children:"Delivery Date"}),e.jsx("th",{style:{width:"10%"},children:"Action"})]})}),e.jsx("tbody",{children:i.map((X,ne)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:X.item_id,onChange:te=>J(ne,"item_id",te.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),h.map(te=>e.jsx("option",{value:te.id,children:(te.item_code||te.code||te.id)+" - "+(te.item_name||te.name||"")},te.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right",value:X.qty,onChange:te=>J(ne,"qty",te.target.value),step:"1",min:"0",required:!0})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right",value:X.unit_price,onChange:te=>J(ne,"unit_price",te.target.value),step:"1",min:"0",required:!0})}),e.jsx("td",{children:e.jsxs("select",{className:"input text-right",value:X.tax_percent,onChange:te=>J(ne,"tax_percent",te.target.value),children:[e.jsx("option",{value:0,children:"No Tax"}),f.map(te=>e.jsxs("option",{value:te.rate_percent,children:[te.code," - ",te.name," (",Number(te.rate_percent).toFixed(2),"%)"]},te.id))]})}),e.jsx("td",{className:"text-right font-medium",children:X.line_total.toFixed(2)}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"input",value:X.delivery_date,onChange:te=>J(ne,"delivery_date",te.target.value)})}),e.jsx("td",{children:e.jsx("button",{type:"button",onClick:()=>k(ne),className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-sm font-medium",disabled:i.length===1,children:"Remove"})})]},ne))})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Summary"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-7",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{className:"font-semibold",children:D.toFixed(2)})]}),e.jsxs("div",{className:"flex items-center gap-2 justify-center flex-1",children:[e.jsx("div",{children:"Total Tax"}),e.jsx("div",{className:"font-semibold",children:Q.toFixed(2)})]}),e.jsx("div",{className:"flex-1"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Shipping Cost"}),e.jsx("div",{children:e.jsx("input",{type:"number",className:"input w-32",value:a.shipping_cost,onChange:X=>n(ne=>({...ne,shipping_cost:X.target.value})),step:"1",min:"0"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:"Discount (%)"}),e.jsx("div",{children:e.jsx("input",{type:"number",className:"input w-32",value:a.discount_percent,onChange:X=>n(ne=>({...ne,discount_percent:X.target.value})),step:"1",min:"0"})})]}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-4 md:col-span-2 lg:col-span-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Grand Total"}),e.jsx("div",{className:"text-lg font-bold",children:C.toFixed(2)})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("h2",{className:"text-lg font-semibold text-white dark:text-slate-100",children:"Supporting Documents"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"file",className:"input",onChange:O,multiple:!0}),e.jsx("span",{className:"text-sm",children:L?"Uploading...":"Attach PDF, DOCX, XLSX, images"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Filename"}),e.jsx("th",{children:"Link"}),e.jsx("th",{children:"Note"}),e.jsx("th",{className:"text-right",children:"Action"})]})}),e.jsxs("tbody",{children:[B.length?null:e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-6 text-slate-500 dark:text-slate-400",children:"No attachments"})}),B.map((X,ne)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:X.filename}),e.jsx("td",{children:e.jsx("a",{href:X.url,target:"_blank",rel:"noreferrer",className:"text-brand hover:text-brand-700",children:"View"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input",value:X.note||"",onChange:te=>P(oe=>oe.map((ce,re)=>re===ne?{...ce,note:te.target.value}:ce)),placeholder:"Optional note"})}),e.jsx("td",{className:"text-right",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>R(ne),children:"Remove"})})]},`${X.url}-${ne}`))]})]})})]})})]}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx(Le,{to:"/purchase/supplier-quotations",className:"btn-success",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-success",children:[y?"Saving...":r?"Update":"Create"," Quotation"]})]})]})]})}function hJ(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState([]),[c,h]=x.useState(null),[A,f]=x.useState("comparison");x.useEffect(()=>{let B=!0;return a(!0),o(""),ee.get("/purchase/rfqs").then(P=>{var L;B&&d(Array.isArray((L=P.data)==null?void 0:L.items)?P.data.items:[])}).catch(P=>{var L,U;B&&o(((U=(L=P==null?void 0:P.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to load RFQs")}).finally(()=>{B&&a(!1)}),()=>{B=!1}},[]);const g=async()=>{var B,P;if(t){i(!0),o("");try{const L=await ee.get("/purchase/quotation-analysis",{params:{rfq_no:t}});h(L.data)}catch(L){o(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to load quotation analysis"),h(null)}finally{i(!1)}}},v=x.useMemo(()=>{if(!(c!=null&&c.items))return[];const B=new Set;return c.items.forEach(P=>{P.suppliers.forEach(L=>B.add(L.supplier))}),Array.from(B)},[c]),b=B=>!B.suppliers||B.suppliers.length===0?1/0:Math.min(...B.suppliers.map(P=>P.unit_price)),y=(B,P)=>B.suppliers.find(L=>L.supplier===P),j=B=>c!=null&&c.items?c.items.reduce((P,L)=>{const U=y(L,B);return P+(U?U.total:0)},0):0,S=u.find(B=>B.rfq_no===t)||{};return e.jsxs("div",{className:"quotation-analysis-container",children:[e.jsx("style",{children:`
        :root {
            --primary: #0E3646;
            --primary-dark: #082330;
            --primary-light: #1a5570;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
            --light: #f8f9fa;
            --border: #dee2e6;
        }

        .quotation-analysis-container {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #fff;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 30px;
            border-radius: 12px 12px 0 0;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: var(--light);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
            gap: 15px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(14, 54, 70, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-info {
            background: var(--info);
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .form-content {
            padding: 30px;
        }

        .form-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 13px;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 6px;
        }

        .form-control {
            padding: 10px 12px;
            border: 1px solid var(--border);
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .comparison-table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .comparison-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            background: white;
            min-width: 1200px;
        }

        .comparison-table thead th {
            background: var(--primary);
            color: white;
            padding: 15px;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            text-align: left;
        }

        .comparison-table tbody td {
            padding: 12px;
            border-bottom: 1px solid var(--border);
            border-right: 1px solid var(--border);
            vertical-align: top;
        }

        .comparison-table tbody td:last-child {
            border-right: none;
        }

        .supplier-column {
            min-width: 220px;
            background: #f8f9fa;
        }

        .price-cell {
            font-weight: 600;
            font-size: 15px;
            color: var(--primary);
        }

        .best-price {
            background: #d4edda !important;
            position: relative;
        }

        .best-price::after {
            content: " Best";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 10px;
            background: var(--success);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 600;
        }
        
        .tabs {
            display: flex;
            gap: 0;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s;
            font-size: 14px;
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(14, 54, 70, 0.05);
        }

        .info-card {
            background: #e7f3ff;
            border-left: 4px solid var(--info);
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .supplier-info-card {
            background: white;
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            transition: all 0.3s;
        }

        .supplier-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .supplier-name-large {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .stat-row {
            display: flex;
            gap: 30px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: #6c757d;
            font-weight: 600;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--primary);
        }
        
        .score-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 12px;
        }
        
        .score-excellent { background: #d4edda; color: #155724; }
        .score-good { background: #d1ecf1; color: #0c5460; }
        .score-average { background: #fff3cd; color: #856404; }

      `}),e.jsxs("div",{className:"container mx-auto bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"header",children:[e.jsx("h1",{children:" Quotation Analysis & Comparison"}),e.jsx("p",{children:"Compare supplier quotations and select the best offer"})]}),e.jsxs("div",{className:"toolbar",children:[e.jsx("div",{className:"form-group",style:{maxWidth:"300px",margin:0},children:e.jsxs("select",{className:"form-control",value:t,onChange:B=>s(B.target.value),children:[e.jsx("option",{value:"",children:"Select RFQ"}),u.map(B=>e.jsxs("option",{value:B.rfq_no,children:[B.rfq_no," -"," ",B.description||B.status||"No Description"]},B.id))]})}),e.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-info",onClick:g,disabled:!t||n,children:n?"Loading...":" Generate Report"}),e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Back to Purchase"})]})]}),e.jsxs("div",{className:"form-content",children:[t&&e.jsxs("div",{className:"form-section",children:[e.jsx("div",{className:"section-title",children:" RFQ Details"}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"RFQ Number"}),e.jsx("input",{type:"text",className:"form-control",value:S.rfq_no||"",readOnly:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"RFQ Date"}),e.jsx("input",{type:"text",className:"form-control",value:S.rfq_date?bh(new Date(S.rfq_date),"yyyy-MM-dd"):"",readOnly:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Status"}),e.jsx("input",{type:"text",className:"form-control",value:S.status||"",readOnly:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Expiry Date"}),e.jsx("input",{type:"text",className:"form-control",value:S.expiry_date?bh(new Date(S.expiry_date),"yyyy-MM-dd"):"",readOnly:!0})]})]})]}),l&&e.jsx("div",{className:"p-4 text-red-600 bg-red-50 rounded mb-4",children:l}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"info-card",children:e.jsxs("p",{children:[e.jsx("strong",{children:" Analysis Status:"})," Quotations loaded. Review the comparison below to make your selection."]})}),e.jsxs("div",{className:"tabs",children:[e.jsx("button",{className:`tab ${A==="comparison"?"active":""}`,onClick:()=>f("comparison"),children:" Price Comparison"}),e.jsx("button",{className:`tab ${A==="detailed"?"active":""}`,onClick:()=>f("detailed"),children:" Detailed Analysis"}),e.jsx("button",{className:`tab ${A==="scoring"?"active":""}`,onClick:()=>f("scoring"),children:" Scoring Matrix"})]}),A==="comparison"&&e.jsx("div",{className:"tab-content active",children:e.jsx("div",{className:"comparison-table-container",children:e.jsxs("table",{className:"comparison-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{minWidth:"250px"},children:"Item Details"}),v.map(B=>e.jsx("th",{className:"supplier-column",children:B},B))]})}),e.jsxs("tbody",{children:[c.items.map((B,P)=>{const L=b(B);return e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("strong",{children:B.item_name}),e.jsx("br",{}),e.jsx("small",{style:{color:"#6c757d"},children:B.item_code}),e.jsx("br",{}),e.jsxs("small",{style:{color:"#6c757d"},children:["Qty: ",B.qty," ",B.uom||"Units"]})]}),v.map(U=>{const H=y(B,U);if(!H)return e.jsx("td",{children:"-"},U);const q=H.unit_price===L;return e.jsxs("td",{className:`price-cell ${q?"best-price":""}`,children:[e.jsxs("div",{style:{fontSize:"16px",marginBottom:"5px"},children:["$",H.unit_price.toFixed(2)]}),e.jsxs("div",{style:{color:"#6c757d",fontWeight:"normal",fontSize:"13px"},children:["Subtotal: $",H.total.toFixed(2)]}),e.jsxs("div",{style:{marginTop:"5px",color:"var(--primary)"},children:["Total: $",H.total.toFixed(2)]}),e.jsx("div",{style:{marginTop:"8px",fontSize:"12px",fontWeight:"normal"},children:e.jsxs("div",{style:{color:"#28a745"},children:[" ",H.delivery_days," days delivery"]})})]},U)})]},P)}),e.jsxs("tr",{style:{background:"var(--primary)",color:"white",fontWeight:700,fontSize:"15px"},children:[e.jsx("td",{children:"GRAND TOTAL"}),v.map(B=>e.jsxs("td",{children:["$",j(B).toLocaleString("en-US",{minimumFractionDigits:2})]},B))]})]})]})})}),A==="detailed"&&e.jsx("div",{className:"tab-content active",children:v.map((B,P)=>e.jsxs("div",{className:"supplier-info-card",children:[e.jsxs("div",{className:"supplier-header",children:[e.jsx("span",{className:"supplier-name-large",children:B}),e.jsx("span",{className:"score-badge score-good",children:"Score: TBD"})]}),e.jsxs("div",{className:"stat-row",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Total Quoted"}),e.jsxs("span",{className:"stat-value",children:["$",j(B).toLocaleString()]})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-label",children:"Status"}),e.jsx("span",{className:"stat-value",children:"Active"})]})]})]},P))}),A==="scoring"&&e.jsx("div",{className:"tab-content active",children:e.jsx("div",{className:"comparison-table-container",children:e.jsxs("table",{className:"comparison-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{minWidth:"250px"},children:"Criteria"}),e.jsx("th",{style:{width:"120px"},children:"Weight"}),v.map(B=>e.jsx("th",{className:"supplier-column",children:B},B))]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Price Competitiveness"})}),e.jsx("td",{children:"40%"}),v.map(B=>e.jsx("td",{children:"-"},B))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Delivery Speed"})}),e.jsx("td",{children:"30%"}),v.map(B=>e.jsx("td",{children:"-"},B))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Quality / Specs"})}),e.jsx("td",{children:"20%"}),v.map(B=>e.jsx("td",{children:"-"},B))]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:"Payment Terms"})}),e.jsx("td",{children:"10%"}),v.map(B=>e.jsx("td",{children:"-"},B))]}),e.jsxs("tr",{style:{background:"#f8f9fa",fontWeight:600},children:[e.jsx("td",{children:e.jsx("strong",{children:"TOTAL SCORE"})}),e.jsx("td",{children:"100%"}),v.map(B=>e.jsx("td",{children:"-"},B))]})]})]})})})]})]})]})]})}function mJ(){const[t,s]=x.useState(""),[r,a]=x.useState("ALL"),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState(!1),[A,f]=x.useState(!1),[g,v]=x.useState(""),[b,y]=x.useState(null),[j,N]=x.useState([]),[S,B]=x.useState(null),[P,L]=x.useState(null),[U,H]=x.useState(null),[q,V]=x.useState(!1),[M,z]=x.useState(null);x.useEffect(()=>{let D=!0;return o(!0),d(""),ee.get("/purchase/orders").then(Q=>{var E;if(!D)return;const C=Array.isArray((E=Q.data)==null?void 0:E.items)?Q.data.items:[];i(C.filter(w=>String(w.po_type||"").toUpperCase()==="LOCAL"))}).catch(Q=>{var C,E;D&&d(((E=(C=Q==null?void 0:Q.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to load purchase orders")}).finally(()=>{D&&o(!1)}),()=>{D=!1}},[]);const I=D=>({DRAFT:"badge-warning",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-info",RECEIVED:"badge-success",RETURNED:"badge-error",CANCELLED:"badge-error"})[D]||"badge-info",G=x.useMemo(()=>n.filter(D=>{const Q=String(D.po_no||"").toLowerCase().includes(t.toLowerCase())||String(D.supplier_name||"").toLowerCase().includes(t.toLowerCase()),C=r==="ALL"||D.status===r;return Q&&C}),[n,t,r]),Y=async D=>{var Q,C,E;if(z(D),h(!0),v(""),P)await J();else try{f(!0);const w=await ee.get("/workflows"),O=Array.isArray((Q=w.data)==null?void 0:Q.items)?w.data.items:[];L(O),await T(O)}catch(w){v(((E=(C=w==null?void 0:w.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to load workflows")}finally{f(!1)}},J=async()=>{var E,w,O;if(!P||!P.length){y(null),B(null),v("");return}const D="/purchase/purchase-orders-local",Q=R=>String(R||"").trim().toUpperCase().replace(/\s+/g,"_"),C=P.find(R=>Number(R.is_active)===1&&String(R.document_route)===D)||P.find(R=>Number(R.is_active)===1&&Q(R.document_type)==="PURCHASE_ORDER")||null;if(y(C||null),B(null),!!C)try{f(!0);const X=(E=(await ee.get(`/workflows/${C.id}`)).data)==null?void 0:E.item,ne=Array.isArray(X==null?void 0:X.steps)?X.steps:[];N(ne);const te=ne[0]||null;if(B(te?{userId:te.approver_user_id,name:te.approver_name,stepName:te.step_name,stepOrder:te.step_order,approvalLimit:te.approval_limit}:null),te){const oe=(Array.isArray(te.approvers)&&te.approvers.length?te.approvers[0].id:te.approver_user_id)||null;H(oe)}else H(null)}catch(R){v(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load workflow details")}finally{f(!1)}},T=async D=>{var w,O,R;if(!D||!D.length){y(null),B(null),v("");return}const Q="/purchase/purchase-orders-local",C=X=>String(X||"").trim().toUpperCase().replace(/\s+/g,"_"),E=D.find(X=>Number(X.is_active)===1&&String(X.document_route)===Q)||D.find(X=>Number(X.is_active)===1&&C(X.document_type)==="PURCHASE_ORDER")||null;if(y(E||null),B(null),!!E)try{f(!0);const ne=(w=(await ee.get(`/workflows/${E.id}`)).data)==null?void 0:w.item,te=Array.isArray(ne==null?void 0:ne.steps)?ne.steps:[];N(te);const oe=te[0]||null;if(B(oe?{userId:oe.approver_user_id,name:oe.approver_name,stepName:oe.step_name,stepOrder:oe.step_order,approvalLimit:oe.approval_limit}:null),oe){const ce=(Array.isArray(oe.approvers)&&oe.approvers.length?oe.approvers[0].id:oe.approver_user_id)||null;H(ce)}else H(null)}catch(X){v(((R=(O=X==null?void 0:X.response)==null?void 0:O.data)==null?void 0:R.message)||"Failed to load workflow details")}finally{f(!1)}},k=async()=>{var E,w,O;if(!M)return;const Q=Array.isArray(j)&&j.length>0?j[0]:null,C=Q?Array.isArray(Q.approvers)&&Q.approvers.length?Q.approvers:Q.approver_user_id?[{id:Q.approver_user_id}]:[]:[];if(b&&C.length>0&&!U){v("Please select target approver");return}V(!0),v("");try{const R=await ee.post(`/purchase/orders/${M.id}/submit`,{amount:M.total_amount===void 0||M.total_amount===null?null:Number(M.total_amount||0),workflow_id:b?b.id:null,target_user_id:U||null}),X=((E=R==null?void 0:R.data)==null?void 0:E.status)||"PENDING_APPROVAL";i(ne=>ne.map(te=>te.id===M.id?{...te,status:X}:te)),h(!1),z(null)}catch(R){v(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to forward for approval")}finally{V(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Purchase Orders - Local"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage local purchase orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/purchase-orders-local/new",className:"btn-success",children:"+ New Purchase Order"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by PO no or supplier...",className:"input",value:t,onChange:D=>s(D.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:D=>a(D.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"PENDING_APPROVAL",children:"Pending Approval"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"RECEIVED",children:"Received"}),e.jsx("option",{value:"RETURNED",children:"Returned"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"PO Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{className:"text-right",children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:u})}):null,G.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No purchase orders found"})}):G.map(D=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:D.po_no}),e.jsx("td",{children:D.po_date?new Date(D.po_date).toLocaleDateString():""}),e.jsx("td",{children:D.supplier_name}),e.jsx("td",{className:"text-right font-medium",children:Number(D.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${I(D.status)}`,children:D.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/purchase/purchase-orders-local/${D.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),D.status==="DRAFT"&&e.jsx(Le,{to:`/purchase/purchase-orders-local/${D.id}/edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"}),D.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):D.status==="DRAFT"||D.status==="RETURNED"?e.jsx("button",{type:"button",className:"text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",onClick:()=>Y(D),children:"Forward for Approval"}):null]})})]},D.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",G.length," of ",n.length," orders"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]}),c?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Purchase Order for Approval"}),e.jsx("button",{type:"button",onClick:()=>{h(!1),y(null),B(null),v(""),z(null)},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:(M==null?void 0:M.po_no)||""})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:b?`${b.workflow_name} (${b.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:A?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm text-red-600",children:g}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Q=Array.isArray(j)&&j.length>0?j[0]:null,C=Q?Array.isArray(Q.approvers)&&Q.approvers.length?Q.approvers.map(E=>({id:E.id,name:E.username})):Q.approver_user_id?[{id:Q.approver_user_id,name:Q.approver_name||String(Q.approver_user_id)}]:[]:[];return C.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:U||"",onChange:E=>H(E.target.value?Number(E.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),C.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:b?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{h(!1),y(null),B(null),v(""),z(null)},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:k,disabled:q||!M||Array.isArray(j)&&j.length>0&&b&&!U,children:q?"Forwarding...":"Forward"})]})]})}):null]})}function mb(){var Ze,ht;const{id:t}=Ls(),s=ma(),r=ys(),{user:a}=ca(),n=!t||t==="new",i=!!t&&t!=="new"&&(s.pathname.includes("/edit")||(()=>{try{const ze=new URLSearchParams(s.search||""),Fe=String(ze.get("mode")||"").toLowerCase(),xe=String(ze.get("edit")||"").toLowerCase();return Fe==="edit"||xe==="1"||xe==="true"}catch{return!1}})()),[l,o]=x.useState(!1),[u,d]=x.useState(!1),[c,h]=x.useState(""),[A,f]=x.useState(!1),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState(null),[S,B]=x.useState(null),[P,L]=x.useState([]),[U,H]=x.useState(!1),[q,V]=x.useState(null),[M,z]=x.useState(null),[I,G]=x.useState([]),[Y,J]=x.useState([]),[T,k]=x.useState([]),[D,Q]=x.useState([]),[C,E]=x.useState([]),[w,O]=x.useState([]),[R,X]=x.useState([]),[ne,te]=x.useState([]),[oe,ce]=x.useState([]),re=x.useRef(null),[de,Ie]=x.useState({po_no:"",po_date:new Date().toISOString().split("T")[0],supplier_id:"",quotation_id:"",po_type:"LOCAL",status:"DRAFT",warehouse_id:"",currency:"GHS",exchange_rate:1,delivery_date:"",payment_terms:30,remarks:"",port_loading:"",port_discharge:"",incoterms:"",hs_code:"",shipping_date:"",insurance_required:!1,freight_amount:0,other_charges:0,discount_amount:0,tax_amount:0,terms_conditions:`1. All goods must meet specified quality standards
2. Delivery to be made as per schedule
3. Payment terms: Net 30 days from delivery
4. Supplier responsible for any defects within warranty period
5. Late delivery penalties may apply as per agreement
6. All disputes subject to arbitration in Accra, Ghana`}),[le,Z]=x.useState([{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]),[ve,Ue]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""}),[Be,_e]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowIdx:null}),{uoms:Me}=el(),Ye=x.useMemo(()=>{const ze=Array.isArray(Me)?Me:[],Fe=ze.find(xe=>String(xe.uom_code||"").toUpperCase()==="PCS")||ze[0];return Fe&&Fe.uom_code?Fe.uom_code:"PCS"},[Me]);x.useEffect(()=>{let ze=!0;async function Fe(){var xe,we,Xe,ut,ft,mt,pt;try{const[vt,Ot,Ae,je,We]=await Promise.allSettled([ee.get("/purchase/suppliers"),ee.get("/inventory/warehouses"),ee.get("/inventory/items"),ee.get("/purchase/quotations"),ee.get("/inventory/unit-conversions")]);if(!ze)return;if(vt.status==="fulfilled"&&G(Array.isArray((xe=vt.value.data)==null?void 0:xe.items)?vt.value.data.items:[]),Ot.status==="fulfilled"&&J(Array.isArray((we=Ot.value.data)==null?void 0:we.items)?Ot.value.data.items:[]),Ae.status==="fulfilled"&&k(Array.isArray((Xe=Ae.value.data)==null?void 0:Xe.items)?Ae.value.data.items:[]),je.status==="fulfilled"){const De=Array.isArray((ut=je.value.data)==null?void 0:ut.items)?je.value.data.items:[];E(De);const lt=String(de.supplier_id||""),rt=lt&&lt.length?De.filter(et=>String(et.supplier_id)===String(lt)):[];Q(rt)}We.status==="fulfilled"&&te(Array.isArray((ft=We.value.data)==null?void 0:ft.items)?We.value.data.items:[])}catch(vt){if(!ze)return;h(((pt=(mt=vt==null?void 0:vt.response)==null?void 0:mt.data)==null?void 0:pt.message)||"Failed to load lookups")}}return Fe(),()=>{ze=!1}},[]);const ot=()=>{window.print()},Ke=async()=>{const ze=re.current;if(!ze)return;const Fe=ze.style.cssText;ze.style.cssText=Fe+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const xe=await Ai(ze,{scale:2,useCORS:!0}),we=xe.toDataURL("image/png"),Xe=new ds("p","mm","a4"),ut=Xe.internal.pageSize.getWidth(),ft=Xe.internal.pageSize.getHeight(),mt=ut,pt=xe.height*mt/xe.width;let vt=0;for(;vt<pt;)Xe.addImage(we,"PNG",0,-vt,mt,pt),vt+=ft,vt<pt&&Xe.addPage();const Ot="PurchaseOrder_"+(de.po_no||new Date().toISOString().slice(0,10))+".pdf";Xe.save(Ot)}finally{ze.style.cssText=Fe}};x.useEffect(()=>{let ze=!0;async function Fe(){var xe;try{const we=await ee.get("/finance/currencies");if(!ze)return;const Xe=Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[];O(Xe)}catch{}}return Fe(),()=>{ze=!1}},[]),x.useEffect(()=>{async function ze(){var Fe;try{const xe=Array.isArray(w)?w:[];if(!xe.length)return;const we=xe.find(pt=>String(pt.is_base)==="1"||pt.is_base===1||pt.is_base===!0)||xe.find(pt=>String(pt.code||pt.currency_code||"").toUpperCase()==="GHS")||xe.find(pt=>/ghana|cedi/i.test(String(pt.name||pt.currency_name||""))),Xe=xe.find(pt=>String(pt.code||pt.currency_code||"").toUpperCase()==="USD");if(!we||!Xe||we.id===Xe.id)return;const ut=de.po_date||new Date().toISOString().split("T")[0],ft=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Xe.id,toCurrencyId:we.id,to:ut}});if(!(Array.isArray((Fe=ft.data)==null?void 0:Fe.items)?ft.data.items:[]).length)try{await ee.post("/finance/currency-rates",{fromCurrencyId:Xe.id,toCurrencyId:we.id,rate:1,rateDate:ut})}catch{}}catch{}}ze()},[w,de.po_date]),x.useEffect(()=>{let ze=!0;async function Fe(){var xe;try{const we=await ee.get("/sales/prices/standard");if(!ze)return;const Xe=Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[];X(Xe)}catch{}}return Fe(),()=>{ze=!1}},[]),x.useEffect(()=>{let ze=!0;async function Fe(){var xe;try{const we=await ee.get("/finance/tax-codes");if(!ze)return;const ut=(Array.isArray((xe=we.data)==null?void 0:xe.items)?we.data.items:[]).map(ft=>({value:ft.id,label:ft.name,rate:Number(ft.rate_percent)}));ce(ut)}catch{}}return Fe(),()=>{ze=!1}},[]);const ct=async ze=>{var ut;const Fe=String(ze||"").toUpperCase(),xe=Array.isArray(w)?w:[];if(!Fe||!xe.length)return;const we=xe.find(ft=>String(ft.is_base)==="1"||ft.is_base===1||ft.is_base===!0)||xe.find(ft=>String(ft.code||ft.currency_code||"").toUpperCase()==="GHS")||xe.find(ft=>/ghana|cedi/i.test(String(ft.name||ft.currency_name||""))),Xe=xe.find(ft=>String(ft.code||ft.currency_code||"").toUpperCase()===Fe);if(!we||!Xe||we.id===Xe.id){Ie(ft=>({...ft,exchange_rate:1}));return}try{const ft=de.po_date||new Date().toISOString().split("T")[0],mt=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Xe.id,toCurrencyId:we.id,to:ft}}),vt=(Array.isArray((ut=mt.data)==null?void 0:ut.items)?mt.data.items:[])[0];if(vt&&vt.rate)Ie(Ot=>({...Ot,exchange_rate:Number(vt.rate)||Ot.exchange_rate||1}));else try{await ee.post("/finance/currency-rates",{fromCurrencyId:Xe.id,toCurrencyId:we.id,rate:1,rateDate:ft}),Ie(Ot=>({...Ot,exchange_rate:1}))}catch{Ie(Ot=>({...Ot,exchange_rate:1}))}}catch{}};x.useEffect(()=>{ct(de.currency)},[w,de.currency,de.po_date]),x.useEffect(()=>{if(i)return;let ze=!0;return ee.get("/purchase/orders/next-no",{params:{po_type:de.po_type||"LOCAL"}}).then(Fe=>{var xe;if(ze&&(xe=Fe.data)!=null&&xe.nextNo){const we=String(Fe.data.nextNo||""),Xe=we.replace(/^PO-/i,"LP-"),ut=Xe.toUpperCase().startsWith("LP-")?Xe:`LP-${we.replace(/^LP-/i,"")}`;Ie(ft=>({...ft,po_no:ft.po_no||ut}))}}).catch(Fe=>console.error("Failed to load next purchase order number",Fe)),()=>{ze=!1}},[i,de.po_type]),x.useEffect(()=>{xt()},[]);async function xt(){var ze,Fe,xe;try{const Xe=(Fe=(ze=(await ee.get("/admin/me")).data)==null?void 0:ze.scope)==null?void 0:Fe.companyId;if(Xe){const ft=((xe=(await ee.get(`/admin/companies/${Xe}`)).data)==null?void 0:xe.item)||{};Ue(mt=>({...mt,name:ft.name||mt.name||"",address:ft.address||mt.address||"",phone:ft.telephone||mt.phone||"",email:ft.email||mt.email||"",city:ft.city||mt.city||"",state:ft.state||mt.state||"",country:ft.country||mt.country||"",logoUrl:ft.has_logo===1||ft.has_logo===!0?`/api/admin/companies/${Xe}/logo`:qs}))}else Ue(ut=>({...ut,logoUrl:ut.logoUrl||qs}))}catch{Ue(we=>({...we,logoUrl:we.logoUrl||qs}))}}x.useEffect(()=>{if(n)return;let ze=!0;return o(!0),h(""),ee.get(`/purchase/orders/${t}`).then(Fe=>{var Xe,ut,ft;if(!ze)return;const xe=(Xe=Fe.data)==null?void 0:Xe.item,we=Array.isArray((ft=(ut=Fe.data)==null?void 0:ut.item)==null?void 0:ft.details)?Fe.data.item.details:[];xe&&(Ie({po_no:xe.po_no||"",po_date:xe.po_date||new Date().toISOString().split("T")[0],supplier_id:xe.supplier_id?String(xe.supplier_id):"",po_type:xe.po_type||"LOCAL",status:xe.status||"DRAFT",warehouse_id:xe.warehouse_id?String(xe.warehouse_id):"",currency:xe.currency||"GHS",exchange_rate:Number(xe.exchange_rate)||1,delivery_date:xe.delivery_date||"",payment_terms:xe.payment_terms||30,remarks:xe.remarks||"",port_loading:xe.port_loading||"",port_discharge:xe.port_discharge||"",incoterms:xe.incoterms||"",hs_code:xe.hs_code||"",shipping_date:xe.shipping_date||"",insurance_required:!!xe.insurance_required,freight_amount:Number(xe.freight_amount)||0,other_charges:Number(xe.other_charges)||0,discount_amount:Number(xe.discount_amount)||0,tax_amount:Number(xe.tax_amount)||0,terms_conditions:xe.terms_conditions||de.terms_conditions}),Z(we.length?we.filter(mt=>mt).map(mt=>({item_id:mt.item_id?String(mt.item_id):"",qty:Number(mt.qty)||0,uom:mt.uom||"",unit_price:Number(mt.unit_price)||0,discount_percent:Number(mt.discount_percent)||0,tax_percent:Number(mt.tax_percent)||0,line_total:Number(mt.line_total)||0})):[{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]))}).catch(Fe=>{var xe,we;ze&&h(((we=(xe=Fe==null?void 0:Fe.response)==null?void 0:xe.data)==null?void 0:we.message)||"Failed to load purchase order")}).finally(()=>{ze&&o(!1)}),()=>{ze=!1}},[t]);const be=x.useMemo(()=>{let ze=0,Fe=0,xe=0;le.forEach(ft=>{if(!ft)return;const mt=Number(ft.qty)||0,pt=Number(ft.unit_price)||0,vt=Number(ft.discount_percent)||0,Ot=Number(ft.tax_percent)||0,Ae=mt*pt,je=Ae*(vt/100),De=(Ae-je)*(Ot/100);ze+=Ae,Fe+=je,xe+=De});const we=Number(de.freight_amount)||0,Xe=Number(de.other_charges)||0,ut=ze-Fe+xe+we+Xe;return{subTotal:ze,totalDiscount:Fe,totalTax:xe,freight:we,other:Xe,grandTotal:ut}},[le,de.freight_amount,de.other_charges]),Ce=async ze=>{var ut,ft;const{name:Fe,value:xe,type:we,checked:Xe}=ze.target;if(Ie(mt=>({...mt,[Fe]:we==="checkbox"?Xe:xe})),Fe==="supplier_id"){const mt=String(xe||"");if(mt){const pt=(Array.isArray(C)?C:[]).filter(vt=>String(vt.supplier_id)===mt);Q(pt),Ie(vt=>{const Ot=pt.some(Ae=>String(Ae.id)===String(vt.quotation_id||""));return{...vt,quotation_id:Ot?vt.quotation_id:""}});try{const vt=I.find(Ae=>String(Ae.id)===mt),Ot=vt&&vt.supplier_code&&String(vt.supplier_code).trim()||(vt?`SU-${String(Number(vt.id||0)).padStart(6,"0")}`:"");if(Ot){const Ae=await ee.get("/finance/accounts",{params:{search:Ot}}),je=Array.isArray((ut=Ae.data)==null?void 0:ut.items)?Ae.data.items:[],We=je.find(lt=>String(lt.code)===Ot)||je[0]||null,De=We&&(We.currency_code||We.currency||We.currencyCode)||null;if(De){const lt=String(De).toUpperCase();Ie(rt=>({...rt,currency:lt})),await ct(lt)}}}catch{}}else Q(Array.isArray(C)?C:[])}if(Fe==="quotation_id"&&xe)try{const pt=(ft=(await ee.get(`/purchase/quotations/${xe}`)).data)==null?void 0:ft.item;if(pt){const Ot=(Array.isArray(w)?w:[]).find(De=>String(De.id)===String(pt.currency_id||"")),Ae=String((Ot==null?void 0:Ot.code)||(Ot==null?void 0:Ot.currency_code)||pt.currency_code||pt.currency||"").toUpperCase()||de.currency,We=new Set(["USD","EUR","GBP"]).has(Ae)?Ae:de.currency;if(Ie(De=>({...De,supplier_id:pt.supplier_id?String(pt.supplier_id):De.supplier_id,currency:We,exchange_rate:pt.exchange_rate!==void 0&&pt.exchange_rate!==null?Number(pt.exchange_rate)||De.exchange_rate||1:De.exchange_rate,delivery_date:pt.valid_until||De.delivery_date||"",remarks:pt.remarks||De.remarks||""})),pt.exchange_rate!==void 0&&pt.exchange_rate!==null||await ct(We),pt.details){const De=pt.details.map(lt=>({item_id:String(lt.item_id),qty:Number(lt.qty)||0,uom:lt.uom||Ye,unit_price:Number(lt.unit_price)||0,discount_percent:Number(lt.discount_percent)||0,tax_percent:0,line_total:Number(lt.line_total)||0}));Z(De)}}}catch(mt){console.error("Failed to fetch quotation details",mt)}Fe==="currency"&&await ct(xe)},Te=(ze,Fe,xe)=>{const we=[...le];if(we[ze]={...we[ze],[Fe]:xe},Fe==="item_id"){const je=T.find(rt=>String(rt.id)===String(xe)),We=(je==null?void 0:je.uom)||Ye;we[ze].uom=We;let lt=je&&Number(je.cost_price)||0;if(Array.isArray(R)&&R.length){const rt=R.filter(et=>String(et.product_id)===String(xe)).sort((et,Qt)=>{const Qe=et.effective_date?new Date(et.effective_date).getTime():0;return(Qt.effective_date?new Date(Qt.effective_date).getTime():0)-Qe||new Date(Qt.created_at).getTime()-new Date(et.created_at).getTime()});rt.length>0&&(lt=Number(rt[0].cost_price)||lt)}we[ze].unit_price=lt}const Xe=Number(we[ze].qty)||0,ut=Number(we[ze].unit_price)||0,ft=Number(we[ze].discount_percent)||0,mt=Number(we[ze].tax_percent)||0,pt=Xe*ut,vt=pt*(ft/100),Ot=pt-vt,Ae=Ot*(mt/100);we[ze].line_total=Ot+Ae,Z(we)},ue=()=>{Z(ze=>[...ze,{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}])},ge=ze=>{Z(Fe=>Fe.length>1?Fe.filter((xe,we)=>we!==ze):Fe)},Ve=async ze=>{var Fe,xe,we,Xe,ut,ft,mt,pt,vt,Ot,Ae,je,We;ze.preventDefault(),d(!0),h("");try{const De=(we=(xe=(Fe=ze==null?void 0:ze.nativeEvent)==null?void 0:Fe.submitter)==null?void 0:xe.dataset)==null?void 0:we.submitType,lt=De==="pending"?"PENDING_APPROVAL":De==="draft"?"DRAFT":de.status||"DRAFT";if(!de.supplier_id){h("Supplier is required"),d(!1);return}const rt=le.filter(he=>he.item_id&&Number(he.qty)>0&&Number(he.unit_price)>0);if(rt.length===0){h("At least one item with quantity and unit price is required"),d(!1);return}const et=String(de.po_no||""),Qe={po_no:et.toUpperCase().startsWith("LP-")?et:et.replace(/^PO-/i,"LP-")||(et.length?`LP-${et.replace(/^LP-/i,"")}`:""),po_date:de.po_date,po_type:"LOCAL",status:lt,supplier_id:Number(de.supplier_id),warehouse_id:Number(de.warehouse_id)||null,currency:de.currency,exchange_rate:Number(de.exchange_rate)||1,delivery_date:de.delivery_date||"",payment_terms:Number(de.payment_terms)||0,remarks:de.remarks||"",port_loading:de.port_loading||"",port_discharge:de.port_discharge||"",incoterms:de.incoterms||"",hs_code:de.hs_code||"",shipping_date:de.shipping_date||"",insurance_required:!!de.insurance_required,freight_amount:Number(de.freight_amount)||0,other_charges:Number(de.other_charges)||0,discount_amount:be.totalDiscount,tax_amount:be.totalTax,total_amount:be.grandTotal,terms_conditions:de.terms_conditions||"",quotation_id:de.quotation_id?Number(de.quotation_id):void 0,details:rt.map(he=>({item_id:Number(he.item_id),qty:Number(he.qty)||0,uom:he.uom||"",unit_price:Number(he.unit_price)||0,discount_percent:Number(he.discount_percent)||0,tax_percent:Number(he.tax_percent)||0,line_total:Number(he.line_total)||0}))};if(De==="pending"){if(i){await ee.post(`/purchase/orders/${t}/submit`,{amount:be.grandTotal??null,workflow_id:j?j.id:null,target_user_id:M||null});const he=await ee.get(`/purchase/orders/${t}`),pe=(Xe=he.data)==null?void 0:Xe.item,ye=Array.isArray((ft=(ut=he.data)==null?void 0:ut.item)==null?void 0:ft.details)?he.data.item.details:[];pe&&(Ie({po_no:pe.po_no||"",po_date:pe.po_date||new Date().toISOString().split("T")[0],supplier_id:pe.supplier_id?String(pe.supplier_id):"",po_type:pe.po_type||"LOCAL",status:pe.status||"DRAFT",warehouse_id:pe.warehouse_id?String(pe.warehouse_id):"",currency:pe.currency||"GHS",exchange_rate:Number(pe.exchange_rate)||1,delivery_date:pe.delivery_date||"",payment_terms:pe.payment_terms||30,remarks:pe.remarks||"",port_loading:pe.port_loading||"",port_discharge:pe.port_discharge||"",incoterms:pe.incoterms||"",hs_code:pe.hs_code||"",shipping_date:pe.shipping_date||"",insurance_required:!!pe.insurance_required,freight_amount:Number(pe.freight_amount)||0,other_charges:Number(pe.other_charges)||0}),Z(ye.map(Ne=>({item_id:Ne.item_id?String(Ne.item_id):"",qty:Number(Ne.qty)||Number(Ne.qty_ordered)||0,uom:Ne.uom||Ye||"",unit_price:Number(Ne.unit_price)||0,discount_percent:Number(Ne.discount_percent)||0,tax_percent:Number(Ne.tax_percent)||0,line_total:Number(Ne.line_total)||Number(Ne.amount)||0}))))}else{const he=await ee.post("/purchase/orders",Qe),pe=(mt=he==null?void 0:he.data)==null?void 0:mt.id;pe&&await ee.post(`/purchase/orders/${pe}/submit`,{amount:be.grandTotal??null,workflow_id:j?j.id:null,target_user_id:M||null})}r("/purchase/purchase-orders-local");return}if(i){await ee.put(`/purchase/orders/${t}/status`,{status:lt});const he=await ee.get(`/purchase/orders/${t}`),pe=(pt=he.data)==null?void 0:pt.item,ye=Array.isArray((Ot=(vt=he.data)==null?void 0:vt.item)==null?void 0:Ot.details)?he.data.item.details:[];pe&&(Ie({po_no:pe.po_no||"",po_date:pe.po_date||new Date().toISOString().split("T")[0],supplier_id:pe.supplier_id?String(pe.supplier_id):"",po_type:pe.po_type||"LOCAL",status:pe.status||"DRAFT",warehouse_id:pe.warehouse_id?String(pe.warehouse_id):"",currency:pe.currency||"GHS",exchange_rate:Number(pe.exchange_rate)||1,delivery_date:pe.delivery_date||"",payment_terms:pe.payment_terms||30,remarks:pe.remarks||"",port_loading:pe.port_loading||"",port_discharge:pe.port_discharge||"",incoterms:pe.incoterms||"",hs_code:pe.hs_code||"",shipping_date:pe.shipping_date||"",insurance_required:!!pe.insurance_required,freight_amount:Number(pe.freight_amount)||0,other_charges:Number(pe.other_charges)||0}),Z(ye.map(Ne=>({item_id:Ne.item_id?String(Ne.item_id):"",qty:Number(Ne.qty)||Number(Ne.qty_ordered)||0,uom:Ne.uom||Ye||"",unit_price:Number(Ne.unit_price)||0,discount_percent:Number(Ne.discount_percent)||0,tax_percent:Number(Ne.tax_percent)||0,line_total:Number(Ne.line_total)||Number(Ne.amount)||0}))))}else{const he=await ee.post("/purchase/orders",Qe),pe=(Ae=he==null?void 0:he.data)==null?void 0:Ae.id;pe&&lt!=="DRAFT"&&await ee.put(`/purchase/orders/${pe}/status`,{status:lt})}r("/purchase/purchase-orders-local")}catch(De){const lt=((We=(je=De==null?void 0:De.response)==null?void 0:je.data)==null?void 0:We.message)||(De==null?void 0:De.message)||"Error saving purchase order. Please try again.";h(lt)}finally{d(!1)}},tt=async()=>{var ze,Fe,xe;if(!n){H(!0),y("");try{const we=await ee.post(`/purchase/orders/${t}/submit`,{amount:be.grandTotal??null,workflow_id:j?j.id:null,target_user_id:M||null}),Xe=((ze=we==null?void 0:we.data)==null?void 0:ze.status)||"PENDING_APPROVAL";Ie(ut=>({...ut,status:Xe})),f(!1),r("/purchase/purchase-orders-local")}catch(we){y(((xe=(Fe=we==null?void 0:we.response)==null?void 0:Fe.data)==null?void 0:xe.message)||"Failed to forward for approval")}finally{H(!1)}}};return console.log("Rendering PurchaseOrdersLocalForm",{id:t,isNew:n,isEdit:i}),e.jsxs("div",{className:"w-full pb-10",children:[e.jsx("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:ve.logoUrl||qs,alt:ve.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:ve.name||"Company"}),ve.address&&e.jsx("div",{children:ve.address}),(ve.city||ve.state||ve.country)&&e.jsx("div",{children:[ve.city,ve.state,ve.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[ve.phone&&e.jsx("span",{children:ve.phone}),ve.email&&e.jsx("span",{children:ve.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",de.po_date||""]}),e.jsxs("div",{children:["PO #: ",de.po_no||""]})]})]})}),e.jsxs("div",{ref:re,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:ve.logoUrl||qs,alt:ve.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:ve.name||"Company"}),ve.address&&e.jsx("div",{children:ve.address}),(ve.city||ve.state||ve.country)&&e.jsx("div",{children:[ve.city,ve.state,ve.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[ve.phone&&e.jsx("span",{children:ve.phone}),ve.email&&e.jsx("span",{children:ve.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",de.po_date||""]}),e.jsxs("div",{children:["PO #: ",de.po_no||""]}),e.jsxs("div",{children:["Supplier:"," ",((Ze=I.find(ze=>String(ze.id)===String(de.supplier_id)))==null?void 0:Ze.supplier_name)||((ht=I.find(ze=>String(ze.id)===String(de.supplier_id)))==null?void 0:ht.name)||""]}),e.jsxs("div",{children:["Currency: ",de.currency||""]}),e.jsxs("div",{children:["Exchange Rate: ",Number(de.exchange_rate||1).toFixed(2)]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Net Amount"})]})}),e.jsx("tbody",{children:le.map((ze,Fe)=>{const xe=T.find(Xe=>String(Xe.id)===String(ze.item_id)),we=(xe==null?void 0:xe.item_name)||(xe==null?void 0:xe.item_code)||"Item";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:we}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ze.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ze.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(ze.line_total||0).toFixed(2)})]},Fe)})}),e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Subtotal"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(be.subTotal||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Discount"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(be.totalDiscount||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Tax"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(be.totalTax||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Freight"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(be.freight||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Other Charges"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(be.other||0).toFixed(2)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 font-semibold",children:"Grand Total"}),e.jsx("td",{}),e.jsx("td",{}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(be.grandTotal||0).toFixed(2)})]})]})]})})]}),e.jsxs("div",{className:"w-full bg-white rounded-xl shadow-[0_4px_20px_rgba(14,54,70,0.15)] overflow-hidden",children:[e.jsxs("div",{className:"bg-[#0E3646] text-white p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:" Purchase Order"}),e.jsx("p",{className:"opacity-90",children:"Create local and import purchase orders"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center p-5 bg-[#f8f9fa] border-b border-[#dee2e6] gap-4",children:[e.jsx("div",{className:"flex bg-[#f8f9fa] p-1 rounded-md border border-[#dee2e6]",children:e.jsx("button",{type:"button",className:`px-5 py-2.5 rounded text-sm font-semibold transition-all ${de.po_type==="LOCAL"?"bg-[#0E3646] text-white":"text-gray-500 hover:bg-gray-200"}`,onClick:()=>Ie({...de,po_type:"LOCAL"}),children:" Local Order"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Le,{to:"/purchase/purchase-orders-local",className:"btn btn-secondary font-medium flex items-center gap-2",children:" View Orders"}),e.jsxs("button",{type:"button",onClick:Ke,className:"btn-outline font-medium flex items-center gap-2",children:[e.jsx(Yc,{className:"w-4 h-4"}),"Download PDF"]}),e.jsxs("button",{type:"button",onClick:ot,className:"btn-primary font-medium flex items-center gap-2",children:[e.jsx(qh,{className:"w-4 h-4"}),"Print"]})]})]}),e.jsxs("div",{className:"p-8",children:[l&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),c&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded mb-6 border border-red-200",children:c}),e.jsxs("form",{onSubmit:Ve,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Purchase Order Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Number"}),e.jsx("input",{type:"text",name:"po_no",value:de.po_no,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10 bg-[#e9ecef] cursor-not-allowed",readOnly:!0,placeholder:"Auto-generated"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Date"}),e.jsx("input",{type:"date",name:"po_date",value:de.po_date,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Order Type"}),e.jsx("input",{type:"text",value:de.po_type,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm bg-[#e9ecef]",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Status"}),e.jsx("div",{children:e.jsx("span",{className:"px-4 py-1.5 rounded-full text-xs font-bold bg-[#e9ecef] text-[#495057]",children:de.status})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Supplier"}),e.jsxs("select",{name:"supplier_id",value:de.supplier_id,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),Array.isArray(I)&&I.map(ze=>ze&&e.jsx("option",{value:ze.id,children:ze.supplier_name||ze.name||"Unknown Supplier"},ze.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Reference Quotation"}),e.jsxs("select",{name:"quotation_id",value:de.quotation_id,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Quotation"}),Array.isArray(D)&&D.map(ze=>ze&&e.jsxs("option",{value:ze.id,children:[ze.quotation_no," - ",ze.supplier_name]},ze.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:de.warehouse_id,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),Array.isArray(Y)&&Y.map(ze=>ze&&e.jsx("option",{value:ze.id,children:ze.warehouse_name||ze.name||"Unknown Warehouse"},ze.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Currency"}),e.jsxs("select",{name:"currency",value:de.currency,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"GHS",children:"GHS - Ghana Cedi"}),e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Exchange Rate"}),e.jsx("input",{type:"number",name:"exchange_rate",value:de.exchange_rate,onChange:Ce,step:"0.0001",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Expected Delivery Date"}),e.jsx("input",{type:"date",name:"delivery_date",value:de.delivery_date,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",name:"payment_terms",value:de.payment_terms,onChange:Ce,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646]",children:" Order Items"}),e.jsx("button",{type:"button",onClick:ue,className:"px-4 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all text-sm font-medium flex items-center gap-2",children:" Add Item"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("div",{className:"mb-2 text-xs text-slate-600",children:"If a unit conversion exists for the selected item and UOM, use the number of UOM button beside the UOM to convert quantity to the items default for accurate costing."}),e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-[#0E3646] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-[13px] w-[50px]",children:"#"}),e.jsx("th",{className:"p-3 text-left text-[13px]",children:"Item Name"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Qty"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"UOM"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"Unit Price"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Disc %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Tax %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[150px]",children:"Net Amount"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[80px]",children:"Action"})]})}),e.jsx("tbody",{children:le.map((ze,Fe)=>ze&&e.jsxs("tr",{className:"border-b border-[#dee2e6] hover:bg-[#0E3646]/5 transition-colors",children:[e.jsx("td",{className:"p-3 text-sm",children:Fe+1}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:ze.item_id,onChange:xe=>Te(Fe,"item_id",xe.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm focus:outline-none focus:border-[#0E3646]",required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),Array.isArray(T)&&T.map(xe=>xe&&e.jsx("option",{value:xe.id,children:xe.item_name||xe.item_code||"Unknown Item"},xe.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:ze.qty,onChange:xe=>Te(Fe,"qty",xe.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsxs("td",{className:"p-3",children:[e.jsxs("select",{value:ze.uom||Ye||"",onChange:xe=>Te(Fe,"uom",xe.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-center focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select UOM"}),Array.isArray(Me)&&Me.map(xe=>xe&&e.jsx("option",{value:xe.uom_code,children:xe.uom_name?`${xe.uom_name} (${xe.uom_code})`:xe.uom_code},xe.id))]}),(()=>{const xe=T.find(pt=>String(pt.id)===String(ze.item_id)),we=(xe==null?void 0:xe.uom)&&String(xe.uom)||ze.uom&&String(ze.uom)||(Ye?String(Ye):""),Xe=(Array.isArray(ne)?ne:[]).filter(pt=>Number(pt.is_active)&&Number(pt.item_id)===Number(ze.item_id)&&String(pt.to_uom)===we).map(pt=>String(pt.from_uom)),ut=String(ze.uom||""),ft=ut&&ut!==we?ut:Xe[0]||"";return Xe.length>0&&ft&&ft!==we?e.jsx("button",{type:"button",className:"ml-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>_e({open:!0,itemId:ze.item_id,defaultUom:we,currentUom:ft,rowIdx:Fe}),children:`number of ${ft}`}):null})()]}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:ze.unit_price,onChange:xe=>Te(Fe,"unit_price",xe.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:ze.discount_percent,onChange:xe=>Te(Fe,"discount_percent",xe.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",max:"100",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:(()=>{const xe=oe.find(we=>Number(we.rate)===Number(ze.tax_percent||0));return xe?xe.value:""})(),onChange:xe=>{const we=xe.target.value,Xe=oe.find(ft=>String(ft.value)===String(we)),ut=Xe?Xe.rate:0;Te(Fe,"tax_percent",ut)},className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"No Tax"}),oe.map(xe=>e.jsx("option",{value:xe.value,children:xe.label},xe.value))]})}),e.jsxs("td",{className:"p-3 text-right font-medium text-sm",children:[de.currency," ",ze.line_total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>ge(Fe),className:"text-[#dc3545] hover:bg-[#dc3545]/10 p-1.5 rounded transition-colors",children:""})})]},Fe))})]})]}),e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg mt-5 border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Items:"}),e.jsx("span",{className:"font-bold",children:le.filter(ze=>ze&&ze.item_id).length})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sub Total:"}),e.jsxs("span",{className:"font-bold",children:[de.currency," ",be.subTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#dc3545]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Discount:"}),e.jsxs("span",{className:"font-bold",children:["-",de.currency," ",be.totalDiscount.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#0E3646]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tax Amount:"}),e.jsxs("span",{className:"font-bold",children:[de.currency," ",be.totalTax.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Freight Charges:"}),e.jsx("input",{type:"number",name:"freight_amount",value:de.freight_amount,onChange:Ce,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Other Charges:"}),e.jsx("input",{type:"number",name:"other_charges",value:de.other_charges,onChange:Ce,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-3 text-lg font-bold text-[#0E3646]",children:[e.jsx("span",{children:"GRAND TOTAL:"}),e.jsxs("span",{children:[de.currency," ",be.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Terms & Conditions"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("textarea",{name:"terms_conditions",value:de.terms_conditions,onChange:Ce,rows:"6",className:"p-3 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",placeholder:"Enter terms and conditions..."})})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-8 gap-4",children:[e.jsx("div",{children:e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#dc3545] text-white rounded hover:bg-[#c82333] transition-all font-medium flex items-center gap-2",onClick:()=>alert("Delete functionality not implemented yet"),children:" Delete"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#6c757d] text-white rounded hover:bg-[#5a6268] transition-all font-medium flex items-center gap-2",onClick:()=>Ie({...de,remarks:""}),children:" Clear"}),e.jsx("button",{type:"submit",disabled:u,"data-submit-type":"draft",className:"px-5 py-2.5 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:u?"Saving...":" Save as Draft"}),e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#17a2b8] text-white rounded hover:bg-[#138496] transition-all font-medium flex items-center gap-2",onClick:()=>window.print(),children:" Print"}),e.jsx("button",{type:"submit",disabled:u,"data-submit-type":"pending",className:"px-5 py-2.5 bg-[#28a745] text-white rounded hover:bg-[#218838] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:" Submit for Approval"})]})]})]})]})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{f(!1),N(null),B(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:de.po_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:j?`${j.workflow_name} (${j.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Fe=Array.isArray(P)&&P.length>0?P[0]:null,xe=Fe?Array.isArray(Fe.approvers)&&Fe.approvers.length?Fe.approvers.map(we=>({id:we.id,name:we.username})):Fe.approver_user_id?[{id:Fe.approver_user_id,name:Fe.approver_name||String(Fe.approver_user_id)}]:[]:[];return xe.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:M||"",onChange:we=>z(we.target.value?Number(we.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),xe.map(we=>e.jsx("option",{value:we.id,children:we.name},we.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:j?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{f(!1),N(null),B(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:tt,disabled:U||n,children:U?"Forwarding...":"Forward"})]})]})}),e.jsx(sd,{open:Be.open,itemId:Be.itemId,defaultUom:Be.defaultUom,currentUom:Be.currentUom,onClose:()=>_e({open:!1,itemId:null,defaultUom:"",currentUom:"",rowIdx:null}),onApply:ze=>{const{converted_qty:Fe}=ze||{},xe=Be.rowIdx;xe!=null&&Z(we=>{const Xe=[...we],ut={...Xe[xe]},ft=Number(Fe||0);ut.qty=ft,ut.uom=Be.defaultUom||ut.uom;const mt=Number(ut.unit_price||0),pt=Number(ut.discount_percent||0),vt=Number(ut.tax_percent||0),Ot=ft*mt,Ae=Ot*(pt/100),je=Ot-Ae,We=je*(vt/100);return ut.line_total=je+We,Xe[xe]=ut,Xe})}})]})}function fJ(){const[t,s]=x.useState(""),[r,a]=x.useState("ALL"),[n,i]=x.useState([]),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState(!1),[A,f]=x.useState(null),[g,v]=x.useState(!1),[b,y]=x.useState(""),[j,N]=x.useState(null),[S,B]=x.useState(null),[P,L]=x.useState([]),[U,H]=x.useState(!1),[q,V]=x.useState(null),[M,z]=x.useState(null);x.useEffect(()=>{let D=!0;return o(!0),d(""),ee.get("/purchase/orders").then(Q=>{var E;if(!D)return;const C=Array.isArray((E=Q.data)==null?void 0:E.items)?Q.data.items:[];i(C.filter(w=>String(w.po_type||"").toUpperCase()==="IMPORT"))}).catch(Q=>{var C,E;D&&d(((E=(C=Q==null?void 0:Q.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to load purchase orders")}).finally(()=>{D&&o(!1)}),()=>{D=!1}},[]);const I=D=>({DRAFT:"badge-warning",PENDING_APPROVAL:"badge-warning",APPROVED:"badge-info",RECEIVED:"badge-success",RETURNED:"badge-error",CANCELLED:"badge-error"})[D]||"badge-info",G=x.useMemo(()=>n.filter(D=>{const Q=String(D.po_no||"").toLowerCase().includes(t.toLowerCase())||String(D.supplier_name||"").toLowerCase().includes(t.toLowerCase()),C=r==="ALL"||D.status===r;return Q&&C}),[n,t,r]),Y=async D=>{var Q,C,E;if(f(D),h(!0),y(""),q)await J();else try{v(!0);const w=await ee.get("/workflows"),O=Array.isArray((Q=w.data)==null?void 0:Q.items)?w.data.items:[];V(O),await T(O)}catch(w){y(((E=(C=w==null?void 0:w.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to load workflows")}finally{v(!1)}},J=async()=>{var E,w,O;if(!q||!q.length){N(null),B(null),y("");return}const D="/purchase/purchase-orders-import",Q=R=>String(R||"").trim().toUpperCase().replace(/\s+/g,"_"),C=q.find(R=>Number(R.is_active)===1&&String(R.document_route)===D)||q.find(R=>Number(R.is_active)===1&&Q(R.document_type)==="PURCHASE_ORDER")||null;if(N(C||null),B(null),!!C)try{v(!0);const X=(E=(await ee.get(`/workflows/${C.id}`)).data)==null?void 0:E.item,ne=Array.isArray(X==null?void 0:X.steps)?X.steps:[];L(ne);const te=ne[0]||null;if(B(te?{userId:te.approver_user_id,name:te.approver_name,stepName:te.step_name,stepOrder:te.step_order,approvalLimit:te.approval_limit}:null),te){const oe=(Array.isArray(te.approvers)&&te.approvers.length?te.approvers[0].id:te.approver_user_id)||null;z(oe)}else z(null)}catch(R){y(((O=(w=R==null?void 0:R.response)==null?void 0:w.data)==null?void 0:O.message)||"Failed to load workflow details")}finally{v(!1)}},T=async D=>{var w,O,R;if(!D||!D.length){N(null),B(null),y("");return}const Q="/purchase/purchase-orders-import",C=X=>String(X||"").trim().toUpperCase().replace(/\s+/g,"_"),E=D.find(X=>Number(X.is_active)===1&&String(X.document_route)===Q)||D.find(X=>Number(X.is_active)===1&&C(X.document_type)==="PURCHASE_ORDER")||null;if(N(E||null),B(null),!!E)try{v(!0);const ne=(w=(await ee.get(`/workflows/${E.id}`)).data)==null?void 0:w.item,te=Array.isArray(ne==null?void 0:ne.steps)?ne.steps:[];L(te);const oe=te[0]||null;B(oe?{userId:oe.approver_user_id,name:oe.approver_name,stepName:oe.step_name,stepOrder:oe.step_order,approvalLimit:oe.approval_limit}:null)}catch(X){y(((R=(O=X==null?void 0:X.response)==null?void 0:O.data)==null?void 0:R.message)||"Failed to load workflow details")}finally{v(!1)}},k=async()=>{var D,Q,C;if(A){H(!0),y("");try{const E=await ee.post(`/purchase/orders/${A.id}/submit`,{amount:(A==null?void 0:A.total_amount)??null,workflow_id:j?j.id:null,target_user_id:M||null}),w=((D=E==null?void 0:E.data)==null?void 0:D.status)||"PENDING_APPROVAL";i(O=>O.map(R=>R.id===A.id?{...R,status:w}:R)),h(!1),f(null)}catch(E){y(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to forward for approval")}finally{H(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Purchase Orders - Import"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage import purchase orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/purchase-orders-import/new",className:"btn-success",children:"+ New Purchase Order"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by PO no or supplier...",className:"input",value:t,onChange:D=>s(D.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:r,onChange:D=>a(D.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"RECEIVED",children:"Received"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"PO Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{className:"text-right",children:"Total Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[l?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):u?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-red-600",children:u})}):null,G.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No purchase orders found"})}):G.map(D=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:D.po_no}),e.jsx("td",{children:D.po_date?new Date(D.po_date).toLocaleDateString():""}),e.jsx("td",{children:D.supplier_name}),e.jsx("td",{className:"text-right font-medium",children:Number(D.total_amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${I(D.status)}`,children:D.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/purchase/purchase-orders-import/${D.id}`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),D.status==="DRAFT"?e.jsx(Le,{to:`/purchase/purchase-orders-import/${D.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium",children:"Edit"}):null,D.status==="APPROVED"?e.jsx("span",{className:"text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):D.status==="DRAFT"||D.status==="RETURNED"?e.jsx("button",{type:"button",onClick:()=>Y(D),className:"text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",children:"Forward for Approval"}):null]})})]},D.id))]})]})}),e.jsx("div",{className:"card-body border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{children:["Showing ",G.length," of ",n.length," orders"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Previous"}),e.jsx("button",{className:"btn-success px-3 py-1.5",disabled:!0,children:"Next"})]})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{h(!1),f(null),N(null),B(null),y("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:A==null?void 0:A.po_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:j?`${j.workflow_name} (${j.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:g?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:b?e.jsx("div",{className:"text-sm text-red-600",children:b}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Q=Array.isArray(P)&&P.length>0?P[0]:null,C=Q?Array.isArray(Q.approvers)&&Q.approvers.length?Q.approvers.map(E=>({id:E.id,name:E.username})):Q.approver_user_id?[{id:Q.approver_user_id,name:Q.approver_name||String(Q.approver_user_id)}]:[]:[];return C.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:M||"",onChange:E=>z(E.target.value?Number(E.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),C.map(E=>e.jsx("option",{value:E.id,children:E.name},E.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:S?`Step ${S.stepOrder}  ${S.stepName}${S.approvalLimit!=null?`  Limit: ${Number(S.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:j?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{h(!1),f(null),N(null),B(null),y("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:k,disabled:U,children:U?"Forwarding...":"Forward"})]})]})})]})}function fb(){var ht,ze;const{id:t}=Ls(),s=ma(),r=ys(),{user:a}=ca(),n=!t||t==="new",i=!!t&&t!=="new"&&(s.pathname.includes("/edit")||(()=>{try{const Fe=new URLSearchParams(s.search||""),xe=String(Fe.get("mode")||"").toLowerCase(),we=String(Fe.get("edit")||"").toLowerCase();return xe==="edit"||we==="1"||we==="true"}catch{return!1}})()),l=!!t&&t!=="new"&&!i,[o,u]=x.useState(!1),[d,c]=x.useState(!1),[h,A]=x.useState(""),[f,g]=x.useState(!1),[v,b]=x.useState(!1),[y,j]=x.useState(""),[N,S]=x.useState(null),[B,P]=x.useState(null),[L,U]=x.useState([]),[H,q]=x.useState(!1),[V,M]=x.useState(null),[z,I]=x.useState(null),[G,Y]=x.useState([]),[J,T]=x.useState([]),[k,D]=x.useState([]),[Q,C]=x.useState([]),[E,w]=x.useState([]),[O,R]=x.useState([]),[X,ne]=x.useState([]),[te,oe]=x.useState([]),[ce,re]=x.useState([]),de=x.useRef(null),[Ie,le]=x.useState({open:!1,itemId:null,defaultUom:"",currentUom:"",rowIdx:null}),[Z,ve]=x.useState({po_no:"",po_date:new Date().toISOString().split("T")[0],supplier_id:"",quotation_id:"",po_type:"IMPORT",status:"DRAFT",warehouse_id:"",currency:"USD",exchange_rate:1,delivery_date:"",payment_terms:30,delivery_terms:"",remarks:"",port_loading:"",port_discharge:"",incoterms:"",hs_code:"",shipping_date:"",insurance_required:!1,freight_amount:0,other_charges:0,discount_amount:0,tax_amount:0,terms_conditions:`1. All goods must meet specified quality standards
2. Delivery to be made as per schedule
3. Payment terms: Net 30 days from delivery
4. Supplier responsible for any defects within warranty period
5. Late delivery penalties may apply as per agreement
6. All disputes subject to arbitration in Accra, Ghana`}),[Ue,Be]=x.useState([{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]),[_e,Me]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""}),{uoms:Ye}=el(),ot=x.useMemo(()=>{const Fe=Array.isArray(Ye)?Ye:[],xe=Fe.find(we=>String(we.uom_code||"").toUpperCase()==="PCS")||Fe[0];return xe&&xe.uom_code?xe.uom_code:"PCS"},[Ye]);x.useEffect(()=>{let Fe=!0;async function xe(){var we,Xe,ut,ft,mt,pt,vt,Ot;try{const[Ae,je,We,De,lt]=await Promise.allSettled([ee.get("/purchase/suppliers"),ee.get("/inventory/warehouses"),ee.get("/inventory/items"),ee.get("/purchase/quotations"),ee.get("/inventory/unit-conversions")]);if(!Fe)return;if(Ae.status==="fulfilled"){const rt=Array.isArray((we=Ae.value.data)==null?void 0:we.items)?Ae.value.data.items:[];Y(rt)}if(je.status==="fulfilled"&&T(Array.isArray((Xe=je.value.data)==null?void 0:Xe.items)?je.value.data.items:[]),We.status==="fulfilled"&&D(Array.isArray((ut=We.value.data)==null?void 0:ut.items)?We.value.data.items:[]),De.status==="fulfilled"){const rt=Array.isArray((ft=De.value.data)==null?void 0:ft.items)?De.value.data.items:[];w(rt);const et=String(Z.supplier_id||""),Qt=et&&et.length?rt.filter(Qe=>String(Qe.supplier_id)===String(et)):[];C(Qt)}if(lt.status==="fulfilled"&&re(Array.isArray((mt=lt.value.data)==null?void 0:mt.items)?lt.value.data.items:[]),Ae.status==="rejected"&&De.status==="fulfilled"){const rt=Array.isArray((pt=De.value.data)==null?void 0:pt.items)?De.value.data.items:[],et=new Set,Qt=[];for(const Qe of rt){const he=Qe.supplier_id;he&&!et.has(String(he))&&(et.add(String(he)),Qt.push({id:he,supplier_name:Qe.supplier_name,supplier_type:Qe.supplier_type||null}))}Qt.length&&Y(Qt)}Ae.status==="rejected"&&je.status==="rejected"&&We.status==="rejected"&&De.status==="rejected"&&A("Failed to load lookups")}catch(Ae){if(!Fe)return;A(((Ot=(vt=Ae==null?void 0:Ae.response)==null?void 0:vt.data)==null?void 0:Ot.message)||"Failed to load lookups")}}return xe(),()=>{Fe=!1}},[]),x.useEffect(()=>{if(i)return;let Fe=!0;return ee.get("/purchase/orders/next-no",{params:{po_type:Z.po_type||"IMPORT"}}).then(xe=>{var we;Fe&&(we=xe.data)!=null&&we.nextNo&&ve(Xe=>({...Xe,po_no:Xe.po_no||xe.data.nextNo}))}).catch(xe=>console.error("Failed to load next purchase order number",xe)),()=>{Fe=!1}},[i,Z.po_type]),x.useEffect(()=>{Ke()},[]);async function Ke(){var Fe,xe,we;try{const ut=(xe=(Fe=(await ee.get("/admin/me")).data)==null?void 0:Fe.scope)==null?void 0:xe.companyId;if(ut){const mt=((we=(await ee.get(`/admin/companies/${ut}`)).data)==null?void 0:we.item)||{};Me(pt=>({...pt,name:mt.name||pt.name||"",address:mt.address||pt.address||"",phone:mt.telephone||pt.phone||"",email:mt.email||pt.email||"",city:mt.city||pt.city||"",state:mt.state||pt.state||"",country:mt.country||pt.country||"",logoUrl:mt.has_logo===1||mt.has_logo===!0?`/api/admin/companies/${ut}/logo`:qs}))}else Me(ft=>({...ft,logoUrl:ft.logoUrl||qs}))}catch{Me(Xe=>({...Xe,logoUrl:Xe.logoUrl||qs}))}}x.useEffect(()=>{let Fe=!0;async function xe(){var we;try{const Xe=await ee.get("/finance/currencies");if(!Fe)return;const ut=Array.isArray((we=Xe.data)==null?void 0:we.items)?Xe.data.items:[];R(ut)}catch(Xe){console.error("Error fetching currencies:",Xe)}}return xe(),()=>{Fe=!1}},[]),x.useEffect(()=>{async function Fe(){var xe;try{const we=Array.isArray(O)?O:[];if(!we.length)return;const Xe=we.find(vt=>String(vt.is_base)==="1"||vt.is_base===1||vt.is_base===!0)||we.find(vt=>String(vt.code||vt.currency_code||"").toUpperCase()==="GHS")||we.find(vt=>/ghana|cedi/i.test(String(vt.name||vt.currency_name||""))),ut=we.find(vt=>String(vt.code||vt.currency_code||"").toUpperCase()==="USD");if(!Xe||!ut||Xe.id===ut.id)return;const ft=Z.po_date||new Date().toISOString().split("T")[0],mt=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:ut.id,toCurrencyId:Xe.id,to:ft}});if(!(Array.isArray((xe=mt.data)==null?void 0:xe.items)?mt.data.items:[]).length)try{await ee.post("/finance/currency-rates",{fromCurrencyId:ut.id,toCurrencyId:Xe.id,rate:1,rateDate:ft})}catch(vt){console.error("Failed to seed USD->GHS rate",vt)}}catch(we){console.error("ensureUsdGhsRate error",we)}}Fe()},[O,Z.po_date]),x.useEffect(()=>{let Fe=!0;async function xe(){var we;try{const Xe=await ee.get("/sales/prices/standard");if(!Fe)return;const ut=Array.isArray((we=Xe.data)==null?void 0:we.items)?Xe.data.items:[];ne(ut)}catch(Xe){console.error("Error fetching standard prices:",Xe)}}return xe(),()=>{Fe=!1}},[]),x.useEffect(()=>{let Fe=!0;async function xe(){var we;try{const Xe=await ee.get("/finance/tax-codes");if(!Fe)return;const ft=(Array.isArray((we=Xe.data)==null?void 0:we.items)?Xe.data.items:[]).map(mt=>({value:mt.id,label:mt.name,rate:Number(mt.rate_percent)}));oe(ft)}catch(Xe){console.error("Error fetching tax codes:",Xe)}}return xe(),()=>{Fe=!1}},[]);const ct=async Fe=>{var ft;const xe=String(Fe||"").toUpperCase(),we=Array.isArray(O)?O:[];if(!xe||!we.length)return;const Xe=we.find(mt=>String(mt.is_base)==="1"||mt.is_base===1||mt.is_base===!0)||we.find(mt=>String(mt.code||mt.currency_code||"").toUpperCase()==="GHS")||we.find(mt=>/ghana|cedi/i.test(String(mt.name||mt.currency_name||""))),ut=we.find(mt=>String(mt.code||mt.currency_code||"").toUpperCase()===xe);if(!Xe||!ut||Xe.id===ut.id){ve(mt=>({...mt,exchange_rate:1}));return}try{const mt=Z.po_date||new Date().toISOString().split("T")[0],pt=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:ut.id,toCurrencyId:Xe.id,to:mt}}),Ot=(Array.isArray((ft=pt.data)==null?void 0:ft.items)?pt.data.items:[])[0];if(Ot&&Ot.rate)ve(Ae=>({...Ae,exchange_rate:Number(Ot.rate)||Ae.exchange_rate||1}));else try{await ee.post("/finance/currency-rates",{fromCurrencyId:ut.id,toCurrencyId:Xe.id,rate:1,rateDate:mt}),ve(Ae=>({...Ae,exchange_rate:1}))}catch{ve(Ae=>({...Ae,exchange_rate:1}))}}catch{}};x.useEffect(()=>{ct(Z.currency)},[O,Z.currency,Z.po_date]),x.useEffect(()=>{if(!t||t==="new")return;let Fe=!0;return u(!0),A(""),ee.get(`/purchase/orders/${t}`).then(xe=>{var ut,ft,mt;if(!Fe)return;const we=(ut=xe.data)==null?void 0:ut.item,Xe=Array.isArray((mt=(ft=xe.data)==null?void 0:ft.item)==null?void 0:mt.details)?xe.data.item.details:[];we&&(ve({po_no:we.po_no||"",po_date:we.po_date||new Date().toISOString().split("T")[0],supplier_id:we.supplier_id?String(we.supplier_id):"",po_type:we.po_type||"IMPORT",status:we.status||"DRAFT",warehouse_id:we.warehouse_id?String(we.warehouse_id):"",currency:we.currency||"GHS",exchange_rate:Number(we.exchange_rate)||1,delivery_date:we.delivery_date||"",payment_terms:we.payment_terms||30,delivery_terms:we.delivery_terms||"",remarks:we.remarks||"",port_loading:we.port_loading||"",port_discharge:we.port_discharge||"",incoterms:we.incoterms||"",hs_code:we.hs_code||"",shipping_date:we.shipping_date||"",insurance_required:!!we.insurance_required,freight_amount:Number(we.freight_amount)||0,other_charges:Number(we.other_charges)||0,discount_amount:Number(we.discount_amount)||0,tax_amount:Number(we.tax_amount)||0,terms_conditions:we.terms_conditions||Z.terms_conditions}),Be(Xe.length?Xe.filter(pt=>pt).map(pt=>({item_id:pt.item_id?String(pt.item_id):"",qty:Number(pt.qty)||0,uom:pt.uom||"",unit_price:Number(pt.unit_price)||0,discount_percent:Number(pt.discount_percent)||0,tax_percent:Number(pt.tax_percent)||0,line_total:Number(pt.line_total)||0})):[{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}]))}).catch(xe=>{var we,Xe;Fe&&A(((Xe=(we=xe==null?void 0:xe.response)==null?void 0:we.data)==null?void 0:Xe.message)||"Failed to load purchase order")}).finally(()=>{Fe&&u(!1)}),()=>{Fe=!1}},[t]);const xt=x.useMemo(()=>{let Fe=0,xe=0,we=0;Ue.forEach(mt=>{if(!mt)return;const pt=Number(mt.qty)||0,vt=Number(mt.unit_price)||0,Ot=Number(mt.discount_percent)||0,Ae=Number(mt.tax_percent)||0,je=pt*vt,We=je*(Ot/100),lt=(je-We)*(Ae/100);Fe+=je,xe+=We,we+=lt});const Xe=Number(Z.freight_amount)||0,ut=Number(Z.other_charges)||0,ft=Fe-xe+we+Xe+ut;return{subTotal:Fe,totalDiscount:xe,totalTax:we,freight:Xe,other:ut,grandTotal:ft}},[Ue,Z.freight_amount,Z.other_charges]),be=async Fe=>{var ft,mt;const{name:xe,value:we,type:Xe,checked:ut}=Fe.target;if(ve(pt=>({...pt,[xe]:Xe==="checkbox"?ut:we})),xe==="supplier_id"){const pt=String(we||"");if(pt){const vt=(Array.isArray(E)?E:[]).filter(Ot=>String(Ot.supplier_id)===pt);C(vt),ve(Ot=>{const Ae=vt.some(je=>String(je.id)===String(Ot.quotation_id||""));return{...Ot,quotation_id:Ae?Ot.quotation_id:""}});try{const Ot=G.find(je=>String(je.id)===pt),Ae=Ot&&Ot.supplier_code&&String(Ot.supplier_code).trim()||(Ot?`SU-${String(Number(Ot.id||0)).padStart(6,"0")}`:"");if(Ae){const je=await ee.get("/finance/accounts",{params:{search:Ae}}),We=Array.isArray((ft=je.data)==null?void 0:ft.items)?je.data.items:[],De=We.find(rt=>String(rt.code)===Ae)||We[0]||null,lt=De&&(De.currency_code||De.currency||De.currencyCode)||null;if(lt){const rt=String(lt).toUpperCase();ve(et=>({...et,currency:rt})),await ct(rt)}}}catch{}}else C(Array.isArray(E)?E:[])}if(xe==="quotation_id"&&we)try{const vt=(mt=(await ee.get(`/purchase/quotations/${we}`)).data)==null?void 0:mt.item;if(vt){const Ae=(Array.isArray(O)?O:[]).find(lt=>String(lt.id)===String(vt.currency_id||"")),je=String((Ae==null?void 0:Ae.code)||(Ae==null?void 0:Ae.currency_code)||vt.currency_code||vt.currency||"").toUpperCase()||Z.currency,De=new Set(["USD","EUR","GBP"]).has(je)?je:Z.currency;if(ve(lt=>({...lt,supplier_id:vt.supplier_id?String(vt.supplier_id):lt.supplier_id,currency:De,exchange_rate:vt.exchange_rate!==void 0&&vt.exchange_rate!==null?Number(vt.exchange_rate)||lt.exchange_rate||1:lt.exchange_rate,delivery_date:vt.valid_until||lt.delivery_date||"",remarks:vt.remarks||lt.remarks||""})),vt.exchange_rate!==void 0&&vt.exchange_rate!==null||await ct(De),vt.details){const lt=vt.details.map(rt=>({item_id:String(rt.item_id),qty:Number(rt.qty)||0,uom:rt.uom||ot,unit_price:Number(rt.unit_price)||0,discount_percent:Number(rt.discount_percent)||0,tax_percent:0,line_total:Number(rt.line_total)||0}));Be(lt)}}}catch(pt){console.error("Failed to fetch quotation details",pt)}xe==="currency"&&await ct(we)},Ce=()=>{window.print()},Te=async()=>{const Fe=de.current;if(!Fe)return;const xe=Fe.style.cssText;Fe.style.cssText=xe+";position:fixed;left:-10000px;top:0;display:block;z-index:-1;background:white;width:794px;padding:32px;";try{const we=await Ai(Fe,{scale:2,useCORS:!0}),Xe=we.toDataURL("image/png"),ut=new ds("p","mm","a4"),ft=ut.internal.pageSize.getWidth(),mt=ut.internal.pageSize.getHeight(),pt=ft,vt=we.height*pt/we.width;let Ot=0;for(;Ot<vt;)ut.addImage(Xe,"PNG",0,-Ot,pt,vt),Ot+=mt,Ot<vt&&ut.addPage();const Ae="PurchaseOrder_"+(Z.po_no||new Date().toISOString().slice(0,10))+".pdf";ut.save(Ae)}finally{Fe.style.cssText=xe}},ue=(Fe,xe,we)=>{const Xe=[...Ue];if(Xe[Fe]={...Xe[Fe],[xe]:we},xe==="item_id"){const We=k.find(et=>String(et.id)===String(we)),De=(We==null?void 0:We.uom)||ot;Xe[Fe].uom=De;let rt=We&&Number(We.cost_price)||0;if(Array.isArray(X)&&X.length){const et=X.filter(Qt=>String(Qt.product_id)===String(we)).sort((Qt,Qe)=>{const he=Qt.effective_date?new Date(Qt.effective_date).getTime():0;return(Qe.effective_date?new Date(Qe.effective_date).getTime():0)-he||new Date(Qe.created_at).getTime()-new Date(Qt.created_at).getTime()});et.length>0&&(rt=Number(et[0].cost_price)||rt)}Xe[Fe].unit_price=rt}const ut=Number(Xe[Fe].qty)||0,ft=Number(Xe[Fe].unit_price)||0,mt=Number(Xe[Fe].discount_percent)||0,pt=Number(Xe[Fe].tax_percent)||0,vt=ut*ft,Ot=vt*(mt/100),Ae=vt-Ot,je=Ae*(pt/100);Xe[Fe].line_total=Ae+je,Be(Xe)},ge=()=>{Be(Fe=>[...Fe,{item_id:"",qty:0,uom:"",unit_price:0,discount_percent:0,tax_percent:0,line_total:0}])},Ve=Fe=>{Be(xe=>xe.length>1?xe.filter((we,Xe)=>Xe!==Fe):xe)},tt=async Fe=>{var xe,we,Xe,ut,ft,mt,pt;Fe.preventDefault(),c(!0),A("");try{const vt=(Xe=(we=(xe=Fe==null?void 0:Fe.nativeEvent)==null?void 0:xe.submitter)==null?void 0:we.dataset)==null?void 0:Xe.submitType,Ot=vt==="pending"?"PENDING_APPROVAL":vt==="draft"?"DRAFT":Z.status||"DRAFT";if(!Z.supplier_id){A("Supplier is required"),c(!1);return}const Ae=Ue.filter(We=>We.item_id&&Number(We.qty)>0&&Number(We.unit_price)>0);if(Ae.length===0){A("At least one item with quantity and unit price is required"),c(!1);return}const je={po_no:Z.po_no,po_date:Z.po_date,po_type:"IMPORT",status:Ot,supplier_id:Number(Z.supplier_id),warehouse_id:Number(Z.warehouse_id)||null,currency:Z.currency,exchange_rate:Number(Z.exchange_rate)||1,delivery_date:Z.delivery_date||"",payment_terms:Number(Z.payment_terms)||0,delivery_terms:Z.delivery_terms||"",remarks:Z.remarks||"",port_loading:Z.port_loading||"",port_discharge:Z.port_discharge||"",incoterms:Z.incoterms||"",hs_code:Z.hs_code||"",shipping_date:Z.shipping_date||"",insurance_required:!!Z.insurance_required,freight_amount:Number(Z.freight_amount)||0,other_charges:Number(Z.other_charges)||0,discount_amount:xt.totalDiscount,tax_amount:xt.totalTax,total_amount:xt.grandTotal,terms_conditions:Z.terms_conditions||"",quotation_id:Z.quotation_id?Number(Z.quotation_id):void 0,details:Ae.map(We=>({item_id:Number(We.item_id),qty:Number(We.qty)||0,uom:We.uom||"",unit_price:Number(We.unit_price)||0,discount_percent:Number(We.discount_percent)||0,tax_percent:Number(We.tax_percent)||0,line_total:Number(We.line_total)||0}))};if(vt==="pending"){if(i)await ee.post(`/purchase/orders/${t}/submit`,{amount:xt.grandTotal??null,workflow_id:N?N.id:null,target_user_id:z||null});else{const We=await ee.post("/purchase/orders",je),De=(ut=We==null?void 0:We.data)==null?void 0:ut.id;De&&await ee.post(`/purchase/orders/${De}/submit`,{amount:xt.grandTotal??null,workflow_id:N?N.id:null,target_user_id:z||null})}r("/purchase/purchase-orders-import");return}if(i)await ee.put(`/purchase/orders/${t}/status`,{status:Ot});else{const We=await ee.post("/purchase/orders",je),De=(ft=We==null?void 0:We.data)==null?void 0:ft.id;De&&Ot!=="DRAFT"&&await ee.put(`/purchase/orders/${De}/status`,{status:Ot})}r("/purchase/purchase-orders-import")}catch(vt){const Ot=((pt=(mt=vt==null?void 0:vt.response)==null?void 0:mt.data)==null?void 0:pt.message)||(vt==null?void 0:vt.message)||"Error saving purchase order. Please try again.";A(Ot)}finally{c(!1)}},Ze=async()=>{var Fe,xe,we;if(!n){q(!0),j("");try{const Xe=await ee.post(`/purchase/orders/${t}/submit`,{amount:xt.grandTotal??null,workflow_id:N?N.id:null,target_user_id:z||null}),ut=((Fe=Xe==null?void 0:Xe.data)==null?void 0:Fe.status)||"PENDING_APPROVAL";ve(ft=>({...ft,status:ut})),g(!1)}catch(Xe){j(((we=(xe=Xe==null?void 0:Xe.response)==null?void 0:xe.data)==null?void 0:we.message)||"Failed to forward for approval")}finally{q(!1)}}};return console.log("Rendering PurchaseOrdersImportForm",{id:t,isNew:n,isEdit:i,isView:l}),e.jsxs("div",{className:"w-full pb-10",children:[e.jsx("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:_e.logoUrl||qs,alt:_e.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:_e.name||"Company"}),_e.address&&e.jsx("div",{children:_e.address}),(_e.city||_e.state||_e.country)&&e.jsx("div",{children:[_e.city,_e.state,_e.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[_e.phone&&e.jsx("span",{children:_e.phone}),_e.email&&e.jsx("span",{children:_e.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",Z.po_date||""]}),e.jsxs("div",{children:["PO #: ",Z.po_no||""]})]})]})}),e.jsxs("div",{className:"w-full bg-white rounded-xl shadow-[0_4px_20px_rgba(14,54,70,0.15)] overflow-hidden",children:[e.jsxs("div",{className:"bg-[#0E3646] text-white p-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:" Purchase Order"}),e.jsx("p",{className:"opacity-90",children:"Create local and import purchase orders"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center p-5 bg-[#f8f9fa] border-b border-[#dee2e6] gap-4",children:[e.jsx("div",{className:"flex bg-[#f8f9fa] p-1 rounded-md border border-[#dee2e6]",children:e.jsx("button",{type:"button",className:`px-5 py-2.5 rounded text-sm font-semibold transition-all ${Z.po_type==="IMPORT"?"bg-[#0E3646] text-white":"text-gray-500 hover:bg-gray-200"}`,onClick:()=>ve({...Z,po_type:"IMPORT"}),children:" Import Order"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Le,{to:"/purchase/purchase-orders-import",className:"btn btn-secondary font-medium flex items-center gap-2",children:" View Orders"}),e.jsxs("button",{type:"button",onClick:Te,className:"btn-outline font-medium flex items-center gap-2",children:[e.jsx(Yc,{className:"w-4 h-4"}),"Download PDF"]}),e.jsxs("button",{type:"button",onClick:Ce,className:"btn-primary font-medium flex items-center gap-2",children:[e.jsx(qh,{className:"w-4 h-4"}),"Print"]})]})]}),e.jsxs("div",{className:"p-8",children:[o&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),h&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded mb-6 border border-red-200",children:h}),e.jsxs("form",{onSubmit:tt,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Purchase Order Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Number"}),e.jsx("input",{type:"text",name:"po_no",value:Z.po_no,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10 bg-[#e9ecef] cursor-not-allowed",readOnly:!0,placeholder:"Auto-generated"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"PO Date"}),e.jsx("input",{type:"date",name:"po_date",value:Z.po_date,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Order Type"}),e.jsx("input",{type:"text",value:Z.po_type,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm bg-[#e9ecef]",readOnly:!0})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Status"}),e.jsx("div",{children:e.jsx("span",{className:"px-4 py-1.5 rounded-full text-xs font-bold bg-[#e9ecef] text-[#495057]",children:Z.status})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Supplier"}),e.jsxs("select",{name:"supplier_id",value:Z.supplier_id,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",required:!0,children:[e.jsx("option",{value:"",children:"Select Supplier"}),Array.isArray(G)&&G.map(Fe=>Fe&&e.jsx("option",{value:Fe.id,children:Fe.supplier_name||Fe.name||"Unknown Supplier"},Fe.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Reference Quotation"}),e.jsxs("select",{name:"quotation_id",value:Z.quotation_id,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Quotation"}),Array.isArray(Q)&&Q.map(Fe=>Fe&&e.jsxs("option",{value:Fe.id,children:[Fe.quotation_no," - ",Fe.supplier_name]},Fe.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Warehouse"}),e.jsxs("select",{name:"warehouse_id",value:Z.warehouse_id,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Warehouse"}),Array.isArray(J)&&J.map(Fe=>Fe&&e.jsx("option",{value:Fe.id,children:Fe.warehouse_name||Fe.name||"Unknown Warehouse"},Fe.id))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Currency"}),e.jsxs("select",{name:"currency",value:Z.currency,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"GHS",children:"GHS - Ghana Cedi"}),e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Exchange Rate"}),e.jsx("input",{type:"number",name:"exchange_rate",value:Z.exchange_rate,onChange:be,step:"0.01",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5 required",children:"Expected Delivery Date"}),e.jsx("input",{type:"date",name:"delivery_date",value:Z.delivery_date,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",name:"payment_terms",value:Z.payment_terms,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Delivery Terms"}),e.jsxs("select",{name:"delivery_terms",value:Z.delivery_terms,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select Terms"}),e.jsx("option",{value:"FOB",children:"FOB - Free on Board"}),e.jsx("option",{value:"CIF",children:"CIF - Cost, Insurance & Freight"}),e.jsx("option",{value:"EXW",children:"EXW - Ex Works"}),e.jsx("option",{value:"DDP",children:"DDP - Delivered Duty Paid"})]})]})]})]}),Z.po_type==="IMPORT"&&e.jsxs("div",{className:"mb-8 bg-[#fff3cd] border-l-4 border-[#ffc107] p-6 rounded",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-4",children:" Import Order Details"}),e.jsxs("div",{className:"bg-[#e7f3ff] border-l-4 border-[#17a2b8] p-4 rounded mb-5 text-sm text-[#0c5460]",children:[e.jsx("strong",{children:" Import Order:"})," Additional documentation and compliance requirements apply for international procurement."]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Port of Loading"}),e.jsx("input",{type:"text",name:"port_loading",value:Z.port_loading,onChange:be,placeholder:"e.g., Shanghai, China",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Port of Discharge"}),e.jsx("input",{type:"text",name:"port_discharge",value:Z.port_discharge,onChange:be,placeholder:"e.g., Tema Port, Ghana",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Incoterms"}),e.jsxs("select",{name:"incoterms",value:Z.incoterms,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"FOB",children:"FOB"}),e.jsx("option",{value:"CIF",children:"CIF"}),e.jsx("option",{value:"CFR",children:"CFR"}),e.jsx("option",{value:"EXW",children:"EXW"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"HS Code"}),e.jsx("input",{type:"text",name:"hs_code",value:Z.hs_code,onChange:be,placeholder:"Harmonized System Code",className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Expected Shipping Date"}),e.jsx("input",{type:"date",name:"shipping_date",value:Z.shipping_date,onChange:be,className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-[13px] font-bold text-[#0E3646] mb-1.5",children:"Insurance Required"}),e.jsxs("select",{name:"insurance_required",value:Z.insurance_required?"YES":"NO",onChange:Fe=>ve({...Z,insurance_required:Fe.target.value==="YES"}),className:"p-2.5 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",children:[e.jsx("option",{value:"YES",children:"Yes"}),e.jsx("option",{value:"NO",children:"No"})]})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646]",children:" Order Items"}),e.jsx("button",{type:"button",onClick:ge,className:"px-4 py-2 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all text-sm font-medium flex items-center gap-2",children:" Add Item"})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsx("div",{className:"mb-2 text-xs text-slate-600",children:"If a unit conversion exists for the selected item and UOM, use the number of UOM button beside the UOM to convert quantity to the items default for accurate costing."}),e.jsxs("table",{className:"w-full border-collapse bg-white rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-[#0E3646] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 text-left text-[13px] w-[50px]",children:"#"}),e.jsx("th",{className:"p-3 text-left text-[13px]",children:"Item Name"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Qty"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"UOM"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[120px]",children:"Unit Price"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[100px]",children:"Disc %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[140px]",children:"Tax %"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[150px]",children:"Net Amount"}),e.jsx("th",{className:"p-3 text-left text-[13px] w-[80px]",children:"Action"})]})}),e.jsx("tbody",{children:Ue.map((Fe,xe)=>Fe&&e.jsxs("tr",{className:"border-b border-[#dee2e6] hover:bg-[#0E3646]/5 transition-colors",children:[e.jsx("td",{className:"p-3 text-sm",children:xe+1}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:Fe.item_id,onChange:we=>ue(xe,"item_id",we.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm focus:outline-none focus:border-[#0E3646]",required:!0,children:[e.jsx("option",{value:"",children:"Select Item"}),Array.isArray(k)&&k.map(we=>we&&e.jsx("option",{value:we.id,children:we.item_name||we.item_code||"Unknown Item"},we.id))]})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Fe.qty,onChange:we=>ue(xe,"qty",we.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsxs("td",{className:"p-3",children:[e.jsxs("select",{value:Fe.uom||ot||"",onChange:we=>ue(xe,"uom",we.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-center focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"Select UOM"}),Array.isArray(Ye)&&Ye.map(we=>we&&e.jsx("option",{value:we.uom_code,children:we.uom_name?`${we.uom_name} (${we.uom_code})`:we.uom_code},we.id))]}),(()=>{const we=k.find(pt=>String(pt.id)===String(Fe.item_id)),Xe=(we==null?void 0:we.uom)&&String(we.uom)||(ot?String(ot):""),ut=String(Fe.uom||""),ft=Array.isArray(ce)&&ce.some(pt=>Number(pt.is_active)&&Number(pt.item_id)===Number(Fe.item_id)&&String(pt.from_uom)===ut&&String(pt.to_uom)===Xe);return ut&&Xe&&ut!==Xe&&String(Fe.item_id||"")&&ft?e.jsx("button",{type:"button",className:"ml-2 px-2 py-1 text-xs border border-brand text-brand rounded hover:bg-brand hover:text-white transition-colors",onClick:()=>le({open:!0,itemId:Fe.item_id,defaultUom:Xe,currentUom:ut,rowIdx:xe}),children:`number of ${ut}`}):null})()]}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Fe.unit_price,onChange:we=>ue(xe,"unit_price",we.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsx("input",{type:"number",value:Fe.discount_percent,onChange:we=>ue(xe,"discount_percent",we.target.value),className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",min:"0",max:"100",step:"1"})}),e.jsx("td",{className:"p-3",children:e.jsxs("select",{value:(()=>{const we=te.find(Xe=>Number(Xe.rate)===Number(Fe.tax_percent||0));return we?we.value:""})(),onChange:we=>{const Xe=we.target.value,ut=te.find(mt=>String(mt.value)===String(Xe)),ft=ut?ut.rate:0;ue(xe,"tax_percent",ft)},className:"w-full p-2 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]",children:[e.jsx("option",{value:"",children:"No Tax"}),te.map(we=>e.jsx("option",{value:we.value,children:we.label},we.value))]})}),e.jsxs("td",{className:"p-3 text-right font-medium text-sm",children:[Z.currency," ",Fe.line_total.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("button",{type:"button",onClick:()=>Ve(xe),className:"text-[#dc3545] hover:bg-[#dc3545]/10 p-1.5 rounded transition-colors",children:""})})]},xe))})]})]}),e.jsxs("div",{className:"bg-[#f8f9fa] p-5 rounded-lg mt-5 border border-[#dee2e6]",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Items:"}),e.jsx("span",{className:"font-bold",children:Ue.filter(Fe=>Fe&&Fe.item_id).length})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sub Total:"}),e.jsxs("span",{className:"font-bold",children:[Z.currency," ",xt.subTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#dc3545]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Discount:"}),e.jsxs("span",{className:"font-bold",children:["-",Z.currency," ",xt.totalDiscount.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] text-[#0E3646]",children:[e.jsx("span",{className:"text-sm font-medium",children:"Tax Amount:"}),e.jsxs("span",{className:"font-bold",children:[Z.currency," ",xt.totalTax.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Freight Charges:"}),e.jsx("input",{type:"number",name:"freight_amount",value:Z.freight_amount,onChange:be,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b border-[#dee2e6] items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Other Charges:"}),e.jsx("input",{type:"number",name:"other_charges",value:Z.other_charges,onChange:be,className:"w-[150px] p-1.5 border border-[#dee2e6] rounded text-sm text-right focus:outline-none focus:border-[#0E3646]"})]}),e.jsxs("div",{className:"flex justify-between py-3 text-lg font-bold text-[#0E3646]",children:[e.jsx("span",{children:"GRAND TOTAL:"}),e.jsxs("span",{children:[Z.currency," ",xt.grandTotal.toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-lg font-semibold text-[#0E3646] mb-5 pb-2 border-b-2 border-[#0E3646]",children:" Terms & Conditions"}),e.jsx("div",{className:"flex flex-col",children:e.jsx("textarea",{name:"terms_conditions",value:Z.terms_conditions,onChange:be,rows:"6",className:"p-3 border border-[#dee2e6] rounded-md text-sm focus:outline-none focus:border-[#0E3646] focus:ring-2 focus:ring-[#0E3646]/10",placeholder:"Enter terms and conditions..."})})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-8 gap-4",children:[e.jsx("div",{children:e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#dc3545] text-white rounded hover:bg-[#c82333] transition-all font-medium flex items-center gap-2",onClick:()=>alert("Delete functionality not implemented yet"),children:" Delete"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{type:"button",className:"px-5 py-2.5 bg-[#6c757d] text-white rounded hover:bg-[#5a6268] transition-all font-medium flex items-center gap-2",onClick:()=>ve({...Z,remarks:""}),children:" Clear"}),!l&&e.jsx("button",{type:"submit",disabled:d,"data-submit-type":"draft",className:"px-5 py-2.5 bg-[#0E3646] text-white rounded hover:bg-[#082330] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:d?"Saving...":" Save as Draft"}),!l&&e.jsx("button",{type:"submit",disabled:d,"data-submit-type":"pending",className:"px-5 py-2.5 bg-[#28a745] text-white rounded hover:bg-[#218838] transition-all font-medium flex items-center gap-2 disabled:opacity-70",children:" Submit for Approval"})]})]})]})]})]}),e.jsxs("div",{ref:de,className:"hidden p-8 bg-white",style:{width:"794px",maxWidth:"794px"},children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:_e.logoUrl||qs,alt:_e.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:_e.name||"Company"}),_e.address&&e.jsx("div",{children:_e.address}),(_e.city||_e.state||_e.country)&&e.jsx("div",{children:[_e.city,_e.state,_e.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[_e.phone&&e.jsx("span",{children:_e.phone}),_e.email&&e.jsx("span",{children:_e.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Purchase Order"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",Z.po_date||""]}),e.jsxs("div",{children:["PO #: ",Z.po_no||""]}),e.jsxs("div",{children:["Supplier:"," ",((ht=G.find(Fe=>String(Fe.id)===String(Z.supplier_id)))==null?void 0:ht.supplier_name)||((ze=G.find(Fe=>String(Fe.id)===String(Z.supplier_id)))==null?void 0:ze.name)||""]}),e.jsxs("div",{children:["Currency: ",Z.currency||""]}),e.jsxs("div",{children:["Exchange Rate: ",Number(Z.exchange_rate||1).toFixed(2)]}),Z.incoterms&&e.jsxs("div",{children:["Incoterms: ",Z.incoterms]}),Z.port_loading&&e.jsxs("div",{children:["Port Loading: ",Z.port_loading]}),Z.port_discharge&&e.jsxs("div",{children:["Port Discharge: ",Z.port_discharge]})]})]}),e.jsx("div",{className:"mb-2",style:{width:"100%",overflow:"visible",margin:"0 auto"},children:e.jsxs("table",{className:"text-sm",style:{width:"100%",tableLayout:"fixed"},children:[e.jsxs("colgroup",{children:[e.jsx("col",{style:{width:"40%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}}),e.jsx("col",{style:{width:"20%"}})]}),e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left",children:"Description"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Quantity"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"px-2 py-2 text-right",children:"Net Amount"})]})}),e.jsx("tbody",{children:Ue.map((Fe,xe)=>{const we=k.find(ut=>String(ut.id)===String(Fe.item_id)),Xe=(we==null?void 0:we.item_name)||(we==null?void 0:we.item_code)||"Item";return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2",children:Xe}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Fe.qty||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Fe.unit_price||0).toFixed(2)}),e.jsx("td",{className:"px-2 py-2 text-right",children:Number(Fe.line_total||0).toFixed(2)})]},xe)})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("div",{className:"px-2 py-1 font-medium",children:"Gross Subtotal"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(xt.subTotal||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Discount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(xt.totalDiscount||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Net Sub Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Number(xt.subTotal-xt.totalDiscount||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Tax Amount"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(xt.totalTax||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Freight Charges"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(xt.freight||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-medium",children:"Other Charges"}),e.jsx("div",{className:"px-2 py-1 text-right",children:Number(xt.other||0).toFixed(2)}),e.jsx("div",{className:"px-2 py-1 font-semibold",children:"Total"}),e.jsx("div",{className:"px-2 py-1 text-right font-semibold",children:Number(xt.grandTotal||0).toFixed(2)})]})})})]})]}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{g(!1),S(null),P(null),j("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:Z.po_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:N?`${N.workflow_name} (${N.workflow_code})`:"None (inactive)"})]}),e.jsx("div",{children:v?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null}),e.jsx("div",{children:y?e.jsx("div",{className:"text-sm text-red-600",children:y}):null}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const xe=Array.isArray(L)&&L.length>0?L[0]:null,we=xe?Array.isArray(xe.approvers)&&xe.approvers.length?xe.approvers.map(Xe=>({id:Xe.id,name:Xe.username})):xe.approver_user_id?[{id:xe.approver_user_id,name:xe.approver_name||String(xe.approver_user_id)}]:[]:[];return we.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:z||"",onChange:Xe=>I(Xe.target.value?Number(Xe.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),we.map(Xe=>e.jsx("option",{value:Xe.id,children:Xe.name},Xe.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:B?`Step ${B.stepOrder}  ${B.stepName}${B.approvalLimit!=null?`  Limit: ${Number(B.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:N?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{g(!1),S(null),P(null),j("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:Ze,disabled:H||n,children:H?"Forwarding...":"Forward"})]})]})}),e.jsx(sd,{open:Ie.open,itemId:Ie.itemId,defaultUom:Ie.defaultUom,currentUom:Ie.currentUom,onClose:()=>le({open:!1,itemId:null,defaultUom:"",currentUom:"",rowIdx:null}),onApply:Fe=>{const{converted_qty:xe}=Fe||{},we=Ie.rowIdx;we!=null&&Be(Xe=>{const ut=[...Xe],ft={...ut[we]},mt=Number(xe||0);ft.qty=mt,ft.uom=Ie.defaultUom||ft.uom;const pt=Number(ft.unit_price||0),vt=Number(ft.discount_percent||0),Ot=Number(ft.tax_percent||0),Ae=mt*pt,je=Ae*(vt/100),We=Ae-je,De=We*(Ot/100);return ft.line_total=We+De,ut[we]=ft,ut})}})]})}function pJ(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState([]);x.useEffect(()=>{let c=!0;return a(!0),i(""),ee.get("/purchase/shipping-advices").then(h=>{var A;c&&o(Array.isArray((A=h.data)==null?void 0:A.items)?h.data.items:[])}).catch(h=>{var A,f;c&&i(((f=(A=h==null?void 0:h.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load shipping advice")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=c=>({DRAFT:"badge-info",IN_TRANSIT:"badge-warning",ARRIVED:"badge-success",CLEARED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=x.useMemo(()=>{const c=t.toLowerCase();return l.filter(h=>{const A=String(h.advice_no||"").toLowerCase(),f=String(h.po_no||"").toLowerCase(),g=String(h.bill_of_lading||"").toLowerCase();return A.includes(c)||f.includes(c)||g.includes(c)})},[l,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Shipping Advice"}),e.jsx("p",{className:"text-sm mt-1",children:"Track shipments and vessel information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/shipping-advice/new",className:"btn-success",children:"+ New Shipping Advice"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by advice no / PO / vessel...",className:"input",value:t,onChange:c=>s(c.target.value)})})})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Advice No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"PO"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"ETD"}),e.jsx("th",{children:"ETA"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):n?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-red-600",children:n})}):null,d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No records"})}):d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:c.advice_no}),e.jsx("td",{children:c.advice_date?new Date(c.advice_date).toLocaleDateString():""}),e.jsx("td",{children:c.po_no}),e.jsx("td",{children:c.supplier_name}),e.jsx("td",{children:c.etd_date?new Date(c.etd_date).toLocaleDateString():"-"}),e.jsx("td",{children:c.eta_date?new Date(c.eta_date).toLocaleDateString():"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/purchase/shipping-advice/${c.id}?mode=view`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/purchase/shipping-advice/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))]})]})})]})]})}function dS(){const{id:t}=Ls(),s=ys(),r=!t||t==="new",{user:a}=ca(),[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState([]),[A,f]=x.useState({advice_no:"Auto-generated",advice_date:new Date().toISOString().split("T")[0],po_id:"",status:"IN_TRANSIT",shipping_method:"",shipping_company:"",tracking_number:"",vessel_name:"",voyage_number:"",port_of_loading:"",port_of_discharge:"",bl_number:"",bl_date:"",container_numbers:"",total_packages:0,gross_weight:0,volume:0,etd:"",eta:"",remarks:""}),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState([]),[S,B]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",logoUrl:""});x.useEffect(()=>{Promise.all([ee.get("/purchase/orders?status=APPROVED"),ee.get("/purchase/shipping-advices")]).then(([Y,J])=>{var O,R;const k=(Array.isArray((O=Y.data)==null?void 0:O.items)?Y.data.items:[]).filter(X=>String(X.po_type||"").toUpperCase()==="IMPORT"),Q=(Array.isArray((R=J.data)==null?void 0:R.items)?J.data.items:[]).filter(X=>String(X.status||"").toUpperCase()!=="CANCELLED"),C=new Set(Q.map(X=>X.po_id||X.poId).filter(X=>X!=null).map(X=>String(X))),E=new Set(Q.map(X=>X.po_no||X.poNo).filter(X=>X!=null).map(X=>String(X))),w=k.filter(X=>{const ne=String(X.id),te=String(X.po_no||X.poNo||"");return!(C.has(ne)||te&&E.has(te))});h(w)}).catch(Y=>console.error(Y))},[]),x.useEffect(()=>{P()},[]),x.useEffect(()=>{r&&(async()=>{var Y;try{const T=(Y=(await ee.get("/purchase/shipping-advices/next-no")).data)==null?void 0:Y.nextNo;T&&f(k=>({...k,advice_no:T}))}catch{}})()},[r]);async function P(){var Y,J,T;try{const D=(J=(Y=(await ee.get("/admin/me")).data)==null?void 0:Y.scope)==null?void 0:J.companyId;if(D){const C=((T=(await ee.get(`/admin/companies/${D}`)).data)==null?void 0:T.item)||{};B(E=>({...E,name:C.name||E.name||"",address:C.address||E.address||"",phone:C.telephone||E.phone||"",email:C.email||E.email||"",city:C.city||E.city||"",state:C.state||E.state||"",country:C.country||E.country||"",logoUrl:C.has_logo===1||C.has_logo===!0?`/api/admin/companies/${D}/logo`:qs}))}else B(Q=>({...Q,logoUrl:Q.logoUrl||qs}))}catch{B(k=>({...k,logoUrl:k.logoUrl||qs}))}}x.useEffect(()=>{r||(i(!0),ee.get(`/purchase/shipping-advices/${t}`).then(Y=>{var k;const J=((k=Y.data)==null?void 0:k.item)||{},T=J.details||[];f({advice_no:J.advice_no,advice_date:J.advice_date?J.advice_date.split("T")[0]:"",po_id:J.po_id,supplier_id:J.supplier_id,status:J.status,tracking_number:J.bill_of_lading||"",vessel_name:J.vessel_name||"",container_numbers:J.container_no||"",etd:J.etd_date?J.etd_date.split("T")[0]:"",eta:J.eta_date?J.eta_date.split("T")[0]:"",remarks:J.remarks||""}),v(T.map(D=>({item_id:D.item_id,item_code:D.item_code,item_name:D.item_name,ordered_qty:0,shipped_qty:D.qty_shipped,uom:"pcs",remarks:D.remarks||""})))}).catch(Y=>{var J,T;return d(((T=(J=Y==null?void 0:Y.response)==null?void 0:J.data)==null?void 0:T.message)||"Failed to load data")}).finally(()=>i(!1)))},[t,r]),x.useEffect(()=>{A.po_id&&ee.get(`/purchase/orders/${A.po_id}`).then(Y=>{var k,D,Q;const J=((D=(k=Y.data)==null?void 0:k.item)==null?void 0:D.details)||[],T=(Q=Y.data)==null?void 0:Q.item;if(N(J),T&&T.supplier_id&&f(C=>({...C,supplier_id:T.supplier_id})),r&&g.length===0){const C=J.map(E=>({item_id:E.item_id,item_code:E.item_code,item_name:E.item_name,ordered_qty:E.qty,shipped_qty:E.qty,uom:E.uom||"pcs",package_numbers:"",remarks:""}));v(C)}else g.length>0&&v(C=>C.map(E=>{const w=J.find(O=>String(O.item_id)===String(E.item_id));return w?{...E,ordered_qty:w.qty}:E}))}).catch(console.error)},[A.po_id,r]);const L=Y=>{const{name:J,value:T}=Y.target;f(k=>({...k,[J]:T}))},U=(Y,J,T)=>{const k=[...g];k[Y]={...k[Y],[J]:T},v(k)},H=Y=>{v(g.filter((J,T)=>T!==Y))},q=()=>{y([{status_title:"",status_date:new Date().toISOString().slice(0,16),description:"",location:""},...b])},V=(Y,J,T)=>{const k=[...b];k[Y]={...k[Y],[J]:T},y(k)},M=Y=>{y(b.filter((J,T)=>T!==Y))},z=async Y=>{var J,T,k;Y.preventDefault(),o(!0),d("");try{const D=((J=c.find(C=>String(C.id)===String(A.po_id)))==null?void 0:J.supplier_id)||null,Q={advice_no:A.advice_no,advice_date:A.advice_date,po_id:A.po_id,supplier_id:A.supplier_id||D,status:A.status||"IN_TRANSIT",vessel_name:A.vessel_name||null,bill_of_lading:A.tracking_number||null,container_no:A.container_numbers||null,etd_date:A.etd||null,eta_date:A.eta||null,remarks:A.remarks||null,details:g.map(C=>({item_id:C.item_id,qty_shipped:Number(C.shipped_qty)||0,remarks:C.remarks||null}))};r?await ee.post("/purchase/shipping-advices",Q):await ee.put(`/purchase/shipping-advices/${t}`,Q),s("/purchase/shipping-advice")}catch(D){d(((k=(T=D==null?void 0:D.response)==null?void 0:T.data)==null?void 0:k.message)||"Failed to save")}finally{o(!1)}},I=()=>{alert("Notification sent to warehouse and stakeholders!")},G=()=>{window.print()};return e.jsxs("div",{className:"space-y-6 pb-20",children:[e.jsx("div",{className:"hidden print:block p-8 max-w-[19cm] mx-auto",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:S.logoUrl||qs,alt:S.name||"Company",className:"w-16 h-16 object-contain border border-gray-300"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-semibold text-base",children:S.name||"Company"}),S.address&&e.jsx("div",{children:S.address}),(S.city||S.state||S.country)&&e.jsx("div",{children:[S.city,S.state,S.country].filter(Boolean).join(", ")}),e.jsxs("div",{className:"flex gap-3",children:[S.phone&&e.jsx("span",{children:S.phone}),S.email&&e.jsx("span",{children:S.email})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xl font-semibold",children:"Shipping Advice"})}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{children:["DATE: ",A.advice_date||""]}),e.jsxs("div",{children:["Advice #: ",A.advice_no||""]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[r?"New":"Edit"," Shipping Advice"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Manage shipment details, tracking, and items."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase/shipping-advice",className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{onClick:G,className:"btn btn-outline",type:"button",children:"Print"}),e.jsx("button",{onClick:z,className:"btn btn-primary",disabled:l,children:l?"Saving...":"Save Advice"})]})]}),u&&e.jsx("div",{className:"p-4 bg-red-50 text-red-700 rounded-lg border border-red-200",children:u}),n?e.jsx("div",{className:"text-center py-10",children:"Loading..."}):e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"General Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Advice No"}),e.jsx("input",{type:"text",className:"input bg-slate-100",value:A.advice_no,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Advice Date *"}),e.jsx("input",{type:"date",className:"input",name:"advice_date",value:A.advice_date,onChange:L,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Purchase Order *"}),e.jsxs("select",{className:"input",name:"po_id",value:A.po_id,onChange:L,required:!0,disabled:!r&&g.length>0,children:[e.jsx("option",{value:"",children:"Select PO..."}),c.map(Y=>e.jsxs("option",{value:Y.id,children:[Y.po_no," - ",Y.supplier_name]},Y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",name:"status",value:A.status,onChange:L,children:[e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"IN_TRANSIT",children:"In Transit"}),e.jsx("option",{value:"ARRIVED",children:"Arrived"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Shipment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shipping Method"}),e.jsxs("select",{className:"input",name:"shipping_method",value:A.shipping_method,onChange:L,children:[e.jsx("option",{value:"",children:"Select..."}),e.jsx("option",{value:"SEA",children:"Sea Freight"}),e.jsx("option",{value:"AIR",children:"Air Freight"}),e.jsx("option",{value:"ROAD",children:"Road Freight"}),e.jsx("option",{value:"COURIER",children:"Courier"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Shipping Company"}),e.jsx("input",{type:"text",className:"input",name:"shipping_company",value:A.shipping_company,onChange:L,placeholder:"e.g. Maersk, DHL"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tracking / BL No"}),e.jsx("input",{type:"text",className:"input",name:"tracking_number",value:A.tracking_number,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Vessel / Flight Name"}),e.jsx("input",{type:"text",className:"input",name:"vessel_name",value:A.vessel_name,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voyage No"}),e.jsx("input",{type:"text",className:"input",name:"voyage_number",value:A.voyage_number,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Loading"}),e.jsx("input",{type:"text",className:"input",name:"port_of_loading",value:A.port_of_loading,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Discharge"}),e.jsx("input",{type:"text",className:"input",name:"port_of_discharge",value:A.port_of_discharge,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Container Nos"}),e.jsx("input",{type:"text",className:"input",name:"container_numbers",value:A.container_numbers,onChange:L,placeholder:"Comma separated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ETD (Estimated Departure)"}),e.jsx("input",{type:"date",className:"input",name:"etd",value:A.etd,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ETA (Estimated Arrival)"}),e.jsx("input",{type:"date",className:"input",name:"eta",value:A.eta,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Total Packages"}),e.jsx("input",{type:"number",className:"input",name:"total_packages",value:A.total_packages,onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Gross Weight (kg)"}),e.jsx("input",{type:"number",className:"input",name:"gross_weight",value:A.gross_weight,onChange:L,step:"0.01"})]})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Items in Shipment"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>{},children:"Refresh from PO"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{className:"w-24",children:"Ordered"}),e.jsx("th",{className:"w-32",children:"Shipped Qty"}),e.jsx("th",{className:"w-24",children:"UOM"}),e.jsx("th",{children:"Package Nos"}),e.jsx("th",{children:"Remarks"}),e.jsx("th",{className:"w-10"})]})}),e.jsxs("tbody",{children:[g.map((Y,J)=>e.jsxs("tr",{children:[e.jsx("td",{children:Y.item_code}),e.jsx("td",{children:Y.item_name}),e.jsx("td",{className:"text-slate-500",children:Y.ordered_qty}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input input-sm w-full",value:Y.shipped_qty,onChange:T=>U(J,"shipped_qty",T.target.value),step:"0.01"})}),e.jsx("td",{children:Y.uom}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input input-sm w-full",value:Y.package_numbers,onChange:T=>U(J,"package_numbers",T.target.value),placeholder:"e.g. 1-10"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"input input-sm w-full",value:Y.remarks,onChange:T=>U(J,"remarks",T.target.value)})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700",onClick:()=>H(J),children:""})})]},J)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center py-4 text-slate-500",children:"No items selected. Select a PO to populate items."})})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Tracking Timeline"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-primary",onClick:q,children:"+ Add Event"})]}),e.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[b.map((Y,J)=>e.jsxs("div",{className:"flex gap-4 items-start p-3 bg-slate-50 dark:bg-slate-800 rounded-lg border",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("input",{type:"text",className:"input input-sm font-semibold",placeholder:"Status (e.g. Departed)",value:Y.status_title,onChange:T=>V(J,"status_title",T.target.value)}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"datetime-local",className:"input input-sm w-full",value:Y.status_date?new Date(Y.status_date).toISOString().slice(0,16):"",onChange:T=>V(J,"status_date",T.target.value)}),e.jsx("input",{type:"text",className:"input input-sm w-full",placeholder:"Location",value:Y.location,onChange:T=>V(J,"location",T.target.value)})]}),e.jsx("textarea",{className:"input input-sm w-full",placeholder:"Description / Notes",rows:"2",value:Y.description,onChange:T=>V(J,"description",T.target.value)})]}),e.jsx("button",{type:"button",className:"text-red-500",onClick:()=>M(J),children:""})]},J)),b.length===0&&e.jsx("p",{className:"text-center text-slate-500 py-4",children:"No tracking updates yet."})]})]}),e.jsxs("div",{className:"card p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 border-b pb-2",children:"Additional Remarks"}),e.jsx("textarea",{className:"input w-full h-32",name:"remarks",value:A.remarks,onChange:L,placeholder:"Any internal notes or instructions..."})]}),e.jsxs("div",{className:"pt-6 border-t",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{type:"button",className:"btn btn-info w-full sm:w-auto",onClick:I,children:" Send Arrival Notification"}),e.jsx("button",{type:"button",className:"btn btn-secondary w-full sm:w-auto",onClick:()=>y(Y=>[{status_title:"Arrived at Port",status_date:new Date().toISOString(),location:A.port_of_discharge||"Port",description:"Vessel has arrived at discharge port."},...Y]),children:" Mark as Arrived"})]})]})]})]})]})]})}function xJ(){const[t,s]=x.useState(""),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState([]);x.useEffect(()=>{let c=!0;return a(!0),i(""),ee.get("/purchase/port-clearances").then(h=>{var A;c&&o(Array.isArray((A=h.data)==null?void 0:A.items)?h.data.items:[])}).catch(h=>{var A,f;c&&i(((f=(A=h==null?void 0:h.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to load port clearances")}).finally(()=>{c&&a(!1)}),()=>{c=!1}},[]);const u=c=>({PENDING:"badge-warning",CLEARED:"badge-success",CANCELLED:"badge-error"})[c]||"badge-info",d=x.useMemo(()=>{const c=t.toLowerCase();return l.filter(h=>{const A=String(h.clearance_no||"").toLowerCase(),f=String(h.advice_no||"").toLowerCase();return A.includes(c)||f.includes(c)})},[l,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"Clearing at Port"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage customs and port clearances"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/port-clearances/new",className:"btn-success",children:"+ New Clearance"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by clearance no / shipping advice...",className:"input",value:t,onChange:c=>s(c.target.value)})})})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Clearance No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"PO"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Clearing Agent"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[r?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):n?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-red-600",children:n})}):null,d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No records"})}):d.map(c=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:c.clearance_no}),e.jsx("td",{children:c.clearance_date?new Date(c.clearance_date).toLocaleDateString():""}),e.jsx("td",{children:c.po_no||""}),e.jsx("td",{children:c.supplier_name||""}),e.jsx("td",{children:c.clearing_agent||""}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(c.status)}`,children:c.status})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/purchase/port-clearances/${c.id}?mode=view`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/purchase/port-clearances/${c.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ml-2",children:"Edit"})]})]},c.id))]})]})})]})]})}function uS(){const{id:t}=Ls(),s=ys(),r=!t||t==="new",[a,n]=x.useState(!1),[i,l]=x.useState(!1),[o,u]=x.useState(""),[d,c]=x.useState([]),[h,A]=x.useState({clearance_no:r?"Auto-generated":"",clearance_date:new Date().toISOString().split("T")[0],shipping_advice_id:"",status:"PENDING",port_of_entry:"",arrival_date:"",clearing_agent:"",target_clearance_date:"",customs_declaration_number:"",declaration_date:"",hs_code:"",assessment_date:"",total_clearance_cost:0}),[f,g]=x.useState([]);x.useEffect(()=>{let S=!0;return Promise.all([ee.get("/purchase/shipping-advices"),ee.get("/purchase/port-clearances")]).then(([B,P])=>{var V,M;if(!S)return;const L=Array.isArray((V=B.data)==null?void 0:V.items)?B.data.items:[],U=Array.isArray((M=P.data)==null?void 0:M.items)?P.data.items:[],H=new Set(U.map(z=>z.advice_id||z.adviceId).filter(z=>z!=null).map(z=>String(z))),q=L.filter(z=>{const I=String(z.status||"").toUpperCase(),G=I==="IN_TRANSIT"||I==="ARRIVED",Y=!H.has(String(z.id));return G&&Y});c(q)}).catch(B=>{S&&console.error("Failed to load shipping advice",B)}),()=>{S=!1}},[]),x.useEffect(()=>{r&&ee.get("/purchase/port-clearances/next-no").then(S=>{var P;const B=(P=S.data)==null?void 0:P.nextNo;B&&A(L=>({...L,clearance_no:B}))}).catch(()=>{})},[r]),x.useEffect(()=>{h.shipping_advice_id&&ee.get(`/purchase/shipping-advices/${h.shipping_advice_id}`).then(S=>{var P;const B=(P=S.data)==null?void 0:P.item;if(B){const L=B.eta_date&&typeof B.eta_date=="string"?B.eta_date.split("T")[0]:B.eta_date||"";A(U=>({...U,arrival_date:U.arrival_date||L||U.arrival_date,target_clearance_date:U.target_clearance_date||L||U.target_clearance_date}))}}).catch(console.error)},[h.shipping_advice_id]),x.useEffect(()=>{if(r)return;let S=!0;return n(!0),u(""),ee.get(`/purchase/port-clearances/${t}`).then(B=>{var L;if(!S)return;const P=(L=B.data)==null?void 0:L.item;if(P)if(A({clearance_no:P.clearance_no||"",clearance_date:P.clearance_date?typeof P.clearance_date=="string"?P.clearance_date.split("T")[0]:P.clearance_date:new Date().toISOString().split("T")[0],shipping_advice_id:P.advice_id?String(P.advice_id):"",status:P.status||"PENDING",port_of_entry:P.port_of_entry||"",arrival_date:P.arrival_date||"",clearing_agent:P.clearing_agent||"",target_clearance_date:P.target_clearance_date||"",customs_declaration_number:P.customs_entry_no||P.customs_declaration_number||"",declaration_date:P.declaration_date||"",hs_code:P.hs_code||"",assessment_date:P.assessment_date||"",total_clearance_cost:Number(P.total_clearance_cost)||Number(P.duty_amount||0)+Number(P.other_charges||0)||0}),B.data.charges&&Array.isArray(B.data.charges))g(B.data.charges.map(U=>({id:U.id,charge_type:U.charge_type,amount:U.amount,vendor_authority:U.vendor_authority||""})));else{const U=[];Number(P.duty_amount)>0&&U.push({charge_type:"DUTY",amount:P.duty_amount,vendor_authority:"Customs"}),Number(P.other_charges)>0&&U.push({charge_type:"OTHER",amount:P.other_charges,vendor_authority:"Other"}),g(U)}}).catch(B=>{var P,L;S&&u(((L=(P=B==null?void 0:B.response)==null?void 0:P.data)==null?void 0:L.message)||"Failed to load port clearance")}).finally(()=>{S&&n(!1)}),()=>{S=!1}},[t,r]),x.useEffect(()=>{const S=f.reduce((B,P)=>B+(Number(P.amount)||0),0);A(B=>({...B,total_clearance_cost:S}))},[f]);const v=S=>{const{name:B,value:P}=S.target;A(L=>({...L,[B]:P}))},b=()=>{g([...f,{charge_type:"DUTY",amount:0,vendor_authority:""}])},y=S=>{const B=[...f];B.splice(S,1),g(B)},j=(S,B,P)=>{const L=[...f];L[S]={...L[S],[B]:P},g(L)},N=async S=>{var B,P;S.preventDefault(),l(!0),u("");try{const L={...h,shipping_advice_id:Number(h.shipping_advice_id),charges:f.map(U=>({charge_type:U.charge_type,amount:Number(U.amount),vendor_authority:U.vendor_authority}))};r?await ee.post("/purchase/port-clearances",L):await ee.put(`/purchase/port-clearances/${t}`,L),s("/purchase/port-clearances")}catch(L){u(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to save port clearance")}finally{l(!1)}};return a?e.jsx("div",{className:"p-4",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[r?"New":"Edit"," Port Clearance"]}),e.jsx("p",{className:"text-sm mt-1 text-slate-500",children:"Manage customs declarations and port charges"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase/port-clearances",className:"btn-secondary",children:"Cancel"}),e.jsx("button",{onClick:N,disabled:i,className:"btn-primary",children:i?"Saving...":"Save Changes"})]})]}),o&&e.jsx("div",{className:"p-4 bg-red-50 text-red-700 rounded-md border border-red-200",children:o}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Clearance Details"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Clearance No"}),e.jsx("input",{type:"text",className:"input",value:h.clearance_no,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Clearance Date"}),e.jsx("input",{type:"date",className:"input",name:"clearance_date",value:h.clearance_date,onChange:v,required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Shipping Advice"}),e.jsxs("select",{className:"input",name:"shipping_advice_id",value:h.shipping_advice_id,onChange:v,required:!0,children:[e.jsx("option",{value:"",children:"Select Shipping Advice..."}),d.map(S=>e.jsxs("option",{value:S.id,children:[S.advice_no," - ",S.po_no," (",S.supplier_name,")"]},S.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",name:"status",value:h.status,onChange:v,children:[e.jsx("option",{value:"PENDING",children:"Pending"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"CLEARED",children:"Cleared"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Target Clearance Date"}),e.jsx("input",{type:"date",className:"input",name:"target_clearance_date",value:h.target_clearance_date,onChange:v})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Customs & Import Data"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Port of Entry"}),e.jsx("input",{type:"text",className:"input",name:"port_of_entry",value:h.port_of_entry,onChange:v,placeholder:"e.g. Tema Port"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Arrival Date"}),e.jsx("input",{type:"date",className:"input",name:"arrival_date",value:h.arrival_date,onChange:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Clearing Agent"}),e.jsx("input",{type:"text",className:"input",name:"clearing_agent",value:h.clearing_agent,onChange:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"HS Code"}),e.jsx("input",{type:"text",className:"input",name:"hs_code",value:h.hs_code,onChange:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customs Decl. No"}),e.jsx("input",{type:"text",className:"input",name:"customs_declaration_number",value:h.customs_declaration_number,onChange:v})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Declaration Date"}),e.jsx("input",{type:"date",className:"input",name:"declaration_date",value:h.declaration_date,onChange:v})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex justify-between items-center",children:[e.jsx("h3",{className:"card-title",children:"Charges & Duties"}),e.jsx("button",{type:"button",onClick:b,className:"btn-sm btn-secondary",children:"+ Add Charge"})]}),e.jsxs("div",{className:"card-body space-y-4",children:[f.length===0&&e.jsx("p",{className:"text-sm text-slate-500 italic",children:"No charges added yet."}),f.map((S,B)=>e.jsxs("div",{className:"flex gap-4 items-end border-b border-slate-100 pb-4 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"label text-xs",children:"Type"}),e.jsxs("select",{className:"input text-sm py-1",value:S.charge_type,onChange:P=>j(B,"charge_type",P.target.value),children:[e.jsx("option",{value:"DUTY",children:"Import Duty"}),e.jsx("option",{value:"VAT",children:"VAT"}),e.jsx("option",{value:"LEVY",children:"Import Levy"}),e.jsx("option",{value:"HANDLING",children:"Port Handling"}),e.jsx("option",{value:"STORAGE",children:"Storage Fees"}),e.jsx("option",{value:"OTHER",children:"Other Charges"})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"label text-xs",children:"Amount"}),e.jsx("input",{type:"number",step:"1",className:"input text-sm py-1",value:S.amount,onChange:P=>j(B,"amount",P.target.value)})]}),e.jsxs("div",{className:"flex-[2]",children:[e.jsx("label",{className:"label text-xs",children:"Vendor / Authority"}),e.jsx("input",{type:"text",className:"input text-sm py-1",value:S.vendor_authority,onChange:P=>j(B,"vendor_authority",P.target.value),placeholder:"e.g. GRA"})]}),e.jsx("button",{type:"button",onClick:()=>y(B),className:"text-red-500 hover:text-red-700 pb-2",children:""})]},B)),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-100",children:e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-medium text-slate-500 mr-4",children:"Total Cost:"}),e.jsx("span",{className:"text-xl font-bold text-slate-900",children:h.total_clearance_cost.toLocaleString(void 0,{minimumFractionDigits:2})})]})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Documents"})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"border-2 border-dashed border-slate-300 rounded-lg p-6 text-center hover:bg-slate-50 cursor-pointer transition-colors",children:[e.jsx("div",{className:"text-slate-400 mb-2",children:e.jsx("svg",{className:"w-8 h-8 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:"Click to upload documents"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"PDF, JPG, PNG up to 10MB"})]}),e.jsx("div",{className:"mt-4 space-y-2",children:e.jsx("p",{className:"text-xs text-slate-400 italic text-center",children:"No documents attached"})})]})]}),e.jsx("div",{className:"card bg-blue-50 border-blue-100",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-2",children:"Help & Instructions"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"Ensure all duties are calculated based on the latest HS Code rates."}),e.jsx("li",{children:"Attach scanned copies of the Customs Declaration."}),e.jsx("li",{children:"Update status to 'Cleared' only when goods have left the port."})]})]})})]})]})]})}function AS(){const s=ma().pathname.includes("purchase-bills-import")?"IMPORT":"LOCAL",[r,a]=x.useState(""),[n,i]=x.useState(!1),[l,o]=x.useState(""),[u,d]=x.useState([]);x.useEffect(()=>{let f=!0;return i(!0),o(""),ee.get("/purchase/bills",{params:{bill_type:s}}).then(g=>{var v;f&&d(Array.isArray((v=g.data)==null?void 0:v.items)?g.data.items:[])}).catch(g=>{var v,b;f&&o(((b=(v=g==null?void 0:g.response)==null?void 0:v.data)==null?void 0:b.message)||"Failed to load purchase bills")}).finally(()=>{f&&i(!1)}),()=>{f=!1}},[s]);const c=f=>({DRAFT:"badge-info",POSTED:"badge-success",CANCELLED:"badge-error"})[f]||"badge-info",h=f=>({UNPAID:"badge-error",PARTIALLY_PAID:"badge-warning",PAID:"badge-success"})[f]||"badge-info",A=x.useMemo(()=>{const f=r.toLowerCase();return u.filter(g=>{const v=String(g.bill_no||"").toLowerCase(),b=String(g.supplier_name||"").toLowerCase(),y=String(g.po_no||"").toLowerCase();return v.includes(f)||b.includes(f)||y.includes(f)})},[u,r]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:["Purchase Bills - ",s]}),e.jsx("p",{className:"text-sm mt-1",children:"Record and manage supplier bills"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:`/purchase/purchase-bills-${s.toLowerCase()}/new`,className:"btn-success",children:"+ New Bill"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by bill no / supplier / PO...",className:"input",value:r,onChange:f=>a(f.target.value)})})})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bill No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"PO"}),e.jsx("th",{className:"text-right",children:"Total"}),e.jsx("th",{className:"text-right",children:"Tax"}),e.jsx("th",{className:"text-right",children:"Net"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):l?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8 text-red-600",children:l})}):null,A.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"10",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No records"})}):A.map(f=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:f.bill_no}),e.jsx("td",{children:f.bill_date?new Date(f.bill_date).toLocaleDateString():""}),e.jsx("td",{children:f.supplier_name}),e.jsx("td",{children:f.po_no||"-"}),e.jsx("td",{className:"text-right font-medium",children:Number(f.total_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"text-right",children:Number(f.tax_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"text-right font-medium",children:Number(f.net_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${h(String(f.payment_status||""))}`,children:String(f.payment_status||"")||"-"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${c(f.status)}`,children:f.status})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/purchase/purchase-bills-${s.toLowerCase()}/${f.id}?mode=view`,className:"text-brand hover:text-brand-600 dark:text-brand-300 dark:hover:text-brand-200 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/purchase/purchase-bills-${s.toLowerCase()}/${f.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium ml-2",children:"Edit"})]})]},f.id))]})]})})]})]})}const _m=[{id:4,code:"GHS",name:"Ghanaian Cedi"},{id:1,code:"USD",name:"US Dollar"},{id:2,code:"EUR",name:"Euro"},{id:3,code:"GBP",name:"British Pound"}];function bx(){const{id:t}=Ls(),s=ys(),r=ma(),a=!t||t==="new",n=r.pathname.includes("purchase-bills-import")?"IMPORT":"LOCAL",[i,l]=x.useState(!1),[o,u]=x.useState(!1),[d,c]=x.useState(""),[h,A]=x.useState([]),[f,g]=x.useState([]),[v,b]=x.useState([]),[y,j]=x.useState([]),[N,S]=x.useState([]),[B,P]=x.useState([]),[L,U]=x.useState([]),[H,q]=x.useState(null),[V,M]=x.useState([]),[z,I]=x.useState(t&&t!=="new"?Number(t):null),[G,Y]=x.useState({bill_no:"",bill_date:new Date().toISOString().split("T")[0],supplier_id:"",po_id:"",grn_id:"",bill_type:n,due_date:"",currency_id:4,exchange_rate:1,payment_terms:30,status:"DRAFT",discount_amount:0,freight_charges:0,other_charges:0}),[J,T]=x.useState([{id:Date.now(),item_id:"",uom_id:"",qty:0,unit_price:0,discount_percent:0,tax_amount:0,line_total:0}]);x.useEffect(()=>{let oe=!0;return(async()=>{var re,de,Ie,le,Z,ve,Ue,Be;try{if(a){const ct=n==="IMPORT"?`PIB-${String(1).padStart(6,"0")}`:`PLB-${String(1).padStart(6,"0")}`;Y(xt=>({...xt,bill_no:ct}))}const[_e,Me,Ye,ot,Ke]=await Promise.all([ee.get("/purchase/suppliers").catch(()=>({data:{items:[]}})),ee.get("/purchase/orders").catch(()=>({data:{items:[]}})),ee.get("/inventory/items").catch(()=>({data:{items:[]}})),ee.get("/inventory/uoms").catch(()=>({data:{items:[]}})),ee.get("/finance/tax-codes").catch(()=>({data:{items:[]}}))]);oe&&(A(Array.isArray((re=_e.data)==null?void 0:re.items)?_e.data.items:[]),g(Array.isArray((de=Me.data)==null?void 0:de.items)?Me.data.items:[]),j(Array.isArray((Ie=Ye.data)==null?void 0:Ie.items)?Ye.data.items:[]),S(Array.isArray((le=Ye.data)==null?void 0:le.items)?Ye.data.items:[]),P(Array.isArray((Z=ot.data)==null?void 0:Z.items)?ot.data.items:[]),M(Array.isArray((ve=Ke.data)==null?void 0:ve.items)?Ke.data.items:[]));try{const ct=await ee.get("/purchase/grns",{params:{status:"APPROVED"}});oe&&b(Array.isArray((Ue=ct.data)==null?void 0:Ue.items)?ct.data.items:[])}catch{}try{const ct=await ee.get("/finance/currencies");if(oe){const xt=Array.isArray((Be=ct.data)==null?void 0:Be.items)?ct.data.items:[];U(xt);const be=xt.find(Ce=>Number(Ce.is_base)===1);q(be?Number(be.id):null)}}catch{}}catch{oe&&c("Failed to load lookups")}})(),()=>{oe=!1}},[]),x.useEffect(()=>{if(a)return;let oe=!0;return l(!0),c(""),ee.get(`/purchase/bills/${t}`).then(ce=>{var Ie,le;if(!oe)return;const re=(Ie=ce.data)==null?void 0:Ie.item,de=Array.isArray((le=ce.data)==null?void 0:le.details)?ce.data.details:[];re&&(Y({bill_no:re.bill_no||"",bill_date:re.bill_date?re.bill_date.split("T")[0]:"",supplier_id:re.supplier_id?String(re.supplier_id):"",po_id:re.po_id?String(re.po_id):"",grn_id:re.grn_id?String(re.grn_id):"",bill_type:re.bill_type||n,due_date:re.due_date?re.due_date.split("T")[0]:"",currency_id:re.currency_id||4,exchange_rate:Number(re.exchange_rate)||1,payment_terms:Number(re.payment_terms)||30,status:re.status||"DRAFT",discount_amount:Number(re.discount_amount)||0,freight_charges:Number(re.freight_charges)||0,other_charges:Number(re.other_charges)||0}),T(de.length?de.map(Z=>({id:Z.id||Date.now()+Math.random(),item_id:Z.item_id?String(Z.item_id):"",uom_id:Z.uom_id?String(Z.uom_id):"",qty:Number(Z.qty)||0,unit_price:Number(Z.unit_price)||0,discount_percent:Number(Z.discount_percent)||0,tax_amount:Number(Z.tax_amount)||0,line_total:Number(Z.line_total)||0})):[]))}).catch(ce=>{oe&&c("Failed to load purchase bill")}).finally(()=>{oe&&l(!1)}),()=>{oe=!1}},[t,a]);const k=oe=>{const ce=Number(oe.qty)||0,re=Number(oe.unit_price)||0,de=Number(oe.discount_percent)||0;let Ie=Number(oe.tax_amount)||0;const le=ce*re,Z=le*(de/100),ve=le-Z;if(oe.tax_code_id){const Be=V.find(Me=>String(Me.id)===String(oe.tax_code_id)),_e=Be&&Number(Be.rate_percent)||0;Ie=ve*(_e/100)}const Ue=ve+Ie;return{...oe,tax_amount:Ie,line_total:Ue}},D=async(oe,ce)=>{var re;try{const Ie=(re=(await ee.get(`/finance/item-tax/${ce}`)).data)==null?void 0:re.tax;if(!Ie)return;T(le=>le.map(Z=>{if(Z.id!==oe)return Z;const ve=Number(Z.qty)||0,Ue=Number(Z.unit_price)||0,Be=Number(Z.discount_percent)||0,_e=ve*Ue,Me=_e*(Be/100),Ye=_e-Me,ot=Number(Ie.tax_rate)||0,Ke={...Z,tax_code_id:String(Ie.id),tax_amount:Ye*(ot/100)};return k(Ke)}))}catch{}},Q=(oe,ce,re)=>{T(de=>de.map(Ie=>{if(Ie.id!==oe)return Ie;let le={...Ie,[ce]:re};if(ce==="item_id"){const Z=y.find(ve=>String(ve.id)===String(re));if(Z&&Z.uom){const ve=B.find(Ue=>String(Ue.uom_code)===String(Z.uom));le.uom_id=ve?String(ve.id):""}re&&D(oe,re)}if(ce==="tax_code_id"){const Z=V.find(Ke=>String(Ke.id)===String(re)),ve=Number(le.qty)||0,Ue=Number(le.unit_price)||0,Be=Number(le.discount_percent)||0,_e=ve*Ue,Me=_e*(Be/100),Ye=_e-Me,ot=Z&&Number(Z.rate_percent)||0;le.tax_amount=Ye*(ot/100)}return k(le)}))},C=()=>{T(oe=>[...oe,{id:Date.now(),item_id:"",uom_id:"",qty:0,unit_price:0,discount_percent:0,tax_amount:0,line_total:0}])},E=oe=>{T(ce=>ce.filter(re=>re.id!==oe))},w=async oe=>{var ce,re,de,Ie;try{const le=await ee.get(`/purchase/grns/${oe}`),Z=(ce=le.data)==null?void 0:ce.item,ve=(de=(re=le.data)==null?void 0:re.item)==null?void 0:de.details;if(Z&&(Y(_e=>({..._e,po_id:Z.po_id?String(Z.po_id):_e.po_id,supplier_id:Z.supplier_id?String(Z.supplier_id):_e.supplier_id,grn_id:String(oe)})),Z.po_id))try{const Me=(Ie=(await ee.get(`/purchase/orders/${Z.po_id}`)).data)==null?void 0:Ie.item;if(Me){const Ye=String(Me.currency||Me.currency_code||Me.currencyCode||"").toUpperCase(),ot=_m.find(Ke=>String(Ke.code).toUpperCase()===Ye)||_m[0];Y(Ke=>({...Ke,currency_id:Number(Me.currency_id)||(ot?Number(ot.id):Ke.currency_id),exchange_rate:Me.exchange_rate!=null?Number(Me.exchange_rate||1):Ke.exchange_rate}))}}catch{}if(Array.isArray(ve)&&ve.length>0){const _e=ve.map(Me=>{const Ye=B.find(xt=>xt.uom_code===Me.uom||xt.uom_name===Me.uom),ot=Number(Me.qty_accepted)||0,Ke=Number(Me.unit_price)||0,ct=ot*Ke;return{id:Date.now()+Math.random(),item_id:Me.item_id?String(Me.item_id):"",uom_id:Ye?String(Ye.id):"",qty:ot,unit_price:Ke,discount_percent:0,tax_amount:0,line_total:ct}});T(_e)}const Be=Array.from(new Set(ve.map(_e=>_e.item_id?String(_e.item_id):"").filter(Boolean))).map(_e=>y.find(Ye=>String(Ye.id)===_e)||{id:_e,item_code:_e,item_name:""});S(Be)}catch(le){console.error("Failed to load GRN details",le)}},O=async oe=>{var de,Ie,le;const{name:ce,value:re}=oe.target;if(Y(Z=>({...Z,[ce]:re})),ce==="supplier_id")if(re){const Z=h.find(Ue=>String(Ue.id)===String(re)),ve=Z&&Z.supplier_code&&String(Z.supplier_code).trim()||(Z?`SU-${String(Number(Z.id||0)).padStart(6,"0")}`:"");if(ve)try{const Ue=await ee.get("/finance/accounts",{params:{search:ve}}),Be=Array.isArray((de=Ue.data)==null?void 0:de.items)?Ue.data.items:[],_e=Be.find(Ye=>String(Ye.code)===ve)||Be[0]||null,Me=_e&&_e.currency_code&&String(_e.currency_code)||null;if(Me){const Ye=_m.find(ot=>String(ot.code).toUpperCase()===Me.toUpperCase())||null;Ye&&Y(ot=>({...ot,currency_id:Number(Ye.id)}))}}catch{}}else Y(Z=>({...Z,currency_id:4}));if(ce==="grn_id"&&re?await w(re):ce==="grn_id"&&!re&&S(y),ce==="po_id"&&re){const Z=f.find(Be=>String(Be.id)===re);let ve=G.supplier_id;Z&&Z.supplier_id&&(ve=String(Z.supplier_id),Y(Be=>({...Be,supplier_id:ve})));const Ue=v.filter(Be=>String(Be.po_id)===re&&Be.grn_type===n&&String(Be.status).toUpperCase()==="APPROVED");Ue.length===1?await w(Ue[0].id):(Y(Be=>{const _e=Ue.find(Me=>String(Me.id)===Be.grn_id);return{...Be,supplier_id:ve||Be.supplier_id,grn_id:_e?Be.grn_id:""}}),S(y))}if(ce==="currency_id"){const Z=_m.find(Me=>Number(Me.id)===Number(re)),ve=Z?String(Z.code).toUpperCase():null,Ue=ve&&L.find(Me=>String(Me.code).toUpperCase()===ve.toUpperCase()),Be=Ue?Number(Ue.id):null,_e=H?Number(H):null;if(!Be||!_e)Y(Me=>({...Me,exchange_rate:1}));else if(Be===_e)Y(Me=>({...Me,exchange_rate:1}));else try{const Me=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Be,toCurrencyId:_e}}),Ye=Array.isArray((Ie=Me.data)==null?void 0:Ie.items)?Me.data.items:[];if(Ye.length>0){const ot=Number(Ye[0].rate)||1;Y(Ke=>({...Ke,exchange_rate:ot}))}else{const ot=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:_e,toCurrencyId:Be}}),Ke=Array.isArray((le=ot.data)==null?void 0:le.items)?ot.data.items:[];if(Ke.length>0){const ct=Number(Ke[0].rate)||1;Y(xt=>({...xt,exchange_rate:1/ct}))}else Y(ct=>({...ct,exchange_rate:1}))}}catch{Y(Me=>({...Me,exchange_rate:1}))}}},R=x.useMemo(()=>{const oe=J.reduce((ve,Ue)=>ve+(Number(Ue.qty)||0)*(Number(Ue.unit_price)||0),0),ce=J.reduce((ve,Ue)=>ve+(Number(Ue.tax_amount)||0),0),re=J.reduce((ve,Ue)=>{const Be=(Number(Ue.qty)||0)*(Number(Ue.unit_price)||0);return ve+Be*(Number(Ue.discount_percent)||0)/100},0),de=re+(Number(G.discount_amount)||0),Ie=Number(G.freight_charges)||0,le=Number(G.other_charges)||0,Z=oe-de+ce+Ie+le;return{subTotal:oe,itemDiscounts:re,lineTaxTotal:ce,grandTotal:Z}},[J,G.discount_amount,G.freight_charges,G.other_charges]),X=async()=>{var oe,ce,re;if(!G.bill_date){c("Bill Date is required");return}if(!G.supplier_id){c("Supplier is required");return}if(!G.grn_id){c("GRN is required for posting");return}if(J.length===0||!J.some(de=>de.item_id)){c("At least one item is required");return}try{u(!0);const de={...G,bill_no:G.bill_no||void 0,supplier_id:Number(G.supplier_id),po_id:G.po_id?Number(G.po_id):null,grn_id:G.grn_id?Number(G.grn_id):null,currency_id:Number(G.currency_id),exchange_rate:Number(G.exchange_rate),payment_terms:Number(G.payment_terms),discount_amount:Number(G.discount_amount),freight_charges:Number(G.freight_charges),other_charges:Number(G.other_charges),status:"DRAFT",details:J.filter(Z=>Z.item_id).map(Z=>({item_id:Number(Z.item_id),uom_id:Z.uom_id?Number(Z.uom_id):null,qty:Number(Z.qty)||0,unit_price:Number(Z.unit_price)||0,discount_percent:Number(Z.discount_percent)||0,tax_amount:Number(Z.tax_amount)||0,line_total:Number(Z.line_total)||0}))};let Ie=null;if(z)await ee.put(`/purchase/bills/${z}`,de);else{const Z=await ee.post("/purchase/bills",de);Ie=Number(((oe=Z==null?void 0:Z.data)==null?void 0:oe.id)||0)||null,Ie&&I(Ie)}const le=z||Ie;if(!le){c("Bill not found for posting");return}await ee.post(`/purchase/bills/${le}/post`,{}),Y(Z=>({...Z,status:"POSTED"})),s(`/purchase/purchase-bills-${n.toLowerCase()}`)}catch(de){c(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Posting failed")}finally{u(!1)}},ne=()=>{Y(oe=>({...oe,supplier_id:"",po_id:"",grn_id:"",due_date:"",currency_id:4,exchange_rate:1,payment_terms:30,discount_amount:0,freight_charges:0,other_charges:0})),T([{id:Date.now(),item_id:"",uom_id:"",qty:0,unit_price:0,discount_percent:0,tax_amount:0,line_total:0}])},te=`/purchase/purchase-bills-${n.toLowerCase()}`;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:[a?"New":"Edit"," Purchase Bill - ",n]}),e.jsx("p",{className:"text-sm mt-1",children:"Record and manage supplier bills"})]}),e.jsx(Le,{to:te,className:"btn-secondary",children:"Back to List"})]}),i&&e.jsx("div",{className:"p-4 bg-white rounded shadow",children:"Loading..."}),d&&e.jsx("div",{className:"p-4 text-red-600 bg-white rounded shadow",children:d}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg px-4 py-2",children:e.jsx("h3",{className:"font-semibold",children:"Invoice Information"})}),e.jsxs("div",{className:"card-body p-4 grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Invoice Type"}),e.jsxs("select",{className:"input",value:G.bill_type,disabled:!0,children:[e.jsx("option",{value:"LOCAL",children:"Local"}),e.jsx("option",{value:"IMPORT",children:"Import"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Bill No"}),e.jsx("input",{className:"input bg-gray-100",value:G.bill_no,placeholder:"Auto-generated",disabled:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label required",children:"Bill Date"}),e.jsx("input",{type:"date",className:"input",name:"bill_date",value:G.bill_date,onChange:O})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label required",children:"Supplier"}),e.jsxs("select",{className:"input",name:"supplier_id",value:G.supplier_id,onChange:O,children:[e.jsx("option",{value:"",children:"-- Select Supplier --"}),h.map(oe=>e.jsx("option",{value:oe.id,children:oe.supplier_name},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Related PO"}),e.jsxs("select",{className:"input",name:"po_id",value:G.po_id,onChange:O,children:[e.jsx("option",{value:"",children:"-- Select PO --"}),f.filter(oe=>(!G.supplier_id||String(oe.supplier_id)===String(G.supplier_id))&&oe.po_type===n).map(oe=>e.jsx("option",{value:oe.id,children:oe.po_no},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Related GRN"}),e.jsxs("select",{className:"input",name:"grn_id",value:G.grn_id,onChange:O,children:[e.jsx("option",{value:"",children:"-- Select GRN --"}),v.filter(oe=>(!G.supplier_id||String(oe.supplier_id)===String(G.supplier_id))&&(!G.po_id||String(oe.po_id)===String(G.po_id))&&oe.grn_type===n&&String(oe.status).toUpperCase()==="APPROVED").map(oe=>e.jsx("option",{value:oe.id,children:oe.grn_no},oe.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{type:"date",className:"input",name:"due_date",value:G.due_date,onChange:O})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("select",{className:"input",name:"currency_id",value:G.currency_id,onChange:O,children:_m.map(oe=>e.jsx("option",{value:oe.id,children:oe.code},oe.id))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{type:"number",className:"input text-right",name:"exchange_rate",value:G.exchange_rate,onChange:O,step:"0.000001"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"label",children:"Payment Terms (Days)"}),e.jsx("input",{type:"number",className:"input text-right",name:"payment_terms",value:G.payment_terms,onChange:O})]}),e.jsx("div",{className:"form-group"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg px-4 py-2 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:"Items"}),e.jsx("button",{type:"button",className:"btn-success text-xs",onClick:C,children:"+ Add Item"})]}),e.jsxs("div",{className:"card-body overflow-x-auto",children:[e.jsxs("div",{className:"mb-2 text-xs text-slate-600",children:["Unit of Measure and Conversions: select UOM per line. If the supplier billed in a different UOM than the items default, define or verify a conversion to ensure correct quantities and amounts.",e.jsx("span",{className:"ml-2",children:e.jsx(Le,{to:"/inventory/unit-conversions",className:"text-brand font-medium underline",children:"Manage conversions"})})]}),e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-1/4",children:"Item"}),e.jsx("th",{className:"w-28 text-right",children:"Qty"}),e.jsx("th",{className:"w-36 text-right",children:"UOM"}),e.jsx("th",{className:"w-32 text-right",children:"Unit Price"}),e.jsx("th",{className:"w-28 text-right",children:"Disc %"}),e.jsx("th",{className:"w-40 text-right",children:"Tax Amt"}),e.jsx("th",{className:"w-32 text-right",children:"Net Amount"}),e.jsx("th",{className:"w-16",children:"Action"})]})}),e.jsx("tbody",{children:J.map(oe=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input text-sm w-full",value:oe.item_id,onChange:ce=>Q(oe.id,"item_id",ce.target.value),children:[e.jsx("option",{value:"",children:"Select Item"}),N.map(ce=>e.jsxs("option",{value:String(ce.id),children:[ce.item_code," - ",ce.item_name]},ce.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right text-sm w-full",value:oe.qty,onChange:ce=>Q(oe.id,"qty",ce.target.value)})}),e.jsx("td",{children:e.jsxs("select",{className:"input text-sm w-full",value:oe.uom_id,onChange:ce=>Q(oe.id,"uom_id",ce.target.value),children:[e.jsx("option",{value:"",children:"Select UOM"}),B.map(ce=>e.jsx("option",{value:String(ce.id),children:ce.uom_name?`${ce.uom_name} (${ce.uom_code})`:ce.uom_code},ce.id))]})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right text-sm w-full",value:oe.unit_price,onChange:ce=>Q(oe.id,"unit_price",ce.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"input text-right text-sm w-full",value:oe.discount_percent,onChange:ce=>Q(oe.id,"discount_percent",ce.target.value)})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"input text-sm w-full",value:oe.tax_code_id||"",onChange:ce=>Q(oe.id,"tax_code_id",ce.target.value),children:[e.jsx("option",{value:"",children:"No Tax"}),V.map(ce=>e.jsx("option",{value:String(ce.id),children:ce.name},ce.id))]}),e.jsx("span",{className:"text-right w-32",children:Number(oe.tax_amount||0).toFixed(2)})]})}),e.jsx("td",{className:"text-right font-medium",children:Number(oe.line_total).toFixed(2)}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",onClick:()=>E(oe.id),title:"Remove",children:e.jsx(wI,{size:16})})})]},oe.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"hidden md:block"}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-gray-100 px-4 py-2 border-b",children:e.jsx("h3",{className:"font-semibold text-gray-700",children:"Summary"})}),e.jsxs("div",{className:"card-body p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Sub Total:"}),e.jsx("span",{className:"font-semibold",children:R.subTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center text-red-600",children:[e.jsx("span",{className:"text-gray-600",children:"Discount Amount (Items + Global):"}),e.jsxs("span",{children:["-"," ",(R.itemDiscounts+Number(G.discount_amount)||0).toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Global Discount Input:"}),e.jsx("input",{type:"number",className:"input w-32 text-right",name:"discount_amount",value:G.discount_amount,onChange:O})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Tax Amount:"}),e.jsx("span",{className:"font-semibold",children:R.lineTaxTotal.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Freight Charges:"}),e.jsx("input",{type:"number",className:"input w-32 text-right",name:"freight_charges",value:G.freight_charges,onChange:O})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Other Charges:"}),e.jsx("input",{type:"number",className:"input w-32 text-right",name:"other_charges",value:G.other_charges,onChange:O})]}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{children:"Grand Total:"}),e.jsx("span",{children:R.grandTotal.toFixed(2)})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-end",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:ne,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-success",onClick:X,disabled:o,children:"Post"})]})]})}function gJ(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let d=!0;return i(!0),o(""),ee.get("/purchase/suppliers").then(c=>{var h;d&&a(Array.isArray((h=c.data)==null?void 0:h.items)?c.data.items:[])}).catch(c=>{var h,A;d&&o(((A=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load suppliers")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=x.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.supplier_code||"").toLowerCase().includes(d)||String(c.supplier_name||"").toLowerCase().includes(d)||String(c.phone||"").toLowerCase().includes(d)||String(c.email||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Supplier Details Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Add and manage supplier master data"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/purchase/suppliers/new",className:"btn-success",children:"+ New Supplier"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by code, name, phone, email...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No suppliers found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.supplier_code||"-"}),e.jsx("td",{children:d.supplier_name}),e.jsx("td",{children:d.phone||"-"}),e.jsx("td",{children:d.email||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d.is_active?"badge-success":"badge-error"}`,children:d.is_active?"ACTIVE":"INACTIVE"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/purchase/suppliers/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/purchase/suppliers/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},d.id))]})]})})]})]})})}function hS(){const{id:t}=Ls(),s=ys(),r=!t||t==="new",a=x.useRef(null),[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState("basic"),[g,v]=x.useState([]),[b,y]=x.useState({supplier_code:"",supplier_name:"",contact_person:"",email:"",phone:"",address:"",payment_terms:"",is_active:!0,supplier_type:"LOCAL",tax_id:"",business_reg_no:"",industry:"",website:"",city:"",country:"GH",currency_id:"",credit_limit:"",bank_name:"",bank_account:"",swift_code:""});x.useEffect(()=>{if(r)return;let P=!0;return i(!0),d(""),ee.get(`/purchase/suppliers/${t}`).then(L=>{var H;if(!P)return;const U=(H=L.data)==null?void 0:H.item;U&&y(q=>({...q,supplier_code:U.supplier_code||"",supplier_name:U.supplier_name||"",contact_person:U.contact_person||"",email:U.email||"",phone:U.phone||"",address:U.address||"",payment_terms:U.payment_terms||"",is_active:!!U.is_active,supplier_type:U.supplier_type||q.supplier_type||"LOCAL"}))}).catch(L=>{var U,H;P&&d(((H=(U=L==null?void 0:L.response)==null?void 0:U.data)==null?void 0:H.message)||"Failed to load supplier")}).finally(()=>{P&&i(!1)}),()=>{P=!1}},[t,r]),x.useEffect(()=>{if(!r)return;(async()=>{var L,U,H;try{const q=await ee.get("/purchase/suppliers/next-code");if((L=q.data)!=null&&L.code){y(V=>({...V,supplier_code:q.data.code}));return}}catch(q){console.error("Failed to fetch next supplier code",q)}try{const q=await ee.get("/purchase/suppliers"),V=Array.isArray((U=q.data)==null?void 0:U.items)?q.data.items:[],M=await ee.get("/finance/accounts",{params:{search:"SU-"}}),z=Array.isArray((H=M.data)==null?void 0:H.items)?M.data.items:[];let I=0;for(const Y of V){const J=String(Y.supplier_code||"").match(/^SU-(\d{6})$/);if(J){const T=Number(J[1]);Number.isFinite(T)&&T>I&&(I=T)}}for(const Y of z){const J=String(Y.code||"").match(/^SU-(\d{6})$/);if(J){const T=Number(J[1]);Number.isFinite(T)&&T>I&&(I=T)}}const G=`SU-${String(I+1).padStart(6,"0")}`;y(Y=>({...Y,supplier_code:G}))}catch{}})()},[r]),x.useEffect(()=>{(async()=>{var L;try{const U=await ee.get("/finance/currencies"),H=Array.isArray((L=U.data)==null?void 0:L.items)?U.data.items:[];v(H);const q=H.find(V=>Number(V.is_base)===1)||H.find(V=>String(V.code||V.currency_code||"").toUpperCase()==="GHS")||H.find(V=>/ghana|cedi/i.test(String(V.name||V.currency_name||"")));q&&y(V=>({...V,currency_id:V.currency_id||String(q.id||"")}))}catch(U){console.error("Failed to fetch currencies",U)}})()},[]);const j=P=>{const{name:L,value:U,type:H,checked:q}=P.target;y(V=>({...V,[L]:H==="checkbox"?q:U}))},N=async P=>{var L,U;P.preventDefault(),o(!0),d(""),h("");try{const H={supplier_code:b.supplier_code||null,supplier_name:b.supplier_name,contact_person:b.contact_person||null,email:b.email||null,phone:b.phone||null,address:b.address||null,payment_terms:b.payment_terms||null,is_active:!!b.is_active,supplier_type:b.supplier_type||"LOCAL",currency_id:b.currency_id===void 0||b.currency_id===null?null:String(b.currency_id||"")};r?await ee.post("/purchase/suppliers",H):await ee.put(`/purchase/suppliers/${t}`,H),h("Supplier saved successfully!"),r&&s("/purchase/suppliers")}catch(H){d(((U=(L=H==null?void 0:H.response)==null?void 0:L.data)==null?void 0:U.message)||"Failed to save supplier")}finally{o(!1)}},S=()=>{const L="data:text/csv;charset=utf-8,"+["supplier_name","supplier_code","contact_person","email","phone","address","payment_terms"].join(",")+`
Example Supplier,SUP001,John Doe,john@example.com,1234567890,123 Main St,30 Days`,U=encodeURI(L),H=document.createElement("a");H.setAttribute("href",U),H.setAttribute("download","supplier_template.csv"),document.body.appendChild(H),H.click(),document.body.removeChild(H)},B=P=>{const L=P.target.files[0];if(!L)return;const U=new FileReader;U.onload=async H=>{const V=H.target.result.split(`
`).map(Y=>Y.trim()).filter(Y=>Y);if(V.length<2){d("Invalid CSV format or empty file");return}const M=V[0].split(",").map(Y=>Y.trim()),z=V.slice(1);let I=0,G=0;i(!0);for(const Y of z){const J=Y.split(",").map(k=>k.trim());if(J.length<1)continue;const T={};if(M.forEach((k,D)=>{J[D]&&(T[k]=J[D])}),!T.supplier_name){G++;continue}try{await ee.post("/purchase/suppliers",{supplier_name:T.supplier_name,supplier_code:T.supplier_code||null,contact_person:T.contact_person||null,email:T.email||null,phone:T.phone||null,address:T.address||null,payment_terms:T.payment_terms||null,is_active:!0}),I++}catch(k){console.error("Failed to upload row",Y,k),G++}}i(!1),h(`Mass upload completed. Success: ${I}, Failed: ${G}`),a.current&&(a.current.value="")},U.readAsText(L)};return e.jsxs("div",{className:"max-w-7xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden my-6",children:[e.jsxs("div",{className:"text-white p-8",style:{background:"linear-gradient(135deg, #0E3646 0%, #0E3646 100%)"},children:[e.jsx("h1",{className:"text-3xl font-bold",children:" Supplier Setup & Configuration"}),e.jsx("p",{className:"mt-2 text-slate-300",children:"Manage supplier information, contacts, and performance"})]}),e.jsxs("div",{className:"flex flex-wrap justify-between items-center p-6 bg-slate-50 border-b border-slate-200 gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("input",{type:"text",className:"w-full pl-3 pr-10 py-2 border border-slate-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#0E3646]",placeholder:"Search suppliers..."}),e.jsx("span",{className:"absolute right-3 top-2.5 text-slate-400",children:""})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",onClick:S,children:" Template"}),e.jsx("button",{type:"button",className:"bg-slate-600 hover:bg-slate-700 text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",onClick:()=>{var P;return(P=a.current)==null?void 0:P.click()},children:" Mass Upload"}),e.jsx("input",{type:"file",ref:a,className:"hidden",accept:".csv",onChange:B}),!r&&e.jsx("button",{type:"button",className:"text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",style:{backgroundColor:"#0E3646"},onClick:()=>{y({supplier_code:"",supplier_name:"",contact_person:"",email:"",phone:"",address:"",payment_terms:"",is_active:!0,supplier_type:"LOCAL",tax_id:"",business_reg_no:"",industry:"",website:"",city:"",country:"GH",currency:"GHS",credit_limit:"",bank_name:"",bank_account:"",swift_code:""}),s("/purchase/suppliers/new")},children:" New Supplier"}),e.jsx(Le,{to:"/purchase/suppliers",className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-md transition-colors flex items-center gap-2",children:" View All"})]})]}),e.jsxs("div",{className:"p-8",children:[n&&e.jsx("div",{className:"text-center py-4",children:"Loading..."}),u&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-md mb-6",children:u}),c&&e.jsx("div",{className:"bg-green-50 text-green-600 p-4 rounded-md mb-6",children:c}),e.jsxs("form",{onSubmit:N,children:[e.jsx("div",{className:"flex border-b-2 border-slate-200 mb-8 overflow-x-auto",children:[{id:"basic",label:" Basic Information"},{id:"financial",label:" Financial Details"},{id:"documents",label:" Documents"}].map(P=>e.jsx("button",{type:"button",className:`px-6 py-3 font-medium whitespace-nowrap transition-colors border-b-2 -mb-[2px] ${A===P.id?"border-[#0E3646] text-[#0E3646]":"border-transparent text-slate-500 hover:bg-slate-50"}`,onClick:()=>f(P.id),children:P.label},P.id))}),e.jsxs("div",{className:A==="basic"?"block":"hidden",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Supplier Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Supplier Code"}),e.jsx("input",{type:"text",name:"supplier_code",className:`w-full px-3 py-2 border border-slate-300 rounded-md ${r?"bg-gray-50":"bg-gray-100 text-slate-500"}`,value:b.supplier_code,onChange:j,placeholder:r?"Auto-generated":"Locked for existing supplier",readOnly:!r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Supplier Name *"}),e.jsx("input",{type:"text",name:"supplier_name",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 focus:border-transparent outline-none",value:b.supplier_name,onChange:j,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Supplier Type"}),e.jsxs("select",{name:"supplier_type",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.supplier_type,onChange:j,children:[e.jsx("option",{value:"LOCAL",children:"Local Supplier"}),e.jsx("option",{value:"IMPORT",children:"Import Supplier"}),e.jsx("option",{value:"BOTH",children:"Both"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Status"}),e.jsxs("select",{name:"is_active",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.is_active,onChange:P=>j({target:{name:"is_active",value:P.target.value==="true"}}),children:[e.jsx("option",{value:!0,children:"Active"}),e.jsx("option",{value:!1,children:"Inactive"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Tax Registration Number"}),e.jsx("input",{type:"text",name:"tax_id",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.tax_id,onChange:j,placeholder:"TIN/VAT number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Industry"}),e.jsxs("select",{name:"industry",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.industry,onChange:j,children:[e.jsx("option",{value:"",children:"Select Industry"}),e.jsx("option",{value:"MANUFACTURING",children:"Manufacturing"}),e.jsx("option",{value:"TRADING",children:"Trading"}),e.jsx("option",{value:"SERVICES",children:"Services"})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Website"}),e.jsx("input",{type:"url",name:"website",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.website,onChange:j,placeholder:"https://www.supplier.com"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Address & Contact"}),e.jsx("div",{className:"grid grid-cols-1 gap-6 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Address"}),e.jsx("textarea",{name:"address",rows:"2",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.address,onChange:j,placeholder:"Street address"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"city",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.city,onChange:j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Country"}),e.jsxs("select",{name:"country",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.country,onChange:j,children:[e.jsx("option",{value:"GH",children:"Ghana"}),e.jsx("option",{value:"NG",children:"Nigeria"}),e.jsx("option",{value:"CN",children:"China"}),e.jsx("option",{value:"US",children:"United States"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.phone,onChange:j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.email,onChange:j})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Contact Person (Primary)"}),e.jsx("input",{type:"text",name:"contact_person",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.contact_person,onChange:j})]})})]})]}),e.jsxs("div",{className:A==="financial"?"block":"hidden",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Payment & Financial Terms"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Default Currency"}),e.jsxs("select",{name:"currency_id",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.currency_id,onChange:j,children:[e.jsx("option",{value:"",children:"Select currency"}),g.map(P=>e.jsx("option",{value:P.id,children:(P.code||P.currency_code)+" - "+(P.name||P.currency_name||"")},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Payment Terms (Days)"}),e.jsx("input",{type:"text",name:"payment_terms",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.payment_terms,onChange:j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Credit Limit"}),e.jsx("input",{type:"number",name:"credit_limit",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.credit_limit,onChange:j})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bank_name",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.bank_name,onChange:j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",name:"bank_account",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.bank_account,onChange:j})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-800 mb-1",children:"SWIFT Code"}),e.jsx("input",{type:"text",name:"swift_code",className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-slate-500 outline-none",value:b.swift_code,onChange:j})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 pb-2 border-b-2 border-slate-800",children:" Financial Statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"GHS 250,000"}),e.jsx("div",{className:"text-sm opacity-90",children:"Total Purchases YTD"})]}),e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"15"}),e.jsx("div",{className:"text-sm opacity-90",children:"Purchase Orders"})]}),e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"GHS 45,000"}),e.jsx("div",{className:"text-sm opacity-90",children:"Outstanding Balance"})]}),e.jsxs("div",{className:"p-6 rounded-lg text-white text-center shadow-md",style:{background:"linear-gradient(135deg, #0E3646 0%, #1a5570 100%)"},children:[e.jsx("div",{className:"text-3xl font-bold mb-1",children:"28 Days"}),e.jsx("div",{className:"text-sm opacity-90",children:"Avg Payment Time"})]})]})]})]}),e.jsx("div",{className:A==="documents"?"block":"hidden",children:e.jsx("div",{className:"text-center py-10 text-slate-500 bg-slate-50 rounded-lg border border-dashed border-slate-300",children:e.jsx("p",{children:"Document Management coming soon."})})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-slate-200 mt-6",children:[e.jsx(Le,{to:"/purchase/suppliers",className:"px-6 py-2 border border-slate-300 rounded-md text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"button",className:"px-6 py-2 text-white rounded-md transition-colors",style:{backgroundColor:"#2E8B1F"},onClick:()=>{window.confirm("Activate this supplier?")&&alert("Supplier activated successfully!")},children:" Activate"}),e.jsx("button",{type:"submit",className:"px-6 py-2 text-white rounded-md transition-colors disabled:opacity-50",style:{backgroundColor:"#0E3646"},disabled:l,children:l?"Saving...":" Save Supplier"})]})]})]})]})}function vJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/purchase/reports/import-order-tracking",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["PO No","Supplier","Order Date","Shipment ETA","Status","Value"],f=(Array.isArray(n)?n:[]).map(j=>[j.po_no||"-",j.supplier_name||"-",j.order_date?new Date(j.order_date).toLocaleDateString():"-",j.eta_date?new Date(j.eta_date).toLocaleDateString():"-",j.status||"-",Number(j.total_value||0).toFixed(2)]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="import-order-tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({po_no:v.po_no||"-",supplier:v.supplier_name||"-",order_date:v.order_date?new Date(v.order_date).toLocaleDateString():"-",shipment_eta:v.eta_date?new Date(v.eta_date).toLocaleDateString():"-",status:v.status||"-",value:Number(v.total_value||0)})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"ImportOrderTracking"),xr(g,"import-order-tracking.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Import Order Tracking",10,f),f+=8,A.setFontSize(10),A.text("PO No",10,f),A.text("Supplier",45,f),A.text("Order Date",95,f),A.text("Shipment ETA",130,f),A.text("Status",165,f),A.text("Value",190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(g=>{f>270&&(A.addPage(),f=15);const v=String(g.po_no||"-"),b=String(g.supplier_name||"-"),y=g.order_date?new Date(g.order_date).toLocaleDateString():"-",j=g.eta_date?new Date(g.eta_date).toLocaleDateString():"-",N=String(g.status||"-"),S=Number(g.total_value||0).toFixed(2);A.text(v,10,f),A.text(b.slice(0,35),45,f),A.text(y,95,f),A.text(j,130,f),A.text(N,165,f),A.text(S,190,f,{align:"right"}),f+=5}),A.save("import-order-tracking.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Import Order Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Status and shipment tracking for import POs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Shipment ETA"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map(A=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:A.po_no||"-"}),e.jsx("td",{children:A.supplier_name||"-"}),e.jsx("td",{children:A.order_date?new Date(A.order_date).toLocaleDateString():"-"}),e.jsx("td",{children:A.eta_date?new Date(A.eta_date).toLocaleDateString():"-"}),e.jsx("td",{children:A.status||"-"}),e.jsx("td",{className:"text-right",children:Number(A.total_value||0).toLocaleString()})]},A.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function bJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/purchase/reports/local-order-tracking",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["PO No","Supplier","Order Date","Expected Delivery","Status","Value"],f=(Array.isArray(n)?n:[]).map(j=>[j.po_no||"-",j.supplier_name||"-",j.order_date?new Date(j.order_date).toLocaleDateString():"-",j.expected_delivery?new Date(j.expected_delivery).toLocaleDateString():"-",j.status||"-",Number(j.total_value||0).toFixed(2)]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="local_order_tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({po_no:v.po_no||"-",supplier:v.supplier_name||"-",order_date:v.order_date?new Date(v.order_date).toLocaleDateString():"-",expected_delivery:v.expected_delivery?new Date(v.expected_delivery).toLocaleDateString():"-",status:v.status||"-",value:Number(v.total_value||0)})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"LocalOrderTracking"),xr(g,"local-order-tracking.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Local Order Tracking",10,f),f+=8,A.setFontSize(10);const g=["PO No","Supplier","Order Date","Expected","Status","Value"];A.text(g[0],10,f),A.text(g[1],40,f),A.text(g[2],90,f),A.text(g[3],120,f),A.text(g[4],150,f),A.text(g[5],180,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=String(v.po_no||"-"),y=String(v.supplier_name||"-"),j=v.order_date?new Date(v.order_date).toLocaleDateString():"-",N=v.expected_delivery?new Date(v.expected_delivery).toLocaleDateString():"-",S=String(v.status||"-"),B=Number(v.total_value||0).toFixed(2);A.text(b,10,f),A.text(y.slice(0,30),40,f),A.text(j,90,f),A.text(N,120,f),A.text(S,150,f),A.text(B,180,f,{align:"right"}),f+=5}),A.save("local-order-tracking.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Local Order Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Status tracking for local purchase orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"PO No"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Expected Delivery"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map(A=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:A.po_no||"-"}),e.jsx("td",{children:A.supplier_name||"-"}),e.jsx("td",{children:A.order_date?new Date(A.order_date).toLocaleDateString():"-"}),e.jsx("td",{children:A.expected_delivery?new Date(A.expected_delivery).toLocaleDateString():"-"}),e.jsx("td",{children:A.status||"-"}),e.jsx("td",{className:"text-right",children:Number(A.total_value||0).toLocaleString()})]},A.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function yJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var A,f,g;try{o(!0);const v=await ee.get("/purchase/reports/purchase-tracking",{params:{from:t||null,to:r||null}});i(((A=v.data)==null?void 0:A.items)||[])}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load report")}finally{o(!1)}}function d(){const A=["Stage","Reference","Supplier","Date","Status","Value"],f=(Array.isArray(n)?n:[]).map(j=>[j.stage||"-",j.ref_no||"-",j.supplier_name||"-",j.txn_date?new Date(j.txn_date).toLocaleDateString():"-",j.status||"-",Number(j.total_value||0).toFixed(2)]),g=[A.join(","),...f.map(j=>j.join(","))].join(`
`),v=new Blob([g],{type:"text/csv;charset=utf-8;"}),b=URL.createObjectURL(v),y=document.createElement("a");y.href=b,y.download="purchase_tracking.csv",y.click(),URL.revokeObjectURL(b)}function c(){const A=(Array.isArray(n)?n:[]).map(v=>({stage:v.stage||"-",reference:v.ref_no||"-",supplier:v.supplier_name||"-",date:v.txn_date?new Date(v.txn_date).toLocaleDateString():"-",status:v.status||"-",value:Number(v.total_value||0)})),f=is.json_to_sheet(A),g=is.book_new();is.book_append_sheet(g,f,"PurchaseTracking"),xr(g,"purchase-tracking.xlsx")}function h(){const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Purchase Tracking",10,f),f+=8,A.setFontSize(10);const g=["Stage","Reference","Supplier","Date","Status","Value"];A.text(g[0],10,f),A.text(g[1],45,f),A.text(g[2],90,f),A.text(g[3],130,f),A.text(g[4],160,f),A.text(g[5],190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,(Array.isArray(n)?n:[]).forEach(v=>{f>270&&(A.addPage(),f=15);const b=String(v.stage||"-"),y=String(v.ref_no||"-"),j=String(v.supplier_name||"-"),N=v.txn_date?new Date(v.txn_date).toLocaleDateString():"-",S=String(v.status||"-"),B=Number(v.total_value||0).toFixed(2);A.text(b.slice(0,25),10,f),A.text(y.slice(0,30),45,f),A.text(j.slice(0,35),90,f),A.text(N,130,f),A.text(S,160,f),A.text(B,190,f,{align:"right"}),f+=5}),A.save("purchase-tracking.pdf")}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Purchase Tracking"}),e.jsx("p",{className:"text-sm mt-1",children:"Overall tracking of purchase requests, orders, and bills"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l||n.length===0,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:c,disabled:l||n.length===0,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:h,disabled:l||n.length===0,children:"Export PDF"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:A=>s(A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:A=>a(A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Stage"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Value"})]})}),e.jsx("tbody",{children:n.map((A,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:A.stage||"-"}),e.jsx("td",{className:"font-medium",children:A.ref_no||"-"}),e.jsx("td",{children:A.supplier_name||"-"}),e.jsx("td",{children:A.txn_date?new Date(A.txn_date).toLocaleDateString():"-"}),e.jsx("td",{children:A.status||"-"}),e.jsx("td",{className:"text-right",children:Number(A.total_value||0).toLocaleString()})]},A.id||f))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function jJ({status:t}){const s=String(t||"").toLowerCase(),r={paid:{label:" PAID",cls:"bg-green-100 text-green-700 border-green-200"},overdue:{label:" OVERDUE",cls:"bg-red-100 text-red-700 border-red-200"},pending:{label:" PENDING",cls:"bg-amber-100 text-amber-700 border-amber-200"}},a=r[s]||r.pending;return e.jsx("span",{className:`inline-block px-3 py-1 text-xs rounded border ${a.cls}`,children:a.label})}function NJ({idx:t,row:s,onChange:r,onRemove:a}){const n=(u,d)=>r(t,{...s,[u]:d}),i=Number(s.qty||0),l=Number(s.rate||0),o=i*l;return e.jsxs("tr",{children:[e.jsx("td",{className:"p-2",children:t+1}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"input",value:s.desc||"",onChange:u=>n("desc",u.target.value),placeholder:"Service description"})}),e.jsx("td",{className:"p-2",children:e.jsxs("select",{className:"input",value:s.category||"",onChange:u=>n("category",u.target.value),children:[e.jsx("option",{value:"",children:"Select service"}),e.jsx("option",{value:"installation",children:"Installation"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"repair",children:"Repair"}),e.jsx("option",{value:"consultation",children:"Consultation"})]})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"input text-right",type:"number",value:s.qty??"",onChange:u=>n("qty",u.target.value),placeholder:"Qty"})}),e.jsx("td",{className:"p-2",children:e.jsx("input",{className:"input text-right",type:"number",value:s.rate??"",onChange:u=>n("rate",u.target.value),placeholder:"Rate"})}),e.jsx("td",{className:"p-2 text-right",children:Number(o||0).toFixed(2)}),e.jsx("td",{className:"p-2",children:e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>a(t),children:"Remove"})})]})}function Fy(){const[t,s]=x.useState({number:"",status:"pending",clientName:"",clientCompany:"",clientAddress:"",clientCity:"",clientState:"",clientZip:"",clientPhone:"",clientEmail:"",billDate:"",dueDate:"",services:[],subtotal:0,tax:0,total:0,paymentMethod:"cash",paymentReference:"",notes:"",terms:""}),[r]=x.useState([{key:"cash",label:"Cash",icon:""},{key:"card",label:"Card",icon:""},{key:"mobile",label:"Mobile Money",icon:""},{key:"bank",label:"Bank Transfer",icon:""}]),a=c=>{s(h=>({...h,paymentMethod:c}))},n=(c,h)=>{s(A=>({...A,[c]:h}))},i=()=>{s(c=>({...c,services:[...c.services,{desc:"",category:"",qty:"",rate:""}]}))},l=c=>{s(h=>({...h,services:h.services.filter((A,f)=>f!==c)}))},o=(c,h)=>{s(A=>({...A,services:A.services.map((f,g)=>g===c?h:f)}))},u=x.useMemo(()=>{const c=t.services.reduce((f,g)=>{const v=Number(g.qty||0),b=Number(g.rate||0);return f+v*b},0),h=c*0,A=c+h;return{subtotal:c,tax:h,total:A}},[t.services]);Ts.useEffect(()=>{s(c=>({...c,subtotal:u.subtotal,tax:u.tax,total:u.total}))},[u.subtotal,u.tax,u.total]);function d(){const c={number:t.number||null,status:t.status||"pending",client_name:t.clientName||null,client_company:t.clientCompany||null,client_address:t.clientAddress||null,client_city:t.clientCity||null,client_state:t.clientState||null,client_zip:t.clientZip||null,client_phone:t.clientPhone||null,client_email:t.clientEmail||null,bill_date:t.billDate||null,due_date:t.dueDate||null,services:t.services.map(h=>({description:h.desc||"",category:h.category||"",qty:Number(h.qty||0),unit_price:Number(h.rate||0)})),subtotal:Number(u.subtotal||0),tax_amount:Number(u.tax||0),total_amount:Number(u.total||0),payment_method:t.paymentMethod||"cash",payment_reference:t.paymentReference||null,notes:t.notes||null,terms:t.terms||null};ee.post("/purchase/service-bills",c).then(()=>alert("Service bill saved")).catch(h=>{var A,f;return alert(((f=(A=h==null?void 0:h.response)==null?void 0:A.data)==null?void 0:f.message)||"Failed to save service bill")})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/service-management",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Service Management"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Service Bill"}),e.jsx("p",{className:"text-sm mt-1",children:"Prepare and issue bill for services provided"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"BILL NO."}),e.jsx("div",{className:"text-lg font-semibold",children:t.number})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold",children:"Client Information"}),e.jsx(jJ,{status:t.status})]})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Client Name"}),e.jsx("input",{className:"input",value:t.clientName,onChange:c=>n("clientName",c.target.value),placeholder:"Client Name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name"}),e.jsx("input",{className:"input",value:t.clientCompany,onChange:c=>n("clientCompany",c.target.value),placeholder:"Company Name"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Street Address"}),e.jsx("input",{className:"input",value:t.clientAddress,onChange:c=>n("clientAddress",c.target.value),placeholder:"123 Main Street"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:t.clientCity,onChange:c=>n("clientCity",c.target.value),placeholder:"New York"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:t.clientState,onChange:c=>n("clientState",c.target.value),placeholder:"NY"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Zip Code"}),e.jsx("input",{className:"input",value:t.clientZip,onChange:c=>n("clientZip",c.target.value),placeholder:"10001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Phone Number"}),e.jsx("input",{className:"input",value:t.clientPhone,onChange:c=>n("clientPhone",c.target.value),placeholder:"+233 ..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email Address"}),e.jsx("input",{className:"input",type:"email",value:t.clientEmail,onChange:c=>n("clientEmail",c.target.value),placeholder:"name@example.com"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Bill Information"})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bill Date"}),e.jsx("input",{className:"input",type:"date",value:t.billDate,onChange:c=>n("billDate",c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{className:"input",type:"date",value:t.dueDate,onChange:c=>n("dueDate",c.target.value)})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Category"}),e.jsx("th",{className:"text-right",children:"Qty"}),e.jsx("th",{className:"text-right",children:"Rate"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[t.services.map((c,h)=>e.jsx(NJ,{idx:h,row:c,onChange:o,onRemove:l},h)),e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:e.jsx("button",{type:"button",className:"btn-success",onClick:i,children:"+ Add Service Line"})})})]})]})})})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Payment Details"})}),e.jsx("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:r.map(c=>{const h=t.paymentMethod===c.key;return e.jsxs("button",{type:"button",className:`p-3 rounded border text-left ${h?"border-brand-500 bg-brand-50":"border-slate-200 bg-white"}`,onClick:()=>a(c.key),children:[e.jsx("div",{className:"text-2xl",children:c.icon}),e.jsx("div",{className:"text-sm",children:c.label})]},c.key)})}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Reference / Transaction ID"}),e.jsx("input",{className:"input",value:t.paymentReference,onChange:c=>n("paymentReference",c.target.value),placeholder:"Enter reference number"})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Terms & Notes"})}),e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Terms"}),e.jsx("textarea",{className:"input",rows:3,value:t.terms,onChange:c=>n("terms",c.target.value),placeholder:"Payment due within 14 days"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Notes"}),e.jsx("textarea",{className:"input",rows:3,value:t.notes,onChange:c=>n("notes",c.target.value),placeholder:"Any additional information"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:d,children:"Save Bill"})]})]})}function qB(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState("");x.useEffect(()=>{let d=!0;return i(!0),o(""),ee.get("/purchase/service-confirmations").then(c=>{var h;d&&a(Array.isArray((h=c.data)==null?void 0:h.items)?c.data.items:[])}).catch(c=>{var h,A;d&&o(((A=(h=c==null?void 0:c.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load service confirmations")}).finally(()=>{d&&i(!1)}),()=>{d=!1}},[]);const u=x.useMemo(()=>{const d=t.toLowerCase();return r.filter(c=>String(c.sc_no||"").toLowerCase().includes(d)||String(c.supplier_name||"").toLowerCase().includes(d)||String(c.status||"").toLowerCase().includes(d))},[r,t]);return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Service Confirmation"}),e.jsx("p",{className:"text-sm mt-1",children:"Confirm service receipts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/service-management",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/service-management/service-confirmation/new",className:"btn-success",children:"+ New Confirmation"})]})]})}),e.jsxs("div",{className:"card-body",children:[l?e.jsx("div",{className:"text-sm text-red-600 mb-4",children:l}):null,e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by no, supplier, status...",className:"input max-w-md",value:t,onChange:d=>s(d.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[n?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"Loading..."})}):null,!n&&!u.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500 dark:text-slate-400",children:"No confirmations found"})}):null,u.map(d=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-brand-700 dark:text-brand-300",children:d.sc_no}),e.jsx("td",{children:d.sc_date?String(d.sc_date).slice(0,10):"-"}),e.jsx("td",{children:d.supplier_name||"-"}),e.jsx("td",{children:Number(d.total_amount||0).toFixed(2)}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-info",children:d.status||"DRAFT"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:`/service-management/service-confirmation/${d.id}?mode=view`,className:"text-brand hover:text-brand-700 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/service-management/service-confirmation/${d.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"})]})})]},d.id))]})]})})]})]})})}function mS(t){if(!t)return"";try{return new Date(t).toISOString().slice(0,10)}catch{return""}}function Ty(){const{id:t}=Ls(),{search:s}=ma(),r=ys(),a=t==="new",n=new URLSearchParams(s).get("mode")||(a?"edit":"view"),[i,l]=x.useState(new Date),[o,u]=x.useState(!1),[d,c]=x.useState(!1),[h,A]=x.useState(""),[f,g]=x.useState([]),[v,b]=x.useState({sc_no:"",sc_date:mS(new Date),supplier_id:"",status:"DRAFT",remarks:"",details:[]}),[y,j]=x.useState(""),[N,S]=x.useState(0);x.useEffect(()=>{let k=!0;return ee.get("/purchase/suppliers").then(D=>{var Q;k&&g(Array.isArray((Q=D.data)==null?void 0:Q.items)?D.data.items:[])}).catch(D=>{var Q,C;k&&A(((C=(Q=D==null?void 0:D.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load suppliers")}),()=>{k=!1}},[]),x.useEffect(()=>{const k=setInterval(()=>l(new Date),1e3);return()=>clearInterval(k)},[]),x.useEffect(()=>{if(a)return;let k=!0;return u(!0),A(""),ee.get(`/purchase/service-confirmations/${t}`).then(D=>{var E,w;if(!k)return;const Q=(E=D.data)==null?void 0:E.item,C=Array.isArray((w=D.data)==null?void 0:w.details)?D.data.details:[];Q&&b({sc_no:Q.sc_no||"",sc_date:mS(Q.sc_date),supplier_id:Q.supplier_id?String(Q.supplier_id):"",status:Q.status||"DRAFT",remarks:Q.remarks||"",details:C.map(O=>({description:O.description||"",qty:O.qty??"",unit_price:O.unit_price??""}))})}).catch(D=>{var Q,C;k&&A(((C=(Q=D==null?void 0:D.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load service confirmation")}).finally(()=>{k&&u(!1)}),()=>{k=!1}},[t,a]);const B=x.useMemo(()=>[{key:"diagnosis",name:"Diagnosis",icon:"",price:50},{key:"repair",name:"Repair",icon:"",price:150},{key:"maintenance",name:"Maintenance",icon:"",price:100},{key:"installation",name:"Installation",icon:"",price:200},{key:"consultation",name:"Consultation",icon:"",price:75},{key:"upgrade",name:"Upgrade",icon:"",price:220}],[]),P=x.useMemo(()=>{const k=v.details||[];let D=0;for(const Q of k){const C=Number(Q.qty),E=Number(Q.unit_price);!Number.isFinite(C)||!Number.isFinite(E)||(D+=C*E)}return D},[v.details]),L=x.useMemo(()=>P*.125,[P]),U=x.useMemo(()=>P+L,[P,L]),H=x.useMemo(()=>U*(Number(N)/100),[U,N]);function q(){window.print()}function V(){alert("Downloading confirmation PDF (demo)")}async function M(){try{await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard")}catch{alert("Unable to copy link")}}const z=k=>{b(D=>({...D,details:D.details.filter((Q,C)=>C!==k)}))},I=(k,D)=>{b(Q=>({...Q,details:Q.details.map((C,E)=>E===k?{...C,...D}:C)}))},G=k=>{const D=v.details.findIndex(Q=>String(Q.description||"").trim()===k.name);if(D>=0){z(D);return}b(Q=>({...Q,details:[...Q.details,{description:k.name,qty:1,unit_price:k.price}]}))},Y=k=>v.details.some(D=>String(D.description||"").trim()===k.name),J=async k=>{var D,Q;k&&typeof k.preventDefault=="function"&&k.preventDefault(),c(!0),A("");try{const C={sc_no:v.sc_no||null,sc_date:v.sc_date,supplier_id:v.supplier_id?Number(v.supplier_id):null,status:v.status||"DRAFT",remarks:v.remarks||null,details:(v.details||[]).map(E=>({description:String(E.description||"").trim(),qty:E.qty===""?null:Number(E.qty),unit_price:E.unit_price===""?null:Number(E.unit_price)}))};if(!C.sc_date||!C.supplier_id)throw new Error("Date and supplier are required");a?await ee.post("/purchase/service-confirmations",C):await ee.put(`/purchase/service-confirmations/${t}`,C),r("/purchase/service-confirmation")}catch(C){A(((Q=(D=C==null?void 0:C.response)==null?void 0:D.data)==null?void 0:Q.message)||(C==null?void 0:C.message)||"Failed to save service confirmation")}finally{c(!1)}},T=x.useMemo(()=>{const k=v.supplier_id?Number(v.supplier_id):null;if(!k)return"";const D=f.find(Q=>Number(Q.id)===k);return D&&D.supplier_name||""},[v.supplier_id,f]);return n==="view"&&!a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"flex justify-center mb-2",children:e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx("span",{className:"text-3xl",children:""})})}),e.jsx("div",{className:"text-2xl font-bold",style:{color:"#0E3646"},children:"Service Confirmation"}),e.jsx("div",{className:"text-sm mt-1",children:"Confirmation saved successfully"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-6 mb-4 border-l-4",style:{borderLeftColor:"#0E3646"},children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Confirmation Number"}),e.jsx("div",{className:"text-xl font-bold",style:{color:"#0E3646"},children:v.sc_no||"-"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 border-2 border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",onClick:q,children:[" ",e.jsx("span",{className:"text-sm font-medium",children:"Print"})]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 border-2 border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",onClick:V,children:[" ",e.jsx("span",{className:"text-sm font-medium",children:"Download"})]}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-3 py-2 border-2 border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",onClick:M,children:[" ",e.jsx("span",{className:"text-sm font-medium",children:"Share"})]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold",children:"Status"}),e.jsx("span",{className:"badge badge-info",children:v.status||"DRAFT"})]})}),e.jsxs("div",{className:"card-body grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Supplier"}),e.jsx("div",{className:"font-semibold",children:T||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Appointment"}),e.jsx("div",{className:"font-semibold",children:v.sc_date||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("div",{className:"text-xs text-slate-500",children:"Remarks"}),e.jsx("div",{className:"font-semibold",children:v.remarks||"-"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Selected Services"})}),e.jsx("div",{className:"card-body",children:v.details.length?e.jsx("div",{className:"space-y-2",children:v.details.map((k,D)=>{const Q=Math.max(1,Number(k.qty||1)),C=Number(k.unit_price||0),E=Q*C;return e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-medium text-brand-700",children:k.description}),e.jsx("div",{className:"font-semibold",children:`GH ${E.toFixed(2)}`})]}),e.jsx("div",{className:"text-xs text-slate-600",children:`GH ${C.toFixed(2)}  ${Q}`})]},D)})}):e.jsxs("div",{className:"text-center text-slate-600 p-6",children:[e.jsx("div",{className:"text-3xl",children:""}),e.jsx("div",{className:"text-sm mt-2",children:"No services selected"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Totals"})}),e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Services Subtotal"}),e.jsx("div",{children:`GH ${P.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax (12.5%)"}),e.jsx("div",{children:`GH ${L.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-bold",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{children:`GH ${U.toFixed(2)}`})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/purchase/service-confirmation",className:"btn-secondary",children:"Back to List"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>r(`/purchase/service-confirmation/${t}?mode=edit`),children:"Edit Confirmation"})]})]}):e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:a?"New Service Confirmation":"Edit Service Confirmation"}),e.jsx("p",{className:"text-sm mt-1",children:"Confirm service receipts"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm",children:i.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold",children:i.toLocaleTimeString()})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"No"}),e.jsx("input",{type:"text",className:"input",value:v.sc_no,onChange:k=>b({...v,sc_no:k.target.value}),placeholder:"Auto-generated if blank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{type:"date",className:"input",value:v.sc_date,onChange:k=>b({...v,sc_date:k.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:v.status,onChange:k=>b({...v,status:k.target.value}),children:[e.jsx("option",{value:"DRAFT",children:"DRAFT"}),e.jsx("option",{value:"CONFIRMED",children:"CONFIRMED"}),e.jsx("option",{value:"CANCELLED",children:"CANCELLED"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Supplier *"}),e.jsxs("select",{className:"input",value:v.supplier_id,onChange:k=>b({...v,supplier_id:k.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select supplier..."}),f.map(k=>e.jsx("option",{value:String(k.id),children:(k.supplier_code?`${k.supplier_code} - `:"")+k.supplier_name},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Time"}),e.jsx("input",{type:"time",className:"input",value:y,onChange:k=>j(k.target.value)})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Select Services"}),e.jsx("div",{className:"rounded-lg border border-sky-200 bg-sky-50 text-sky-900 p-3 text-sm",children:"Click on services to select them. You can select multiple services."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-3",children:B.map(k=>{const D=Y(k);return e.jsxs("button",{type:"button",className:`p-4 rounded-lg border transition-colors text-left ${D?"border-brand-500 bg-brand text-white":"border-slate-200 bg-white hover:bg-slate-800 hover:text-white"}`,onClick:()=>G(k),children:[e.jsx("div",{className:"text-2xl",children:k.icon}),e.jsx("div",{className:"font-semibold mt-1",children:k.name}),e.jsx("div",{className:"mt-2 font-bold",children:`GH ${Number(k.price).toFixed(2)}`})]},k.key)})})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Additional Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Remarks"}),e.jsx("textarea",{className:"input",rows:"3",value:v.remarks,onChange:k=>b({...v,remarks:k.target.value})})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Service Summary"})}),e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"flex justify-between py-1 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm",children:"Supplier"}),e.jsx("div",{className:"text-sm font-semibold",children:T||"-"})]}),e.jsxs("div",{className:"flex justify-between py-1 border-b border-slate-200",children:[e.jsx("div",{className:"text-sm",children:"Appointment"}),e.jsx("div",{className:"text-sm font-semibold",children:(v.sc_date||"")+(y?` ${y}`:"")})]}),e.jsxs("div",{className:"flex justify-between py-1",children:[e.jsx("div",{className:"text-sm",children:"Location"}),e.jsx("div",{className:"text-sm font-semibold",children:"In Shop"})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Selected Services"}),v.details.length?e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:v.details.map((k,D)=>{const Q=Math.max(1,Number(k.qty||1)),C=Number(k.unit_price||0),E=Q*C;return e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-medium text-brand-700",children:k.description}),e.jsx("div",{className:"font-semibold",children:`GH ${E.toFixed(2)}`})]}),e.jsx("div",{className:"text-xs text-slate-600",children:`GH ${C.toFixed(2)}  ${Q}`}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("button",{type:"button",className:"btn-secondary btn-sm",onClick:()=>I(D,{qty:Math.max(1,Q-1)}),children:"-"}),e.jsx("span",{className:"text-sm font-semibold",children:Q}),e.jsx("button",{type:"button",className:"btn-secondary btn-sm",onClick:()=>I(D,{qty:Q+1}),children:"+"}),e.jsx("button",{type:"button",className:"btn-danger btn-sm ml-auto",onClick:()=>z(D),children:"Remove"})]})]},D)})}):e.jsxs("div",{className:"text-center text-slate-600 p-6",children:[e.jsx("div",{className:"text-3xl",children:""}),e.jsx("div",{className:"text-sm mt-2",children:"No services selected"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Deposit"})}),e.jsxs("div",{className:"card-body space-y-2",children:[e.jsx("label",{className:"label",children:"Deposit Percent"}),e.jsx("input",{type:"number",className:"input",value:N,onChange:k=>S(k.target.value),placeholder:"0"}),e.jsxs("div",{className:"text-sm",children:["Deposit Amount: ",`GH ${H.toFixed(2)}`]})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(Le,{to:"/service-management/service-confirmation",className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:J,disabled:d,children:"Save Confirmation"})]}),h?e.jsx("div",{className:"text-sm text-red-600 mt-3",children:h}):null]})]})})}function wJ({title:t,description:s}){return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:t}),s?e.jsx("p",{className:"text-sm mt-1",children:s}):null]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-sm",children:"This page is ready to be implemented."})})]})}function _J(){const[t,s]=Ts.useState([{icon:"",value:"GHS 2.5M",label:"Total Purchases (YTD)",change:" 15.3% from last year",changeType:"positive",path:"/purchase/reports"},{icon:"",value:"156",label:"Active Purchase Orders",change:" 12 this month",changeType:"positive",path:"/purchase/purchase-orders-local"},{icon:"",value:"48",label:"Active Suppliers",change:" 3 new this month",changeType:"positive",path:"/purchase/suppliers"},{icon:"",value:"23",label:"Pending Approvals",change:"Requires attention",changeType:"neutral",path:"/purchase/purchase-orders-local"},{icon:"",value:"GHS 450K",label:"Outstanding Payables",change:"25 pending invoices",changeType:"neutral",path:"/purchase/purchase-bills-local"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o;try{const u=await ee.get("/bi/dashboards"),d=Number(((o=(l=(i=u==null?void 0:u.data)==null?void 0:i.summary)==null?void 0:l.purchase)==null?void 0:o.total)||0);a&&s(c=>{const h=[...c];return h[0]={...h[0],value:`GHS ${Number(d).toLocaleString()}`,label:"Total Purchases (Last 30 Days)"},h})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"RFQ & Quotations",items:[{title:"Request for Quotation",description:"Create and send RFQs to suppliers",path:"/purchase/rfqs",icon:""},{title:"Supplier Quotations",description:"Receive and manage supplier quotations",path:"/purchase/supplier-quotations",icon:""},{title:"Quotation Analysis",description:"Compare quotations from multiple suppliers",path:"/purchase/quotation-analysis",icon:""}]},{title:"Purchase Orders",items:[{title:"Purchase Order - Local",description:"Create and manage local purchase orders",path:"/purchase/purchase-orders-local",icon:""},{title:"Purchase Order - Import",description:"Create and manage import purchase orders",path:"/purchase/purchase-orders-import",icon:""}]},{title:"Shipping & Clearing",items:[{title:"Shipping Advice",description:"Track shipments and vessel information",path:"/purchase/shipping-advice",icon:""},{title:"Clearing at Port",description:"Manage customs and port clearances",path:"/purchase/port-clearances",icon:""}]},{title:"Billing",items:[{title:"Purchase Bill - Local",description:"Record and manage local supplier bills",path:"/purchase/purchase-bills-local",icon:""},{title:"Purchase Bill - Import",description:"Record and manage import supplier bills",path:"/purchase/purchase-bills-import",icon:""}]},{title:"Service Procurement",items:[{title:"Service Bill",description:"Prepare and issue service bills",path:"/purchase/service-bills",icon:""},{title:"Service Confirmation",description:"Confirm received services",path:"/purchase/service-confirmation",icon:""}]},{title:"Suppliers",items:[{title:"Supplier Details Setup",description:"Add and manage supplier information",path:"/purchase/suppliers",icon:""}]},{title:"Reports",items:[{title:"Purchase Reports",description:"View purchase analytics and reports",path:"/purchase/reports",icon:""},{title:"Import Order Tracking",description:"Track import PO status and shipments",path:"/purchase/reports/import-order-tracking",icon:""},{title:"Local Order Tracking",description:"Track local PO status and deliveries",path:"/purchase/reports/local-order-tracking",icon:""},{title:"Purchase Tracking",description:"Track end-to-end procurement stages",path:"/purchase/reports/purchase-tracking",icon:""}]}];return e.jsx(Gl,{title:" Purchase Management Module",description:"Comprehensive procurement solution for local and import purchases, supplier management, and service procurement",stats:t,sections:r})}function SJ(){return e.jsxs(Ji,{children:[e.jsx(Je,{index:!0,element:e.jsx(_J,{})}),e.jsx(Je,{path:"rfqs",element:e.jsx(nX,{})}),e.jsx(Je,{path:"rfqs/new",element:e.jsx(Ab,{})}),e.jsx(Je,{path:"rfqs/:id",element:e.jsx(Ab,{})}),e.jsx(Je,{path:"rfqs/:id/edit",element:e.jsx(Ab,{})}),e.jsx(Je,{path:"supplier-quotations",element:e.jsx(AJ,{})}),e.jsx(Je,{path:"supplier-quotations/new",element:e.jsx(hb,{})}),e.jsx(Je,{path:"supplier-quotations/:id",element:e.jsx(hb,{})}),e.jsx(Je,{path:"supplier-quotations/:id/edit",element:e.jsx(hb,{})}),e.jsx(Je,{path:"quotation-analysis",element:e.jsx(hJ,{})}),e.jsx(Je,{path:"purchase-orders-local",element:e.jsx(mJ,{})}),e.jsx(Je,{path:"purchase-orders-local/new",element:e.jsx(mb,{})}),e.jsx(Je,{path:"purchase-orders-local/:id",element:e.jsx(mb,{})}),e.jsx(Je,{path:"purchase-orders-local/:id/edit",element:e.jsx(mb,{})}),e.jsx(Je,{path:"purchase-orders-import",element:e.jsx(fJ,{})}),e.jsx(Je,{path:"purchase-orders-import/new",element:e.jsx(fb,{})}),e.jsx(Je,{path:"purchase-orders-import/:id",element:e.jsx(fb,{})}),e.jsx(Je,{path:"purchase-orders-import/:id/edit",element:e.jsx(fb,{})}),e.jsx(Je,{path:"shipping-advice",element:e.jsx(pJ,{})}),e.jsx(Je,{path:"shipping-advice/new",element:e.jsx(dS,{})}),e.jsx(Je,{path:"shipping-advice/:id",element:e.jsx(dS,{})}),e.jsx(Je,{path:"port-clearances",element:e.jsx(xJ,{})}),e.jsx(Je,{path:"port-clearances/new",element:e.jsx(uS,{})}),e.jsx(Je,{path:"port-clearances/:id",element:e.jsx(uS,{})}),e.jsx(Je,{path:"purchase-bills-local",element:e.jsx(AS,{})}),e.jsx(Je,{path:"purchase-bills-local/new",element:e.jsx(bx,{})}),e.jsx(Je,{path:"purchase-bills-local/:id",element:e.jsx(bx,{})}),e.jsx(Je,{path:"purchase-bills-import",element:e.jsx(AS,{})}),e.jsx(Je,{path:"purchase-bills-import/new",element:e.jsx(bx,{})}),e.jsx(Je,{path:"purchase-bills-import/:id",element:e.jsx(bx,{})}),e.jsx(Je,{path:"service-bills",element:e.jsx(Fy,{})}),e.jsx(Je,{path:"service-bills/new",element:e.jsx(Fy,{})}),e.jsx(Je,{path:"service-confirmation",element:e.jsx(qB,{})}),e.jsx(Je,{path:"service-confirmation/new",element:e.jsx(Ty,{})}),e.jsx(Je,{path:"service-confirmation/:id",element:e.jsx(Ty,{})}),e.jsx(Je,{path:"suppliers",element:e.jsx(gJ,{})}),e.jsx(Je,{path:"suppliers/new",element:e.jsx(hS,{})}),e.jsx(Je,{path:"suppliers/:id",element:e.jsx(hS,{})}),e.jsx(Je,{path:"reports",element:e.jsx(wJ,{title:"Purchase Reports",description:"View purchase analytics and reports"})}),e.jsx(Je,{path:"reports/import-order-tracking",element:e.jsx(vJ,{})}),e.jsx(Je,{path:"reports/local-order-tracking",element:e.jsx(bJ,{})}),e.jsx(Je,{path:"reports/purchase-tracking",element:e.jsx(yJ,{})}),e.jsx(Je,{path:"*",element:e.jsx(Hc,{to:"/purchase",replace:!0})})]})}function CJ(){const[t,s]=Ts.useState([{icon:"",value:"245,000",label:"Cash Balance",change:" 5% this month",changeType:"positive",path:"/finance/reports"},{icon:"",value:"12",label:"Pending Vouchers",change:"3 urgent",changeType:"neutral",path:"/finance/journal-voucher"},{icon:"",value:"32,000",label:"Monthly Expenses",change:" 2% vs last month",changeType:"positive",path:"/finance/reports"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.finance)==null?void 0:o.cash_balance)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.finance)==null?void 0:c.pending_vouchers)||0),y=Number(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.finance)==null?void 0:f.monthly_expenses)||0);a&&s(j=>{const N=[...j];return N[0]={...N[0],value:`${v.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:`${y.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Voucher Management",features:[{name:"Journal Entry",path:"/finance/journal-voucher",description:"General ledger journal entries",icon:""},{name:"Make Payment",path:"/finance/payment-voucher",description:"Record outgoing payments",icon:""},{name:"Receive Payment",path:"/finance/receipt-voucher",description:"Record incoming payments",icon:""},{name:"Credit Note",path:"/finance/credit-note",description:"Customer credit notes",icon:""},{name:"Debit Note",path:"/finance/debit-note",description:"Supplier debit notes",icon:""},{name:"Sales Voucher",path:"/finance/sales-voucher",description:"Sales transaction vouchers",icon:""},{name:"Purchase Voucher",path:"/finance/purchase-voucher",description:"Purchase transaction vouchers",icon:""},{name:"Account Transfer",path:"/finance/contra-voucher",description:"Bank or ledger transfers",icon:""},{name:"Voucher Register Report",path:"/finance/reports",description:"Voucher listing with filters (report)",icon:""}]},{title:"Accounting Setup",features:[{name:"Chart of Account Groups",path:"/finance/account-groups",description:"Setup account group hierarchy",icon:""},{name:"Accounts Creation",path:"/finance/accounts",description:"Create and manage accounts",icon:""},{name:"Tax Codes & Deductions",path:"/finance/tax-codes",description:"Configure tax and deduction codes",icon:""},{name:"Currencies",path:"/finance/currencies",description:"Manage currencies and base currency",icon:""},{name:"Fiscal Years",path:"/finance/fiscal-years",description:"Open/close fiscal periods",icon:""}]},{title:"Reports & Analysis",features:[{name:"Voucher Register",path:"/finance/reports/voucher-register",description:"Voucher listing with filters",icon:""},{name:"Payment Due",path:"/finance/reports/payment-due",description:"Upcoming and overdue payables",icon:""},{name:"Customer Outstanding",path:"/finance/reports/customer-outstanding",description:"Receivables outstanding by customer",icon:""},{name:"Trial Balance",path:"/finance/reports/trial-balance",description:"Debits and credits summary",icon:""},{name:"Audit Trail",path:"/finance/reports/audit-trail",description:"System activity on finance transactions",icon:""},{name:"Journal Report",path:"/finance/reports/journals",description:"Journal entries by range",icon:""},{name:"General Ledger",path:"/finance/reports/general-ledger",description:"Account ledger movements",icon:""},{name:"Debtors Ledger",path:"/finance/reports/debtors-ledger",description:"Customer ledger with running balance",icon:""},{name:"Creditors Ledger",path:"/finance/reports/creditors-ledger",description:"Supplier ledger with running balance",icon:""},{name:"Supplier Outstanding",path:"/finance/reports/supplier-outstanding",description:"Payables outstanding by supplier",icon:""},{name:"Profit & Loss",path:"/finance/reports/profit-and-loss",description:"Income vs. expenses summary",icon:""},{name:"Balance Sheet",path:"/finance/reports/balance-sheet",description:"Assets, liabilities, and equity",icon:""},{name:"Cash Flow",path:"/finance/reports/cash-flow",description:"Operating, investing, financing flows",icon:""},{name:"Ratio Analysis",path:"/finance/reports/ratio-analysis",description:"Key performance ratios",icon:""}]},{title:"Banking",features:[{name:"Bank Reconciliation",path:"/finance/bank-reconciliation",description:"Match bank statements with ledger, mark cleared",icon:""},{name:"Post-Dated Cheques (PDC)",path:"/finance/pdc-postings",description:"Register instruments and track status",icon:""}]}];return e.jsx(Gl,{title:"Finance Module",description:"Comprehensive accounting, budgeting, and financial reporting system",stats:t,sections:r})}function kJ({status:t}){const s=t==="DRAFT"?"badge badge-warning":t==="APPROVED"||t==="POSTED"?"badge badge-success":t==="REVERSED"||t==="CANCELLED"?"badge badge-error":"badge badge-info";return e.jsx("span",{className:s,children:t})}function Wd({voucherTypeCode:t,title:s}){const[r,a]=x.useState([]),[n,i]=x.useState(!0),[l,o]=x.useState(""),[u,d]=x.useState("ALL"),c=String(t).toUpperCase()==="PV",h=String(t).toUpperCase()==="RV",A=String(t).toUpperCase()==="CV",[f,g]=x.useState(!1),[v,b]=x.useState(null),[y,j]=x.useState(!1),[N,S]=x.useState(""),[B,P]=x.useState(null),[L,U]=x.useState([]),[H,q]=x.useState(null),[V,M]=x.useState(null),[z,I]=x.useState(null),[G,Y]=x.useState(!1),[J,T]=x.useState({name:"",address:"",phone:"",email:"",city:"",state:"",country:"",postalCode:"",website:"",taxId:"",registrationNo:"",logoUrl:""}),[k,D]=x.useState(null),[Q,C]=x.useState(null),E=String(t).toUpperCase()==="JV"?"journal-voucher":String(t).toUpperCase()==="PV"?"payment-voucher":String(t).toUpperCase()==="RV"?"receipt-voucher":String(t).toUpperCase()==="CV"?"contra-voucher":String(t).toUpperCase()==="SV"?"sales-voucher":String(t).toUpperCase()==="PUV"?"purchase-voucher":String(t).toUpperCase()==="DN"?"debit-note":"credit-note";async function w(){var be,Ce,Te;try{i(!0);const ue=await ee.get("/finance/vouchers",{params:{voucherTypeCode:t}});a(((be=ue.data)==null?void 0:be.items)||[])}catch(ue){nt.error(((Te=(Ce=ue==null?void 0:ue.response)==null?void 0:Ce.data)==null?void 0:Te.message)||"Failed to load vouchers")}finally{i(!1)}}const[O,R]=x.useState([]),[X,ne]=x.useState(!1);async function te(){var be;try{ne(!0);const Ce=await ee.get("/finance/accounts",{params:{active:1}});R(((be=Ce.data)==null?void 0:be.items)||[])}catch{R([])}finally{ne(!1)}}x.useEffect(()=>{w(),A&&te()},[t]),x.useEffect(()=>{let be=!0;async function Ce(){var Te,ue,ge;try{const tt=(ue=(Te=(await ee.get("/admin/me")).data)==null?void 0:Te.scope)==null?void 0:ue.companyId;if(!tt)return;const ht=((ge=(await ee.get(`/admin/companies/${tt}`)).data)==null?void 0:ge.item)||{};if(!be)return;T(ze=>({...ze,name:ht.name||ze.name||"",address:ht.address||ze.address||"",phone:ht.telephone||ze.phone||"",email:ht.email||ze.email||"",city:ht.city||ze.city||"",state:ht.state||ze.state||"",country:ht.country||ze.country||"",postalCode:ht.postal_code||ze.postalCode||"",website:ht.website||ze.website||"",taxId:ht.tax_id||ze.taxId||"",registrationNo:ht.registration_no||ze.registrationNo||"",logoUrl:ht.has_logo===1||ht.has_logo===!0?`/api/admin/companies/${tt}/logo`:ze.logoUrl||""}))}catch{}}return Ce(),()=>{be=!1}},[]);const oe=x.useMemo(()=>r.filter(be=>{const Ce=l.trim().toLowerCase(),Te=!Ce||String(be.voucher_no||"").toLowerCase().includes(Ce)||String(be.narration||"").toLowerCase().includes(Ce),ue=u==="ALL"||be.status===u;return Te&&ue}),[r,l,u]),ce=x.useMemo(()=>{const be=new Map;for(const Ce of O||[]){const Te=String(Ce.code||""),ue=String(Ce.name||"");Te&&be.set(Te,ue)}return be},[O]);function re(be){var Ve,tt;const Ce=String(be.narration||"");if(!A||!Ce)return Ce||"-";const Te=Ce.split(" | ").map(Ze=>Ze.trim());let ue="",ge="";for(const Ze of Te)if(Ze.toLowerCase().startsWith("from:")){const ht=((Ve=Ze.split(":")[1])==null?void 0:Ve.trim())||"";ue=ce.get(ht)||ht}else if(Ze.toLowerCase().startsWith("to:")){const ht=((tt=Ze.split(":")[1])==null?void 0:tt.trim())||"";ge=ce.get(ht)||ht}return ue&&ge?`${ue}  ${ge}`:ue||ge||Ce||"-"}function de(be){return String(be??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Ie(be){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Voucher</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; color: #0f172a; background: #fff; }
      .vh { font-size: 12px; }
      .vh table { border-collapse: collapse; width: 100%; }
      .vh th, .vh td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      .vh th { background: #f8fafc; text-align: left; }
      .vh .right { text-align: right; }
      .vh .center { text-align: center; }
      .vh-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 8px; }
      .vh-logo { min-width: 120px; max-width: 200px; }
      .vh-company { text-align: right; font-size: 11px; line-height: 1.35; }
      .vh-company .name { font-weight: 800; font-size: 14px; }
      .vh-titlebar { display: flex; align-items: center; gap: 10px; color: #0f172a; margin: 4px 0 10px; }
      .vh-titlebar .line { flex: 1; height: 1px; background: #0f172a; }
      .vh-titlebar .title { font-weight: 700; }
      .vh-details { width: 100%; margin-bottom: 10px; border: 1px solid #cbd5e1; }
      .vh-details td { border-color: #cbd5e1; }
      .vh-details .label { width: 32%; color: #475569; }
      .vh-details .label-wide { width: 40%; color: #475569; }
      .vh-items thead th { font-weight: 600; }
      .vh-footer a { color: inherit; text-decoration: underline; }
      @media print { button { display: none; } }
    </style>
  </head>
  <body>${be||""}</body>
</html>`}async function le(be){var Te;const Ce=Array.from(((Te=be==null?void 0:be.querySelectorAll)==null?void 0:Te.call(be,"img"))||[]);Ce.length&&await Promise.all(Ce.map(ue=>new Promise(ge=>{if(ue.complete)return ge();const Ve=()=>ge();ue.addEventListener("load",Ve,{once:!0}),ue.addEventListener("error",Ve,{once:!0})})))}function Z(be){const Ce=be.company||{},Te=be.receipt||{},ue=Array.isArray(be.items)?be.items:[],ge=be.totals||{};return`
    <div class="vh">
      <div class="vh-header">
        <div class="vh-logo">${Ce.logoHtml||""}</div>
        <div class="vh-company">
          <div class="name">${de(Ce.name||"")}</div>
          <div>${de(Ce.addressLine1||"")}</div>
          <div>${de(Ce.addressLine2||"")}</div>
          <div>Telephone: ${de(Ce.phone||"")}</div>
          <div>${de(Ce.website||"")}</div>
          <div>TIN: ${de(Ce.taxId||"")} &nbsp; Reg: ${de(Ce.registrationNo||"")}</div>
        </div>
      </div>
      <div class="vh-titlebar">
        <div class="line"></div>
        <div class="title">* Receipt Voucher *</div>
        <div class="line"></div>
      </div>
      <table class="vh-details">
        <tr>
          <td style="width:50%;vertical-align:top;border-right:1px solid #cbd5e1;">
            <table style="width:100%;">
              <tr><td class="label-wide">Receipt No</td><td>:</td><td>${de(Te.receiptNo||"")}</td></tr>
              <tr><td class="label-wide">Date/Time</td><td>:</td><td>${de(Te.dateTime||"")}</td></tr>
              <tr><td class="label-wide">Method</td><td>:</td><td>${de(Te.paymentMethod||"")}</td></tr>
            </table>
          </td>
          <td style="width:50%;vertical-align:top;">
            <div style="padding:8px;">
              <div class="label">Narration</div>
              <div>${de(Te.headerText||"")}</div>
            </div>
          </td>
        </tr>
      </table>
      <table class="vh-items">
        <thead>
          <tr>
            <th>Description</th>
            <th class="right" style="width:22%;">Amount</th>
          </tr>
        </thead>
        <tbody>
          ${ue.map(Ve=>`
            <tr>
              <td>${de(Ve.name||"")}</td>
              <td class="right">${de(Ve.lineTotal||Ve.price||"0.00")}</td>
            </tr>
          `).join("")}
          <tr>
            <td class="right"><strong>Subtotal</strong></td>
            <td class="right"><strong>${de(Number(ge.subtotal||0).toFixed(2))}</strong></td>
          </tr>
          <tr>
            <td class="right">Tax</td>
            <td class="right">${de(Number(ge.tax||0).toFixed(2))}</td>
          </tr>
          <tr>
            <td class="right"><strong>Total</strong></td>
            <td class="right"><strong>${de(Number(ge.total||ge.grand||0).toFixed(2))}</strong></td>
          </tr>
        </tbody>
      </table>
      <div class="vh-footer" style="margin-top:10px;text-align:center;">
        <div>${de(Te.footerText||"")}</div>
      </div>
    </div>
    `}function ve(be){const Ce=be.company||{},Te=be.payment||{},ue=Array.isArray(be.items)?be.items:[],ge=be.totals||{};return`
    <div class="vh">
      <div class="vh-header">
        <div class="vh-logo">${Ce.logoHtml||""}</div>
        <div class="vh-company">
          <div class="name">${de(Ce.name||"")}</div>
          <div>${de(Ce.addressLine1||"")}</div>
          <div>${de(Ce.addressLine2||"")}</div>
          <div>Telephone: ${de(Ce.phone||"")}</div>
          <div>${de(Ce.website||"")}</div>
          <div>TIN: ${de(Ce.taxId||"")} &nbsp; Reg: ${de(Ce.registrationNo||"")}</div>
        </div>
      </div>
      <div class="vh-titlebar">
        <div class="line"></div>
        <div class="title">* Payment Voucher *</div>
        <div class="line"></div>
      </div>
      <table class="vh-details">
        <tr>
          <td style="width:50%;vertical-align:top;border-right:1px solid #cbd5e1;">
            <table style="width:100%;">
              <tr><td class="label-wide">Payment No</td><td>:</td><td>${de(Te.paymentNo||"")}</td></tr>
              <tr><td class="label-wide">Date/Time</td><td>:</td><td>${de(Te.dateTime||"")}</td></tr>
              <tr><td class="label-wide">Method</td><td>:</td><td>${de(Te.paymentMethod||"")}</td></tr>
            </table>
          </td>
          <td style="width:50%;vertical-align:top;">
            <div style="padding:8px;">
              <div class="label">Narration</div>
              <div>${de(Te.headerText||"")}</div>
            </div>
          </td>
        </tr>
      </table>
      <table class="vh-items">
        <thead>
          <tr>
            <th>Description</th>
            <th class="right" style="width:22%;">Amount</th>
          </tr>
        </thead>
        <tbody>
          ${ue.map(Ve=>`
            <tr>
              <td>${de(Ve.name||"")}</td>
              <td class="right">${de(Ve.lineTotal||Ve.price||"0.00")}</td>
            </tr>
          `).join("")}
          <tr>
            <td class="right"><strong>Subtotal</strong></td>
            <td class="right"><strong>${de(Number(ge.subtotal||0).toFixed(2))}</strong></td>
          </tr>
          <tr>
            <td class="right">Tax</td>
            <td class="right">${de(Number(ge.tax||0).toFixed(2))}</td>
          </tr>
          <tr>
            <td class="right"><strong>Total</strong></td>
            <td class="right"><strong>${de(Number(ge.total||ge.grand||0).toFixed(2))}</strong></td>
          </tr>
        </tbody>
      </table>
      <div class="vh-footer" style="margin-top:10px;text-align:center;">
        <div>${de(Te.footerText||"")}</div>
      </div>
    </div>
    `}function Ue(be,Ce){const Te=String(J.logoUrl||"").trim(),ue=Te?`<img src="${Te}" alt="${de(J.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",ge=(Array.isArray(Ce)?Ce:[]).filter(tt=>Number(tt.credit||0)>0).map(tt=>{const Ze=Number(tt.credit||0);return{name:String(tt.description||tt.account_name||""),qty:"1.00",price:Ze.toFixed(2),discount:"0.00",lineTotal:Ze.toFixed(2)}}),Ve=ge.reduce((tt,Ze)=>{const ht=Number(Ze.lineTotal||0);return tt.subtotal+=ht,tt.total+=ht,tt},{subtotal:0,total:0});return{company:{name:J.name||"",addressLine1:J.address||"",addressLine2:[J.city,J.state,J.country].filter(Boolean).join("  "),phone:J.phone||"",website:J.website||"",taxId:J.taxId||"",registrationNo:J.registrationNo||"",logoUrl:Te,logoHtml:ue},receipt:{receiptNo:String(be.voucher_no||""),dateTime:be.voucher_date?new Date(be.voucher_date).toLocaleString():new Date().toLocaleString(),paymentMethod:"",headerText:"",footerText:""},items:ge,totals:{subtotal:Ve.subtotal.toFixed(2),tax:"0.00",total:Ve.total.toFixed(2)}}}function Be(be,Ce){const Te=String(J.logoUrl||"").trim(),ue=Te?`<img src="${Te}" alt="${de(J.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",ge=(Array.isArray(Ce)?Ce:[]).filter(tt=>Number(tt.debit||0)>0).map(tt=>{const Ze=Number(tt.debit||0);return{name:String(tt.description||tt.account_name||""),qty:"1.00",price:Ze.toFixed(2),discount:"0.00",lineTotal:Ze.toFixed(2)}}),Ve=ge.reduce((tt,Ze)=>{const ht=Number(Ze.lineTotal||0);return tt.subtotal+=ht,tt.total+=ht,tt},{subtotal:0,total:0});return{company:{name:J.name||"",addressLine1:J.address||"",addressLine2:[J.city,J.state,J.country].filter(Boolean).join("  "),phone:J.phone||"",website:J.website||"",taxId:J.taxId||"",registrationNo:J.registrationNo||"",logoUrl:Te,logoHtml:ue},payment:{paymentNo:String(be.voucher_no||""),dateTime:be.voucher_date?new Date(be.voucher_date).toLocaleString():new Date().toLocaleString(),paymentMethod:"",headerText:"",footerText:""},items:ge,totals:{subtotal:Ve.subtotal.toFixed(2),tax:"0.00",total:Ve.total.toFixed(2)}}}async function _e(be){var Ce,Te,ue;try{const ge=await ee.get(`/finance/vouchers/${be}`),Ve=((Ce=ge.data)==null?void 0:Ce.voucher)||{},tt=Array.isArray((Te=ge.data)==null?void 0:Te.lines)?ge.data.lines:[],Ze=h?Z(Ue(Ve,tt)):c?ve(Be(Ve,tt)):"",ht=Ie(Ze),ze=document.createElement("iframe");ze.style.position="fixed",ze.style.right="0",ze.style.bottom="0",ze.style.width="0",ze.style.height="0",ze.style.border="0",document.body.appendChild(ze);const Fe=((ue=ze.contentWindow)==null?void 0:ue.document)||ze.contentDocument||null;if(!Fe){document.body.removeChild(ze),window.print();return}Fe.open(),Fe.write(ht),Fe.close();const xe=ze.contentWindow||window;setTimeout(()=>{xe.focus();try{xe.print()}catch{}setTimeout(()=>{document.body.removeChild(ze)},100)},200)}catch{}}async function Me(be){var Ce,Te;try{const ue=await ee.get(`/finance/vouchers/${be}`),ge=((Ce=ue.data)==null?void 0:Ce.voucher)||{},Ve=Array.isArray((Te=ue.data)==null?void 0:Te.lines)?ue.data.lines:[],tt=h?Z(Ue(ge,Ve)):c?ve(Be(ge,Ve)):"";if(!tt)return;const Ze=document.createElement("div");Ze.style.position="fixed",Ze.style.left="-10000px",Ze.style.top="0",Ze.style.width="794px",Ze.style.background="white",Ze.style.padding="32px",Ze.innerHTML=tt,document.body.appendChild(Ze);try{await le(Ze);const ht=await Ai(Ze,{scale:2,useCORS:!0}),ze=ht.toDataURL("image/png"),Fe=new ds("p","mm","a4"),xe=Fe.internal.pageSize.getWidth(),we=Fe.internal.pageSize.getHeight(),Xe=xe,ut=ht.height*Xe/ht.width;let ft=0;for(;ft<ut;)Fe.addImage(ze,"PNG",0,-ft,Xe,ut),ft+=we,ft<ut&&Fe.addPage();const mt=(h?"ReceiptVoucher_":c?"PaymentVoucher_":"Voucher_")+(String(ge.voucher_no||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";Fe.save(mt)}finally{document.body.removeChild(Ze)}}catch{}}async function Ye(be){var Ce,Te;try{const ue=window.prompt("Reason for reversal (optional):")||"";await ee.post(`/finance/vouchers/${be}/reverse`,{reason:ue}),nt.success("Voucher reversed"),w()}catch(ue){nt.error(((Te=(Ce=ue==null?void 0:ue.response)==null?void 0:Ce.data)==null?void 0:Te.message)||"Failed to reverse voucher")}}async function ot(be){var Ce,Te,ue;if(b(be),g(!0),S(""),V)await Ke();else try{j(!0);const ge=await ee.get("/workflows"),Ve=Array.isArray((Ce=ge.data)==null?void 0:Ce.items)?ge.data.items:[];M(Ve),await ct(Ve)}catch(ge){S(((ue=(Te=ge==null?void 0:ge.response)==null?void 0:Te.data)==null?void 0:ue.message)||"Failed to load workflows")}finally{j(!1)}}async function Ke(){var ge,Ve,tt;if(!V||!V.length){P(null),q(null),U([]),S("");return}const be=c?"/finance/payment-voucher":h?"/finance/receipt-voucher":"/finance/contra-voucher",Ce=c?["PAYMENT_VOUCHER","Payment Voucher","PV"]:h?["RECEIPT_VOUCHER","Receipt Voucher","RV"]:["CONTRA_VOUCHER","Contra Voucher","CV"],Te=Ze=>String(Ze||"").trim().toUpperCase().replace(/\s+/g,"_"),ue=V.find(Ze=>Number(Ze.is_active)===1&&String(Ze.document_route||"")===be)||V.find(Ze=>Number(Ze.is_active)===1&&(Te(Ze.document_type)===Te(Ce[0])||Te(Ze.document_type)===Te(Ce[1])||Te(Ze.document_type)===Te(Ce[2])))||null;if(P(ue||null),q(null),I(null),U([]),!!ue)try{j(!0);const Ze=await ee.get(`/workflows/${ue.id}`),ht=((ge=Ze==null?void 0:Ze.data)==null?void 0:ge.item)||{},ze=Array.isArray(ht==null?void 0:ht.steps)?ht.steps:[];U(ze);const Fe=ze[0]||null;if(q(Fe?{userId:Fe.approver_user_id,name:Fe.approver_name,stepName:Fe.step_name,stepOrder:Fe.step_order,approvalLimit:Fe.approval_limit}:null),Fe){const xe=(Array.isArray(Fe.approvers)&&Fe.approvers.length?Fe.approvers[0].id:Fe.approver_user_id)||null;I(xe)}else I(null)}catch(Ze){S(((tt=(Ve=Ze==null?void 0:Ze.response)==null?void 0:Ve.data)==null?void 0:tt.message)||"Failed to load workflow details")}finally{j(!1)}}async function ct(be){var Ve,tt,Ze;if(!be||!be.length){P(null),q(null),U([]),S("");return}const Ce=c?"/finance/payment-voucher":h?"/finance/receipt-voucher":"/finance/contra-voucher",Te=c?["PAYMENT_VOUCHER","Payment Voucher","PV"]:h?["RECEIPT_VOUCHER","Receipt Voucher","RV"]:["CONTRA_VOUCHER","Contra Voucher","CV"],ue=ht=>String(ht||"").trim().toUpperCase().replace(/\s+/g,"_"),ge=be.find(ht=>Number(ht.is_active)===1&&String(ht.document_route||"")===Ce)||be.find(ht=>Number(ht.is_active)===1&&(ue(ht.document_type)===ue(Te[0])||ue(ht.document_type)===ue(Te[1])||ue(ht.document_type)===ue(Te[2])))||null;if(P(ge||null),q(null),I(null),U([]),!!ge)try{j(!0);const ht=await ee.get(`/workflows/${ge.id}`),ze=((Ve=ht==null?void 0:ht.data)==null?void 0:Ve.item)||{},Fe=Array.isArray(ze==null?void 0:ze.steps)?ze.steps:[];U(Fe);const xe=Fe[0]||null;if(q(xe?{userId:xe.approver_user_id,name:xe.approver_name,stepName:xe.step_name,stepOrder:xe.step_order,approvalLimit:xe.approval_limit}:null),xe){const we=(Array.isArray(xe.approvers)&&xe.approvers.length?xe.approvers[0].id:xe.approver_user_id)||null;I(we)}else I(null)}catch(ht){S(((Ze=(tt=ht==null?void 0:ht.response)==null?void 0:tt.data)==null?void 0:Ze.message)||"Failed to load workflow details")}finally{j(!1)}}async function xt(){var be,Ce,Te;if(v){Y(!0),S("");try{const ue=v.total_debit===void 0||v.total_debit===null?v.total_credit===void 0||v.total_credit===null?null:Number(v.total_credit||0):Number(v.total_debit||0),ge=await ee.post(`/finance/vouchers/${v.id}/submit`,{amount:ue,workflow_id:B?B.id:null,target_user_id:z||null}),Ve=((be=ge==null?void 0:ge.data)==null?void 0:be.status)||"PENDING_APPROVAL";a(tt=>tt.map(Ze=>Ze.id===v.id?{...Ze,status:Ve}:Ze)),g(!1),b(null)}catch(ue){S(((Te=(Ce=ue==null?void 0:ue.response)==null?void 0:Ce.data)==null?void 0:Te.message)||"Failed to forward for approval")}finally{Y(!1)}}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"List, review, and manage vouchers"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{type:"button",className:"btn-success",onClick:w,disabled:n,children:"Refresh"}),e.jsx(Le,{to:"./create",className:"btn-success",children:"Create New"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"input",placeholder:"Search voucher no or narration...",value:l,onChange:be=>o(be.target.value)})}),e.jsx("div",{className:"w-full md:w-56",children:e.jsxs("select",{className:"input",value:u,onChange:be=>d(be.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"SUBMITTED",children:"Submitted"}),e.jsx("option",{value:"APPROVED",children:"Approved"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"REVERSED",children:"Reversed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})})]}),n?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("div",{className:"mt-2",children:"Loading..."})]}):oe.length===0?e.jsx("div",{className:"text-center py-12",children:"No vouchers found."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Narration"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:oe.map(be=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:be.voucher_no}),e.jsx("td",{children:new Date(be.voucher_date).toLocaleDateString()}),e.jsx("td",{children:re(be)}),e.jsx("td",{className:"text-right",children:`GH ${Number(be.total_debit||0).toLocaleString()}`}),e.jsx("td",{className:"text-right",children:`GH ${Number(be.total_credit||0).toLocaleString()}`}),e.jsx("td",{children:e.jsx(kJ,{status:be.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Le,{to:`/finance/${E}/${be.id}?mode=view`,className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),e.jsx(Le,{to:`/finance/${E}/${be.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 font-medium text-sm",style:{display:(c||h)&&be.status==="APPROVED"?"none":"inline"},children:"Edit"}),(c||h)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",onClick:()=>_e(be.id),children:"Print"}),e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",onClick:()=>Me(be.id),children:"PDF"})]}),(c||h||A)&&(be.status==="APPROVED"?e.jsx("span",{className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-green-500 text-white",children:"Approved"}):e.jsx("button",{type:"button",className:"ml-3 text-sm font-medium px-2 py-1 rounded bg-brand text-white hover:bg-brand-700 transition-colors",onClick:()=>ot(be),disabled:G||be.status==="POSTED"||be.status==="REJECTED"||be.status==="PENDING_APPROVAL"||be.status==="SUBMITTED",children:"Forward for Approval"})),!c&&!h&&!A&&e.jsx("button",{type:"button",className:"text-red-600 hover:text-red-700 font-medium text-sm",onClick:()=>Ye(be.id),disabled:be.status==="REVERSED",children:"Reverse"})]})})]},be.id))})]})})]})}),f?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w/full max-w-md overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-brand text-white flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Forward for Approval"}),e.jsx("button",{onClick:()=>{g(!1),b(null),P(null),q(null),I(null),U([]),S("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Voucher:"," ",e.jsx("span",{className:"font-semibold",children:v==null?void 0:v.voucher_no})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:B?`${B.workflow_name} (${B.workflow_code})`:"None (inactive)"})]}),e.jsxs("div",{children:[y?e.jsx("div",{className:"text-sm",children:"Loading workflow..."}):null,N?e.jsx("div",{className:"text-sm text-red-600",children:N}):null]}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Target Approver"}),(()=>{const Ce=Array.isArray(L)&&L.length>0?L[0]:null,Te=Ce?Array.isArray(Ce.approvers)&&Ce.approvers.length?Ce.approvers.map(ue=>({id:ue.id,name:ue.username})):Ce.approver_user_id?[{id:Ce.approver_user_id,name:Ce.approver_name||String(Ce.approver_user_id)}]:[]:[];return Te.length>0?e.jsxs("div",{className:"mt-1",children:[e.jsxs("select",{className:"input w-full",value:z||"",onChange:ue=>I(ue.target.value?Number(ue.target.value):null),children:[e.jsx("option",{value:"",children:"Select target approver"}),Te.map(ue=>e.jsx("option",{value:ue.id,children:ue.name},ue.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:H?`Step ${H.stepOrder}  ${H.stepName}${H.approvalLimit!=null?`  Limit: ${Number(H.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:B?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})()]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{g(!1),b(null),P(null),q(null),I(null),U([]),S("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:xt,disabled:G||!v||Array.isArray(L)&&L.length>0&&B&&!z,children:G?"Forwarding...":"Forward"})]})]})}):null]})}function Sm(){return{accountId:"",description:"",debit:"",credit:""}}function si({voucherTypeCode:t,title:s}){var fc,xi,yl;const r=ys(),{id:a}=Ls(),{search:n}=ma(),l=new URLSearchParams(n).get("mode")==="view",o=!!a,[u,d]=x.useState(!1),[c,h]=x.useState([]),[A,f]=x.useState([]),[g,v]=x.useState([]),[b,y]=x.useState([]),[j,N]=x.useState([]),[S,B]=x.useState([]),[P,L]=x.useState([]),[U,H]=x.useState([]),[q,V]=x.useState([]),[M,z]=x.useState(""),[I,G]=x.useState(new Date().toISOString().split("T")[0]),[Y,J]=x.useState(""),[T,k]=x.useState(""),[D,Q]=x.useState([Sm(),Sm()]),C=String(t).toUpperCase()==="RV",E=String(t).toUpperCase()==="PV",w=String(t).toUpperCase()==="CV",O=String(t).toUpperCase()==="DN",R=String(t).toUpperCase()==="CN",[X,ne]=x.useState({receivedFrom:"",receivedFromCode:"",payerAccountId:"",paymentMethod:"Cash",reference:"",chequeDate:"",depositAccountId:"",taxCodeId:"",items:[{description:"",accountId:"",amount:"",referenceNo:""}],notes:""}),[te,oe]=x.useState({payTo:"",payToCode:"",payToAccountId:"",paymentMethod:"Cash",reference:"",chequeDate:"",paymentAccountId:"",taxCodeId:"",items:[{description:"",accountId:"",amount:""}],notes:""}),[ce,re]=x.useState(""),[de,Ie]=x.useState(""),[le,Z]=x.useState(!1),[ve,Ue]=x.useState(""),[Be,_e]=x.useState(!1),[Me,Ye]=x.useState(!1),[ot,Ke]=x.useState(""),[ct,xt]=x.useState(null),[be,Ce]=x.useState(null),[Te,ue]=x.useState(null),[ge,Ve]=x.useState(null),[tt,Ze]=x.useState(!1),[ht,ze]=x.useState("DRAFT"),[Fe,xe]=x.useState({fromAccountId:"",toAccountId:"",transferMethod:"Cash",reference:"",chequeDate:"",taxCodeId:"",items:[{description:"",amount:""}],notes:""}),[we,Xe]=x.useState(""),[ut,ft]=x.useState([]),[mt,pt]=x.useState(""),vt=x.useMemo(()=>{const ke=Array.isArray(ut)?ut:[];return ke.find(at=>String(at.is_base)==="1"||at.is_base===1||at.is_base===!0)||ke.find(at=>String(at.code||at.currency_code||"").toUpperCase()==="GHS")||ke.find(at=>/ghana|cedi/i.test(String(at.name||at.currency_name||"")))},[ut]),Ot=x.useMemo(()=>{const ke=D.find(dt=>String(dt.accountId||"")),at=g.find(dt=>String(dt.id)===String((ke==null?void 0:ke.accountId)||""));return(at==null?void 0:at.currency_id)||null},[D,g]);async function Ae(){var ke,at,dt,St,Ut,It,Ht,ts,Xt;try{const[hs,Ns,ns,ss,vs,fs,gr]=await Promise.all([ee.get("/finance/voucher-types"),ee.get("/finance/fiscal-years"),ee.get("/finance/accounts"),ee.get("/finance/tax-codes"),ee.get("/sales/customers?active=true"),ee.get("/purchase/suppliers?active=true"),ee.get("/finance/currencies")]),Ka=((ke=hs.data)==null?void 0:ke.items)||[],Ur=((at=Ns.data)==null?void 0:at.items)||[],er=((dt=ns.data)==null?void 0:dt.items)||[],ea=(((St=ss.data)==null?void 0:St.items)||[]).filter(Ys=>Number(Ys.is_active||0)===1),sr=Array.isArray((Ut=vs.data)==null?void 0:Ut.items)?vs.data.items:[],za=Array.isArray((It=fs.data)==null?void 0:It.items)?fs.data.items:[],un=Array.isArray((Ht=gr.data)==null?void 0:Ht.items)?gr.data.items:[],gi=[...sr.map(Ys=>({type:"CUSTOMER",id:Ys.id,code:Ys.customer_code&&String(Ys.customer_code).trim()||`C${String(Number(Ys.id||0)).padStart(5,"0")}`,name:String(Ys.customer_name||"").trim()})),...za.map(Ys=>({type:"SUPPLIER",id:Ys.id,code:Ys.supplier_code&&String(Ys.supplier_code).trim()||`SU-${String(Number(Ys.id||0)).padStart(6,"0")}`,name:String(Ys.supplier_name||"").trim()}))].filter(Ys=>Ys.name).sort((Ys,Gr)=>Ys.name.localeCompare(Gr.name));h(Ka),f(Ur),v(er),y(ea),N(gi),ft(un),!T&&Ur.length&&k(String(Ur[0].id))}catch(hs){nt.error(((Xt=(ts=hs==null?void 0:hs.response)==null?void 0:ts.data)==null?void 0:Xt.message)||"Failed to load finance setup")}}async function je(ke){var at;try{const dt=await ee.get("/sales/invoices"),Ut=(Array.isArray((at=dt.data)==null?void 0:at.items)?dt.data.items:[]).filter(It=>String(It.customer_id)===String(ke)&&Number(It.balance_amount||0)>0).map(It=>({id:It.id,invoice_no:It.invoice_no,balance_amount:Number(It.balance_amount||0),total_amount:Number(It.total_amount||0)})).sort((It,Ht)=>It.invoice_no.localeCompare(Ht.invoice_no));B(Ut)}catch{B([])}}async function We(ke){var at;try{const dt=await ee.get("/purchase/bills"),Ut=(Array.isArray((at=dt.data)==null?void 0:at.items)?dt.data.items:[]).filter(Ht=>String(Ht.supplier_id)===String(ke)).map(Ht=>({id:Ht.id,bill_no:Ht.bill_no,payment_status:String(Ht.payment_status||"UNPAID"),net_amount:Number(Ht.net_amount||0),amount_paid:Number(Ht.amount_paid||0),outstanding:Math.max(0,Math.round((Number(Ht.net_amount||0)-Number(Ht.amount_paid||0))*100)/100)})).filter(Ht=>Ht.payment_status!=="PAID"&&Number(Ht.outstanding)>0).sort((Ht,ts)=>String(Ht.bill_no||"").localeCompare(String(ts.bill_no||"")));L(Ut);const It=new Set(Ut.map(Ht=>String(Ht.bill_no)));H(Ht=>Ht.filter(ts=>It.has(String(ts))))}catch{L([])}}x.useEffect(()=>{Ae()},[]),x.useEffect(()=>{async function ke(){var at;if(!o&&E)try{const dt=await ee.get("/finance/vouchers/next-no?voucherTypeCode=PV"),St=String(((at=dt.data)==null?void 0:at.nextNo)||""),Ut=St.match(/^PV-?(\d+)$/i),It=Ut?`PV-${String(Ut[1]).padStart(6,"0")}`:St;z(It)}catch{z("")}}ke()},[E,o]),x.useEffect(()=>{async function ke(){var at;if(!o&&C)try{const dt=await ee.get("/finance/vouchers/next-no?voucherTypeCode=RV"),St=String(((at=dt.data)==null?void 0:at.nextNo)||""),Ut=St.match(/^RV-?(\d+)$/i),It=Ut?`RV-${String(Ut[1]).padStart(6,"0")}`:St;z(It)}catch{z("")}}ke()},[C,o]),x.useEffect(()=>{async function ke(){var at;if(!o&&w)try{const dt=await ee.get("/finance/vouchers/next-no?voucherTypeCode=CV"),St=String(((at=dt.data)==null?void 0:at.nextNo)||""),Ut=St.match(/^CV-?(\d+)$/i),It=Ut?`CV-${String(Ut[1]).padStart(6,"0")}`:St;z(It)}catch{z("")}}ke()},[w,o]),x.useEffect(()=>{async function ke(){var at;if(!o&&O)try{const dt=await ee.get("/finance/vouchers/next-no?voucherTypeCode=DN"),St=String(((at=dt.data)==null?void 0:at.nextNo)||""),Ut=St.match(/^DN-?(\d+)$/i),It=Ut?`DN-${String(Ut[1]).padStart(6,"0")}`:St;z(It)}catch{z("")}}ke()},[O,o]),x.useEffect(()=>{async function ke(){var at;if(!o&&R)try{const dt=await ee.get("/finance/vouchers/next-no?voucherTypeCode=CN"),St=String(((at=dt.data)==null?void 0:at.nextNo)||""),Ut=St.match(/^CN-?(\d+)$/i),It=Ut?`CN-${String(Ut[1]).padStart(6,"0")}`:St;z(It)}catch{z("")}}ke()},[R,o]),x.useEffect(()=>{if(!(R||O))return;const ke=Ot||null,at=(vt==null?void 0:vt.id)||null;if(!ke||!at){pt("1");return}if(String(ke)===String(at)){pt("1");return}(async()=>{var dt,St;try{const Ut=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Number(ke),toCurrencyId:Number(at),to:I||null}}),Ht=(Array.isArray((dt=Ut.data)==null?void 0:dt.items)?Ut.data.items:[]).slice().sort((Xt,hs)=>new Date(hs.rate_date).getTime()-new Date(Xt.rate_date).getTime());let ts=Ht.length?Number(Ht[0].rate||0):0;if(!ts)try{const Xt=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Number(at),toCurrencyId:Number(ke),to:I||null}}),Ns=(Array.isArray((St=Xt.data)==null?void 0:St.items)?Xt.data.items:[]).slice().sort((ss,vs)=>new Date(vs.rate_date).getTime()-new Date(ss.rate_date).getTime()),ns=Ns.length?Number(Ns[0].rate||0):0;ts=ns?1/ns:0}catch{}pt(ts?String(ts):"1")}catch{pt("1")}})()},[R,O,Ot,vt,I]);async function De(){var ke,at,dt,St,Ut,It,Ht,ts;if(o)try{d(!0);const hs=(await ee.get(`/finance/vouchers/${a}`)).data||{},Ns=hs.item||hs.voucher||hs;if(!Ns)return;const ns=(Ns.voucher_date||Ns.date||new Date().toISOString()).split("T")[0];G(ns),z(String(Ns.voucher_no||((ke=hs.voucher)==null?void 0:ke.voucher_no)||"")),ze(String(Ns.status||((at=hs.voucher)==null?void 0:at.status)||"DRAFT")),(Ns.fiscal_year_id||Ns.fiscalYearId||(dt=hs.voucher)!=null&&dt.fiscal_year_id)&&k(String(Ns.fiscal_year_id||Ns.fiscalYearId||((St=hs.voucher)==null?void 0:St.fiscal_year_id))),J(Ns.narration||((Ut=hs.voucher)==null?void 0:Ut.narration)||"");const ss=Array.isArray(hs.lines)?hs.lines:Array.isArray(Ns.lines)?Ns.lines:Ns.items||[],vs=String(Ns.narration||((It=hs.voucher)==null?void 0:It.narration)||""),fs=er=>{const ea=vs.match(new RegExp(`${er}\\s*:\\s*([^|]+)`,"i"));return ea?String(ea[1]).trim():""},gr=ss.filter(er=>Number(er.credit||0)>0),Ka=ss.filter(er=>Number(er.debit||0)>0),Ur=ss.map(er=>({accountId:String(er.account_id||er.accountId||""),description:er.description||"",debit:Number(er.debit||0),credit:Number(er.credit||0)}))||[];if(Q(Ur.length?Ur:[Sm(),Sm()]),C){const er=Ur.find(Gr=>Number(Gr.debit||0)>0),ea=Ur.filter(Gr=>Number(Gr.credit||0)>0),sr=gr[0]||null,za=fs("Received from")||(sr==null?void 0:sr.account_name)||"",un=sr!=null&&sr.account_code?String(sr.account_code):"",gi=sr!=null&&sr.account_id?String(sr.account_id):"",Ys=un?j.find(Gr=>String(Gr.code)===un):null;String((Ys==null?void 0:Ys.type)||"").toUpperCase()==="CUSTOMER"&&(Ys!=null&&Ys.id)?await je(Ys.id):B([]),ne(Gr=>({...Gr,depositAccountId:(er==null?void 0:er.accountId)||"",receivedFrom:za||Gr.receivedFrom,receivedFromCode:un||Gr.receivedFromCode,payerAccountId:gi||Gr.payerAccountId,paymentMethod:fs("Method")||Gr.paymentMethod,reference:fs("Ref")||Gr.reference,items:ea.length>0?ea.map(An=>({description:An.description||"",accountId:String(An.accountId||""),amount:Number(An.credit||0),referenceNo:String((gr.find(Mn=>String(Mn.account_id||"")===String(An.accountId||""))||{}).reference_no||"")||""})):Gr.items}))}else if(E){const er=Ur.find(Ys=>Number(Ys.credit||0)>0),ea=Ur.filter(Ys=>Number(Ys.debit||0)>0),sr=Ka[0]||null,za=fs("Paid to")||(sr==null?void 0:sr.account_name)||"",un=sr!=null&&sr.account_code?String(sr.account_code):"",gi=sr!=null&&sr.account_id?String(sr.account_id):"";oe(Ys=>({...Ys,paymentAccountId:(er==null?void 0:er.accountId)||"",payTo:za||Ys.payTo,payToCode:un||Ys.payToCode,payToAccountId:gi||Ys.payToAccountId,paymentMethod:fs("Method")||Ys.paymentMethod,reference:fs("Ref")||Ys.reference,items:ea.length>0?ea.map(Gr=>({description:Gr.description||"",accountId:String(Gr.accountId||""),amount:Number(Gr.debit||0)})):Ys.items}))}else if(w){const er=Ur.find(sr=>Number(sr.debit||0)>0),ea=Ur.find(sr=>Number(sr.credit||0)>0);xe(sr=>({...sr,toAccountId:(er==null?void 0:er.accountId)||"",fromAccountId:(ea==null?void 0:ea.accountId)||"",items:Ur.length>0?Ur.filter(za=>Number(za.debit||0)>0||Number(za.credit||0)>0).map(za=>({description:za.description||"",amount:Number(za.debit||za.credit||0)})):sr.items}))}}catch(Xt){nt.error(((ts=(Ht=Xt==null?void 0:Xt.response)==null?void 0:Ht.data)==null?void 0:ts.message)||"Failed to load voucher")}finally{d(!1)}}x.useEffect(()=>{De()},[a]);async function lt(ke){var at,dt,St;try{const Ut=await ee.get("/finance/voucher-types",{params:{code:ke}}),It=Array.isArray((at=Ut.data)==null?void 0:at.items)?Ut.data.items:[];if(It.length>0)return Number(It[0].id||0);const Ht=String(ke||"").toUpperCase(),ts=Ht==="PV"?"Payment Voucher":Ht==="RV"?"Receipt Voucher":Ht==="CV"?"Contra Voucher":Ht==="CN"?"Credit Note":Ht==="DN"?"Debit Note":"Voucher",Xt=Ht==="PV"?"PAYMENT":Ht==="RV"?"RECEIPT":"GENERAL";await ee.post("/finance/voucher-types",{code:Ht,name:ts,category:Xt,prefix:Ht,next_number:1,requires_approval:0,is_active:1});const hs=await ee.get("/finance/voucher-types",{params:{code:Ht}}),Ns=Array.isArray((dt=hs.data)==null?void 0:dt.items)?hs.data.items:[];return Number(((St=Ns==null?void 0:Ns[0])==null?void 0:St.id)||0)}catch{return 0}}const rt=x.useMemo(()=>c.find(ke=>ke.code===t),[c,t]),et=x.useMemo(()=>{var ke,at,dt;if(C){const St=X.items.reduce((Ht,ts)=>Ht+Number(ts.amount||0),0),Ut=Number(((ke=b.find(Ht=>String(Ht.id)===String(X.taxCodeId)))==null?void 0:ke.rate_percent)||0),It=Math.round(St*Ut)/100;return{debit:St,credit:St,subtotal:St,tax:It,grand:St+It}}if(E){const St=te.items.reduce((Ht,ts)=>Ht+Number(ts.amount||0),0),Ut=Number(((at=b.find(Ht=>String(Ht.id)===String(te.taxCodeId)))==null?void 0:at.rate_percent)||0),It=Math.round(St*Ut)/100;return{debit:St,credit:St,subtotal:St,tax:It,grand:St+It}}if(w){const St=Fe.items.reduce((Ht,ts)=>Ht+Number(ts.amount||0),0),Ut=Number(((dt=b.find(Ht=>String(Ht.id)===String(Fe.taxCodeId)))==null?void 0:dt.rate_percent)||0),It=Math.round(St*Ut)/100;return{debit:St,credit:St,subtotal:St,tax:It,grand:St+It}}return D.reduce((St,Ut)=>(St.debit+=Number(Ut.debit||0),St.credit+=Number(Ut.credit||0),St),{debit:0,credit:0})},[D,X,te,Fe,C,E,w,b]),Qt=Math.round(et.debit*100)===Math.round(et.credit*100),[Qe,he]=x.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:""});x.useEffect(()=>{let ke=!0;async function at(){var dt,St,Ut;try{const Ht=(St=(dt=(await ee.get("/admin/me")).data)==null?void 0:dt.scope)==null?void 0:St.companyId;if(!Ht)return;const Xt=((Ut=(await ee.get(`/admin/companies/${Ht}`)).data)==null?void 0:Ut.item)||{},hs=Xt.has_logo===1||Xt.has_logo===!0?`/api/admin/companies/${Ht}/logo`:"";if(!ke)return;he({name:Xt.name||"",address:Xt.address||"",city:Xt.city||"",state:Xt.state||"",country:Xt.country||"",phone:Xt.telephone||"",email:Xt.email||"",website:Xt.website||"",taxId:Xt.tax_id||"",registrationNo:Xt.registration_no||"",logoUrl:hs})}catch{}}return at(),()=>{ke=!1}},[]);function pe(ke){return String(ke??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function ye(ke){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Voucher</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 24px; color: #0f172a; background: #fff; }
      .vh { font-size: 12px; }
      .vh table { border-collapse: collapse; width: 100%; }
      .vh th, .vh td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      .vh th { background: #f8fafc; text-align: left; }
      .vh .right { text-align: right; }
      .vh .center { text-align: center; }
      .vh-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 8px; }
      .vh-logo { min-width: 120px; max-width: 200px; }
      .vh-company { text-align: right; font-size: 11px; line-height: 1.35; }
      .vh-company .name { font-weight: 800; font-size: 14px; }
      .vh-titlebar { display: flex; align-items: center; gap: 10px; color: #0f172a; margin: 4px 0 10px; }
      .vh-titlebar .line { flex: 1; height: 1px; background: #0f172a; }
      .vh-titlebar .title { font-weight: 700; }
      .vh-details { width: 100%; margin-bottom: 10px; border: 1px solid #cbd5e1; }
      .vh-details td { border-color: #cbd5e1; }
      .vh-details .label { width: 32%; color: #475569; }
      .vh-details .label-wide { width: 40%; color: #475569; }
      .vh-items thead th { font-weight: 600; }
      .vh-footer a { color: inherit; text-decoration: underline; }
      @media print { button { display: none; } }
    </style>
  </head>
  <body>${ke||""}</body>
</html>`}function Ne(ke){const at=ke.company||{},dt=ke.receipt||{},St=Array.isArray(ke.items)?ke.items:[],Ut=ke.totals||{};return`
    <div class="vh">
      <div class="vh-header">
        <div class="vh-logo">${at.logoHtml||""}</div>
        <div class="vh-company">
          <div class="name">${pe(at.name||"")}</div>
          <div>${pe(at.addressLine1||"")}</div>
          <div>${pe(at.addressLine2||"")}</div>
          <div>Telephone: ${pe(at.phone||"")}</div>
          <div>Email: ${pe(at.email||"")}</div>
          <div>${pe(at.website||"")}</div>
          <div>TIN: ${pe(at.taxId||"")} &nbsp; Reg: ${pe(at.registrationNo||"")}</div>
        </div>
      </div>
      <div class="vh-titlebar">
        <div class="line"></div>
        <div class="title">* Receipt Voucher *</div>
        <div class="line"></div>
      </div>
      <table class="vh-details">
        <tr>
          <td style="width:50%;vertical-align:top;border-right:1px solid #cbd5e1;">
            <table style="width:100%;">
              <tr><td class="label-wide">Receipt No</td><td>:</td><td>${pe(dt.receiptNo||"")}</td></tr>
              <tr><td class="label-wide">Date/Time</td><td>:</td><td>${pe(dt.dateTime||"")}</td></tr>
              <tr><td class="label-wide">Method</td><td>:</td><td>${pe(dt.paymentMethod||"")}</td></tr>
            </table>
          </td>
          <td style="width:50%;vertical-align:top;">
            <div style="padding:8px;">
              <div class="label">Narration</div>
              <div>${pe(dt.headerText||"")}</div>
            </div>
          </td>
        </tr>
      </table>
      <table class="vh-items">
        <thead>
          <tr>
            <th>Description</th>
            <th class="right" style="width:22%;">Amount</th>
          </tr>
        </thead>
        <tbody>
          ${St.map(It=>`
            <tr>
              <td>${pe(It.name||"")}</td>
              <td class="right">${pe(It.lineTotal||It.price||"0.00")}</td>
            </tr>
          `).join("")}
          <tr>
            <td class="right"><strong>Subtotal</strong></td>
            <td class="right"><strong>${pe(Number(Ut.subtotal||0).toFixed(2))}</strong></td>
          </tr>
          <tr>
            <td class="right">Tax</td>
            <td class="right">${pe(Number(Ut.tax||0).toFixed(2))}</td>
          </tr>
          <tr>
            <td class="right"><strong>Total</strong></td>
            <td class="right"><strong>${pe(Number(Ut.total||Ut.grand||0).toFixed(2))}</strong></td>
          </tr>
        </tbody>
      </table>
      <div class="vh-footer" style="margin-top:10px;text-align:center;">
        <div>${pe(dt.footerText||"")}</div>
      </div>
    </div>
    `}function He(ke){const at=ke.company||{},dt=ke.payment||{},St=Array.isArray(ke.items)?ke.items:[],Ut=ke.totals||{};return`
    <div class="vh">
      <div class="vh-header">
        <div class="vh-logo">${at.logoHtml||""}</div>
        <div class="vh-company">
          <div class="name">${pe(at.name||"")}</div>
          <div>${pe(at.addressLine1||"")}</div>
          <div>${pe(at.addressLine2||"")}</div>
          <div>Telephone: ${pe(at.phone||"")}</div>
          <div>Email: ${pe(at.email||"")}</div>
          <div>${pe(at.website||"")}</div>
          <div>TIN: ${pe(at.taxId||"")} &nbsp; Reg: ${pe(at.registrationNo||"")}</div>
        </div>
      </div>
      <div class="vh-titlebar">
        <div class="line"></div>
        <div class="title">* Payment Voucher *</div>
        <div class="line"></div>
      </div>
      <table class="vh-details">
        <tr>
          <td style="width:50%;vertical-align:top;border-right:1px solid #cbd5e1;">
            <table style="width:100%;">
              <tr><td class="label-wide">Payment No</td><td>:</td><td>${pe(dt.paymentNo||"")}</td></tr>
              <tr><td class="label-wide">Date/Time</td><td>:</td><td>${pe(dt.dateTime||"")}</td></tr>
              <tr><td class="label-wide">Method</td><td>:</td><td>${pe(dt.paymentMethod||"")}</td></tr>
            </table>
          </td>
          <td style="width:50%;vertical-align:top;">
            <div style="padding:8px;">
              <div class="label">Narration</div>
              <div>${pe(dt.headerText||"")}</div>
            </div>
          </td>
        </tr>
      </table>
      <table class="vh-items">
        <thead>
          <tr>
            <th>Description</th>
            <th class="right" style="width:22%;">Amount</th>
          </tr>
        </thead>
        <tbody>
          ${St.map(It=>`
            <tr>
              <td>${pe(It.name||"")}</td>
              <td class="right">${pe(It.lineTotal||It.price||"0.00")}</td>
            </tr>
          `).join("")}
          <tr>
            <td class="right"><strong>Subtotal</strong></td>
            <td class="right"><strong>${pe(Number(Ut.subtotal||0).toFixed(2))}</strong></td>
          </tr>
          <tr>
            <td class="right">Tax</td>
            <td class="right">${pe(Number(Ut.tax||0).toFixed(2))}</td>
          </tr>
          <tr>
            <td class="right"><strong>Total</strong></td>
            <td class="right"><strong>${pe(Number(Ut.total||Ut.grand||0).toFixed(2))}</strong></td>
          </tr>
        </tbody>
      </table>
      <div class="vh-footer" style="margin-top:10px;text-align:center;">
        <div>${pe(dt.footerText||"")}</div>
      </div>
    </div>
    `}const Ge=()=>{const ke=String(Qe.logoUrl||"").trim(),at=ke?`<img src="${ke}" alt="${pe(Qe.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",dt=[];Qe.address&&dt.push(Qe.address);const St=[Qe.city,Qe.state].filter(Boolean).join(", ");St&&dt.push(St),Qe.country&&dt.push(Qe.country);const Ut=String(dt[0]||""),It=String(dt.slice(1).join("  ")||""),Ht=(Array.isArray(X.items)?X.items:[]).map(Ns=>{const ns=Number(Ns.amount||0);return{name:String(Ns.description||""),qty:"1.00",price:ns.toFixed(2),discount:"0.00",lineTotal:ns.toFixed(2)}}),ts=I?new Date(I):new Date,Xt=String(X.paymentMethod||"").toUpperCase(),hs=Xt==="CASH"?"Cash":Xt==="BANK"?"Bank":Xt==="CHEQUE"?"Cheque":Xt==="TRANSFER"?"Bank Transfer":Xt==="CARD"?"Card":"Other";return{company:{name:Qe.name||"",addressLine1:Ut,addressLine2:It,phone:Qe.phone||"",website:Qe.website||"",taxId:Qe.taxId||"",registrationNo:Qe.registrationNo||"",logoUrl:ke,logoHtml:at},receipt:{receiptNo:String(M||""),dateTime:ts.toLocaleString(),paymentMethod:hs,headerText:"",footerText:""},items:Ht,totals:{subtotal:Number(et.subtotal||0).toFixed(2),tax:Number(et.tax||0).toFixed(2),total:Number(et.grand||0).toFixed(2)}}},gt=()=>{const ke=String(Qe.logoUrl||"").trim(),at=ke?`<img src="${ke}" alt="${pe(Qe.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"",dt=[];Qe.address&&dt.push(Qe.address);const St=[Qe.city,Qe.state].filter(Boolean).join(", ");St&&dt.push(St),Qe.country&&dt.push(Qe.country);const Ut=String(dt[0]||""),It=String(dt.slice(1).join("  ")||""),Ht=(Array.isArray(te.items)?te.items:[]).map(Ns=>{const ns=Number(Ns.amount||0);return{name:String(Ns.description||""),qty:"1.00",price:ns.toFixed(2),discount:"0.00",lineTotal:ns.toFixed(2)}}),ts=I?new Date(I):new Date,Xt=String(te.paymentMethod||"").toUpperCase(),hs=Xt==="CASH"?"Cash":Xt==="BANK"?"Bank":Xt==="CHEQUE"?"Cheque":Xt==="TRANSFER"?"Bank Transfer":Xt==="CARD"?"Card":"Other";return{company:{name:Qe.name||"",addressLine1:Ut,addressLine2:It,phone:Qe.phone||"",website:Qe.website||"",taxId:Qe.taxId||"",registrationNo:Qe.registrationNo||"",logoUrl:ke,logoHtml:at},payment:{paymentNo:String(M||""),dateTime:ts.toLocaleString(),paymentMethod:hs,headerText:"",footerText:""},items:Ht,totals:{subtotal:Number(et.subtotal||0).toFixed(2),tax:Number(et.tax||0).toFixed(2),total:Number(et.grand||0).toFixed(2)}}};async function kt(ke){var dt;const at=Array.from(((dt=ke==null?void 0:ke.querySelectorAll)==null?void 0:dt.call(ke,"img"))||[]);at.length!==0&&await Promise.race([Promise.all(at.map(St=>new Promise(Ut=>{if(St.complete)return Ut();const It=()=>Ut();St.addEventListener("load",It,{once:!0}),St.addEventListener("error",It,{once:!0})}))),new Promise(St=>setTimeout(St,1500))])}const yt=async()=>{var ke;try{const at=C?Ne(Ge()):E?He(gt()):"",dt=ye(at),St=document.createElement("iframe");St.style.position="fixed",St.style.right="0",St.style.bottom="0",St.style.width="0",St.style.height="0",St.style.border="0",document.body.appendChild(St);const Ut=((ke=St.contentWindow)==null?void 0:ke.document)||St.contentDocument||null;if(!Ut){document.body.removeChild(St),window.print();return}Ut.open(),Ut.write(dt),Ut.close();const It=St.contentWindow||window;setTimeout(()=>{It.focus();try{It.print()}catch{}setTimeout(()=>{document.body.removeChild(St)},100)},200)}catch{}},Et=async()=>{try{const ke=C?Ne(Ge()):E?He(gt()):"";if(!ke)return;const at=document.createElement("div");at.style.position="fixed",at.style.left="-10000px",at.style.top="0",at.style.width="794px",at.style.background="white",at.style.padding="32px",at.innerHTML=ke,document.body.appendChild(at);try{await kt(at);const dt=await Ai(at,{scale:2,useCORS:!0}),St=dt.toDataURL("image/png"),Ut=new ds("p","mm","a4"),It=Ut.internal.pageSize.getWidth(),Ht=Ut.internal.pageSize.getHeight(),ts=It,Xt=dt.height*ts/dt.width;let hs=0;for(;hs<Xt;)Ut.addImage(St,"PNG",0,-hs,ts,Xt),hs+=Ht,hs<Xt&&Ut.addPage();const Ns=(C?"ReceiptVoucher_":E?"PaymentVoucher_":"Voucher_")+(M||new Date().toISOString().slice(0,10))+".pdf";Ut.save(Ns)}finally{document.body.removeChild(at)}}catch{}};function Ft(ke,at){l||Q(dt=>dt.map((St,Ut)=>Ut===ke?{...St,...at}:St))}function Yt(){l||Q(ke=>[...ke,Sm()])}function rs(ke){l||Q(at=>at.length<=2?at:at.filter((dt,St)=>St!==ke))}async function As(ke){var Ht,ts,Xt,hs,Ns,ns;if(ke.preventDefault(),l)return;const at=Number((rt==null?void 0:rt.id)||0)||await lt(t),dt=Number(at||0);let St=[];if(C){if(!X.depositAccountId){nt.error("Select deposit account");return}const ss=X.items.map(fs=>({accountId:Number(fs.accountId||0),description:fs.description||null,amount:Number(fs.amount||0),referenceNo:fs.referenceNo&&String(fs.referenceNo).trim()||null})).filter(fs=>fs.accountId&&fs.amount>0);if(ss.length===0){nt.error("Enter at least one payment detail item");return}const vs=ss.reduce((fs,gr)=>fs+gr.amount,0);St=[{accountId:Number(X.depositAccountId),description:X.receivedFrom||"Receipt",debit:Number(vs),credit:0},...ss.map(fs=>({accountId:fs.accountId,description:fs.description,debit:0,credit:fs.amount,referenceNo:fs.referenceNo||null}))]}else if(E){if(!te.paymentAccountId){nt.error("Select payment account");return}const ss=te.items.map(fs=>({accountId:Number(fs.accountId||0),description:fs.description||null,amount:Number(fs.amount||0),referenceNo:fs.referenceNo&&String(fs.referenceNo).trim()||null})).filter(fs=>fs.accountId&&fs.amount>0);if(ss.length===0){nt.error("Enter at least one payment detail item");return}const vs=ss.reduce((fs,gr)=>fs+gr.amount,0);St=[...ss.map(fs=>({accountId:fs.accountId,description:fs.description,debit:fs.amount,credit:0,referenceNo:fs.referenceNo||null})),{accountId:Number(te.paymentAccountId),description:te.payTo||"Payment",debit:0,credit:Number(vs)}]}else if(w){if(!Fe.fromAccountId||!Fe.toAccountId){nt.error("Select both From and To accounts");return}if(String(Fe.fromAccountId)===String(Fe.toAccountId)){nt.error("From and To accounts must be different");return}const ss=Fe.items.map(fs=>({description:fs.description||null,amount:Number(fs.amount||0)})).filter(fs=>fs.amount>0);if(ss.length===0){nt.error("Enter at least one transfer detail item");return}const vs=ss.reduce((fs,gr)=>fs+gr.amount,0);St=[{accountId:Number(Fe.toAccountId),description:"Account Transfer",debit:Number(vs),credit:0},{accountId:Number(Fe.fromAccountId),description:"Account Transfer",debit:0,credit:Number(vs)}]}else St=D.map(ss=>({accountId:Number(ss.accountId||0),description:ss.description||null,debit:Number(ss.debit||0),credit:Number(ss.credit||0)})).filter(ss=>ss.accountId&&(ss.debit||ss.credit));if(St.length<2){nt.error("Enter at least two posting lines");return}const Ut=St.reduce((ss,vs)=>ss+Number(vs.debit||0),0),It=St.reduce((ss,vs)=>ss+Number(vs.credit||0),0);if(Math.round(Ut*100)!==Math.round(It*100)){nt.error("Total debit must equal total credit");return}try{d(!0);const ss={voucherTypeId:dt,voucherTypeCode:t,voucherDate:I,narration:C?[X.receivedFrom?`Received from: ${X.receivedFrom}`:null,X.paymentMethod?`Method: ${X.paymentMethod}`:null,X.reference?`Ref: ${X.reference}`:null,Y||null].filter(Boolean).join(" | "):E?[te.payTo?`Paid to: ${te.payTo}`:null,te.paymentMethod?`Method: ${te.paymentMethod}`:null,te.reference?`Ref: ${te.reference}`:null,Y||null].filter(Boolean).join(" | "):w?[Fe.fromAccountId?`From: ${(Ht=g.find(vs=>String(vs.id)===String(Fe.fromAccountId)))==null?void 0:Ht.code}`:null,Fe.toAccountId?`To: ${(ts=g.find(vs=>String(vs.id)===String(Fe.toAccountId)))==null?void 0:ts.code}`:null,Fe.transferMethod?`Method: ${Fe.transferMethod}`:null,Fe.reference?`Ref: ${Fe.reference}`:null,Y||null].filter(Boolean).join(" | "):Y,lines:St,...E?{apply_to_purchase_bills:(te.items||[]).map(vs=>({ref:vs.referenceNo&&String(vs.referenceNo)||"",amount:Number(vs.amount||0)})).filter(vs=>vs.ref&&vs.amount>0).map(vs=>{const fs=P.find(gr=>String(gr.bill_no)===String(vs.ref));return fs?{bill_id:Number(fs.id),amount:vs.amount}:null}).filter(Boolean)}:{}};if(o){const vs=await ee.put(`/finance/vouchers/${a}`,ss);nt.success(((Xt=vs.data)==null?void 0:Xt.message)||"Updated voucher")}else{const vs=await ee.post("/finance/vouchers",ss);nt.success(`Created ${((hs=vs.data)==null?void 0:hs.voucherNo)||"voucher"}`)}r(`/finance/${t==="JV"?"journal-voucher":t==="PV"?"payment-voucher":t==="RV"?"receipt-voucher":t==="CV"?"contra-voucher":t==="SV"?"sales-voucher":t==="PUV"?"purchase-voucher":t==="DN"?"debit-note":t==="CN"?"credit-note":"journal-voucher"}`)}catch(ss){nt.error(((ns=(Ns=ss==null?void 0:ss.response)==null?void 0:Ns.data)==null?void 0:ns.message)||"Failed to create voucher")}finally{d(!1)}}if(!C&&!E&&!w)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Create a new voucher (double-entry enforced)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"..",className:"btn-success",children:"Back"}),ht==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var ke,at,dt,St;if(o&&(_e(!0),Ke(""),!Te))try{Ye(!0);const Ut=await ee.get("/workflows"),It=Array.isArray((ke=Ut.data)==null?void 0:ke.items)?Ut.data.items:[];ue(It);const Ht=(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0);let ts=null;const Xt=It.filter(ns=>String(ns.document_route||"")==="/finance/receipt-voucher"),hs=It.filter(ns=>["RECEIPT_VOUCHER","Receipt Voucher","RV"].includes(String(ns.document_type||""))),Ns=[...Xt,...hs];for(const ns of Ns){if(ts)break;if(Number(ns.is_active)!==1)continue;if(Ht===null){ts=ns;break}const ss=ns.min_amount===null||Number(Ht)>=Number(ns.min_amount),vs=ns.max_amount===null||Number(Ht)<=Number(ns.max_amount);if(ss&&vs){ts=ns;break}}if(!ts)for(const ns of hs){if(ts)break;if(Number(ns.is_active)!==1)continue;if(Ht===null){ts=ns;break}const ss=ns.min_amount===null||Number(Ht)>=Number(ns.min_amount),vs=ns.max_amount===null||Number(Ht)<=Number(ns.max_amount);if(ss&&vs){ts=ns;break}}if(xt(ts),Ce(null),Ve(null),ts){const ns=await ee.get(`/workflows/${ts.id}`),ss=((at=ns==null?void 0:ns.data)==null?void 0:at.item)||{},vs=Number(ss.current_step_order||1),fs=Array.isArray(ss==null?void 0:ss.next_step_approvers)?ss.next_step_approvers:[],gr=fs.length>0?Number(fs[0].id):null;Ce({stepOrder:vs||1,stepName:String(ss.step_name||"Step 1"),approvalLimit:fs.length>0?Number(fs[0].approval_limit||0):null,approvers:fs}),Ve(gr)}}catch(Ut){Ke(((St=(dt=Ut==null?void 0:Ut.response)==null?void 0:dt.data)==null?void 0:St.message)||"Failed to load workflows")}finally{Ye(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:As,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:yu,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:M||(R?"CN-000001":O?"DN-000001":""),disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:I,onChange:ke=>G(ke.target.value),required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year *"}),e.jsxs("select",{className:`input ${Nr}`,value:T,onChange:ke=>k(ke.target.value),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),A.map(ke=>e.jsx("option",{value:ke.id,children:ke.code},ke.id))]})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"label",children:"Narration"}),e.jsx("input",{className:"input",value:Y,onChange:ke=>J(ke.target.value),placeholder:"Optional narration",disabled:l})]})]}),le&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-xl shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 py-3 border-b",children:[e.jsx("div",{className:"font-semibold text-brand",children:"Select Paid To"}),e.jsx("button",{type:"button",className:"text-slate-600 hover:text-slate-800 text-xl font-bold",onClick:()=>Z(!1),children:""})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input w-full",placeholder:"Type name or code",value:ve,onChange:ke=>Ue(ke.target.value),autoFocus:!0}),e.jsx("div",{className:"mt-3 max-h-64 overflow-y-auto border rounded",children:Jl.length===0?e.jsx("div",{className:"p-3 text-center text-slate-500",children:"No matches"}):Jl.sort((ke,at)=>String(ke.name).localeCompare(String(at.name))).map(ke=>e.jsxs("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-slate-100 border-b last:border-b-0",onClick:()=>{const at=String(ke.id),dt=String(ke.name||""),St=te.items.length===0?[{description:"",accountId:at,amount:0}]:te.items.map((Ut,It)=>It===0?{...Ut,accountId:at}:Ut);Ga({payTo:dt,payToAccountId:at,items:St}),Z(!1),Ue("")},children:[e.jsx("div",{className:"font-medium",children:ke.name}),e.jsx("div",{className:"text-xs text-slate-500",children:ke.code})]},ke.id))}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{Z(!1),Ue("")},children:"Close"})})]})]})}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[R||O?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input",value:mt||"",readOnly:!0})]})}):null,e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Posting Lines"}),e.jsx("button",{type:"button",className:"btn-success",onClick:Yt,disabled:l,children:"+ Add Line"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),R||O?e.jsx("th",{className:"text-right w-32",children:"Currency"}):null,e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:D.map((ke,at)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("select",{className:"input",value:ke.accountId,onChange:dt=>Ft(at,{accountId:dt.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),g.map(dt=>e.jsxs("option",{value:dt.id,children:[dt.code," - ",dt.name]},dt.id))]})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:ke.description,onChange:dt=>Ft(at,{description:dt.target.value}),placeholder:"Line memo",disabled:l})}),R||O?e.jsx("td",{className:"text-right",children:(()=>{const dt=g.find(St=>String(St.id)===String(ke.accountId||""));return(dt==null?void 0:dt.currency_code)||""})()}):null,e.jsx("td",{children:e.jsx("input",{className:"input text-right",type:"number",min:"0",step:"1",value:ke.debit||"",onChange:dt=>Ft(at,{debit:String(dt.target.value||"").replace(/^0+(?=\d)/,""),credit:0}),onFocus:()=>{String(ke.debit??"")==="0"&&Ft(at,{debit:""})},disabled:l})}),e.jsx("td",{children:e.jsx("input",{className:"input text-right",type:"number",min:"0",step:"1",value:ke.credit||"",onChange:dt=>Ft(at,{credit:String(dt.target.value||"").replace(/^0+(?=\d)/,""),debit:0}),onFocus:()=>{String(ke.credit??"")==="0"&&Ft(at,{credit:""})},disabled:l})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"text-red-600 hover:text-red-700 text-sm font-medium",onClick:()=>rs(at),disabled:l,children:"Remove"})})]},at))})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs("div",{className:"w-72 space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Debit"}),e.jsx("span",{children:`GH ${et.debit.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Total Credit"}),e.jsx("span",{children:`GH ${et.credit.toFixed(2)}`})]}),e.jsxs("div",{className:`flex justify-between text-sm font-semibold ${Qt?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:[e.jsx("span",{children:"Status"}),e.jsx("span",{children:Qt?"Balanced":"Not Balanced"})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||!Qt||l,children:u?"Saving...":"Save Voucher"})]})]})})}),Be?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Receipt Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:M||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:ct?ct.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:ot||""}),e.jsx("div",{children:Me?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):be&&Array.isArray(be.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ge||"",onChange:ke=>Ve(ke.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),be.approvers.map(ke=>e.jsx("option",{value:ke.id,children:ke.username},ke.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:be?`Step ${be.stepOrder}  ${be.stepName}${be.approvalLimit!=null?`  Limit: ${Number(be.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:ct?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var ke,at,dt;if(o){Ze(!0),Ke("");try{const St=await ee.post(`/finance/vouchers/${a}/submit`,{amount:(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0),workflow_id:ct?ct.id:null,target_user_id:ge||null}),Ut=((ke=St==null?void 0:St.data)==null?void 0:ke.status)||"PENDING_APPROVAL";ze(Ut),_e(!1)}catch(St){Ke(((dt=(at=St==null?void 0:St.response)==null?void 0:at.data)==null?void 0:dt.message)||"Failed to forward for approval")}finally{Ze(!1)}}},disabled:tt||!o,children:tt?"Forwarding...":"Forward"})]})]})}):null]});function es(ke){l||ne(at=>({...at,...ke}))}function Jt(ke,at){l||es({items:X.items.map((dt,St)=>St===ke?{...dt,...at}:dt)})}function Ps(ke){const at=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],dt=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],St=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],Ut=Math.floor(ke||0),It=Math.round(((ke||0)-Ut)*100);function Ht(Xt){return Xt===0?"":Xt<10?at[Xt]:Xt<20?St[Xt-10]:Xt<100?dt[Math.floor(Xt/10)]+(Xt%10!==0?" "+at[Xt%10]:""):Xt<1e3?at[Math.floor(Xt/100)]+" Hundred"+(Xt%100!==0?" "+Ht(Xt%100):""):Xt<1e6?Ht(Math.floor(Xt/1e3))+" Thousand"+(Xt%1e3!==0?" "+Ht(Xt%1e3):""):Ht(Math.floor(Xt/1e6))+" Million"+(Xt%1e6!==0?" "+Ht(Xt%1e6):"")}let ts=Ht(Ut)+" Cedi"+(Ut!==1?"s":"");return It>0&&(ts+=" and "+Ht(It)+" Pesewa"+(It!==1?"s":"")),ts}function Os(ke){const at=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],dt=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],St=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],Ut=Math.floor(ke||0),It=Math.round(((ke||0)-Ut)*100);function Ht(hs){return hs===0?"Zero":hs<10?at[hs]:hs<20?St[hs-10]:hs<100?dt[Math.floor(hs/10)]+(hs%10!==0?" "+at[hs%10]:""):hs<1e3?at[Math.floor(hs/100)]+" Hundred"+(hs%100!==0?" "+Ht(hs%100):""):hs<1e6?Ht(Math.floor(hs/1e3))+" Thousand"+(hs%1e3!==0?" "+Ht(hs%1e3):""):Ht(Math.floor(hs/1e6))+" Million"+(hs%1e6!==0?" "+Ht(hs%1e6):"")}const ts=Ht(Ut),Xt=String(It).padStart(2,"0");return It>0?`${ts} and ${Xt}/100`:`${ts}`}const lr=x.useMemo(()=>["Cheque","Bank Transfer","Credit Card"].includes(X.paymentMethod||""),[X.paymentMethod]),zs=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(X.depositAccountId||""));return(ke==null?void 0:ke.currency_code)||""},[g,X.depositAccountId]),ba=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(X.payerAccountId||""));return(ke==null?void 0:ke.currency_code)||""},[g,X.payerAccountId]),dn=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(X.payerAccountId||""));return(ke==null?void 0:ke.currency_id)||null},[g,X.payerAccountId]),Ea=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(X.depositAccountId||""));return(ke==null?void 0:ke.currency_id)||null},[g,X.depositAccountId]),Lr=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(Fe.toAccountId||""));return(ke==null?void 0:ke.currency_code)||""},[g,Fe.toAccountId]),Wr=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(Fe.fromAccountId||""));return(ke==null?void 0:ke.currency_code)||""},[g,Fe.fromAccountId]),mr=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(Fe.fromAccountId||""));return(ke==null?void 0:ke.currency_id)||null},[g,Fe.fromAccountId]),Dr=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(Fe.toAccountId||""));return(ke==null?void 0:ke.currency_id)||null},[g,Fe.toAccountId]),vl=x.useMemo(()=>{const ke=new Set(["BANK ACCOUNTS","CASH AND CASH EQUIVALENTS"]);return(g||[]).filter(at=>ke.has(String(at.group_name||"").trim().toUpperCase()))},[g]),Po=x.useMemo(()=>{const ke=g.find(Ht=>String(Ht.id)===String(Fe.fromAccountId||"")),at=g.find(Ht=>String(Ht.id)===String(Fe.toAccountId||"")),dt=String((ke==null?void 0:ke.group_code)||"").toUpperCase(),St=String((ke==null?void 0:ke.group_name)||"").toUpperCase(),Ut=String((at==null?void 0:at.group_code)||"").toUpperCase(),It=String((at==null?void 0:at.group_name)||"").toUpperCase();return dt==="AST_BANK"||St==="BANK ACCOUNTS"||Ut==="AST_BANK"||It==="BANK ACCOUNTS"},[g,Fe.fromAccountId,Fe.toAccountId]),zl=x.useMemo(()=>{const ke=Ea;let at=ut.find(dt=>String(dt.id)===String(ke));return!at&&zs&&(at=ut.find(dt=>String(dt.code)===String(zs))),at?String(at.name||""):""},[ut,Ea,zs]),fi=x.useMemo(()=>["Cheque","Bank Transfer","Credit Card"].includes(te.paymentMethod||""),[te.paymentMethod]),pi=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(te.paymentAccountId||""));return(ke==null?void 0:ke.currency_code)||""},[g,te.paymentAccountId]),Wa=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(te.payToAccountId||""));return(ke==null?void 0:ke.currency_code)||""},[g,te.payToAccountId]),Yl=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(te.payToAccountId||""));return(ke==null?void 0:ke.currency_id)||null},[g,te.payToAccountId]),Fa=x.useMemo(()=>{const ke=g.find(at=>String(at.id)===String(te.paymentAccountId||""));return(ke==null?void 0:ke.currency_id)||null},[g,te.paymentAccountId]),Xl=x.useMemo(()=>{const ke=Fa,at=ut.find(dt=>String(dt.id)===String(ke));return String(at?at.name||at.code||"":pi||"")},[ut,Fa,pi]),Nr=l?"bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold":"",mc=x.useMemo(()=>{const ke=c.find(at=>String(at.code).toUpperCase()===String(t).toUpperCase());return(ke==null?void 0:ke.name)||"Payment Voucher"},[c,t]),bl=x.useMemo(()=>{const ke=c.find(at=>String(at.code).toUpperCase()===String(t).toUpperCase());return(ke==null?void 0:ke.name)||"Receive Voucher"},[c,t]),yu=x.useMemo(()=>{const ke=c.find(dt=>String(dt.code).toUpperCase()===String(t).toUpperCase());if(ke!=null&&ke.name)return ke.name;const at=String(t||"").toUpperCase();return at==="CN"?"Credit Note":at==="DN"?"Debit Note":"Voucher"},[c,t]);if(x.useEffect(()=>{if(!w)return;const ke=mr||null,at=Dr||null,dt=Wr||"",St=Lr||"";if(!ke||!at){Ie("");return}if(dt&&St&&dt===St){Ie("1");return}(async()=>{var Ut;try{const It=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Number(ke),toCurrencyId:Number(at),to:I||null}}),ts=(Array.isArray((Ut=It.data)==null?void 0:Ut.items)?It.data.items:[]).slice().sort((hs,Ns)=>new Date(Ns.rate_date).getTime()-new Date(hs.rate_date).getTime()),Xt=ts.length?Number(ts[0].rate||0):0;Ie(Xt?String(Xt):"")}catch{Ie("")}})()},[w,mr,Dr,Wr,Lr,I]),C)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Record incoming payments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"..",className:"btn-success",children:"Back"}),ht==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var ke,at,dt,St;if(o&&(_e(!0),Ke(""),!Te))try{Ye(!0);const Ut=await ee.get("/workflows"),It=Array.isArray((ke=Ut.data)==null?void 0:ke.items)?Ut.data.items:[];ue(It);const Ht=(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0);let ts=null;const Xt=It.filter(ns=>String(ns.document_route||"")==="/finance/contra-voucher"),hs=It.filter(ns=>["CONTRA_VOUCHER","Contra Voucher","CV"].includes(String(ns.document_type||""))),Ns=[...Xt,...hs];for(const ns of Ns){if(ts)break;if(Number(ns.is_active)!==1)continue;if(Ht===null){ts=ns;break}const ss=ns.min_amount===null||Number(Ht)>=Number(ns.min_amount),vs=ns.max_amount===null||Number(Ht)<=Number(ns.max_amount);if(ss&&vs){ts=ns;break}}if(!ts)for(const ns of hs){if(ts)break;if(Number(ns.is_active)!==1)continue;if(Ht===null){ts=ns;break}const ss=ns.min_amount===null||Number(Ht)>=Number(ns.min_amount),vs=ns.max_amount===null||Number(Ht)<=Number(ns.max_amount);if(ss&&vs){ts=ns;break}}if(xt(ts),Ce(null),Ve(null),ts){const ns=await ee.get(`/workflows/${ts.id}`),ss=((at=ns==null?void 0:ns.data)==null?void 0:at.item)||{},vs=Number(ss.current_step_order||1),fs=Array.isArray(ss==null?void 0:ss.next_step_approvers)?ss.next_step_approvers:[],gr=fs.length>0?Number(fs[0].id):null;Ce({stepOrder:vs||1,stepName:String(ss.step_name||"Step 1"),approvalLimit:fs.length>0?Number(fs[0].approval_limit||0):null,approvers:fs}),Ve(gr)}}catch(Ut){Ke(((St=(dt=Ut==null?void 0:Ut.response)==null?void 0:dt.data)==null?void 0:St.message)||"Failed to load workflows")}finally{Ye(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:As,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:bl,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:M||"RV-000001",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:I,onChange:ke=>G(ke.target.value),required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year *"}),e.jsxs("select",{className:`input ${Nr}`,value:T,onChange:ke=>k(ke.target.value),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),A.map(ke=>e.jsx("option",{value:ke.id,children:ke.code},ke.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Received From"}),e.jsxs("select",{className:`input ${Nr}`,value:X.receivedFromCode||"",onChange:ke=>{const at=ke.target.value,dt=j.find(Ns=>String(Ns.code)===String(at)),St=(dt==null?void 0:dt.name)||"",Ut=g.find(Ns=>String(Ns.code)===String(at)),It=String((dt==null?void 0:dt.type)||"").toUpperCase()==="CUSTOMER",Ht=String((dt==null?void 0:dt.type)||"").toUpperCase()==="SUPPLIER",ts=g.find(Ns=>{const ns=String(Ns.group_name||"").toUpperCase(),ss=It?"DEBTORS":Ht?"CREDITORS":"";if(ss&&ns!==ss)return!1;const vs=String(Ns.name||"").trim().toLowerCase(),fs=String(St||"").trim().toLowerCase();return vs===fs||vs.includes(fs)||fs.includes(vs)}),Xt=Ut||ts||null,hs=Xt!=null&&Xt.id?String(Xt.id):"";It&&(dt!=null&&dt.id)?je(dt.id):B([]),es({receivedFrom:St,receivedFromCode:at,payerAccountId:hs,items:X.items.length===0?[{description:"",accountId:hs,amount:"",referenceNo:""}]:X.items.map((Ns,ns)=>ns===0?{...Ns,accountId:hs}:Ns)})},disabled:l,children:[e.jsx("option",{value:"",children:"Select customer or supplier"}),j.map(ke=>e.jsx("option",{value:ke.code,children:ke.name},ke.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsxs("select",{className:`input ${Nr}`,value:X.paymentMethod,onChange:ke=>es({paymentMethod:ke.target.value}),disabled:l,children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Cheque"}),e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Credit Card"}),e.jsx("option",{children:"Mobile Money"})]})]}),lr?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Cheque No"}),e.jsx("input",{className:`input ${Nr}`,value:X.reference,onChange:ke=>es({reference:ke.target.value}),placeholder:"Reference Number or Cheque Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cheque Date"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:X.chequeDate||"",onChange:ke=>es({chequeDate:ke.target.value}),disabled:l})]})]})}):null]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"label",children:"Deposit Account *"}),e.jsx("span",{className:"text-xs text-slate-500",children:zs||""})]}),e.jsxs("select",{className:`input ${Nr}`,value:X.depositAccountId,onChange:ke=>es({depositAccountId:ke.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),g.filter(ke=>{const at=String(ke.group_code||"").toUpperCase(),dt=String(ke.group_name||"").toUpperCase();return lr?at==="AST_BANK"||dt==="BANK ACCOUNTS":at==="AST_CASH"||dt==="CASH AND CASH EQUIVALENTS"}).map(ke=>e.jsxs("option",{value:ke.id,children:[ke.code," - ",ke.name]},ke.id))]})]}),e.jsx("div",{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:zs||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:we||"",readOnly:!0})]})]})})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[R||O?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input",value:mt||"",readOnly:!0})]})}):null,e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Payment Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:"#"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"w-64",children:"Account"}),e.jsx("th",{className:"w-64",children:"Bill"}),e.jsx("th",{className:"text-right w-32",children:"Currency"}),e.jsx("th",{className:"text-right w-40",children:"Amount"}),e.jsx("th",{className:"w-24"})]})}),e.jsx("tbody",{children:X.items.length===0?e.jsx("tr",{children:e.jsx("td",{className:"text-center p-2",colSpan:7,children:"No items"})}):X.items.map((ke,at)=>e.jsxs("tr",{children:[e.jsx("td",{children:at+1}),e.jsx("td",{children:e.jsx("input",{className:`input ${Nr}`,value:ke.description,onChange:dt=>Jt(at,{description:dt.target.value}),placeholder:"Description",disabled:l})}),e.jsx("td",{children:e.jsxs("select",{className:`input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold ${Nr}`,value:ke.accountId,onChange:dt=>{const St=dt.target.value;if(Jt(at,{accountId:St}),at===0){const Ut=g.find(Xt=>String(Xt.id)===String(St)),It=Ut!=null&&Ut.code?String(Ut.code):"",Ht=j.find(Xt=>String(Xt.code)===String(It)),ts=(Ht==null?void 0:Ht.name)||"";es({receivedFrom:ts,receivedFromCode:It,payerAccountId:String(St||"")})}},required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),g.map(dt=>e.jsx("option",{value:dt.id,children:dt.name},dt.id))]})}),e.jsx("td",{children:S.length>0?at===0?e.jsx("select",{multiple:!0,className:`input ${Nr}`,value:q,onChange:dt=>{const St=Array.from(dt.target.selectedOptions).map(Ht=>Ht.value);V(St);const Ut=S.filter(Ht=>St.includes(String(Ht.invoice_no))),It=Ut.length>0?Ut.map(Ht=>({description:`Invoice ${Ht.invoice_no} payment`,accountId:X.payerAccountId||"",amount:Number(Ht.balance_amount||0),referenceNo:String(Ht.invoice_no)})):[{description:"",accountId:X.payerAccountId||"",amount:0,referenceNo:""}];es({items:It})},size:Math.min(6,Math.max(3,S.length)),disabled:l,children:S.map(dt=>e.jsxs("option",{value:dt.invoice_no,children:[dt.invoice_no,"  Outstanding"," ",Number(dt.balance_amount||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},dt.id))}):e.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Select invoices using first row"}):e.jsx("div",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"No outstanding invoices for selected customer"})}),e.jsx("td",{className:"text-right",children:ba||""}),e.jsx("td",{children:e.jsx("input",{className:`input text-right ${Nr}`,type:"number",min:"0",step:"1",value:ke.amount||"",onChange:dt=>Jt(at,{amount:Number(dt.target.value||0)}),onFocus:()=>{Number(ke.amount||0)===0&&Jt(at,{amount:""})},disabled:l})}),e.jsx("td",{children:e.jsx("div",{})})]},at))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold",children:Number(et.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Tax (",Number(((fc=b.find(ke=>String(ke.id)===String(X.taxCodeId)))==null?void 0:fc.rate_percent)||0),"%)"]}),e.jsxs("select",{className:`input w-36 ${Nr}`,value:X.taxCodeId,onChange:ke=>es({taxCodeId:ke.target.value}),disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),b.map(ke=>e.jsx("option",{value:ke.id,children:ke.name},ke.id))]})]}),e.jsx("span",{className:"font-semibold",children:Number(et.tax||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("span",{className:"font-bold",children:Number(et.grand||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount in Words"}),e.jsx("textarea",{className:"input h-20",value:`${Os(Number(et.grand||0))} ${zl}`.trim(),readOnly:!0})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes / Remarks"}),e.jsx("textarea",{className:"input h-24",value:X.notes,onChange:ke=>es({notes:ke.target.value}),placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:yt,children:"Print Voucher"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Et,children:"Download PDF"}),e.jsx(Le,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||l||!Qt||!X.depositAccountId||Number(et.grand||0)<=0,children:u?"Saving...":"Save Voucher"})]})]})})}),Be?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Contra Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:M||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:ct?ct.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:ot||""}),e.jsx("div",{children:Me?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):be&&Array.isArray(be.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ge||"",onChange:ke=>Ve(ke.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),be.approvers.map(ke=>e.jsx("option",{value:ke.id,children:ke.username},ke.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:be?`Step ${be.stepOrder}  ${be.stepName}${be.approvalLimit!=null?`  Limit: ${Number(be.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:ct?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var ke,at,dt;if(o){Ze(!0),Ke("");try{const St=await ee.post(`/finance/vouchers/${a}/submit`,{amount:(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0),workflow_id:ct?ct.id:null,target_user_id:ge||null}),Ut=((ke=St==null?void 0:St.data)==null?void 0:ke.status)||"PENDING_APPROVAL";ze(Ut),_e(!1)}catch(St){Ke(((dt=(at=St==null?void 0:St.response)==null?void 0:at.data)==null?void 0:dt.message)||"Failed to forward for approval")}finally{Ze(!1)}}},disabled:tt||!o,children:tt?"Forwarding...":"Forward"})]})]})}):null]});function Ga(ke){l||oe(at=>({...at,...ke}))}function or(ke,at){l||Ga({items:te.items.map((dt,St)=>St===ke?{...dt,...at}:dt)})}const Jl=x.useMemo(()=>{const ke=g.filter(dt=>["DEBTORS","CREDITORS"].includes(String(dt.group_name||"").toUpperCase()));if(!ve)return ke;const at=String(ve).toLowerCase();return ke.filter(dt=>String(dt.name||"").toLowerCase().includes(at)||String(dt.code||"").toLowerCase().includes(at))},[g,ve]);if(x.useEffect(()=>{if(!E)return;const ke=g.find(It=>String(It.id)===String(te.paymentAccountId||""));if(!ke)return;const at=String(ke.group_code||"").toUpperCase(),dt=String(ke.group_name||"").toUpperCase();(fi?at==="AST_BANK"||dt==="BANK ACCOUNTS":at==="AST_CASH"||dt==="CASH AND CASH EQUIVALENTS")||Ga({paymentAccountId:""})},[E,fi,g,te.paymentAccountId]),x.useEffect(()=>{if(!C)return;const ke=g.find(It=>String(It.id)===String(X.depositAccountId||""));if(!ke)return;const at=String(ke.group_code||"").toUpperCase(),dt=String(ke.group_name||"").toUpperCase();(lr?at==="AST_BANK"||dt==="BANK ACCOUNTS":at==="AST_CASH"||dt==="CASH AND CASH EQUIVALENTS")||es({depositAccountId:""})},[C,lr,g,X.depositAccountId]),x.useEffect(()=>{if(!E)return;const ke=Yl||null,at=Fa||null,dt=Wa||"",St=pi||"";if(!ke||!at){re("");return}if(dt&&St&&dt===St){re("1");return}(async()=>{var Ut;try{const It=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Number(ke),toCurrencyId:Number(at),to:I||null}}),ts=(Array.isArray((Ut=It.data)==null?void 0:Ut.items)?It.data.items:[]).slice().sort((hs,Ns)=>new Date(Ns.rate_date).getTime()-new Date(hs.rate_date).getTime()),Xt=ts.length?Number(ts[0].rate||0):0;re(Xt?String(Xt):"")}catch{re("")}})()},[E,Yl,Fa,Wa,pi,I]),x.useEffect(()=>{if(!C)return;const ke=dn||null,at=Ea||null,dt=ba||"",St=zs||"";if(!ke||!at){Xe("1");return}if(dt&&St&&dt===St){Xe("1");return}(async()=>{var Ut,It;try{const Ht=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Number(ke),toCurrencyId:Number(at),to:I||null}}),Xt=(Array.isArray((Ut=Ht.data)==null?void 0:Ut.items)?Ht.data.items:[]).slice().sort((Ns,ns)=>new Date(ns.rate_date).getTime()-new Date(Ns.rate_date).getTime());let hs=Xt.length?Number(Xt[0].rate||0):0;if(!hs)try{const Ns=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:Number(at),toCurrencyId:Number(ke),to:I||null}}),ss=(Array.isArray((It=Ns.data)==null?void 0:It.items)?Ns.data.items:[]).slice().sort((fs,gr)=>new Date(gr.rate_date).getTime()-new Date(fs.rate_date).getTime()),vs=ss.length?Number(ss[0].rate||0):0;hs=vs?1/vs:0}catch{}Xe(hs?String(hs):"1")}catch{Xe("1")}})()},[C,dn,Ea,ba,zs,I]),E)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Record outgoing payments"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"..",className:"btn-success",children:"Back"}),ht==="APPROVED"?e.jsx("span",{className:"px-2 py-1 rounded bg-green-500 text-white text-sm font-medium",children:"Approved"}):e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var ke,at,dt,St,Ut;if(o&&(_e(!0),Ke(""),!Te))try{Ye(!0);const It=await ee.get("/workflows"),Ht=Array.isArray((ke=It.data)==null?void 0:ke.items)?It.data.items:[];ue(Ht);const ts=(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0);let Xt=null;const hs=Ht.filter(ss=>String(ss.document_route||"")==="/finance/payment-voucher"),Ns=Ht.filter(ss=>["PAYMENT_VOUCHER","Payment Voucher","PV"].includes(String(ss.document_type||""))),ns=[...hs,...Ns];for(const ss of ns){if(Xt)break;if(Number(ss.is_active)!==1)continue;if(ts===null){Xt=ss;break}const vs=ss.min_amount===null||Number(ts)>=Number(ss.min_amount),fs=ss.max_amount===null||Number(ts)<=Number(ss.max_amount);if(vs&&fs){Xt=ss;break}}if(!Xt)for(const ss of Ns){if(Xt)break;if(Number(ss.is_active)!==1)continue;if(ts===null){Xt=ss;break}const vs=ss.min_amount===null||Number(ts)>=Number(ss.min_amount),fs=ss.max_amount===null||Number(ts)<=Number(ss.max_amount);if(vs&&fs){Xt=ss;break}}if(xt(Xt),Ce(null),Ve(null),Xt){const ss=await ee.get(`/workflows/${Xt.id}`),vs=((at=ss==null?void 0:ss.data)==null?void 0:at.item)||{},fs=Number(vs.current_step_order||1),gr=Array.isArray(vs==null?void 0:vs.next_step_approvers)?vs.next_step_approvers:[],Ka=await ee.get(`/workflows/${Xt.id}`),Ur=Array.isArray((dt=Ka==null?void 0:Ka.data)!=null&&dt.item?[Ka.data.item]:[])?[]:[],er=fs||1,ea=gr.length>0?Number(gr[0].id):null;Ce({stepOrder:er,stepName:String(vs.step_name||"Step 1"),approvalLimit:gr.length>0?Number(gr[0].approval_limit||0):null,approvers:gr}),Ve(ea)}}catch(It){Ke(((Ut=(St=It==null?void 0:It.response)==null?void 0:St.data)==null?void 0:Ut.message)||"Failed to load workflows")}finally{Ye(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:As,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:mc,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:M||"PV-000000",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:"input",type:"date",value:I,onChange:ke=>G(ke.target.value),required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Fiscal Year *"}),e.jsxs("select",{className:"input",value:T,onChange:ke=>k(ke.target.value),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select"}),A.map(ke=>e.jsx("option",{value:ke.id,children:ke.code},ke.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Paid To"}),e.jsxs("select",{className:`input ${Nr}`,value:te.payToCode||"",onChange:ke=>{const at=ke.target.value,dt=j.find(ts=>String(ts.code)===String(at)),St=(dt==null?void 0:dt.name)||"",Ut=g.find(ts=>String(ts.code)===String(at)),It=Ut!=null&&Ut.id?String(Ut.id):"",Ht=te.items.length===0?[{description:"",accountId:It,amount:0}]:te.items.map((ts,Xt)=>Xt===0?{...ts,accountId:It}:ts);Ga({payTo:St,payToCode:at,payToAccountId:It,items:Ht}),String((dt==null?void 0:dt.type)||"").toUpperCase()==="SUPPLIER"&&(dt!=null&&dt.id)?We(dt.id):(L([]),H([]))},disabled:l,children:[e.jsx("option",{value:"",children:"Select customer or supplier"}),j.map(ke=>e.jsx("option",{value:ke.code,children:ke.name},ke.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsxs("select",{className:`input ${Nr}`,value:te.paymentMethod,onChange:ke=>Ga({paymentMethod:ke.target.value}),children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Cheque"}),e.jsx("option",{children:"Bank Transfer"}),e.jsx("option",{children:"Credit Card"}),e.jsx("option",{children:"Mobile Money"})]})]}),fi?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Cheque No"}),e.jsx("input",{className:`input ${Nr}`,value:te.reference,onChange:ke=>Ga({reference:ke.target.value}),placeholder:"Reference Number or Cheque Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cheque Date"}),e.jsx("input",{className:`input ${Nr}`,type:"date",value:te.chequeDate||"",onChange:ke=>Ga({chequeDate:ke.target.value}),disabled:l})]})]})}):null]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Account *"}),e.jsxs("select",{className:`input ${Nr}`,value:te.paymentAccountId,onChange:ke=>Ga({paymentAccountId:ke.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select account"}),g.filter(ke=>{const at=String(ke.group_code||"").toUpperCase(),dt=String(ke.group_name||"").toUpperCase();return fi?at==="AST_BANK"||dt==="BANK ACCOUNTS":at==="AST_CASH"||dt==="CASH AND CASH EQUIVALENTS"}).map(ke=>e.jsxs("option",{value:ke.id,children:[ke.code," - ",ke.name]},ke.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Outstanding Bills"}),P.length>0?e.jsx("select",{multiple:!0,className:`input ${Nr}`,value:U,onChange:ke=>{const at=Array.from(ke.target.selectedOptions).map(Ut=>Ut.value);H(at);const dt=P.filter(Ut=>at.includes(String(Ut.bill_no))),St=dt.length>0?dt.map(Ut=>({description:`Bill ${Ut.bill_no} payment`,accountId:te.payToAccountId||"",amount:Number(Ut.outstanding||0),referenceNo:String(Ut.bill_no)})):[{description:"",accountId:te.payToAccountId||"",amount:0,referenceNo:""}];Ga({items:St})},size:Math.min(6,Math.max(3,P.length)),disabled:l,children:P.map(ke=>e.jsxs("option",{value:ke.bill_no,children:[ke.bill_no,"  ",ke.payment_status,"  Outstanding"," ",Number(ke.outstanding||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},ke.id))}):e.jsx("div",{className:"input bg-gray-100 text-gray-500",children:"No bills for selected supplier"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:pi||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:ce||"",readOnly:!0})]})]}),e.jsx("div",{})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Payment Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:"#"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"w-64",children:"Account"}),e.jsx("th",{className:"text-right w-32",children:"Currency"}),e.jsx("th",{className:"text-right w-40",children:"Amount"})]})}),e.jsx("tbody",{children:te.items.length===0?e.jsx("tr",{children:e.jsx("td",{className:"text-center p-2",colSpan:5,children:"No items"})}):te.items.map((ke,at)=>e.jsxs("tr",{children:[e.jsx("td",{children:at+1}),e.jsx("td",{children:e.jsx("input",{className:`input ${Nr}`,value:ke.description,onChange:dt=>or(at,{description:dt.target.value}),placeholder:"Description"})}),e.jsx("td",{children:e.jsxs("select",{className:`input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold ${Nr}`,value:ke.accountId,onChange:dt=>or(at,{accountId:dt.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),g.map(dt=>e.jsx("option",{value:dt.id,children:dt.name},dt.id))]})}),e.jsx("td",{className:"text-right",children:Wa||""}),e.jsx("td",{children:e.jsx("input",{className:`input text-right ${Nr}`,type:"number",min:"0",step:"1",value:ke.amount||"",onChange:dt=>or(at,{amount:Number(dt.target.value||0)}),onFocus:()=>{Number(ke.amount||0)===0&&or(at,{amount:""})},disabled:l})})]},at))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold",children:Number(et.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Tax (",Number(((xi=b.find(ke=>String(ke.id)===String(te.taxCodeId)))==null?void 0:xi.rate_percent)||0),"%)"]}),e.jsxs("select",{className:"input w-36",value:te.taxCodeId,onChange:ke=>Ga({taxCodeId:ke.target.value}),children:[e.jsx("option",{value:"",children:"Select"}),b.map(ke=>e.jsx("option",{value:ke.id,children:ke.name},ke.id))]})]}),e.jsx("span",{className:"font-semibold",children:Number(et.tax||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("span",{className:"font-bold",children:Number(et.grand||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount in Words"}),e.jsx("textarea",{className:"input h-20",value:`${Os(Number(et.grand||0))} ${Xl}`.trim(),readOnly:!0})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes / Remarks"}),e.jsx("textarea",{className:`input h-24 ${Nr}`,value:te.notes,onChange:ke=>Ga({notes:ke.target.value}),placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:yt,children:"Print Voucher"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Et,children:"Download PDF"}),e.jsx(Le,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||l||!Qt||!te.paymentAccountId||Number(et.grand||0)<=0,children:u?"Saving...":"Save Voucher"})]})]})})}),Be?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Payment Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:M||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:ct?ct.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:ot||""}),e.jsx("div",{children:Me?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):be&&Array.isArray(be.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ge||"",onChange:ke=>Ve(ke.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),be.approvers.map(ke=>e.jsx("option",{value:ke.id,children:ke.username},ke.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:be?`Step ${be.stepOrder}  ${be.stepName}${be.approvalLimit!=null?`  Limit: ${Number(be.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:ct?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var ke,at,dt;if(o){Ze(!0),Ke("");try{const St=await ee.post(`/finance/vouchers/${a}/submit`,{amount:(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0),workflow_id:ct?ct.id:null,target_user_id:ge||null}),Ut=((ke=St==null?void 0:St.data)==null?void 0:ke.status)||"PENDING_APPROVAL";ze(Ut),_e(!1)}catch(St){Ke(((dt=(at=St==null?void 0:St.response)==null?void 0:at.data)==null?void 0:dt.message)||"Failed to forward for approval")}finally{Ze(!1)}}},disabled:tt||!o,children:tt?"Forwarding...":"Forward"})]})]})}):null]});function Qn(ke){l||xe(at=>({...at,...ke}))}function Zl(ke,at){l||Qn({items:Fe.items.map((dt,St)=>St===ke?{...dt,...at}:dt)})}if(w)return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:s}),e.jsx("p",{className:"text-sm mt-1",children:"Transfer funds between accounts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"..",className:"btn-success",children:"Back"}),e.jsx("button",{type:"button",className:"btn-success",onClick:async()=>{var ke,at,dt,St;if(o&&(_e(!0),Ke(""),!Te))try{Ye(!0);const Ut=await ee.get("/workflows"),It=Array.isArray((ke=Ut.data)==null?void 0:ke.items)?Ut.data.items:[];ue(It);const Ht=(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0);let ts=null;const Xt=It.filter(ns=>String(ns.document_route||"")==="/finance/contra-voucher"),hs=It.filter(ns=>["CONTRA_VOUCHER","Contra Voucher","CV"].includes(String(ns.document_type||""))),Ns=[...Xt,...hs];for(const ns of Ns){if(ts)break;if(Number(ns.is_active)!==1)continue;if(Ht===null){ts=ns;break}const ss=ns.min_amount===null||Number(Ht)>=Number(ns.min_amount),vs=ns.max_amount===null||Number(Ht)<=Number(ns.max_amount);if(ss&&vs){ts=ns;break}}if(!ts)for(const ns of hs){if(ts)break;if(Number(ns.is_active)!==1)continue;if(Ht===null){ts=ns;break}const ss=ns.min_amount===null||Number(Ht)>=Number(ns.min_amount),vs=ns.max_amount===null||Number(Ht)<=Number(ns.max_amount);if(ss&&vs){ts=ns;break}}if(xt(ts),Ce(null),Ve(null),ts){const ns=await ee.get(`/workflows/${ts.id}`),ss=((at=ns==null?void 0:ns.data)==null?void 0:at.item)||{},vs=Number(ss.current_step_order||1),fs=Array.isArray(ss==null?void 0:ss.next_step_approvers)?ss.next_step_approvers:[],gr=fs.length>0?Number(fs[0].id):null;Ce({stepOrder:vs||1,stepName:String(ss.step_name||"Step 1"),approvalLimit:fs.length>0?Number(fs[0].approval_limit||0):null,approvers:fs}),Ve(gr)}}catch(Ut){Ke(((St=(dt=Ut==null?void 0:Ut.response)==null?void 0:dt.data)==null?void 0:St.message)||"Failed to load workflows")}finally{Ye(!1)}},disabled:u||!o,children:"Forward for Approval"})]})]})})}),e.jsx("form",{onSubmit:As,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Type"}),e.jsx("input",{className:"input",value:"Contra Voucher",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No"}),e.jsx("input",{className:"input",value:M||"CV-000001",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date *"}),e.jsx("input",{className:"input",type:"date",value:I,onChange:ke=>G(ke.target.value),required:!0,disabled:l})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Account *"}),e.jsxs("select",{className:"input",value:Fe.fromAccountId,onChange:ke=>Qn({fromAccountId:ke.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),vl.map(ke=>e.jsx("option",{value:ke.id,children:ke.name},ke.id))]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:Wr||"",readOnly:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Account *"}),e.jsxs("select",{className:"input",value:Fe.toAccountId,onChange:ke=>Qn({toAccountId:ke.target.value}),required:!0,disabled:l,children:[e.jsx("option",{value:"",children:"Select account"}),vl.map(ke=>e.jsx("option",{value:ke.id,children:ke.name},ke.id))]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:Lr||"",readOnly:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Transfer Method"}),e.jsxs("select",{className:"input",value:Fe.transferMethod,onChange:ke=>Qn({transferMethod:ke.target.value}),disabled:l,children:[e.jsx("option",{children:"Cash"}),e.jsx("option",{children:"Cheque"}),e.jsx("option",{children:"Bank Transfer"})]})]}),Po?e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Cheque No"}),e.jsx("input",{className:"input",value:Fe.reference,onChange:ke=>Qn({reference:ke.target.value}),placeholder:"Reference Number or Cheque Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cheque Date"}),e.jsx("input",{className:"input",type:"date",value:Fe.chequeDate||"",onChange:ke=>Qn({chequeDate:ke.target.value}),disabled:l})]})]})}):e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Reference / Instrument No"}),e.jsx("input",{className:"input",value:Fe.reference,onChange:ke=>Qn({reference:ke.target.value}),placeholder:"Reference Number",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Exchange Rate"}),e.jsx("input",{className:"input bg-blue-50 text-blue-700 border-blue-300 dark:bg-blue-900/30 dark:text-blue-200 dark:border-blue-700 font-semibold",value:de||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Code"}),e.jsxs("select",{className:"input",value:Fe.taxCodeId,onChange:ke=>Qn({taxCodeId:ke.target.value}),disabled:l,children:[e.jsx("option",{value:"",children:"None"}),b.map(ke=>e.jsx("option",{value:ke.id,children:ke.name},ke.id))]})]})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsx("div",{className:"font-semibold text-slate-800 dark:text-slate-200",children:"Transfer Details"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-10",children:"#"}),e.jsx("th",{className:"w-64",children:"Description"}),e.jsx("th",{className:"text-right w-40",children:"Amount to Transfer"}),e.jsx("th",{className:"w-24 hidden"})]})}),e.jsx("tbody",{children:Fe.items.length===0?e.jsx("tr",{children:e.jsx("td",{className:"text-center p-2",colSpan:4,children:"No items"})}):Fe.items.map((ke,at)=>e.jsxs("tr",{children:[e.jsx("td",{children:at+1}),e.jsx("td",{children:e.jsx("input",{className:"input",value:ke.description,onChange:dt=>Zl(at,{description:dt.target.value}),placeholder:"Description",disabled:l})}),e.jsx("td",{children:e.jsx("input",{className:"input text-right",type:"number",min:"0",step:"1",value:ke.amount,onChange:dt=>Zl(at,{amount:Number(dt.target.value||0)}),onFocus:()=>{Number(ke.amount||0)===0&&Zl(at,{amount:""})},disabled:l})}),e.jsx("td",{className:"hidden"})]},at))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{className:"font-semibold",children:Number(et.subtotal||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{children:["Tax (",Number(((yl=b.find(ke=>String(ke.id)===String(Fe.taxCodeId)))==null?void 0:yl.rate_percent)||0),"%)"]})}),e.jsx("span",{className:"font-semibold",children:Number(et.tax||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"font-semibold",children:"TOTAL AMOUNT"}),e.jsx("span",{className:"font-bold",children:Number(et.grand||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount in Words"}),e.jsx("textarea",{className:"input h-20",value:Ps(Number(et.grand||0)),readOnly:!0})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes / Remarks"}),e.jsx("textarea",{className:"input h-24",value:Fe.notes,onChange:ke=>Qn({notes:ke.target.value}),placeholder:"Additional notes or comments"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:yt,children:"Print Voucher"}),e.jsx(Le,{to:"..",className:"btn-success",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:u||l||!Qt||!Fe.fromAccountId||!Fe.toAccountId||Number(et.grand||0)<=0,children:u?"Saving...":"Save Voucher"})]})]})})}),Be?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95%]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-brand text-white rounded-t-lg",children:[e.jsx("div",{className:"font-semibold",children:"Forward Contra Voucher for Approval"}),e.jsx("button",{type:"button",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},className:"text-white hover:text-slate-200 text-xl font-bold",children:""})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-slate-700",children:["Document No:"," ",e.jsx("span",{className:"font-semibold",children:M||"-"})]}),e.jsxs("div",{className:"text-sm text-slate-700",children:["Workflow:"," ",e.jsx("span",{className:"font-semibold",children:ct?ct.workflow_name:"Auto"})]}),e.jsx("div",{className:"text-sm text-red-600",children:ot||""}),e.jsx("div",{children:Me?e.jsx("div",{className:"text-slate-600",children:"Loading workflows..."}):be&&Array.isArray(be.approvers)?e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assign To"}),e.jsxs("select",{className:"input",value:ge||"",onChange:ke=>Ve(ke.target.value||null),children:[e.jsx("option",{value:"",children:"Select approver"}),be.approvers.map(ke=>e.jsx("option",{value:ke.id,children:ke.username},ke.id))]}),e.jsx("div",{className:"text-xs text-slate-600 mt-1",children:be?`Step ${be.stepOrder}  ${be.stepName}${be.approvalLimit!=null?`  Limit: ${Number(be.approvalLimit).toLocaleString()}`:""}`:""})]}):e.jsx("div",{className:"text-slate-600",children:ct?"No approver found in workflow definition":"No active workflow; default behavior will apply"})})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2 bg-gray-50",children:[e.jsx("button",{type:"button",className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",onClick:()=>{_e(!1),xt(null),Ce(null),Ke("")},children:"Cancel"}),e.jsx("button",{type:"button",className:"px-4 py-2 bg-brand text-white rounded hover:bg-brand-700",onClick:async()=>{var ke,at,dt;if(o){Ze(!0),Ke("");try{const St=await ee.post(`/finance/vouchers/${a}/submit`,{amount:(et==null?void 0:et.grand)===""||(et==null?void 0:et.grand)==null?null:Number((et==null?void 0:et.grand)||0),workflow_id:ct?ct.id:null,target_user_id:ge||null}),Ut=((ke=St==null?void 0:St.data)==null?void 0:ke.status)||"PENDING_APPROVAL";ze(Ut),_e(!1)}catch(St){Ke(((dt=(at=St==null?void 0:St.response)==null?void 0:at.data)==null?void 0:dt.message)||"Failed to forward for approval")}finally{Ze(!1)}}},disabled:tt||!o,children:tt?"Forwarding...":"Forward"})]})]})}):null]})}function fS(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/finance/reports/voucher-register",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Voucher Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Voucher listing report with date filters"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"VoucherRegister"),xr(h,"voucher-register.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Voucher Register",10,h),h+=8,c.setFontSize(10),c.text("Date",10,h),c.text("Voucher No",45,h),c.text("Type",95,h),c.text("Narration",125,h),c.text("Debit",160,h),c.text("Credit",180,h),c.text("Status",200,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.voucher_date?new Date(A.voucher_date).toLocaleDateString():"-",g=String(A.voucher_no||"-"),v=String(A.voucher_type_code||"-"),b=String(A.narration||"-").slice(0,35),y=String(Number(A.total_debit||0).toLocaleString()),j=String(Number(A.total_credit||0).toLocaleString()),N=String(A.status||"-");c.text(f,10,h),c.text(g,45,h),c.text(v,95,h),c.text(b,125,h),c.text(y,160,h),c.text(j,180,h),c.text(N,200,h,{align:"right"}),h+=5}),c.save("voucher-register.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Narration"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(d.voucher_date).toLocaleDateString()}),e.jsx("td",{className:"font-medium",children:d.voucher_no}),e.jsx("td",{children:d.voucher_type_code}),e.jsx("td",{children:d.narration||"-"}),e.jsx("td",{className:"text-right",children:Number(d.total_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.total_credit||0).toLocaleString()}),e.jsx("td",{children:d.status})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function BJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var c,h,A;try{o(!0);const f=await ee.get("/finance/reports/trial-balance",{params:{from:t||null,to:r||null}});i(((c=f.data)==null?void 0:c.items)||[])}catch(f){nt.error(((A=(h=f==null?void 0:f.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load trial balance")}finally{o(!1)}}x.useEffect(()=>{u()},[]);const d=n.reduce((c,h)=>(c.opening_debit+=Number(h.opening_debit||0),c.opening_credit+=Number(h.opening_credit||0),c.movement_debit+=Number(h.movement_debit||0),c.movement_credit+=Number(h.movement_credit||0),c.closing_debit+=Number(h.closing_debit||0),c.closing_credit+=Number(h.closing_credit||0),c),{opening_debit:0,opening_credit:0,movement_debit:0,movement_credit:0,closing_debit:0,closing_credit:0});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Trial Balance"}),e.jsx("p",{className:"text-sm mt-1",children:"Debits and credits by account"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:c=>s(c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:c=>a(c.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const h=is.json_to_sheet(c),A=is.book_new();is.book_append_sheet(A,h,"TrialBalance"),xr(A,"trial-balance.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const h=new ds("p","mm","a4");let A=15;h.setFontSize(14),h.text("Trial Balance",10,A),A+=8,h.setFontSize(10),h.text("Account",10,A),h.text("Op Dr",95,A),h.text("Op Cr",115,A),h.text("Mv Dr",135,A),h.text("Mv Cr",155,A),h.text("Cls Dr",175,A),h.text("Cls Cr",190,A,{align:"right"}),A+=4,h.line(10,A,200,A),A+=5,c.forEach(f=>{A>270&&(h.addPage(),A=15);const g=`${String(f.account_code||"-")} ${String(f.account_name||"").slice(0,40)}`.trim();h.text(g,10,A),h.text(String(Number(f.opening_debit||0).toLocaleString()),95,A),h.text(String(Number(f.opening_credit||0).toLocaleString()),115,A),h.text(String(Number(f.movement_debit||0).toLocaleString()),135,A),h.text(String(Number(f.movement_credit||0).toLocaleString()),155,A),h.text(String(Number(f.closing_debit||0).toLocaleString()),175,A),h.text(String(Number(f.closing_credit||0).toLocaleString()),190,A,{align:"right"}),A+=5}),A+=5,h.setFontSize(11),h.text(`Totals  Op Dr: ${d.opening_debit.toLocaleString()}`,10,A),A+=6,h.text(`Op Cr: ${d.opening_credit.toLocaleString()}`,10,A),A+=6,h.text(`Mv Dr: ${d.movement_debit.toLocaleString()}`,10,A),A+=6,h.text(`Mv Cr: ${d.movement_credit.toLocaleString()}`,10,A),A+=6,h.text(`Cls Dr: ${d.closing_debit.toLocaleString()}`,10,A),A+=6,h.text(`Cls Cr: ${d.closing_credit.toLocaleString()}`,10,A),h.save("trial-balance.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Account"}),e.jsx("th",{className:"text-right",children:"Opening Dr"}),e.jsx("th",{className:"text-right",children:"Opening Cr"}),e.jsx("th",{className:"text-right",children:"Movement Dr"}),e.jsx("th",{className:"text-right",children:"Movement Cr"}),e.jsx("th",{className:"text-right",children:"Closing Dr"}),e.jsx("th",{className:"text-right",children:"Closing Cr"})]})}),e.jsx("tbody",{children:n.map(c=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:c.account_code}),e.jsx("div",{className:"text-sm",children:c.account_name})]}),e.jsx("td",{className:"text-right",children:Number(c.opening_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.opening_credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.movement_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.movement_credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.closing_debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.closing_credit||0).toLocaleString()})]},c.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Totals"}),e.jsx("td",{className:"text-right font-semibold",children:d.opening_debit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.opening_credit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.movement_debit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.movement_credit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.closing_debit.toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:d.closing_credit.toLocaleString()})]})})]})})]})})]})}function EJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/finance/reports/journals",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load journals")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Journals"}),e.jsx("p",{className:"text-sm mt-1",children:"Journal entries for the selected period"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"Journals"),xr(h,"journals.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Journals",10,h),h+=8,c.setFontSize(10),c.text("Date",10,h),c.text("Voucher No",45,h),c.text("Line",95,h),c.text("Account",115,h),c.text("Debit",160,h),c.text("Credit",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.voucher_date?new Date(A.voucher_date).toLocaleDateString():"-",g=String(A.voucher_no||"-"),v=String(A.line_no||"-"),b=`${String(A.account_code||"-")} ${String(A.account_name||"").slice(0,30)}`.trim(),y=String(Number(A.debit||0).toLocaleString()),j=String(Number(A.credit||0).toLocaleString());c.text(f,10,h),c.text(g,45,h),c.text(v,95,h),c.text(b,115,h),c.text(y,160,h),c.text(j,190,h,{align:"right"}),h+=5}),c.save("journals.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Line"}),e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"})]})}),e.jsx("tbody",{children:n.map((d,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(d.voucher_date).toLocaleDateString()}),e.jsx("td",{className:"font-medium",children:d.voucher_no}),e.jsx("td",{children:d.line_no}),e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:d.account_code}),e.jsx("div",{className:"text-sm",children:d.account_name})]}),e.jsx("td",{children:d.description||"-"}),e.jsx("td",{className:"text-right",children:Number(d.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.credit||0).toLocaleString()})]},`${d.id}-${c}`))})]})})]})})]})}function FJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState(""),[l,o]=x.useState([]),[u,d]=x.useState(0),[c,h]=x.useState([]),[A,f]=x.useState(!1);async function g(){var b,y,j,N;try{const S=await ee.get("/finance/accounts",{params:{postable:1,active:1}});o(((b=S.data)==null?void 0:b.items)||[]),!n&&((N=(j=(y=S.data)==null?void 0:y.items)==null?void 0:j[0])!=null&&N.id)&&i(String(S.data.items[0].id))}catch{nt.error("Failed to load accounts")}}async function v(){var b,y,j,N;if(n)try{f(!0);const S=await ee.get("/finance/reports/general-ledger",{params:{accountId:n,from:t||null,to:r||null}});d(Number(((b=S.data)==null?void 0:b.opening_balance)||0)),h(((y=S.data)==null?void 0:y.items)||[])}catch(S){nt.error(((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load general ledger")}finally{f(!1)}}return x.useEffect(()=>{g()},[]),x.useEffect(()=>{v()},[n]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"General Ledger"}),e.jsx("p",{className:"text-sm mt-1",children:"Ledger entries for a selected account"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Account"}),e.jsx("select",{className:"input",value:n,onChange:b=>i(b.target.value),children:l.map(b=>e.jsxs("option",{value:b.id,children:[b.code,"  ",b.name]},b.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:b=>s(b.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:b=>a(b.target.value)})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:v,disabled:A,children:A?"Running...":"Run"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:A,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const b=Array.isArray(c)?c:[];if(!b.length)return;const y=is.json_to_sheet(b),j=is.book_new();is.book_append_sheet(j,y,"GeneralLedger"),xr(j,"general-ledger.xlsx")},disabled:!c.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const b=Array.isArray(c)?c:[];if(!b.length)return;const y=new ds("p","mm","a4");let j=15;y.setFontSize(14),y.text("General Ledger",10,j),j+=6,y.setFontSize(10),y.text(`Opening: ${Number(u||0).toLocaleString()}`,10,j),j+=8,y.text("Date",10,j),y.text("Voucher No",45,j),y.text("Line",95,j),y.text("Description",115,j),y.text("Debit",160,j),y.text("Credit",180,j),y.text("Balance",200,j,{align:"right"}),j+=4,y.line(10,j,200,j),j+=5,b.forEach(N=>{j>270&&(y.addPage(),j=15);const S=N.voucher_date?new Date(N.voucher_date).toLocaleDateString():"-",B=String(N.voucher_no||"-"),P=String(N.line_no||"-"),L=String(N.description||"-").slice(0,35),U=String(Number(N.debit||0).toLocaleString()),H=String(Number(N.credit||0).toLocaleString()),q=String(Number(N.balance||0).toLocaleString());y.text(S,10,j),y.text(B,45,j),y.text(P,95,j),y.text(L,115,j),y.text(U,160,j),y.text(H,180,j),y.text(q,200,j,{align:"right"}),j+=5}),y.save("general-ledger.pdf")},disabled:!c.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 mb-4",children:[e.jsx("div",{className:"text-sm",children:"Opening Balance"}),e.jsx("div",{className:"text-xl font-semibold",children:Number(u||0).toLocaleString()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher No"}),e.jsx("th",{children:"Line"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:c.map((b,y)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(b.voucher_date).toLocaleDateString()}),e.jsx("td",{className:"font-medium",children:b.voucher_no}),e.jsx("td",{children:b.line_no}),e.jsx("td",{children:b.description||"-"}),e.jsx("td",{className:"text-right",children:Number(b.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(b.credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(b.balance||0).toLocaleString()})]},`${b.voucher_no}-${b.line_no}-${y}`))})]})})]})})]})}function TJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState({items:[],total:0}),[l,o]=x.useState({items:[],total:0}),[u,d]=x.useState(0),[c,h]=x.useState(!1);async function A(){var f,g,v,b,y;try{h(!0);const j=await ee.get("/finance/reports/profit-and-loss",{params:{from:t||null,to:r||null}});i(((f=j.data)==null?void 0:f.income)||{items:[],total:0}),o(((g=j.data)==null?void 0:g.expenses)||{items:[],total:0}),d(Number(((v=j.data)==null?void 0:v.net_profit)||0))}catch(j){nt.error(((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.message)||"Failed to load P&L")}finally{h(!1)}}return x.useEffect(()=>{A()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Profit and Loss"}),e.jsx("p",{className:"text-sm mt-1",children:"Income and expense summary"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:f=>s(f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:f=>a(f.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:A,disabled:c,children:c?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:c,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const f=[...n.items.map(b=>({section:"Income",...b})),...l.items.map(b=>({section:"Expenses",...b}))];if(!f.length)return;const g=is.json_to_sheet(f),v=is.book_new();is.book_append_sheet(v,g,"ProfitAndLoss"),xr(v,"profit-and-loss.xlsx")},disabled:!n.items.length&&!l.items.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const f=[...n.items.map(b=>({section:"Income",...b})),...l.items.map(b=>({section:"Expenses",...b}))];if(!f.length)return;const g=new ds("p","mm","a4");let v=15;g.setFontSize(14),g.text("Profit and Loss",10,v),v+=8,g.setFontSize(10),g.text("Section",10,v),g.text("Account",60,v),g.text("Amount",190,v,{align:"right"}),v+=4,g.line(10,v,200,v),v+=5,f.forEach(b=>{v>270&&(g.addPage(),v=15);const y=String(b.section),j=`${String(b.account_code||"-")} ${String(b.account_name||"").slice(0,40)}`.trim(),N=String(Number(b.amount||0).toLocaleString());g.text(y,10,v),g.text(j,60,v),g.text(N,190,v,{align:"right"}),v+=5}),v+=5,g.setFontSize(11),g.text(`Total Income: ${Number(n.total||0).toLocaleString()}`,10,v),v+=6,g.text(`Total Expenses: ${Number(l.total||0).toLocaleString()}`,10,v),v+=6,g.text(`Net Profit: ${Number(u||0).toLocaleString()}`,10,v),g.save("profit-and-loss.pdf")},disabled:!n.items.length&&!l.items.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Income"}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:n.items.map(f=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:f.account_code}),e.jsx("div",{className:"text-sm",children:f.account_name})]}),e.jsx("td",{className:"text-right",children:Number(f.amount||0).toLocaleString()})]},f.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Total Income"}),e.jsx("td",{className:"text-right font-semibold",children:Number(n.total||0).toLocaleString()})]})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Expenses"}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:l.items.map(f=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:f.account_code}),e.jsx("div",{className:"text-sm",children:f.account_name})]}),e.jsx("td",{className:"text-right",children:Number(f.amount||0).toLocaleString()})]},f.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Total Expenses"}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.total||0).toLocaleString()})]})})]})})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 mt-6",children:[e.jsx("div",{className:"text-sm",children:"Net Profit"}),e.jsx("div",{className:"text-xl font-semibold",children:Number(u||0).toLocaleString()})]})]})})]})}function IJ(){const[t,s]=x.useState(""),[r,a]=x.useState({items:[],total:0}),[n,i]=x.useState({items:[],total:0}),[l,o]=x.useState({items:[],total:0}),[u,d]=x.useState(0),[c,h]=x.useState(!1);async function A(){var g,v,b,y,j,N;try{h(!0);const S=await ee.get("/finance/reports/balance-sheet",{params:{to:t||null}});a(((g=S.data)==null?void 0:g.assets)||{items:[],total:0}),i(((v=S.data)==null?void 0:v.liabilities)||{items:[],total:0}),o(((b=S.data)==null?void 0:b.equity)||{items:[],total:0}),d(Number(((y=S.data)==null?void 0:y.balance)||0))}catch(S){nt.error(((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load balance sheet")}finally{h(!1)}}x.useEffect(()=>{A()},[]);function f({title:g,data:v}){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:g}),e.jsx("th",{className:"text-right",children:"Amount"})]})}),e.jsx("tbody",{children:v.items.map(b=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:b.account_code}),e.jsx("div",{className:"text-sm",children:b.account_name})]}),e.jsx("td",{className:"text-right",children:Number(b.amount||0).toLocaleString()})]},b.account_id))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsxs("td",{className:"font-semibold",children:["Total ",g]}),e.jsx("td",{className:"text-right font-semibold",children:Number(v.total||0).toLocaleString()})]})})]})})}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Balance Sheet"}),e.jsx("p",{className:"text-sm mt-1",children:"Position at selected date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As Of"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:g=>s(g.target.value)})]}),e.jsxs("div",{className:"md:col-span-3 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:A,disabled:c,children:c?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>s(""),disabled:c,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const g=[...r.items.map(y=>({section:"Assets",...y})),...n.items.map(y=>({section:"Liabilities",...y})),...l.items.map(y=>({section:"Equity",...y}))];if(!g.length)return;const v=is.json_to_sheet(g),b=is.book_new();is.book_append_sheet(b,v,"BalanceSheet"),xr(b,"balance-sheet.xlsx")},disabled:!r.items.length&&!n.items.length&&!l.items.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const g=[...r.items.map(y=>({section:"Assets",...y})),...n.items.map(y=>({section:"Liabilities",...y})),...l.items.map(y=>({section:"Equity",...y}))];if(!g.length)return;const v=new ds("p","mm","a4");let b=15;v.setFontSize(14),v.text("Balance Sheet",10,b),b+=8,v.setFontSize(10),v.text("Section",10,b),v.text("Account",60,b),v.text("Amount",190,b,{align:"right"}),b+=4,v.line(10,b,200,b),b+=5,g.forEach(y=>{b>270&&(v.addPage(),b=15);const j=String(y.section),N=`${String(y.account_code||"-")} ${String(y.account_name||"").slice(0,40)}`.trim(),S=String(Number(y.amount||0).toLocaleString());v.text(j,10,b),v.text(N,60,b),v.text(S,190,b,{align:"right"}),b+=5}),b+=5,v.setFontSize(11),v.text(`Total Assets: ${Number(r.total||0).toLocaleString()}`,10,b),b+=6,v.text(`Total Liabilities: ${Number(n.total||0).toLocaleString()}`,10,b),b+=6,v.text(`Total Equity: ${Number(l.total||0).toLocaleString()}`,10,b),b+=6,v.text(`Balance: ${Number(u||0).toLocaleString()}`,10,b),v.save("balance-sheet.pdf")},disabled:!r.items.length&&!n.items.length&&!l.items.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(f,{title:"Assets",data:r}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(f,{title:"Liabilities",data:n}),e.jsx(f,{title:"Equity",data:l})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 mt-6",children:[e.jsx("div",{className:"text-sm",children:"Assets - (Liabilities + Equity)"}),e.jsx("div",{className:"text-xl font-semibold",children:Number(u||0).toLocaleString()})]})]})})]})}function LJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState({inflow:0,outflow:0,net:0}),[u,d]=x.useState(!1);async function c(){var h,A,f,g;try{d(!0);const v=await ee.get("/finance/reports/cash-flow",{params:{from:t||null,to:r||null}});i(((h=v.data)==null?void 0:h.items)||[]),o(((A=v.data)==null?void 0:A.totals)||{inflow:0,outflow:0,net:0})}catch(v){nt.error(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to load cash flow")}finally{d(!1)}}return x.useEffect(()=>{c()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Cash Flow"}),e.jsx("p",{className:"text-sm mt-1",children:"Movements in bank and cash accounts"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:h=>s(h.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:c,disabled:u,children:u?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:u,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const h=Array.isArray(n)?n:[];if(!h.length)return;const A=is.json_to_sheet(h),f=is.book_new();is.book_append_sheet(f,A,"CashFlow"),xr(f,"cash-flow.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const h=Array.isArray(n)?n:[];if(!h.length)return;const A=new ds("p","mm","a4");let f=15;A.setFontSize(14),A.text("Cash Flow",10,f),f+=8,A.setFontSize(10),A.text("Bank",10,f),A.text("Account",70,f),A.text("Inflow",130,f),A.text("Outflow",160,f),A.text("Net",190,f,{align:"right"}),f+=4,A.line(10,f,200,f),f+=5,h.forEach(g=>{f>270&&(A.addPage(),f=15);const v=String(g.bank_name||"-").slice(0,40),b=`${String(g.account_code||"-")} ${String(g.account_name||"").slice(0,30)}`.trim(),y=String(Number(g.inflow||0).toLocaleString()),j=String(Number(g.outflow||0).toLocaleString()),N=String(Number(g.net||0).toLocaleString());A.text(v,10,f),A.text(b,70,f),A.text(y,130,f),A.text(j,160,f),A.text(N,190,f,{align:"right"}),f+=5}),f+=5,A.setFontSize(11),A.text(`Totals  Inflow: ${Number(l.inflow||0).toLocaleString()}`,10,f),f+=6,A.text(`Outflow: ${Number(l.outflow||0).toLocaleString()}`,10,f),f+=6,A.text(`Net: ${Number(l.net||0).toLocaleString()}`,10,f),A.save("cash-flow.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"Account"}),e.jsx("th",{className:"text-right",children:"Inflow"}),e.jsx("th",{className:"text-right",children:"Outflow"}),e.jsx("th",{className:"text-right",children:"Net"})]})}),e.jsx("tbody",{children:n.map(h=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:h.bank_name}),e.jsxs("td",{children:[e.jsx("div",{className:"font-medium",children:h.account_code}),e.jsx("div",{className:"text-sm",children:h.account_name})]}),e.jsx("td",{className:"text-right",children:Number(h.inflow||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.outflow||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(h.net||0).toLocaleString()})]},`${h.bank_account_id}-${h.account_id}`))}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{className:"font-semibold",children:"Totals"}),e.jsx("td",{}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.inflow||0).toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.outflow||0).toLocaleString()}),e.jsx("td",{className:"text-right font-semibold",children:Number(l.net||0).toLocaleString()})]})})]})})]})})]})}function DJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/finance/reports/payment-due",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Payment Due Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Upcoming and overdue payables by due date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Due Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Due Date"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=["Due Date","Ref","Party","Amount","Outstanding","Status"],h=d.map(b=>[b.due_date?new Date(b.due_date).toLocaleDateString():"-",String(b.ref_no||"-"),String(b.party_name||"-"),Number(b.amount||0).toFixed(2),Number(b.outstanding||0).toFixed(2),String(b.status||"-")]),A=[c.join(","),...h.map(b=>b.join(","))].join(`
`),f=new Blob([A],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(f),v=document.createElement("a");v.href=g,v.download="payment-due.csv",v.click(),URL.revokeObjectURL(g)},disabled:!n.length,children:"Export CSV"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"PaymentDue"),xr(h,"payment-due.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Payment Due Report",10,h),h+=8,c.setFontSize(10),c.text("Due Date",10,h),c.text("Ref",45,h),c.text("Party",85,h),c.text("Amount",140,h),c.text("Outstanding",165,h),c.text("Status",200,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.due_date?new Date(A.due_date).toLocaleDateString():"-",g=String(A.ref_no||"-"),v=String(A.party_name||"-").slice(0,40),b=String(Number(A.amount||0).toLocaleString()),y=String(Number(A.outstanding||0).toLocaleString()),j=String(A.status||"-");c.text(f,10,h),c.text(g,45,h),c.text(v,85,h),c.text(b,140,h),c.text(y,165,h),c.text(j,200,h,{align:"right"}),h+=5}),c.save("payment-due.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Due Date"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Party"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Outstanding"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.due_date?new Date(d.due_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:d.ref_no||"-"}),e.jsx("td",{children:d.party_name||"-"}),e.jsx("td",{className:"text-right",children:Number(d.amount||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(d.outstanding||0).toLocaleString()}),e.jsx("td",{children:d.status||"-"})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function UJ(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await ee.get("/finance/reports/customer-outstanding",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){nt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return x.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Customer Outstanding Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Receivables outstanding per customer as of a date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=is.json_to_sheet(o),d=is.book_new();is.book_append_sheet(d,u,"CustomerOutstanding"),xr(d,"customer-outstanding.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new ds("p","mm","a4");let d=15;u.setFontSize(14),u.text("Customer Outstanding Report",10,d),d+=8,u.setFontSize(10),u.text("Customer",10,d),u.text("Invoice No",75,d),u.text("Inv Date",115,d),u.text("Due Date",145,d),u.text("Amount",165,d),u.text("Received",180,d),u.text("Outstanding",200,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15);const h=String(c.customer_name||"-").slice(0,60),A=String(c.invoice_no||"-"),f=c.invoice_date?new Date(c.invoice_date).toLocaleDateString():"-",g=c.due_date?new Date(c.due_date).toLocaleDateString():"-",v=String(Number(c.amount||0).toLocaleString()),b=String(Number(c.received||0).toLocaleString()),y=String(Number(c.outstanding||0).toLocaleString());u.text(h,10,d),u.text(A,75,d),u.text(f,115,d),u.text(g,145,d),u.text(v,165,d),u.text(b,180,d),u.text(y,200,d,{align:"right"}),d+=5}),u.save("customer-outstanding.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Invoice Date"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Received"}),e.jsx("th",{className:"text-right",children:"Outstanding"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.customer_name||"-"}),e.jsx("td",{children:o.invoice_no||"-"}),e.jsx("td",{children:o.invoice_date?new Date(o.invoice_date).toLocaleDateString():"-"}),e.jsx("td",{children:o.due_date?new Date(o.due_date).toLocaleDateString():"-"}),e.jsx("td",{className:"text-right",children:Number(o.amount||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.received||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.outstanding||0).toLocaleString()})]},o.id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function PJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/finance/reports/audit-trail",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Audit Trail"}),e.jsx("p",{className:"text-sm mt-1",children:"System activity for finance transactions"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"AuditTrail"),xr(h,"audit-trail.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Audit Trail",10,h),h+=8,c.setFontSize(10),c.text("Date/Time",10,h),c.text("User",60,h),c.text("Action",95,h),c.text("Entity",130,h),c.text("Ref",165,h),c.text("Details",190,h,{align:"right"}),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=A.action_time?new Date(A.action_time).toLocaleString():"-",g=String(A.user_name||"-").slice(0,25),v=String(A.action||"-").slice(0,25),b=String(A.entity||"-").slice(0,25),y=String(A.ref_no||"-").slice(0,25),j=String(A.details||"-").slice(0,60);c.text(f,10,h),c.text(g,60,h),c.text(v,95,h),c.text(b,130,h),c.text(y,165,h),c.text(j,190,h,{align:"right"}),h+=5}),c.save("audit-trail.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Entity"}),e.jsx("th",{children:"Reference"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:n.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.action_time?new Date(d.action_time).toLocaleString():"-"}),e.jsx("td",{children:d.user_name||"-"}),e.jsx("td",{children:d.action||"-"}),e.jsx("td",{children:d.entity||"-"}),e.jsx("td",{className:"font-medium",children:d.ref_no||"-"}),e.jsx("td",{children:d.details||"-"})]},d.id))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function RJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1),u=x.useMemo(()=>{const c=n.reduce((f,g)=>f+Number(g.debit||0),0),h=n.reduce((f,g)=>f+Number(g.credit||0),0),A=c-h;return{debit:c,credit:h,balance:A}},[n]);async function d(){var c,h,A;try{o(!0);const f=await ee.get("/finance/reports/debtors-ledger",{params:{from:t||null,to:r||null}});i(((c=f.data)==null?void 0:c.items)||[])}catch(f){nt.error(((A=(h=f==null?void 0:f.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{d()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Debtors Ledger"}),e.jsx("p",{className:"text-sm mt-1",children:"Customer ledger movements and running balance"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:c=>s(c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:c=>a(c.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const h=is.json_to_sheet(c),A=is.book_new();is.book_append_sheet(A,h,"DebtorsLedger"),xr(A,"debtors-ledger.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const h=new ds("p","mm","a4");let A=15;h.setFontSize(14),h.text("Debtors Ledger",10,A),A+=8,h.setFontSize(10),h.text("Date",10,A),h.text("Document",45,A),h.text("Description",95,A),h.text("Debit",140,A),h.text("Credit",165,A),h.text("Balance",190,A,{align:"right"}),A+=4,h.line(10,A,200,A),A+=5,c.forEach((f,g)=>{A>270&&(h.addPage(),A=15);const v=f.txn_date?new Date(f.txn_date).toLocaleDateString():"-",b=String(f.doc_no||"-"),y=String(f.description||"-").slice(0,35),j=Number(f.debit||0),N=Number(f.credit||0),S=c.slice(0,g+1).reduce((B,P)=>B+Number(P.debit||0)-Number(P.credit||0),0);h.text(v,10,A),h.text(b,45,A),h.text(y,95,A),h.text(String(j.toLocaleString()),140,A),h.text(String(N.toLocaleString()),165,A),h.text(String(Number(S||0).toLocaleString()),190,A,{align:"right"}),A+=5}),A+=5,h.setFontSize(11),h.text(`Totals  Debit: ${Number(u.debit||0).toLocaleString()}`,10,A),A+=6,h.text(`Credit: ${Number(u.credit||0).toLocaleString()}`,10,A),A+=6,h.text(`Balance: ${Number(u.balance||0).toLocaleString()}`,10,A),h.save("debtors-ledger.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:n.map((c,h)=>{const A=n.slice(0,h+1).reduce((f,g)=>f+Number(g.debit||0)-Number(g.credit||0),0);return e.jsxs("tr",{children:[e.jsx("td",{children:c.txn_date?new Date(c.txn_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:c.doc_no||"-"}),e.jsx("td",{children:c.description||"-"}),e.jsx("td",{className:"text-right",children:Number(c.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A||0).toLocaleString()})]},c.id||h)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-right font-medium",children:"Totals"}),e.jsx("td",{className:"text-right font-medium",children:u.debit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.credit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.balance.toLocaleString()})]})})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function OJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1),u=x.useMemo(()=>{const c=n.reduce((f,g)=>f+Number(g.debit||0),0),h=n.reduce((f,g)=>f+Number(g.credit||0),0),A=c-h;return{debit:c,credit:h,balance:A}},[n]);async function d(){var c,h,A;try{o(!0);const f=await ee.get("/finance/reports/creditors-ledger",{params:{from:t||null,to:r||null}});i(((c=f.data)==null?void 0:c.items)||[])}catch(f){nt.error(((A=(h=f==null?void 0:f.response)==null?void 0:h.data)==null?void 0:A.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{d()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Creditors Ledger"}),e.jsx("p",{className:"text-sm mt-1",children:"Supplier ledger movements and running balance"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:c=>s(c.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:c=>a(c.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:d,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const h=is.json_to_sheet(c),A=is.book_new();is.book_append_sheet(A,h,"CreditorsLedger"),xr(A,"creditors-ledger.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const c=Array.isArray(n)?n:[];if(!c.length)return;const h=new ds("p","mm","a4");let A=15;h.setFontSize(14),h.text("Creditors Ledger",10,A),A+=8,h.setFontSize(10),h.text("Date",10,A),h.text("Document",45,A),h.text("Description",95,A),h.text("Debit",140,A),h.text("Credit",165,A),h.text("Balance",190,A,{align:"right"}),A+=4,h.line(10,A,200,A),A+=5,c.forEach((f,g)=>{A>270&&(h.addPage(),A=15);const v=f.txn_date?new Date(f.txn_date).toLocaleDateString():"-",b=String(f.doc_no||"-"),y=String(f.description||"-").slice(0,35),j=Number(f.debit||0),N=Number(f.credit||0),S=c.slice(0,g+1).reduce((B,P)=>B+Number(P.debit||0)-Number(P.credit||0),0);h.text(v,10,A),h.text(b,45,A),h.text(y,95,A),h.text(String(j.toLocaleString()),140,A),h.text(String(N.toLocaleString()),165,A),h.text(String(Number(S||0).toLocaleString()),190,A,{align:"right"}),A+=5}),A+=5,h.setFontSize(11),h.text(`Totals  Debit: ${Number(u.debit||0).toLocaleString()}`,10,A),A+=6,h.text(`Credit: ${Number(u.credit||0).toLocaleString()}`,10,A),A+=6,h.text(`Balance: ${Number(u.balance||0).toLocaleString()}`,10,A),h.save("creditors-ledger.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Document"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Debit"}),e.jsx("th",{className:"text-right",children:"Credit"}),e.jsx("th",{className:"text-right",children:"Balance"})]})}),e.jsx("tbody",{children:n.map((c,h)=>{const A=n.slice(0,h+1).reduce((f,g)=>f+Number(g.debit||0)-Number(g.credit||0),0);return e.jsxs("tr",{children:[e.jsx("td",{children:c.txn_date?new Date(c.txn_date).toLocaleDateString():"-"}),e.jsx("td",{className:"font-medium",children:c.doc_no||"-"}),e.jsx("td",{children:c.description||"-"}),e.jsx("td",{className:"text-right",children:Number(c.debit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(c.credit||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(A||0).toLocaleString()})]},c.id||h)})}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("td",{colSpan:3,className:"text-right font-medium",children:"Totals"}),e.jsx("td",{className:"text-right font-medium",children:u.debit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.credit.toLocaleString()}),e.jsx("td",{className:"text-right font-medium",children:u.balance.toLocaleString()})]})})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function QJ(){const[t,s]=x.useState(""),[r,a]=x.useState([]),[n,i]=x.useState(!1);async function l(){var o,u,d;try{i(!0);const c=await ee.get("/finance/reports/supplier-outstanding",{params:{asOf:t||null}});a(((o=c.data)==null?void 0:o.items)||[])}catch(c){nt.error(((d=(u=c==null?void 0:c.response)==null?void 0:u.data)==null?void 0:d.message)||"Failed to load report")}finally{i(!1)}}return x.useEffect(()=>{l()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Supplier Outstanding Report"}),e.jsx("p",{className:"text-sm mt-1",children:"Payables outstanding per supplier as of a date"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"As of Date"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:o=>s(o.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:l,disabled:n,children:n?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s("")},disabled:n,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=is.json_to_sheet(o),d=is.book_new();is.book_append_sheet(d,u,"SupplierOutstanding"),xr(d,"supplier-outstanding.xlsx")},disabled:!r.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const o=Array.isArray(r)?r:[];if(!o.length)return;const u=new ds("p","mm","a4");let d=15;u.setFontSize(14),u.text("Supplier Outstanding Report",10,d),d+=8,u.setFontSize(10),u.text("Supplier",10,d),u.text("Bill No",75,d),u.text("Bill Date",110,d),u.text("Due Date",140,d),u.text("Amount",165,d),u.text("Paid",180,d),u.text("Outstanding",200,d,{align:"right"}),d+=4,u.line(10,d,200,d),d+=5,o.forEach(c=>{d>270&&(u.addPage(),d=15);const h=String(c.supplier_name||"-").slice(0,60),A=String(c.bill_no||"-"),f=c.bill_date?new Date(c.bill_date).toLocaleDateString():"-",g=c.due_date?new Date(c.due_date).toLocaleDateString():"-",v=String(Number(c.amount||0).toLocaleString()),b=String(Number(c.paid||0).toLocaleString()),y=String(Number(c.outstanding||0).toLocaleString());u.text(h,10,d),u.text(A,75,d),u.text(f,110,d),u.text(g,140,d),u.text(v,165,d),u.text(b,180,d),u.text(y,200,d,{align:"right"}),d+=5}),u.save("supplier-outstanding.pdf")},disabled:!r.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Supplier"}),e.jsx("th",{children:"Bill No"}),e.jsx("th",{children:"Bill Date"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Paid"}),e.jsx("th",{className:"text-right",children:"Outstanding"})]})}),e.jsx("tbody",{children:r.map(o=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:o.supplier_name||"-"}),e.jsx("td",{children:o.bill_no||"-"}),e.jsx("td",{children:o.bill_date?new Date(o.bill_date).toLocaleDateString():"-"}),e.jsx("td",{children:o.due_date?new Date(o.due_date).toLocaleDateString():"-"}),e.jsx("td",{className:"text-right",children:Number(o.amount||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.paid||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(o.outstanding||0).toLocaleString()})]},o.id))})]})}),r.length===0&&!n?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function MJ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState([]),[l,o]=x.useState(!1);async function u(){var d,c,h;try{o(!0);const A=await ee.get("/finance/reports/ratio-analysis",{params:{from:t||null,to:r||null}});i(((d=A.data)==null?void 0:d.items)||[])}catch(A){nt.error(((h=(c=A==null?void 0:A.response)==null?void 0:c.data)==null?void 0:h.message)||"Failed to load report")}finally{o(!1)}}return x.useEffect(()=>{u()},[]),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/finance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Finance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Ratio Analysis"}),e.jsx("p",{className:"text-sm mt-1",children:"Key financial ratios for performance insights"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",type:"date",value:t,onChange:d=>s(d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",type:"date",value:r,onChange:d=>a(d.target.value)})]}),e.jsxs("div",{className:"md:col-span-2 flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:u,disabled:l,children:l?"Running...":"Run Report"}),e.jsx("button",{type:"button",className:"btn-success",onClick:()=>{s(""),a("")},disabled:l,children:"Clear"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=is.json_to_sheet(d),h=is.book_new();is.book_append_sheet(h,c,"RatioAnalysis"),xr(h,"ratio-analysis.xlsx")},disabled:!n.length,children:"Export Excel"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{const d=Array.isArray(n)?n:[];if(!d.length)return;const c=new ds("p","mm","a4");let h=15;c.setFontSize(14),c.text("Ratio Analysis",10,h),h+=8,c.setFontSize(10),c.text("Ratio",10,h),c.text("Value",95,h),c.text("Notes",130,h),h+=4,c.line(10,h,200,h),h+=5,d.forEach(A=>{h>270&&(c.addPage(),h=15);const f=String(A.name||"-").slice(0,70),g=Number(A.value||0).toFixed(2),v=String(A.notes||"-").slice(0,60);c.text(f,10,h),c.text(g,95,h),c.text(v,130,h),h+=5}),c.save("ratio-analysis.pdf")},disabled:!n.length,children:"Export PDF"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>window.print(),children:"Print"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Ratio"}),e.jsx("th",{className:"text-right",children:"Value"}),e.jsx("th",{children:"Notes"})]})}),e.jsx("tbody",{children:n.map((d,c)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:d.name||"-"}),e.jsx("td",{className:"text-right",children:Number(d.value||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{children:d.notes||"-"})]},d.key||c))})]})}),n.length===0&&!l?e.jsx("div",{className:"text-center py-10",children:"No rows."}):null]})})]})}function HJ(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(!0),[A,f]=x.useState(""),[g,v]=x.useState(""),[b,y]=x.useState("ASSET"),[j,N]=x.useState(""),[S,B]=x.useState(""),[P,L]=x.useState(""),[U,H]=x.useState(""),[q,V]=x.useState("ASSET"),[M,z]=x.useState("");async function I(){var D,Q,C;try{a(!0);const E=await ee.get("/finance/account-groups",{params:{search:n||null,nature:l||null,active:u||null,includeTotals:c?"1":"0"}});s(((D=E.data)==null?void 0:D.items)||[])}catch(E){nt.error(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to load account groups")}finally{a(!1)}}x.useEffect(()=>{I()},[]);async function G(D){var Q,C;D.preventDefault();try{await ee.post("/finance/account-groups",{code:A,name:g,nature:b,parentId:j?Number(j):null,isActive:1}),nt.success("Account group created"),f(""),v(""),N(""),I()}catch(E){nt.error(((C=(Q=E==null?void 0:E.response)==null?void 0:Q.data)==null?void 0:C.message)||"Failed to create group")}}async function Y(D,Q){var C,E;try{a(!0),await ee.put(`/finance/account-groups/${D}/active`,{isActive:+!!Q}),nt.success("Status updated"),await I()}catch(w){nt.error(((E=(C=w==null?void 0:w.response)==null?void 0:C.data)==null?void 0:E.message)||"Failed to update active status")}finally{a(!1)}}function J(D){B(String(D.id)),L(D.code||""),H(D.name||""),V(D.nature||"ASSET"),z(D.parent_id?String(D.parent_id):"")}function T(){B(""),L(""),H(""),V("ASSET"),z("")}async function k(){var D,Q;try{a(!0);const C={code:P,name:U,nature:q,parentId:M?Number(M):null};await ee.put(`/finance/account-groups/${S}`,C),nt.success("Group updated"),T(),await I()}catch(C){nt.error(((Q=(D=C==null?void 0:C.response)==null?void 0:D.data)==null?void 0:Q.message)||"Failed to update group")}finally{a(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Chart of Account Groups"}),e.jsx("p",{className:"text-sm mt-1",children:"Maintain account group hierarchy"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("input",{className:"input w-48",placeholder:"Search code/name...",value:n,onChange:D=>i(D.target.value)}),e.jsxs("select",{className:"input w-40",value:l,onChange:D=>o(D.target.value),children:[e.jsx("option",{value:"",children:"All Nature"}),e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]}),e.jsxs("select",{className:"input w-32",value:u,onChange:D=>d(D.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}),e.jsx("button",{className:"btn-success",onClick:I,disabled:r,children:"Apply"})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:G,className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:A,onChange:D=>f(D.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:g,onChange:D=>v(D.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Nature *"}),e.jsxs("select",{className:"input",value:b,onChange:D=>y(D.target.value),children:[e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Parent"}),e.jsxs("select",{className:"input",value:j,onChange:D=>N(D.target.value),children:[e.jsx("option",{value:"",children:"None"}),t.map(D=>e.jsxs("option",{value:D.id,children:[D.code," - ",D.name]},D.id))]})]}),e.jsx("div",{className:"md:col-span-5 flex justify-end",children:e.jsx("button",{className:"btn-success",type:"submit",children:"Create Group"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:r?e.jsx("div",{className:"text-center py-10",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Nature"}),e.jsx("th",{children:"Parent"}),e.jsx("th",{className:"text-right",children:"Accounts"}),e.jsx("th",{children:"Active"})]})}),e.jsx("tbody",{children:t.map(D=>e.jsx("tr",{children:String(S)===String(D.id)?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{className:"input",value:P,onChange:Q=>L(Q.target.value)})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:U,onChange:Q=>H(Q.target.value)})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:q,onChange:Q=>V(Q.target.value),children:[e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:M,onChange:Q=>z(Q.target.value),children:[e.jsx("option",{value:"",children:"None"}),t.map(Q=>e.jsxs("option",{value:Q.id,children:[Q.code," - ",Q.name]},`p-${Q.id}`))]})}),e.jsx("td",{className:"text-right",children:typeof D.account_count=="number"?D.account_count:"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",disabled:r,onClick:k,children:"Save"}),e.jsx("button",{className:"btn btn-secondary",disabled:r,onClick:T,children:"Cancel"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"font-medium",children:D.code}),e.jsx("td",{children:D.name}),e.jsx("td",{children:D.nature}),e.jsx("td",{children:D.parent_name||"-"}),e.jsx("td",{className:"text-right",children:typeof D.account_count=="number"?D.account_count:"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>J(D),disabled:r,children:"Edit"}),D.is_active?e.jsx("button",{className:"btn btn-secondary",disabled:r||typeof D.active_account_count=="number"&&D.active_account_count>0,onClick:()=>{window.confirm("Deactivate this group?")&&Y(D.id,0)},children:"Deactivate"}):e.jsx("button",{className:"btn-success",disabled:r,onClick:()=>Y(D.id,1),children:"Activate"})]})})]})},D.id))})]})})})})]})}function pS(){const[t,s]=x.useState([]),[r,a]=x.useState([]),[n,i]=x.useState([]),[l,o]=x.useState(!0),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState(""),[g,v]=x.useState(""),[b,y]=x.useState(""),[j,N]=x.useState(""),[S,B]=x.useState(""),[P,L]=x.useState(""),[U,H]=x.useState(""),[q,V]=x.useState(!0),[M,z]=x.useState(""),[I,G]=x.useState(""),[Y,J]=x.useState(""),[T,k]=x.useState(""),[D,Q]=x.useState(""),[C,E]=x.useState(!0);async function w(){var ce,re,de,Ie,le;try{o(!0);const[Z,ve,Ue]=await Promise.all([ee.get("/finance/accounts",{params:{search:u||null,groupId:c||null,nature:A||null,active:g||null,postable:b||null}}),ee.get("/finance/account-groups"),ee.get("/finance/currencies")]);s(((ce=Z.data)==null?void 0:ce.items)||[]),a(((re=ve.data)==null?void 0:re.items)||[]),i(((de=Ue.data)==null?void 0:de.items)||[])}catch(Z){nt.error(((le=(Ie=Z==null?void 0:Z.response)==null?void 0:Ie.data)==null?void 0:le.message)||"Failed to load accounts")}finally{o(!1)}}async function O(){var ce,re;try{await ee.post("/finance/accounts/sync")}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to sync accounts from customers/suppliers")}}x.useEffect(()=>{(async()=>(await O(),await w()))()},[]);async function R(ce){var re,de;ce.preventDefault();try{await ee.post("/finance/accounts",{groupId:Number(j),code:S,name:P,currencyId:U?Number(U):null,isPostable:q,isControlAccount:0,isActive:1}),nt.success("Account created"),B(""),L(""),N(""),H(""),V(!0),w()}catch(Ie){nt.error(((de=(re=Ie==null?void 0:Ie.response)==null?void 0:re.data)==null?void 0:de.message)||"Failed to create account")}}async function X(ce,re){var de,Ie;try{o(!0),await ee.put(`/finance/accounts/${ce}/active`,{isActive:+!!re}),nt.success("Status updated"),await w()}catch(le){nt.error(((Ie=(de=le==null?void 0:le.response)==null?void 0:de.data)==null?void 0:Ie.message)||"Failed to update active status")}finally{o(!1)}}function ne(ce){z(String(ce.id)),G(String(ce.group_id)),J(ce.code||""),k(ce.name||""),Q(ce.currency_id?String(ce.currency_id):""),E(!!ce.is_postable)}function te(){z(""),G(""),J(""),k(""),Q(""),E(!0)}async function oe(){var ce,re;try{o(!0),await ee.put(`/finance/accounts/${M}`,{groupId:I?Number(I):null,code:Y,name:T,currencyId:D?Number(D):null,isPostable:C?1:0}),nt.success("Account updated"),te(),await w()}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to update account")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Chart of Accounts"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage ledger accounts"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("input",{className:"input w-48",placeholder:"Search code/name...",value:u,onChange:ce=>d(ce.target.value)}),e.jsxs("select",{className:"input w-48",value:c,onChange:ce=>h(ce.target.value),children:[e.jsx("option",{value:"",children:"All Groups"}),r.map(ce=>e.jsxs("option",{value:ce.id,children:[ce.code," - ",ce.name]},`flt-${ce.id}`))]}),e.jsxs("select",{className:"input w-40",value:A,onChange:ce=>f(ce.target.value),children:[e.jsx("option",{value:"",children:"All Nature"}),e.jsx("option",{value:"ASSET",children:"Asset"}),e.jsx("option",{value:"LIABILITY",children:"Liability"}),e.jsx("option",{value:"EQUITY",children:"Equity"}),e.jsx("option",{value:"INCOME",children:"Income"}),e.jsx("option",{value:"EXPENSE",children:"Expense"})]}),e.jsxs("select",{className:"input w-32",value:g,onChange:ce=>v(ce.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}),e.jsxs("select",{className:"input w-40",value:b,onChange:ce=>y(ce.target.value),children:[e.jsx("option",{value:"",children:"All Posting"}),e.jsx("option",{value:"1",children:"Postable"}),e.jsx("option",{value:"0",children:"Non-postable"})]}),e.jsx("button",{className:"btn-success",onClick:w,disabled:l,children:"Apply"})]})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:R,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Group *"}),e.jsxs("select",{className:"input",value:j,onChange:ce=>N(ce.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select group"}),r.map(ce=>e.jsxs("option",{value:ce.id,children:[ce.code," - ",ce.name]},ce.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:S,onChange:ce=>B(ce.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:P,onChange:ce=>L(ce.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsxs("select",{className:"input",value:U,onChange:ce=>H(ce.target.value),children:[e.jsx("option",{value:"",children:"Default"}),n.map(ce=>e.jsx("option",{value:ce.id,children:ce.code},ce.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Posting"}),e.jsxs("select",{className:"input",value:q?"1":"0",onChange:ce=>V(ce.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Postable"}),e.jsx("option",{value:"0",children:"Non-postable"})]})]}),e.jsx("div",{className:"md:col-span-6 flex justify-end",children:e.jsx("button",{className:"btn-success",type:"submit",children:"Create Account"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:l?e.jsx("div",{className:"text-center py-10",children:"Loading..."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Group"}),e.jsx("th",{children:"Nature"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Postable"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.map(ce=>e.jsx("tr",{children:String(M)===String(ce.id)?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx("input",{className:"input",value:Y,onChange:re=>J(re.target.value)})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:T,onChange:re=>k(re.target.value)})}),e.jsx("td",{children:e.jsx("select",{className:"input",value:I,onChange:re=>G(re.target.value),children:r.map(re=>e.jsxs("option",{value:re.id,children:[re.code," - ",re.name]},`g-${re.id}`))})}),e.jsx("td",{children:ce.nature}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:D,onChange:re=>Q(re.target.value),children:[e.jsx("option",{value:"",children:"Default"}),n.map(re=>e.jsx("option",{value:re.id,children:re.code},`c-${re.id}`))]})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:C?"1":"0",onChange:re=>E(re.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Yes"}),e.jsx("option",{value:"0",children:"No"})]})}),e.jsx("td",{children:ce.is_active?"Yes":"No"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",disabled:l,onClick:oe,children:"Save"}),e.jsx("button",{className:"btn btn-secondary",disabled:l,onClick:te,children:"Cancel"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"font-medium",children:ce.code}),e.jsx("td",{children:ce.name}),e.jsx("td",{children:ce.group_name}),e.jsx("td",{children:ce.nature}),e.jsx("td",{children:ce.currency_code||"-"}),e.jsx("td",{children:ce.is_postable?"Yes":"No"}),e.jsx("td",{children:ce.is_active?"Yes":"No"}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",disabled:l,onClick:()=>ne(ce),children:"Edit"}),ce.is_active?e.jsx("button",{className:"btn btn-secondary",disabled:l,onClick:()=>X(ce.id,0),children:"Deactivate"}):e.jsx("button",{className:"btn-success",disabled:l,onClick:()=>X(ce.id,1),children:"Activate"})]})})]})},ce.id))})]})})})})]})}function qJ(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState("TAX"),[A,f]=x.useState(!0),[g,v]=x.useState({}),[b,y]=x.useState(null),[j,N]=x.useState(null),[S,B]=x.useState([]),[P,L]=x.useState(""),[U,H]=x.useState(""),[q,V]=x.useState(""),[M,z]=x.useState(!0);async function I(){var oe,ce,re;try{a(!0);const de=await ee.get("/finance/tax-codes");s(((oe=de.data)==null?void 0:oe.items)||[])}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to load tax codes")}finally{a(!1)}}x.useEffect(()=>{I()},[]);async function G(oe){var ce,re,de;try{const Ie=await ee.get(`/finance/tax-codes/${oe}/components`);B(((ce=Ie.data)==null?void 0:ce.items)||[])}catch(Ie){nt.error(((de=(re=Ie==null?void 0:Ie.response)==null?void 0:re.data)==null?void 0:de.message)||"Failed to load tax components")}}function Y(oe){y(oe.id),N(oe),L(""),H(""),V(""),z(!0),G(oe.id)}async function J(oe){var ce,re;if(oe.preventDefault(),!!b)try{await ee.post(`/finance/tax-codes/${b}/components`,{componentName:P.trim(),ratePercent:U?Number(U):0,sortOrder:q?Number(q):100,isActive:M}),nt.success("Component added"),L(""),H(""),V(""),z(!0),G(b)}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to add tax component")}}const[T,k]=x.useState({});function D(oe){k(ce=>({...ce,[oe.id]:{component_name:oe.component_name,rate_percent:oe.rate_percent,sort_order:oe.sort_order,is_active:oe.is_active}}))}function Q(oe,ce,re){k(de=>({...de,[oe]:{...de[oe]||{},[ce]:re}}))}async function C(oe){var re,de;const ce=T[oe];if(ce)try{await ee.put(`/finance/tax-components/${oe}`,{componentName:ce.component_name,ratePercent:ce.rate_percent===""||ce.rate_percent===null?void 0:Number(ce.rate_percent),sortOrder:ce.sort_order===""||ce.sort_order===null?void 0:Number(ce.sort_order),isActive:ce.is_active}),nt.success("Component updated"),k(Ie=>{const le={...Ie};return delete le[oe],le}),G(b)}catch(Ie){nt.error(((de=(re=Ie==null?void 0:Ie.response)==null?void 0:re.data)==null?void 0:de.message)||"Failed to update component")}}async function E(oe){var ce,re;if(window.confirm("Disable this component?"))try{await ee.delete(`/finance/tax-components/${oe}`),nt.success("Component disabled"),k(de=>{const Ie={...de};return delete Ie[oe],Ie}),G(b)}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to disable component")}}async function w(oe){var ce,re;oe.preventDefault();try{await ee.post("/finance/tax-codes",{code:n.trim(),name:l.trim(),ratePercent:u?Number(u):0,type:c,isActive:A}),nt.success("Tax code created"),i(""),o(""),d(""),h("TAX"),f(!0),I()}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to create tax code")}}function O(oe){v(ce=>({...ce,[oe.id]:{name:oe.name,rate_percent:oe.rate_percent,type:oe.type,is_active:oe.is_active}}))}function R(oe,ce,re){v(de=>({...de,[oe]:{...de[oe]||{},[ce]:re}}))}async function X(oe){var re,de;const ce=g[oe];if(ce)try{await ee.put(`/finance/tax-codes/${oe}`,{name:ce.name,ratePercent:ce.rate_percent===""||ce.rate_percent===null?void 0:Number(ce.rate_percent),type:ce.type,isActive:ce.is_active}),nt.success("Tax code updated"),v(Ie=>{const le={...Ie};return delete le[oe],le}),I()}catch(Ie){nt.error(((de=(re=Ie==null?void 0:Ie.response)==null?void 0:re.data)==null?void 0:de.message)||"Failed to update tax code")}}function ne(oe){v(ce=>{const re={...ce};return delete re[oe],re})}async function te(oe){var ce,re;try{await ee.put(`/finance/tax-codes/${oe.id}`,{isActive:!oe.is_active}),I()}catch(de){nt.error(((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.message)||"Failed to toggle status")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Tax Codes & Deductions"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure tax and deduction codes used across modules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:I,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:w,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:n,onChange:oe=>i(oe.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:l,onChange:oe=>o(oe.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate (%)"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:u,onChange:oe=>d(oe.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Type *"}),e.jsxs("select",{className:"input",value:c,onChange:oe=>h(oe.target.value),required:!0,children:[e.jsx("option",{value:"TAX",children:"Tax"}),e.jsx("option",{value:"DEDUCTION",children:"Deduction"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:oe=>f(oe.target.checked)}),"Active"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Rate (%)"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(oe=>{const ce=!!g[oe.id],re=g[oe.id]||{};return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:oe.code}),e.jsx("td",{children:ce?e.jsx("input",{className:"input",value:re.name??"",onChange:de=>R(oe.id,"name",de.target.value)}):oe.name}),e.jsx("td",{children:ce?e.jsxs("select",{className:"input",value:re.type??"TAX",onChange:de=>R(oe.id,"type",de.target.value),children:[e.jsx("option",{value:"TAX",children:"Tax"}),e.jsx("option",{value:"DEDUCTION",children:"Deduction"})]}):oe.type}),e.jsx("td",{children:ce?e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:re.rate_percent===void 0?oe.rate_percent:re.rate_percent,onChange:de=>R(oe.id,"rate_percent",de.target.value)}):Number(oe.rate_percent||0).toFixed(2)}),e.jsx("td",{children:ce?e.jsxs("select",{className:"input",value:(re.is_active?1:0).toString(),onChange:de=>R(oe.id,"is_active",de.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}):oe.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-right",children:ce?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>X(oe.id),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>ne(oe.id),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>O(oe),children:"Edit"}),e.jsx("button",{className:"btn",onClick:()=>Y(oe),children:"Components"}),e.jsx("button",{className:"btn",onClick:()=>te(oe),children:oe.is_active?"Disable":"Enable"})]})})]},oe.id)})})]})})})}),b&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Components for ",j==null?void 0:j.code," - ",j==null?void 0:j.name]}),e.jsx("p",{className:"text-sm",children:"Define composite taxes/deductions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>G(b),children:"Refresh"}),e.jsx("button",{className:"btn",onClick:()=>y(null),children:"Close"})]})]}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("form",{onSubmit:J,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Component Name *"}),e.jsx("input",{className:"input",value:P,onChange:oe=>L(oe.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate (%)"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:U,onChange:oe=>H(oe.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sort Order"}),e.jsx("input",{className:"input",type:"number",min:"0",value:q,onChange:oe=>V(oe.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:M,onChange:oe=>z(oe.target.checked)}),"Active"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add Component"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Component"}),e.jsx("th",{children:"Rate (%)"}),e.jsx("th",{children:"Sort"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[S.map(oe=>{const ce=!!T[oe.id],re=T[oe.id]||{};return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:ce?e.jsx("input",{className:"input",value:re.component_name===void 0?oe.component_name:re.component_name,onChange:de=>Q(oe.id,"component_name",de.target.value)}):oe.component_name}),e.jsx("td",{children:ce?e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:re.rate_percent===void 0?oe.rate_percent:re.rate_percent,onChange:de=>Q(oe.id,"rate_percent",de.target.value)}):Number(oe.rate_percent||0).toFixed(2)}),e.jsx("td",{children:ce?e.jsx("input",{className:"input",type:"number",min:"0",value:re.sort_order===void 0?oe.sort_order:re.sort_order,onChange:de=>Q(oe.id,"sort_order",de.target.value)}):oe.sort_order}),e.jsx("td",{children:ce?e.jsxs("select",{className:"input",value:(re.is_active?1:0).toString(),onChange:de=>Q(oe.id,"is_active",de.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]}):oe.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-right",children:ce?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>C(oe.id),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>k(de=>{const Ie={...de};return delete Ie[oe.id],Ie}),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>D(oe),children:"Edit"}),e.jsx("button",{className:"btn",onClick:()=>E(oe.id),children:"Disable"})]})})]},oe.id)}),S.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-slate-600",children:"No components defined"})})]})]})})]})]})]})}function VJ(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(!1),[A,f]=x.useState(!0);async function g(){var S,B,P;try{a(!0);const L=await ee.get("/finance/currencies");s(((S=L.data)==null?void 0:S.items)||[])}catch(L){nt.error(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to load currencies")}finally{a(!1)}}x.useEffect(()=>{g()},[]);async function v(S){var B,P;S.preventDefault();try{await ee.post("/finance/currencies",{code:n.trim().toUpperCase(),name:l.trim(),symbol:u.trim()||null,isBase:c,isActive:A}),nt.success("Currency created"),i(""),o(""),d(""),h(!1),f(!0),g()}catch(L){nt.error(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to create currency")}}async function b(S){var B,P;try{await ee.put(`/finance/currencies/${S}`,{isBase:1}),nt.success("Base currency updated"),g()}catch(L){nt.error(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to set base currency")}}async function y(S){var B,P;try{await ee.put(`/finance/currencies/${S.id}`,{isActive:S.is_active?0:1}),g()}catch(L){nt.error(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to toggle status")}}async function j(S){var B,P;try{await ee.put(`/finance/currencies/${S.id}`,{name:S._name??S.name,symbol:S._symbol??S.symbol}),nt.success("Currency updated"),g()}catch(L){nt.error(((P=(B=L==null?void 0:L.response)==null?void 0:B.data)==null?void 0:P.message)||"Failed to update currency")}}function N(S,B,P){s(L=>L.map(U=>U.id===S?{...U,[B]:P}:U))}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Currencies"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage currencies and base currency for the company"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:g,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:n,onChange:S=>i(S.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:l,onChange:S=>o(S.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Symbol"}),e.jsx("input",{className:"input",value:u,onChange:S=>d(S.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:S=>h(S.target.checked)}),"Set as Base"]})}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:S=>f(S.target.checked)}),"Active"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Symbol"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(S=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:S.code}),e.jsx("td",{children:e.jsx("input",{className:"input",value:S._name??S.name??"",onChange:B=>N(S.id,"_name",B.target.value)})}),e.jsx("td",{children:e.jsx("input",{className:"input",value:S._symbol??S.symbol??"",onChange:B=>N(S.id,"_symbol",B.target.value)})}),e.jsx("td",{children:S.is_base?e.jsx("span",{className:"badge badge-success",children:"Base"}):e.jsx("button",{className:"btn",onClick:()=>b(S.id),children:"Set Base"})}),e.jsx("td",{children:S.is_active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>j(S),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>y(S),children:S.is_active?"Disable":"Enable"})]})})]},S.id))})]})})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Currency Rates"}),e.jsx("p",{className:"text-sm",children:"Maintain exchange rate history"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"btn btn-secondary",disabled:!1,onClick:()=>{},children:"Help"})})]})}),e.jsx("div",{className:"card-body space-y-4",children:e.jsx($J,{items:t})})]})]})}function $J({items:t}){const[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(""),[o,u]=x.useState(""),[d,c]=x.useState(""),[h,A]=x.useState(""),[f,g]=x.useState(""),[v,b]=x.useState(""),[y,j]=x.useState(""),[N,S]=x.useState(""),[B,P]=x.useState({});async function L(){var U,H,q;try{n(!0);const V=await ee.get("/finance/currency-rates",{params:{fromCurrencyId:i||null,toCurrencyId:o||null,from:d||null,to:h||null}});r(((U=V.data)==null?void 0:U.items)||[])}catch(V){nt.error(((q=(H=V==null?void 0:V.response)==null?void 0:H.data)==null?void 0:q.message)||"Failed to load currency rates")}finally{n(!1)}}return x.useEffect(()=>{L()},[i,o,d,h]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Currency"}),e.jsxs("select",{className:"input",value:i,onChange:U=>l(U.target.value),children:[e.jsx("option",{value:"",children:"All"}),t.map(U=>e.jsxs("option",{value:U.id,children:[U.code," - ",U.name]},`f-${U.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Currency"}),e.jsxs("select",{className:"input",value:o,onChange:U=>u(U.target.value),children:[e.jsx("option",{value:"",children:"All"}),t.map(U=>e.jsxs("option",{value:U.id,children:[U.code," - ",U.name]},`t-${U.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From Date"}),e.jsx("input",{className:"input",type:"date",value:d,onChange:U=>c(U.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To Date"}),e.jsx("input",{className:"input",type:"date",value:h,onChange:U=>A(U.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn btn-secondary",onClick:L,disabled:a,children:"Refresh"})})]}),e.jsxs("form",{onSubmit:async U=>{var H,q;U.preventDefault();try{await ee.post("/finance/currency-rates",{fromCurrencyId:Number(f),toCurrencyId:Number(v),rate:Number(y),rateDate:N||void 0}),nt.success("Rate added"),g(""),b(""),j(""),S(""),L()}catch(V){nt.error(((q=(H=V==null?void 0:V.response)==null?void 0:H.data)==null?void 0:q.message)||"Failed to add currency rate")}},className:"grid grid-cols-1 md:grid-cols-6 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From *"}),e.jsxs("select",{className:"input",value:f,onChange:U=>g(U.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(U=>e.jsxs("option",{value:U.id,children:[U.code," - ",U.name]},`n-f-${U.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To *"}),e.jsxs("select",{className:"input",value:v,onChange:U=>b(U.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(U=>e.jsxs("option",{value:U.id,children:[U.code," - ",U.name]},`n-t-${U.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate *"}),e.jsx("input",{className:"input",type:"number",step:"0.000001",min:"0",value:y,onChange:U=>j(U.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective Date"}),e.jsx("input",{className:"input",type:"date",value:N,onChange:U=>S(U.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add Rate"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Date"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[s.map(U=>{const H=B[U.id]||{},q=!!B[U.id];return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:U.from_code}),e.jsx("td",{children:U.to_code}),e.jsx("td",{children:q?e.jsx("input",{className:"input",type:"number",step:"0.000001",min:"0",value:H.rate===void 0?U.rate:H.rate,onChange:V=>P(M=>({...M,[U.id]:{...M[U.id]||{},rate:V.target.value}}))}):Number(U.rate).toFixed(6)}),e.jsx("td",{children:q?e.jsx("input",{className:"input",type:"date",value:H.rate_date===void 0?U.rate_date?String(U.rate_date).slice(0,10):"":H.rate_date,onChange:V=>P(M=>({...M,[U.id]:{...M[U.id]||{},rate_date:V.target.value}}))}):U.rate_date?String(U.rate_date).slice(0,10):""}),e.jsx("td",{className:"text-right",children:q?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:async()=>{var V,M;try{await ee.put(`/finance/currency-rates/${U.id}`,{rate:H.rate===""||H.rate===null?void 0:Number(H.rate),rateDate:H.rate_date||void 0}),nt.success("Rate updated"),P(z=>{const I={...z};return delete I[U.id],I}),L()}catch(z){nt.error(((M=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:M.message)||"Failed to update rate")}},children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>P(V=>{const M={...V};return delete M[U.id],M}),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>P(V=>({...V,[U.id]:{rate:U.rate,rate_date:String(U.rate_date).slice(0,10)}})),children:"Edit"}),e.jsx("button",{className:"btn",onClick:async()=>{var V,M;if(window.confirm("Delete this rate?"))try{await ee.delete(`/finance/currency-rates/${U.id}`),nt.success("Rate deleted"),P(z=>{const I={...z};return delete I[U.id],I}),L()}catch(z){nt.error(((M=(V=z==null?void 0:z.response)==null?void 0:V.data)==null?void 0:M.message)||"Failed to delete rate")}},children:"Delete"})]})})]},U.id)}),s.length===0&&!a&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-6 text-slate-600",children:"No rates found"})})]})]})})]})}function WJ(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(!0);async function A(){var b,y,j;try{a(!0);const N=await ee.get("/finance/fiscal-years");s(((b=N.data)==null?void 0:b.items)||[])}catch(N){nt.error(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Failed to load fiscal years")}finally{a(!1)}}x.useEffect(()=>{A()},[]);async function f(b){var y,j;b.preventDefault();try{await ee.post("/finance/fiscal-years",{code:n.trim(),startDate:l,endDate:u,isOpen:c}),nt.success("Fiscal year created"),i(""),o(""),d(""),h(!0),A()}catch(N){nt.error(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Failed to create fiscal year")}}async function g(b){var y,j;try{await ee.post(`/finance/fiscal-years/${b}/open`),nt.success("Fiscal year opened"),A()}catch(N){nt.error(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Failed to open fiscal year")}}async function v(b){var y,j;try{await ee.post(`/finance/fiscal-years/${b}/close`),nt.success("Fiscal year closed"),A()}catch(N){nt.error(((j=(y=N==null?void 0:N.response)==null?void 0:y.data)==null?void 0:j.message)||"Failed to close fiscal year")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Fiscal Years"}),e.jsx("p",{className:"text-sm mt-1",children:"Open and close fiscal periods, manage reporting ranges"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",onClick:A,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:f,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:n,onChange:b=>i(b.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date *"}),e.jsx("input",{className:"input",type:"date",value:l,onChange:b=>o(b.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date *"}),e.jsx("input",{className:"input",type:"date",value:u,onChange:b=>d(b.target.value),required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:b=>h(b.target.checked)}),"Set Open"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(b=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:b.code}),e.jsx("td",{children:b.start_date?String(b.start_date).split("T")[0]:""}),e.jsx("td",{children:b.end_date?String(b.end_date).split("T")[0]:""}),e.jsx("td",{children:b.is_open?e.jsx("span",{className:"badge badge-success",children:"Open"}):e.jsx("span",{className:"badge badge-error",children:"Closed"})}),e.jsx("td",{className:"text-right",children:e.jsx("div",{className:"flex justify-end gap-2",children:b.is_open?e.jsx("button",{className:"btn",onClick:()=>v(b.id),children:"Close"}):e.jsx("button",{className:"btn",onClick:()=>g(b.id),children:"Open"})})})]},b.id))})]})})})})]})}function GJ(){const[t,s]=x.useState([]),[r,a]=x.useState([]),[n,i]=x.useState(!0),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState("");async function g(){var y,j,N,S;try{i(!0);const[B,P]=await Promise.all([ee.get("/finance/bank-accounts"),ee.get("/finance/bank-reconciliations")]);s(((y=B.data)==null?void 0:y.items)||[]),a(((j=P.data)==null?void 0:j.items)||[])}catch(B){nt.error(((S=(N=B==null?void 0:B.response)==null?void 0:N.data)==null?void 0:S.message)||"Failed to load bank accounts / reconciliations")}finally{i(!1)}}x.useEffect(()=>{g()},[]);async function v(y){var j,N;if(y.preventDefault(),u&&c){const S=new Date(u),B=new Date(c);if(S>B){nt.error("Statement From must be before or equal to Statement To");return}}try{await ee.post("/finance/bank-reconciliations",{bankAccountId:Number(l),statementFrom:u,statementTo:c,statementEndingBalance:A?Number(A):void 0}),nt.success("Reconciliation created"),o(""),d(""),h(""),f(""),g()}catch(S){nt.error(((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to create reconciliation")}}async function b(y){var j,N;if(y.status!=="COMPLETED"&&window.confirm("Mark this reconciliation as COMPLETED?"))try{await ee.post(`/finance/bank-reconciliations/${y.id}/complete`),nt.success("Reconciliation completed"),g()}catch(S){nt.error(((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to complete reconciliation")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Bank Reconciliation"}),e.jsx("p",{className:"text-sm mt-1",children:"Create and manage bank reconciliations"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",disabled:n,onClick:g,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:v,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Bank Account *"}),e.jsxs("select",{className:"input",value:l,onChange:y=>o(y.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),t.map(y=>e.jsxs("option",{value:y.id,children:[y.name," (",y.account_number||"No Acc",")"]},y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement From *"}),e.jsx("input",{className:"input",type:"date",value:u,onChange:y=>d(y.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement To *"}),e.jsx("input",{className:"input",type:"date",value:c,onChange:y=>h(y.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Ending Balance"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:A,onChange:y=>f(y.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Create"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Bank"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{className:"text-right",children:"Ending Balance"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[r.map(y=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:y.bank_account_name}),e.jsx("td",{children:String(y.statement_from).slice(0,10)}),e.jsx("td",{children:String(y.statement_to).slice(0,10)}),e.jsx("td",{className:"text-right",children:Number(y.statement_ending_balance||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:y.status==="COMPLETED"?e.jsx("span",{className:"badge badge-success",children:"Completed"}):e.jsx("span",{className:"badge badge-info",children:"Draft"})}),e.jsx("td",{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(Le,{to:`/finance/bank-reconciliation/${y.id}`,className:"btn btn-secondary",children:"Open"}),y.status!=="COMPLETED"&&e.jsx("button",{className:"btn",onClick:()=>b(y),children:"Complete"})]})})]},y.id)),r.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-6 text-slate-600",children:"No reconciliations found"})})]})]})})})})]})}function KJ(){var C,E;const{id:t}=Ls();ys();const[s,r]=x.useState(!0),[a,n]=x.useState(null),[i,l]=x.useState([]),[o,u]=x.useState({}),[d,c]=x.useState({voucherId:"",statementDate:"",description:"",amount:"",cleared:!1}),[h,A]=x.useState({}),[f,g]=x.useState([]),[v,b]=x.useState(""),[y,j]=x.useState(!1),[N,S]=x.useState(null),[B,P]=x.useState([]),[L,U]=x.useState(!1),[H,q]=x.useState({date:"",description:"",amount:"",cleared:"",voucher_no:""}),[V,M]=x.useState(null);async function z(){var w,O,R,X;try{r(!0);const ne=await ee.get(`/finance/bank-reconciliations/${t}`);n(((w=ne.data)==null?void 0:w.header)||null),l(((O=ne.data)==null?void 0:O.lines)||[]),u({}),A({});try{const te=await ee.get(`/finance/bank-reconciliations/${t}/summary`);M(te.data||null)}catch{M(null)}}catch(ne){nt.error(((X=(R=ne==null?void 0:ne.response)==null?void 0:R.data)==null?void 0:X.message)||"Failed to load reconciliation")}finally{r(!1)}}x.useEffect(()=>{z()},[t]),x.useEffect(()=>{(async()=>{var w;try{const O=await ee.get("/finance/vouchers");g(((w=O.data)==null?void 0:w.items)||[])}catch{}})()},[]);async function I(){var R,X;const w=o.statement_from||(a==null?void 0:a.statement_from),O=o.statement_to||(a==null?void 0:a.statement_to);if(w&&O){const ne=new Date(w),te=new Date(O);if(ne>te){nt.error("Statement From must be before or equal to Statement To");return}}try{await ee.put(`/finance/bank-reconciliations/${t}`,{statementFrom:o.statement_from||void 0,statementTo:o.statement_to||void 0,statementEndingBalance:o.statement_ending_balance===""||o.statement_ending_balance===null?void 0:Number(o.statement_ending_balance),status:o.status||void 0}),nt.success("Header updated"),z()}catch(ne){nt.error(((X=(R=ne==null?void 0:ne.response)==null?void 0:R.data)==null?void 0:X.message)||"Failed to update header")}}async function G(w){var O,R;if(w.preventDefault(),!d.statementDate){nt.error("Statement Date is required");return}if(!d.amount||Number(d.amount)===0){nt.error("Amount must be non-zero");return}if(a!=null&&a.statement_from&&(a!=null&&a.statement_to)){const X=new Date(d.statementDate),ne=new Date(a.statement_from),te=new Date(a.statement_to);if(X<ne||X>te){nt.error("Line date must be within reconciliation date range");return}}try{await ee.post(`/finance/bank-reconciliations/${t}/lines`,{voucherId:d.voucherId?Number(d.voucherId):void 0,statementDate:d.statementDate,description:d.description||void 0,amount:Number(d.amount),cleared:d.cleared?1:0}),nt.success("Line added"),c({voucherId:"",statementDate:"",description:"",amount:"",cleared:!1}),z()}catch(X){nt.error(((R=(O=X==null?void 0:X.response)==null?void 0:O.data)==null?void 0:R.message)||"Failed to add line")}}async function Y(w){var R,X;const O=h[w.id]||{};if(O.amount!==void 0&&(O.amount===""||Number(O.amount)===0)){nt.error("Amount must be non-zero");return}if(O.statement_date){const ne=new Date(O.statement_date),te=new Date(a.statement_from),oe=new Date(a.statement_to);if(ne<te||ne>oe){nt.error("Line date must be within reconciliation date range");return}}try{await ee.put(`/finance/bank-reconciliation-lines/${w.id}`,{voucherId:O.voucher_id===void 0?void 0:Number(O.voucher_id||0),statementDate:O.statement_date||void 0,description:O.description||void 0,amount:O.amount===void 0||O.amount===""?void 0:Number(O.amount),cleared:O.cleared===void 0?void 0:O.cleared?1:0}),nt.success("Line updated"),A(ne=>{const te={...ne};return delete te[w.id],te}),z()}catch(ne){nt.error(((X=(R=ne==null?void 0:ne.response)==null?void 0:R.data)==null?void 0:X.message)||"Failed to update line")}}async function J(w){var O,R;if(window.confirm("Delete this line?"))try{await ee.delete(`/finance/bank-reconciliation-lines/${w.id}`),nt.success("Line deleted"),A(X=>{const ne={...X};return delete ne[w.id],ne}),z()}catch(X){nt.error(((R=(O=X==null?void 0:X.response)==null?void 0:O.data)==null?void 0:R.message)||"Failed to delete line")}}async function T(w){var O,R,X,ne;if(w.preventDefault(),!N){nt.error("Choose a CSV or XLSX file");return}try{j(!0);const te=new FormData;if(te.append("file",N),L){const de={};H.date&&(de.date=H.date),H.description&&(de.description=H.description),H.amount&&(de.amount=H.amount),H.cleared&&(de.cleared=H.cleared),H.voucher_no&&(de.voucher_no=H.voucher_no),te.append("mapping",JSON.stringify(de))}const oe=await ee.post(`/finance/bank-reconciliations/${t}/lines/import`,te,{headers:{"Content-Type":"multipart/form-data"}}),ce=((O=oe.data)==null?void 0:O.insertedCount)||0,re=((R=oe.data)==null?void 0:R.skippedCount)||0;nt.success(`Imported ${ce} lines, skipped ${re}`),S(null),z()}catch(te){nt.error(((ne=(X=te==null?void 0:te.response)==null?void 0:X.data)==null?void 0:ne.message)||"Failed to import lines")}finally{j(!1)}}async function k(w){try{const O=await ee.get(`/finance/bank-reconciliations/lines/import-template?format=${w}`,{responseType:"blob"}),R=new Blob([O.data],{type:w==="xlsx"?"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"text/csv"}),X=URL.createObjectURL(R),ne=document.createElement("a");ne.href=X,ne.download=w==="xlsx"?"reconciliation_import_template.xlsx":"reconciliation_import_template.csv",document.body.appendChild(ne),ne.click(),ne.remove(),URL.revokeObjectURL(X)}catch{nt.error("Failed to download template")}}function D(w){if(S(w),P([]),!w)return;const O=new FileReader;O.onload=()=>{try{const R=v0(O.result,{type:"binary"}),X=R.Sheets[R.SheetNames[0]],ne=is.sheet_to_json(X,{header:1}),oe=(Array.isArray(ne==null?void 0:ne[0])?ne[0]:[]).map(ce=>String(ce||"").trim()).filter(ce=>ce.length>0);P(oe)}catch{}},O.readAsBinaryString(w)}if(!a&&!s)return e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Reconciliation Not Found"})}),e.jsx("div",{className:"card-body",children:e.jsx(Le,{to:"/finance/bank-reconciliation",className:"btn",children:"Back to List"})})]})});const Q=V?{cleared:Number(V.clearedTotal||0),uncleared:Number(V.unclearedTotal||0),ending:Number(V.statementEndingBalance||0),openingBook:Number(V.openingBookBalance||0),periodMovement:Number(V.periodBookMovement||0),endingBook:Number(V.endingBookBalance||0),diffBankVsCleared:Number(V.diffBankVsCleared||0),diffBankVsBook:Number(V.diffBankVsBook||0),outstandingEstimate:Number(V.outstandingEstimate||0)}:{cleared:i.filter(w=>Number(w.cleared)).reduce((w,O)=>w+Number(O.amount||0),0),uncleared:i.filter(w=>!Number(w.cleared)).reduce((w,O)=>w+Number(O.amount||0),0),ending:Number((a==null?void 0:a.statement_ending_balance)||0),openingBook:0,periodMovement:0,endingBook:0,diffBankVsCleared:Number((a==null?void 0:a.statement_ending_balance)||0)-i.filter(w=>Number(w.cleared)).reduce((w,O)=>w+Number(O.amount||0),0),diffBankVsBook:0,outstandingEstimate:0};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Bank Reconciliation Details"}),e.jsxs("p",{className:"text-sm mt-1",children:[a==null?void 0:a.bank_account_name," ",a!=null&&a.account_number?`(${a.account_number})`:""]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/finance/bank-reconciliation",className:"btn btn-secondary",children:"Back to List"}),e.jsx("button",{className:"btn btn-secondary",disabled:s,onClick:z,children:"Refresh"})]})]})}),a&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement From"}),e.jsx("input",{className:"input",type:"date",value:o.statement_from===void 0?(C=a.statement_from)==null?void 0:C.slice(0,10):o.statement_from,onChange:w=>u(O=>({...O,statement_from:w.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement To"}),e.jsx("input",{className:"input",type:"date",value:o.statement_to===void 0?(E=a.statement_to)==null?void 0:E.slice(0,10):o.statement_to,onChange:w=>u(O=>({...O,statement_to:w.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Ending Balance"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:o.statement_ending_balance===void 0?a.statement_ending_balance??"":o.statement_ending_balance,onChange:w=>u(O=>({...O,statement_ending_balance:w.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status===void 0?a.status:o.status,onChange:w=>u(O=>({...O,status:w.target.value})),children:[e.jsx("option",{value:"DRAFT",children:"Draft"}),e.jsx("option",{value:"COMPLETED",children:"Completed"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",onClick:I,children:"Save Header"})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Cleared Total"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.cleared.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Uncleared Total"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.uncleared.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Statement Ending Balance"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.ending.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Diff (Ending  Cleared)"}),e.jsx("div",{className:`text-xl font-semibold ${Q.diffBankVsCleared===0?"text-green-600":"text-red-600"}`,children:Q.diffBankVsCleared.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Book Opening"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.openingBook.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Book Movement"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.periodMovement.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Book Ending"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.endingBook.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Diff (Ending  Book)"}),e.jsx("div",{className:`text-xl font-semibold ${Q.diffBankVsBook===0?"text-green-600":"text-red-600"}`,children:Q.diffBankVsBook.toLocaleString("en-US",{minimumFractionDigits:2})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"label",children:"Outstanding Estimate (Book  Cleared)"}),e.jsx("div",{className:"text-xl font-semibold",children:Q.outstandingEstimate.toLocaleString("en-US",{minimumFractionDigits:2})})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Statement Lines"}),e.jsx("p",{className:"text-sm",children:"Add bank statement lines and mark cleared"})]})})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("form",{onSubmit:T,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"label",children:"Import Lines (CSV/XLSX)"}),e.jsx("input",{className:"input",type:"file",accept:".csv,.xlsx",onChange:w=>{var O;return D(((O=w.target.files)==null?void 0:O[0])||null)}})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-secondary",disabled:y,children:y?"Importing...":"Import"})}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn",onClick:()=>k("csv"),children:"Download CSV Template"}),e.jsx("button",{type:"button",className:"btn",onClick:()=>k("xlsx"),children:"Download XLSX Template"})]}),e.jsxs("div",{className:"md:col-span-6",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:L,onChange:w=>U(w.target.checked)}),"Advanced Mapping"]}),L&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date Column"}),e.jsxs("select",{className:"input",value:H.date,onChange:w=>q(O=>({...O,date:w.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),B.map(w=>e.jsx("option",{value:w,children:w},`date-${w}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description Column"}),e.jsxs("select",{className:"input",value:H.description,onChange:w=>q(O=>({...O,description:w.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),B.map(w=>e.jsx("option",{value:w,children:w},`desc-${w}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount Column"}),e.jsxs("select",{className:"input",value:H.amount,onChange:w=>q(O=>({...O,amount:w.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),B.map(w=>e.jsx("option",{value:w,children:w},`amt-${w}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cleared Column"}),e.jsxs("select",{className:"input",value:H.cleared,onChange:w=>q(O=>({...O,cleared:w.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),B.map(w=>e.jsx("option",{value:w,children:w},`clr-${w}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher No. Column"}),e.jsxs("select",{className:"input",value:H.voucher_no,onChange:w=>q(O=>({...O,voucher_no:w.target.value})),children:[e.jsx("option",{value:"",children:"Auto"}),B.map(w=>e.jsx("option",{value:w,children:w},`vno-${w}`))]})]})]})]})]}),e.jsxs("form",{onSubmit:G,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher (optional)"}),e.jsx("input",{className:"input mb-2",placeholder:"Search voucher no.",value:v,onChange:w=>b(w.target.value)}),e.jsxs("select",{className:"input",value:d.voucherId,onChange:w=>c(O=>({...O,voucherId:w.target.value})),children:[e.jsx("option",{value:"",children:"None"}),(v?f.filter(w=>String(w.voucher_no||"").toLowerCase().includes(v.toLowerCase())):f).slice(0,50).map(w=>e.jsxs("option",{value:w.id,children:[w.voucher_no," (",w.voucher_type_code,") -"," ",String(w.voucher_date).slice(0,10)]},w.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Statement Date *"}),e.jsx("input",{className:"input",type:"date",value:d.statementDate,onChange:w=>c(O=>({...O,statementDate:w.target.value})),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:d.description,onChange:w=>c(O=>({...O,description:w.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount *"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:d.amount,onChange:w=>c(O=>({...O,amount:w.target.value})),required:!0})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:d.cleared,onChange:w=>c(O=>({...O,cleared:w.target.checked}))}),"Cleared"]})}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add Line"})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Voucher"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Description"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[i.map(w=>{var X;const O=h[w.id]||{},R=!!h[w.id];return e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:R?e.jsx("input",{className:"input",type:"number",min:"0",value:O.voucher_id===void 0?w.voucher_id??"":O.voucher_id,onChange:ne=>A(te=>({...te,[w.id]:{...te[w.id]||{},voucher_id:ne.target.value}}))}):w.voucher_no?`${w.voucher_no}`:""}),e.jsx("td",{children:R?e.jsx("input",{className:"input",type:"date",value:O.statement_date===void 0?(X=w.statement_date)==null?void 0:X.slice(0,10):O.statement_date,onChange:ne=>A(te=>({...te,[w.id]:{...te[w.id]||{},statement_date:ne.target.value}}))}):String(w.statement_date).slice(0,10)}),e.jsx("td",{children:R?e.jsx("input",{className:"input",value:O.description===void 0?w.description??"":O.description,onChange:ne=>A(te=>({...te,[w.id]:{...te[w.id]||{},description:ne.target.value}}))}):w.description}),e.jsx("td",{className:"text-right",children:R?e.jsx("input",{className:"input",type:"number",step:"0.01",value:O.amount===void 0?w.amount??"":O.amount,onChange:ne=>A(te=>({...te,[w.id]:{...te[w.id]||{},amount:ne.target.value}}))}):Number(w.amount||0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{children:R?e.jsxs("select",{className:"input",value:O.cleared??w.cleared?"1":"0",onChange:ne=>A(te=>({...te,[w.id]:{...te[w.id]||{},cleared:ne.target.value==="1"}})),children:[e.jsx("option",{value:"1",children:"Cleared"}),e.jsx("option",{value:"0",children:"Uncleared"})]}):w.cleared?e.jsx("span",{className:"badge badge-success",children:"Cleared"}):e.jsx("span",{className:"badge badge-error",children:"Uncleared"})}),e.jsx("td",{className:"text-right",children:R?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn-success",onClick:()=>Y(w),children:"Save"}),e.jsx("button",{className:"btn",onClick:()=>A(ne=>{const te={...ne};return delete te[w.id],te}),children:"Cancel"})]}):e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>A(ne=>({...ne,[w.id]:{voucher_id:w.voucher_id,statement_date:String(w.statement_date).slice(0,10),description:w.description,amount:w.amount,cleared:!!w.cleared}})),children:"Edit"}),e.jsx("button",{className:"btn",onClick:()=>J(w),children:"Delete"})]})})]},w.id)}),i.length===0&&!s&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-6 text-slate-600",children:"No lines yet"})})]})]})})]})]})]})}function zJ(){const[t,s]=x.useState([]),[r,a]=x.useState([]),[n,i]=x.useState(!0),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState(""),[g,v]=x.useState(""),[b,y]=x.useState([]),[j,N]=x.useState("");async function S(){var U,H,q,V;try{i(!0);const[M,z]=await Promise.all([ee.get("/finance/pdc-postings"),ee.get("/finance/bank-accounts")]);let I=((U=M.data)==null?void 0:U.items)||[];l&&(I=I.filter(G=>G.status===l)),s(I),a(((H=z.data)==null?void 0:H.items)||[])}catch(M){nt.error(((V=(q=M==null?void 0:M.response)==null?void 0:q.data)==null?void 0:V.message)||"Failed to load PDCs")}finally{i(!1)}}x.useEffect(()=>{S()},[l]),x.useEffect(()=>{(async()=>{var U;try{const H=await ee.get("/finance/vouchers");y(((U=H.data)==null?void 0:U.items)||[])}catch{}})()},[]);async function B(U){var q,V;if(U.preventDefault(),!u){nt.error("Voucher ID is required");return}if(!c.trim()){nt.error("Instrument No. is required");return}if(!A){nt.error("Instrument Date is required");return}const H=b.find(M=>Number(M.id)===Number(u));if(H){const M=new Date(A),z=new Date(H.voucher_date);if(M<z){nt.error("Instrument Date must be on or after voucher date");return}}try{await ee.post("/finance/pdc-postings",{voucherId:Number(u),instrumentNo:c.trim(),instrumentDate:A,bankAccountId:g?Number(g):void 0}),nt.success("PDC created"),d(""),h(""),f(""),v(""),S()}catch(M){nt.error(((V=(q=M==null?void 0:M.response)==null?void 0:q.data)==null?void 0:V.message)||"Failed to create PDC")}}async function P(U,H){var q,V;if(window.confirm(`Change status to ${H}?`))try{await ee.put(`/finance/pdc-postings/${U.id}`,{status:H}),nt.success("Status updated"),S()}catch(M){nt.error(((V=(q=M==null?void 0:M.response)==null?void 0:q.data)==null?void 0:V.message)||"Failed to update status")}}async function L(U){var H,q;if(window.confirm("Delete this PDC?"))try{await ee.delete(`/finance/pdc-postings/${U.id}`),nt.success("PDC deleted"),S()}catch(V){nt.error(((q=(H=V==null?void 0:V.response)==null?void 0:H.data)==null?void 0:q.message)||"Failed to delete PDC")}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Post-Dated Cheques (PDC)"}),e.jsx("p",{className:"text-sm mt-1",children:"Register and manage PDC postings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx("button",{className:"btn btn-secondary",disabled:n,onClick:S,children:"Refresh"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:B,className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher *"}),e.jsx("input",{className:"input mb-2",placeholder:"Search voucher no.",value:j,onChange:U=>N(U.target.value)}),e.jsxs("select",{className:"input",value:u,onChange:U=>d(U.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select"}),(j?b.filter(U=>String(U.voucher_no||"").toLowerCase().includes(j.toLowerCase())):b).slice(0,50).map(U=>e.jsxs("option",{value:U.id,children:[U.voucher_no," (",U.voucher_type_code,") -"," ",String(U.voucher_date).slice(0,10)]},U.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Instrument No. *"}),e.jsx("input",{className:"input",value:c,onChange:U=>h(U.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Instrument Date *"}),e.jsx("input",{className:"input",type:"date",value:A,onChange:U=>f(U.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:g,onChange:U=>v(U.target.value),children:[e.jsx("option",{value:"",children:"Select"}),r.map(U=>e.jsxs("option",{value:U.id,children:[U.name," (",U.account_number||"No Acc",")"]},U.id))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",children:"Add PDC"})})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:l,onChange:U=>o(U.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"HELD",children:"Held"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Instrument No."}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Voucher"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsxs("tbody",{children:[t.map(U=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:U.instrument_no}),e.jsx("td",{children:String(U.instrument_date).slice(0,10)}),e.jsx("td",{children:U.voucher_no}),e.jsx("td",{children:e.jsx("span",{className:"badge",children:U.status})}),e.jsx("td",{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(Le,{to:`/finance/pdc-postings/${U.id}`,className:"btn btn-secondary",children:"Edit"}),U.status==="HELD"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn",onClick:()=>P(U,"POSTED"),children:"Post"}),e.jsx("button",{className:"btn",onClick:()=>P(U,"CANCELLED"),children:"Cancel"}),e.jsx("button",{className:"btn",onClick:()=>L(U),children:"Delete"})]})]})})]},U.id)),t.length===0&&!n&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-6 text-slate-600",children:"No PDCs found"})})]})]})})]})})]})}function YJ(){var v;const{id:t}=Ls(),[s,r]=x.useState(!0),[a,n]=x.useState(null),[i,l]=x.useState([]),[o,u]=x.useState({}),[d,c]=x.useState([]),[h,A]=x.useState("");async function f(){var b,y,j,N;try{r(!0);const[S,B]=await Promise.all([ee.get("/finance/pdc-postings"),ee.get("/finance/bank-accounts")]),P=(((b=S.data)==null?void 0:b.items)||[]).find(L=>Number(L.id)===Number(t));n(P||null),u({}),l(((y=B.data)==null?void 0:y.items)||[])}catch(S){nt.error(((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to load PDC")}finally{r(!1)}}x.useEffect(()=>{f()},[t]),x.useEffect(()=>{(async()=>{var b;try{const y=await ee.get("/finance/vouchers");c(((b=y.data)==null?void 0:b.items)||[])}catch{}})()},[]);async function g(){var j,N;if(o.instrument_date!==void 0&&!String(o.instrument_date).trim()||!(a!=null&&a.instrument_date)&&o.instrument_date===void 0){nt.error("Instrument Date is required");return}const b=o.voucher_id===void 0||o.voucher_id===""?a==null?void 0:a.voucher_id:Number(o.voucher_id),y=o.instrument_date===void 0||!String(o.instrument_date).trim()?a==null?void 0:a.instrument_date:o.instrument_date;if(b&&y){const S=d.find(B=>Number(B.id)===Number(b));if(S){const B=new Date(y),P=new Date(S.voucher_date);if(B<P){nt.error("Instrument Date must be on or after voucher date");return}}}try{await ee.put(`/finance/pdc-postings/${t}`,{voucherId:o.voucher_id===void 0?void 0:Number(o.voucher_id),instrumentNo:o.instrument_no||void 0,instrumentDate:o.instrument_date||void 0,bankAccountId:o.bank_account_id===void 0?void 0:o.bank_account_id?Number(o.bank_account_id):null,status:o.status||void 0}),nt.success("PDC updated"),f()}catch(S){nt.error(((N=(j=S==null?void 0:S.response)==null?void 0:j.data)==null?void 0:N.message)||"Failed to update PDC")}}return!a&&!s?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h1",{className:"text-2xl font-bold",children:"PDC Not Found"})}),e.jsx("div",{className:"card-body",children:e.jsx(Le,{to:"/finance/pdc-postings",className:"btn",children:"Back to List"})})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Edit Post-Dated Cheque"}),e.jsx("p",{className:"text-sm mt-1",children:a==null?void 0:a.instrument_no})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/finance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/finance/pdc-postings",className:"btn btn-secondary",children:"Back to List"}),e.jsx("button",{className:"btn btn-secondary",disabled:s,onClick:f,children:"Refresh"})]})]})}),a&&e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher"}),e.jsx("input",{className:"input mb-2",placeholder:"Search voucher no.",value:h,onChange:b=>A(b.target.value)}),e.jsxs("select",{className:"input",value:o.voucher_id===void 0?a.voucher_id??"":o.voucher_id,onChange:b=>u(y=>({...y,voucher_id:b.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),(h?d.filter(b=>String(b.voucher_no||"").toLowerCase().includes(h.toLowerCase())):d).slice(0,50).map(b=>e.jsxs("option",{value:b.id,children:[b.voucher_no," (",b.voucher_type_code,") -"," ",String(b.voucher_date).slice(0,10)]},b.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Instrument No."}),e.jsx("input",{className:"input",value:o.instrument_no===void 0?a.instrument_no??"":o.instrument_no,onChange:b=>u(y=>({...y,instrument_no:b.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Instrument Date"}),e.jsx("input",{className:"input",type:"date",value:o.instrument_date===void 0?(v=a.instrument_date)==null?void 0:v.slice(0,10):o.instrument_date,onChange:b=>u(y=>({...y,instrument_date:b.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:o.bank_account_id===void 0?a.bank_account_id??"":o.bank_account_id,onChange:b=>u(y=>({...y,bank_account_id:b.target.value})),children:[e.jsx("option",{value:"",children:"Select"}),i.map(b=>e.jsxs("option",{value:b.id,children:[b.name," (",b.account_number||"No Acc",")"]},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status===void 0?a.status:o.status,onChange:b=>u(y=>({...y,status:b.target.value})),children:[e.jsx("option",{value:"HELD",children:"Held"}),e.jsx("option",{value:"POSTED",children:"Posted"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"btn-success",onClick:g,children:"Save"})})]})})})]})}function XJ(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(CJ,{})}),e.jsx(Je,{path:"/journal-voucher",element:e.jsx(Wd,{voucherTypeCode:"JV",title:"Journal Entry"})}),e.jsx(Je,{path:"/journal-voucher/create",element:e.jsx(si,{voucherTypeCode:"JV",title:"New Journal Entry"})}),e.jsx(Je,{path:"/journal-voucher/:id",element:e.jsx(si,{voucherTypeCode:"JV",title:"Journal Entry"})}),e.jsx(Je,{path:"/payment-voucher",element:e.jsx(Wd,{voucherTypeCode:"PV",title:"Make Payment"})}),e.jsx(Je,{path:"/payment-voucher/create",element:e.jsx(si,{voucherTypeCode:"PV",title:"Make Payment"})}),e.jsx(Je,{path:"/payment-voucher/:id",element:e.jsx(si,{voucherTypeCode:"PV",title:"Make Payment"})}),e.jsx(Je,{path:"/receipt-voucher",element:e.jsx(Wd,{voucherTypeCode:"RV",title:"Receive Payment"})}),e.jsx(Je,{path:"/receipt-voucher/create",element:e.jsx(si,{voucherTypeCode:"RV",title:"Receive Payment"})}),e.jsx(Je,{path:"/receipt-voucher/:id",element:e.jsx(si,{voucherTypeCode:"RV",title:"Receive Payment"})}),e.jsx(Je,{path:"/contra-voucher",element:e.jsx(Wd,{voucherTypeCode:"CV",title:"Account Transfer"})}),e.jsx(Je,{path:"/contra-voucher/create",element:e.jsx(si,{voucherTypeCode:"CV",title:"Account Transfer"})}),e.jsx(Je,{path:"/contra-voucher/:id",element:e.jsx(si,{voucherTypeCode:"CV",title:"Account Transfer"})}),e.jsx(Je,{path:"/sales-voucher",element:e.jsx(Wd,{voucherTypeCode:"SV",title:"Sales Vouchers"})}),e.jsx(Je,{path:"/sales-voucher/create",element:e.jsx(si,{voucherTypeCode:"SV",title:"New Sales Voucher"})}),e.jsx(Je,{path:"/sales-voucher/:id",element:e.jsx(si,{voucherTypeCode:"SV",title:"Sales Vouchers"})}),e.jsx(Je,{path:"/purchase-voucher",element:e.jsx(Wd,{voucherTypeCode:"PUV",title:"Purchase Vouchers"})}),e.jsx(Je,{path:"/purchase-voucher/create",element:e.jsx(si,{voucherTypeCode:"PUV",title:"New Purchase Voucher"})}),e.jsx(Je,{path:"/purchase-voucher/:id",element:e.jsx(si,{voucherTypeCode:"PUV",title:"Purchase Vouchers"})}),e.jsx(Je,{path:"/debit-note",element:e.jsx(Wd,{voucherTypeCode:"DN",title:"Debit Notes"})}),e.jsx(Je,{path:"/debit-note/create",element:e.jsx(si,{voucherTypeCode:"DN",title:"New Debit Note"})}),e.jsx(Je,{path:"/debit-note/:id",element:e.jsx(si,{voucherTypeCode:"DN",title:"Debit Notes"})}),e.jsx(Je,{path:"/credit-note",element:e.jsx(Wd,{voucherTypeCode:"CN",title:"Credit Notes"})}),e.jsx(Je,{path:"/credit-note/create",element:e.jsx(si,{voucherTypeCode:"CN",title:"New Credit Note"})}),e.jsx(Je,{path:"/credit-note/:id",element:e.jsx(si,{voucherTypeCode:"CN",title:"Credit Notes"})}),e.jsx(Je,{path:"/account-groups",element:e.jsx(HJ,{})}),e.jsx(Je,{path:"/accounts",element:e.jsx(pS,{})}),e.jsx(Je,{path:"/coa",element:e.jsx(pS,{})}),e.jsx(Je,{path:"/tax-codes",element:e.jsx(qJ,{})}),e.jsx(Je,{path:"/currencies",element:e.jsx(VJ,{})}),e.jsx(Je,{path:"/fiscal-years",element:e.jsx(WJ,{})}),e.jsx(Je,{path:"/bank-reconciliation",element:e.jsx(GJ,{})}),e.jsx(Je,{path:"/bank-reconciliation/:id",element:e.jsx(KJ,{})}),e.jsx(Je,{path:"/pdc-postings",element:e.jsx(zJ,{})}),e.jsx(Je,{path:"/pdc-postings/:id",element:e.jsx(YJ,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(fS,{})}),e.jsx(Je,{path:"/reports/voucher-register",element:e.jsx(fS,{})}),e.jsx(Je,{path:"/reports/trial-balance",element:e.jsx(BJ,{})}),e.jsx(Je,{path:"/reports/journals",element:e.jsx(EJ,{})}),e.jsx(Je,{path:"/reports/general-ledger",element:e.jsx(FJ,{})}),e.jsx(Je,{path:"/reports/payment-due",element:e.jsx(DJ,{})}),e.jsx(Je,{path:"/reports/customer-outstanding",element:e.jsx(UJ,{})}),e.jsx(Je,{path:"/reports/audit-trail",element:e.jsx(PJ,{})}),e.jsx(Je,{path:"/reports/debtors-ledger",element:e.jsx(RJ,{})}),e.jsx(Je,{path:"/reports/creditors-ledger",element:e.jsx(OJ,{})}),e.jsx(Je,{path:"/reports/supplier-outstanding",element:e.jsx(QJ,{})}),e.jsx(Je,{path:"/reports/ratio-analysis",element:e.jsx(MJ,{})}),e.jsx(Je,{path:"/reports/profit-and-loss",element:e.jsx(TJ,{})}),e.jsx(Je,{path:"/reports/balance-sheet",element:e.jsx(IJ,{})}),e.jsx(Je,{path:"/reports/cash-flow",element:e.jsx(LJ,{})}),e.jsx(Je,{path:"*",element:e.jsx(Hc,{to:"/finance",replace:!0})})]})}function JJ(){const t=ys(),[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(""),[o,u]=x.useState(""),[d,c]=x.useState("ALL"),[h,A]=x.useState("ALL");x.useEffect(()=>{f()},[]);const f=async()=>{var j,N,S;try{n(!0),l("");const B=await ee.get("/hr/employees");r(Array.isArray((j=B.data)==null?void 0:j.items)?B.data.items:[])}catch(B){l(((S=(N=B==null?void 0:B.response)==null?void 0:N.data)==null?void 0:S.message)||"Error fetching employees"),console.error("Error fetching employees:",B)}finally{n(!1)}},g=j=>j?e.jsx("span",{className:"badge badge-success",children:"ACTIVE"}):e.jsx("span",{className:"badge badge-error",children:"INACTIVE"}),v=j=>{const N={PERMANENT:"badge badge-success",CONTRACT:"badge badge-info",TEMPORARY:"badge badge-warning",INTERN:"badge bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-300"};return e.jsx("span",{className:N[j]||"badge",children:j})},b=s.filter(j=>{const N=String(j.emp_no||"").toLowerCase().includes(o.toLowerCase())||String(j.full_name||"").toLowerCase().includes(o.toLowerCase())||String(j.email||"").toLowerCase().includes(o.toLowerCase()),S=d==="ALL"||(d==="ACTIVE"?j.is_active:!j.is_active),B=h==="ALL"||j.department===h;return N&&S&&B}),y=["ALL",...new Set(s.map(j=>j.department).filter(Boolean))];return a?e.jsx("div",{className:"text-center py-8",children:"Loading employees..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Employee Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage employee records and information"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/employees/new",className:"btn-success",children:"+ New Employee"})]})]})})}),i&&e.jsx("div",{className:"alert alert-error",children:e.jsx("span",{children:i})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search by employee number, name, or email...",className:"input",value:o,onChange:j=>u(j.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsx("select",{className:"input",value:h,onChange:j=>A(j.target.value),children:y.map(j=>e.jsx("option",{value:j,children:j==="ALL"?"All Departments":j},j))})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{className:"input",value:d,onChange:j=>c(j.target.value),children:[e.jsx("option",{value:"ALL",children:"All Status"}),e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-brand"}),e.jsx("p",{className:"mt-2",children:"Loading employees..."})]}):b.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"No employees found."})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Emp No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Designation"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Contact"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b.map(j=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:j.emp_no}),e.jsx("td",{children:j.full_name}),e.jsx("td",{children:j.designation}),e.jsx("td",{children:j.department}),e.jsx("td",{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{children:j.email}),e.jsx("div",{className:"text-slate-500",children:j.contact_no})]})}),e.jsx("td",{children:v(j.employment_type)}),e.jsx("td",{children:g(j.is_active)}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>t(`/human-resources/employees/${j.id}`),className:"text-brand hover:text-brand-600 font-medium text-sm",children:"View"}),e.jsx("button",{onClick:()=>t(`/human-resources/employees/${j.id}`),className:"text-blue-600 hover:text-blue-700 font-medium text-sm",children:"Edit"})]})})]},j.id))})]})})]})})]})}function xS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({emp_no:"",full_name:"",designation:"",department:"",email:"",contact_no:"",employment_type:"PERMANENT",date_joined:new Date().toISOString().split("T")[0],is_active:1});x.useEffect(()=>{r&&d()},[s]);async function d(){var A,f,g;try{n(!0),l("");const v=await ee.get(`/hr/employees/${s}`);(A=v.data)!=null&&A.item&&u(v.data.item)}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error fetching employee")}finally{n(!1)}}function c(A,f){u(g=>({...g,[A]:f}))}async function h(A){var f,g;A.preventDefault(),n(!0),l("");try{r?await ee.put(`/hr/employees/${s}`,o):await ee.post("/hr/employees",o),t("/human-resources/employees")}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error saving employee")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Employee":"New Employee"}),e.jsx("p",{className:"text-sm mt-1",children:"Employee setup and configuration"})]}),e.jsx(Le,{to:"/human-resources/employees",className:"btn-success",children:"Back"})]})})}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee No"}),e.jsx("input",{className:"input",value:o.emp_no,onChange:A=>c("emp_no",A.target.value),placeholder:"Auto-generated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Full Name *"}),e.jsx("input",{className:"input",value:o.full_name,onChange:A=>c("full_name",A.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Designation"}),e.jsx("input",{className:"input",value:o.designation,onChange:A=>c("designation",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsx("input",{className:"input",value:o.department,onChange:A=>c("department",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Email"}),e.jsx("input",{className:"input",type:"email",value:o.email,onChange:A=>c("email",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact No"}),e.jsx("input",{className:"input",value:o.contact_no,onChange:A=>c("contact_no",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employment Type"}),e.jsxs("select",{className:"input",value:o.employment_type,onChange:A=>c("employment_type",A.target.value),children:[e.jsx("option",{value:"PERMANENT",children:"Permanent"}),e.jsx("option",{value:"CONTRACT",children:"Contract"}),e.jsx("option",{value:"TEMPORARY",children:"Temporary"}),e.jsx("option",{value:"INTERN",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date Joined"}),e.jsx("input",{className:"input",type:"date",value:o.date_joined,onChange:A=>c("date_joined",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Active"}),e.jsxs("select",{className:"input",value:String(o.is_active),onChange:A=>c("is_active",Number(A.target.value)),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(Le,{to:"/human-resources/employees",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save Employee"})]})]})})})]})}function ZJ(){const t=[{id:1,code:"ANNUAL",name:"Annual Leave",daysPerYear:21,active:!0},{id:2,code:"SICK",name:"Sick Leave",daysPerYear:10,active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Leave Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure leave types and balances"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/leave-setup/new",className:"btn-success",children:"+ New Leave Type"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Days/Year"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.daysPerYear}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/human-resources/leave-setup/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/human-resources/leave-setup/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})})]})}function gS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({code:"",name:"",daysPerYear:0,active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({code:"ANNUAL",name:"Annual Leave",daysPerYear:21,active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/leave-setup")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Leave Type":"New Leave Type"}),e.jsx("p",{className:"text-sm mt-1",children:"Leave configuration"})]}),e.jsx(Le,{to:"/human-resources/leave-setup",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:i.code,onChange:d=>o("code",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Days per Year"}),e.jsx("input",{className:"input",type:"number",min:"0",value:i.daysPerYear,onChange:d=>o("daysPerYear",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/leave-setup",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function eZ(){const t=[{id:1,code:"DAY",name:"Day Shift",start:"08:00",end:"17:00",active:!0},{id:2,code:"NIGHT",name:"Night Shift",start:"20:00",end:"05:00",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Shift System Setup"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage work shifts"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/shifts/new",className:"btn-success",children:"+ New Shift"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.start}),e.jsx("td",{children:s.end}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Le,{to:`/human-resources/shifts/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})})]})}function vS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({code:"",name:"",start:"08:00",end:"17:00",active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({code:"DAY",name:"Day Shift",start:"08:00",end:"17:00",active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/shifts")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Shift":"New Shift"}),e.jsx("p",{className:"text-sm mt-1",children:"Shift configuration"})]}),e.jsx(Le,{to:"/human-resources/shifts",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code *"}),e.jsx("input",{className:"input",value:i.code,onChange:d=>o("code",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Time"}),e.jsx("input",{className:"input",type:"time",value:i.start,onChange:d=>o("start",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Time"}),e.jsx("input",{className:"input",type:"time",value:i.end,onChange:d=>o("end",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/shifts",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function tZ(){const t=[{id:1,emp:"EMP-001",name:"John Doe",date:"2025-01-02",status:"PRESENT"},{id:2,emp:"EMP-002",name:"Jane Smith",date:"2025-01-02",status:"PRESENT"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Attendance System"}),e.jsx("p",{className:"text-sm mt-1",children:"Track employee attendance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/attendance/new",className:"btn-success",children:"+ New Entry"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Emp No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.emp}),e.jsx("td",{children:s.name}),e.jsx("td",{children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Le,{to:`/human-resources/attendance/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/human-resources/attendance/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})})]})}function bS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({empNo:"",date:new Date().toISOString().split("T")[0],status:"PRESENT"});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({empNo:"EMP-001",date:"2025-01-02",status:"PRESENT"}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/attendance")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Attendance":"New Attendance"}),e.jsx("p",{className:"text-sm mt-1",children:"Attendance entry"})]}),e.jsx(Le,{to:"/human-resources/attendance",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee No *"}),e.jsx("input",{className:"input",value:i.empNo,onChange:d=>o("empNo",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date *"}),e.jsx("input",{className:"input",type:"date",value:i.date,onChange:d=>o("date",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.status,onChange:d=>o("status",d.target.value),children:[e.jsx("option",{value:"PRESENT",children:"Present"}),e.jsx("option",{value:"ABSENT",children:"Absent"}),e.jsx("option",{value:"LEAVE",children:"Leave"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/attendance",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function sZ(){const t=[{id:1,name:"Standard Monthly",currency:"GHS",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Salary Configuration"}),e.jsx("p",{className:"text-sm mt-1",children:"Define salary structures and components"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/salary-config/new",className:"btn-success",children:"+ New Config"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.currency}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Le,{to:`/human-resources/salary-config/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})})]})}function yS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({name:"",currency:"GHS",active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Standard Monthly",currency:"GHS",active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/salary-config")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Salary Config":"New Salary Config"}),e.jsx("p",{className:"text-sm mt-1",children:"Salary config setup"})]}),e.jsx(Le,{to:"/human-resources/salary-config",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Currency"}),e.jsx("input",{className:"input",value:i.currency,onChange:d=>o("currency",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/salary-config",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function rZ(){const t=[{id:1,name:"Income Tax",active:!0},{id:2,name:"Social Security",active:!0},{id:3,name:"Tier 3",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Tax & Deductions"}),e.jsx("p",{className:"text-sm mt-1",children:"Configure payroll deductions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/tax-config/new",className:"btn-success",children:"+ New Config"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsx("td",{children:e.jsx(Le,{to:`/human-resources/tax-config/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})})]})}function jS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({name:"",ratePercent:0,active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Income Tax",ratePercent:0,active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/tax-config")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Tax Config":"New Tax Config"}),e.jsx("p",{className:"text-sm mt-1",children:"Tax and deduction setup"})]}),e.jsx(Le,{to:"/human-resources/tax-config",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Rate (%)"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.ratePercent,onChange:d=>o("ratePercent",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/tax-config",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",type:"submit",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function aZ(){const t=[{id:1,name:"Transport Allowance",amount:200,active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Employee Allowances"}),e.jsx("p",{className:"text-sm mt-1",children:"Allowance setup (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/allowances/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{className:"text-right",children:Number(s.amount).toFixed(2)}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Le,{className:"text-brand hover:text-brand-600 text-sm font-medium",to:`/human-resources/allowances/${s.id}?mode=view`,children:"View"}),e.jsx(Le,{className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",to:`/human-resources/allowances/${s.id}?mode=edit`,children:"Edit"})]})]},s.id))})]})})})]})}function NS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({name:"",amount:0,active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Transport Allowance",amount:200,active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/allowances")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Allowance":"New Allowance"})}),e.jsx(Le,{to:"/human-resources/allowances",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.amount,onChange:d=>o("amount",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{className:"btn-success",to:"/human-resources/allowances",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function nZ(){const t=[{id:1,employee:"John Doe",amount:1e3,balance:600,status:"ACTIVE"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Employee Loans"}),e.jsx("p",{className:"text-sm mt-1",children:"Loan setup and tracking (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/loans/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{className:"text-right",children:"Balance"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.employee}),e.jsx("td",{className:"text-right",children:Number(s.amount).toFixed(2)}),e.jsx("td",{className:"text-right",children:Number(s.balance).toFixed(2)}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Le,{to:`/human-resources/loans/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/human-resources/loans/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function wS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({employee:"",amount:0,status:"ACTIVE"});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({employee:"John Doe",amount:1e3,status:"ACTIVE"}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/loans")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Loan":"New Loan"})}),e.jsx(Le,{to:"/human-resources/loans",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsx("input",{className:"input",value:i.employee,onChange:d=>o("employee",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Amount"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.amount,onChange:d=>o("amount",Number(d.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.status,onChange:d=>o("status",d.target.value),children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"CLOSED",children:"Closed"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/loans",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function iZ(){const[t]=x.useState([{id:1,period:"2025-01",employee:"John Doe",netPay:2500,status:"GENERATED"}]),[s,r]=x.useState({name:"",address:"",logoUrl:""});x.useEffect(()=>{let u=!0;async function d(){var c,h,A;try{const g=(h=(c=(await ee.get("/admin/me")).data)==null?void 0:c.scope)==null?void 0:h.companyId;if(!g)return;const b=((A=(await ee.get(`/admin/companies/${g}`)).data)==null?void 0:A.item)||{},y=b.has_logo===1||b.has_logo===!0?`/api/admin/companies/${g}/logo`:"";if(!u)return;r({name:String(b.name||""),address:String(b.address||""),logoUrl:String(y||"")})}catch{}}return d(),()=>{u=!1}},[]);function a(u){return String(u??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function n(u){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Payslip</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${u||""}</body>
</html>`}async function i(u){var c;const d=Array.from(((c=u==null?void 0:u.querySelectorAll)==null?void 0:c.call(u,"img"))||[]);d.length&&await Promise.all(d.map(h=>new Promise(A=>{if(h.complete)return A();const f=()=>A();h.addEventListener("load",f,{once:!0}),h.addEventListener("error",f,{once:!0})})))}async function l(u){var v;const d=`<div>
  <div style="font-weight:800;font-size:18px;">Payslip</div>
  <div>Period: ${a(String(u.period||""))}</div>
  <div>Employee: ${a(String(u.employee||""))}</div>
  <div>Net Pay: ${a(Number(u.netPay||0).toFixed(2))}</div>
  <div>Status: ${a(String(u.status||""))}</div>
</div>`,c=n(d),h=document.createElement("iframe");h.style.position="fixed",h.style.right="0",h.style.bottom="0",h.style.width="0",h.style.height="0",h.style.border="0",document.body.appendChild(h);const A=((v=h.contentWindow)==null?void 0:v.document)||h.contentDocument||null;if(!A){document.body.removeChild(h);return}A.open(),A.write(c),A.close();const f=h.contentWindow||window;setTimeout(()=>{f.focus();try{f.print()}catch{}setTimeout(()=>{document.body.removeChild(h)},100)},200)}async function o(u){const d=`<div>
  <div style="font-weight:800;font-size:18px;">Payslip</div>
  <div>Period: ${a(String(u.period||""))}</div>
  <div>Employee: ${a(String(u.employee||""))}</div>
  <div>Net Pay: ${a(Number(u.netPay||0).toFixed(2))}</div>
  <div>Status: ${a(String(u.status||""))}</div>
</div>`,c=document.createElement("div");c.style.position="fixed",c.style.left="-10000px",c.style.top="0",c.style.width="794px",c.style.background="white",c.style.padding="32px",c.innerHTML=d,document.body.appendChild(c);try{await i(c);const h=await Ai(c,{scale:2,useCORS:!0}),A=h.toDataURL("image/png"),f=new ds("p","mm","a4"),g=f.internal.pageSize.getWidth(),v=f.internal.pageSize.getHeight(),b=g,y=h.height*b/h.width;let j=0;for(;j<y;)f.addImage(A,"PNG",0,-j,b,y),j+=v,j<y&&f.addPage();const N="Payslip_"+(String(u.period||"").replaceAll(" ","_")||new Date().toISOString().slice(0,10))+".pdf";f.save(N)}finally{document.body.removeChild(c)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Payslips"}),e.jsx("p",{className:"text-sm mt-1",children:"Payslip configuration (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/payslips/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Period"}),e.jsx("th",{children:"Employee"}),e.jsx("th",{className:"text-right",children:"Net Pay"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(u=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:u.period}),e.jsx("td",{children:u.employee}),e.jsx("td",{className:"text-right",children:Number(u.netPay).toFixed(2)}),e.jsx("td",{children:u.status}),e.jsxs("td",{children:[e.jsx(Le,{to:`/human-resources/payslips/${u.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/human-resources/payslips/${u.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"}),e.jsx("button",{type:"button",className:"ml-2 inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",onClick:()=>l(u),children:"Print"}),e.jsx("button",{type:"button",className:"ml-1 inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",onClick:()=>o(u),children:"PDF"})]})]},u.id))})]})})})]})}function ol(t){return String(t??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function lZ(t){return`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Payslip</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; padding: 16px; color: #0f172a; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #e2e8f0; padding: 6px 8px; vertical-align: top; }
      th { background: #f8fafc; text-align: left; }
    </style>
  </head>
  <body>${t||""}</body>
</html>`}async function oZ(t){var r;const s=Array.from(((r=t==null?void 0:t.querySelectorAll)==null?void 0:r.call(t,"img"))||[]);s.length!==0&&await Promise.race([Promise.all(s.map(a=>new Promise(n=>{if(a.complete)return n();const i=()=>n();a.addEventListener("load",i,{once:!0}),a.addEventListener("error",i,{once:!0})}))),new Promise(a=>setTimeout(a,1500))])}function _S(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({period:"",employee:"",netPay:0,status:"GENERATED"}),[o,u]=x.useState({name:"",address:"",logoUrl:""});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({period:"2025-01",employee:"John Doe",netPay:2500,status:"GENERATED"}),n(!1)},150))},[r]),x.useEffect(()=>{let g=!0;async function v(){var b,y,j;try{const S=(y=(b=(await ee.get("/admin/me")).data)==null?void 0:b.scope)==null?void 0:y.companyId;if(!S)return;const P=((j=(await ee.get(`/admin/companies/${S}`)).data)==null?void 0:j.item)||{},L=P.has_logo===1||P.has_logo===!0?`/api/admin/companies/${S}/logo`:"";if(!g)return;u({name:String(P.name||""),address:String(P.address||""),logoUrl:String(L||"")})}catch{}}return v(),()=>{g=!1}},[]);const d=x.useMemo(()=>{const g=String(o.logoUrl||"").trim(),v=g?`<img src="${g}" alt="${ol(o.name||"Company")}" style="max-height:80px;object-fit:contain;" />`:"";return{company:{name:o.name||"OmniSuite Ltd",address:o.address||"123 Business Rd",logoUrl:g,logoHtml:v},payslip:{period:String(i.period||""),employee:String(i.employee||""),netPay:Number(i.netPay||0).toFixed(2),status:String(i.status||"")}}},[i,o]);function c(g,v){l(b=>({...b,[g]:v}))}async function h(){var P;const g=ol(d.company.name),b=`<div style="display:flex;justify-content:space-between;align-items:flex-start;">
  <div>
    ${d.company.logoUrl?`<img src="${d.company.logoUrl}" alt="${g}" style="max-height:80px;object-fit:contain;" />`:""}
    <div style="font-weight:800;font-size:18px;">${g}</div>
    <div style="font-size:12px;color:#475569;">${ol(d.company.address)}</div>
  </div>
  <div style="text-align:right;">
    <div style="font-weight:800;font-size:20px;">PAYSLIP</div>
    <div style="font-size:12px;">Period: ${ol(d.payslip.period)}</div>
  </div>
</div>
<hr />
<div style="font-size:12px;margin-bottom:10px;"><strong>Employee:</strong> ${ol(d.payslip.employee)}</div>
<table style="font-size:12px;">
  <tbody>
    <tr><td>Net Pay</td><td style="text-align:right;">${ol(d.payslip.netPay)}</td></tr>
    <tr><td>Status</td><td style="text-align:right;">${ol(d.payslip.status)}</td></tr>
  </tbody>
</table>`,y=lZ(b),j=document.createElement("iframe");j.style.position="fixed",j.style.right="0",j.style.bottom="0",j.style.width="0",j.style.height="0",j.style.border="0",document.body.appendChild(j);const N=((P=j.contentWindow)==null?void 0:P.document)||j.contentDocument||null;if(!N){document.body.removeChild(j);return}N.open(),N.write(y),N.close();const S=j.contentWindow||window;setTimeout(()=>{S.focus();try{S.print()}catch{}setTimeout(()=>{document.body.removeChild(j)},100)},200)}async function A(){const g=ol(d.company.name),b=`<div style="display:flex;justify-content:space-between;align-items:flex-start;">
  <div>
    ${d.company.logoUrl?`<img src="${d.company.logoUrl}" alt="${g}" style="max-height:80px;object-fit:contain;" />`:""}
    <div style="font-weight:800;font-size:18px;">${g}</div>
    <div style="font-size:12px;color:#475569;">${ol(d.company.address)}</div>
  </div>
  <div style="text-align:right;">
    <div style="font-weight:800;font-size:20px;">PAYSLIP</div>
    <div style="font-size:12px;">Period: ${ol(d.payslip.period)}</div>
  </div>
</div>
<hr />
<div style="font-size:12px;margin-bottom:10px;"><strong>Employee:</strong> ${ol(d.payslip.employee)}</div>
<table style="font-size:12px;">
  <tbody>
    <tr><td>Net Pay</td><td style="text-align:right;">${ol(d.payslip.netPay)}</td></tr>
    <tr><td>Status</td><td style="text-align:right;">${ol(d.payslip.status)}</td></tr>
  </tbody>
</table>`,y=document.createElement("div");y.style.position="fixed",y.style.left="-10000px",y.style.top="0",y.style.width="794px",y.style.background="white",y.style.padding="32px",y.innerHTML=b,document.body.appendChild(y);try{await oZ(y);const j=await Ai(y,{scale:2,useCORS:!0}),N=j.toDataURL("image/png"),S=new ds("p","mm","a4"),B=S.internal.pageSize.getWidth(),P=S.internal.pageSize.getHeight(),L=B,U=j.height*L/j.width;let H=0;for(;H<U;)S.addImage(N,"PNG",0,-H,L,U),H+=P,H<U&&S.addPage();const q="Payslip_"+(d.payslip.period||new Date().toISOString().slice(0,10))+".pdf";S.save(q)}finally{document.body.removeChild(y)}}async function f(g){g.preventDefault(),n(!0);try{t("/human-resources/payslips")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Payslip":"New Payslip"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:h,children:"Print"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:A,children:"Download PDF"}),e.jsx(Le,{to:"/human-resources/payslips",className:"btn-success",children:"Back"})]})]})}),e.jsx("form",{onSubmit:f,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Period *"}),e.jsx("input",{className:"input",value:i.period,onChange:g=>c("period",g.target.value),required:!0,placeholder:"YYYY-MM"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsx("input",{className:"input",value:i.employee,onChange:g=>c("employee",g.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Net Pay"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:i.netPay,onChange:g=>c("netPay",Number(g.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.status,onChange:g=>c("status",g.target.value),children:[e.jsx("option",{value:"GENERATED",children:"Generated"}),e.jsx("option",{value:"PAID",children:"Paid"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/payslips",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function cZ(){const t=[{id:1,employee:"John Doe",effectiveDate:"2025-01-01",from:"Junior",to:"Senior"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Promotions"}),e.jsx("p",{className:"text-sm mt-1",children:"Track employee promotions (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/promotions/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Effective Date"}),e.jsx("th",{children:"From"}),e.jsx("th",{children:"To"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.employee}),e.jsx("td",{children:new Date(s.effectiveDate).toLocaleDateString()}),e.jsx("td",{children:s.from}),e.jsx("td",{children:s.to}),e.jsx("td",{children:e.jsx(Le,{to:`/human-resources/promotions/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function SS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({employee:"",effectiveDate:new Date().toISOString().split("T")[0],from:"",to:""});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({employee:"John Doe",effectiveDate:"2025-01-01",from:"Junior",to:"Senior"}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/promotions")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Promotion":"New Promotion"})}),e.jsx(Le,{to:"/human-resources/promotions",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Employee *"}),e.jsx("input",{className:"input",value:i.employee,onChange:d=>o("employee",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Effective Date"}),e.jsx("input",{className:"input",type:"date",value:i.effectiveDate,onChange:d=>o("effectiveDate",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{className:"input",value:i.from,onChange:d=>o("from",d.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{className:"input",value:i.to,onChange:d=>o("to",d.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/promotions",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function dZ(){const t=[{id:1,provider:"Omni Health",policyName:"Standard Plan",active:!0}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Medical Policies"}),e.jsx("p",{className:"text-sm mt-1",children:"Employee medical policy setup (placeholder)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/human-resources",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/human-resources/medical-policies/new",className:"btn-success",children:"+ New"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Provider"}),e.jsx("th",{children:"Policy"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.provider}),e.jsx("td",{children:s.policyName}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/human-resources/medical-policies/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/human-resources/medical-policies/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function CS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({provider:"",policyName:"",active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({provider:"Omni Health",policyName:"Standard Plan",active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/human-resources/medical-policies")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:r?"Edit Medical Policy":"New Medical Policy"})}),e.jsx(Le,{to:"/human-resources/medical-policies",className:"btn-success",children:"Back"})]})}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Provider *"}),e.jsx("input",{className:"input",value:i.provider,onChange:d=>o("provider",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Policy Name *"}),e.jsx("input",{className:"input",value:i.policyName,onChange:d=>o("policyName",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/human-resources/medical-policies",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function uZ(){const t=[{title:"Attendance Summary",description:"Attendance by date range (placeholder)"},{title:"Payroll Summary",description:"Gross vs deductions (placeholder)"},{title:"Leave Balances",description:"Remaining leave by employee (placeholder)"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"HR Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Attendance, payroll, and leave reports"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function AZ(){const[t,s]=Ts.useState([{icon:"",value:"142",label:"Active Employees",change:"5 new this month",changeType:"positive",path:"/human-resources/employees"},{icon:"",value:"8",label:"On Leave",change:"Today",changeType:"neutral",path:"/human-resources/leave-setup"},{icon:"",value:"Pending",label:"Payroll Status",change:"Due in 3 days",changeType:"negative",path:"/human-resources/payslips"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.hr)==null?void 0:o.employees)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.hr)==null?void 0:c.on_leave)||0),y=String(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.hr)==null?void 0:f.payroll_status)||"").trim();a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:y||N[2].value},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Employee Management",features:[{name:"Employee Setup",path:"/human-resources/employees",description:"Manage employee records and information",icon:""},{name:"Promotions",path:"/human-resources/promotions",description:"Record employee promotions and salary changes",icon:""}]},{title:"Leave & Attendance",features:[{name:"Leave Setup",path:"/human-resources/leave-setup",description:"Configure leave types and employee leave balances",icon:""},{name:"Shift Management",path:"/human-resources/shifts",description:"Setup and manage work shifts",icon:""},{name:"Attendance",path:"/human-resources/attendance",description:"Track employee attendance and check-ins",icon:""}]},{title:"Payroll & Compensation",features:[{name:"Salary Configuration",path:"/human-resources/salary-config",description:"Setup salary components and structures",icon:""},{name:"Tax & Deductions",path:"/human-resources/tax-config",description:"Configure income tax, tier 3, and social security",icon:""},{name:"Employee Allowances",path:"/human-resources/allowances",description:"Manage employee allowances and benefits",icon:""},{name:"Employee Loans",path:"/human-resources/loans",description:"Track and manage employee loans",icon:""},{name:"Payslips",path:"/human-resources/payslips",description:"Generate and manage employee payslips",icon:""}]},{title:"Policies & Reports",features:[{name:"Medical Policies",path:"/human-resources/medical-policies",description:"Setup employee medical insurance policies",icon:""},{name:"HR Reports",path:"/human-resources/reports",description:"View attendance, payroll, and leave reports",icon:""}]}];return e.jsx(Gl,{title:"Human Resources",description:"Employee management and payroll processing",stats:t,sections:r})}function hZ(){return e.jsxs(Ji,{children:[e.jsx(Je,{index:!0,element:e.jsx(AZ,{})}),e.jsx(Je,{path:"employees",element:e.jsx(JJ,{})}),e.jsx(Je,{path:"employees/new",element:e.jsx(xS,{})}),e.jsx(Je,{path:"employees/:id",element:e.jsx(xS,{})}),e.jsx(Je,{path:"leave-setup",element:e.jsx(ZJ,{})}),e.jsx(Je,{path:"leave-setup/new",element:e.jsx(gS,{})}),e.jsx(Je,{path:"leave-setup/:id",element:e.jsx(gS,{})}),e.jsx(Je,{path:"shifts",element:e.jsx(eZ,{})}),e.jsx(Je,{path:"shifts/new",element:e.jsx(vS,{})}),e.jsx(Je,{path:"shifts/:id",element:e.jsx(vS,{})}),e.jsx(Je,{path:"attendance",element:e.jsx(tZ,{})}),e.jsx(Je,{path:"attendance/new",element:e.jsx(bS,{})}),e.jsx(Je,{path:"attendance/:id",element:e.jsx(bS,{})}),e.jsx(Je,{path:"salary-config",element:e.jsx(sZ,{})}),e.jsx(Je,{path:"salary-config/new",element:e.jsx(yS,{})}),e.jsx(Je,{path:"salary-config/:id",element:e.jsx(yS,{})}),e.jsx(Je,{path:"tax-config",element:e.jsx(rZ,{})}),e.jsx(Je,{path:"tax-config/new",element:e.jsx(jS,{})}),e.jsx(Je,{path:"tax-config/:id",element:e.jsx(jS,{})}),e.jsx(Je,{path:"allowances",element:e.jsx(aZ,{})}),e.jsx(Je,{path:"allowances/new",element:e.jsx(NS,{})}),e.jsx(Je,{path:"allowances/:id",element:e.jsx(NS,{})}),e.jsx(Je,{path:"loans",element:e.jsx(nZ,{})}),e.jsx(Je,{path:"loans/new",element:e.jsx(wS,{})}),e.jsx(Je,{path:"loans/:id",element:e.jsx(wS,{})}),e.jsx(Je,{path:"payslips",element:e.jsx(iZ,{})}),e.jsx(Je,{path:"payslips/new",element:e.jsx(_S,{})}),e.jsx(Je,{path:"payslips/:id",element:e.jsx(_S,{})}),e.jsx(Je,{path:"promotions",element:e.jsx(cZ,{})}),e.jsx(Je,{path:"promotions/new",element:e.jsx(SS,{})}),e.jsx(Je,{path:"promotions/:id",element:e.jsx(SS,{})}),e.jsx(Je,{path:"medical-policies",element:e.jsx(dZ,{})}),e.jsx(Je,{path:"medical-policies/new",element:e.jsx(CS,{})}),e.jsx(Je,{path:"medical-policies/:id",element:e.jsx(CS,{})}),e.jsx(Je,{path:"reports",element:e.jsx(uZ,{})}),e.jsx(Je,{path:"*",element:e.jsx(Hc,{to:"/human-resources",replace:!0})})]})}function mZ(){const t=[{id:1,assetNo:"AST-001",name:"Generator",location:"Plant 1",status:"ACTIVE"},{id:2,assetNo:"AST-002",name:"Forklift",location:"Warehouse",status:"ACTIVE"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Assets"}),e.jsx("p",{className:"text-sm mt-1",children:"Register and manage maintainable assets"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/maintenance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/maintenance/assets/new",className:"btn-success",children:"+ New Asset"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Asset No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.assetNo}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.location}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Le,{to:`/maintenance/assets/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/maintenance/assets/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function kS(){const t=ys(),{id:s}=Ls(),r=!!s,{search:a}=ma(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=x.useState(!1),[u,d]=x.useState({assetNo:"",name:"",location:"",status:"ACTIVE"});x.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({assetNo:"AST-001",name:"Generator",location:"Plant 1",status:"ACTIVE"}),o(!1)},150))},[r]);function c(A,f){d(g=>({...g,[A]:f}))}async function h(A){A.preventDefault(),o(!0);try{t("/maintenance/assets")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/maintenance/assets",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Assets"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Asset":r?"Edit Asset":"New Asset"})]}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Asset No"}),e.jsx("input",{className:"input",value:u.assetNo,onChange:A=>c("assetNo",A.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:u.name,onChange:A=>c("name",A.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Location"}),e.jsx("input",{className:"input",value:u.location,onChange:A=>c("location",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.status,onChange:A=>c("status",A.target.value),children:[e.jsx("option",{value:"ACTIVE",children:"Active"}),e.jsx("option",{value:"INACTIVE",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/maintenance/assets",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function fZ(){const t=[{id:1,woNo:"MWO-0001",asset:"AST-001 Generator",priority:"HIGH",status:"OPEN"},{id:2,woNo:"MWO-0002",asset:"AST-002 Forklift",priority:"MEDIUM",status:"IN_PROGRESS"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/maintenance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Maintenance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Maintenance Work Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Corrective and preventive maintenance execution"})]}),e.jsx(Le,{to:"/maintenance/work-orders/new",className:"btn-success",children:"+ New Work Order"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"WO No"}),e.jsx("th",{children:"Asset"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.woNo}),e.jsx("td",{children:s.asset}),e.jsx("td",{children:s.priority}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Le,{to:`/maintenance/work-orders/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/maintenance/work-orders/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function BS(){const t=ys(),{id:s}=Ls(),r=!!s,{search:a}=ma(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState({woNo:"",assetNo:"AST-001",description:"",priority:"MEDIUM",status:"OPEN"});x.useEffect(()=>{r&&A()},[s]);async function A(){var v,b,y;try{o(!0),d("");const j=await ee.get(`/maintenance/work-orders/${s}`);(v=j.data)!=null&&v.item&&h(j.data.item)}catch(j){d(((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.message)||"Error fetching work order")}finally{o(!1)}}function f(v,b){h(y=>({...y,[v]:b}))}async function g(v){var b,y;v.preventDefault(),o(!0),d("");try{r?await ee.put(`/maintenance/work-orders/${s}`,c):await ee.post("/maintenance/work-orders",c),t("/maintenance/work-orders")}catch(j){d(((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.message)||"Error saving work order")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/maintenance/work-orders",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Work Orders"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Work Order":r?"Edit Work Order":"New Work Order"})]}),e.jsx("form",{onSubmit:g,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[u&&e.jsx("div",{className:"alert alert-error mb-4",children:u}),e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"WO No"}),e.jsx("input",{className:"input",value:c.woNo,onChange:v=>f("woNo",v.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Asset No"}),e.jsx("input",{className:"input",value:c.assetNo,onChange:v=>f("assetNo",v.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:c.description,onChange:v=>f("description",v.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Priority"}),e.jsxs("select",{className:"input",value:c.priority,onChange:v=>f("priority",v.target.value),children:[e.jsx("option",{value:"LOW",children:"Low"}),e.jsx("option",{value:"MEDIUM",children:"Medium"}),e.jsx("option",{value:"HIGH",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:c.status,onChange:v=>f("status",v.target.value),children:[e.jsx("option",{value:"OPEN",children:"Open"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"DONE",children:"Done"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/maintenance/work-orders",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function pZ(){const t=[{id:1,code:"PM-001",asset:"AST-001 Generator",frequency:"MONTHLY",active:!0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Preventive Maintenance Schedules"}),e.jsx("p",{className:"text-sm mt-1",children:"Define PM frequency and tasks"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/maintenance",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/maintenance/pm-schedules/new",className:"btn-success",children:"+ New Schedule"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Asset"}),e.jsx("th",{children:"Frequency"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.asset}),e.jsx("td",{children:s.frequency}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/maintenance/pm-schedules/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/maintenance/pm-schedules/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function ES(){const t=ys(),{id:s}=Ls(),r=!!s,{search:a}=ma(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=x.useState(!1),[u,d]=x.useState({code:"",assetNo:"AST-001",frequency:"MONTHLY",active:!0});x.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({code:"PM-001",assetNo:"AST-001",frequency:"MONTHLY",active:!0}),o(!1)},150))},[r]);function c(A,f){d(g=>({...g,[A]:f}))}async function h(A){A.preventDefault(),o(!0);try{t("/maintenance/pm-schedules")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/maintenance/pm-schedules",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to PM Schedules"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Schedule":r?"Edit Schedule":"New Schedule"})]}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code"}),e.jsx("input",{className:"input",value:u.code,onChange:A=>c("code",A.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Asset No"}),e.jsx("input",{className:"input",value:u.assetNo,onChange:A=>c("assetNo",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Frequency"}),e.jsxs("select",{className:"input",value:u.frequency,onChange:A=>c("frequency",A.target.value),children:[e.jsx("option",{value:"DAILY",children:"Daily"}),e.jsx("option",{value:"WEEKLY",children:"Weekly"}),e.jsx("option",{value:"MONTHLY",children:"Monthly"}),e.jsx("option",{value:"QUARTERLY",children:"Quarterly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.active?"1":"0",onChange:A=>c("active",A.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/maintenance/pm-schedules",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function xZ(){const t=[{title:"Work Order Aging",description:"Open work orders by age (placeholder)"},{title:"Asset Downtime",description:"Downtime by asset (placeholder)"},{title:"Preventive Compliance",description:"PM schedules completed vs due (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/maintenance",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Maintenance"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Maintenance Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Asset and maintenance KPIs"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function gZ(){const[t,s]=Ts.useState([{icon:"",value:"8",label:"Open Work Orders",change:"2 critical",changeType:"negative",path:"/maintenance/work-orders"},{icon:"",value:"4",label:"Overdue PMs",change:"Needs attention",changeType:"negative",path:"/maintenance/pm-schedules"},{icon:"",value:"98%",label:"Asset Health",change:" 1% this month",changeType:"positive",path:"/maintenance/assets"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.maintenance)==null?void 0:o.open_work_orders)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.maintenance)==null?void 0:c.overdue_pms)||0),y=Number(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.maintenance)==null?void 0:f.asset_health_percent)||0);a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:`${y}%`},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Master Data",features:[{name:"Assets",path:"/maintenance/assets",description:"Register and manage assets",icon:""},{name:"New Asset",path:"/maintenance/assets/new",description:"Add an asset",icon:""}]},{title:"Execution",features:[{name:"Work Orders",path:"/maintenance/work-orders",description:"Corrective and preventive work orders",icon:""},{name:"New Work Order",path:"/maintenance/work-orders/new",description:"Create a maintenance work order",icon:""}]},{title:"Preventive Maintenance",features:[{name:"PM Schedules",path:"/maintenance/pm-schedules",description:"Define preventive schedules",icon:""},{name:"New Schedule",path:"/maintenance/pm-schedules/new",description:"Create a new PM schedule",icon:""}]},{title:"Reports",features:[{name:"Maintenance Reports",path:"/maintenance/reports",description:"Asset and maintenance KPIs",icon:""}]}];return e.jsx(Gl,{title:"Maintenance",description:"Asset maintenance and work order management",stats:t,sections:r})}function vZ(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(gZ,{})}),e.jsx(Je,{path:"/assets",element:e.jsx(mZ,{})}),e.jsx(Je,{path:"/assets/new",element:e.jsx(kS,{})}),e.jsx(Je,{path:"/assets/:id",element:e.jsx(kS,{})}),e.jsx(Je,{path:"/work-orders",element:e.jsx(fZ,{})}),e.jsx(Je,{path:"/work-orders/new",element:e.jsx(BS,{})}),e.jsx(Je,{path:"/work-orders/:id",element:e.jsx(BS,{})}),e.jsx(Je,{path:"/pm-schedules",element:e.jsx(pZ,{})}),e.jsx(Je,{path:"/pm-schedules/new",element:e.jsx(ES,{})}),e.jsx(Je,{path:"/pm-schedules/:id",element:e.jsx(ES,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(xZ,{})})]})}function bZ(){const t=[{id:1,code:"PRJ-001",name:"ERP Rollout",status:"IN_PROGRESS",budget:5e4},{id:2,code:"PRJ-002",name:"Warehouse Upgrade",status:"PLANNED",budget:2e4}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Projects"}),e.jsx("p",{className:"text-sm mt-1",children:"Project portfolio"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/project-management",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/project-management/projects/new",className:"btn-success",children:"+ New Project"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-right",children:"Budget"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.status}),e.jsx("td",{className:"text-right",children:Number(s.budget).toFixed(2)}),e.jsx("td",{children:e.jsx(Le,{to:`/project-management/projects/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function FS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({code:"",name:"",status:"PLANNED",budget:0,startDate:"",endDate:""});x.useEffect(()=>{r&&d()},[s]);async function d(){var A,f,g;try{n(!0),l("");const v=await ee.get(`/projects/projects/${s}`);(A=v.data)!=null&&A.item&&u(v.data.item)}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error fetching project")}finally{n(!1)}}function c(A,f){u(g=>({...g,[A]:f}))}async function h(A){var f,g;A.preventDefault(),n(!0),l("");try{r?await ee.put(`/projects/projects/${s}`,o):await ee.post("/projects/projects",o),t("/project-management/projects")}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error saving project")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/project-management/projects",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Projects"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:r?"Edit Project":"New Project"})]}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code"}),e.jsx("input",{className:"input",value:o.code,onChange:A=>c("code",A.target.value),placeholder:"Auto"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:o.name,onChange:A=>c("name",A.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status,onChange:A=>c("status",A.target.value),children:[e.jsx("option",{value:"PLANNED",children:"Planned"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"ON_HOLD",children:"On Hold"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Budget"}),e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",value:o.budget,onChange:A=>c("budget",Number(A.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Start Date"}),e.jsx("input",{className:"input",type:"date",value:o.startDate,onChange:A=>c("startDate",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"End Date"}),e.jsx("input",{className:"input",type:"date",value:o.endDate,onChange:A=>c("endDate",A.target.value)})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/project-management/projects",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function yZ(){const t=[{id:1,project:"PRJ-001",title:"Define chart of accounts",assignee:"Finance Team",due:"2025-02-15",status:"IN_PROGRESS"},{id:2,project:"PRJ-001",title:"Migrate opening balances",assignee:"Finance Team",due:"2025-02-28",status:"PLANNED"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Tasks"}),e.jsx("p",{className:"text-sm mt-1",children:"Task tracking across projects"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/project-management",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/project-management/tasks/new",className:"btn-success",children:"+ New Task"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Project"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Assignee"}),e.jsx("th",{children:"Due"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.project}),e.jsx("td",{className:"font-medium",children:s.title}),e.jsx("td",{children:s.assignee}),e.jsx("td",{children:new Date(s.due).toLocaleDateString()}),e.jsx("td",{children:s.status}),e.jsx("td",{children:e.jsx(Le,{to:`/project-management/tasks/${s.id}`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"Edit"})})]},s.id))})]})})})]})}function TS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState(""),[o,u]=x.useState({projectCode:"PRJ-001",title:"",assignee:"",due:"",status:"PLANNED"});x.useEffect(()=>{r&&d()},[s]);async function d(){var A,f,g;try{n(!0),l("");const v=await ee.get(`/projects/tasks/${s}`);(A=v.data)!=null&&A.item&&u(v.data.item)}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error fetching task")}finally{n(!1)}}function c(A,f){u(g=>({...g,[A]:f}))}async function h(A){var f,g;A.preventDefault(),n(!0),l("");try{r?await ee.put(`/projects/tasks/${s}`,o):await ee.post("/projects/tasks",o),t("/project-management/tasks")}catch(v){l(((g=(f=v==null?void 0:v.response)==null?void 0:f.data)==null?void 0:g.message)||"Error saving task")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/project-management/tasks",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Tasks"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:r?"Edit Task":"New Task"})]}),e.jsx("form",{onSubmit:h,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[i&&e.jsx("div",{className:"alert alert-error mb-4",children:i}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Project"}),e.jsx("input",{className:"input",value:o.projectCode,onChange:A=>c("projectCode",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Assignee"}),e.jsx("input",{className:"input",value:o.assignee,onChange:A=>c("assignee",A.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Title *"}),e.jsx("input",{className:"input",value:o.title,onChange:A=>c("title",A.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Due Date"}),e.jsx("input",{className:"input",type:"date",value:o.due,onChange:A=>c("due",A.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:o.status,onChange:A=>c("status",A.target.value),children:[e.jsx("option",{value:"PLANNED",children:"Planned"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"DONE",children:"Done"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/project-management/tasks",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function jZ(){const t=[{title:"Project Status Summary",description:"Planned vs in-progress vs completed (placeholder)"},{title:"Task Due Report",description:"Tasks due by date range (placeholder)"},{title:"Budget vs Actual",description:"Budget utilization (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/project-management",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Project Management"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Project Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Portfolio KPIs and reporting"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function NZ(){const[t,s]=Ts.useState([{icon:"",value:"8",label:"Active Projects",change:"2 due this week",changeType:"neutral",path:"/project-management/projects"},{icon:"",value:"34",label:"Open Tasks",change:"12 high priority",changeType:"negative",path:"/project-management/tasks"},{icon:"",value:"92%",label:"On Time Completion",change:" 3% this month",changeType:"positive",path:"/project-management/reports"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.projects)==null?void 0:o.active_projects)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.projects)==null?void 0:c.open_tasks)||0),y=Number(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.projects)==null?void 0:f.on_time_percent)||0);a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:`${y}%`},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Portfolio",badge:"Planning",items:[{title:"Projects",path:"/project-management/projects",description:"Create and manage projects",icon:"",actions:[{label:"View Projects",path:"/project-management/projects",type:"outline"},{label:"New Project",path:"/project-management/projects/new",type:"primary"}]}]},{title:"Execution",badge:"Tracking",items:[{title:"Tasks",path:"/project-management/tasks",description:"Assign and track tasks",icon:"",actions:[{label:"View Tasks",path:"/project-management/tasks",type:"outline"},{label:"New Task",path:"/project-management/tasks/new",type:"primary"}]}]},{title:"Reports",items:[{title:"Project Reports",path:"/project-management/reports",description:"Project KPIs and status reporting",icon:"",actions:[{label:"View Reports",path:"/project-management/reports",type:"primary"}]}]}];return e.jsx(Gl,{title:"Project Management",description:"Project planning, tracking, and resource allocation",stats:t,sections:r})}function wZ(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(NZ,{})}),e.jsx(Je,{path:"/projects",element:e.jsx(bZ,{})}),e.jsx(Je,{path:"/projects/new",element:e.jsx(FS,{})}),e.jsx(Je,{path:"/projects/:id",element:e.jsx(FS,{})}),e.jsx(Je,{path:"/tasks",element:e.jsx(yZ,{})}),e.jsx(Je,{path:"/tasks/new",element:e.jsx(TS,{})}),e.jsx(Je,{path:"/tasks/:id",element:e.jsx(TS,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(jZ,{})})]})}function _Z(){const t=[{id:1,code:"BOM-001",product:"Finished Good A",version:"v1",active:!0},{id:2,code:"BOM-002",product:"Finished Good B",version:"v1",active:!0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Bills of Materials (BOM)"}),e.jsx("p",{className:"text-sm mt-1",children:"Manage BOM definitions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/production",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/production/bom/new",className:"btn-success",children:"+ New BOM"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Code"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Version"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.code}),e.jsx("td",{children:s.product}),e.jsx("td",{children:s.version}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/production/bom/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/production/bom/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function IS(){const t=ys(),{id:s}=Ls(),r=!!s,{search:a}=ma(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=x.useState(!1),[u,d]=x.useState({code:"",product:"",version:"v1",active:!0,lines:[{component:"",qty:1}]});x.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({code:"BOM-001",product:"Finished Good A",version:"v1",active:!0,lines:[{component:"Raw Material X",qty:2}]}),o(!1)},150))},[r]);function c(v,b){d(y=>({...y,[v]:b}))}function h(v,b,y){d(j=>{const N=[...j.lines];return N[v]={...N[v],[b]:y},{...j,lines:N}})}function A(){d(v=>({...v,lines:[...v.lines,{component:"",qty:1}]}))}function f(v){d(b=>({...b,lines:b.lines.filter((y,j)=>j!==v)}))}async function g(v){v.preventDefault(),o(!0);try{t("/production/bom")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/production/bom",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to BOM"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View BOM":r?"Edit BOM":"New BOM"})]}),e.jsx("form",{onSubmit:g,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("fieldset",{disabled:i,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Code"}),e.jsx("input",{className:"input",value:u.code,onChange:v=>c("code",v.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Product *"}),e.jsx("input",{className:"input",value:u.product,onChange:v=>c("product",v.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Version"}),e.jsx("input",{className:"input",value:u.version,onChange:v=>c("version",v.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.active?"1":"0",onChange:v=>c("active",v.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:"Components"}),e.jsx("button",{type:"button",className:"btn-success",onClick:A,disabled:i,children:"+ Add"})]}),e.jsx("div",{className:"space-y-2",children:u.lines.map((v,b)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2",children:[e.jsx("div",{className:"md:col-span-8",children:e.jsx("input",{className:"input",placeholder:"Component",value:v.component,onChange:y=>h(b,"component",y.target.value)})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx("input",{className:"input",type:"number",min:"0",step:"0.01",placeholder:"Qty",value:v.qty,onChange:y=>h(b,"qty",Number(y.target.value))})}),e.jsx("div",{className:"md:col-span-1 flex md:justify-end",children:e.jsx("button",{type:"button",className:"btn-success",onClick:()=>f(b),disabled:i||u.lines.length<=1,children:""})})]},b))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/production/bom",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function SZ(){const t=[{id:1,woNo:"WO-0001",product:"Finished Good A",qty:10,status:"PLANNED"},{id:2,woNo:"WO-0002",product:"Finished Good B",qty:5,status:"RELEASED"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Work Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Production order tracking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/production",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/production/work-orders/new",className:"btn-success",children:"+ New Work Order"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"WO No"}),e.jsx("th",{children:"Product"}),e.jsx("th",{className:"text-right",children:"Qty"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.woNo}),e.jsx("td",{children:s.product}),e.jsx("td",{className:"text-right",children:Number(s.qty).toFixed(2)}),e.jsx("td",{children:s.status}),e.jsxs("td",{children:[e.jsx(Le,{to:`/production/work-orders/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/production/work-orders/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function LS(){const t=ys(),{id:s}=Ls(),r=!!s,{search:a}=ma(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=x.useState(!1),[u,d]=x.useState(""),[c,h]=x.useState({woNo:"",product:"",qty:0,status:"PLANNED"});x.useEffect(()=>{r&&A()},[s]);async function A(){var v,b,y;try{o(!0),d("");const j=await ee.get(`/production/work-orders/${s}`);(v=j.data)!=null&&v.item&&h(j.data.item)}catch(j){d(((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.message)||"Error fetching work order")}finally{o(!1)}}function f(v,b){h(y=>({...y,[v]:b}))}async function g(v){var b,y;v.preventDefault(),o(!0),d("");try{r?await ee.put(`/production/work-orders/${s}`,c):await ee.post("/production/work-orders",c),t("/production/work-orders")}catch(j){d(((y=(b=j==null?void 0:j.response)==null?void 0:b.data)==null?void 0:y.message)||"Error saving work order")}finally{o(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/production/work-orders",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Work Orders"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"View Work Order":r?"Edit Work Order":"New Work Order"})]}),e.jsx("form",{onSubmit:g,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[u&&e.jsx("div",{className:"alert alert-error mb-4",children:u}),e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"WO No"}),e.jsx("input",{className:"input",value:c.woNo,onChange:v=>f("woNo",v.target.value),placeholder:"Auto"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Product *"}),e.jsx("input",{className:"input",value:c.product,onChange:v=>f("product",v.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Qty"}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:c.qty,onChange:v=>f("qty",Number(v.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:c.status,onChange:v=>f("status",v.target.value),children:[e.jsx("option",{value:"PLANNED",children:"Planned"}),e.jsx("option",{value:"RELEASED",children:"Released"}),e.jsx("option",{value:"IN_PROGRESS",children:"In Progress"}),e.jsx("option",{value:"COMPLETED",children:"Completed"}),e.jsx("option",{value:"CANCELLED",children:"Cancelled"})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/production/work-orders",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function CZ(){const t=[{title:"Work Order Status",description:"Planned vs Released vs Completed (placeholder)"},{title:"BOM Usage",description:"Component usage by BOM (placeholder)"},{title:"Production Output",description:"Output by date range (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/production",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Production"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Production Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Manufacturing analytics and reports"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function kZ(){const[t,s]=Ts.useState([{icon:"",value:"12",label:"Active Work Orders",change:"3 due today",changeType:"neutral",path:"/production/work-orders"},{icon:"",value:"94%",label:"Efficiency",change:" 2% this week",changeType:"positive",path:"/production/reports"},{icon:"",value:"45",label:"Active BOMs",change:"5 new this month",changeType:"neutral",path:"/production/bom"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.production)==null?void 0:o.active_work_orders)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.production)==null?void 0:c.efficiency_percent)||0),y=Number(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.production)==null?void 0:f.active_boms)||0);a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:`${b}%`},N[2]={...N[2],value:String(y)},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Master Data",features:[{name:"Bills of Materials",path:"/production/bom",description:"Define BOMs and components",icon:""},{name:"New BOM",path:"/production/bom/new",description:"Create a new BOM",icon:""}]},{title:"Execution",features:[{name:"Work Orders",path:"/production/work-orders",description:"Create and track work orders",icon:""},{name:"New Work Order",path:"/production/work-orders/new",description:"Start a work order",icon:""}]},{title:"Reports",features:[{name:"Production Reports",path:"/production/reports",description:"Manufacturing analytics",icon:""}]}];return e.jsx(Gl,{title:"Production",description:"Manufacturing and production planning",stats:t,sections:r})}function BZ(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(kZ,{})}),e.jsx(Je,{path:"/bom",element:e.jsx(_Z,{})}),e.jsx(Je,{path:"/bom/new",element:e.jsx(IS,{})}),e.jsx(Je,{path:"/bom/:id",element:e.jsx(IS,{})}),e.jsx(Je,{path:"/work-orders",element:e.jsx(SZ,{})}),e.jsx(Je,{path:"/work-orders/new",element:e.jsx(LS,{})}),e.jsx(Je,{path:"/work-orders/:id",element:e.jsx(LS,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(CZ,{})})]})}function EZ(){const t=[{title:"Daily Sales Summary",description:"Total sales by date (placeholder)"},{title:"Payment Method Breakdown",description:"Cash/Card/Mobile totals (placeholder)"},{title:"Top Selling Items",description:"Best performing items (placeholder)"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Sales analytics and end-of-day reporting"})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}const DS="pos_payment_settings",US="pos_general_settings",FZ=({active:t,onClick:s,children:r})=>e.jsx("button",{type:"button",onClick:s,className:`px-4 py-2 rounded-md border ${t?"bg-slate-100 border-slate-300 text-slate-900":"bg-white border-slate-200 text-slate-600"}`,children:r});function TZ({emoji:t,title:s,subtitle:r}){return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:[t," ",s]}),r?e.jsx("p",{className:"text-sm mt-1",children:r}):null]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Le,{to:"/pos",className:"btn btn-secondary",children:"Return to Menu"})})]})}function VB({title:t,children:s}){return e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:t}),e.jsx("div",{className:"text-blue-800",children:s})]})}function PS({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function IZ(){const{scope:t}=ca(),[s,r]=x.useState([]),[a,n]=x.useState(!0),[i,l]=x.useState(!1),[o,u]=x.useState(-1),[d,c]=x.useState([]),[h,A]=x.useState(!1),[f,g]=x.useState(null),[v,b]=x.useState(!1),[y,j]=x.useState(!1),[N,S]=x.useState([]),[B,P]=x.useState([]),[L,U]=x.useState({}),[H,q]=x.useState(""),[V,M]=x.useState({name:"",code:"AUTO",warehouse:"",ip_address:"",active:!0});function z(){const R=s.reduce((X,ne)=>{const te=String(ne.code||"").match(/^T(\d{3})$/);if(!te)return X;const oe=parseInt(te[1],10);return Number.isFinite(oe)&&oe>X?oe:X},0)+1;return`T${String(R).padStart(3,"0")}`}function I(){n(!0),ee.get("/pos/terminals").then(O=>{var X;const R=Array.isArray((X=O.data)==null?void 0:X.items)?O.data.items:[];r(R.map(ne=>({...ne,active:!!ne.is_active})))}).catch(()=>r([])).finally(()=>n(!1))}x.useEffect(()=>{I()},[]),x.useEffect(()=>{let O=!0;return ee.get("/inventory/warehouses").then(R=>{var X;O&&c(Array.isArray((X=R.data)==null?void 0:X.items)?R.data.items:[])}).catch(()=>{O&&c([])}),()=>{O=!1}},[]);function G(){u(-1),M({name:"",code:z(),warehouse:"",ip_address:"",active:!0}),l(!0)}function Y(O){const R=s[O];u(O),M({name:(R==null?void 0:R.name)||"",code:(R==null?void 0:R.code)||"AUTO",warehouse:(R==null?void 0:R.warehouse)||"",ip_address:(R==null?void 0:R.ip_address)||"",active:!!(R!=null&&R.active)}),l(!0)}async function J(){var X,ne,te,oe;const O=String(V.name||"").trim();let R=String(V.code||"").trim();if(!O){nt.warn("Provide terminal name");return}(!R||R==="AUTO")&&(R=z());try{if(o>=0){const ce=s[o];if(!ce||!ce.id){nt.error("Terminal id is missing");return}await ee.put(`/pos/terminals/${ce.id}`,{code:R,name:O,warehouse:V.warehouse||null,counter_no:ce.counter_no||null,ip_address:V.ip_address||null,active:!!V.active})}else await ee.post("/pos/terminals",{code:R,name:O,warehouse:V.warehouse||null,counter_no:null,ip_address:V.ip_address||null,active:!!V.active});l(!1),u(-1),I(),nt.success("Terminal saved")}catch(ce){const re=((ne=(X=ce==null?void 0:ce.response)==null?void 0:X.data)==null?void 0:ne.message)||((oe=(te=ce==null?void 0:ce.response)==null?void 0:te.data)==null?void 0:oe.error)||"Failed to save terminal";nt.error(re)}}async function T(O){var X,ne,te,oe;const R=s[O];if(!R||!R.id){r(ce=>ce.filter((re,de)=>de!==O));return}try{await ee.put(`/pos/terminals/${R.id}`,{code:R.code,name:R.name,warehouse:R.warehouse||null,counter_no:R.counter_no||null,ip_address:R.ip_address||null,active:!1}),I(),nt.success("Terminal deactivated")}catch(ce){const re=((ne=(X=ce==null?void 0:ce.response)==null?void 0:X.data)==null?void 0:ne.message)||((oe=(te=ce==null?void 0:ce.response)==null?void 0:te.data)==null?void 0:oe.error)||"Failed to deactivate terminal";nt.error(re)}}async function k(O){var ne,te,oe,ce,re,de,Ie;const R=Number((t==null?void 0:t.companyId)||0)||void 0,X=Number((t==null?void 0:t.branchId)||0)||void 0;b(!0);try{const[le,Z]=await Promise.all([ee.get("/admin/users",{params:{...R?{company_id:R}:{},...X?{branch_id:X}:{},active:1,limit:100}}),ee.get("/pos/terminal-users",{params:{terminalId:O}})]),ve=Array.isArray((te=(ne=le.data)==null?void 0:ne.data)==null?void 0:te.items)?le.data.data.items:[],Ue=Array.isArray((oe=Z.data)==null?void 0:oe.items)?Z.data.items:[];S(ve),U(Ue.reduce((Be,_e)=>{const Me=String(_e.user_id);return Be[Me]=String(_e.username||Me),Be},{})),P(Ue.map(Be=>Number(Be.user_id)).filter(Be=>Number.isFinite(Be)&&Be>0).map(String)),q("")}catch(le){S([]),P([]),U({}),q("");const Z=((re=(ce=le==null?void 0:le.response)==null?void 0:ce.data)==null?void 0:re.message)||((Ie=(de=le==null?void 0:le.response)==null?void 0:de.data)==null?void 0:Ie.error)||"Failed to load users for terminal";nt.error(Z)}finally{b(!1)}}function D(O){O!=null&&O.id&&(g(O),A(!0),q(""),k(O.id))}async function Q(){var te,oe,ce,re;const O=f==null?void 0:f.id;if(!O)return;const R=String(H||"").trim(),X=R?[...B,R]:B,ne=Array.from(new Set(X)).map(de=>Number(de)).filter(de=>Number.isFinite(de)&&de>0);j(!0);try{await ee.put("/pos/terminal-users",{terminalId:O,userIds:ne}),nt.success("Terminal users updated"),A(!1),g(null),P([]),q("")}catch(de){const Ie=((oe=(te=de==null?void 0:de.response)==null?void 0:te.data)==null?void 0:oe.message)||((re=(ce=de==null?void 0:de.response)==null?void 0:ce.data)==null?void 0:re.error)||"Failed to update terminal users";nt.error(Ie)}finally{j(!1)}}const C=x.useMemo(()=>{const O=new Map;for(const R of N)R!=null&&R.id&&O.set(String(R.id),R);return O},[N]),E=x.useMemo(()=>new Set(B),[B]),w=x.useMemo(()=>N.filter(O=>(O==null?void 0:O.id)&&!E.has(String(O.id))),[N,E]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(VB,{title:"About POS Terminals",children:"Configure and manage point-of-sale terminals. Each terminal represents a physical checkout counter or device in your store."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-success",onClick:G,children:"+ Add Terminal"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:I,children:"Refresh"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-sm mb-3",children:"Manage register identifiers, warehouse/location binding, printer/IP, and activation status."}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Terminal Name"}),e.jsx("th",{children:"Terminal ID"}),e.jsx("th",{children:"Warehouse"}),e.jsx("th",{children:"Receipt Printer"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading..."})}):s.length?s.map(O=>e.jsxs("tr",{children:[e.jsx("td",{children:O.name}),e.jsx("td",{children:O.code}),e.jsx("td",{children:O.warehouse||"-"}),e.jsx("td",{children:O.ip_address||"Not configured"}),e.jsx("td",{children:e.jsx("span",{className:O.active?"badge-success":"badge-secondary",children:O.active?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Y(s.indexOf(O)),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>D(O),children:"Users"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>T(s.indexOf(O)),children:"Delete"})]})})]},O.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:e.jsx("div",{className:"text-center text-slate-600 py-4",children:"No terminals found"})})})})]})})]})}),i?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-brand text-white",children:e.jsx("div",{className:"text-lg font-bold",children:o>=0?"Edit Terminal":"Add Terminal"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal Name"}),e.jsx("input",{className:"input",value:V.name,onChange:O=>M(R=>({...R,name:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal ID"}),e.jsx("input",{className:"input",value:V.code,onChange:O=>M(R=>({...R,code:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsx(PS,{value:V.warehouse,onChange:O=>M(R=>({...R,warehouse:O})),options:d.map(O=>{const R=`${O.warehouse_code?`${O.warehouse_code} - `:""}${O.warehouse_name||""}`;return{value:R,label:R}}),placeholder:"Select warehouse",filterPlaceholder:"Filter warehouses..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Printer / IP"}),e.jsx("input",{className:"input",value:V.ip_address,onChange:O=>M(R=>({...R,ip_address:O.target.value})),placeholder:"Printer name or IP"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:!!V.active,onChange:O=>M(R=>({...R,active:O.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(!1),u(-1)},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:J,children:"Save"})]})]})]})}):null,h?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-200 bg-brand text-white",children:[e.jsx("div",{className:"text-lg font-bold",children:"Assign Users"}),e.jsxs("div",{className:"text-sm opacity-90",children:[f==null?void 0:f.name," (",f==null?void 0:f.code,")"]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[v?e.jsx("div",{className:"py-8 text-center text-slate-600",children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 items-end",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Add User"}),e.jsx(PS,{value:H,onChange:O=>q(String(O)),options:w.map(O=>({value:String(O.id),label:String(O.username||"")})),placeholder:"Select user",filterPlaceholder:"Filter users..."})]}),e.jsx("button",{type:"button",className:"btn btn-secondary",disabled:!H||y,onClick:()=>{const O=String(H||"").trim();O&&(P(R=>R.includes(O)?R:[...R,O]),q(""))},children:"Add"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Assigned Users"}),e.jsx("button",{type:"button",className:"btn btn-secondary",disabled:!B.length||y,onClick:()=>P([]),children:"Clear All"})]}),e.jsx("div",{className:"mt-2 overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase text-slate-600",children:"Username"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase text-slate-600",children:"Action"})]})}),e.jsx("tbody",{children:B.length?B.map(O=>{var X;const R=((X=C.get(String(O)))==null?void 0:X.username)||L[String(O)]||String(O);return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:R}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("button",{type:"button",className:"btn btn-danger",disabled:y,onClick:()=>P(ne=>ne.filter(te=>te!==String(O))),children:"Remove"})})]},O)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"2",className:"p-4 text-center text-slate-500",children:"No users assigned"})})})]})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",disabled:y,onClick:()=>{A(!1),g(null)},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:v||y,onClick:Q,children:y?"Saving...":"Save"})]})]})]})}):null]})}function LZ(){const[t,s]=x.useState([]),[r,a]=x.useState(!0),[n,i]=x.useState(!1),[l,o]=x.useState(-1),[u,d]=x.useState([]),[c,h]=x.useState({name:"",type:"cash",account:"",requireReference:!1,active:!0}),[A,f]=x.useState(!0),[g,v]=x.useState(!0),[b,y]=x.useState(""),[j,N]=x.useState("10000"),[S,B]=x.useState(!0),[P,L]=x.useState(""),[U,H]=x.useState("2.5"),[q,V]=x.useState(!0),M=x.useMemo(()=>{const k=new Map;for(const D of u){if(!D||D.id===void 0||D.id===null)continue;const Q=String(D.id),C=String(D.name||"").trim();k.set(Q,C||Q)}return k},[u]);function z(){a(!0),ee.get("/pos/payment-modes").then(k=>{var C;const Q=(Array.isArray((C=k.data)==null?void 0:C.items)?k.data.items:[]).map(E=>({id:E.id,name:E.name,type:E.type,account:E.account||"",requireReference:!!E.require_reference,active:!!E.is_active}));s(Q)}).catch(()=>{s([])}).finally(()=>a(!1))}x.useEffect(()=>{z()},[]),x.useEffect(()=>{let k=!0;return ee.get("/finance/accounts",{params:{postable:1,active:1}}).then(D=>{var C;if(!k)return;const Q=Array.isArray((C=D.data)==null?void 0:C.items)?D.data.items:[];d(Q)}).catch(()=>{k&&d([])}),()=>{k=!1}},[]),x.useEffect(()=>{try{const k=localStorage.getItem(DS);if(!k)return;const D=JSON.parse(k);if(!D||typeof D!="object")return;typeof D.cashEnabled=="boolean"&&f(D.cashEnabled),typeof D.cardEnabled=="boolean"&&v(D.cardEnabled),D.cashAccountId&&y(String(D.cashAccountId)),D.maxCashAmount!==void 0&&N(String(D.maxCashAmount)),typeof D.requireChangeCalc=="boolean"&&B(D.requireChangeCalc),D.cardBankAccountId&&L(String(D.cardBankAccountId)),D.cardProcessingFee!==void 0&&H(String(D.cardProcessingFee)),typeof D.requireCardLast4=="boolean"&&V(D.requireCardLast4)}catch{}},[]);function I(){o(-1),h({name:"",type:"cash",account:"",requireReference:!1,active:!0}),i(!0)}function G(k){const D=t[k];o(k),h({name:(D==null?void 0:D.name)||"",type:(D==null?void 0:D.type)||"cash",account:(D==null?void 0:D.account)||"",requireReference:!!(D!=null&&D.requireReference),active:!!(D!=null&&D.active)}),i(!0)}async function Y(k){var Q,C,E,w;const D=t[k];if(!D||!D.id){s(O=>O.filter((R,X)=>X!==k));return}try{await ee.put(`/pos/payment-modes/${D.id}`,{name:D.name,type:D.type,account:D.account||"",requireReference:D.requireReference||!1,active:!1}),z(),nt.success("Payment mode deactivated")}catch(O){const R=((C=(Q=O==null?void 0:O.response)==null?void 0:Q.data)==null?void 0:C.message)||((w=(E=O==null?void 0:O.response)==null?void 0:E.data)==null?void 0:w.error)||"Failed to deactivate payment mode";nt.error(R)}}async function J(){var Q,C,E,w;const k=String(c.name||"").trim(),D=String(c.type||"").trim();if(!k||!D){nt.warn("Provide payment name and type");return}try{if(l>=0){const O=t[l];if(!O||!O.id){nt.error("Payment mode id is missing");return}await ee.put(`/pos/payment-modes/${O.id}`,{name:k,type:D,account:c.account||"",requireReference:!!c.requireReference,active:!!c.active})}else await ee.post("/pos/payment-modes",{name:k,type:D,account:c.account||"",requireReference:!!c.requireReference,active:!!c.active});i(!1),o(-1),z(),nt.success("Payment mode saved")}catch(O){const R=((C=(Q=O==null?void 0:O.response)==null?void 0:Q.data)==null?void 0:C.message)||((w=(E=O==null?void 0:O.response)==null?void 0:E.data)==null?void 0:w.error)||"Failed to save payment mode";nt.error(R)}}function T(){const k={cashEnabled:!!A,cardEnabled:!!g,cashAccountId:b||"",maxCashAmount:j===""?"":Number(j||0).toString(),requireChangeCalc:!!S,cardBankAccountId:P||"",cardProcessingFee:U===""?"":Number(U||0).toString(),requireCardLast4:!!q};try{localStorage.setItem(DS,JSON.stringify(k)),nt.success("Payment settings saved")}catch{nt.error("Failed to save payment settings")}}return e.jsxs("div",{className:"space-y-6",children:[e.jsx(VB,{title:"About Payment Methods",children:"Configure available payment methods for your POS system. Enable or disable payment options and set processing preferences."}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Payment Methods"}),e.jsx("button",{type:"button",className:"btn-success",onClick:I,children:"+ Add Payment Mode"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Account"}),e.jsx("th",{children:"Require Reference"}),e.jsx("th",{children:"Active"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500",children:"Loading..."})}):t.length?t.map((k,D)=>e.jsxs("tr",{children:[e.jsx("td",{children:k.name}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-success",children:k.type})}),e.jsx("td",{children:k.account?M.get(String(k.account))||String(k.account):"N/A"}),e.jsx("td",{children:k.requireReference?"Yes":"No"}),e.jsx("td",{children:e.jsx("span",{className:k.active?"badge-success badge":"badge-secondary badge",children:k.active?"Active":"Inactive"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>G(D),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Y(D),children:"Delete"})]})})]},k.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-8 text-slate-500",children:"No payment modes configured"})})})]})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Cash Payment"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:k=>f(k.target.checked)}),e.jsx("span",{className:"text-sm",children:"Enable Cash Payments"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cash Account"}),e.jsxs("select",{className:"input",value:b,onChange:k=>y(k.target.value),children:[e.jsx("option",{value:"",children:"Select cash account"}),u.map(k=>e.jsxs("option",{value:String(k.id),children:[k.code," - ",k.name]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Max Cash Amount"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:j,onChange:k=>N(k.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Require Change Calculation"}),e.jsxs("select",{className:"input",value:S?"YES":"NO",onChange:k=>B(k.target.value==="YES"),children:[e.jsx("option",{value:"YES",children:"Yes"}),e.jsx("option",{value:"NO",children:"No"})]})]})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Card Payment"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:k=>v(k.target.checked)}),e.jsx("span",{className:"text-sm",children:"Enable Card Payments"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Bank Account"}),e.jsxs("select",{className:"input",value:P,onChange:k=>L(k.target.value),children:[e.jsx("option",{value:"",children:"Select bank account"}),u.map(k=>e.jsxs("option",{value:String(k.id),children:[k.code," - ",k.name]},k.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Processing Fee %"}),e.jsx("input",{className:"input",type:"number",step:"0.01",value:U,onChange:k=>H(k.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Require Card Last 4 Digits"}),e.jsxs("select",{className:"input",value:q?"YES":"NO",onChange:k=>V(k.target.value==="YES"),children:[e.jsx("option",{value:"YES",children:"Yes"}),e.jsx("option",{value:"NO",children:"No"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Card Types Accepted"}),e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:"text-sm",children:"Visa"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:"text-sm",children:"Mastercard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:"text-sm",children:"American Express"})]})]})]})]})})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:T,children:"Save Payment Settings"})}),n?e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-md overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 bg-brand text-white",children:e.jsx("div",{className:"text-lg font-bold",children:l>=0?"Edit Payment Mode":"Add Payment Mode"})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Name"}),e.jsx("input",{className:"input",value:c.name,onChange:k=>h(D=>({...D,name:k.target.value})),placeholder:"e.g., Cash, Credit Card"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Type"}),e.jsxs("select",{className:"input",value:c.type,onChange:k=>h(D=>({...D,type:k.target.value})),children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"mobile",children:"Mobile Money"}),e.jsx("option",{value:"bank",children:"Bank Transfer"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Account"}),e.jsxs("select",{className:"input",value:c.account,onChange:k=>h(D=>({...D,account:k.target.value})),children:[e.jsx("option",{value:"",children:"Select account"}),u.map(k=>e.jsxs("option",{value:String(k.id),children:[k.code," - ",k.name]},k.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.requireReference,onChange:k=>h(D=>({...D,requireReference:k.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Require Reference Number"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c.active,onChange:k=>h(D=>({...D,active:k.target.checked}))}),e.jsx("span",{className:"text-sm",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(!1),o(-1)},children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:J,children:"Save Payment Mode"})]})]})]})}):null]})}function DZ(){const[t,s]=x.useState([]),[r,a]=x.useState(""),[n,i]=x.useState(!0),[l,o]=x.useState("Inclusive"),[u,d]=x.useState(!0),[c,h]=x.useState([]),[A,f]=x.useState(""),[g,v]=x.useState(!0);x.useEffect(()=>{let y=!0;return ee.get("/finance/tax-codes").then(j=>{var N;y&&s(Array.isArray((N=j.data)==null?void 0:N.items)?j.data.items:[])}).catch(()=>{y&&s([])}).finally(()=>{y&&i(!1)}),()=>{y=!1}},[]),x.useEffect(()=>{let y=!0;return ee.get("/pos/tax-settings").then(j=>{var S;if(!y)return;const N=((S=j.data)==null?void 0:S.item)||null;N&&(N.tax_code_id&&a(String(N.tax_code_id)),N.tax_account_id&&f(String(N.tax_account_id)),N.tax_type&&o(String(N.tax_type)),N.is_active!==void 0&&d(!!N.is_active))}).catch(()=>{}),()=>{y=!1}},[]);async function b(){const y={taxCodeId:r||"",taxAccountId:A||"",taxType:l||"",isActive:!!u};try{await ee.put("/pos/tax-settings",y),nt.success("Tax settings saved")}catch{nt.error("Failed to save tax settings")}}return x.useEffect(()=>{let y=!0;return ee.get("/finance/accounts",{params:{postable:1,active:1}}).then(j=>{var S;if(!y)return;const N=Array.isArray((S=j.data)==null?void 0:S.items)?j.data.items:[];h(N)}).catch(()=>{y&&h([])}).finally(()=>{y&&v(!1)}),()=>{y=!1}},[]),e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Tax Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Tax Code"}),e.jsxs("select",{className:"input",value:r,onChange:y=>a(y.target.value),disabled:n,children:[e.jsx("option",{value:"",children:"Select tax code"}),t.map(y=>e.jsx("option",{value:y.id,children:y.name},y.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Type"}),e.jsxs("select",{className:"input",value:l,onChange:y=>o(y.target.value),children:[e.jsx("option",{value:"Inclusive",children:"Inclusive"}),e.jsx("option",{value:"Exclusive",children:"Exclusive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Tax Account"}),e.jsxs("select",{className:"input",value:A,onChange:y=>f(y.target.value),disabled:g,children:[e.jsx("option",{value:"",children:"Select tax account"}),c.map(y=>e.jsxs("option",{value:y.id,children:[y.code,"  ",y.name]},y.id))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:y=>d(y.target.checked)}),e.jsx("label",{className:"label mb-0",children:"Tax Active"})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,children:"Save Tax Settings"})})]})})})}function UZ(){const[t,s]=x.useState(""),[r,a]=x.useState(""),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState(!1),[g,v]=x.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:qs}),[b,y]=x.useState(!1);x.useEffect(()=>{let N=!0;async function S(){var B;try{const L=((B=(await ee.get("/pos/receipt-settings")).data)==null?void 0:B.item)||null;if(!N)return;L&&(L.company_name&&s(String(L.company_name)),L.header_text&&i(String(L.header_text)),L.footer_text&&o(String(L.footer_text)),L.contact_number&&a(String(L.contact_number)),L.address_line1&&d(String(L.address_line1)),L.address_line2&&h(String(L.address_line2)),f(L.show_logo===1||L.show_logo===!0||String(L.show_logo).toLowerCase()==="true"))}catch{}}return S(),()=>{N=!1}},[]),x.useEffect(()=>{let N=!0;async function S(){var B,P,L;try{y(!0);const H=(P=(B=(await ee.get("/admin/me")).data)==null?void 0:B.scope)==null?void 0:P.companyId;if(!H){if(!N)return;v(M=>({...M,logoUrl:M.logoUrl||qs}));return}const V=((L=(await ee.get(`/admin/companies/${H}`)).data)==null?void 0:L.item)||{};if(!N)return;v(M=>({...M,name:V.name||M.name||"",address:V.address||M.address||"",city:V.city||M.city||"",state:V.state||M.state||"",country:V.country||M.country||"",phone:V.telephone||M.phone||"",email:V.email||M.email||"",website:V.website||M.website||"",taxId:V.tax_id||M.taxId||"",registrationNo:V.registration_no||M.registrationNo||"",logoUrl:V.has_logo===1||V.has_logo===!0?`/api/admin/companies/${H}/logo`:M.logoUrl||qs}))}catch{if(!N)return;v(U=>({...U,logoUrl:U.logoUrl||qs}))}finally{N&&y(!1)}}return S(),()=>{N=!1}},[]);async function j(){var S,B,P,L;const N={companyName:t.trim(),contactNumber:r.trim(),headerText:n.trim(),footerText:l.trim(),addressLine1:u.trim(),addressLine2:c.trim(),logoUrl:g.logoUrl||"",showLogo:!!A};try{await ee.put("/pos/receipt-settings",N),nt.success("Receipt settings saved")}catch(U){const H=((B=(S=U==null?void 0:U.response)==null?void 0:S.data)==null?void 0:B.message)||((L=(P=U==null?void 0:U.response)==null?void 0:P.data)==null?void 0:L.error)||"Failed to save receipt settings";nt.error(H)}}return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Receipt Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-16 h-16 border rounded bg-white flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:g.logoUrl,alt:g.name||"Company Logo",className:"max-w-full max-h-full object-contain"})}),e.jsxs("div",{className:"text-xs text-slate-700",children:[e.jsx("div",{className:"font-semibold text-sm",children:g.name||"Company Name"}),e.jsxs("div",{children:[g.address,g.city?`, ${g.city}`:"",g.country?`, ${g.country}`:""]}),e.jsx("div",{children:g.phone?`Mobile: ${g.phone}`:g.email||""}),e.jsx("div",{children:g.taxId?`TIN: ${g.taxId}`:""})]})]}),e.jsx("div",{className:"md:col-span-2 text-xs text-slate-500",children:b?"Loading company information from profile...":"Company details are loaded from the company profile (adm_companies)."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Upload Logo"}),e.jsx("input",{type:"file",accept:"image/*",className:"input",onChange:async N=>{var B,P,L,U,H,q;const S=(B=N.target.files)==null?void 0:B[0];if(S)try{const V=new FormData;V.append("logo",S);const M=await ee.post("/pos/receipt-settings/logo",V,{headers:{"Content-Type":"multipart/form-data"}}),z=((P=M==null?void 0:M.data)==null?void 0:P.logoUrl)||g.logoUrl||"";v(I=>({...I,logoUrl:z})),f(!0),nt.success("Logo uploaded and linked to receipts")}catch(V){const M=((U=(L=V==null?void 0:V.response)==null?void 0:L.data)==null?void 0:U.message)||((q=(H=V==null?void 0:V.response)==null?void 0:H.data)==null?void 0:q.error)||"Failed to upload logo";nt.error(M)}finally{N.target.value=""}}})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company Name"}),e.jsx("input",{className:"input",type:"text",placeholder:"Company name",value:t,onChange:N=>s(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Contact Number"}),e.jsx("input",{className:"input",type:"text",placeholder:"+1234567890",value:r,onChange:N=>a(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Header Text"}),e.jsx("textarea",{className:"input h-28",placeholder:"Thank you for your purchase",value:n,onChange:N=>i(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Footer Text"}),e.jsx("textarea",{className:"input h-28",placeholder:"Please visit again",value:l,onChange:N=>o(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address Line 1"}),e.jsx("input",{className:"input",type:"text",placeholder:"Street address",value:u,onChange:N=>d(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Address Line 2"}),e.jsx("input",{className:"input",type:"text",placeholder:"City, State, ZIP",value:c,onChange:N=>h(N.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:N=>f(N.target.checked)}),e.jsx("span",{className:"text-sm",children:"Show Logo on Receipt"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",disabled:!0}),e.jsx("span",{className:"text-sm",children:"Show Barcode on Receipt"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:j,children:"Save Receipt Settings"})})]})})})}function PZ(){const[t,s]=x.useState("GHS - Ghana Cedi"),[r,a]=x.useState("2"),[n,i]=x.useState("MM/DD/YYYY"),[l,o]=x.useState("12 Hour"),[u,d]=x.useState(!1),[c,h]=x.useState(!1),[A,f]=x.useState(!1),[g,v]=x.useState(!1);x.useEffect(()=>{try{const y=localStorage.getItem(US);if(!y)return;const j=JSON.parse(y);if(!j||typeof j!="object")return;j.defaultCurrency&&s(String(j.defaultCurrency)),j.decimalPlaces!==void 0&&a(String(j.decimalPlaces)),j.dateFormat&&i(String(j.dateFormat)),j.timeFormat&&o(String(j.timeFormat)),typeof j.allowDiscounts=="boolean"&&d(j.allowDiscounts),typeof j.requireCustomer=="boolean"&&h(j.requireCustomer),typeof j.autoLogoutAfterShiftClose=="boolean"&&f(j.autoLogoutAfterShiftClose),typeof j.autoPrintReceipt=="boolean"&&v(j.autoPrintReceipt)}catch{}},[]);function b(){const y={defaultCurrency:t,decimalPlaces:r||"2",dateFormat:n,timeFormat:l,allowDiscounts:!!u,requireCustomer:!!c,autoLogoutAfterShiftClose:!!A,autoPrintReceipt:!!g};try{localStorage.setItem(US,JSON.stringify(y)),nt.success("General settings saved")}catch{nt.error("Failed to save general settings")}}return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"General Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Default Currency"}),e.jsxs("select",{className:"input",value:t,onChange:y=>s(y.target.value),children:[e.jsx("option",{value:"USD - US Dollar",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR - Euro",children:"EUR - Euro"}),e.jsx("option",{value:"GBP - British Pound",children:"GBP - British Pound"}),e.jsx("option",{value:"GHS - Ghana Cedi",children:"GHS - Ghana Cedi"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Decimal Places"}),e.jsxs("select",{className:"input",value:r,onChange:y=>a(y.target.value),children:[e.jsx("option",{value:"0",children:"0"}),e.jsx("option",{value:"2",children:"2"}),e.jsx("option",{value:"3",children:"3"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Date Format"}),e.jsxs("select",{className:"input",value:n,onChange:y=>i(y.target.value),children:[e.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Time Format"}),e.jsxs("select",{className:"input",value:l,onChange:y=>o(y.target.value),children:[e.jsx("option",{value:"12 Hour",children:"12 Hour"}),e.jsx("option",{value:"24 Hour",children:"24 Hour"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:y=>d(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Allow Discounts"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:y=>h(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Require Customer for Sales"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:y=>f(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Auto Logout After Shift Close"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:y=>v(y.target.checked)}),e.jsx("span",{className:"text-sm",children:"Auto Print Receipt"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,children:"Save General Settings"})})]})})})}function RZ(){const[t,s]=x.useState("terminals"),r=[{key:"terminals",label:" Terminals"},{key:"payment",label:" Payment Modes"},{key:"taxes",label:" Tax Settings"},{key:"receipts",label:" Receipt Settings"},{key:"general",label:" General Settings"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(TZ,{emoji:"",title:"POS Setup & Configuration",subtitle:"Configure terminals, payment methods, and system settings"}),e.jsx("div",{className:"flex gap-2",children:r.map(a=>e.jsx(FZ,{active:t===a.key,onClick:()=>s(a.key),children:a.label},a.key))}),t==="terminals"&&e.jsx(IZ,{}),t==="payment"&&e.jsx(LZ,{}),t==="taxes"&&e.jsx(DZ,{}),t==="receipts"&&e.jsx(UZ,{}),t==="general"&&e.jsx(PZ,{})]})}function pb({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function RS(){const[t,s]=x.useState(new Date),[r,a]=x.useState(""),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(!1),[A,f]=x.useState(null),[g,v]=x.useState([]),[b,y]=x.useState("cash"),[j,N]=x.useState(""),[S,B]=x.useState(!1),[P,L]=x.useState({amount:0,method:"",ref:""}),[U,H]=x.useState(null),[q,V]=x.useState([]),[M,z]=x.useState(!1),[I,G]=x.useState(!0),[Y,J]=x.useState(""),[T,k]=x.useState([]),[D,Q]=x.useState(!1),[C,E]=x.useState(""),[w,O]=x.useState([]),[R,X]=x.useState(!1),[ne,te]=x.useState("");x.useEffect(()=>{const Ke=setInterval(()=>s(new Date),1e3);return()=>clearInterval(Ke)},[]),x.useEffect(()=>{let Ke=!1;return G(!0),ee.get("/pos/day/status").then(ct=>{var Ce;if(Ke)return;const xt=((Ce=ct==null?void 0:ct.data)==null?void 0:Ce.item)||null,be=String((xt==null?void 0:xt.status)||"").toUpperCase()==="OPEN";z(be)}).catch(()=>{Ke||z(!1)}).finally(()=>{Ke||G(!1)}),()=>{Ke=!0}},[]),x.useEffect(()=>{let Ke=!0;return Q(!0),E(""),ee.get("/sales/price-types").then(ct=>{var be;if(!Ke)return;const xt=Array.isArray((be=ct.data)==null?void 0:be.items)?ct.data.items:[];if(k(xt),!Y&&xt.length){let Ce=xt.find(Te=>String(Te.name||"").trim().toLowerCase()==="retail")||xt[0];Ce&&Ce.id&&J(String(Ce.id))}}).catch(ct=>{var xt,be;Ke&&E(((be=(xt=ct==null?void 0:ct.response)==null?void 0:xt.data)==null?void 0:be.message)||"Failed to load price types")}).finally(()=>{Ke&&Q(!1)}),()=>{Ke=!1}},[Y]),x.useEffect(()=>{let Ke=!0;return X(!0),te(""),ee.get("/inventory/items").then(ct=>{var Ce;if(!Ke)return;const be=(Array.isArray((Ce=ct.data)==null?void 0:Ce.items)?ct.data.items:[]).filter(Te=>Te&&Te.is_active!==!1).map(Te=>({id:Te.id,name:Te.item_name||"",code:Te.item_code||""}));O(be)}).catch(ct=>{var xt,be;Ke&&te(((be=(xt=ct==null?void 0:ct.response)==null?void 0:xt.data)==null?void 0:be.message)||"Failed to load items")}).finally(()=>{Ke&&X(!1)}),()=>{Ke=!1}},[]),x.useEffect(()=>{let Ke=!1;async function ct(){if(!Array.isArray(g)||!g.length)return;const xt=await Promise.all(g.map(async be=>{const Ce=w.find(ue=>String(ue.name||"").trim().toLowerCase()===String(be.name||"").trim().toLowerCase())||null,Te=Ce?await oe(Ce.id,Y,be.price):be.price;return{...be,price:Te}}));Ke||v(xt)}return ct(),()=>{Ke=!0}},[Y]);async function oe(Ke,ct,xt){var be;try{const Ce={product_id:Ke,quantity:1,price_type:ct||"",only_standard:!0},Te=await ee.post("/sales/prices/best-price",Ce),ue=Number((be=Te.data)==null?void 0:be.price);return Number.isFinite(ue)?ue:Number(xt||0)}catch{return Number(xt||0)}}x.useEffect(()=>{let Ke=!1;async function ct(){var be,Ce;const xt=String(n||"").trim();if(a(""),o(""),d(""),f(null),v([]),!xt){h(!0);try{const Te=await ee.get("/pos/sales",{params:{limit:200}}),ge=(Array.isArray((be=Te.data)==null?void 0:be.items)?Te.data.items:Array.isArray((Ce=Te.data)==null?void 0:Ce.item)?Te.data.item:[]).map(Ve=>({id:Ve.id,receiptNo:String(Ve.sale_no||""),date:String(Ve.sale_date||"").slice(0,10),customer:String(Ve.customer_id||""),payment:String(Ve.payment_method||"").replace(/^./,tt=>tt.toUpperCase())}));V(ge)}catch{V([])}finally{h(!1)}return}h(!0);try{async function Te(Ve){var ht,ze;const tt=await ee.get("/pos/sales",{params:{limit:1e3,...Ve}});return Array.isArray((ht=tt.data)==null?void 0:ht.items)?tt.data.items:Array.isArray((ze=tt.data)==null?void 0:ze.item)?tt.data.item:[]}let ue=[];try{ue=await Te({date:xt})}catch{}if(!Ke&&!ue.length)try{ue=await Te({sale_date:xt})}catch{}if(!Ke&&!ue.length)try{ue=await Te({from:xt,to:xt})}catch{}if(!Ke&&!ue.length)try{ue=(await Te({})).filter(tt=>String(tt.sale_date||tt.date||"").slice(0,10)===xt)}catch{}if(Ke)return;const ge=ue.map(Ve=>({id:Ve.id,receiptNo:String(Ve.sale_no||""),date:String(Ve.sale_date||"").slice(0,10),customer:String(Ve.customer_id||""),payment:String(Ve.payment_method||"").replace(/^./,tt=>tt.toUpperCase())}));V(ge)}catch{if(Ke)return;V([])}finally{if(Ke)return;h(!1)}}return ct(),()=>{Ke=!0}},[n]);const ce=x.useMemo(()=>g.reduce((Ke,ct)=>Ke+ct.price*ct.returnQuantity,0),[g]),re=x.useMemo(()=>ce*.125,[ce]),de=x.useMemo(()=>ce+re,[ce,re]);async function Ie(){var xt;const Ke=Number(r||0);if(!Ke)return;const ct=q.find(be=>Number(be.id)===Ke)||null;if(ct)try{const be=await ee.get(`/pos/sales/${ct.id}`),Te=(Array.isArray((xt=be.data)==null?void 0:xt.details)?be.data.details:[]).map((ue,ge)=>({id:ge+1,name:String(ue.item_name||""),price:Number(ue.unit_price||0),quantity:Number(ue.qty||0)}));f({...ct,items:Te}),v([])}catch{f({...ct,items:[]}),v([])}}function le(Ke,ct){if(!A)return;const xt=A.items.find(be=>be.id===Ke);xt&&(ct?(async()=>{const be=w.find(ue=>String(ue.name||"").trim().toLowerCase()===String(xt.name||"").trim().toLowerCase())||null,Ce=be?await oe(be.id,Y,xt.price):xt.price,Te={id:xt.id,name:xt.name,price:Ce,soldQty:xt.quantity,returnQuantity:1,reason:"defective"};v(ue=>{const ge=ue.findIndex(Ve=>Ve.id===Ke);if(ge>=0){const Ve=ue.slice();return Ve[ge]=Te,Ve}return[...ue,Te]})})():v(be=>be.filter(Ce=>Ce.id!==Ke)))}function Z(Ke,ct){const xt=Math.max(1,Number(ct||1));v(be=>be.map(Ce=>Ce.id===Ke?{...Ce,returnQuantity:xt}:Ce))}function ve(Ke,ct){v(xt=>xt.map(be=>be.id===Ke?{...be,reason:ct}:be))}function Ue(Ke){v(ct=>ct.filter(xt=>xt.id!==Ke))}function Be(){g.length&&v([])}function _e(){if(!g.length)return;const Ke="RTN-"+Date.now(),ct=new Date;L({amount:de,method:b==="cash"?"Cash":b==="card"?"Card Refund":b==="mobile"?"Mobile Money":"Store Credit",ref:Ke}),H(ct),B(!0)}function Me(){B(!1),f(null),v([]),a(""),i(""),o(""),d(""),N("")}function Ye(){var Ve;if(!A||!g.length)return;const ct=(U?new Date(U):new Date).toLocaleString(),xt=g.map(tt=>{const Ze=Number(tt.returnQuantity||0),ht=Number(tt.price||0),ze=Ze*ht,Fe=String(tt.reason||"").replace(/^./,xe=>xe.toUpperCase());return`<tr>
          <td>${String(tt.name||"")}</td>
          <td class="right">${Ze}</td>
          <td class="right">${ht.toFixed(2)}</td>
          <td class="right">${ze.toFixed(2)}</td>
          <td>${Fe}</td>
        </tr>`}).join(""),be=String(j||"").trim()?`<div class="muted" style="margin-top:8px;">Notes: ${String(j||"")}</div>`:"",Ce=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Return Receipt</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; vertical-align: top; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        <h1>RETURN RECEIPT</h1>
        <div class="center muted">Sales Return & Refund</div>
        <hr />
        <div class="row"><span>Return Ref:</span><span>${String(P.ref||"-")}</span></div>
        <div class="row"><span>Original Receipt:</span><span>${String(A.receiptNo||"-")}</span></div>
        <div class="row"><span>Sale Date:</span><span>${String(A.date||"-")}</span></div>
        <div class="row"><span>Return Date:</span><span>${ct}</span></div>
        <div class="row"><span>Refund Method:</span><span>${String(P.method||"-")}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Total</th>
              <th>Reason</th>
            </tr>
          </thead>
          <tbody>
            ${xt}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Items Subtotal</span><span>${ce.toFixed(2)}</span></div>
          <div class="row"><span>Tax Refund</span><span>${re.toFixed(2)}</span></div>
          <div class="row"><strong>Total Refund</strong><strong>${de.toFixed(2)}</strong></div>
        </div>
        ${be}
        <button onclick="window.print()">Print</button>
      </body>
      </html>
    `,Te=document.createElement("iframe");Te.style.position="fixed",Te.style.right="0",Te.style.bottom="0",Te.style.width="0",Te.style.height="0",Te.style.border="0",document.body.appendChild(Te);const ue=((Ve=Te.contentWindow)==null?void 0:Ve.document)||Te.contentDocument||null;if(!ue)return;ue.open(),ue.write(Ce),ue.close();const ge=Te.contentWindow;ge&&(ge.focus(),setTimeout(()=>{try{ge.print()}catch{}setTimeout(()=>{try{document.body.removeChild(Te)}catch{}},500)},150))}const ot=x.useMemo(()=>(Array.isArray(q)?q:[]).filter(Ke=>{const ct=String(l||"").trim().toLowerCase(),xt=String(u||"").trim().toLowerCase();return!(ct&&!String(Ke.customer||"").toLowerCase().includes(ct)||xt&&String(Ke.payment||"").toLowerCase()!==xt)}).map(Ke=>{const ct=String(Ke.receiptNo||"-"),xt=String(Ke.date||""),be=xt?`${ct}  ${xt}`:ct;return{value:String(Ke.id),label:be}}),[q,l,u]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Sales Return & Refund"}),e.jsx("p",{className:"text-sm mt-1",children:"Process returns from original receipts"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:t.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:t.toLocaleTimeString()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[!I&&!M&&e.jsxs("div",{className:"alert-danger rounded-lg p-4",children:["Day is not open. Open day before processing returns.",e.jsx("div",{className:"mt-2",children:e.jsx(Le,{to:"/pos/day-management",className:"btn-secondary",children:"Open Day Management"})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Find Original Sale"})}),e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sale Date"}),e.jsx("input",{type:"date",className:"input",value:n,onChange:Ke=>i(Ke.target.value),disabled:!M})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Receipt Number"}),e.jsx(pb,{value:r,onChange:a,options:ot,placeholder:c?"Loading receipts...":"Select receipt",disabled:!M||c,filterPlaceholder:"Filter receipts..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Phone"}),e.jsx("input",{className:"input",placeholder:"e.g., 0244123456",value:l,onChange:Ke=>o(Ke.target.value),disabled:!M})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment Method"}),e.jsx(pb,{value:u,onChange:d,options:[{value:"cash",label:"Cash"},{value:"card",label:"Card"},{value:"mobile",label:"Mobile Money"}],placeholder:"All Methods",disabled:!M,filterPlaceholder:"Filter methods..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsx(pb,{value:Y,onChange:Ke=>{J(Ke),v(ct=>ct.map(xt=>({...xt})))},options:T.map(Ke=>({value:String(Ke.id),label:String(Ke.name||"")})),placeholder:D?"Loading price types...":"Select Price Type",disabled:!M||D||!T.length,filterPlaceholder:"Filter price types..."})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn-primary w-full",onClick:Ie,disabled:!M||!r,children:"Search Receipt"})})]})]}),A?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Receipt Number"}),e.jsx("div",{className:"font-medium",children:A.receiptNo})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Sale Date"}),e.jsx("div",{className:"font-medium",children:A.date})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Customer"}),e.jsx("div",{className:"font-medium",children:A.customer})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"text-slate-500",children:"Payment Method"}),e.jsx("div",{className:"font-medium",children:A.payment})]}),e.jsxs("div",{className:"flex justify-between md:col-span-2",children:[e.jsx("div",{className:"text-slate-500",children:"Original Total"}),e.jsx("div",{className:"font-medium",children:(()=>{const Ke=A.items.reduce((xt,be)=>xt+be.price*be.quantity,0),ct=Ke*.125;return`GH ${(Ke+ct).toFixed(2)}`})()})]})]})})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"font-semibold",children:"Select Items to Return"})}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Return"}),e.jsx("th",{children:"Item Name"}),e.jsx("th",{className:"text-right",children:"Price"}),e.jsx("th",{className:"text-right",children:"Sold Qty"}),e.jsx("th",{className:"text-right",children:"Return Qty"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:A.items.map(Ke=>{const ct=g.find(xt=>xt.id===Ke.id);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",className:"checkbox",checked:!!ct,onChange:xt=>le(Ke.id,xt.target.checked)})}),e.jsx("td",{className:"font-medium",children:Ke.name}),e.jsx("td",{className:"text-right",children:`GH ${Number(Ke.price).toFixed(2)}`}),e.jsx("td",{className:"text-right",children:Ke.quantity}),e.jsx("td",{className:"text-right",children:e.jsx("input",{type:"number",className:"input w-24 text-right",min:1,max:Ke.quantity,value:ct?ct.returnQuantity:1,disabled:!ct,onChange:xt=>Z(Ke.id,xt.target.value)})}),e.jsx("td",{children:e.jsxs("select",{className:"input",value:ct?ct.reason:"defective",disabled:!ct,onChange:xt=>ve(Ke.id,xt.target.value),children:[e.jsx("option",{value:"defective",children:"Defective"}),e.jsx("option",{value:"wrong",children:"Wrong Item"}),e.jsx("option",{value:"damaged",children:"Damaged"}),e.jsx("option",{value:"unwanted",children:"Unwanted"}),e.jsx("option",{value:"other",children:"Other"})]})})]},Ke.id)})})]})})]})]}):e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-center text-slate-600",children:"Search for a receipt to process returns"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Return Summary"})}),e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:g.length?g.map(Ke=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-medium text-slate-900",children:Ke.name}),e.jsx("div",{className:"text-red-600 font-semibold",children:`-GH ${(Ke.price*Ke.returnQuantity).toFixed(2)}`})]}),e.jsxs("div",{className:"text-xs text-slate-600 mt-1",children:[Ke.returnQuantity,"  GH"," ",Number(Ke.price).toFixed(2)," "," ",String(Ke.reason||"").replace(/^./,ct=>ct.toUpperCase())]}),e.jsx("div",{className:"mt-2",children:e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>Ue(Ke.id),children:"Remove"})})]},Ke.id)):e.jsx("div",{className:"text-center text-slate-600",children:"No items selected for return"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Items Subtotal"}),e.jsx("div",{children:`GH ${ce.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax Refund"}),e.jsx("div",{children:`GH ${re.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("div",{children:"Total Refund"}),e.jsx("div",{className:"text-red-700",children:`GH ${de.toFixed(2)}`})]})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"font-semibold",children:"Refund Method"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{type:"button",className:`btn ${b==="cash"?"btn-primary":"btn-secondary"}`,onClick:()=>y("cash"),children:"Cash"}),e.jsx("button",{type:"button",className:`btn ${b==="card"?"btn-primary":"btn-secondary"}`,onClick:()=>y("card"),children:"Card"}),e.jsx("button",{type:"button",className:`btn ${b==="mobile"?"btn-primary":"btn-secondary"}`,onClick:()=>y("mobile"),children:"Mobile Money"}),e.jsx("button",{type:"button",className:`btn ${b==="credit"?"btn-primary":"btn-secondary"}`,onClick:()=>y("credit"),children:"Store Credit"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Additional Notes"}),e.jsx("textarea",{className:"input",value:j,onChange:Ke=>N(Ke.target.value),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx("button",{type:"button",className:"btn-primary w-full",onClick:_e,disabled:!M||!g.length,children:"Process Return"}),e.jsx("button",{type:"button",className:"btn-secondary w-full",onClick:Be,disabled:!M||!g.length,children:"Clear Selection"})]})]})})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"Return Processed"}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Refund Amount"}),e.jsx("div",{className:"font-semibold",children:`GH ${Number(P.amount).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Refund Method"}),e.jsx("div",{className:"font-semibold",children:P.method})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Return Reference"}),e.jsx("div",{className:"font-semibold",children:P.ref})]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:Me,children:"New Return"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{Ye(),Me()},children:"Print Return Receipt"})]})]})})]})}function xb({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"All"}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function OZ(){const{user:t}=ca(),[s,r]=x.useState(new Date),[a,n]=x.useState(""),[i,l]=x.useState(""),[o,u]=x.useState(""),[d,c]=x.useState(""),[h,A]=x.useState(""),[f,g]=x.useState([]),[v,b]=x.useState(null),[y,j]=x.useState(1),N=10,[S,B]=x.useState(""),[P,L]=x.useState([]),[U,H]=x.useState(!1);x.useEffect(()=>{const R=setInterval(()=>r(new Date),1e3);return()=>clearInterval(R)},[]),x.useEffect(()=>{let R=!1;async function X(){var ne,te,oe;H(!0);try{const[ce,re]=await Promise.all([ee.get("/pos/terminals"),ee.get("/pos/terminal-users")]);if(R)return;const de=Array.isArray((ne=ce.data)==null?void 0:ne.items)?ce.data.items:[],Ie=Array.isArray((te=re.data)==null?void 0:te.items)?re.data.items:[],le=Number((t==null?void 0:t.sub)||0)||Number((t==null?void 0:t.id)||0)||void 0,Z=new Set(Ie.filter(Be=>Number(Be==null?void 0:Be.user_id)===le).map(Be=>Number(Be==null?void 0:Be.terminal_id)).filter(Be=>Number.isFinite(Be)&&Be>0)),ve=de.filter(Be=>Z.has(Number(Be==null?void 0:Be.id)));L(ve);const Ue=(ve.length?String(((oe=ve[0])==null?void 0:oe.code)||""):"")||"";B(Ue)}catch{if(R)return;L([]),B("")}finally{if(R)return;H(!1)}}return X(),()=>{R=!0}},[t==null?void 0:t.id,t==null?void 0:t.sub]),x.useEffect(()=>{let R=!1;const X=S?{params:{terminal:S}}:{};return ee.get("/pos/sales",X).then(ne=>{var ce;if(R)return;const oe=(Array.isArray((ce=ne.data)==null?void 0:ce.items)?ne.data.items:[]).map(re=>{const de=String(re.sale_date||""),Ie=de.slice(0,10),le=de.includes("T")?de.split("T")[1].slice(0,8):"";return{id:re.id,receiptNo:String(re.sale_no||""),date:Ie,time:le,customer:String(re.customer_id||""),phone:"",payment:String(re.payment_method||"").toLowerCase(),status:String(re.payment_status||"").toLowerCase(),items:[],total_amount:Number(re.total_amount||0),items_count:Number(re.items_count||0)}});g(oe)}).catch(()=>{R||g([])}),()=>{R=!0}},[S]);const q=R=>{const X=R.reduce((te,oe)=>te+oe.price*oe.quantity,0),ne=X*.125;return X+ne},V=R=>R.reduce((X,ne)=>X+ne.price*ne.quantity,0),M=x.useMemo(()=>{const R=String(h||"").toLowerCase();return f.filter(X=>{const ne=(!a||X.date>=a)&&(!i||X.date<=i),te=!o||X.status===o,oe=!d||X.payment===d,ce=!R||X.receiptNo.toLowerCase().includes(R)||X.customer.toLowerCase().includes(R);return ne&&te&&oe&&ce})},[f,a,i,o,d,h]),z=Math.max(1,Math.ceil(M.length/N)),I=x.useMemo(()=>{const R=(y-1)*N,X=R+N;return M.slice(R,X)},[M,y]);x.useEffect(()=>{j(1)},[a,i,o,d,h]);function G(){const R=["Receipt","Date","Time","Customer","Phone","Payment","Status","Items","Total"],X=M.map(re=>[re.receiptNo,re.date,re.time,re.customer,re.phone,re.payment,re.status,re.items.reduce((de,Ie)=>de+Ie.quantity,0),q(re.items).toFixed(2)]),ne=[R.join(","),...X.map(re=>re.join(","))].join(`
`),te=new Blob([ne],{type:"text/csv;charset=utf-8;"}),oe=URL.createObjectURL(te),ce=document.createElement("a");ce.href=oe,ce.download="pos_register.csv",ce.click(),URL.revokeObjectURL(oe)}function Y(){window.print()}function J(){alert("Register closing flow will be implemented with sessions.")}function T(R){alert("Printing transaction "+R)}function k(R){g(X=>X.filter(ne=>ne.id!==R))}async function D(R){var X;try{const ne=await ee.get(`/pos/sales/${R.id}`),oe=(Array.isArray((X=ne.data)==null?void 0:X.details)?ne.data.details:[]).map(ce=>({name:String(ce.item_name||""),price:Number(ce.unit_price||0),quantity:Number(ce.qty||0)}));b({...R,items:oe})}catch{b(R)}}function Q(){b(null)}function C(){alert("Printing receipt "+String((v==null?void 0:v.receiptNo)||""))}function E(){alert("Emailing receipt "+String((v==null?void 0:v.receiptNo)||""))}const w=M.length?(y-1)*N+1:0,O=Math.min(y*N,M.length);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Register"}),e.jsx("p",{className:"text-sm mt-1",children:"Transactions listing and details"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:s.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:s.toLocaleTimeString()})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal"}),e.jsx(xb,{value:S,onChange:B,placeholder:U?"Loading terminals...":"All Terminals (assigned)",options:(Array.isArray(P)?P:[]).map(R=>({value:String(R.code||""),label:String(R.code||R.name||"")})),disabled:U,filterPlaceholder:"Filter terminals..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{type:"date",className:"input",value:a,onChange:R=>n(R.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{type:"date",className:"input",value:i,onChange:R=>l(R.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsx(xb,{value:o,onChange:u,placeholder:"All Status",options:[{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"returned",label:"Returned"}],filterPlaceholder:"Filter status..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Payment"}),e.jsx(xb,{value:d,onChange:c,placeholder:"All Payments",options:[{value:"cash",label:"Cash"},{value:"card",label:"Card"},{value:"mobile",label:"Mobile Money"}],filterPlaceholder:"Filter payments..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input",placeholder:"Search receipt or customer",value:h,onChange:R=>A(R.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:G,children:"Export CSV"}),e.jsx("button",{className:"btn-primary",onClick:Y,children:"Print"}),e.jsx("button",{className:"btn-danger",onClick:J,children:"Close Register"})]})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Receipt #"}),e.jsx("th",{children:"Date/Time"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Payment"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:I.length?I.map(R=>{const X=Number(R.total_amount||0),ne=Number(R.items_count||0);return e.jsxs("tr",{onClick:()=>D(R),className:"cursor-pointer",children:[e.jsx("td",{className:"font-medium",children:R.receiptNo}),e.jsxs("td",{children:[R.date,e.jsx("div",{className:"text-xs text-slate-500",children:R.time})]}),e.jsxs("td",{children:[R.customer,e.jsx("div",{className:"text-xs text-slate-500",children:R.phone})]}),e.jsx("td",{children:ne}),e.jsx("td",{children:e.jsx("span",{className:"px-2 py-1 rounded bg-slate-100 text-slate-700 text-xs",children:String(R.payment||"").toUpperCase()})}),e.jsx("td",{className:"text-right",children:`GH ${Number(X).toFixed(2)}`}),e.jsx("td",{children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${R.status==="completed"?"bg-green-100 text-green-700":R.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:String(R.status||"").toUpperCase()})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:te=>{te.stopPropagation(),D(R)},children:"View"}),e.jsx("button",{className:"btn btn-secondary",onClick:te=>{te.stopPropagation(),T(R.id)},children:"Print"}),e.jsx("button",{className:"btn btn-danger",onClick:te=>{te.stopPropagation(),k(R.id)},children:"Delete"})]})})]},R.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:e.jsx("div",{className:"text-center text-slate-600 py-6",children:"No transactions found"})})})})]})})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm",children:["Showing ",w," to ",O," of ",M.length," transactions"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>j(R=>Math.max(1,R-1)),disabled:y===1,children:" Previous"}),Array.from({length:z},(R,X)=>X+1).map(R=>e.jsx("button",{className:`btn ${y===R?"btn-primary":"btn-secondary"}`,onClick:()=>j(R),children:R},R)),e.jsx("button",{className:"btn btn-secondary",onClick:()=>j(R=>Math.min(z,R+1)),disabled:y>=z,children:"Next "})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xl font-bold",children:"Transaction Details"}),e.jsx("button",{className:"btn btn-secondary",onClick:Q,children:"Close"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mt-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Receipt Number"}),e.jsx("div",{className:"font-medium",children:v.receiptNo})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Date & Time"}),e.jsxs("div",{className:"font-medium",children:[v.date," ",v.time]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Customer"}),e.jsx("div",{className:"font-medium",children:v.customer})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Payment Method"}),e.jsx("div",{className:"font-medium",children:String(v.payment||"").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Cashier"}),e.jsx("div",{className:"font-medium",children:v.cashier})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Status"}),e.jsx("div",{className:"font-medium",children:String(v.status||"").toUpperCase()})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"font-semibold mb-2",children:"Items Purchased"}),e.jsx("div",{className:"space-y-2",children:v.items.map((R,X)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:R.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:[R.quantity,"  GH ",Number(R.price).toFixed(2)]})]}),e.jsx("div",{className:"font-semibold",children:`GH ${(R.quantity*R.price).toFixed(2)}`})]},X))})]}),e.jsxs("div",{className:"mt-4 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{children:`GH ${V(v.items).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax"}),e.jsx("div",{children:`GH ${(V(v.items)*.125).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{children:`GH ${q(v.items).toFixed(2)}`})]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:C,children:"Print Receipt"}),e.jsx("button",{className:"btn btn-secondary",onClick:E,children:"Email Receipt"})]})]})})]})}function QZ({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function MZ(){const{user:t}=ca(),[s,r]=x.useState(new Date),[a,n]=x.useState(""),[i,l]=x.useState([]),[o,u]=x.useState(!1),[d,c]=x.useState(""),[h,A]=x.useState(""),[f,g]=x.useState(""),[v,b]=x.useState(""),[y,j]=x.useState(1),[N,S]=x.useState(""),[B,P]=x.useState([]),[L,U]=x.useState([]),[H,q]=x.useState(!1),[V,M]=x.useState(""),[z,I]=x.useState([]),[G,Y]=x.useState(!1),[J,T]=x.useState(""),[k,D]=x.useState(!1),[Q,C]=x.useState(null),[E,w]=x.useState([]),[O,R]=x.useState(!1),[X,ne]=x.useState(""),[te,oe]=x.useState(""),[ce,re]=x.useState(12.5),[de,Ie]=x.useState("Exclusive"),[le,Z]=x.useState(""),[ve,Ue]=x.useState(!0),[Be,_e]=x.useState(!1),[Me,Ye]=x.useState(!0),[ot,Ke]=x.useState(""),[ct,xt]=x.useState(""),[be,Ce]=x.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:qs});x.useMemo(()=>{const Qe=String(a||"").toLowerCase();return Qe?L.filter(he=>he.name.toLowerCase().includes(Qe)||he.code.toLowerCase().includes(Qe)):L},[L,a]);const Te=x.useMemo(()=>(Array.isArray(L)?L:[]).map(Qe=>({value:String(Qe.id),label:(Qe.code?`${Qe.code} - `:"")+String(Qe.name||"")})),[L]),ue=x.useMemo(()=>{const Qe=String(v||"").trim().toLowerCase();return Qe?Te.filter(he=>String(he.label||"").trim().toLowerCase().includes(Qe)).slice(0,10):[]},[v,Te]);x.useEffect(()=>{const Qe=setInterval(()=>r(new Date),1e3);return()=>clearInterval(Qe)},[]),x.useEffect(()=>{let Qe=!1;async function he(){var pe,ye,Ne,He;Ye(!0);try{const Ge=Number((t==null?void 0:t.sub)||0)||Number((t==null?void 0:t.id)||0)||void 0,[gt,kt]=await Promise.all([ee.get("/pos/terminals"),ee.get("/pos/terminal-users")]),yt=Array.isArray((pe=gt.data)==null?void 0:pe.items)?gt.data.items:[],Et=Array.isArray((ye=kt.data)==null?void 0:ye.items)?kt.data.items:[],Ft=new Set(Et.filter(Os=>Number(Os==null?void 0:Os.user_id)===Number(Ge)).map(Os=>Number(Os==null?void 0:Os.terminal_id)).filter(Os=>Number.isFinite(Os)&&Os>0)),Yt=yt.filter(Os=>Ft.has(Number(Os==null?void 0:Os.id))),rs=(Yt.length?String(((Ne=Yt[0])==null?void 0:Ne.code)||""):"")||"";Ke(rs);const As=rs?{params:{terminal:rs}}:void 0,es=await ee.get("/pos/day/status",As),Jt=((He=es==null?void 0:es.data)==null?void 0:He.item)||null,Ps=String((Jt==null?void 0:Jt.status)||"").toUpperCase()==="OPEN";_e(Ps)}catch{if(Qe)return;_e(!1)}finally{if(Qe)return;Ye(!1)}}return he(),()=>{Qe=!0}},[t==null?void 0:t.id,t==null?void 0:t.sub]),x.useEffect(()=>{let Qe=!0;return R(!0),ne(""),ee.get("/pos/payment-modes").then(he=>{var Ne;if(!Qe)return;const ye=(Array.isArray((Ne=he.data)==null?void 0:Ne.items)?he.data.items:[]).filter(He=>He&&He.is_active!==0&&He.is_active!==!1);if(w(ye),!te&&ye.length){let He=ye.find(Ge=>String(Ge.type||"").trim().toLowerCase()==="cash")||ye[0];He&&He.id&&oe(String(He.id))}}).catch(he=>{var pe,ye;Qe&&ne(((ye=(pe=he==null?void 0:he.response)==null?void 0:pe.data)==null?void 0:ye.message)||"Failed to load payment modes")}).finally(()=>{Qe&&R(!1)}),()=>{Qe=!1}},[te]),x.useEffect(()=>{let Qe=!0;return ee.get("/pos/tax-settings").then(he=>{var kt;if(!Qe)return;const pe=((kt=he.data)==null?void 0:kt.item)||null;if(!pe){Ue(!1),re(0),Ie("Exclusive"),Z("");return}const ye=pe.is_active!==0&&pe.is_active!==!1;if(Ue(ye),!ye){re(0),Ie("Exclusive"),Z("");return}pe.tax_type&&Ie(String(pe.tax_type));const Ne=Number(pe.tax_rate_percent??12.5);re(Number.isFinite(Ne)?Ne:12.5);const He=String(pe.tax_name||"").trim(),Ge=String(pe.tax_code||"").trim(),gt=String(pe.tax_code_id||"").trim();Z(He||Ge||gt||"")}).catch(()=>{Qe&&(Ue(!1),re(0),Ie("Exclusive"),Z(""))}),()=>{Qe=!1}},[]),x.useEffect(()=>{let Qe=!0;async function he(){var pe,ye,Ne;try{const Ge=(ye=(pe=(await ee.get("/admin/me")).data)==null?void 0:pe.scope)==null?void 0:ye.companyId;if(!Ge){if(!Qe)return;Ce(yt=>({...yt,logoUrl:yt.logoUrl||qs}));return}const kt=((Ne=(await ee.get(`/admin/companies/${Ge}`)).data)==null?void 0:Ne.item)||{};if(!Qe)return;Ce(yt=>({...yt,name:kt.name||yt.name||"",address:kt.address||yt.address||"",city:kt.city||yt.city||"",state:kt.state||yt.state||"",country:kt.country||yt.country||"",phone:kt.telephone||yt.phone||"",email:kt.email||yt.email||"",website:kt.website||yt.website||"",taxId:kt.tax_id||yt.taxId||"",registrationNo:kt.registration_no||yt.registrationNo||"",logoUrl:kt.has_logo===1||kt.has_logo===!0?`/api/admin/companies/${Ge}/logo`:yt.logoUrl||qs}))}catch{if(!Qe)return;Ce(He=>({...He,logoUrl:He.logoUrl||qs}))}}return he(),()=>{Qe=!1}},[]),x.useEffect(()=>{let Qe=!0;return Y(!0),T(""),ee.get("/sales/price-types").then(he=>{var ye;if(!Qe)return;const pe=Array.isArray((ye=he.data)==null?void 0:ye.items)?he.data.items:[];if(I(pe),!N&&pe.length){let Ne=pe.find(He=>String(He.name||"").trim().toLowerCase()==="retail")||pe[0];Ne&&Ne.id&&S(String(Ne.id))}}).catch(he=>{var pe,ye;Qe&&T(((ye=(pe=he==null?void 0:he.response)==null?void 0:pe.data)==null?void 0:ye.message)||"Failed to load price types")}).finally(()=>{Qe&&Y(!1)}),()=>{Qe=!1}},[N]),x.useEffect(()=>{let Qe=!0;return q(!0),M(""),ee.get("/inventory/items").then(he=>{var Ne;if(!Qe)return;const ye=(Array.isArray((Ne=he.data)==null?void 0:Ne.items)?he.data.items:[]).filter(He=>He&&He.is_active!==!1).map(He=>({id:He.id,name:He.item_name||"",code:He.item_code||"",price:Number(He.selling_price??0),availQty:Number(He.avail_qty??0),image_url:He.image_url||"",barcode:He.barcode||""}));U(ye)}).catch(he=>{var pe,ye;Qe&&M(((ye=(pe=he==null?void 0:he.response)==null?void 0:pe.data)==null?void 0:ye.message)||"Failed to load items")}).finally(()=>{Qe&&q(!1)}),()=>{Qe=!1}},[]);const ge=x.useMemo(()=>i.reduce((Qe,he)=>{const pe=Number(he.quantity||0),ye=Number(he.price||0);return Qe+pe*ye},0),[i]),Ve=x.useMemo(()=>i.reduce((Qe,he)=>{const pe=Number(he.quantity||0),ye=Number(he.price||0),Ne=Number(he.discount||0),He=Math.max(0,pe*ye-Ne);return Qe+He},0),[i]),tt=x.useMemo(()=>{const Qe=ge-Ve;return!Number.isFinite(Qe)||Qe<0?0:Qe},[ge,Ve]),Ze=x.useMemo(()=>{const Qe=Number(ce||0)/100;return!Qe||Ve<=0?0:Ve*Qe},[Ve,ce]),ht=x.useMemo(()=>Ve+Ze,[Ve,Ze]),ze=x.useMemo(()=>{const Qe=Number(ct||0);return Number.isFinite(Qe)?Qe:0},[ct]),Fe=x.useMemo(()=>{const Qe=ze-ht;return Number.isFinite(Qe)?Qe:0},[ze,ht]),xe=x.useRef(null),we=x.useRef(null),Xe=x.useRef(null),ut=x.useMemo(()=>!E.length||!te?null:E.find(Qe=>String(Qe.id)===String(te))||null,[E,te]);function ft(Qe){const he=String((Qe==null?void 0:Qe.type)||"").toLowerCase();return he==="cash"?"CASH":he==="card"||he==="bank"?"CARD":he==="mobile"?"MOBILE":"CASH"}async function mt(Qe,he,pe){var ye;try{const Ne={product_id:Qe,quantity:1,price_type:he||"",only_standard:!0},He=await ee.post("/sales/prices/best-price",Ne),Ge=Number((ye=He.data)==null?void 0:ye.price);return Number.isFinite(Ge)?Ge:Number(pe||0)}catch{return Number(pe||0)}}async function pt(Qe,he){const ye=Math.max(1,Number(he));if(!Qe||!ye)return;const Ne=await mt(Qe.id,N,Qe.price);if(l(He=>He.find(gt=>gt.id===Qe.id)?He.map(gt=>{if(gt.id!==Qe.id)return gt;const kt=gt.quantity+ye;return{...gt,quantity:kt,price:Ne,discount:Number(gt.discount||0)}}):[...He,{id:Qe.id,name:Qe.name,code:Qe.code,price:Ne,quantity:ye,discount:0}]),P(He=>He.some(Ge=>Ge.id===Qe.id)?He:[...He,Qe]),g(String(Qe.id)),A(""),j(1),Xe.current)try{Xe.current.focus()}catch{}if(xe.current)try{xe.current.scrollIntoView({behavior:"smooth",block:"start"})}catch{}}function vt(Qe){const he=L.find(pe=>String(pe.id)===String(Qe))||null;he&&pt(he,1),b("")}function Ot(Qe,he){l(pe=>pe.map(Ne=>Ne.id===Qe?{...Ne,quantity:Math.max(0,Number(Ne.quantity||0)+he)}:Ne).filter(Ne=>Number(Ne.quantity||0)>0))}function Ae(Qe,he,pe){l(ye=>ye.map(Ne=>{if(Ne.id!==Qe)return Ne;if(he==="quantity"){const He=Number(pe||0);return{...Ne,quantity:He>0?He:0}}if(he==="discount"){const He=Number(pe||0);return{...Ne,discount:He>=0?He:0}}return Ne}).filter(Ne=>Number(Ne.quantity||0)>0))}function je(Qe){l(he=>he.filter(pe=>pe.id!==Qe)),P(he=>he.filter(pe=>pe.id!==Qe)),Number(f||0)===Qe&&(g(""),j(1))}function We(Qe){je(Qe)}function De(){i.length&&(l([]),P([]))}x.useEffect(()=>{we.current&&(clearTimeout(we.current),we.current=null);const Qe=String(h||"").trim().toLowerCase();if(!Qe)return;const he=L.find(pe=>{const ye=String(pe.code||"").toLowerCase(),Ne=String(pe.name||"").toLowerCase(),He=String(pe.barcode||"").toLowerCase();return ye===Qe||Ne===Qe||He===Qe});return he&&(we.current=setTimeout(()=>{pt(he,1)},120)),()=>{we.current&&(clearTimeout(we.current),we.current=null)}},[h,L]),x.useEffect(()=>{const Qe=Number(f||0);if(!Qe)return;const he=i.find(ye=>ye.id===Qe);if(!he){j(1);return}const pe=Number(he.quantity||0);j(pe||0)},[i,f]),x.useEffect(()=>{P(Qe=>(Array.isArray(Qe)?Qe:[]).filter(he=>i.some(pe=>pe.id===he.id)))},[i]),x.useEffect(()=>{if(Be&&Xe.current)try{Xe.current.focus()}catch{}},[Be]);async function lt(){var Qe,he,pe,ye,Ne,He;if(!(!i.length||o)){if(!Be)try{const Ge=ot?{params:{terminal:ot}}:void 0,gt=await ee.get("/pos/day/status",Ge),kt=((Qe=gt==null?void 0:gt.data)==null?void 0:Qe.item)||null;if(!(String((kt==null?void 0:kt.status)||"").toUpperCase()==="OPEN")){alert("Day is not open. Please open the POS day before sales entry.");return}_e(!0)}catch{alert("Day is not open. Please open the POS day before sales entry.");return}try{u(!0);let Ge=te?String(te):"";if(!Ge){const Yt=Array.isArray(E)?E:[],rs=Yt.find(As=>String(As.type||"").trim().toLowerCase()==="cash")||Yt[0];rs!=null&&rs.id&&(Ge=String(rs.id),oe(String(rs.id)))}if(!Ge){alert("Please configure a POS payment mode before completing a sale.");return}const gt=i.map(Yt=>({item_id:Yt.id,name:Yt.name,quantity:Number(Yt.quantity||0),price:Number(Yt.price||0),discount:Number(Yt.discount||0)})),yt={payment_method:ft(ut),payment_mode_id:Number(Ge),customer_name:null,lines:gt,status:"COMPLETED",terminal:ot||"",tax_rate_percent:ve?ce:0,tax_type:ve?de:"Exclusive"},Et=await ee.post("/pos/sales",yt),Ft=String(((he=Et.data)==null?void 0:he.receipt_no)||"");c(Ft),C(new Date),D(!0)}catch(Ge){const gt=((ye=(pe=Ge==null?void 0:Ge.response)==null?void 0:pe.data)==null?void 0:ye.message)||((He=(Ne=Ge==null?void 0:Ge.response)==null?void 0:Ne.data)==null?void 0:He.error)||"Failed to complete sale";alert(gt)}finally{u(!1)}}}function rt(){if(D(!1),l([]),P([]),c(""),A(""),g(""),j(1),C(null),Xe.current)try{Xe.current.focus()}catch{}}async function et(){var Qe;try{const pe=((Qe=(await ee.get("/pos/receipt-settings")).data)==null?void 0:Qe.item)||null;return pe?{companyName:pe.company_name||"",showLogo:pe.show_logo===1||pe.show_logo===!0||pe.show_logo==="1",headerText:pe.header_text||"",footerText:pe.footer_text||"",contactNumber:pe.contact_number||"",addressLine1:pe.address_line1||"",addressLine2:pe.address_line2||"",logoUrl:pe.logo_url||""}:{}}catch{return{}}}async function Qt(){var Lr;if(!i.length)return;const Qe=await et(),pe=(Q?new Date(Q):new Date).toLocaleString(),ye=(t==null?void 0:t.username)||(t==null?void 0:t.name)||(t==null?void 0:t.fullName)||"Cashier",Ne=(ut==null?void 0:ut.name)||(function(){const Wr=String((ut==null?void 0:ut.type)||"").toLowerCase();return Wr==="cash"?"Cash":Wr==="card"?"Card":Wr==="mobile"?"Mobile Money":Wr==="bank"?"Bank":"Other"})(),He=String(Qe.companyName||be.name||"Company Name"),Ge=[];be.address&&Ge.push(be.address);const gt=[be.city,be.state].filter(Boolean).join(", ");gt&&Ge.push(gt),be.country&&Ge.push(be.country);const kt=String(Ge[0]||Qe.addressLine1||"Street address"),yt=String(Ge.slice(1).join("  ")||Qe.addressLine2||"City, State, ZIP"),Et=String(be.phone||Qe.contactNumber||"+1234567890"),Ft=String(Qe.headerText||"Thank you for your purchase"),Yt=String(Qe.footerText||"Please visit again"),rs=[];be.taxId&&rs.push(`TIN: ${be.taxId}`),be.website&&rs.push(be.website);const As=rs.join("  ");let Jt=!!Qe.showLogo?String(Qe.logoUrl||"").trim():"";if(Jt&&!(Jt.startsWith("http://")||Jt.startsWith("https://")||Jt.startsWith("data:"))){const mr=window.location.origin||"";Jt.startsWith("/")?Jt=mr+Jt:Jt=mr+"/"+Jt}const Ps=Jt?`<div class="center"><img src="${Jt}" alt="${He}" style="max-height:100px;margin-bottom:8px;object-fit:contain;" /></div>`:"",Os=i.map(Wr=>{const mr=Number(Wr.quantity||0),Dr=Number(Wr.price||0),vl=Number(Wr.discount||0),Po=Math.max(0,mr*Dr-vl);return`
          <tr>
            <td>${Wr.name||""}</td>
            <td class="right">${mr}</td>
            <td class="right">GH ${Dr.toFixed(2)}</td>
            <td class="right">GH ${vl.toFixed(2)}</td>
            <td class="right">GH ${Po.toFixed(2)}</td>
          </tr>
        `}).join(""),lr=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Receipt</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          .footer { margin-top: 10px; text-align: center; font-size: 11px; white-space: pre-wrap; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        ${Ps}
        <h1>${He}</h1>
        <div class="center muted">${kt}</div>
        <div class="center muted">${yt}</div>
        <div class="center muted">Mobile: ${Et}</div>
        ${As?`<div class="center muted">${As}</div>`:""}
        <div class="center muted" style="margin-top:6px;">${Ft}</div>
        <hr />
        <div class="row"><span>Receipt No:</span><span>${d||"-"}</span></div>
        <div class="row"><span>Date:</span><span>${pe}</span></div>
        <div class="row"><span>Cashier:</span><span>${ye}</span></div>
        <div class="row"><span>Payment:</span><span>${Ne}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Disc</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${Os}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Subtotal</span><span>GH ${Ve.toFixed(2)}</span></div>${ve?`<div class="row"><span>Tax</span><span>GH ${Ze.toFixed(2)}</span></div>`:""}
          <div class="row"><strong>Grand Total</strong><strong>GH ${ht.toFixed(2)}</strong></div>
          <div class="row"><span>Amount Paid</span><span>GH ${ze.toFixed(2)}</span></div>
          <div class="row"><span>${Fe>=0?"Change":"Amount Due"}</span><span>GH ${Math.abs(Fe).toFixed(2)}</span></div>
        </div>
        <div class="footer">${Yt}</div>
      </body>
      </html>
    `,zs=document.createElement("iframe");zs.style.position="fixed",zs.style.right="0",zs.style.bottom="0",zs.style.width="0",zs.style.height="0",zs.style.border="0",document.body.appendChild(zs);const ba=((Lr=zs.contentWindow)==null?void 0:Lr.document)||zs.contentDocument||null;if(!ba){document.body.removeChild(zs);return}ba.open(),ba.write(lr),ba.close();const dn=zs.contentWindow||window;setTimeout(()=>{dn.focus();try{dn.print()}catch{}setTimeout(()=>{document.body.removeChild(zs)},100)},200)}return e.jsxs("div",{className:"space-y-6 pos-sales-entry",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Sales Entry"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:s.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:s.toLocaleTimeString()}),e.jsxs("div",{className:"mt-1 text-xs",children:[e.jsx("span",{className:"mr-2",children:"Terminal:"}),e.jsx("span",{className:"font-semibold",children:ot||"-"}),e.jsxs("span",{className:"ml-3",children:["Status:",e.jsx("span",{className:`ml-1 px-2 py-0.5 rounded ${Be?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:Be?"Open":"Closed"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[!Me&&!Be&&e.jsxs("div",{className:"alert-danger rounded-lg p-4",children:["Day is not open. Open day before sales entry.",e.jsx("div",{className:"mt-2",children:e.jsx(Le,{to:"/pos/day-management",className:"btn-secondary",children:"Open Day Management"})})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Barcode"}),e.jsx("input",{className:"input",placeholder:"Scan or type barcode",value:h,onChange:Qe=>A(Qe.target.value),ref:Xe,autoFocus:!0,disabled:!Be})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Item"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{className:"input",placeholder:H?"Loading items...":"Type to search items",value:v,onChange:Qe=>b(Qe.target.value),onKeyDown:Qe=>{Qe.key==="Enter"&&ue.length&&vt(ue[0].value)},disabled:!Be||H||!L.length}),v&&ue.length?e.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border border-slate-200 rounded-lg shadow-lg max-h-48 overflow-auto",children:ue.map(Qe=>e.jsx("button",{type:"button",className:"block w-full text-left px-3 py-2 hover:bg-slate-50",onClick:()=>vt(Qe.value),children:Qe.label},Qe.value))}):null]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quantity"}),e.jsx("input",{type:"number",className:"input",min:1,value:y,onChange:Qe=>{const he=Qe.target.value;j(he);const pe=Number(f||0);pe&&Ae(pe,"quantity",he)},disabled:!Be})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Price Type"}),e.jsx(QZ,{value:N,onChange:Qe=>S(Qe),options:z.map(Qe=>({value:String(Qe.id),label:String(Qe.name||"")})),placeholder:G?"Loading price types...":"Select Price Type",disabled:!Be||G||!z.length,filterPlaceholder:"Filter price types..."})]})]})})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Item Information"}),B.length?e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 bg-white",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 text-slate-700",children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Item Code"}),e.jsx("th",{className:"px-3 py-2 text-left",children:"Item Name"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Price"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Avail_Qty"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"QTY"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Discount"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Total"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:B.map(Qe=>{const he=i.find(Ge=>Ge.id===Qe.id)||null,pe=Number((he==null?void 0:he.quantity)||0),ye=Number((he==null?void 0:he.price)||0),Ne=Number((he==null?void 0:he.discount)||0),He=Math.max(0,pe*ye-Ne);return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2",children:Qe.code}),e.jsx("td",{className:"px-3 py-2",children:Qe.name}),e.jsx("td",{className:"px-3 py-2 text-right",children:`GH ${ye.toFixed(2)}`}),e.jsx("td",{className:"px-3 py-2 text-right",children:Number(Qe.availQty||0)}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("input",{type:"number",className:"input text-right w-24",min:0,value:pe,onChange:Ge=>Ae(Qe.id,"quantity",Ge.target.value)})}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("input",{type:"number",className:"input text-right w-24",min:0,step:"0.01",value:Ne,onChange:Ge=>Ae(Qe.id,"discount",Ge.target.value)})}),e.jsx("td",{className:"px-3 py-2 text-right",children:`GH ${He.toFixed(2)}`}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("button",{type:"button",className:"btn-danger inline-flex items-center justify-center",onClick:()=>We(Qe.id),children:e.jsx(Hl,{className:"w-4 h-4"})})})]},Qe.id)})})]})}):e.jsx("div",{className:"rounded-lg border border-slate-200 bg-white p-6 text-center text-sm text-slate-600",children:"Select an item by barcode or from the item filter to view details"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Shopping Cart"})}),e.jsxs("div",{className:"card-body space-y-3",ref:xe,children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:i.length?i.map(Qe=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:Qe.name}),e.jsxs("div",{className:"text-xs text-slate-600",children:["GH ",Number(Qe.price).toFixed(2)," each",Number(Qe.discount||0)>0?e.jsxs("span",{className:"ml-2 text-amber-600",children:["Disc GH ",Number(Qe.discount||0).toFixed(2)]}):null]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Ot(Qe.id,-1),children:"-"}),e.jsx("span",{className:"text-sm font-semibold",children:Qe.quantity}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Ot(Qe.id,1),children:"+"}),e.jsx("button",{type:"button",className:"btn-danger inline-flex items-center justify-center",onClick:()=>je(Qe.id),children:e.jsx(Hl,{className:"w-4 h-4"})})]})]},Qe.id)):e.jsx("div",{className:"text-center text-slate-600",children:"Cart is empty"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Discount"}),e.jsx("div",{children:`GH ${tt.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Subtotal"}),e.jsx("div",{children:`GH ${Ve.toFixed(2)}`})]}),ve?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Tax"}),e.jsx("div",{children:`GH ${Ze.toFixed(2)}`})]}):null,e.jsxs("div",{className:"flex justify-between font-bold pt-2 border-t",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{children:`GH ${ht.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("label",{htmlFor:"amountPaid",className:"mr-2",children:"Amount Paid"}),e.jsx("input",{id:"amountPaid",type:"number",inputMode:"decimal",className:"input text-right w-36",step:"0.01",min:"0",value:ct,onChange:Qe=>xt(Qe.target.value),placeholder:"0.00",disabled:!Be})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:Fe>=0?"Change":"Amount Due"}),e.jsx("div",{className:Fe>=0?"text-emerald-600":"text-red-600",children:`GH ${Math.abs(Fe).toFixed(2)}`})]})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:O?e.jsx("div",{className:"col-span-2 text-center text-sm text-slate-500",children:"Loading payment modes..."}):E.length?E.map(Qe=>e.jsx("button",{type:"button",className:`btn ${String(te)===String(Qe.id)?"btn-primary":"btn-secondary"}`,onClick:()=>oe(String(Qe.id)),disabled:!Be,children:Qe.name},Qe.id)):e.jsx("div",{className:"col-span-2 text-center text-sm text-slate-500",children:"No payment modes configured"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{type:"button",className:"btn-success w-full",onClick:De,disabled:!Be,children:"Clear Cart"}),e.jsx("button",{type:"button",className:"btn-success w-full",onClick:lt,disabled:!Be||!i.length||o||O||!E.length||!te,children:"Complete Sale"})]})]})})]})]}),k&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:"Sale Completed"}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Receipt No"}),e.jsx("div",{className:"font-semibold",children:d||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Total"}),e.jsx("div",{className:"font-semibold",children:`GH ${ht.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Amount Paid"}),e.jsx("div",{className:"font-semibold",children:`GH ${ze.toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:Fe>=0?"Change":"Amount Due"}),e.jsx("div",{className:"font-semibold",children:`GH ${Math.abs(Fe).toFixed(2)}`})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{children:"Payment Method"}),e.jsx("div",{className:"font-semibold",children:(ut==null?void 0:ut.name)||(function(){const Qe=String((ut==null?void 0:ut.type)||"").toLowerCase();return Qe==="cash"?"Cash":Qe==="card"?"Card":Qe==="mobile"?"Mobile Money":Qe==="bank"?"Bank":"Other"})()})]})]}),e.jsxs("div",{className:"mt-6 flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-primary",onClick:rt,children:"New Sale"}),e.jsx("button",{type:"button",className:"btn-secondary",onClick:Qt,children:"Print Receipt"})]})]})})]})}function HZ({value:t,onChange:s,options:r,disabled:a,filterPlaceholder:n}){const i=Array.isArray(r)?r:[];return e.jsx("div",{className:"space-y-2",children:e.jsx("select",{className:"input",value:t,onChange:l=>s(l.target.value),disabled:a,children:i.map(l=>e.jsx("option",{value:String(l.value),children:l.label},String(l.value)))})})}function qZ(){const[t,s]=x.useState(!1),[r,a]=x.useState([]),[n,i]=x.useState("ALL"),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState("ALL"),[g,v]=x.useState(null),[b,y]=x.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:qs}),[j,N]=x.useState(!1),[S,B]=x.useState(""),[P,L]=x.useState({});x.useEffect(()=>{let T=!1;return s(!0),ee.get("/pos/sales").then(k=>{var D;T||a(Array.isArray((D=k.data)==null?void 0:D.items)?k.data.items:[])}).catch(()=>{T||a([])}).finally(()=>{T||s(!1)}),()=>{T=!0}},[]),x.useEffect(()=>{let T=!0;async function k(){var D;try{const C=((D=(await ee.get("/pos/receipt-settings")).data)==null?void 0:D.item)||null;if(!T)return;if(!C){L({});return}L({companyName:C.company_name||"",showLogo:C.show_logo===1||C.show_logo===!0||String(C.show_logo).toLowerCase()==="true",headerText:C.header_text||"",footerText:C.footer_text||"",contactNumber:C.contact_number||"",addressLine1:C.address_line1||"",addressLine2:C.address_line2||"",logoUrl:C.logo_url||""})}catch{if(!T)return;L({})}}return k(),()=>{T=!1}},[]),x.useEffect(()=>{let T=!0;async function k(){var D,Q,C;try{const w=(Q=(D=(await ee.get("/admin/me")).data)==null?void 0:D.scope)==null?void 0:Q.companyId;if(!w){if(!T)return;y(X=>({...X,logoUrl:X.logoUrl||qs}));return}const R=((C=(await ee.get(`/admin/companies/${w}`)).data)==null?void 0:C.item)||{};if(!T)return;y(X=>({...X,name:R.name||X.name||"",address:R.address||X.address||"",city:R.city||X.city||"",state:R.state||X.state||"",country:R.country||X.country||"",phone:R.telephone||X.phone||"",email:R.email||X.email||"",website:R.website||X.website||"",taxId:R.tax_id||X.taxId||"",registrationNo:R.registration_no||X.registrationNo||"",logoUrl:R.has_logo===1||R.has_logo===!0?`/api/admin/companies/${w}/logo`:X.logoUrl||qs}))}catch{if(!T)return;y(E=>({...E,logoUrl:E.logoUrl||qs}))}}return k(),()=>{T=!1}},[]);const U=x.useMemo(()=>{const T=new Map;for(const k of r){const D=String(k.collector_username||"").trim(),Q=String(k.collector_full_name||"").trim(),C=D||Q;C&&(T.has(C)||T.set(C,{key:C,label:D||Q}))}return Array.from(T.values()).sort((k,D)=>String(k.label||"").localeCompare(String(D.label||"")))},[r]),H=x.useMemo(()=>[{value:"ALL",label:"All collectors"},...U.map(T=>({value:T.key,label:T.label}))],[U]),q=x.useMemo(()=>{const T=String(c||"").trim().toLowerCase(),k=A==="ALL"?"":String(A||"").trim();return r.filter(D=>{const Q=T?String(D.sale_no||"").toLowerCase().includes(T):!0,C=n==="ALL"?!0:String(D.payment_status||"")===n,E=String(D.sale_date||"").slice(0,10),w=l?E>=l:!0,O=u?E<=u:!0,R=String(D.collector_username||D.collector_full_name||"").trim();return Q&&C&&w&&O&&(k?R===k:!0)})},[r,c,n,l,u,A]),V=x.useMemo(()=>{const T=q.reduce((Q,C)=>Q+Number(C.total_amount||0),0),k=q.reduce((Q,C)=>Q+(String(C.payment_status||"")==="PAID"?Number(C.total_amount||0):0),0),D=T-k;return{count:q.length,totalAmount:T,cashCollected:k,outstanding:D}},[q]),M=x.useMemo(()=>{const T={};for(const k of q){const D=String(k.payment_method||"").toUpperCase()||"UNKNOWN",Q=Number(k.total_amount||0),C=String(k.payment_status||"")==="PAID";T[D]||(T[D]={method:D,invoices:0,totalAmount:0,collectedAmount:0}),T[D].invoices+=1,T[D].totalAmount+=Q,C&&(T[D].collectedAmount+=Q)}return Object.values(T)},[q]);function z(T,k){const D=P||{},Q=String(b.name||D.companyName||"Company Name"),C=[];b.address&&C.push(b.address);const E=[b.city,b.state].filter(Boolean).join(", ");E&&C.push(E),b.country&&C.push(b.country);const w=String(C[0]||D.addressLine1||"Street address"),O=String(C.slice(1).join("  ")||D.addressLine2||"City, State, ZIP"),R=String(b.phone||D.contactNumber||"+1234567890"),X=String(D.headerText||"Thank you for your purchase"),ne=String(D.footerText||"Please visit again"),te=[];b.taxId&&te.push(`TIN: ${b.taxId}`),b.website&&te.push(b.website);const oe=te.join("  ");let ce=String(D.logoUrl||b.logoUrl||"").trim();if(ce&&!(ce.startsWith("http://")||ce.startsWith("https://")||ce.startsWith("data:"))){const Ke=window.location.origin||"";ce.startsWith("/")?ce=Ke+ce:ce=Ke+"/"+ce}const re=ce?`<div class="center"><img src="${ce}" alt="${Q}" style="max-height:100px;margin-bottom:8px;object-fit:contain;" /></div>`:"",Ie=(T&&T.sale_date?new Date(T.sale_date):new Date).toLocaleString(),le=(function(){const ot=String((T==null?void 0:T.payment_method)||"").toUpperCase();return ot==="CASH"?"Cash":ot==="CARD"?"Card":ot==="MOBILE"?"Mobile Money":ot==="BANK"?"Bank":"Other"})(),Z=(Array.isArray(k)?k:[]).map(ot=>{const Ke=Number(ot.qty||0),ct=Number(ot.unit_price||0),xt=Number(ot.line_total||Ke*ct||0);return`
          <tr>
            <td>${ot.item_name||""}</td>
            <td class="right">${Ke.toFixed(2)}</td>
            <td class="right">${ct.toFixed(2)}</td>
            <td class="right">${xt.toFixed(2)}</td>
          </tr>
        `}).join(""),ve=Number((T==null?void 0:T.gross_amount)||0),Ue=Number((T==null?void 0:T.discount_amount)||0),Be=Number((T==null?void 0:T.tax_amount)||0),_e=ve-Ue,Me=Number((T==null?void 0:T.net_amount)||(T==null?void 0:T.total_amount)||_e+Be);return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Invoice</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          .footer { margin-top: 10px; text-align: center; font-size: 11px; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        ${re}
        <h1>${Q}</h1>
        <div class="center muted">${w}</div>
        <div class="center muted">${O}</div>
        <div class="center muted">Mobile: ${R}</div>
        ${oe?`<div class="center muted">${oe}</div>`:""}
        <div class="center muted" style="margin-top:6px;">${X}</div>
        <hr />
        <div class="row"><span>Receipt No:</span><span>${(T==null?void 0:T.sale_no)||"-"}</span></div>
        <div class="row"><span>Date:</span><span>${Ie}</span></div>
        <div class="row"><span>Payment:</span><span>${le}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${Z}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Subtotal</span><span>${_e.toFixed(2)}</span></div>
          <div class="row"><span>Discount</span><span>${Ue.toFixed(2)}</span></div>
          <div class="row"><span>Tax</span><span>${Be.toFixed(2)}</span></div>
          <div class="row"><strong>Total</strong><strong>${Me.toFixed(2)}</strong></div>
        </div>
        <div class="footer">${ne}</div>
      </body>
      </html>
    `}async function I(T){var k,D;if(!(!T||!T.id)){v(T.id);try{const Q=await ee.get(`/pos/sales/${T.id}`),C=((k=Q.data)==null?void 0:k.item)||null,E=Array.isArray((D=Q.data)==null?void 0:D.details)?Q.data.details:[];if(!C){alert("Invoice not found");return}const w=z(C,E);B(w),N(!0)}catch{alert("Failed to load invoice")}finally{v(null)}}}async function G(T){var k,D,Q;if(!(!T||!T.id)){v(T.id);try{const C=await ee.get(`/pos/sales/${T.id}`),E=((k=C.data)==null?void 0:k.item)||null,w=Array.isArray((D=C.data)==null?void 0:D.details)?C.data.details:[];if(!E){alert("Invoice not found");return}const O=z(E,w),R=document.createElement("iframe");R.style.position="fixed",R.style.right="0",R.style.bottom="0",R.style.width="0",R.style.height="0",R.style.border="0",document.body.appendChild(R);const X=((Q=R.contentWindow)==null?void 0:Q.document)||R.contentDocument||null;if(!X){document.body.removeChild(R);return}X.open(),X.write(O),X.close();const ne=R.contentWindow||window;setTimeout(()=>{ne.focus();try{ne.print()}catch{}setTimeout(()=>{document.body.removeChild(R)},100)},200)}catch{alert("Failed to load invoice"),v(null)}}}async function Y(T){var k,D;if(!(!T||!T.id)){v(T.id);try{const Q=await ee.get(`/pos/sales/${T.id}`),C=((k=Q.data)==null?void 0:k.item)||null,E=Array.isArray((D=Q.data)==null?void 0:D.details)?Q.data.details:[];if(!C){alert("Invoice not found");return}const w=loadReceiptSettings(),O=String(b.name||w.companyName||"Company Name"),R=[];b.address&&R.push(b.address);const X=[b.city,b.state].filter(Boolean).join(", ");X&&R.push(X),b.country&&R.push(b.country);const ne=String(R[0]||w.addressLine1||"Street address"),te=String(R.slice(1).join("  ")||w.addressLine2||"City, State, ZIP"),oe=String(b.phone||w.contactNumber||"+1234567890"),ce=String(w.headerText||"Thank you for your purchase"),de=(C&&C.sale_date?new Date(C.sale_date):new Date).toLocaleString(),Ie=(function(){const ct=String((C==null?void 0:C.payment_method)||"").toUpperCase();return ct==="CASH"?"Cash":ct==="CARD"?"Card":ct==="MOBILE"?"Mobile Money":ct==="BANK"?"Bank":"Other"})(),le=Number((C==null?void 0:C.gross_amount)||0),Z=Number((C==null?void 0:C.discount_amount)||0),ve=Number((C==null?void 0:C.tax_amount)||0),Ue=le-Z,Be=Number((C==null?void 0:C.net_amount)||(C==null?void 0:C.total_amount)||Ue+ve),_e=new ds("p","mm","a4");let Me=15;_e.setFontSize(14),_e.text(O,10,Me),Me+=6,_e.setFontSize(10),_e.text(ne,10,Me),Me+=5,_e.text(te,10,Me),Me+=5,_e.text("Mobile: "+oe,10,Me),Me+=5;const Ye=[];b.taxId&&Ye.push(`TIN: ${b.taxId}`),b.website&&Ye.push(b.website);const ot=Ye.join("  ");ot&&(_e.text(ot,10,Me),Me+=5),Me+=1,_e.text(ce,10,Me),Me+=8,_e.setFontSize(11),_e.text("Receipt No: "+(C.sale_no||"-"),10,Me),Me+=5,_e.text("Date: "+de,10,Me),Me+=5,_e.text("Payment: "+Ie,10,Me),Me+=8,_e.setFontSize(10),_e.text("Item",10,Me),_e.text("Qty",90,Me),_e.text("Price",120,Me),_e.text("Total",160,Me),Me+=4,_e.line(10,Me,200,Me),Me+=5,(Array.isArray(E)?E:[]).forEach(ct=>{const xt=Number(ct.qty||0),be=Number(ct.unit_price||0),Ce=Number(ct.line_total||xt*be||0);Me>270&&(_e.addPage(),Me=15);const Te=String(ct.item_name||""),ue=40;(Te.length>ue?[Te.slice(0,ue),Te.slice(ue)]:[Te]).forEach(Ve=>{_e.text(Ve,10,Me),_e.text(xt.toFixed(2),90,Me,{align:"right"}),_e.text(be.toFixed(2),120,Me,{align:"right"}),_e.text(Ce.toFixed(2),160,Me,{align:"right"}),Me+=5})}),Me+=4,_e.line(10,Me,200,Me),Me+=6,_e.text("Subtotal:",120,Me,{align:"right"}),_e.text(Ue.toFixed(2),160,Me,{align:"right"}),Me+=5,_e.text("Discount:",120,Me,{align:"right"}),_e.text(Z.toFixed(2),160,Me,{align:"right"}),Me+=5,_e.text("Tax:",120,Me,{align:"right"}),_e.text(ve.toFixed(2),160,Me,{align:"right"}),Me+=5,_e.text("Total:",120,Me,{align:"right"}),_e.text(Be.toFixed(2),160,Me,{align:"right"});const Ke=`POS_Invoice_${C.sale_no||T.id}.pdf`;_e.save(Ke)}catch{alert("Failed to download invoice")}finally{v(null)}}}function J(){N(!1),B("")}return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Cash Collection Details"}),e.jsx("p",{className:"text-sm mt-1",children:"List of all invoices from POS sales with collection summary"})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4",children:[e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"From Date"}),e.jsx("input",{type:"date",className:"input",value:l,onChange:T=>o(T.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"To Date"}),e.jsx("input",{type:"date",className:"input",value:u,onChange:T=>d(T.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:n,onChange:T=>i(T.target.value),children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"PENDING",children:"Pending"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Collector"}),e.jsx(HZ,{value:A,onChange:f,options:H,disabled:!H.length,filterPlaceholder:"Filter collectors..."})]}),e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"label",children:"Invoice No"}),e.jsx("input",{className:"input",placeholder:"Search by invoice number",value:c,onChange:T=>h(T.target.value)})]})]})})}),e.jsxs("div",{className:"xl:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Invoices"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:V.count})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:`GH ${Number(V.totalAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Cash Collected"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:`GH ${Number(V.cashCollected).toFixed(2)}`})]})]}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Invoice Preview"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:J,children:""})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:S?e.jsx("iframe",{title:"Invoice Preview",srcDoc:S,className:"w-full h-[70vh] border-0"}):e.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"Loading invoice..."})})]})})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"text-sm font-semibold text-slate-900",children:"Payment Mode Summary"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200 mt-3",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Payment Mode"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Invoices"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Total Amount"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Amount Collected"})]})}),e.jsx("tbody",{className:"bg-white",children:M.length?M.map(T=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:T.method}),e.jsx("td",{className:"p-2 text-right",children:Number(T.invoices||0).toLocaleString()}),e.jsx("td",{className:"p-2 text-right",children:`GH ${Number(T.totalAmount||0).toFixed(2)}`}),e.jsx("td",{className:"p-2 text-right",children:`GH ${Number(T.collectedAmount||0).toFixed(2)}`})]},T.method)):e.jsx("tr",{children:e.jsx("td",{className:"p-3 text-center text-slate-500",colSpan:4,children:"No data for selected filters"})})})]})})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Invoice No"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Date"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Payment Mode"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Amount Collected"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Collector"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Status"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white",children:t?e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:6,children:"Loading..."})}):q.length?q.map(T=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:T.sale_no}),e.jsx("td",{className:"p-2",children:String(T.sale_date||"").replace("T"," ").slice(0,16)}),e.jsx("td",{className:"p-2",children:String(T.payment_method||"").toUpperCase()||"-"}),e.jsx("td",{className:"p-2 text-right",children:`GH ${Number(T.total_amount||0).toFixed(2)}`}),e.jsx("td",{className:"p-2",children:T.collector_username||T.collector_full_name||"-"}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:String(T.payment_status||"")==="PAID"?"inline-block px-2 py-1 rounded bg-green-100 text-green-800":"inline-block px-2 py-1 rounded bg-yellow-100 text-yellow-800",children:String(T.payment_status||"")||"-"})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"text-brand hover:text-brand-600 font-medium text-sm",onClick:()=>I(T),disabled:g===T.id,children:"View"}),e.jsx("button",{type:"button",className:"btn-primary text-xs px-3 py-1.5",onClick:()=>G(T),disabled:g===T.id,children:"Print"}),e.jsx("button",{type:"button",className:"btn-outline text-xs px-3 py-1.5",onClick:()=>Y(T),disabled:g===T.id,children:"Download"})]})})]},T.id)):e.jsx("tr",{children:e.jsx("td",{className:"p-3",colSpan:6,children:"No invoices found"})})}),e.jsx("tfoot",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-2 font-semibold",colSpan:4,children:"Totals"}),e.jsx("td",{className:"p-2 text-right font-bold",children:`GH ${Number(V.totalAmount).toFixed(2)}`}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex flex-col text-xs",children:[e.jsxs("span",{className:"text-green-700",children:["Collected:"," ",`GH ${Number(V.cashCollected).toFixed(2)}`]}),e.jsxs("span",{className:"text-red-700",children:["Outstanding:"," ",`GH ${Number(V.outstanding).toFixed(2)}`]})]})})]})})]})})})})]})}function VZ(){const{user:t}=ca(),[s,r]=x.useState(new Date),[a,n]=x.useState(!1),[i,l]=x.useState([]),[o,u]=x.useState(""),[d,c]=x.useState(""),[h,A]=x.useState("ALL"),[f,g]=x.useState(""),[v,b]=x.useState(null),[y,j]=x.useState(""),[N,S]=x.useState([]),[B,P]=x.useState(!1),[L,U]=x.useState({name:"",address:"",city:"",state:"",country:"",phone:"",email:"",website:"",taxId:"",registrationNo:"",logoUrl:qs}),[H,q]=x.useState(!1),[V,M]=x.useState(""),[z,I]=x.useState({});x.useEffect(()=>{const w=setInterval(()=>r(new Date),1e3);return()=>clearInterval(w)},[]),x.useEffect(()=>{let w=!0;async function O(){var R;try{const ne=((R=(await ee.get("/pos/receipt-settings")).data)==null?void 0:R.item)||null;if(!w)return;if(!ne){I({});return}I({companyName:ne.company_name||"",showLogo:ne.show_logo===1||ne.show_logo===!0||String(ne.show_logo).toLowerCase()==="true",headerText:ne.header_text||"",footerText:ne.footer_text||"",contactNumber:ne.contact_number||"",addressLine1:ne.address_line1||"",addressLine2:ne.address_line2||"",logoUrl:ne.logo_url||""})}catch{if(!w)return;I({})}}return O(),()=>{w=!1}},[]),x.useEffect(()=>{let w=!1;async function O(){var R,X,ne;P(!0);try{const[te,oe]=await Promise.all([ee.get("/pos/terminals"),ee.get("/pos/terminal-users")]);if(w)return;const ce=Array.isArray((R=te.data)==null?void 0:R.items)?te.data.items:[],re=Array.isArray((X=oe.data)==null?void 0:X.items)?oe.data.items:[],de=Number((t==null?void 0:t.sub)||0)||Number((t==null?void 0:t.id)||0)||void 0,Ie=new Set(re.filter(ve=>Number(ve==null?void 0:ve.user_id)===de).map(ve=>Number(ve==null?void 0:ve.terminal_id)).filter(ve=>Number.isFinite(ve)&&ve>0)),le=ce.filter(ve=>Ie.has(Number(ve==null?void 0:ve.id)));S(le);const Z=(le.length?String(((ne=le[0])==null?void 0:ne.code)||""):"")||"";j(Z)}catch{if(w)return;S([]),j("")}finally{if(w)return;P(!1)}}return O(),()=>{w=!0}},[t==null?void 0:t.id,t==null?void 0:t.sub]),x.useEffect(()=>{let w=!1;n(!0);const O=y?{params:{terminal:y}}:{};return ee.get("/pos/sales",O).then(R=>{var X;w||l(Array.isArray((X=R.data)==null?void 0:X.items)?R.data.items:[])}).catch(()=>{w||l([])}).finally(()=>{w||n(!1)}),()=>{w=!0}},[y]),x.useEffect(()=>{let w=!0;async function O(){var R,X,ne;try{const oe=(X=(R=(await ee.get("/admin/me")).data)==null?void 0:R.scope)==null?void 0:X.companyId;if(!oe){if(!w)return;U(de=>({...de,logoUrl:de.logoUrl||qs}));return}const re=((ne=(await ee.get(`/admin/companies/${oe}`)).data)==null?void 0:ne.item)||{};if(!w)return;U(de=>({...de,name:re.name||de.name||"",address:re.address||de.address||"",city:re.city||de.city||"",state:re.state||de.state||"",country:re.country||de.country||"",phone:re.telephone||de.phone||"",email:re.email||de.email||"",website:re.website||de.website||"",taxId:re.tax_id||de.taxId||"",registrationNo:re.registration_no||de.registrationNo||"",logoUrl:re.has_logo===1||re.has_logo===!0?`/api/admin/companies/${oe}/logo`:de.logoUrl||qs}))}catch{if(!w)return;U(te=>({...te,logoUrl:te.logoUrl||qs}))}}return O(),()=>{w=!1}},[]);const G=x.useMemo(()=>{const w=String(f||"").trim().toLowerCase();return i.filter(O=>{const R=!w||String(O.sale_no||"").toLowerCase().includes(w)||String(O.customer_id||"").toLowerCase().includes(w),X=h==="ALL"?!0:String(O.payment_status||"")===h,ne=String(O.sale_date||"").slice(0,10),te=o?ne>=o:!0,oe=d?ne<=d:!0;return R&&X&&te&&oe})},[i,f,h,o,d]),Y=x.useMemo(()=>{const w=G.length,O=G.reduce((ne,te)=>ne+Number(te.total_amount||0),0),R=G.reduce((ne,te)=>ne+(String(te.payment_status||"")==="PAID"?Number(te.total_amount||0):0),0),X=O-R;return{count:w,totalAmount:O,paid:R,pending:X}},[G]);function J(){const w=["Invoice No","Date","Customer","Amount","Status"],O=G.map(oe=>[String(oe.sale_no||""),String(oe.sale_date||"").replace("T"," ").slice(0,16),oe.customer_id?`#${oe.customer_id}`:"-",Number(oe.total_amount||0).toFixed(2),String(oe.payment_status||"")]),R=[w.join(","),...O.map(oe=>oe.join(","))].join(`
`),X=new Blob([R],{type:"text/csv;charset=utf-8;"}),ne=URL.createObjectURL(X),te=document.createElement("a");te.href=ne,te.download="pos_invoices.csv",te.click(),URL.revokeObjectURL(ne)}function T(){window.print()}function k(w,O){const R=z||{},X=String(L.name||R.companyName||"Company Name"),ne=[];L.address&&ne.push(L.address);const te=[L.city,L.state].filter(Boolean).join(", ");te&&ne.push(te),L.country&&ne.push(L.country);const oe=String(ne[0]||R.addressLine1||"Street address"),ce=String(ne.slice(1).join("  ")||R.addressLine2||"City, State, ZIP"),re=String(L.phone||R.contactNumber||"+1234567890"),de=String(R.headerText||"Thank you for your purchase"),Ie=String(R.footerText||"Please visit again"),le=[];L.taxId&&le.push(`TIN: ${L.taxId}`),L.website&&le.push(L.website);const Z=le.join("  ");let ve=String(R.logoUrl||L.logoUrl||"").trim();if(ve&&!(ve.startsWith("http://")||ve.startsWith("https://")||ve.startsWith("data:"))){const ue=window.location.origin||"";ve.startsWith("/")?ve=ue+ve:ve=ue+"/"+ve}const Ue=ve?`<div class="center"><img src="${ve}" alt="${X}" style="max-height:100px;margin-bottom:8px;object-fit:contain;" /></div>`:"",_e=(w&&w.sale_date?new Date(w.sale_date):new Date).toLocaleString(),Me=(function(){const Te=String((w==null?void 0:w.payment_method)||"").toUpperCase();return Te==="CASH"?"Cash":Te==="CARD"?"Card":Te==="MOBILE"?"Mobile Money":Te==="BANK"?"Bank":"Other"})(),Ye=(Array.isArray(O)?O:[]).map(Te=>{const ue=Number(Te.qty||0),ge=Number(Te.unit_price||0),Ve=Number(Te.line_total||ue*ge||0);return`
          <tr>
            <td>${Te.item_name||""}</td>
            <td class="right">${ue.toFixed(2)}</td>
            <td class="right">GH ${ge.toFixed(2)}</td>
            <td class="right">GH ${Ve.toFixed(2)}</td>
          </tr>
        `}).join(""),ot=Number((w==null?void 0:w.gross_amount)||0),Ke=Number((w==null?void 0:w.discount_amount)||0),ct=Number((w==null?void 0:w.tax_amount)||0),xt=ot-Ke,be=Number((w==null?void 0:w.net_amount)||(w==null?void 0:w.total_amount)||xt+ct);return`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8" />
        <title>POS Invoice</title>
        <style>
          body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 16px; max-width: 480px; margin: 0 auto; }
          h1 { text-align: center; margin: 0 0 4px; font-size: 18px; }
          .center { text-align: center; }
          .muted { font-size: 12px; color: #555; }
          .row { display: flex; justify-content: space-between; font-size: 13px; margin: 2px 0; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 12px; }
          th, td { padding: 4px; border-bottom: 1px solid #eee; }
          th { text-align: left; }
          th.right, td.right { text-align: right; }
          .totals { margin-top: 8px; border-top: 1px solid #000; padding-top: 4px; }
          .footer { margin-top: 10px; text-align: center; font-size: 11px; white-space: pre-wrap; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        ${Ue}
        <h1>${X}</h1>
        <div class="center muted">${oe}</div>
        <div class="center muted">${ce}</div>
        <div class="center muted">Mobile: ${re}</div>
        ${Z?`<div class="center muted">${Z}</div>`:""}
        <div class="center muted" style="margin-top:6px;">${de}</div>
        <hr />
        <div class="row"><span>Receipt No:</span><span>${(w==null?void 0:w.sale_no)||"-"}</span></div>
        <div class="row"><span>Date:</span><span>${_e}</span></div>
        <div class="row"><span>Payment:</span><span>${Me}</span></div>
        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="right">Qty</th>
              <th class="right">Price</th>
              <th class="right">Total</th>
            </tr>
          </thead>
          <tbody>
            ${Ye.replace(/<td class="right">(\d+(?:\.\d{1,2})?)<\/td>\s*<td class="right">(\d+(?:\.\d{1,2})?)<\/td>$/gm,'<td class="right">$1</td><td class="right">GH $2')}
          </tbody>
        </table>
        <div class="totals">
          <div class="row"><span>Subtotal</span><span>GH ${xt.toFixed(2)}</span></div>
          <div class="row"><span>Discount</span><span>GH ${Ke.toFixed(2)}</span></div>
          <div class="row"><span>Tax</span><span>GH ${ct.toFixed(2)}</span></div>
          <div class="row"><strong>Total</strong><strong>GH ${be.toFixed(2)}</strong></div>
        </div>
        <div class="footer">${Ie}</div>
      </body>
      </html>
    `}async function D(w){var O,R;if(!(!w||!w.id)){b(w.id);try{const X=await ee.get(`/pos/sales/${w.id}`),ne=((O=X.data)==null?void 0:O.item)||null,te=Array.isArray((R=X.data)==null?void 0:R.details)?X.data.details:[];if(!ne){alert("Invoice not found");return}const oe=k(ne,te);M(oe),q(!0)}catch{alert("Failed to load invoice")}finally{b(null)}}}async function Q(w){var O,R,X;if(!(!w||!w.id)){b(w.id);try{const ne=await ee.get(`/pos/sales/${w.id}`),te=((O=ne.data)==null?void 0:O.item)||null,oe=Array.isArray((R=ne.data)==null?void 0:R.details)?ne.data.details:[];if(!te){alert("Invoice not found");return}const ce=k(te,oe),re=document.createElement("iframe");re.style.position="fixed",re.style.right="0",re.style.bottom="0",re.style.width="0",re.style.height="0",re.style.border="0",document.body.appendChild(re);const de=((X=re.contentWindow)==null?void 0:X.document)||re.contentDocument||null;if(!de){document.body.removeChild(re);return}de.open(),de.write(ce),de.close();const Ie=re.contentWindow||window;setTimeout(()=>{Ie.focus();try{Ie.print()}catch{}setTimeout(()=>{document.body.removeChild(re)},100)},200)}catch{alert("Failed to load invoice"),b(null)}}}async function C(w){var O,R,X;if(!(!w||!w.id)){b(w.id);try{const ne=await ee.get(`/pos/sales/${w.id}`),te=((O=ne.data)==null?void 0:O.item)||null,oe=Array.isArray((R=ne.data)==null?void 0:R.details)?ne.data.details:[];if(!te){alert("Invoice not found");return}const ce=z||{},re=String(L.name||ce.companyName||"Company Name"),de=[];L.address&&de.push(L.address);const Ie=[L.city,L.state].filter(Boolean).join(", ");Ie&&de.push(Ie),L.country&&de.push(L.country);const le=String(de[0]||ce.addressLine1||"Street address"),Z=String(de.slice(1).join("  ")||ce.addressLine2||"City, State, ZIP"),ve=String(L.phone||ce.contactNumber||"+1234567890"),Ue=String(ce.headerText||"Thank you for your purchase"),Be=String(ce.footerText||"Please visit again"),Me=(te&&te.sale_date?new Date(te.sale_date):new Date).toLocaleString(),Ye=(function(){const ht=String((te==null?void 0:te.payment_method)||"").toUpperCase();return ht==="CASH"?"Cash":ht==="CARD"?"Card":ht==="MOBILE"?"Mobile Money":ht==="BANK"?"Bank":"Other"})(),ot=Number((te==null?void 0:te.gross_amount)||0),Ke=Number((te==null?void 0:te.discount_amount)||0),ct=Number((te==null?void 0:te.tax_amount)||0),xt=ot-Ke,be=Number((te==null?void 0:te.net_amount)||(te==null?void 0:te.total_amount)||xt+ct),Ce=new ds("p","mm","a4");let Te=15;Ce.setFontSize(14),Ce.text(re,10,Te),Te+=6,Ce.setFontSize(10),Ce.text(le,10,Te),Te+=5,Ce.text(Z,10,Te),Te+=5,Ce.text("Mobile: "+ve,10,Te),Te+=5;const ue=[];L.taxId&&ue.push(`TIN: ${L.taxId}`),L.website&&ue.push(L.website);const ge=ue.join("  ");ge&&(Ce.text(ge,10,Te),Te+=5),Te+=1,Ce.text(Ue,10,Te),Te+=8,Ce.setFontSize(11),Ce.text("Receipt No: "+(te.sale_no||"-"),10,Te),Te+=5,Ce.text("Date: "+Me,10,Te),Te+=5,Ce.text("Payment: "+Ye,10,Te),Te+=8,Ce.setFontSize(10),Ce.text("Item",10,Te),Ce.text("Qty",90,Te),Ce.text("Price",120,Te),Ce.text("Total",160,Te),Te+=4,Ce.line(10,Te,200,Te),Te+=5,(Array.isArray(oe)?oe:[]).forEach(ht=>{const ze=Number(ht.qty||0),Fe=Number(ht.unit_price||0),xe=Number(ht.line_total||ze*Fe||0);Te>270&&(Ce.addPage(),Te=15);const we=String(ht.item_name||""),Xe=40;(we.length>Xe?[we.slice(0,Xe),we.slice(Xe)]:[we]).forEach(ft=>{Ce.text(ft,10,Te),Ce.text(ze.toFixed(2),90,Te,{align:"right"}),Ce.text(Fe.toFixed(2),120,Te,{align:"right"}),Ce.text(xe.toFixed(2),160,Te,{align:"right"}),Te+=5})}),Te+=4,Ce.line(10,Te,200,Te),Te+=6,Ce.text("Subtotal:",120,Te,{align:"right"}),Ce.text(xt.toFixed(2),160,Te,{align:"right"}),Te+=5,Ce.text("Discount:",120,Te,{align:"right"}),Ce.text(Ke.toFixed(2),160,Te,{align:"right"}),Te+=5,Ce.text("Tax:",120,Te,{align:"right"}),Ce.text(ct.toFixed(2),160,Te,{align:"right"}),Te+=5,Ce.text("Total:",120,Te,{align:"right"}),Ce.text(be.toFixed(2),160,Te,{align:"right"}),Te+=8;const Ve=Be.replace(/\r\n/g,`
`).split(`
`),tt=((X=Ce.getFont())==null?void 0:X.fontName)||"helvetica";try{Ce.setFont("courier","normal")}catch{}Ce.setFontSize(10),Ve.forEach(ht=>{Te>270&&(Ce.addPage(),Te=15),Ce.text(ht,10,Te),Te+=5});try{Ce.setFont(tt,"normal")}catch{}const Ze=`POS_Invoice_${te.sale_no||w.id}.pdf`;Ce.save(Ze)}catch{alert("Failed to download invoice")}finally{b(null)}}}function E(){q(!1),M("")}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Invoices"}),e.jsx("p",{className:"text-sm mt-1",children:"List of all invoices created from POS sales entry"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:s.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:s.toLocaleTimeString()})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-3 flex-1",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Terminal"}),e.jsxs("select",{className:"input",value:y,onChange:w=>j(w.target.value),disabled:B,children:[e.jsx("option",{value:"",children:B?"Loading terminals...":"All Terminals (assigned)"}),(Array.isArray(N)?N:[]).map(w=>e.jsx("option",{value:String(w.code||""),children:String(w.code||w.name||"")},String(w.code)))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"From"}),e.jsx("input",{type:"date",className:"input",value:o,onChange:w=>u(w.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"To"}),e.jsx("input",{type:"date",className:"input",value:d,onChange:w=>c(w.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:h,onChange:w=>A(w.target.value),children:[e.jsx("option",{value:"ALL",children:"All"}),e.jsx("option",{value:"PAID",children:"Paid"}),e.jsx("option",{value:"PENDING",children:"Pending"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Search"}),e.jsx("input",{className:"input",placeholder:"Search invoice no or customer",value:f,onChange:w=>g(w.target.value)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"btn-success",onClick:J,children:"Export CSV"}),e.jsx("button",{className:"btn-primary",onClick:T,children:"Print"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Invoices"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:Y.count})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-brand-700",children:`GH ${Number(Y.totalAmount).toFixed(2)}`})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs uppercase text-slate-500",children:"Paid"}),e.jsx("div",{className:"text-2xl font-bold text-green-700",children:`GH ${Number(Y.paid).toFixed(2)}`})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice No"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{className:"text-right",children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"Loading..."})}):G.length?G.map(w=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"font-medium",children:w.sale_no}),e.jsx("td",{children:String(w.sale_date||"").replace("T"," ").slice(0,16)}),e.jsx("td",{children:w.customer_id?`#${w.customer_id}`:"-"}),e.jsx("td",{className:"text-right",children:`GH ${Number(w.total_amount||0).toFixed(2)}`}),e.jsx("td",{children:e.jsx("span",{className:String(w.payment_status||"")==="PAID"?"px-2 py-1 rounded bg-green-100 text-green-700 text-xs":"px-2 py-1 rounded bg-yellow-100 text-yellow-700 text-xs",children:String(w.payment_status||"")})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"text-brand hover:text-brand-600 font-medium text-sm",onClick:()=>D(w),disabled:v===w.id,children:"View"}),e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-green-600 hover:bg-green-700 text-white text-xs font-semibold",onClick:()=>Q(w),disabled:v===w.id,children:"Print"}),e.jsx("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 rounded bg-purple-600 hover:bg-purple-700 text-white text-xs font-semibold",onClick:()=>C(w),disabled:v===w.id,children:"Download"})]})})]},w.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:e.jsx("div",{className:"text-center text-slate-600 py-6",children:"No invoices found"})})})})]})})}),H&&e.jsx("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-erp w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200",children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900",children:"Invoice Preview"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:E,children:""})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:V?e.jsx("iframe",{title:"Invoice Preview",srcDoc:V,className:"w-full h-[70vh] border-0"}):e.jsx("div",{className:"p-4 text-center text-sm text-slate-500",children:"Loading invoice..."})})]})})]})}const yx=[200,100,50,20,10,5,2,1,.5,.2];function OS({value:t,onChange:s,options:r,placeholder:a,disabled:n,filterPlaceholder:i}){const l=Array.isArray(r)?r:[];return e.jsx("div",{children:e.jsxs("select",{className:"input",value:t,onChange:o=>s(o.target.value),disabled:n,children:[e.jsx("option",{value:"",children:a||"Select..."}),l.map(o=>e.jsx("option",{value:String(o.value),children:o.label},String(o.value)))]})})}function $Z(){const[t,s]=x.useState(!1),[r,a]=x.useState([]),[n,i]=x.useState(""),[l,o]=x.useState(new Date().toISOString().slice(0,10)),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState(""),[g,v]=x.useState(50),[b,y]=x.useState(!1),[j,N]=x.useState([]),[S,B]=x.useState(yx.map(()=>0));x.useEffect(()=>{let E=!1;return s(!0),ee.get("/pos/terminals").then(w=>{var R;if(E)return;const O=Array.isArray((R=w.data)==null?void 0:R.items)?w.data.items:[];if(a(O),!u&&O.length){const X=O[0];d(String(X.id)),h(String(X.warehouse||""))}}).catch(()=>{E||a([])}).finally(()=>{E||s(!1)}),()=>{E=!0}},[]),x.useEffect(()=>{const E=r.find(w=>String(w.id)===String(u));E&&E.warehouse&&String(c||"").trim()===""&&h(String(E.warehouse))},[u,r]);const P=x.useMemo(()=>{const E=new Set;for(const w of r){const O=String((w==null?void 0:w.warehouse)||"").trim();O&&E.add(O)}return Array.from(E.values())},[r]),L=x.useMemo(()=>(Array.isArray(r)?r:[]).map(E=>({value:String(E.id),label:String(E.code||E.name||"")})),[r]),U=x.useMemo(()=>{const E=(Array.isArray(P)?P:[]).map(w=>({value:String(w),label:String(w)}));return!E.length&&String(c||"").trim()?[{value:String(c),label:String(c)}]:E},[P,c]),H=x.useMemo(()=>{const E=String(A||"").trim().toLowerCase();return E?j.filter(w=>String(w.account||"").toLowerCase().includes(E)):j},[j,A]),q=x.useMemo(()=>{const E=Math.max(1,Number(g||0)||1);return H.slice(0,E)},[H,g]),V=x.useMemo(()=>j.reduce((E,w)=>(E.credit+=Number(w.credit||0),E.debit+=Number(w.debit||0),E),{credit:0,debit:0}),[j]),M=x.useMemo(()=>yx.map((E,w)=>I(E*Number(S[w]||0))),[S]),z=x.useMemo(()=>I(M.reduce((E,w)=>E+Number(w||0),0)),[M]);function I(E){return Math.round(Number(E||0)*100)/100}function G(E,w){const O=E.get(String(w));if(!O)return String(w||"");const R=String(O.code||"").trim(),X=String(O.name||"").trim();return R&&X?`${R} - ${X}`:X||R||String(w||"")}function Y(E,w,O){const R=String(O||"").trim();if(!R)return"";const X=Number(R);if(Number.isFinite(X)&&X>0)return G(w,X);const ne=E.find(te=>String(te.code||"")===R);return ne?G(w,ne.id):R}function J(E){const w=Array.isArray(E)?E.slice():[];w.sort((R,X)=>{const ne=String((R==null?void 0:R.code)||""),te=String((X==null?void 0:X.code)||""),oe=String((R==null?void 0:R.name)||"").toLowerCase(),ce=String((X==null?void 0:X.name)||"").toLowerCase(),re=ne==="4000"||ne==="400000"?0:oe.includes("sales")?1:ne.toLowerCase().startsWith("4")?2:3,de=te==="4000"||te==="400000"?0:ce.includes("sales")?1:te.toLowerCase().startsWith("4")?2:3;return re!==de?re-de:ne.localeCompare(te)});const O=w[0];return O!=null&&O.id?Number(O.id):0}function T(E){return String(E||"").slice(0,10)}async function k(){var E,w,O,R;s(!0);try{const[X,ne,te,oe]=await Promise.all([ee.get("/pos/sales"),ee.get("/finance/accounts",{params:{postable:1,active:1}}),ee.get("/pos/tax-settings"),ee.get("/pos/payment-modes")]),ce=Array.isArray((E=X.data)==null?void 0:E.items)?X.data.items:[],re=Array.isArray((w=ne.data)==null?void 0:w.items)?ne.data.items:[],de=new Map(re.map(ue=>[String(ue.id),ue])),Ie=((O=te.data)==null?void 0:O.item)||null,le=Array.isArray((R=oe.data)==null?void 0:R.items)?oe.data.items:[],Z=T(l),ve=ce.filter(ue=>{const ge=T(ue.sale_date);return String(ue.payment_status||"").toUpperCase()==="PAID"&&ge===Z});if(!ve.length){N([]),window.alert("No completed POS sales found for the selected date.");return}const Ue=String((Ie==null?void 0:Ie.tax_type)||"Exclusive").toLowerCase(),Be=Ie&&Number(Ie.is_active)===0?0:1,_e=Be&&Number((Ie==null?void 0:Ie.tax_account_id)||0)>0?Number(Ie.tax_account_id):0,Me=re.filter(ue=>String(ue.nature||"").toUpperCase()==="INCOME"),Ye=J(Me);if(!Ye)throw new Error("Sales account not configured for posting");let ot=0,Ke=0;const ct=new Map;for(const ue of ve){const ge=Number(ue.gross_amount||0),Ve=Number(ue.discount_amount||0),tt=I(ge-Ve),Ze=I(Number(ue.tax_amount||0)),ht=I(Number(ue.total_amount||0));let ze=tt;Be&&Ue==="inclusive"&&Ze>0&&tt>0&&(ze=I(tt-Ze)),ot=I(ot+Math.max(0,ze)),Ke=I(Ke+Math.max(0,Ze));const Fe=String(ue.payment_method||"CASH").toUpperCase();ct.set(Fe,I((ct.get(Fe)||0)+ht))}if(Ke>0&&!_e)throw new Error("Tax account not configured in POS Tax Settings");const xt=[];ot>0&&xt.push({account:G(de,Ye),credit:ot,debit:0}),Ke>0&&_e&&xt.push({account:G(de,_e),credit:Ke,debit:0});const be=new Map;for(const ue of le){if(Number(ue.is_active)===0)continue;const ge=String(ue.type||"").toLowerCase();be.has(ge)||be.set(ge,ue)}const Ce=["CASH","CARD","MOBILE"],Te=Array.from(ct.keys()).sort((ue,ge)=>{const Ve=Ce.indexOf(ue),tt=Ce.indexOf(ge);return Ve===-1&&tt===-1?ue.localeCompare(ge):Ve===-1?1:tt===-1?-1:Ve-tt});for(const ue of Te){const ge=I(ct.get(ue)||0);if(ge<=0)continue;const Ve=ue==="CARD"?"card":ue==="MOBILE"?"mobile":"cash",tt=be.get(Ve),Ze=Y(re,de,tt==null?void 0:tt.account);if(!Ze)throw new Error(`No linked Finance account found for payment type: ${Ve}`);xt.push({account:Ze,credit:0,debit:ge})}N(xt)}catch(X){N([]),window.alert(String((X==null?void 0:X.message)||"Failed to populate transactions"))}finally{s(!1)}}function D(){i(""),N([]),f(""),B(yx.map(()=>0))}function Q(){const E=r.find(oe=>String(oe.id)===String(u)),w=E?String(E.code||E.name||"").trim():"",O=String(n||"").trim()||"Auto-generated",R=l,X=String(c||"").trim()||"-",ne=z.toFixed(2);window.confirm(`Post transaction to finance?

Voucher: ${O}
Date: ${R}
Till: ${w||"-"}
Warehouse: ${X}
Cash Total: GHS ${ne}`)&&(window.alert("Transaction posted to finance successfully!"),D())}const C=x.useMemo(()=>{const E=q.length?1:0,w=q.length;return`${E} - ${w}`},[q.length]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"POS Finance Posting"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher no."}),e.jsx("input",{className:"input",value:n,onChange:E=>i(E.target.value),placeholder:"Auto-generated"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Voucher Date"}),e.jsx("input",{className:"input",type:"date",value:l,onChange:E=>o(E.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Till"}),e.jsx(OS,{value:u,onChange:E=>{const w=String(E||"");d(w);const O=r.find(R=>String(R.id)===String(w));O&&h(String(O.warehouse||""))},options:L,placeholder:r.length?"Select till":"Loading...",filterPlaceholder:"Filter tills...",disabled:t||!r.length})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Warehouse"}),e.jsx(OS,{value:c,onChange:E=>h(String(E||"")),options:U,placeholder:U.length?"Select":"-",filterPlaceholder:"Filter warehouses...",disabled:t||!U.length})]})]}),e.jsx("div",{children:e.jsx("button",{type:"button",className:"btn-primary",onClick:k,disabled:t,children:"POPULATE DATA"})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-[1fr_350px] gap-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{className:"input",placeholder:"Search...",value:A,onChange:E=>f(E.target.value)})}),e.jsx("button",{type:"button",className:"btn-primary",onClick:k,disabled:t,children:"Go"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-sm text-slate-600",children:"Rows"}),e.jsxs("select",{className:"input",value:String(g),onChange:E=>v(Number(E.target.value)),children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>y(E=>!E),children:"Actions "}),b&&e.jsx("div",{className:"absolute right-0 mt-2 w-40 rounded border border-slate-200 bg-white shadow-lg z-10",children:e.jsx("button",{type:"button",className:"w-full text-left px-3 py-2 text-sm hover:bg-slate-50",onClick:()=>{y(!1),D()},children:"Clear"})})]})]}),e.jsx("div",{className:"overflow-x-auto rounded border border-slate-200",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Sr No"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Account Name"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Credit"}),e.jsx("th",{className:"text-right p-2 text-xs uppercase",children:"Debit"})]})}),e.jsx("tbody",{className:"bg-white",children:j.length?e.jsxs(e.Fragment,{children:[q.map((E,w)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2 text-center",children:w+1}),e.jsx("td",{className:"p-2",children:E.account}),e.jsx("td",{className:"p-2 text-right",children:Number(E.credit||0)>0?Number(E.credit||0).toFixed(2):""}),e.jsx("td",{className:"p-2 text-right",children:Number(E.debit||0)>0?Number(E.debit||0).toFixed(2):""})]},w)),e.jsxs("tr",{className:"border-t bg-slate-50 font-semibold",children:[e.jsx("td",{className:"p-2"}),e.jsx("td",{className:"p-2"}),e.jsx("td",{className:"p-2 text-right",children:V.credit.toFixed(2)}),e.jsx("td",{className:"p-2 text-right",children:V.debit.toFixed(2)})]})]}):e.jsx("tr",{children:e.jsx("td",{className:"p-10 text-center text-slate-500",colSpan:4,children:'Click "POPULATE DATA" to load transactions'})})})]})}),e.jsx("div",{className:"flex justify-end text-xs text-slate-600",children:C})]}),e.jsxs("div",{className:"rounded-lg bg-brand text-white p-4 h-fit",children:[e.jsx("div",{className:"text-center text-base font-semibold",children:"Denomination Cash Count"}),e.jsx("div",{className:"mt-4 space-y-2",children:yx.map((E,w)=>e.jsxs("div",{className:"grid grid-cols-[1fr_90px_110px] gap-2 items-center",children:[e.jsx("div",{className:"text-sm",children:`GHS ${Number(E).toFixed(2)}`}),e.jsx("input",{type:"number",min:"0",className:"rounded px-2 py-1 text-slate-900",value:String(S[w]??0),onChange:O=>{const R=S.slice();R[w]=Number(O.target.value||0),B(R)}}),e.jsx("div",{className:"rounded px-2 py-1 bg-white/20 text-right text-sm",children:M[w].toFixed(2)})]},String(E)))}),e.jsxs("div",{className:"mt-4 rounded bg-white/20 px-3 py-3 flex items-center justify-between font-semibold",children:[e.jsx("div",{children:"TOTAL:"}),e.jsx("div",{children:z.toFixed(2)})]}),e.jsx("button",{type:"button",className:"btn-primary w-full mt-4",onClick:Q,disabled:t||!j.length,children:"POST TO FINANCE"})]})]})]})})]})}function WZ(){const{user:t,scope:s}=ca();function r(le){try{const Z=new Date(le);if(Number.isNaN(Z.getTime()))return"";const ve=Ke=>String(Ke).padStart(2,"0"),Ue=Z.getFullYear(),Be=ve(Z.getMonth()+1),_e=ve(Z.getDate()),Me=ve(Z.getHours()),Ye=ve(Z.getMinutes()),ot=ve(Z.getSeconds());return`${Ue}-${Be}-${_e}T${Me}:${Ye}:${ot}`}catch{return""}}const[a,n]=x.useState(new Date),[i,l]=x.useState(""),[o,u]=x.useState([]),[d,c]=x.useState(!1),[h,A]=x.useState([]),[f,g]=x.useState({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),v=x.useMemo(()=>Number((t==null?void 0:t.sub)||(t==null?void 0:t.id)||0),[t]),b=x.useMemo(()=>{const le=(t==null?void 0:t.username)||(t==null?void 0:t.name)||(t==null?void 0:t.fullName)||"Cashier";return String(le)},[t]),[y,j]=x.useState(!1),[N,S]=x.useState({dateTime:r(new Date),float:"",supervisor:"",notes:""}),[B,P]=x.useState(new Array(6).fill(!1)),L=x.useMemo(()=>{const le=B.length||1,Z=B.filter(Boolean).length;return Math.round(Z/le*100)},[B]),[U,H]=x.useState({cash:{count:0,amount:0},card:{count:0,amount:0},mobile:{count:0,amount:0}}),q=x.useMemo(()=>{const le=Number(U.cash.amount||0)+Number(U.card.amount||0)+Number(U.mobile.amount||0),Z=Number(U.cash.count||0)+Number(U.card.count||0)+Number(U.mobile.count||0);return{totalAmount:le,totalCount:Z}},[U]),V=x.useMemo(()=>Number(N.float||0)+Number(U.cash.amount||0),[N.float,U.cash.amount]),[M,z]=x.useState({dateTime:r(new Date),actualCash:"",notes:""}),I=x.useMemo(()=>Number(M.actualCash||0)-Number(V||0),[M.actualCash,V]),[G,Y]=x.useState([{time:new Date,title:"Waiting",description:"No activity yet"}]),[J,T]=x.useState({open:!1,title:"",icon:"",message:""}),[k,D]=x.useState([]),Q=x.useMemo(()=>({cashCount:Number(U.cash.count||0),cashAmount:Number(U.cash.amount||0),cardCount:Number(U.card.count||0),cardAmount:Number(U.card.amount||0),mobileCount:Number(U.mobile.count||0),mobileAmount:Number(U.mobile.amount||0)}),[U]),C=x.useMemo(()=>f.open?f.index>=0&&f.index<k.length?k[f.index]:f.item:null,[f.open,f.index,f.item,k]);x.useEffect(()=>{const le=setInterval(()=>n(new Date),1e3);return()=>clearInterval(le)},[]),x.useEffect(()=>{const le=String((t==null?void 0:t.username)||"").trim();le&&!N.supervisor&&S(Z=>({...Z,supervisor:le}))},[t==null?void 0:t.username]),x.useEffect(()=>{let le=!1;async function Z(){var ve,Ue,Be;if(v){c(!0);try{const[_e,Me]=await Promise.all([ee.get("/pos/terminals"),ee.get("/pos/terminal-users")]);if(le)return;const Ye=Array.isArray((ve=_e.data)==null?void 0:ve.items)?_e.data.items:[],ot=Array.isArray((Ue=Me.data)==null?void 0:Ue.items)?Me.data.items:[],Ke=new Set(ot.filter(Ce=>Number(Ce==null?void 0:Ce.user_id)===Number(v)).map(Ce=>Number(Ce==null?void 0:Ce.terminal_id)).filter(Ce=>Number.isFinite(Ce)&&Ce>0)),ct=Ye.filter(Ce=>Ke.has(Number(Ce==null?void 0:Ce.id)));u(ct);const be=ct.some(Ce=>String((Ce==null?void 0:Ce.code)||"")===String(i||""))?i:((Be=ct[0])==null?void 0:Be.code)||"";l(be?String(be):"")}catch{if(le)return;u([]),l("")}finally{le||c(!1)}}}return Z(),()=>{le=!0}},[v,b]),x.useEffect(()=>{let le=!1;async function Z(){var ve;try{const Ue=Number((s==null?void 0:s.companyId)||0)||void 0,Be=Number((s==null?void 0:s.branchId)||0)||void 0,_e=await ee.get("/admin/users",{params:{...Ue?{company_id:Ue}:{},...Be?{branch_id:Be}:{},active:1,limit:100}});if(le)return;A(Array.isArray((ve=_e.data)==null?void 0:ve.items)?_e.data.items:[])}catch{if(le)return;A([])}}return Z(),()=>{le=!0}},[s==null?void 0:s.companyId,s==null?void 0:s.branchId]),x.useEffect(()=>{let le=!1;return ee.get("/pos/analytics/day-summary").then(Z=>{var Be;if(le)return;const ve=((Be=Z==null?void 0:Z.data)==null?void 0:Be.summary)||{},Ue={cash:{count:Number(ve.cashCount||0),amount:Number(ve.cashAmount||0)},card:{count:Number(ve.cardCount||0),amount:Number(ve.cardAmount||0)},mobile:{count:Number(ve.mobileCount||0),amount:Number(ve.mobileAmount||0)}};H(Ue)}).catch(()=>{}),()=>{le=!0}},[]),x.useEffect(()=>{let le=!1;const Z=i;if(Z)return ee.get("/pos/day/status",{params:{terminal:Z}}).then(ve=>{var Me;if(le)return;const Ue=(Me=ve==null?void 0:ve.data)==null?void 0:Me.item;if(!Ue){j(!1),D([]);return}const Be=String(Ue.status||"").toUpperCase()==="OPEN";j(Be),S({dateTime:r(Ue.open_datetime||""),float:Ue.opening_float===null||Ue.opening_float===void 0?"":String(Ue.opening_float),supervisor:Ue.supervisor_name||"",notes:Ue.open_notes||""}),z(Ye=>({...Ye,dateTime:r(Ue.close_datetime||""),actualCash:Ue.actual_cash===null||Ue.actual_cash===void 0?"":String(Ue.actual_cash),notes:Ue.close_notes||""}));const _e={dayStatusId:Number(Ue.id||0)||null,no:`DAY-${String(Ue.id||"").padStart(6,"0")}`,terminal:String(Ue.terminal_code||Z||""),cashier:b,start:Ue.open_datetime?new Date(Ue.open_datetime).toLocaleString():"-",startTime:Ue.open_datetime||null,end:Ue.close_datetime?new Date(Ue.close_datetime).toLocaleString():"-",endTime:Ue.close_datetime||null,opening:Number(Ue.opening_float||0),status:Be?"Open":"Closed",startSummary:oe({}),endSummary:Be?null:Q,expectedCash:null,actualCash:Ue.actual_cash===null||Ue.actual_cash===void 0?null:Number(Ue.actual_cash||0),cashVariance:null,closeNotes:Ue.close_notes||""};if(!Be&&_e.actualCash!==null){const Ye=Number(_e.opening||0)+Number(Q.cashAmount||0);_e.expectedCash=Ye,_e.cashVariance=Number(_e.actualCash||0)-Ye}D([_e]),E(Be?"Day Status":"Last Day Status",Be?"Day is currently open":"Last day is closed")}).catch(()=>{}),()=>{le=!0}},[i]);function E(le,Z){const ve={time:new Date,title:le,description:Z};Y(Ue=>{var Me;const _e=Ue.length===1&&String((Me=Ue[0])==null?void 0:Me.title).includes("Waiting")?[]:Ue.slice();return[ve,..._e].slice(0,50)})}function w(le,Z,ve){T({open:!0,title:le,icon:Z,message:ve})}function O(){T(le=>({...le,open:!1}))}function R(le){P(Z=>{const ve=Z.slice();ve[le]=!ve[le];const Ue=["Verify cash float count","Check POS system connectivity","Verify printer and receipt paper","Test card payment terminal","Review pending transactions","Confirm inventory sync"][le];return E(ve[le]?"Checklist Completed":"Checklist Unchecked",Ue),ve})}async function X(le){var ve,Ue,Be,_e,Me;if(le.preventDefault(),!B.every(Boolean)){nt.warn("Complete all opening checklist items");return}if(!N.dateTime||!N.supervisor){nt.warn("Provide opening date/time and supervisor");return}try{const Ye={terminal:i,openingDateTime:N.dateTime,openingFloat:Number(N.float||0),supervisor:N.supervisor,notes:N.notes},ot=await ee.post("/pos/day/open",Ye),Ke=(ve=ot==null?void 0:ot.data)==null?void 0:ve.item;Ke?(j(String(Ke.status||"").toUpperCase()==="OPEN"),S({dateTime:r(Ke.open_datetime||"")||N.dateTime,float:Ke.opening_float===null||Ke.opening_float===void 0?String(N.float||""):String(Ke.opening_float),supervisor:Ke.supervisor_name||N.supervisor,notes:Ke.open_notes||N.notes}),D([{dayStatusId:Number(Ke.id||0)||null,no:`DAY-${String(Ke.id||"").padStart(6,"0")}`,terminal:String(Ke.terminal_code||i||""),cashier:b,start:Ke.open_datetime?new Date(Ke.open_datetime).toLocaleString():new Date(N.dateTime).toLocaleString(),startTime:Ke.open_datetime||N.dateTime,end:"-",endTime:null,opening:Number(Ke.opening_float??N.float??0),status:"Open",startSummary:oe({}),endSummary:null,expectedCash:null,actualCash:null,cashVariance:null,closeNotes:""}])):j(!0),w("Day Opened","","Day is open. Complete transactions and close day when finished."),E("Day Opened","Operations started")}catch(Ye){const ot=((Be=(Ue=Ye==null?void 0:Ye.response)==null?void 0:Ue.data)==null?void 0:Be.message)||((Me=(_e=Ye==null?void 0:Ye.response)==null?void 0:_e.data)==null?void 0:Me.error)||"Failed to open day";nt.error(ot)}}async function ne(le){var Z,ve,Ue,Be,_e,Me;if(le.preventDefault(),!y){nt.error("Open the day first");return}if(!M.dateTime){nt.warn("Provide closing date/time");return}try{const Ye={terminal:i,closingDateTime:M.dateTime,actualCash:Number(M.actualCash||0),notes:M.notes},ot=await ee.post("/pos/day/close",Ye),Ke=(Z=ot==null?void 0:ot.data)==null?void 0:Z.item;if(Ke){z(xt=>({...xt,dateTime:r(Ke.close_datetime||"")||M.dateTime,actualCash:Ke.actual_cash===null||Ke.actual_cash===void 0?String(M.actualCash||""):String(Ke.actual_cash),notes:Ke.close_notes||M.notes})),j(String(Ke.status||"").toUpperCase()==="OPEN");let ct=Q;try{const xt=await ee.get("/pos/analytics/day-summary");ct=oe(((ve=xt==null?void 0:xt.data)==null?void 0:ve.summary)||{})}catch{}D(xt=>{const be=Array.isArray(xt)&&xt.length?xt[0]:{},Ce=Number(be.opening??N.float??Ke.opening_float??0),Te=Ce+Number(ct.cashAmount||0),ue=Number(Ke.actual_cash??M.actualCash??0);return[{...be,dayStatusId:Number(Ke.id||be.dayStatusId||0)||null,no:be.no||`DAY-${String(Ke.id||"").padStart(6,"0")}`,terminal:String(Ke.terminal_code||i||be.terminal||""),cashier:b,start:be.start||(N.dateTime?new Date(N.dateTime).toLocaleString():"-"),startTime:be.startTime||N.dateTime||null,end:Ke.close_datetime?new Date(Ke.close_datetime).toLocaleString():new Date(M.dateTime).toLocaleString(),endTime:Ke.close_datetime||M.dateTime,opening:Ce,status:"Closed",startSummary:be.startSummary||oe({}),endSummary:ct,expectedCash:Te,actualCash:ue,cashVariance:ue-Te,closeNotes:Ke.close_notes||M.notes||""}]})}else j(!1);w("Day Closed","","End-of-day reconciliation complete. See report summary below."),E("Day Closed","Operations ended")}catch(Ye){const ot=((Be=(Ue=Ye==null?void 0:Ye.response)==null?void 0:Ue.data)==null?void 0:Be.message)||((Me=(_e=Ye==null?void 0:Ye.response)==null?void 0:_e.data)==null?void 0:Me.error)||"Failed to close day";nt.error(ot)}}function te(le){return`${Number(le||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}function oe(le){const Z=le||{};return{cashCount:Number(Z.cashCount||0),cashAmount:Number(Z.cashAmount||0),cardCount:Number(Z.cardCount||0),cardAmount:Number(Z.cardAmount||0),mobileCount:Number(Z.mobileCount||0),mobileAmount:Number(Z.mobileAmount||0)}}function ce(le,Z){const ve=oe(le),Ue=oe(Z),Be=(_e,Me)=>Math.max(0,Number(_e||0)-Number(Me||0));return{cashCount:Be(ve.cashCount,Ue.cashCount),cashAmount:Be(ve.cashAmount,Ue.cashAmount),cardCount:Be(ve.cardCount,Ue.cardCount),cardAmount:Be(ve.cardAmount,Ue.cardAmount),mobileCount:Be(ve.mobileCount,Ue.mobileCount),mobileAmount:Be(ve.mobileAmount,Ue.mobileAmount)}}function re(le){const Z=(le==null?void 0:le.startSummary)!==null&&(le==null?void 0:le.startSummary)!==void 0,ve=(le==null?void 0:le.endSummary)||Q,Ue=Z?ce(ve,(le==null?void 0:le.startSummary)||null):{cashCount:0,cashAmount:0,cardCount:0,cardAmount:0,mobileCount:0,mobileAmount:0},Be=Number(Ue.cashCount||0)+Number(Ue.cardCount||0)+Number(Ue.mobileCount||0),_e=Number(Ue.cashAmount||0)+Number(Ue.cardAmount||0)+Number(Ue.mobileAmount||0),Me=Z?_e:Number((le==null?void 0:le.sales)||0),Ye=(le==null?void 0:le.status)==="Closed"&&(le==null?void 0:le.expectedCash)!==null&&(le==null?void 0:le.expectedCash)!==void 0?Number(le.expectedCash||0):Number((le==null?void 0:le.opening)||0)+Number(Ue.cashAmount||0),ot=(le==null?void 0:le.status)==="Closed"&&(le==null?void 0:le.actualCash)!==null&&(le==null?void 0:le.actualCash)!==void 0?Number(le.actualCash||0):(le==null?void 0:le.actualCash)===null||(le==null?void 0:le.actualCash)===void 0?null:Number(le.actualCash||0),Ke=(le==null?void 0:le.status)==="Closed"&&(le==null?void 0:le.cashVariance)!==null&&(le==null?void 0:le.cashVariance)!==void 0?Number(le.cashVariance||0):ot===null?null:ot-Ye;return{diff:Ue,totalCount:Be,totalAmount:Me,expectedCashAtClose:Ye,actualCashAtClose:ot,cashVarianceAtClose:Ke}}function de(le){try{return new Date(le).toLocaleTimeString()}catch{return"--:--"}}function Ie(){const le=q.totalAmount,Z=q.totalCount,ve=window.open("","_blank");if(!ve)return;const Ue=a.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),Be=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>POS End of Day Report</title>
        <style>
          body { font-family: 'Courier New', monospace; padding: 20px; max-width: 700px; margin: 0 auto; }
          h1 { text-align: center; border-bottom: 2px solid #0E3646; padding-bottom: 10px; color: #0E3646; }
          .row { display: flex; justify-content: space-between; margin: 5px 0; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; }
          th { background: #0E3646; color: white; }
          .totals { background: #f0f0f0; font-weight: bold; }
          .footer { margin-top: 20px; }
          @media print { button { display: none; } }
        </style>
      </head>
      <body>
        <h1>END OF DAY REPORT</h1>
        <div class="row"><strong>Terminal:</strong><span>${i}</span></div>
        <div class="row"><strong>Cashier:</strong><span>${b}</span></div>
        <div class="row"><strong>Date:</strong><span>${Ue}</span></div>
        <div class="row"><strong>Opening Float:</strong><span>${te(N.float)}</span></div>
        <table>
          <thead>
            <tr><th>Payment Method</th><th>Transactions</th><th>Amount Received</th></tr>
          </thead>
          <tbody>
            <tr><td>Cash</td><td>${U.cash.count}</td><td>${te(U.cash.amount)}</td></tr>
            <tr><td>Card</td><td>${U.card.count}</td><td>${te(U.card.amount)}</td></tr>
            <tr><td>Mobile Money</td><td>${U.mobile.count}</td><td>${te(U.mobile.amount)}</td></tr>
            <tr class="totals"><td><strong>TOTAL</strong></td><td><strong>${Z}</strong></td><td><strong>${te(le)}</strong></td></tr>
          </tbody>
        </table>
        <div class="footer">
          <div class="row"><strong>Expected Cash:</strong><span>${te(V)}</span></div>
          <div class="row"><strong>Actual Cash Count:</strong><span>${te(M.actualCash||0)}</span></div>
          <div class="row"><strong>Variance:</strong><span>${te(I)}</span></div>
        </div>
        <button onclick="window.print()">Print</button>
      </body>
      </html>
    `;ve.document.write(Be),ve.document.close()}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/pos",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to POS"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100",children:"POS Day Management"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Open and close POS business day with reconciliation"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:a.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700 dark:text-brand-300",children:a.toLocaleTimeString()})]})]}),e.jsx("div",{className:"rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Terminal"}),e.jsx("div",{className:"space-y-1",children:e.jsxs("select",{className:"input py-1 px-2 text-sm",value:i,onChange:le=>l(le.target.value),disabled:d||!o.length,children:[!o.length&&e.jsx("option",{value:"",children:d?"Loading...":"No terminals assigned"}),o.map(le=>e.jsx("option",{value:String(le.code||""),children:String(le.code||"")},le.id))]})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Cashier"}),e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:b})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-slate-500 text-sm",children:"Date"}),e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100 text-sm",children:a.toLocaleDateString()})]}),e.jsx("div",{children:e.jsx("span",{className:y?"badge-success":"badge-danger",children:y?"OPEN":"CLOSED"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Open Day"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsxs("div",{className:"card-body",children:[!y&&e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Day Opening Procedure"}),e.jsx("div",{className:"text-blue-800",children:"Complete the checklist and verify opening float before starting operations."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Opening Date & Time"}),e.jsx("input",{type:"datetime-local",className:"input",value:N.dateTime,onChange:le=>S(Z=>({...Z,dateTime:le.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Opening Float ()"}),e.jsx("input",{type:"number",className:"input",step:"1",value:N.float,onChange:le=>S(Z=>({...Z,float:le.target.value})),required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Supervisor Name"}),e.jsxs("select",{className:"input",value:N.supervisor,onChange:le=>S(Z=>({...Z,supervisor:le.target.value})),required:!0,children:[e.jsx("option",{value:"",children:"Select supervisor"}),N.supervisor&&!h.some(le=>String((le==null?void 0:le.username)||"")===String(N.supervisor))&&e.jsx("option",{value:N.supervisor,children:N.supervisor}),h.map(le=>e.jsx("option",{value:String(le.username||""),children:String(le.username||"")},le.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Notes"}),e.jsx("textarea",{className:"input",rows:3,value:N.notes,onChange:le=>S(Z=>({...Z,notes:le.target.value}))})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"font-semibold text-slate-700",children:"Opening Checklist"}),e.jsxs("div",{className:"font-semibold text-brand-700",children:[L,"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-slate-200 rounded",children:e.jsx("div",{className:"h-3 rounded bg-gradient-to-r from-brand-700 to-brand-500",style:{width:`${L}%`}})}),e.jsx("ul",{className:"mt-3 space-y-2",children:["Verify cash float count","Check POS system connectivity","Verify printer and receipt paper","Test card payment terminal","Review pending transactions","Confirm inventory sync"].map((le,Z)=>e.jsxs("li",{className:`flex items-center gap-3 p-3 rounded-lg border ${B[Z]?"bg-green-50 border-green-200":"bg-slate-50 border-slate-200"}`,children:[e.jsx("input",{type:"checkbox",className:"checkbox",checked:B[Z],onChange:()=>R(Z)}),e.jsx("div",{className:`text-sm ${B[Z]?"line-through":""}`,children:le})]},Z))})]}),e.jsx("button",{type:"submit",className:"btn-success w-full",children:" Open Day"})]}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"alert-success rounded-lg p-4 flex items-center gap-2",children:[e.jsx("span",{children:""}),e.jsx("div",{children:"Day is currently open. Complete transactions and close day when finished."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Opened At"}),e.jsx("div",{className:"font-semibold",children:de(N.dateTime)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Opening Float"}),e.jsx("div",{className:"font-bold",children:te(N.float)})]})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Close Day"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsx("div",{className:"card-body",children:e.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[e.jsx("div",{className:"font-semibold text-blue-900 mb-1",children:"Day Closing Procedure"}),e.jsx("div",{className:"text-blue-800",children:"Complete end-of-day reconciliation and verify all transactions before closing."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Closing Date & Time"}),e.jsx("input",{type:"datetime-local",className:"input",value:M.dateTime,onChange:le=>z(Z=>({...Z,dateTime:le.target.value})),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Total Sales"}),e.jsx("div",{className:"font-bold",children:te(q.totalAmount)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Transactions"}),e.jsx("div",{className:"font-semibold",children:q.totalCount})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Actual Cash Count ()"}),e.jsx("input",{type:"number",className:"input",step:"1",value:M.actualCash,onChange:le=>z(Z=>({...Z,actualCash:le.target.value})),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Expected Cash"}),e.jsx("input",{type:"text",className:"input",disabled:!0,value:te(V)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Cash Variance"}),e.jsx("input",{type:"text",className:"input",disabled:!0,value:te(I),style:{color:I>=0?"#28a745":"#dc3545",fontWeight:700}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Closing Notes"}),e.jsx("textarea",{className:"input",rows:3,value:M.notes,onChange:le=>z(Z=>({...Z,notes:le.target.value}))})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200",children:[e.jsx("div",{className:"p-3 font-semibold",children:"Sales Report"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Transactions"}),e.jsx("th",{children:"Amount Received"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:U.cash.count}),e.jsx("td",{children:te(U.cash.amount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Card"}),e.jsx("td",{children:U.card.count}),e.jsx("td",{children:te(U.card.amount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Mobile Money"}),e.jsx("td",{children:U.mobile.count}),e.jsx("td",{children:te(U.mobile.amount)})]}),e.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{children:q.totalCount}),e.jsx("td",{children:te(q.totalAmount)})]})]})]})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn-danger flex-1",children:" Close Day"}),e.jsx("button",{type:"button",className:"btn-info flex-1",onClick:Ie,children:" Print Report"})]})]})})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Activity Timeline"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-3",children:[G.map((le,Z)=>e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsxs("div",{className:"text-sm font-semibold text-brand-700",children:[new Date(le.time).toLocaleTimeString()," - ",le.title]}),e.jsx("div",{className:"text-sm",children:le.description})]},Z)),!G.length&&e.jsx("div",{className:"text-sm text-slate-500",children:"No activity yet"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("div",{className:"card-title",children:"Sessions/Shifts"}),e.jsx("div",{className:"text-2xl",children:""})]}),e.jsx("div",{className:"card-body space-y-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Session History"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-slate-200",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"bg-slate-800 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Session #"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Terminal"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Cashier"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Start Time"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"End Time"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Opening Cash"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Total Sales"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Status"}),e.jsx("th",{className:"text-left p-2 text-xs uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white",children:k.map((le,Z)=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:le.no}),e.jsx("td",{className:"p-2",children:le.terminal}),e.jsx("td",{className:"p-2",children:le.cashier}),e.jsx("td",{className:"p-2",children:le.start}),e.jsx("td",{className:"p-2",children:le.end}),e.jsx("td",{className:"p-2",children:Number(le.opening).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"p-2",children:Number(le.sales).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}),e.jsx("td",{className:"p-2",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${le.status==="Open"?"bg-blue-100 text-blue-700":le.status==="Closed"?"bg-green-100 text-green-700":"bg-slate-100 text-slate-700"}`,children:le.status})}),e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-info",onClick:()=>g({open:!0,mode:"details",index:Z,item:le,actualCash:"",notes:""}),children:"Details"}),le.status==="Open"?e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{g({open:!0,mode:"close",index:Z,item:le,actualCash:"",notes:""})},children:"Close"}):e.jsx("button",{type:"button",className:"btn btn-info",disabled:!0,children:"Closed"})]})})]},Z))})]})})]})})]}),f.open&&C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"rounded-xl bg-white dark:bg-slate-800 shadow-lg w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900 dark:text-slate-100",children:f.mode==="close"?`Close ${C.no}`:`Session ${C.no}`}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:()=>g({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),children:""})]}),(()=>{const le=C,Z=re(le),ve=le.start||(le.startTime?new Date(le.startTime).toLocaleString():"-"),Ue=le.end&&le.end!=="-"?le.end:le.endTime?new Date(le.endTime).toLocaleString():"-",Be=Z.cashVarianceAtClose!==null;return f.mode==="close"?e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Terminal"}),e.jsx("div",{className:"font-semibold",children:le.terminal})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cashier"}),e.jsx("div",{className:"font-semibold",children:le.cashier})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Start Time"}),e.jsx("div",{className:"font-semibold",children:ve})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Expected Cash"}),e.jsx("div",{className:"font-bold",children:te(Z.expectedCashAtClose)})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3 font-semibold bg-slate-50",children:"Sales (Since Session Start)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Transactions"}),e.jsx("th",{children:"Amount Received"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:Z.diff.cashCount}),e.jsx("td",{children:te(Z.diff.cashAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Card"}),e.jsx("td",{children:Z.diff.cardCount}),e.jsx("td",{children:te(Z.diff.cardAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Mobile Money"}),e.jsx("td",{children:Z.diff.mobileCount}),e.jsx("td",{children:te(Z.diff.mobileAmount)})]}),e.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{children:Z.totalCount}),e.jsx("td",{children:te(Z.totalAmount)})]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Actual Cash Count ()"}),e.jsx("input",{type:"number",className:"input",step:"1",value:f.actualCash,onChange:_e=>g(Me=>({...Me,actualCash:_e.target.value})),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Closing Notes"}),e.jsx("textarea",{className:"input",rows:3,value:f.notes,onChange:_e=>g(Me=>({...Me,notes:_e.target.value}))})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>g({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-danger",onClick:async()=>{var Ke;const _e=f.index;if(_e<0||_e>=k.length)return;if(String(f.actualCash||"").trim()===""){nt.warn("Provide actual cash count");return}let Me=Q;try{const ct=await ee.get("/pos/analytics/day-summary");Me=oe(((Ke=ct==null?void 0:ct.data)==null?void 0:Ke.summary)||{})}catch{}const Ye=new Date,ot=Number(f.actualCash||0);D(ct=>ct.map((xt,be)=>{if(be!==_e)return xt;const Ce=ce(Me,(xt==null?void 0:xt.startSummary)||null),Te=Number(Ce.cashAmount||0)+Number(Ce.cardAmount||0)+Number(Ce.mobileAmount||0),ue=Number((xt==null?void 0:xt.opening)||0)+Number(Ce.cashAmount||0),ge=ot-ue;return{...xt,end:Ye.toLocaleString(),endTime:Ye.toISOString(),status:"Closed",sales:Te,endSummary:Me,expectedCash:ue,actualCash:ot,cashVariance:ge,closeNotes:f.notes||""}})),E("Session Closed",`${C.cashier} on ${C.terminal}`),g({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""})},children:"Close Session"})]})]}):e.jsxs("div",{className:"max-h-[70vh] overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Terminal"}),e.jsx("div",{className:"font-semibold",children:le.terminal})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Cashier"}),e.jsx("div",{className:"font-semibold",children:le.cashier})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Status"}),e.jsx("div",{className:"font-semibold",children:le.status})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Start Time"}),e.jsx("div",{className:"font-semibold",children:ve})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"End Time"}),e.jsx("div",{className:"font-semibold",children:Ue})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-slate-50",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Opening Cash"}),e.jsx("div",{className:"font-bold",children:te(le.opening)})]})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3 font-semibold bg-slate-50",children:"Sales Breakdown"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Transactions"}),e.jsx("th",{children:"Amount Received"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Cash"}),e.jsx("td",{children:Z.diff.cashCount}),e.jsx("td",{children:te(Z.diff.cashAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Card"}),e.jsx("td",{children:Z.diff.cardCount}),e.jsx("td",{children:te(Z.diff.cardAmount)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Mobile Money"}),e.jsx("td",{children:Z.diff.mobileCount}),e.jsx("td",{children:te(Z.diff.mobileAmount)})]}),e.jsxs("tr",{className:"bg-blue-50 font-semibold",children:[e.jsx("td",{children:"TOTAL"}),e.jsx("td",{children:Z.totalCount}),e.jsx("td",{children:te(Z.totalAmount)})]})]})]})})]}),e.jsxs("div",{className:"rounded-lg border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-3 font-semibold bg-slate-50",children:"Cash Reconciliation"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4",children:[e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Expected Cash"}),e.jsx("div",{className:"font-bold",children:te(Z.expectedCashAtClose)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Actual Cash"}),e.jsx("div",{className:"font-bold",children:Z.actualCashAtClose===null?"-":te(Z.actualCashAtClose)})]}),e.jsxs("div",{className:"p-3 rounded-lg border border-slate-200 bg-white",children:[e.jsx("div",{className:"text-xs text-slate-600",children:"Variance"}),e.jsx("div",{className:"font-bold",style:{color:Z.cashVarianceAtClose===null?void 0:Z.cashVarianceAtClose>=0?"#28a745":"#dc3545"},children:Be?te(Z.cashVarianceAtClose):"-"})]})]}),(le.closeNotes||(C==null?void 0:C.closeNotes))&&e.jsx("div",{className:"px-4 pb-4 text-sm text-slate-700",children:le.closeNotes||(C==null?void 0:C.closeNotes)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>g({open:!1,mode:"details",index:-1,item:null,actualCash:"",notes:""}),children:"Close"})})]})})()]})}),J.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"rounded-xl bg-white dark:bg-slate-800 shadow-lg w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-xl font-bold text-slate-900 dark:text-slate-100",children:J.title}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link",onClick:O,children:""})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"text-center text-6xl",children:J.icon}),e.jsx("div",{className:"text-center",children:J.message}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx(Le,{to:"/pos",className:"btn-secondary",children:"Return to POS"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:O,children:"Continue"})]})]})]})})]})}function GZ(){const[t,s]=x.useState(null),[r,a]=x.useState(new Date),{token:n}=ca();x.useEffect(()=>{let u=!1;return ee.get("/pos/analytics/overview").then(d=>{u||s(d.data||null)}).catch(()=>{u||s(null)}),()=>{u=!0}},[n]),x.useEffect(()=>{const u=setInterval(()=>a(new Date),1e3);return()=>clearInterval(u)},[]);const i=u=>`GH${Number(u||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,l=[{icon:"",value:i((t==null?void 0:t.todaySales)||0),label:"Today Sales",path:"/pos/reports"},{icon:"",value:String((t==null?void 0:t.totalCustomers)??0),label:"Total Customers",path:"/sales/customers"},{icon:"",value:i((t==null?void 0:t.averageOrder)||0),label:"Average Order",path:"/pos/reports"},{icon:"",value:i((t==null?void 0:t.monthlyRevenue)||0),label:"Monthly Revenue",path:"/finance/reports"}],o=[{title:"Transactions",features:[{name:"Sales Entry",path:"/pos/sales-entry",description:"Quick sales entry",icon:""},{name:"Start/End Business Day",path:"/pos/day-management",description:"Open/close POS business day and reconciliation",icon:""},{name:"Cash Collection",path:"/pos/cash-collection",description:"Invoices list and collection summary",icon:""},{name:"POS Invoices",path:"/pos/invoices",description:"All invoices created from sales entry",icon:""},{name:"Post to Finance",path:"/pos/post-to-finance",description:"Post POS sales as finance sales vouchers",icon:""},{name:"POS Returns",path:"/pos/returns",description:"Process sales returns and refunds",icon:""},{name:"POS Register",path:"/pos/register",description:"Transactions listing and details",icon:""}]},{title:"Setup",features:[{name:"POS Setup",path:"/pos/setup",description:"Configure terminals, shifts, payments, and settings",icon:""}]},{title:"Reports",features:[{name:"POS Reports",path:"/pos/reports",description:"Daily sales and performance reports",icon:""}]}];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:"Point of Sale"}),e.jsx("div",{className:"text-sm text-slate-600",children:"Retail sales and transaction management"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-slate-700",children:r.toLocaleDateString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("div",{className:"text-sm font-semibold text-brand-700",children:r.toLocaleTimeString()})]})]}),e.jsx(Gl,{title:"Point of Sale",description:"Retail sales and transaction management",stats:l,sections:o})]})}function KZ(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(GZ,{})}),e.jsx(Je,{path:"/returns",element:e.jsx(RS,{})}),e.jsx(Je,{path:"/returns/new",element:e.jsx(RS,{})}),e.jsx(Je,{path:"/register",element:e.jsx(OZ,{})}),e.jsx(Je,{path:"/sales-entry",element:e.jsx(MZ,{})}),e.jsx(Je,{path:"/cash-collection",element:e.jsx(qZ,{})}),e.jsx(Je,{path:"/invoices",element:e.jsx(VZ,{})}),e.jsx(Je,{path:"/post-to-finance",element:e.jsx($Z,{})}),e.jsx(Je,{path:"/day-management",element:e.jsx(WZ,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(EZ,{})}),e.jsx(Je,{path:"/setup",element:e.jsx(RZ,{})})]})}function zZ(){const t=[{id:1,name:"Executive Overview",description:"Enterprise KPIs across all modules",active:!0,icon:"",color:"from-emerald-600 to-emerald-800"},{id:2,name:"Sales KPIs",description:"Revenue, average order, customer growth, profitability",active:!0,icon:"",color:"from-blue-600 to-blue-800"},{id:3,name:"Purchase KPIs",description:"Spend, supplier performance, order cycle times",active:!0,icon:"",color:"from-indigo-600 to-indigo-800"},{id:4,name:"Inventory KPIs",description:"Stock valuation, turns, low-stock, aging",active:!0,icon:"",color:"from-purple-600 to-purple-800"},{id:5,name:"Finance KPIs",description:"P&L highlights, cash flow, ratios, ledger health",active:!0,icon:"",color:"from-rose-600 to-rose-800"},{id:6,name:"Human Resources KPIs",description:"Headcount, attendance, payroll, attrition",active:!0,icon:"",color:"from-teal-600 to-teal-800"},{id:7,name:"POS KPIs",description:"Terminal sales, peak hours, basket size, payment mix",active:!0,icon:"",color:"from-orange-600 to-orange-800"},{id:8,name:"Production KPIs",description:"WO throughput, yield, downtime, OEE",active:!0,icon:"",color:"from-yellow-600 to-yellow-700"},{id:9,name:"Project Management KPIs",description:"Progress, burn-down, cycle time, blockers",active:!0,icon:"",color:"from-cyan-600 to-cyan-800"},{id:10,name:"Maintenance KPIs",description:"Work orders, MTTR, compliance, asset health",active:!0,icon:"",color:"from-lime-600 to-lime-700"},{id:11,name:"Administration KPIs",description:"User activity, permissions, audit status",active:!0,icon:"",color:"from-slate-600 to-slate-800"},{id:12,name:"Custom Analytics",description:"Cross-module insights and ad-hoc dashboards",active:!0,icon:"",color:"from-fuchsia-600 to-fuchsia-800"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Dashboards"}),e.jsx("p",{className:"text-sm mt-1",children:"Saved KPI dashboards covering all modules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/business-intelligence",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/business-intelligence/dashboards/new",className:"btn-success",children:"+ New Dashboard"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(s=>e.jsx("div",{className:`rounded-xl shadow-erp border border-slate-200 dark:border-slate-700 overflow-hidden bg-gradient-to-br ${s.color} text-white`,children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-2xl",children:s.icon}),e.jsx("span",{className:s.active?"badge badge-success":"badge badge-error",children:s.active?"Active":"Inactive"})]}),e.jsx("div",{className:"mt-3 font-bold text-lg",children:s.name}),e.jsx("div",{className:"mt-1 text-sm opacity-90",children:s.description}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(Le,{to:`/business-intelligence/dashboards/${s.id}?mode=view`,className:"btn btn-sm btn-secondary",children:"View"}),e.jsx(Le,{to:`/business-intelligence/dashboards/${s.id}?mode=edit`,className:"btn btn-sm btn-secondary",children:"Edit"})]})]})},s.id))})]})}function QS(){var P,L,U,H,q,V,M;const t=ys(),{id:s}=Ls(),r=!!s,{search:a}=ma(),i=new URLSearchParams(a).get("mode")==="view",[l,o]=x.useState(!1),[u,d]=x.useState({name:"",description:"",active:!0}),[c,h]=x.useState(null),[A,f]=x.useState([]),[g,v]=x.useState([]),[b,y]=x.useState([]);x.useEffect(()=>{r&&(o(!0),setTimeout(()=>{d({name:"Executive Overview",description:"High-level KPIs across modules",active:!0}),o(!1)},150))},[r]),x.useEffect(()=>{if(!i)return;let z=!1;return o(!0),Promise.all([ee.get("/bi/dashboards").catch(()=>({data:{}})),ee.get("/bi/sales-report").catch(()=>({data:{items:[]}})),ee.get("/bi/purchase-report").catch(()=>({data:{items:[]}})),ee.get("/bi/inventory-report").catch(()=>({data:{items:[]}}))]).then(([I,G,Y,J])=>{var k,D,Q;if(z)return;const T=I.data||{};h(T.summary||null),f(Array.isArray((k=G.data)==null?void 0:k.items)?G.data.items:[]),v(Array.isArray((D=Y.data)==null?void 0:D.items)?Y.data.items:[]),y(Array.isArray((Q=J.data)==null?void 0:Q.items)?J.data.items:[])}).finally(()=>{z||o(!1)}),()=>{z=!0}},[i]);function j(z,I){d(G=>({...G,[z]:I}))}async function N(z){z.preventDefault(),o(!0);try{t("/business-intelligence/dashboards")}finally{o(!1)}}function S(z){return`${Number(z||0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}function B({data:z}){const I=Math.max(1,...z.map(G=>Number(G.total||G.count||0)));return e.jsx("div",{className:"flex items-end gap-1 h-24",children:z.slice().reverse().map((G,Y)=>{const J=Number(G.total||G.count||0),T=Math.max(4,Math.round(J/I*96));return e.jsx("div",{className:"w-3 bg-brand-500/70 rounded-t",style:{height:`${T}px`},title:`${G.date||""}  ${S(G.total||0)}  ${G.count||0}`},Y)})})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/business-intelligence/dashboards",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Dashboards"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:i?"Executive Overview":r?"Edit Dashboard":"New Dashboard"})]}),i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Sales (30 days)"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:S(((P=c==null?void 0:c.sales)==null?void 0:P.total)||0)}),e.jsxs("div",{className:"text-xs mt-1",children:[((L=c==null?void 0:c.sales)==null?void 0:L.documents)||0," documents"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Purchases (30 days)"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:S(((U=c==null?void 0:c.purchase)==null?void 0:U.total)||0)}),e.jsxs("div",{className:"text-xs mt-1",children:[((H=c==null?void 0:c.purchase)==null?void 0:H.documents)||0," orders"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Inventory Items"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:Number(((q=c==null?void 0:c.inventory)==null?void 0:q.items)||0).toLocaleString()}),e.jsxs("div",{className:"text-xs mt-1",children:[Number(((V=c==null?void 0:c.inventory)==null?void 0:V.quantity)||0).toLocaleString()," units"]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"text-sm text-slate-500",children:"Active Employees"}),e.jsx("div",{className:"text-2xl font-bold mt-2",children:Number(((M=c==null?void 0:c.hr)==null?void 0:M.employees)||0).toLocaleString()}),e.jsx("div",{className:"text-xs mt-1",children:"HR status"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Sales Trend"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Last 30 days"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(B,{data:A}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Bars show totals by day"})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-slate-50 rounded-t-lg",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold",children:"Purchase Trend"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Last 30 days"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsx(B,{data:g}),e.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Bars show totals by day"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header bg-slate-50 rounded-t-lg",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Low Stock Watchlist"}),e.jsx("div",{className:"text-xs text-slate-500",children:"Least available items"})]}),e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Item Code"}),e.jsx("th",{children:"Name"}),e.jsx("th",{className:"text-right",children:"Qty"}),e.jsx("th",{className:"text-right",children:"Reorder"}),e.jsx("th",{className:"text-right",children:"Max"})]})}),e.jsxs("tbody",{children:[b.map((z,I)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:z.item_code}),e.jsx("td",{children:z.item_name}),e.jsx("td",{className:"text-right",children:Number(z.qty||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(z.reorder_level||0).toLocaleString()}),e.jsx("td",{className:"text-right",children:Number(z.max_stock_level||0).toLocaleString()})]},I)),b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-slate-500 text-sm",children:"No low stock items"})}):null]})]})})]})]}):e.jsx("form",{onSubmit:N,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx("fieldset",{disabled:i,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:u.name,onChange:z=>j("name",z.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:u.active?"1":"0",onChange:z=>j("active",z.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:u.description,onChange:z=>j("description",z.target.value)})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/business-intelligence/dashboards",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:l||i,children:l?"Saving...":"Save"})]})]})})})]})}function YZ(){const t=[{id:1,name:"Sales Summary",module:"Sales",active:!0},{id:2,name:"Voucher Register",module:"Finance",active:!0}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Saved Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Report definitions and schedules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/business-intelligence",className:"btn btn-secondary",children:"Return to Menu"}),e.jsx(Le,{to:"/business-intelligence/reports/new",className:"btn-success",children:"+ New Report"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Module"}),e.jsx("th",{children:"Status"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium",children:s.name}),e.jsx("td",{children:s.module}),e.jsx("td",{children:s.active?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-error",children:"Inactive"})}),e.jsxs("td",{children:[e.jsx(Le,{to:`/business-intelligence/reports/${s.id}?mode=view`,className:"text-brand hover:text-brand-600 text-sm font-medium",children:"View"}),e.jsx(Le,{to:`/business-intelligence/reports/${s.id}?mode=edit`,className:"text-blue-600 hover:text-blue-700 text-sm font-medium ml-2",children:"Edit"})]})]},s.id))})]})})})]})}function MS(){const t=ys(),{id:s}=Ls(),r=!!s,[a,n]=x.useState(!1),[i,l]=x.useState({name:"",module:"Sales",query:"",active:!0});x.useEffect(()=>{r&&(n(!0),setTimeout(()=>{l({name:"Sales Summary",module:"Sales",query:"SELECT ...",active:!0}),n(!1)},150))},[r]);function o(d,c){l(h=>({...h,[d]:c}))}async function u(d){d.preventDefault(),n(!0);try{t("/business-intelligence/reports")}finally{n(!1)}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/business-intelligence/reports",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Reports"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:r?"Edit Report":"New Report"})]}),e.jsx("form",{onSubmit:u,children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Name *"}),e.jsx("input",{className:"input",value:i.name,onChange:d=>o("name",d.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Module"}),e.jsxs("select",{className:"input",value:i.module,onChange:d=>o("module",d.target.value),children:[e.jsx("option",{value:"Sales",children:"Sales"}),e.jsx("option",{value:"Finance",children:"Finance"}),e.jsx("option",{value:"Inventory",children:"Inventory"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Query/Definition"}),e.jsx("input",{className:"input",value:i.query,onChange:d=>o("query",d.target.value),placeholder:"Placeholder"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Status"}),e.jsxs("select",{className:"input",value:i.active?"1":"0",onChange:d=>o("active",d.target.value==="1"),children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"0",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Le,{to:"/business-intelligence/reports",className:"btn-success",children:"Cancel"}),e.jsx("button",{className:"btn-success",disabled:a,children:a?"Saving...":"Save"})]})]})})})]})}function XZ(){const t=[{title:"Executive Dashboard",description:"KPIs across ERP modules (placeholder)"},{title:"Trend Analysis",description:"Time series trends (placeholder)"},{title:"Operational KPIs",description:"Daily operational performance (placeholder)"}];return e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-header bg-brand text-white rounded-t-lg",children:[e.jsx("h1",{className:"text-2xl font-bold dark:text-brand-300",children:"Business Intelligence Reports"}),e.jsx("p",{className:"text-sm mt-1",children:"Dashboards and analytics"})]})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map((s,r)=>e.jsxs("div",{className:"p-4 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800",children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-slate-100",children:s.title}),e.jsx("div",{className:"text-sm mt-1",children:s.description})]},r))})})})]})}function JZ(){const[t,s]=Ts.useState([{icon:"",value:"15",label:"Active Dashboards",change:"2 created this week",changeType:"positive",path:"/business-intelligence/dashboards"},{icon:"",value:"8",label:"Scheduled Reports",change:"Running daily",changeType:"neutral",path:"/business-intelligence/reports"},{icon:"",value:"Connected",label:"Data Sources",change:"All systems online",changeType:"positive",path:"/business-intelligence/bi-reports"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.bi)==null?void 0:o.active_dashboards)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.bi)==null?void 0:c.scheduled_reports)||0),y=String(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.bi)==null?void 0:f.data_sources_status)||"").trim();a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:y||N[2].value},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Dashboards",features:[{name:"Dashboard List",path:"/business-intelligence/dashboards",description:"Manage KPI dashboards",icon:""},{name:"New Dashboard",path:"/business-intelligence/dashboards/new",description:"Create a new dashboard",icon:""}]},{title:"Reports",features:[{name:"Saved Reports",path:"/business-intelligence/reports",description:"Report definitions and schedules",icon:""},{name:"New Report",path:"/business-intelligence/reports/new",description:"Create a new report definition",icon:""},{name:"BI Reports",path:"/business-intelligence/bi-reports",description:"Quick report shortcuts",icon:""}]}];return e.jsx(Gl,{title:"Business Intelligence",description:"Analytics, reporting, and data insights",stats:t,sections:r})}function ZZ(){return e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(JZ,{})}),e.jsx(Je,{path:"/dashboards",element:e.jsx(zZ,{})}),e.jsx(Je,{path:"/dashboards/new",element:e.jsx(QS,{})}),e.jsx(Je,{path:"/dashboards/:id",element:e.jsx(QS,{})}),e.jsx(Je,{path:"/reports",element:e.jsx(YZ,{})}),e.jsx(Je,{path:"/reports/new",element:e.jsx(MS,{})}),e.jsx(Je,{path:"/reports/:id",element:e.jsx(MS,{})}),e.jsx(Je,{path:"/bi-reports",element:e.jsx(XZ,{})})]})}function gb({number:t,title:s}){return e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-100 text-brand-700 flex items-center justify-center font-semibold",children:t}),e.jsx("div",{className:"text-lg font-semibold text-slate-900 dark:text-slate-100",children:s})]})}function HS(){const[t,s]=x.useState({firstName:"",lastName:"",email:"",phone:"",company:"",address:"",city:"",state:"",zipCode:"",serviceType:"",department:"",requestTitle:"",description:"",urgency:"normal",preferredDate:"",preferredTime:"",contactMethod:"email",recurring:"no",additionalNotes:"",terms:!1}),[r,a]=x.useState([]),[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState({id:null,request_no:""}),[c,h]=x.useState(!1),A=x.useMemo(()=>["firstName","lastName","email","phone","serviceType","requestTitle","description","urgency","terms"],[]),f=x.useMemo(()=>{let B=0;for(const P of A){const L=t[P];P==="terms"?L===!0&&B++:typeof L=="string"&&L.trim()!==""&&B++}return Math.round(B/A.length*100)},[t,A]);function g(B,P){s(L=>({...L,[B]:P}))}function v(B){const P=Array.from(B.target.files||[]);b(P),B.target.value=""}function b(B){const P=[...r];for(const L of B){if(L.size>10*1024*1024){alert(`File ${L.name} is too large. Max size is 10MB.`);continue}P.push(L)}a(P)}function y(B){a(P=>P.filter(L=>L.name!==B))}function j(){const P=Date.now().toString().slice(-6),L=Math.floor(Math.random()*1e3).toString().padStart(3,"0");return`SR-${P}-${L}`}function N(){s({firstName:"",lastName:"",email:"",phone:"",company:"",address:"",city:"",state:"",zipCode:"",serviceType:"",department:"",requestTitle:"",description:"",urgency:"normal",preferredDate:"",preferredTime:"",contactMethod:"email",recurring:"no",additionalNotes:"",terms:!1}),a([])}function S(B){if(B.preventDefault(),A.filter(z=>{const I=t[z];return z==="terms"?!I:!String(I||"").trim()}).length){alert("Please complete all required fields.");return}if(c)return;h(!0);const L=`${String(t.firstName||"").trim()} ${String(t.lastName||"").trim()}`.trim(),H=[String(t.address||"").trim(),String(t.city||"").trim(),String(t.state||"").trim(),String(t.zipCode||"").trim()].filter(Boolean).join(", "),V={normal:"low",urgent:"medium",emergency:"high"}[String(t.urgency||"normal")]||"low",M={full_name:L,email:t.email,phone:t.phone,company:t.company||null,address:H||null,service_type:t.serviceType,department:t.department||null,request_title:t.requestTitle,description:t.description,priority:V,preferred_date:t.preferredDate||null,preferred_time:t.preferredTime||null,contact_method:t.contactMethod||"email",recurring:t.recurring||"no",additional_notes:t.additionalNotes||null,agreed_terms:t.terms?1:0,attachments:r.map(z=>({name:z.name,size:z.size,type:z.type}))};ee.post("/purchase/service-requests",M).then(z=>{var Y,J;const I=((Y=z==null?void 0:z.data)==null?void 0:Y.id)||null,G=((J=z==null?void 0:z.data)==null?void 0:J.request_no)||"";d({id:I,request_no:G}),o(!0)}).catch(z=>{var I,G;alert(((G=(I=z==null?void 0:z.response)==null?void 0:I.data)==null?void 0:G.message)||"Failed to submit request. Please try again.")}).finally(()=>{h(!1)})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Le,{to:"/service-management",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Service Management"}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-slate-100 mt-2",children:"Service Request"}),e.jsx("p",{className:"text-sm mt-1",children:"Submit your service request and we will get back to you shortly"})]}),e.jsxs("div",{className:"w-64",children:[e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-brand-600 transition-all",style:{width:`${f}%`}})}),e.jsxs("div",{className:"text-xs mt-1 text-right",children:[f,"%"]})]})]}),e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-4",children:[e.jsx(gb,{number:"1",title:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["First Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:t.firstName,onChange:B=>g("firstName",B.target.value),placeholder:"John"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Last Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:t.lastName,onChange:B=>g("lastName",B.target.value),placeholder:"Doe"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"email",value:t.email,onChange:B=>g("email",B.target.value),placeholder:"john.doe@example.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Phone ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:t.phone,onChange:B=>g("phone",B.target.value),placeholder:"+233 ..."})]})]}),e.jsx(gb,{number:"2",title:"Company & Address"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company"}),e.jsx("input",{className:"input",value:t.company,onChange:B=>g("company",B.target.value),placeholder:"Company Ltd."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Street Address"}),e.jsx("input",{className:"input",value:t.address,onChange:B=>g("address",B.target.value),placeholder:"123 Main Street"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"City"}),e.jsx("input",{className:"input",value:t.city,onChange:B=>g("city",B.target.value),placeholder:"Accra"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"State"}),e.jsx("input",{className:"input",value:t.state,onChange:B=>g("state",B.target.value),placeholder:"Greater Accra"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Zip Code"}),e.jsx("input",{className:"input",value:t.zipCode,onChange:B=>g("zipCode",B.target.value),placeholder:"00000"})]})]}),e.jsx(gb,{number:"3",title:"Service Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Service Type ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{className:"input",value:t.serviceType,onChange:B=>g("serviceType",B.target.value),children:[e.jsx("option",{value:"",children:"Select service"}),e.jsx("option",{value:"installation",children:"Installation"}),e.jsx("option",{value:"maintenance",children:"Maintenance"}),e.jsx("option",{value:"repair",children:"Repair"}),e.jsx("option",{value:"consultation",children:"Consultation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Department"}),e.jsx("input",{className:"input",value:t.department,onChange:B=>g("department",B.target.value),placeholder:"IT / Facilities / Operations"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"label",children:["Request Title ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:t.requestTitle,onChange:B=>g("requestTitle",B.target.value),placeholder:"Brief title of the request"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"label",children:["Description ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{className:"input",value:t.description,onChange:B=>g("description",B.target.value),rows:4,placeholder:"Detailed description of the issue or service needed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Urgency"}),e.jsxs("select",{className:"input",value:t.urgency,onChange:B=>g("urgency",B.target.value),children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"urgent",children:"Urgent"}),e.jsx("option",{value:"emergency",children:"Emergency"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Preferred Date"}),e.jsx("input",{className:"input",type:"date",value:t.preferredDate,onChange:B=>g("preferredDate",B.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Preferred Time"}),e.jsx("input",{className:"input",type:"time",value:t.preferredTime,onChange:B=>g("preferredTime",B.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Preferred Contact Method"}),e.jsxs("select",{className:"input",value:t.contactMethod,onChange:B=>g("contactMethod",B.target.value),children:[e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"phone",children:"Phone"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Recurring Service"}),e.jsxs("select",{className:"input",value:t.recurring,onChange:B=>g("recurring",B.target.value),children:[e.jsx("option",{value:"no",children:"No"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"label",children:"Additional Notes"}),e.jsx("textarea",{className:"input",value:t.additionalNotes,onChange:B=>g("additionalNotes",B.target.value),rows:3,placeholder:"Any additional information"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:t.terms,onChange:B=>g("terms",B.target.checked)}),"I agree to the terms and conditions"]})})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold",children:"Attachments (optional)"}),e.jsxs("div",{className:"text-xs text-slate-200",children:["Ref: ",u.request_no||j()]})]})}),e.jsxs("div",{className:"card-body space-y-3",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition "+(n?"border-brand-400 bg-brand-50":"border-slate-300"),onDragOver:B=>{B.preventDefault(),i(!0)},onDragLeave:B=>{B.preventDefault(),i(!1)},onDrop:B=>{B.preventDefault(),i(!1);const P=Array.from(B.dataTransfer.files||[]);b(P)},children:[e.jsx("div",{className:"text-sm",children:"Drag & drop files here or click to upload"}),e.jsx("div",{className:"mt-3",children:e.jsx("input",{type:"file",multiple:!0,onChange:v})})]}),r.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Selected Files"}),e.jsx("div",{className:"space-y-2",children:r.map(B=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded border border-slate-200",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:B.name}),e.jsxs("div",{className:"text-xs text-slate-500",children:[(B.size/1024).toFixed(1)," KB "," ",B.type||"unknown"]})]}),e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>y(B.name),children:"Remove"})]},B.name))})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>N(),children:"Reset"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:c,children:"Submit Request"})]})]}),l&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/40 z-50",children:e.jsxs("div",{className:"card w-full max-w-md",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Request Submitted"})}),e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-sm",children:"Thank you. Your service request has been submitted successfully."}),e.jsxs("div",{className:"text-sm",children:["Reference No: ",u.request_no||"(pending)"]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>o(!1),children:"Close"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>{o(!1),N()},children:"New Request"})]})]})]})})]})}function qS({html:t}){return e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",dangerouslySetInnerHTML:{__html:t}})})}function eee(){const[t,s]=x.useState("internal"),[r,a]=x.useState(!1),[n,i]=x.useState(""),[l,o]=x.useState(""),[u,d]=x.useState({custId:"",accEmail:""}),[c,h]=x.useState({fname:"",lname:"",email:"",phone:""}),[A,f]=x.useState({servCat:"",items:[]}),[g,v]=x.useState({addr:"",date:"",time:""}),[b,y]=x.useState(""),[j,N]=x.useState({dept:"",cost:""}),[S,B]=x.useState({name:"",title:"",email:"",phone:""}),[P,L]=x.useState({name:"",id:"",email:"",phone:""}),[U,H]=x.useState({cat:"",scope:""}),[q,V]=x.useState({loc:"",start:"",end:""}),[M,z]=x.useState({estCost:"",currency:"USD"});function I(){return`ORD-${Date.now().toString().slice(-8)}`}function G(){f(E=>({...E,items:[...E.items,{id:crypto.randomUUID(),desc:"",qty:1,price:0,sub:0}]}))}function Y(E,w,O){f(R=>{const X=R.items.map(ne=>{if(ne.id===E){const te={...ne,[w]:O},oe=parseFloat(te.qty||0),ce=parseFloat(te.price||0);return te.sub=oe*ce,te}return ne});return{...R,items:X}})}function J(E){f(w=>({...w,items:w.items.filter(O=>O.id!==E)}))}const T=x.useMemo(()=>{let E=0,w='<div class="sum-item"><strong>Services</strong></div>';for(const O of A.items){const R=String(O.desc||"Service"),X=parseFloat(O.qty||0),ne=parseFloat(O.price||0),te=X*ne;te>0&&(w+=`<div class="sum-item"><span>${R} (x${X})</span><span>$${te.toFixed(2)}</span></div>`),E+=te}if(l==="existing"){const O=E*.1;w+=`<div class="sum-item"><span>Discount (10%)</span><span style="color:#27ae60">-$${O.toFixed(2)}</span></div>`,E-=O}return E>0?w+=`<div class="sum-total"><span>Total</span><span>$${E.toFixed(2)}</span></div>`:w='<p style="text-align:center;color:#7f8c8d;padding:20px">Add services to see summary</p>',w},[A.items,l]);function k(){o(""),d({custId:"",accEmail:""}),h({fname:"",lname:"",email:"",phone:""}),f({servCat:"",items:[]}),v({addr:"",date:"",time:""}),y("")}function D(){N({dept:"",cost:""}),B({name:"",title:"",email:"",phone:""}),L({name:"",id:"",email:"",phone:""}),H({cat:"",scope:""}),V({loc:"",start:"",end:""}),z({estCost:"",currency:"USD"})}function Q(E){E.preventDefault();const w=I();i(w),a(!0)}function C(E){E.preventDefault();const w=I();i(w),a(!0)}return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/service-management",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Service Management"}),e.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Service Order Management"}),e.jsx("p",{className:"text-sm mt-1",children:"Comprehensive order system for internal services and external contractors"})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold dark:text-brand-300",children:"Service Orders"}),e.jsx("p",{className:"text-sm mt-1",children:"Internal services and external contractor orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:t==="internal"?"btn-primary":"btn-secondary",onClick:()=>s("internal"),children:"Internal Order"}),e.jsx("button",{type:"button",className:t==="external"?"btn-primary":"btn-secondary",onClick:()=>s("external"),children:"External Order"})]})]})}),e.jsxs("div",{className:"card-body",children:[t==="internal"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs("form",{onSubmit:Q,children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Customer Information"}),e.jsx("p",{children:"Select customer type and provide details"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Customer Type ",e.jsx("span",{className:"req",children:"*"})]}),e.jsxs("div",{style:{display:"flex",gap:15,marginBottom:12},children:[e.jsxs("div",{className:`btn-group ${l==="existing"?"active":""}`,onClick:()=>o("existing"),children:[e.jsx("h4",{children:"Existing Customer"}),e.jsx("p",{children:"10% loyalty discount"})]}),e.jsxs("div",{className:`btn-group ${l==="general"?"active":""}`,onClick:()=>o("general"),children:[e.jsx("h4",{children:"General Public"}),e.jsx("p",{children:"Standard pricing"})]})]})]}),l==="existing"&&e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Customer ID ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:u.custId,onChange:E=>d(w=>({...w,custId:E.target.value})),placeholder:"CUST-12345"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Account Email ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"email",value:u.accEmail,onChange:E=>d(w=>({...w,accEmail:E.target.value})),placeholder:"account@example.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["First Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:c.fname,onChange:E=>h(w=>({...w,fname:E.target.value})),placeholder:"John"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Last Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:c.lname,onChange:E=>h(w=>({...w,lname:E.target.value})),placeholder:"Doe"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Email ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"email",value:c.email,onChange:E=>h(w=>({...w,email:E.target.value})),placeholder:"customer@example.com"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Phone ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:c.phone,onChange:E=>h(w=>({...w,phone:E.target.value})),placeholder:"+1 (555) 123-4567"})]})]}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Service Selection"}),e.jsx("p",{children:"Choose service category and add items"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Service Category ",e.jsx("span",{className:"req",children:"*"})]}),e.jsxs("select",{className:"input",value:A.servCat,onChange:E=>f(w=>({...w,servCat:E.target.value})),children:[e.jsx("option",{value:"",children:"-- Select Category --"}),e.jsx("option",{value:"consulting",children:"Consulting & Advisory"}),e.jsx("option",{value:"installation",children:"Installation & Setup"}),e.jsx("option",{value:"maintenance",children:"Maintenance & Support"}),e.jsx("option",{value:"repair",children:"Repair & Troubleshooting"}),e.jsx("option",{value:"training",children:"Training & Education"}),e.jsx("option",{value:"custom",children:"Custom/Specialized"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h4",{style:{color:"var(--primary)",marginBottom:10},children:" Service Items"}),e.jsx("div",{children:A.items.map(E=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 100px 120px 40px",gap:12,marginBottom:10,padding:10,background:"var(--white)",border:"2px solid var(--border)",borderRadius:6},children:[e.jsx("input",{className:"input",value:E.desc,onChange:w=>Y(E.id,"desc",w.target.value),placeholder:"Service description"}),e.jsx("input",{className:"input",type:"number",min:"1",value:E.qty,onChange:w=>Y(E.id,"qty",w.target.value)}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:E.price,onChange:w=>Y(E.id,"price",w.target.value),placeholder:"0.00"}),e.jsx("input",{className:"input",readOnly:!0,value:(parseFloat(E.qty||0)*parseFloat(E.price||0)).toFixed(2)}),e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>J(E.id),children:""})]},E.id))}),e.jsx("button",{type:"button",className:"btn-primary mt-2",onClick:G,children:"+ Add Service Item"})]})}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Location & Schedule"}),e.jsx("p",{children:"Where and when should service be performed?"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Service Address ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("textarea",{className:"input",value:g.addr,onChange:E=>v(w=>({...w,addr:E.target.value})),placeholder:"Complete address"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Service Date ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"date",value:g.date,onChange:E=>v(w=>({...w,date:E.target.value}))})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Time Slot ",e.jsx("span",{className:"req",children:"*"})]}),e.jsxs("select",{className:"input",value:g.time,onChange:E=>v(w=>({...w,time:E.target.value})),children:[e.jsx("option",{value:"",children:"-- Select Time --"}),e.jsx("option",{value:"08-10",children:"8:00 AM - 10:00 AM"}),e.jsx("option",{value:"10-12",children:"10:00 AM - 12:00 PM"}),e.jsx("option",{value:"12-14",children:"12:00 PM - 2:00 PM"}),e.jsx("option",{value:"14-16",children:"2:00 PM - 4:00 PM"}),e.jsx("option",{value:"16-18",children:"4:00 PM - 6:00 PM"})]})]})]}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Payment"}),e.jsx("p",{children:"Select payment method"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Payment Method ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:["card","bank","cash","invoice"].map(E=>e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"radio",name:"pay",value:E,checked:b===E,onChange:()=>y(E)}),E[0].toUpperCase()+E.slice(1)]},E))})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:k,children:"Clear"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Submit Order"})]})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Order Summary"}),e.jsx(qS,{html:T})]})]}),t==="external"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Requesting Department"}),e.jsx("p",{children:"Which department needs this service?"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Department ",e.jsx("span",{className:"req",children:"*"})]}),e.jsxs("select",{className:"input",value:j.dept,onChange:E=>N(w=>({...w,dept:E.target.value})),children:[e.jsx("option",{value:"",children:"-- Select Department --"}),e.jsx("option",{value:"operations",children:"Operations"}),e.jsx("option",{value:"it",children:"IT"}),e.jsx("option",{value:"facilities",children:"Facilities"}),e.jsx("option",{value:"hr",children:"HR"}),e.jsx("option",{value:"finance",children:"Finance"})]})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Cost Center ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:j.cost,onChange:E=>N(w=>({...w,cost:E.target.value})),placeholder:"CC-12345"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Requestor Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:S.name,onChange:E=>B(w=>({...w,name:E.target.value})),placeholder:"Full name"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Job Title ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:S.title,onChange:E=>B(w=>({...w,title:E.target.value})),placeholder:"Position"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Email ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"email",value:S.email,onChange:E=>B(w=>({...w,email:E.target.value})),placeholder:"requestor@company.com"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Phone ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:S.phone,onChange:E=>B(w=>({...w,phone:E.target.value})),placeholder:"+1 (555) 123-4567"})]})]}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Contractor Information"}),e.jsx("p",{children:"Select or add contractor details"})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Contractor Name ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:P.name,onChange:E=>L(w=>({...w,name:E.target.value})),placeholder:"Company name"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Contractor ID"," ",e.jsx("span",{className:"text-slate-500",children:"(Optional)"})]}),e.jsx("input",{className:"input",value:P.id,onChange:E=>L(w=>({...w,id:E.target.value})),placeholder:"CONT-12345"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Contractor Email ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"email",value:P.email,onChange:E=>L(w=>({...w,email:E.target.value})),placeholder:"contractor@company.com"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Contractor Phone ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",value:P.phone,onChange:E=>L(w=>({...w,phone:E.target.value})),placeholder:"+1 (555) 987-6543"})]})]}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Service Requirements"}),e.jsx("p",{children:"Describe services needed from contractor"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Service Category ",e.jsx("span",{className:"req",children:"*"})]}),e.jsxs("select",{className:"input",value:U.cat,onChange:E=>H(w=>({...w,cat:E.target.value})),children:[e.jsx("option",{value:"",children:"-- Select Category --"}),e.jsx("option",{value:"construction",children:"Construction & Renovation"}),e.jsx("option",{value:"electrical",children:"Electrical Services"}),e.jsx("option",{value:"plumbing",children:"Plumbing Services"}),e.jsx("option",{value:"hvac",children:"HVAC Services"}),e.jsx("option",{value:"it",children:"IT & Technology"}),e.jsx("option",{value:"cleaning",children:"Cleaning & Janitorial"})]})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Scope of Work ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("textarea",{className:"input",value:U.scope,onChange:E=>H(w=>({...w,scope:E.target.value})),placeholder:"Detailed description of work to be performed"})]}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Location & Timeline"}),e.jsx("p",{children:"Where and when should work be performed?"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Work Location ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("textarea",{className:"input",value:q.loc,onChange:E=>V(w=>({...w,loc:E.target.value})),placeholder:"Facility address"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Start Date ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"date",value:q.start,onChange:E=>V(w=>({...w,start:E.target.value}))})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["End Date ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"date",value:q.end,onChange:E=>V(w=>({...w,end:E.target.value}))})]})]}),e.jsxs("div",{className:"section-header",children:[e.jsx("h3",{children:" Budget Information"}),e.jsx("p",{children:"Estimated costs and payment terms"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Estimated Cost ",e.jsx("span",{className:"req",children:"*"})]}),e.jsx("input",{className:"input",type:"number",step:"0.01",min:"0",value:M.estCost,onChange:E=>z(w=>({...w,estCost:E.target.value})),placeholder:"0.00"})]}),e.jsxs("div",{className:"group",children:[e.jsxs("label",{children:["Currency ",e.jsx("span",{className:"req",children:"*"})]}),e.jsxs("select",{className:"input",value:M.currency,onChange:E=>z(w=>({...w,currency:E.target.value})),children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:D,children:"Clear"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Submit Order"})]})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Order Summary"}),e.jsx(qS,{html:'<p style="text-align:center;color:#7f8c8d;padding:20px">Fill in details to see summary</p>'})]})]})]})]}),r&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/40 z-50",children:e.jsxs("div",{className:"card w-full max-w-md",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Order Submitted"})}),e.jsxs("div",{className:"card-body space-y-3 text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:""}),e.jsx("div",{className:"text-sm",children:"Your order has been received and is being processed."}),e.jsxs("div",{className:"order-num",children:["Order #: ",n]}),e.jsx("div",{className:"flex justify-center gap-2",children:e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>a(!1),children:"Done"})})]})]})})]})}const tee=[{id:"ORD-20240001",orderNumber:"ORD-20240001",customer:"John Smith",serviceType:"HVAC Maintenance",location:"123 Main St, Downtown",scheduledDate:"2024-02-15",status:"Pending Execution",priority:"Medium",estimatedCost:450},{id:"ORD-20240002",orderNumber:"ORD-20240002",customer:"ABC Corporation",serviceType:"Electrical Installation",location:"456 Business Park, Suite 200",scheduledDate:"2024-02-16",status:"Pending Execution",priority:"High",estimatedCost:1250},{id:"ORD-20240003",orderNumber:"ORD-20240003",customer:"Sarah Johnson",serviceType:"Plumbing Repair",location:"789 Residential Ave, Apt 5B",scheduledDate:"2024-02-14",status:"Pending Execution",priority:"Urgent",estimatedCost:325},{id:"ORD-20240004",orderNumber:"ORD-20240004",customer:"Tech Solutions Inc",serviceType:"Network Installation",location:"321 Tech Plaza, Floor 3",scheduledDate:"2024-02-17",status:"Pending Execution",priority:"High",estimatedCost:2100}],see=[{id:"TECH-001",name:"David Rodriguez",role:"Senior Technician - Electrical"},{id:"TECH-002",name:"Lisa Anderson",role:"Technician - HVAC"},{id:"TECH-003",name:"Robert Kim",role:"Junior Technician - Plumbing"},{id:"TECH-004",name:"Amanda White",role:"Specialist - Installation"}];function ree(){const[t,s]=x.useState(1),[r,a]=x.useState(""),[n,i]=x.useState(null),[l,o]=x.useState(""),[u,d]=x.useState(""),[c,h]=x.useState(""),[A,f]=x.useState([]),[g,v]=x.useState(""),[b,y]=x.useState(new Set),[j,N]=x.useState(""),[S,B]=x.useState(""),[P,L]=x.useState(""),[U,H]=x.useState([]),[q,V]=x.useState({qc1:!1,qc2:!1,qc3:!1,qc4:!1,qc5:!1,qc6:!1}),[M,z]=x.useState(""),I=x.useMemo(()=>{try{const[ue,ge]=(j||"00:00").split(":").map(Fe=>Number(Fe||0)),[Ve,tt]=(M||"00:00").split(":").map(Fe=>Number(Fe||0)),Ze=ue+ge/60,ze=Ve+tt/60-Ze;return ze>0?ze.toFixed(2):""}catch{return""}},[j,M]),[G,Y]=x.useState(""),[J,T]=x.useState(""),[k,D]=x.useState(""),[Q,C]=x.useState(""),[E,w]=x.useState(""),[O,R]=x.useState(!1),[X,ne]=x.useState(""),[te,oe]=x.useState(""),[ce,re]=x.useState([]),[de,Ie]=x.useState(!1),[le,Z]=x.useState(!1),[ve,Ue]=x.useState(""),Be=x.useMemo(()=>{const ue=r.toLowerCase();return tee.filter(ge=>ge.orderNumber.toLowerCase().includes(ue)||ge.customer.toLowerCase().includes(ue)||ge.serviceType.toLowerCase().includes(ue))},[r]);function _e(ue){s(ue)}function Me(ue){s(ue)}function Ye(){f(ue=>[...ue,{id:crypto.randomUUID(),code:"",name:"",qty:1,unit:"",note:""}])}function ot(ue,ge,Ve){f(tt=>tt.map(Ze=>Ze.id===ue?{...Ze,[ge]:Ve}:Ze))}function Ke(ue){f(ge=>ge.filter(Ve=>Ve.id!==ue))}function ct(ue){y(ge=>{const Ve=new Set(Array.from(ge));return Ve.has(ue)?Ve.delete(ue):Ve.add(ue),Ve})}function xt(ue){return ge=>{const Ve=Array.from(ge.target.files||[]);ue(tt=>[...tt,...Ve]),ge.target.value=""}}function be(ue){return Number(ue||0).toLocaleString("en-US",{minimumFractionDigits:2})}function Ce(ue){ue.preventDefault();const ge=`EXEC-${Date.now().toString().slice(-8)}`;Ue(ge),Z(!0)}const Te=x.useMemo(()=>{if(!n)return'<p style="text-align:center;color:#64748b;padding:20px;">Select a service order to begin</p>';const ue=A.length,ge=Object.values(q).filter(Boolean).length;return`
      <div class="space-y-2">
        <div class="summary-item"><span class="label">Order</span><span class="value">${n.orderNumber}</span></div>
        <div class="summary-item"><span class="label">Customer</span><span class="value">${n.customer}</span></div>
        <div class="summary-item"><span class="label">Type</span><span class="value">${n.serviceType}</span></div>
        <div class="summary-item"><span class="label">Scheduled</span><span class="value">${n.scheduledDate}</span></div>
        <div class="summary-item"><span class="label">Materials</span><span class="value">${ue}</span></div>
        <div class="summary-item"><span class="label">Techs</span><span class="value">${Array.from(b).length}</span></div>
        <div class="summary-item"><span class="label">QC Checks</span><span class="value">${ge} / 6</span></div>
        <div class="summary-item"><span class="label">Est. Cost</span><span class="value">$${be(n.estimatedCost)}</span></div>
        <div class="status-badge ${t<3?"status-pending":t<5?"status-in-progress":"status-completed"}">
          ${t<3?"Pending":t<5?"In Progress":"Completed"}
        </div>
      </div>
    `},[n,A,b,q,t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(Le,{to:"/service-management",className:"text-sm text-brand hover:text-brand-600 dark:text-brand-400 dark:hover:text-brand-300",children:" Back to Service Management"}),e.jsx("h1",{className:"text-2xl font-bold mt-2",children:"Service Execution Management"}),e.jsx("p",{className:"text-sm mt-1",children:"Track and manage service execution from assignment to completion"})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsxs("div",{className:"flex justify-between items-center text-white",children:[e.jsx("div",{className:"font-semibold",children:"Execution Progress"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(ue=>e.jsx("button",{type:"button",className:t===ue?"btn-primary":"btn-secondary",onClick:()=>s(ue),children:ue},ue))})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_380px] gap-6",children:[e.jsx("div",{children:e.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[t===1&&e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:" Service Order Reference"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"label",children:["Search Service Order ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:r,onChange:ue=>a(ue.target.value),placeholder:"Search by order number, customer name, or service type..."}),r.trim()&&e.jsxs("div",{className:"mt-2 border rounded",children:[Be.map(ue=>e.jsxs("div",{className:"p-2 hover:bg-slate-50 cursor-pointer",onClick:()=>{i(ue),a(ue.orderNumber)},children:[e.jsxs("div",{className:"font-medium text-brand-700",children:[ue.orderNumber,"  ",ue.customer]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[ue.serviceType,"  ",ue.location,"  ",ue.scheduledDate]})]},ue.id)),!Be.length&&e.jsx("div",{className:"p-2 text-sm text-slate-500",children:"No matches"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Execution Date ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"date",value:l,onChange:ue=>o(ue.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Scheduled Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"time",value:u,onChange:ue=>d(ue.target.value)})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"label",children:["Assigned Supervisor ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("select",{className:"input",value:c,onChange:ue=>h(ue.target.value),children:[e.jsx("option",{value:"",children:"-- Select Supervisor --"}),e.jsx("option",{value:"SUP-001",children:"John Smith - Senior Supervisor"}),e.jsx("option",{value:"SUP-002",children:"Sarah Johnson - Field Supervisor"}),e.jsx("option",{value:"SUP-003",children:"Michael Chen - Technical Supervisor"}),e.jsx("option",{value:"SUP-004",children:"Emily Brown - Quality Supervisor"})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>_e(2),children:"Next: Material Requisition "})})]})}),t===2&&e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:" Material Requisition from Stores"}),e.jsx("div",{className:"text-sm bg-blue-50 border-l-4 border-blue-400 p-3 rounded",children:"Materials will be checked against store inventory. Unavailable items will be flagged for procurement."}),e.jsxs("div",{className:"space-y-2",children:[A.map(ue=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_120px_120px_40px] gap-2 items-end p-3 bg-slate-50 rounded border",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Description"}),e.jsx("input",{className:"input",value:ue.name,onChange:ge=>ot(ue.id,"name",ge.target.value),placeholder:"Material description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Qty"}),e.jsx("input",{className:"input",type:"number",min:"1",value:ue.qty,onChange:ge=>ot(ue.id,"qty",ge.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Unit"}),e.jsx("input",{className:"input",value:ue.unit,onChange:ge=>ot(ue.id,"unit",ge.target.value),placeholder:"pcs / ft / roll"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Note"}),e.jsx("input",{className:"input",value:ue.note,onChange:ge=>ot(ue.id,"note",ge.target.value),placeholder:"Optional note"})]}),e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>Ke(ue.id),children:""})]},ue.id)),e.jsx("button",{type:"button",className:"btn-primary",onClick:Ye,children:"+ Add Material Item"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Requisition Notes"}),e.jsx("textarea",{className:"input",value:g,onChange:ue=>v(ue.target.value),placeholder:"Any special requirements or notes"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Me(1),children:" Back"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>_e(3),children:"Next: Execution Details "})]})]})}),t===3&&e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:" Service Execution Details"}),e.jsx("div",{className:"space-y-2",children:see.map(ue=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded border",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-brand-700",children:ue.name}),e.jsx("div",{className:"text-xs text-slate-500",children:ue.role})]}),e.jsx("input",{type:"checkbox",checked:b.has(ue.id),onChange:()=>ct(ue.id)})]},ue.id))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Actual Start Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"time",value:j,onChange:ue=>N(ue.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Estimated Duration (hours) ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"number",step:"0.5",min:"0",value:S,onChange:ue=>B(ue.target.value)})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Work Performed Description ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{className:"input",value:P,onChange:ue=>L(ue.target.value),placeholder:"Detailed description of work performed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Service Execution Photos"}),e.jsx("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png",onChange:xt(H)}),U.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:U.map(ue=>e.jsx("div",{className:"flex items-center justify-between p-2 border rounded",children:e.jsxs("div",{className:"text-xs",children:[ue.name,"  ",(ue.size/1024).toFixed(1)," KB"]})},ue.name))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Me(2),children:" Back"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>_e(4),children:"Next: Quality Check "})]})]})}),t===4&&e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:" Quality Check & Verification"}),e.jsx("div",{className:"space-y-2",children:Object.keys(q).map((ue,ge)=>e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm p-2 border rounded",children:[e.jsx("input",{type:"checkbox",checked:q[ue],onChange:Ve=>V(tt=>({...tt,[ue]:Ve.target.checked}))}),["All work completed as per service order specifications","All materials used are documented and accounted for","Work area cleaned and restored to original condition","All safety protocols followed during execution","Equipment/systems tested and functioning properly","No additional issues or defects identified"][ge]]},ue))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Actual End Time ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",type:"time",value:M,onChange:ue=>z(ue.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Total Duration (hours)"}),e.jsx("input",{className:"input",value:I,readOnly:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Quality Check Notes"}),e.jsx("textarea",{className:"input",value:G,onChange:ue=>Y(ue.target.value),placeholder:"Any observations, recommendations, or issues"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Me(3),children:" Back"}),e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>_e(5),children:"Next: Service Closing "})]})]})}),t===5&&e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body space-y-3",children:[e.jsx("div",{className:"text-lg font-semibold",children:" Service Closing"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Customer Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:J,onChange:ue=>T(ue.target.value),placeholder:"Name of person receiving service"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Customer Contact ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{className:"input",value:k,onChange:ue=>D(ue.target.value),placeholder:"Phone or email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Feedback"}),e.jsx("textarea",{className:"input",value:Q,onChange:ue=>C(ue.target.value),placeholder:"Customer comments"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Customer Satisfaction Rating"}),e.jsx("div",{className:"flex flex-wrap gap-3 mt-1",children:[5,4,3,2,1].map(ue=>e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"radio",name:"satisfaction",value:String(ue),checked:E===String(ue),onChange:ge=>w(ge.target.value)}),Array.from({length:ue}).map(()=>"").join("")," ",["Excellent","Good","Average","Poor","Very Poor"][5-ue]]},ue))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:O,onChange:ue=>R(ue.target.checked)}),e.jsx("span",{children:"Follow-up service required"})]}),O&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Follow-up Details"}),e.jsx("textarea",{className:"input",value:X,onChange:ue=>ne(ue.target.value)})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:["Closing Remarks ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("textarea",{className:"input",value:te,onChange:ue=>oe(ue.target.value),placeholder:"Final summary and recommendations"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Completion Certificate/Photos"}),e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png",onChange:xt(re)}),ce.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:ce.map(ue=>e.jsx("div",{className:"flex items-center justify-between p-2 border rounded",children:e.jsxs("div",{className:"text-xs",children:[ue.name,"  ",(ue.size/1024).toFixed(1)," KB"]})},ue.name))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:de,onChange:ue=>Ie(ue.target.checked)}),e.jsx("span",{children:"I confirm that all work has been completed satisfactorily and customer has approved the service"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>Me(4),children:" Back"}),e.jsx("button",{type:"submit",className:"btn-success",disabled:!de,children:"Complete Service Execution"})]})]})})]})}),e.jsx("div",{children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Execution Summary"}),e.jsx("div",{dangerouslySetInnerHTML:{__html:Te}})]})})})]})})]}),le&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/40 z-50",children:e.jsxs("div",{className:"card w-full max-w-md",children:[e.jsx("div",{className:"card-header bg-brand text-white rounded-t-lg",children:e.jsx("div",{className:"font-semibold",children:"Service Execution Completed"})}),e.jsxs("div",{className:"card-body space-y-3 text-center",children:[e.jsx("div",{className:"text-4xl mb-2 text-green-600",children:""}),e.jsx("div",{className:"text-sm",children:"The service has been successfully executed and closed. All documentation has been recorded."}),e.jsxs("div",{className:"font-semibold",children:["Execution Number: ",ve]}),e.jsx("div",{className:"flex justify-center gap-2",children:e.jsx("button",{type:"button",className:"btn-primary",onClick:()=>Z(!1),children:"Done"})})]})]})})]})}function aee(){const[t,s]=Ts.useState([{icon:"",value:"12",label:"Open Requests",change:" 3 new today",changeType:"positive",path:"/service-management/service-requests"},{icon:"",value:"7",label:"Pending Bills",change:" stable",changeType:"neutral",path:"/service-management/service-bills"},{icon:"",value:"19",label:"Confirmed Services",change:" 5 this week",changeType:"positive",path:"/service-management/service-confirmation"}]);Ts.useEffect(()=>{let a=!0;async function n(){var i,l,o,u,d,c,h,A,f;try{const g=await ee.get("/bi/dashboards"),v=Number(((o=(l=(i=g==null?void 0:g.data)==null?void 0:i.summary)==null?void 0:l.services)==null?void 0:o.open_requests)||0),b=Number(((c=(d=(u=g==null?void 0:g.data)==null?void 0:u.summary)==null?void 0:d.services)==null?void 0:c.pending_bills)||0),y=Number(((f=(A=(h=g==null?void 0:g.data)==null?void 0:h.summary)==null?void 0:A.services)==null?void 0:f.confirmed)||0);a&&s(j=>{const N=[...j];return N[0]={...N[0],value:String(v)},N[1]={...N[1],value:String(b)},N[2]={...N[2],value:String(y)},N})}catch{}}return n(),()=>{a=!1}},[]);const r=[{title:"Requests",items:[{title:"Service Requests",description:"Submit and track service requests",path:"/service-management/service-requests",icon:"",actions:[{label:"New Request",path:"/service-management/service-requests/new",type:"primary"}]},{title:"Service Orders",description:"Create internal/external service orders",path:"/service-management/service-orders",icon:"",actions:[{label:"New Order",path:"/service-management/service-orders",type:"primary"}]},{title:"Service Execution",description:"Execute, verify and close service orders",path:"/service-management/service-execution",icon:"",actions:[{label:"Start Execution",path:"/service-management/service-execution",type:"primary"}]},{title:"Service Confirmation",description:"Confirm delivered services from suppliers",path:"/service-management/service-confirmation",icon:"",actions:[{label:"New Confirmation",path:"/service-management/service-confirmation/new",type:"primary"}]},{title:"Service Bills",description:"Prepare and issue service bills",path:"/service-management/service-bills",icon:"",actions:[{label:"New Bill",path:"/service-management/service-bills",type:"primary"}]}]}];return e.jsx(Gl,{title:"Service Management",description:"End-to-end service request, confirmation, and billing",stats:t,sections:r})}function nee(){const{hasModuleAccess:t,hasAccess:s}=ca(),r=()=>e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-center text-slate-600",children:"You do not have permission to view this page."})})})});return t("Service Management")?e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(aee,{})}),e.jsx(Je,{path:"service-requests",element:s("/service-management/service-requests","view")?e.jsx(HS,{}):e.jsx(r,{})}),e.jsx(Je,{path:"service-requests/new",element:s("/service-management/service-requests/new","create")?e.jsx(HS,{}):e.jsx(r,{})}),e.jsx(Je,{path:"service-orders",element:s("/service-management/service-orders","view")?e.jsx(eee,{}):e.jsx(r,{})}),e.jsx(Je,{path:"service-execution",element:s("/service-management/service-execution","view")?e.jsx(ree,{}):e.jsx(r,{})}),e.jsx(Je,{path:"service-confirmation",element:s("/service-management/service-confirmation","view")?e.jsx(qB,{}):e.jsx(r,{})}),e.jsx(Je,{path:"service-confirmation/:id",element:s("/service-management/service-confirmation/:id","edit")?e.jsx(Ty,{}):e.jsx(r,{})}),e.jsx(Je,{path:"service-bills",element:s("/service-management/service-bills","view")?e.jsx(Fy,{}):e.jsx(r,{})})]}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"text-center text-slate-600",children:"You do not have access to the Service Management module."})})})})}function iee(){const[t,s]=x.useState([]),[r,a]=x.useState(!1),n=ys(),i=x.useMemo(()=>t.filter(d=>Number(d.is_read)!==1).length,[t]),l=x.useMemo(()=>t.filter(d=>Number(d.is_read)!==1),[t]);async function o(){var d;a(!0);try{const c=await ee.get("/workflows/notifications");s(Array.isArray((d=c.data)==null?void 0:d.items)?c.data.items:[])}catch{s([])}finally{a(!1)}}x.useEffect(()=>{o()},[]);async function u(d){try{await ee.put(`/workflows/notifications/${d}/read`),s(c=>c.map(h=>h.id===d?{...h,is_read:1}:h))}catch{}}return e.jsxs("div",{className:"max-w-5xl mx-auto p-4 space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 dark:text-white",children:"Notifications"}),e.jsxs("p",{className:"text-slate-500 mt-1",children:[i," unread  ",t.length," total"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{to:"/",className:"btn btn-secondary",children:"Home"}),e.jsx("button",{className:"btn btn-outline",onClick:o,disabled:r,children:"Refresh"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-4",children:"Loading..."})}):l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center py-8 text-slate-500",children:"No notifications"})}):l.map(d=>e.jsxs("tr",{className:"hover",children:[e.jsx("td",{className:"font-medium",children:d.title}),e.jsx("td",{children:d.message}),e.jsx("td",{children:d.created_at?new Date(d.created_at).toLocaleString():"-"}),e.jsx("td",{children:Number(d.is_read)===1?e.jsx("span",{className:"badge bg-green-100 text-green-800 border-green-300 dark:bg-green-900 dark:text-green-200 dark:border-green-800",children:"Read"}):e.jsx("span",{className:"badge bg-yellow-100 text-yellow-800 border-yellow-300 dark:bg-yellow-900 dark:text-yellow-200 dark:border-yellow-800",children:"Unread"})}),e.jsx("td",{children:e.jsxs("div",{className:"flex gap-2",children:[d.link?e.jsx("button",{className:"btn btn-ghost btn-xs text-blue-600",onClick:()=>n(d.link),title:"Open",children:"Open"}):null,Number(d.is_read)!==1?e.jsx("button",{className:"btn btn-ghost btn-xs text-slate-600",onClick:()=>u(d.id),title:"Mark Read",children:"Mark Read"}):null]})})]},d.id))})]})})})]})}const lee="/assets/OMNISUITE_WHITE_LOGO-C3pcEyUY.png";function oee(){const[t,s]=x.useState(()=>TC()),[r,a]=x.useState(null);x.useEffect(()=>{const u=FT(({event:d,snapshot:c})=>{s(c),a(d)});return()=>u()},[]);const n=x.useMemo(()=>t.pending||0,[t.pending]),i=x.useMemo(()=>t.failed||0,[t.failed]),l=x.useMemo(()=>t.completed||0,[t.completed]),o=x.useMemo(()=>t.items||[],[t.items]);return{lastEvent:r,pending:n,failed:i,completed:l,items:o}}function cee(){const[t,s]=x.useState(null),[r,a]=x.useState(!1),[n,i]=x.useState(!1);x.useEffect(()=>{i("serviceWorker"in navigator);function d(f){s(f)}function c(){a(!0),s(null)}window.addEventListener("beforeinstallprompt",d),window.addEventListener("appinstalled",c);const h=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches,A=navigator.standalone===!0;return(h||A)&&a(!0),()=>{window.removeEventListener("beforeinstallprompt",d),window.removeEventListener("appinstalled",c)}},[]);const l=x.useMemo(()=>!!t,[t]);async function o(){var c;if(!t)return!1;const d=await((c=t.prompt)==null?void 0:c.call(t));return s(null),d}function u(){s(null)}return{isInstallable:l,isInstalled:r,isPWASupported:n,handleInstall:o,dismissPrompt:u}}function dee(){const{isInstallable:t,isInstalled:s,isPWASupported:r,handleInstall:a}=cee(),[n,i]=x.useState(!1),[l,o]=x.useState(!1),[u,d]=x.useState(typeof window<"u"?window.innerWidth:1920);return x.useEffect(()=>{function c(){d(window.innerWidth)}return window.addEventListener("resize",c),()=>window.removeEventListener("resize",c)},[]),x.useEffect(()=>{const c=r&&!s&&(t||/Mobile|Android|iPad|iPhone/.test(navigator.userAgent))&&u<=1024;o(c)},[t,s,r,u]),l?e.jsxs("div",{className:"fixed bottom-4 right-4 z-[60] flex flex-col items-end gap-2",children:[n&&e.jsxs("div",{className:"card p-3 shadow-erp-lg bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700",children:[e.jsx("div",{className:"text-sm font-semibold",children:"Install"}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:/iPad|iPhone|iPod/.test(navigator.userAgent)?"Tap Share  Add to Home Screen":"Tap menu  Install / Add to Home Screen"}),e.jsx("div",{className:"mt-2 flex justify-end",children:e.jsx("button",{type:"button",className:"btn-secondary px-2 py-1",onClick:()=>i(!1),children:"Close"})})]}),e.jsx("button",{type:"button",className:"btn-primary rounded-full w-12 h-12 shadow-erp-lg flex items-center justify-center","aria-label":"Install app",onClick:async()=>{t?await a()||i(!0):(i(!0),setTimeout(()=>i(!1),4e3))},title:"Install OmniSuite",children:e.jsx(Yc,{className:"w-5 h-5"})})]}):null}const VS=[{key:"administration",label:"Administration",path:"/administration",icon:""},{key:"sales",label:"Sales",path:"/sales",icon:""},{key:"inventory",label:"Inventory",path:"/inventory",icon:""},{key:"purchase",label:"Purchase",path:"/purchase",icon:""},{key:"finance",label:"Finance",path:"/finance",icon:""},{key:"human-resources",label:"Human Resources",path:"/human-resources",icon:""},{key:"maintenance",label:"Maintenance",path:"/maintenance",icon:""},{key:"project-management",label:"Project Management",path:"/project-management",icon:""},{key:"production",label:"Production",path:"/production",icon:""},{key:"pos",label:"POS",path:"/pos",icon:""},{key:"business-intelligence",label:"Business Intelligence",path:"/business-intelligence",icon:""},{key:"service-management",label:"Service Management",path:"/service-management",icon:""}];function uee(){const{token:t,user:s,scope:r,setScope:a,logout:n,hasModuleAccess:i}=ca(),{theme:l}=DC(),{pending:o,failed:u,completed:d,items:c,lastEvent:h}=oee(),A=ys(),f=ma(),[g,v]=x.useState(!1),[b,y]=x.useState(!1);x.useEffect(()=>{if(h==="queued"){y(!0);const le=setTimeout(()=>y(!1),3e3);return()=>clearTimeout(le)}},[h]);const[j,N]=x.useState(typeof navigator<"u"?navigator.onLine!==!1:!0);x.useEffect(()=>{function le(){N(!0)}function Z(){N(!1)}return window.addEventListener("online",le),window.addEventListener("offline",Z),()=>{window.removeEventListener("online",le),window.removeEventListener("offline",Z)}},[]),x.useEffect(()=>{try{if("serviceWorker"in navigator){const le=Z=>{const ve=(Z==null?void 0:Z.data)||{};ve.type==="navigate"&&typeof ve.url=="string"&&A(ve.url)};return navigator.serviceWorker.addEventListener("message",le),()=>navigator.serviceWorker.removeEventListener("message",le)}}catch{}},[A]),x.useEffect(()=>{async function le(){try{const Z=f.pathname||"/",Ue=(Z.split("/").filter(Boolean)[0]||"dashboard").replace(/-/g," ").replace(/\b\w/g,Be=>Be.toUpperCase());await ee.post("/admin/activity/log",{module_name:Ue,action:"VIEW",ref_no:String((s==null?void 0:s.username)||""),message:"Page View",url_path:Z,event_time:new Date().toISOString()})}catch{}}le()},[f.pathname]);const[S,B]=x.useState(()=>typeof window<"u"?window.matchMedia("(min-width: 768px)").matches:!1),[P,L]=x.useState(!1),U=x.useRef(null),[H,q]=x.useState(!1),[V,M]=x.useState(!1),[z,I]=x.useState(0),[G,Y]=x.useState(0),J=x.useMemo(()=>{const le=(s==null?void 0:s.username)||(s==null?void 0:s.name)||"Guest",Z=(s==null?void 0:s.role)||(Array.isArray(s==null?void 0:s.roles)?s.roles[0]:null)||"Developer",ve=(s==null?void 0:s.companyName)||`Company #${(r==null?void 0:r.companyId)??"-"}`,Ue=(s==null?void 0:s.branchName)||`Branch #${(r==null?void 0:r.branchId)??"-"}`;return{username:le,role:Z,companyName:ve,branchName:Ue}},[r==null?void 0:r.branchId,r==null?void 0:r.companyId,s]),T=x.useMemo(()=>Array.isArray(s==null?void 0:s.roles)?s.roles:s!=null&&s.role?[s.role]:[],[s==null?void 0:s.roles,s==null?void 0:s.role]),[k,D]=x.useState(()=>Array.isArray(s==null?void 0:s.roles)?s.roles[0]:(s==null?void 0:s.role)||null),[Q,C]=x.useState([]),[E,w]=x.useState(!1);x.useEffect(()=>{const le=Number((s==null?void 0:s.sub)||(s==null?void 0:s.id));if(!Number.isFinite(le)){C([]);return}let Z=!0;async function ve(){var Ue,Be,_e;w(!0);try{const Me=await ee.get(`/admin/users/${le}/roles`),Ye=Array.isArray((Ue=Me.data)==null?void 0:Ue.items)?Me.data.items:[];Z&&C(Ye),Z&&Ye.length>0&&!k&&D(((Be=Ye[0])==null?void 0:Be.name)||((_e=Ye[0])==null?void 0:_e.code)||null)}catch{Z&&C([])}finally{Z&&w(!1)}}return ve(),()=>{Z=!1}},[]),x.useEffect(()=>{M(!1),I(0),Y(0)},[r==null?void 0:r.companyId,r==null?void 0:r.branchId]),x.useEffect(()=>{let le=!1;async function Z(){var ve;try{let Ue=function(be){const Ce="=".repeat((4-be.length%4)%4),Te=(be+Ce).replace(/-/g,"+").replace(/_/g,"/"),ue=window.atob(Te),ge=new Uint8Array(ue.length);for(let Ve=0;Ve<ue.length;++Ve)ge[Ve]=ue.charCodeAt(Ve);return ge};const Be=typeof localStorage<"u"?localStorage.getItem("push_enabled"):null;if(!(Be===null?!0:String(Be)==="1")||typeof window>"u"||!("serviceWorker"in navigator)||!("PushManager"in window)||!("Notification"in window)||window.Notification.permission!=="granted")return;const Me=await navigator.serviceWorker.ready,Ye=await ee.get("/push/public-key"),ot=String(((ve=Ye.data)==null?void 0:ve.publicKey)||"");if(!ot)return;const Ke=Ue(ot),ct=await Me.pushManager.getSubscription();if(ct&&ct.endpoint){await ee.post("/push/subscribe",{subscription:ct.toJSON()});return}const xt=await Me.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ke});if(le)return;await ee.post("/push/subscribe",{subscription:xt.toJSON()})}catch{}}return Z(),()=>{le=!0}},[t]),x.useEffect(()=>{let le=null;async function Z(){var Ue,Be;try{const _e=await ee.get("/workflows/notifications"),Me=Array.isArray((Ue=_e.data)==null?void 0:Ue.items)?_e.data.items:[],Ye=Me.filter(ot=>Number(ot.is_read)!==1).length;if(Y(Ye),typeof window<"u")try{const ot="notified_notification_ids",Ke=localStorage.getItem(ot),ct=Ke?JSON.parse(Ke):[],xt=new Set(Array.isArray(ct)?ct:[]),be="Notification"in window&&((Be=window.Notification)==null?void 0:Be.permission)==="granted",Ce="/OMNISUITE_ICON_CLEAR.png";for(const Te of Me){const ue=Number(Te.id);if(Number(Te.is_read)!==1&&!xt.has(ue)){try{gv({title:String(Te.title||"Notification"),message:String(Te.message||""),native:be,icon:Ce,onClick:()=>{Te.link?A(String(Te.link)):A("/notifications")}})}catch{}xt.add(ue)}}localStorage.setItem(ot,JSON.stringify(Array.from(xt)))}catch{}}catch{}}async function ve(){var Ue,Be;try{if(V)return;const _e=await ee.get("/inventory/alerts/low-stock"),Me=Array.isArray((Ue=_e.data)==null?void 0:Ue.items)?_e.data.items:[];if(!Me.length)return;M(!0),I(Me.length);const Ye=Me.length,ot=typeof window<"u"&&"Notification"in window&&((Be=window.Notification)==null?void 0:Be.permission)==="granted",Ke="/OMNISUITE_ICON_CLEAR.png";if(Ye<=5)for(const ct of Me){const xt=Number(ct.qty||0),be=Number(ct.reorder_level||0);nt.warn(`${ct.item_code}: stock ${xt}  reorder ${be} (${ct.item_name})`);try{gv({title:"Low Stock",message:`${ct.item_code}: stock ${xt}  reorder ${be}`,native:ot,icon:Ke,onClick:()=>A("/inventory/alerts/low-stock")})}catch{}}else{nt.warn(`${Ye} items are at or below reorder levels. Check Inventory.`);try{gv({title:"Low Stock",message:`${Ye} items are at or below reorder levels`,native:ot,icon:Ke,onClick:()=>A("/inventory/alerts/low-stock")})}catch{}}}catch{}}return ve(),Z(),le=setInterval(Z,6e4),()=>{le&&clearInterval(le)}},[r==null?void 0:r.companyId,r==null?void 0:r.branchId,V]),x.useEffect(()=>{if(typeof window<"u"&&"Notification"in window&&window.Notification.permission==="default")try{window.Notification.requestPermission().catch(()=>{})}catch{}},[]),x.useEffect(()=>{const le=Array.isArray(s==null?void 0:s.roles)?s.roles:s!=null&&s.role?[s.role]:[];le.length&&!le.includes(k)&&D(le[0])},[s==null?void 0:s.roles,s==null?void 0:s.role,k]);const O=x.useMemo(()=>Number((s==null?void 0:s.sub)||(s==null?void 0:s.id)),[s==null?void 0:s.sub,s==null?void 0:s.id]),[R,X]=x.useState([]),[ne,te]=x.useState(null),[oe,ce]=x.useState([]);x.useEffect(()=>{let le=!0;async function Z(){var ve,Ue;try{if(!Number.isFinite(O))return;const Be=await ee.get(`/admin/users/${O}/branches`),_e=Array.isArray((ve=Be.data)==null?void 0:ve.items)?Be.data.items:[];le&&(X(_e),!ne&&_e.length>0&&te(Number(_e[0].id)))}catch{try{const Be=await ee.get("/admin/branches"),_e=Array.isArray((Ue=Be.data)==null?void 0:Ue.items)?Be.data.items:[],Me=Array.isArray(s==null?void 0:s.branchIds)?s.branchIds.map(Number).filter(ot=>Number.isFinite(ot)):[],Ye=_e.filter(ot=>Me.includes(Number(ot.id)));le&&(X(Ye),!ne&&Ye.length>0&&te(Number(Ye[0].id)))}catch{}}}return Z(),()=>{le=!1}},[O,s==null?void 0:s.branchIds,ne]),x.useEffect(()=>{let le=!0;async function Z(){var ve;try{const Ue=await ee.get("/admin/companies"),Be=Array.isArray((ve=Ue.data)==null?void 0:ve.items)?Ue.data.items:[];le&&ce(Be)}catch{}}return Z(),()=>{le=!1}},[]);const re=x.useMemo(()=>{const le=R.find(Z=>Number(Z.id)===Number(r==null?void 0:r.branchId));if(le){const Z=le.company_name||`Company #${le.company_id}`;return`${le.name} (${Z})`}return J.branchName},[R,r==null?void 0:r.branchId,J.branchName]),de=x.useMemo(()=>{const le=R.find(ve=>Number(ve.id)===Number(r==null?void 0:r.branchId));if(le)return le.company_name||`Company #${le.company_id}`;if(R.length===1){const ve=R[0];return ve.company_name||`Company #${ve.company_id}`}const Z=oe.find(ve=>Number(ve.id)===Number(r==null?void 0:r.companyId));return Z?Z.name:(s==null?void 0:s.companyName)||`Company #${(r==null?void 0:r.companyId)??"-"}`},[R,r==null?void 0:r.branchId,s==null?void 0:s.companyName,r==null?void 0:r.companyId,oe]);x.useEffect(()=>{const le=Array.isArray(Q)&&Q.length>1||Array.isArray(T)&&T.length>1,Z=Array.isArray(R)?R.length>1:!1;le&&Z&&q(!0)},[Q,T,R]);const Ie=x.useMemo(()=>{const le=f.pathname.replace(/\/+$/,"")||"/";return le==="/"||le==="/dashboard"?!0:VS.some(Z=>Z.path===le)},[f.pathname]);return x.useEffect(()=>{typeof window<"u"&&(window.matchMedia("(min-width: 768px)").matches?B(Ie):B(!1))},[f.pathname,Ie]),x.useEffect(()=>{function le(Z){U.current&&(U.current.contains(Z.target)||L(!1))}return document.addEventListener("mousedown",le),()=>document.removeEventListener("mousedown",le)},[]),e.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-900 dark:bg-slate-900 dark:text-slate-100 flex flex-col",children:[e.jsxs("header",{className:"flex justify-between items-center px-6 py-1 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 shadow-sm z-50 sticky top-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button","aria-label":"Open menu",onClick:()=>B(le=>!le),className:"inline-flex items-center justify-center w-9 h-9 rounded-lg text-slate-500 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800 transition-colors",children:e.jsx("span",{className:"text-xl leading-none","aria-hidden":"true",children:""})}),e.jsx(Le,{to:"/",className:"inline-flex items-center","aria-label":"Go to Home",children:e.jsx("img",{src:l==="dark"?lee:qs,alt:"OmniSuite",className:"h-8 w-auto"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sL,{}),e.jsxs("button",{type:"button","aria-label":"Notifications",onClick:()=>A("/notifications"),className:"relative inline-flex items-center justify-center w-9 h-9 rounded-lg text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-800 transition-colors",title:"Notifications",children:[e.jsx(XT,{size:18}),(G>0||z>0)&&e.jsx("span",{className:"absolute -top-1 -right-1 text-[10px] leading-none font-bold px-1.5 py-0.5 rounded-full bg-red-600 text-white",children:G>0?G>99?"99+":G:z>99?"99+":z})]}),e.jsxs("div",{className:"relative",ref:U,children:[e.jsxs("button",{type:"button",onClick:()=>L(le=>!le),className:"inline-flex items-center gap-2 px-3 py-1 rounded-lg text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800 transition-colors",children:[e.jsx("span",{className:"text-sm font-semibold",children:"User Profile"}),e.jsx("span",{"aria-hidden":"true",children:""})]}),P&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 shadow-erp-lg overflow-hidden z-50",children:[e.jsx("div",{className:"p-4 border-b border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:J.username})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Company"}),e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100 text-right",children:de})]}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("div",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Branch"}),e.jsx("div",{className:"text-right",children:R.length>1?e.jsx("select",{className:"input",value:String((r==null?void 0:r.branchId)||ne||""),onChange:le=>{const Z=Number(le.target.value);te(Z),a(ve=>{const Ue=R.find(_e=>Number(_e.id)===Z),Be=Ue?Number(Ue.company_id):ve.companyId;return{...ve,companyId:Be,branchId:Z}}),L(!1)},children:R.map(le=>e.jsxs("option",{value:le.id,children:[le.name," (",le.company_name||`Company #${le.company_id}`,")"]},le.id))}):e.jsx("div",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100",children:re})})]}),e.jsx("div",{className:"pt-1",children:e.jsx("button",{type:"button",onClick:()=>q(!0),className:"btn-primary w-full",disabled:(Q.length>1||T.length>1)&&R.length>1,children:"Switch Context"})}),e.jsx("div",{className:"pt-3 border-t border-slate-200 dark:border-slate-700 flex justify-end",children:e.jsx("button",{type:"button",onClick:()=>{L(!1),n(),A("/login",{replace:!0})},className:"btn-secondary",children:"Logout"})})]})]})]})]})]}),b&&e.jsx("div",{className:"px-6 py-2 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 border-b border-green-300 dark:border-green-800 text-sm",children:"Saved Offline"}),!j&&e.jsx("div",{className:"px-6 py-2 bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200 border-b border-yellow-300 dark:border-yellow-800 text-sm",children:"Offline mode enabled. Pages and assets are cached. Actions queue for sync."}),g&&e.jsxs("div",{className:"px-6 py-3 border-b border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950",children:[e.jsxs("div",{className:"text-sm",children:["Pending ",o,"  Failed ",u,"  Completed ",d]}),e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[c.map(le=>e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 rounded border border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:le.method.toUpperCase()})," ",e.jsx("span",{className:"text-slate-500",children:le.url})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:le.status==="pending"?"badge bg-yellow-100 text-yellow-800 border-yellow-300 dark:bg-yellow-900 dark:text-yellow-200 dark:border-yellow-800":le.status==="failed"?"badge bg-red-100 text-red-800 border-red-300 dark:bg-red-900 dark:text-red-200 dark:border-red-800":"badge bg-green-100 text-green-800 border-green-300 dark:bg-green-900 dark:text-green-200 dark:border-green-800",children:le.status})})]},le.id)),c.length===0&&e.jsx("div",{className:"text-xs text-slate-500",children:"No queued items"})]})})]}),H&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"w-full max-w-md card p-6 shadow-erp-lg bg-white dark:bg-slate-900",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Switch Role & Branch"}),e.jsx("button",{type:"button",className:"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200",onClick:()=>q(!1),"aria-label":"Close",children:""})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Company"}),e.jsx("div",{className:"input",children:de})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Role"}),Q.length>1||T.length>1?e.jsx("select",{className:"input w-full",value:k||"",onChange:le=>D(le.target.value),disabled:E,children:(Q.length?Q:T).map(le=>{const Z=typeof le=="string"?le:le.name||le.code,ve=typeof le=="string"?le:le.id;return e.jsx("option",{value:Z,children:Z},ve)})}):e.jsx("div",{className:"input",children:k||J.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Branch"}),R.length>1?e.jsx("select",{className:"input w-full",value:String(ne||(r==null?void 0:r.branchId)||""),onChange:le=>te(Number(le.target.value)),children:R.map(le=>e.jsxs("option",{value:le.id,children:[le.name," (",le.company_name||`Company #${le.company_id}`,")"]},le.id))}):e.jsx("div",{className:"input",children:re})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>q(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn-primary",disabled:(Q.length>1||T.length>1)&&!k||R.length>1&&!ne,onClick:()=>{const le=R.find(Z=>Number(Z.id)===Number(ne||(r==null?void 0:r.branchId)));a(Z=>({...Z,companyId:le?Number(le.company_id):Z.companyId,branchId:le?Number(le.id):Z.branchId})),q(!1),L(!1)},children:"Apply"})]})]})}),e.jsxs("div",{className:"flex-1 "+(S?"grid md:grid-cols-[280px_1fr]":"grid grid-cols-1"),children:[S&&e.jsx("button",{type:"button","aria-label":"Close menu",onClick:()=>B(!1),className:"fixed inset-0 z-40 bg-black/40 md:hidden"}),e.jsx("aside",{className:"border-b md:border-b-0 md:border-r border-slate-800 dark:border-slate-800 p-5 md:sticky md:top-[45px] md:h-[calc(100vh-45px)] bg-brand-950 dark:bg-slate-950 shadow-lg overflow-y-auto no-scrollbar z-40 "+(S?"fixed md:static inset-y-0 left-0 w-[280px] top-[45px]":"hidden"),children:e.jsxs("nav",{className:"space-y-1 pb-6",children:[e.jsxs(fN,{to:"/",end:!0,className:({isActive:le})=>"flex items-center px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group "+(le?"bg-brand-800 text-white shadow-lg border-l-4 border-primary-light":"text-brand-200 hover:bg-brand-800 hover:text-white border-l-4 border-transparent"),children:[e.jsx("span",{className:"w-6 text-lg leading-none opacity-80 group-hover:opacity-100 transition-opacity","aria-hidden":"true",children:""}),"Home"]}),VS.filter(le=>i(le.label)).map(le=>e.jsxs(fN,{to:le.path,className:({isActive:Z})=>"flex items-center px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group "+(Z?"bg-brand-800 text-white shadow-lg border-l-4 border-primary-light":"text-brand-200 hover:bg-brand-800 hover:text-white border-l-4 border-transparent"),children:[e.jsx("span",{className:"w-6 text-lg leading-none opacity-80 group-hover:opacity-100 transition-opacity","aria-hidden":"true",children:le.icon}),e.jsx("span",{children:le.label})]},le.key))]})}),e.jsx("main",{className:"bg-slate-50 dark:bg-slate-900",children:e.jsx("div",{className:"w-full max-w-full lg:max-w-[1200px] mx-auto p-3 md:p-4 lg:p-6",children:e.jsxs(Ji,{children:[e.jsx(Je,{path:"/",element:e.jsx(aL,{})}),e.jsx(Je,{path:"/dashboard",element:e.jsx(rL,{})}),e.jsx(Je,{path:"/administration/*",element:e.jsx(_L,{})}),e.jsx(Je,{path:"/sales/*",element:e.jsx(pY,{})}),e.jsx(Je,{path:"/inventory/*",element:e.jsx(aX,{})}),e.jsx(Je,{path:"/purchase/*",element:e.jsx(SJ,{})}),e.jsx(Je,{path:"/finance/*",element:e.jsx(XJ,{})}),e.jsx(Je,{path:"/human-resources/*",element:e.jsx(hZ,{})}),e.jsx(Je,{path:"/maintenance/*",element:e.jsx(vZ,{})}),e.jsx(Je,{path:"/project-management/*",element:e.jsx(wZ,{})}),e.jsx(Je,{path:"/production/*",element:e.jsx(BZ,{})}),e.jsx(Je,{path:"/pos/*",element:e.jsx(KZ,{})}),e.jsx(Je,{path:"/business-intelligence/*",element:e.jsx(ZZ,{})}),e.jsx(Je,{path:"/service-management/*",element:e.jsx(nee,{})}),e.jsx(Je,{path:"/notifications",element:e.jsx(iee,{})})]})})})]}),e.jsx(dee,{})]})}function Aee(){const t="/".replace(/\/+$/,""),s=t.startsWith("/")?t:"/";return e.jsx(IF,{basename:s,children:e.jsx(WI,{store:X6,children:e.jsx(MT,{children:e.jsxs(QT,{children:[e.jsx(YF,{position:"top-right",theme:"dark"}),e.jsx(t5.Notifications,{}),e.jsxs(Ji,{children:[e.jsx(Je,{path:"/login",element:e.jsx(BI,{})}),e.jsx(Je,{path:"/forgot-password",element:e.jsx(EI,{})}),e.jsx(Je,{path:"/reset-password",element:e.jsx(FI,{})}),e.jsx(Je,{path:"/select-branch",element:e.jsx(ON,{children:e.jsx(J6,{})})}),e.jsx(Je,{path:"/*",element:e.jsx(ON,{children:e.jsx(uee,{})})}),e.jsx(Je,{path:"*",element:e.jsx(Hc,{to:"/",replace:!0})})]})]})})})})}const hee="/assets/OMNISUITE_ICON_CLEAR-n2Vk6MyQ.png";(function(){try{const s=document.head||document.getElementsByTagName("head")[0];["icon","shortcut icon","apple-touch-icon","apple-touch-icon-precomposed"].forEach(a=>{let n=document.querySelector(`link[rel="${a}"]`);n||(n=document.createElement("link"),n.setAttribute("rel",a),n.setAttribute("type","image/png"),a.startsWith("apple-touch-icon")&&n.setAttribute("sizes","180x180"),s.appendChild(n)),n.setAttribute("href",hee)})}catch{}})();DE.createRoot(document.getElementById("root")).render(e.jsx(Ts.StrictMode,{children:e.jsx(Aee,{})}));"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js")});export{Hr as _,fee as c,Iy as g};
